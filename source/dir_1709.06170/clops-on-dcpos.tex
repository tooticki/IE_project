\documentclass[11pt,letterpaper]{article}

\pdfoutput=1

%\usepackage[bookmarks=false]{hyperref}
%\usepackage[bookmarks=true]{hyperref}
\usepackage{hyperref}

\input{extended-preamble.tex}

%\addtotextwidth{2cm}
%\addtotextheight{2.75cm}
\addtotextwidth{2cm}
\addtotextheight{3cm}

\captionsetup{margin=2.7em,%
	format=plain,%
	labelsep=period,%
	indention=1.35em,%
	%justification=justified,%
	font=small,labelfont=bf}

%\renewcommand{\baselinestretch}{1.05}
\renewcommand{\baselinestretch}{1.0618}
\setlength{\parindent}{1.25em}

\input{join-induction-preamble.tex}

\renewcommand{\emph}[1]{\textit{#1\/}}

\renewcommand{\thmskip}{\bigskip}
\renewcommand{\interskip}{\medskip}
\renewcommand{\inskip}{\smallskip}

\hypersetup{
  pdftitle={Closure operators on dcpos)},
  pdfauthor={France Dacar},
  %pdfkeywords={dcpo, closure, Scott-continuous, Scott-open, domain, preframe, frame, fitted}
}

%====================================================================================================
% Title: Closure operators on dcpos
% Author: France Dacar
% Subject: 
% Keywords: 
%====================================================================================================

\title{Closure operators on dcpos}

\author{France Dacar, Jo\v{z}ef Stefan Institute\\
	{\tt France.Dacar@ijs.si}}

%\date{May 20, 2017} % started
%\date{September 12, 2017} % --> arXiv
\date{\today}

%====================================================================================================
\begin{document}

\maketitle

\begin{abstract}
We examine collective properties of closure operators on posets that are at least dcpos.
The first theorem sets the tone of the paper:
it tells how a~set of preclosure maps on a~dcpo determines the least closure operator above them,
and pronounces the related induction principle, and its companion, the obverse induction principle.
Using this theorem we prove that the poset of closure operators on a~dcpo is a~complete lattice,
and then provide a~constructive proof of the Tarski's theorem for dcpos.
We go on to construct the joins
	in the complete lattice of \Scottcont\ closure operators on a~dcpo,
and to prove that the complete lattice of nuclei on a~preframe is a~frame,
giving some constructions in the special case of the frame of all nuclei on a~frame.
In~the rather drawn-out proof if the Hofmann--Mislove--Johnstone theorem
we show off the utility of the obverse induction, applying it in the proof of the crucial lemma.
After that we shift a~viewpoint and prove some results, analogous to results about dcpos,
for posets in which certain special subsets have enough maximal elements;
these results actually specialize to dcpos, but at the price of using the axiom of choice.
We conclude by pointing out two convex geometries associated with closure operators on a~dcpo.
\end{abstract}

\hypersetup{
  pdftitle={Closure operators on dcpos},
  pdfauthor={France Dacar},
  pdfkeywords={}
}

%====================================================================================================


%----------------------------------------------------------------------------------------------------
\section{Preliminaries}
\label{sec:prelims}

In this section we present notation and terminology, and state some basic facts.

\txtskip

For every set $X$ we denote the set of all subsets of $X$ by $\Pow\negdtinysp X$.

If $X$ and $Y$ are sets,
	then $\Fun(X,Y)$ denotes the set of all functions from~$X$ to~$Y$.
We write $\Fun(X,X)$ as $\Fun(X)$.

If~$X$ and~$Y$ are~sets, $A\subseteq X$, and $F\subseteq\Fun(X,Y)$,
then we write $F(A)$ for the set $\set{f(a)\suchthat \text{$f\in F$ and $a\in A$}}\subseteq B$.
We write $\set{f}(A)$ as $f(A)$ and $F\bigl(\set{a}\bigr)$ as~$F(a)$.

\txtskip

Let $X$ be a set and $F$ a set of functions $X\negdtinysp\to X$.

A~\notion{fixed point}, or~\notion{fixpoint}, of $F$
	is an~$x\in X$ such that $f(x) = x$ for every~$f\in\nolinebreak F$.
We~denote the set of all fixed~points~of~$F$~by~$\Fix(F)$,
	and call it the~\notion{fixpoint~set}~of~$F\negtinysp$.
We~write $\Fix(\set{f})$ as~$\Fix(f)\tinysp$;
always $\Fix(f)\narrt\subseteq f(X)$, and $\Fix(f) = f(X)$ iff $f$~is an~idempotent function.
Note that $\Fix(F) = \Inters_{f\in F}\Fix(f)\tinysp$; in particular $\Fix(\emptyset) = X$.

Let $A$ be a~subset of~$X$.
The~subset $A$ is said to be \notion{closed under}~$F$ if $F(A)\subseteq A\dtinysp$;
as a~special case, $a\in X$ is a fixed point of $F$ iff $\set{a}$ is closed under~$F$.
%
The~subset~$A$~is said to be \notion{inversely closed under}~$F$
	if~$f^{-1}(A)\subseteq A$ for every $f\in F$.
The~subset~$A$~is closed under~$F$
iff its complement $X\negdtinysp\narrdt\setdiff A$ is inversely closed under~$F\tinysp$:
the statement
    $(\forall x\narr\in X)(\forall\negtinysp f\narr\in F)
		(x\narrdt\in A\widet\impl f(x)\narrdt\in A)$
says that $A$ is closed under $F\tinysp$;
it is equivalent to the statement
    $(\forall x\narr\in X)(\forall\negtinysp f\narr\in F)
		(f(x)\narrdt\notin A \widet\impl x\narrdt\notin A)$,
which says that $X\negdtinysp\narrdt\setdiff A$ is inversely closed under~$F$.

\txtskip

Let $P$ be a~poset.

If a~subset of the poset $P$ has a~least (greatest) element, we shall write it
	as $\widedt{\tbot(A)}$ {\large(}$\widedt{\ttop(A)}${\large)}.
If the whole poset~$P$ has a~least (greatest) element, we shall rather write it
	as $\bot = \bot_{\tinysp P}\tinysp$ {\large(}resp.\ $\top = \top_{\!P}${\large)}.

Let $x\in P$ and $A\subseteq P$.
We shall denote by $\allabove{A}{x}$ the set $\set{y\narrt\in A\negtinysp\suchthat y\geq x}$
	of all~ele\-ments of~$A$ above~$x\tinysp$,
and by $\allbelow{A}{x}$ the set $\set{y\narrt\in A\negtinysp\suchthat y\leq x}$
	of all elements of~$A$ below~$x\tinysp$.
In~particular, $\lup x = \allabove{P}{x}$ is the principal filter of $P$ generated by~$x\tinysp$,
and $\ldown x = \allbelow{P\negtinysp}{x}$ is the principal ideal of $P$ generated by~$x\tinysp$.
We~shall~write~$x\geq A$ ($x\leq A$) to mean that $x\geq a$ ($x\leq a$) for every~$a\in A\tinysp$,
	that is,~that $x$~is~an upper (lower) bound~of~$A\tinysp$.

A~\notion{lower set} of the~poset~$P$ is a~subset $A$ of~$P$
	such that $x\in A\tinysp$, $y\in P$, and $x\geq y$ imply $y\in A\tinysp$.
Dually, an~\notion{upper set} of the~poset~$P$ is a~subset~$A$ of~$P$
	such that $x\in A\tinysp$, $y\in P$, and $x\leq y$ imply $y\in A\tinysp$.
A~subset~$A$ of the~poset~$P$ is a~lower set of~$P$
	\iff\ its complement $P\narrdt\setdiff A$ is an upper set of~$P$.

Let $X$ be a~subset of the~poset~$P$.
We shall denote by $\ldown X$ the lower set of $P$ generated by $X$
	{\large(}which is the least lower set of $P$ that contains~$X${\large)}:
$\ldown X = \tUnion_{x\in X} \ldown x\tinysp$.
Dually, we shall denote by $\lup\negtinysp X$ the upper set generated by~$X$.

A~poset $D$ is said to be \notion{(upward) directed}
if it is nonempty and every two elements of $D$ have an upper bound in~$D$,
or equivalently, if every finite (possibly empty) subset of $D$ has an upper bound in~$D$.
A~subset of the poset $P$ is \notion{(upward) directed}
	if it is directed as a~subposet of~$P$.
Dually there is the notion of a~\notion{downward directed} (subset of~a)~poset.
An~\notion{ideal} of the poset $P$ is a~directed lower set of~$P$,
and dually, a~\notion{filter} of the poset $P$ is a~downward directed upper set of~$P$.

\txtskip

A~\notion{directed complete poset}, or a~\notion{dcpo} for short,
is a~poset in which every directed subset has a~join.
A~dcpo is said to be \notion{pointed} if it has a~least element.

Let $A$ be a~subset of a~dcpo~$P$.
The~subset~$A$ is said to be \notion{closed under directed joins},
	or~shorter, \notion{directed-closed},
if for every directed subset $D$ of $A$ its join $\tJoin\!D$ in~$P$ lies~in~$A$.
The subset $A$ is said to be \notion{inaccessible by directed joins}
if every directed subset $D$ of $P$ whose join lies in~$A$
	has at least an element in~$A\tinysp$ (that is, intersects~$A$).
The subset~$A$ is inaccessible by directed joins \iff\
	its complement $P\narrdt\setdiff A$ is closed under directed joins.

\txtskip

A~function $f$ from a~poset~$P$ to a~poset~$Q$ is \notion{increasing} (\notion{decreasing})
if~$x\leq y$ in~$P$ always implies $f(x)\leq f(y)$ {\large(}$f(x)\geq f(y)${\large)}~in~$Q$.
If~$f\colon P\to Q$ and $g\colon Q\to R$ are increasing functins between posets,
then the composite $gf = g\narrt\compose f\colon P\to R$ is increasing.
The set of all increasing functions $P\to Q$ shall be denoted by $\Inc(P,Q)$,
and $\Inc(P,P)$ will be shortened to $\Inc(\negtinysp P)$.
If $P$ is a~poset ordered by $\leq\dtinysp$,
then the poset on the same set of elements, but ordered by~$\geq\dtinysp$,
is said to be the \notion{opposite} %, or the \notion{dual},
	of~the~poset~$P$
and is denoted by $P^{\tinysp\op}$.
If $P$ and $Q$ are posets,
then an increasing function $P\to Q$ is also an increasing function $P^{\tinysp\op}\to Q^\op$,
and a~decreasing function $P\to Q$
is~the~same~thing as an increasing function $P\to Q^\op$
	or an increasing function $P^{\tinysp\op}\to Q\tinysp$.

For any set $X$ and any poset $P$ the set $\Fun(X,P)$ of all functions $X\to P$
	is made into a~poset with the pointwise partial ordering:
if $f,\tinysp g\colon X\to P$, then we let $f\leq g$ iff $f(x)\leq g(x)$ for every $x\in X$.
In particular, for any posets $P$ and $Q$ the set $\Inc(P,Q)$ is~made~into a~poset in this way.
Let~$P$,~$Q$,~$R$ be~posets.
The composition
%
\begin{equation*}
\Inc(Q,R)\narrt\times\Inc(P,Q) \wide\longto \Inc(P,R) \wide: (g,f) \wide\longmapsto gf
\end{equation*}
%
is~increasing in both operands:
if $f_1\leq f_2$ in $\Inc(P,Q)$ and $g\in\Inc(Q,R)\tinysp$,
	then $gf_1\leq gf_2$
	because $\Inc(P,Q)$ and $\Inc(P,R)$ are ordered pointwise and $g$ is increasing,
and if we have $f\in\Inc(P,Q)$ and $g_1\leq g_2$ in $\Inc(Q,R)$,
	then $g_1f\leq g_2f$
	because $\Inc(Q,R)$ and $\Inc(P,R)$ are ordered pointwise.
In particular, $\Inc(\negtinysp P)$ is an ordered composition monoid.

\txtskip

Let $f$ be an endofunction on a~poset~$P$.
We say that $f$ \notion{ascends} (\notion{descends}) on $x\in P$
	if $x\leq f(x)$ {\large(}$x\geq f(x)${\large)}.
The function $f$ is \notion{ascending} (\notion{descending})
	if $f$ ascends (descends) on every element of~$P$.
An~ascending and increasing function $f$ is called a~\notion{preclosure map}
	(\aka\ an~\knownas{inflationary map}, as in~Escard\'o~\cite{escardo}).
The set $\Asc\tinysp(\negtinysp P)$ of all ascending maps on a~poset~$P$ is a~composition monoid;
it is also a~poset (ordered pointwise),
	but~it~is~not, in general, an ordered monoid.
However, the set $\Precl(\negtinysp P)$ of all preclosure maps on a~poset~$P$
is a~submonoid, and hence a~sub-(ordered monoid),%
%
\footnote{Every submonoid of an ordered monoid $M$ becomes a~sub-(ordered monoid)
when we equip it with the partial order induced from~$M$.}
%
of the ordered monoid $\Inc\tinysp(\negtinysp P)$.

A~\notion{closure operator} on a~poset~$P$ is an idempotent preclosure map on~$P$,
that is, it is an endofunction on $P$ that is ascending, increasing, and idempotent;
the poset of all closure operators on $P$, ordered pointwise, is denoted by~$\Cl(\negtinysp P)$.
Dually, an \notion{interior operator} on a~poset~$P$ is a~closure operator on $P^{\tinysp\op}$,
that is, it is an endofunction on~$P$ that is descending, increasing, and idempotent.

If~$g$ is a~preclosure map on~$P$ and $h$ is a~closure operator on~$P$,
then the inequality $g\leq h$ is equivalent to
	either of the equalities $gh = h$, $hg = h$.

A~\notion{closure system} in a~poset~$P$
	is a~fixpoint set of some closure operator on~$P$.
A~subset~$C$ of~$P$ is a~closure system in~$P$
	\iff\ for every $x\in P$ the set $\allabove{C}{x}$ has a~least element.
If $C$ is a~closure system in~$P$,
then the endofunction~$\gamma$ on~$P$, which sends every $x\narrt\in P$
	to the least element $\gamma(x)$ of $\allabove{C}{x}$,
is a~closure operator denoted~by~$\cl_{\tinysp C}\tinysp$.
We~de\-note~by~$\ClSys(\negtinysp P)$ the poset of all closure systems in~$P$ ordered by inclusion.
The~map $\Cl(\negtinysp P)\to\ClSys(\negtinysp P) : \gamma\mapsto\Fix(\gamma)$
	is an antiisomorphism of posets,
with the inverse $\ClSys(\negtinysp P)\to\Cl(\negtinysp P) : C\mapsto\cl_{\tinysp C}\tinysp$.
The~notion of an~\notion{interior system} is dual to that of a~closure system;
that is, an interior system in a~poset~$P$
	is a~fixpoint set of some interior operator on~$P$.

Let $\gamma$ be a~closure operator on~$P$.
If~a~subset $S$ of the closure system $\gamma(\negtinysp P)$
	has a~join in the subposet $\gamma(\negtinysp P)$ of~$P$,
we write the join as~$\Join^{\tinysp\gamma}\!S$.
For~any subset~$S$ of~$P$ which has a~join $\Join\!S$ in the poset~$P$,
the~subset~$\gamma(S)$ of $\gamma(\negtinysp P)$ has in the subposet~$\gamma(\negtinysp P)$ the~join
	$\Join^{\tinysp\gamma}\negdtinysp\gamma(S) = \gamma(\Join\!S)$.
In~particular, if~$S\subseteq\gamma(\negtinysp P)$ has a~join $\Join\!S$ in~$P$,
then~$S = \gamma(S)$ has the~join $\Join^{\tinysp\gamma}\!S = \gamma(\Join\!S)$ in~$\gamma(\negtinysp P)$.%
%
\footnote{A~subset of $\gamma(\negtinysp P)$ may have a~join in~$\gamma(\negtinysp P)$
	without having a~join in~$P\tinysp$.}
%
Let~$\gammapr\colon P\to\gamma(\negtinysp P)$
	be the closure operator $\gamma$
		with its codomain restricted to the subposet~$\gamma(\negtinysp P)$ of~$P\tinysp$;
then~$\gammapr$~preserves all joins which exist~in~$P$.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{comment}
On the other hand, the inclusion map $\kappa\colon (\negtinysp P)\into P$
	preserves all meets that exist in $\gamma(\negtinysp P)\tinysp$:
if $S\subseteq\gamma(\negtinysp P)$ has a~meet $\Meet^{\!\gamma}\!S$ in $\gamma(\negtinysp P)$,
then $\Meet^{\!\gamma}\!S = \kappa(\Meet^{\!\gamma}\!S) = \Meet\negtinysp S$,
	where the last meet is taken in~$P$.
Moreover, if a~subset $S$ of $\gamma(\negtinysp P)$ has a~meet $\Meet\negtinysp S$ in~$P$,
then this meet belongs to $\gamma(\negtinysp P)$
	and hence is the meet of $S$ in~$\gamma(\negtinysp P)\dtinysp$:
		$\Meet\negtinysp S=\Meet^{\!\gamma}\!S$.
Therefore, a~subset $S$ of $\gamma(\negtinysp P)$ has a~meet in~$\gamma(\negtinysp P)$ \iff\ it has a~meet in~$P$,
	and when the two meets exist they are equal.
\end{comment}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Let $\beta$ and $\gamma$ be closure operators on a~poset~$P$
	such that $\beta\gamma\leq\gamma\beta\dtinysp$;
then $\gamma\beta$ is a~closure operator on~$P$,
and it is the join of the closure operators $\gamma$ and $\beta$ in the poset~$\cl(P)$.
Indeed, $\gamma\beta$ is a~preclosure map,
which is idempotent since
    $\gamma\beta\tinysp \gamma\beta
	\leq \gamma\tinysp\gamma\beta\beta
	= \gamma\beta\dtinysp$;
thus $\gamma\beta$~is a~closure operator.
If $\delta$ is a~closure operator and $\set{\beta,\gamma}\leq\delta$,
then $\gamma\beta\leq\delta\delta = \delta$,
and~so $\gamma\beta$~is the least upper bound of $\set{\beta,\gamma}$ in~$\Cl(P)$.
In symbols, $\gamma\beta = \beta\join\gamma$ in~$\Cl(P)$.

\txtskip

Let $L$ be a~complete lattice.

A~subset of $L$ is a~closure system \iff\ it is closed under arbitrary meets.
The~set~$\ClSys(L)$ of all closure systems in~$L$ is closed under arbitrary intersections,
and is therefore a~closure system in the complete lattice~$\Pow\negdtinysp L\dtinysp$;
consequently, the poset $\ClSys(L)$ is a~complete lattice.
The~poset~$\Cl(L)$, which is antiisomorphic to the poset~$\ClSys(L)$,
	is~likewisee a~complete lattice.
Let $\Gamma\subseteq\Cl(L)$.
The~meet of~$\Gamma$ in~$\Cl(L)$ is computed pointwise:
    $\bigl(\tMeet\negdtinysp\Gamma\bigr)(x)
	= \tMeet\negtinysp\Gamma(x)$
    for $x\in L\tinysp$.
The~join~$\tJoin\negtinysp\Gamma$ in~$\Cl(L)$ is the closure operator
whose fixpoint set
    is~$\Fix(\Gamma) = \tInters_{\tinysp\gamma\in\Gamma}\negtinysp\Fix(\gamma)\tinysp$.

Let $X$ be a~subset of $L\tinysp$.
The subset $X$ generates the closure system $\widedt{\clsys(X)}$,
	the~least closure system in $L$ that contains~$X$;
the closure system $\widedt{\clsys(X)}$ is the set of the meets of all subsets of~$X$.
The closure operator $\cl_X$ on $L$ whose fixpoint set is $\widedt{\clsys(X)}$ is~given
by~$\dtinysp\cl_X(y)
	= \tMeet(\allabove{\clsys(X)}{y})
	= \tMeet(\allabove{X\negdtinysp}{y})$
for $y\in L\tinysp$.

\txtskip

We now turn to closure operators on, and closure systems in,
	the complete lattice~$\PowE$ of all subsets of some set~$E\tinysp$.

One way to determine a~closure system in $\PowE$ is by a~set of closure rules.

A~\notion{closure rule on $E$}
is a~pair $\pair{B,c}\in\ClRul(E)\defeq(\PowE)\narrdt\times E\tinysp$,
which is usually~written as~$B\negdtinysp\adjoins{}c\tinysp$,
with the set $B$ called the~\notion{body} and the element $c$ called the~\notion{head}
of the closure rule.
If $R$ is a~set of closure rules on~$E$,
then we~write~$\pair{B,c}\in R$~as~$R\colon B\negdtinysp\adjoins{}c\dtinysp$.
When the `ambient set' $E$ is known and we write $B\negdtinysp\adjoins{}c\tinysp$,
it is understood that $B$~is a~subset of $E$ and $c$~is an element of~$E$.

A~\notion{closure theory on $E$} is a~set $T$ of closure rules on~$E$ which is
%
\begin{items}{weakening$\tinysp$:\,}
\item[reflexive$\tinysp$:\,]
	for all $B\subseteq E$ and all $b\in E\tinysp$,\\
	if $b\in B$ then $T\colon B\negdtinysp\adjoins{}b\tinysp$,\qquad and
\item[transitive$\tinysp$:\,]
	for all $B,\tinysp C\subseteq E$ and all $d\in E\tinysp$,\\
	if $T\colon B\negdtinysp\adjoins{}c$ for every $c\in C$
		and $T\colon C\negtinysp\adjoins{}d\tinysp$,
	then $T\colon B\negdtinysp\adjoins{}d\tinysp$.
\end{items}%
%
\noindent We denote by $\ClTheor(E)$ the poset of all closure theories on $E$
	ordered by inclusion.%
%
\footnote{A set of closure rules is also known as~\knownas{implicational system},
while a~closure theory is referred to as a~\knownas{complete implicational system}.}%
%

We say that a subset $X$ of $E$ \notion{obeys} a~closure rule $B\negdtinysp\adjoins{}c$ on $E$,
or that the closure rule $B\negdtinysp\adjoins{}c$ \notion{is obeyed by} the subset~$X$,
if $B\subseteq X$ implies $c\in X$.
If $\coll{X}$ is a~set of subsets of $E$ and $R$ is a~set of closure rules on~$E$,
then we say that $\coll{X}$ obeys $R$, ot that $R$ is obeyed by $\coll{X}$,
if every set in $\coll{X}$ obeys every rule in~$R\tinysp$.

The relation ``$\negtinysp X$ obeys $B\negdtinysp\adjoins{}c\tinysp$''
	between a~subset $X$ of $E$ and a~closure rule $B\negdtinysp\adjoins{}c$ on~$E$
gives rise to a~contravariant Galois connection
%
\begin{equation*}
\pair{\sigma,\varrho}
	\wide\colon \Pow\negtinysp\ClRul(E) \wide\Galoisconn (\PowPowE)^\op~,
\end{equation*}
%
where for every $R\subseteq\ClRul(E)$,
	$\sigma(R)$ is the set of all subsets of $E$ that obey~$R\tinysp$,
and for every $\coll{X}\subseteq\PowE$,
	$\varrho\tinysp(\coll{X})$ is the set of all closure rules on $E$ obeyed by~$\coll{X}$.

It is easy to verify that $\sigma(R)$~is a~closure system in the complete lattice~$\PowE$
	for every~$R\subseteq\ClRul(E)$,
and that $\varrho\tinysp(\coll{X})$~is a~closure theory on~$E$
	for every~$\coll{X}\subseteq\PowE\tinysp$.
The converse is also true:
every closure system in $\PowE$ is of the form $\sigma(R)$
	for some $R\subseteq\ClRul(E)$,
and every closure theory on $E$ is of the form $\varrho\tinysp(\coll{X})$
	for some $\coll{X}\subseteq\nolinebreak\PowE$.
In short: $\sigma\bigl(\Pow\negtinysp\ClRul(E)\bigr) = \ClSys(\PowE)$
	and $\varrho\bigl(\PowPowE\bigr) = \ClTheor(E)\tinysp$.

Given a~set $R$ of closure rules,
we shall say that the closure system $\sigma(R)$ in~$\PowE$ is~\notion{determined} by~$R\tinysp$,
and that the closure operator on $\PowE$ which has $\Fix(\gamma)=\sigma(R)$
	is~\notion{determined} by~$R\tinysp$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{comment}
The restriction $\ClTheor(E)\to\ClSys(\PowE) : T \mapsto \sys(T)$ of the mapping~$\sigma$
	is an antiisomorphism of complete lattices,
with the inverse $\ClSys(\PowE)\to\ClTheor(E) : \coll{C}\mapsto\rul(\coll{C})$,
		which is the restriction of the~mapping~$\varrho\tinysp$.

The isomorphism $\Cl(\PowE) \to \ClSys(\PowE)^\op : \gamma \mapsto \Fix(\gamma)$
composes with the isomorphism $\ClSys(\PowE)^\op \to \ClTheor(E)$
to yield the isomorphim of complete lattices $\Cl(\PowE) \to \ClTheor(E)$
which sends each closure operator $\gamma$ on $\PowE$
to the closure theory
	$\dtinysp\rul(\gamma)
	    \defeq \bigset{B\negdtinysp\adjoins{}c\bigsuchthat c\in\negtinysp\gamma(B)}$
		on~$E\tinysp$.
The~isomorphism $\ClTheor(E) \to \ClSys(\PowE)^\op$
composes with the isomorphism
	$\ClSys(\PowE)^\op \to \Cl(\PowE) : \coll{C}\mapsto\cl_{\tinysp\coll{C}}$,
yieding the isomorphism of complete lattices $\ClTheor(E) \to \Cl(\PowE)$,
the inverse of the preceding composite isomorphism,
which sends each closure theory~$T$ on~$E$ to the closure operator~$\widedt{\cl_T}$ on~$\PowE$
given by $\dtinysp\cl_T(X)
		= \bigset{y\in E\bigsuchthat T\colon\narrdt X\adjoins{}y}$ for $X\subseteq E\tinysp$.
%\end{comment}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{comment}
The closure system $\ClSys(\PowE)$ in $\PowPowE$
	is the fixpoint set of the closure operator~$\sigma\negdtinysp\varrho\tinysp$,
so~that $\sigma\negdtinysp\varrho(\coll{X}) = \clsys(\coll{X})$ for every $\coll{X}\subseteq\PowE\tinysp$.
There is also the closure operator $\varrho\tinysp\sigma$ on~$\Pow\negtinysp\ClTheor(E)$
which for each $R\subseteq\ClRul(E)$ yields the closure theory~$\widedt{\der(R)}$~on~$E\dtinysp$;
the rules in $\widedt{\der(R)}$ are said to be \notion{derived} from the rules~in~$R\tinysp$.
The identity $\sigma\negdtinysp\varrho\tinysp\sigma = \sigma$
	satisfied by the Galois connection $\pair{\sigma,\varrho}$
has the following interpretation:
if $R$ is any~set of closure rules on~$E\tinysp$,
	then $\sigma\bigl(\varrho\tinysp\sigma(R)\bigr) = \sigma(R)$
means that a~subset of $E$ obeys the set of rules~$R$
	\iff\ it obeys the closure theory $\der(R) = \varrho\tinysp\sigma(R)\tinysp$.
\end{comment}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%----------------------------------------------------------------------------------------------------
\section{Overview of the paper}
\label{sec:overview}

The central theme of the paper are the properties
of the poset $\Cl(P)$ of all closure operators on a~poset $P$ that is at least a~dcpo,
and of subposets of $\Cl(P)$ consisting of some special kind of closure operators,
for instance of the subposet $\ScCl(P)$ of all \Scottcont\ closure operators.
The~results of the paper are, among other things,
subsuming and substantially extending almost every known fixed point theorem
for~posets.%
%
\footnote{An exception are the fixpoint theorems for $\omega$-complete posets,
	which may not be dcpos and are for this reason not considered in the paper.}
%

\txtskip

The basic fact is that, for a~dcpo $P$, the poset $\Cl(P)$ is a~complete lattice.
More is true, actually: the complete lattice $\ClSys(P)$ of all closure systems in~$P$,
	which is antiisomorphic to the complete lattice $\Cl(P)$,
is a~closure system in the powerset lattice~$\Pow\negtinysp P\tinysp$
{\large(}which means that the intersection of a~set of closure systems in~$P$
	is always a~closure system in~$P${\large)};
what is more, the fixpoint set of any preclosure map on~$P$ is a~closure system.
These results are established in section~\ref{sec:completlatt-of-clopers-on-dcpo},
as consequences of the main theorem, Theorem~\ref{thm:in-dcpo-cl-generd-by-precls-&-induct},
which describes how a~set $G$ of preclosure maps on a~dcpo~$P$
	determines the least closure operator $\gencl{G}$ above them.

The main theorem of section~\ref{sec:completlatt-of-clopers-on-dcpo}
	also pronounces the \knownas{induction principle}:
if a~subset of~$P$ is closed under directed joins in~$P$ and is closed under~$G$,
then it is closed under~$\gencl{G}$.
The induction principle has a~dual, the \knownas{obverse induction principle},
but the passage from the former to the latter
	involves the law of excluded middle~(EM);
since the one application of the obverse induction principle in the paper
is in a~proof which intentionally avoids using~EM,
the obverse induction principle is stated and proved~on~its~own.

Section~\ref{sec:completlatt-of-clopers-on-dcpo} concludes
with the version of Tarski's fixed point theorem for dcpos,
	which is proved using Theorem~\ref{thm:in-dcpo-cl-generd-by-precls-&-induct}
		and its consequences.

\txtskip

Section~\ref{sec:Scottcont-clopers-on-dcpo}
considers the poset $\ScCl(P)$ of all \Scottcont\ closure operators on a~dcpo~$P$.
%
The main result of the section
	is~Theorem~\ref{thm:in-dcpo-Scottcont-preclmaps-gener-Scottcont-clop}:
if $G$ is a~set of \Scottcont\ preclosure maps on $P$,
then the least closure operator $\gencl{G}$ above~$G$
is the directed pointwise join of the composition monoid~$G^*$ generated~by~$G$,
and it is~\Scottcont.
Consequently, the poset $\ScCl(P)$ is an interior system in the complete lattice~$\Cl(P)$
	and so is itself a~complete lattice with the joins inherited from~$\Cl(P)$,
while the poset $\DcClSys(P)$ of all closure systems in $P$ that are closed under directed joins
	{\large(}which is antiisomorphic to the complete lattice $\ScCl(P)$
		and is therefore a~complete lattice{\large)}
is~a~closure system in~$\ClSys(P)$ as~well~as~in~$\Pow\negtinysp P$.

For~every closure operator~$\gamma$ on~$P$
there exists the greatest \Scottcont\ closure operator $\widedt{\sccore\gamma}$ below~$\gamma\tinysp$,
called the \knownas{\Scottcont\ core} of the closure operator~$\gamma\tinysp$.
Dually,~for every closure system~$C$ in~$P$
there exists the least directed-closed closure system~$\dtinysp\dcclsys(C)$ that contains~$C$.
Not much can be said about $\widedt{\sccore\gamma}$ and~$\dtinysp\dcclsys(C)$
	for a~general dcpo~$P$,
but if $P$ is a~domain (a~continuous dcpo),
then both can~be constructed:
Proposition~\ref{prop:sc(gamma)-on-domain}
	gives the construction of the \Scottcont\ core of~a~closure operator on a~domain~$P$,
while Proposition~\ref{prop:dcclsys-in-domain}
	has the construction of $\dtinysp\dcclsys(C)$ for~a~closure system $C$ in a~domain~$P$
		{\large(}and also of $\dtinysp\dcclsys(X)$ for any subset $X$~of~$P${\large)}.

\txtskip

In section~\ref{sec:frame-of-nuclei-on-preframe} we carry out the project
that is only sketched in~Escard\'o~\cite{escardo}:
we prove (when the time comes) that the poset of all nuclei on a~preframe is a~frame.

A~\knownas{frame} is a~complete lattice in which binary meets distribute over arbitrary joins.
A~\knownas{preframe} is a~meet-semilattice that is also a~dcpo
	and in which binary meets distribute over directed joins.
Given a~meet-semilattice~$P$,
a~\knownas{nucleus} (\knownas{prenucleus}) on~$P$
	is a~closure operator (a~preclosure map) on~$P$ that preserves binary meets;
the fixpoint set of a~nucleus on $P$ is called a~\knownas{nuclear system} in~$P\dtinysp$;
$\Nuc(P)$ denotes the poset of all nuclei on~$P$
and $\NucSys(P)$ denotes the poset of all nuclear systems in~$P$ .

The~main result of the section is Theorem~\ref{thm:in-preframe-prenuclei-generate-nucleus}
which states that for any set $\Gamma$ of prenuclei in a~preframe~$P$
the least closure operator $\gencl{\Gamma}$ above the set of preclosure maps~$\Gamma$ is a~nucleus.
It follows that for a~preframe~$P$
the poset $\Nuc(P)$ is closed under all joins in the complete lattice $\Cl(P)$
	and is thus a~complete lattice;
besides this, $\Nuc(P)$ is closed under the (pointwise calculated) binary meets in~$\Cl(P)$.
For every closure operator~$\gamma$ on a~preframe~$P$
there exists the largest nucleus $\widedt{\nuccore\gamma}$ below~$\gamma\tinysp$,
the \knownas{nuclear core} of~$\gamma\tinysp$.

Proposition~\ref{prop:frame-of-nuclei-on-preframe} tells us
that on a~preframe $P$ the complete lattice $\Nuc(P)$ is actually a~frame.
Both Theorem~\ref{thm:in-preframe-prenuclei-generate-nucleus}
	and Proposition~\ref{prop:frame-of-nuclei-on-preframe}
are proved using the induction principle.

We conclude the section	by taking a~quick look at \Scottcont\ nuclei on~$P$.

\txtskip

In section~\ref{sec:nucs-on-frames} we look at the nuclei on a~frame~$L\tinysp$.
Since a~frame is a~special preframe,
all results for preframes specialize to the frame~$L\tinysp$.
But, since a~frame is \emph{very} special preframe,
we can say much more about the frame of nuclei $\Nuc(L)$ on the frame $L$
than about the frame of nuclei on a~mere preframe.
For~instance, by~Proposition~\ref{prop:frame-L-Nuc(L)-sub-(completlatt)-of-Cl(L)},
the subset~$\Nuc(L)$ of~$\Cl(L)$ is closed not only under arbitrary joins in~$\Cl(L)$
but also under arbitrary (not just binary) meets in~$\Cl(L)\dtinysp$;
that is, $\Nuc(L)$~is a~sub\nobreakdash-(complete lattice) of the complete lattice~$\Cl(L)$.

A~frame is relatively pseudocomplemented, that is, it is a~complete Heyting algebra.
Corollary~\ref{cor:in-frame-nucC(y)=Meet(x-in-X)((y=>gamma(x))=>gamma(x))}
at the end of the section gives a~formula,
	which uses the operation $\impl$ of relative pseudocomplementation,
for the nuclear core $\widedt{\nuccore\gamma}$ of a~closure operator $\gamma$ on~$L\tinysp$.

\txtskip

In~\cite{escardo} Escard\'o shows off the utility of join induction
by using it in a~proof of the Hofmann--Mislove$\tinysp$--Johnstone theorem.
In~section~\ref{sec:HMJ-theorem} we prove the HMJ theorem in a~way
that demonstrates the power of the obverse induction principle.
Our proof of the HMJ~theorem is spread through proofs of three lemmas,
	with parts of it reasoned out in the connecting text;
the short concluding reasoning then ties everything together.
The obverse induction principle is used in the proof of Lemma~\ref{lem:scott-open-filter-is-nuclear},
which is for that very reason short and transparent.

\txtskip

For a~dcpo~$P$, the complete lattice $\ClSys(P)$ of all closure systems in~$\Pow\negtinysp P$
	is a~closure system in the powerset lattice $\Pow\negtinysp P$
and so it is determined by a~set of closure rules on~$P$.
In section~\ref{sec:do-it-with-max-elems}
we prove that $\ClSys(P)$ is determined
	by the set of all~\knownas{default} closure rules associated with~$P$,
which are the closure rules on~$P$ of the form $B\negdtinysp\adjoins{}c\tinysp$,
where $c\in P$ is a~maximal lower bound of $B\subseteq P$.
The proof of this result, however, requires the axiom of choice (AC),
since in a~set theory without~AC it implies~AC.

We actually develop a~little theory which operates with maximal elements.
We prove several assertions of the following form:
if in every subset of~$P$ of some special kind
	every element has a~maximal element of the subset above it,
then $P$ has a~certain property.
For example, if every lower bound of any~subset of~$P$
	is below some maximal lower bound of the subset,
then the closure systems in~$P$ are determined by the set of all default closure rules;
in short, if $P$ has `enough' default closure rules associated with it%
\,---\,if it is \knownas{default enabled}\,---\,%
then the closure system $\ClSys(P)$ of~$\Pow\negtinysp P$
	is determined by the default closure rules.
Similarly, by requiring that a~meet-semilattice
	possesses `enough' closure rules of a~certain form,
we can prove that $\Nuc(P)$ is an interior system in~$\Cl(P)$,
and requiring existence of even more closure rules
	we are able to prove that $\Nuc(P)$ is a~frame.
Interestingly, we can prove all this without ever invoking~AC.
These results mimick results in section~\ref{sec:frame-of-nuclei-on-preframe},
and they in fact imply them by specialization,
at~the~price of being forced to use~AC to accomplish~it.

The class of the default-enabled posets is strictly larger than the class of the~dcpos.
A~default-enabled poset~$P$ shares with posets the properties
that the set of all closure systems in~$P$ is a~closure system in~$\Pow\negtinysp P$,
and that the fixpoint set of every~preclosure map on~$P$ is a~closure system~in~$P$.
Here is a~project that may turn out to be more of an adventure than it appears:
characterize, in structural terms,
	the posets that have the one, or the other, or both of these properties.

\txtskip

In section~\ref{sec:conv-geoms-assoc-with-dcpo} we prove that for every dcpo~$P$,
the closure operator~$\widedt{\clsys_P}$ on~$\Pow\negtinysp P$
    {\large(}which for each $X\subseteq P$
	yields the least closure system in~$P$ that contains~$X${\large)}
and the closure operator $\widedt{\dcclsys_P}$ on~$\Pow\negtinysp P$
    {\large(}which for each~$X\subseteq P$
	yields the least directed\nobreakdash-closed closure system in $P$ that contains~$X${\large)}
are convex,
meaning that they satisfy the anti-exchange axiom.
Since all that we need to obtain these two results
is the property of every dcpo $P$ that $\ClSys(P)$ is a~closure system in~$P$,
the~results are valid also for every default-enabled poset~$P$.

%!

%----------------------------------------------------------------------------------------------------
\section{The complete lattice of closure operators on a~dcpo}
\label{sec:completlatt-of-clopers-on-dcpo}

Let~$P$ be a~dcpo,
and let $M\defeq\Precl(\negtinysp P)$ be the pointwise-ordered composition monoid
	of all preclosure maps on~$P\negtinysp$.
In~$M$~all~directed joins exist, and they are calculated pointwise:
if~$F$ is a~directed subset of~$M$,
then at each $x\in P$ the set $F(x)$ is directed,
thus the map $\varphi\colon P\to P : x\mapsto\Join\!F(x)$ is well defined,
and one easily verifies that it is a~preclosure~map;
it follows that $\varphi = \Join\! F$ in the poset~$M$.
The ordered monoid $M$ is therefore a~dcpo;
moreover, $M$~is a~pointed~dcpo since the identity map $\id_P$ is its least element.
Mark that every submonoid of~$M$ is a~directed subset~of~$M$
	because $f,\tinysp g\leq fg$ for any $f,\tinysp g\in M$:
$f\narrt\leq fg$ because $g$~is ascending and $f$~is increasing,
	and $g\narrt\leq fg$ because $f$~is ascending.


\txtskip

The following theorem describes
how a set of preclosure maps on a~dcpo determines the least~closure operator above them.

\thmskip

\begin{theorem}\label{thm:in-dcpo-cl-generd-by-precls-&-induct}
Let\/ $P$ be a~dcpo,
and let\/ $G$ be a~set of preclosure maps on\/~$P\negtinysp$.
Then\/ $\Fix(\leftt G)$ is a~closure system in\/~$P\negtinysp$,
and the corresponding closure operator\/ $\gencl{G}$ on\/~$P\negtinysp$,
	which has\/ $\Fix(\gencl{G}\tinysp) = \Fix(\leftt G)$,
is the least of all closure operators on\/~$P$ that are above\/~$\nolinebreak G$.

The~{\bfseries induction principle} holds:
if a~subset of\/~$P$ is closed under directed joins in\/~$P$ and is closed under\/~$G$,
then~it~is closed under\/~$\gencl{G}$.

Moreover, the~{\bfseries obverse induction principle}~holds:
%? ``obverse'' induction principle
if~a~subset of\/ $P$ is inaccessible by directed joins and is inversely closed under\/~$G$,
then it is inversely closed under\/~$\gencl{G}$.
\end{theorem}

\interskip

\begin{proof}
In the pointwise-ordered composition monoid $M$ of all preclosure maps on~$P\negtinysp$,
let $H$ be the intersection of all submonoids
that contain $G$ and are closed under directed joins~in~$M$;
$H$~is the least such submonoid.
Since~$H$ is a~directed subset of~$M$, the join $h = \Join\!H$ in~$M$ exists.
Then $h\in H$, because $H$ is closed under directed joins,
thus $h$ is~the greatest element~of~$H$.
Since~$H$ is a submonoid of~$M$, we have $h\tinysp h\in H$,
hence~$h\tinysp h\leq h$,
which shows that $h$ is a~closure operator.
We~have $h\geq G$ because $H$ contains~$G$.
Let $k\geq G$ be a~closure operator; then~$k\in M$.
The set $K = \allbelow{M\negdtinysp}{k}$
	is a submonoid of~$M$ since~$\id_P\in K$
and since~$f,\tinysp \fpr \in M$ and $f,\tinysp \fpr \leq k$
	imply $f\negtinysp\fpr \leq k\tinysp k = k\dtinysp$;
$K$~is evidently closed under directed joins in~$M$
	(it is closed under all existing joins~in~$M$)
	and contains~$G$,
thus it contains $H$, whence~$h\leq k$.

\emph{The induction principle.}
Let $A$ be a subset of~$P$
that is closed under directed joins and is closed under~$G$.
Let~$F$ be the set of all $f\in M$ such that $f(A)\subseteq A\tinysp$.
Then $F$~is a~submonoid~of~$M$ and contains~$G\tinysp$;
$F$~is closed under directed joins~in~$M$,
	because~$A$ is closed under directed joins~in~$P$
	and because the directed joins in~$M$ are calculated pointwise.
It~follows that $H\subseteq F$, hence~$h\in F$, that~is, $h(A)\subseteq A\tinysp$.

For every $g\in G$ we have $g\tinysp h = h\tinysp$,
%since composing $\id_P \leq g \leq h$ with $h$
%	we obtain $h \leq g\tinysp h \leq h\tinysp h = h\dtinysp$;
%this implies that every element of $h(\negtinysp P) = \Fix(h)$ is a~fixed point of~$G$.
which implies that every element of $h(\negtinysp P) = \Fix(h)$ is a~fixed point of~$G$.
Conversely, if~$a$~is a~fixed point of~$G$,
then the set~$\set{a}$ is closed under~$G$,
and since it is evidently closed under directed joins~in~$P\negtinysp$,
it is closed under~$h$,
thus~$h(a) = a \in \Fix(h)$.

The closure operator $\gencl{G} \defeq h$ has the properties
	stated in the first assertion of the proposition.

\emph{The obverse induction principle.}
Suppose that $A\subseteq P$ is inversely closed under~$G$
and that it is inaccessible by directed joins.
Let $F$ be the set of all $f\in M$ such that $f^{-1}(A)\subseteq A\dtinysp$;
$F$~contains~$G$ and it is a~submonoid of~$M$.
Let~$E$ be a~directed subset~of~$F$; we shall show that $\Join\!E\in F$.
Let~$x\in P\negtinysp$,
and suppose that $\bigl(\Join\!E\bigr)(x) = \Join\negdtinysp E(x) \in\nolinebreak A\dtinysp$;
since~$A$ is inaccessible by directed joins,
there exists $e\in E$ with $e(x)\in A\tinysp$,
and we have $x\in A$ because $A$ is inversely closed under~$e\tinysp$.
It~follows that $A$ is inversely closed under~$\Join\!E$.
We see that~$F$ is closed under directed joins, so $F$ contains~$H$
	and with it the closure operator~$\gencl{G}$,
whence $A$ is inversely closed under~$\gencl{G}$.
\end{proof}

\thmskip

In the classical logic, which uses the law of excluded middle (EM for short) with abandon,
the obverse induction principle for a~subset~$A$ of~$P$
is just a~rephrasing of the induction principle for the complement $P\narrdt\setdiff A\tinysp$.
Since we want to apply the obverse induction principle in situations where EM is not admissible,
we~proved~it on~its~own.

\txtskip

Let $P\negtinysp$, $G$, and $\gencl{G}$ be as in Theorem~\ref{thm:in-dcpo-cl-generd-by-precls-&-induct}.
We~shall say that the closure operator $\gencl{G}$
is~\notion{generated by} the set~$G$ of preclosure maps.

\txtskip

The special case of Theorem~\ref{thm:in-dcpo-cl-generd-by-precls-&-induct} where $G=\set{g}$
is of interest on its own.

\thmskip

\begin{corollary}\label{thm:cl-gen-by-single-precl-in-dcpo}
If\/ $g$ is a~preclosure map on a~dcpo\/~$P\negtinysp$,
then\/ $\Fix(g)$ is a~closure system in\/~$P\negtinysp$,
and the closure operator\/ $\overbar{g}$ on\/ $P$ that has\/ $\Fix(\overbar{g})=\Fix(g)$
is the least of all closure operators on\/ $P$ that are above\/ $g\tinysp$.
\end{corollary}

\thmskip

The induction principle and the obverse induction principle
of course hold in the special case featuring a~single preclosure map;
there is no need to restate them.

\txtskip

As a~consequence of Theorem~\ref{thm:in-dcpo-cl-generd-by-precls-&-induct},
if~$P$ is a~dcpo, then in the poset $\Cl(\negtinysp P)$ every subset has a~join,
	therefore~$\Cl(\negtinysp P)$ is a~complete lattice.

\thmskip

\begin{corollary}
The poset\/ $\Cl(\negtinysp P)$ of all closure operators on a~dcpo\/~$P$
is a~complete lattice,
and so is the poset\/ $\ClSys(\negtinysp P)$ of all closure systems in\/~$P\negtinysp$.
In\/~$\Cl(\negtinysp P)$, the join of a~set\/~$G$ of closure operators is
the closure operator\/~$\gencl{G}$ generated by\/~$G$,
while~in\/~$\ClSys(\negtinysp P)$, the meet of a~set\/~$\coll{C}$ of closure systems
	is the intersection\/ $\Inters\coll{C}$.%
%
\footnote{The `intersection' of the empty set of subsets of~$P$
is by convention~$P\negtinysp$, the top element of~$\Pow\negtinysp{P}$.}%
%
\end{corollary}

\interskip

\begin{proof}
For every $G\subseteq\Cl(\negtinysp P)$,
$\gencl{G}$ is the join of~$G$ in~$\Cl(\leftt G)$
	by Theorem~\ref{thm:in-dcpo-cl-generd-by-precls-&-induct}:
$\tJoin\negdtinysp G = \gencl{G}\tinysp$.
Since the mapping $\Cl(\negtinysp P)\to\ClSys(\negtinysp P) : g\mapsto\Fix(g)$
	is an~antiisomorphism of~complete lattices,
for~every~$G\subseteq\Cl(\negtinysp P)$ we have
    $\tMeet_{g\in G}\Fix(g)
	= \Fix(\tJoin\negdtinysp G)
	= \Fix\bigl(\gencl{G}\dtinysp\bigr)
	= \Fix(\leftt G)
	= \Inters_{\tinysp g\in G}\Fix(g)$,
and it follows that
	all meets in $\ClSys(\negtinysp P)$ exist and that they are calculated as~intersections.
\end{proof}

\thmskip

Let $P$ be a~dcpo.
The set $\ClSys(\negtinysp P)$ of all closure systems in~$P$
is a~closure system in the complete lattice $\Pow\negtinysp P$.
The corresponding closure operator on~$\Pow\negtinysp P$
maps each subset~$X$ of~$P$
	to the closure system~$\dtinysp\clsys(X) = \clsys_P(X)\tinysp$,
which is the least of all closure systems in~$P$ that contain~$X$.

\thmskip

\begin{proposition}
If\/ $h$ is a~closure operator on a~dcpo\/~$P\negtinysp$,
then the subposet\/ $h(\negtinysp P)=\Fix(h)$ of\/~$P$ is a~dcpo.%
%
\footnote{However, the subposet $h(\negtinysp P)$ is in general not a~sub-dcpo of the dcpo\/~$P\tinysp$:
a~directed subset $D$ of $h(\negtinysp P)$ has in $h(\negtinysp P)$ the join $\tJoin^h\!D=h(\tJoin\!D)$,
where the join $\tJoin\!D$ is taken in~$P$.}
%
The~restriction\/ $\hpr\colon P\to h(\negtinysp P)$ of the closure operator\/~$h$
preserves directed joins.
\end{proposition}

\interskip

\begin{proof}
Let $S$ be a~directed subset of~$h(\negtinysp P)$.
The set~$S$ is also directed in~$P\negtinysp$, hence it has a~join $\Join\! S$ in~$P\negtinysp$,
and then~$h\bigl(\Join\! S\bigr)$ is the join of~$S$ in~$h(\negtinysp P)$.
The second assertion of the proposition holds
because for any~closure operator~$h$ on an~arbitrary poset~$P$
the restriction $\hpr\colon P\to h(\negtinysp P)$ preserves all existing joins.
\end{proof}

\thmskip

Tarski's fixed point theorem, a~version for dcpos,
	easily follows from Theorem~\ref{thm:in-dcpo-cl-generd-by-precls-&-induct}.

\thmskip

\begin{theorem}\label{thm:tarski's-fixed-point-thm-for-dcpos}
Let\/ $f$ be an increasing map on a~dcpo\/~$P\negtinysp$.
The fixpoint set~of\/~$f\negtinysp$, as a~subposet of\/~$P\negtinysp$, is a~dcpo,
and for every\/ $x\in P$ on which\/ $f$~ascends
there exists a~least fixed point of\/~$f$ above\/~$x$.
If\/~$P$ has a~least element, then\/~$f$ has a~least fixed~point.
\end{theorem}

\interskip

\begin{proof}
Let $A \defeq \set{x\narrt\in P\narrt\suchthat x\narrt\leq f(x)}\dtinysp$;
that is, $A$ is the set of all elements of $P$ on which $f$ ascends.
It~is clear that $A$~contains all fixed points of~$f$.
Since $x\leq f(x)$ implies $f(x)\leq f\bigl(f(x)\bigr)$,
the set $A$ is closed under~$f$.
If $S\subseteq A$ is directed, then the join $\Join\!S$ in~$P$ exists,
and $s\leq f(s)\leq f\bigl(\Join\! S\bigr)$ for every~$s\in S$,
hence $\Join\! S\leq f\bigl(\Join\! S\bigr)$,
so~$A$~is closed under directed~joins.
Thus the subposet $A$ is a~dcpo%
%
\footnote{Actually the subposet $A$ is a~sub$\tinysp$-dcpo of~$P\negtinysp$,
	since the directed joins in~$A$ are inherited from~$P\negtinysp$.}%
%
, and the restriction $g\colon A\to A$ of~$f$ is a~preclosure map on~$A\tinysp$.
The closure operator $\gencl{g}$ on~$A$
maps each $x\in A$ to the least element above $x$ in the set
$\Fix(\gencl{g}) = \Fix(g) = \Fix(f)$, and~this~set,
as a~subposet of~$A\tinysp$, and hence~of~$P\negtinysp$, is~a~dcpo.%
%
\footnote{The subposet $\Fix(f)$ of~$P$ is,
	in general, not a~sub$\tinysp$-dcpo of~$P\negtinysp$.}
%
If~$P$ has a~least element~$\bot$,
then $\bot\in A\tinysp$, and $\gencl{g}(\bot)$ is the least fixed~point~of~$f$.
\end{proof}

\pagebreak[3]
\thmskip

The last statement of Theorem~\ref{thm:tarski's-fixed-point-thm-for-dcpos}
is the bare-bones Tarski's fixed point theorem for dcpos;
let us restate it on its own.

\thmskip

\begin{corollary}\label{cor:barebones-tarski's-fixed-point-thm}
Every increasing endomap on a~pointed dcpo has a~least fixed point.
\end{corollary}

\pagebreak[3]
\thmskip

It can be proved, with a~generous help from the axiom of choice,
that the bare-bones Tarski's fixed point property, stated in the corollary,
	in fact characterizes pointed dcpos.
See,~for example, Theorem~11 (after consulting Corollary~2 of Theorem~1)~in Markowsky~\cite{markowsky}.


%----------------------------------------------------------------------------------------------------
\section{\Scottcont\ closure operators on dcpos}
\label{sec:Scottcont-clopers-on-dcpo}

To begin with we establish a~general result
about preservation of some special joins
	by the~pointwise join of functions that preserve those special joins.

\txtskip

For any poset $P$ we denote by $\Joinable\negtinysp P$
	the set of all subsets of $P$ that have a~join~in~$P$.

Let $P$ and $Q$ be posets, and let $\coll{A}\subseteq\Joinable\negtinysp P$.

We~shall say that a~function $f\colon P\to Q$ \notion{preserves $\coll{A}$-joins}
    if for every $A\in\coll{A}$ we have
	$f(A)\in\Joinable Q$ and $f(\tJoin\negtinysp\!A)=\tJoin\negdtinysp f(A)\tinysp$.
Let~$F$ be a~set of functions $P\to Q\tinysp$.
We~shall say that $F$~\notion{preserves $\coll{A}$-joins}
	if~every function in $F$ preserves $\coll{A}$-joins.
We~shall say that $F$~\notion{has a~pointwise join}
	if~$F(x)\in\Joinable Q$ for every $x\in P\negtinysp$.
Whenever $F$ has a~pointwise join
	we define \notion{the pointwise join} $\dottJoin\negdtinysp F\colon P\to Q$ of~$F$
by $(\dottJoin\negdtinysp F)(x) \defeq \tJoin\negdtinysp F(x)$ for every~$x\in P\negtinysp$.

Note that if $\coll{A}$ contains all subsets $\set{x,y}$ of $P$ with $x<y\tinysp$,
then every function $P\to Q$ which preserves $\coll{A}$-joins is increasing.

\thmskip

\begin{lemma}\label{lem:preserv-of-joins-by-pntwise-join}
Let\/ $P$ and\/ $Q$ be posets, let\/ $F$ be a~set of functions\/ $P\to Q\tinysp$,
	and\/ $\coll{A}\subseteq\Joinable\negtinysp P\negtinysp$.
If\/ $F$ preserves $\coll{A}$-joins and has a~pointwise join,
then the pointwise join\/ $\dottJoin\!F$ preserves $\coll{A}$-joins.
More\-over, for every\/ $A\in\coll{A}$ we have\/ $F(A)\in\Joinable Q$ and
%
\begin{equation}\label{eq:(pwJoin F)(Join A)=Join(pwJoin f)(A)=Join F(A)}
    (\dottJoin\!F)(\tJoin\negdtinysp\!A)
	\Eq \tJoin(\dottJoin\!F)(A)
	\Eq \tJoin\!F(A)~.
\end{equation}
%
\end{lemma}

\negdisplayhalfskip
\interskip

\begin{proof}
Consider any $A\in\coll{A}\tinysp$.\pagebreak[3]
By assumption the join $\tJoin\negdtinysp\!A$ exists
	and the join $\tJoin\!F(x)$ exists for every~$x\in P\negtinysp$,
therefore the element
	$(\dottJoin\!F)(\tJoin\negdtinysp\!A) = \tJoin\!F(\tJoin\negdtinysp\!A)$
		of~$Q$
and the subset
	$(\dottJoin\!F)(A) = \bigset{\tJoin\!F(a)\bigsuchthat a\in A}$
		of~$Q$
are well-defined.
Let $y$ be an arbitrary element of $Q$.
The chain of equivalences
%
\begin{align*}
y \geq (\dottJoin\!F)(\tJoin\negdtinysp\!A)
    &\wider\Isequiv \text{$y \geq f(\tJoin\negdtinysp\!A)$\, for every \,$f\narrt\in F$} \\
    &\wider\Isequiv \text{$y \geq \tJoin\!f(A)$\, for every \,$f\narrt\in F$}
	\quad \text{{\large(}since $f(\tJoin\negdtinysp\!A) = \tJoin\!f(A)${\large)}}\\
    &\wider\Isequiv \text{$y\geq f(a)$\, for every \,$a\in A$\, and for every\, $f\narrt\in F$} \\
    &\wider\Isequiv \text{$y\geq F(A)$}~,
\end{align*}
%
proves that $F(A)\in\Joinable Q$ and that
	$\tJoin\!F(A) = (\dottJoin\!F)(\tJoin\negdtinysp\!A)$.
Then
%
\begin{align*}
y \geq (\dottJoin\!F)(A)
    &\wider\Isequiv \text{$y \geq \tJoin\!F(a)$\, for every \,$a\in A$} \\
    &\wider\Isequiv \text{$y \geq f(a)$\, for every \,$f\narrt\in F$\, and for every \,$a\in A$} \\
    &\wider\Isequiv \text{$y\geq F(A)$}~,
\end{align*}
%
clinches the proof ot the equalities~\eqref{eq:(pwJoin F)(Join A)=Join(pwJoin f)(A)=Join F(A)}.
\end{proof}

\pagebreak[3]
\thmskip

Lemma~6 is so general with a~reason:
it makes perfectly clear that
	$F$ preserving $\coll{A}$-joins	and $F$ having a~poinwise join
are two independent properties of the set of functions~$F\tinysp$;
in a~certain sense these two properties are orthogonal to each other.
For example, suppose that $P$ and $Q$ are dcpos
	and that $\coll{A}$ is the set of all directed subsets of~$P\tinysp$;
in this case $F$ preserving $\coll{A}$-joins means that $F$ preserves directed joins.
The~set~of~functions~$F$ need not be directed (in~the~pointwise ordering).
It~surely~helps if~$F$ is directed, since then the sets $F(x)$, $x\in P\negtinysp$,
are directed subsets of~$Q$ and have joins in~$Q$,
thus we know that $F$ has a~pointwise join \emph{because} it is directed and $Q$~is a~dcpo,
and we can conclude that the pointwise join $\dottJoin\negdtinysp F$ preserves directed joins.
But suppose that $Q$ is a~complete lattice (with $P$ still just any dcpo):
then \emph{every} set~$F$ of functions $P\to Q$ that preserve directed joins
has a~pointwise join $\dottJoin\negdtinysp F$ which preserves directed~joins.

\txtskip

A function between posets $f\colon P\to Q$ is said to be \notion{\Scottcont}
if it preserves all existing directed joins.%
%
\footnote{In other words, $f$ is \Scottcont\ iff it preserves $\coll{D}$-joins,
where $\coll{D}$ is the set of all directed subsets of $P$ that have a~join in $P\negtinysp$.}
%
In detail, $f$ is \Scottcont\ \iff\
for~every directed subset $Y$ of $P$ which has a~join $\tJoin\negtinysp Y$ in $P\negtinysp$,
the $f$-image of this join is the join in~$Q$ of the~$f$-image of the set~$Y$,%
%
\footnote{There are those who prefer the more long-winded
``$\tinysp$the $f$-image of the set $Y$ has a~join in $Q$
	which is equal to the $f$-image of the join of~$Y$ in~$P\tinysp$''.}
%
that is, $f(\tJoin\negtinysp Y) = \tJoin\negdtinysp f(Y)\tinysp$.
In~particular, a~\Scottcont\ function
	preserves joins of all pairs of comparable elements~of~$P\negtinysp$,
which implies that $f$~is~increasing,
therefore for every directed subset~$Y$~of~$P$ its image~$f(Y)$~is a~directed subset of~$Q$.
From this it follows that if $f\colon P\to Q$ and $g\colon Q\to R$
are \Scottcont\ functions between posets,
then the composite function $gf\colon P\to R$ is \Scottcont.

For any posets $P$ and $Q$ we let $\Sc(P,Q)$
denote the poset of all \Scottcont\ functions $P\to Q$ with the pointwise ordering.

For any poset $P$ we denote by $\ScPrecl(\negtinysp P)$ the pointwise ordered poset
	of all \Scottcont\ preclosure maps on~$P\negtinysp$,
and by $\ScCl(\negtinysp P)$ the pointwise ordered poset of all \Scottcont\ closure operators on~$P\negtinysp$.

\txtskip

The following proposition follows from Lemma~\ref{lem:preserv-of-joins-by-pntwise-join}
by specialization.

\thmskip

\begin{proposition}\label{prop:dirjoin-of-Scottcont-funs-between-dcpos}
Let\/ $P$ and\/ $Q$ be dcpos.
If\/ $F$ is a~directed subset of\/ $\Sc(P,Q)$,
then the pointwise join\/ $\dottJoin\!F$ exists and is \Scottcont.
\end{proposition}

\thmskip

\begin{corollary}\label{cor:P-Q-dcpos==>Sc(P,Q)-dcpo-pntwise-joins}
If\/ $P$ and\/ $Q$ are dcpos,
then\/ $\Sc(P,Q)$ is a~dcpo in which directed joins are calculated pointwise.
\end{corollary}

\thmskip

\begin{corollary}\label{cor:P-dcpo==>ScPreCl(P)-dcpo-pntwise-joins}
If $P$ is a~dcpo,
then $\ScPrecl(\negtinysp P)$ is a~pointed dcpo in which directed joins are calculated pointwise.
\end{corollary}

\interskip

\begin{proof}
If $F$ is a~directed set of \Scottcont\ preclosure maps on~$P\negtinysp$,
then the pointwise join $\dottJoin\!F$ is is a~preclosure map
which is \Scottcont\ by~Proposition~\ref{prop:dirjoin-of-Scottcont-funs-between-dcpos}.
Therefore $\ScPrecl(\negtinysp P)$ is a~dcpo with directed joins that are calculated pointwise,
and it is a~pointed dcpo since the identity map $\widedt{\id_P}$ is its bottom element.
\end{proof}

\pagebreak[3]
\thmskip

Let $P\negtinysp$, $Q$, $R$ be posets.
For any sets of functions $F\subseteq\Inc(P,Q)$ and $G\subseteq\Inc(Q,R)$
we write
	$GF \narrt\defeq \set{\dtinysp gf\negdtinysp\suchthat
					f\narrdt\in F,\, g\narrdt\in G\tinysp}\dtinysp$;
when both $F$ and $G$ are directed, $GF$ is easily seen to be directed
	(recall that composition of increasing maps is increasing in both operands).

\thmskip

\begin{proposition}\label{prop:composing-Sc(P,Q)-and-Sc(Q,R)}
Let\/ $P\negtinysp$, $Q$, and\/ $R$ be dcpos.
If\/ $F\subseteq\Sc(P,Q)$ and\/ $G\subseteq\Sc(Q,R)$ are directed,
then\/ $GF \subseteq \Sc(P,R)$ is~directed and
%
\begin{equation}\label{eq:(Join(G))*(Join(F))=Join(G*F)}
(\tJoin\negtinysp G)(\tJoin\negdtinysp F)	\Eq \tJoin(GF)~.
\end{equation}
%
\end{proposition}

%\negdisplayshortskip
%\interskip

\begin{proof}
Let $x\in P\negtinysp$.
The set $F(x)$ is directed,
every $g\in G$ preserves directed joins,
and~$G$, being directed, has a~pointwise join,
and so we calculate
%
\begin{align*}
\bigl((\tJoin\negtinysp G)(\tJoin\negdtinysp F)\bigr)(x)
	&\Eq (\dottJoin\negtinysp G)\bigl((\dottJoin\negdtinysp F)(x)\bigr)
	    \Eq (\dottJoin\negtinysp G)\bigl(\tJoin\negdtinysp F(x)\bigr)
		\quad\text{(apply Lemma~\ref{lem:preserv-of-joins-by-pntwise-join})} \\[.5ex]
	&\Eq \tJoin\negtinysp G\bigl(F(x)\bigr)
	    \Eq \tJoin (GF)(x)
	    \Eq \bigl(\dottJoin(GF)\bigr)(x) \\[.5ex]
	&\Eq \bigl(\tJoin(GF)\bigr)(x)~.
\end{align*}
%
This proves the equality~\eqref{eq:(Join(G))*(Join(F))=Join(G*F)}.
\end{proof}

\thmskip

\begin{corollary}\label{cor:dcpo-P==>compos-monoids-Sc(P)-and-ScPreCl(P)}
Let\/ $P$ be a~dcpo.
The dcpo\/ $\Sc(\negtinysp P)$ is a~composition monoid
	in which the composition distributes over directed joins:
if\/~$F$ and\/~$G$ are directed subsets of\/~$\Sc(\negtinysp P)\tinysp$,
then\/ $GF$ is a~directed subset of\/~$\Sc(\negtinysp P)$ and
	$(\tJoin\negtinysp G)(\tJoin\!F) = \tJoin(GF)\tinysp$.
Likewise the pointed dcpo\/~$\ScPrecl(\negtinysp P)$ is an~ordered composition monoid
	in which the composition distributes over directed joins.
\end{corollary}

\thmskip

Let $P$ be a~dcpo.
Every submonoid of the ordered composition monoid $\ScPrecl(\negtinysp P)$
	is a~submonoid of the ordered composition monoid $\Precl(\negtinysp P)$
and is therefore directed.

\thmskip

\begin{theorem}\label{thm:in-dcpo-Scottcont-preclmaps-gener-Scottcont-clop}
Let\/ $P$ be a~dcpo,
and let\/ $G$ be a~set of \Scottcont\ preclosure maps on\/~$P\tinysp$;
we denote by\/~$G^*$ the submonoid of\/~$\ScPrecl(\negtinysp P)$ generated by\/~$G$.
The directed join\/ $h\defeq\tJoin\negdtinysp G^*$ of\/~$G^*$ in\/~$\ScPrecl(\negtinysp P)$
	{\rm(}which is calculated pointwise\/{\rm)}
is a~\Scottcont\ closure operator on\/~$P\negtinysp$.
Moreover, $h$ is also the closure operator on\/~$P$
	generated by the set\/~$G$ of preclosure maps on\/~$P\negtinysp$,
therefore\/ $\Fix(h) = \Fix(\leftt G)\tinysp$.
\end{theorem}

\interskip

\begin{proof}
Since the submonoid $G^*\negdtinysp$ of $\tinysp\ScPrecl(\negtinysp P)$ is directed,
the join
    $h = \tJoin\negdtinysp G^*\negdtinysp
	= \dottJoin\negdtinysp G^*\negdtinysp$
		in $\ScPrecl(\negtinysp P)$ exists.
According to Corollary~\ref{cor:dcpo-P==>compos-monoids-Sc(P)-and-ScPreCl(P)}
we have
%
\begin{equation*}
h\tinysp h \Eq (\tJoin\negdtinysp G^*)(\tJoin\negdtinysp G^*)
	\Eq \tJoin(G^*G^*)
	\Eq \tJoin\negdtinysp G^*\negdtinysp
	\Eq h~,
\end{equation*}
%
thus~$h$~is a~\Scottcont\ closure operator on~$P\negtinysp$, and clearly $h\geq G$.

\pagebreak[3]

Now let $k$ be a~closure operator on $P$ and $k\geq G$.
{\large(}Note that we are \emph{not} assuming that $k$ is \Scottcont.{\large)}
First, $k\geq\id_P\in G^*\negdtinysp$.
Next, if $u\in G^*$ is a~composite of $n\geq 1$ functions in~$G$, then $u\leq k^n = k\tinysp$.
Thus $k\geq G^*\negdtinysp$, whence
    $k\geq \dottJoin\negdtinysp G^*\negdtinysp
	= \tJoin\negdtinysp G^*\negdtinysp
	= h\tinysp$.

It follows that $h$ is the closure operator on~$P$
generated by the set $G$ of preclosure maps on~$P\negtinysp$,
therefore $h$ is, according to Theorem~\ref{thm:in-dcpo-cl-generd-by-precls-&-induct},
	the (unique) closure operator~on~$P$ that has $\Fix(h)=\Fix(\leftt G)\tinysp$.
\end{proof}

\thmskip

\begin{corollary}\label{cor:single-Scottcont-preclmap-geners-Scottcont-clop}
If\/ $g$ is a~\Scottcont\ preclosure map on a~dcpo\/ $P\negtinysp$,
then\/ $\Fix(g)$~is the~fixpoint set of the
	\Scottcont\ closure operator\/ $\tJoin_{\!k\in\NN} g^{\tinysp k}$
		{\rm(}a~join~of~a~nonempty chain\/{\rm)},
which is the least of all closure operators on\/~$P$ that are above\/~$g\tinysp$.
\end{corollary}

\thmskip

The join in the corollary is of course of the composition monoid
	$\set{g}^* = \set{\widet{g^{\tinysp k}\negdtinysp\suchthat k\narrt\in\NN}}$
generated by a~single \Scottcont\ preclosure map~$g\tinysp$.

\thmskip

\begin{corollary}\label{cor:dcpo-P-joins-in-ScCl(P)}
Let\/ $P$ be a~dcpo, and let\/ $G$ be a~set of \Scottcont\ closure operators on\/~$P\negtinysp$.
The pointwise directed join\/ $\dottJoin\negdtinysp G^*$
is the join\/ $\tJoin\negdtinysp G$ of\/ $G$ in\/ $\ScCl(\negtinysp P)\tinysp$,
and~it~is~also the~join of\/ $G$ in\/ $\Cl(\negtinysp P)$ so that\/
    $\Fix(\tJoin\negdtinysp G)
	= \Fix(\leftt G)
	= \Inters_{\rightdt{g\in G}}\Fix(g)\tinysp$.
\end{corollary}

\thmskip

Let $P$ be a~dcpo.
Corollary~\ref{cor:dcpo-P-joins-in-ScCl(P)} tells us that
the subset $\ScCl(\negtinysp P)$ (of all \Scottcont\ closure operators on~$P\tinysp$)
	of the set $\Cl(\negtinysp P)$ (of all closure operators on~$P\tinysp$)
is~closed under all joins of the complete lattice $\Cl(\negtinysp P)$
%\,---\,that is, $\ScCl(\negtinysp P)$ is an interior system in~$\Cl(\negtinysp P)\tinysp$\,---\,%
and is therefore itself a~complete lattice whose joins are inherited from~$\Cl(\negtinysp P)$.
Correspondingly,
the set of the fixpoint sets of all \Scottcont\ closure operators on~$P$
is a~closure system in the complete lattice $\ClSys(\negtinysp P)$ of all closure systems in~$P\negtinysp$,
and is therefore a~closure system in the powerset lattice $\Pow\negtinysp P\negtinysp$,
that is, it is closed under arbitrary intersections.
There is a~less roundabout way to see this,
using an explicit characterization,
	given below in Lemma~\ref{lem:dcpo-P-dirclosed-clsyss},
of fixpoint sets of the \Scottcont\ closure operators on a~dcpo.

\pagebreak[3]
\txtskip

But first an~auxiliary lemma, almost trivial, though still worth telling on its own.

\thmskip

\begin{lemma}\label{lem:gamma(Join(X))=gamma(gamma(Join(X)))}
Let\/ $P$ be a~poset, $\gamma$ a~closure operator on\/~$P\negtinysp$, and\/ $X$ a~subset of\/~$P\negtinysp$.
If~both\/~$\tJoin\!X$ and\/ $\tJoin\negdtinysp\gamma(X)$ exist,
then\/ $\gamma(\tJoin\!X) = \gamma(\tJoin\negdtinysp\gamma(X))\tinysp$.
\end{lemma}

\interskip

\begin{proof}
We get the asserted identity by
applying $\gamma$ to $\tJoin\!X \leq \tJoin\negdtinysp\gamma(X) \leq \gamma(\tJoin\!X)\tinysp$.
\end{proof}

\thmskip

And here is the promised characterization.

\thmskip

\begin{lemma}\label{lem:dcpo-P-dirclosed-clsyss}
A~closure operator\/~$\gamma$ on a~dcpo\/~$P$ is \Scottcont\
\iff\/ $\Fix(\gamma)$ is closed under directed joins.
\end{lemma}

\interskip

\begin{proof}
Write $C\defeq\Fix(\gamma)$.

Suppose $\gamma$ is \Scottcont.
If $Y\negdtinysp\subseteq C$ is directed,
then $\gamma(\tinysp\tJoin\negtinysp Y)
	= \tJoin\negdtinysp\gamma(Y)
	=\tJoin\negtinysp Y\negdtinysp$,
therefore $\tJoin\negtinysp Y\negdtinysp\in C$.

Suppose $C$ is closed under directed joins,
and let $Y\negdtinysp\subseteq P$ be directed.
Then $\gamma(Y)$~is a~directed subset of $C$,
thus $\tJoin\negdtinysp\gamma(Y)\in C$,
and $\gamma(\tinysp\tJoin\negtinysp Y)
	= \gamma(\tinysp\tJoin\negdtinysp\gamma(Y))
	= \tJoin\negdtinysp\gamma(Y)$.
\end{proof}

\thmskip

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{comment}
Notice something?
The second part of the proof,
	proving sufficiency of the condition imposed on the fixpoint set,
uses both assumptions, namely that $P$ is a~dcpo
	and that $\gamma$ is a~closure operator (\ie,~is~ascending, increasing, and idempotent).
However, the first part, which proves necessity of the condition, uses neither assumption,
	so let us reformulate this part in full generality.
(We will survive another trivial lemma.)

\thmskip

\begin{lemma}
If\/ $P$ is a~poset and\/ $f$ is a~\Scottcont\ endofunction on\/~$P\negtinysp$,
then the fixpoint set of\/~$f$ is closed under all existing directed joins in\/~$P\negtinysp$.
\end{lemma}

\interskip

\begin{proof}
Suppose a~directed subset $Y\negdtinysp$ of $\Fix(f)$
	has a~join $\tJoin\negtinysp Y\negdtinysp$ in~$P\negtinysp$.
Since $f$ preserves existing directed joins in~$P\negtinysp$,
the $f$-image of the join of $Y\negdtinysp$ is the join of the $f$-image of the set $Y\negdtinysp$,
that is, $f(\tJoin\negtinysp Y) = \tJoin\negdtinysp f(Y)\tinysp$.
Since all elements of $Y\negdtinysp$ are fixed points of $f$, we~have $f(Y)=Y\negdtinysp$
and therefore $f(\tJoin\negtinysp Y) = \tJoin\negtinysp Y\negdtinysp \in \Fix(f)\tinysp$.
\end{proof}

\thmskip

In particular, if $g$ is a~\Scottcont\ preclosure map on a~dcpo~$P\negtinysp$,
then $\Fix(g)$~is a~closure system in~$P$
	that is closed under all directed joins in~$P\negtinysp$.

\txtskip
\end{comment}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Let $P$ be a~dcpo.

We know that the poset $\Cl(\negtinysp P)$ of all closure operators on $P\negtinysp$, ordered pointwise,
and the poset $\ClSys(\negtinysp P)$ of all closure systems on $P\negtinysp$, ordered by inclusion,
are complete lattices,
where $\ClSys(\negtinysp P)$ is a~closure system in the powerset lattice $\Pow\negtinysp P\negtinysp$,
meaning that the intersection of any set of closure systems in~$P$
	is a~closure system in~$P\negtinysp$.

Let us denote by $\DcClSys(\negtinysp P)$ the subposet of $\ClSys(\negtinysp P)$
	consisting of all directed-closed closure systems in~$P\negtinysp$.
If $\coll{C}$ is any subset of $\DcClSys(\negtinysp P)\tinysp$,
%which is to say a~collection of closure systems that are closed under directed joins,
then the intersection~$\tInters\coll{C}$ is a~closure system closed under directed joins,
so it belongs to~$\DcClSys(\negtinysp P)\tinysp$.
We see that the set $\DcClSys(\negtinysp P)$ is a~closure system
	in the complete lattice $\Pow\negtinysp P\negtinysp$,
and is also a~closure system in~the complete lattice $\ClSys(\negtinysp P)\tinysp$.
The~poset~$\DcClSys(\negtinysp P)$ is thus a~complete lattice in which all meets are intersections.
The~isomorphism of~complete lattices
	$\Cl(\negtinysp P) \to \ClSys(\negtinysp P)^\op : \gamma \mapsto \Fix(\gamma)$
restricts to the isomorphism of~complete lattices
	$\ScCl(\negtinysp P) \to \DcClSys(\negtinysp P)^\op\tinysp$.

Since $\DcClSys(\negtinysp P)$ is a~closure system in $\Pow\negtinysp P\negtinysp$,
for every subset~$X$ of~$P$
	there exists the~least of all directed-closed closure systems that contain~$X$,
	which we denote by \zerorule$\widedt{\dcclsys(X)}\tinysp$.
The endomapping $\widedt\dcclsys$ on $\Pow\negtinysp P$
	is a~closure operator on $\Pow\negtinysp P\negtinysp$,
	and it restricts to a~closure operator on~$\ClSys(L)\tinysp$.
Since $\ScCl(\negtinysp P)$ is an interior system in~$\Cl(\negtinysp P)\tinysp$,
for every closure operator~$\gamma$ on~$P$
    there exists the~greatest of all \Scottcont\ closure operators on~$P$
	that are below $\gamma\tinysp$,
    which we denote by $\widedt{\sccore\gamma}$
	and call it the \notion{\Scottcont~core} of the closure operator~$\gamma\tinysp$.
The~endomapping~$\widedt\sccore$ on~$\Cl(\negtinysp P)$ is an~inte\-rior~operator on~$\Cl(\negtinysp P)\tinysp$.
Via~the isomorphism $\Cl(\negtinysp P) \to \ClSys(\negtinysp P)^\op : \gamma\mapsto\Fix(\gamma)$
the interior operator~$\widedt\sccore$ on~$\Cl(\negtinysp P)$
	corresponds to the restricted closure operator $\widedt\dcclsys$ on $\ClSys(\negtinysp P)\tinysp$,
that is, for every closure operator~$\gamma$ on~$P$ we have
	$\Fix(\sccore\gamma) = \dcclsys(\Fix(\gamma))\tinysp$.

\txtskip

For a~general dcpo $P$ we cannot say much
    either about the closure operator~\zerorule$\widedt\dcclsys$\zerorule\
	on~$\Pow\negtinysp P\negtinysp$
	    {\large(}and its restriction to $\ClSys(\negtinysp P)${\large)}
    or about the interior operator $\widedt\sccore$ on~$\Cl(\negtinysp P)\tinysp$.
However, if $P$ is a~domain, % (a~continuous dcpo),
then there exist explicit constructions
	of the \Scottcont\ core $\widedt{\sccore\gamma}$
		of any~closure operator~$\gamma$ on~$P$
	and of the directed-closed closure system $\widedt{\dcclsys(C)}$
		generated by any~closure system~$C$ in~$P\tinysp$;
these two constructions are described in
	Proposition~\ref{prop:sc(gamma)-on-domain} and Proposition~\ref{prop:dcclsys-in-domain}.

\txtskip

The following definitions are
	from~\textit{Continuous Lattices and Domains\/}~\cite{CLaD}~(CLaD).

Let $P$ be a~poset.

For any elements $x$ and $y$ of~$P$
we say that \notion{$x$ is way below~$y\tinysp$}, and write $x\waybelow y\tinysp$,
if for every directed subset~$D$ of~$P$ that has a~join in~$P\negtinysp$,
the relation $y\leq\tJoin\!D$ implies that $x\leq d$ for some $d\in\negdtinysp D$.

For~every~$x\in P$ we define the set
	$\ddown x\defeq\set{\widet{u\narrt\in P\suchthat u\narrt\waybelow x}}\tinysp$,
which is a~lower set contained in the principal ideal $\ldown x\tinysp$.

The poset $P$ is said to be \notion{continuous}
if it satisfies the \notion{axiom of approximation}:
for every $x\in P$ the set $\ddown x$ is directed
	and has in $P$ the join $\tJoin\negtinysp\ddown x = x\dtinysp$.

A~\notion{domain} is a~continuous dcpo.

\txtskip

We shall silently use the basic properties of the way-below relation.
Besides those we will also need the following two results from~CLaD~\cite{CLaD}.

The first result is the \notion{interpolation property}
	of the way-below relation on a~continuous poset~$P$
	{\large(}Theorem~I-1.9(ii){\large)}:
{\it for any\/ $x,\tinysp z\in P$ such that\/ $x\waybelow z$
	there exists\/~$y\in P$ so that\/ $x\waybelow y\waybelow z\tinysp$}.

The second result is a~characterization of \Scottcont\ functions between domains
	{\large(}Proposition~II-2.1(5){\large)}:
{\it a~function\/ $f\colon P\to Q\tinysp$, where\/ $P$ and\/ $Q$ are domains,
is \Scottcont\ iff\/ $f(x) = \tJoin\negdtinysp f(\ddown x)$ for every\/ $x\in P$}
{\large(}\ie, $f(x)$~is the join of~$f(\ddown x)$ in~$Q$,
or, more long-windedly, the join of $f(\ddown x)$ in $Q$ exists and is~equal~to~$f(x)${\large)}.

\txtskip

And here is the first of the promised constructions,
namely the construction of the \Scottcont\ core of a~closure operator on a~domain.

\thmskip

\begin{proposition}\label{prop:sc(gamma)-on-domain}
Let\/ $\gamma$ be a~closure operator on a~domain\/~$P\negtinysp$.
Then for all\/ $x\in P$ we have\/ $(\sccore\gamma)(x)=\tJoin\negdtinysp\gamma(\ddown x)$.
\end{proposition}

\interskip

\begin{proof}
We define the endomap~$\gamma\inter$ on~$P$
	by $\gamma\inter(x)\defeq\tJoin\negdtinysp\gamma(\ddown x)$ for $x\in P\negtinysp$.

$\gamma\inter$ is ascending:
    $\gamma\inter(x)
	= \tJoin\negdtinysp\gamma(\ddown x)
	\geq \tJoin\!\ddown x
	= x\tinysp$.

$\gamma\inter$ is increasing.
If $x\leq y\tinysp$, then $\ddown x\subseteq\ddown y\tinysp$,
which clearly implies $\gamma\inter(x)\leq\gamma\inter(y)\tinysp$.

$\gamma\inter$ is idempotent.\pagebreak[3]
It suffices to prove that $\gamma\inter(\gamma\inter(x))\leq\gamma\inter(x)\tinysp$,
and to prove this inequality it suffices to prove
that every element of $P$ which is way below the left hand side is below the right hand side.
So~let $u \waybelow \gamma\inter(\gamma\inter(x))
		= \tJoin\negtinysp\gamma(\ddown\gamma\inter(x))\tinysp$.
The join is directed, thus there exists $v\in\ddown\gamma\inter(x)$
	such that $u\leq\gamma(v)\tinysp$.
Now $v\waybelow\gamma\inter(x) = \tJoin\negdtinysp\gamma(\ddown x)\tinysp$,
where the join is directed,
thus $v\leq \gamma(w)$ for some $w\waybelow x\tinysp$.
It follows that
    $u \leq \gamma(v) \leq \gamma(w)
	\leq \tJoin\negdtinysp\gamma(\ddown x)
	= \gamma\inter(x)$.

We have proved that $\gamma\inter$ is a~closure operator on~$P\negtinysp$.

Evidently $\gamma\inter\leq\gamma\tinysp$.

The closure operator $\gamma\inter$ is \Scottcont.
Since $P$ is a~domain, we will prove that $\gamma\inter$~is \Scottcont\
	when we prove that $\tJoin\negdtinysp\gamma\inter(\ddown x)=\gamma\inter(x)\tinysp$
		for every $x\in P$.
It suffices to prove the inequality~$\geq\dtinysp$.
By the definition of $\gamma\inter$ we have
%
\begin{align}
\gamma\inter(x)
	&\Eq \tJoin_{\!u\waybelow x}\negdtinysp\gamma(u)~,
							\label{eq:gammainter(x)} \\[1ex]
\tJoin\negdtinysp\gamma\inter(\ddown x)
	&\Eq \tJoin_{\!v\waybelow x}\negdtinysp\gamma\inter(v)
	\Eq \tJoin_{\!v\waybelow x}\!\tJoin_{\!u\waybelow v}\negtinysp\gamma(u)~.
							\label{eq:Join(gammainter(ddown(x)))}
\end{align}
%
Given any $u$ way below $x$,
there exists, because of the interpolation property,
an~element~$v\in P$ such that $u \waybelow v \waybelow x\tinysp$,
which shows that the term $\gamma(u)$
	in the join in~\eqref{eq:gammainter(x)}
appears also in the double join in~\eqref{eq:Join(gammainter(ddown(x)))}.
This proves the inequality
	$\tJoin\negdtinysp\gamma\inter(\ddown x) \geq \gamma\inter(x)\tinysp$.

Let $\beta$ be a~\Scottcont\ closure operator on~$P$ such that $\beta\leq\gamma\tinysp$.
Then for every $x\in P$ we have
    $\beta(x)
	= \tJoin\!\beta(\ddown x)
	\leq\tJoin\negdtinysp\gamma(\ddown x)
	= \gamma\inter(x)\tinysp$.

We conclude that $\gamma\inter = \sccore\gamma\dtinysp$.
\end{proof}

\thmskip

For the second construction,
that of a~directed-closed closure system generated by a~closure system in a~domain,
we have to introduce an operation.

For each subset $X$ of a~dcpo $P$ we let $\widedt{\dj(X)}$ denote
	the set of the joins of all directed subsets of~$X$.
We have $X\subseteq\dj(X)$ because one-element sets are directed,
thus the mapping $\dtinysp\dj\colon\Pow\negtinysp P\to\Pow\negtinysp P$ is ascending.
It is clear that the mapping $\widedt\dj$ is increasing.
But $\widedt\dj$ is in general not idempotent;
more often than not it is very far from being a~closure operator.
The following proposition thus comes as a~slight surprise.

\pagebreak[3]
\thmskip

\begin{proposition}\label{prop:dcclsys-in-domain}
If\/ $C$ is a~closure system in a~domain\/~$P\negtinysp$, then\/~$\dcclsys(C)=\dj(C)\dtinysp$;
therefore, if\/~$X$ is any subset of\/~$P\negtinysp$, then\/~$\dcclsys(X)=\dj(\clsys(X))\tinysp$.
\end{proposition}

\interskip

\begin{proof}
Let $P$ be a~domain, $C$ a~closure system in~$P$,
	and $\gamma$ a~closure operator on~$P$ with $\Fix(\gamma)=C$.
Since~$\dtinysp\dcclsys(C)$ contains $C$ and is closed under directed joins,
	it~con\-tains~$\dtinysp\dj(C)\tinysp$.
On~the other hand,
\zerorule$\dtinysp\dcclsys(C)
	= \dcclsys(\Fix(\gamma))
	= \Fix(\sccore\gamma)
	= (\sccore\gamma)(\negtinysp P)$
is the set of the closures
    $(\sccore\gamma)(x)
	= \tJoin\negdtinysp\gamma(\ddown x)$
for all $x\in P\negtinysp$.
Since for each $x\in P$ the set $\gamma(\ddown x)$ is a~directed subset of $C$,
its join belongs to $\dj(C)\dtinysp$;
this proves the inclusion $\dtinysp\dcclsys(C)\subseteq\dj(C)\tinysp$.

If $X$ is any subset of $P\negtinysp$,
then applying $\widedt\dcclsys$ to $X\subseteq \clsys(X) \subseteq \dcclsys(X)$
we get $\dtinysp\dcclsys(X) = \dcclsys(\clsys(X)) = \dj(\clsys(X))\tinysp$.
\end{proof}

\thmskip

Proposition~\ref{prop:dcclsys-in-domain} generalizes Theorem~4-1.22
	in~\textit{Lattice Theory: Special Topics and Applications\/}~\cite{LT-STA-2}~(LT-STA-2).

\pagebreak[3]


%----------------------------------------------------------------------------------------------------
\section{The frame of nuclei on a preframe}
\label{sec:frame-of-nuclei-on-preframe}

In this section we carry out the project that is only sketched in broad outline
at the end of Section~3 in~Escard\'o~\cite{escardo}.

\txtskip

A~\notion{preframe}%
%
\footnote{Preframes are also known as meet continuous semilattices.
See Definition O-4.1 in~CLaD~\cite{CLaD}.}
%
is a~dcpo $P$ that is also a~meet-semilattice,%
%
\footnote{A meet-semilattice is a~poset in which any two elements have a~meet,
	or equivalently, in which every nonempty finite subset has a~meet.
Some authors require that a~meet-semilattice is to have a~top element;
for instance, see~\textit{Stone Spaces\/}~\cite{johnstoneSS}.}%
%
\,%
%
\footnote{In~Escard\'o~\cite{escardo},
a~preframe is understood as a~dcpo that is also a~meet-semilattice \emph{with a~top element}
in~which binary meets distribute over directed joins.
As a~preframe is defined here
	{\larger(}and as a~meet continuous semilattice is defined in~CLaD~\cite{CLaD}{\larger)},
it is not required to possess a~top element.
This additional generality seems trivial, but it isn't.}
%
in which binary meets distribute over directed joins;
that is, the \notion{directed distributive law} holds:%
%
\footnote{Equivalently, the meet shift $P\to P : y\mapsto x\meet y$
	is \Scottcont\ for every $x\in P\negtinysp$.
This is the~justification for calling the semilattice $P$ meet continuous.}
%
%
\begin{equation*}
x\meet\tJoin\negtinysp Y \Eq \Join_{y\in Y} (x\meet y)~,
	\qquad\quad \text{$x\in P$\,, \ directed $Y\subseteq P$}\,.
\end{equation*}
%
Note that if $x\in P$ and $Y\subseteq P$ is directed,
	then also $\set{x\meet y\suchthat y\in Y}$ is directed.

\txtskip

For a~while, let $P$ be any~meet-semilattice.

\txtskip

In~the poset $\Fun(\negtinysp P)$ of all endofunctions on~$P$ ordered pointwise,
any~two endofunctions $\gamma$ and $\delta$ have a~meet $\gamma\meet\delta$,
	which is calculated pointwise,
and the following~is~true:
%
\begin{items}{(iii)}
\item[(i)] If $\gamma$ and $\delta$ are ascending, so is $\gamma\meet\delta\tinysp$.
\item[(ii)] If $\gamma$ and $\delta$ are increasing, so is $\gamma\meet\delta\tinysp$.
\item[(iii)] If $\gamma$ and $\delta$ are closure operators, so is $\gamma\meet\delta\tinysp$.
\item[(iv)] If $\gamma$ and $\delta$ preserve binary meets, so does $\gamma\meet\delta\tinysp$.
\end{items}%
%
\noindent Properties (i) and (ii) are easily verified.
%
For~(iii), assume $\beta$ and $\gamma$ are closure operators~on~$P$
and put $\beta = \gamma\meet\delta$.
Then $\beta$ is increasing and ascending by~(i)~and~(ii).
Since $\beta\beta \leq \gamma\tinysp\gamma = \gamma$,
and similarly $\beta\beta \leq \delta$,
we have $\beta\beta \leq \gamma\meet\delta = \beta$,
thus $\beta$~is idempotent.
Finally, to~prove~(iv), assume that $\gamma$ and $\delta$ preserve binary meets
	and let~$x,\,y\in P\dtinysp$;
then
%
\begin{align*}
(\gamma\meet\delta)(x\meet y)
  & \Eq \gamma(x\meet y)\meet\delta(x\meet y)
  	\Eq \gamma(x)\meet\gamma(y)\meet\delta(x)\meet\delta(y)\\[0.5ex]
  & \Eq (\gamma\meet\delta)(x)\meet(\gamma\meet\delta)(y)\,.
\end{align*}
%
Because of (i), (ii), and (iii), in the posets $\Precl(\negtinysp P)$
	and $\Cl(\negtinysp P)$ all binary meets exists
and they are calculated pointwise.

\thmskip

\begin{proposition}\label{prop:Fix(alpha-meet-beta)-on-meetsemilatt}
If $\gamma$ and $\delta$  are closure operators on a~meet-semilattice~$P$,
and $\gamma\meet\delta$ is their meet in $\Cl(\negtinysp P)$,
then $\Fix(\gamma\narrt\meet\delta)
	= \bigset{x\narrt\meet y\bigsuchthat x\narrt\in\Fix(\gamma),\, y\narrt\in\Fix(\delta)}$.
\end{proposition}

\interskip

\begin{proof}
If $z\in\Fix(\gamma\narrt\meet\delta)$,
then $z = (\gamma\narrt\meet\delta)(z) = \gamma(z) \meet \delta(z)$,
where $\gamma(z)\in\gamma(\negtinysp P)=\Fix(\gamma)$ and $\delta(z)\in\delta(\negtinysp P)=\Fix(\delta)$.

If $x\narrdt\in\Fix(\gamma)$ and $y\narrdt\in\Fix(\delta)$,
then $(\gamma\narrt\meet\delta)(x\narrt\meet y)
	\narrt= \gamma(x\narrt\meet y) \meet \delta(x\narrt\meet y)
	\narrt\leq \gamma(x) \meet \delta(y)
	\narrt= x \meet y\tinysp$,
and it follows that $x\meet y\in \Fix(\gamma\narrt\meet\delta)$.
\end{proof}

\thmskip

A~closure operator on the meet-semilattice~$P$ that preserves binary meets
	(hence preserves nonempty finite meets%
%
\footnote{A~``$\tinysp$nonempty finite meet''
	is short for a~``$\tinysp$meet of a~nonempty finite set''.}%
%
)
is called a~\notion{nucleus}~on~$P\negtinysp$.
A~preclosure map on~$P$ that preserves binary meets
is called a~\notion{prenucleus}~on~$P\negtinysp$.
A~map $\gamma\colon P\to P$ is a~prenucleus
iff~it is ascending and preserves binary meets,
and it is a~nucleus
iff~it is ascending and idempotent and preserves binary meets
(in both cases $\gamma$ is increasing since it preserves  binary meets).
If~$\gamma$ is a~prenucleus, and~$P$ possesses a top element~$\top$,
then~$\gamma(\top) = \top$ because $\gamma$ is ascending;
that is, if~the~empty meet%
%
\footnote{When we say ``$\tinysp$the empty meet'' we mean ``$\tinysp$the meet of the empty set''.}
%
in $P$ exists,
then $\gamma$ preserves~it.

We let $\Prenuc(\negtinysp P)$ and $\Nuc(\negtinysp P)$ denote the pointwise-ordered sets
	of all prenuclei resp.\ all nuclei on a~meet-semilattice~$P\negtinysp$.
The fixpoint set of a~nucleus on~$P$ shall be called a~\notion{nuclear system} in~$P\negtinysp$,
and the poset of all nuclear systems in~$P\negtinysp$, ordered by inclusion,
shall be denoted by $\NucSys(\negtinysp P)\tinysp$.

From (i)--(iv) above it follows
that the pointwise meet of two prenuclei on the meet-semilattice~$P$ is a~prenucleus on~$P\negtinysp$,
and that the pointwise meet of two nuclei on~$P$ is a~nucleus on~$P\negtinysp$.
Therefore, in the poset~$\Prenuc(\negtinysp P)$
	all binary meets exist and they are calculated pointwise,
and the same is true for the poset $\Nuc(\negtinysp P)$.

\txtskip

From now on let $P$ be a~preframe.

\txtskip

How about the joins of sets of nuclei on the~preframe~$P\dtinysp$?
They~always exist,
and~they are calculated in the complete lattice $\Cl(\negtinysp P)$ of all closure operators on~$P\negtinysp$.
We~give a slightly more general~result.

\pagebreak[3]
\thmskip

\begin{theorem}\label{thm:in-preframe-prenuclei-generate-nucleus}
Let\/ $P$~be a~preframe,
and let\/ $\Gamma$ be a~set of prenuclei on\/~$P\tinysp$;
then the closure operator\/ $\gencl{\Gamma}$,
	generated by the set\/ $\Gamma$ of~preclosure maps,
is a~nucleus.
In~particular, if\/~$\Gamma$ is a~set of nuclei on\/~$P\negtinysp$,
then the join\/~$\Join\negtinysp\Gamma$, taken in the complete lattice\/~$\Cl(\negtinysp P)$,
is~a~nucleus.
\end{theorem}

\interskip

\begin{proof}
Put $\delta = \gencl{\Gamma}$.
Let $x,\,y\in P\negtinysp$.
%
Since~$\delta$ is increasing, we have $\delta(x\meet y) \leq \delta(x)\meet\delta(y)$;
we must prove that the converse inequality also holds.

We~will first prove the weaker assertion $x\meet \delta(y) \leq \delta(x\meet y)$.
Let~$A$ be the set of all $z\in P$ such that $x\meet z \leq \delta(x\meet y)$.
The~set~$A$ contains~$y\tinysp$,
and it is closed under directed joins by directed distributivity.
For any $z\in A$ and any $\gamma\in\Gamma$ we have
%
\begin{equation*}
x\meet\gamma(z)
  \Leq \gamma(x)\meet\gamma(z)
  \Eq \gamma(x\meet z)
  \Leq \gamma\bigl(\delta(x\meet y)\bigr)
  \Eq \delta(x\meet y)\,,
\end{equation*}
%
hence $\gamma(z)\in A\dtinysp$;
thus $A$ is closed under~$\Gamma$.
The induction principle gives~$\delta(y)\in\nolinebreak A\tinysp$.

Now we substitute $\delta(x)$ for~$x$ in $x\meet \delta(y) \leq \delta(x\meet y)$ and~get
%
\begin{equation*}
\delta(x)\meet\delta(y)
  \Leq \delta\bigl(\delta(x)\meet y\bigr)
  \Leq \delta\bigl(\delta(x\meet y)\bigr)
  \Eq \delta(x\meet y)\,, %\tag*{\qed}
\end{equation*}
%
where the second inequality holds because $\delta(x)\meet y \leq \delta(x\meet y)$
	and $\delta$ is increasing.
\end{proof}

\thmskip

\begin{corollary}\label{cor:complete-lattice-of-nuclei}
For any preframe\/~$P\negtinysp$, the subset\/ $\Nuc(\negtinysp P)$ of\/ $\Cl(\negtinysp P)$
is closed under arbitrary joins in the complete lattice\/~$\Cl(\negtinysp P)$,
hence it is a~complete lattice.%
%
\footnote{Here we see that not requiring that preframes have top elements
	is not so innocent as it seems.
For~a~preframe~$P$ with a~top element
	it is trivial that there is a~greatest nucleus~on~$P\negtinysp$,
namely the constant map sending every element of~$P$ to its top element.
In~contrast, the existence of a~greatest nucleus
	on a~preframe~$P$ which lacks a~top element
is a~quite nontrivial matter;
and the greatest nucleus on $P$ does exist,
	since it is the top element of the complete lattice~$\Nuc(\negtinysp P)\tinysp$.}
%
Also,~$\Nuc(\negtinysp P)$ is closed under binary meets
	{\rm(}and hence under nonempty finite meets\/{\rm)}
		in\/~$\Cl(\negtinysp P)$,
since binary meets in\/~$\Nuc(\negtinysp P)$ are calculated pointwise,
	same as they are calculated in\/~$\Cl(\negtinysp P)$.
\end{corollary}

\thmskip

If~$P$ possesses a~top element $\top\negtinysp$,
then the top nucleus is the same as the top closure operator,
which is the constant map $P\to P : x\mapsto\top\negtinysp$.
However, if $P$ does not have a~top element,
then the top nucleus might be strictly smaller than the top closure operator.
That is, though a~subset $\Nuc(\negtinysp P)$ of $\Cl(\negtinysp P)$ is closed under all joins
	and also under all nonempty finite meets,
		both taken in the complete lattice $\Cl(\negtinysp P)\tinysp$,
it might not be closed under the empty meet taken in~$\Cl(\negtinysp P)\tinysp$.
This can already happen in a~finite preframe.
Since every finite directed set has a~greatest element, which is its join,
every finite poset is a~dcpo and every finite meet-semilattice is a~preframe.
The meet-semilattice $P_1$ in the left panel of Figure~\ref{fig:P1-preframe-with-topnuc<topcl}
%
\begin{figure}[!htp]\centering
\vspace{1.5ex}
\includegraphics[draft=false]{mp/closure-induction-1.mps}
\vspace{1ex}
\captionsetup{margin=2em}
\caption{The only nuclear system in the preframe $P_1$ is the whole $P_1$\\
	(represented by the black dot in the right panel),
	so the only nucleus on $P_1$\\ is the identity map,
	which is different from the top closure operator on~$P_1$.}
\label{fig:P1-preframe-with-topnuc<topcl}
\vspace{-1ex}
\end{figure}
%
is the simplest possible example:
there are four closure operators corresponding
	to the four closure systems exhibited in the right panel,
while there is only one nucleus, namely the identity map.

\txtskip

Since $\Nuc(\negtinysp P)$ is an interior system in the complete lattice $\Cl(\negtinysp P)$,
for every closure operator $\gamma$ on the preframe $P$
there exists the largest nucleus below $\gamma\tinysp$,
the \notion{nuclear core} $\widedt{\nuccore\gamma}$ of the closure operator~$\gamma\tinysp$.

\txtskip

A~\notion{frame} is a~complete lattice $L$
in which finite meets distribute over arbitrary joins,
which means that the following \notion{infinite distributivity law} holds in~$L\tinysp$:
%
\begin{equation*}
x\meet\tJoin\negtinysp Y \Eq \Join_{y\in Y}(x\meet y)~,
	\qquad\quad \text{$x\in L$\,, \ $Y\subseteq L$}\,.
\vspace{-1ex}
\end{equation*}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{comment}
As~an~ordered structure, a~frame is the same thing as a~complete Heyting algebra.
The~difference is in the structural features that are perceived as basic
and have to be preserved by morphisms.
For~frames the basic operations are finite meets and arbitrary joins,
and morphisms of frames are maps that preserve these operations;
correspondingly, a~subframe is a~subset of a~frame
closed under finite meets and arbitrary joins,
equipped with the frame structure induced from the `ambient' frame.
A~complete Heyting algebra has another basic operation, the implication $\bimpl$
	(also known as the relative pseudocomplementation);
a~morphism of complete Heyting algebras is a~morphism of frames
that in addition preserves implications.
%\end{comment}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\negdisplayhalfskip
\thmskip

\begin{proposition}\label{prop:frame-of-nuclei-on-preframe}
For any preframe\/~$P$ the complete lattice\/~$\Nuc(\negtinysp P)$ is a~frame.
\end{proposition}

\interskip

\begin{proof}
Let $\beta\in\Nuc(\negtinysp P)$ and $\Gamma\subseteq\Nuc(\negtinysp P)$,
and write $\delta \defeq \Join\negtinysp\Gamma$,
	$\deltapr \defeq \Join_{\gamma\in\Gamma\tinysp}(\beta\meet\gamma)$
{\large(}joins taken in~$\Nuc(\negtinysp P)$, hence in~$\Cl(\negtinysp P)${\large)}.
We~must show that $\beta\meet\delta = \deltapr\negdtinysp$.
The~inequal\-ity~$\beta\meet\delta \geq \deltapr $
holds because $\beta\meet\delta \geq\nolinebreak \beta\meet\nolinebreak\gamma$
for every $\gamma\in\Gamma$.

To~prove the other inequality,
let~$x\in P$ and put
	$A \defeq \bigset{z\in P\bigsuchthat \beta(x)\meet z \leq \deltapr (x)}\tinysp$.
Evidently $x\in A\tinysp$,
	and $A$ is closed under directed joins by directed distributivity in~$P\negtinysp$.
In~order to see that $A$ is closed under $\Gamma$,
we consider any $\gamma\in\Gamma$ and any $z\in A\tinysp$,
exhibit the following chain of equalities and inequalities,
%
\begin{align*}
\beta(x) \meet \gamma(z)
	&\Eq \beta(x) \widet\meet \gamma\beta(x) \widet\meet \gamma(z)
		\Eq \beta(x) \widet\meet \gamma\bigl(\beta(x)\narrt\meet z\bigr)
		\Leq \beta(x) \widet\meet \gamma\bigl(\deltapr(x)\bigr) \\[.5ex]
	&\Leq \beta\bigl(\deltapr(x)\bigr) \widet\meet \gamma\bigl(\deltapr(x)\bigr)
		\Eq (\beta\narrt\meet\gamma)\bigl(\deltapr(x)\bigr) \\[.5ex]
	&\Eq \deltapr(x)~,
\end{align*}
%
and then from the inequality between the first and the last expression in the chain
	conclude that $\gamma(z)\in A\tinysp$.
By the induction principle it then follows that $\delta(x)\in A\tinysp$,
that~is, that $(\beta\meet\delta)(x) = \beta(x)\meet\delta(x) \leq \deltapr (x)\tinysp$.
\end{proof}

\thmskip

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{comment}
In the proof above
we use the assumption that every $\gamma\in\Gamma$ is a~nucleus,
but we do not need $\beta$ to be a~nucleus, it suffices that $\beta$ is a~closure operator.
So we have actually proved the following, albeit rather technical,
	enhancement of Proposition~\ref{prop:frame-of-nuclei-on-preframe}:

\thmskip

\begin{proposition}\label{prop:frame-of-nuclei-on-preframes-enhanced}
If\/ $P$ is a~preframe,
$\beta$ is a~closure operator on\/~$P$,
and\/ $\Gamma$ is a~set of nuclei on\/~$P$,
then
%
\begin{equation*}
\beta \meet \tJoin\negdtinysp\Gamma \Eq \tJoin_{\!\gamma\in\Gamma}\tinysp(\beta\meet\gamma)~,
\end{equation*}
%
with the binary meets and the joins taken in the complete lattice\/~$\Cl(\negtinysp P)$.
\end{proposition}

\thmskip

The binary meets are of course calculated pointwise,
and the join $\tJoin\negdtinysp\Gamma$, though taken in $\Cl(\negtinysp P)$, is actually a~nucleus.

I~do not know whether there is any interesting application
	for the Proposition~\ref{prop:frame-of-nuclei-on-preframes-enhanced}.
Well, perhaps somebody out there will find in this proposition
the missing link for her/his proof that has been languishing unfinished for a~long time.

\txtskip
\end{comment}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In conclusion of this nuclear-themed section we take a~quick look at \Scottcont\ nuclei on a~preframe.
Given a~preframe $P\negtinysp$, we denote by $\ScNuc(\negtinysp P)$
	the poset of all \Scottcont\ nuclei on~$P\negtinysp$, ordered pointwise.

\thmskip

\begin{theorem}\label{thm:in-preframe-nuc-generd-by-prenucs}
Let\/ $\Gamma$ be a~set of \Scottcont\ prenuclei on a~preframe\/~$P\negtinysp$.
The pointwise join\/~$\delta\defeq\dottJoin\negtinysp\Gamma^*$
	is a~\Scottcont\ nucleus on\/~$P\negtinysp$.
Moreover, $\delta$ is the closure operator on the dcpo\/~$P$
	that is generated by the set\/~$\Gamma$ of preclosure maps on\/~$P\negtinysp$.

If\/ $\Gamma$ is a~set of \Scottcont\ nuclei on\/~$P\negtinysp$,
then the pointwise join of\/~$\Gamma^*$
is the join of\/ $\Gamma$ in\/~$\ScNuc(\negtinysp P)$
	as well as in\/~$\Nuc(\negtinysp P)$ and in\/~$\Cl(\negtinysp P)\tinysp$.
The~set\/~$\tinysp\ScNuc(\negtinysp P)$ is therefore
	an~interior system in the complete lattice\/~$\Nuc(\negtinysp P)$
		and also in the complete lattice\/~$\Cl(\negtinysp P)\tinysp$,
and so is itself a~complete lattice
	since it is a~subposet of\/~$\Nuc(\negtinysp P)$ and hence of\/~$\Cl(\negtinysp P)$.
\end{theorem}

\interskip

\begin{proof}
According to Theorem~\ref{thm:in-dcpo-Scottcont-preclmaps-gener-Scottcont-clop},
	$\delta$ is a~\Scottcont\ closure operator on~$P\negtinysp$,
	and it is also the closure operator on~$P$ generated by the set $\Gamma$ of preclosure maps.
By Theorem~\ref{thm:in-preframe-prenuclei-generate-nucleus}
	it then follows that $\delta$ is a~nucleus.
\end{proof}

\thmskip

\begin{proposition}\label{prop:meet-of-two-Scotcont-nuclei-is-Scottcont}
The pointwise meet of two \Scottcont\ nuclei on a~preframe\/~$P$
is a~\Scottcont\ nucleus on\/~$P$.
\end{proposition}

\interskip

\begin{proof}
Let $\gamma$ and $\delta$ be \Scottcont\ nuclei on~$P$.
We know that the pointwise meet $\gamma\meet\delta$ is a~nucleus,
so it remains to prove that the meet is \Scottcont.

Let $Y$ be a~directed subset of~$P\tinysp$;
we shall prove that
	$(\gamma\narrt\meet\delta)(\tJoin\negtinysp Y) = \tJoin(\gamma\narrt\meet\delta)(Y)\tinysp$.
It~suffices to prove the inequality $\leq\dtinysp$.
We calculate:
%
\begin{equation}\label{eq:(gamma-meet-delta)(Join(Y))=...}
\begin{aligned}
(\gamma\narrt\meet\delta)(\tJoin\negtinysp Y)
    &\Eq \gamma(\tJoin\negtinysp Y) \meet \delta(\tJoin\negtinysp Y)
	\Eq \tJoin\negdtinysp\gamma(Y) \widedt\meet \tJoin\negdtinysp\delta(Y) \\[.75ex]
    &\Eq \tJoin_{\!y_1,y_2\in Y} \bigl(\gamma(y_1)\meet\delta(y_2)\bigr)~;
\end{aligned}
\end{equation}
%
the last equality holds because of directed distributivity.
Now if $y_1,\tinysp y_2\in Y$,
then there exists $y\in Y$ such that $\set{y_1,y_2}\leq y\tinysp$,
and it follows that
    $\gamma(y_1)\meet\delta(y_2)
	\leq \gamma(y) \meet \delta(y)
	= (\gamma\narrt\meet\delta)(y)
	\leq \tJoin(\gamma\narrt\meet\delta)(Y)\tinysp$.
The last join in~\eqref{eq:(gamma-meet-delta)(Join(Y))=...}
	is therefore $\leq\tJoin(\gamma\narrt\meet\delta)(Y)$,
and we have the desired inequality.
\end{proof}

\thmskip

The following is a~straightforward consequence
	of~Theorem~\ref{thm:in-preframe-nuc-generd-by-prenucs}
	and Proposition~\ref{prop:meet-of-two-Scotcont-nuclei-is-Scottcont}.

\thmskip

\begin{corollary}\label{cor:ScNuc(preframe)-is-frame}
Let\/ $P$ be a~preframe.
The subposet\/ $\ScNuc(\negtinysp P)$ of the frame\/ $\Nuc(\negtinysp P)$
	is in $\Nuc(\negtinysp P)$ closed under all joins and under binary meets,
therefore it is itself a~frame,
	whose arbitrary joins and nonempty finite meets are inherited from\/~$\Nuc(\negtinysp P)$.
\end{corollary}

\thmskip

It is an open question whether there exists a~preframe~$P$
such that the top element of~$\ScNuc(\negtinysp P)$
	is different (hence strictly below) the top element of~$\Nuc(\negtinysp P)$.
If such a~preframe exists, it lacks a~top element,
and it is by necessity infinite
	since every increasing function between finite poset is \Scottcont\
and so every nucleus on a~finite preframe (that is, on a~finite meet-semilattice) is \Scottcont.


%----------------------------------------------------------------------------------------------------
\section{Nuclei on frames}
\label{sec:nucs-on-frames}

In this section we consider frames, as preframes with special properties.
For starters we specialize Proposition~\ref{prop:frame-of-nuclei-on-preframe} to frames.

\thmskip

\begin{corollary}\label{cor:frame-of-nuclei-on-frame}
For any frame\/~$L$ the complete lattice\/~$\Nuc(L)$ is a~frame.
\end{corollary}

\thmskip

The concise proof of Proposition~\ref{prop:frame-of-nuclei-on-preframe},
	which also serves as a~proof of Corollary~\ref{cor:frame-of-nuclei-on-frame},
compares well with the long-winded proof of
	Proposition~II.2.5 in~\textit{Stone Spaces\/}~\cite{johnstoneSS}.

\txtskip

From now on, to th end of the section, we let $L$ be a~frame.

\txtskip

Arbitrary joins and finite meets in the complete lattice $\Nuc(L)$
are calculated in the complete lattice $\Cl(L)$, as in any preframe;
but, $L$ being a~frame, more~is~true.

\thmskip

\begin{proposition}\label{prop:frame-L-Nuc(L)-sub-(completlatt)-of-Cl(L)}
Let $L$ be a~frame.
Arbitrary meets in the complete lattice\/~$\Nuc(L)$ are calculated pointwise,
same as they are calculated in the complete lattice\/~$\Cl(L)$.
As~arbitrary joins in\/~$\Nuc(L)$ also are calculated in\/~$\Cl(L)$,
the complete lattice~$\Nuc(L)$
	is a~sub$\tinysp$-{\rm(}complete lattice\/{\rm)} of the complete lattice\/~$\Cl(L)$.
\end{proposition}

\interskip

\begin{proof}
%\begin{proof*}
We have to prove that for any set $\Gamma$ of nuclei
its pointwise meet $\alpha\defeq\nolinebreak\Meet\negdtinysp\Gamma$,
	which is a~closure operator, % by Proposition~\ref{prop:clops-and-clsys-in-complete-latt},
preserves binary meets;
but this is a~straightforward consequence of the associativity-cum-commutativity of arbitrary meets
	in the complete lattice~$L\tinysp$.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{comment}
preserves binary meets.
But this is a~consequence of the complete associativity of meets:
%
\begin{align*}
\alpha(x\narrt\meet y)
	&\,\Eq \Meet_{\gamma\in\Gamma}\!\gamma(x\narrt\meet y)
		\wide\Eq \Meet_{\gamma\in\Gamma}\bigl(\gamma(x)\meet\gamma(y)\bigr)
		\wide\Eq \Meet_{\gamma\in\Gamma}\!\negdtinysp\gamma(x)
			\,\meet \Meet_{\gamma\in\Gamma}\!\negdtinysp\gamma(y) \\[.5ex]
	&\,\Eq\, \alpha(x)\meet\alpha(y)~.		\tag*{\qed}
\end{align*}
\end{comment}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\end{proof*}
\end{proof}

%\negdisplayskip
\thmskip

We have mentioned that a~frame is a~complete Heyting algebra:
for any two elements $a,\,b\in L$ there exists
	the \notion{relative pseudo-complement} of~$a$ with respect to~$b$,
which is the unique element $(a\bimpl b)\in L$ such that
%
\begin{equation*}
x\meet a \Leq b \wide\Isequiv x\leq (a\bimpl b)
	\qquad\quad \text{for every \ $x\in L$}~;
\end{equation*}
%
the infinite distributivity implies that
	$(a\bimpl b) \widedt= \Join\set{x\suchthat x\meet a\leq b}$.

\txtskip

The following proposition characterizes nuclear systems in a~frame.%
%
\footnote{A nuclear system in a~frame (alias locale) is also known as a~\knownas{sublocale}.}
%

\thmskip

\begin{proposition}\label{prop:charact-of-nucsyss-in-frames}
Let\/ $L$ be a~frame.
A~subset\/~$C$ of\/~$L$ is a~nuclear system in\/~$L$
\iff\/ $C$ is a closure system in\/~$L$
	{\rm(}\ie, it is closed under arbitrary meets{\rm)},
and\/ $x\in L$, $y\in C$ together imply\/ $(x\bimpl y)\in C$.
\end{proposition}

\interskip

\begin{proof}
Suppose $C$ is a~nuclear system.
Then $C$ is a~closure system.
Let $\gamma$ be the nucleus with $\Fix(\gamma)=C$.
Let $x\in L$ and $y\in C$;
we have to prove that $x\bimpl y$ is a fixed point of~$\gamma\tinysp$.
It suffices to prove that $\gamma(x\narrt\bimpl y)\leq(x\bimpl y)\tinysp$.
Since $x\meet(x\bimpl y) \leq y$ and $\gamma(y)=y$ we have
%
\begin{equation*}
x\meet\gamma(x\narrt\bimpl y)
	\widedt\Leq \gamma(x)\meet\gamma(x\narrt\bimpl y)
	\widedt\Eq \gamma\bigl(x\meet(x\narrt\bimpl y)\bigr)
	\widedt\Leq \gamma(y)
	\widedt\Eq y~,
\end{equation*}
%
and by the defining property of $x\bimpl y$ it follows that
	$\gamma(x\narrt\bimpl y)\leq(x\bimpl y)$,
as required.

Conversely, suppose that $C$ is a~closure system,
and that $x\in L$, $y\in C$ always imply $(x\bimpl y)\in C$.
Let $\gamma$ be the closure operator with $\Fix(\gamma)=\gamma(L)=C\tinysp$;
we shall prove that $\gamma$~preserves binary meets.
We need only prove that $x\meet\gamma(y)\leq\gamma(x\narrt\meet y)$
	for~all~$x,\tinysp y\in L\tinysp$.
Let~$z\defeq\bigl(x\bimpl\gamma(x\narrt\meet y)\bigr) \in C$.
From $x\meet y\leq\gamma(x\narrt\meet y)$ 
	we get $y\leq \bigl(x\bimpl\gamma(x\narrt\meet y)\bigr) = z\dtinysp$;
but then $\gamma(y)\leq\gamma(z)=z$,
whence $x\meet\gamma(y)\leq x\meet z \leq\gamma(x\narrt\meet y)\dtinysp$.
\end{proof}

\thmskip

For any two subsets $A$ and $B$ of a~frame $L$ we shall write
%
\begin{equation*}
(A\bimpl B) \Defeq \bigset{a\narrt\bimpl b\bigsuchthat a\narrt\in A\tinysp,\, b\narrt\in B}~.
\end{equation*}
%
Using this notation, Proposition~\ref{prop:charact-of-nucsyss-in-frames} says
    that a~closure system $C$ in the frame~$L$ is a~nuclear system iff $(L\bimpl C)\subseteq C$
	{\large(}which implies $(L\bimpl C)=C\tinysp${\large)}.

Every subset $X$ of a~complete lattice
generates the smallest closure system $\widedt{\clsys(X)}$ in the lattice that contains~$X$;
the closure system $\widedt{\clsys(X)}$ consists of the meets of all subsets of~$X$.
Likewise every subset $X$ of the~frame~$L$
generates the smallest nuclear system $\widedt{\nucsys(X)}$ in $L$ that contains~$X$;
can we somehow construct $\widedt{\nucsys(X)}$?

\thmskip

\begin{proposition}\label{prop:in-frame-nucsys(X)=clsys(L=>X)}
If\/ $X$ is any subset of a~frame\/ $L\tinysp$, then
%
\begin{equation*}
\nucsys(X) \Eq \clsys\dtinysp(L\rightt\bimpl X)\tinysp~.
\end{equation*}
\end{proposition}

%\negdisplayhalfskip
%\interskip
\inskip

\begin{proof}
The endofunction $(L\bimpl\anon)\colon X\mapsto(L\narrt\bimpl X)$ on $\Pow\negtinysp L$
	is a~closure operator on the powerset lattice~$\Pow\negtinysp L\dtinysp$:
it is ascending because $(\top\bimpl x) = x$ for every~$x\in X$;
it is evidently increasing;
and it is idempotent because $(a\bimpl(b\bimpl x)) = ((a\narrt\meet b)\bimpl x)$
	for all $a,\tinysp b\in L$ and every $x\in X$.
In~view of Proposition~\ref{prop:charact-of-nucsyss-in-frames}
the closure operator $\widet\nucsys$ on $\Pow\negtinysp L$
is the join, in the complete lattice $\Cl(\Pow\negtinysp L)\tinysp$,
of the closure operators $\widedt\clsys$ and $(L\bimpl\anon)\tinysp$.

Let $X$ be any subset of $L\tinysp$.
We shall prove the inclusion
%
\begin{equation*}
(L\bimpl\clsys(X)) \Subseteq \clsys\dtinysp(L\rightt\bimpl X)~,
\end{equation*}
%
from which it will follow that
    $\dtinysp\clsys\dtinysp(L\bimpl\anon)
	\widet= \clsys\widet\join\tinysp(L\narrt\bimpl\anon)
	\widet= \nucsys\,$.
Consider a~general element of $\widedt{\clsys(X)}$,
    which is of the form $\tMeet_{\tinysp i\in I}\negtinysp x_i$
	for some elements $x_i$ ($i\in I$) of the set~$X$;
also let $y\in L\tinysp$.
Then
%
\begin{equation*}
\bigl(y\dtinysp\bimpl\tMeet_{\tinysp i\in I}\negtinysp x_i\bigr)
	\widedt\Eq \tMeet_{\tinysp i\in I} (y\bimpl x_i)
	\widedt\In \clsys(L\rightt\bimpl X)~,
\end{equation*}
%
which proves the asserted inclusion.
\end{proof}

\pagebreak[3]
\thmskip

Mark that we do not obtain a~shortcut when constructing $\widedt{\nucsys(C)}$
	for a~closure system~$C$
since we still have to construct $\widedt{\nucsys(C)}$ as $\widedt{\clsys\dtinysp(L\bimpl C)}$,
	which resists simplification.

However, there is an important special case where $\dtinysp\nucsys(X)$ does simplify.

\thmskip

\begin{proposition}\label{prop:in-frame-nucsys(x)=(L=>x)}
If $x$ is any element of a~frame $L\tinysp$, then
%
\begin{equation*}
\nucsys(\set{x}) \Eq (L\bimpl x)~.
\end{equation*}
%
\end{proposition}

%\negdisplayhalfskip
%\interskip
\inskip

\begin{proof}
It suffices to prove that $L\bimpl x$ is already closed under all meets,
so that \zerorule$\dtinysp\nucsys(\set{x}) = \clsys\dtinysp(L\bimpl x) = (L\bimpl x)\tinysp$.
And indeed, if $y_i$, $i\in I$, are any elements of~$L\tinysp$,
then $\tMeet_{\tinysp i\in I}(y_i\bimpl x)
	= \bigl((\tJoin_{\!i\in I} y_i)\bimpl x\bigr)
	\in (L\bimpl x)\tinysp$.
\end{proof}

\pagebreak[3]
\thmskip

We are not yet satisfied.
Now that we have constructed $\widedt{\nucsys(X)}$,
the nuclear system generated by a~subset $X$ of a~frame,
we are curious what the corresponding nucleus $\dtinysp\nuc_X$ looks like,
	the one whose fixpoint set is $\widedt{\nucsys(X)}$.
%And, perhaps we can construct the nucleus~$\dtinysp\nuc_X$, too?

\thmskip

\begin{proposition}\label{prop:in-frame-nucX(y)=Meet(x-in-X)((y=>x)=>x)}
If\/ $X$ is any subset of a frame\/ $L\tinysp$, then
%
\begin{equation*}
\nuc_X(y) \Eq\! \Meet_{x\in X}\!\bigl((y\bimpl x)\bimpl x\bigr)
			\qquad\quad \text{\rm for\, $y\in L$}\,.
\end{equation*}
%
\end{proposition}

\inskip

\begin{proof}
For every $y\in L$ we have
%
\begin{equation*}
\nuc_X(y) \Eq \Meet\negtinysp\allabove{\nucsys(X)\negtinysp}{y}
	\Eq \Meet\tinysp\allabove{\bigl(\clsys(L\bimpl\negdtinysp X)\bigr)\negdtinysp}{y}
	\Eq \Meet\tinysp\allabove{(L\bimpl\negdtinysp X)\negtinysp}{y}~.
\end{equation*}
%
Fix $x\in X$, and let $u\in L\tinysp$.
Then $y\leq(u\bimpl x)$ iff $u\meet y\leq x$ iff $u\leq (y\bimpl x)\tinysp$,
and for every $u\leq(y\bimpl x)$ we have $(u\bimpl x)\geq(y\bimpl x)\bimpl x\tinysp$.
The meet of all terms of the form $(u\bimpl x)$ in
	$\tMeet\bigl(\tinysp\allabove{(L\bimpl\negdtinysp X)\negtinysp}{y}\bigr)$
is $\bigl((y\bimpl x)\bimpl x\bigr)\tinysp$.
Now we release~$x$ to run through the whole set~$X$
and obtain the formula for~$\widedt{\nuc_X(y)}$ given in the proposition.
\end{proof}

\thmskip

Let us exhibit two special cases of
	Proposition~\ref{prop:in-frame-nucX(y)=Meet(x-in-X)((y=>x)=>x)},
one with $X=\set{x}\tinysp$, and another one where $X$~is a~closure system.

\thmskip

\begin{corollary}\label{cor:in-frame-nucx(y)=((y=>x)=>x)}
If\/ $x$ is any element of a~frame\/ $L$, then
%
\begin{equation*}
\nuc_{\set{x}}(y) \Eq \bigl((y\bimpl x)\bimpl x\bigr)
			\qquad\quad \text{\rm for\, $y\in L$}\,.
\end{equation*}
%
\end{corollary}

\interskip
%\inskip

\begin{corollary}\label{cor:in-frame-nucC(y)=Meet(x-in-X)((y=>gamma(x))=>gamma(x))}
If\/ $\gamma$ is a~closure operator on a~frame\/ $L\tinysp$, then
%
\begin{equation*}
\nuc_{\tinysp\gamma(L)}(y) \Eq\!
	\Meet_{u\in L}\!\bigl((y\bimpl\negtinysp\gamma(u))\bimpl\negtinysp\gamma(u)\bigr)
			\qquad\quad \text{\rm for\, $y\in L$}\,.
\end{equation*}
%
\end{corollary}

\negdisplayshortskip
\thmskip

The nucleus $\dtinysp\nuccore\gamma \defeq \nuc_{\tinysp\gamma(L)}\tinysp$
	is the nuclear core of the closure operator~$\gamma$,
that~is,
it~is~the~greatest of all nuclei on the frame~$L$ that are below~$\gamma\tinysp$.

\txtskip

It is high time we introduce, for each $x\in L$,
	the \notion{regular nucleus} $\dtinysp\regnuc_x \defeq \nuc_{\set{x}}$ on~$L\dtinysp$;
by~Proposition~\ref{prop:in-frame-nucsys(x)=(L=>x)}
	the fixpoint set of the regular nucleus $\widedt{\regnuc_x}$ is $L\bimpl x\dtinysp$.
The mapping $L \to \NucSys(L) : x \mapsto (L\bimpl x)$ is injective because
	$x$~is the least element of $L\bimpl x\tinysp$,
and it follows that also the mapping $L \to \Nuc(L) : x\mapsto \regnuc_x$ is injective.

\thmskip

\begin{proposition}\label{prop:nu<=rx-iff-x-in-Fix(nu)}
If\/ $\nu$ is a~nucleus on a~frame\/~$L\tinysp$ and\/ $x\in L\tinysp$,
	then\/ $\nu\leq\regnuc_x$ iff\/ $x\in\Fix(\nu)$.
In particular, if\/ $x,\tinysp y\in L\tinysp$,
	then\/ $\regnuc_x \leq \regnuc_y$ iff\/ $y\in(L\bimpl x)$.
\end{proposition}

\interskip

\begin{proof}
Let $\nu$ be a~nucleus on a~frame $L$ and $x\in L$.
Then $\nu\leq\regnuc_x$
	iff $\Fix(\regnuc_x)\subseteq\Fix(\nu)$,
	iff $(L\bimpl x)\subseteq\Fix(\nu)$,
	iff $x\in\Fix(\nu)\dtinysp$;
the last equivalence holds since $x=(\top\bimpl x)$~is in~$(L\bimpl x)$,
and because $x\in\Fix(\nu)$ implies $(L\bimpl x)\subseteq\Fix(\nu)$.
\end{proof}

\thmskip

By Proposition~\ref{prop:in-frame-nucX(y)=Meet(x-in-X)((y=>x)=>x)}
%the set $\RegNuc(L)$ of all regular nuclei on $L$
the set of all regular nuclei on~$L$
	meet-generates the complete lattice of all nuclei on~$L\tinysp$.
Moreover, if~$\nu$~is a nucleus and $X$~is a~subset of~$L\tinysp$,
then $\nu=\tMeet_{x\in X}\regnuc_x\tinysp$
	iff $X$ generates the nuclear system $\Fix(\nu)\dtinysp$;
in~particular, $\nu=\tMeet\tinysp\set{\regnuc_x\narrt\suchthat x\narrt\in\Fix(\nu)}$.

\txtskip

The sub$\tinysp$-(complete lattice) $\Nuc(L)$ of $\Cl(L)$ is not only an interior system in~$\Cl(L)$,
which gives us for every closure operator on~$L$ the largest nucleus below it,
it is also a~closure system in~$\Cl(L)$,
and so for any given closure operator $\gamma$ on $L$
there exists the least nucleus $\nu$ above it,
which is the (pointwise) meet of all nuclei above~$\gamma\dtinysp$;
but since $\Nuc(L)$~is meet-generated by the regular nuclei,
it follows that
    $\nu = \tMeet\tinysp\set{\regnuc_x\narrt\suchthat x\narrt\in L,\,\gamma\narrt\leq\regnuc_x}\tinysp$.
For a~closure operator $\gamma$ on $L$ and the least nucleus $\nu$ above it,
	let $C\defeq\Fix(\gamma)$ and $N\defeq\Fix(\nu)$.
Since for every $x\in L$ we have $\nu\leq \regnuc_x$ iff $\gamma\leq \regnuc_x\tinysp$,
by Proposition~\ref{prop:nu<=rx-iff-x-in-Fix(nu)} it follows that
	$N \defeq \set{x\narrt\in L \suchthat (L\bimpl x)\subseteq C\tinysp}\dtinysp$;
since $N\subseteq C$ we have also
	$N = \set{x\narrt\in C\suchthat (L\bimpl x)\subseteq C\tinysp}\tinysp$,
and therefore 
    $\nu = \tMeet\tinysp\set{\regnuc_x\narrt\suchthat x\narrt\in C,\,\gamma\narrt\leq\regnuc_x}\tinysp$.

\thmskip

\begin{proposition}\label{prop:the-least-nuc-above-clop}
If\/ $\gamma$ is a~closure operator on a~frame\/~$L$
and\/~$\nu$ is the least nucleaus above\/~$\gamma\tinysp$,
then
%
\begin{equation*}
\nu \Eq \Meet\tinysp\bigset{\regnuc_x\bigsuchthat x\in C,\, \gamma\leq \regnuc_x}~,
	\qquad
\Fix(\nu) \Eq \bigset{x\in C\bigsuchthat (L\bimpl x)\subseteq\Fix(\gamma)}~,
\end{equation*}
%
where the meet in the formula for\/~$\nu$ is calculated pointwise.
\end{proposition}

%!

%----------------------------------------------------------------------------------------------------
\section[The Hofmann-Mislove-Johnstone theorem]%
	{The Hofmann--Mislove$\tinysp$--Johnstone theorem}
\label{sec:HMJ-theorem}

In~\cite{escardo} Escard\'o shows off the utility of join induction
by using it in a~proof of the Hofmann--Mislove$\tinysp$--Johnstone theorem.
In this section we use the HMJ~theorem as a~training wheel
	on which we try out an application of the obverse induction principle.
The proof of the HMJ~theorem is spread through proofs of three lemmas,
	with parts of it reasoned out in the connecting text;
the short concluding reasoning then ties everything together.
The obverse induction principle gets its chance
	in the proof of Lemma~\ref{lem:scott-open-filter-is-nuclear},
where it performs admirably,
simplifying proofs of the corresponding results
	in~Johnstone~\cite{johnstoneViet} and~Escard\'o~\cite{escardo}
and shortening them to five easy lines of the proof proper
	(after the introductory~line).

\thmskip

\begin{theorem}[Johnstone]\label{thm:HMJ-theorem}
The compact fitted quotient frames of any frame
are in order-reversing bijective correspondence%
%
\footnote{An ``order-reversing bijective correspondence'' means an antiisomorphism of posets,
that is, a~bijection between posets such that both the bijection itself and its inverse
are order-reversing.}
%
with the Scott-open filters of the frame.
\end{theorem}

\thmskip

If this sounds all Greek to you, do not panic; %at this point, do not panic and run away;
everything will be explained below\,---\,slowly and in sickening detail\,---\,%
before we embark on the actual proof of the theorem,
which will be short and quite painless.

\txtskip

Frames we have already defined:
a~frame is a complete lattice in which finite meets distribute over arbitrary joins,
and a~frame morphism is a~mapping from a~frame to a~frame
that preserves finite meets and arbitrary joins.

\txtskip

Henceforward let $L$ be an arbitrary frame.

\txtskip

Consider a~nucleus $\gamma$ on~$L$.
The subposet $\gamma(L) = \Fix(\gamma)$ of~$L$ is a~complete lattice
in which meets are calculated in~$L$
and the join of a~subset $S$ of $\gamma(L)$ is
$\Join^{\tinysp\gamma}\!S =\nolinebreak \gamma\bigl(\Join\!S\bigr)$.
Moreover, the infinite distributivity law holds in the~complete lattice~$\gamma(L)$,
so~it~is in fact a~frame:
given any $x\in \gamma(L)$ and any $Y\subseteq\gamma(L)$, we have
$x\meet\Join^{\tinysp\gamma}\negtinysp Y
    = \gamma(x)\meet\gamma\bigl(\Join\negtinysp Y\bigr)
    = \gamma\bigl(x\meet\Join\negtinysp Y\bigr)
    = \gamma\bigl(\Join_{\negdtinysp y\in Y}(x\meet\nolinebreak y)\bigr)
    = \Join^{\tinysp\gamma}_{\negdtinysp y\in Y}(x\meet y)$.
The restriction $\gammapr\colon L\to\gamma(L)$ of~$\gamma$
preserves finite meets because $\gamma$ preserves~them,
and it preserves joins because $\gamma$ is a~closure~operator;
thus $\gammapr$~is a~surjective frame morphism.
This~is~why the~nuclear system~$\gamma(L)$
	is~also~called a~\notion{quotient frame}~of~$L\tinysp$.

Let~$f\colon L\to K$ be a~morphism of frames.
Since~$f$ preserves all joins,
it has a~right adjoint $g\colon K\to L$, which preserves all meets,
thus the closure operator $\gamma \defeq gf$~on~$L$ preserves finite meets,
that is,~it is a~nucleus on~$L$.
Now suppose that $f$ is surjective,
	and~hence $g$~is injective and~$fg=\id_K$.
Denoting by~$\gammapr\colon L\to\gamma(L)=g(K)$ the restriction of~$\gamma$
and by $h\colon g(K)\to K$ the restriction of~$f$,
we have an~isomorphism~$h$ of frames such that~$h\tinysp\gammapr = f$.
Therefore, every surjective frame morphism from~$L$ is isomorphic
to an `inner' surjective frame morphism from~$L$ associated with a~nucleus on~$L\tinysp$.

\txtskip

A~frame is said to be \notion{compact} if its top element is inaccessible by directed joins.
Spelled out: a frame $K$, with a~top element $\top$, is compact
\iff\ every directed subset $S$ of $K$ whose join is $\top$ already contains~$\top$.
%If~$S$~is~an~arbitrary subset of~$K$,
%then $\tJoin\!S=\tJoin\tinysp\set{\dtinysp\tJoin\negtinysp\!A\suchthat A\narrdt\in\Powfin S\dtinysp}$.
%This fact leads to the following alternative characterization of compact frames:
%a~frame $K$ is compact
%\iff\ for every $S\subseteq K$ such that $\tJoin\!S=\top$
%there exists a~finite $A\subseteq S$ such that $\tJoin\negtinysp\!A=\top$.

\txtskip

So we now know what is a~compact quotient frame.
``Fitted'' comes next.

\txtskip

Let $a\in L$.
The~principal ideal $\ldown a$ is a~frame,
the map $f_a\colon L\to\ldown a : x\mapsto x\meet a$ is a~surjective frame morphism,
and the defining property of $(\anon\bimpl\anon)$ shows that
the right adjoint of $f_a$ is the map $g_a\colon \ldown a\to L : y \mapsto (a\bimpl y)$;
the nucleus $a\open := g_a f_a$ on~$L$
maps $x\in L$ to $a\open(x) = \bigl(a\bimpl(x\meet a)\bigr) = (a\bimpl x)$.%
%
\footnote{We can verify directly that $a\open = (a\bimpl\anon)$ is a~nucleus:
it is ascending and increasing;
it is idempotent, $\bigl(a\bimpl(a\bimpl x)\bigr) = \bigl((a\meet a)\bimpl x) = (a\bimpl x)$;
it preserves binary meets, $\bigl(a\bimpl(x\meet y)\bigr) = (a\bimpl x)\meet(a\bimpl y)$.}
%
The nucleus $a\open$ is called the~\notion{open nucleus} associated with~$a$;
the corresponding nuclear system is $a\open(L)=(a\bimpl L)$.
The restriction of the mapping $g_a$ to $\ldown a\to(a\bimpl L)$
is an isomorphism of posets and hence of frames.

A~nucleus $\gamma$ on~$L$,
	and the corresponding nuclear system~$\gamma(L)=\Fix(\gamma)$, % in~$L$,
are said to be~\notion{fitted},
if~$\gamma$ is a~join of open nuclei
	{\large(}with the join taken in the complete lattice~$\Nuc(L)${\large)}.\linebreak[3]
We shall denote by $\FitNuc\tinysp(L)$ the set of all fitted nuclei on~$L$,
and by $\FitNucSys(L)$ the set of all fitted nuclear systems
(that is,~fitted quotient frames)~on~$L$.
Subposet $\FitNuc\tinysp(L)$ of $\Nuc(L)$ is a~complete lattice
because it is evidently closed under joins~in~$\Nuc(L)$.%
%
\footnote{Actually, $\FitNuc\tinysp(L)$ is a~subframe of $\Nuc(L)$,
that is,~it is also closed under finite meets,
since $\bot\!\open\colon x\mapsto\top$ is the greatest nucleus,
and $a\open\!\meet b\open = (a\join b)\open$ for all $a,\,b\in L$.}\linebreak[3]
%
Correspondingly, the subposet $\FitNucSys(L)$ of $\NucSys(L)$ is a~complete lattice;
it~is closed~under meets in~$\NucSys(L)$,
and since meets in~$\NucSys(L)$ are intersections,
$\FitNucSys(L)$ is a~closure system in~$\Pow{\negtinysp L}$.

Below any nucleus $\gamma\in\Nuc(L)$
there exists the greatest fitted nucleus ${\gamma\tinysp}^\fitit\in\FitNuc\tinysp(L)$:
${\gamma\tinysp}^\fitit$ is simply the join of all open nuclei below~$\gamma\tinysp$.
The~mapping $\gamma\mapsto{\gamma\tinysp}^\fitit$ is an interior operator on~$\Nuc(L)$;
it is fittingly called the~\notion{fitting} of nuclei on~$L\tinysp$.

\txtskip

Given a~nucleus $\gamma$ on~$L$, which open nuclei on~$L$ are below~$\gamma\tinysp$?
Lemma~\ref{lem:open-nucs-below-a-nuc} has the answer.
In the proof of this lemma we are going to use the following
inequality satisfied by an endomap~$f$ on the frame~$L$
	that preserves binary meets, and hence is increasing:
for all $x,\tinysp y\in L$, $f(x\bimpl y)\leq \bigl(f(x)\bimpl\nolinebreak f(y)\bigr)$.
The inequality follows from the inequality between the first and the last expressions in
$f(x)\meet f(x\bimpl y) = f\bigl(x\meet(x\bimpl y)\bigr) \leq f(y)$.

\thmskip

\begin{lemma}\label{lem:open-nucs-below-a-nuc}
Let\/~$L$ be a~frame.
If\/~$a\in L$ and\/~$\gamma\in\Nuc(L)$, then\/~$a\open\leq\gamma$ iff\/ $\gamma(a)=\top$.
\end{lemma}

\interskip

\begin{proof}
If~$a\open\leq\gamma$, then $\top = (a\bimpl a) = a\open(a) \leq \gamma(a)$.
%
Conversely, if $\gamma(a) = \top$,
then for every $x\in L$,
$a\open(x) = (a\bimpl x) \leq \gamma(a\bimpl x) \leq \bigl(\gamma(a)\bimpl\gamma(x)\bigr)
= \bigl(\top\bimpl\gamma(x)\bigr) = \gamma(x)$.
\end{proof}

\thmskip

We can now write down the following formula for the fitting of a nucleus:
%
\begin{equation}\label{eq:fitting-formula}
{\gamma\tinysp}^\fitit \Eq \tJoin\set{a\open\suchthat\gamma(a)=\top}
	\qquad\quad \text{for every \ $\gamma\in\Nuc(L)$}~.
\end{equation}
%

%\vspace{1ex}
\negdisplayshortskip
\thmskip

So far we completely understand one side of the bijection mentioned in Theorem~\ref{thm:HMJ-theorem}.
There is not much left to understand on the other side.
%We have already met Scott-$\tinysp$closed subsets of a~dcpo\,---\,%
%	they are lower sets that are closed under directed joins.
%A~subset of a~dcpo is said to be \notion{Scott-open} if its complement in the dcpo is Scott-$\tinysp$closed.
%A~subset~$U$ of a~dcpo is therefore Scott-open
%\iff\ it is an upper set inaccessible by directed joins,
%where unreachability by directed joins means that
%for any directed subset~$S$ of~the~dcpo,
%$\Join\!S \in U$ implies that some element of $S$ lies in~$U$.

Recall that a~filter of a~poset $P$ is a~downward directed upper set of~$P$.
In~our frame~$L$ a~filter is an upper set closed under finite meets
(including the empty meet, that is,~a~filter always contains~$\top$).
Every~filter $V\negdtinysp$ of~$L$
obeys the \knownas{modus~ponens} rule:
for~all~$a,\,b\in L$,
	if $a\in V\negdtinysp$ and $(a\bimpl b)\in V\negdtinysp$,
	then $b\in V\negdtinysp$ because $b \geq a\meet(a\bimpl b) \in V\negdtinysp$.

For any nucleus $\gamma$ on~$L$,
the set $\gamma^{-1}(\top)$ is a~filter of~$L$;
we~shall call filters of this form \notion{nuclear filters} of~$L$,
and will denote by $\NucFilt(L)$
the poset of all nuclear filters of~$L$ ordered by~inclusion.
Since
%
\begin{equation*}
\bigl(\tMeet\negdtinysp\Gamma\bigr)^{-1}(\top)
    \widedt\Eq \tInters\dtinysp\set{\gamma^{-1}(\top)\suchthat \gamma\in\Gamma}
    \qquad\quad \text{for every \ $\Gamma\subseteq\Nuc(L)$}
\end{equation*}
%
(recall that all meets of nuclei are calculated pointwise),
it follows that $\NucFilt(L)$ is a~closure system in~$\Pow{\negtinysp L}\tinysp$.
Indeed, given a~set $\coll{V}$ of nuclear filters,
let $\Gamma$ be the set of all nuclei $\gamma$ such that $\gamma^{-1}(\top)\in\coll{V}$.
Since every filter in $\coll{V}$ is of the form $\gamma^{-1}(\top)$
for some nucleus $\gamma$ in $\Gamma$,
the intersection
$\Inters\negdtinysp\coll{V}
	= \Inters_{\gamma\in\Gamma}\gamma^{-1}(\top)
	= (\Meet\negdtinysp\Gamma)^{-1}(\top)$
is a~nuclear filter.

By definition, a~Scott-open subset of a poset is an upper set inaccessible by directed joins.
Since every~filter is an upper set by definition,
a~filter is Scott-open \iff\ it is inaccessible by directed joins.

\txtskip

We have everything ready to relate compact fitted quotient frames to Scott-open filters.
The following lemma is Lemma~4.4 in~Escard\'{o}~\cite{escardo},
which in turn is Lemma~3.4(i) in~Johnstone~\cite{johnstoneViet};
its proof is almost verbatim as in~Escard\'{o}~\cite{escardo},
which in turn is lifted from~Johnstone~\cite{johnstoneViet}.
Anyway, this lemma is not very deep,
it is an~immediate consequence
	of the relationship between joins in a~frame and joins in a~quotient frame of~the~frame.

\thmskip

\begin{lemma}\label{lem:compact-qr-vs-scottopen-nf}
Let\/ $\gamma$ be a nucleus on a frame\/~$L$.
Then the quotient frame\/ $\gamma(L)$ is compact
\iff\ the nuclear filter\/ $\gamma^{-1}(\top)$ is Scott-open.
\end{lemma}

\interskip

\begin{proof}
($\implies$)\, Suppose $\gamma(L)$ is compact,
and let $S\subseteq L$ be directed with $\Join\!S \in \gamma^{-1}(\top)$.
Since $\Join^{\tinysp\gamma}\!\gamma(S) = \gamma\bigl(\Join\!S\bigr) = \top$ and $\gamma(L)$ is compact,
there is some $s\in S$ with $\gamma(s) = \top$, that is,~with $s\in\gamma^{-1}(\top)$.

($\isimplied$)\, Suppose $\gamma^{-1}(\top)$ is Scott-open,
and let $S\subseteq\gamma(L)$ be directed with $\Join^{\tinysp\gamma}\!S = \top$.
Since $\Join^{\tinysp\gamma}\!S = \gamma\bigl(\Join\!S\bigr)$, we have $\Join\!S\in\gamma^{-1}(\top)$,
and since $\gamma^{-1}(\top)$ is Scott-open,
there is some $s\in S$ such that $s\in\gamma^{-1}(\top)$,
that is, such that $s = \gamma(s) = \top$.
\end{proof}

\thmskip

The fitting of nuclei, the interior operator $\gamma\mapsto\gamma^\fitit$ on $\Nuc(L)$,
is a~counit of a~certain (covariant) Galois connection, which we now proceed to describe.

For~every $\gamma\in\Nuc(L)$ put $\oneker\negtinysp\gamma := \gamma^{-1}(\top)$,
and for every $S\in\Pow{\negtinysp L}$ put $\fitnuc\tinysp S := \Join_{\!s\in S}s\open$.
For any $\gamma\in\Nuc(L)$ and any $S\in\Pow{\negtinysp L}$
the chain of equivalences
%	(the second equivalence holds by Lemma~\ref{lem:open-nucs-below-a-nuc})
%
\begin{align*}
\qquad\qquad\qquad
\fitnuc\tinysp S \Leq \gamma
    & \wide\Isequiv (\forall s\narr\in S)(s\open\leq\gamma) \\[0.5ex]
    & \wide\Isequiv (\forall s\narr\in S)(\gamma(s) = \top)
		&& \text{(by Lemma~\ref{lem:open-nucs-below-a-nuc})}
							\qquad\qquad \\[0.5ex]
    & \wide\Isequiv S\Subseteq\oneker\negtinysp\gamma
\end{align*}
%
shows that $\pair{\fitnuc,\negdtinysp\oneker}$
	is a~Galois connection $\Pow{\negtinysp L}\galoisconn\Nuc(L)\tinysp$.
By our definitions, $\fitnuc\tinysp\Pow{\negtinysp L}$
	is the~set $\FitNuc\tinysp(L)$ of all fitted nuclei on~$L$,
while $\oneker\negtinysp\Nuc(L)$ is the set $\NucFilt(L)$ of all nuclear filters of~$L$.
From the general properties of Galois connections it at once follows that
%$\fitnuc\negtinysp\oneker\colon \gamma\mapsto\gamma^\fitit$ is an interior operator on~$\Nuc(L)$
$\fitnuc\negtinysp\oneker$ is an interior operator on~$\Nuc(L)$
and that for any~nucleus $\gamma$,
$\fitnuc\negtinysp\oneker\negtinysp\gamma = \gamma^\fitit$ (see~\ref{eq:fitting-formula})
	is the greatest fitted nucleus below~$\gamma$
		(all~of~which we already know),
while on the other side,
$\dtinysp\nucfilt \defeq \oneker\negtinysp\fitnuc$ 
	is a~closure operator on~$\Pow{\negtinysp L}\tinysp$,
where for any subset~$S$~of~$L$,
$\dtinysp\nucfilt(S)$ is the least nuclear filter of~$L$ that contains~$S$.
We~have the identities $\oneker\negtinysp\fitnuc\negtinysp\oneker = \oneker$
and $\fitnuc\negtinysp\oneker\negtinysp\fitnuc = \fitnuc$,
meaning, respectively, that
$\bigl(\gamma^\fitit\bigr)^{-1}(\top) = \gamma^{-1}(\top)$ for every $\gamma\in\Nuc(L)$
and that
%$\Join_{\!s\in\nucfilt(S)}s\open = \Join_{\!s\in S}s\open$ for every $S\subseteq L$.
$\Join\dtinysp\set{s\open\negtinysp\narrdt\suchthat s\narrt\in\nucfilt(S)}
	= \Join\dtinysp\set{s\open\negtinysp\narrdt\suchthat s\narrt\in S}$
for every $S\subseteq L$.
And, restricting $\fitnuc$ to $\NucFilt(L)\to\FitNuc\tinysp(L)$
and $\oneker$ to $\FitNuc\tinysp(L)\to\NucFilt(L)$,
we obtain two isomorphisms of complete lattices which are inverses to each other.

\txtskip

At last, here comes the punch line\,---\,or should it be the~punch lemma?

The following lemma is Lemma 3.4(ii) in Johnstone~\cite{johnstoneViet},
reappearing as Lemma~4.3(2) in~Escard\'o~\cite{escardo}.
We~give a~short and simple proof, which uses the obverse induction principle
	instead of ordinals and transfinite induction in~Johnstone~\cite{johnstoneViet},
	and instead of the join induction principle in~Escard\'o~\cite{escardo}.

\pagebreak[3]
\thmskip

\begin{lemma}\label{lem:scott-open-filter-is-nuclear}
Every Scott-open filter of a~frame\/ $L$ is nuclear.
\end{lemma}

\interskip

\begin{proof}
Let $V\negdtinysp$ be a~Scott-open filter of a~frame $L$,
and let
	$\gamma = \fitnuc\negtinysp V\negdtinysp 
		= \Join\dtinysp\set{v\open\negdtinysp\suchthat v\in V}\tinysp$.
The filter $V$, being Scott open, is inaccessible by directed joins.
If $v\in V\negdtinysp$, and $x\in L$ is such that $v\open(x) = (v\bimpl x) \in V$,
then~$x\in V$ by modus ponens, which means that~$V\negdtinysp$
is inversely closed under~$\set{v\open\suchthat v\in V}$.
By~the~obverse induction principle, $V$~is~inversely closed under~$\gamma$,
so certainly
$\nucfilt(V)
	= \oneker\negtinysp\gamma
	= \gamma^{-1}(\top) \subseteq V\negdtinysp$.
Since also $V\negdtinysp\subseteq\nucfilt(V)$,
we see that $V\negdtinysp=\nucfilt(V)$ is a~nuclear~filter.
\end{proof}

\thmskip

After all the preparations,
Theorem~\ref{thm:HMJ-theorem} is easy to prove.

\thmskip

\begin{proof}[Proof of Theorem~\ref{thm:HMJ-theorem}.]
Let~$\coll{F}$ be the poset of all Scott-open filters of~$L$ ordered by inclusion,
let $\coll{Q}$ be the subposet of $\FitNucSys(L)$
	consisting of all compact fitted quotient frames on~$L$,
and let $\coll{G}$ be the subposet of $\FitNuc(L)$
	consisting of all nuclei $\gamma$ on~$L$ such that $\gamma(\negtinysp P)\in\coll{Q}\dtinysp$.
Now Lemma~\ref{lem:scott-open-filter-is-nuclear} and Lemma~\ref{lem:compact-qr-vs-scottopen-nf}
tell us that $\coll{F}$ is a~subposet of $\NucFilt(L)$
and that the~isomorphisms of complete lattices
%
\begin{equation*}
\NucFilt(L) \longto \FitNuc(L) \longto \FitNucSys(L)^\op
	\wide: V \longmapsto \fitnuc\negtinysp V \longmapsto (\fitnuc\negtinysp V)(L)
\end{equation*}
%
restrict to isomorphism of posets $\coll{F} \to \coll{G} \to \coll{Q}^\op$.
\end{proof}


%----------------------------------------------------------------------------------------------------
\section{Doing it with maximal elements}
\label{sec:do-it-with-max-elems}

Let $P$ be a~dcpo.
Since the poset $\ClSys(\negtinysp P)$ of all closure systems in~$P$
	is a~closure system in $\Pow\negtinysp P\negtinysp$,
it is determined by a~set of closure rules on~$P\negtinysp$.
One such set of closure rules is, of course, the full-fledged closure theory
consisting of all closure rules obeyed by~$\ClSys(\negtinysp P)\tinysp$.
But this closure theory is too large;
we want some smaller set of closure rules
	that determines the closure system $\ClSys(\negtinysp P)\tinysp$,
and moreover,
we want a~set of closure rules
	which can be described in terms of the structure of the dcpo~$P\negtinysp$.

We shall obtain a~suitable set of closure rules using the approach
	in~Francesco Ranzato's paper~\cite{ranzato}.
We~will not follow the exposition in the paper;
our treatment will be more streamlined,	and we will obtain some results that are not in the paper.

\txtskip

A~\notion{default closure rule} associated with a~poset~$P$ %, ordered~by~$\leq\tinysp$,
is a~closure rule $B\negdtinysp\adjoins{}c$ on the set~$P$
	(that is, $B\subseteq P$ and $c\in P\tinysp$)
where $c$ is a~maximal lower bound of~$B$.
We shall denote by $\Rulesdflt(\negtinysp P)$
	the set of all default closure rules associated with a poset~$P\negtinysp$.
We shall write $B\negdtinysp\adjoins{\dflt}c$
	to mean that $B\negdtinysp\adjoins{}c$ is a~default closure rule,
that is, that $\Rulesdflt(\negtinysp P)\colon B\negdtinysp\adjoins{}c\tinysp$.

\txtskip

A~default closure rule can be reflexive (which means that it has~$c\in B\tinysp$).
A~default closure rule $B\negdtinysp\adjoins{}c$ is reflexive
\iff\ $c$ is the least element of~$B$.
In~more detail:
if~$B\negdtinysp\adjoins{}c$ is a~default closure rule and~$c\in B$,
	then $c$~is the least element of~$B\tinysp$;
if~$B$ has a~least element~$c\tinysp$,
	then $B\negdtinysp\adjoins{}c$ is the unique default closure rule with~the~body~$B$.

\thmskip

\begin{lemma}\label{lem:f-preclosure-on-P=>Fix(f)-obeys-Rdf(P)}
If\/ $f$ is a~preclosure map on a~poset\/~$P\negtinysp$,
	then\/ $\Fix(f)$ obeys\/~$\Rulesdflt(\negtinysp P)$.
\end{lemma}

\interskip

\begin{proof}
Let $B\negdtinysp\adjoins{\dflt}c$ with $B\subseteq\Fix(f)\tinysp$.
For any $b\in B$ we have $f(c)\leq f(b) = b$, thus $f(c)$~is a~lower bound of~$B$.
Since $c\leq f(c)$ and $c$ is a~maximal lower bound of~$B$,
it~follows that~$f(c)=c\in\Fix(f)\tinysp$.
\end{proof}

%!

\thmskip

Let $P$ be a~poset.

We~shall say that $P$ \notion{has a~ceiling}
if for every element~$x$ of~$P$ there exists a~maximal element~$y$ of~$P$
	such that~$x\leq y\tinysp$.
%In other words, $P$ has a~ceiling
%	\iff\ every element of~$P$ is below some maximal element of~$P\negtinysp$.
We shall say that a~subset~$A$ of~$P$ has a~ceiling
	if the subposet~$A$ of~$P$ has a~ceiling.
Mark that the empty poset has a~ceiling.

We shall say that $P$ is \notion{default-enabled}
if for every subset $X$ of $P$ the set of all lower bounds of $X$ in $P$ has a~ceiling
	(that is, every lower bound of $X$ is below some maximal lower bound of~$X\tinysp$).%
%
\footnote{A~default-enabled poset is in~Ranzato~\cite{ranzato}
called a~\knownas{relatively maximal lower bound complete} poset,
which is rather a~mothful, so Ranzato shortens it to \knownas{rmlb$\tinysp$-complete} poset,
which is not very mnemonic.}
%
If $P$ is default enabled, then in particular the set $P$ itself,
	which is the set of all lower bounds of the empty subset,
has a~ceiling.

\txtskip

The following lemma tells us that a~default-enabled poset
	has enough default closure rules associated with it
to determine the closure systems in the poset.

\thmskip

\begin{lemma}\label{lem:dflt-enabled-P-has-enough-dflt-clrules}
Let\/ $P$ be a~default-enabled poset.
If a~subset\/~$C$ of\/~$P$ obeys\/~$\Rulesdflt(\negtinysp P)$,
	then\/ $C$~is a~closure system in\/~$P\negtinysp$.
\end{lemma}

\interskip

\begin{proof}
Let $x$ be an arbitrary element of~$P\tinysp$;
it suffices to prove that the set $B\defeq\allabove{C}{x}$ has a~least element.
The~ele\-ment~$x$ is a~lower bound of~$B$,
thus $x\leq u$ for some maximal lower bound of $B$ because $P$ is default-enabled.
Then $B\negdtinysp\adjoins{\dflt}u\dtinysp$,
therefore $u\in C$ because $C$ obeys $\Rulesdflt(\negtinysp P)\tinysp$,
whence $u\in\allabove{C}{x} = B$ is the least element of~$B$.
\end{proof}

\thmskip

The proofs of Lemma~\ref{lem:f-preclosure-on-P=>Fix(f)-obeys-Rdf(P)}
	and Lemma~\ref{lem:dflt-enabled-P-has-enough-dflt-clrules}
correspond to the two parts of the proof of Theorem~4.4 in~Ranzato~\cite{ranzato}
(where Lemma~\ref{lem:f-preclosure-on-P=>Fix(f)-obeys-Rdf(P)}
	is slightly more general than the first part of Theorem~4.4).

\thmskip

We have the following consequence of
	Lemma~\ref{lem:f-preclosure-on-P=>Fix(f)-obeys-Rdf(P)}
		and Lemma~\ref{lem:dflt-enabled-P-has-enough-dflt-clrules}:

\thmskip

\begin{proposition}\label{prop:P-dflt-enabled=>ClSys(P)-clsys-in-Pow(P)-etc}
Let\/ $P$ be a~default-enabled poset.
A~subset of\/ $P$ is a~closure system~in\/~$P$ \iff\ it obeys\/~$\Rulesdflt(\negtinysp P)$.
Consequently, the family\/~$\ClSys(\negtinysp P)$ of all closure systems in\/~$P$
is a~closure system in\/~$\Pow\negdtinysp P\negtinysp$,
%	{\rm(}that is, it is closed under arbitrary intersections{\rm)},
and so is itself a~complete lattice in which all meets are intersections.
Also the poset\/~$\Cl(\negtinysp P)$ of all closure operators on\/~$P\negtinysp$,
being antiisomorphic to the poset\/~$\ClSys(\negtinysp P)$,
	is a~complete lattice.
\end{proposition}

\thmskip

We~want to cook up for default-enabled posets a~theorem
	that would resemble Theorem~\ref{thm:in-dcpo-cl-generd-by-precls-&-induct} for dcpos.
With this aim in mind we introduce the following notion:

\txtskip

Let us say that a~subset $A$ of a~poset $P$ is \notion{default-enabled within~$P$}
if it satisfies the following two conditions:
%
\begin{items}{{\rm(ii)}\:}
\item[{\rm(i)}\:] the~subposet~$A$ is default-enabled;
\item[{\rm(ii)}\:] for~every~$x\in P$ the set $\allbelow{A}{x}$ has a~ceiling.
\end{items}%
%
\pagebreak[3]
\noindent The condition~(i) is a~property of the structure of the subposet $A$ alone,
	independent of the rest of the structure of the `ambient' poset~$P\negtinysp$,
while the condition~(ii) prescribes how the subposet $A$ has to `sit' inside the poset~$P\negtinysp$.

\txtskip

And here is the theorem mimicking Theorem~\ref{thm:in-dcpo-cl-generd-by-precls-&-induct};
with it we wander beyond~Ranzato~\cite{ranzato}.

\thmskip

\begin{theorem}\label{thm:in-dfltenab-cl-generd-by-precls-&-induct}
Let\/ $P$ be a~default-enabled poset,
and let\/ $G$ be a~set of preclosure maps on\/~$P\negtinysp$.
The set\/~$\Fix(\leftt G)$ is a~closure system in\/~$P\negtinysp$,
and the closure operator\/~$\overbar{G}$ on\/~$P$
	which has\/~$\Fix\bigl(\overbar{G}\dtinysp\bigr)=\Fix(\leftt G)$
is the least closure operator on $P$ that is above\/~$G$.

The following {\bfseries induction principle} holds:
if a~subset\/~$A$ of\/~$P$ is default-enabled within\/~$P$ and is closed under\/~$G$,
then it is closed under\/~$\overbar{G}\tinysp$.
\end{theorem}

\interskip

\begin{proof}
For every $g\in G$ the fixpoint set $\Fix(g)$ obeys $\Rulesdflt(\negtinysp P)$
	by Lemma~\ref{lem:f-preclosure-on-P=>Fix(f)-obeys-Rdf(P)} ,
thus $\Fix(g)\in\ClSys(\negtinysp P)$ by Lemma~\ref{lem:dflt-enabled-P-has-enough-dflt-clrules}.
Since $\ClSys(\negtinysp P)$ is closed under arbitrary intersections,
	by~Proposition~\ref{prop:P-dflt-enabled=>ClSys(P)-clsys-in-Pow(P)-etc},
the set $\Fix(\leftt G)=\Inters_{g\in G}\Fix(g)$ is~a~closure system,
so~there exists a~(unique) closure operator~$h$ on~$P$ which has $\Fix(h)=\Fix(\leftt G)$.
If~$g\in G$, then $h(\negtinysp P)=\Fix(h)\subseteq\Fix(g)$,
	whence $g(x)\leq g(h(x)) = h(x)$ for every~$x\in P\tinysp$;
it~follows that~$h\geq G$.
Let $k$ be a~closure operator $\geq G$.
For every $g\in G$ we have $gk=k\tinysp$.
Therefore $\Fix(k)=k(\negtinysp P)\subseteq\Fix(g)$ for every $g\in G\tinysp$;
but then $\Fix(k)\subseteq\Fix(\leftt G)=\Fix(h)$, which means that $k\geq h\tinysp$.
The closure operator $\overbar{G}\defeq h$
	has the properties stated in the theorem.

\emph{The induction principle.}

Assume that $A\subseteq P$ is default-enabled within~$P$ and closed under~$G$.

Let $G_{\negdtinysp A}$ be the set of restrictions
	$g_{\negtinysp A}\colon A\to A$ of the maps~$g\in G$.
We obtained a~set~$G_{\negdtinysp A}$ of preclosure maps on a~default-enabled subposet~$A\tinysp$,
thus there is (by the first part of the proof above, applied to the poset~$A\tinysp$)
a~closure operator $\hpr$ on~$A$ such that $\Fix(\hpr)=\Fix(G_{\negdtinysp A})$,
where $\Fix(G_{\negdtinysp A}) = A\inters\Fix(\leftt G) = A\inters\Fix(h)\subseteq\Fix(h)$.
If~$a\in A\tinysp$, then~$a\leq\hpr(a)\in\Fix(\hpr)=\Fix(G_{\negdtinysp A})\subseteq\Fix(h)$,
thus $h(a)\leq h(\hpr(a))=\hpr(a)$.

We shall prove that for every $a\in A$ also $h(a)\geq\hpr(a)$,
and then we will be able to conclude that $h(a)=\hpr(a)\in A\tinysp$.

So let $a\in A\tinysp$.
By assumption $\allbelow{A}{h(a)}$ has a~ceiling.
Since $a\in \allbelow{A}{h(a)}\tinysp$,
there exists in $\allbelow{A}{h(a)}$ a~maximal element $\apr$ such that $a\leq\apr$.
For every $g\in G$ we have $g(\apr)\leq g(h(a))=h(a)$ and $g(\apr)\in A\tinysp$,
thus $g(\apr)\in \allbelow{A}{h(a)}\tinysp$;
now since $\apr\leq g(\apr)$ and $\apr$~is maximal in $\allbelow{A}{h(a)}\tinysp$,
it follows that $g(\apr)=\apr$.
Thus we have $a\leq\apr$ in~$A\tinysp$,
where $\apr$~is fixed by~$g_{\negtinysp A}$ for every $g\in G$,
therefore $\apr$ is fixed by~$\hpr$,
and it follows that $\hpr(a)\leq\hpr(\apr)=\apr\leq h(a)$.
\end{proof}

\thmskip

Every dcpo is a~default-enabled poset.
First, every nonempty dcpo has a~maximal element, by Zorn's lemma.
Next, if~$P$~is a~dcpo and $x$~is any element of~$P\negtinysp$,
then the principal filter~$\lup x$ is a~sub-dcpo of~$P$
and hence has a~maximal element which is also a~maximal element of~$P\dtinysp$;
it~follows that $P$~has a~ceiling.
Finally, if $X$ is any subset of a~dcpo~$P\negtinysp$,
then the set of all lower bounds of~$X$ in~$P$ is a~sub-dcpo of~$P\negtinysp$,
thus it has a~ceiling,
and we see that $P$~is default-enabled.

Suppose that a~subset $A$ of a~dcpo $P$ is closed under directed joins in~$P\negtinysp$.
If~$x$~is any element of~$A$,
then $\allbelow{A}{x} = A \inters \ldown x$
	is the intersection of two sub-dcpos of~$P\negtinysp$,
thus it is a~sub-dcpo of~$P\negtinysp$,
so~it~has a~ceiling.
The sub-dcpo~$A$ is default-enabled within~$P\negtinysp$.

Theorem~\ref{thm:in-dfltenab-cl-generd-by-precls-&-induct}
therefore specializes to Theorem~\ref{thm:in-dcpo-cl-generd-by-precls-&-induct},
but we need the axiom of choice to do this.
We~in fact cannot do the specialization without invoking the axiom of choice,
since it is not hard to prove that the assertion
	that every dcpo has a~ceiling,
	and hence that every nonempty dcpo has a~maximal element,
implies the axiom of choice
	(in~the~theory of sets without the axiom of choice).

Luckily we do not need the help of the axiom of choice
	in order to specialize Theorem~\ref{thm:in-dfltenab-cl-generd-by-precls-&-induct}
		to Theorem~\ref{thm:in-dcpo-cl-generd-by-precls-&-induct},
since we already proved the latter theorem on its own.

\txtskip

The obvious question to ask at this point is
whether the class of default-enabled posets is strictly larger than the class of dcpos.
The answer is yes, it is strictly larger: the~poset~$P_2$ in Figure~\ref{fig:dfltenabd-post-not-dcpo}
%
\begin{figure}[!htp]\centering
\vspace{1ex}
\includegraphics[draft=false]{mp/closure-induction-2.mps}
\vspace{.5ex}
\caption{A default-enabled poset which is not a dcpo.}
\label{fig:dfltenabd-post-not-dcpo}
\end{figure}
%
	(reproduced from~Ranzato~\cite{ranzato})
is default-enabled while it is not a~dcpo.
This poset $P_2$, though it answers the question in the affirmative,
is not very exciting, since the only closure operator on it is the identity map.
Here is a~challenge: describe a~class of \emph{interesting} default-enabled posets
that are far~from~being~dcpos%
%
\footnote{Which means no cheap tricks.
For example, we can stand the poset $P_2$ on top of any dcpo
and obtain a~default-enabled poset which is not a~dcpo\,---\,%
but such a~poset is as uninteresting as is the poset~$P_2\tinysp$.}
%
and whose complete lattices of closure operators are quite nontrivial.

\pagebreak[3]
\txtskip

Now we are going to travel farther beyond~Ranzato~\cite{ranzato}.
Let $P$ be a~meet-semilattice.

For any two elements $a$ and $b$ of $P$
we define the set $(a\astbimpl b) \defeq \set{x\in P\suchthat x\narrt\meet a\leq b}$,
and then define the set $(a\dotbimpl b)$
	as the set of all maximal elements of the set~$(a\astbimpl b)$.
Note that the set $(a\astbimpl b)$ is always nonempty as it contains the element~$b\dtinysp$;
however, $(a\astbimpl b)$ may not have any maximal elements,
	so the set $(a\dotbimpl b)$ may be empty.

A~\notion{nuclear closure rule} associated with~$P$ is a~unary closure rule $b\adjoins{}c\tinysp$,
where $c\in(a\dotbimpl b)$ for some~$a\in P$.
The set of all nuclear closure rules on $P$ shall be denoted by~$\Rulesnuc(\negtinysp P)$.
We shall write $b\adjoins{\nuc}c$
	to mean that the closure rule $b\adjoins{}c$ is nuclear;
that~is, $b\adjoins{\nuc}c$ is synonymous with $\Rulesnuc(\negtinysp P)\colon b\adjoins{\nuc}c$.
A~subset~$X$ of~$P$ obeys~$\Rulesnuc(\negtinysp P)$
	\iff\ $(a\dotbimpl x)\subseteq X$ for all~$a\in P$ and all~$x\in X$.

\thmskip

\begin{lemma}\label{lem:Fix(prenuc)-obeys-nuclear-rules}
If\/ $\gamma$ is a~prenucleus on a~meet-semilattice\/~$P$,
	then\/ $\Fix(\gamma)$ obeys\/~$\Rulesnuc(\negtinysp P)$.
\end{lemma}

\interskip

\begin{proof}
Suppose that $b\adjoins{\nuc}c$ with $b\in\Fix(\gamma)\dtinysp$;
	we shall prove that $c\in\Fix(\gamma)$.
There exists $a\in P$ such that $c\in(a\dotbimpl b)$.
Since $c\meet a\leq b$ and $\gamma(b)=b\tinysp$, we have
%
\begin{equation*}
\gamma(c)\meet a
	\Leq \gamma(c)\meet\gamma(a)
	\Eq \gamma(c\narrt\meet a)
	\Leq \gamma(b)
	\Eq b~,
\end{equation*}
%
thus $\gamma(c)\in(a\astbimpl b)$.
Since $c\leq\gamma(c)$ and $c$ is maximal in $(a\astbimpl b)$, we have $\gamma(c)=c\tinysp$.
\end{proof}

\thmskip

A~sort of strong converse of Lemma~\ref{lem:Fix(prenuc)-obeys-nuclear-rules} holds
if for all elements $a$, $b$ of a~meet-semi\-lattice~$P$
	the set $(a\astbimpl b)$ has a~ceiling.

\thmskip

\begin{lemma}\label{lem:enough-nucrules-clop-obeys-nucrules=>clop-is-nuc}
Let\/ $P$ be a~meet-semilattice in which every set $(a\astbimpl b)$ with\/~$a,\tinysp b\in P$
	has~a~ceiling.
Let\/~$\gamma$~be a~closure operator on\/~$P$.
If\/~$(a\dotbimpl b)\subseteq\Fix(\gamma)$ for~all\/~$a\in P$ and all\/~$b\in\Fix(\gamma)$,
then\/ $\gamma$ preserves binary meets, that is, it is a~nucleus.
\end{lemma}

\interskip

\begin{proof}
Let $a,\tinysp b\in P$.
The inequality $\gamma(a)\meet\gamma(b)\geq\gamma(a\narrt\meet b)$ holds
	since $\gamma$ is increasing.
For the converse inequality
it suffices to prove the inequality $a\meet\gamma(b)\leq\gamma(a\narrt\meet b)$.%
%
\footnote{$\tinysp$Then
$\gamma(a)\meet\gamma(b)
	\leq \gamma(\gamma(a)\meet b)
	\leq \gamma(\gamma(a\narrt\meet b))
	= \gamma(a\narrt\meet b)$.}
%
Since $a\meet b\leq \gamma(a\narrt\meet b)$,
	$b$ lies in $\bigl(a\astbimpl\gamma(a\narrt\meet b)\bigr)$.
Since $\bigl(a\astbimpl\gamma(a\narrt\meet b)\bigr)$ has a~ceiling,
there exists $c\in\negdtinysp \bigl(a\dotbimpl\gamma(a\narrt\meet b)\bigr)$
	such that $b\leq c\tinysp$.
Since $\gamma(a\narrt\meet b)\in\Fix(\gamma)$,
it follows from our assumption about $\Fix(\gamma)$ that $c\in\Fix(\gamma)$,
therefore $\gamma(b) \leq \gamma(c) = c\tinysp$,
and we conclude that $a\meet\gamma(b) \leq a\meet c \leq \gamma(a\narrt\meet b)$.
\end{proof}

\thmskip

Let us say that a meet-semilattice $P$ is \notion{nuclear-enabled}
if it is default-enabled and every set $(a\astbimpl b)$ with $a,\tinysp b\in P$ has a~ceiling.
The following proposition is a~consequence of Lemma~\ref{lem:Fix(prenuc)-obeys-nuclear-rules}
and Lemma~\ref{lem:enough-nucrules-clop-obeys-nucrules=>clop-is-nuc}.

\thmskip

\begin{proposition}\label{prop:nuc-enab-meet-semilatt}
If\/ $P$ is a~nuclear-enabled meet-semilattice,
then\/ $\NucSys(\negtinysp P)$ is a~closure system in\/ $\Pow\negtinysp P$
	determined by the set of closure rules\/ $\Rulesdflt(\negtinysp P)\union\Rulesnuc(\negtinysp P)\tinysp$.
\end{proposition}

\thmskip

Let $P$ be a~nuclear-enabled meet-semilattice.

The poset $\NucSys(\negtinysp P)$, %(ordered by inclusion),
	being a~closure system in the complete lattice $\Pow\negtinysp P$,
is a~complete lattice; it is also a~closure system in the complete lattice $\ClSys(\negtinysp P)$.
The meets in $\NucSys(\negtinysp P)$, as well as in $\ClSys(\negtinysp P)$, are intersections.
Correspondingly, $\Nuc(\negtinysp P)$ is an interior system in~$\Cl(\negtinysp P)$,
	and hence is a~complete lattice with joins inherited
		from the complete lattice~$\Cl(\negtinysp P)\dtinysp$:
for every subset $\Gamma$ of $\Nuc(\negtinysp P)$ the join $\tJoin\negtinysp\Gamma$,
	taken in $\Cl(\negtinysp P)$,
is~a~nucleus, therefore is a~join of $\Gamma$ in $\Nuc(\negtinysp P)\tinysp$;
moreover, $\Fix(\tinysp\tJoin\negtinysp\Gamma)=\Inters_{\tinysp\gamma\in\Gamma}\Fix(\gamma)$
by the~antiisomorphism between $\Cl(\negtinysp P)$ and $\ClSys(\negtinysp P)$.

Let $\Gamma\subseteq\Nuc(\negtinysp P)$,
	and set $\coll{C}\defeq\bigset{\Fix(\gamma)\bigsuchthat\gamma\narrt\in\Gamma}$.
The join of $\coll{C}$ in $\NucSys(\negtinysp P)$ is $B\defeq\nucsys(\tUnion\coll{C})$,
where $\nucsys=\nucsys_P$ is the closure operator on $\Pow\negtinysp P$
	determined by the closure rules $\Rulesdflt(\negtinysp P)\union\Rulesnuc(\negtinysp P)\tinysp$.
If $\beta$ is the meet of $\Gamma$ in $\Nuc(\negtinysp P)$, then $\Fix(\beta)\narrt=B$.

The nonempty finite meets in $\Cl(\negtinysp P)$ as well as in $\Nuc(\negtinysp P)$ are calculated pointwise.
If~$P$~has a~top element~$\top$,
then the constant map $P\to P : x\mapsto \top$
is the top element of both $\Cl(\negtinysp P)$ and $\Nuc(\negtinysp P)$.
If $P$ does not have a~top element,
then the top element of $\Nuc(\negtinysp P)$ may be different (thus strictly smaller)
	than the top element of $\Cl(\negtinysp P)$.

\thmskip

\begin{proposition}\label{prop:nuc-enab-meet-semilatt--nuc-generd-by-prenucs}
Let\/ $P$ be a~nuclear-enabled meet-semilattice, and let\/~$\Gamma$ be a~set of prenuclei on~$P$.
The closure operator\/~$\chi$ on\/~$P$ which has\/~$\Fix(\chi)=\Fix(\Gamma)\tinysp$,
	the least closure operator on\/ $P$ that is above\/~$\Gamma$,
is a~nucleus.
\end{proposition}

\interskip

\begin{proof}
For every $\gamma\in\Gamma$ the set $\Fix(\gamma)$ obeys $\Rulesnuc(\negtinysp P)$
	by Lemma~\ref{lem:Fix(prenuc)-obeys-nuclear-rules},
therefore $\Fix(\Gamma)=\tInters_{\tinysp\gamma\in\Gamma}\Fix(\gamma)$ obeys $\Rulesnuc(\negtinysp P)$.
By Lemma~\ref{lem:enough-nucrules-clop-obeys-nucrules=>clop-is-nuc}
	the closure operator $\chi$ preserves binary meets, that is, its is a~nucleus.
By Theorem~\ref{thm:in-dfltenab-cl-generd-by-precls-&-induct}
	the closure operator $\chi$ is the least closure operator on $P$ that is above~$\Gamma$.
\end{proof}

\thmskip

The following proposition is a~do-it-by-maximal-elements analogue
	of Proposition~\ref{prop:frame-of-nuclei-on-preframe}.

\thmskip

\begin{proposition}\label{prop:when-Nuc(meet-semilatt)-is-a-frame}
If\/ $P$ is a~default-enabled meet-semilattice,
and for all\/ $a,\tinysp b\in P$
	the set\/~$(a\astbimpl b)$ is default-enabled within~$P$
		{\rm(}so it certainly has a~ceiling\/{\rm)},
then the complete lattice\/~$\Nuc(\negtinysp P)$ is a~frame.
\end{proposition}

\interskip

\begin{proof}
We shall prove that for all $\beta\in\Nuc(\negtinysp P)$ and all $\Gamma\subseteq\Nuc(\negtinysp P)$
the following identity holds:
%
\begin{equation*}
\beta\meet\tJoin\Gamma \Eq \tJoin_{\!\gamma\in\Gamma}(\beta\meet\gamma)~.
\end{equation*}
%
The inequality $\geq$ is clear, so it remains to prove the converse inequality~$\leq\dtinysp$.
We~write $\delta\defeq\tJoin\Gamma$
	and $\deltapr\defeq\tJoin{\!\gamma\in\Gamma}(\beta\meet\gamma)\tinysp$.
We have to prove that
%
\begin{equation*}
\beta(x)\meet\delta(x) \Eq (\beta\narrt\meet\delta)(x) \Leq \deltapr(x)
	\qquad\quad \text{for every $x\in P$}
\end{equation*}
%
(recall that finite meets in $\Nuc(\negtinysp P)$ are calculated pointwise).
Let $A \defeq \bigl(\beta(x)\astbimpl\deltapr(x)\bigr)
	= \bigset{z\narrdt\in P\bigsuchthat \beta(x)\meet z\leq\deltapr(x)}\tinysp$.
Clearly $x\in A$, and $A$ is by assumption default-enabled within~$P$.
We~prove that the set $A$ is closed under $\Gamma$
precisely as we did in the proof of Proposition~\ref{prop:frame-of-nuclei-on-preframe}.
By the induction principle,
	formulated in Theorem~\ref{thm:in-dfltenab-cl-generd-by-precls-&-induct},
it follows that $A$ is closed under $\delta$, and hence that $\delta(x)\in A$,
which means that $\beta(x)\meet\delta(x)\leq\deltapr(x)\tinysp$.
\end{proof}

\thmskip

The last two propositions above specialize to propositions about preframes
since in a~preframe every set of the form $(a\astbimpl b)$ is a~subdcpo
	(in~fact it is a~Scott-closed subset)
and as such it is default-enabled within the preframe.
The act of specialization requires the use of the axiom of choice,
so we are lucky, again, that we have already proved the specialized propositions.


%----------------------------------------------------------------------------------------------------
\section{Two convex geometries associated with a dcpo}
\label{sec:conv-geoms-assoc-with-dcpo}

A~\notion{convex geometry} is a~structure $\pair{E,\gamma}$
where $E$ is a~set and $\gamma$ is a~\notion{convex} closure operator on~$\PowE$,
which means that $\gamma$ satisfies the following \notion{anti-exchange axiom}:
\begin{items}{(AE)\:}
\item[(AE)\:] For every subset $A$ of $E$ and all elements $x$, $y$ of $E\tinysp$,\\
	if $x,\tinysp y\notin \gamma(A)$ and $x\neq y$
		and $x\in\gamma(A\narrt\union\set{y})\tinysp$,
	then $y\notin\gamma(A\narrt\union\set{x})\tinysp$.
\end{items}%
%
\pagebreak[3]
\noindent The anti-exchange axiom is equivalent to the following condition:
%
\begin{items}{(CAS)\:}
\item[(CAS)\:] For every $\gamma$-closed subset $C$ of $E$ and all elements $x$, $y$ of $E\tinysp$,\\
	if $x,\tinysp y\notin C$
		and $\gamma(C\narrt\union\set{y})=\gamma(C\narrt\union\set{x})$,
	then~$x=y\tinysp$.
\end{items}%
%
\noindent Let $\gamma$ be an arbitrary~closure operator on $\PowE\tinysp$.
For every subset~$A$ of~$E$,
the closure operator $\gamma$ induces the preorder  $\leq_A$ on the set $E\narrdt\setdiff A$,
	where $x\narrt{\leq_A}y$ iff $x\in\gamma(A\narrt\union\set{y})$.
The~condition~(CAS) requires that for every $\gamma$-closed subset~$C$ of~$E$
	the preorder $\leq_C$ is~anti\-symmetric, that is, that it is a~partial order.

\txtskip

The following proposition is the main result of this section.
It generalizes Proposition~5-5.1 in~LT-STA-2~\cite{LT-STA-2}.
It will be proved in due time.

\thmskip

\begin{proposition}\label{prop:dcpo-P==>(P,clsysP)-(P,dcclsysP)-convex-geoms}
If\/ $P$ is a~dcpo,
then\/ $\pair{P,\dtinysp\clsys_P}$ and\/ $\pair{P,\dtinysp\dcclsys_P}$ are convex geometries.
\end{proposition}

\thmskip

We start with some very general observations.

\thmskip

\begin{lemma}\label{lem:clsys-C-lowset-A==>clsys-CunionA}
Let\/ $P$ be a~poset.
If\/~$C$ is a~closure system in\/~$P$ and\/~$A$ is a~lower set of\/~$P$,
then\/~$C\union A$ is a~closure system in\/~$P$.
\end{lemma}

\interskip

\begin{proof}
Let $\gamma$ be the closure operator on $P$ with $\Fix(\gamma)=C$.
We define the endomapping $\gamma^{\tinysp A}$ on $P$ by
%
\begin{equation*}
\gamma^{\rightt A}(x) \Defeq
	\begin{cases}
	\,x & \text{if $x\in A$}\,, \\[.25ex]
	\,\gamma(x) & \text{otherwise}\,.
	\end{cases}
\end{equation*}
%
It is clear that $\gamma^{\tinysp A}$ is ascending and idempotent.
Let $x\leq y$ in~$P\tinysp$;
	we shall prove that $\gamma^{\rightt A}(x) \leq \gamma^{\rightt A}(y)\tinysp$.
This is clear if $x\notin A$ or $y\in A$.
Suppose that $x\in A$ and $y\notin A\tinysp$;
then $\gamma^{\rightt A}(x) = x \leq y \leq \gamma(y) = \gamma^{\rightt A}(y)\tinysp$.
Thus $\gamma^{\leftt A}$ is a~closure operator on~$P$.
Since $\Fix(\gamma^{\tinysp A}) = C\union A\tinysp$, we are done.
\end{proof}

\thmskip

\begin{lemma}\label{lem:clsys-dirclsd-C-fingen-lowset-A=>clsys-dirclsd-CunionA}
Let\/ $P$ be a~poset.
If\/ $C$~is a~closure system in\/~$P$
	that is closed under existing directed joins in\/~$P$,
and\/ $A$~is a~finitely generated lower set of\/~$P$,
then\/ $C\union A$~is a~closure system in\/~$P$
	that is closed under existing directed joins in\/~$P$.
\end{lemma}

\thmskip

The set $C\union A$ is a~closure system
	by Lemma~\ref{lem:clsys-C-lowset-A==>clsys-CunionA}.
It remains to prove that $C\union A$ is closed under existing directed joins.
Since $A$ is a~union of finitely many principal ideals,
and every principal ideal is closed under all existing joins
	hence under all existing directed joins,
the desired result is a~consequence of the following lemma.

\thmskip

\begin{lemma}\label{lem:union-of-two-diclsd-sets-is-dirclsd}
If subsets\/ $A$ and\/ $B$ of a~poset\/~$P$
	are closed under existing directed joins in\/~$P$,
then the subset\/ $A\union B$ is closed under existing directed joins in\/~$P$.
\end{lemma}

\interskip

\begin{proof}
Let a~directed subset $Y$ of $A\union B$ have a~join~$u$ in~$P$.
We consider two cases.

Case~1: $Y\inters A$ is a~cofinal subset of~$Y$.
The set $Y\inters A$ has the same upper bounds in~$P$ as the set $Y$,
thus the join $u$ of $Y$ in $P$ is also the join of $Y\inters A$ in $P$.
Since $Y\inters A$ is a~directed subset of $A$ and $A$ is closed under existing directed joins,
we have $u\in A\tinysp$.

Case~2: $Y\inters A$ is not a~cofinal subset of~$Y$.
There exists $b\in Y$ such that the set $\allabove{Y\negdtinysp}{b}$ is disjoint with $A$
and is, therefore, contained in~$B$.
Since $\allabove{Y\negdtinysp}{b}$ is a~cofinal subset of $Y$ it follows that $u\in B$.
\end{proof}

\thmskip

\begin{proposition}\label{prop:ClSys(P)-clsys-in-PowP=>clsysP-satisfies-(CAS)}
Let\/ $P$ be a~poset.
If\/ $\ClSys(\negtinysp P)$ is a~closure system in\/~$\Pow\negtinysp P$,
then $\pair{P,\dtinysp\clsys_P}$ is a~convex geometry.
\end{proposition}

\interskip

\begin{proof}
Let $C$ be a~closure system in $P$,
and suppose that $x,\tinysp y\in P$ are not in $C$ and that
    $\clsys_P\bigl(C\narrt\union\set{y}\bigr)
	= \clsys_P\bigl(C\narrt\union\set{x}\bigr)\tinysp$.
The set $C\union\ldown y$ is,
	according to Lemma~\ref{lem:clsys-C-lowset-A==>clsys-CunionA},
		a~closure system,
	and it contains $C\union\set{y}\tinysp$,
thus it contains $\widedt{\clsys_P\bigl(C\narrt\union\set{y}\bigr)}$.
Now~from
    $x\narrt\in\clsys_P\bigl(C\narrt\union\set{y}\bigr)
	\narrt\subseteq C\union\ldown y$
and $x\narrt\notin C$ it follows that $x\narrt\in\ldown y$,
	that~is, that~$x\leq y\tinysp$.
Likewise we see that $y\leq x$, and we conclude that $x=y\tinysp$.
The closure operator $\widedt{\clsys_P}$ on $\Pow\negtinysp P$ satisfies the condition~(CAS).
\end{proof}

\thmskip

Let $P$ be a~poset.

We denote by $\DcClSys(\negtinysp P)$ the subposet of $\Pow\negtinysp P$
consisting of all closure systems~in~$P$ that are closed under existing directed joins in~$P$
		(shorter: are directed-closed in~$P$).
This extends the notation $\DcClSys(\negtinysp P)$ for a~dcpo~$P$
	introduced in section~\ref{sec:Scottcont-clopers-on-dcpo}.

Suppose that $\ClSys(\negtinysp P)$ is a~closure system in~$\Pow\negtinysp P$.
Then $\DcClSys(\negtinysp P)$ is a~closure system in~$\Pow\negtinysp P$, too.
Indeed, if $\coll{C}$ is any set of directed-closed closure systems in~$P$,
then the intersection $\tInters\coll{C}$ is a~closure system by assumption,
and it is also directed-closed.
Therefore, for every subset $X$ of~$P$
there exists not only
    the least closure system $\widedt{\clsys(X)}$ that contains $X$
	(this one by assumption),
but there exists also
    the least directed-closed closure system $\widedt{\dcclsys(X)}$ that contains~$X$.

\thmskip

\begin{proposition}\label{prop:ClSys(P)-clsys-in-PowP=>dcclsysP-satisfies-(CAS)}
Let\/ $P$ be a~poset.
If\/ $\ClSys(\negtinysp P)$ is a~closure system in\/~$\Pow\negtinysp P$,
then $\pair{P,\dtinysp\dcclsys_P}$ is a~convex geometry.
\end{proposition}

\thmskip

The proof is the same
	as that of Proposition~\ref{prop:ClSys(P)-clsys-in-PowP=>clsysP-satisfies-(CAS)},
except that it uses Lemma~\ref{lem:clsys-dirclsd-C-fingen-lowset-A=>clsys-dirclsd-CunionA}
	instead of Lemma~\ref{lem:clsys-C-lowset-A==>clsys-CunionA}.

\thmskip

\begin{proof}[Proof of Proposition~\ref{prop:dcpo-P==>(P,clsysP)-(P,dcclsysP)-convex-geoms}.]
As $P$ is a~dcpo, $\ClSys(\negtinysp P)$ is a~closure system in $\Pow\negtinysp P$.
Now~apply Proposition~\ref{prop:ClSys(P)-clsys-in-PowP=>clsysP-satisfies-(CAS)}
	and Proposition~\ref{prop:ClSys(P)-clsys-in-PowP=>dcclsysP-satisfies-(CAS)}.
\end{proof}

\thmskip

The following proposition has essentially the same proof
	as Proposition~\ref{prop:dcpo-P==>(P,clsysP)-(P,dcclsysP)-convex-geoms}.

\thmskip

\begin{proposition}\label{prop:P-dfltenab-==>(P,clsysP)-(P,dcclsysP)-convex-geoms}
If\/ $P$ is a~default-enabled poset,
then\/ $\pair{P,\dtinysp\clsys_P}$ and\/ $\pair{P,\dtinysp\dcclsys_P}$ are convex geometries.
\end{proposition}

\thmskip

We are not done yet.
For a~dcpo $P\negtinysp$, the closure operator $\widedt{\clsys_P}$ is convex for a~reason,
the reason being that this closure operator is \emph{acyclic}.
Below we give the definition of acyclic closure operators,
but only after the definition of a~funnel for a~closure operator.

\txtskip

Let $E$ be a~set and $\gamma$ a~closure operator on $\PowE\tinysp$.

We shall say that a~preorder $\leq$ on $E$
	is a~\notion{funnel for} the closure operator~$\gamma$,
or that $\gamma$~\notion{has a~funnel}~$\leq\dtinysp$,
if for every $X\subseteq E$ and every $y\in\gamma(X)$
there exists a~subset~$Z$ of~$X$ such that $y\leq Z$ and $y\in\gamma(Z)\tinysp$.
Mark that a~preorder~$\leq$ on~$E$ is a~funnel for~$\gamma$
iff for every $X\subseteq E$ and every $y\in\gamma(X)$
	it follows that $y\in\gamma(\allabove{X\negdtinysp}{y})\tinysp$.

We shall say that the closure operator $\gamma$ is \notion{acyclic}
if it has an~antisymmetric funnel, that is, a~funnel which is a~partial order on~$E\tinysp$.

\thmskip

\begin{proposition}\label{prop:properts-equiv-to-<=-beig-funnel-for-clop}
Let\/ $E$ be a~set,
	$\gamma$ a~closure operator on\/~$\Pow\negdtinysp E\tinysp$,
	and\/ $\leq$ a~preorder on\/~$E\tinysp$.
The following are equivalent:
%
\begin{items}{{\rm(1)}\:}
\item[{\rm(1)}\:] $\leq$~is a~funnel for\/~$\gamma\dtinysp$;
\item[{\rm(2)}\:] for all\/ $X,\tinysp U\negdtinysp\subseteq E\tinysp$,
	if\/ $U$~is an upper set of~$\pair{E,{\leq}\tinysp}\tinysp$,
	then\/ $\gamma(X)\inters U\subseteq\gamma(X\narrt\inters U)\dtinysp$;
\item[{\rm(3)}\:] for all $X\subseteq E$ and all $y\in E$ we have
	$\allabove{\gamma(X)}{y} \subseteq \gamma(\allabove{X}{y})\tinysp$.
\end{items}%
%
\end{proposition}

\negdisplayhalfskip
\interskip

\begin{proof}
(1)$\Implies$(2).\,
Assume~(1), and let $X,\tinysp U\subseteq E$ with~$U$ an upper set of~$\pair{E,{\leq}\tinysp}\tinysp$.
Let~$u\in\gamma(X)\inters U$ and write $Z\defeq\allabove{X\negdtinysp}{u}\tinysp$.
Then $Z\subseteq U$ because $U$ is an upper set,
	and~$u\in\gamma(Z)$ since $\leq$ is a~funnel for~$\gamma\tinysp$,
thus $Z\subseteq X\inters U$ and $u\in\gamma(Z)\subseteq\gamma(X\narrt\inters U)\tinysp$.

(2)$\Implies$(3) holds by specialization ($\widet{U\leftt=\lup y}$).

(3)$\Implies$(1).\,
Assuming (3), suppose that $y\in\gamma(X)$;
then $y\in \allabove{\gamma(X)}{y} \widet\subseteq \gamma(\allabove{X\negdtinysp}{y})$.
\end{proof}

\thmskip
\pagebreak[3]

And why are acyclic closure operators so interesting?
This is why:

\thmskip

\begin{proposition}\label{prop:generd-Lemma8-3.23-in-LT-STA-2}
Let\/ $E$ be a~set, $\leq$ a~partial order on\/~$E\tinysp$,
	and\/ $\gamma$ a~closure operator on\/~$\PowE\tinysp$.
If\/~$\leq$ is a~funnel for\/~$\gamma\tinysp$, then the following statements are true:
%
\begin{items}{{\rm(ii)}\:}
\item[{\rm(i)}\:] For all\/ $A\subseteq E$ and all\/ $x,\tinysp y\in E$,
	if\/ $x\notin\gamma(A)$ and\/ $x\in \gamma(A\narrt\union\set{y})$,
	then\/ $x\leq y\tinysp$.
\item[{\rm(ii)}\:] The closure operator\/ $\gamma$ is convex.
\end{items}%
%
\end{proposition}

\negdisplayhalfskip
\interskip

\begin{proof}
(i)\, Assume that $A$, $x$, $y$ satisfy the premises.
Since $x\in\gamma(A\narrt\union\set{y})$ and~$\leq$~is a~fun\-nel for~$\gamma\tinysp$,
it follows that $x\in\gamma\bigl(\allabove{(A\narrt\union\set{y})}{x}\bigr)\tinysp$.
Now the set $\allabove{(A\narrt\union\set{y})}{x}$ must contain~$y$ 
since~otherwise we would have $\allabove{(A\narrt\union\set{y})}{x} = \allabove{A}{x}$
	and $x\in\gamma(\allabove{A}{x})\subseteq\gamma(A)\tinysp$,
contrary to assumptions.
That~is,~we~have~$x\leq y\tinysp$.

(ii)\, For every $\gamma$-closed $C\subseteq P$
	and for all $x,\tinysp y\in P\narrt\setdiff C$,
if $\gamma(C\narrt\union\set{x})=\gamma(C\narrt\union\set{y})\tinysp$,
then by part (i) it follows that $x\leq y$ and $y\leq x$, whence $x=y\tinysp$.
The closure operator $\gamma$ satisfies the condition~(CAS).
\end{proof}

\thmskip

Proposition~\ref{prop:generd-Lemma8-3.23-in-LT-STA-2} generalizes
	Lemma~8-3.23 in~LT-STA-2~\cite{LT-STA-2},
from algebraic closure operators of poset type to arbitrary acyclic closure operators.%
%
\footnote{Mark that the partial order in Proposition~\ref{prop:generd-Lemma8-3.23-in-LT-STA-2}
is opposite to the partial order in Lemma~8-3.23.}
%
The proof of the proposition is \emph{not} completely modeled after the proof of Lemma~8-3.23,
since the latter proof uses Lemma~8-3.2
	which provides a~useful consequence of algebraicity of the closure operator,
and the proof above has no use (and no need) for such a~lemma.

\thmskip

\begin{proposition}\label{prop:ClSys(P)-clsys-in-PowP=>clsysP-is-acyclic}
Let\/ $P$ be a~poset.
If\/ $\ClSys(\negtinysp P)$ is a~closure system in\/~$\Pow\negtinysp P$,
then the partial order of\/~$P$ is a~funnel for the closure operator\/~$\clsys_P$,
which is therefore~acyclic.
\end{proposition}

\interskip

\begin{proof}
Let $X\subseteq P$ and $y\in\clsys_P(X)\dtinysp$;
we have to prove that $y\in\clsys_P(\allabove{X\negdtinysp}{y})\tinysp$.

The set $\dtinysp\clsys_P(\allabove{X\negdtinysp}{y})
				\union(P\narrt\setdiff\narrt\lup y)$
    is by Lemma~\ref{lem:clsys-C-lowset-A==>clsys-CunionA}
	a~closure system in~$P\tinysp$;
it~contains the set~$X$,
so it contains the closure system $\widedt{\clsys_P(X)}$
	and hence contains the element~$y\dtinysp$;
since $y\notin P\narrdt\setdiff\lup y$,
we conclude that $y\in\clsys_P(\allabove{X\negdtinysp}{y})\tinysp$.
\end{proof}

\thmskip

\begin{corollary}\label{cor:P-dcpo-or-dfltenab==>clsysP-acyclic}
If\/ $P$ is a~dcpo or a~default-enabled poset,
%then the closure operator\/ $\clsys_P$ on $\Pow\negtinysp P$ is acyclic.
then\/ $\widedt{\clsys_P}$ is acyclic.
\end{corollary}

\thmskip

Therefore, if $P$ is a~dcpo or a~default-enabled poset,
then the closure operator $\widedt{\clsys_P}$ on $\Pow\negtinysp P$
is convex \emph{because} it is acyclic,
	in view of Proposition~\ref{prop:generd-Lemma8-3.23-in-LT-STA-2}.
This proves again the first halves of
	Proposition~\ref{prop:dcpo-P==>(P,clsysP)-(P,dcclsysP)-convex-geoms}
	and Proposition~\ref{prop:P-dfltenab-==>(P,clsysP)-(P,dcclsysP)-convex-geoms};
but the original direct proofs of those halves were markedly simpler,
so one can be excused for not seeing the point
	of the new proofs that go the roundabout way through acyclicity.
However, Corollary~\ref{cor:P-dcpo-or-dfltenab==>clsysP-acyclic} is of independent interest.
For example, the part of the corollary about default-enabled posets
is the special case of Lemma~4.3 in Ranzato~\cite{ranzato} for a~default-enabled poset,
which (\ie, the special case) is then used in the proof of Theorem~5.2 in~\cite{ranzato}.

%\newpage

%----------------------------------------------------------------------------------------------------
\begin{thebibliography}{9}

\bibitem{escardo} M.\:H.\:Escard\'o,	% Mart\'\i{}n H\"otzel Escard\'o
	``\href{http://www.cs.bham.ac.uk/~mhe/papers/hmj.pdf}%
		{Joins in the frame of nuclei}''.
	\textit{Applied Categorical Structures}, Springer (formerly Kluwer), volume~11, number~2,
	pp.~117--124, April~2003.

\bibitem{CLaD} Gerhard Gierz, Karl H.\;Hofmann, Klaus Keimel, Jimmy D.\;Lawson,
	Michael Mislove, and Dana S.\;Scott,
	\textit{Continuous Lattices and Domains}.
	Encyclopedia of Mathematics and its Applications, Vol.\;93,
	Cambridge University Press, Cambridge, 2003.

\bibitem{LT-STA-2} George Gr\"atzer, Friedrich Wehrung, Editors,
	\textit{Lattice Theory: Special Topics and Applications}, Volume~2.
	Birkh\"auser, 2016.

\bibitem{johnstoneSS} Peter T.\:Johnstone,
	\textit{Stone spaces}.
	Cambridge University Press, 1982.

\bibitem{johnstoneViet} P.\:T.\:Johnstone,
	``Vietoris locales and localic semilattices''.
	In~\textit{Continuous lattices and their applications {\rm(}Bremen, 1982\/{\rm)}}, pp.~155--180.
	Dekker, New York, 1985.

\bibitem{markowsky} George Markowsky,
	``\href{http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.454.7687&rep=rep1&type=pdf}%
		{Chain-complete posets and directed sets with applications}''.
	Algebra Universalis~6 (1976), pp.~53--68, Birkh\"auser Verlag, Basel.

\bibitem{ranzato} Francesco Ranzato,
	``\href{http://www.math.unipd.it/~ranzato/papers/ic99.pdf}%
		{Closures on CPOs Form Complete Lattices}''.
	Information and Computation 152, 236--249 (1999).

\end{thebibliography}
%----------------------------------------------------------------------------------------------------


\end{document}
%====================================================================================================
