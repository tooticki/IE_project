<!DOCTYPE html><html>
<head>
<title></title>
<style type="text/css">
<!--
.xflip {
    -moz-transform: scaleX(-1);
    -webkit-transform: scaleX(-1);
    -o-transform: scaleX(-1);
    transform: scaleX(-1);
    filter: fliph;
}
.yflip {
    -moz-transform: scaleY(-1);
    -webkit-transform: scaleY(-1);
    -o-transform: scaleY(-1);
    transform: scaleY(-1);
    filter: flipv;
}
.xyflip {
    -moz-transform: scaleX(-1) scaleY(-1);
    -webkit-transform: scaleX(-1) scaleY(-1);
    -o-transform: scaleX(-1) scaleY(-1);
    transform: scaleX(-1) scaleY(-1);
    filter: fliph + flipv;
}
-->
</style>
</head>
<body>
<a name=1></a><img class="yflip" src="html/1610.01521-1_1.png"/><br/>
Supersaturation&#160;in&#160;Posets&#160;and&#160;Applications&#160;Involving&#160;the<br/>
Container&#160;Method<br/>
Jonathan&#160;A.&#160;Noel1,&#160;2<br/>
Alex&#160;Scott3<br/>
Benny&#160;Sudakov1<br/>
Abstract<br/>
We&#160;consider&#160;‘supersaturation’&#160;problems&#160;in&#160;partially&#160;ordered&#160;sets&#160;(posets)&#160;of&#160;the&#160;fol-<br/>
lowing&#160;form.&#160;Given&#160;a&#160;finite&#160;poset&#160;P&#160;and&#160;an&#160;integer&#160;m&#160;greater&#160;than&#160;the&#160;cardinality&#160;of&#160;the<br/>largest&#160;antichain&#160;in&#160;P&#160;,&#160;what&#160;is&#160;the&#160;minimum&#160;number&#160;of&#160;comparable&#160;pairs&#160;in&#160;a&#160;subset&#160;of<br/>P&#160;of&#160;cardinality&#160;m?&#160;We&#160;provide&#160;a&#160;framework&#160;for&#160;obtaining&#160;lower&#160;bounds&#160;on&#160;this&#160;quantity<br/>based&#160;on&#160;counting&#160;comparable&#160;pairs&#160;relative&#160;to&#160;a&#160;random&#160;chain&#160;and&#160;apply&#160;this&#160;framework<br/>to&#160;obtain&#160;supersaturation&#160;results&#160;for&#160;three&#160;classical&#160;posets:&#160;the&#160;boolean&#160;lattice,&#160;the&#160;collec-<br/>tion&#160;of&#160;subspaces&#160;of&#160;Fn&#160;ordered&#160;by&#160;set&#160;inclusion&#160;and&#160;the&#160;set&#160;of&#160;divisors&#160;of&#160;the&#160;square&#160;of&#160;a<br/>
q<br/>
square-free&#160;integer&#160;under&#160;the&#160;‘divides’&#160;relation.&#160;The&#160;bound&#160;that&#160;we&#160;obtain&#160;for&#160;the&#160;boolean<br/>lattice&#160;can&#160;be&#160;viewed&#160;as&#160;an&#160;approximate&#160;version&#160;of&#160;a&#160;known&#160;theorem&#160;of&#160;Kleitman&#160;<a href="1610.01521s.html#31">[23].</a><br/>
In&#160;addition,&#160;we&#160;apply&#160;our&#160;supersaturation&#160;results&#160;to&#160;obtain&#160;(a)&#160;upper&#160;bounds&#160;on&#160;the<br/>
number&#160;of&#160;antichains&#160;in&#160;these&#160;posets&#160;and&#160;(b)&#160;asymptotic&#160;bounds&#160;on&#160;the&#160;cardinality&#160;of&#160;the<br/>largest&#160;antichain&#160;in&#160;p-random&#160;subsets&#160;of&#160;these&#160;posets&#160;which&#160;hold&#160;with&#160;high&#160;probability<br/>(for&#160;p&#160;in&#160;a&#160;certain&#160;range).&#160;The&#160;proofs&#160;of&#160;these&#160;results&#160;rely&#160;on&#160;a&#160;‘container-type’&#160;lemma<br/>for&#160;posets&#160;which&#160;generalises&#160;a&#160;result&#160;of&#160;Balogh,&#160;Mycroft&#160;and&#160;Treglown&#160;<a href="1610.01521s.html#30">[6].&#160;</a>We&#160;also&#160;state<br/>a&#160;number&#160;of&#160;open&#160;problems&#160;regarding&#160;supersaturation&#160;in&#160;posets&#160;and&#160;counting&#160;antichains.<br/>
1<br/>
Introduction<br/>
A&#160;large&#160;part&#160;of&#160;extremal&#160;combinatorics&#160;is&#160;concerned&#160;with&#160;determining&#160;the&#160;maximum&#160;size&#160;of&#160;a<br/>combinatorial&#160;object&#160;subject&#160;to&#160;the&#160;constraint&#160;that&#160;it&#160;does&#160;not&#160;contain&#160;a&#160;certain&#160;‘forbidden’<br/>substructure.&#160;One&#160;example&#160;of&#160;such&#160;an&#160;extremal&#160;problem&#160;is&#160;to&#160;determine&#160;the&#160;cardinality&#160;of&#160;the<br/>
<a href="http://arxiv.org/abs/1610.01521v2">arXiv:1610.01521v2 &#160;[math.CO] &#160;27 Aug 2017</a><br/>
largest&#160;subset&#160;of&#160;a&#160;partially&#160;ordered&#160;set&#160;(poset)&#160;P&#160;which&#160;does&#160;not&#160;contain&#160;a&#160;comparable&#160;pair;<br/>i.e.&#160;to&#160;determine&#160;the&#160;cardinality&#160;of&#160;the&#160;largest&#160;antichain.&#160;Perhaps&#160;the&#160;most&#160;famous&#160;result&#160;in<br/>this&#160;area&#160;is&#160;Sperner’s&#160;Theorem&#160;<a href="1610.01521s.html#32">[37]&#160;</a>which&#160;says&#160;that&#160;the&#160;size&#160;of&#160;the&#160;largest&#160;antichain&#160;in&#160;the<br/>boolean&#160;lattice&#160;poset&#160;P(n),&#160;consisting&#160;of&#160;all&#160;subsets&#160;of&#160;[n]&#160;:=&#160;{1,&#160;.&#160;.&#160;.&#160;,&#160;n}&#160;ordered&#160;by&#160;inclusion,<br/>is<br/>
n&#160;.<br/>
⌊n/2⌋<br/>
A&#160;closely&#160;related&#160;problem&#160;is&#160;to&#160;determine&#160;the&#160;minimum&#160;number&#160;of&#160;copies&#160;of&#160;a&#160;particular<br/>
substructure&#160;in&#160;a&#160;combinatorial&#160;object&#160;of&#160;prescribed&#160;size.&#160;These&#160;so&#160;called&#160;‘supersaturation’<br/>problems&#160;have&#160;a&#160;long&#160;history&#160;starting&#160;with&#160;a&#160;result&#160;of&#160;Rademacher&#160;(unpublished,&#160;see&#160;<a href="1610.01521s.html#31">[18]</a>)<br/>which&#160;says&#160;that&#160;every&#160;graph&#160;with&#160;n&#160;vertices&#160;and&#160;more&#160;than&#160;n2/4&#160;edges&#160;must&#160;contain&#160;at<br/>least&#160;⌊n/2⌋&#160;triangles.&#160;For&#160;additional&#160;background&#160;on&#160;supersaturation&#160;problems&#160;in&#160;extremal<br/>combinatorics&#160;see,&#160;e.g.,&#160;<a href="1610.01521s.html#30">[14,&#160;</a><a href="1610.01521s.html#31">29,&#160;30,&#160;</a><a href="1610.01521s.html#32">33,&#160;34]&#160;</a>and&#160;the&#160;references&#160;therein.<br/>
1Department&#160;of&#160;Mathematics,&#160;ETH,&#160;Raemistrasse&#160;101,&#160;HG&#160;G&#160;33.4,&#160;8092&#160;Zurich,&#160;Switzerland.&#160;E-mail:<br/>
{jonathan.noel,benjamin.sudakov}@math.ethz.ch.<br/>
2Part&#160;of&#160;this&#160;work&#160;was&#160;completed&#160;while&#160;the&#160;first&#160;author&#160;was&#160;a&#160;DPhil&#160;student&#160;at&#160;the&#160;University&#160;of&#160;Oxford.<br/>3Mathematical&#160;Institute,&#160;University&#160;of&#160;Oxford,&#160;Andrew&#160;Wiles&#160;Building,&#160;Radcliffe&#160;Observatory&#160;Quarter,<br/>
Woodstock&#160;Road,&#160;Oxford,&#160;OX2&#160;6GG,&#160;UK.&#160;E-mail:&#160;scott@maths.ox.ac.uk.<br/>
1<br/>
<hr/>
<a name=2></a><img class="yflip" src="html/1610.01521-2_1.png"/><br/>
<img class="yflip" src="html/1610.01521-2_2.png"/><br/>
Our&#160;focus&#160;in&#160;this&#160;paper&#160;is&#160;on&#160;a&#160;natural&#160;supersaturation&#160;problem&#160;for&#160;posets:&#160;given&#160;a&#160;finite<br/>
poset&#160;P&#160;and&#160;a&#160;positive&#160;integer&#160;m&#160;≤&#160;|P&#160;|,&#160;what&#160;is&#160;the&#160;minimum&#160;number&#160;of&#160;comparable&#160;pairs&#160;in<br/>a&#160;subset&#160;S&#160;of&#160;P&#160;of&#160;cardinality&#160;m?&#160;An&#160;early&#160;result&#160;in&#160;this&#160;direction&#160;is&#160;due&#160;to&#160;Kleitman&#160;<a href="1610.01521s.html#31">[23]<br/></a>who&#160;proved&#160;that,&#160;for&#160;1&#160;≤&#160;m&#160;≤&#160;2n,&#160;the&#160;number&#160;of&#160;comparable&#160;pairs&#160;in&#160;a&#160;subset&#160;of&#160;P(n)&#160;of<br/>cardinality&#160;m&#160;is&#160;minimised&#160;by&#160;a&#160;collection&#160;of&#160;m&#160;subsets&#160;of&#160;[n]&#160;whose&#160;cardinalities&#160;are&#160;as&#160;close<br/>to&#160;n/2&#160;as&#160;possible.&#160;This&#160;result&#160;strengthens&#160;Sperner’s&#160;Theorem&#160;and&#160;settled&#160;a&#160;conjecture&#160;of<br/>Erd˝os&#160;and&#160;Katona&#160;(see&#160;<a href="1610.01521s.html#30">[10,&#160;13,&#160;</a><a href="1610.01521s.html#31">16]&#160;</a>for&#160;further&#160;results).<br/>
In&#160;this&#160;paper,&#160;we&#160;prove&#160;new&#160;supersaturation&#160;results&#160;for&#160;two&#160;classical&#160;posets&#160;(Theorems&#160;<a href="1610.01521s.html#2">1.2</a><br/>
and&#160;<a href="1610.01521s.html#3">1.4&#160;</a>below).&#160;Our&#160;method&#160;involves&#160;counting&#160;comparisons&#160;relative&#160;to&#160;a&#160;random&#160;chain&#160;and<br/>should&#160;be&#160;applicable&#160;to&#160;posets&#160;beyond&#160;those&#160;covered&#160;in&#160;this&#160;paper.&#160;We&#160;also&#160;illustrate&#160;the<br/>method&#160;by&#160;using&#160;it&#160;to&#160;prove&#160;an&#160;approximate&#160;version&#160;of&#160;the&#160;supersaturation&#160;theorem&#160;of&#160;Kleit-<br/>man&#160;<a href="1610.01521s.html#31">[23]&#160;</a>in&#160;the&#160;boolean&#160;lattice&#160;(Theorem&#160;<a href="1610.01521s.html#6">3.1)</a>.&#160;All&#160;three&#160;of&#160;these&#160;supersaturation&#160;results&#160;will<br/>be&#160;applied&#160;to&#160;prove&#160;bounds&#160;on&#160;the&#160;number&#160;of&#160;antichains&#160;in&#160;these&#160;posets&#160;and&#160;bounds&#160;on&#160;the<br/>size&#160;of&#160;antichains&#160;in&#160;random&#160;subsets&#160;of&#160;these&#160;posets.<br/>
Throughout&#160;the&#160;paper,&#160;for&#160;a&#160;subset&#160;S&#160;of&#160;a&#160;poset&#160;P&#160;,&#160;we&#160;let&#160;comp(S)&#160;denote&#160;the&#160;number&#160;of<br/>
comparable&#160;pairs&#160;in&#160;S.<br/>
Definition&#160;1.1.&#160;Given&#160;a&#160;prime&#160;power&#160;q&#160;and&#160;integers&#160;n&#160;≥&#160;1&#160;let&#160;V&#160;(q,&#160;n)&#160;be&#160;the&#160;poset&#160;of&#160;all<br/>subspaces&#160;of&#160;Fnq&#160;ordered&#160;by&#160;inclusion.&#160;For&#160;an&#160;integer&#160;0&#160;≤&#160;i&#160;≤&#160;n,&#160;the&#160;q-binomial&#160;coefficient<br/>
&#160;n&#160;<br/>
is&#160;the&#160;number&#160;of&#160;subspaces&#160;of&#160;Fn<br/>
i&#160;q<br/>
q&#160;of&#160;dimension&#160;i.<br/>
Elementary&#160;counting&#160;shows&#160;that<br/>
i−1<br/>
h&#160;n&#160;i<br/>
Y&#160;1&#160;−&#160;qn−j<br/>
=<br/>
.<br/>
i&#160;q<br/>
1&#160;−&#160;qj+1<br/>
j=0<br/>
One&#160;may&#160;also&#160;observe&#160;that,&#160;for&#160;fixed&#160;n&#160;and&#160;q,&#160;the&#160;sequence&#160;&#160;n&#160;&#160;,&#160;.&#160;.&#160;.&#160;,&#160;&#160;n&#160;&#160;is&#160;unimodal&#160;and<br/>
0&#160;q<br/>
n&#160;q<br/>
h<br/>
i<br/>
satisfies&#160;&#160;n&#160;&#160;=<br/>
n<br/>
for&#160;all&#160;0<br/>
i<br/>
≤&#160;i&#160;≤&#160;n.&#160;We&#160;prove&#160;the&#160;following&#160;theorem.<br/>
q<br/>
n−i&#160;q<br/>
Theorem&#160;1.2.&#160;Let&#160;q&#160;be&#160;a&#160;prime&#160;power&#160;and&#160;k&#160;be&#160;a&#160;fixed&#160;positive&#160;integer.&#160;There&#160;exists&#160;a<br/>constant&#160;n0(k)&#160;such&#160;that&#160;if&#160;n&#160;≥&#160;n0(k)&#160;and&#160;S&#160;⊆&#160;V&#160;(q,&#160;n)&#160;has&#160;cardinality&#160;at&#160;least<br/>
k−1&#160;<br/>
<br/>
X<br/>
n<br/>
+&#160;t,<br/>
&#160;n−k+1+2r&#160;<br/>
r=0<br/>
2<br/>
q<br/>
then<br/>
&#160;⌈(n&#160;+&#160;k)/2⌉&#160;<br/>
comp(S)&#160;≥&#160;t<br/>
.<br/>
k<br/>
q<br/>
h<br/>
i<br/>
It&#160;is&#160;easy&#160;to&#160;see&#160;that&#160;Theorem&#160;<a href="1610.01521s.html#2">1.2&#160;</a>is&#160;best&#160;possible&#160;when&#160;k&#160;=&#160;1&#160;and&#160;0&#160;≤&#160;t&#160;≤<br/>
n<br/>
⌊(n−1)/2⌋&#160;q<br/>
as&#160;the&#160;set&#160;S&#160;consisting&#160;of&#160;all&#160;subspaces&#160;of&#160;dimension&#160;⌈n/2⌉&#160;and&#160;t&#160;subspaces&#160;of&#160;dimension<br/>
h<br/>
i<br/>
⌊(n&#160;−&#160;1)/2⌋&#160;contains&#160;exactly&#160;t&#160;⌈(n+1)/2⌉<br/>
comparable&#160;pairs.<br/>
1<br/>
q<br/>
Definition&#160;1.3.&#160;Given&#160;n&#160;≥&#160;1,&#160;we&#160;define&#160;a&#160;poset&#160;on&#160;{0,&#160;1,&#160;2}n&#160;where&#160;x&#160;≤&#160;y&#160;if&#160;and&#160;only&#160;if<br/>xj&#160;≤&#160;yj&#160;for&#160;1&#160;≤&#160;j&#160;≤&#160;n,&#160;where&#160;xj&#160;and&#160;yj&#160;are&#160;the&#160;jth&#160;coordinates&#160;of&#160;x&#160;and&#160;y,&#160;respectively.&#160;For<br/>0&#160;≤&#160;i&#160;≤&#160;2n,&#160;let&#160;ℓi(n)&#160;denote&#160;the&#160;number&#160;of&#160;vectors&#160;in&#160;{0,&#160;1,&#160;2}n&#160;whose&#160;coordinates&#160;sum&#160;to&#160;i.<br/>
2<br/>
<hr/>
<a name=3></a><img class="yflip" src="html/1610.01521-3_1.png"/><br/>
<img class="yflip" src="html/1610.01521-3_2.png"/><br/>
<img class="yflip" src="html/1610.01521-3_3.png"/><br/>
<img class="yflip" src="html/1610.01521-3_4.png"/><br/>
<img class="yflip" src="html/1610.01521-3_5.png"/><br/>
<img class="yflip" src="html/1610.01521-3_6.png"/><br/>
<img class="yflip" src="html/1610.01521-3_7.png"/><br/>
<img class="yflip" src="html/1610.01521-3_8.png"/><br/>
The&#160;poset&#160;{0,&#160;1,&#160;2}n&#160;can&#160;also&#160;be&#160;viewed&#160;as&#160;the&#160;poset&#160;of&#160;divisors&#160;of&#160;the&#160;square&#160;of&#160;a&#160;square-<br/>
free&#160;integer&#160;with&#160;n&#160;prime&#160;factors&#160;under&#160;the&#160;‘divides’&#160;relation&#160;or&#160;the&#160;poset&#160;of&#160;all&#160;submultisets<br/>of&#160;a&#160;multiset&#160;consisting&#160;of&#160;n&#160;distinct&#160;elements&#160;each&#160;of&#160;multiplicity&#160;two&#160;under&#160;inclusion.&#160;It&#160;is<br/>easy&#160;to&#160;see&#160;that<br/>
⌊i/2⌋<br/>
<br/>
<br/>
<br/>
X<br/>
n<br/>
i&#160;−&#160;s<br/>
ℓi(n)&#160;=<br/>
.<br/>
i&#160;−&#160;s<br/>
s<br/>
s=max{0,i−n}<br/>
Also,&#160;trivially,&#160;ℓi(n)&#160;=&#160;ℓ2n−i(n)&#160;for&#160;0&#160;≤&#160;i&#160;≤&#160;2n.&#160;A&#160;result&#160;of&#160;de&#160;Bruijn,&#160;van&#160;Ebbenhorst<br/>Tengbergen&#160;and&#160;Kruyswijk&#160;<a href="1610.01521s.html#31">[15]&#160;</a>says&#160;that&#160;{0,&#160;1,&#160;2}n&#160;has&#160;a&#160;‘symmetric&#160;chain&#160;decomposition’&#160;(see<br/><a href="1610.01521s.html#30">[3]&#160;</a>for&#160;details)&#160;which,&#160;in&#160;particular,&#160;implies&#160;that&#160;the&#160;sequence&#160;ℓ0(n),&#160;.&#160;.&#160;.&#160;,&#160;ℓ2n(n)&#160;is&#160;unimodal.<br/>We&#160;prove&#160;the&#160;following&#160;theorem.<br/>
Theorem&#160;1.4.&#160;Let&#160;k&#160;be&#160;a&#160;fixed&#160;positive&#160;integer.&#160;Then&#160;there&#160;exists&#160;a&#160;constant&#160;n0(k)&#160;such&#160;that<br/>if&#160;n&#160;≥&#160;n0(k)&#160;and&#160;S&#160;⊆&#160;{0,&#160;1,&#160;2}n&#160;has&#160;cardinality&#160;at&#160;least<br/>
n+⌈&#160;k−1<br/>
2<br/>
⌉<br/>
X<br/>
ℓr(n)&#160;+&#160;t,<br/>
r=n−⌊&#160;k−1<br/>
2<br/>
⌋<br/>
then<br/>
&#160;ℓ<br/>
<br/>
comp(S)&#160;≥<br/>
3k−1(n)&#160;−&#160;1&#160;t.<br/>
ℓ2k−1(n)<br/>
Note&#160;that&#160;for&#160;k&#160;=&#160;1&#160;we&#160;have&#160;ℓ3k−1(n)&#160;−&#160;1&#160;=&#160;n−1&#160;and,&#160;for&#160;general&#160;k&#160;and&#160;n&#160;large&#160;with&#160;respect<br/>
ℓ2k−1(n)<br/>
2<br/>
to&#160;k,&#160;we&#160;have<br/>
<br/>
ℓ3k−1(n)<br/>
(1&#160;+&#160;o(1)<br/>
n<br/>
(1&#160;+&#160;o(1))(2k&#160;−&#160;1)!nk<br/>
−&#160;1&#160;=<br/>
3k−1<br/>
=<br/>
.<br/>
(1.5)<br/>
ℓ<br/>
n&#160;<br/>
2k−1(n)<br/>
(3k&#160;−&#160;1)!<br/>
2k−1<br/>
In&#160;particular,&#160;for&#160;k&#160;=&#160;1&#160;and&#160;|S|&#160;not&#160;much&#160;larger&#160;than&#160;ℓn(n),&#160;Theorem&#160;<a href="1610.01521s.html#3">1.4&#160;</a>is&#160;nearly&#160;best<br/>possible.&#160;To&#160;see&#160;this,&#160;let&#160;S&#160;=&#160;Sn&#160;∪&#160;Sn+1&#160;where&#160;Sn&#160;contains&#160;all&#160;elements&#160;of&#160;{0,&#160;1,&#160;2}n&#160;whose<br/>coordinates&#160;sum&#160;to&#160;n&#160;and&#160;Sn+1&#160;contains&#160;the&#160;|S|−ℓn(n)&#160;elements&#160;of&#160;{0,&#160;1,&#160;2}n&#160;whose&#160;coordinates<br/>sum&#160;to&#160;n&#160;+&#160;1&#160;and,&#160;subject&#160;to&#160;this,&#160;have&#160;the&#160;minimum&#160;number&#160;of&#160;non-zero&#160;coordinates.<br/>
In&#160;the&#160;past&#160;few&#160;years,&#160;there&#160;has&#160;been&#160;some&#160;considerable&#160;success&#160;in&#160;extending&#160;classical<br/>
results&#160;in&#160;extremal&#160;combinatorics&#160;to&#160;sparse&#160;random&#160;settings&#160;due&#160;to&#160;the&#160;breakthroughs&#160;made<br/>independently&#160;by&#160;Conlon&#160;and&#160;Gowers&#160;<a href="1610.01521s.html#30">[12]&#160;</a>and&#160;Schacht&#160;<a href="1610.01521s.html#32">[36]</a>.&#160;Shortly&#160;thereafter&#160;another,&#160;very<br/>different,&#160;approach&#160;known&#160;as&#160;the&#160;‘container&#160;method’&#160;was&#160;developed&#160;independently&#160;by&#160;Balogh,<br/>Morris&#160;and&#160;Samotij&#160;<a href="1610.01521s.html#30">[5]&#160;</a>and&#160;Saxton&#160;and&#160;Thomason&#160;<a href="1610.01521s.html#32">[35]</a>.&#160;As&#160;was&#160;demonstrated&#160;in&#160;<a href="1610.01521s.html#30">[5,&#160;</a><a href="1610.01521s.html#32">35]</a>,<br/>the&#160;container&#160;method&#160;can&#160;be&#160;used&#160;to&#160;prove&#160;many&#160;of&#160;the&#160;results&#160;of&#160;<a href="1610.01521s.html#30">[12,&#160;</a><a href="1610.01521s.html#32">36]</a>.&#160;Two&#160;advantages<br/>of&#160;the&#160;container&#160;method&#160;are&#160;that&#160;it&#160;is&#160;relatively&#160;straightforward&#160;to&#160;apply&#160;and&#160;that&#160;it&#160;often<br/>provides&#160;‘counting’&#160;results&#160;which&#160;can&#160;be&#160;much&#160;stronger&#160;than&#160;the&#160;corresponding&#160;probabilistic<br/>statements.&#160;Supersaturation&#160;theorems&#160;form&#160;a&#160;key&#160;ingredient&#160;in&#160;most&#160;proofs&#160;involving&#160;the<br/>container&#160;method.&#160;For&#160;instance,&#160;many&#160;of&#160;the&#160;proofs&#160;in&#160;<a href="1610.01521s.html#30">[5,&#160;</a><a href="1610.01521s.html#32">35]&#160;</a>applied&#160;the&#160;classical&#160;graph<br/>supersaturation&#160;theorem&#160;of&#160;Erd˝os&#160;and&#160;Simonovits&#160;<a href="1610.01521s.html#31">[20]</a>.&#160;For&#160;additional&#160;applications&#160;of&#160;the<br/>container&#160;method,&#160;see&#160;<a href="1610.01521s.html#30">[4,&#160;8,&#160;</a><a href="1610.01521s.html#31">31]&#160;</a>and&#160;the&#160;references&#160;therein.<br/>
We&#160;apply&#160;Theorems&#160;<a href="1610.01521s.html#2">1.2&#160;</a>and&#160;<a href="1610.01521s.html#3">1.4&#160;</a>and&#160;the&#160;container&#160;method&#160;to&#160;prove&#160;upper&#160;bounds&#160;on&#160;the<br/>
number&#160;of&#160;antichains&#160;in&#160;V&#160;(q,&#160;n)&#160;and&#160;{0,&#160;1,&#160;2}n&#160;(Theorem&#160;<a href="1610.01521s.html#4">1.6&#160;</a>and&#160;<a href="1610.01521s.html#4">1.7)&#160;</a>and&#160;upper&#160;bounds&#160;on<br/>the&#160;largest&#160;antichains&#160;in&#160;random&#160;subsets&#160;of&#160;these&#160;posets&#160;of&#160;a&#160;certain&#160;density&#160;which&#160;hold&#160;with<br/>high&#160;probability&#160;(Theorems&#160;<a href="1610.01521s.html#4">1.8&#160;</a>and&#160;<a href="1610.01521s.html#4">1.9)</a>.<br/>
3<br/>
<hr/>
<a name=4></a><img class="yflip" src="html/1610.01521-4_1.png"/><br/>
<img class="yflip" src="html/1610.01521-4_2.png"/><br/>
Theorem&#160;1.6.&#160;Let&#160;q&#160;be&#160;a&#160;fixed&#160;prime&#160;power.<br/>
The&#160;number&#160;of&#160;antichains&#160;in&#160;V(q,&#160;n)&#160;is<br/>
(<br/>
i<br/>
1+O(√nq−n/4))h&#160;n<br/>
2<br/>
⌊n/2⌋&#160;q&#160;.<br/>
√<br/>
<br/>
<br/>
<br/>
1+O<br/>
log&#160;n/n<br/>
ℓ<br/>
Theorem&#160;1.7.&#160;The&#160;number&#160;of&#160;antichains&#160;in&#160;{0,&#160;1,&#160;2}n&#160;is&#160;2<br/>
n(n).<br/>
Of&#160;course,&#160;the&#160;number&#160;of&#160;antichains&#160;in&#160;any&#160;poset&#160;P&#160;is&#160;at&#160;least&#160;2&#160;to&#160;the&#160;power&#160;of&#160;the<br/>
cardinality&#160;of&#160;its&#160;largest&#160;antichain,&#160;and&#160;so&#160;Theorems&#160;<a href="1610.01521s.html#4">1.6&#160;</a>and&#160;<a href="1610.01521s.html#4">1.7&#160;</a>are&#160;best&#160;possible&#160;up&#160;to&#160;the<br/>(1&#160;+&#160;o(1))&#160;factor&#160;in&#160;the&#160;exponent.<br/>
Given&#160;a&#160;set&#160;X,&#160;a&#160;p-random&#160;subset&#160;of&#160;X&#160;is&#160;a&#160;subset&#160;of&#160;X&#160;obtained&#160;by&#160;including&#160;each&#160;element<br/>
of&#160;X&#160;with&#160;probability&#160;p&#160;independently&#160;of&#160;one&#160;another.<br/>
Theorem&#160;1.8.&#160;Let&#160;q&#160;be&#160;a&#160;fixed&#160;prime&#160;power&#160;and&#160;ε&#160;&gt;&#160;0.&#160;There&#160;exists&#160;a&#160;positive&#160;constant<br/>c(ε,&#160;q)&#160;such&#160;that&#160;if&#160;p&#160;≥&#160;c(ε,&#160;q)/qn/2,&#160;then&#160;with&#160;high&#160;probability&#160;every&#160;antichain&#160;in&#160;a&#160;p-random<br/>
h<br/>
i<br/>
subset&#160;of&#160;V&#160;(q,&#160;n)&#160;has&#160;cardinality&#160;at&#160;most&#160;(1&#160;+&#160;ε)p<br/>
n<br/>
.<br/>
⌊n/2⌋&#160;q<br/>
Theorem&#160;1.9.&#160;Let&#160;ε&#160;&gt;&#160;0&#160;be&#160;fixed.&#160;There&#160;exists&#160;a&#160;positive&#160;constant&#160;c(ε)&#160;such&#160;that&#160;if&#160;p&#160;≥&#160;c(ε)/n,<br/>then&#160;with&#160;high&#160;probability&#160;every&#160;antichain&#160;in&#160;a&#160;p-random&#160;subset&#160;of&#160;{0,&#160;1,&#160;2}n&#160;has&#160;cardinality<br/>at&#160;most&#160;(1&#160;+&#160;ε)pℓn(n).<br/>
It&#160;is&#160;not&#160;hard&#160;to&#160;see&#160;that&#160;Theorems&#160;<a href="1610.01521s.html#4">1.8&#160;</a>and&#160;<a href="1610.01521s.html#4">1.9&#160;</a>are&#160;best&#160;possible&#160;up&#160;to&#160;the&#160;choice&#160;of&#160;the<br/>
constants&#160;c(ε,&#160;q)&#160;and&#160;c(ε);&#160;this&#160;is&#160;made&#160;explicit&#160;in&#160;Section&#160;<a href="1610.01521s.html#23">6.</a><br/>
In&#160;the&#160;next&#160;section,&#160;we&#160;prove&#160;a&#160;general&#160;lemma&#160;for&#160;obtaining&#160;lower&#160;bounds&#160;on&#160;the&#160;number&#160;of<br/>
comparable&#160;pairs&#160;in&#160;a&#160;subset&#160;S&#160;of&#160;a&#160;poset&#160;P&#160;.&#160;We&#160;provide&#160;a&#160;few&#160;basic&#160;applications&#160;of&#160;this&#160;lemma<br/>in&#160;Section&#160;<a href="1610.01521s.html#6">3&#160;</a>including&#160;a&#160;proof&#160;of&#160;an&#160;approximate&#160;version&#160;of&#160;the&#160;theorem&#160;of&#160;Kleitman&#160;<a href="1610.01521s.html#31">[23]&#160;</a>and<br/>a&#160;proof&#160;of&#160;Theorem&#160;<a href="1610.01521s.html#2">1.2.&#160;</a>In&#160;Section&#160;<a href="1610.01521s.html#9">4,&#160;</a>we&#160;apply&#160;this&#160;lemma&#160;again&#160;to&#160;prove&#160;Theorem&#160;<a href="1610.01521s.html#3">1.4.&#160;</a>In<br/>Section&#160;<a href="1610.01521s.html#20">5&#160;</a>we&#160;prove&#160;a&#160;container-type&#160;lemma&#160;for&#160;posets&#160;which&#160;generalises&#160;a&#160;result&#160;of&#160;<a href="1610.01521s.html#30">[6]&#160;</a>proved<br/>for&#160;the&#160;boolean&#160;lattice.&#160;In&#160;Section&#160;<a href="1610.01521s.html#23">6,&#160;</a>we&#160;use&#160;this&#160;lemma&#160;to&#160;prove&#160;Theorems&#160;<a href="1610.01521s.html#4">1.6,&#160;1.7,&#160;1.8&#160;</a>and&#160;<a href="1610.01521s.html#4">1.9<br/></a>and&#160;a&#160;known&#160;upper&#160;bound&#160;on&#160;the&#160;number&#160;of&#160;antichains&#160;in&#160;the&#160;boolean&#160;lattice&#160;included&#160;for&#160;the<br/>sake&#160;of&#160;demonstration.&#160;Throughout&#160;the&#160;paper,&#160;we&#160;will&#160;require&#160;several&#160;known&#160;bounds&#160;on&#160;&#160;n&#160;<br/>
i&#160;q<br/>
and&#160;ℓi(n)&#160;which&#160;are&#160;stated&#160;in&#160;the&#160;appendix.<br/>
2<br/>
Comparison&#160;Counting&#160;Via&#160;Random&#160;Chains<br/>
Our&#160;general&#160;approach&#160;to&#160;proving&#160;supersaturation&#160;results,&#160;which&#160;was&#160;inspired&#160;by&#160;<a href="1610.01521s.html#30">[13]</a>,&#160;is&#160;to<br/>count&#160;comparable&#160;pairs&#160;in&#160;a&#160;subset&#160;S&#160;of&#160;P&#160;by&#160;considering&#160;the&#160;expected&#160;number&#160;of&#160;such&#160;pairs<br/>in&#160;a&#160;chain&#160;of&#160;P&#160;chosen&#160;randomly&#160;according&#160;to&#160;some&#160;distribution.&#160;One&#160;should&#160;point&#160;out&#160;that<br/>the&#160;general&#160;idea&#160;of&#160;counting&#160;comparable&#160;pairs&#160;relative&#160;to&#160;a&#160;random&#160;chain&#160;goes&#160;back,&#160;in&#160;some<br/>sense,&#160;to&#160;Lubell’s&#160;proof&#160;<a href="1610.01521s.html#31">[28]&#160;</a>of&#160;the&#160;LYM&#160;inequality.&#160;It&#160;was&#160;recently&#160;used&#160;by&#160;Das,&#160;Gan&#160;and<br/>Sudakov&#160;<a href="1610.01521s.html#30">[13]&#160;</a>and&#160;Dove,&#160;Griggs,&#160;Kang&#160;and&#160;Sereni&#160;<a href="1610.01521s.html#31">[16]&#160;</a>to&#160;count&#160;chains&#160;of&#160;length&#160;k&#160;in&#160;subsets<br/>of&#160;P(n)&#160;of&#160;prescribed&#160;cardinality.&#160;In&#160;order&#160;for&#160;this&#160;technique&#160;to&#160;be&#160;effective,&#160;one&#160;requires&#160;a<br/>distribution&#160;on&#160;the&#160;chains&#160;in&#160;P&#160;which&#160;is&#160;sufficiently&#160;‘balanced.’&#160;Roughly&#160;speaking,&#160;what&#160;we<br/>mean&#160;by&#160;this&#160;is&#160;that&#160;a&#160;random&#160;chain&#160;chosen&#160;according&#160;to&#160;this&#160;distribution&#160;is&#160;not&#160;too&#160;unlikely<br/>to&#160;contain&#160;any&#160;fixed&#160;element&#160;of&#160;P&#160;and,&#160;at&#160;the&#160;same&#160;time,&#160;not&#160;too&#160;likely&#160;to&#160;contain&#160;any&#160;fixed<br/>comparable&#160;pair&#160;of&#160;P&#160;.&#160;Our&#160;estimates&#160;will&#160;use&#160;a&#160;lemma&#160;on&#160;random&#160;chains,&#160;for&#160;which&#160;we&#160;require<br/>the&#160;notion&#160;of&#160;a&#160;comparability&#160;digraph.<br/>
Definition&#160;2.1.&#160;Let&#160;P&#160;be&#160;a&#160;poset.&#160;A&#160;comparability&#160;digraph&#160;for&#160;P&#160;is&#160;a&#160;digraph&#160;D&#160;with<br/>V&#160;(D)&#160;=&#160;P&#160;such&#160;that<br/>
4<br/>
<hr/>
<a name=5></a>•&#160;for&#160;every&#160;directed&#160;arc&#160;(x,&#160;y)&#160;of&#160;D,&#160;we&#160;have&#160;that&#160;x&#160;is&#160;comparable&#160;to&#160;y&#160;in&#160;P&#160;,&#160;and<br/>
•&#160;for&#160;every&#160;comparable&#160;pair&#160;x,&#160;y&#160;∈&#160;P&#160;,&#160;exactly&#160;one&#160;of&#160;the&#160;arcs&#160;(x,&#160;y)&#160;or&#160;(y,&#160;x)&#160;is&#160;in&#160;E(D).<br/>
We&#160;remark&#160;that&#160;a&#160;poset&#160;P&#160;can&#160;have&#160;many&#160;comparability&#160;digraphs.&#160;In&#160;particular,&#160;the&#160;fact<br/>
that&#160;a&#160;comparability&#160;digraph&#160;contains&#160;an&#160;arc&#160;from&#160;x&#160;to&#160;y&#160;does&#160;not&#160;determine&#160;which&#160;of&#160;the<br/>relations&#160;x&#160;&lt;&#160;y&#160;or&#160;y&#160;&lt;&#160;x&#160;holds.<br/>
Lemma&#160;2.2.&#160;Let&#160;P&#160;be&#160;a&#160;poset,&#160;let&#160;D&#160;be&#160;a&#160;comparability&#160;digraph&#160;for&#160;P&#160;,&#160;let&#160;µ&#160;be&#160;a&#160;distribution<br/>on&#160;the&#160;chains&#160;of&#160;P&#160;and&#160;let&#160;Cµ&#160;be&#160;a&#160;random&#160;chain&#160;chosen&#160;according&#160;to&#160;µ.&#160;Suppose&#160;further&#160;that<br/>P&#160;(x&#160;∈&#160;Cµ)&#160;&gt;&#160;0&#160;for&#160;every&#160;x&#160;∈&#160;P&#160;.&#160;Then,&#160;for&#160;every&#160;set&#160;S&#160;⊆&#160;P&#160;,&#160;we&#160;have<br/>
<br/>
−1&#160;&#160;<br/>
<br/>
−1!<br/>
comp(S)&#160;≥<br/>
max<br/>
P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)<br/>
|S|&#160;−&#160;min&#160;P&#160;(x&#160;∈&#160;Cµ)<br/>
.<br/>
(x,y)∈E(D)<br/>
x∈P<br/>
Proof.&#160;We&#160;proceed&#160;by&#160;induction&#160;on&#160;|S|&#160;where&#160;the&#160;base&#160;case&#160;|S|&#160;≤&#160;(minx∈P&#160;P&#160;(x&#160;∈&#160;Cµ))−1&#160;is<br/>trivial.&#160;Given&#160;w&#160;∈&#160;S,&#160;we&#160;define&#160;d+(w)&#160;to&#160;be&#160;the&#160;number&#160;of&#160;arcs&#160;(w,&#160;z)<br/>
S<br/>
∈&#160;E(D)&#160;with&#160;z&#160;∈&#160;S.<br/>
Suppose&#160;that&#160;there&#160;exists&#160;w&#160;∈&#160;S&#160;with&#160;d+(w)<br/>
S<br/>
≥&#160;max(x,y)∈E(D)&#160;P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)−1.&#160;In&#160;this<br/>
case,&#160;we&#160;apply&#160;the&#160;inductive&#160;hypothesis&#160;to&#160;S&#160;\&#160;{w}&#160;to&#160;obtain&#160;at&#160;least<br/>
<br/>
−1&#160;&#160;<br/>
<br/>
−1!<br/>
max<br/>
P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)<br/>
|S&#160;\&#160;{w}|&#160;−&#160;min&#160;P&#160;(x&#160;∈&#160;Cµ)<br/>
.<br/>
(x,y)∈E(D)<br/>
x∈P<br/>
comparable&#160;pairs&#160;in&#160;S&#160;which&#160;do&#160;not&#160;involve&#160;w.&#160;We&#160;then&#160;obtain&#160;the&#160;desired&#160;bound&#160;on&#160;comp(S)<br/>by&#160;considering&#160;these&#160;comparable&#160;pairs&#160;along&#160;with&#160;those&#160;of&#160;the&#160;form&#160;(w,&#160;z)&#160;∈&#160;E(D)&#160;with&#160;z&#160;∈&#160;S.<br/>Thus,&#160;we&#160;may&#160;assume&#160;that&#160;every&#160;w&#160;∈&#160;S&#160;satisfies<br/>
<br/>
−1<br/>
d+(w)&#160;&lt;<br/>
max<br/>
.<br/>
(2.3)<br/>
S<br/>
P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)<br/>
(x,y)∈E(D)<br/>
The&#160;chain&#160;C<br/>
<br/>
µ&#160;contains&#160;precisely&#160;|Cµ&#160;∩&#160;S|&#160;elements&#160;of&#160;S&#160;and<br/>
|Cµ∩S|&#160;of&#160;the&#160;comparable&#160;pairs<br/>
2<br/>
of&#160;S&#160;(since&#160;every&#160;pair&#160;in&#160;C<br/>
<br/>
µ&#160;is&#160;comparable).&#160;Since&#160;k&#160;−&#160;k2&#160;≤&#160;1&#160;for&#160;all&#160;k,&#160;we&#160;get&#160;that<br/>
<br/>
|C<br/>
<br/>
X<br/>
1&#160;≥<br/>
µ&#160;∩&#160;S|<br/>
E&#160;|Cµ&#160;∩&#160;S|&#160;−<br/>
=<br/>
P&#160;(w&#160;∈&#160;C<br/>
P&#160;(w,&#160;z&#160;∈&#160;C<br/>
2<br/>
µ)&#160;−<br/>
X<br/>
µ)<br/>
w∈S<br/>
w,z∈S<br/>
(w,z)∈E(D)<br/>
<br/>
<br/>
X<br/>
X<br/>
=<br/>
P&#160;(w&#160;∈&#160;C&#160;<br/>
<br/>
µ)&#160;1&#160;−<br/>
P&#160;(z&#160;∈&#160;Cµ&#160;|&#160;w&#160;∈&#160;Cµ)<br/>
<br/>
<br/>
w∈S<br/>
z∈S<br/>
(w,z)∈E(D)<br/>
<br/>
<br/>
≥&#160;X&#160;P&#160;(w&#160;∈&#160;Cµ)&#160;1&#160;−&#160;d+(w)&#160;max<br/>
.<br/>
S<br/>
P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)<br/>
(x,y)∈E(D)<br/>
w∈S<br/>
By&#160;<a href="1610.01521s.html#5">(2.3)</a>,&#160;all&#160;of&#160;the&#160;summands&#160;are&#160;positive,&#160;and&#160;so&#160;this&#160;expression&#160;is&#160;bounded&#160;below&#160;by<br/>
<br/>
&#160;<br/>
<br/>
X<br/>
min&#160;P&#160;(x&#160;∈&#160;Cµ)<br/>
1&#160;−&#160;d+(w)&#160;max<br/>
P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;.<br/>
x∈P<br/>
S<br/>
(x,y)∈E(D)<br/>
w∈S<br/>
5<br/>
<hr/>
<a name=6></a><img class="yflip" src="html/1610.01521-6_1.png"/><br/>
<img class="yflip" src="html/1610.01521-6_2.png"/><br/>
<img class="yflip" src="html/1610.01521-6_3.png"/><br/>
<img class="yflip" src="html/1610.01521-6_4.png"/><br/>
<img class="yflip" src="html/1610.01521-6_5.png"/><br/>
<img class="yflip" src="html/1610.01521-6_6.png"/><br/>
<img class="yflip" src="html/1610.01521-6_7.png"/><br/>
<img class="yflip" src="html/1610.01521-6_8.png"/><br/>
Rearranging,&#160;we&#160;obtain<br/>
<br/>
−1&#160;&#160;<br/>
<br/>
−1!<br/>
X<br/>
comp(S)&#160;=<br/>
d+(w)<br/>
max<br/>
min<br/>
S<br/>
≥<br/>
P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)<br/>
|S|&#160;−<br/>
P&#160;(x&#160;∈&#160;Cµ)<br/>
(x,y)∈E(D)<br/>
x∈P<br/>
w∈S<br/>
as&#160;desired.<br/>
Remark&#160;2.4.&#160;We&#160;remark&#160;that&#160;the&#160;proof&#160;of&#160;this&#160;lemma&#160;generalises&#160;to&#160;give&#160;a&#160;lower&#160;bound<br/>on&#160;the&#160;number&#160;of&#160;edges&#160;induced&#160;by&#160;a&#160;set&#160;of&#160;m&#160;vertices&#160;in&#160;a&#160;general&#160;graph&#160;G&#160;in&#160;terms&#160;of&#160;m.<br/>That&#160;is,&#160;one&#160;could&#160;orient&#160;the&#160;edges&#160;of&#160;the&#160;graph&#160;and&#160;select&#160;a&#160;random&#160;clique&#160;according&#160;to&#160;a<br/>probability&#160;distribution&#160;µ.<br/>
3<br/>
Supersaturation&#160;in&#160;P(n)&#160;and&#160;V&#160;(q,&#160;n)<br/>
To&#160;illustrate&#160;the&#160;applicability&#160;of&#160;Lemma&#160;<a href="1610.01521s.html#5">2.2,&#160;</a>we&#160;prove&#160;a&#160;weak&#160;version&#160;of&#160;the&#160;theorem&#160;of<br/>Kleitman&#160;<a href="1610.01521s.html#31">[23]&#160;</a>in&#160;the&#160;boolean&#160;lattice&#160;which&#160;is&#160;often&#160;good&#160;enough&#160;for&#160;applications&#160;involving&#160;the<br/>container&#160;method&#160;(see,&#160;e.g.,&#160;<a href="1610.01521s.html#30">[6,&#160;8,&#160;11]&#160;</a>and&#160;Theorem&#160;<a href="1610.01521s.html#23">6.1)</a>.<br/>
Theorem&#160;3.1&#160;(Kleitman&#160;<a href="1610.01521s.html#31">[23]</a>).&#160;Let&#160;k&#160;be&#160;a&#160;fixed&#160;positive&#160;integer.&#160;Then&#160;there&#160;exists&#160;a&#160;constant<br/>n0(k)&#160;such&#160;that&#160;if&#160;n&#160;≥&#160;n0(k)&#160;and&#160;S&#160;⊆&#160;P(n)&#160;is&#160;a&#160;set&#160;of&#160;cardinality&#160;at&#160;least<br/>
k−1&#160;<br/>
<br/>
X<br/>
n<br/>
+&#160;t,<br/>
&#160;n−k+1+2r&#160;<br/>
r=0<br/>
2<br/>
then<br/>
⌈(n&#160;+&#160;k)/2⌉<br/>
comp(S)&#160;≥&#160;t<br/>
.<br/>
k<br/>
Proof.&#160;For&#160;0&#160;≤&#160;r&#160;≤&#160;k&#160;−&#160;1,&#160;let&#160;Pr&#160;be&#160;the&#160;poset&#160;consisting&#160;all&#160;subsets&#160;of&#160;[n]&#160;of&#160;cardinality<br/>equivalent&#160;to&#160;&#160;n−k+1+2r&#160;&#160;modulo&#160;k&#160;ordered&#160;by&#160;inclusion&#160;(the&#160;idea&#160;of&#160;splitting&#160;the&#160;levels&#160;of<br/>
2<br/>
P(n)&#160;into&#160;equivalence&#160;classes&#160;modulo&#160;k&#160;is&#160;also&#160;used&#160;by&#160;Collares&#160;Neto&#160;and&#160;Morris&#160;<a href="1610.01521s.html#30">[11]</a>).&#160;Note<br/>that&#160;P0&#160;∪&#160;·&#160;·&#160;·&#160;∪&#160;Pk−1&#160;partitions&#160;P(n).&#160;Define&#160;Sr&#160;:=&#160;S&#160;∩&#160;Pr&#160;and<br/>
<br/>
n<br/>
<br/>
tr&#160;:=&#160;|Sr|&#160;−<br/>
.<br/>
&#160;n−k+1+2r&#160;<br/>
2<br/>
Clearly,&#160;Pk−1<br/>
r=0&#160;tr&#160;=&#160;t.&#160;Our&#160;goal&#160;is&#160;to&#160;show&#160;that,&#160;for&#160;0&#160;≤&#160;r&#160;≤&#160;k&#160;−&#160;1,&#160;the&#160;following&#160;holds:<br/>
⌈(n&#160;+&#160;k)/2⌉<br/>
comp(Sr)&#160;≥&#160;tr<br/>
.<br/>
(3.2)<br/>
k<br/>
This&#160;will&#160;imply&#160;the&#160;result&#160;since&#160;comp(S)&#160;≥&#160;Pk−1<br/>
r=0&#160;comp(Sr).<br/>
Let&#160;r&#160;∈&#160;{0,&#160;.&#160;.&#160;.&#160;,&#160;k&#160;−&#160;1}&#160;be&#160;fixed.&#160;We&#160;prove&#160;<a href="1610.01521s.html#6">(3.2)&#160;</a>by&#160;induction&#160;on&#160;tr.&#160;Note&#160;that&#160;<a href="1610.01521s.html#6">(3.2)&#160;</a>holds<br/>
trivially&#160;if&#160;tr&#160;≤&#160;0.&#160;Now,&#160;for&#160;tr&#160;≥&#160;1,&#160;if&#160;Sr&#160;contains&#160;an&#160;element&#160;x&#160;which&#160;is&#160;comparable&#160;to<br/>at&#160;least&#160;⌈(n+k)/2⌉&#160;elements&#160;of&#160;S<br/>
k<br/>
r,&#160;then&#160;we&#160;apply&#160;the&#160;induction&#160;hypothesis&#160;to&#160;find&#160;at&#160;least<br/>
(t<br/>
<br/>
r&#160;−&#160;1)&#160;⌈(n+k)/2⌉<br/>
comparable&#160;pairs&#160;in&#160;S<br/>
k<br/>
r&#160;\&#160;{x}&#160;and&#160;we&#160;are&#160;done.&#160;Therefore,&#160;we&#160;can&#160;assume<br/>
that&#160;there&#160;is&#160;no&#160;such&#160;x&#160;∈&#160;Sr.<br/>
Next,&#160;we&#160;show&#160;that&#160;we&#160;can&#160;assume&#160;that&#160;S&#160;does&#160;not&#160;contain&#160;any&#160;extremely&#160;small&#160;sets.&#160;Let<br/>
s&#160;∈&#160;{0,&#160;.&#160;.&#160;.&#160;,&#160;k&#160;−&#160;1}&#160;so&#160;that&#160;n−k+1+2r&#160;<br/>
2<br/>
≡&#160;s&#160;mod&#160;k.&#160;Let&#160;X&#160;be&#160;the&#160;set&#160;of&#160;all&#160;elements&#160;of&#160;Sr&#160;of<br/>
6<br/>
<hr/>
<a name=7></a><img class="yflip" src="html/1610.01521-7_1.png"/><br/>
<img class="yflip" src="html/1610.01521-7_2.png"/><br/>
<img class="yflip" src="html/1610.01521-7_3.png"/><br/>
<img class="yflip" src="html/1610.01521-7_4.png"/><br/>
<img class="yflip" src="html/1610.01521-7_5.png"/><br/>
cardinality&#160;s.&#160;Suppose&#160;that&#160;X&#160;6=&#160;∅&#160;and&#160;for&#160;each&#160;x&#160;∈&#160;X&#160;let&#160;Nk+s(x)&#160;be&#160;the&#160;elements&#160;of&#160;Pr&#160;\&#160;Sr<br/>of&#160;cardinality&#160;k&#160;+&#160;s&#160;which&#160;are&#160;comparable&#160;to&#160;x.&#160;By&#160;the&#160;result&#160;of&#160;the&#160;previous&#160;paragraph,&#160;x&#160;is<br/>comparable&#160;to&#160;fewer&#160;than&#160;⌈(n+k)/2⌉&#160;elements&#160;of&#160;S<br/>
k<br/>
r&#160;and&#160;so<br/>
n&#160;−&#160;s<br/>
⌈(n&#160;+&#160;k)/2⌉<br/>
n&#160;−&#160;k&#160;+&#160;1<br/>
⌈(n&#160;+&#160;k)/2⌉<br/>
|Nk+s(x)|&#160;&gt;<br/>
−<br/>
≥<br/>
−<br/>
k<br/>
k<br/>
k<br/>
k<br/>
which,&#160;if&#160;n0(k)&#160;is&#160;chosen&#160;large&#160;enough&#160;with&#160;respect&#160;to&#160;k,&#160;is&#160;at&#160;least<br/>
<br/>
n&#160;<br/>
n<br/>
≥<br/>
≥&#160;|X|.<br/>
k&#160;−&#160;1<br/>
s<br/>
Therefore,&#160;we&#160;can&#160;greedily&#160;associate&#160;each&#160;element&#160;x&#160;of&#160;X&#160;to&#160;an&#160;element&#160;yx&#160;of&#160;Pr&#160;\&#160;Sr&#160;of<br/>cardinality&#160;k&#160;+&#160;s&#160;such&#160;that&#160;x&#160;is&#160;comparable&#160;to&#160;yx&#160;and&#160;the&#160;yx&#160;are&#160;distinct&#160;from&#160;one&#160;another.<br/>It&#160;is&#160;clear&#160;that&#160;the&#160;set&#160;S′r&#160;:=&#160;(Sr&#160;\&#160;X)&#160;∪&#160;{yx&#160;:&#160;x&#160;∈&#160;X}&#160;has&#160;the&#160;same&#160;cardinality&#160;as&#160;Sr&#160;and&#160;at<br/>most&#160;as&#160;many&#160;comparable&#160;pairs&#160;as&#160;Sr.&#160;So,&#160;in&#160;what&#160;follows,&#160;we&#160;can&#160;assume&#160;that&#160;X&#160;=&#160;∅;&#160;that<br/>is,&#160;every&#160;element&#160;of&#160;Sr&#160;has&#160;cardinality&#160;at&#160;least&#160;k&#160;+&#160;s.<br/>
Now,&#160;define&#160;P&#160;∗<br/>
r&#160;to&#160;be&#160;the&#160;poset&#160;obtained&#160;from&#160;Pr&#160;by&#160;deleting&#160;all&#160;sets&#160;of&#160;cardinality&#160;s.&#160;Let<br/>
D&#160;be&#160;a&#160;digraph&#160;with&#160;V&#160;(D)&#160;=&#160;P&#160;∗<br/>
r&#160;containing&#160;every&#160;arc&#160;(x,&#160;y)&#160;where&#160;either<br/>
•&#160;x&#160;and&#160;y&#160;are&#160;comparable&#160;and&#160;the&#160;cardinality&#160;of&#160;y&#160;is&#160;closer&#160;to&#160;n/2&#160;than&#160;the&#160;cardinality&#160;of<br/>
x,&#160;or<br/>
•&#160;x&#160;&lt;&#160;y&#160;and&#160;|x|&#160;=&#160;n&#160;−&#160;|y|.<br/>
Let&#160;Cµ&#160;be&#160;a&#160;random&#160;chain&#160;in&#160;P&#160;∗r&#160;obtained&#160;by&#160;taking&#160;a&#160;maximal&#160;chain&#160;in&#160;P(n)&#160;uniformly&#160;at<br/>random&#160;and&#160;intersecting&#160;it&#160;with&#160;P&#160;∗<br/>
r&#160;.&#160;Then&#160;any&#160;two&#160;elements&#160;of&#160;P&#160;∗<br/>
r&#160;of&#160;the&#160;same&#160;cardinality&#160;are<br/>
equally&#160;likely&#160;to&#160;be&#160;contained&#160;in&#160;Cµ&#160;and&#160;so<br/>
<br/>
n<br/>
−1<br/>
P&#160;(x&#160;∈&#160;Cµ)&#160;≥<br/>
for&#160;all&#160;x&#160;∈&#160;P&#160;∗<br/>
&#160;n−k+1+2r&#160;<br/>
r&#160;.<br/>
2<br/>
Also,&#160;given&#160;(x,&#160;y)&#160;∈&#160;E(D),&#160;we&#160;have<br/>
<br/>
|x|&#160;−1<br/>
<br/>
<br/>
if&#160;x&#160;&gt;&#160;y,<br/>
P&#160;(y&#160;∈&#160;C<br/>
|y|<br/>
µ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;=<br/>
n−|x|&#160;−1<br/>
<br/>
<br/>
otherwise.<br/>
|y|−|x|<br/>
By&#160;definition&#160;of&#160;D&#160;and&#160;the&#160;fact&#160;that&#160;X&#160;=&#160;∅,&#160;we&#160;get&#160;that&#160;this&#160;quantity&#160;is&#160;always&#160;at&#160;most<br/>
⌈(n+k)/2⌉−1.&#160;Thus,&#160;<a href="1610.01521s.html#6">(3.2)&#160;</a>holds&#160;by&#160;Lemma&#160;<a href="1610.01521s.html#5">2.2.</a><br/>
k<br/>
The&#160;proof&#160;of&#160;Theorem&#160;<a href="1610.01521s.html#6">3.1&#160;</a>above&#160;exploits&#160;the&#160;following&#160;two&#160;properties&#160;of&#160;a&#160;uniformly<br/>
random&#160;maximal&#160;chain&#160;Cµ&#160;in&#160;the&#160;boolean&#160;lattice:<br/>
•&#160;any&#160;two&#160;subsets&#160;of&#160;[n]&#160;of&#160;the&#160;same&#160;cardinality&#160;are&#160;equally&#160;likely&#160;to&#160;be&#160;contained&#160;in&#160;Cµ<br/>
and<br/>
•&#160;for&#160;any&#160;two&#160;comparable&#160;pairs&#160;(x1,&#160;y1)&#160;and&#160;(x2,&#160;y2)&#160;in&#160;P(n)&#160;such&#160;that&#160;|x1|&#160;=&#160;|x2|&#160;and<br/>
|y1|&#160;=&#160;|y2|,&#160;we&#160;have&#160;P&#160;(x1,&#160;y1&#160;∈&#160;Cµ)&#160;=&#160;P&#160;(x2,&#160;y2&#160;∈&#160;Cµ).<br/>
It&#160;is&#160;clear&#160;that&#160;one&#160;can&#160;often&#160;obtain&#160;a&#160;supersaturation&#160;result&#160;for&#160;posets&#160;satisfying&#160;these&#160;two<br/>conditions&#160;by&#160;taking&#160;a&#160;maximal&#160;chain&#160;uniformly&#160;at&#160;random&#160;and&#160;applying&#160;Lemma&#160;<a href="1610.01521s.html#5">2.2.&#160;</a>We<br/>demonstrate&#160;this&#160;by&#160;outlining&#160;a&#160;proof&#160;of&#160;Theorem&#160;<a href="1610.01521s.html#2">1.2.</a><br/>
7<br/>
<hr/>
<a name=8></a><img class="yflip" src="html/1610.01521-8_1.png"/><br/>
<img class="yflip" src="html/1610.01521-8_2.png"/><br/>
<img class="yflip" src="html/1610.01521-8_3.png"/><br/>
<img class="yflip" src="html/1610.01521-8_4.png"/><br/>
<img class="yflip" src="html/1610.01521-8_5.png"/><br/>
<img class="yflip" src="html/1610.01521-8_6.png"/><br/>
<img class="yflip" src="html/1610.01521-8_7.png"/><br/>
Proof&#160;of&#160;Theorem&#160;<a href="1610.01521s.html#2">1.2.&#160;</a>For&#160;0&#160;≤&#160;r&#160;≤&#160;k&#160;−&#160;1,&#160;let&#160;Pr&#160;be&#160;the&#160;poset&#160;consisting&#160;all&#160;subspaces&#160;of&#160;Fnq&#160;of<br/>dimension&#160;equivalent&#160;to&#160;n−k+1+2r&#160;&#160;modulo&#160;k&#160;ordered&#160;by&#160;inclusion.&#160;Analogous&#160;to&#160;the&#160;proof<br/>
2<br/>
of&#160;Theorem&#160;<a href="1610.01521s.html#6">3.1,&#160;</a>we&#160;define&#160;Sr&#160;:=&#160;S&#160;∩&#160;Pr&#160;and<br/>
<br/>
n<br/>
<br/>
tr&#160;:=&#160;|Sr|&#160;−<br/>
.<br/>
&#160;n−k+1+2r&#160;<br/>
2<br/>
q<br/>
Clearly,&#160;Pk−1<br/>
r=0&#160;tr&#160;=&#160;t.&#160;Our&#160;goal&#160;is&#160;to&#160;prove&#160;that,&#160;for&#160;each&#160;r&#160;=&#160;0,&#160;.&#160;.&#160;.&#160;,&#160;k&#160;−&#160;1,<br/>
&#160;⌈(n&#160;+&#160;k)/2⌉&#160;<br/>
comp(Sr)&#160;≥&#160;tr<br/>
.<br/>
(3.3)<br/>
k<br/>
q<br/>
We&#160;prove&#160;<a href="1610.01521s.html#8">(3.3)&#160;</a>by&#160;induction&#160;on&#160;tr&#160;where&#160;the&#160;case&#160;tr&#160;≤&#160;0&#160;is&#160;trivial.&#160;By&#160;the&#160;inductive<br/>
h<br/>
i<br/>
hypothesis,&#160;we&#160;can&#160;assume&#160;that&#160;every&#160;element&#160;of&#160;S<br/>
⌈(n+k)/2⌉<br/>
r&#160;is&#160;comparable&#160;to&#160;fewer&#160;than<br/>
k<br/>
q<br/>
other&#160;elements&#160;of&#160;Sr.&#160;If&#160;Sr&#160;contains&#160;an&#160;element&#160;of&#160;dimension&#160;s&#160;&lt;&#160;k,&#160;then&#160;we&#160;can&#160;shift&#160;all&#160;such<br/>elements&#160;up&#160;to&#160;subspaces&#160;of&#160;dimension&#160;k&#160;+&#160;s&#160;without&#160;increasing&#160;the&#160;number&#160;of&#160;comparable<br/>pairs&#160;(as&#160;in&#160;the&#160;proof&#160;of&#160;Theorem&#160;<a href="1610.01521s.html#6">3.1)&#160;</a>since<br/>
&#160;n&#160;−&#160;k&#160;+&#160;1<br/>
&#160;⌈(n&#160;+&#160;k)/2⌉<br/>
<br/>
n&#160;<br/>
−<br/>
≥<br/>
k<br/>
k<br/>
k<br/>
q<br/>
q<br/>
−&#160;1&#160;q<br/>
if&#160;n0(k)&#160;is&#160;chosen&#160;large&#160;enough&#160;with&#160;respect&#160;to&#160;k.<br/>
Now,&#160;we&#160;let&#160;P&#160;∗<br/>
r&#160;be&#160;the&#160;poset&#160;obtained&#160;from&#160;Pr&#160;by&#160;deleting&#160;all&#160;elements&#160;of&#160;dimension&#160;less<br/>
than&#160;k&#160;and&#160;let&#160;D&#160;be&#160;a&#160;digraph&#160;with&#160;V&#160;(D)&#160;=&#160;P&#160;∗<br/>
r&#160;containing&#160;every&#160;arc&#160;(x,&#160;y)&#160;such&#160;that&#160;either<br/>
•&#160;x&#160;is&#160;comparable&#160;to&#160;y&#160;and&#160;the&#160;dimension&#160;of&#160;y&#160;is&#160;closer&#160;to&#160;n/2&#160;than&#160;the&#160;dimension&#160;of&#160;x,&#160;or<br/>
•&#160;x&#160;&lt;&#160;y&#160;and&#160;the&#160;dimension&#160;of&#160;x&#160;is&#160;n&#160;minus&#160;the&#160;dimension&#160;of&#160;y.<br/>
Let&#160;Cµ&#160;be&#160;a&#160;uniformly&#160;random&#160;chain&#160;in&#160;P&#160;∗r&#160;obtained&#160;by&#160;taking&#160;a&#160;random&#160;maximal&#160;chain&#160;in<br/>V&#160;(q,&#160;n)&#160;and&#160;intersecting&#160;it&#160;with&#160;P&#160;∗r.&#160;It&#160;is&#160;not&#160;hard&#160;to&#160;show&#160;that<br/>
<br/>
n<br/>
−1<br/>
P&#160;(x&#160;∈&#160;Cµ)&#160;≥<br/>
for&#160;all&#160;x&#160;∈&#160;P&#160;∗<br/>
&#160;n−k+1+2r&#160;<br/>
r&#160;and<br/>
2<br/>
q<br/>
&#160;⌈(n&#160;+&#160;k)/2⌉&#160;−1<br/>
P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;≤<br/>
for&#160;all&#160;(x,&#160;y)&#160;∈&#160;E(D).<br/>
k<br/>
q<br/>
The&#160;result&#160;follows.<br/>
Our&#160;main&#160;difficulty&#160;in&#160;proving&#160;Theorem&#160;<a href="1610.01521s.html#3">1.4&#160;</a>is&#160;that&#160;one&#160;can&#160;no&#160;longer&#160;obtain&#160;a&#160;good&#160;bound<br/>
by&#160;taking&#160;a&#160;uniformly&#160;random&#160;maximal&#160;chain&#160;in&#160;{0,&#160;1,&#160;2}n&#160;and&#160;applying&#160;Lemma&#160;<a href="1610.01521s.html#5">2.2.&#160;</a>Much<br/>of&#160;the&#160;next&#160;section&#160;is&#160;devoted&#160;to&#160;constructing&#160;a&#160;more&#160;appropriate&#160;distribution&#160;on&#160;chains&#160;in<br/>{0,&#160;1,&#160;2}n&#160;and&#160;studying&#160;its&#160;properties.<br/>
8<br/>
<hr/>
<a name=9></a><img class="yflip" src="html/1610.01521-9_1.png"/><br/>
<img class="yflip" src="html/1610.01521-9_2.png"/><br/>
<img class="yflip" src="html/1610.01521-9_3.png"/><br/>
4<br/>
Supersaturation&#160;in&#160;{0,&#160;1,&#160;2}n<br/>
We&#160;open&#160;this&#160;section&#160;with&#160;a&#160;basic&#160;definition.<br/>
Definition&#160;4.1.&#160;A&#160;poset&#160;P&#160;is&#160;said&#160;to&#160;be&#160;ranked&#160;if&#160;it&#160;can&#160;be&#160;partitioned&#160;into&#160;non-empty&#160;sets<br/>L0,&#160;.&#160;.&#160;.&#160;,&#160;LN&#160;called&#160;levels&#160;such&#160;that<br/>
•&#160;if&#160;x&#160;∈&#160;Li&#160;and&#160;x&#160;&lt;&#160;y,&#160;then&#160;y&#160;∈&#160;Sj&gt;i&#160;Lj,<br/>
•&#160;if&#160;x&#160;&lt;&#160;y&#160;such&#160;that&#160;x&#160;∈&#160;Li&#160;and&#160;y&#160;∈&#160;Lj&#160;for&#160;j&#160;&gt;&#160;i&#160;+&#160;1,&#160;then&#160;there&#160;exists&#160;z&#160;∈&#160;Li+1&#160;such&#160;that<br/>
x&#160;&lt;&#160;z&#160;&lt;&#160;y.<br/>
If&#160;x&#160;∈&#160;Li,&#160;then&#160;we&#160;say&#160;that&#160;the&#160;rank&#160;of&#160;x&#160;is&#160;i.<br/>
It&#160;is&#160;clear&#160;that&#160;{0,&#160;1,&#160;2}n&#160;is&#160;a&#160;ranked&#160;poset&#160;where&#160;Li&#160;is&#160;the&#160;set&#160;of&#160;vectors&#160;in&#160;{0,&#160;1,&#160;2}n&#160;whose<br/>
coordinates&#160;sum&#160;to&#160;i.&#160;Also,&#160;the&#160;posets&#160;P(n)&#160;and&#160;V&#160;(q,&#160;n)&#160;are&#160;both&#160;ranked&#160;posets&#160;where&#160;the<br/>rank&#160;of&#160;an&#160;element&#160;is&#160;equal&#160;to&#160;its&#160;cardinality&#160;or&#160;dimension,&#160;respectively.<br/>
In&#160;the&#160;previous&#160;section,&#160;we&#160;used&#160;the&#160;fact&#160;that&#160;a&#160;uniformly&#160;random&#160;chain&#160;of&#160;maximal&#160;length<br/>
in&#160;P(n)&#160;or&#160;V&#160;(q,&#160;n)&#160;is&#160;equally&#160;likely&#160;to&#160;contain&#160;any&#160;element&#160;of&#160;rank&#160;i.&#160;The&#160;poset&#160;{0,&#160;1,&#160;2}n<br/>does&#160;not&#160;have&#160;this&#160;property.&#160;That&#160;is,&#160;one&#160;can&#160;easily&#160;show&#160;that&#160;for&#160;n&#160;≥&#160;2&#160;a&#160;uniformly&#160;random<br/>maximal&#160;chain&#160;is&#160;not&#160;equally&#160;likely&#160;to&#160;contain&#160;any&#160;given&#160;element&#160;in&#160;Li&#160;for&#160;2&#160;≤&#160;i&#160;≤&#160;2n&#160;−&#160;2.<br/>Therefore,&#160;if&#160;we&#160;are&#160;to&#160;apply&#160;Lemma&#160;<a href="1610.01521s.html#5">2.2&#160;</a>to&#160;obtain&#160;a&#160;supersaturation&#160;result&#160;which&#160;applies<br/>to&#160;all&#160;subsets&#160;of&#160;{0,&#160;1,&#160;2}n&#160;of&#160;cardinality&#160;greater&#160;than&#160;ℓn(n),&#160;then&#160;we&#160;will&#160;require&#160;a&#160;different<br/>distribution&#160;on&#160;the&#160;chains&#160;of&#160;{0,&#160;1,&#160;2}n.<br/>
Definition&#160;4.2.&#160;Let&#160;P&#160;be&#160;a&#160;ranked&#160;poset&#160;with&#160;non-empty&#160;levels&#160;L0,&#160;.&#160;.&#160;.&#160;,&#160;LN&#160;.&#160;A&#160;non-empty<br/>finite&#160;multiset&#160;C&#160;of&#160;maximal&#160;chains&#160;in&#160;P&#160;is&#160;called&#160;a&#160;regular&#160;covering&#160;by&#160;chains&#160;if&#160;for&#160;0&#160;≤&#160;i&#160;≤&#160;N<br/>every&#160;element&#160;of&#160;Li&#160;is&#160;contained&#160;in&#160;exactly&#160;|C&#160;|/|Li|&#160;chains&#160;of&#160;C&#160;.<br/>
As&#160;noted&#160;above,&#160;the&#160;collection&#160;of&#160;all&#160;maximal&#160;chains&#160;in&#160;{0,&#160;1,&#160;2}n&#160;is&#160;not&#160;a&#160;regular&#160;covering<br/>
by&#160;chains.&#160;However,&#160;Anderson&#160;<a href="1610.01521s.html#30">[1]&#160;</a>proved&#160;that&#160;{0,&#160;1,&#160;2}n&#160;does&#160;possess&#160;a&#160;regular&#160;covering&#160;by<br/>chains&#160;(in&#160;fact,&#160;he&#160;proved&#160;that&#160;the&#160;same&#160;is&#160;true&#160;for&#160;the&#160;poset&#160;of&#160;divisors&#160;of&#160;any&#160;integer;&#160;see<br/>also&#160;<a href="1610.01521s.html#30">[3]</a>).&#160;The&#160;following&#160;useful&#160;result&#160;of&#160;Kleitman&#160;<a href="1610.01521s.html#31">[25]&#160;</a>characterises&#160;ranked&#160;posets&#160;with&#160;regular<br/>coverings&#160;by&#160;chains&#160;in&#160;terms&#160;of&#160;two&#160;other&#160;natural&#160;conditions,&#160;one&#160;of&#160;which&#160;will&#160;be&#160;used&#160;in&#160;our<br/>proof.<br/>
Definition&#160;4.3.&#160;Let&#160;P&#160;be&#160;a&#160;ranked&#160;poset&#160;with&#160;levels&#160;L0,&#160;.&#160;.&#160;.&#160;,&#160;LN&#160;.&#160;Then&#160;P&#160;is&#160;said&#160;to&#160;have&#160;the<br/>LYM&#160;property&#160;if,&#160;for&#160;every&#160;antichain&#160;A&#160;⊆&#160;P&#160;,<br/>
N<br/>
X&#160;|A&#160;∩&#160;Li|&#160;≤&#160;1.<br/>
|L<br/>
i=0<br/>
i|<br/>
Definition&#160;4.4.&#160;Let&#160;P&#160;be&#160;a&#160;ranked&#160;poset&#160;with&#160;levels&#160;L0,&#160;.&#160;.&#160;.&#160;,&#160;LN&#160;.&#160;Then&#160;P&#160;is&#160;said&#160;to&#160;have&#160;the<br/>normalised&#160;matching&#160;property&#160;if&#160;for&#160;0&#160;≤&#160;i&#160;≤&#160;N&#160;−&#160;1&#160;and&#160;T&#160;⊆&#160;Li&#160;we&#160;have<br/>
|{y&#160;∈&#160;Li+1&#160;:&#160;y&#160;&gt;&#160;x&#160;for&#160;some&#160;x&#160;∈&#160;T&#160;}|<br/>
|T&#160;|<br/>
≥<br/>
.<br/>
|Li+1|<br/>
|Li|<br/>
Theorem&#160;4.5&#160;(Kleitman&#160;<a href="1610.01521s.html#31">[25]</a>).&#160;Let&#160;P&#160;be&#160;a&#160;ranked&#160;poset.&#160;The&#160;following&#160;are&#160;equivalent:&#160;(1)&#160;P<br/>has&#160;a&#160;regular&#160;covering&#160;by&#160;chains,&#160;(2)&#160;P&#160;has&#160;the&#160;LYM&#160;property&#160;and&#160;(3)&#160;P&#160;has&#160;the&#160;normalised<br/>matching&#160;property.<br/>
9<br/>
<hr/>
<a name=10></a><img class="yflip" src="html/1610.01521-10_1.png"/><br/>
The&#160;distribution&#160;µ&#160;on&#160;the&#160;maximal&#160;chains&#160;of&#160;{0,&#160;1,&#160;2}n&#160;that&#160;we&#160;construct&#160;essentially<br/>
amounts&#160;to&#160;choosing&#160;a&#160;uniformly&#160;random&#160;chain&#160;from&#160;a&#160;regular&#160;covering&#160;by&#160;chains.&#160;One<br/>subtle&#160;point&#160;is&#160;that,&#160;in&#160;the&#160;proof&#160;of&#160;Theorem&#160;<a href="1610.01521s.html#3">1.4,&#160;</a>it&#160;will&#160;be&#160;useful&#160;to&#160;insist&#160;that&#160;the&#160;distribu-<br/>tion&#160;µ&#160;is&#160;‘memoryless’&#160;in&#160;the&#160;sense&#160;that&#160;if&#160;z1&#160;&lt;&#160;z2&#160;&lt;&#160;·&#160;·&#160;·&#160;&lt;&#160;zq&#160;in&#160;{0,&#160;1,&#160;2}n&#160;and&#160;Cµ&#160;is&#160;a&#160;chain<br/>chosen&#160;randomly&#160;according&#160;to&#160;µ,&#160;then<br/>
P&#160;(zq&#160;∈&#160;Cµ&#160;|&#160;z1,&#160;.&#160;.&#160;.&#160;,&#160;zq−1&#160;∈&#160;Cµ)&#160;=&#160;P&#160;(zq&#160;∈&#160;Cµ&#160;|&#160;zq−1&#160;∈&#160;Cµ)&#160;.<br/>
(4.6)<br/>
Note&#160;that&#160;a&#160;chain&#160;chosen&#160;uniformly&#160;at&#160;random&#160;from&#160;a&#160;regular&#160;covering&#160;by&#160;chains&#160;need&#160;not<br/>satisfy&#160;<a href="1610.01521s.html#10">(4.6)</a>.&#160;Also&#160;note&#160;that,&#160;if&#160;<a href="1610.01521s.html#10">(4.6)&#160;</a>holds&#160;for&#160;every&#160;such&#160;sequence,&#160;then&#160;one&#160;can&#160;easily&#160;deduce<br/>
P&#160;(z1&#160;∈&#160;Cµ&#160;|&#160;z2,&#160;.&#160;.&#160;.&#160;,&#160;zq&#160;∈&#160;Cµ)&#160;=&#160;P&#160;(z1&#160;∈&#160;Cµ&#160;|&#160;z2&#160;∈&#160;Cµ)<br/>
as&#160;well.&#160;Before&#160;constructing&#160;µ,&#160;we&#160;require&#160;a&#160;couple&#160;of&#160;definitions.<br/>
Definition&#160;4.7.&#160;For&#160;integers&#160;i&#160;and&#160;s,&#160;let&#160;Lsi&#160;be&#160;the&#160;elements&#160;of&#160;Li&#160;with&#160;exactly&#160;s&#160;coordinates<br/>equal&#160;to&#160;2.&#160;Note&#160;that&#160;Lsi&#160;is&#160;non-empty&#160;if&#160;and&#160;only&#160;if&#160;max{0,&#160;i&#160;−&#160;n}&#160;≤&#160;s&#160;≤&#160;⌊i/2⌋.<br/>
Definition&#160;4.8.&#160;For&#160;integers&#160;i&#160;and&#160;s,&#160;define<br/>
⌊i/2⌋<br/>
[<br/>
L≥s<br/>
i<br/>
:=<br/>
Lri&#160;and<br/>
r=s<br/>
s<br/>
[<br/>
L≤s<br/>
i<br/>
:=<br/>
Lri.<br/>
r=max{0,i−n}<br/>
Our&#160;goal&#160;is&#160;to&#160;construct&#160;a&#160;distribution&#160;µ&#160;on&#160;the&#160;maximal&#160;chains&#160;in&#160;{0,&#160;1,&#160;2}n&#160;such&#160;that<br/>
<a href="1610.01521s.html#10">(4.6)&#160;</a>holds&#160;and,&#160;for&#160;0&#160;≤&#160;i&#160;≤&#160;2n,&#160;every&#160;element&#160;of&#160;Li&#160;is&#160;equally&#160;likely&#160;to&#160;be&#160;contained&#160;in&#160;Cµ.<br/>We&#160;begin&#160;by&#160;insisting&#160;that&#160;Cµ&#160;contains&#160;(0,&#160;.&#160;.&#160;.&#160;,&#160;0)&#160;with&#160;probability&#160;one&#160;and&#160;that&#160;it&#160;is&#160;equally<br/>likely&#160;to&#160;contain&#160;any&#160;element&#160;of&#160;L1.<br/>
Now,&#160;suppose&#160;that&#160;Cµ&#160;has&#160;been&#160;constructed&#160;up&#160;to&#160;level&#160;i&#160;where&#160;1&#160;≤&#160;i&#160;≤&#160;2n&#160;−&#160;2.&#160;In&#160;order<br/>
for&#160;<a href="1610.01521s.html#10">(4.6)&#160;</a>to&#160;hold,&#160;we&#160;must&#160;choose&#160;an&#160;element&#160;of&#160;Li+1&#160;to&#160;add&#160;to&#160;Cµ&#160;independently&#160;of&#160;the&#160;choice<br/>
<br/>
<br/>
of&#160;C<br/>
Si−1<br/>
µ&#160;∩<br/>
j=1&#160;Lj&#160;.&#160;That&#160;is,&#160;our&#160;goal&#160;is&#160;to&#160;define&#160;the&#160;values&#160;of&#160;P(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;for&#160;all<br/>
x&#160;∈&#160;Li&#160;and&#160;y&#160;∈&#160;Li+1&#160;with&#160;x&#160;&lt;&#160;y&#160;in&#160;such&#160;a&#160;way&#160;that&#160;each&#160;element&#160;of&#160;Li+1&#160;is&#160;equally&#160;likely&#160;to<br/>be&#160;contained&#160;in&#160;Cµ.<br/>
We&#160;rephrase&#160;the&#160;problem&#160;of&#160;defining&#160;these&#160;conditional&#160;probabilities&#160;as&#160;follows.&#160;Suppose<br/>
that&#160;we&#160;define&#160;a&#160;weighting&#160;of&#160;Li+1&#160;by&#160;assigning&#160;each&#160;element&#160;of&#160;Li&#160;a&#160;weight&#160;of&#160;1/|Li|&#160;and<br/>then&#160;redistributing&#160;the&#160;weight&#160;in&#160;such&#160;a&#160;way&#160;that&#160;each&#160;x&#160;∈&#160;Li&#160;sends&#160;weight&#160;wx,y&#160;≥&#160;0&#160;to&#160;each<br/>y&#160;∈&#160;Li+1&#160;comparable&#160;to&#160;x,&#160;where&#160;Py∈L<br/>
w<br/>
i+1<br/>
x,y&#160;=&#160;1/|Li|.&#160;What&#160;we&#160;would&#160;like&#160;to&#160;do&#160;is&#160;to&#160;fix<br/>
x&lt;y<br/>
the&#160;weights&#160;wx,y&#160;in&#160;such&#160;a&#160;way&#160;that&#160;every&#160;element&#160;of&#160;Li+1&#160;receives&#160;weight&#160;1/|Li+1|.&#160;Note&#160;that,<br/>for&#160;max{0,&#160;i&#160;−&#160;n}&#160;≤&#160;s&#160;≤&#160;⌊(i&#160;−&#160;2)/2⌋&#160;all&#160;of&#160;the&#160;weight&#160;sent&#160;by&#160;elements&#160;of&#160;L≥s+1<br/>
i<br/>
is&#160;received&#160;by<br/>
elements&#160;of&#160;L≥s+1<br/>
i+1<br/>
.&#160;So,&#160;the&#160;total&#160;weight&#160;received&#160;by&#160;the&#160;set&#160;L≥s+1<br/>
i+1<br/>
is<br/>
<br/>
<br/>
L≥s+1<br/>
<br/>
i<br/>
<br/>
X<br/>
+<br/>
w<br/>
|L<br/>
x,y.<br/>
i|<br/>
(x,y)∈Lsi×Ls+1<br/>
i+1<br/>
x&lt;y<br/>
10<br/>
<hr/>
<a name=11></a><img class="yflip" src="html/1610.01521-11_1.png"/><br/>
<img class="yflip" src="html/1610.01521-11_2.png"/><br/>
<img class="yflip" src="html/1610.01521-11_3.png"/><br/>
<img class="yflip" src="html/1610.01521-11_4.png"/><br/>
<img class="yflip" src="html/1610.01521-11_5.png"/><br/>
<img class="yflip" src="html/1610.01521-11_6.png"/><br/>
<br/>
<br/>
L≥s+1<br/>
In&#160;order&#160;to&#160;achieve&#160;the&#160;desired&#160;weighting&#160;of&#160;L<br/>
<br/>
i+1<br/>
<br/>
i+1,&#160;we&#160;need&#160;this&#160;quantity&#160;to&#160;be&#160;equal&#160;to<br/>
,<br/>
|Li+1|<br/>
which&#160;implies&#160;that<br/>
<br/>
<br/>
<br/>
<br/>
|Li|&#160;L≥s+1&#160;−&#160;|Li+1|&#160;L≥s+1<br/>
X<br/>
<br/>
i+1<br/>
<br/>
<br/>
i<br/>
<br/>
wx,y&#160;=<br/>
.<br/>
(4.9)<br/>
|Li|&#160;|Li+1|<br/>
(x,y)∈Lsi×Ls+1<br/>
i+1<br/>
x&lt;y<br/>
Similarly&#160;since,&#160;for&#160;max{0,&#160;i&#160;+&#160;1&#160;−&#160;n}&#160;≤&#160;s&#160;≤&#160;⌊i/2⌋,&#160;all&#160;of&#160;the&#160;weight&#160;sent&#160;by&#160;elements&#160;of&#160;L≤s−1<br/>
i<br/>
is&#160;received&#160;by&#160;elements&#160;of&#160;L≤s<br/>
i+1,&#160;we&#160;require&#160;that<br/>
<br/>
<br/>
<br/>
<br/>
|Li|&#160;L≤s&#160;&#160;−&#160;L≤s−1&#160;|Li+1|<br/>
X<br/>
<br/>
i+1<br/>
<br/>
i<br/>
<br/>
wx,y&#160;=<br/>
.<br/>
(4.10)<br/>
|Li||Li+1|<br/>
(x,y)∈Lsi×Lsi+1<br/>
x&lt;y<br/>
We&#160;insist&#160;that&#160;our&#160;construction&#160;has&#160;the&#160;property&#160;that&#160;wx,y&#160;depends&#160;only&#160;on&#160;the&#160;number&#160;of<br/>coordinates&#160;of&#160;x&#160;and&#160;y&#160;which&#160;are&#160;equal&#160;to&#160;two.&#160;That&#160;is,&#160;if&#160;x&#160;∈&#160;Lsi&#160;and&#160;y&#160;∈&#160;Ls+1<br/>
i+1&#160;for&#160;some&#160;s,<br/>
then&#160;set&#160;wx,y&#160;=&#160;wi,s&#160;and&#160;if&#160;x&#160;∈&#160;Lsi&#160;and&#160;y&#160;∈&#160;Lsi+1,&#160;then&#160;set&#160;wx,y&#160;=&#160;w′i,s.&#160;The&#160;left&#160;sides&#160;of&#160;<a href="1610.01521s.html#11">(4.9)<br/></a>and&#160;<a href="1610.01521s.html#11">(4.10)&#160;</a>become&#160;(i&#160;−&#160;2s)|Lsi|wi,s&#160;and&#160;(n&#160;−&#160;i&#160;+&#160;s)|Lsi|w′i,s,&#160;respectively.&#160;Rearranging,&#160;we&#160;get<br/>that,&#160;for&#160;max{0,&#160;i&#160;−&#160;n}&#160;≤&#160;s&#160;≤&#160;⌊(i&#160;−&#160;1)/2⌋,<br/>
<br/>
<br/>
<br/>
<br/>
|Li|&#160;L≥s+1&#160;−&#160;|Li+1|&#160;L≥s+1<br/>
<br/>
i+1<br/>
<br/>
<br/>
i<br/>
<br/>
wi,s&#160;=<br/>
(4.11)<br/>
|Lsi|&#160;|Li|&#160;|Li+1|&#160;(i&#160;−&#160;2s)<br/>
and,&#160;for&#160;max{0,&#160;i&#160;−&#160;n&#160;+&#160;1}&#160;≤&#160;s&#160;≤&#160;⌊i/2⌋,<br/>
<br/>
<br/>
<br/>
<br/>
|Li|&#160;L≤s&#160;&#160;−&#160;|Li+1|&#160;L≤s−1<br/>
<br/>
i+1<br/>
<br/>
i<br/>
<br/>
w′i,s&#160;=<br/>
.<br/>
(4.12)<br/>
|Lsi|&#160;|Li|&#160;|Li+1|&#160;(n&#160;−&#160;i&#160;+&#160;s)<br/>
For&#160;completeness,&#160;if&#160;i&#160;is&#160;even,&#160;then&#160;set&#160;wi,i/2&#160;:=&#160;0&#160;and&#160;if&#160;i&#160;≥&#160;n,&#160;set&#160;w′i,i−n&#160;:=&#160;0.&#160;The&#160;weights<br/>
wi,s&#160;and&#160;w′i,s&#160;are&#160;all&#160;non-negative&#160;since&#160;{0,&#160;1,&#160;2}n&#160;has&#160;the&#160;normalised&#160;matching&#160;property.<br/>
So,&#160;we&#160;extend&#160;the&#160;chain&#160;Cµ&#160;to&#160;level&#160;i&#160;+&#160;1&#160;in&#160;the&#160;following&#160;way.&#160;Given&#160;that&#160;Cµ&#160;contains<br/>
x&#160;∈&#160;Lsi,&#160;then&#160;we&#160;add&#160;an&#160;element&#160;y&#160;of&#160;Li+1&#160;comparable&#160;to&#160;x&#160;to&#160;Cµ,&#160;independently&#160;of&#160;the&#160;choice<br/>of&#160;Cµ&#160;\&#160;{x},&#160;with&#160;probability&#160;|Li|wi,s&#160;if&#160;y&#160;∈&#160;Ls+1<br/>
i+1&#160;and&#160;with&#160;probability&#160;|Li|w′i,s&#160;if&#160;y&#160;∈&#160;Lsi+1.<br/>
Note&#160;that&#160;x&#160;is&#160;comparable&#160;to&#160;i&#160;−&#160;2s&#160;elements&#160;of&#160;Ls+1<br/>
i+1&#160;and&#160;n&#160;−&#160;i&#160;+&#160;s&#160;elements&#160;of&#160;Lsi+1&#160;and&#160;that<br/>
(i&#160;−&#160;2s)wi,s&#160;+&#160;(n&#160;−&#160;i&#160;+&#160;s)w′i,s&#160;=&#160;1/|Li|&#160;=&#160;P(x&#160;∈&#160;Cµ)&#160;by&#160;definition.<br/>
Let&#160;us&#160;verify&#160;that&#160;any&#160;element&#160;of&#160;Li+1&#160;is&#160;contained&#160;in&#160;Cµ&#160;with&#160;probability&#160;1/|Li+1|.&#160;By<br/>
construction,&#160;given&#160;y&#160;∈&#160;Lti+1,&#160;the&#160;probability&#160;that&#160;y&#160;is&#160;contained&#160;in&#160;Cµ&#160;is<br/>
X<br/>
X<br/>
X<br/>
P&#160;(x,&#160;y&#160;∈&#160;Cµ)&#160;=<br/>
P&#160;(x&#160;∈&#160;Cµ)&#160;P&#160;(y&#160;∈&#160;C&#160;|&#160;x&#160;∈&#160;Cµ)&#160;+<br/>
P&#160;(x&#160;∈&#160;Cµ)&#160;P&#160;(y&#160;∈&#160;C&#160;|&#160;x&#160;∈&#160;Cµ)&#160;.<br/>
x∈Li<br/>
x∈Lt−1<br/>
x∈Lt<br/>
x&lt;y<br/>
i<br/>
i<br/>
x&lt;y<br/>
x&lt;y<br/>
<br/>
<br/>
(i+1)L≤0&#160;<br/>
If&#160;t&#160;=&#160;0,&#160;then&#160;the&#160;first&#160;sum&#160;is&#160;zero&#160;and&#160;the&#160;second&#160;is&#160;equal&#160;to&#160;(i&#160;+&#160;1)w′<br/>
<br/>
i+1<br/>
i,0&#160;=<br/>
=<br/>
|L0i||Li+1|(n−i)<br/>
1/|Li+1|.&#160;If&#160;i&#160;is&#160;odd&#160;and&#160;t&#160;=&#160;(i&#160;+&#160;1)/2,&#160;then&#160;the&#160;second&#160;sum&#160;is&#160;zero&#160;and&#160;the&#160;first&#160;is&#160;equal&#160;to<br/>
11<br/>
<hr/>
<a name=12></a><img class="yflip" src="html/1610.01521-12_1.png"/><br/>
<img class="yflip" src="html/1610.01521-12_2.png"/><br/>
<img class="yflip" src="html/1610.01521-12_3.png"/><br/>
<img class="yflip" src="html/1610.01521-12_4.png"/><br/>
<img class="yflip" src="html/1610.01521-12_5.png"/><br/>
<img class="yflip" src="html/1610.01521-12_6.png"/><br/>
<img class="yflip" src="html/1610.01521-12_7.png"/><br/>
<img class="yflip" src="html/1610.01521-12_8.png"/><br/>
<img class="yflip" src="html/1610.01521-12_9.png"/><br/>
<img class="yflip" src="html/1610.01521-12_10.png"/><br/>
<img class="yflip" src="html/1610.01521-12_11.png"/><br/>
<img class="yflip" src="html/1610.01521-12_12.png"/><br/>
<img class="yflip" src="html/1610.01521-12_13.png"/><br/>
<br/>
<br/>
(i+1)L≥(i+1)/2<br/>
i+1&#160;&#160;w<br/>
<br/>
i+1<br/>
<br/>
=&#160;1/<br/>
2<br/>
i,(i−1)/2&#160;=&#160;<br/>
<br/>
|Li+1|.&#160;Finally,&#160;if&#160;max{i&#160;+&#160;1&#160;−&#160;n,&#160;1}&#160;≤&#160;t&#160;≤&#160;⌊i/2⌋,&#160;then<br/>
2L(i−1)/2|Li+1|<br/>
<br/>
i<br/>
<br/>
the&#160;above&#160;expression&#160;becomes<br/>
twi,t−1&#160;+&#160;(i&#160;+&#160;1&#160;−&#160;2t)w′i,t<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
t&#160;|Li|&#160;L≥t&#160;&#160;−&#160;|Li+1|&#160;L≥t<br/>
(i&#160;+&#160;1&#160;−&#160;2t)&#160;|Li|&#160;L≤t&#160;&#160;−&#160;|Li+1|&#160;L≤t−1<br/>
<br/>
i+1<br/>
<br/>
i&#160;<br/>
<br/>
i+1<br/>
<br/>
i<br/>
<br/>
=<br/>
+<br/>
<br/>
<br/>
Lt−1<br/>
|Lt<br/>
i<br/>
&#160;|Li|&#160;|Li+1|&#160;(i&#160;−&#160;2t&#160;+&#160;2)<br/>
i|&#160;|Li|&#160;|Li+1|&#160;(n&#160;−&#160;i&#160;+&#160;t)<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
|Li|&#160;L≥t&#160;&#160;−&#160;|Li+1|&#160;L≥t<br/>
|Li|&#160;L≤t&#160;&#160;−&#160;|Li+1|&#160;L≤t−1<br/>
<br/>
i+1<br/>
<br/>
i&#160;<br/>
<br/>
i+1<br/>
<br/>
i<br/>
<br/>
=<br/>
+<br/>
n<br/>
<br/>
i+1−t<br/>
n<br/>
<br/>
i+1−t<br/>
i+1−t<br/>
t<br/>
|Li|&#160;|Li+1|<br/>
i+1−t<br/>
t<br/>
|Li|&#160;|Li+1|<br/>
|Lt<br/>
1<br/>
=<br/>
i+1|<br/>
=<br/>
.<br/>
n<br/>
<br/>
i+1−t<br/>
|L<br/>
i+1−t<br/>
t<br/>
|Li+1|<br/>
i+1|<br/>
We&#160;complete&#160;the&#160;construction&#160;by&#160;insisting&#160;that&#160;Cµ&#160;contains&#160;(2,&#160;.&#160;.&#160;.&#160;,&#160;2)&#160;with&#160;probability&#160;one.<br/>
Most&#160;of&#160;the&#160;work&#160;in&#160;this&#160;section&#160;is&#160;devoted&#160;to&#160;proving&#160;the&#160;following&#160;lemma.<br/>
Lemma&#160;4.13.&#160;Let&#160;k&#160;≥&#160;1&#160;be&#160;a&#160;fixed&#160;integer,&#160;let&#160;n&#160;be&#160;large&#160;with&#160;respect&#160;to&#160;k&#160;and&#160;let&#160;Cµ&#160;be&#160;a<br/>chain&#160;chosen&#160;randomly&#160;according&#160;to&#160;µ.&#160;Let&#160;0&#160;≤&#160;i,&#160;j&#160;≤&#160;2n&#160;be&#160;integers&#160;such&#160;that<br/>
•&#160;|i&#160;−&#160;j|&#160;≥&#160;k,<br/>
•&#160;either&#160;min{i,&#160;j}&#160;≥&#160;2k&#160;or&#160;max{i,&#160;j}&#160;≤&#160;2n&#160;−&#160;2k,&#160;and<br/>
•&#160;|j&#160;−&#160;n|&#160;≤&#160;|i&#160;−&#160;n|.<br/>
If&#160;x&#160;∈&#160;Li&#160;and&#160;y&#160;∈&#160;Lj&#160;are&#160;such&#160;that&#160;x&#160;is&#160;comparable&#160;to&#160;y,&#160;then<br/>
&#160;ℓ<br/>
−1<br/>
3k<br/>
P&#160;(y&#160;∈&#160;C<br/>
−1(n)<br/>
µ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;≤<br/>
−&#160;1<br/>
.<br/>
ℓ2k−1(n)<br/>
We&#160;now&#160;derive&#160;Theorem&#160;<a href="1610.01521s.html#3">1.4&#160;</a>from&#160;Lemma&#160;<a href="1610.01521s.html#12">4.13&#160;</a>after&#160;which&#160;we&#160;will&#160;turn&#160;our&#160;attention&#160;to<br/>
proving&#160;the&#160;lemma&#160;itself.<br/>
Proof&#160;of&#160;Theorem&#160;<a href="1610.01521s.html#3">1.4&#160;</a>assuming&#160;Lemma&#160;<a href="1610.01521s.html#12">4.13.&#160;</a>For&#160;0&#160;≤&#160;r&#160;≤&#160;k−1,&#160;let&#160;Pr&#160;be&#160;the&#160;poset&#160;consisting<br/>all&#160;elements&#160;of&#160;{0,&#160;1,&#160;2}n&#160;of&#160;rank&#160;equivalent&#160;to&#160;n&#160;+&#160;2r−k+1&#160;modulo&#160;k&#160;with&#160;partial&#160;order<br/>
2<br/>
inherited&#160;from&#160;{0,&#160;1,&#160;2}n.&#160;Define&#160;Sr&#160;:=&#160;S&#160;∩&#160;Pr&#160;and<br/>
tr&#160;:=&#160;|Sr|&#160;−&#160;ℓn+⌈2r−k+1<br/>
2<br/>
⌉(n).<br/>
Clearly,&#160;Pk−1<br/>
r=0&#160;tr&#160;=&#160;t.&#160;We&#160;prove&#160;that,&#160;for&#160;each&#160;r&#160;=&#160;0,&#160;.&#160;.&#160;.&#160;,&#160;k&#160;−&#160;1,<br/>
&#160;ℓ<br/>
<br/>
comp(S<br/>
3k−1(n)<br/>
r)&#160;≥<br/>
−&#160;1&#160;t<br/>
ℓ<br/>
r.<br/>
(4.14)<br/>
2k−1(n)<br/>
We&#160;prove&#160;<a href="1610.01521s.html#12">(4.14)&#160;</a>by&#160;induction&#160;on&#160;tr&#160;where&#160;the&#160;case&#160;tr&#160;≤&#160;0&#160;is&#160;trivial.&#160;By&#160;the&#160;inductive<br/>
hypothesis,&#160;we&#160;can&#160;assume&#160;that&#160;every&#160;element&#160;of&#160;Sr&#160;is&#160;comparable&#160;to&#160;fewer&#160;than&#160;ℓ3k−1(n)&#160;−&#160;1<br/>
ℓ2k−1(n)<br/>
other&#160;elements&#160;of&#160;Sr.<br/>
12<br/>
<hr/>
<a name=13></a><img class="yflip" src="html/1610.01521-13_1.png"/><br/>
<img class="yflip" src="html/1610.01521-13_2.png"/><br/>
<img class="yflip" src="html/1610.01521-13_3.png"/><br/>
<img class="yflip" src="html/1610.01521-13_4.png"/><br/>
<img class="yflip" src="html/1610.01521-13_5.png"/><br/>
<img class="yflip" src="html/1610.01521-13_6.png"/><br/>
<img class="yflip" src="html/1610.01521-13_7.png"/><br/>
<img class="yflip" src="html/1610.01521-13_8.png"/><br/>
<img class="yflip" src="html/1610.01521-13_9.png"/><br/>
<img class="yflip" src="html/1610.01521-13_10.png"/><br/>
<img class="yflip" src="html/1610.01521-13_11.png"/><br/>
Next,&#160;we&#160;prove&#160;that&#160;it&#160;suffices&#160;to&#160;consider&#160;the&#160;case&#160;that&#160;Sr&#160;contains&#160;no&#160;elements&#160;of&#160;rank<br/>
less&#160;than&#160;2k.&#160;First,&#160;let&#160;A&#160;be&#160;the&#160;set&#160;of&#160;all&#160;elements&#160;of&#160;Sr&#160;of&#160;rank&#160;less&#160;than&#160;k.&#160;Clearly,&#160;each<br/>element&#160;of&#160;A&#160;has&#160;rank&#160;r.&#160;Let&#160;us&#160;show&#160;that&#160;we&#160;can&#160;assume&#160;that&#160;A&#160;is&#160;empty.&#160;For&#160;each&#160;subset<br/>T&#160;of&#160;A,&#160;let&#160;Γ(T&#160;)&#160;denote&#160;the&#160;elements&#160;of&#160;Lr+k&#160;comparable&#160;to&#160;at&#160;least&#160;one&#160;member&#160;of&#160;T&#160;.&#160;If&#160;we<br/>had&#160;|Γ(T&#160;)&#160;\&#160;Sr|&#160;≥&#160;|T&#160;|&#160;for&#160;every&#160;subset&#160;T&#160;of&#160;A,&#160;then&#160;by&#160;Hall’s&#160;Marriage&#160;Theorem&#160;<a href="1610.01521s.html#31">[21]&#160;</a>we&#160;could<br/>associate&#160;each&#160;element&#160;of&#160;x&#160;∈&#160;A&#160;to&#160;an&#160;element&#160;f&#160;(x)&#160;of&#160;Lr+k&#160;\&#160;Sr&#160;such&#160;that&#160;x&#160;&lt;&#160;f&#160;(x)&#160;and&#160;the<br/>function&#160;f&#160;is&#160;injective.&#160;Given&#160;such&#160;a&#160;function&#160;f&#160;,&#160;it&#160;is&#160;clear&#160;that&#160;the&#160;set&#160;S′&#160;:=&#160;(Sr&#160;\&#160;A)&#160;∪&#160;f&#160;(A)<br/>has&#160;the&#160;same&#160;cardinality&#160;as&#160;Sr&#160;and&#160;at&#160;most&#160;as&#160;many&#160;comparable&#160;pairs&#160;as&#160;Sr.<br/>
Thus,&#160;we&#160;suppose&#160;that&#160;no&#160;such&#160;f&#160;exists&#160;and&#160;so&#160;there&#160;there&#160;must&#160;be&#160;a&#160;set&#160;T&#160;⊆&#160;A&#160;such&#160;that<br/>
|Γ(T&#160;)&#160;\&#160;Sr|&#160;&lt;&#160;|T&#160;|.&#160;Since&#160;{0,&#160;1,&#160;2}n&#160;has&#160;the&#160;normalised&#160;matching&#160;property,&#160;we&#160;have<br/>
|Γ(T&#160;)&#160;∩&#160;Sr|<br/>
|Γ(T&#160;)|<br/>
|Γ(T&#160;)&#160;\&#160;S<br/>
|L<br/>
=<br/>
−<br/>
r|&#160;&gt;<br/>
r+k|&#160;−&#160;1<br/>
|T&#160;|<br/>
|T&#160;|<br/>
|T&#160;|<br/>
|Lr|<br/>
which&#160;is&#160;at&#160;least&#160;ℓ3k−1(n)&#160;−&#160;1&#160;by&#160;Theorem&#160;<a href="1610.01521s.html#32">A.3.&#160;</a>Putting&#160;these&#160;two&#160;facts&#160;together,&#160;we&#160;have<br/>
ℓ2k−1(n)<br/>
&#160;ℓ<br/>
<br/>
|Γ(T&#160;)&#160;∩&#160;S<br/>
3k−1(n)<br/>
r|&#160;&gt;<br/>
−&#160;1&#160;|T&#160;|.<br/>
(4.15)<br/>
ℓ2k−1(n)<br/>
So,&#160;by&#160;the&#160;Pigeonhole&#160;Principle,&#160;there&#160;must&#160;be&#160;some&#160;element&#160;of&#160;T&#160;which&#160;is&#160;comparable&#160;to<br/>more&#160;than&#160;ℓ3k−1(n)&#160;−1&#160;elements&#160;of&#160;S<br/>
ℓ<br/>
r,&#160;which&#160;is&#160;a&#160;contradiction.&#160;Thus,&#160;Sr&#160;contains&#160;no&#160;elements<br/>
2k−1(n)<br/>
of&#160;rank&#160;less&#160;than&#160;k.&#160;Applying&#160;the&#160;same&#160;argument&#160;to&#160;the&#160;elements&#160;of&#160;Sr&#160;of&#160;rank&#160;r+k&#160;(and&#160;using<br/>the&#160;fact&#160;that&#160;Sr&#160;has&#160;no&#160;elements&#160;of&#160;rank&#160;r,&#160;which&#160;we&#160;just&#160;proved),&#160;we&#160;get&#160;that&#160;Sr&#160;contains&#160;no<br/>elements&#160;of&#160;rank&#160;less&#160;than&#160;2k.<br/>
Now,&#160;we&#160;let&#160;P&#160;∗<br/>
r&#160;be&#160;the&#160;poset&#160;obtained&#160;from&#160;Pr&#160;by&#160;deleting&#160;all&#160;elements&#160;of&#160;rank&#160;less&#160;than<br/>
2k.&#160;By&#160;the&#160;above&#160;argument,&#160;we&#160;can&#160;assume&#160;Sr&#160;⊆&#160;P&#160;∗r.&#160;Let&#160;D&#160;be&#160;a&#160;digraph&#160;with&#160;V&#160;(D)&#160;=&#160;P&#160;∗r<br/>containing&#160;every&#160;arc&#160;(x,&#160;y)&#160;such&#160;that<br/>
•&#160;x&#160;is&#160;comparable&#160;to&#160;y&#160;and&#160;the&#160;rank&#160;of&#160;y&#160;is&#160;closer&#160;to&#160;n&#160;than&#160;the&#160;rank&#160;of&#160;x,&#160;or<br/>
•&#160;x&#160;&lt;&#160;y&#160;and&#160;the&#160;rank&#160;of&#160;x&#160;is&#160;2n&#160;minus&#160;the&#160;rank&#160;of&#160;y.<br/>
Let&#160;Cµ&#160;be&#160;a&#160;random&#160;chain&#160;in&#160;P&#160;∗r&#160;obtained&#160;by&#160;taking&#160;a&#160;random&#160;chain&#160;in&#160;{0,&#160;1,&#160;2}n&#160;chosen<br/>according&#160;to&#160;µ&#160;and&#160;intersecting&#160;it&#160;with&#160;P&#160;∗<br/>
r&#160;.<br/>
Provided&#160;that&#160;n0(k)&#160;is&#160;sufficiently&#160;large,&#160;the<br/>
theorem&#160;now&#160;follows&#160;from&#160;Lemmas&#160;<a href="1610.01521s.html#5">2.2&#160;</a>and&#160;<a href="1610.01521s.html#12">4.13.</a><br/>
4.1<br/>
Proof&#160;of&#160;Lemma&#160;<a href="1610.01521s.html#12">4.13</a><br/>
It&#160;is&#160;clear&#160;by&#160;construction&#160;of&#160;µ&#160;that&#160;one&#160;can&#160;obtain&#160;an&#160;upper&#160;bound&#160;on&#160;P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)<br/>when&#160;x&#160;and&#160;y&#160;are&#160;in&#160;consecutive&#160;levels&#160;by&#160;bounding&#160;the&#160;‘weight&#160;functions’&#160;wi,s&#160;and&#160;w′i,s&#160;from<br/>above.&#160;Our&#160;first&#160;step&#160;is&#160;to&#160;bound&#160;the&#160;weight&#160;functions&#160;relative&#160;to&#160;one&#160;another.<br/>
Proposition&#160;4.16.&#160;For&#160;1&#160;≤&#160;i&#160;≤&#160;n&#160;−&#160;1&#160;and&#160;0&#160;≤&#160;s&#160;&lt;&#160;i/2&#160;we&#160;have&#160;w′i,s&#160;&lt;&#160;wi,s.<br/>
Proof.&#160;Define&#160;a&#160;weighting&#160;of&#160;the&#160;elements&#160;of&#160;Li+1&#160;by&#160;first&#160;assigning&#160;weight&#160;one&#160;to&#160;each&#160;element<br/>of&#160;Li&#160;and&#160;then&#160;redistributing&#160;the&#160;weight&#160;so&#160;that,&#160;for&#160;0&#160;≤&#160;s&#160;≤&#160;⌊i/2⌋,&#160;each&#160;x&#160;∈&#160;Lsi&#160;sends&#160;weight<br/>|Li|w′i,s&#160;to&#160;each&#160;y&#160;∈&#160;Lsi+1&#160;comparable&#160;to&#160;x&#160;and&#160;weight&#160;|Li|wi,s&#160;to&#160;each&#160;y&#160;∈&#160;Ls+1<br/>
i+1&#160;comparable<br/>
to&#160;x.&#160;By&#160;construction&#160;of&#160;the&#160;weight&#160;functions&#160;wi,s&#160;and&#160;w′i,s&#160;we&#160;see&#160;that,&#160;after&#160;redistributing,<br/>each&#160;element&#160;of&#160;Li&#160;has&#160;weight&#160;zero&#160;and&#160;each&#160;element&#160;of&#160;Li+1&#160;has&#160;weight&#160;|Li|/|Li+1|.<br/>
13<br/>
<hr/>
<a name=14></a><img class="yflip" src="html/1610.01521-14_1.png"/><br/>
<img class="yflip" src="html/1610.01521-14_2.png"/><br/>
<img class="yflip" src="html/1610.01521-14_3.png"/><br/>
<img class="yflip" src="html/1610.01521-14_4.png"/><br/>
<img class="yflip" src="html/1610.01521-14_5.png"/><br/>
<img class="yflip" src="html/1610.01521-14_6.png"/><br/>
<img class="yflip" src="html/1610.01521-14_7.png"/><br/>
<img class="yflip" src="html/1610.01521-14_8.png"/><br/>
<img class="yflip" src="html/1610.01521-14_9.png"/><br/>
<img class="yflip" src="html/1610.01521-14_10.png"/><br/>
<img class="yflip" src="html/1610.01521-14_11.png"/><br/>
<img class="yflip" src="html/1610.01521-14_12.png"/><br/>
<img class="yflip" src="html/1610.01521-14_13.png"/><br/>
<img class="yflip" src="html/1610.01521-14_14.png"/><br/>
<img class="yflip" src="html/1610.01521-14_15.png"/><br/>
<img class="yflip" src="html/1610.01521-14_16.png"/><br/>
<img class="yflip" src="html/1610.01521-14_17.png"/><br/>
<img class="yflip" src="html/1610.01521-14_18.png"/><br/>
<img class="yflip" src="html/1610.01521-14_19.png"/><br/>
<img class="yflip" src="html/1610.01521-14_20.png"/><br/>
<img class="yflip" src="html/1610.01521-14_21.png"/><br/>
Now,&#160;we&#160;define&#160;a&#160;second&#160;weighting&#160;of&#160;Li+1&#160;by&#160;assigning&#160;each&#160;element&#160;of&#160;Li&#160;weight&#160;one&#160;and<br/>
redistributing&#160;the&#160;weight&#160;so&#160;that&#160;each&#160;element&#160;of&#160;Lsi&#160;sends&#160;its&#160;weight&#160;evenly&#160;to&#160;the&#160;elements<br/>of&#160;Li+1&#160;comparable&#160;to&#160;it.&#160;Under&#160;this&#160;weighting,&#160;each&#160;y&#160;∈&#160;Lsi+1&#160;receives&#160;weight<br/>
s<br/>
i&#160;+&#160;1&#160;−&#160;2s<br/>
f&#160;(s)&#160;:=<br/>
+<br/>
.<br/>
n&#160;+&#160;1&#160;−&#160;s<br/>
n&#160;−&#160;s<br/>
We&#160;claim&#160;that&#160;f&#160;(s)&#160;is&#160;strictly&#160;decreasing&#160;in&#160;s&#160;for&#160;s&#160;in&#160;the&#160;range&#160;0&#160;≤&#160;s&#160;≤&#160;i+1&#160;.&#160;Indeed,&#160;for<br/>
2<br/>
0&#160;≤&#160;s&#160;≤&#160;i−1&#160;,&#160;we&#160;have<br/>
2<br/>
&#160;s&#160;+&#160;1<br/>
i&#160;−&#160;2s&#160;−&#160;1&#160;<br/>
<br/>
s<br/>
i&#160;−&#160;2s&#160;+&#160;1<br/>
f&#160;(s&#160;+&#160;1)&#160;−&#160;f&#160;(s)&#160;=<br/>
+<br/>
−<br/>
+<br/>
n&#160;−&#160;s<br/>
n&#160;−&#160;s&#160;−&#160;1<br/>
n&#160;−&#160;s&#160;+&#160;1<br/>
n&#160;−&#160;s<br/>
s(n&#160;−&#160;i&#160;−&#160;2)&#160;−&#160;(n&#160;−&#160;i)(n&#160;+&#160;1)<br/>
(n&#160;−&#160;i)(s&#160;−&#160;n&#160;−&#160;1)&#160;−&#160;2s<br/>
=<br/>
=<br/>
.<br/>
(n&#160;−&#160;s&#160;+&#160;1)(n&#160;−&#160;s)(n&#160;−&#160;s&#160;−&#160;1)<br/>
(n&#160;−&#160;s&#160;+&#160;1)(n&#160;−&#160;s)(n&#160;−&#160;s&#160;−&#160;1)<br/>
The&#160;denominator&#160;is&#160;always&#160;positive&#160;for&#160;0&#160;≤&#160;s&#160;≤&#160;n−2.&#160;If&#160;i<br/>
2<br/>
∈&#160;{n&#160;−&#160;2,&#160;n&#160;−&#160;1},&#160;then&#160;the&#160;numerator<br/>
is&#160;clearly&#160;negative.&#160;Finally,&#160;if&#160;1&#160;≤&#160;i&#160;≤&#160;n&#160;−&#160;3,&#160;then&#160;the&#160;numerator&#160;is&#160;again&#160;negative&#160;since<br/>0&#160;≤&#160;s&#160;≤&#160;i−1<br/>
&lt;&#160;n&#160;+&#160;1&#160;and&#160;n<br/>
2<br/>
≤&#160;n−2<br/>
2<br/>
−&#160;i&#160;−&#160;2&#160;&lt;&#160;n&#160;−&#160;i.&#160;Thus,&#160;f(s)&#160;is&#160;strictly&#160;decreasing&#160;in&#160;s.<br/>
Therefore,&#160;for&#160;0&#160;≤&#160;s&#160;≤&#160;i−1,&#160;the&#160;elements&#160;of&#160;L≤s<br/>
2<br/>
i+1&#160;receive&#160;more&#160;weight&#160;on&#160;average&#160;under<br/>
the&#160;second&#160;weighting&#160;than&#160;do&#160;the&#160;elements&#160;of&#160;L≥s+1<br/>
i+1<br/>
.&#160;Note&#160;that,&#160;under&#160;both&#160;redistribution<br/>
rules,&#160;all&#160;of&#160;the&#160;weight&#160;from&#160;L≤s−1<br/>
i<br/>
is&#160;sent&#160;to&#160;L≤s<br/>
i+1&#160;and&#160;all&#160;of&#160;the&#160;weight&#160;from&#160;L≥s+1<br/>
i<br/>
is&#160;sent&#160;to<br/>
L≥s+1<br/>
i+1<br/>
.&#160;Therefore,&#160;the&#160;amount&#160;of&#160;weight&#160;received&#160;by&#160;the&#160;elements&#160;of&#160;L≥s+1<br/>
i+1<br/>
versus&#160;the&#160;amount<br/>
received&#160;by&#160;elements&#160;of&#160;L≤s<br/>
i+1&#160;is&#160;only&#160;affected&#160;by&#160;the&#160;amount&#160;of&#160;weight&#160;that&#160;the&#160;elements&#160;of&#160;Lsi<br/>
choose&#160;to&#160;send&#160;to&#160;Lsi+1&#160;and&#160;Ls+1<br/>
i+1&#160;.&#160;As&#160;we&#160;have&#160;mentioned,&#160;the&#160;first&#160;redistribution&#160;rule&#160;assigns<br/>
each&#160;element&#160;of&#160;Li+1&#160;to&#160;the&#160;same&#160;weight&#160;while&#160;the&#160;second&#160;assigns&#160;more&#160;weight&#160;to&#160;elements<br/>of&#160;Li+1&#160;which&#160;have&#160;fewer&#160;coordinates&#160;equal&#160;to&#160;two.&#160;Putting&#160;this&#160;all&#160;together,&#160;it&#160;must&#160;be&#160;the<br/>case&#160;that,&#160;under&#160;the&#160;first&#160;redistribution&#160;rule,&#160;each&#160;x&#160;∈&#160;Lsi&#160;sends&#160;more&#160;weight&#160;to&#160;each&#160;element<br/>of&#160;Ls+1<br/>
i+1&#160;comparable&#160;to&#160;it&#160;than&#160;it&#160;sends&#160;to&#160;each&#160;element&#160;of&#160;Lsi+1&#160;comparable&#160;to&#160;it.&#160;This&#160;proves<br/>
that&#160;w′i,s&#160;&lt;&#160;wi,s.<br/>
We&#160;also&#160;use&#160;a&#160;similar&#160;‘weight&#160;redistribution&#160;trick’&#160;to&#160;obtain&#160;various&#160;bounds&#160;on&#160;the&#160;ratio<br/>
|Li+1|/|Li|&#160;which&#160;will&#160;be&#160;needed&#160;later&#160;in&#160;this&#160;section.&#160;Since&#160;these&#160;proofs&#160;are&#160;all&#160;fairly&#160;routine,<br/>and&#160;not&#160;particularly&#160;enlightening,&#160;we&#160;have&#160;included&#160;them&#160;in&#160;the&#160;appendix.<br/>
In&#160;what&#160;follows,&#160;it&#160;will&#160;be&#160;useful&#160;to&#160;notice&#160;that&#160;the&#160;weight&#160;functions&#160;wi,s&#160;and&#160;w′i,s&#160;exhibit<br/>
a&#160;certain&#160;symmetry&#160;around&#160;the&#160;nth&#160;level.&#160;Specifically,<br/>
<br/>
<br/>
<br/>
<br/>
|L2n−i−1|&#160;L≤n−i+s&#160;−&#160;|L2n<br/>
L≤n−i+s−1<br/>
<br/>
2n−i<br/>
<br/>
−i|&#160;&#160;2n−i−1<br/>
<br/>
w′2n−i−1,n−i+s&#160;=<br/>
<br/>
<br/>
Ln−i+s<br/>
2n−i−1&#160;|L2n−i−1||L2n−i|(s&#160;+&#160;1)<br/>
<br/>
<br/>
<br/>
<br/>
|Li+1|&#160;L≤s&#160;−&#160;|Li|&#160;L≤s&#160;<br/>
<br/>
i<br/>
<br/>
<br/>
i+1<br/>
=<br/>
=&#160;w<br/>
|Ls<br/>
i,s<br/>
(4.17)<br/>
i&#160;|&#160;|Li+1||Li|(i&#160;−&#160;2s)<br/>
and,&#160;similarly,<br/>
w2n−i−1,n−i+s−1&#160;=&#160;w′i,s.<br/>
(4.18)<br/>
Next,&#160;we&#160;prove&#160;an&#160;upper&#160;bound&#160;on&#160;wi,s&#160;which&#160;is&#160;tight&#160;when&#160;i&#160;is&#160;odd&#160;and&#160;s&#160;=&#160;i−1.&#160;An&#160;analogous<br/>
2<br/>
result&#160;for&#160;the&#160;‘upper&#160;half’&#160;of&#160;{0,&#160;1,&#160;2}n&#160;follows&#160;from&#160;<a href="1610.01521s.html#14">(4.17)</a>.<br/>
14<br/>
<hr/>
<a name=15></a><img class="yflip" src="html/1610.01521-15_1.png"/><br/>
<img class="yflip" src="html/1610.01521-15_2.png"/><br/>
<img class="yflip" src="html/1610.01521-15_3.png"/><br/>
<img class="yflip" src="html/1610.01521-15_4.png"/><br/>
<img class="yflip" src="html/1610.01521-15_5.png"/><br/>
<img class="yflip" src="html/1610.01521-15_6.png"/><br/>
<img class="yflip" src="html/1610.01521-15_7.png"/><br/>
<img class="yflip" src="html/1610.01521-15_8.png"/><br/>
<img class="yflip" src="html/1610.01521-15_9.png"/><br/>
<img class="yflip" src="html/1610.01521-15_10.png"/><br/>
<img class="yflip" src="html/1610.01521-15_11.png"/><br/>
<img class="yflip" src="html/1610.01521-15_12.png"/><br/>
<img class="yflip" src="html/1610.01521-15_13.png"/><br/>
Proposition&#160;4.19.&#160;Suppose&#160;that&#160;n&#160;≥&#160;5.&#160;Then&#160;for&#160;1&#160;≤&#160;i&#160;≤&#160;n&#160;−&#160;1&#160;and&#160;0&#160;≤&#160;s&#160;&lt;&#160;i&#160;we&#160;have<br/>
2<br/>
wi,s&#160;≤<br/>
2<br/>
.<br/>
(i+1)|Li+1|<br/>
Proof.&#160;If&#160;there&#160;is&#160;an&#160;integer&#160;s&#160;such&#160;that&#160;0&#160;≤&#160;s&#160;&lt;&#160;i&#160;and<br/>
2<br/>
2&#160;|Li|&#160;s(s&#160;+&#160;1)(n&#160;−&#160;i&#160;+&#160;s)(n&#160;−&#160;i&#160;+&#160;s&#160;+&#160;1)<br/>
(4.20)<br/>
≤&#160;(i&#160;−&#160;2s&#160;−&#160;1)(i&#160;−&#160;2s)(i&#160;−&#160;2s&#160;+&#160;1)&#160;((i&#160;+&#160;1)|Li+1|&#160;−&#160;(n&#160;−&#160;i&#160;+&#160;s&#160;+&#160;1)|Li|)&#160;,<br/>
then&#160;we&#160;let&#160;s0&#160;be&#160;the&#160;largest&#160;such&#160;integer.&#160;Otherwise,&#160;set&#160;s0&#160;:=&#160;0.&#160;Note&#160;that&#160;both&#160;sides&#160;of<br/><a href="1610.01521s.html#15">(4.20)&#160;</a>are&#160;non-negative&#160;for&#160;all&#160;s&#160;such&#160;that&#160;0&#160;≤&#160;s&#160;&lt;&#160;i&#160;,&#160;where&#160;Lemma&#160;<a href="1610.01521s.html#32">A.4&#160;</a>is&#160;used&#160;to&#160;verify<br/>
2<br/>
that&#160;the&#160;right&#160;side&#160;is&#160;non-negative.&#160;If&#160;s0&#160;≥&#160;1,&#160;then&#160;the&#160;inequality&#160;<a href="1610.01521s.html#15">(4.20)&#160;</a>must&#160;hold&#160;for&#160;all<br/>0&#160;≤&#160;i&#160;≤&#160;n−1&#160;and&#160;s&#160;such&#160;that&#160;0&#160;≤&#160;s&#160;≤&#160;s0&#160;and&#160;must&#160;fail&#160;to&#160;hold&#160;for&#160;all&#160;s&#160;such&#160;that&#160;s0+1&#160;≤&#160;s&#160;&lt;&#160;i&#160;;<br/>
2<br/>
this&#160;is&#160;because,&#160;for&#160;fixed&#160;0&#160;≤&#160;i&#160;≤&#160;n&#160;−&#160;1&#160;and&#160;s&#160;in&#160;the&#160;range&#160;0&#160;≤&#160;s&#160;&lt;&#160;i&#160;,&#160;the&#160;left&#160;side&#160;of&#160;<a href="1610.01521s.html#15">(4.20)&#160;</a>is<br/>
2<br/>
increasing&#160;in&#160;s&#160;and&#160;the&#160;right&#160;side&#160;is&#160;decreasing&#160;in&#160;s.<br/>
By&#160;<a href="1610.01521s.html#11">(4.11)</a>,&#160;the&#160;inequality&#160;wi,s&#160;≤<br/>
2<br/>
can&#160;be&#160;rewritten&#160;as&#160;follows:<br/>
(i+1)|Li+1|<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
(i&#160;+&#160;1)&#160;|Li|&#160;L≥s+1&#160;−&#160;|Li+1|&#160;L≥s+1&#160;≤&#160;2&#160;|Ls<br/>
<br/>
i+1<br/>
<br/>
<br/>
i<br/>
<br/>
i&#160;|&#160;|Li|&#160;(i&#160;−&#160;2s)<br/>
or,&#160;equivalently,<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
|Li|&#160;(i&#160;+&#160;1)&#160;L≥s+1&#160;−&#160;2(i&#160;−&#160;2s)&#160;|Ls<br/>
≤&#160;|Li+1|&#160;(i&#160;+&#160;1)&#160;L≥s+1&#160;.<br/>
(4.21)<br/>
<br/>
i+1<br/>
<br/>
i&#160;|<br/>
<br/>
i<br/>
<br/>
Our&#160;goal&#160;is&#160;to&#160;prove&#160;that&#160;<a href="1610.01521s.html#15">(4.21)&#160;</a>holds&#160;for&#160;0&#160;≤&#160;s&#160;&lt;&#160;i&#160;.&#160;The&#160;argument&#160;will&#160;either&#160;use&#160;induction<br/>
2<br/>
on&#160;s&#160;or&#160;induction&#160;on&#160;&#160;i&#160;<br/>
2<br/>
−&#160;s&#160;depending&#160;on&#160;whether&#160;s&#160;≤&#160;s0&#160;or&#160;s&#160;≥&#160;s0&#160;+&#160;1.&#160;Before&#160;proving&#160;the<br/>
case&#160;s&#160;≤&#160;s0,&#160;though,&#160;we&#160;need&#160;to&#160;verify&#160;the&#160;‘base&#160;case’&#160;s&#160;=&#160;0.<br/>
Case&#160;1:&#160;s&#160;=&#160;0.<br/>
In&#160;this&#160;case,&#160;<a href="1610.01521s.html#15">(4.21)&#160;</a>becomes<br/>
|L<br/>
<br/>
<br/>
<br/>
i|&#160;(i&#160;+&#160;1)&#160;|Li+1|&#160;−&#160;(i&#160;+&#160;1)&#160;L0i+1&#160;−&#160;2i&#160;L0i&#160;≤&#160;|Li+1|&#160;(i&#160;+&#160;1)&#160;|Li|&#160;−&#160;L0i&#160;.<br/>
Since&#160;(i&#160;+&#160;1)&#160;<br/>
<br/>
<br/>
<br/>
<br/>
L0<br/>
i+1&#160;=&#160;(i&#160;+&#160;1)<br/>
n<br/>
=&#160;(n<br/>
=&#160;(n<br/>
i+1<br/>
−&#160;i)&#160;ni<br/>
−&#160;i)&#160;L0i,&#160;this&#160;simplifies&#160;to<br/>
(i&#160;+&#160;1)&#160;|Li+1|&#160;≤&#160;(n&#160;+&#160;i)&#160;|Li|&#160;.<br/>
(4.22)<br/>
To&#160;prove&#160;<a href="1610.01521s.html#15">(4.22)</a>,&#160;we&#160;observe&#160;that&#160;each&#160;element&#160;of&#160;Lri&#160;is&#160;comparable&#160;to&#160;n&#160;−&#160;r&#160;elements&#160;of&#160;Li+1<br/>and&#160;each&#160;element&#160;of&#160;Lri+1&#160;comparable&#160;to&#160;i&#160;+&#160;1&#160;−&#160;r&#160;elements&#160;of&#160;Li.&#160;Therefore,<br/>
⌊i+1<br/>
2&#160;⌋<br/>
⌊&#160;i2⌋<br/>
X<br/>
X<br/>
(i&#160;+&#160;1&#160;−&#160;r)&#160;<br/>
<br/>
Lr<br/>
i+1&#160;=<br/>
(n&#160;−&#160;r)&#160;|Lri|&#160;.<br/>
r=0<br/>
r=0<br/>
This&#160;equality&#160;can&#160;be&#160;rewritten&#160;as&#160;follows:<br/>
⌊i+1<br/>
2&#160;⌋<br/>
⌊&#160;i2⌋<br/>
X<br/>
X<br/>
(i&#160;+&#160;1)&#160;|L<br/>
<br/>
i+1|&#160;−<br/>
r&#160;Lri+1&#160;=&#160;(n&#160;+&#160;i)&#160;|Li|&#160;−<br/>
(i&#160;+&#160;r)&#160;|Lri|&#160;.<br/>
r=0<br/>
r=0<br/>
15<br/>
<hr/>
<a name=16></a><img class="yflip" src="html/1610.01521-16_1.png"/><br/>
<img class="yflip" src="html/1610.01521-16_2.png"/><br/>
<img class="yflip" src="html/1610.01521-16_3.png"/><br/>
<img class="yflip" src="html/1610.01521-16_4.png"/><br/>
<img class="yflip" src="html/1610.01521-16_5.png"/><br/>
<img class="yflip" src="html/1610.01521-16_6.png"/><br/>
<img class="yflip" src="html/1610.01521-16_7.png"/><br/>
<img class="yflip" src="html/1610.01521-16_8.png"/><br/>
<img class="yflip" src="html/1610.01521-16_9.png"/><br/>
<img class="yflip" src="html/1610.01521-16_10.png"/><br/>
<img class="yflip" src="html/1610.01521-16_11.png"/><br/>
<img class="yflip" src="html/1610.01521-16_12.png"/><br/>
<img class="yflip" src="html/1610.01521-16_13.png"/><br/>
<img class="yflip" src="html/1610.01521-16_14.png"/><br/>
So,&#160;after&#160;a&#160;change&#160;of&#160;index,&#160;we&#160;see&#160;that&#160;<a href="1610.01521s.html#15">(4.22)&#160;</a>is&#160;equivalent&#160;to<br/>
⌊&#160;i2⌋<br/>
⌊i−1<br/>
2&#160;⌋<br/>
X<br/>
X<br/>
(i&#160;+&#160;r)&#160;|Lr<br/>
<br/>
i&#160;|&#160;≥<br/>
(r&#160;+&#160;1)&#160;Lr+1<br/>
i+1&#160;&#160;.<br/>
r=0<br/>
r=0<br/>
For&#160;0&#160;≤&#160;r&#160;≤&#160;i−1&#160;&#160;we&#160;have<br/>
2<br/>
<br/>
<br/>
n&#160;i&#160;−&#160;r<br/>
(i&#160;+&#160;r)&#160;<br/>
i−r<br/>
Lr+1<br/>
(i&#160;+&#160;r)&#160;|Lr<br/>
i+1<br/>
r<br/>
i&#160;|&#160;=&#160;(i&#160;+&#160;r)<br/>
=<br/>
i&#160;−&#160;r<br/>
r<br/>
i−r<br/>
r+1<br/>
(i&#160;+&#160;r)(r&#160;+&#160;1)<br/>
=<br/>
<br/>
<br/>
<br/>
Lr+1&#160;≥&#160;(r&#160;+&#160;1)&#160;Lr+1<br/>
i&#160;−&#160;2r<br/>
i+1<br/>
i+1<br/>
and&#160;so&#160;<a href="1610.01521s.html#15">(4.22)&#160;</a>holds.&#160;This&#160;completes&#160;the&#160;proof&#160;in&#160;this&#160;case.<br/>
Case&#160;2:&#160;1&#160;≤&#160;s&#160;≤&#160;s0.<br/>
We&#160;can&#160;assume,&#160;by&#160;induction&#160;and&#160;the&#160;previous&#160;case,&#160;that&#160;<a href="1610.01521s.html#15">(4.21)&#160;</a>is&#160;true&#160;if&#160;s&#160;is&#160;replaced&#160;by<br/>
s&#160;−&#160;1.&#160;That&#160;is,&#160;we&#160;assume&#160;that&#160;the&#160;following&#160;inequality&#160;is&#160;true:<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
|L<br/>
<br/>
i|&#160;(i&#160;+&#160;1)&#160;L≥s&#160;&#160;−&#160;2(i&#160;−&#160;2s&#160;+&#160;2)&#160;<br/>
<br/>
<br/>
Ls−1<br/>
≤&#160;|Li+1|&#160;(i&#160;+&#160;1)&#160;L≥s&#160;.<br/>
<br/>
i+1<br/>
i<br/>
<br/>
i<br/>
<br/>
Subtracting&#160;this&#160;inequality&#160;from&#160;<a href="1610.01521s.html#15">(4.21)</a>,&#160;we&#160;see&#160;that&#160;it&#160;suffices&#160;to&#160;prove&#160;that<br/>
|L<br/>
<br/>
<br/>
i|&#160;(i&#160;+&#160;1)&#160;Ls+1<br/>
i+1&#160;&#160;−&#160;2(i&#160;−&#160;2s)&#160;|Lsi|&#160;+&#160;2(i&#160;−&#160;2s&#160;+&#160;2)&#160;Ls−1<br/>
i<br/>
<br/>
≤&#160;|L<br/>
<br/>
i+1|&#160;(i&#160;+&#160;1)&#160;Ls+1<br/>
i<br/>
&#160;.<br/>
After&#160;substituting&#160;the&#160;values&#160;of&#160;<br/>
<br/>
<br/>
<br/>
Ls+1<br/>
i+1&#160;,&#160;|Lsi|,&#160;Ls−1<br/>
i<br/>
&#160;and&#160;<br/>
Ls+1<br/>
i<br/>
&#160;into&#160;the&#160;above&#160;inequality,&#160;it<br/>
becomes<br/>
<br/>
<br/>
n&#160;i&#160;−&#160;s<br/>
<br/>
n&#160;i&#160;−&#160;s<br/>
<br/>
n<br/>
i&#160;−&#160;s&#160;+&#160;1<br/>
|Li|&#160;(i&#160;+&#160;1)<br/>
−&#160;2(i&#160;−&#160;2s)<br/>
+&#160;2(i&#160;−&#160;2s&#160;+&#160;2)<br/>
i&#160;−&#160;s<br/>
s&#160;+&#160;1<br/>
i&#160;−&#160;s<br/>
s<br/>
i&#160;−&#160;s&#160;+&#160;1<br/>
s&#160;−&#160;1<br/>
<br/>
n<br/>
i&#160;−&#160;s&#160;−&#160;1<br/>
≤&#160;|Li+1|&#160;(i&#160;+&#160;1)<br/>
.<br/>
i&#160;−&#160;s&#160;−&#160;1<br/>
s&#160;+&#160;1<br/>
By&#160;simplifying&#160;this&#160;expression,&#160;one&#160;can&#160;show&#160;that&#160;it&#160;is&#160;in&#160;fact&#160;equivalent&#160;to&#160;<a href="1610.01521s.html#15">(4.20)</a>,&#160;which&#160;holds<br/>for&#160;s&#160;because&#160;s&#160;≤&#160;s0.&#160;This&#160;completes&#160;the&#160;proof&#160;in&#160;this&#160;case.<br/>
Case&#160;3:&#160;s0&#160;+&#160;1&#160;≤&#160;s&#160;&lt;&#160;i&#160;.<br/>
2<br/>
In&#160;the&#160;case&#160;that&#160;i&#160;is&#160;odd&#160;and&#160;s&#160;=&#160;i−1&#160;we&#160;have&#160;w<br/>
by&#160;definition&#160;and&#160;so&#160;the<br/>
2<br/>
i,s&#160;=<br/>
2<br/>
(i+1)|Li+1|<br/>
result&#160;holds&#160;with&#160;equality.&#160;If&#160;i&#160;is&#160;even&#160;and&#160;s&#160;=&#160;i−2&#160;,&#160;then&#160;w<br/>
by&#160;<a href="1610.01521s.html#11">(4.11)</a>.<br/>
2<br/>
i,s&#160;=<br/>
2<br/>
i|Li+1|&#160;−<br/>
4<br/>
(2n−i)|Li|<br/>
In&#160;this&#160;case,&#160;the&#160;bound&#160;wi,s&#160;≤<br/>
2<br/>
reduces&#160;to&#160;the&#160;following:<br/>
(i+1)|Li+1|<br/>
(2n&#160;−&#160;i)|Li|&#160;≤&#160;2(i&#160;+&#160;1)|Li+1|.<br/>
Since&#160;1&#160;≤&#160;i&#160;≤&#160;n&#160;−&#160;1,&#160;this&#160;inequality&#160;holds&#160;by&#160;Lemmas&#160;<a href="1610.01521s.html#32">A.4,&#160;</a><a href="1610.01521s.html#33">A.5&#160;</a>and&#160;<a href="1610.01521s.html#34">A.6.</a><br/>
So,&#160;we&#160;are&#160;done&#160;unless&#160;s<br/>
<br/>
0&#160;&lt;&#160;s&#160;&lt;&#160;i2&#160;−&#160;1.&#160;We&#160;can&#160;assume,&#160;by&#160;induction&#160;on&#160;&#160;i2&#160;−&#160;s,&#160;that<br/>
<a href="1610.01521s.html#15">(4.21)&#160;</a>is&#160;true&#160;if&#160;s&#160;is&#160;replaced&#160;by&#160;s&#160;+&#160;1.&#160;That&#160;is,&#160;we&#160;assume&#160;that&#160;the&#160;following&#160;inequality&#160;holds:<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
|L<br/>
<br/>
i|&#160;(i&#160;+&#160;1)&#160;L≥s+2&#160;−&#160;2(i&#160;−&#160;2s&#160;−&#160;2)&#160;<br/>
<br/>
<br/>
Ls+1<br/>
≤&#160;|Li+1|&#160;(i&#160;+&#160;1)&#160;L≥s+2&#160;.<br/>
<br/>
i+1<br/>
<br/>
i<br/>
<br/>
i<br/>
<br/>
16<br/>
<hr/>
<a name=17></a><img class="yflip" src="html/1610.01521-17_1.png"/><br/>
<img class="yflip" src="html/1610.01521-17_2.png"/><br/>
<img class="yflip" src="html/1610.01521-17_3.png"/><br/>
<img class="yflip" src="html/1610.01521-17_4.png"/><br/>
<img class="yflip" src="html/1610.01521-17_5.png"/><br/>
<img class="yflip" src="html/1610.01521-17_6.png"/><br/>
<img class="yflip" src="html/1610.01521-17_7.png"/><br/>
<img class="yflip" src="html/1610.01521-17_8.png"/><br/>
<img class="yflip" src="html/1610.01521-17_9.png"/><br/>
<img class="yflip" src="html/1610.01521-17_10.png"/><br/>
<img class="yflip" src="html/1610.01521-17_11.png"/><br/>
Similar&#160;to&#160;the&#160;proof&#160;of&#160;the&#160;previous&#160;case,&#160;we&#160;can&#160;derive&#160;<a href="1610.01521s.html#15">(4.21)&#160;</a>from&#160;the&#160;above&#160;inequality<br/>provided&#160;that&#160;we&#160;can&#160;prove&#160;the&#160;following:<br/>
|L<br/>
<br/>
<br/>
i|&#160;(i&#160;+&#160;1)&#160;Ls+2<br/>
i+1&#160;&#160;−&#160;2(i&#160;−&#160;2s&#160;−&#160;2)&#160;Ls+1<br/>
i<br/>
&#160;+&#160;2(i&#160;−&#160;2s)&#160;|Ls<br/>
i&#160;|<br/>
&gt;&#160;|L<br/>
<br/>
i+1|&#160;(i&#160;+&#160;1)&#160;Ls+2<br/>
i<br/>
&#160;.<br/>
Simplifying&#160;this&#160;expression&#160;in&#160;a&#160;similar&#160;fashion&#160;to&#160;the&#160;proof&#160;of&#160;the&#160;previous&#160;case,&#160;we&#160;see&#160;that<br/>it&#160;is&#160;equivalent&#160;to&#160;the&#160;following&#160;inequality:<br/>
2&#160;|Li|&#160;(s&#160;+&#160;1)(s&#160;+&#160;2)(n&#160;−&#160;i&#160;+&#160;s&#160;+&#160;1)(n&#160;−&#160;i&#160;+&#160;s&#160;+&#160;2)<br/>
&gt;&#160;(i&#160;−&#160;2s&#160;−&#160;3)(i&#160;−&#160;2s&#160;−&#160;2)(i&#160;−&#160;2s&#160;−&#160;1)&#160;((i&#160;+&#160;1)&#160;|Li+1|&#160;−&#160;(n&#160;−&#160;i&#160;+&#160;s&#160;+&#160;2)&#160;|Li|)&#160;.<br/>
This&#160;is&#160;precisely&#160;the&#160;negation&#160;of&#160;<a href="1610.01521s.html#15">(4.20)&#160;</a>with&#160;s&#160;is&#160;replaced&#160;by&#160;s&#160;+&#160;1.&#160;This&#160;inequality&#160;holds<br/>because&#160;s&#160;&gt;&#160;s0&#160;and&#160;s0&#160;was&#160;chosen&#160;to&#160;be&#160;the&#160;largest&#160;index&#160;satisfying&#160;<a href="1610.01521s.html#15">(4.20)</a>.&#160;This&#160;completes<br/>the&#160;proof&#160;of&#160;the&#160;proposition.<br/>
We&#160;derive&#160;the&#160;following&#160;corollary.<br/>
Corollary&#160;4.23.&#160;For&#160;n&#160;≥&#160;5&#160;and&#160;0&#160;≤&#160;i&#160;≤&#160;2n&#160;−&#160;1,&#160;if&#160;x&#160;∈&#160;Li&#160;and&#160;y&#160;∈&#160;Li+1&#160;such&#160;that&#160;x&#160;&lt;&#160;y,&#160;then<br/>
(2|Li|/(i&#160;+&#160;1)|Li+1|&#160;if&#160;i&#160;≤&#160;n&#160;−&#160;1<br/>
P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;≤&#160;2/(2n&#160;−&#160;i)<br/>
otherwise.<br/>
Proof.&#160;Let&#160;max{0,&#160;i&#160;−&#160;n}&#160;≤&#160;s&#160;≤&#160;i/2&#160;so&#160;that&#160;x&#160;∈&#160;Lsi.&#160;By&#160;construction,&#160;P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;is<br/>either&#160;equal&#160;to&#160;wi,s|Li|&#160;or&#160;w′i,s|Li|.<br/>
Suppose&#160;first&#160;that&#160;i&#160;≤&#160;n&#160;−&#160;1.&#160;If&#160;s&#160;&lt;&#160;i/2,&#160;then&#160;by&#160;Propositions&#160;<a href="1610.01521s.html#13">4.16&#160;</a>and&#160;<a href="1610.01521s.html#15">4.19,&#160;</a>we&#160;have<br/>
that&#160;wi,s&#160;and&#160;w′i,s&#160;are&#160;both&#160;bounded&#160;above&#160;by<br/>
2<br/>
and&#160;we&#160;are&#160;done.&#160;In&#160;the&#160;case&#160;that<br/>
(i+1)|Li+1|<br/>
i&#160;is&#160;even&#160;and&#160;s&#160;=&#160;i/2,&#160;we&#160;have&#160;that&#160;wi,i/2&#160;=&#160;0&#160;and&#160;w′<br/>
=<br/>
2<br/>
which&#160;is&#160;bounded&#160;above<br/>
i,i/2<br/>
2n−i<br/>
by<br/>
2<br/>
by&#160;Lemmas&#160;<a href="1610.01521s.html#32">A.4,&#160;</a><a href="1610.01521s.html#33">A.5&#160;</a>and&#160;<a href="1610.01521s.html#34">A.6.&#160;</a>This&#160;completes&#160;the&#160;proof&#160;for&#160;i&#160;≤&#160;n&#160;−&#160;1.&#160;The<br/>
(i+1)|Li+1|<br/>
case&#160;i&#160;≥&#160;n&#160;follows&#160;from&#160;the&#160;case&#160;i&#160;≤&#160;n&#160;−&#160;1&#160;via&#160;equations&#160;<a href="1610.01521s.html#14">(4.17)&#160;</a>and&#160;<a href="1610.01521s.html#14">(4.18)&#160;</a>and&#160;the&#160;fact&#160;that<br/>P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;=&#160;P&#160;(x&#160;∈&#160;Cµ&#160;|&#160;y&#160;∈&#160;Cµ)&#160;|Li+1|/|Li|.<br/>
We&#160;are&#160;now&#160;ready&#160;to&#160;prove&#160;Lemma&#160;<a href="1610.01521s.html#12">4.13.&#160;</a>The&#160;proof&#160;is&#160;divided&#160;into&#160;three&#160;cases&#160;depending<br/>
on&#160;whether<br/>
•&#160;|j&#160;−&#160;i|&#160;is&#160;‘small,’<br/>
•&#160;|j&#160;−&#160;i|&#160;is&#160;‘large’&#160;and&#160;i&#160;+&#160;j&#160;=&#160;2n,&#160;or<br/>
•&#160;|j&#160;−&#160;i|&#160;is&#160;‘large’&#160;and&#160;i&#160;+&#160;j&#160;6=&#160;2n.<br/>
The&#160;first&#160;case&#160;is&#160;done&#160;by&#160;summing&#160;over&#160;all&#160;chains&#160;containing&#160;x&#160;and&#160;y&#160;and&#160;applying&#160;<a href="1610.01521s.html#10">(4.6)<br/></a>and&#160;Corollary&#160;<a href="1610.01521s.html#17">4.23&#160;</a>to&#160;each&#160;of&#160;them.&#160;In&#160;the&#160;second&#160;case,&#160;we&#160;assume&#160;that&#160;(x,&#160;y)&#160;is&#160;chosen<br/>from&#160;Li&#160;×&#160;Lj&#160;to&#160;maximise&#160;P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;and&#160;obtain&#160;a&#160;lower&#160;bound&#160;on&#160;the&#160;number&#160;of<br/>y′&#160;∈&#160;Lj&#160;comparable&#160;to&#160;x&#160;such&#160;that&#160;P&#160;(y′&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;=&#160;P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ).&#160;Since&#160;the&#160;sum&#160;of<br/>P&#160;(y′&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;over&#160;all&#160;such&#160;y′&#160;is&#160;at&#160;most&#160;one,&#160;this&#160;lower&#160;bound&#160;on&#160;the&#160;number&#160;of&#160;such&#160;y′<br/>gives&#160;us&#160;an&#160;upper&#160;bound&#160;on&#160;P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ).&#160;The&#160;third&#160;case&#160;is&#160;done&#160;by&#160;a&#160;simple&#160;inductive<br/>trick&#160;which&#160;uses&#160;the&#160;first&#160;two&#160;cases.<br/>
17<br/>
<hr/>
<a name=18></a><img class="yflip" src="html/1610.01521-18_1.png"/><br/>
<img class="yflip" src="html/1610.01521-18_2.png"/><br/>
<img class="yflip" src="html/1610.01521-18_3.png"/><br/>
<img class="yflip" src="html/1610.01521-18_4.png"/><br/>
<img class="yflip" src="html/1610.01521-18_5.png"/><br/>
<img class="yflip" src="html/1610.01521-18_6.png"/><br/>
<img class="yflip" src="html/1610.01521-18_7.png"/><br/>
<img class="yflip" src="html/1610.01521-18_8.png"/><br/>
<img class="yflip" src="html/1610.01521-18_9.png"/><br/>
<img class="yflip" src="html/1610.01521-18_10.png"/><br/>
<img class="yflip" src="html/1610.01521-18_11.png"/><br/>
<img class="yflip" src="html/1610.01521-18_12.png"/><br/>
<img class="yflip" src="html/1610.01521-18_13.png"/><br/>
<img class="yflip" src="html/1610.01521-18_14.png"/><br/>
<img class="yflip" src="html/1610.01521-18_15.png"/><br/>
<img class="yflip" src="html/1610.01521-18_16.png"/><br/>
<img class="yflip" src="html/1610.01521-18_17.png"/><br/>
<img class="yflip" src="html/1610.01521-18_18.png"/><br/>
<img class="yflip" src="html/1610.01521-18_19.png"/><br/>
<img class="yflip" src="html/1610.01521-18_20.png"/><br/>
<img class="yflip" src="html/1610.01521-18_21.png"/><br/>
<img class="yflip" src="html/1610.01521-18_22.png"/><br/>
Proof&#160;of&#160;Lemma&#160;<a href="1610.01521s.html#12">4.13.&#160;</a>Let&#160;k&#160;≥&#160;1&#160;be&#160;a&#160;fixed&#160;integer&#160;and&#160;let&#160;n&#160;be&#160;sufficiently&#160;large&#160;with&#160;respect<br/>to&#160;k.&#160;Let&#160;i,&#160;j&#160;be&#160;integers&#160;satisfying&#160;the&#160;hypotheses&#160;of&#160;the&#160;lemma.&#160;Note&#160;that,&#160;by&#160;the&#160;symmetry<br/>of&#160;µ&#160;around&#160;level&#160;n&#160;(i.e.&#160;by&#160;equations&#160;<a href="1610.01521s.html#14">(4.17)&#160;</a>and&#160;<a href="1610.01521s.html#14">(4.18)</a>),&#160;we&#160;can&#160;assume&#160;that&#160;i&#160;&lt;&#160;n.&#160;The<br/>assumption&#160;|j&#160;−&#160;n|&#160;≤&#160;|i&#160;−&#160;n|&#160;can&#160;therefore&#160;be&#160;rewritten&#160;as&#160;i&#160;&lt;&#160;j&#160;and&#160;i&#160;+&#160;j&#160;≤&#160;2n.<br/>
Case&#160;1:&#160;k&#160;≤&#160;j&#160;−&#160;i&#160;≤&#160;11n/10.<br/>
It&#160;is&#160;clear&#160;that&#160;P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;is&#160;equal&#160;to&#160;the&#160;sum&#160;of&#160;P&#160;(zi+1,&#160;.&#160;.&#160;.&#160;,&#160;zj&#160;∈&#160;Cµ&#160;|&#160;zi&#160;∈&#160;Cµ)&#160;over<br/>
all&#160;sequences&#160;zi&#160;&lt;&#160;zi+1&#160;&lt;&#160;·&#160;·&#160;·&#160;&lt;&#160;zj&#160;such&#160;that&#160;zi&#160;=&#160;x&#160;and&#160;zj&#160;=&#160;y.&#160;The&#160;number&#160;of&#160;such&#160;sequences<br/>is&#160;clearly&#160;bounded&#160;above&#160;by&#160;(j&#160;−&#160;i)!&#160;and,&#160;for&#160;every&#160;such&#160;sequence,&#160;we&#160;have<br/>
j−1<br/>
Y<br/>
P&#160;(zi+1,&#160;.&#160;.&#160;.&#160;,&#160;zj&#160;∈&#160;Cµ&#160;|&#160;zi&#160;∈&#160;Cµ)&#160;=<br/>
P&#160;(zr+1&#160;∈&#160;Cµ&#160;|&#160;zr&#160;∈&#160;Cµ)<br/>
r=i<br/>
by&#160;<a href="1610.01521s.html#10">(4.6)</a>.&#160;For&#160;i&#160;≤&#160;r&#160;≤&#160;n&#160;−&#160;1,&#160;we&#160;have&#160;that&#160;P&#160;(zr+1&#160;∈&#160;Cµ&#160;|&#160;zr&#160;∈&#160;Cµ)&#160;≤<br/>
2|Li|<br/>
by&#160;Corol-<br/>
(i+1)|Li+1|&#160;≤&#160;2<br/>
n<br/>
lary&#160;<a href="1610.01521s.html#17">4.23&#160;</a>and&#160;Lemmas&#160;<a href="1610.01521s.html#32">A.4,&#160;</a><a href="1610.01521s.html#33">A.5&#160;</a>and&#160;<a href="1610.01521s.html#34">A.6&#160;</a>and&#160;for&#160;n&#160;≤&#160;r&#160;≤&#160;j−1&#160;we&#160;have&#160;P&#160;(zr+1&#160;∈&#160;Cµ&#160;|&#160;zr&#160;∈&#160;Cµ)&#160;≤<br/>
2<br/>
by&#160;Corollary&#160;<a href="1610.01521s.html#17">4.23.&#160;</a>Since&#160;i&#160;+&#160;j<br/>
and&#160;so&#160;we&#160;get<br/>
2n−r<br/>
≤&#160;2n,&#160;we&#160;have&#160;that&#160;i&#160;≤&#160;n&#160;−&#160;j−i<br/>
2<br/>
&#160;2&#160;⌈(j−i)/2⌉<br/>
2⌊(j−i)/2⌋<br/>
P&#160;(zi+1,&#160;.&#160;.&#160;.&#160;,&#160;zj&#160;∈&#160;Cµ&#160;|&#160;zi&#160;∈&#160;Cµ)&#160;≤<br/>
n<br/>
n(n&#160;−&#160;1)&#160;·&#160;·&#160;·&#160;(n&#160;−&#160;⌊(j&#160;−&#160;i)/2⌋&#160;+&#160;1)<br/>
2j−i(n&#160;−&#160;⌊(j&#160;−&#160;i)/2⌋)!<br/>
=<br/>
.<br/>
n⌈(j−i)/2⌉n!<br/>
As&#160;mentioned&#160;earlier,&#160;the&#160;number&#160;of&#160;such&#160;sequences&#160;is&#160;at&#160;most&#160;(j&#160;−&#160;i)!&#160;and&#160;so&#160;we&#160;obtain<br/>
2j−i(j&#160;−&#160;i)!(n&#160;−&#160;⌊(j&#160;−&#160;i)/2⌋)!<br/>
P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;≤<br/>
.<br/>
(4.24)<br/>
n⌈(j−i)/2⌉n!<br/>
In&#160;the&#160;case&#160;j&#160;−&#160;i&#160;=&#160;k,&#160;the&#160;right&#160;side&#160;is&#160;at&#160;most&#160;2k&#160;n−1&#160;which,&#160;by&#160;<a href="1610.01521s.html#3">(1.5)&#160;</a>and&#160;the&#160;fact&#160;that<br/>
k<br/>
ℓ<br/>
<br/>
−1<br/>
2(n)&#160;−&#160;1&#160;=&#160;n−1,&#160;is&#160;less&#160;than&#160;ℓ3k−1(n)&#160;−&#160;1<br/>
for&#160;n<br/>
ℓ<br/>
0(k)&#160;sufficiently&#160;large&#160;and&#160;so&#160;we&#160;are&#160;done.<br/>
1(n)<br/>
2<br/>
ℓ2k−1(n)<br/>
Also,&#160;the&#160;right&#160;side&#160;is&#160;decreasing&#160;in&#160;j&#160;−&#160;i&#160;for&#160;k&#160;≤&#160;j&#160;−&#160;i&#160;≤&#160;n/10&#160;and&#160;so&#160;we&#160;are&#160;done&#160;for&#160;j&#160;−&#160;i&#160;in<br/>this&#160;range&#160;as&#160;well.<br/>
So,&#160;we&#160;assume&#160;that&#160;n/10&#160;&lt;&#160;j&#160;−&#160;i&#160;≤&#160;11n/10.&#160;If&#160;we&#160;define&#160;c&#160;:=&#160;j−i,&#160;then&#160;<a href="1610.01521s.html#18">(4.24)&#160;</a>can&#160;be<br/>
n<br/>
rewritten&#160;as<br/>
2cn(cn)!(n&#160;−&#160;⌊cn/2⌋)!<br/>
P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;≤<br/>
.<br/>
n⌈cn/2⌉n!<br/>
Applying&#160;Stirling’s&#160;Approximation,&#160;we&#160;see&#160;that&#160;the&#160;right&#160;side&#160;is&#160;bounded&#160;above&#160;by<br/>
&#160;√<br/>
n(1−c/2)&#160;<br/>
n2cn&#160;cn&#160;cn&#160;&#160;n(1−c/2)<br/>
e<br/>
e<br/>
√&#160;&#160;(2c)c&#160;(1&#160;−&#160;c/2)&#160;n<br/>
O&#160;<br/>
&#160;=&#160;O<br/>
n<br/>
.<br/>
<br/>
ncn/2&#160;n&#160;n<br/>
<br/>
ec/2(1&#160;−&#160;c/2)c/2<br/>
e<br/>
Notice&#160;that&#160;(2c)c(1−c/2)&#160;&lt;&#160;0.99&#160;for&#160;1/10&#160;&lt;&#160;c&#160;≤&#160;11/10&#160;and&#160;so&#160;the&#160;above&#160;expression&#160;decreases<br/>
ec/2(1−c/2)c/2<br/>
<br/>
−1<br/>
exponentially&#160;with&#160;n&#160;and&#160;therefore&#160;is&#160;less&#160;than<br/>
ℓ3k−1(n)&#160;−&#160;1<br/>
for&#160;n<br/>
ℓ<br/>
0(k)&#160;sufficiently&#160;large.<br/>
2k−1(n)<br/>
This&#160;completes&#160;the&#160;proof&#160;in&#160;this&#160;case.<br/>
Case&#160;2:&#160;i&#160;+&#160;j&#160;=&#160;2n&#160;and&#160;i&#160;&lt;&#160;9n/20.<br/>
18<br/>
<hr/>
<a name=19></a><img class="yflip" src="html/1610.01521-19_1.png"/><br/>
<img class="yflip" src="html/1610.01521-19_2.png"/><br/>
<img class="yflip" src="html/1610.01521-19_3.png"/><br/>
<img class="yflip" src="html/1610.01521-19_4.png"/><br/>
In&#160;this&#160;case,&#160;we&#160;suppose&#160;further&#160;that&#160;the&#160;pair&#160;(x,&#160;y)&#160;is&#160;chosen&#160;from&#160;Li&#160;×&#160;L2n−i&#160;so&#160;that<br/>
P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;is&#160;maximised.&#160;We&#160;prove&#160;the&#160;following&#160;claim.<br/>
Claim&#160;4.25.&#160;If&#160;there&#160;exist&#160;a&#160;coordinate&#160;α&#160;∈&#160;[n]&#160;such&#160;that&#160;xα&#160;=&#160;0&#160;and&#160;yα&#160;=&#160;2,&#160;then&#160;for&#160;every<br/>coordinate&#160;β&#160;∈&#160;[n]&#160;with&#160;xβ&#160;=&#160;1&#160;we&#160;have&#160;yβ&#160;=&#160;2.<br/>
Proof.&#160;Suppose&#160;to&#160;the&#160;contrary&#160;that&#160;there&#160;is&#160;a&#160;coordinate&#160;α&#160;∈&#160;[n]&#160;such&#160;that&#160;xα&#160;=&#160;0&#160;and&#160;yα&#160;=&#160;2<br/>and&#160;a&#160;coordinate&#160;β&#160;∈&#160;[n]&#160;with&#160;xβ&#160;=&#160;yβ&#160;=&#160;1.&#160;Let&#160;τα,β&#160;:&#160;{0,&#160;1,&#160;2}n&#160;→&#160;{0,&#160;1,&#160;2}n&#160;be&#160;the&#160;function<br/>which&#160;exchanges&#160;the&#160;αth&#160;coordinate&#160;with&#160;the&#160;βth&#160;coordinate.&#160;Note&#160;that&#160;x&#160;&lt;&#160;τα,β(y).&#160;Our<br/>goal&#160;is&#160;to&#160;show&#160;that<br/>
P&#160;(τα,β(y)&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;&gt;&#160;P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)<br/>
which&#160;will&#160;contradict&#160;our&#160;choice&#160;of&#160;x&#160;and&#160;y.<br/>
Given&#160;a&#160;sequence&#160;Z&#160;=&#160;(zi,&#160;.&#160;.&#160;.&#160;,&#160;z2n−i)&#160;of&#160;elements&#160;of&#160;{0,&#160;1,&#160;2}n&#160;with&#160;zi&#160;&lt;&#160;·&#160;·&#160;·&#160;&lt;&#160;z2n−i,&#160;zi&#160;=&#160;x<br/>
and&#160;z2n−i&#160;=&#160;y&#160;define&#160;ℓ(Z)&#160;to&#160;be&#160;the&#160;smallest&#160;integer&#160;ℓ&#160;such&#160;that&#160;the&#160;αth&#160;coordinate&#160;of&#160;zℓ&#160;is&#160;a<br/>two.&#160;For&#160;every&#160;such&#160;sequence,&#160;define&#160;another&#160;sequence&#160;π(Z)&#160;as&#160;follows:<br/>
π(Z)&#160;:=&#160;z<br/>
<br/>
i,&#160;.&#160;.&#160;.&#160;,&#160;zℓ(Z)−1,&#160;τα,β&#160;zℓ(Z)&#160;,&#160;.&#160;.&#160;.&#160;,&#160;τα,β&#160;(z2n−i)&#160;.<br/>
Notice&#160;that&#160;π(Z)&#160;is&#160;a&#160;chain&#160;starting&#160;with&#160;x&#160;and&#160;ending&#160;at&#160;πα,β(y).&#160;It&#160;is&#160;not&#160;hard&#160;to&#160;see&#160;that<br/>the&#160;function&#160;π&#160;is&#160;injective.&#160;Now,&#160;the&#160;key&#160;observation&#160;is&#160;that,&#160;by&#160;construction&#160;of&#160;Cµ,&#160;for&#160;any<br/>such&#160;sequence&#160;Z,&#160;we&#160;have<br/>
P&#160;(zi+1,&#160;.&#160;.&#160;.&#160;,&#160;z2n−i&#160;∈&#160;Cµ&#160;|&#160;zi&#160;∈&#160;Cµ)<br/>
=&#160;P&#160;z<br/>
<br/>
<br/>
i+1,&#160;.&#160;.&#160;.&#160;,&#160;zℓ(Z)−1,&#160;τα,β&#160;zℓ(Z)&#160;,&#160;.&#160;.&#160;.&#160;,&#160;τα,β&#160;(z2n−i)&#160;∈&#160;Cµ&#160;|&#160;zi&#160;∈&#160;Cµ&#160;.<br/>
This&#160;proves&#160;P&#160;(τα,β(y)&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;≥&#160;P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;since&#160;P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;is&#160;equal<br/>to&#160;the&#160;sum&#160;over&#160;all&#160;such&#160;sequences&#160;of&#160;P&#160;(zi+1,&#160;.&#160;.&#160;.&#160;,&#160;z2n−i&#160;∈&#160;Cµ&#160;|&#160;zi&#160;∈&#160;Cµ).&#160;In&#160;order&#160;to&#160;prove&#160;the<br/>strict&#160;inequality,&#160;all&#160;that&#160;we&#160;need&#160;is&#160;a&#160;single&#160;chain&#160;containing&#160;x&#160;and&#160;τα,β(y)&#160;which&#160;is&#160;not&#160;a<br/>subsequence&#160;of&#160;one&#160;of&#160;the&#160;chains&#160;π(Z)&#160;for&#160;Z&#160;as&#160;above.&#160;Any&#160;chain&#160;of&#160;the&#160;form&#160;x&#160;&lt;&#160;z&#160;&lt;&#160;τα,β(y)<br/>with&#160;zβ&#160;=&#160;2&#160;has&#160;this&#160;property.&#160;This&#160;completes&#160;the&#160;proof&#160;of&#160;the&#160;claim.<br/>
We&#160;now&#160;prove&#160;that,&#160;in&#160;fact,&#160;there&#160;must&#160;be&#160;at&#160;least&#160;n/10&#160;coordinates&#160;α&#160;∈&#160;[n]&#160;such&#160;that<br/>
xα&#160;=&#160;0&#160;and&#160;yα&#160;=&#160;2.&#160;If&#160;not,&#160;then&#160;we&#160;must&#160;have&#160;that&#160;the&#160;rank&#160;of&#160;y&#160;is&#160;at&#160;most&#160;2i+(n−i)+n/10&#160;=<br/>11n/10&#160;+&#160;i.&#160;However,&#160;by&#160;assumption&#160;of&#160;this&#160;case,&#160;the&#160;rank&#160;of&#160;y&#160;is&#160;precisely&#160;2n&#160;−&#160;i.&#160;Putting<br/>this&#160;together,&#160;we&#160;get&#160;that&#160;2n&#160;−&#160;i&#160;≤&#160;11n/10&#160;+&#160;i&#160;which&#160;implies&#160;that&#160;i&#160;≥&#160;9n/20,&#160;a&#160;contradiction.<br/>Thus,&#160;by&#160;Claim&#160;<a href="1610.01521s.html#19">4.25&#160;</a>we&#160;have&#160;that&#160;yβ&#160;=&#160;2&#160;for&#160;every&#160;coordinate&#160;β&#160;∈&#160;[n]&#160;with&#160;xβ&#160;≥&#160;1.<br/>
By&#160;the&#160;result&#160;of&#160;the&#160;previous&#160;paragraph&#160;and&#160;the&#160;symmetry&#160;of&#160;the&#160;distribution&#160;µ,&#160;we&#160;see<br/>
that&#160;P&#160;(y′&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;is&#160;equal&#160;to&#160;P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;for&#160;every&#160;y′&#160;∈&#160;L2n−i&#160;such&#160;that<br/>
•&#160;y′&#160;=&#160;2&#160;for&#160;every&#160;coordinate&#160;β<br/>
β<br/>
∈&#160;[n]&#160;with&#160;xβ&#160;≥&#160;1,&#160;and<br/>
•&#160;y′&#160;has&#160;the&#160;same&#160;number&#160;of&#160;coordinates&#160;in&#160;{0,&#160;1}&#160;as&#160;y.<br/>
By&#160;the&#160;hypotheses&#160;of&#160;the&#160;lemma&#160;and&#160;the&#160;fact&#160;that&#160;the&#160;rank&#160;of&#160;x&#160;plus&#160;the&#160;rank&#160;of&#160;y&#160;is&#160;2n,&#160;we<br/>must&#160;have&#160;that&#160;the&#160;rank&#160;of&#160;y&#160;is&#160;at&#160;most&#160;2n&#160;−&#160;2k.&#160;This&#160;implies&#160;that&#160;y&#160;must&#160;have&#160;at&#160;least&#160;k<br/>coordinates&#160;in&#160;{0,&#160;1}.&#160;Also,&#160;recall&#160;that&#160;we&#160;have&#160;proved&#160;above&#160;that&#160;there&#160;are&#160;at&#160;least&#160;n/10&#160;≫&#160;k<br/>coordinates&#160;such&#160;that&#160;α&#160;∈&#160;[n]&#160;such&#160;that&#160;xα&#160;=&#160;0&#160;and&#160;yα&#160;=&#160;2.&#160;Since&#160;i&#160;&lt;&#160;9n/20,&#160;we&#160;have&#160;that&#160;x<br/>
19<br/>
<hr/>
<a name=20></a><img class="yflip" src="html/1610.01521-20_1.png"/><br/>
<img class="yflip" src="html/1610.01521-20_2.png"/><br/>
<img class="yflip" src="html/1610.01521-20_3.png"/><br/>
<img class="yflip" src="html/1610.01521-20_4.png"/><br/>
<img class="yflip" src="html/1610.01521-20_5.png"/><br/>
<img class="yflip" src="html/1610.01521-20_6.png"/><br/>
<img class="yflip" src="html/1610.01521-20_7.png"/><br/>
has&#160;at&#160;least&#160;11n/20&#160;coordinates&#160;which&#160;are&#160;equal&#160;to&#160;zero.&#160;Putting&#160;all&#160;of&#160;this&#160;together,&#160;we&#160;get<br/>that,&#160;for&#160;n0(k)&#160;sufficiently&#160;large,&#160;the&#160;number&#160;of&#160;such&#160;y′&#160;is&#160;at&#160;least<br/>
⌈11n/20⌉<br/>
ℓ<br/>
&gt;&#160;3k−1(n)&#160;−&#160;1<br/>
k<br/>
ℓ2k−1(n)<br/>
by&#160;<a href="1610.01521s.html#3">(1.5)</a>.&#160;Since&#160;P&#160;(y′&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;is&#160;the&#160;same&#160;for&#160;all&#160;such&#160;y′&#160;and&#160;the&#160;sum&#160;of&#160;this&#160;quantity<br/>
<br/>
−1<br/>
over&#160;all&#160;y′&#160;is&#160;at&#160;most&#160;one,&#160;we&#160;must&#160;have&#160;that<br/>
ℓ<br/>
P&#160;(y&#160;∈&#160;C<br/>
3k−1(n)<br/>
µ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;≤<br/>
−&#160;1<br/>
.&#160;This<br/>
ℓ2k−1(n)<br/>
completes&#160;the&#160;proof&#160;in&#160;this&#160;case.<br/>
Case&#160;3:&#160;j&#160;−&#160;i&#160;&gt;&#160;11n/10&#160;and&#160;i&#160;+&#160;j&#160;&lt;&#160;2n.<br/>
In&#160;this&#160;case,&#160;we&#160;proceed&#160;by&#160;induction&#160;on&#160;2n&#160;−&#160;i&#160;−&#160;j.&#160;The&#160;basis&#160;of&#160;our&#160;induction&#160;will&#160;be&#160;the<br/>
case&#160;2n&#160;−&#160;i&#160;−&#160;j&#160;=&#160;0,&#160;which&#160;is&#160;covered&#160;by&#160;Case&#160;<a href="1610.01521s.html#18">2.&#160;</a>We&#160;can&#160;write&#160;P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;as<br/>
X<br/>
P&#160;(y,&#160;z&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)<br/>
z∈Li+1<br/>
x&lt;z&lt;y<br/>
X<br/>
=<br/>
P&#160;(z&#160;∈&#160;Cµ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;P&#160;(y&#160;∈&#160;Cµ&#160;|&#160;z&#160;∈&#160;Cµ)<br/>
z∈Li+1<br/>
x&lt;z&lt;y<br/>
by&#160;<a href="1610.01521s.html#10">(4.6)</a>.&#160;Since&#160;Pz∈L<br/>
P&#160;(z&#160;∈&#160;C<br/>
i+1<br/>
µ&#160;|&#160;x&#160;∈&#160;Cµ)&#160;≤&#160;1,&#160;we&#160;see&#160;that&#160;it&#160;suffices&#160;to&#160;show&#160;that<br/>
x&lt;z&lt;y<br/>
&#160;ℓ<br/>
−1<br/>
3k<br/>
P&#160;(y&#160;∈&#160;C<br/>
−1(n)<br/>
µ&#160;|&#160;z&#160;∈&#160;Cµ)&#160;≤<br/>
−&#160;1<br/>
(4.26)<br/>
ℓ2k−1(n)<br/>
for&#160;every&#160;z&#160;∈&#160;Li+1&#160;such&#160;that&#160;x&#160;&lt;&#160;z&#160;&lt;&#160;y.&#160;So,&#160;let&#160;z&#160;be&#160;any&#160;such&#160;element.&#160;By&#160;assumption,&#160;we<br/>have&#160;that&#160;i&#160;+&#160;1&#160;&lt;&#160;j&#160;and&#160;(i&#160;+&#160;1)&#160;+&#160;j&#160;≤&#160;2n&#160;and&#160;so&#160;the&#160;rank&#160;of&#160;y&#160;is&#160;at&#160;least&#160;as&#160;close&#160;to&#160;n&#160;as&#160;the<br/>rank&#160;of&#160;z&#160;is.&#160;If&#160;we&#160;have&#160;j&#160;−&#160;(i&#160;+&#160;1)&#160;≤&#160;11n/10,&#160;then&#160;<a href="1610.01521s.html#20">(4.26)&#160;</a>holds&#160;by&#160;the&#160;argument&#160;given&#160;in<br/>Case&#160;<a href="1610.01521s.html#18">1&#160;</a>and&#160;we&#160;are&#160;done.&#160;So,&#160;we&#160;assume&#160;that&#160;j&#160;−&#160;(i&#160;+&#160;1)&#160;&gt;&#160;11n/10.&#160;If&#160;we&#160;have&#160;(i&#160;+&#160;1)&#160;+&#160;j&#160;=&#160;2n,<br/>then&#160;<a href="1610.01521s.html#20">(4.26)&#160;</a>holds&#160;by&#160;the&#160;argument&#160;given&#160;in&#160;Case&#160;<a href="1610.01521s.html#18">2.&#160;</a>Thus,&#160;we&#160;have&#160;that&#160;j&#160;−&#160;(i&#160;+&#160;1)&#160;&gt;&#160;11n/10<br/>and&#160;(i&#160;+&#160;1)&#160;+&#160;j&#160;&lt;&#160;2n&#160;and&#160;we&#160;now&#160;get&#160;that&#160;<a href="1610.01521s.html#20">(4.26)&#160;</a>holds&#160;by&#160;the&#160;inductive&#160;hypothesis.&#160;This<br/>completes&#160;the&#160;proof&#160;of&#160;the&#160;lemma.<br/>
5<br/>
Containers&#160;for&#160;Antichains<br/>
In&#160;this&#160;section,&#160;we&#160;generalise&#160;a&#160;container-type&#160;lemma&#160;for&#160;the&#160;boolean&#160;lattice&#160;proved&#160;by&#160;Balogh,<br/>Mycroft&#160;and&#160;Treglown&#160;<a href="1610.01521s.html#30">[6]&#160;</a>to&#160;general&#160;posets.&#160;The&#160;main&#160;idea&#160;in&#160;the&#160;proof&#160;originated&#160;in&#160;the<br/>work&#160;of&#160;Kleitman&#160;and&#160;Winston&#160;<a href="1610.01521s.html#31">[26]&#160;</a>and&#160;has&#160;now&#160;been&#160;used&#160;many&#160;times;&#160;see,&#160;e.g.,&#160;<a href="1610.01521s.html#30">[6,&#160;8,&#160;</a><a href="1610.01521s.html#31">31]</a>.<br/>In&#160;essence,&#160;what&#160;this&#160;lemma&#160;says&#160;is&#160;that&#160;if&#160;P&#160;satisfies&#160;a&#160;certain&#160;supersaturation&#160;bound,&#160;then<br/>there&#160;is&#160;a&#160;collection&#160;of&#160;‘not&#160;very&#160;large’&#160;subsets&#160;of&#160;P&#160;indexed&#160;by&#160;‘very&#160;small’&#160;subsets&#160;of&#160;P&#160;with<br/>the&#160;property&#160;that&#160;every&#160;antichain&#160;in&#160;P&#160;is&#160;contained&#160;in&#160;at&#160;least&#160;one&#160;set&#160;from&#160;the&#160;collection.&#160;The<br/>elements&#160;of&#160;such&#160;a&#160;collection&#160;are&#160;referred&#160;to&#160;as&#160;containers.&#160;The&#160;fact&#160;that&#160;the&#160;containers&#160;are<br/>indexed&#160;by&#160;small&#160;subsets&#160;of&#160;P&#160;is&#160;typically&#160;used&#160;to&#160;argue&#160;that&#160;the&#160;total&#160;number&#160;of&#160;containers<br/>is&#160;very&#160;small&#160;compared&#160;to&#160;the&#160;total&#160;number&#160;of&#160;antichains.<br/>
Definition&#160;5.1.&#160;Given&#160;a&#160;set&#160;X&#160;and&#160;an&#160;integer&#160;j,&#160;we&#160;let&#160;X&#160;&#160;denote&#160;the&#160;set&#160;of&#160;all&#160;subsets&#160;of<br/>
≤j<br/>
m&#160;of&#160;cardinality&#160;at&#160;most&#160;j.&#160;Also,&#160;for&#160;n&#160;≥&#160;j,&#160;define&#160;n&#160;&#160;:=&#160;Pj<br/>
n.<br/>
≤j<br/>
r=0&#160;r<br/>
20<br/>
<hr/>
<a name=21></a>Lemma&#160;5.2.&#160;Let&#160;d&#160;and&#160;m&#160;be&#160;positive&#160;integers&#160;and&#160;let&#160;P&#160;be&#160;a&#160;poset&#160;such&#160;that&#160;|P&#160;|&#160;&gt;&#160;m&#160;and<br/>every&#160;subset&#160;S&#160;of&#160;P&#160;of&#160;cardinality&#160;greater&#160;than&#160;m&#160;contains&#160;at&#160;least&#160;|S|d&#160;comparable&#160;pairs.<br/>Then&#160;there&#160;exists&#160;a&#160;function<br/>
<br/>
P<br/>
<br/>
<br/>
P&#160;<br/>
f&#160;:<br/>
→<br/>
≤&#160;|P&#160;|/(2d&#160;+&#160;1)<br/>
≤&#160;m<br/>
such&#160;that&#160;for&#160;every&#160;antichain&#160;I&#160;⊆&#160;P&#160;there&#160;exists&#160;a&#160;subset&#160;T&#160;of&#160;I&#160;of&#160;cardinality&#160;at&#160;most<br/>|P&#160;|/(2d&#160;+&#160;1)&#160;with&#160;T&#160;∩&#160;f(T&#160;)&#160;=&#160;∅&#160;and&#160;I&#160;⊆&#160;T&#160;∪&#160;f(T&#160;).<br/>
A&#160;key&#160;idea&#160;from&#160;<a href="1610.01521s.html#30">[6]&#160;</a>is&#160;that&#160;it&#160;can&#160;often&#160;be&#160;advantageous&#160;to&#160;prove&#160;a&#160;‘multi-stage’&#160;container<br/>
lemma,&#160;where&#160;the&#160;purpose&#160;of&#160;the&#160;early&#160;stages&#160;is&#160;to&#160;‘thin&#160;out’&#160;the&#160;poset&#160;to&#160;reduce&#160;the&#160;overall<br/>number&#160;of&#160;containers&#160;(see&#160;also&#160;<a href="1610.01521s.html#30">[8]</a>).&#160;We&#160;prove&#160;the&#160;following&#160;lemma&#160;of&#160;this&#160;type,&#160;which&#160;implies<br/>Lemma&#160;<a href="1610.01521s.html#21">5.2.</a><br/>
Lemma&#160;5.3.&#160;For&#160;k&#160;≥&#160;1&#160;let&#160;d1&#160;&gt;&#160;·&#160;·&#160;·&#160;&gt;&#160;dk&#160;and&#160;m0&#160;&gt;&#160;·&#160;·&#160;·&#160;&gt;&#160;mk&#160;be&#160;positive&#160;integers&#160;and&#160;let&#160;P<br/>be&#160;a&#160;poset&#160;such&#160;that&#160;|P&#160;|&#160;=&#160;m0&#160;and,&#160;for&#160;1&#160;≤&#160;j&#160;≤&#160;k,&#160;every&#160;subset&#160;S&#160;of&#160;P&#160;of&#160;cardinality&#160;greater<br/>than&#160;mj&#160;contains&#160;at&#160;least&#160;|S|dj&#160;comparable&#160;pairs.&#160;Then&#160;there&#160;exists&#160;functions&#160;f1,&#160;.&#160;.&#160;.&#160;,&#160;fk&#160;where<br/>
<br/>
P<br/>
<br/>
<br/>
P&#160;<br/>
fj&#160;:<br/>
→<br/>
≤&#160;Pjr=1&#160;(mr−1/(2dr&#160;+&#160;1))<br/>
≤&#160;mj<br/>
such&#160;that&#160;for&#160;every&#160;antichain&#160;I&#160;⊆&#160;P&#160;there&#160;exists&#160;disjoint&#160;subsets&#160;T1,&#160;.&#160;.&#160;.&#160;,&#160;Tk&#160;of&#160;I&#160;with<br/>
(i)&#160;|Tj|&#160;≤&#160;mj−1/(2dj&#160;+&#160;1)&#160;for&#160;1&#160;≤&#160;j&#160;≤&#160;k,<br/>
<br/>
<br/>
(ii)&#160;T<br/>
Sj&#160;−1<br/>
j&#160;⊆&#160;fj−1<br/>
r=1&#160;Tr<br/>
for&#160;2&#160;≤&#160;j&#160;≤&#160;k&#160;−&#160;1,<br/>
<br/>
<br/>
<br/>
<br/>
(iii)<br/>
Sj<br/>
Sj<br/>
r=1&#160;Tr<br/>
∩&#160;fj<br/>
r=1&#160;Tr<br/>
=&#160;∅&#160;for&#160;1&#160;≤&#160;j&#160;≤&#160;k&#160;and<br/>
<br/>
<br/>
<br/>
<br/>
(iv)&#160;I&#160;⊆&#160;Sk<br/>
Sk<br/>
r=1&#160;Tr<br/>
∪&#160;fk<br/>
r=1&#160;Tr&#160;.<br/>
Proof.&#160;Fix&#160;an&#160;arbitrary&#160;total&#160;order&#160;x1,&#160;.&#160;.&#160;.&#160;,&#160;x|P|&#160;on&#160;the&#160;elements&#160;of&#160;P&#160;(this&#160;will&#160;only&#160;be&#160;used&#160;to<br/>
‘break&#160;ties’&#160;later&#160;in&#160;the&#160;proof).&#160;The&#160;proof&#160;of&#160;this&#160;lemma&#160;amounts&#160;to&#160;a&#160;simple&#160;application&#160;of&#160;the<br/>so-called&#160;Kleitman–Winston&#160;algorithm&#160;<a href="1610.01521s.html#31">[26]</a>.&#160;This&#160;algorithm&#160;takes,&#160;as&#160;an&#160;input,&#160;an&#160;antichain<br/>
<br/>
<br/>
I&#160;of&#160;P&#160;and&#160;produces&#160;the&#160;sets&#160;T<br/>
Sk<br/>
1,&#160;.&#160;.&#160;.&#160;,&#160;Tk&#160;as&#160;well&#160;as&#160;the&#160;sets&#160;f1(T1),&#160;.&#160;.&#160;.&#160;,&#160;fk<br/>
r=1&#160;Tr&#160;.&#160;After<br/>
describing&#160;this&#160;algorithm,&#160;we&#160;will&#160;verify&#160;that&#160;these&#160;sets&#160;have&#160;all&#160;of&#160;the&#160;desired&#160;properties&#160;and<br/>
<br/>
<br/>
that&#160;the&#160;functions&#160;f<br/>
Sj<br/>
1,&#160;.&#160;.&#160;.&#160;,&#160;fk&#160;are&#160;well&#160;defined;&#160;i.e.,&#160;we&#160;show&#160;that&#160;fj<br/>
r=1&#160;Tr<br/>
depends&#160;only<br/>
on&#160;Sjr=1&#160;Tr&#160;and&#160;not&#160;on&#160;the&#160;input&#160;antichain&#160;I&#160;or&#160;on&#160;the&#160;sets&#160;T1,&#160;.&#160;.&#160;.&#160;,&#160;Tj&#160;individually.<br/>
Given&#160;a&#160;set&#160;S&#160;⊆&#160;P&#160;and&#160;x&#160;∈&#160;S,&#160;define&#160;NS(x)&#160;to&#160;be&#160;the&#160;set&#160;of&#160;elements&#160;of&#160;S&#160;that&#160;are<br/>
comparable&#160;to&#160;x&#160;and&#160;let&#160;dS(x)&#160;:=&#160;|NS(x)|.&#160;Set&#160;P0&#160;:=&#160;P&#160;and&#160;let&#160;u0&#160;be&#160;the&#160;element&#160;of&#160;P0&#160;such<br/>that&#160;dP&#160;(u<br/>
0<br/>
0)&#160;is&#160;maximum;&#160;if&#160;there&#160;is&#160;a&#160;tie,&#160;then&#160;we&#160;let&#160;u0&#160;be&#160;the&#160;choice&#160;which&#160;comes&#160;earliest<br/>
in&#160;the&#160;total&#160;order.&#160;Now,&#160;given&#160;i&#160;≥&#160;1,&#160;the&#160;set&#160;Pi−1&#160;and&#160;an&#160;element&#160;ui−1&#160;of&#160;Pi−1,&#160;the&#160;ith&#160;step<br/>of&#160;the&#160;algorithm&#160;will&#160;either&#160;terminate&#160;or&#160;it&#160;will&#160;produce&#160;a&#160;non-empty&#160;set&#160;Pi&#160;(&#160;Pi−1&#160;and&#160;an<br/>element&#160;ui&#160;of&#160;Pi&#160;which&#160;it&#160;will&#160;pass&#160;to&#160;the&#160;next&#160;step.&#160;We&#160;proceed&#160;differently&#160;depending&#160;on&#160;the<br/>value&#160;of&#160;dP<br/>
(u<br/>
i−1<br/>
i−1).<br/>
Case&#160;1:&#160;dP<br/>
(u<br/>
i−1<br/>
i−1)&#160;≥&#160;2dk.<br/>
21<br/>
<hr/>
<a name=22></a>Let&#160;j&#160;be&#160;the&#160;smallest&#160;integer&#160;in&#160;{1,&#160;.&#160;.&#160;.&#160;,&#160;k}&#160;such&#160;that&#160;dP<br/>
(u<br/>
i−1<br/>
i−1)&#160;≥&#160;2dj&#160;.&#160;If&#160;ui−1&#160;/<br/>
∈&#160;I,&#160;then<br/>
we&#160;define&#160;Pi&#160;:=&#160;Pi−1&#160;\&#160;{ui−1}.&#160;On&#160;the&#160;other&#160;hand,&#160;if&#160;ui−1&#160;∈&#160;I,&#160;then&#160;we&#160;add&#160;ui−1&#160;to&#160;Tj&#160;and<br/>define&#160;Pi&#160;:=&#160;Pi−1&#160;\&#160;{ui−1}&#160;∪&#160;NP<br/>
(u<br/>
i−1<br/>
i−1).&#160;It&#160;is&#160;clear&#160;that&#160;Pi&#160;(&#160;Pi−1.<br/>
If&#160;Pi&#160;6=&#160;∅,&#160;then&#160;let&#160;ui&#160;∈&#160;Pi&#160;such&#160;that&#160;dP&#160;(u<br/>
i<br/>
i)&#160;is&#160;maximum&#160;and,&#160;subject&#160;to&#160;this,&#160;ui&#160;comes<br/>
earliest&#160;in&#160;the&#160;total&#160;order.&#160;If,&#160;in&#160;addition,&#160;dP&#160;(u<br/>
i<br/>
i)&#160;≥&#160;2dj&#160;,&#160;then&#160;we&#160;simply&#160;proceed&#160;to&#160;the&#160;next<br/>
step&#160;of&#160;the&#160;algorithm.<br/>
Suppose&#160;now&#160;that&#160;Pi&#160;=&#160;∅&#160;or&#160;that&#160;dP&#160;(u<br/>
i<br/>
i)&#160;&lt;&#160;2dj&#160;.&#160;In&#160;the&#160;former&#160;case,&#160;set&#160;ℓ&#160;:=&#160;k&#160;−&#160;j&#160;and,&#160;in<br/>
the&#160;latter&#160;case,&#160;let&#160;ℓ&#160;∈&#160;{0,&#160;.&#160;.&#160;.&#160;,&#160;k&#160;−&#160;j}&#160;be&#160;the&#160;largest&#160;integer&#160;such&#160;that&#160;dP&#160;(u<br/>
i<br/>
i)&#160;&lt;&#160;2dj+ℓ.&#160;We&#160;do<br/>
the&#160;following:<br/>
•&#160;terminate&#160;the&#160;definition&#160;of&#160;Tj,<br/>
•&#160;set&#160;Tj+1,&#160;.&#160;.&#160;.&#160;,&#160;Tj+ℓ&#160;:=&#160;∅,<br/>
<br/>
<br/>
<br/>
<br/>
•&#160;set&#160;f<br/>
Sj<br/>
Sj+ℓ<br/>
j<br/>
r=1&#160;Tr<br/>
=&#160;·&#160;·&#160;·&#160;=&#160;fj+ℓ<br/>
r=1&#160;Tr<br/>
:=&#160;Pi.<br/>
If&#160;Pi&#160;=&#160;∅,&#160;then&#160;terminate&#160;the&#160;algorithm;&#160;otherwise,&#160;proceed&#160;to&#160;the&#160;next&#160;step.<br/>
Case&#160;2:&#160;dP<br/>
(u<br/>
i−1<br/>
i−1)&#160;&lt;&#160;2dk.<br/>
In&#160;this&#160;case,&#160;we&#160;simply&#160;terminate&#160;the&#160;algorithm.&#160;This&#160;concludes&#160;the&#160;description&#160;of&#160;the<br/>
algorithm.<br/>
A&#160;key&#160;feature&#160;of&#160;the&#160;algorithm&#160;is&#160;that&#160;the&#160;sequence&#160;dP&#160;(u<br/>
(u<br/>
0<br/>
0),&#160;dP1<br/>
1),&#160;.&#160;.&#160;.&#160;is&#160;non-increasing,<br/>
which&#160;follows&#160;easily&#160;from&#160;the&#160;choice&#160;of&#160;the&#160;elements&#160;u0,&#160;u1,&#160;.&#160;.&#160;.&#160;and&#160;the&#160;fact&#160;that&#160;Pi&#160;(&#160;Pi−1<br/>for&#160;all&#160;i&#160;≥&#160;1.&#160;Since&#160;this&#160;sequence&#160;is&#160;non-increasing&#160;and&#160;d1&#160;&gt;&#160;·&#160;·&#160;·&#160;&gt;&#160;dk&#160;we&#160;see&#160;that,&#160;for&#160;each<br/>j&#160;∈&#160;{1,&#160;.&#160;.&#160;.&#160;,&#160;k},&#160;there&#160;is&#160;a&#160;unique&#160;step&#160;of&#160;the&#160;algorithm&#160;such&#160;that&#160;the&#160;definition&#160;of&#160;Tj&#160;and<br/>
<br/>
<br/>
<br/>
<br/>
f<br/>
Sj<br/>
Sj<br/>
j<br/>
r=1&#160;Tr<br/>
is&#160;finalised.&#160;Also,&#160;if&#160;1&#160;≤&#160;j&#160;&lt;&#160;j′&#160;≤&#160;k,&#160;then&#160;Tj&#160;and&#160;fj<br/>
r=1&#160;Tr<br/>
are&#160;defined&#160;before<br/>
<br/>
<br/>
T<br/>
Sj′<br/>
j′&#160;and&#160;fj′<br/>
r=1&#160;Tr&#160;.<br/>
It&#160;is&#160;clear&#160;by&#160;construction&#160;that&#160;<a href="1610.01521s.html#21">(ii)&#160;</a>and&#160;<a href="1610.01521s.html#21">(iii)&#160;</a>hold&#160;and&#160;that&#160;Tj&#160;⊆&#160;I&#160;for&#160;1&#160;≤&#160;j&#160;≤&#160;k.&#160;Also,<br/>
<a href="1610.01521s.html#21">(iv)&#160;</a>holds&#160;since&#160;we&#160;never&#160;delete&#160;an&#160;element&#160;of&#160;I&#160;during&#160;the&#160;running&#160;of&#160;the&#160;algorithm.&#160;By<br/>
<br/>
<br/>
construction,&#160;every&#160;element&#160;of&#160;f<br/>
Sj<br/>
j<br/>
r=1&#160;Tr<br/>
is&#160;comparable&#160;to&#160;fewer&#160;than&#160;2dj&#160;other&#160;elements<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
in&#160;f<br/>
Sj<br/>
Sj<br/>
Sj<br/>
j<br/>
<br/>
<br/>
r=1&#160;Tr&#160;.<br/>
Therefore,&#160;comp&#160;fj<br/>
r=1&#160;Tr<br/>
&lt;&#160;fj<br/>
dj&#160;which&#160;implies&#160;that<br/>
<br/>
r=1&#160;Tr&#160;<br/>
<br/>
<br/>
<br/>
<br/>
f<br/>
Sj<br/>
j<br/>
&#160;≤&#160;mj&#160;by&#160;hypothesis.&#160;This&#160;verifies&#160;that&#160;fj&#160;does,&#160;indeed,&#160;map&#160;into<br/>
P<br/>
.&#160;For<br/>
<br/>
r=1&#160;Tr&#160;<br/>
≤mj<br/>
each&#160;element&#160;that&#160;we&#160;added&#160;to&#160;T1,&#160;we&#160;deleted&#160;at&#160;least&#160;2d1&#160;+&#160;1&#160;elements&#160;of&#160;P&#160;.&#160;Therefore,<br/>|T1|&#160;≤&#160;|P&#160;|/(2d1&#160;+&#160;1)&#160;=&#160;m0/(2d1&#160;+&#160;1).&#160;Similarly,&#160;for&#160;j&#160;≥&#160;2,&#160;for&#160;each&#160;element&#160;that&#160;we&#160;added<br/>
<br/>
<br/>
to&#160;T<br/>
Sj−1<br/>
j&#160;we&#160;deleted&#160;at&#160;least&#160;2dj&#160;+&#160;1&#160;elements&#160;of&#160;fj−1<br/>
r=1&#160;Tr<br/>
and&#160;so&#160;|Tj|&#160;≤&#160;mj−1/(2dj&#160;+&#160;1).<br/>
Thus,&#160;<a href="1610.01521s.html#21">(i)&#160;</a>holds.<br/>
Finally,&#160;we&#160;argue&#160;that&#160;the&#160;functions&#160;f1,&#160;.&#160;.&#160;.&#160;,&#160;fk&#160;are&#160;well&#160;defined.&#160;Let&#160;I&#160;and&#160;I′&#160;be&#160;antichains<br/>
yielding&#160;the&#160;same&#160;set&#160;Sjr=1&#160;Tr&#160;for&#160;some&#160;j&#160;with&#160;1&#160;≤&#160;j&#160;≤&#160;k.&#160;Let&#160;u0,&#160;u1,&#160;.&#160;.&#160;.&#160;and&#160;P0,&#160;P1,&#160;.&#160;.&#160;.<br/>be&#160;the&#160;elements&#160;and&#160;subsets&#160;of&#160;P&#160;produced&#160;while&#160;running&#160;the&#160;algorithm&#160;with&#160;input&#160;I&#160;and<br/>let&#160;u′0,&#160;u′1,&#160;.&#160;.&#160;.&#160;and&#160;P&#160;′0,&#160;P&#160;′1,&#160;.&#160;.&#160;.&#160;be&#160;the&#160;elements&#160;and&#160;subsets&#160;of&#160;P&#160;produced&#160;while&#160;running&#160;the<br/>algorithm&#160;with&#160;input&#160;I′.&#160;Let&#160;i&#160;denote&#160;the&#160;minimum&#160;integer&#160;such&#160;that&#160;dP&#160;(u<br/>
i<br/>
i)&#160;&lt;&#160;2dj&#160;.<br/>
We<br/>
prove&#160;that&#160;ut&#160;=&#160;u′t&#160;and&#160;Pt&#160;=&#160;P&#160;′t&#160;for&#160;all&#160;0&#160;≤&#160;t&#160;≤&#160;i.&#160;If&#160;not,&#160;let&#160;t&#160;be&#160;the&#160;smallest&#160;such&#160;integer<br/>for&#160;which&#160;it&#160;fails.&#160;Clearly,&#160;t&#160;≥&#160;1.&#160;Now,&#160;if&#160;Pt&#160;=&#160;P&#160;′t,&#160;then&#160;ut&#160;=&#160;u′t&#160;follows&#160;immediately&#160;so&#160;we<br/>must&#160;have&#160;Pt&#160;6=&#160;P&#160;′t.&#160;However,&#160;since&#160;ut−1&#160;=&#160;u′t−1&#160;and&#160;Pt−1&#160;=&#160;P&#160;′t−1,&#160;the&#160;only&#160;way&#160;that&#160;we<br/>
can&#160;have&#160;Pt&#160;6=&#160;P&#160;′t&#160;is&#160;if&#160;ut−1&#160;∈&#160;I&#160;and&#160;u′t−1&#160;/∈&#160;I′&#160;or&#160;vice&#160;versa.&#160;By&#160;definition&#160;of&#160;i,&#160;we&#160;have<br/>
22<br/>
<hr/>
<a name=23></a><img class="yflip" src="html/1610.01521-23_1.png"/><br/>
<img class="yflip" src="html/1610.01521-23_2.png"/><br/>
<img class="yflip" src="html/1610.01521-23_3.png"/><br/>
<img class="yflip" src="html/1610.01521-23_4.png"/><br/>
<img class="yflip" src="html/1610.01521-23_5.png"/><br/>
<img class="yflip" src="html/1610.01521-23_6.png"/><br/>
<img class="yflip" src="html/1610.01521-23_7.png"/><br/>
<img class="yflip" src="html/1610.01521-23_8.png"/><br/>
<img class="yflip" src="html/1610.01521-23_9.png"/><br/>
<img class="yflip" src="html/1610.01521-23_10.png"/><br/>
dP<br/>
(u<br/>
t−1<br/>
t−1)&#160;≥&#160;2dj&#160;and&#160;so&#160;ut−1&#160;∈&#160;I&#160;implies&#160;ut−1&#160;∈&#160;Sjr=1&#160;Tr&#160;by&#160;the&#160;description&#160;of&#160;the&#160;algorithm.<br/>
However,&#160;u′t−1&#160;/∈&#160;I′&#160;implies&#160;that&#160;the&#160;algorithm&#160;will&#160;not&#160;add&#160;u′t−1&#160;to&#160;any&#160;of&#160;the&#160;sets&#160;T1,&#160;.&#160;.&#160;.&#160;,&#160;Tk<br/>
<br/>
<br/>
and&#160;so&#160;u′<br/>
Sj<br/>
t−1&#160;/<br/>
∈&#160;Sjr=1&#160;Tr,&#160;contradicting&#160;the&#160;fact&#160;that&#160;ut−1&#160;=&#160;u′t−1.&#160;Therefore&#160;fj<br/>
r=1&#160;Tr<br/>
does<br/>
not&#160;depend&#160;on&#160;I.&#160;This&#160;argument&#160;also&#160;proves&#160;that&#160;it&#160;depends&#160;only&#160;on&#160;the&#160;union&#160;Sjr=1&#160;Tr&#160;and<br/>not&#160;on&#160;the&#160;sets&#160;T1,&#160;.&#160;.&#160;.&#160;,&#160;Tj&#160;individually.&#160;This&#160;completes&#160;the&#160;proof.<br/>
The&#160;following&#160;lemma&#160;is&#160;a&#160;consequence&#160;of&#160;Lemma&#160;<a href="1610.01521s.html#21">5.3&#160;</a>which&#160;we&#160;will&#160;use&#160;to&#160;count&#160;antichains<br/>
in&#160;the&#160;next&#160;section.<br/>
Lemma&#160;5.4.&#160;For&#160;k&#160;≥&#160;1&#160;let&#160;d1&#160;&gt;&#160;·&#160;·&#160;·&#160;&gt;&#160;dk&#160;and&#160;m0&#160;&gt;&#160;·&#160;·&#160;·&#160;&gt;&#160;mk&#160;be&#160;positive&#160;integers&#160;and&#160;let&#160;P<br/>be&#160;a&#160;poset&#160;such&#160;that&#160;|P&#160;|&#160;=&#160;m0&#160;and,&#160;for&#160;1&#160;≤&#160;j&#160;≤&#160;k,&#160;every&#160;subset&#160;S&#160;of&#160;P&#160;of&#160;cardinality&#160;greater<br/>than&#160;mj&#160;contains&#160;at&#160;least&#160;|S|dj&#160;comparable&#160;pairs.&#160;Then&#160;there&#160;is&#160;a&#160;collection&#160;F&#160;of&#160;subsets&#160;of<br/>P&#160;such&#160;that<br/>
(a)&#160;|F|&#160;≤&#160;Qk<br/>
mr−1<br/>
<br/>
r=1<br/>
,<br/>
≤mr−1/(2dr+1)<br/>
(b)&#160;|A|&#160;≤&#160;m<br/>
mr−1<br/>
k&#160;+&#160;Pk<br/>
r=1<br/>
for&#160;every&#160;A<br/>
2d<br/>
∈&#160;F&#160;and<br/>
r&#160;+1<br/>
(c)&#160;for&#160;every&#160;antichain&#160;I&#160;of&#160;P&#160;,&#160;there&#160;exists&#160;A&#160;∈&#160;F&#160;such&#160;that&#160;I&#160;⊆&#160;A.<br/>
Proof.&#160;Apply&#160;Lemma&#160;<a href="1610.01521s.html#21">5.3&#160;</a>to&#160;obtain&#160;the&#160;functions&#160;f1,&#160;.&#160;.&#160;.&#160;,&#160;fk.&#160;For&#160;each&#160;antichain&#160;I,&#160;let&#160;T1,I,&#160;.&#160;.&#160;.&#160;,&#160;Tk,I<br/>
<br/>
<br/>
<br/>
<br/>
be&#160;disjoint&#160;sets&#160;as&#160;in&#160;Lemma&#160;<a href="1610.01521s.html#21">5.3&#160;</a>such&#160;that&#160;I&#160;⊆&#160;Sk<br/>
Sk<br/>
r=1&#160;Tr,I<br/>
∪&#160;f<br/>
r=1&#160;Tr,I&#160;.&#160;Define<br/>
(&#160;<br/>
k<br/>
!<br/>
&#160;<br/>
k<br/>
!<br/>
)<br/>
F<br/>
[<br/>
[<br/>
:=<br/>
Tr,I<br/>
∪&#160;f<br/>
Tr,I<br/>
:&#160;I&#160;⊆&#160;P&#160;is&#160;an&#160;antichain&#160;.<br/>
r=1<br/>
r=1<br/>
Then&#160;<a href="1610.01521s.html#23">(b)&#160;</a>and&#160;<a href="1610.01521s.html#23">(c)&#160;</a>hold&#160;by&#160;construction.&#160;Let&#160;us&#160;show&#160;that&#160;<a href="1610.01521s.html#23">(a)&#160;</a>holds.&#160;The&#160;number&#160;of&#160;ways&#160;of<br/>choosing&#160;T<br/>
<br/>
1,I&#160;is&#160;at&#160;most<br/>
|P&#160;|<br/>
.&#160;Now,&#160;for&#160;2&#160;≤&#160;j&#160;≤&#160;k,&#160;given&#160;that&#160;T<br/>
≤|P&#160;|/(2d<br/>
1,I&#160;,&#160;.&#160;.&#160;.&#160;,&#160;Tj−1,I&#160;have<br/>
1+1)<br/>
<br/>
<br/>
been&#160;chosen,&#160;we&#160;know&#160;that&#160;T<br/>
Sj−1<br/>
j,I&#160;is&#160;a&#160;subset&#160;of&#160;fj−1<br/>
r=1&#160;Tr,I&#160;.&#160;Therefore,&#160;there&#160;are&#160;at&#160;most<br/>
mj−1<br/>
&#160;ways&#160;to&#160;choose&#160;T<br/>
≤m<br/>
j,I&#160;.&#160;This&#160;argument&#160;proves&#160;<a href="1610.01521s.html#23">(a)</a>.<br/>
j−1/(2dj&#160;+1)<br/>
6<br/>
Applications&#160;of&#160;the&#160;Container-Type&#160;Lemma<br/>
6.1<br/>
Counting&#160;Antichains<br/>
Before&#160;presenting&#160;the&#160;proofs&#160;of&#160;Theorems&#160;<a href="1610.01521s.html#4">1.6&#160;</a>and&#160;<a href="1610.01521s.html#4">1.7,&#160;</a>we&#160;illustrate&#160;the&#160;the&#160;method&#160;by&#160;applying<br/>Lemma&#160;<a href="1610.01521s.html#23">5.4&#160;</a>and&#160;Theorem&#160;<a href="1610.01521s.html#6">3.1&#160;</a>to&#160;obtain&#160;a&#160;short&#160;proof&#160;of&#160;a&#160;known&#160;upper&#160;bound&#160;on&#160;the&#160;number<br/>of&#160;antichains&#160;in&#160;P(n).&#160;The&#160;problem&#160;of&#160;approximating&#160;the&#160;number&#160;of&#160;antichains&#160;in&#160;P(n)&#160;is<br/>known&#160;as&#160;Dedekind’s&#160;Problem&#160;and&#160;has&#160;a&#160;long&#160;history;&#160;see&#160;Kahn&#160;<a href="1610.01521s.html#31">[22]</a>.<br/>
Theorem&#160;6.1&#160;(See,&#160;e.g.,&#160;<a href="1610.01521s.html#31">[22]</a>).&#160;The&#160;number&#160;of&#160;antichains&#160;in&#160;P(n)&#160;is&#160;at&#160;most<br/>
√<br/>
<br/>
<br/>
<br/>
1+O<br/>
log(n)/n<br/>
(&#160;n&#160;)<br/>
2<br/>
⌈n/2⌉&#160;.<br/>
Proof.&#160;We&#160;generate&#160;a&#160;set&#160;of&#160;containers&#160;for&#160;the&#160;antichains&#160;of&#160;P(n)&#160;using&#160;Lemma&#160;<a href="1610.01521s.html#23">5.4.&#160;</a>An<br/>upper&#160;bound&#160;on&#160;the&#160;number&#160;of&#160;antichains&#160;will&#160;then&#160;follow&#160;by&#160;considering&#160;all&#160;subsets&#160;of&#160;the<br/>
23<br/>
<hr/>
<a name=24></a><img class="yflip" src="html/1610.01521-24_1.png"/><br/>
<img class="yflip" src="html/1610.01521-24_2.png"/><br/>
<img class="yflip" src="html/1610.01521-24_3.png"/><br/>
<img class="yflip" src="html/1610.01521-24_4.png"/><br/>
<img class="yflip" src="html/1610.01521-24_5.png"/><br/>
<img class="yflip" src="html/1610.01521-24_6.png"/><br/>
<img class="yflip" src="html/1610.01521-24_7.png"/><br/>
<img class="yflip" src="html/1610.01521-24_8.png"/><br/>
<img class="yflip" src="html/1610.01521-24_9.png"/><br/>
<img class="yflip" src="html/1610.01521-24_10.png"/><br/>
<img class="yflip" src="html/1610.01521-24_11.png"/><br/>
<img class="yflip" src="html/1610.01521-24_12.png"/><br/>
<img class="yflip" src="html/1610.01521-24_13.png"/><br/>
<img class="yflip" src="html/1610.01521-24_14.png"/><br/>
<img class="yflip" src="html/1610.01521-24_15.png"/><br/>
<img class="yflip" src="html/1610.01521-24_16.png"/><br/>
<img class="yflip" src="html/1610.01521-24_17.png"/><br/>
<img class="yflip" src="html/1610.01521-24_18.png"/><br/>
<img class="yflip" src="html/1610.01521-24_19.png"/><br/>
<img class="yflip" src="html/1610.01521-24_20.png"/><br/>
<img class="yflip" src="html/1610.01521-24_21.png"/><br/>
<img class="yflip" src="html/1610.01521-24_22.png"/><br/>
<img class="yflip" src="html/1610.01521-24_23.png"/><br/>
<img class="yflip" src="html/1610.01521-24_24.png"/><br/>
<img class="yflip" src="html/1610.01521-24_25.png"/><br/>
<img class="yflip" src="html/1610.01521-24_26.png"/><br/>
<img class="yflip" src="html/1610.01521-24_27.png"/><br/>
<img class="yflip" src="html/1610.01521-24_28.png"/><br/>
<img class="yflip" src="html/1610.01521-24_29.png"/><br/>
<img class="yflip" src="html/1610.01521-24_30.png"/><br/>
<img class="yflip" src="html/1610.01521-24_31.png"/><br/>
<img class="yflip" src="html/1610.01521-24_32.png"/><br/>
<img class="yflip" src="html/1610.01521-24_33.png"/><br/>
<img class="yflip" src="html/1610.01521-24_34.png"/><br/>
<img class="yflip" src="html/1610.01521-24_35.png"/><br/>
<img class="yflip" src="html/1610.01521-24_36.png"/><br/>
<img class="yflip" src="html/1610.01521-24_37.png"/><br/>
√<br/>
√<br/>
2(&#160;n&#160;)<br/>
(&#160;n&#160;)<br/>
containers.&#160;Set&#160;d<br/>
⌊n/2⌋<br/>
⌊n/2⌋<br/>
1&#160;:=&#160;n<br/>
log&#160;n,&#160;d2&#160;:=<br/>
n&#160;log&#160;n,&#160;m0&#160;:=&#160;2n,&#160;m1&#160;:=<br/>
and&#160;m<br/>
.<br/>
1−8d<br/>
2&#160;:=<br/>
1/n2<br/>
1−2d2/n<br/>
If&#160;S&#160;is&#160;a&#160;subset&#160;of&#160;P(n)&#160;of&#160;cardinality&#160;at&#160;least&#160;m1,&#160;then,&#160;by&#160;Theorem&#160;<a href="1610.01521s.html#6">3.1,</a><br/>
<br/>
<br/>
n&#160;&#160;&#160;n2&#160;<br/>
comp(S)&#160;≥&#160;|S|&#160;−&#160;2&#160;⌈n/2⌉<br/>
8<br/>
&#160;n2&#160;<br/>
<br/>
<br/>
n&#160;&#160;&#160;n2&#160;<br/>
=&#160;(|S|&#160;−&#160;m1)<br/>
+&#160;m<br/>
≥&#160;(|S|&#160;−&#160;m<br/>
8<br/>
1&#160;−&#160;2&#160;⌈n/2⌉<br/>
8<br/>
1)d1&#160;+&#160;m1d1&#160;=&#160;|S|d1<br/>
<br/>
&#160;<br/>
<br/>
since&#160;m<br/>
<br/>
n2<br/>
1&#160;−&#160;2<br/>
n<br/>
=&#160;m<br/>
⌊n/2⌋<br/>
8<br/>
1d1.&#160;Similarly,&#160;if&#160;S&#160;has&#160;cardinality&#160;at&#160;least&#160;m2,&#160;then&#160;comp(S)&#160;≥<br/>
|S|d2.&#160;Therefore,&#160;we&#160;can&#160;apply&#160;Lemma&#160;<a href="1610.01521s.html#23">5.4&#160;</a>to&#160;P(n)&#160;with&#160;k&#160;=&#160;2&#160;and&#160;these&#160;values&#160;of&#160;d1,&#160;d2,&#160;m0,&#160;m1<br/>and&#160;m<br/>
<br/>
m1<br/>
<br/>
2&#160;to&#160;obtain&#160;a&#160;collection&#160;F&#160;of&#160;at&#160;most<br/>
2n<br/>
containers,&#160;each&#160;of&#160;cardinality<br/>
≤2n/d1<br/>
≤m1/d2<br/>
at&#160;most&#160;m2&#160;+&#160;m1&#160;+&#160;2n&#160;,&#160;such&#160;that&#160;each&#160;antichain&#160;of<br/>
d<br/>
P(n)&#160;is&#160;contained&#160;in&#160;at&#160;least&#160;one&#160;container.<br/>
2<br/>
d1<br/>
Thus,&#160;the&#160;number&#160;of&#160;antichains&#160;in&#160;P(n)&#160;is&#160;at&#160;most<br/>
<br/>
2n<br/>
<br/>
m<br/>
<br/>
1<br/>
2m2+&#160;m1&#160;+&#160;2n<br/>
+&#160;2n<br/>
d2<br/>
d1&#160;≤&#160;(e&#160;·&#160;d<br/>
d1<br/>
≤&#160;2n/d<br/>
1)2n/d1&#160;(e&#160;·&#160;d2)m1/d2&#160;2m2+&#160;m1<br/>
d2<br/>
1<br/>
≤&#160;m1/d2<br/>
2n&#160;log2(e·d1)<br/>
=&#160;2<br/>
+&#160;m1&#160;log2(e·d2)&#160;+m<br/>
+&#160;2n<br/>
d<br/>
2+&#160;m1<br/>
1<br/>
d2<br/>
d2<br/>
d1<br/>
&#160;2n&#160;log&#160;n<br/>
<br/>
≤&#160;m<br/>
+&#160;m1&#160;log&#160;n<br/>
2&#160;2+O<br/>
d1<br/>
d2<br/>
for&#160;n&#160;sufficiently&#160;large.&#160;Now,&#160;bounding&#160;the&#160;exponent,&#160;we&#160;get<br/>
n<br/>
<br/>
√<br/>
&#160;2n&#160;log&#160;n<br/>
m<br/>
<br/>
&#160;2n&#160;log&#160;n<br/>
<br/>
n&#160;<br/>
<br/>
m<br/>
1&#160;log&#160;n<br/>
⌊n/2⌋<br/>
p<br/>
2&#160;+&#160;O<br/>
+<br/>
=<br/>
+&#160;O<br/>
+<br/>
log&#160;n/n<br/>
d1<br/>
d2<br/>
1&#160;−&#160;2d2/n<br/>
n<br/>
⌊n/2⌋<br/>
<br/>
n&#160;<br/>
4d&#160;&#160;n&#160;<br/>
<br/>
n&#160;<br/>
<br/>
≤<br/>
+<br/>
2<br/>
+&#160;O<br/>
plog&#160;n/n<br/>
⌊n/2⌋<br/>
n<br/>
⌊n/2⌋<br/>
⌊n/2⌋<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
n<br/>
=&#160;1&#160;+&#160;O&#160;plog&#160;n/n<br/>
⌊n/2⌋<br/>
<br/>
<br/>
since<br/>
n<br/>
&#160;=&#160;Θ&#160;2n<br/>
√<br/>
by&#160;Stirling’s&#160;Approximation.&#160;The&#160;result&#160;follows.<br/>
⌊n/2⌋<br/>
n<br/>
We&#160;now&#160;prove&#160;Theorems&#160;<a href="1610.01521s.html#4">1.6&#160;</a>and&#160;<a href="1610.01521s.html#4">1.7&#160;</a>by&#160;following&#160;along&#160;similar&#160;lines&#160;to&#160;the&#160;proof&#160;of<br/>
Theorem&#160;<a href="1610.01521s.html#23">6.1&#160;</a>given&#160;above.<br/>
<br/>
<br/>
Proof&#160;of&#160;Theorem&#160;<a href="1610.01521s.html#4">1.6.&#160;</a>For&#160;brevity,&#160;define&#160;N&#160;:=&#160;|V(q,&#160;n)|&#160;and&#160;note&#160;that&#160;N&#160;=&#160;Θ&#160;qn2/2&#160;by<br/>
h<br/>
i<br/>
√<br/>
n<br/>
⌊n/2⌋<br/>
Theorem&#160;<a href="1610.01521s.html#32">A.1.&#160;</a>Let&#160;d&#160;:=<br/>
nqn/4&#160;and&#160;m&#160;:=<br/>
q<br/>
.&#160;Note&#160;that&#160;Theorem&#160;<a href="1610.01521s.html#32">A.1&#160;</a>also<br/>
h<br/>
i−1<br/>
1−d&#160;⌈(n+1)/2⌉<br/>
1<br/>
q<br/>
<br/>
<br/>
implies&#160;that&#160;m&#160;=&#160;Θ&#160;qn2/2<br/>
and&#160;so&#160;m&#160;and&#160;N&#160;are&#160;of&#160;the&#160;same&#160;order&#160;of&#160;magnitude.&#160;By<br/>
Theorem&#160;<a href="1610.01521s.html#2">1.2,&#160;</a>if&#160;S&#160;is&#160;a&#160;subset&#160;of&#160;V&#160;(q,&#160;n)&#160;of&#160;cardinality&#160;at&#160;least&#160;m,&#160;then<br/>
&#160;<br/>
!<br/>
<br/>
n<br/>
<br/>
&#160;⌈(n&#160;+&#160;1)/2⌉&#160;<br/>
comp(S)&#160;≥&#160;|S|&#160;−&#160;⌊n/2⌋<br/>
1<br/>
q<br/>
q<br/>
&#160;<br/>
!<br/>
&#160;⌈(n&#160;+&#160;1)/2⌉&#160;<br/>
<br/>
n<br/>
<br/>
&#160;⌈(n&#160;+&#160;1)/2⌉&#160;<br/>
=&#160;(|S|&#160;−&#160;m)<br/>
+<br/>
m&#160;−<br/>
≥&#160;(|S|&#160;−&#160;m)&#160;d&#160;+&#160;md&#160;=&#160;|S|d.<br/>
1<br/>
1<br/>
q<br/>
⌊n/2⌋&#160;q<br/>
q<br/>
24<br/>
<hr/>
<a name=25></a><img class="yflip" src="html/1610.01521-25_1.png"/><br/>
<img class="yflip" src="html/1610.01521-25_2.png"/><br/>
<img class="yflip" src="html/1610.01521-25_3.png"/><br/>
<img class="yflip" src="html/1610.01521-25_4.png"/><br/>
<img class="yflip" src="html/1610.01521-25_5.png"/><br/>
<img class="yflip" src="html/1610.01521-25_6.png"/><br/>
<img class="yflip" src="html/1610.01521-25_7.png"/><br/>
<img class="yflip" src="html/1610.01521-25_8.png"/><br/>
<img class="yflip" src="html/1610.01521-25_9.png"/><br/>
<img class="yflip" src="html/1610.01521-25_10.png"/><br/>
<img class="yflip" src="html/1610.01521-25_11.png"/><br/>
<img class="yflip" src="html/1610.01521-25_12.png"/><br/>
<img class="yflip" src="html/1610.01521-25_13.png"/><br/>
<img class="yflip" src="html/1610.01521-25_14.png"/><br/>
<img class="yflip" src="html/1610.01521-25_15.png"/><br/>
<img class="yflip" src="html/1610.01521-25_16.png"/><br/>
<img class="yflip" src="html/1610.01521-25_17.png"/><br/>
<img class="yflip" src="html/1610.01521-25_18.png"/><br/>
<img class="yflip" src="html/1610.01521-25_19.png"/><br/>
<img class="yflip" src="html/1610.01521-25_20.png"/><br/>
<img class="yflip" src="html/1610.01521-25_21.png"/><br/>
<img class="yflip" src="html/1610.01521-25_22.png"/><br/>
<img class="yflip" src="html/1610.01521-25_23.png"/><br/>
<img class="yflip" src="html/1610.01521-25_24.png"/><br/>
<img class="yflip" src="html/1610.01521-25_25.png"/><br/>
<img class="yflip" src="html/1610.01521-25_26.png"/><br/>
<img class="yflip" src="html/1610.01521-25_27.png"/><br/>
<img class="yflip" src="html/1610.01521-25_28.png"/><br/>
<img class="yflip" src="html/1610.01521-25_29.png"/><br/>
<img class="yflip" src="html/1610.01521-25_30.png"/><br/>
<img class="yflip" src="html/1610.01521-25_31.png"/><br/>
<img class="yflip" src="html/1610.01521-25_32.png"/><br/>
<img class="yflip" src="html/1610.01521-25_33.png"/><br/>
<img class="yflip" src="html/1610.01521-25_34.png"/><br/>
<img class="yflip" src="html/1610.01521-25_35.png"/><br/>
<img class="yflip" src="html/1610.01521-25_36.png"/><br/>
<img class="yflip" src="html/1610.01521-25_37.png"/><br/>
<img class="yflip" src="html/1610.01521-25_38.png"/><br/>
<img class="yflip" src="html/1610.01521-25_39.png"/><br/>
<img class="yflip" src="html/1610.01521-25_40.png"/><br/>
<img class="yflip" src="html/1610.01521-25_41.png"/><br/>
<img class="yflip" src="html/1610.01521-25_42.png"/><br/>
<img class="yflip" src="html/1610.01521-25_43.png"/><br/>
<img class="yflip" src="html/1610.01521-25_44.png"/><br/>
<img class="yflip" src="html/1610.01521-25_45.png"/><br/>
Thus,&#160;by&#160;Lemma&#160;<a href="1610.01521s.html#23">5.4,&#160;</a>there&#160;is&#160;a&#160;collection&#160;of&#160;at&#160;most<br/>
N<br/>
&#160;containers,&#160;each&#160;of&#160;cardinality<br/>
≤N/d<br/>
at&#160;most&#160;m&#160;+&#160;N&#160;,&#160;such&#160;that&#160;each&#160;antichain&#160;is&#160;contained&#160;in&#160;at&#160;least&#160;one&#160;container.&#160;Thus,&#160;the<br/>
d<br/>
number&#160;of&#160;antichains&#160;in&#160;V&#160;(q,&#160;n)&#160;is&#160;at&#160;most<br/>
<br/>
N<br/>
<br/>
N<br/>
2m+&#160;N<br/>
)(log(e·d)+1)<br/>
d<br/>
≤&#160;(e&#160;·&#160;d)&#160;d&#160;2m+Nd&#160;=&#160;2m+log&#160;N+(&#160;Nd<br/>
≤&#160;N/d<br/>
Since&#160;q&#160;is&#160;fixed,&#160;we&#160;can&#160;use&#160;Theorem&#160;<a href="1610.01521s.html#32">A.1&#160;</a>to&#160;bound&#160;the&#160;exponent&#160;as&#160;follows:<br/>
h<br/>
n<br/>
i<br/>
&#160;N&#160;<br/>
⌊n/2⌋<br/>
<br/>
N&#160;·&#160;n<br/>
m&#160;+&#160;log&#160;N&#160;+<br/>
(log(e&#160;·&#160;d)&#160;+&#160;1)&#160;≤<br/>
q<br/>
+&#160;O&#160;n2&#160;+<br/>
d<br/>
h<br/>
i−1<br/>
d<br/>
1&#160;−&#160;d&#160;⌈(n+1)/2⌉<br/>
1<br/>
q<br/>
h<br/>
i<br/>
2d<br/>
n<br/>
<br/>
n<br/>
<br/>
⌊n/2⌋<br/>
&#160;N&#160;·&#160;n<br/>
≤<br/>
+<br/>
q&#160;+&#160;O<br/>
.<br/>
⌊n/2⌋<br/>
h<br/>
i<br/>
d<br/>
q<br/>
⌈(n+1)/2⌉<br/>
1<br/>
q<br/>
<br/>
<br/>
h<br/>
i<br/>
h<br/>
i<br/>
This&#160;completes&#160;the&#160;proof&#160;since&#160;N&#160;=&#160;Θ<br/>
n<br/>
and,&#160;for&#160;fixed&#160;q,&#160;we&#160;have&#160;⌈(n+1)/2⌉<br/>
=<br/>
⌊n/2⌋&#160;q<br/>
1<br/>
q<br/>
Θ&#160;qn/2.<br/>
√<br/>
√<br/>
Proof&#160;of&#160;Theorem&#160;<a href="1610.01521s.html#4">1.7.&#160;</a>Set&#160;d1&#160;:=&#160;n&#160;log&#160;n,&#160;d2&#160;:=<br/>
n&#160;log&#160;n,&#160;m0&#160;:=&#160;3n,&#160;m1&#160;:=<br/>
2ℓn(n)<br/>
and<br/>
1−50d1/n2<br/>
m2&#160;:=&#160;ℓn(n)&#160;.&#160;If&#160;S&#160;is&#160;a&#160;subset&#160;of&#160;{0,&#160;1,&#160;2}n&#160;of&#160;cardinality&#160;at&#160;least&#160;m<br/>
1−4d<br/>
1,&#160;then,&#160;by&#160;Theorem&#160;<a href="1610.01521s.html#3">1.4,</a><br/>
2/n<br/>
&#160;n2&#160;<br/>
comp(S)&#160;≥&#160;(|S|&#160;−&#160;2ℓn(n))&#160;50<br/>
&#160;n2&#160;<br/>
&#160;n2&#160;<br/>
=&#160;(|S|&#160;−&#160;m1)<br/>
+&#160;(m<br/>
≥&#160;(|S|&#160;−&#160;m<br/>
50<br/>
1&#160;−&#160;2ℓn(n))<br/>
50<br/>
1)d1&#160;+&#160;m1d1&#160;=&#160;|S|d1,<br/>
<br/>
<br/>
since&#160;(m<br/>
n2<br/>
1&#160;−&#160;2ℓn(n))<br/>
=&#160;m<br/>
50<br/>
1d1.<br/>
Similarly,&#160;if&#160;the&#160;cardinality&#160;of&#160;S&#160;is&#160;at&#160;least&#160;m2,&#160;then<br/>
comp(S)&#160;≥&#160;|S|d2.&#160;Therefore,&#160;we&#160;can&#160;apply&#160;Lemma&#160;<a href="1610.01521s.html#23">5.4&#160;</a>to&#160;{0,&#160;1,&#160;2}n&#160;with&#160;k&#160;=&#160;2&#160;and&#160;these<br/>values&#160;of&#160;d<br/>
<br/>
m1<br/>
<br/>
1,&#160;d2,&#160;m0,&#160;m1&#160;and&#160;m2&#160;to&#160;obtain&#160;a&#160;collection&#160;F&#160;of&#160;at&#160;most<br/>
3n<br/>
containers,<br/>
≤3n/d1<br/>
≤m1/d2<br/>
each&#160;of&#160;cardinality&#160;at&#160;most&#160;m2&#160;+&#160;m1&#160;+&#160;3n&#160;,&#160;such&#160;that&#160;each&#160;antichain&#160;of<br/>
d<br/>
{0,&#160;1,&#160;2}n&#160;is&#160;contained<br/>
2<br/>
d1<br/>
in&#160;at&#160;least&#160;one&#160;container.&#160;We&#160;get&#160;that&#160;the&#160;number&#160;of&#160;antichains&#160;in&#160;{0,&#160;1,&#160;2}n&#160;is&#160;at&#160;most<br/>
<br/>
3n<br/>
<br/>
m<br/>
<br/>
1<br/>
2m2+&#160;m1&#160;+&#160;3n<br/>
+&#160;3n<br/>
d2<br/>
d1&#160;≤&#160;(e&#160;·&#160;d<br/>
d1<br/>
≤&#160;3n/d<br/>
1)3n/d1&#160;(e&#160;·&#160;d2)m1/d2&#160;2m2+&#160;m1<br/>
d2<br/>
1<br/>
≤&#160;m1/d2<br/>
&#160;3n&#160;log&#160;n<br/>
<br/>
≤&#160;m<br/>
+&#160;m1&#160;log&#160;n<br/>
2&#160;2+O<br/>
d1<br/>
d2<br/>
for&#160;n&#160;sufficiently&#160;large.&#160;Now,&#160;bounding&#160;the&#160;exponent,&#160;we&#160;get<br/>
&#160;3n&#160;log&#160;n<br/>
m<br/>
<br/>
ℓ<br/>
&#160;3n&#160;log&#160;n<br/>
ℓ<br/>
<br/>
m<br/>
1&#160;log&#160;n<br/>
n(n)<br/>
n(n)&#160;log&#160;n<br/>
2&#160;+&#160;O<br/>
+<br/>
=<br/>
+&#160;O<br/>
+<br/>
d1<br/>
d2<br/>
1&#160;−&#160;4d2/n<br/>
d1<br/>
d2<br/>
8d<br/>
&#160;3n&#160;log&#160;n<br/>
ℓ<br/>
<br/>
≤&#160;ℓ<br/>
2ℓn(n)<br/>
n(n)&#160;log&#160;n<br/>
n(n)&#160;+<br/>
+&#160;O<br/>
+<br/>
n<br/>
d1<br/>
d2<br/>
<br/>
<br/>
<br/>
=&#160;1&#160;+&#160;O&#160;plog&#160;n/n<br/>
ℓn(n)<br/>
<br/>
<br/>
since&#160;ℓ<br/>
3n<br/>
n(n)&#160;=&#160;Θ<br/>
√<br/>
by&#160;Theorem&#160;<a href="1610.01521s.html#32">A.2.&#160;</a>The&#160;result&#160;follows.<br/>
n<br/>
25<br/>
<hr/>
<a name=26></a><img class="yflip" src="html/1610.01521-26_1.png"/><br/>
<img class="yflip" src="html/1610.01521-26_2.png"/><br/>
<img class="yflip" src="html/1610.01521-26_3.png"/><br/>
<img class="yflip" src="html/1610.01521-26_4.png"/><br/>
<img class="yflip" src="html/1610.01521-26_5.png"/><br/>
Remark&#160;6.2.&#160;Balogh,&#160;Treglown&#160;and&#160;Wagner&#160;<a href="1610.01521s.html#30">[8]&#160;</a>have&#160;also&#160;used&#160;the&#160;container&#160;method&#160;to&#160;prove<br/>an&#160;upper&#160;bound&#160;on&#160;the&#160;number&#160;of&#160;antichains&#160;in&#160;P(n).&#160;Their&#160;proof&#160;only&#160;applies&#160;a&#160;single-stage<br/>container&#160;lemma&#160;(similar&#160;to&#160;Lemma&#160;<a href="1610.01521s.html#21">5.2)</a>,&#160;however,&#160;and&#160;so&#160;the&#160;bound&#160;that&#160;they&#160;obtain&#160;is<br/>weaker&#160;than&#160;that&#160;of&#160;Theorem&#160;<a href="1610.01521s.html#23">6.1.</a><br/>
In&#160;the&#160;proofs&#160;of&#160;Theorems&#160;<a href="1610.01521s.html#23">6.1&#160;</a>and&#160;<a href="1610.01521s.html#4">1.7&#160;</a>we&#160;used&#160;Lemma&#160;<a href="1610.01521s.html#21">5.3&#160;</a>with&#160;k&#160;=&#160;2&#160;and&#160;in&#160;the&#160;proof<br/>
of&#160;Theorem&#160;<a href="1610.01521s.html#4">1.6&#160;</a>we&#160;used&#160;Lemma&#160;<a href="1610.01521s.html#21">5.3&#160;</a>with&#160;k&#160;=&#160;1.&#160;We&#160;remark&#160;that&#160;it&#160;is&#160;not&#160;possible&#160;to&#160;obtain<br/>better&#160;bounds&#160;by&#160;following&#160;the&#160;same&#160;proof&#160;with&#160;a&#160;larger&#160;fixed&#160;value&#160;of&#160;k.<br/>
We&#160;should&#160;also&#160;mention&#160;that&#160;much&#160;stronger&#160;bounds&#160;than&#160;that&#160;of&#160;Theorem&#160;<a href="1610.01521s.html#23">6.1&#160;</a>are&#160;known.<br/>
In&#160;particular,&#160;Korshunov&#160;<a href="1610.01521s.html#31">[27]&#160;</a>obtained&#160;precise&#160;asymptotics&#160;of&#160;the&#160;number&#160;of&#160;antichains&#160;in<br/>P(n).<br/>
6.2<br/>
Antichains&#160;in&#160;Random&#160;Subsets<br/>
In&#160;this&#160;section,&#160;we&#160;use&#160;Lemma&#160;<a href="1610.01521s.html#23">5.4&#160;</a>to&#160;prove&#160;Theorems&#160;<a href="1610.01521s.html#4">1.8&#160;</a>and&#160;<a href="1610.01521s.html#4">1.9.&#160;</a>We&#160;remark&#160;that&#160;our<br/>approach&#160;is&#160;very&#160;similar&#160;to&#160;that&#160;of&#160;Balogh,&#160;Mycroft&#160;and&#160;Treglown&#160;<a href="1610.01521s.html#30">[6]&#160;</a>who&#160;used&#160;a&#160;rough&#160;form<br/>of&#160;Theorem&#160;<a href="1610.01521s.html#6">3.1&#160;</a>to&#160;show&#160;that,&#160;when&#160;p&#160;≫&#160;1/n,&#160;the&#160;largest&#160;antichain&#160;in&#160;a&#160;p-random&#160;subset&#160;of<br/>P(n)&#160;is&#160;(1&#160;+&#160;o(1))p<br/>
n&#160;&#160;with&#160;high&#160;probability;&#160;the&#160;same&#160;result&#160;was&#160;obtained&#160;independently<br/>
⌊n/2⌋<br/>
by&#160;Collares&#160;Neto&#160;and&#160;Morris&#160;<a href="1610.01521s.html#30">[11]&#160;</a>using&#160;a&#160;somewhat&#160;different&#160;approach.<br/>
In&#160;both&#160;proofs,&#160;the&#160;first&#160;step&#160;will&#160;be&#160;to&#160;use&#160;Lemma&#160;<a href="1610.01521s.html#21">5.2&#160;</a>to&#160;obtain&#160;a&#160;collection&#160;of&#160;containers<br/>
for&#160;the&#160;antichains&#160;of&#160;the&#160;poset.&#160;Now,&#160;if&#160;a&#160;p-random&#160;subset&#160;contains&#160;a&#160;large&#160;antichain,&#160;then<br/>in&#160;particular&#160;it&#160;must&#160;contain&#160;a&#160;large&#160;subset&#160;of&#160;one&#160;of&#160;the&#160;containers&#160;(since&#160;every&#160;antichain<br/>is&#160;contained&#160;in&#160;some&#160;container).&#160;By&#160;applying&#160;a&#160;version&#160;of&#160;the&#160;standard&#160;Chernoff&#160;Bound<br/>(Theorem&#160;<a href="1610.01521s.html#26">6.3,&#160;</a>stated&#160;below)&#160;one&#160;obtains&#160;that&#160;the&#160;probability&#160;that&#160;this&#160;occurs&#160;for&#160;any&#160;fixed<br/>container&#160;is&#160;very&#160;small&#160;and,&#160;using&#160;the&#160;fact&#160;that&#160;the&#160;number&#160;of&#160;containers&#160;is&#160;not&#160;too&#160;large,&#160;we<br/>can&#160;apply&#160;a&#160;simple&#160;union&#160;bound&#160;to&#160;complete&#160;the&#160;proof.<br/>
Theorem&#160;6.3&#160;(The&#160;Chernoff&#160;Bound;&#160;see,&#160;e.g.,&#160;<a href="1610.01521s.html#31">[17]</a>).&#160;Suppose&#160;that&#160;X1,&#160;.&#160;.&#160;.&#160;,&#160;Xn&#160;are&#160;independent<br/>random&#160;variables&#160;taking&#160;values&#160;in&#160;{0,&#160;1}&#160;and&#160;let&#160;X&#160;:=&#160;Pni=1&#160;Xi.&#160;Then<br/>
<br/>
e−&#160;δ2E(X)<br/>
3<br/>
if&#160;0&#160;&lt;&#160;δ&#160;&lt;&#160;1,<br/>
P(X&#160;&gt;&#160;(1&#160;+&#160;δ)E(X))&#160;≤<br/>
e−&#160;δE(X)<br/>
3<br/>
if&#160;δ&#160;&gt;&#160;1.<br/>
We&#160;prove&#160;Theorem&#160;<a href="1610.01521s.html#4">1.8.</a><br/>
<br/>
<br/>
h<br/>
i<br/>
Proof&#160;of&#160;Theorem&#160;<a href="1610.01521s.html#4">1.8.&#160;</a>Define&#160;N&#160;:=&#160;|V&#160;(q,&#160;n)&#160;|&#160;and&#160;note&#160;that&#160;N&#160;=&#160;Θ<br/>
n<br/>
by&#160;Theo-<br/>
⌈n/2⌉&#160;q<br/>
rem&#160;<a href="1610.01521s.html#32">A.1.&#160;</a>Let&#160;p&#160;=&#160;c(ε,&#160;q)/qn/2&#160;for&#160;some&#160;constant&#160;c(ε,&#160;q),&#160;to&#160;be&#160;chosen&#160;later,&#160;and&#160;let&#160;Ap&#160;be&#160;a<br/>subset&#160;of&#160;V&#160;(q,&#160;n)&#160;obtained&#160;by&#160;including&#160;each&#160;element&#160;independently&#160;with&#160;probability&#160;p.&#160;Let<br/>
h<br/>
i<br/>
m&#160;:=&#160;(1&#160;+&#160;ε/2)<br/>
n<br/>
.&#160;By&#160;Theorem&#160;<a href="1610.01521s.html#2">1.2,&#160;</a>every&#160;subset&#160;S&#160;of<br/>
⌈n/2⌉<br/>
V&#160;(q,&#160;n)&#160;of&#160;cardinality&#160;at&#160;least&#160;m<br/>
q<br/>
satisfies<br/>
<br/>
1<br/>
&#160;&#160;⌈(n&#160;+&#160;1)/2⌉&#160;<br/>
<br/>
<br/>
&#160;ε&#160;<br/>
⌈(n&#160;+&#160;1)/2⌉<br/>
comp(S)&#160;≥&#160;1&#160;−<br/>
|S|&#160;≥<br/>
|S|<br/>
1&#160;+&#160;ε/2<br/>
1<br/>
3<br/>
1<br/>
q<br/>
q<br/>
h<br/>
i<br/>
given&#160;that&#160;ε&#160;∈&#160;(0,&#160;1).&#160;So,&#160;we&#160;set&#160;d&#160;:=&#160;ε&#160;&#160;⌈(n+1)/2⌉<br/>
and&#160;let&#160;f&#160;be&#160;the&#160;function&#160;resulting&#160;from<br/>
3<br/>
1<br/>
q<br/>
applying&#160;Lemma&#160;<a href="1610.01521s.html#21">5.2&#160;</a>to&#160;V&#160;(q,&#160;n)&#160;with&#160;these&#160;values&#160;m&#160;and&#160;d.&#160;Note&#160;that,&#160;since&#160;q&#160;is&#160;constant,&#160;we<br/>have&#160;d&#160;=&#160;Θ&#160;qn/2.&#160;In&#160;particular,&#160;p&#160;is&#160;bounded&#160;below&#160;by&#160;a&#160;constant&#160;multiple&#160;of&#160;c(ε,&#160;q)/d.<br/>
26<br/>
<hr/>
<a name=27></a><img class="yflip" src="html/1610.01521-27_1.png"/><br/>
<img class="yflip" src="html/1610.01521-27_2.png"/><br/>
<img class="yflip" src="html/1610.01521-27_3.png"/><br/>
<img class="yflip" src="html/1610.01521-27_4.png"/><br/>
<img class="yflip" src="html/1610.01521-27_5.png"/><br/>
<img class="yflip" src="html/1610.01521-27_6.png"/><br/>
<img class="yflip" src="html/1610.01521-27_7.png"/><br/>
<img class="yflip" src="html/1610.01521-27_8.png"/><br/>
<img class="yflip" src="html/1610.01521-27_9.png"/><br/>
<img class="yflip" src="html/1610.01521-27_10.png"/><br/>
<img class="yflip" src="html/1610.01521-27_11.png"/><br/>
<img class="yflip" src="html/1610.01521-27_12.png"/><br/>
<img class="yflip" src="html/1610.01521-27_13.png"/><br/>
<img class="yflip" src="html/1610.01521-27_14.png"/><br/>
Fix&#160;T&#160;⊆&#160;V&#160;(q,&#160;n)&#160;such&#160;that&#160;|T&#160;|&#160;≤&#160;N&#160;.&#160;The&#160;probability&#160;that&#160;A<br/>
2d+1<br/>
p&#160;contains&#160;an&#160;antichain&#160;I<br/>
h<br/>
i<br/>
of&#160;size&#160;at&#160;least&#160;(1&#160;+&#160;ε)p<br/>
n<br/>
with&#160;T<br/>
⌈n/2⌉<br/>
⊆&#160;I&#160;⊆&#160;T&#160;∪&#160;f(T&#160;)&#160;is&#160;at&#160;most<br/>
q<br/>
&#160;<br/>
!<br/>
<br/>
n<br/>
<br/>
P(T&#160;⊆&#160;Ap)&#160;·&#160;P&#160;|Ap&#160;∩&#160;f&#160;(T&#160;)|&#160;≥&#160;p(1&#160;+&#160;ε)<br/>
−&#160;|T&#160;|<br/>
⌈n/2⌉&#160;q<br/>
<br/>
<br/>
h<br/>
i<br/>
since&#160;T&#160;∩&#160;f&#160;(T&#160;)&#160;=&#160;∅.&#160;By&#160;Theorem&#160;<a href="1610.01521s.html#32">A.1,&#160;</a>|T&#160;|&#160;≤&#160;N&#160;=&#160;O&#160;q−n/2<br/>
n<br/>
.&#160;By&#160;choosing&#160;c(ε,&#160;q)<br/>
2d+1<br/>
⌈n/2⌉&#160;q<br/>
h<br/>
i<br/>
sufficiently&#160;large,&#160;we&#160;can&#160;make&#160;|T&#160;|&#160;≤&#160;ε&#160;&#160;p<br/>
n<br/>
and&#160;so&#160;we&#160;get&#160;that&#160;the&#160;above&#160;probability<br/>
4<br/>
⌈n/2⌉&#160;q<br/>
is&#160;at&#160;most<br/>
&#160;<br/>
!<br/>
<br/>
n<br/>
<br/>
p|T&#160;|P&#160;|Ap&#160;∩&#160;f&#160;(T&#160;)|&#160;≥&#160;p(1&#160;+&#160;3ε/4)<br/>
.<br/>
⌈n/2⌉&#160;q<br/>
h<br/>
i<br/>
(1+3ε/4)<br/>
n<br/>
−|f(T&#160;)|<br/>
⌈n/2⌉<br/>
Applying&#160;Theorem&#160;<a href="1610.01521s.html#26">6.3&#160;</a>with&#160;δ&#160;=<br/>
q<br/>
we&#160;get&#160;that<br/>
|f(T&#160;)|<br/>
<br/>
&#160;<br/>
!<br/>
<br/>
n<br/>
<br/>
e−&#160;δ2|f(T)|p<br/>
3<br/>
if&#160;0&#160;&lt;&#160;δ&#160;&lt;&#160;1,<br/>
P<br/>
|Ap&#160;∩&#160;f(T&#160;)|&#160;≥&#160;p(1&#160;+&#160;3ε/4)<br/>
≤<br/>
⌈n/2⌉&#160;q<br/>
e−&#160;δ|f&#160;(T&#160;)|p<br/>
3<br/>
if&#160;δ&#160;&gt;&#160;1.<br/>
h<br/>
i<br/>
Since&#160;|f&#160;(T&#160;)|&#160;≤&#160;m&#160;=&#160;(1&#160;+&#160;ε/2)<br/>
n<br/>
,&#160;the&#160;right&#160;side&#160;is&#160;bounded&#160;above&#160;by&#160;e−ε2mp/100.&#160;There-<br/>
⌈n/2⌉&#160;q<br/>
h<br/>
i<br/>
fore,&#160;the&#160;probability&#160;that&#160;A<br/>
n<br/>
p&#160;contains&#160;an&#160;antichain&#160;of&#160;size&#160;at&#160;least&#160;(1&#160;+&#160;ε)p<br/>
is&#160;at<br/>
⌈n/2⌉&#160;q<br/>
most<br/>
N/(2d+1)&#160;<br/>
<br/>
X<br/>
X<br/>
N<br/>
p|T&#160;|e−ε2mp/100&#160;≤<br/>
pae−ε2mp/100.<br/>
a<br/>
T&#160;⊆V(q,n)<br/>
a=0<br/>
|T&#160;|≤N/(2d+1)<br/>
Given&#160;that&#160;c(ε,&#160;q)&#160;is&#160;large&#160;enough,&#160;the&#160;quantity&#160;Npa&#160;is&#160;increasing&#160;for&#160;0<br/>
.&#160;Thus,<br/>
a<br/>
≤&#160;a&#160;≤&#160;N<br/>
2d+1<br/>
this&#160;is&#160;bounded&#160;above&#160;by<br/>
<br/>
N<br/>
<br/>
+&#160;1&#160;(e(2d&#160;+&#160;1)p)N/(2d+1)&#160;e−ε2mp/100.<br/>
2d&#160;+&#160;1<br/>
Since&#160;d&#160;=&#160;Θ&#160;qn/2&#160;and&#160;N&#160;=&#160;Θ(m),&#160;the&#160;quantity&#160;e(2d&#160;+&#160;1)p&#160;bounded&#160;above&#160;by&#160;a&#160;constant<br/>multiple&#160;of&#160;c(ε,&#160;q)&#160;and&#160;ε2mp/100&#160;is&#160;bounded&#160;below&#160;by&#160;a&#160;constant&#160;multiple&#160;(depending&#160;only&#160;on<br/>
<br/>
<br/>
ε&#160;and&#160;q)&#160;of&#160;c(ε,&#160;q)<br/>
N<br/>
.&#160;Therefore,&#160;we&#160;may&#160;choose&#160;c(ε,&#160;q)&#160;large&#160;enough&#160;so&#160;that&#160;log(e(2d&#160;+<br/>
2d+1<br/>
<br/>
<br/>
1)p)<br/>
N<br/>
&lt;&#160;ε2mp/200,&#160;and&#160;so&#160;the&#160;above&#160;expression&#160;is&#160;o(1).&#160;The&#160;result&#160;follows.<br/>
2d+1<br/>
Let&#160;us&#160;note&#160;that&#160;Theorem&#160;<a href="1610.01521s.html#4">1.8&#160;</a>is&#160;best&#160;possible&#160;up&#160;to&#160;the&#160;choice&#160;of&#160;the&#160;constant&#160;c(ε,&#160;q).<br/>
Let&#160;Ap&#160;be&#160;a&#160;p-random&#160;subset&#160;of&#160;V&#160;(q,&#160;n)&#160;where&#160;p&#160;=&#160;c/qn/2&#160;for&#160;some&#160;constant&#160;c&#160;&gt;&#160;0&#160;and<br/>let&#160;n&#160;be&#160;large&#160;with&#160;respect&#160;to&#160;q&#160;and&#160;c.&#160;Given&#160;x&#160;∈&#160;V&#160;(q,&#160;n)&#160;of&#160;dimension&#160;⌈(n&#160;+&#160;1)/2⌉,&#160;the<br/>expected&#160;number&#160;of&#160;subspaces&#160;of&#160;x&#160;of&#160;dimension&#160;⌊n/2⌋&#160;contained&#160;in&#160;Ap&#160;is&#160;constant.&#160;Thus,<br/>with&#160;probability&#160;bounded&#160;away&#160;from&#160;zero,&#160;a&#160;constant&#160;proportion&#160;of&#160;the&#160;elements&#160;of&#160;V&#160;(q,&#160;n)∩Ap<br/>of&#160;dimension&#160;⌈(n&#160;+&#160;1)/2⌉&#160;have&#160;no&#160;subspaces&#160;of&#160;dimension&#160;⌊n/2⌋&#160;contained&#160;in&#160;Ap.&#160;Taking&#160;this<br/>set&#160;along&#160;with&#160;all&#160;subspaces&#160;of&#160;Fnq&#160;of&#160;dimension&#160;⌊n/2⌋&#160;contained&#160;in&#160;Ap&#160;gives&#160;us&#160;an&#160;antichain<br/>
27<br/>
<hr/>
<a name=28></a><img class="yflip" src="html/1610.01521-28_1.png"/><br/>
<img class="yflip" src="html/1610.01521-28_2.png"/><br/>
<img class="yflip" src="html/1610.01521-28_3.png"/><br/>
<img class="yflip" src="html/1610.01521-28_4.png"/><br/>
<img class="yflip" src="html/1610.01521-28_5.png"/><br/>
<img class="yflip" src="html/1610.01521-28_6.png"/><br/>
<img class="yflip" src="html/1610.01521-28_7.png"/><br/>
<img class="yflip" src="html/1610.01521-28_8.png"/><br/>
<img class="yflip" src="html/1610.01521-28_9.png"/><br/>
<img class="yflip" src="html/1610.01521-28_10.png"/><br/>
<img class="yflip" src="html/1610.01521-28_11.png"/><br/>
<img class="yflip" src="html/1610.01521-28_12.png"/><br/>
<img class="yflip" src="html/1610.01521-28_13.png"/><br/>
<img class="yflip" src="html/1610.01521-28_14.png"/><br/>
<img class="yflip" src="html/1610.01521-28_15.png"/><br/>
<img class="yflip" src="html/1610.01521-28_16.png"/><br/>
<img class="yflip" src="html/1610.01521-28_17.png"/><br/>
<img class="yflip" src="html/1610.01521-28_18.png"/><br/>
<img class="yflip" src="html/1610.01521-28_19.png"/><br/>
<img class="yflip" src="html/1610.01521-28_20.png"/><br/>
<img class="yflip" src="html/1610.01521-28_21.png"/><br/>
<img class="yflip" src="html/1610.01521-28_22.png"/><br/>
<img class="yflip" src="html/1610.01521-28_23.png"/><br/>
h<br/>
i<br/>
of&#160;size&#160;at&#160;least&#160;(1&#160;+&#160;ε)p<br/>
n<br/>
for&#160;some&#160;ε&#160;=&#160;ε(q,&#160;c)&#160;&gt;&#160;0.&#160;Here,&#160;we&#160;used&#160;the&#160;fact&#160;that<br/>
⌊n/2⌋&#160;q<br/>
<br/>
<br/>
h<br/>
n<br/>
i<br/>
h<br/>
i<br/>
=&#160;Θ<br/>
n<br/>
for&#160;fixed&#160;q&#160;(Theorem&#160;<a href="1610.01521s.html#32">A.1)</a>.&#160;A&#160;similar&#160;argument&#160;shows&#160;that<br/>
⌈(n+1)/2⌉&#160;q<br/>
⌊n/2⌋&#160;q<br/>
Theorem&#160;<a href="1610.01521s.html#4">1.9&#160;</a>is&#160;best&#160;possible&#160;up&#160;to&#160;the&#160;choice&#160;of&#160;c(ε).&#160;Next,&#160;we&#160;apply&#160;Lemma&#160;<a href="1610.01521s.html#21">5.2&#160;</a>and<br/>Theorem&#160;<a href="1610.01521s.html#3">1.4&#160;</a>to&#160;prove&#160;Theorem&#160;<a href="1610.01521s.html#4">1.9.</a><br/>
Proof&#160;of&#160;Theorem&#160;<a href="1610.01521s.html#4">1.9.&#160;</a>Let&#160;p&#160;=&#160;c(ε)/n&#160;for&#160;some&#160;constant&#160;c(ε)&#160;to&#160;be&#160;chosen&#160;later&#160;and&#160;let&#160;Ap<br/>be&#160;a&#160;subset&#160;of&#160;{0,&#160;1,&#160;2}n&#160;obtained&#160;by&#160;including&#160;each&#160;element&#160;independently&#160;with&#160;probability&#160;p.<br/>Let&#160;m1&#160;:=&#160;3ℓn(n)&#160;and&#160;let&#160;m2&#160;:=&#160;(1&#160;+&#160;ε/2)ℓn(n).&#160;By&#160;Theorem&#160;<a href="1610.01521s.html#3">1.4,&#160;</a>every&#160;subset&#160;S&#160;of&#160;{0,&#160;1,&#160;2}n<br/>of&#160;cardinality&#160;at&#160;least&#160;m1&#160;satisfies<br/>
&#160;n2&#160;<br/>
&#160;n2&#160;<br/>
comp(S)&#160;≥&#160;(|S|&#160;−&#160;2ℓn(n))<br/>
≥<br/>
|S|<br/>
50<br/>
200<br/>
Also,&#160;by&#160;Theorem&#160;<a href="1610.01521s.html#3">1.4,&#160;</a>every&#160;subset&#160;S&#160;of&#160;{0,&#160;1,&#160;2}n&#160;of&#160;cardinality&#160;at&#160;least&#160;m2&#160;satisfies<br/>
&#160;n&#160;<br/>
&#160;εn&#160;<br/>
comp(S)&#160;≥&#160;(|S|&#160;−&#160;ℓn(n))<br/>
≥<br/>
|S|<br/>
4<br/>
12<br/>
given&#160;that&#160;ε&#160;∈&#160;(0,&#160;1).&#160;So,&#160;we&#160;set&#160;d1&#160;:=&#160;n2&#160;and&#160;d<br/>
.&#160;Let&#160;f<br/>
200<br/>
2&#160;:=&#160;εn<br/>
12<br/>
1&#160;and&#160;f2&#160;be&#160;the&#160;functions<br/>
resulting&#160;from&#160;applying&#160;Lemma&#160;<a href="1610.01521s.html#21">5.3&#160;</a>to&#160;{0,&#160;1,&#160;2}n&#160;with&#160;k&#160;=&#160;2&#160;and&#160;the&#160;values&#160;of&#160;d1,&#160;d2,&#160;m1,&#160;m2<br/>above.<br/>
Fix&#160;T1&#160;⊆&#160;{0,&#160;1,&#160;2}n&#160;such&#160;that&#160;|T1|&#160;≤&#160;3n&#160;and&#160;fix&#160;T<br/>
.&#160;The<br/>
2d<br/>
2&#160;⊆&#160;f1(T1)&#160;such&#160;that&#160;|T2|&#160;≤<br/>
m1<br/>
1+1<br/>
2d2+1<br/>
probability&#160;that&#160;Ap&#160;contains&#160;an&#160;antichain&#160;I&#160;of&#160;size&#160;at&#160;least&#160;(1&#160;+&#160;ε)pℓn(n)&#160;with&#160;T1&#160;∪&#160;T2&#160;⊆&#160;I&#160;⊆<br/>T1&#160;∪&#160;T2&#160;∪&#160;f2(T1&#160;∪&#160;T2)&#160;is&#160;at&#160;most<br/>
P(T1&#160;∪&#160;T2&#160;⊆&#160;Ap)&#160;·&#160;P&#160;(|Ap&#160;∩&#160;f2&#160;(T1&#160;∪&#160;T2)|&#160;≥&#160;p(1&#160;+&#160;ε)ℓn(n)&#160;−&#160;|T1&#160;∪&#160;T2|)<br/>
(6.4)<br/>
since&#160;(T1&#160;∪&#160;T2)&#160;∩&#160;f2&#160;(T1&#160;∪&#160;T2)&#160;=&#160;∅.&#160;Note&#160;that&#160;|T1&#160;∪&#160;T2|&#160;≤&#160;100·3n&#160;+&#160;6ℓn(n)<br/>
for&#160;large&#160;n<br/>
n2<br/>
εn<br/>
≤&#160;10ℓn(n)<br/>
εn<br/>
by&#160;Theorem&#160;<a href="1610.01521s.html#32">A.2.&#160;</a>Since&#160;p&#160;=&#160;c(ε)/n,&#160;we&#160;may&#160;choose&#160;c(ε)&#160;sufficiently&#160;large&#160;so&#160;that&#160;|T1&#160;∪&#160;T2|&#160;≤<br/>
ε&#160;&#160;pℓ<br/>
4<br/>
n(n).&#160;Therefore,&#160;the&#160;expression&#160;in&#160;<a href="1610.01521s.html#28">(6.4)&#160;</a>is&#160;bounded&#160;above&#160;by<br/>
p|T1∪T2|P&#160;(|Ap&#160;∩&#160;f2(T1&#160;∪&#160;T2)|&#160;≥&#160;p(1&#160;+&#160;3ε/4)ℓn(n))&#160;.<br/>
Applying&#160;Theorem&#160;<a href="1610.01521s.html#26">6.3&#160;</a>with&#160;δ&#160;=&#160;(1+3ε/4)ℓn(n)−|f2(T1∪T2)|&#160;we&#160;get&#160;that<br/>
|f2(T1∪T2)|<br/>
<br/>
e−&#160;δ2|f2(T1∪T2)|p<br/>
3<br/>
if&#160;0&#160;&lt;&#160;δ&#160;&lt;&#160;1,<br/>
P&#160;(|Ap&#160;∩&#160;f2(T1&#160;∪&#160;T2)|&#160;≥&#160;p(1&#160;+&#160;3ε/4)ℓn(n))&#160;≤<br/>
e−&#160;δ|f2(T1∪T2)|p<br/>
3<br/>
if&#160;δ&#160;&gt;&#160;1.<br/>
Since&#160;|f2&#160;(T1&#160;∪&#160;T2)|&#160;≤&#160;(1+ε/2)ℓn(n),&#160;the&#160;right&#160;side&#160;is&#160;bounded&#160;above&#160;by&#160;e−ε2ℓn(n)p/100.&#160;There-<br/>fore,&#160;the&#160;probability&#160;that&#160;Ap&#160;contains&#160;an&#160;antichain&#160;of&#160;size&#160;at&#160;least&#160;(1&#160;+&#160;ε)pℓn(n)&#160;is&#160;at&#160;most<br/>
3n<br/>
m1<br/>
2d1+1&#160;2d2+1&#160;<br/>
<br/>
<br/>
X<br/>
X<br/>
3n<br/>
m1&#160;pa+be−ε2ℓn(n)p/100<br/>
a<br/>
b<br/>
a=0<br/>
b=0<br/>
For&#160;c(ε)&#160;sufficiently&#160;large,&#160;the&#160;quantity&#160;3n&#160;m1pa+b&#160;is&#160;increasing&#160;in&#160;both&#160;a&#160;and&#160;b&#160;in&#160;the&#160;range<br/>
a<br/>
b<br/>
0&#160;≤&#160;a&#160;≤&#160;3n<br/>
and&#160;0<br/>
.&#160;Therefore,&#160;the&#160;above&#160;expression&#160;is&#160;at&#160;most<br/>
2d<br/>
≤&#160;b&#160;≤&#160;m1<br/>
1+1<br/>
2d2+1<br/>
<br/>
3n<br/>
&#160;<br/>
m<br/>
<br/>
m<br/>
1<br/>
3n<br/>
1<br/>
(3ed<br/>
2d1+1&#160;(3ed<br/>
2d2+1&#160;e−ε2ℓn(n)p/100.<br/>
2d<br/>
1p)<br/>
2p)<br/>
1&#160;+&#160;1<br/>
2d2&#160;+&#160;1<br/>
28<br/>
<hr/>
<a name=29></a><img class="yflip" src="html/1610.01521-29_1.png"/><br/>
<img class="yflip" src="html/1610.01521-29_2.png"/><br/>
<img class="yflip" src="html/1610.01521-29_3.png"/><br/>
<img class="yflip" src="html/1610.01521-29_4.png"/><br/>
<img class="yflip" src="html/1610.01521-29_5.png"/><br/>
<img class="yflip" src="html/1610.01521-29_6.png"/><br/>
By&#160;definition&#160;of&#160;d2&#160;and&#160;p,&#160;we&#160;have&#160;that&#160;3ed2p&#160;is&#160;bounded&#160;above&#160;by&#160;a&#160;constant&#160;multiple&#160;of<br/>c(ε)&#160;and,&#160;since&#160;ℓn(n)&#160;=&#160;Θ&#160;(m1),&#160;we&#160;have&#160;that&#160;ε2ℓn(n)p/100&#160;is&#160;bounded&#160;below&#160;by&#160;a&#160;constant<br/>
<br/>
<br/>
multiple&#160;(depending&#160;only&#160;on&#160;ε)&#160;of&#160;c(ε)<br/>
m1<br/>
.&#160;Therefore&#160;we&#160;may&#160;choose&#160;c(ε)&#160;large&#160;enough&#160;so<br/>
2d2+1<br/>
<br/>
<br/>
that&#160;log(3ed<br/>
m1<br/>
2p)<br/>
&lt;&#160;ε2ℓ<br/>
2d<br/>
n(n)p/200&#160;and&#160;so&#160;the&#160;above&#160;expression&#160;is&#160;o(1).&#160;This&#160;completes<br/>
2+1<br/>
the&#160;proof.<br/>
To&#160;close&#160;this&#160;section,&#160;we&#160;remark&#160;that&#160;none&#160;of&#160;the&#160;proofs&#160;in&#160;this&#160;section&#160;required&#160;asymptot-<br/>
ically&#160;sharp&#160;supersaturation&#160;results.&#160;In&#160;applying&#160;the&#160;container&#160;method,&#160;it&#160;is&#160;often&#160;sufficient<br/>to&#160;have&#160;a&#160;supersaturation&#160;result&#160;which&#160;is&#160;best&#160;possible&#160;up&#160;to&#160;a&#160;constant&#160;factor&#160;(such&#160;as&#160;the<br/>graph&#160;supersaturation&#160;theorem&#160;of&#160;Erd˝os&#160;and&#160;Simonovits&#160;<a href="1610.01521s.html#31">[20]</a>).<br/>
7<br/>
Open&#160;Problems<br/>
For&#160;general&#160;r&#160;≥&#160;1&#160;one&#160;can&#160;define&#160;a&#160;partial&#160;order&#160;on&#160;{0,&#160;.&#160;.&#160;.&#160;,&#160;r}n&#160;where&#160;x&#160;≤&#160;y&#160;if&#160;and&#160;only&#160;if<br/>xj&#160;≤&#160;yj&#160;for&#160;all&#160;j.&#160;For&#160;0&#160;≤&#160;i&#160;≤&#160;rn&#160;let&#160;ℓi(n,&#160;r)&#160;be&#160;the&#160;number&#160;of&#160;elements&#160;of&#160;{0,&#160;.&#160;.&#160;.&#160;,&#160;r}n&#160;with<br/>coordinate&#160;sum&#160;equal&#160;to&#160;i.&#160;We&#160;propose&#160;the&#160;following&#160;conjecture.<br/>
Conjecture&#160;7.1.&#160;Let&#160;r,&#160;n&#160;be&#160;positive&#160;integers&#160;such&#160;that&#160;n&#160;is&#160;large&#160;with&#160;respect&#160;to&#160;r.&#160;Then,&#160;for<br/>1&#160;≤&#160;m&#160;≤&#160;(r&#160;+&#160;1)n,&#160;the&#160;number&#160;of&#160;comparable&#160;pairs&#160;in&#160;a&#160;subset&#160;of&#160;{0,&#160;.&#160;.&#160;.&#160;,&#160;r}n&#160;of&#160;cardinality&#160;m<br/>is&#160;minimised&#160;by&#160;a&#160;set&#160;whose&#160;elements&#160;have&#160;coordinate&#160;sum&#160;as&#160;close&#160;to&#160;rn/2&#160;as&#160;possible.<br/>
We&#160;remark&#160;that&#160;the&#160;same&#160;conjecture&#160;was&#160;made&#160;independently&#160;by&#160;Balogh&#160;and&#160;Wagner&#160;<a href="1610.01521s.html#30">[10]</a>.<br/>
The&#160;case&#160;r&#160;=&#160;1&#160;of&#160;Conjecture&#160;<a href="1610.01521s.html#29">7.1&#160;</a>follows&#160;from&#160;the&#160;theorem&#160;of&#160;Kleitman&#160;<a href="1610.01521s.html#31">[23]&#160;</a>(without&#160;the<br/>requirement&#160;that&#160;n&#160;is&#160;large),&#160;but&#160;it&#160;is&#160;open&#160;for&#160;all&#160;other&#160;values&#160;of&#160;r.&#160;In&#160;particular,&#160;the&#160;case<br/>r&#160;=&#160;2&#160;of&#160;Conjecture&#160;<a href="1610.01521s.html#29">7.1&#160;</a>is&#160;strictly&#160;stronger&#160;than&#160;Theorem&#160;<a href="1610.01521s.html#3">1.4.&#160;</a>The&#160;following&#160;weak&#160;form&#160;of<br/>Conjecture&#160;<a href="1610.01521s.html#29">7.1&#160;</a>would&#160;be&#160;good&#160;enough&#160;for&#160;certain&#160;applications.<br/>
Conjecture&#160;7.2&#160;(Weak&#160;form&#160;of&#160;Conjecture&#160;<a href="1610.01521s.html#29">7.1)</a>.&#160;Let&#160;r,&#160;k&#160;be&#160;positive&#160;integers.&#160;There&#160;exist&#160;a<br/>positive&#160;constant&#160;c(r,&#160;k)&#160;such&#160;that&#160;for&#160;every&#160;S&#160;⊆&#160;{0,&#160;.&#160;.&#160;.&#160;,&#160;r}n&#160;we&#160;have<br/>
comp(S)&#160;≥&#160;|S|&#160;−&#160;kℓ⌈rn/2⌉(n,&#160;r)&#160;c(r,&#160;k)nk<br/>
The&#160;poset&#160;{0,&#160;.&#160;.&#160;.&#160;,&#160;r}n&#160;can&#160;also&#160;be&#160;viewed&#160;as&#160;the&#160;poset&#160;of&#160;divisors&#160;of&#160;the&#160;rth&#160;power&#160;of&#160;a<br/>
square-free&#160;integer&#160;with&#160;n&#160;prime&#160;factors.&#160;Another&#160;natural&#160;direction&#160;for&#160;future&#160;work&#160;could&#160;be<br/>to&#160;prove&#160;a&#160;non-trivial&#160;supersaturation&#160;theorem&#160;for&#160;the&#160;poset&#160;of&#160;divisors&#160;of&#160;a&#160;general&#160;integer<br/>(perhaps&#160;with&#160;the&#160;number&#160;of&#160;distinct&#160;prime&#160;factors&#160;sufficiently&#160;large&#160;with&#160;respect&#160;to&#160;the&#160;largest<br/>multiplicity&#160;of&#160;a&#160;prime&#160;factor).&#160;As&#160;mentioned&#160;earlier,&#160;Anderson&#160;<a href="1610.01521s.html#30">[1]&#160;</a>proved&#160;that&#160;such&#160;posets<br/>have&#160;regular&#160;coverings&#160;by&#160;chains.&#160;It&#160;seems&#160;possible&#160;that&#160;one&#160;could&#160;prove&#160;a&#160;supersaturation<br/>theorem&#160;for&#160;such&#160;a&#160;poset&#160;by&#160;considering&#160;a&#160;chain&#160;chosen&#160;randomly&#160;according&#160;to&#160;a&#160;distribution<br/>based&#160;on&#160;a&#160;regular&#160;covering&#160;by&#160;chains&#160;and&#160;applying&#160;Lemma&#160;<a href="1610.01521s.html#5">2.2.&#160;</a>The&#160;devil,&#160;however,&#160;is&#160;in&#160;the<br/>details.<br/>
Also,&#160;one&#160;could&#160;consider&#160;supersaturation&#160;problems&#160;for&#160;other&#160;classical&#160;posets.&#160;In&#160;particular,<br/>
it&#160;would&#160;also&#160;be&#160;interesting&#160;to&#160;prove&#160;supersaturation&#160;results&#160;for&#160;posets&#160;which&#160;do&#160;not&#160;have<br/>regular&#160;coverings&#160;by&#160;chains,&#160;or&#160;for&#160;posets&#160;which&#160;are&#160;not&#160;even&#160;ranked.<br/>
In&#160;another&#160;direction,&#160;one&#160;could&#160;try&#160;to&#160;improve&#160;our&#160;bounds&#160;on&#160;the&#160;number&#160;of&#160;antichains&#160;in<br/>
V&#160;(q,&#160;n)&#160;and&#160;{0,&#160;1,&#160;2}n&#160;(Theorems&#160;<a href="1610.01521s.html#4">1.6&#160;</a>and&#160;<a href="1610.01521s.html#4">1.7)&#160;</a>and&#160;obtain&#160;similar&#160;bounds&#160;for&#160;other&#160;posets.<br/>
29<br/>
<hr/>
<a name=30></a>Note&#160;added&#160;in&#160;the&#160;proof.&#160;Following&#160;the&#160;submission&#160;of&#160;this&#160;paper,&#160;Balogh,&#160;Petˇr´ıˇ<br/>
cov´a&#160;and<br/>
Wagner&#160;<a href="1610.01521s.html#30">[7]&#160;</a>disproved&#160;Conjecture&#160;<a href="1610.01521s.html#29">7.1&#160;</a>for&#160;all&#160;r&#160;≥&#160;2&#160;and&#160;Samotij&#160;<a href="1610.01521s.html#31">[32]&#160;</a>proved&#160;the&#160;conjecture&#160;of<br/>Kleitman&#160;<a href="1610.01521s.html#31">[23]&#160;</a>that,&#160;for&#160;any&#160;k&#160;≥&#160;2&#160;and&#160;1&#160;≤&#160;m&#160;≤&#160;2n,&#160;the&#160;number&#160;of&#160;chains&#160;of&#160;length&#160;k&#160;in&#160;a<br/>subset&#160;of&#160;P(n)&#160;of&#160;size&#160;m&#160;is&#160;minimised&#160;by&#160;a&#160;collection&#160;of&#160;subsets&#160;of&#160;[n]&#160;of&#160;size&#160;as&#160;close&#160;to&#160;n/2<br/>as&#160;possible.<br/>
References<br/>
[1]&#160;I.&#160;Anderson.&#160;On&#160;the&#160;divisors&#160;of&#160;a&#160;number.&#160;J.&#160;London&#160;Math.&#160;Soc.,&#160;43:410–418,&#160;1968.<br/>
[2]&#160;I.&#160;Anderson.&#160;A&#160;variance&#160;method&#160;in&#160;combinatorial&#160;number&#160;theory.&#160;Glasgow&#160;Math.&#160;J.,<br/>
10:126–129,&#160;1969.<br/>
[3]&#160;I.&#160;Anderson.&#160;Combinatorics&#160;of&#160;finite&#160;sets.&#160;Oxford&#160;Science&#160;Publications.&#160;The&#160;Clarendon<br/>
Press,&#160;Oxford&#160;University&#160;Press,&#160;New&#160;York,&#160;1987.<br/>
[4]&#160;J.&#160;Balogh,&#160;H.&#160;Liu,&#160;and&#160;M.&#160;Sharifzadeh.&#160;The&#160;number&#160;of&#160;subsets&#160;of&#160;integers&#160;with&#160;no&#160;k-term<br/>
arithmetic&#160;progression.&#160;Int.&#160;Math.&#160;Res.&#160;Not.&#160;IMRN,&#160;2016(00):&#160;1–19.<br/>
[5]&#160;J.&#160;Balogh,&#160;R.&#160;Morris,&#160;and&#160;W.&#160;Samotij.&#160;Independent&#160;sets&#160;in&#160;hypergraphs.&#160;J.&#160;Amer.&#160;Math.<br/>
Soc.,&#160;28(3):669–709,&#160;2015.<br/>
[6]&#160;J.&#160;Balogh,&#160;R.&#160;Mycroft,&#160;and&#160;A.&#160;Treglown.&#160;A&#160;random&#160;version&#160;of&#160;Sperner’s&#160;theorem.&#160;J.<br/>
Combin.&#160;Theory&#160;Ser.&#160;A,&#160;128:104–110,&#160;2014.<br/>
[7]&#160;J.&#160;Balogh,&#160;ˇ<br/>
S.&#160;Petˇr´ıˇcov´a,&#160;and&#160;A.&#160;Zs.&#160;Wagner.&#160;Families&#160;in&#160;posets&#160;minimizing&#160;the&#160;number<br/>
of&#160;comparable&#160;pairs.&#160;<a href="http://arxiv.org/abs/1703.05427">arXiv:1703.05427v</a>1,&#160;preprint.<br/>
[8]&#160;J.&#160;Balogh,&#160;A.&#160;Treglown,&#160;and&#160;A.&#160;Zs.&#160;Wagner.&#160;Applications&#160;of&#160;graph&#160;containers&#160;in&#160;the<br/>
boolean&#160;lattice.&#160;Random&#160;Structures&#160;Algorithms,&#160;49(4):845–872,&#160;2016.<br/>
[9]&#160;J.&#160;Balogh&#160;and&#160;A.&#160;Zs.&#160;Wagner.&#160;Further&#160;applications&#160;of&#160;the&#160;container&#160;method.&#160;In&#160;A.&#160;Bev-<br/>
eridge,&#160;J.&#160;R.&#160;Griggs,&#160;G.&#160;Hogben,&#160;L.&#160;Musiker,&#160;and&#160;P.&#160;Tetali,&#160;editors,&#160;Recent&#160;Trends&#160;in<br/>Combinatorics,&#160;volume&#160;159&#160;of&#160;The&#160;IMA&#160;Volumes&#160;in&#160;Mathematics&#160;and&#160;its&#160;Applications,<br/>pages&#160;191–213.&#160;Springer,&#160;Cham,&#160;2016.<br/>
[10]&#160;J.&#160;Balogh&#160;and&#160;A.&#160;Zs.&#160;Wagner.&#160;Kleitman’s&#160;conjecture&#160;about&#160;families&#160;of&#160;given&#160;size&#160;mini-<br/>
mizing&#160;the&#160;number&#160;of&#160;k-chains.&#160;<a href="http://arxiv.org/abs/1609.02262">arXiv:1609.02262v</a>1,&#160;preprint,&#160;2016.<br/>
[11]&#160;M.&#160;Collares&#160;and&#160;R.&#160;Morris.&#160;Maximum-size&#160;antichains&#160;in&#160;random&#160;set-systems.&#160;Random<br/>
Structures&#160;Algorithms,&#160;49(2):308–321,&#160;2016.<br/>
[12]&#160;D.&#160;Conlon&#160;and&#160;T.&#160;Gowers.&#160;Combinatorial&#160;theorems&#160;in&#160;sparse&#160;random&#160;sets.&#160;Ann.&#160;of&#160;Math.<br/>
(2),&#160;184(2):367–454,&#160;2016.<br/>
[13]&#160;S.&#160;Das,&#160;W.&#160;Gan,&#160;and&#160;B.&#160;Sudakov.&#160;Sperner’s&#160;theorem&#160;and&#160;a&#160;problem&#160;of&#160;Erd˝os,&#160;Katona<br/>
and&#160;Kleitman.&#160;Combin.&#160;Probab.&#160;Comput.,&#160;24(4):585–608,&#160;2015.<br/>
[14]&#160;S.&#160;Das,&#160;W.&#160;Gan&#160;and&#160;B.&#160;Sudakov,&#160;The&#160;minimum&#160;number&#160;of&#160;disjoint&#160;pairs&#160;in&#160;set&#160;systems<br/>
and&#160;related&#160;problems,&#160;Combinatorica,&#160;36(6):623–660,&#160;2016.<br/>
30<br/>
<hr/>
<a name=31></a>[15]&#160;N.&#160;G.&#160;de&#160;Bruijn,&#160;Ca.&#160;van&#160;Ebbenhorst&#160;Tengbergen,&#160;and&#160;D.&#160;Kruyswijk.&#160;On&#160;the&#160;set&#160;of<br/>
divisors&#160;of&#160;a&#160;number.&#160;Nieuw&#160;Arch.&#160;Wiskunde&#160;(2),&#160;23:191–193,&#160;1951.<br/>
[16]&#160;A.&#160;P.&#160;Dove,&#160;J.&#160;R.&#160;Griggs,&#160;R.&#160;J.&#160;Kang,&#160;and&#160;J.-S.&#160;Sereni.&#160;Supersaturation&#160;in&#160;the&#160;Boolean<br/>
lattice.&#160;Integers,&#160;14A:Paper&#160;No.&#160;A4,&#160;7,&#160;2014.<br/>
[17]&#160;D.&#160;P.&#160;Dubhashi&#160;and&#160;A.&#160;Panconesi.&#160;Concentration&#160;of&#160;measure&#160;for&#160;the&#160;analysis&#160;of&#160;random-<br/>
ized&#160;algorithms.&#160;Cambridge&#160;University&#160;Press,&#160;Cambridge,&#160;2009.<br/>
[18]&#160;P.&#160;Erd˝os.&#160;On&#160;a&#160;theorem&#160;of&#160;Rademacher-Tur´<br/>
an.&#160;Illinois&#160;J.&#160;Math.,&#160;6:122–127,&#160;1962.<br/>
[19]&#160;P.&#160;Erd˝os.&#160;Some&#160;recent&#160;results&#160;on&#160;extremal&#160;problems&#160;in&#160;graph&#160;theory.&#160;Results.&#160;In&#160;Theory&#160;of<br/>
Graphs&#160;(Internat.&#160;Sympos.,&#160;Rome,&#160;1966),&#160;pages&#160;117–123&#160;(English);&#160;pp.&#160;124–130&#160;(French).<br/>Gordon&#160;and&#160;Breach,&#160;New&#160;York;&#160;Dunod,&#160;Paris,&#160;1967.<br/>
[20]&#160;P.&#160;Erd˝os&#160;and&#160;M.&#160;Simonovits.&#160;Supersaturated&#160;graphs&#160;and&#160;hypergraphs.&#160;Combinatorica,<br/>
3(2):181–192,&#160;1983.<br/>
[21]&#160;P.&#160;Hall.&#160;On&#160;representatives&#160;of&#160;subsets.&#160;J.&#160;London&#160;Math.&#160;Soc.,&#160;10(1):26–30,&#160;1935.<br/>
[22]&#160;J.&#160;Kahn.&#160;Entropy,&#160;independent&#160;sets&#160;and&#160;antichains:&#160;a&#160;new&#160;approach&#160;to&#160;Dedekind’s<br/>
problem.&#160;Proc.&#160;Amer.&#160;Math.&#160;Soc.,&#160;130(2):371–378,&#160;2002.<br/>
[23]&#160;D.&#160;Kleitman.&#160;A&#160;conjecture&#160;of&#160;Erd˝os-Katona&#160;on&#160;commensurable&#160;pairs&#160;among&#160;subsets&#160;of<br/>
an&#160;n-set.&#160;In&#160;Theory&#160;of&#160;Graphs&#160;(Proc.&#160;Colloq.,&#160;Tihany,&#160;1966),&#160;pages&#160;215–218.&#160;Academic<br/>Press,&#160;New&#160;York,&#160;1968.<br/>
[24]&#160;D.&#160;Kleitman.&#160;On&#160;Dedekind’s&#160;problem:&#160;The&#160;number&#160;of&#160;monotone&#160;Boolean&#160;functions.<br/>
Proc.&#160;Amer.&#160;Math.&#160;Soc.,&#160;21:677–682,&#160;1969.<br/>
[25]&#160;D.&#160;J.&#160;Kleitman.&#160;On&#160;an&#160;extremal&#160;property&#160;of&#160;antichains&#160;in&#160;partial&#160;orders.&#160;The&#160;LYM<br/>
property&#160;and&#160;some&#160;of&#160;its&#160;implications&#160;and&#160;applications.&#160;In&#160;Combinatorics&#160;(Proc.&#160;NATO<br/>Advanced&#160;Study&#160;Inst.,&#160;Breukelen,&#160;1974),&#160;Part&#160;2:&#160;Graph&#160;theory;&#160;foundations,&#160;partitions<br/>and&#160;combinatorial&#160;geometry,&#160;pages&#160;77–90.&#160;Math.&#160;Centre&#160;Tracts,&#160;No.&#160;56.&#160;Math.&#160;Centrum,<br/>Amsterdam,&#160;1974.<br/>
[26]&#160;D.&#160;J.&#160;Kleitman&#160;and&#160;K.&#160;J.&#160;Winston.&#160;On&#160;the&#160;number&#160;of&#160;graphs&#160;without&#160;4-cycles.&#160;Discrete<br/>
Math.,&#160;41(2):167–172,&#160;1982.<br/>
[27]&#160;A.&#160;D.&#160;Korshunov.&#160;The&#160;number&#160;of&#160;monotone&#160;Boolean&#160;functions.&#160;Problemy&#160;Kibernet.,<br/>
(38):5–108,&#160;272,&#160;1981.<br/>
[28]&#160;D.&#160;Lubell.&#160;A&#160;short&#160;proof&#160;of&#160;Sperner’s&#160;lemma.&#160;J.&#160;Combinatorial&#160;Theory,&#160;1:299,&#160;1966.<br/>
[29]&#160;B.&#160;Patk´os.&#160;Supersaturation&#160;and&#160;stability&#160;for&#160;forbidden&#160;subposet&#160;problems.&#160;J.&#160;Combin.<br/>
Theory&#160;Ser.&#160;A,&#160;136:220–237,&#160;2015.<br/>
[30]&#160;C.&#160;Reiher.&#160;The&#160;clique&#160;density&#160;theorem.&#160;Ann.&#160;of&#160;Math.&#160;(2),&#160;184(3):683–707,&#160;2016.<br/>
[31]&#160;W.&#160;Samotij.&#160;Counting&#160;independent&#160;sets&#160;in&#160;graphs.&#160;European&#160;J.&#160;Combin.,&#160;48:5–18,&#160;2015.<br/>
[32]&#160;W.&#160;Samotij.&#160;Subsets&#160;of&#160;posets&#160;minimising&#160;the&#160;number&#160;of&#160;chains.&#160;<a href="http://arxiv.org/abs/1708.02436">arXiv:1708.02436v</a>1,<br/>
preprint.<br/>
31<br/>
<hr/>
<a name=32></a><img class="yflip" src="html/1610.01521-32_1.png"/><br/>
<img class="yflip" src="html/1610.01521-32_2.png"/><br/>
<img class="yflip" src="html/1610.01521-32_3.png"/><br/>
<img class="yflip" src="html/1610.01521-32_4.png"/><br/>
<img class="yflip" src="html/1610.01521-32_5.png"/><br/>
<img class="yflip" src="html/1610.01521-32_6.png"/><br/>
<img class="yflip" src="html/1610.01521-32_7.png"/><br/>
<img class="yflip" src="html/1610.01521-32_8.png"/><br/>
[33]&#160;W.&#160;Samotij&#160;and&#160;B.&#160;Sudakov,&#160;On&#160;the&#160;number&#160;of&#160;monotone&#160;sequences,&#160;J.&#160;Combinatorial<br/>
Theory&#160;Ser.&#160;B&#160;115:132–163,&#160;2015.<br/>
[34]&#160;W.&#160;Samotij&#160;and&#160;B.&#160;Sudakov.&#160;The&#160;number&#160;of&#160;additive&#160;triples&#160;in&#160;subsets&#160;of&#160;abelian&#160;groups.<br/>
Math.&#160;Proc.&#160;Cambridge&#160;Philos.&#160;Soc.,&#160;160(3):495–512,&#160;2016.<br/>
[35]&#160;D.&#160;Saxton&#160;and&#160;A.&#160;Thomason.&#160;Hypergraph&#160;containers.&#160;Invent.&#160;Math.,&#160;201(3):925–992,<br/>
2015.<br/>
[36]&#160;M.&#160;Schacht.<br/>
Extremal&#160;results&#160;for&#160;random&#160;discrete&#160;structures.<br/>
Ann.&#160;of&#160;Math.&#160;(2),<br/>
184(2):333–365,&#160;2016.<br/>
[37]&#160;E.&#160;Sperner.&#160;Ein&#160;Satz&#160;¨<br/>
uber&#160;Untermengen&#160;einer&#160;endlichen&#160;Menge.&#160;Math.&#160;Z.,&#160;27(1):544–548,<br/>
1928.<br/>
[38]&#160;H.&#160;S.&#160;Wilf.&#160;Three&#160;problems&#160;in&#160;combinatorial&#160;asymptotics.&#160;J.&#160;Combin.&#160;Theory&#160;Ser.&#160;A,<br/>
35(2):199–207,&#160;1983.<br/>
A<br/>
Rank&#160;Numbers&#160;in&#160;V&#160;(q,&#160;n)&#160;and&#160;{0,&#160;1,&#160;2}n<br/>
We&#160;provide&#160;a&#160;number&#160;of&#160;results&#160;regarding&#160;the&#160;rank&#160;numbers&#160;in&#160;V&#160;(q,&#160;n)&#160;and&#160;{0,&#160;1,&#160;2}n&#160;that<br/>we&#160;require&#160;in&#160;the&#160;paper.&#160;The&#160;first&#160;is&#160;a&#160;theorem&#160;of&#160;Wilf&#160;<a href="1610.01521s.html#32">[38]&#160;</a>which&#160;is&#160;used&#160;in&#160;the&#160;proofs&#160;of<br/>Theorems&#160;<a href="1610.01521s.html#4">1.6&#160;</a>and&#160;<a href="1610.01521s.html#4">1.8.</a><br/>
Theorem&#160;A.1&#160;(Wilf&#160;<a href="1610.01521s.html#32">[38]</a>).&#160;For&#160;a&#160;fixed&#160;prime&#160;power&#160;q&#160;and&#160;n&#160;→&#160;∞,&#160;we&#160;have<br/>
<br/>
|V&#160;(q,&#160;n)&#160;|&#160;=&#160;Θ&#160;qn2/2&#160;,&#160;and<br/>
<br/>
n<br/>
<br/>
<br/>
=&#160;Θ&#160;qn2/2&#160;.<br/>
⌊n/2⌋&#160;q<br/>
<br/>
<br/>
h<br/>
i<br/>
In&#160;particular,&#160;|V&#160;(q,&#160;n)&#160;|&#160;=&#160;Θ<br/>
n<br/>
.<br/>
⌊n/2⌋&#160;q<br/>
The&#160;following&#160;result&#160;of&#160;Anderson&#160;<a href="1610.01521s.html#30">[2]&#160;</a>is&#160;used&#160;in&#160;the&#160;proofs&#160;of&#160;Theorems&#160;<a href="1610.01521s.html#4">1.7&#160;</a>and&#160;<a href="1610.01521s.html#4">1.9.</a><br/>
<br/>
<br/>
Theorem&#160;A.2&#160;(Anderson&#160;<a href="1610.01521s.html#30">[2]</a>).&#160;ℓ<br/>
3n<br/>
n(n)&#160;=&#160;Θ<br/>
√<br/>
.<br/>
n<br/>
A&#160;sequence&#160;a0,&#160;.&#160;.&#160;.&#160;,&#160;aN&#160;is&#160;said&#160;to&#160;be&#160;log-concave&#160;if&#160;ai+1<br/>
for&#160;1<br/>
a<br/>
≤&#160;ai<br/>
≤&#160;i&#160;≤&#160;N&#160;−&#160;1.&#160;In&#160;the<br/>
i<br/>
ai−1<br/>
proof&#160;of&#160;Theorem&#160;<a href="1610.01521s.html#3">1.4&#160;</a>we&#160;use&#160;the&#160;following&#160;theorem,&#160;which&#160;has&#160;been&#160;proven&#160;in&#160;several&#160;different<br/>papers&#160;(see&#160;Chapter&#160;4&#160;of&#160;<a href="1610.01521s.html#30">[3]&#160;</a>for&#160;references).&#160;To&#160;our&#160;knowledge,&#160;the&#160;earliest&#160;proof&#160;is&#160;due&#160;to<br/>Anderson&#160;<a href="1610.01521s.html#30">[1]</a>.<br/>
Theorem&#160;A.3&#160;(Anderson&#160;<a href="1610.01521s.html#30">[1]</a>).&#160;The&#160;sequence&#160;ℓ0(n),&#160;.&#160;.&#160;.&#160;,&#160;ℓ2n(n)&#160;is&#160;log-concave.<br/>
We&#160;now&#160;provide&#160;some&#160;quantitative&#160;upper&#160;and&#160;lower&#160;bounds&#160;on&#160;the&#160;ratios&#160;ℓi+1(n)/ℓi(n)<br/>
which&#160;we&#160;used&#160;in&#160;Section&#160;<a href="1610.01521s.html#9">4.&#160;</a>We&#160;obtain&#160;different&#160;bounds&#160;depending&#160;on&#160;whether&#160;1&#160;≤&#160;i&#160;≤&#160;n&#160;−&#160;3,<br/>i&#160;=&#160;n&#160;−&#160;2&#160;or&#160;i&#160;=&#160;n&#160;−&#160;1.<br/>
Lemma&#160;A.4.&#160;For&#160;n&#160;≥&#160;4&#160;and&#160;1&#160;≤&#160;i&#160;≤&#160;n&#160;−&#160;3,<br/>
n&#160;+&#160;1<br/>
ℓ<br/>
⌈i/2⌉&#160;−&#160;⌊i/2⌋<br/>
n&#160;−&#160;⌈i/2⌉<br/>
≤&#160;i+1(n)&#160;≤<br/>
+<br/>
.<br/>
i&#160;+&#160;1<br/>
ℓi(n)<br/>
⌈i/2⌉<br/>
⌈(i&#160;+&#160;2)/2⌉<br/>
32<br/>
<hr/>
<a name=33></a><img class="yflip" src="html/1610.01521-33_1.png"/><br/>
<img class="yflip" src="html/1610.01521-33_2.png"/><br/>
<img class="yflip" src="html/1610.01521-33_3.png"/><br/>
<img class="yflip" src="html/1610.01521-33_4.png"/><br/>
<img class="yflip" src="html/1610.01521-33_5.png"/><br/>
<img class="yflip" src="html/1610.01521-33_6.png"/><br/>
<img class="yflip" src="html/1610.01521-33_7.png"/><br/>
<img class="yflip" src="html/1610.01521-33_8.png"/><br/>
<img class="yflip" src="html/1610.01521-33_9.png"/><br/>
<img class="yflip" src="html/1610.01521-33_10.png"/><br/>
<img class="yflip" src="html/1610.01521-33_11.png"/><br/>
<img class="yflip" src="html/1610.01521-33_12.png"/><br/>
<img class="yflip" src="html/1610.01521-33_13.png"/><br/>
<img class="yflip" src="html/1610.01521-33_14.png"/><br/>
<img class="yflip" src="html/1610.01521-33_15.png"/><br/>
<img class="yflip" src="html/1610.01521-33_16.png"/><br/>
<img class="yflip" src="html/1610.01521-33_17.png"/><br/>
<img class="yflip" src="html/1610.01521-33_18.png"/><br/>
<img class="yflip" src="html/1610.01521-33_19.png"/><br/>
<img class="yflip" src="html/1610.01521-33_20.png"/><br/>
<img class="yflip" src="html/1610.01521-33_21.png"/><br/>
<img class="yflip" src="html/1610.01521-33_22.png"/><br/>
<img class="yflip" src="html/1610.01521-33_23.png"/><br/>
<img class="yflip" src="html/1610.01521-33_24.png"/><br/>
<img class="yflip" src="html/1610.01521-33_25.png"/><br/>
<img class="yflip" src="html/1610.01521-33_26.png"/><br/>
<img class="yflip" src="html/1610.01521-33_27.png"/><br/>
<img class="yflip" src="html/1610.01521-33_28.png"/><br/>
<img class="yflip" src="html/1610.01521-33_29.png"/><br/>
<img class="yflip" src="html/1610.01521-33_30.png"/><br/>
<img class="yflip" src="html/1610.01521-33_31.png"/><br/>
<img class="yflip" src="html/1610.01521-33_32.png"/><br/>
<img class="yflip" src="html/1610.01521-33_33.png"/><br/>
<img class="yflip" src="html/1610.01521-33_34.png"/><br/>
<img class="yflip" src="html/1610.01521-33_35.png"/><br/>
<img class="yflip" src="html/1610.01521-33_36.png"/><br/>
<img class="yflip" src="html/1610.01521-33_37.png"/><br/>
Proof.&#160;Begin&#160;by&#160;giving&#160;each&#160;element&#160;y&#160;of&#160;Li+1&#160;a&#160;‘weight’&#160;of&#160;1&#160;and&#160;then&#160;redistributing&#160;the<br/>weight&#160;of&#160;y&#160;evenly&#160;among&#160;the&#160;x&#160;∈&#160;Li&#160;with&#160;x&#160;&lt;&#160;y.&#160;For&#160;0&#160;≤&#160;s&#160;≤&#160;⌊i/2⌋,&#160;the&#160;weight&#160;recieved&#160;by<br/>x&#160;∈&#160;Lsi&#160;is&#160;precisely<br/>
i&#160;−&#160;2s<br/>
n&#160;−&#160;i&#160;+&#160;s<br/>
f&#160;(s)&#160;:=<br/>
+<br/>
.<br/>
i&#160;−&#160;s<br/>
i&#160;−&#160;s&#160;+&#160;1<br/>
Note&#160;that&#160;f&#160;(s)&#160;is&#160;well&#160;defined&#160;as&#160;i&#160;≥&#160;1&#160;and&#160;so&#160;s&#160;&lt;&#160;i.&#160;We&#160;claim&#160;that&#160;f&#160;(s)&#160;is&#160;non-decreasing&#160;for<br/>s&#160;in&#160;the&#160;range&#160;0&#160;≤&#160;s&#160;≤&#160;⌊i/2⌋.&#160;Indeed,&#160;for&#160;i&#160;≥&#160;2&#160;and&#160;0&#160;≤&#160;s&#160;≤&#160;⌊(i&#160;−&#160;2)/2⌋,&#160;we&#160;have<br/>
&#160;i&#160;−&#160;2s&#160;−&#160;2<br/>
n&#160;−&#160;i&#160;+&#160;s&#160;+&#160;1&#160;<br/>
&#160;i&#160;−&#160;2s<br/>
n&#160;−&#160;i&#160;+&#160;s&#160;<br/>
f&#160;(s&#160;+&#160;1)&#160;−&#160;f&#160;(s)&#160;=<br/>
+<br/>
−<br/>
+<br/>
i&#160;−&#160;s&#160;−&#160;1<br/>
i&#160;−&#160;s<br/>
i&#160;−&#160;s<br/>
i&#160;−&#160;s&#160;+&#160;1<br/>
s(−n&#160;+&#160;i&#160;−&#160;1)&#160;+&#160;ni&#160;−&#160;n&#160;−&#160;i2&#160;−&#160;1<br/>
=<br/>
.<br/>
(i&#160;−&#160;s&#160;+&#160;1)(i&#160;−&#160;s)(i&#160;−&#160;s&#160;−&#160;1)<br/>
Since&#160;n&#160;&gt;&#160;i&#160;and&#160;s&#160;≤&#160;i−2,&#160;this&#160;expression&#160;is&#160;bounded&#160;below&#160;by<br/>
2<br/>
(i&#160;−&#160;2)(−n&#160;+&#160;i&#160;−&#160;1)&#160;+&#160;2ni&#160;−&#160;2n&#160;−&#160;2i2&#160;−&#160;2<br/>
i(n&#160;−&#160;i&#160;−&#160;3)<br/>
=<br/>
2(i&#160;−&#160;s&#160;+&#160;1)(i&#160;−&#160;s)(i&#160;−&#160;s&#160;−&#160;1)<br/>
2(i&#160;−&#160;s&#160;+&#160;1)(i&#160;−&#160;s)(i&#160;−&#160;s&#160;−&#160;1)<br/>
which&#160;is&#160;non-negative&#160;since&#160;i&#160;≤&#160;n&#160;−&#160;3.&#160;Therefore,&#160;the&#160;total&#160;weight&#160;is&#160;bounded&#160;below&#160;by&#160;|Li|<br/>multiplied&#160;by&#160;the&#160;weight&#160;recieved&#160;by&#160;an&#160;element&#160;of&#160;L0i&#160;and&#160;bounded&#160;above&#160;by&#160;|Li|&#160;multiplied<br/>by&#160;the&#160;weight&#160;recieved&#160;by&#160;an&#160;element&#160;of&#160;L⌊i/2⌋<br/>
i<br/>
.&#160;However,&#160;clearly,&#160;the&#160;total&#160;weight&#160;is&#160;precisely<br/>
|Li+1|&#160;and&#160;so&#160;we&#160;obtain<br/>
&#160;n&#160;+&#160;1&#160;<br/>
&#160;⌈i/2⌉&#160;−&#160;⌊i/2⌋<br/>
n&#160;−&#160;⌈i/2⌉&#160;<br/>
|L<br/>
+<br/>
|L<br/>
i&#160;+&#160;1<br/>
i|&#160;≤&#160;|Li+1|&#160;≤<br/>
⌈i/2⌉<br/>
⌈(i&#160;+&#160;2)/2⌉<br/>
i|<br/>
as&#160;desired.<br/>
Lemma&#160;A.5.&#160;For&#160;n&#160;≥&#160;5&#160;we&#160;have<br/>
n&#160;+&#160;2<br/>
ℓ<br/>
4n&#160;+&#160;7<br/>
≤&#160;n−1(n)&#160;≤<br/>
n<br/>
ℓn−2(n)<br/>
4n&#160;−&#160;2<br/>
Proof.&#160;Distribute&#160;weights&#160;to&#160;the&#160;elements&#160;of&#160;Li&#160;in&#160;the&#160;same&#160;way&#160;as&#160;in&#160;the&#160;proof&#160;of&#160;Lemma&#160;<a href="1610.01521s.html#32">A.4<br/></a>and&#160;define&#160;f&#160;(s)&#160;in&#160;the&#160;same&#160;way&#160;as&#160;well,&#160;except&#160;that&#160;i&#160;=&#160;n&#160;−&#160;2.&#160;As&#160;in&#160;that&#160;proof,&#160;for<br/>0&#160;≤&#160;s&#160;≤&#160;⌊(n&#160;−&#160;4)/2⌋,&#160;we&#160;have<br/>
s(−n&#160;+&#160;(n&#160;−&#160;2)&#160;−&#160;1)&#160;+&#160;n(n&#160;−&#160;2)&#160;−&#160;n&#160;−&#160;(n&#160;−&#160;2)2&#160;−&#160;1<br/>
f&#160;(s&#160;+&#160;1)&#160;−&#160;f&#160;(s)&#160;=<br/>
((n&#160;−&#160;2)&#160;−&#160;s&#160;+&#160;1)((n&#160;−&#160;2)&#160;−&#160;s)((n&#160;−&#160;2)&#160;−&#160;s&#160;−&#160;1)<br/>
−3s&#160;+&#160;n&#160;−&#160;5<br/>
=&#160;(n&#160;−&#160;1&#160;−&#160;s)(n&#160;−&#160;2&#160;−&#160;s)(n&#160;−&#160;3&#160;−&#160;s)<br/>
which&#160;is&#160;non-negative&#160;if&#160;and&#160;only&#160;if&#160;s&#160;≤&#160;n−5.&#160;So,&#160;we&#160;have&#160;that&#160;f&#160;(s)&#160;is&#160;non-decreasing&#160;in&#160;the<br/>
3<br/>
range&#160;0&#160;≤&#160;s&#160;≤&#160;n−2&#160;and&#160;non-increasing&#160;in&#160;the&#160;range&#160;n−2<br/>
.&#160;It&#160;follows&#160;that<br/>
3<br/>
3<br/>
≤&#160;s&#160;≤&#160;n−2<br/>
2<br/>
<br/>
&#160;n&#160;−&#160;2<br/>
&#160;n&#160;−&#160;2<br/>
min&#160;f&#160;(0),&#160;f<br/>
|L<br/>
|L<br/>
2<br/>
i|&#160;≤&#160;|Li+1|&#160;≤&#160;f<br/>
3<br/>
i|<br/>
and&#160;the&#160;result&#160;follows&#160;since&#160;f&#160;n−2&#160;&#160;=&#160;n+2&#160;&lt;&#160;n+1&#160;=&#160;f&#160;(0)&#160;and&#160;f&#160;n−2&#160;&#160;=&#160;4n+7&#160;.<br/>
2<br/>
n<br/>
n−1<br/>
3<br/>
4n−2<br/>
33<br/>
<hr/>
<a name=34></a><img class="yflip" src="html/1610.01521-34_1.png"/><br/>
<img class="yflip" src="html/1610.01521-34_2.png"/><br/>
<img class="yflip" src="html/1610.01521-34_3.png"/><br/>
<img class="yflip" src="html/1610.01521-34_4.png"/><br/>
<img class="yflip" src="html/1610.01521-34_5.png"/><br/>
<img class="yflip" src="html/1610.01521-34_6.png"/><br/>
<img class="yflip" src="html/1610.01521-34_7.png"/><br/>
<img class="yflip" src="html/1610.01521-34_8.png"/><br/>
<img class="yflip" src="html/1610.01521-34_9.png"/><br/>
<img class="yflip" src="html/1610.01521-34_10.png"/><br/>
<img class="yflip" src="html/1610.01521-34_11.png"/><br/>
<img class="yflip" src="html/1610.01521-34_12.png"/><br/>
<img class="yflip" src="html/1610.01521-34_13.png"/><br/>
<img class="yflip" src="html/1610.01521-34_14.png"/><br/>
<img class="yflip" src="html/1610.01521-34_15.png"/><br/>
<img class="yflip" src="html/1610.01521-34_16.png"/><br/>
Lemma&#160;A.6.&#160;For&#160;n&#160;≥&#160;5&#160;we&#160;have<br/>
⌈(n&#160;−&#160;1)/2⌉&#160;−&#160;⌊(n&#160;−&#160;1)/2⌋<br/>
⌊(n&#160;+&#160;1)/2⌋<br/>
ℓ<br/>
n&#160;+&#160;1<br/>
+<br/>
≤<br/>
n(n)<br/>
≤<br/>
⌈(n&#160;−&#160;1)/2⌉<br/>
⌈(n&#160;+&#160;1)/2⌉<br/>
ℓn−1(n)<br/>
n<br/>
Proof.&#160;Proceed&#160;as&#160;in&#160;the&#160;previous&#160;two&#160;proofs.&#160;This&#160;time,&#160;we&#160;have<br/>
s(−n&#160;+&#160;(n&#160;−&#160;1)&#160;−&#160;1)&#160;+&#160;n(n&#160;−&#160;1)&#160;−&#160;n&#160;−&#160;(n&#160;−&#160;1)2&#160;−&#160;1<br/>
f&#160;(s&#160;+&#160;1)&#160;−&#160;f&#160;(s)&#160;=<br/>
((n&#160;−&#160;1)&#160;−&#160;s&#160;+&#160;1)((n&#160;−&#160;1)&#160;−&#160;s)((n&#160;−&#160;1)&#160;−&#160;s&#160;−&#160;1)<br/>
−2(s&#160;+&#160;1)<br/>
=&#160;(n&#160;−&#160;s)(n&#160;−&#160;1&#160;−&#160;s)(n&#160;−&#160;2&#160;−&#160;s)<br/>
and&#160;so&#160;f&#160;(s)&#160;is&#160;decreasing&#160;in&#160;s&#160;for&#160;0&#160;≤&#160;s&#160;≤&#160;n−1.&#160;Therefore,<br/>
2<br/>
&#160;n&#160;−&#160;1<br/>
f<br/>
|L<br/>
2<br/>
i|&#160;≤&#160;|Li+1|&#160;≤&#160;f&#160;(0)|Li|<br/>
and&#160;we&#160;are&#160;done&#160;since&#160;f&#160;&#160;n−1&#160;&#160;=&#160;⌈(n−1)/2⌉−⌊(n−1)/2⌋&#160;+&#160;⌊(n+1)/2⌋&#160;and&#160;f&#160;(0)&#160;=&#160;n+1&#160;.<br/>
2<br/>
⌈(n−1)/2⌉<br/>
⌈(n+1)/2⌉<br/>
n<br/>
34<br/>
<hr/>
<a name="outline"></a><h1>Document Outline</h1>
<ul>
<li><a href="1610.01521s.html#1">1 Introduction</a></li>
<li><a href="1610.01521s.html#4">2 Comparison Counting Via Random Chains</a></li>
<li><a href="1610.01521s.html#6">3 Supersaturation in P(n) and V(q,n)</a></li>
<li><a href="1610.01521s.html#9">4 Supersaturation in {0,1,2}^n</a>
<ul>
<li><a href="1610.01521s.html#13">4.1 Proof of Lemma ??</a></li>
</ul>
</li>
<li><a href="1610.01521s.html#20">5 Containers for Antichains</a></li>
<li><a href="1610.01521s.html#23">6 Applications of the Container-Type Lemma</a>
<ul>
<li><a href="1610.01521s.html#23">6.1 Counting Antichains</a></li>
<li><a href="1610.01521s.html#26">6.2 Antichains in Random Subsets</a></li>
</ul>
</li>
<li><a href="1610.01521s.html#29">7 Open Problems</a></li>
<li><a href="1610.01521s.html#32">A Rank Numbers in V(q,n) and 0,1,2^n</a></li>
</ul>
<hr/>
</body>
</html>
