<!DOCTYPE html><html>
<head>
<title></title>
<style type="text/css">
<!--
.xflip {
    -moz-transform: scaleX(-1);
    -webkit-transform: scaleX(-1);
    -o-transform: scaleX(-1);
    transform: scaleX(-1);
    filter: fliph;
}
.yflip {
    -moz-transform: scaleY(-1);
    -webkit-transform: scaleY(-1);
    -o-transform: scaleY(-1);
    transform: scaleY(-1);
    filter: flipv;
}
.xyflip {
    -moz-transform: scaleX(-1) scaleY(-1);
    -webkit-transform: scaleX(-1) scaleY(-1);
    -o-transform: scaleX(-1) scaleY(-1);
    transform: scaleX(-1) scaleY(-1);
    filter: fliph + flipv;
}
-->
</style>
</head>
<body>
<a name=1></a>NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,<br/>
AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
TONY&#160;FENG<br/>
Abstract.&#160;Following&#160;the&#160;paradigm&#160;initiated&#160;by&#160;Kottwitz,&#160;we&#160;compute&#160;the&#160;trace&#160;of&#160;Frobenius&#160;composed<br/>with&#160;Hecke&#160;operators&#160;on&#160;the&#160;cohomology&#160;of&#160;nearby&#160;cycles,&#160;at&#160;places&#160;of&#160;parahoric&#160;reduction,&#160;of&#160;perverse<br/>sheaves&#160;on&#160;certain&#160;moduli&#160;stacks&#160;of&#160;shtukas.&#160;Inspired&#160;by&#160;an&#160;argument&#160;of&#160;Ngô,&#160;we&#160;then&#160;use&#160;this&#160;to&#160;give<br/>a&#160;geometric&#160;proof&#160;of&#160;a&#160;base&#160;change&#160;fundamental&#160;lemma&#160;for&#160;parahoric&#160;Hecke&#160;algebras&#160;for&#160;GL&#160;over&#160;local<br/>
n<br/>
function&#160;ﬁelds.&#160;This&#160;generalizes&#160;a&#160;theorem&#160;of&#160;Ngô,&#160;who&#160;proved&#160;the&#160;base&#160;change&#160;fundamental&#160;lemma&#160;for<br/>spherical&#160;Hecke&#160;algebras&#160;for&#160;GL&#160;over&#160;local&#160;function&#160;ﬁelds,&#160;and&#160;extends&#160;to&#160;positive&#160;characteristic&#160;(for&#160;GL&#160;)<br/>
n<br/>
n<br/>
a&#160;fundamental&#160;lemma&#160;originally&#160;introduced&#160;and&#160;proved&#160;by&#160;Haines&#160;for&#160;p-adic&#160;local&#160;ﬁelds.<br/>
Contents<br/>
1.&#160;Introduction<br/>
<a href="1711.02243s.html#1">1</a><br/>
2.&#160;Statement&#160;of&#160;results&#160;and&#160;overview&#160;of&#160;the&#160;paper<br/>
<a href="1711.02243s.html#4">4</a><br/>
3.&#160;Notation<br/>
<a href="1711.02243s.html#8">8</a><br/>
4.&#160;Moduli&#160;of&#160;shtukas<br/>
<a href="1711.02243s.html#9">9</a><br/>
5.&#160;The&#160;Kottwitz&#160;Conjecture&#160;for&#160;shtukas<br/>
<a href="1711.02243s.html#16">16</a><br/>
6.&#160;Counting&#160;parahoric&#160;shtukas<br/>
<a href="1711.02243s.html#20">20</a><br/>
7.&#160;Geometrization&#160;of&#160;base&#160;change&#160;for&#160;Hecke&#160;algebras<br/>
<a href="1711.02243s.html#25">25</a><br/>
8.&#160;Comparison&#160;of&#160;two&#160;moduli&#160;problems<br/>
<a href="1711.02243s.html#32">32</a><br/>
9.&#160;Calculation&#160;of&#160;traces&#160;on&#160;the&#160;cohomology&#160;of&#160;nearby&#160;cycles<br/>
<a href="1711.02243s.html#34">34</a><br/>
References<br/>
<a href="1711.02243s.html#39">39</a><br/>
1.&#160;Introduction<br/>
There&#160;are&#160;two&#160;main&#160;goals&#160;of&#160;this&#160;paper:<br/>
(1)&#160;To&#160;compute&#160;the&#160;trace&#160;of&#160;Frobenius&#160;composed&#160;with&#160;Hecke&#160;operators&#160;on&#160;the&#160;cohomology&#160;of&#160;nearby<br/>
cycles&#160;at&#160;places&#160;of&#160;parahoric&#160;reduction&#160;for&#160;certain&#160;moduli&#160;stacks&#160;of&#160;shtukas,&#160;and<br/>
(2)&#160;To&#160;parlay&#160;the&#160;resulting&#160;formulas&#160;into&#160;a&#160;geometric&#160;proof&#160;of&#160;a&#160;fundamental&#160;lemma&#160;for&#160;base&#160;change&#160;for<br/>
<a href="http://arxiv.org/abs/1711.02243v2">arXiv:1711.02243v2 &#160;[math.NT] &#160;21 Feb 2018</a><br/>
central&#160;elements&#160;in&#160;parahoric&#160;Hecke&#160;algebras&#160;over&#160;local&#160;function&#160;fields.<br/>
The&#160;first&#160;goal&#160;is&#160;accomplished&#160;by&#160;using&#160;the&#160;Grothendieck-Lefschetz&#160;trace&#160;formula&#160;to&#160;break&#160;up&#160;the&#160;computation<br/>of&#160;the&#160;trace&#160;into&#160;two&#160;pieces:&#160;(1)&#160;counting&#160;points&#160;on&#160;certain&#160;moduli&#160;spaces,&#160;and&#160;(2)&#160;understanding&#160;the&#160;stalks<br/>of&#160;the&#160;nearby&#160;cycles&#160;sheaves.&#160;These&#160;pieces&#160;are&#160;then&#160;each&#160;resolved&#160;by&#160;a&#160;sequence&#160;of&#160;technical&#160;steps&#160;whose<br/>overall&#160;strategy&#160;is&#160;rather&#160;well-known,&#160;and&#160;which&#160;would&#160;require&#160;a&#160;considerable&#160;amount&#160;of&#160;notation&#160;to&#160;describe.<br/>Therefore,&#160;in&#160;this&#160;introduction&#160;we&#160;will&#160;focus&#160;on&#160;informally&#160;explaining&#160;the&#160;idea&#160;of&#160;the&#160;second&#160;goal.<br/>
The&#160;fundamental&#160;lemma&#160;of&#160;interest&#160;was&#160;proposed&#160;and&#160;proved&#160;by&#160;Haines&#160;<a href="1711.02243s.html#39">[Hai09]&#160;</a>for&#160;p-adic&#160;(i.e.&#160;mixed<br/>
characteristic)&#160;local&#160;fields,&#160;and&#160;generalizes&#160;the&#160;fundamental&#160;lemma&#160;for&#160;base&#160;change&#160;for&#160;spherical&#160;Hecke&#160;alge-<br/>bras&#160;proved&#160;(independently)&#160;in&#160;the&#160;p-adic&#160;case&#160;by&#160;Clozel&#160;<a href="1711.02243s.html#39">[Clo90]&#160;</a>and&#160;Labesse&#160;<a href="1711.02243s.html#40">[Lab90]</a>,&#160;building&#160;on&#160;work&#160;of<br/>Kottwitz&#160;<a href="1711.02243s.html#39">[Kot86a]</a>,&#160;and&#160;in&#160;the&#160;function&#160;field&#160;case&#160;(for&#160;GLn)&#160;by&#160;Ngô&#160;<a href="1711.02243s.html#40">[Ngo06]</a>.<br/>
The&#160;original&#160;motivation&#160;for&#160;this&#160;fundamental&#160;lemma&#160;was&#160;to&#160;study&#160;the&#160;cohomology&#160;of&#160;a&#160;Shimura&#160;variety&#160;with<br/>
parahoric&#160;level&#160;structure,&#160;and&#160;in&#160;particular&#160;to&#160;determine&#160;the&#160;semisimple&#160;zeta&#160;factor&#160;at&#160;a&#160;place&#160;of&#160;parahoric<br/>reduction.&#160;The&#160;fundamental&#160;lemma&#160;enters&#160;in&#160;comparing&#160;the&#160;trace&#160;of&#160;Frobenius&#160;and&#160;Hecke&#160;operators&#160;on&#160;this<br/>cohomology&#160;with&#160;the&#160;geometric&#160;side&#160;of&#160;the&#160;Arthur-Selberg&#160;trace&#160;formula.&#160;We&#160;refer&#160;the&#160;interested&#160;reader&#160;to<br/><a href="1711.02243s.html#39">[Hai09]</a>,&#160;especially&#160;p.&#160;573,&#160;for&#160;more&#160;details.<br/>
1<br/>
<hr/>
<a name=2></a><img class="yflip" src="html/1711.02243-2_1.png"/><br/>
2<br/>
TONY&#160;FENG<br/>
The&#160;same&#160;applications&#160;are&#160;available&#160;in&#160;the&#160;function&#160;field&#160;setting,&#160;with&#160;Shimura&#160;varieties&#160;replaced&#160;by&#160;the<br/>
moduli&#160;stacks&#160;of&#160;shtukas,&#160;which&#160;have&#160;been&#160;utilized&#160;by&#160;Drinfeld&#160;(<a href="1711.02243s.html#39">[Dri87]</a>,&#160;for&#160;GL2),&#160;L.&#160;Lafforgue&#160;(<a href="1711.02243s.html#40">[Laf02]</a>,&#160;for<br/>GLn),&#160;and&#160;V.&#160;Lafforgue&#160;(<a href="1711.02243s.html#40">[Laf12]</a>,&#160;for&#160;general&#160;reductive&#160;groups)&#160;to&#160;spectacular&#160;success&#160;towards&#160;the&#160;global<br/>Langlands&#160;correspondence&#160;over&#160;function&#160;fields.<br/>
However,&#160;in&#160;this&#160;paper&#160;we&#160;have&#160;chosen&#160;to&#160;emphasize&#160;the&#160;geometric&#160;aspect&#160;of&#160;the&#160;fundamental&#160;lemma,<br/>
rather&#160;than&#160;its&#160;applications&#160;to&#160;the&#160;Langlands&#160;program.&#160;In&#160;contrast&#160;to&#160;the&#160;proof&#160;of&#160;<a href="1711.02243s.html#39">[Hai09]&#160;</a>for&#160;p-adic&#160;case,<br/>which&#160;following&#160;in&#160;the&#160;tradition&#160;of&#160;<a href="1711.02243s.html#39">[Clo90]&#160;</a>and&#160;<a href="1711.02243s.html#40">[Lab90]&#160;</a>is&#160;via&#160;p-adic&#160;harmonic&#160;analysis,&#160;our&#160;proof&#160;works&#160;by<br/>exploiting&#160;additional&#160;geometry&#160;and&#160;structure&#160;which&#160;is&#160;available&#160;in&#160;the&#160;function&#160;field&#160;setting.&#160;Our&#160;strategy&#160;is<br/>very&#160;much&#160;based&#160;on&#160;that&#160;of&#160;<a href="1711.02243s.html#40">[Ngo06]</a>,&#160;and&#160;indeed&#160;specializes&#160;to&#160;it&#160;in&#160;the&#160;case&#160;of&#160;spherical&#160;Hecke&#160;algebras.&#160;We<br/>think&#160;it&#160;would&#160;be&#160;useful&#160;to&#160;give&#160;an&#160;impressionistic&#160;preview&#160;of&#160;the&#160;strategy&#160;now.&#160;A&#160;more&#160;detailed&#160;overview<br/>will&#160;be&#160;given&#160;in&#160;<a href="1711.02243s.html#4">§2.1&#160;</a>and&#160;<a href="1711.02243s.html#6">§2.2.</a><br/>
Broadly&#160;speaking,&#160;the&#160;base&#160;change&#160;fundamental&#160;lemma&#160;compares&#160;an&#160;orbital&#160;integral&#160;with&#160;a&#160;twisted&#160;orbital<br/>
integral.&#160;To&#160;elaborate,&#160;let&#160;F&#160;be&#160;a&#160;local&#160;field,&#160;G&#160;a&#160;reductive&#160;group&#160;over&#160;F&#160;,&#160;γ&#160;∈&#160;G(F&#160;),&#160;and&#160;f&#160;a&#160;function&#160;on<br/>G(F&#160;).&#160;The&#160;orbital&#160;integral&#160;corresponding&#160;to&#160;this&#160;data&#160;is<br/>
Z<br/>
Oγ(f&#160;)&#160;:=<br/>
f&#160;(g−1γg)&#160;dg<br/>
(1.1)<br/>
G(F&#160;)/Gγ(F&#160;)<br/>
where&#160;Gγ(F&#160;)&#160;is&#160;the&#160;centralizer&#160;of&#160;γ&#160;in&#160;G(F&#160;).&#160;We&#160;will&#160;take&#160;f&#160;to&#160;be&#160;in&#160;an&#160;appropriate&#160;Hecke&#160;algebra&#160;HG(F&#160;).<br/>(Of&#160;course&#160;we&#160;also&#160;need&#160;to&#160;discuss&#160;the&#160;normalization&#160;of&#160;Haar&#160;measures,&#160;but&#160;let&#160;us&#160;leave&#160;that&#160;for&#160;<a href="1711.02243s.html#4">§2.1.</a>)<br/>
Let&#160;E/F&#160;be&#160;an&#160;unramified&#160;extension&#160;of&#160;degree&#160;r,&#160;δ&#160;∈&#160;G(E),&#160;and&#160;fE&#160;a&#160;function&#160;on&#160;G(E).&#160;The&#160;twisted<br/>
orbital&#160;integral&#160;corresponding&#160;to&#160;this&#160;data&#160;is&#160;Z<br/>
TOδσ(fE)&#160;:=<br/>
fE(g−1δσ(g))&#160;dg<br/>
(1.2)<br/>
G(E)/Gδσ(F&#160;)<br/>
where&#160;σ&#160;∈&#160;Gal(E/F&#160;)&#160;is&#160;the&#160;lift&#160;of&#160;(arithmetic)&#160;Frobenius,&#160;and<br/>
Gδσ(F&#160;)&#160;:=&#160;{g&#160;∈&#160;G(E):&#160;g−1δσ(g)&#160;=&#160;δ}<br/>
is&#160;the&#160;twisted&#160;centralizer&#160;of&#160;γ&#160;in&#160;Gδσ(E).&#160;Again,&#160;we&#160;will&#160;take&#160;fE&#160;to&#160;be&#160;in&#160;an&#160;appropriate&#160;Hecke&#160;algebra<br/>HG(E).<br/>
If&#160;HG(E),J&#160;and&#160;HG(F),J&#160;are&#160;corresponding&#160;parahoric&#160;Hecke&#160;algebras,&#160;then&#160;there&#160;is&#160;a&#160;base&#160;change&#160;homo-<br/>
morphism&#160;for&#160;their&#160;centers<br/>
b&#160;:&#160;Z(HG(E),J&#160;)&#160;→&#160;Z(HG(F),J&#160;).<br/>
There&#160;is&#160;also&#160;a&#160;norm&#160;map&#160;N&#160;from&#160;stable&#160;twisted&#160;conjugacy&#160;classes&#160;in&#160;G(E)&#160;to&#160;stable&#160;conjugacy&#160;classes&#160;in<br/>G(F&#160;).<br/>
In&#160;the&#160;special&#160;case&#160;G&#160;=&#160;GLn,&#160;the&#160;base&#160;change&#160;fundamental&#160;lemma&#160;for&#160;the&#160;center&#160;of&#160;parahoric&#160;Hecke<br/>
algebras&#160;predicts&#160;that&#160;for&#160;σ-regular,&#160;σ-semisimple&#160;δ&#160;∈&#160;G(E)&#160;and&#160;fE&#160;∈&#160;Z(HG(E),J),&#160;we&#160;have<br/>
TOδσ(fE)&#160;=&#160;ON(δ)(b(fE)).<br/>
(1.3)<br/>
This&#160;is&#160;almost&#160;what&#160;we&#160;will&#160;prove.&#160;(For&#160;more&#160;general&#160;G,&#160;the&#160;formulation&#160;is&#160;more&#160;complicated;&#160;see&#160;<a href="1711.02243s.html#39">[Hai09]</a>,<br/>Theorem&#160;1.0.3&#160;and&#160;§5.)<br/>
Now&#160;we&#160;can&#160;describe&#160;our&#160;strategy&#160;of&#160;proof&#160;of&#160;<a href="1711.02243s.html#2">(1.3)</a>.&#160;The&#160;starting&#160;point&#160;is&#160;the&#160;seminal&#160;work&#160;of&#160;Kottwitz&#160;on<br/>
counting&#160;points&#160;of&#160;Shimura&#160;varieties&#160;over&#160;finite&#160;fields.&#160;In&#160;<a href="1711.02243s.html#39">[Kot92]&#160;</a>Kottwitz&#160;proves&#160;a&#160;formula&#160;expressing&#160;the<br/>trace&#160;of&#160;Frobenius&#160;composed&#160;with&#160;a&#160;Hecke&#160;operator&#160;on&#160;the&#160;cohomology&#160;of&#160;certain&#160;PEL&#160;Shimura&#160;varieties&#160;as<br/>a&#160;sum&#160;of&#160;a&#160;product&#160;of&#160;(twisted)&#160;orbital&#160;integrals:<br/>
X<br/>
Tr(h&#160;◦&#160;Frobp,&#160;H∗(ShK,&#160;Qℓ))&#160;=<br/>
(.&#160;.&#160;.)Oγ(hp)TOδσ(hp)<br/>
(1.4)<br/>
where&#160;ShK&#160;is&#160;an&#160;appropriate&#160;Shimura&#160;variety&#160;and&#160;h&#160;is&#160;a&#160;Hecke&#160;operator.&#160;In&#160;fact&#160;the&#160;purpose&#160;of&#160;the&#160;funda-<br/>mental&#160;lemma&#160;is&#160;to&#160;re-express&#160;the&#160;twisted&#160;orbital&#160;integrals&#160;in&#160;<a href="1711.02243s.html#2">(1.4)</a>,&#160;so&#160;as&#160;to&#160;be&#160;able&#160;to&#160;compare&#160;the&#160;expression<br/>with&#160;the&#160;geometric&#160;side&#160;of&#160;the&#160;Arthur-Selberg&#160;trace&#160;formula.&#160;But&#160;in&#160;this&#160;paper&#160;we&#160;adopt&#160;an&#160;opposite&#160;per-<br/>spective,&#160;instead&#160;viewing&#160;<a href="1711.02243s.html#2">(1.4)&#160;</a>as&#160;giving&#160;a&#160;geometric&#160;interpretation&#160;of&#160;(twisted)&#160;orbital&#160;integrals&#160;(in&#160;the&#160;p-adic<br/>case)&#160;in&#160;terms&#160;of&#160;the&#160;cohomology&#160;of&#160;Shimura&#160;varieties.<br/>
In&#160;the&#160;function&#160;field&#160;setting,&#160;which&#160;is&#160;the&#160;one&#160;of&#160;interest&#160;to&#160;this&#160;paper,&#160;one&#160;can&#160;prove&#160;an&#160;analogous&#160;formula<br/>
of&#160;the&#160;form<br/>
X<br/>
Tr(hA&#160;◦&#160;Frobx&#160;◦τ,&#160;H∗(Sht<br/>
(.&#160;.&#160;.)O<br/>
)TO<br/>
)<br/>
(1.5)<br/>
0<br/>
A,&#160;A))&#160;=<br/>
γ&#160;(hx0<br/>
A<br/>
δσ&#160;(hA,x0<br/>
<hr/>
<a name=3></a>NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,&#160;AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
3<br/>
for&#160;an&#160;appropriate&#160;moduli&#160;stack&#160;ShtA,&#160;an&#160;appropriate&#160;sheaf&#160;A,&#160;an&#160;appropriate&#160;Hecke&#160;operator&#160;hA,&#160;and&#160;an<br/>additional&#160;symmetry&#160;τ&#160;.&#160;(Roughly,&#160;τ&#160;is&#160;a&#160;“rotation”&#160;symmetry&#160;that&#160;arises&#160;from&#160;the&#160;moduli&#160;problem.)<br/>
However,&#160;it&#160;turns&#160;out&#160;that&#160;we&#160;can&#160;also&#160;construct&#160;a&#160;moduli&#160;stack&#160;ShtB&#160;such&#160;that<br/>
X<br/>
Tr(hB&#160;◦&#160;Frobx&#160;◦τ,&#160;H∗(Sht<br/>
(.&#160;.&#160;.)O<br/>
)O<br/>
))<br/>
(1.6)<br/>
0<br/>
B&#160;,&#160;B))&#160;=<br/>
γ&#160;(hx0<br/>
B<br/>
δσ&#160;(b(hB,x0<br/>
for&#160;an&#160;appropriate&#160;sheaf&#160;B,&#160;an&#160;appropriate&#160;Hecke&#160;operator&#160;hB,&#160;and&#160;an&#160;additional&#160;symmetry&#160;τ&#160;similar&#160;to&#160;that<br/>from&#160;<a href="1711.02243s.html#2">(1.5)</a>.&#160;The&#160;crucial&#160;point&#160;is&#160;that&#160;in&#160;<a href="1711.02243s.html#3">(1.6)&#160;</a>the&#160;twisted&#160;orbital&#160;integral&#160;is&#160;replaced&#160;with&#160;the&#160;orbital&#160;integral<br/>of&#160;a&#160;base&#160;changed&#160;function.<br/>
We&#160;remark&#160;that&#160;the&#160;computations&#160;<a href="1711.02243s.html#2">(1.5)&#160;</a>and&#160;<a href="1711.02243s.html#3">(1.6)&#160;</a>were&#160;obtained&#160;in&#160;<a href="1711.02243s.html#40">[Ngo06]&#160;</a>for&#160;places&#160;of&#160;good&#160;(hyperspecial)<br/>
reduction,&#160;in&#160;which&#160;case&#160;one&#160;finds&#160;a&#160;spherical&#160;Hecke&#160;operator.&#160;In&#160;the&#160;present&#160;work,&#160;which&#160;concerns&#160;places<br/>of&#160;parahoric&#160;bad&#160;reduction,&#160;the&#160;analogous&#160;computations&#160;<a href="1711.02243s.html#2">(1.5)&#160;</a>and&#160;<a href="1711.02243s.html#3">(1.6)&#160;</a>are&#160;of&#160;independent&#160;interest,&#160;and<br/>actually&#160;form&#160;the&#160;main&#160;content&#160;of&#160;this&#160;paper.&#160;They&#160;require&#160;several&#160;nontrivial&#160;inputs,&#160;including,&#160;for&#160;the<br/>parahoric&#160;setting&#160;that&#160;we&#160;study&#160;here,&#160;a&#160;version&#160;of&#160;the&#160;Kottwitz&#160;Conjecture&#160;for&#160;shtukas,&#160;as&#160;well&#160;as&#160;a&#160;geometric<br/>interpretation&#160;of&#160;the&#160;base&#160;change&#160;homomorphism&#160;for&#160;Hecke&#160;algebras.&#160;Nevertheless,&#160;let&#160;us&#160;elide&#160;these&#160;points<br/>for&#160;now.<br/>
The&#160;upshot&#160;is&#160;that&#160;<a href="1711.02243s.html#2">(1.5)&#160;</a>and&#160;<a href="1711.02243s.html#3">(1.6)&#160;</a>translate&#160;the&#160;problem&#160;of&#160;comparing&#160;orbital&#160;integrals&#160;and&#160;twisted&#160;orbital<br/>
integrals&#160;into&#160;comparing&#160;(the&#160;cohomology&#160;of)&#160;two&#160;different&#160;moduli&#160;problems&#160;ShtA&#160;and&#160;ShtB.&#160;(We&#160;remark<br/>that&#160;the&#160;relationship&#160;we&#160;seek&#160;turns&#160;out&#160;to&#160;be&#160;subtler&#160;than&#160;equality,&#160;but&#160;again&#160;we&#160;elide&#160;this&#160;issue&#160;for&#160;now.)<br/>
At&#160;this&#160;point&#160;the&#160;particular&#160;the&#160;choice&#160;of&#160;ShtA&#160;and&#160;ShtB&#160;becomes&#160;crucial.&#160;Therefore,&#160;to&#160;proceed&#160;with&#160;the<br/>
discussion&#160;we&#160;will&#160;need&#160;to&#160;give&#160;some&#160;idea&#160;of&#160;what&#160;these&#160;moduli&#160;problems&#160;look&#160;like.&#160;In&#160;<a href="1711.02243s.html#2">(1.4)&#160;</a>the&#160;Shimura<br/>variety&#160;ShK&#160;is&#160;defined&#160;over&#160;an&#160;open&#160;subset&#160;of&#160;the&#160;ring&#160;of&#160;integers&#160;of&#160;a&#160;number&#160;field,&#160;whereas&#160;in&#160;<a href="1711.02243s.html#2">(1.5)&#160;</a>and<br/><a href="1711.02243s.html#3">(1.6)&#160;</a>the&#160;moduli&#160;stacks&#160;ShtA&#160;and&#160;ShtB&#160;are&#160;defined&#160;over&#160;an&#160;open&#160;subset&#160;X◦&#160;of&#160;a&#160;curve&#160;over&#160;a&#160;finite&#160;field&#160;Fq.<br/>The&#160;moduli&#160;stack&#160;ShtA&#160;parametrizes&#160;“independent”&#160;modifications&#160;of&#160;vector&#160;bundles&#160;Ei&#160;over&#160;X◦,&#160;with&#160;the<br/>modifications&#160;occuring&#160;over&#160;the&#160;point&#160;x:<br/>
<br/>
<br/>
<br/>
&#160;x&#160;∈&#160;X◦&#160;<br/>
<br/>
<br/>
<br/>
x<br/>
<br/>
<br/>
<br/>
σE<br/>
<br/>
&#160;1&#160;99K&#160;E1<br/>
<br/>
σ<br/>
x<br/>
Sht<br/>
E&#160;99K&#160;E<br/>
A&#160;“&#160;=&#160;”<br/>
2<br/>
2<br/>
.<br/>
<br/>
<br/>
<br/>
<br/>
.<br/>
<br/>
<br/>
.<br/>
<br/>
<br/>
.<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
σ<br/>
x<br/>
<br/>
Er&#160;99K&#160;Er<br/>
(Here&#160;the&#160;superscript&#160;σ&#160;refers&#160;to&#160;a&#160;Frobenius&#160;twist,&#160;which&#160;has&#160;not&#160;been&#160;explained&#160;but&#160;is&#160;a&#160;standard&#160;part&#160;of<br/>the&#160;definition&#160;of&#160;shtukas.)&#160;On&#160;the&#160;other&#160;hand,&#160;the&#160;moduli&#160;stack&#160;ShtB&#160;parametrizes&#160;“iterated”&#160;modifications<br/>of&#160;G-bundles&#160;Ei&#160;over&#160;X◦:<br/>
<br/>
<br/>
x&#160;∈&#160;X◦<br/>
ShtB&#160;“&#160;=&#160;”<br/>
.<br/>
σ<br/>
x<br/>
x<br/>
x<br/>
Er&#160;99K&#160;E1&#160;99K&#160;.&#160;.&#160;.&#160;99K&#160;Er<br/>
Forgetting&#160;everything&#160;except&#160;x&#160;defines&#160;maps<br/>
ShtA<br/>
ShtB<br/>
X◦<br/>
X◦<br/>
Now&#160;the&#160;key&#160;point&#160;is&#160;that&#160;we&#160;can&#160;deform&#160;these&#160;moduli&#160;problems&#160;by&#160;allowing&#160;the&#160;points&#160;of&#160;modification&#160;to<br/>
vary&#160;over&#160;X◦&#160;(which&#160;of&#160;course&#160;is&#160;a&#160;trick&#160;only&#160;available&#160;in&#160;the&#160;function&#160;field&#160;setting).&#160;More&#160;precisely,&#160;we&#160;can<br/>construct&#160;extended&#160;moduli&#160;stacks<br/>
g<br/>
Sht<br/>
g<br/>
A<br/>
ShtB<br/>
πA<br/>
πB<br/>
(X◦)r<br/>
(X◦)r<br/>
<hr/>
<a name=4></a><img class="yflip" src="html/1711.02243-4_1.png"/><br/>
<img class="yflip" src="html/1711.02243-4_2.png"/><br/>
<img class="yflip" src="html/1711.02243-4_3.png"/><br/>
4<br/>
TONY&#160;FENG<br/>
such&#160;that&#160;ShtA&#160;=&#160;g<br/>
ShtA|∆(X◦)&#160;and&#160;ShtB&#160;=&#160;g<br/>
ShtB|∆(X◦),&#160;by&#160;setting<br/>
<br/>
<br/>
<br/>
x1,&#160;.&#160;.&#160;.&#160;,&#160;xr&#160;∈&#160;X◦<br/>
<br/>
<br/>
<br/>
x<br/>
<br/>
&#160;σ<br/>
1<br/>
<br/>
<br/>
E<br/>
<br/>
<br/>
1&#160;99K&#160;E1<br/>
<br/>
x<br/>
<br/>
g<br/>
σ<br/>
2<br/>
Sht<br/>
E&#160;99K&#160;E<br/>
A“&#160;=&#160;”<br/>
2<br/>
2<br/>
<br/>
<br/>
<br/>
<br/>
.<br/>
<br/>
<br/>
.<br/>
<br/>
<br/>
.<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
σ<br/>
x<br/>
<br/>
E<br/>
r<br/>
r&#160;99K&#160;Er<br/>
and<br/>
<br/>
<br/>
g<br/>
x1,&#160;.&#160;.&#160;.&#160;,&#160;xr&#160;∈&#160;X◦<br/>
ShtB“&#160;=&#160;”<br/>
.<br/>
σ<br/>
x<br/>
x<br/>
x<br/>
E<br/>
1<br/>
2<br/>
r<br/>
r&#160;99K&#160;E1&#160;99K&#160;.&#160;.&#160;.&#160;99K&#160;Er<br/>
If&#160;the&#160;sheaves&#160;RπA!A&#160;and&#160;RπB!B&#160;are&#160;sufficiently&#160;well-behaved,&#160;then&#160;we&#160;may&#160;hope&#160;that&#160;by&#160;a&#160;“continuation<br/>principle”&#160;we&#160;can&#160;deduce&#160;a&#160;comparison&#160;theorem&#160;for&#160;the&#160;cohomology&#160;of&#160;these&#160;two&#160;moduli&#160;problems&#160;over&#160;a<br/>diagonal&#160;point&#160;xr0&#160;∈&#160;∆(X◦)&#160;⊂&#160;(X◦)r&#160;by&#160;proving&#160;such&#160;a&#160;comparison&#160;on&#160;a&#160;dense&#160;open&#160;subset&#160;of&#160;(X◦)r&#160;where<br/>the&#160;points&#160;x1,&#160;.&#160;.&#160;.&#160;,&#160;xr&#160;are&#160;distinct.&#160;This&#160;latter&#160;comparison&#160;works&#160;by&#160;computing&#160;analogues&#160;of&#160;<a href="1711.02243s.html#2">(1.5)&#160;</a>and&#160;<a href="1711.02243s.html#3">(1.6)<br/></a>for&#160;g<br/>
ShtA&#160;and&#160;g<br/>
ShtB&#160;over&#160;such&#160;points,&#160;away&#160;from&#160;∆(X◦),&#160;which&#160;turn&#160;out&#160;to&#160;both&#160;involve&#160;only&#160;orbital&#160;integrals<br/>
and&#160;can&#160;therefore&#160;be&#160;matched&#160;directly.<br/>
2.&#160;Statement&#160;of&#160;results&#160;and&#160;overview&#160;of&#160;the&#160;paper<br/>
2.1.&#160;Statement&#160;of&#160;the&#160;fundamental&#160;lemma.&#160;We&#160;now&#160;give&#160;a&#160;precise&#160;formulation&#160;of&#160;the&#160;fundamental<br/>lemma&#160;of&#160;interest.&#160;It&#160;is&#160;an&#160;exact&#160;analogue&#160;for&#160;local&#160;function&#160;fields&#160;of&#160;the&#160;fundamental&#160;lemma&#160;studied&#160;in<br/><a href="1711.02243s.html#39">[Hai09]</a>.&#160;We&#160;will&#160;impose&#160;several&#160;assumptions&#160;that&#160;simplify&#160;the&#160;formulation,&#160;referring&#160;the&#160;general&#160;case&#160;to<br/><a href="1711.02243s.html#39">[Hai09]</a>.&#160;In&#160;particular&#160;we&#160;assume&#160;that&#160;Gder&#160;is&#160;simply&#160;connected.<br/>
2.1.1.&#160;Normalization&#160;of&#160;Haar&#160;measures.&#160;Recall&#160;the&#160;notation&#160;of&#160;<a href="1711.02243s.html#1">§1.&#160;</a>To&#160;give&#160;a&#160;well-defined&#160;meaning&#160;to&#160;the<br/>orbital&#160;integral&#160;<a href="1711.02243s.html#2">(1.1)&#160;</a>and&#160;twisted&#160;orbital&#160;integral&#160;<a href="1711.02243s.html#2">(1.2)</a>,&#160;we&#160;need&#160;to&#160;specify&#160;Haar&#160;measures&#160;on&#160;G,&#160;Gγ&#160;and&#160;Gδσ.<br/>We&#160;assume&#160;that&#160;γ&#160;is&#160;regular&#160;semisimple.<br/>
We&#160;fix&#160;a&#160;hyperspecial&#160;vertex&#160;and&#160;an&#160;alcove&#160;containing&#160;it&#160;in&#160;the&#160;Bruhat-Tits&#160;building&#160;for&#160;G&#160;over&#160;Ft.&#160;By<br/>
Bruhat-Tits&#160;theory&#160;this&#160;induces&#160;maximal&#160;compact&#160;subgroups&#160;KF&#160;⊂&#160;G(F&#160;)&#160;and&#160;KE&#160;⊂&#160;G(E).<br/>
•&#160;We&#160;pick&#160;the&#160;left-invariant&#160;Haar&#160;measures&#160;dg&#160;on&#160;G(F&#160;)&#160;and&#160;G(E)&#160;such&#160;that&#160;dg(KF&#160;)&#160;=&#160;1&#160;and&#160;dg(KE)&#160;=<br/>
1.<br/>
•&#160;We&#160;pick&#160;the&#160;left-invariant&#160;Haar&#160;measures&#160;dh&#160;on&#160;Gγ(F&#160;)&#160;and&#160;Gδσ(F&#160;)&#160;such&#160;that&#160;dg(KF&#160;∩&#160;Gγ(F&#160;))&#160;=&#160;1<br/>
and&#160;dh&#160;on&#160;Gδσ(E)&#160;is&#160;the&#160;canonical&#160;transfer&#160;of&#160;Haar&#160;measure&#160;from&#160;Gγ&#160;to&#160;its&#160;inner&#160;form&#160;Gδσ.<br/>
Taking&#160;the&#160;quotient&#160;measure&#160;dg&#160;on&#160;G(F&#160;)/G<br/>
dh<br/>
γ&#160;(F&#160;)&#160;and&#160;G(E)/Gδσ&#160;(E),&#160;now&#160;<a href="1711.02243s.html#2">(1.1)&#160;</a>and&#160;<a href="1711.02243s.html#2">(1.2)&#160;</a>have&#160;been&#160;fully<br/>
defined.<br/>
2.1.2.&#160;Parahoric&#160;Hecke&#160;algebras.&#160;We&#160;fix&#160;a&#160;facet&#160;in&#160;the&#160;given&#160;alcove,&#160;which&#160;induces&#160;corresponding&#160;(com-<br/>pact&#160;open)&#160;parahoric&#160;groups&#160;JF&#160;⊂&#160;G(F&#160;)&#160;and&#160;JE&#160;⊂&#160;G(E).&#160;Let&#160;HG(F),J&#160;=&#160;Func(JF&#160;\G(F&#160;)/JF&#160;,&#160;Qℓ)&#160;and<br/>HG(E),J&#160;=&#160;Func(JE\G(E)/JE,&#160;Qℓ)&#160;be&#160;the&#160;corresponding&#160;parahoric&#160;Hecke&#160;algebras.&#160;(Parahoric&#160;Hecke&#160;alge-<br/>bras&#160;are&#160;discussed&#160;in&#160;more&#160;detail&#160;in&#160;<a href="1711.02243s.html#16">§5.1.</a>)<br/>
2.1.3.&#160;The&#160;base&#160;change&#160;homomorphism.&#160;Let&#160;Z(HG(F),J&#160;)&#160;be&#160;the&#160;center&#160;of&#160;HG(F),J&#160;,&#160;and&#160;define&#160;Z(HG(E),J&#160;)<br/>similarly.&#160;There&#160;is&#160;a&#160;base&#160;change&#160;homomorphism<br/>
b&#160;:&#160;Z(HG(E),J)&#160;→&#160;Z(HG(F),J&#160;)<br/>
which&#160;is&#160;defined&#160;in&#160;<a href="1711.02243s.html#25">§7.1.&#160;</a>To&#160;give&#160;a&#160;brief&#160;characterization&#160;of&#160;the&#160;base&#160;change&#160;homomorphism:&#160;under&#160;the<br/>Bernstein&#160;isomorphism<br/>
−&#160;∗J&#160;IK&#160;:&#160;Z(HG(F),J&#160;)&#160;∼<br/>
−<br/>
→&#160;HG(F),K<br/>
<hr/>
<a name=5></a><img class="yflip" src="html/1711.02243-5_1.png"/><br/>
NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,&#160;AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
5<br/>
obtained&#160;by&#160;convolving&#160;with&#160;the&#160;indicator&#160;function&#160;IK,&#160;it&#160;corresponds&#160;to&#160;the&#160;usual&#160;base&#160;change&#160;homomor-<br/>phism&#160;for&#160;spherical&#160;Hecke&#160;algebras.<br/>
Z(H<br/>
b<br/>
G(E),J&#160;)<br/>
Z(HG(F),J&#160;)<br/>
∼&#160;−∗J&#160;IK<br/>
∼&#160;−∗J&#160;IK<br/>
H<br/>
b<br/>
G(E),K<br/>
HG(F),K<br/>
2.1.4.&#160;The&#160;norm&#160;map.&#160;Let&#160;σ&#160;∈&#160;Gal(E/F&#160;)&#160;be&#160;a&#160;lift&#160;of&#160;(arithmetic)&#160;Frobenius.&#160;The&#160;“concrete&#160;norm”<br/>
NmE/F&#160;:&#160;G(E)&#160;→&#160;G(F&#160;)<br/>
defined&#160;by<br/>
NmE/F&#160;(δ)&#160;:=&#160;δ&#160;·&#160;σ(δ)&#160;·&#160;.&#160;.&#160;.&#160;σr−1(δ)<br/>
descends&#160;to&#160;a&#160;norm&#160;map<br/>
N&#160;:&#160;G(E)/stable&#160;σ-conjugacy&#160;→&#160;G(F&#160;)/stable&#160;conjugacy.<br/>
2.1.5.&#160;Formulation&#160;of&#160;the&#160;fundamental&#160;lemma.&#160;The&#160;following&#160;fundamental&#160;lemma&#160;was&#160;proved&#160;by&#160;Haines&#160;in<br/>the&#160;p-adic&#160;setting&#160;(<a href="1711.02243s.html#39">[Hai09]</a>,&#160;Theorem&#160;1.0.3.)<br/>
Theorem&#160;2.1&#160;(Haines).&#160;Let&#160;E/F&#160;be&#160;an&#160;unramified&#160;extension&#160;of&#160;p-adic&#160;local&#160;fields&#160;of&#160;degree&#160;r&#160;and&#160;residue<br/>characteristic&#160;p.&#160;Let&#160;ψ&#160;∈&#160;Z(HG(E),J)&#160;and&#160;δ&#160;∈&#160;G(E)&#160;such&#160;that&#160;N&#160;(δ)&#160;is&#160;semisimple.&#160;Then&#160;we&#160;have<br/>
SOG(E)(ψ)&#160;=&#160;SOG<br/>
δσ<br/>
N&#160;(δ)(b(ψ)).<br/>
Here&#160;SO&#160;are&#160;stable&#160;(twisted)&#160;orbital&#160;integrals,&#160;for&#160;whose&#160;definition&#160;we&#160;refer&#160;to&#160;<a href="1711.02243s.html#39">[Hai09]&#160;</a>§5.1.&#160;Since&#160;our<br/>
eventual&#160;result&#160;will&#160;be&#160;for&#160;G&#160;=&#160;GLn,&#160;where&#160;stable&#160;conjugacy&#160;coincides&#160;with&#160;conjugacy,&#160;we&#160;can&#160;ignore&#160;the<br/>issue&#160;of&#160;stabilization.<br/>
Remark&#160;2.2.&#160;Haines&#160;has&#160;informed&#160;us&#160;that&#160;his&#160;proof,&#160;which&#160;is&#160;based&#160;on&#160;the&#160;global&#160;simple&#160;trace&#160;formula&#160;and<br/>Kottwitz’s&#160;stabilization&#160;of&#160;the&#160;twisted&#160;trace&#160;formula,&#160;does&#160;not&#160;carry&#160;over&#160;(at&#160;least,&#160;not&#160;without&#160;nontrivial<br/>additional&#160;work)&#160;to&#160;the&#160;positive&#160;characteristic&#160;setting.&#160;<a href="1711.02243s.html#5">1</a><br/>
We&#160;now&#160;formulate&#160;our&#160;main&#160;result,&#160;which&#160;is&#160;an&#160;extension&#160;(in&#160;a&#160;special&#160;case)&#160;of&#160;Theorem&#160;<a href="1711.02243s.html#5">2.1&#160;</a>to&#160;positive<br/>
characteristic.<br/>
By&#160;the&#160;Bernstein&#160;isomorphism,&#160;a&#160;basis&#160;for&#160;Z(HG(E),J)&#160;is&#160;given&#160;by&#160;the&#160;functions&#160;ψµ&#160;for&#160;µ&#160;a&#160;dominant<br/>
coweight&#160;of&#160;G,&#160;which&#160;correspond&#160;under&#160;−∗J&#160;IK&#160;to&#160;the&#160;indicator&#160;functions&#160;of&#160;the&#160;double&#160;coset&#160;in&#160;KE\G(E)/KE<br/>indexed&#160;by&#160;µ.<br/>
Example/Definition&#160;2.3.&#160;If&#160;G&#160;=&#160;GLn,&#160;and&#160;T&#160;⊂&#160;GLn&#160;is&#160;the&#160;usual&#160;(diagonal)&#160;maximal&#160;torus,&#160;then&#160;we<br/>may&#160;identify&#160;X∗(T&#160;)&#160;∼<br/>
=&#160;Zn&#160;in&#160;the&#160;standard&#160;way.&#160;The&#160;dominant&#160;weights&#160;coweights&#160;X∗(T&#160;)+&#160;are&#160;those&#160;µ&#160;=<br/>
(µ1,&#160;.&#160;.&#160;.&#160;,&#160;µn)&#160;with&#160;µ1&#160;≥&#160;µ2&#160;≥&#160;.&#160;.&#160;.&#160;≥&#160;µn.&#160;We&#160;define<br/>
|µ|&#160;:=&#160;µ1&#160;+&#160;.&#160;.&#160;.&#160;+&#160;µn.<br/>
In&#160;this&#160;paper&#160;we&#160;prove:<br/>
Theorem&#160;2.4.&#160;Let&#160;E/F&#160;be&#160;an&#160;unramified&#160;degree&#160;r&#160;extension&#160;of&#160;characteristic&#160;p&#160;local&#160;fields.&#160;If&#160;δ&#160;∈&#160;GLn(E)<br/>is&#160;such&#160;that&#160;N&#160;(δ)&#160;is&#160;regular&#160;semisimple&#160;and&#160;separable,&#160;and&#160;ψ&#160;∈&#160;Z(HGLn(E),J)&#160;is&#160;a&#160;linear&#160;combination&#160;of&#160;ψµ<br/>with&#160;|µ|&#160;=&#160;0,&#160;then&#160;we&#160;have<br/>
TOδσ(ψ)&#160;=&#160;ON(δ)(b(ψ)).<br/>
Remark&#160;2.5.&#160;Let&#160;us&#160;make&#160;some&#160;remarks&#160;on&#160;the&#160;hypotheses.&#160;The&#160;hypothesis&#160;|µ|&#160;=&#160;0&#160;arises&#160;geometrically&#160;as<br/>a&#160;condition&#160;for&#160;the&#160;non-emptiness&#160;of&#160;moduli&#160;stacks&#160;of&#160;shtukas.<br/>
The&#160;restriction&#160;to&#160;GLn&#160;comes&#160;from&#160;a&#160;need&#160;to&#160;obtain&#160;a&#160;proper&#160;moduli&#160;stack,&#160;in&#160;order&#160;to&#160;have&#160;enough&#160;control<br/>
over&#160;the&#160;cohomology&#160;of&#160;the&#160;relevant&#160;moduli&#160;stacks&#160;of&#160;shtukas.&#160;In&#160;general&#160;the&#160;moduli&#160;stacks&#160;of&#160;shtukas&#160;are&#160;of<br/>infinite&#160;type,&#160;and&#160;their&#160;cohomology&#160;not&#160;constructible.&#160;However,&#160;for&#160;GLn&#160;we&#160;can&#160;use&#160;the&#160;trick&#160;of&#160;globalizing<br/>to&#160;a&#160;division&#160;algebra&#160;in&#160;order&#160;to&#160;create&#160;a&#160;proper&#160;global&#160;space&#160;with&#160;the&#160;right&#160;local&#160;behavior.<br/>
1However,&#160;we&#160;note&#160;that&#160;W.&#160;Ray&#160;Dulany&#160;proved&#160;the&#160;base&#160;change&#160;fundamental&#160;lemma&#160;for&#160;GL2&#160;by&#160;hand&#160;in&#160;the&#160;function&#160;ﬁeld<br/>
case&#160;<a href="1711.02243s.html#40">[RD]</a>.&#160;We&#160;thank&#160;Tom&#160;Haines&#160;for&#160;informing&#160;us&#160;about&#160;Ray&#160;Dulany’s&#160;work.<br/>
<hr/>
<a name=6></a><img class="yflip" src="html/1711.02243-6_1.png"/><br/>
6<br/>
TONY&#160;FENG<br/>
Remark&#160;2.6.&#160;It&#160;seems&#160;likely&#160;that&#160;the&#160;theorem&#160;can&#160;be&#160;extended&#160;to&#160;prove&#160;Conjecture&#160;<a href="1711.02243s.html#5">2.1&#160;</a>in&#160;full&#160;for&#160;G&#160;=&#160;GLn<br/>using&#160;methods&#160;that&#160;are&#160;by&#160;now&#160;considered&#160;“standard”,&#160;as&#160;in&#160;<a href="1711.02243s.html#39">[Clo90]</a>.&#160;One&#160;reason&#160;we&#160;have&#160;not&#160;bothered&#160;to<br/>do&#160;this&#160;is&#160;that&#160;the&#160;constraint&#160;|µ|&#160;=&#160;0&#160;is&#160;necessary&#160;in&#160;order&#160;to&#160;make&#160;the&#160;geometric&#160;objects&#160;non-trivial,&#160;and&#160;so<br/>is&#160;satisfied&#160;in&#160;applications&#160;of&#160;the&#160;fundamental&#160;lemma&#160;to&#160;study&#160;the&#160;cohomology&#160;of&#160;moduli&#160;stacks&#160;of&#160;shtukas<br/>via&#160;the&#160;Arthur-Selberg&#160;trace&#160;formula.&#160;Therefore,&#160;Theorem&#160;<a href="1711.02243s.html#5">2.4&#160;</a>should&#160;be&#160;adequate&#160;for&#160;applications&#160;to&#160;the<br/>Langlands&#160;program.<br/>
Remark&#160;2.7.&#160;As&#160;T.&#160;Haines&#160;pointed&#160;out&#160;to&#160;us,&#160;another&#160;key&#160;aspect&#160;of&#160;the&#160;fundamental&#160;lemma&#160;is&#160;the&#160;assertion<br/>that&#160;Oγ(b(ψ))&#160;=&#160;0&#160;if&#160;γ&#160;is&#160;not&#160;a&#160;norm.&#160;Our&#160;strategy&#160;does&#160;not&#160;seem&#160;to&#160;naturally&#160;give&#160;access&#160;to&#160;this&#160;statement.<br/>On&#160;the&#160;other&#160;hand,&#160;since&#160;Labesse&#160;gave&#160;a&#160;purely&#160;local&#160;proof&#160;of&#160;this&#160;statement&#160;for&#160;the&#160;spherical&#160;case&#160;in&#160;mixed<br/>characteristic,&#160;which&#160;was&#160;extended&#160;to&#160;the&#160;center&#160;of&#160;parahoric&#160;Hecke&#160;algebras&#160;in&#160;<a href="1711.02243s.html#39">[Hai09]&#160;</a>§5.2,&#160;it&#160;should<br/>generalize&#160;to&#160;positive&#160;characteristic.&#160;We&#160;intend&#160;to&#160;include&#160;this&#160;in&#160;a&#160;future&#160;work,&#160;when&#160;it&#160;becomes&#160;necessary.<br/>
2.1.6.&#160;Related&#160;work.&#160;The&#160;fundamental&#160;lemma&#160;for&#160;base&#160;change&#160;for&#160;spherical&#160;Hecke&#160;algebras,&#160;which&#160;arises&#160;from<br/>Theorem&#160;<a href="1711.02243s.html#5">2.1&#160;</a>in&#160;the&#160;special&#160;case&#160;where&#160;J&#160;=&#160;K&#160;is&#160;a&#160;hyperspecial&#160;maximal&#160;compact&#160;subgroup,&#160;was&#160;proved&#160;in<br/>the&#160;p-adic&#160;case&#160;by&#160;Clozel&#160;<a href="1711.02243s.html#39">[Clo90]&#160;</a>and&#160;Labesse&#160;<a href="1711.02243s.html#40">[Lab90]</a>,&#160;using&#160;key&#160;input&#160;from&#160;Kottwitz&#160;<a href="1711.02243s.html#39">[Kot86a]&#160;</a>who&#160;checked<br/>it&#160;for&#160;the&#160;unit&#160;element.&#160;These&#160;arguments&#160;were&#160;generalized&#160;by&#160;Haines&#160;to&#160;proved&#160;the&#160;base&#160;change&#160;fundamental<br/>lemma&#160;for&#160;centers&#160;of&#160;parahoric&#160;Hecke&#160;algebras,&#160;as&#160;has&#160;been&#160;discussed<a href="1711.02243s.html#6">.2</a><br/>
For&#160;local&#160;function&#160;fields&#160;(i.e.&#160;positive&#160;characteristic),&#160;the&#160;spherical&#160;case&#160;J&#160;=&#160;K&#160;of&#160;Theorem&#160;<a href="1711.02243s.html#5">2.4&#160;</a>was<br/>
established&#160;by&#160;Ngô&#160;<a href="1711.02243s.html#40">[Ngo06]</a>,&#160;also&#160;for&#160;GLn&#160;and&#160;also&#160;for&#160;|µ|&#160;=&#160;0&#160;(with&#160;the&#160;same&#160;reasons&#160;for&#160;the&#160;restrictions).<br/>Indeed,&#160;our&#160;strategy&#160;as&#160;described&#160;in&#160;<a href="1711.02243s.html#1">§1&#160;</a>is&#160;the&#160;one&#160;pioneered&#160;by&#160;<a href="1711.02243s.html#40">[Ngo06]</a>.&#160;Similar&#160;results&#160;were&#160;obtained<br/>independently&#160;and&#160;simultaneously&#160;by&#160;Lau&#160;<a href="1711.02243s.html#40">[Lau04]</a>.&#160;The&#160;key&#160;to&#160;our&#160;generalization&#160;is&#160;that&#160;in&#160;the&#160;parahoric<br/>case,&#160;we&#160;know&#160;enough&#160;about&#160;the&#160;nearby&#160;cycles&#160;sheaf&#160;at&#160;a&#160;place&#160;of&#160;bad&#160;reduction,&#160;thanks&#160;to&#160;the&#160;proof&#160;of&#160;a<br/>“Kottwitz&#160;Conjecture&#160;for&#160;shtukas”&#160;due&#160;to&#160;Gaitsgory&#160;<a href="1711.02243s.html#39">[Gai01]</a>,&#160;to&#160;carry&#160;out&#160;the&#160;geometric&#160;argument.<br/>
2.2.&#160;Overview&#160;of&#160;the&#160;proof.&#160;Let&#160;us&#160;now&#160;give&#160;a&#160;more&#160;detailed&#160;overview&#160;of&#160;the&#160;proof&#160;of&#160;Theorem&#160;<a href="1711.02243s.html#5">2.4.&#160;</a>We<br/>are&#160;trying&#160;to&#160;prove&#160;a&#160;local&#160;result,&#160;but&#160;we&#160;will&#160;immediately&#160;shift&#160;to&#160;a&#160;global&#160;setting.&#160;Therefore,&#160;we&#160;change<br/>notation&#160;from&#160;before.&#160;Let&#160;Fx&#160;be&#160;a&#160;local&#160;function&#160;field&#160;of&#160;characteristic&#160;p,&#160;so&#160;we&#160;have&#160;non-canonically<br/>
0<br/>
F<br/>
∼<br/>
x<br/>
=&#160;F<br/>
0<br/>
q((t)).<br/>
As&#160;the&#160;notation&#160;suggests,&#160;we&#160;view&#160;Fx&#160;as&#160;the&#160;completion&#160;of&#160;a&#160;global&#160;function&#160;field&#160;F&#160;at&#160;a&#160;place&#160;x<br/>
0<br/>
0,&#160;and&#160;we<br/>
view&#160;F&#160;as&#160;the&#160;global&#160;function&#160;field&#160;of&#160;a&#160;smooth&#160;projective&#160;curve&#160;X/Fq.&#160;(Note&#160;that&#160;we&#160;have&#160;implicitly&#160;taken<br/>x0&#160;to&#160;be&#160;a&#160;point&#160;of&#160;degree&#160;one&#160;on&#160;X,&#160;which&#160;is&#160;actually&#160;important.)<br/>
Let&#160;G&#160;be&#160;a&#160;reductive&#160;group&#160;over&#160;F&#160;and&#160;J&#160;⊂&#160;G(Fx&#160;)&#160;a&#160;parahoric&#160;subgroup.&#160;We&#160;choose&#160;any&#160;extension&#160;of<br/>
0<br/>
G&#160;to&#160;parahoric&#160;group&#160;scheme&#160;G&#160;→&#160;X&#160;such&#160;that&#160;over&#160;the&#160;completed&#160;local&#160;ring&#160;Spec&#160;(Ox&#160;:=&#160;b<br/>
O<br/>
),&#160;we&#160;have<br/>
0<br/>
X,x0<br/>
G(Ox&#160;)&#160;=&#160;J.&#160;We&#160;assume&#160;that&#160;G&#160;⊗<br/>
0<br/>
F&#160;Fx&#160;is&#160;split&#160;at&#160;all&#160;x&#160;where&#160;G(Ox)&#160;is&#160;not&#160;hyperspecial.<br/>
Following&#160;<a href="1711.02243s.html#40">[Ngo06]</a>,&#160;in&#160;<a href="1711.02243s.html#32">§8&#160;</a>we&#160;define&#160;two&#160;moduli&#160;stacks&#160;of&#160;G-shtukas&#160;which&#160;we&#160;call&#160;ShtA&#160;and&#160;ShtB.&#160;(We&#160;have<br/>
included&#160;a&#160;background&#160;section&#160;summarizing&#160;the&#160;essential&#160;constructions&#160;and&#160;facts&#160;about&#160;shtukas&#160;in&#160;<a href="1711.02243s.html#9">§4.</a>)&#160;Let<br/>E/F&#160;be&#160;the&#160;unramified&#160;extension&#160;of&#160;degree&#160;r.&#160;As&#160;outlined&#160;in&#160;<a href="1711.02243s.html#1">§1,&#160;</a>the&#160;goal&#160;is&#160;threefold:<br/>
(1)&#160;Obtain&#160;an&#160;expression&#160;relating&#160;the&#160;trace&#160;of&#160;Frobenius&#160;composed&#160;with&#160;Hecke&#160;operators&#160;on&#160;the&#160;coho-<br/>
mology&#160;of&#160;ShtA&#160;to&#160;the&#160;twisted&#160;orbital&#160;integral&#160;of&#160;ψ&#160;∈&#160;Z(HG(Ex&#160;),J).<br/>
0<br/>
(2)&#160;Obtain&#160;an&#160;expression&#160;relating&#160;trace&#160;of&#160;Frobenius&#160;composed&#160;with&#160;Hecke&#160;operators&#160;on&#160;the&#160;cohomology<br/>
of&#160;ShtB&#160;to&#160;the&#160;orbital&#160;integral&#160;of&#160;the&#160;base&#160;changed&#160;function&#160;b(ψ).<br/>
(3)&#160;Relate&#160;the&#160;two&#160;cohomology&#160;groups&#160;in&#160;question&#160;in&#160;some&#160;other&#160;way.<br/>
Let&#160;us&#160;discuss&#160;each&#160;of&#160;these&#160;tasks&#160;in&#160;turn.&#160;For&#160;(1),&#160;we&#160;need&#160;a&#160;geometric&#160;interpretation&#160;of&#160;the&#160;center&#160;of&#160;the<br/>parahoric&#160;Hecke&#160;algebra&#160;HG(Fx&#160;),J.&#160;It&#160;is&#160;well-known&#160;that&#160;the&#160;spherical&#160;Hecke&#160;algebra&#160;is&#160;geometrized,&#160;under<br/>
0<br/>
the&#160;function-sheaf&#160;dictionary,&#160;by&#160;perverse&#160;sheaves&#160;on&#160;the&#160;affine&#160;Grassmannian.&#160;Similarly,&#160;the&#160;parahoric&#160;Hecke<br/>algebra&#160;is&#160;geometrized&#160;by&#160;a&#160;partial&#160;affine&#160;flag&#160;variety.<br/>
This&#160;story&#160;is&#160;globalized&#160;by&#160;the&#160;Beilinson-Drinfeld&#160;Grassmanian&#160;GrG&#160;→&#160;X.&#160;Over&#160;a&#160;general&#160;point&#160;of&#160;X<br/>
the&#160;fiber&#160;of&#160;GrG&#160;is&#160;an&#160;affine&#160;Grassmannian,&#160;but&#160;because&#160;G&#160;is&#160;a&#160;parahoric&#160;group&#160;at&#160;x0,&#160;the&#160;fiber&#160;over&#160;x0&#160;is<br/>actually&#160;a&#160;partial&#160;affine&#160;flag&#160;variety.&#160;It&#160;is&#160;essentially&#160;a&#160;result&#160;of&#160;Gaitsgory,&#160;although&#160;the&#160;formulation&#160;in&#160;<a href="1711.02243s.html#39">[Gai01]</a><br/>
2See&#160;the&#160;last&#160;paragraph&#160;of&#160;the&#160;introduction&#160;to&#160;<a href="1711.02243s.html#39">[Hai09]&#160;</a>for&#160;a&#160;discussion&#160;of&#160;to&#160;what&#160;extent&#160;Conjecture&#160;<a href="1711.02243s.html#5">2.1&#160;</a>follows&#160;from&#160;the<br/>
fundamental&#160;lemma&#160;for&#160;twisted&#160;endoscopy.&#160;Although&#160;base&#160;change&#160;is&#160;a&#160;special&#160;case&#160;of&#160;twisted&#160;endoscopy,&#160;the&#160;fundamental&#160;lemma<br/>for&#160;twisted&#160;endoscopy&#160;should&#160;imply&#160;that&#160;there&#160;is&#160;a&#160;matching&#160;function&#160;for&#160;ψ,&#160;but&#160;does&#160;not&#160;identify&#160;it&#160;in&#160;terms&#160;of&#160;the&#160;base&#160;change<br/>homomorphism.<br/>
<hr/>
<a name=7></a><img class="yflip" src="html/1711.02243-7_1.png"/><br/>
<img class="yflip" src="html/1711.02243-7_2.png"/><br/>
<img class="yflip" src="html/1711.02243-7_3.png"/><br/>
<img class="yflip" src="html/1711.02243-7_4.png"/><br/>
<img class="yflip" src="html/1711.02243-7_5.png"/><br/>
<img class="yflip" src="html/1711.02243-7_6.png"/><br/>
NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,&#160;AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
7<br/>
is&#160;slightly&#160;different,&#160;that&#160;the&#160;nearby&#160;cycles&#160;functor&#160;takes&#160;perverse&#160;sheaves&#160;on&#160;GrG&#160;|X−x&#160;to&#160;central&#160;perverse<br/>
0<br/>
sheaves&#160;on&#160;Gr<br/>
∼<br/>
G&#160;|x<br/>
=&#160;Fl<br/>
0<br/>
G,J&#160;.<br/>
Using&#160;this,&#160;in&#160;<a href="1711.02243s.html#16">§5&#160;</a>we&#160;relate&#160;the&#160;trace&#160;function&#160;associated&#160;to&#160;the&#160;nearby&#160;cycles&#160;sheaf&#160;at&#160;x0&#160;of&#160;perverse&#160;sheaves<br/>
on&#160;ShtG&#160;to&#160;central&#160;elements&#160;of&#160;HG,J&#160;.&#160;This&#160;is&#160;the&#160;desired&#160;geometrization&#160;of&#160;Z(HG(Ex&#160;),J).&#160;The&#160;key&#160;point&#160;is<br/>
0<br/>
that&#160;the&#160;Beilinson-Drinfeld&#160;Grassmannian&#160;is&#160;a&#160;smooth&#160;(even&#160;étale)&#160;local&#160;model&#160;for&#160;ShtG.<br/>
In&#160;<a href="1711.02243s.html#20">§6&#160;</a>we&#160;give&#160;a&#160;counting&#160;formula&#160;for&#160;points&#160;of&#160;ShtA,&#160;in&#160;the&#160;style&#160;of&#160;Kottwitz&#160;<a href="1711.02243s.html#39">[Kot92]</a>.&#160;This&#160;formula&#160;is&#160;based<br/>
on&#160;<a href="1711.02243s.html#40">[Ngo06]&#160;</a>and&#160;<a href="1711.02243s.html#40">[NND08]</a>;&#160;however&#160;we&#160;must&#160;note&#160;that&#160;it&#160;only&#160;gives&#160;a&#160;“partial&#160;formula”,&#160;counting&#160;only&#160;those<br/>points&#160;indexed&#160;by&#160;an&#160;elliptic&#160;Kottwitz&#160;triple.&#160;Indeed,&#160;since&#160;the&#160;moduli&#160;stacks&#160;of&#160;shtukas&#160;are&#160;of&#160;infinite&#160;type<br/>in&#160;general&#160;(even&#160;with&#160;full&#160;level&#160;structure&#160;and&#160;bounded&#160;modifications),&#160;they&#160;can&#160;have&#160;infinitely&#160;many&#160;points<br/>over&#160;finite&#160;fields&#160;in&#160;general,&#160;which&#160;makes&#160;it&#160;somewhat&#160;subtle&#160;to&#160;give&#160;a&#160;meaningful&#160;formula.&#160;This&#160;issue&#160;can<br/>be&#160;bypassed&#160;altogether&#160;for&#160;GLn&#160;by&#160;taking&#160;G&#160;to&#160;be&#160;the&#160;group&#160;associated&#160;to&#160;a&#160;sufficiently&#160;ramified&#160;division<br/>algebra&#160;over&#160;X,&#160;with&#160;G(Fx&#160;)&#160;∼<br/>
=&#160;GL<br/>
).&#160;This&#160;trick&#160;is&#160;one&#160;major&#160;reason&#160;for&#160;the&#160;restriction&#160;to&#160;GL<br/>
0<br/>
n(Fx0<br/>
n;&#160;another<br/>
(which&#160;is&#160;morally&#160;of&#160;the&#160;same&#160;nature)&#160;will&#160;arise&#160;in&#160;the&#160;discussion&#160;of&#160;(3).<br/>
These&#160;ingredients&#160;are&#160;put&#160;together&#160;in&#160;<a href="1711.02243s.html#34">§9.1,&#160;</a>obtaining&#160;a&#160;formula<br/>
<br/>
<br/>
X<br/>
Y<br/>
Tr((h<br/>
<br/>
<br/>
β&#160;⊗&#160;1&#160;.&#160;.&#160;.&#160;⊗&#160;1)&#160;◦&#160;Frobx&#160;◦τ,&#160;RΨ<br/>
(Aµ<br/>
(.&#160;.&#160;.)<br/>
O&#160;(f&#160;)<br/>
·&#160;TO<br/>
0<br/>
xr<br/>
γ<br/>
β<br/>
δ<br/>
σ&#160;(ψ′<br/>
0<br/>
r&#160;))&#160;=<br/>
v<br/>
v<br/>
x0<br/>
r,µ).<br/>
(2.1)<br/>
v6=x0<br/>
See&#160;Theorem&#160;<a href="1711.02243s.html#34">9.2&#160;</a>for&#160;the&#160;precise&#160;statement.<br/>
Now&#160;we&#160;turn&#160;our&#160;attention&#160;to&#160;(2).&#160;All&#160;the&#160;same&#160;ingredients&#160;and&#160;steps&#160;are&#160;required&#160;as&#160;in&#160;(1),&#160;but&#160;now&#160;we<br/>
additionally&#160;need&#160;a&#160;geometric&#160;interpretation&#160;of&#160;the&#160;base&#160;change&#160;homomorphism<br/>
b&#160;:&#160;Z(HG(Ex&#160;),J)&#160;→&#160;Z(HG(F&#160;),J).<br/>
0<br/>
x0<br/>
This&#160;problem&#160;is&#160;studied&#160;in&#160;<a href="1711.02243s.html#25">§7&#160;</a>for&#160;split&#160;reductive&#160;G,&#160;generalizing&#160;results&#160;of&#160;Ngô&#160;for&#160;GLn&#160;<a href="1711.02243s.html#40">[Ngo99]</a>.&#160;First,<br/>by&#160;a&#160;local&#160;study&#160;of&#160;the&#160;affine&#160;Grassmannian&#160;we&#160;prove&#160;the&#160;following&#160;fact.&#160;Let&#160;SatGr&#160;(µ)&#160;be&#160;the&#160;perverse<br/>
G<br/>
sheaf&#160;on&#160;GrG&#160;corresponding,&#160;under&#160;Geometric&#160;Satake,&#160;to&#160;the&#160;dominant&#160;coweight&#160;µ&#160;∈&#160;X∗(T&#160;)+,&#160;and&#160;let&#160;ψr,µ<br/>be&#160;the&#160;trace&#160;function&#160;of&#160;Frobr&#160;on&#160;SatGr&#160;(µ);&#160;thus&#160;ψ<br/>
).&#160;Then&#160;b(ψ<br/>
G<br/>
r,µ&#160;∈&#160;HG,K&#160;(Ex0<br/>
r,µ)&#160;is&#160;the&#160;trace&#160;function<br/>
associated&#160;to&#160;Frob&#160;◦κ′&#160;on&#160;SatGr&#160;(µ)∗r,&#160;where&#160;Sat<br/>
(µ)∗r&#160;is&#160;the&#160;r-fold&#160;convolution&#160;of&#160;Sat<br/>
(µ)&#160;and&#160;κ′&#160;is<br/>
G<br/>
GrG<br/>
GrG<br/>
a&#160;cyclic&#160;permutation&#160;of&#160;order&#160;r&#160;using&#160;from&#160;the&#160;commutativity&#160;constraint&#160;on&#160;perverse&#160;sheaves&#160;on&#160;the&#160;affine<br/>Grassmannian&#160;<a href="1711.02243s.html#40">[MV07]</a>.&#160;See&#160;Theorem&#160;<a href="1711.02243s.html#30">7.15&#160;</a>for&#160;the&#160;precise&#160;statement.&#160;We&#160;emphasize&#160;again&#160;that&#160;this&#160;was<br/>obtained&#160;already&#160;by&#160;Ngô&#160;for&#160;GLn,&#160;which&#160;is&#160;really&#160;the&#160;only&#160;situation&#160;where&#160;we&#160;can&#160;currently&#160;prove&#160;Conjecture<br/><a href="1711.02243s.html#5">2.1;&#160;</a>we&#160;prove&#160;the&#160;more&#160;general&#160;statement&#160;here&#160;in&#160;anticipation&#160;of&#160;future&#160;generalizations.<br/>
Using&#160;the&#160;global&#160;degeneration&#160;from&#160;a&#160;Beilinson-Drinfeld&#160;Grassmanian,&#160;we&#160;prove&#160;an&#160;analogous&#160;generaliza-<br/>
tion&#160;to&#160;the&#160;center&#160;of&#160;parahoric&#160;Hecke&#160;algebras&#160;in&#160;terms&#160;of&#160;nearby&#160;cycles&#160;sheaves;&#160;see&#160;Theorem&#160;<a href="1711.02243s.html#31">7.17&#160;</a>for&#160;the<br/>precise&#160;statement.&#160;This&#160;result&#160;is&#160;used&#160;as&#160;a&#160;local&#160;model&#160;to&#160;understand&#160;sheaves&#160;on&#160;ShtB,&#160;and&#160;is&#160;assembled&#160;in<br/><a href="1711.02243s.html#36">§9.2&#160;</a>in&#160;conjunction&#160;with&#160;the&#160;ingredients&#160;mentioned&#160;in&#160;the&#160;discussion&#160;of&#160;(1)&#160;to&#160;obtain&#160;a&#160;formula<br/>
<br/>
<br/>
X<br/>
Y<br/>
Tr(h<br/>
<br/>
<br/>
β&#160;◦&#160;Frobx&#160;◦τ,&#160;RΨ<br/>
(Bµ<br/>
(.&#160;.&#160;.)<br/>
O&#160;(f&#160;)<br/>
·&#160;O<br/>
(b(ψ′<br/>
0<br/>
xr<br/>
γ<br/>
β<br/>
γ<br/>
0<br/>
r&#160;))&#160;=<br/>
v<br/>
v<br/>
x0<br/>
r,µ)).<br/>
(2.2)<br/>
v6=x0<br/>
See&#160;Theorem&#160;<a href="1711.02243s.html#36">9.3&#160;</a>for&#160;the&#160;precise&#160;statement.<br/>
Finally,&#160;we&#160;address&#160;(3).&#160;As&#160;discussed&#160;in&#160;<a href="1711.02243s.html#1">§1&#160;</a>the&#160;moduli&#160;problems&#160;ShtA&#160;and&#160;ShtB&#160;are&#160;actually&#160;defined&#160;over<br/>
(X◦)r.&#160;By&#160;analogous&#160;but&#160;easier&#160;arguments&#160;we&#160;can&#160;prove&#160;that<br/>
Tr((hβ&#160;⊗&#160;1&#160;.&#160;.&#160;.&#160;⊗&#160;1)&#160;◦&#160;Frobx&#160;◦τ,&#160;Aµr)&#160;=&#160;Tr(hβ&#160;◦&#160;Frobx&#160;◦τ,&#160;Bµr)<br/>
for&#160;x&#160;∈&#160;(X◦)r&#160;consisting&#160;of&#160;r&#160;pairwise-distinct&#160;points.&#160;(We&#160;caution&#160;that&#160;the&#160;relationship&#160;between&#160;Aµr&#160;and&#160;Bµr<br/>is&#160;not&#160;one&#160;of&#160;equality.&#160;Rather,&#160;the&#160;former&#160;is&#160;more&#160;like&#160;the&#160;rth&#160;tensor&#160;power&#160;of&#160;the&#160;latter,&#160;and&#160;the&#160;equality&#160;of<br/>traces&#160;is&#160;the&#160;nonobvious&#160;linear&#160;algebraic&#160;identity&#160;in&#160;Lemma&#160;<a href="1711.02243s.html#30">7.13.</a>)&#160;In&#160;other&#160;words,&#160;we&#160;can&#160;obtain&#160;analogues<br/>of&#160;<a href="1711.02243s.html#7">(2.1)&#160;</a>and&#160;<a href="1711.02243s.html#7">(2.2)&#160;</a>which&#160;are&#160;manifestly&#160;equal&#160;at&#160;sufficiently&#160;many&#160;(by&#160;Chebotarev&#160;density)&#160;x.&#160;In&#160;fact&#160;since<br/>ShtA&#160;and&#160;ShtB&#160;have&#160;good&#160;(hyperspecial)&#160;reduction&#160;at&#160;almost&#160;all&#160;such&#160;x&#160;this&#160;already&#160;follows&#160;from&#160;<a href="1711.02243s.html#40">[Ngo06]&#160;</a>§5,<br/>where&#160;the&#160;proof&#160;is&#160;exactly&#160;as&#160;was&#160;just&#160;indicated;&#160;we&#160;give&#160;a&#160;more&#160;detailed&#160;sketch&#160;of&#160;Ngô’s&#160;proof&#160;in&#160;<a href="1711.02243s.html#33">§8.4.</a><br/>
However,&#160;knowing&#160;the&#160;equality&#160;for&#160;x&#160;∈&#160;U&#160;:=&#160;(X◦)r&#160;−&#160;∆(X◦)&#160;is&#160;not&#160;itself&#160;sufficient&#160;for&#160;deducing&#160;an<br/>
equality&#160;at&#160;a&#160;point&#160;of&#160;∆(X◦).&#160;It&#160;would&#160;be&#160;sufficient&#160;if&#160;the&#160;sheaves&#160;Aµr&#160;and&#160;Bµr&#160;were&#160;local&#160;systems&#160;in&#160;a<br/>
<hr/>
<a name=8></a>8<br/>
TONY&#160;FENG<br/>
neighborhood&#160;of&#160;a&#160;point&#160;of&#160;∆(X◦)&#160;⊂&#160;(X◦)r.&#160;In&#160;fact,&#160;since&#160;they&#160;are&#160;equipped&#160;with&#160;a&#160;partial&#160;Frobenius<br/>structure,&#160;by&#160;“Drinfeld’s&#160;Lemma”&#160;(<a href="1711.02243s.html#39">[Dri87]&#160;</a>Proposition&#160;6.1,&#160;<a href="1711.02243s.html#40">[Lau04]&#160;</a>Lemma&#160;9.2.1)&#160;if&#160;they&#160;were&#160;even&#160;merely<br/>constructible&#160;then&#160;they&#160;would&#160;automatically&#160;be&#160;local&#160;systems&#160;in&#160;a&#160;neighborhood&#160;of&#160;the&#160;generic&#160;point&#160;of<br/>∆(X◦)&#160;⊂&#160;(X◦)r.&#160;Unfortunately,&#160;as&#160;has&#160;already&#160;been&#160;discussed,&#160;the&#160;moduli&#160;stacks&#160;of&#160;shtukas&#160;are&#160;of&#160;infinite<br/>type&#160;in&#160;general,&#160;and&#160;their&#160;cohomology&#160;is&#160;not&#160;even&#160;constructible&#160;on&#160;(X◦)r.&#160;Here&#160;again&#160;we&#160;invoke&#160;the&#160;trick&#160;of<br/>using&#160;a&#160;sufficiently&#160;ramified&#160;division&#160;algebra&#160;in&#160;order&#160;to&#160;enforce&#160;the&#160;properness&#160;of&#160;the&#160;global&#160;moduli&#160;stack,<br/>and&#160;thus&#160;the&#160;constructibility;&#160;of&#160;course&#160;the&#160;cost&#160;is&#160;that&#160;this&#160;only&#160;gives&#160;results&#160;for&#160;GLn.<br/>
2.3.&#160;Summary&#160;of&#160;the&#160;paper.&#160;Although&#160;we&#160;discussed&#160;in&#160;<a href="1711.02243s.html#6">§2.2&#160;</a>why&#160;our&#160;current&#160;argument&#160;does&#160;not&#160;work<br/>beyond&#160;GLn,&#160;we&#160;hope&#160;that&#160;after&#160;future&#160;technical&#160;improvements&#160;in&#160;the&#160;theory&#160;of&#160;shtukas&#160;it&#160;can&#160;be&#160;generalized<br/>to&#160;a&#160;much&#160;wider&#160;class&#160;of&#160;reductive&#160;groups.&#160;For&#160;this&#160;reason,&#160;for&#160;the&#160;individual&#160;steps&#160;we&#160;have&#160;tried&#160;to&#160;work<br/>with&#160;more&#160;general&#160;groups&#160;when&#160;possible.&#160;It&#160;seems&#160;worthwhile&#160;to&#160;give&#160;a&#160;brief&#160;outline&#160;of&#160;the&#160;organization&#160;of<br/>the&#160;paper,&#160;pointing&#160;out&#160;exactly&#160;where&#160;we&#160;can&#160;be&#160;more&#160;general.<br/>
In&#160;<a href="1711.02243s.html#9">§4&#160;</a>we&#160;review&#160;the&#160;theory&#160;of&#160;shtukas&#160;for&#160;nonconstant&#160;reductive&#160;group&#160;schemes,&#160;summarizing&#160;the&#160;essential<br/>
background&#160;facts.&#160;Also,&#160;a&#160;key&#160;point&#160;is&#160;to&#160;define&#160;an&#160;“integral&#160;model”&#160;for&#160;the&#160;moduli&#160;stack&#160;of&#160;shtukas,&#160;extending<br/>over&#160;points&#160;of&#160;parahoric&#160;bad&#160;reduction.<br/>
In&#160;<a href="1711.02243s.html#16">§5&#160;</a>we&#160;establish&#160;an&#160;analogue&#160;of&#160;the&#160;Kottwitz&#160;Conjecture&#160;for&#160;moduli&#160;of&#160;shtukas.&#160;This&#160;works&#160;even&#160;for<br/>
fairly&#160;general&#160;(not&#160;necessarily&#160;constant)&#160;reductive&#160;groups&#160;G&#160;→&#160;X:&#160;Gaitsgory&#160;originally&#160;proved&#160;it&#160;for&#160;constant<br/>groups,&#160;and&#160;his&#160;argument&#160;was&#160;generalized&#160;by&#160;Zhu&#160;in&#160;<a href="1711.02243s.html#40">[Zhu14]&#160;</a>Theorem&#160;7.3&#160;and&#160;Pappas-Zhu&#160;in&#160;<a href="1711.02243s.html#40">[PZ13]</a>.<br/>
In&#160;<a href="1711.02243s.html#20">§6&#160;</a>we&#160;establish&#160;some&#160;counting&#160;formulas&#160;for&#160;points&#160;of&#160;shtukas&#160;over&#160;finite&#160;fields.&#160;This&#160;is&#160;a&#160;minor&#160;variant<br/>
of&#160;the&#160;work&#160;of&#160;Ngô&#160;B.C.&#160;and&#160;Ngô&#160;Dac&#160;T.,&#160;which&#160;was&#160;previously&#160;only&#160;formulated&#160;at&#160;places&#160;hyperspecial&#160;level<br/>structure.&#160;Our&#160;contribution&#160;is&#160;to&#160;write&#160;it&#160;out&#160;for&#160;the&#160;case&#160;of&#160;parahoric&#160;bad&#160;reduction&#160;that&#160;we&#160;require.<br/>
In&#160;<a href="1711.02243s.html#25">§7&#160;</a>we&#160;provide&#160;a&#160;geometric&#160;interpretation&#160;of&#160;the&#160;base&#160;change&#160;homomorphism&#160;for&#160;spherical&#160;Hecke&#160;algebras<br/>
and&#160;the&#160;center&#160;of&#160;parahoric&#160;Hecke&#160;algebras&#160;for&#160;general&#160;split&#160;reductive&#160;groups&#160;G&#160;over&#160;a&#160;local&#160;field.&#160;For&#160;GLn<br/>this&#160;was&#160;proved&#160;by&#160;Ngô,&#160;in&#160;a&#160;formulation&#160;that&#160;was&#160;rather&#160;specific&#160;to&#160;GLn.&#160;We&#160;generalize&#160;the&#160;argument&#160;to<br/>spherical&#160;Hecke&#160;algebras&#160;for&#160;arbitrary&#160;split&#160;reductive&#160;groups,&#160;and&#160;then&#160;use&#160;that&#160;to&#160;deduce&#160;a&#160;result&#160;for&#160;(central<br/>elements&#160;in)&#160;parahoric&#160;Hecke&#160;algebras.<br/>
In&#160;<a href="1711.02243s.html#32">§8&#160;</a>we&#160;introduce&#160;the&#160;two&#160;moduli&#160;problems&#160;ShtA&#160;and&#160;ShtB&#160;which&#160;are&#160;to&#160;be&#160;compared,&#160;and&#160;recall&#160;Ngô’s<br/>
theorem&#160;stating&#160;the&#160;precise&#160;comparison.&#160;Using&#160;this&#160;we&#160;deduce&#160;an&#160;equality&#160;of&#160;traces&#160;on&#160;the&#160;nearby&#160;cycles<br/>sheaves&#160;at&#160;the&#160;point&#160;of&#160;parahoric&#160;reduction.&#160;Here&#160;we&#160;also&#160;crucially&#160;use&#160;that&#160;the&#160;moduli&#160;of&#160;shtukas&#160;associated<br/>to&#160;a&#160;sufficiently&#160;ramified&#160;division&#160;algebra&#160;is&#160;proper,&#160;which&#160;implies&#160;that&#160;the&#160;cohomology&#160;is&#160;a&#160;local&#160;system.<br/>
In&#160;<a href="1711.02243s.html#34">§9&#160;</a>we&#160;compute&#160;these&#160;traces&#160;in&#160;terms&#160;of&#160;(twisted)&#160;orbital&#160;integrals,&#160;giving&#160;formulas&#160;in&#160;the&#160;paradigm&#160;of<br/>
Kottwitz,&#160;and&#160;then&#160;use&#160;them&#160;in&#160;<a href="1711.02243s.html#38">§9.3&#160;</a>to&#160;deduce&#160;the&#160;cases&#160;of&#160;the&#160;base&#160;change&#160;fundamental&#160;lemma&#160;claimed&#160;in<br/>Theorem&#160;<a href="1711.02243s.html#5">2.4.</a><br/>
2.4.&#160;Acknowledgments.&#160;I&#160;am&#160;indebted&#160;to&#160;Zhiwei&#160;Yun&#160;for&#160;teaching&#160;me&#160;basically&#160;everything&#160;that&#160;I&#160;know<br/>about&#160;shtukas,&#160;and&#160;in&#160;particular&#160;for&#160;directing&#160;me&#160;to&#160;<a href="1711.02243s.html#40">[Ngo06]</a>.&#160;I&#160;would&#160;also&#160;like&#160;to&#160;thank&#160;Zhiwei,&#160;Laurent<br/>Clozel,&#160;Gurbir&#160;Dhillon,&#160;Tom&#160;Haines,&#160;Jochen&#160;Heinloth,&#160;Urs&#160;Hartl,&#160;Bao&#160;Le&#160;Hung,&#160;and&#160;Rong&#160;Zhou&#160;for&#160;helpful<br/>conversations&#160;related&#160;to&#160;this&#160;work.&#160;This&#160;document&#160;benefited&#160;enormously&#160;from&#160;comments,&#160;corrections,&#160;and<br/>suggestions&#160;by&#160;Brian&#160;Conrad,&#160;Tom&#160;Haines,&#160;and&#160;Timo&#160;Richarz.<br/>
This&#160;project&#160;was&#160;conceived&#160;at&#160;the&#160;2017&#160;Arbeitsgemeinschaft&#160;in&#160;Oberwolfach,&#160;and&#160;completed&#160;while&#160;I&#160;was<br/>
a&#160;guest&#160;at&#160;the&#160;Institute&#160;for&#160;Advanced&#160;Study,&#160;and&#160;under&#160;the&#160;support&#160;of&#160;an&#160;NSF&#160;Graduate&#160;Fellowship.&#160;I&#160;am<br/>grateful&#160;to&#160;these&#160;institutions&#160;for&#160;their&#160;support.<br/>
3.&#160;Notation<br/>
We&#160;collect&#160;some&#160;notation&#160;that&#160;will&#160;be&#160;used&#160;frequently&#160;throughout&#160;the&#160;paper.<br/>
•&#160;Let&#160;X&#160;be&#160;a&#160;smooth&#160;projective&#160;curve&#160;over&#160;a&#160;finite&#160;field&#160;k&#160;=&#160;Fq,&#160;and&#160;let&#160;F&#160;=&#160;k(X)&#160;be&#160;its&#160;global&#160;function<br/>
field.&#160;We&#160;fix&#160;a&#160;point&#160;x0&#160;∈&#160;X(Fq).<br/>
•&#160;We&#160;will&#160;let&#160;X◦&#160;be&#160;an&#160;open&#160;subset&#160;of&#160;X,&#160;usually&#160;the&#160;complement&#160;of&#160;some&#160;points&#160;for&#160;ramification&#160;and<br/>
possibly&#160;also&#160;x0.<br/>
•&#160;We&#160;denote&#160;by&#160;|X|&#160;the&#160;set&#160;of&#160;closed&#160;points&#160;of&#160;X,&#160;and&#160;for&#160;x&#160;∈&#160;X&#160;we&#160;write&#160;k(x)&#160;for&#160;the&#160;residue&#160;field&#160;of<br/>
x.<br/>
•&#160;For&#160;x&#160;∈&#160;X,&#160;we&#160;let&#160;Ox&#160;be&#160;the&#160;completion&#160;of&#160;OX,x&#160;at&#160;its&#160;maximal,&#160;and&#160;Fx&#160;be&#160;the&#160;fraction&#160;field&#160;of&#160;Ox.<br/>
We&#160;set&#160;Dx&#160;:=&#160;Spec&#160;Ox.<br/>
<hr/>
<a name=9></a><img class="yflip" src="html/1711.02243-9_1.png"/><br/>
NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,&#160;AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
9<br/>
•&#160;We&#160;let&#160;G&#160;be&#160;a&#160;connected&#160;reductive&#160;group&#160;over&#160;F&#160;,&#160;whose&#160;derived&#160;group&#160;is&#160;simply&#160;connected.&#160;We<br/>
assume&#160;that&#160;G&#160;extends&#160;to&#160;a&#160;parahoric&#160;group&#160;scheme&#160;G&#160;→&#160;X,&#160;and&#160;that&#160;G&#160;⊗&#160;Fx&#160;is&#160;split&#160;at&#160;all&#160;points<br/>x&#160;∈&#160;X&#160;where&#160;G(Ox)&#160;is&#160;not&#160;hyperspecial.<br/>
•&#160;We&#160;denote&#160;by&#160;E0&#160;the&#160;trivial&#160;(fppf)&#160;G-torsor&#160;over&#160;X.<br/>
4.&#160;Moduli&#160;of&#160;shtukas<br/>
In&#160;this&#160;section&#160;we&#160;recall&#160;material&#160;concerning&#160;shtukas&#160;and&#160;their&#160;perverse&#160;sheaves.&#160;This&#160;is&#160;mostly&#160;background,<br/>
but&#160;we&#160;emphasize&#160;that&#160;it&#160;is&#160;important&#160;for&#160;us&#160;to&#160;work&#160;at&#160;the&#160;generality&#160;of&#160;nonconstant&#160;groups.&#160;This&#160;allows<br/>us&#160;to&#160;define&#160;an&#160;“integral&#160;model”&#160;for&#160;parahoric&#160;shtukas,&#160;which&#160;is&#160;much&#160;easier&#160;than&#160;the&#160;corresponding&#160;problem<br/>for&#160;Shimura&#160;varieties.&#160;References&#160;for&#160;this&#160;section&#160;are&#160;<a href="1711.02243s.html#40">[Zhu14]&#160;</a>§3&#160;and&#160;<a href="1711.02243s.html#40">[Laf12]&#160;</a>§12.<br/>
4.1.&#160;G-bundles.&#160;Let&#160;G&#160;→&#160;X&#160;be&#160;a&#160;smooth&#160;affine&#160;group&#160;scheme&#160;with&#160;(connected)&#160;reductive&#160;generic&#160;fiber&#160;G,<br/>such&#160;that&#160;G|O&#160;is&#160;a&#160;parahoric&#160;group&#160;scheme&#160;for&#160;each&#160;x&#160;∈&#160;X.&#160;We&#160;assume&#160;that&#160;G|<br/>
is&#160;split&#160;at&#160;all&#160;points&#160;x&#160;∈&#160;X<br/>
x<br/>
Fx<br/>
where&#160;G(Ox)&#160;is&#160;not&#160;hyperspecial.<br/>
4.1.1.&#160;We&#160;recall&#160;the&#160;notion&#160;of&#160;G-bundles&#160;and&#160;affine&#160;Grassmannians,&#160;the&#160;study&#160;of&#160;which&#160;seems&#160;to&#160;have&#160;been<br/>initiated&#160;by&#160;<a href="1711.02243s.html#40">[PR10]</a>.<br/>
Definition&#160;4.1.&#160;A&#160;G-bundle&#160;E&#160;is&#160;a&#160;G-torsor&#160;for&#160;the&#160;fppf&#160;topology.&#160;We&#160;define&#160;BunG&#160;to&#160;be&#160;the&#160;(Artin)&#160;stac<a href="1711.02243s.html#9">k3<br/></a>representing&#160;the&#160;functor<br/>
BunG&#160;:&#160;S&#160;7→&#160;{G-bundles&#160;on&#160;X&#160;×&#160;S}&#160;.<br/>
Definition&#160;4.2.&#160;We&#160;define&#160;the&#160;global&#160;affine&#160;Grassmannian&#160;GrG&#160;to&#160;be&#160;the&#160;(Artin)&#160;stack&#160;representing&#160;the<br/>functor<br/>
<br/>
<br/>
<br/>
x&#160;∈&#160;X(S)<br/>
<br/>
GrG&#160;:&#160;S&#160;7→<br/>
(x,&#160;E,&#160;β)&#160;:<br/>
E&#160;∈&#160;Bun<br/>
<br/>
G&#160;(S)<br/>
β&#160;:&#160;E|<br/>
∼<br/>
<br/>
X<br/>
=&#160;E0|<br/>
S&#160;−Γx<br/>
XS&#160;−Γx<br/>
where&#160;here&#160;and&#160;throughout&#160;E0&#160;denotes&#160;the&#160;trivial&#160;G-torsor.<br/>
We&#160;have&#160;a&#160;map<br/>
π&#160;:&#160;GrG&#160;→&#160;X<br/>
sending&#160;(x,&#160;E,&#160;β)&#160;7→&#160;x.<br/>
Example&#160;4.3.&#160;Let&#160;Gx&#160;=&#160;G|D&#160;.&#160;Then<br/>
x<br/>
GrG&#160;|x&#160;:=&#160;π−1(x)&#160;∼<br/>
=&#160;GrGx<br/>
is&#160;the&#160;usual&#160;affine&#160;Grassmannian&#160;for&#160;Gx.&#160;On&#160;the&#160;other&#160;hand&#160;if&#160;G|D&#160;is&#160;an&#160;Iwahori&#160;group&#160;scheme,&#160;then<br/>
x<br/>
Gr<br/>
∼<br/>
G,x&#160;=&#160;FlG<br/>
is&#160;the&#160;usual&#160;affine&#160;flag&#160;variety.<br/>
x<br/>
4.1.2.&#160;Arc&#160;and&#160;loop&#160;groups.&#160;We&#160;now&#160;give&#160;a&#160;different&#160;perspective&#160;on&#160;BunG&#160;in&#160;terms&#160;of&#160;“loop&#160;groups”.&#160;(The<br/>objects&#160;introduced&#160;here&#160;will&#160;also&#160;be&#160;important&#160;later.)<br/>
Let&#160;BunG,∞Γ&#160;be&#160;the&#160;moduli&#160;stack&#160;of&#160;G-bundles&#160;with&#160;“infinite&#160;level&#160;structure”,&#160;i.e.<br/>
<br/>
<br/>
<br/>
x&#160;∈&#160;X(S)<br/>
<br/>
BunG,∞Γ&#160;:&#160;S&#160;7→<br/>
(x,&#160;E,&#160;ψ)&#160;:<br/>
E&#160;∈&#160;BunG(S)<br/>
<br/>
ψ&#160;:&#160;E|<br/>
∼<br/>
<br/>
b<br/>
−<br/>
→&#160;E0|<br/>
Γ<br/>
b<br/>
x<br/>
Γx<br/>
where&#160;b<br/>
Γx&#160;is&#160;the&#160;completion&#160;of&#160;X&#160;×&#160;S&#160;along&#160;Γx.&#160;One&#160;can&#160;also&#160;think&#160;of&#160;ψ&#160;as&#160;a&#160;compatible&#160;family&#160;of&#160;level<br/>
structures&#160;over&#160;nΓx&#160;as&#160;n&#160;→&#160;∞.&#160;We&#160;set&#160;b<br/>
Γ◦x&#160;:=&#160;b<br/>
Γx&#160;−&#160;Γx&#160;(the&#160;meaning&#160;is&#160;as&#160;in&#160;<a href="1711.02243s.html#40">[Laf12]&#160;</a>Notation&#160;1.7).<br/>
Let&#160;L+G&#160;be&#160;the&#160;global&#160;“arc&#160;group”,&#160;defined&#160;by<br/>
<br/>
x&#160;∈&#160;X(S)<br/>
L+G&#160;:&#160;S&#160;7→<br/>
(x,&#160;β)&#160;:<br/>
.<br/>
β&#160;∈&#160;G(b<br/>
Γx)<br/>
Let&#160;LG&#160;be&#160;the&#160;“loop&#160;group”<br/>
<br/>
<br/>
x&#160;∈&#160;X(S)<br/>
LG&#160;:&#160;S&#160;7→<br/>
(x,&#160;β)&#160;:<br/>
.<br/>
β&#160;∈&#160;G(b<br/>
Γ◦x)<br/>
Remark&#160;4.4.&#160;There&#160;is&#160;an&#160;action&#160;of&#160;L+G&#160;on&#160;GrG&#160;by&#160;changing&#160;the&#160;level&#160;structure&#160;ψ.<br/>
3For&#160;the&#160;fact&#160;that&#160;this&#160;is&#160;really&#160;an&#160;Artin&#160;stack&#160;in&#160;the&#160;generality&#160;required&#160;here,&#160;see&#160;<a href="1711.02243s.html#39">[Bro13]</a>.&#160;We&#160;thank&#160;Brian&#160;Conrad&#160;for<br/>
bringing&#160;this&#160;reference&#160;to&#160;our&#160;attention.<br/>
<hr/>
<a name=10></a><img class="yflip" src="html/1711.02243-10_1.png"/><br/>
<img class="yflip" src="html/1711.02243-10_2.png"/><br/>
10<br/>
TONY&#160;FENG<br/>
4.1.3.&#160;Global&#160;Schubert&#160;varieties.&#160;Let&#160;T&#160;⊂&#160;G&#160;be&#160;a&#160;maximal&#160;torus.&#160;In&#160;<a href="1711.02243s.html#40">[Ric16]&#160;</a>§2&#160;(generalizing&#160;work&#160;in&#160;the<br/>tamely&#160;ramified&#160;case&#160;of&#160;<a href="1711.02243s.html#40">[Zhu14]&#160;</a>§3.3)&#160;it&#160;is&#160;shown&#160;how&#160;to&#160;associate&#160;to&#160;µ&#160;∈&#160;X∗(T&#160;)&#160;a&#160;global&#160;Schubert&#160;variety<br/>
F<br/>
Gr≤µ.&#160;Of&#160;course,&#160;this&#160;is&#160;well-known&#160;in&#160;the&#160;split&#160;case.<br/>
G<br/>
4.1.4.&#160;Geometric&#160;Satake.&#160;We&#160;fix&#160;some&#160;notation&#160;pertaining&#160;to&#160;the&#160;Geometric&#160;Satake&#160;correspondence&#160;(<a href="1711.02243s.html#40">[MV07]</a>).<br/>
Definition&#160;4.5.&#160;Given&#160;a&#160;finite-dimensional&#160;representation&#160;W&#160;of&#160;LG,&#160;we&#160;let&#160;SatGr&#160;(W&#160;)&#160;be&#160;the&#160;associated&#160;per-<br/>
G<br/>
verse&#160;sheaf&#160;on&#160;GrG&#160;furnished&#160;by&#160;Geometric&#160;Satake.&#160;Note&#160;that&#160;SatGr&#160;(W&#160;)&#160;is&#160;automatically&#160;L+G-equivariant.<br/>
G<br/>
(For&#160;a&#160;statement&#160;of&#160;Geometric&#160;Satake&#160;for&#160;non-constant&#160;groups,&#160;see&#160;<a href="1711.02243s.html#40">[Laf12]&#160;</a>Theorem&#160;12.16.)<br/>
If&#160;G&#160;is&#160;split&#160;then&#160;irreducible&#160;finite-dimensional&#160;representations&#160;W&#160;of&#160;LG&#160;=&#160;b<br/>
G&#160;are&#160;indexed&#160;by&#160;dominant<br/>
coweights&#160;µ&#160;∈&#160;X∗(T&#160;)+&#160;for&#160;a&#160;maximal&#160;split&#160;torus&#160;T&#160;⊂&#160;G,&#160;and&#160;we&#160;denote&#160;by&#160;SatGr&#160;(µ)&#160;:=&#160;Sat<br/>
(W<br/>
G<br/>
GrG<br/>
µ)&#160;the<br/>
corresponding&#160;perverse&#160;sheaf.<br/>
This&#160;is&#160;the&#160;primal&#160;source&#160;for&#160;constructing&#160;perverse&#160;sheaves&#160;on&#160;a&#160;plethora&#160;of&#160;objects,&#160;which&#160;will&#160;all&#160;be<br/>
denoted&#160;Sat...(W&#160;)&#160;or&#160;Sat...(µ).<br/>Remark&#160;4.6.&#160;The&#160;sheaves&#160;SatGr&#160;(W&#160;)&#160;are&#160;L+G-equivariant&#160;for&#160;the&#160;action&#160;of&#160;Remark&#160;<a href="1711.02243s.html#9">4.4.</a><br/>
G<br/>
4.2.&#160;Hecke&#160;stacks.<br/>
4.2.1.&#160;We&#160;now&#160;define&#160;objects&#160;that&#160;geometrize&#160;the&#160;Hecke&#160;operators.<br/>
Definition&#160;4.7.&#160;We&#160;define&#160;the&#160;Hecke&#160;stack&#160;HeckeG&#160;by&#160;the&#160;functor&#160;of&#160;points<br/>
<br/>
<br/>
<br/>
x&#160;∈&#160;X(S)<br/>
<br/>
HeckeG&#160;:&#160;S&#160;7→<br/>
(x,&#160;E,&#160;E′,&#160;,&#160;ϕ)&#160;:<br/>
E,&#160;E′&#160;∈&#160;Bun<br/>
.<br/>
<br/>
G&#160;(S)<br/>
<br/>
ϕ&#160;:&#160;E′|<br/>
∼<br/>
X×S−Γ<br/>
−<br/>
→&#160;E|<br/>
x<br/>
X×S−Γx<br/>
We&#160;have&#160;structure&#160;maps<br/>
HeckeG<br/>
h←<br/>
z<br/>✉✉✉✉✉✉✉✉✉<br/>
h→<br/>
$<br/>
■<br/>
■<br/>
■<br/>
■<br/>
■<br/>
■<br/>
■<br/>
■<br/>
■<br/>
π<br/>
<br/>
BunG<br/>
X<br/>
BunG<br/>
where&#160;the&#160;map&#160;h←&#160;takes&#160;(E,&#160;E′)&#160;7→&#160;E,&#160;and&#160;the&#160;map&#160;h→&#160;takes&#160;(E,&#160;E′)&#160;7→&#160;E′.<br/>
One&#160;can&#160;think&#160;of&#160;the&#160;HeckeG&#160;as&#160;looking&#160;locally,&#160;in&#160;the&#160;smooth&#160;topology,&#160;like&#160;BunG&#160;×X&#160;GrG.&#160;To&#160;make&#160;this<br/>
precise,&#160;recall&#160;that&#160;there&#160;is&#160;an&#160;action&#160;of&#160;L+G&#160;on&#160;BunG,∞Γ,&#160;by&#160;changing&#160;the&#160;level&#160;structure.<br/>Proposition&#160;4.8.&#160;There&#160;is&#160;an&#160;isomorphism<br/>
ξ&#160;:&#160;Hecke<br/>
∼<br/>
G&#160;−<br/>
→&#160;(GrG&#160;×X&#160;BunG,∞Γ)/L+G<br/>
where&#160;the&#160;quotient&#160;is&#160;for&#160;the&#160;diagonal&#160;action&#160;of&#160;L+G.<br/>
This&#160;is&#160;actually&#160;taken&#160;as&#160;the&#160;definition&#160;of&#160;the&#160;Hecke&#160;stack&#160;in&#160;<a href="1711.02243s.html#40">[Laf12]&#160;</a>§12.3.1.&#160;Although&#160;it&#160;is&#160;well-known<br/>
we&#160;have&#160;not&#160;found&#160;the&#160;statement&#160;formulated&#160;in&#160;quite&#160;this&#160;way,&#160;so&#160;we&#160;give&#160;a&#160;proof&#160;for&#160;completeness.<br/>
Proof.&#160;Giving&#160;an&#160;isomorphism&#160;Hecke<br/>
∼<br/>
G&#160;−<br/>
→&#160;(GrG&#160;×X&#160;BunG,∞Γ)/L+G&#160;is&#160;equivalent&#160;to&#160;giving&#160;an&#160;L+G-equivariant<br/>
isomorphism&#160;from&#160;an&#160;L+G-torsor&#160;over&#160;HeckeG&#160;to&#160;GrG&#160;×X&#160;BunG,∞Γ,&#160;so&#160;we&#160;will&#160;construct&#160;the&#160;latter.<br/>
Let&#160;^<br/>
HeckeG&#160;→&#160;HeckeG&#160;be&#160;the&#160;L+G-torsor&#160;representing&#160;(x,&#160;ϕ:&#160;E′&#160;99K&#160;E)&#160;∈&#160;HeckeG&#160;plus&#160;a&#160;choice&#160;of&#160;trivial-<br/>
ization&#160;ψ&#160;:&#160;E|<br/>
∼<br/>
b<br/>
=&#160;E0|&#160;.<br/>
Γ<br/>
b<br/>
x<br/>
Γx<br/>
There&#160;is&#160;a&#160;map<br/>
^<br/>
HeckeG&#160;→&#160;GrG&#160;×XI&#160;BunG,∞Γ<br/>
sending<br/>
(x,&#160;ϕ&#160;:&#160;E′&#160;99K&#160;E,&#160;ψ)&#160;7→&#160;(x,&#160;E′,&#160;ψ&#160;◦&#160;ϕ),&#160;(x,&#160;E,&#160;ψ)<br/>
where&#160;we&#160;have&#160;implicitly&#160;used&#160;the&#160;Beauville-Laszlo&#160;theorem&#160;(<a href="1711.02243s.html#40">[Zhu14]</a>,&#160;Lemma&#160;3.1)&#160;to&#160;extend&#160;ϕ&#160;◦&#160;ψ,&#160;which<br/>is&#160;a&#160;priori&#160;only&#160;defined&#160;on&#160;b<br/>
Γ◦x,&#160;to&#160;X&#160;−&#160;Γx.&#160;It&#160;is&#160;easily&#160;checked&#160;that&#160;this&#160;is&#160;an&#160;isomorphism,&#160;by&#160;defining&#160;an<br/>
inverse&#160;directly,&#160;and&#160;that&#160;is&#160;L+G-equivariant.<br/>
<br/>
Remark&#160;4.9.&#160;In&#160;practice,&#160;we&#160;can&#160;always&#160;translate&#160;these&#160;statements&#160;into&#160;ones&#160;about&#160;finite&#160;type&#160;Artin&#160;stacks,<br/>by&#160;bounding&#160;the&#160;type&#160;of&#160;the&#160;modification.&#160;On&#160;any&#160;finite&#160;type&#160;substack&#160;the&#160;action&#160;of&#160;L+G&#160;factors&#160;through&#160;a<br/>finite&#160;étale&#160;quotient.<br/>
<hr/>
<a name=11></a><img class="yflip" src="html/1711.02243-11_1.png"/><br/>
<img class="yflip" src="html/1711.02243-11_2.png"/><br/>
<img class="yflip" src="html/1711.02243-11_3.png"/><br/>
NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,&#160;AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
11<br/>
4.2.2.&#160;Geometric&#160;Satake&#160;for&#160;Hecke.<br/>
Definition&#160;4.10.&#160;We&#160;define&#160;a&#160;functor<br/>
SatHecke&#160;:&#160;Rep<br/>
G<br/>
LG&#160;→&#160;Perv(HeckeG&#160;)<br/>
as&#160;follows.&#160;If&#160;W&#160;∈&#160;RepLG,&#160;then<br/>
SatGr&#160;(W&#160;)&#160;⊠&#160;Q<br/>
∈&#160;Db<br/>
G<br/>
ℓ,BunG,∞Γ<br/>
c&#160;(GrG&#160;×X&#160;BunG,∞Γ)<br/>
descends&#160;to&#160;the&#160;quotient&#160;by&#160;L+G&#160;by&#160;the&#160;fact&#160;that&#160;SatGr&#160;(W&#160;)&#160;is&#160;L+G-equivariant.&#160;We&#160;set&#160;Sat<br/>
(W&#160;)&#160;to<br/>
G<br/>
HeckeG<br/>
be&#160;the&#160;pullback&#160;of&#160;this&#160;descent&#160;via&#160;the&#160;isomorphism&#160;ξ∗&#160;from&#160;Proposition&#160;<a href="1711.02243s.html#10">4.8.</a><br/>
4.2.3.&#160;Hecke&#160;stacks&#160;with&#160;bounded&#160;modification.&#160;For&#160;µ&#160;∈&#160;X∗(T&#160;)&#160;we&#160;define&#160;Heckeµ&#160;as&#160;follows.&#160;First,&#160;we&#160;have<br/>
F<br/>
G<br/>
the&#160;Schubert&#160;variety&#160;Gr≤µ&#160;→&#160;Gr<br/>
G<br/>
G&#160;,&#160;which&#160;has&#160;an&#160;L+G-action.&#160;This&#160;induces&#160;a&#160;substack&#160;of&#160;(GrG&#160;×X&#160;BunG,∞Γ)/L+G,<br/>
and&#160;we&#160;define&#160;Heckeµ&#160;to&#160;be&#160;the&#160;pullback&#160;via&#160;ξ∗&#160;of&#160;Proposition&#160;<a href="1711.02243s.html#10">4.8.</a><br/>
G<br/>
If&#160;G&#160;=&#160;G×X&#160;is&#160;constant&#160;and&#160;split&#160;over&#160;X,&#160;then&#160;Hecke≤µ&#160;admits&#160;a&#160;very&#160;concrete&#160;definition&#160;as&#160;“modifications<br/>
G<br/>
of&#160;G-bundles&#160;with&#160;invariant&#160;bounded&#160;by&#160;µ”.&#160;In&#160;<a href="1711.02243s.html#13">§4.5&#160;</a>we&#160;explicate&#160;this&#160;for&#160;GLn-bundles,&#160;which&#160;may&#160;be&#160;an<br/>enlightening&#160;example.<br/>
4.3.&#160;Shtukas.<br/>
4.3.1.&#160;We&#160;now&#160;define&#160;the&#160;moduli&#160;stack&#160;of&#160;G-shtukas.&#160;At&#160;places&#160;x&#160;∈&#160;X&#160;where&#160;G|D&#160;is&#160;a&#160;parahoric&#160;group<br/>
x<br/>
scheme,&#160;this&#160;should&#160;be&#160;thought&#160;of&#160;as&#160;an&#160;“integral&#160;model”&#160;of&#160;the&#160;usual&#160;moduli&#160;stacks&#160;in&#160;which&#160;the&#160;legs&#160;are<br/>demanded&#160;to&#160;be&#160;disjoint&#160;from&#160;the&#160;level&#160;structure.<br/>
Definition&#160;4.11.&#160;We&#160;define&#160;the&#160;moduli&#160;stack&#160;of&#160;G-shtukas&#160;by&#160;the&#160;following&#160;cartesian&#160;diagram<br/>
ShtG<br/>
BunG<br/>
Id&#160;×&#160;Frob<br/>
Hecke&#160;h←×h→<br/>
G<br/>
BunG&#160;×&#160;BunG<br/>
More&#160;explicitly,&#160;ShtG&#160;represents&#160;the&#160;following&#160;moduli&#160;problem:<br/>
<br/>
<br/>
<br/>
x&#160;∈&#160;X(S)<br/>
<br/>
ShtG&#160;:&#160;S&#160;7→<br/>
(x,&#160;E,&#160;ϕ)&#160;:<br/>
E&#160;∈&#160;Bun<br/>
<br/>
G&#160;(S)<br/>
<br/>
ϕ&#160;:&#160;σE|<br/>
∼<br/>
X×S−Γ<br/>
−<br/>
→&#160;E|<br/>
x<br/>
X×S−Γx<br/>
where&#160;σ&#160;is&#160;the&#160;Frobenius&#160;on&#160;the&#160;S&#160;factor&#160;in&#160;X&#160;×&#160;S,&#160;and&#160;σE&#160;is&#160;the&#160;pullback&#160;of&#160;E&#160;under&#160;the&#160;map&#160;1&#160;×&#160;σ&#160;:&#160;X&#160;×&#160;S&#160;→<br/>X&#160;×&#160;S.<br/>
We&#160;have&#160;an&#160;evident&#160;map<br/>
π&#160;:&#160;ShtG&#160;→&#160;X<br/>
sending&#160;(x,&#160;E,&#160;E′,&#160;ϕ)&#160;7→&#160;x.<br/>
4.3.2.&#160;Perverse&#160;sheaves&#160;on&#160;shtukas.&#160;From&#160;Definition&#160;<a href="1711.02243s.html#11">4.11&#160;</a>we&#160;have&#160;a&#160;tautological&#160;map<br/>
ι&#160;:&#160;ShtG&#160;→&#160;HeckeG&#160;.<br/>
Definition&#160;4.12.&#160;For&#160;W&#160;∈&#160;Rep(LG),&#160;we&#160;define&#160;SatSht&#160;(W&#160;)&#160;to&#160;be&#160;ι∗(Sat<br/>
(W&#160;))&#160;shifted&#160;to&#160;be&#160;perverse<br/>
G<br/>
HeckeG<br/>
along&#160;the&#160;fibers&#160;of&#160;π&#160;:&#160;ShtG&#160;→&#160;X.&#160;This&#160;is&#160;a&#160;perverse&#160;sheaf&#160;up&#160;to&#160;shift&#160;on&#160;ShtG.<br/>
4.3.3.&#160;Schubert&#160;varieties&#160;of&#160;shtukas.&#160;For&#160;µ&#160;∈&#160;X∗(&#160;b<br/>
T&#160;),&#160;we&#160;define&#160;Sht≤µ&#160;=&#160;ι∗&#160;Hecke≤µ.&#160;This&#160;is&#160;a&#160;closed<br/>
F<br/>
G<br/>
G<br/>
substack&#160;of&#160;ShtG&#160;which&#160;is&#160;the&#160;support&#160;of&#160;SatSht&#160;(µ)&#160;We&#160;call&#160;these&#160;“Schubert&#160;varieties&#160;of&#160;shtukas”&#160;even&#160;though<br/>
G<br/>
they&#160;are,&#160;of&#160;course,&#160;not&#160;varieties&#160;but&#160;(Deligne-Mumford)&#160;stacks.<br/>
<hr/>
<a name=12></a><img class="yflip" src="html/1711.02243-12_1.png"/><br/>
<img class="yflip" src="html/1711.02243-12_2.png"/><br/>
12<br/>
TONY&#160;FENG<br/>
4.3.4.&#160;Hecke&#160;operators&#160;on&#160;shtukas.&#160;There&#160;are&#160;Hecke&#160;correspondences&#160;of&#160;shtukas&#160;that&#160;induce&#160;Hecke&#160;operators<br/>on&#160;ShtG,&#160;hence&#160;on&#160;their&#160;cohomology.<br/>
Definition&#160;4.13.&#160;We&#160;define&#160;Hecke(ShtG)&#160;to&#160;be&#160;the&#160;moduli&#160;stack&#160;parametrizing&#160;x,&#160;y&#160;∈&#160;X(S)&#160;along&#160;with&#160;a<br/>diagram<br/>
σ&#160;E<br/>
x<br/>
E<br/>
σ(β)&#160;σ(y)<br/>
β&#160;y<br/>
σ&#160;E′<br/>
x<br/>
E′<br/>
Here&#160;we&#160;note:<br/>
•&#160;E&#160;and&#160;E′&#160;are&#160;G-torsors&#160;on&#160;X&#160;×&#160;S,&#160;and&#160;σE&#160;and&#160;σE′&#160;are&#160;their&#160;twists&#160;by&#160;1&#160;×&#160;σ.<br/>•&#160;The&#160;x&#160;above&#160;the&#160;horizontal&#160;arrows&#160;mean&#160;an&#160;isomorphism&#160;on&#160;the&#160;complement&#160;of&#160;Γx.<br/>•&#160;The&#160;y&#160;(resp.&#160;σ(y))&#160;next&#160;to&#160;the&#160;vertical&#160;arrows&#160;means&#160;an&#160;isomorphism&#160;on&#160;the&#160;complement&#160;of&#160;Γy&#160;(resp.<br/>
Γσ(y)).<br/>
•&#160;The&#160;map&#160;σ(β)&#160;is&#160;the&#160;twist&#160;of&#160;β.&#160;We&#160;emphasize&#160;that&#160;it&#160;is&#160;determined&#160;by&#160;β,&#160;rather&#160;than&#160;being&#160;an<br/>
additional&#160;datum.<br/>
We&#160;evidently&#160;have&#160;a&#160;diagram<br/>
Hecke(ShtG)<br/>
HeckeG<br/>
π2<br/>
π<br/>
X<br/>
where&#160;the&#160;horizontal&#160;arrow&#160;sends&#160;this&#160;data&#160;to&#160;(y,&#160;E,&#160;E′,&#160;β),&#160;which&#160;allows&#160;us&#160;to&#160;define&#160;Hecke(ShtG)≤µ&#160;for<br/>µ&#160;∈&#160;X∗(T&#160;),&#160;and&#160;Sat<br/>
F<br/>
Hecke(ShtG&#160;)(W&#160;)&#160;for&#160;W&#160;∈&#160;Rep(LG).<br/>
We&#160;also&#160;evidently&#160;have&#160;a&#160;diagram<br/>
Hecke(ShtG)<br/>
h←<br/>
h→<br/>
ShtG<br/>
ShtG<br/>
where&#160;the&#160;arrows&#160;h←&#160;and&#160;h→&#160;send&#160;this&#160;data&#160;to&#160;(x,&#160;σE&#160;99K&#160;E)&#160;and&#160;(x,&#160;σE′&#160;99K&#160;E′)&#160;respectively.&#160;For&#160;v&#160;∈&#160;X,&#160;let<br/>
Hecke(ShtG)≤µ<br/>
v<br/>
:=&#160;π−1<br/>
2<br/>
(v).<br/>
A&#160;choice&#160;of&#160;v&#160;∈&#160;X&#160;and&#160;µ&#160;∈&#160;X∗(T&#160;)&#160;induces&#160;a&#160;correspondence<br/>
F<br/>
Hecke(ShtG)≤µ<br/>
v<br/>
h←<br/>
h→<br/>
Sht<br/>
(4.1)<br/>
G<br/>
ShtG<br/>
π<br/>
π<br/>
X<br/>
which&#160;is&#160;the&#160;analogue&#160;of&#160;the&#160;classical&#160;Hecke&#160;correspondences.<br/>
Definition&#160;4.14.&#160;Since&#160;π&#160;◦&#160;h←&#160;=&#160;π&#160;◦&#160;h→&#160;and&#160;h←∗(SatSht&#160;(W&#160;))&#160;∼<br/>
=&#160;h→∗(Sat<br/>
(W&#160;)),&#160;from&#160;Hecke(Sht<br/>
G<br/>
ShtG<br/>
G&#160;)≤µ<br/>
v<br/>
we&#160;get&#160;a&#160;corresponding&#160;Hecke&#160;operator&#160;on&#160;Rπ!&#160;SatSht&#160;(W&#160;)&#160;∈&#160;Db<br/>
G<br/>
c(X&#160;).<br/>
4.4.&#160;Iterated&#160;shtukas&#160;and&#160;factorization.&#160;This&#160;entire&#160;discussion&#160;carries&#160;through&#160;to&#160;“iterated”&#160;versions&#160;of<br/>GrG,&#160;HeckeG&#160;and&#160;ShtG.&#160;We&#160;will&#160;content&#160;ourselves&#160;with&#160;stating&#160;the&#160;essentials,&#160;leaving&#160;the&#160;reader&#160;to&#160;generalize<br/>the&#160;preceding&#160;discussion.&#160;(A&#160;reference&#160;is&#160;<a href="1711.02243s.html#40">[Laf12]&#160;</a>§1,2.)<br/>
<hr/>
<a name=13></a><img class="yflip" src="html/1711.02243-13_1.png"/><br/>
<img class="yflip" src="html/1711.02243-13_2.png"/><br/>
<img class="yflip" src="html/1711.02243-13_3.png"/><br/>
<img class="yflip" src="html/1711.02243-13_4.png"/><br/>
<img class="yflip" src="html/1711.02243-13_5.png"/><br/>
NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,&#160;AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
13<br/>
4.4.1.&#160;Iterated&#160;affine&#160;Grassmannian.&#160;The&#160;iterated&#160;global&#160;affine&#160;Grassmannian<br/>
π&#160;:&#160;GrG&#160;e<br/>
×&#160;GrG&#160;→&#160;X2<br/>
is&#160;defined&#160;by&#160;the&#160;functor&#160;of&#160;points<br/>
<br/>
<br/>
<br/>
x<br/>
<br/>
1,&#160;x2&#160;∈&#160;X&#160;(S)<br/>
<br/>
<br/>
<br/>
E<br/>
<br/>
1,&#160;E2&#160;∈&#160;BunG&#160;(S)<br/>
GrG&#160;e<br/>
×&#160;GrG&#160;:&#160;S&#160;7→<br/>
(x<br/>
∼<br/>
&#160;1,&#160;x2,&#160;E1,&#160;E2,&#160;ϕ,&#160;β):<br/>
<br/>
ϕ&#160;:&#160;E<br/>
−<br/>
→&#160;E<br/>
<br/>
<br/>
1|XS&#160;−Γx<br/>
2|X<br/>
1<br/>
S&#160;−Γx1&#160;<br/>
∼<br/>
<br/>
β&#160;:&#160;E2|X<br/>
−<br/>
→&#160;E0|<br/>
S&#160;−Γx<br/>
X<br/>
2<br/>
S&#160;−Γx2<br/>
We&#160;may&#160;denote&#160;GrG,Xr&#160;=&#160;GrG&#160;e<br/>
×&#160;.&#160;.&#160;.&#160;e<br/>
×&#160;GrG&#160;(r&#160;times),&#160;although&#160;the&#160;reader&#160;should&#160;be&#160;warned&#160;that&#160;this<br/>
notation&#160;is&#160;sometimes&#160;used&#160;elsewhere&#160;in&#160;the&#160;literature&#160;to&#160;denote&#160;a&#160;different&#160;object.&#160;We&#160;also&#160;have&#160;Schubert<br/>cells:&#160;given&#160;µ1,&#160;.&#160;.&#160;.&#160;,&#160;µr&#160;∈&#160;X∗(T&#160;),&#160;we&#160;can&#160;define&#160;Gr≤(µ1,...,µr)<br/>
F<br/>
G,Xr<br/>
in&#160;a&#160;way&#160;that&#160;is&#160;by&#160;now&#160;obvious.<br/>
4.4.2.&#160;Iterated&#160;shtukas.&#160;We&#160;now&#160;define&#160;the&#160;iterated&#160;shtukas.<br/>
Definition&#160;4.15.&#160;We&#160;define&#160;the&#160;moduli&#160;stack&#160;ShtG,Xr&#160;by&#160;the&#160;functor&#160;of&#160;points:<br/>
<br/>
<br/>
<br/>
x1,&#160;.&#160;.&#160;.&#160;,&#160;xr&#160;∈&#160;X(S)<br/>
<br/>
∼<br/>
ShtG,Xr&#160;:&#160;S&#160;7→<br/>
E0,&#160;E1,&#160;.&#160;.&#160;.&#160;,&#160;Er&#160;−→&#160;σE0&#160;∈&#160;BunG(S)<br/>
<br/>
<br/>
ϕ<br/>
∼<br/>
i&#160;:&#160;Ei|X×S−Γ<br/>
−<br/>
→&#160;E<br/>
x<br/>
i+1|X×S−Γ<br/>
i+1<br/>
xi+1<br/>
Remark&#160;4.16.&#160;The&#160;stack&#160;of&#160;iterated&#160;shtukas&#160;ShtG,Xr&#160;can&#160;also&#160;be&#160;defined&#160;as&#160;a&#160;repeated&#160;fibered&#160;product&#160;of<br/>ShtG&#160;over&#160;BunG,&#160;which&#160;is&#160;more&#160;analogous&#160;to&#160;how&#160;we&#160;defined&#160;ShtG.<br/>
We&#160;have&#160;an&#160;evident&#160;map<br/>
π&#160;:&#160;ShtG,Xr&#160;→&#160;Xr<br/>
projecting&#160;to&#160;the&#160;datum&#160;of&#160;(x1,&#160;.&#160;.&#160;.&#160;,&#160;xr).<br/>
We&#160;can&#160;similarly&#160;define&#160;HeckeG,Xr&#160;and&#160;Hecke(ShtG,Xr&#160;).&#160;For&#160;a&#160;tuple&#160;W1,&#160;.&#160;.&#160;.&#160;,&#160;Wr&#160;∈&#160;Rep(LG)&#160;we&#160;can&#160;define<br/>
a&#160;shifted&#160;perverse&#160;sheaf&#160;SatSht<br/>
(W<br/>
G,Xr<br/>
1,&#160;.&#160;.&#160;.&#160;,&#160;Wr&#160;)&#160;using&#160;Geometric&#160;Satake.<br/>
We&#160;also&#160;have&#160;Schubert&#160;cells&#160;for&#160;ShtG,Xr&#160;:&#160;given&#160;µ1,&#160;.&#160;.&#160;.&#160;,&#160;µr&#160;∈&#160;X∗(&#160;b<br/>
T&#160;),&#160;we&#160;can&#160;define&#160;Sht≤(µ1,...,µr)<br/>
F<br/>
G,Xr<br/>
in&#160;a&#160;way<br/>
that&#160;is&#160;by&#160;now&#160;obvious.<br/>
4.5.&#160;D-shtukas.&#160;As&#160;explained&#160;in&#160;<a href="1711.02243s.html#6">§2.2,&#160;</a>one&#160;difficulty&#160;with&#160;ShtG&#160;is&#160;that&#160;it&#160;is&#160;of&#160;infinite&#160;type&#160;in&#160;general.&#160;To<br/>study&#160;the&#160;fundamental&#160;lemma&#160;for&#160;GLn,&#160;we&#160;can&#160;globalize&#160;to&#160;a&#160;division&#160;algebra&#160;instead&#160;of&#160;the&#160;constant&#160;group<br/>GLn,&#160;which&#160;gives&#160;us&#160;a&#160;proper&#160;moduli&#160;problem.&#160;We&#160;now&#160;explain&#160;the&#160;salient&#160;facts&#160;about&#160;this&#160;special&#160;case.<br/>Since&#160;the&#160;literature&#160;already&#160;contains&#160;several&#160;excellent&#160;expositions&#160;of&#160;the&#160;theory&#160;of&#160;D-shtukas,&#160;we&#160;will&#160;content<br/>ourselves&#160;with&#160;a&#160;brief&#160;summary.&#160;A&#160;reference&#160;for&#160;everything&#160;here&#160;is&#160;<a href="1711.02243s.html#40">[Ngo06]&#160;</a>§1;&#160;see&#160;<a href="1711.02243s.html#40">[Laf97]&#160;</a>or&#160;<a href="1711.02243s.html#40">[Lau04]&#160;</a>for&#160;more<br/>extensive&#160;treatments.<br/>
Let&#160;D&#160;be&#160;a&#160;division&#160;algebra&#160;F&#160;of&#160;dimension&#160;n2,&#160;ramified&#160;over&#160;a&#160;(necessarily&#160;finite)&#160;set&#160;of&#160;points&#160;Z&#160;⊂&#160;X.<br/>
We&#160;assume&#160;that&#160;our&#160;fixed&#160;(rational)&#160;point&#160;x<br/>
∼<br/>
0&#160;/<br/>
∈&#160;Z,&#160;so&#160;Dx&#160;:=&#160;D&#160;⊗<br/>
=&#160;gl<br/>
).&#160;Later&#160;we&#160;will&#160;need&#160;to<br/>
0<br/>
F&#160;Fx0<br/>
n(Fx0<br/>
assume&#160;that&#160;#Z&#160;is&#160;sufficiently&#160;large.<br/>
We&#160;extend&#160;D&#160;to&#160;an&#160;OX-algebra&#160;D&#160;such&#160;that&#160;Dx&#160;is&#160;a&#160;maximal&#160;order&#160;in&#160;Dx&#160;for&#160;all&#160;x,&#160;and&#160;we&#160;let&#160;G&#160;→&#160;X<br/>
be&#160;the&#160;associated&#160;group&#160;scheme&#160;of&#160;units.&#160;Let&#160;G&#160;→&#160;X&#160;be&#160;a&#160;corresponding&#160;parahoric&#160;group&#160;scheme;&#160;we&#160;will&#160;be<br/>most&#160;interested&#160;in&#160;the&#160;case&#160;where&#160;G&#160;is&#160;not&#160;hyperspecial&#160;at&#160;x0.<br/>
4.5.1.&#160;Modification&#160;types.&#160;Let&#160;T&#160;⊂&#160;GLn&#160;be&#160;the&#160;standard&#160;maximal&#160;torus.&#160;The&#160;dominant&#160;coweights&#160;are<br/>
X<br/>
∼<br/>
∗(T&#160;)+&#160;=&#160;Zn<br/>
+&#160;:=&#160;{µ&#160;=&#160;(µ1,&#160;.&#160;.&#160;.&#160;,&#160;µn)&#160;:&#160;µ1&#160;≥&#160;µ2&#160;≥&#160;.&#160;.&#160;.&#160;µn}.<br/>
The&#160;relative&#160;position&#160;of&#160;lattices&#160;in&#160;k[[t]]n&#160;is&#160;a&#160;µ&#160;∈&#160;X∗(T&#160;)+&#160;determined&#160;by&#160;the&#160;Cartan&#160;decomposition<br/>
[<br/>
GLn(k((t)))&#160;=<br/>
GLn(k[[t]])tµ&#160;GLn(k[[t]]).<br/>
µ∈X∗(T&#160;)+<br/>
Let&#160;X◦&#160;:=&#160;X&#160;−Z&#160;−{x<br/>
∼<br/>
0}.&#160;For&#160;x&#160;∈&#160;X&#160;◦,&#160;a&#160;modification&#160;of&#160;G-bundles&#160;outside&#160;x&#160;is&#160;an&#160;isomorphism&#160;ϕ&#160;:&#160;E&#160;′|X◦−x&#160;−<br/>
→<br/>
⊕n<br/>
E|X◦−x.&#160;We&#160;can&#160;view&#160;E′|<br/>
and&#160;E|<br/>
as&#160;two&#160;lattices&#160;in&#160;F<br/>
Spec&#160;F&#160;x<br/>
Spec&#160;F&#160;x<br/>
x<br/>
by&#160;using&#160;ϕ&#160;⊗&#160;Fx&#160;to&#160;identify&#160;their&#160;generic<br/>
fibers.&#160;The&#160;relative&#160;position&#160;µ&#160;of&#160;these&#160;two&#160;lattices&#160;will&#160;be&#160;called&#160;the&#160;modification&#160;type&#160;of&#160;ϕ.<br/>
<hr/>
<a name=14></a>14<br/>
TONY&#160;FENG<br/>
4.5.2.&#160;The&#160;global&#160;affine&#160;Grassmannian.&#160;We&#160;can&#160;interpret&#160;Gr≤µ&#160;|<br/>
G<br/>
X◦&#160;as&#160;the&#160;substack&#160;of&#160;GrG&#160;|X◦&#160;parametrizing<br/>
β&#160;:&#160;E|<br/>
∼<br/>
X<br/>
=&#160;E0|<br/>
S&#160;−Γx<br/>
XS&#160;−Γx<br/>
such&#160;that&#160;for&#160;each&#160;geometric&#160;point&#160;of&#160;S,&#160;the&#160;modification&#160;type&#160;of&#160;β&#160;is&#160;≤&#160;µ.&#160;The&#160;sheaf&#160;SatGr&#160;(µ)&#160;is&#160;the&#160;IC<br/>
G<br/>
sheaf&#160;of&#160;Gr≤µ,&#160;i.e.&#160;the&#160;middle&#160;extension&#160;of&#160;the&#160;constant&#160;sheaf&#160;on&#160;the&#160;open&#160;cell.<br/>
G<br/>
Proposition&#160;4.17.&#160;The&#160;sheaf&#160;SatGr&#160;(µ)&#160;is&#160;universally&#160;locally&#160;acyclic&#160;with&#160;respect&#160;to&#160;the&#160;morphism&#160;Gr<br/>
G<br/>
G&#160;|X◦&#160;→<br/>
X◦.<br/>
Proof.&#160;This&#160;is&#160;<a href="1711.02243s.html#40">[Ngo06]&#160;</a>§1.1&#160;Corollaire&#160;6.&#160;Note&#160;that&#160;Ngô’s&#160;formulation&#160;is&#160;slightly&#160;different,&#160;but&#160;is&#160;actually<br/>deduced&#160;from&#160;the&#160;version&#160;that&#160;we&#160;state,&#160;which&#160;is&#160;the&#160;usual&#160;formulation&#160;in&#160;Geometric&#160;Satake.<br/>
<br/>
4.5.3.&#160;The&#160;Hecke&#160;stack.&#160;The&#160;Hecke&#160;stack&#160;Hecke≤µ&#160;|<br/>
G<br/>
X◦&#160;parametrizes&#160;modifications&#160;of&#160;G-torsors&#160;over&#160;X&#160;◦<br/>
(x,&#160;ϕ&#160;:&#160;E′|<br/>
∼<br/>
X×S−Γ<br/>
−<br/>
→&#160;E|<br/>
)<br/>
x<br/>
X×S−Γx<br/>
with&#160;modification&#160;type&#160;≤&#160;µ&#160;at&#160;all&#160;geometric&#160;points&#160;of&#160;S.<br/>
4.5.4.&#160;Shtukas&#160;and&#160;iterated&#160;shtukas.&#160;The&#160;moduli&#160;stack&#160;ShtG,(X−Z)r&#160;parametrizes<br/>
<br/>
<br/>
<br/>
x1,&#160;.&#160;.&#160;.&#160;,&#160;xr&#160;∈&#160;(X&#160;−&#160;Z)(S)<br/>
<br/>
E<br/>
∼<br/>
0,&#160;E1,&#160;.&#160;.&#160;.&#160;,&#160;Er&#160;=&#160;σ&#160;E0&#160;∈&#160;BunG&#160;(S)<br/>
ϕ<br/>
∼<br/>
<br/>
i&#160;:&#160;Ei|X×S−Γ<br/>
−<br/>
→&#160;E<br/>
x<br/>
i+1|X×S−Γ<br/>
i+1<br/>
xi+1<br/>
The&#160;Schubert&#160;“variety”&#160;Sht≤(µ1,...,µr)&#160;associated&#160;to&#160;(µ<br/>
G,(X−Z)r<br/>
1,&#160;.&#160;.&#160;.&#160;,&#160;µr&#160;)&#160;∈&#160;(X∗(T&#160;)+)r&#160;is&#160;the&#160;substack&#160;where&#160;the<br/>
modification&#160;type&#160;of&#160;ϕi&#160;is&#160;bounded&#160;by&#160;µi&#160;at&#160;all&#160;geometric&#160;points&#160;of&#160;S.&#160;For&#160;such&#160;a&#160;tuple&#160;we&#160;can&#160;also&#160;form<br/>SatSht<br/>
.<br/>
G&#160;,(X&#160;−Z)r&#160;(µ1&#160;,&#160;.&#160;.&#160;.&#160;,&#160;µr&#160;)&#160;on&#160;ShtG,(X&#160;−Z)r&#160;,&#160;which&#160;is&#160;perverse&#160;up&#160;to&#160;shift&#160;and&#160;supported&#160;on&#160;Sht≤(µ1,...,µr&#160;)<br/>
G,(X−Z)r<br/>
Proposition&#160;4.18.&#160;The&#160;(shifted)&#160;perverse&#160;sheaf&#160;SatShtG,(X−Z)r(µ1,&#160;.&#160;.&#160;.&#160;,&#160;µr)|(X◦)r&#160;is&#160;locally&#160;acylic&#160;with&#160;respect<br/>to&#160;the&#160;morphism&#160;π&#160;:&#160;SatShtG,(X−Z)r&#160;|(X◦)r&#160;→&#160;(X◦)r.<br/>
Proof.&#160;This&#160;<a href="1711.02243s.html#40">[Ngo06]&#160;</a>§1.4&#160;Corollaire&#160;2,&#160;but&#160;with&#160;the&#160;same&#160;remark&#160;as&#160;in&#160;the&#160;proof&#160;of&#160;Proposition&#160;<a href="1711.02243s.html#14">4.17.</a><br/>
<br/>
4.5.5.&#160;Global&#160;geometry.&#160;The&#160;stack&#160;ShtG&#160;has&#160;infinitely&#160;many&#160;connected&#160;components&#160;owing&#160;to&#160;the&#160;positive-<br/>dimensional&#160;center&#160;of&#160;G.&#160;We&#160;wish&#160;to&#160;and&#160;can&#160;rectify&#160;this&#160;in&#160;the&#160;usual&#160;way:&#160;let&#160;a&#160;∈&#160;A×&#160;be&#160;a&#160;non-trivial&#160;idele<br/>
F<br/>
of&#160;degree&#160;1,&#160;and&#160;let&#160;ShtG&#160;/aZ&#160;be&#160;the&#160;quotient&#160;obtained&#160;by&#160;formally&#160;adjoining&#160;an&#160;isomorphism&#160;E&#160;∼<br/>
=&#160;E&#160;⊗&#160;O(a).<br/>
Similarly&#160;define&#160;ShtG,(X−Z)r&#160;/aZ.&#160;We&#160;still&#160;have&#160;the&#160;map<br/>
π&#160;:&#160;ShtG,(X−Z)r&#160;/aZ&#160;→&#160;(X&#160;−&#160;Z)r<br/>
and&#160;the&#160;Geometric&#160;Satake&#160;sheaves&#160;descend&#160;to&#160;ShtG,(X−Z)r&#160;/aZ,&#160;which&#160;in&#160;an&#160;effort&#160;to&#160;curtail&#160;increasingly<br/>monstrous&#160;notation&#160;we&#160;continue&#160;to&#160;denote&#160;by&#160;SatSht<br/>
(µ<br/>
G,(X−Z)r<br/>
1,&#160;.&#160;.&#160;.&#160;,&#160;µr&#160;).&#160;Furthermore,&#160;we&#160;still&#160;have:<br/>
Proposition&#160;4.19&#160;(<a href="1711.02243s.html#40">[Ngo06]&#160;</a>§1.4&#160;Corollaire&#160;2).&#160;The&#160;shifted&#160;perverse&#160;sheaf&#160;SatShtG,(X−Z)r(µ1,&#160;.&#160;.&#160;.&#160;,&#160;µr)&#160;re-<br/>stricted&#160;to&#160;ShtG,(X◦)r&#160;/aZ&#160;is&#160;locally&#160;acyclic&#160;with&#160;respect&#160;to&#160;the&#160;map<br/>
π&#160;:&#160;ShtG,(X◦)r&#160;/aZ&#160;→&#160;(X◦)r.<br/>
We&#160;now&#160;prepare&#160;to&#160;state&#160;the&#160;properness&#160;result&#160;for&#160;the&#160;morphism&#160;ShtG,(X◦)r&#160;/aZ&#160;→&#160;(X◦)r.&#160;We&#160;can&#160;write<br/>
any&#160;µ&#160;∈&#160;X∗(T&#160;)+&#160;as<br/>
µ&#160;=&#160;µ+&#160;−&#160;µ−<br/>
where<br/>
µ+&#160;:=&#160;(µ+<br/>
1&#160;≥&#160;.&#160;.&#160;.&#160;≥&#160;µ+<br/>
r&#160;≥&#160;0)<br/>
µ−&#160;:=&#160;(0&#160;≥&#160;µ−<br/>
1&#160;≥&#160;.&#160;.&#160;.&#160;≥&#160;µ−<br/>
r&#160;)<br/>
We&#160;define<br/>
||µ||&#160;:=&#160;max(|µ+|,&#160;|µ−|).<br/>
<hr/>
<a name=15></a>NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,&#160;AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
15<br/>
Proposition&#160;4.20&#160;(<a href="1711.02243s.html#40">[Ngo06]&#160;</a>§1.6&#160;Proposition&#160;2).&#160;Let&#160;(µ1,&#160;.&#160;.&#160;.&#160;,&#160;µr)&#160;∈&#160;(X∗(T&#160;)+)r.&#160;Suppose&#160;that&#160;the&#160;locus&#160;Z&#160;of<br/>ramification&#160;points&#160;of&#160;D&#160;satisfies<br/>
#Z&#160;≥&#160;n2(||µ1||&#160;+&#160;.&#160;.&#160;.&#160;+&#160;||µr||).<br/>
Then&#160;the&#160;morphism<br/>
π◦&#160;:&#160;Sht≤(µ1,...,µr)&#160;/aZ&#160;→&#160;(X◦)r<br/>
G,(X◦)r<br/>
is&#160;proper.<br/>
We&#160;need&#160;to&#160;extend&#160;this&#160;result&#160;to&#160;our&#160;integral&#160;model&#160;X&#160;−&#160;Z&#160;=&#160;X◦&#160;∪&#160;{x0}.<br/>
Proposition&#160;4.21.&#160;Let&#160;(µ1,&#160;.&#160;.&#160;.&#160;,&#160;µr)&#160;∈&#160;(X∗(T&#160;)+)r.&#160;Suppose&#160;that&#160;the&#160;locus&#160;Z&#160;of&#160;ramification&#160;points&#160;of&#160;D<br/>satisfies<br/>
#Z&#160;≥&#160;n2(||µ1||&#160;+&#160;.&#160;.&#160;.&#160;+&#160;||µr||).<br/>
Then&#160;the&#160;morphism<br/>
π&#160;:&#160;Sht≤(µ1,...,µr)&#160;/aZ&#160;→&#160;(X&#160;−&#160;Z)r<br/>
G,(X−Z)r<br/>
is&#160;proper.<br/>
Proof.&#160;Let&#160;G&#160;be&#160;the&#160;group&#160;scheme&#160;isomorphic&#160;to&#160;G&#160;at&#160;places&#160;away&#160;from&#160;x0&#160;but&#160;hyperspecial&#160;at&#160;x0.&#160;Then<br/>Proposition&#160;<a href="1711.02243s.html#15">4.20&#160;</a>applied&#160;to&#160;ShtG&#160;shows&#160;that<br/>
π′&#160;:&#160;Sht≤(µ1,...,µr)&#160;/aZ&#160;→&#160;(X&#160;−&#160;Z)r<br/>
G,(X−Z)r<br/>
is&#160;proper.&#160;The&#160;map&#160;G&#160;→&#160;G&#160;induces&#160;a&#160;projection<br/>
pr&#160;:&#160;Sht≤(µ1,...,µr)&#160;/aZ&#160;→&#160;Sht≤(µ1,...,µr)&#160;/aZ<br/>
G,(X−Z)r<br/>
G,(X−Z)r<br/>
which&#160;we&#160;claim&#160;is&#160;proper.&#160;It&#160;obviously&#160;suffices&#160;to&#160;prove&#160;the&#160;claim.&#160;For&#160;that&#160;we&#160;consider&#160;the&#160;commutative<br/>diagram&#160;below,&#160;omitting&#160;some&#160;subscripts&#160;and&#160;superscripts,&#160;etc.&#160;for&#160;clarity&#160;of&#160;presentation.<br/>
ShtG<br/>
BunG<br/>
Id&#160;×&#160;Frob<br/>
Hecke&#160;h←×h→<br/>
G<br/>
BunG&#160;×&#160;BunG<br/>
ShtG<br/>
BunG<br/>
Id&#160;×&#160;Frob<br/>
Hecke<br/>
h←×h→<br/>
G<br/>
BunG&#160;×&#160;BunG<br/>
In&#160;this&#160;diagram&#160;the&#160;squares&#160;with&#160;solid&#160;arrows&#160;are&#160;cartesian.&#160;Let&#160;Hecke′G&#160;and&#160;Sht′G&#160;denote&#160;the&#160;fibered&#160;products<br/>
Hecke′&#160;h←×h→<br/>
G<br/>
BunG&#160;×&#160;BunG<br/>
Hecke&#160;h←×h→<br/>
G<br/>
BunG&#160;×&#160;BunG<br/>
and<br/>
Sht′G<br/>
BunG<br/>
Id&#160;×&#160;Frob&#160;.<br/>
Hecke′&#160;h←×h→<br/>
G<br/>
BunG&#160;×&#160;BunG<br/>
The&#160;map&#160;BunG&#160;→&#160;BunG&#160;is&#160;proper,&#160;hence&#160;so&#160;is&#160;pullback&#160;Hecke′G&#160;→→&#160;HeckeG.&#160;Since&#160;the&#160;map&#160;Hecke≤(µ1,...,µr)&#160;→<br/>
G<br/>
(Hecke′G)≤(µ1,...,µr)&#160;is&#160;proper,&#160;the&#160;map&#160;Sht≤(µ1,...,µr)&#160;→&#160;Sht′≤(µ1,...,µr)&#160;is&#160;also&#160;proper,&#160;hence&#160;so&#160;is&#160;the&#160;compo-<br/>
G<br/>
G<br/>
sition<br/>
≤(µ<br/>
≤(µ<br/>
Sht≤(µ1,...,µr)&#160;→&#160;(Sht′<br/>
1&#160;,...,µr&#160;)<br/>
pr<br/>
−→&#160;Sht<br/>
1&#160;,...,µr&#160;)<br/>
G<br/>
G&#160;)<br/>
G<br/>
.<br/>
<br/>
<hr/>
<a name=16></a><img class="yflip" src="html/1711.02243-16_1.png"/><br/>
<img class="yflip" src="html/1711.02243-16_2.png"/><br/>
<img class="yflip" src="html/1711.02243-16_3.png"/><br/>
<img class="yflip" src="html/1711.02243-16_4.png"/><br/>
16<br/>
TONY&#160;FENG<br/>
5.&#160;The&#160;Kottwitz&#160;Conjecture&#160;for&#160;shtukas<br/>
5.1.&#160;Parahoric&#160;Hecke&#160;algebras.&#160;Let&#160;G&#160;be&#160;a&#160;split&#160;reductive&#160;group&#160;over&#160;a&#160;non-archimedean&#160;local&#160;field&#160;Ft<br/>with&#160;uniformizer&#160;t.&#160;(The&#160;splitness&#160;assumption&#160;is&#160;not&#160;necessary,&#160;but&#160;is&#160;certainly&#160;adequate&#160;for&#160;our&#160;eventual<br/>purposes&#160;and&#160;simplifies&#160;the&#160;notation&#160;significantly.)<br/>
5.1.1.&#160;Spherical&#160;Hecke&#160;algebra.&#160;Let&#160;K&#160;be&#160;a&#160;hyperspecial&#160;maximal&#160;compact&#160;subgroup&#160;of&#160;G(Ft).&#160;By&#160;Bruhat-<br/>Tits&#160;theory&#160;we&#160;may&#160;extend&#160;G&#160;to&#160;an&#160;integral&#160;model&#160;over&#160;the&#160;valuation&#160;subring&#160;Ot&#160;⊂&#160;Ft&#160;such&#160;that&#160;G(Ot)&#160;=&#160;K.<br/>
Let&#160;HG,K&#160;=&#160;Func(K\G(Ft)/K,&#160;Qℓ)&#160;be&#160;the&#160;corresponding&#160;spherical&#160;Hecke&#160;algebra.&#160;This&#160;has&#160;several<br/>
canonical&#160;bases,&#160;so&#160;we&#160;fix&#160;notation&#160;for&#160;them.&#160;Let&#160;T&#160;⊂&#160;G&#160;be&#160;a&#160;maximal&#160;split&#160;torus.&#160;As&#160;is&#160;well&#160;known,&#160;we&#160;have<br/>a&#160;Cartan&#160;decomposition<br/>
[<br/>
G(Ft)&#160;=<br/>
KtµK<br/>
(5.1)<br/>
µ∈X∗(T&#160;)+<br/>
indexed&#160;by&#160;the&#160;dominant&#160;coweights&#160;X<br/>
∼<br/>
∗(T&#160;)+&#160;=&#160;Zn,&#160;where&#160;tµ&#160;is&#160;the&#160;character&#160;such&#160;that&#160;for&#160;a&#160;character<br/>
χ&#160;∈&#160;X∗(T&#160;),&#160;we&#160;have&#160;χ(tµ)&#160;=&#160;thχ,µi.<br/>
Definition&#160;5.1.&#160;For&#160;µ&#160;∈&#160;X∗(T&#160;)+,&#160;we&#160;denote&#160;by&#160;fµ&#160;∈&#160;HG,K&#160;the&#160;indicator&#160;function&#160;of&#160;KtµK.<br/>
5.1.2.&#160;Geometrization&#160;of&#160;spherical&#160;Hecke&#160;algebra.&#160;A&#160;second&#160;basis&#160;is&#160;obtained&#160;by&#160;interpreting&#160;categorifying<br/>the&#160;Hecke&#160;algebra&#160;in&#160;terms&#160;of&#160;L+G-equivariant&#160;perverse&#160;sheaves&#160;on&#160;the&#160;affine&#160;Grassmannian&#160;GrG.&#160;Recall<br/>that&#160;GrG(kt)&#160;=&#160;G(Ft)/G(Ot)&#160;where&#160;kt&#160;is&#160;the&#160;residue&#160;field&#160;of&#160;Ft.&#160;Geometric&#160;Satake&#160;furnishes&#160;a&#160;symmetric<br/>monoidal&#160;equivalence<br/>
PervG(Ot)(GrG)&#160;∼<br/>
=&#160;Rep(&#160;b<br/>
G).<br/>
The&#160;simple&#160;objects&#160;in&#160;Rep(&#160;b<br/>
G)&#160;are&#160;indexed&#160;by&#160;µ&#160;∈&#160;X∗(T&#160;)+,&#160;and&#160;we&#160;denote&#160;by&#160;SatGr&#160;(µ)&#160;the&#160;corresponding<br/>
G<br/>
perverse&#160;sheaf&#160;on&#160;GrG,&#160;which&#160;is&#160;the&#160;IC&#160;sheaf&#160;of&#160;the&#160;Schubert&#160;variety&#160;Gr≤µ.<br/>
G<br/>
For&#160;any&#160;F&#160;∈&#160;PervG(Ot)(GrG),&#160;we&#160;have&#160;under&#160;the&#160;function-sheaf&#160;dictionary&#160;(<a href="1711.02243s.html#40">[KW01]&#160;</a>§III.12)&#160;a&#160;trace<br/>
function&#160;fF&#160;on&#160;G(Ot)\G(Ft)/G(Ot)&#160;given&#160;by<br/>
fF&#160;(x)&#160;=&#160;Tr(Frob,&#160;Fx).<br/>
(5.2)<br/>
Definition&#160;5.2.&#160;We&#160;define&#160;ψµ&#160;to&#160;be&#160;the&#160;trace&#160;function&#160;associated&#160;to&#160;SatGr&#160;(µ).<br/>
G<br/>
Definition&#160;5.3.&#160;Since&#160;SatGr&#160;(µ)&#160;is&#160;a&#160;G(O&#160;)-equivariant&#160;sheaf&#160;on&#160;Gr<br/>
,&#160;its&#160;stalks&#160;are&#160;the&#160;same&#160;on&#160;any<br/>
G<br/>
x0<br/>
G,x0<br/>
open&#160;Schubert&#160;cell&#160;Gr=ν&#160;corresponding&#160;to&#160;KtνK&#160;in&#160;the&#160;Cartan&#160;decomposition&#160;<a href="1711.02243s.html#16">(5.1)</a>.&#160;We&#160;denote&#160;this&#160;common<br/>stalk&#160;by&#160;SatGr&#160;(µ)<br/>
G<br/>
ν&#160;.<br/>
Lemma&#160;5.4.&#160;We&#160;have<br/>
X<br/>
ψµ&#160;=<br/>
Tr(Frob,&#160;SatGr&#160;(µ)<br/>
G<br/>
ν&#160;)fν<br/>
ν≤u<br/>
Proof.&#160;This&#160;is&#160;immediate&#160;from&#160;the&#160;fact&#160;that&#160;SatGr(µ)ν&#160;is&#160;supported&#160;on&#160;Gr≤µ,&#160;which&#160;is&#160;the&#160;union&#160;of&#160;the&#160;Gr=ν<br/>for&#160;ν&#160;≤&#160;µ,&#160;and&#160;the&#160;definition&#160;of&#160;fν&#160;as&#160;the&#160;characteristic&#160;function&#160;on&#160;KtνK.<br/>
<br/>
We&#160;have&#160;a&#160;Satake&#160;isomorphism<br/>
HG(K)&#160;∼<br/>
−<br/>
→&#160;R(&#160;b<br/>
G)&#160;∼<br/>
=&#160;Qℓ[X∗(T&#160;)]W<br/>
where&#160;W&#160;is&#160;the&#160;Weyl&#160;group&#160;of&#160;T&#160;.&#160;(The&#160;Satake&#160;isomorphism&#160;is&#160;reviewed&#160;in&#160;<a href="1711.02243s.html#26">§7.2.</a>)&#160;Here&#160;R(&#160;b<br/>
G)&#160;is&#160;the&#160;represen-<br/>
tation&#160;ring&#160;of&#160;b<br/>
G,&#160;which&#160;is&#160;generated&#160;by&#160;the&#160;classes&#160;of&#160;the&#160;highest&#160;weight&#160;representations&#160;Vµ.<br/>
5.1.3.&#160;Parahoric&#160;Hecke&#160;algebras.&#160;Let&#160;J&#160;be&#160;a&#160;parahoric&#160;subgroup&#160;of&#160;G&#160;stabilizing&#160;a&#160;facet&#160;in&#160;the&#160;dominant&#160;alcove<br/>of&#160;the&#160;vertex&#160;corresponding&#160;to&#160;K&#160;in&#160;the&#160;Bruhat-Tits&#160;building&#160;of&#160;G(Ft).&#160;Let&#160;HG,J&#160;=&#160;Func(J\G(Ft)/J,&#160;Qℓ)<br/>be&#160;the&#160;corresponding&#160;parahoric&#160;Hecke&#160;algebra.<br/>
Theorem&#160;5.5&#160;(Bernstein,&#160;<a href="1711.02243s.html#39">[Hai09]&#160;</a>Theorem&#160;3.1.1.).&#160;Convolution&#160;with&#160;f0&#160;=&#160;IK&#160;(the&#160;identity&#160;of&#160;HG,K)&#160;induces<br/>an&#160;isomorphism<br/>
−&#160;∗J&#160;IK&#160;:&#160;Z(HG,J)&#160;∼<br/>
−<br/>
→&#160;HG,K.<br/>
Definition&#160;5.6.&#160;For&#160;µ&#160;∈&#160;X∗(T&#160;)+,<br/>
•&#160;We&#160;denote&#160;by&#160;f&#160;′µ&#160;the&#160;unique&#160;element&#160;of&#160;Z(HG,J)&#160;such&#160;that&#160;f′µ&#160;∗&#160;IK&#160;=&#160;fµ.<br/>•&#160;We&#160;denote&#160;by&#160;ψ′µ&#160;∈&#160;Z(HG,J)&#160;the&#160;unique&#160;element&#160;such&#160;that&#160;ψ′µ&#160;∗&#160;IK&#160;=&#160;ψµ&#160;∈&#160;HG,K.<br/>
<hr/>
<a name=17></a><img class="yflip" src="html/1711.02243-17_1.png"/><br/>
<img class="yflip" src="html/1711.02243-17_2.png"/><br/>
<img class="yflip" src="html/1711.02243-17_3.png"/><br/>
<img class="yflip" src="html/1711.02243-17_4.png"/><br/>
<img class="yflip" src="html/1711.02243-17_5.png"/><br/>
<img class="yflip" src="html/1711.02243-17_6.png"/><br/>
<img class="yflip" src="html/1711.02243-17_7.png"/><br/>
<img class="yflip" src="html/1711.02243-17_8.png"/><br/>
<img class="yflip" src="html/1711.02243-17_9.png"/><br/>
<img class="yflip" src="html/1711.02243-17_10.png"/><br/>
<img class="yflip" src="html/1711.02243-17_11.png"/><br/>
<img class="yflip" src="html/1711.02243-17_12.png"/><br/>
<img class="yflip" src="html/1711.02243-17_13.png"/><br/>
<img class="yflip" src="html/1711.02243-17_14.png"/><br/>
<img class="yflip" src="html/1711.02243-17_15.png"/><br/>
<img class="yflip" src="html/1711.02243-17_16.png"/><br/>
<img class="yflip" src="html/1711.02243-17_17.png"/><br/>
<img class="yflip" src="html/1711.02243-17_18.png"/><br/>
<img class="yflip" src="html/1711.02243-17_19.png"/><br/>
<img class="yflip" src="html/1711.02243-17_20.png"/><br/>
<img class="yflip" src="html/1711.02243-17_21.png"/><br/>
<img class="yflip" src="html/1711.02243-17_22.png"/><br/>
<img class="yflip" src="html/1711.02243-17_23.png"/><br/>
<img class="yflip" src="html/1711.02243-17_24.png"/><br/>
<img class="yflip" src="html/1711.02243-17_25.png"/><br/>
<img class="yflip" src="html/1711.02243-17_26.png"/><br/>
<img class="yflip" src="html/1711.02243-17_27.png"/><br/>
<img class="yflip" src="html/1711.02243-17_28.png"/><br/>
<img class="yflip" src="html/1711.02243-17_29.png"/><br/>
<img class="yflip" src="html/1711.02243-17_30.png"/><br/>
<img class="yflip" src="html/1711.02243-17_31.png"/><br/>
<img class="yflip" src="html/1711.02243-17_32.png"/><br/>
<img class="yflip" src="html/1711.02243-17_33.png"/><br/>
NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,&#160;AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
17<br/>
5.1.4.&#160;Geometrization&#160;of&#160;parahoric&#160;Hecke&#160;algebras.&#160;There&#160;is&#160;a&#160;geometrization&#160;of&#160;the&#160;parahoric&#160;Hecke&#160;algebra<br/>completely&#160;analogous&#160;to&#160;<a href="1711.02243s.html#16">§5.1.2.&#160;</a>Let&#160;G&#160;be&#160;the&#160;parahoric&#160;group&#160;scheme&#160;corresponding&#160;to&#160;J&#160;by&#160;Bruhat-Tits<br/>theory.&#160;Then&#160;the&#160;Hecke&#160;algebra&#160;HG,J&#160;is&#160;categorified&#160;by&#160;PervG(O)(GrG).<br/>
Note&#160;that&#160;if&#160;J&#160;=&#160;I&#160;is&#160;an&#160;Iwahori&#160;subgroup&#160;(the&#160;stabilizer&#160;of&#160;full&#160;alcove),&#160;then&#160;GrG&#160;is&#160;the&#160;affine&#160;flag&#160;variety<br/>
FlG.&#160;In&#160;general&#160;one&#160;can&#160;think&#160;of&#160;GrG&#160;as&#160;a&#160;kind&#160;of&#160;affine&#160;partial&#160;flag&#160;variety.<br/>
One&#160;might&#160;ask&#160;which&#160;sheaves&#160;the&#160;functions&#160;ψ′µ&#160;correspond&#160;to.&#160;The&#160;answer&#160;is&#160;that&#160;they&#160;can&#160;be&#160;realized&#160;as<br/>
nearby&#160;cycles&#160;of&#160;certain&#160;global&#160;degenerations,&#160;and&#160;it&#160;is&#160;the&#160;key&#160;point&#160;underlying&#160;this&#160;section.<br/>
5.2.&#160;Nearby&#160;cycles.&#160;We&#160;recall&#160;the&#160;definition&#160;and&#160;essential&#160;(for&#160;us)&#160;properties&#160;of&#160;the&#160;nearby&#160;cycles&#160;functor.<br/>For&#160;a&#160;reference,&#160;see&#160;<a href="1711.02243s.html#39">[Del73]&#160;</a>Exposé&#160;XIII.<br/>
A&#160;Henselian&#160;trait&#160;is&#160;a&#160;triple&#160;(S,&#160;s,&#160;η)&#160;where&#160;S&#160;is&#160;a&#160;the&#160;spectrum&#160;of&#160;a&#160;discrete&#160;valuation&#160;ring,&#160;s&#160;is&#160;the&#160;special<br/>
point&#160;of&#160;S&#160;and&#160;η&#160;is&#160;the&#160;generic&#160;point&#160;of&#160;S.&#160;Choose&#160;geometric&#160;points&#160;s&#160;and&#160;η&#160;lying&#160;over&#160;s&#160;and&#160;η,&#160;respectively.<br/>Let&#160;S&#160;be&#160;the&#160;normalization&#160;of&#160;S&#160;in&#160;η.&#160;We&#160;denote&#160;by<br/>
i&#160;:&#160;s&#160;֒→&#160;S<br/>
j&#160;:&#160;η&#160;֒→&#160;S<br/>
i&#160;:&#160;s&#160;→&#160;S<br/>
j&#160;:&#160;η&#160;→&#160;S<br/>
the&#160;obvious&#160;maps.<br/>
Let&#160;f&#160;:&#160;Y&#160;→&#160;S&#160;be&#160;a&#160;finite&#160;type&#160;scheme&#160;over&#160;S.&#160;One&#160;defines&#160;a&#160;topos&#160;Y&#160;×s&#160;η&#160;as&#160;in&#160;<a href="1711.02243s.html#39">[Del73]&#160;</a>Exposé&#160;XIII<br/>
§1.2,&#160;so&#160;that&#160;the&#160;category&#160;Dbc(Y&#160;×s&#160;η,&#160;Qℓ)&#160;is&#160;the&#160;category&#160;of&#160;F&#160;∈&#160;Dbc(Y&#160;×s&#160;s,&#160;Qℓ)&#160;together&#160;with&#160;a&#160;continuous<br/>Gal(η/η)-action&#160;compatible&#160;with&#160;the&#160;Gal(s/s)-action&#160;on&#160;Ys&#160;via&#160;the&#160;natural&#160;map&#160;Gal(η/η)&#160;→&#160;Gal(s/s).<br/>
Definition&#160;5.7.&#160;Given&#160;F&#160;∈&#160;Dbc(Yη,&#160;Qℓ)&#160;we&#160;define&#160;the&#160;nearby&#160;cycles&#160;RΨ(F)&#160;∈&#160;Dbc(Y&#160;×s&#160;s,&#160;Qℓ)&#160;by<br/>
∗<br/>
RΨ(F&#160;)&#160;:=&#160;i&#160;Rj∗(Fη)<br/>
with&#160;the&#160;Gal(η/η)-action&#160;obtained&#160;by&#160;transport&#160;of&#160;structure&#160;from&#160;that&#160;on&#160;Fη.<br/>
Remark&#160;5.8.&#160;When&#160;the&#160;nearby&#160;cycles&#160;construction&#160;is&#160;performed&#160;with&#160;S&#160;=&#160;Spec&#160;Fq[&#160;t]],&#160;the&#160;sheaf&#160;RΨ(F)<br/>is&#160;a&#160;priori&#160;only&#160;defined&#160;over&#160;Y<br/>
,&#160;but&#160;can&#160;be&#160;descended&#160;to&#160;Y<br/>
by&#160;choosing&#160;a&#160;splitting&#160;Gal(F<br/>
F<br/>
F<br/>
q&#160;/Fq)&#160;→<br/>
q<br/>
q<br/>
Gal(Fq((t))/Fq((t))).&#160;When&#160;dealing&#160;with&#160;nearby&#160;cycles&#160;on&#160;affine&#160;Grassmannians&#160;(or&#160;related&#160;objects)&#160;this&#160;is<br/>often&#160;what&#160;we&#160;mean&#160;(see&#160;<a href="1711.02243s.html#39">[Gai01]</a>,&#160;Footnote&#160;4&#160;on&#160;page&#160;8).&#160;Only&#160;after&#160;such&#160;a&#160;descent&#160;one&#160;can&#160;associate&#160;a&#160;trace<br/>function&#160;to&#160;RΨ(F).&#160;We&#160;shall&#160;point&#160;out&#160;when&#160;this&#160;descent&#160;is&#160;being&#160;used,&#160;but&#160;as&#160;a&#160;blanket&#160;rule&#160;it&#160;is&#160;necessary<br/>every&#160;time&#160;we&#160;wish&#160;to&#160;talk&#160;about&#160;a&#160;trace&#160;function.<br/>
Lemma&#160;5.9.&#160;If&#160;f&#160;:&#160;Y&#160;→&#160;S&#160;is&#160;proper,&#160;then&#160;the&#160;base&#160;change&#160;homomorphism<br/>
RΨf∗&#160;→&#160;f∗RΨ<br/>
is&#160;an&#160;isomorphism.<br/>
Proof.&#160;This&#160;is&#160;<a href="1711.02243s.html#39">[Del73]</a>,&#160;Exposé&#160;XIII&#160;(2.1.7.1).<br/>
<br/>
Corollary&#160;5.10.&#160;If&#160;f&#160;:&#160;Y&#160;→&#160;S&#160;is&#160;proper,&#160;then&#160;the&#160;natural&#160;map<br/>
Hic(Yη,&#160;Qℓ)&#160;→&#160;Hic(Ys,&#160;RΨ(Qℓ)).<br/>
is&#160;an&#160;isomorphism.<br/>
Lemma&#160;5.11.&#160;If&#160;f&#160;:&#160;Y&#160;→&#160;S&#160;is&#160;lisse,&#160;then&#160;the&#160;base&#160;change&#160;homomorphism<br/>
f&#160;∗RΨ&#160;→&#160;RΨf&#160;∗<br/>
is&#160;an&#160;isomorphism.<br/>
Proof.&#160;This&#160;is&#160;<a href="1711.02243s.html#39">[Del73]</a>,&#160;Exposé&#160;XIII&#160;(2.1.7.2).<br/>
<br/>
<hr/>
<a name=18></a>18<br/>
TONY&#160;FENG<br/>
5.3.&#160;Degeneration&#160;to&#160;affine&#160;flag&#160;varieties.&#160;Let&#160;X&#160;be&#160;a&#160;smooth&#160;curve&#160;(not&#160;necessarily&#160;projective)&#160;over&#160;Fq<br/>and&#160;let&#160;G&#160;→&#160;X&#160;be&#160;a&#160;parahoric&#160;group&#160;scheme,&#160;with&#160;parahoric&#160;level&#160;structure&#160;at&#160;x0.&#160;We&#160;consider&#160;the&#160;global<br/>affine&#160;Grassmannian&#160;for&#160;G&#160;as&#160;in&#160;<a href="1711.02243s.html#9">§4.1:</a><br/>
π&#160;:&#160;GrG&#160;→&#160;X.<br/>
Consider&#160;the&#160;restriction&#160;GrG&#160;|D&#160;,&#160;where&#160;D<br/>
:=&#160;Spec&#160;O<br/>
is&#160;the&#160;spectrum&#160;of&#160;the&#160;completed&#160;local&#160;ring&#160;at&#160;x<br/>
x<br/>
x<br/>
x<br/>
0.<br/>
0<br/>
0<br/>
0<br/>
We&#160;apply&#160;the&#160;nearby&#160;cycles&#160;construction&#160;of&#160;<a href="1711.02243s.html#17">§5.2&#160;</a>and&#160;in&#160;the&#160;form&#160;of&#160;Remark&#160;<a href="1711.02243s.html#17">5.8,&#160;</a>to<br/>
•&#160;S&#160;=&#160;Dx&#160;,&#160;Y&#160;=&#160;Gr<br/>
,&#160;and<br/>
0<br/>
G&#160;|Dx0<br/>
•&#160;F&#160;=&#160;SatGr&#160;(µ)|<br/>
,&#160;where&#160;D∗&#160;=&#160;Spec&#160;F<br/>
is&#160;thought&#160;of&#160;as&#160;a&#160;local&#160;“punctured&#160;disk”&#160;around&#160;x<br/>
G<br/>
D∗<br/>
x<br/>
0.<br/>
x<br/>
x<br/>
0<br/>
0<br/>
0<br/>
This&#160;produces&#160;a&#160;G(Ox&#160;)-equivariant&#160;perverse&#160;sheaf&#160;RΨ(Sat<br/>
(µ)|<br/>
)&#160;on&#160;Gr<br/>
,&#160;which&#160;we&#160;will&#160;abbreviate<br/>
0<br/>
GrG<br/>
D◦<br/>
G&#160;|x<br/>
x<br/>
0<br/>
0<br/>
by&#160;RΨ(SatGr&#160;(µ)).<br/>
G<br/>
Theorem&#160;5.12&#160;(Gaitsgory&#160;<a href="1711.02243s.html#39">[Gai01]</a>,&#160;Zhu&#160;<a href="1711.02243s.html#40">[Zhu14]</a>).&#160;The&#160;sheaf&#160;RΨ(SatGr&#160;(µ)))&#160;is&#160;central.<br/>
G<br/>
Remark&#160;5.13.&#160;In&#160;the&#160;present&#160;formulation&#160;and&#160;level&#160;of&#160;generality,&#160;this&#160;theorem&#160;is&#160;actually&#160;due&#160;to&#160;X.&#160;Zhu&#160;in<br/><a href="1711.02243s.html#40">[Zhu14]&#160;</a>Theorem&#160;7.3.&#160;Gaitsgory&#160;worked&#160;with&#160;constant&#160;group&#160;schemes&#160;G,&#160;and&#160;a&#160;slightly&#160;different&#160;degeneration.<br/>
Corollary&#160;5.14.&#160;Assume&#160;that&#160;G&#160;:=&#160;G|F<br/>
is&#160;split.&#160;Then&#160;the&#160;trace&#160;function&#160;(in&#160;the&#160;sense&#160;of&#160;<a href="1711.02243s.html#16">(5.2)</a>)&#160;associated<br/>
x0<br/>
to&#160;RΨ(SatGr&#160;(µ)))&#160;is&#160;ψ′<br/>
G<br/>
µ&#160;(Definition&#160;<a href="1711.02243s.html#16">5.6)</a>.<br/>
Remark&#160;5.15.&#160;Note&#160;that&#160;we&#160;need&#160;to&#160;use&#160;Remark&#160;<a href="1711.02243s.html#17">5.8&#160;</a>to&#160;descend&#160;RΨ(SatGr&#160;(µ)))&#160;to&#160;Gr<br/>
,&#160;so&#160;that&#160;it<br/>
G<br/>
G&#160;|x0<br/>
makes&#160;sense&#160;to&#160;speak&#160;of&#160;the&#160;trace&#160;function.<br/>
Proof.&#160;Since&#160;RΨ(SatGr&#160;(µ))&#160;is&#160;a&#160;G(O<br/>
,&#160;which&#160;is&#160;central&#160;by&#160;Theorem<br/>
G<br/>
x)-equivariant&#160;perverse&#160;sheaf&#160;on&#160;GrG&#160;|x0<br/>
<a href="1711.02243s.html#18">5.12,&#160;</a>we&#160;have&#160;a&#160;priori&#160;that&#160;its&#160;trace&#160;function<br/>
Tr(Frob,&#160;RΨ(SatGr&#160;(µ)))<br/>
G<br/>
lies&#160;in&#160;Z(HG,G(O<br/>
,&#160;which&#160;we<br/>
x&#160;)&#160;(Fx&#160;)).<br/>
Since&#160;G&#160;is&#160;split&#160;we&#160;can&#160;extend&#160;it&#160;to&#160;a&#160;constant&#160;group&#160;scheme&#160;over&#160;Dx<br/>
0<br/>
0<br/>
continue&#160;to&#160;denote&#160;G,&#160;such&#160;that&#160;G0(Ox&#160;)&#160;=:&#160;K&#160;is&#160;a&#160;hyperspecial&#160;maximal&#160;compact&#160;subgroup&#160;of&#160;G(F<br/>
0<br/>
x).&#160;Write<br/>
also&#160;J&#160;:=&#160;G(Ox&#160;)&#160;for&#160;the&#160;parahoric&#160;subgroup.&#160;By&#160;the&#160;Bernstein&#160;isomorphism&#160;(Theorem&#160;<a href="1711.02243s.html#16">5.5)</a><br/>
0<br/>
−&#160;∗&#160;IK&#160;:&#160;Z(HG,J&#160;)&#160;∼<br/>
−<br/>
→&#160;HG,K<br/>
it&#160;suffices&#160;to&#160;check&#160;that<br/>
Tr(Frob,&#160;RΨ(SatGr&#160;(µ)))&#160;∗&#160;I<br/>
G<br/>
K&#160;=&#160;ψµ.<br/>
(5.3)<br/>
By&#160;<a href="1711.02243s.html#39">[Gai01]&#160;</a>Theorem&#160;1&#160;(d)&#160;the&#160;map&#160;<a href="1711.02243s.html#18">(5.3)&#160;</a>is&#160;realized&#160;sheaf-theoretically&#160;by&#160;the&#160;pushforward&#160;via&#160;the&#160;proper<br/>map<br/>
pr&#160;:&#160;GrG&#160;→&#160;GrG<br/>
or&#160;in&#160;other&#160;words,<br/>
Tr(Frob,&#160;RΨ(SatGr&#160;(µ)))&#160;∗&#160;I<br/>
(µ))).<br/>
G<br/>
K&#160;=&#160;Tr(Frob,&#160;pr!RΨ(SatGrG<br/>
Now,&#160;by&#160;Lemma&#160;<a href="1711.02243s.html#17">5.9&#160;</a>and&#160;the&#160;fact&#160;that&#160;pr&#160;is&#160;an&#160;isomorphism&#160;over&#160;D∗<br/>
∼<br/>
x<br/>
(since&#160;G|D∗&#160;=&#160;G|D∗&#160;)&#160;we&#160;have<br/>
0<br/>
x0<br/>
x0<br/>
pr!RΨ(SatGr&#160;(µ))&#160;=&#160;RΨ(Sat<br/>
(µ))<br/>
G<br/>
GrG<br/>
but&#160;since&#160;G0|D&#160;→&#160;D<br/>
x<br/>
x&#160;is&#160;smooth&#160;with&#160;constant&#160;fiber&#160;GrG,&#160;we&#160;simply&#160;have<br/>
RΨ(SatGr&#160;(µ))&#160;=&#160;Sat<br/>
(µ)|&#160;,<br/>
G<br/>
GrG<br/>
x0<br/>
whose&#160;trace&#160;function&#160;is&#160;ψµ&#160;by&#160;definition.<br/>
<br/>
Schubert&#160;stratification.&#160;Let&#160;GrG,x&#160;be&#160;the&#160;fiber&#160;of&#160;Gr<br/>
0<br/>
G&#160;over&#160;x0.&#160;We&#160;discuss&#160;the&#160;stratification&#160;induced&#160;by&#160;the<br/>
G(Ox&#160;)-action&#160;on&#160;Gr<br/>
.<br/>
0<br/>
G,x0<br/>
The&#160;analogue&#160;of&#160;the&#160;Cartan&#160;decomposition&#160;<a href="1711.02243s.html#16">(5.1)&#160;</a>is<br/>
G(Ox&#160;)\G(F&#160;)/G(O&#160;)&#160;∼<br/>
=&#160;f<br/>
W<br/>
0<br/>
x0<br/>
x0<br/>
J&#160;\f<br/>
W&#160;/f<br/>
WJ<br/>
where&#160;f<br/>
W&#160;is&#160;the&#160;extended&#160;affine&#160;Weyl&#160;group,&#160;and&#160;f<br/>
WJ&#160;is&#160;the&#160;subgroup&#160;corresponding&#160;to&#160;the&#160;parahoric&#160;subgroup<br/>
J&#160;:=&#160;G(Ox&#160;).&#160;We&#160;refer&#160;to&#160;<a href="1711.02243s.html#39">[Hai09]&#160;</a>§2.6&#160;for&#160;the&#160;notation&#160;and&#160;definitions;&#160;all&#160;that&#160;we&#160;require&#160;are&#160;the&#160;following<br/>
0<br/>
abstract&#160;facts:<br/>
•&#160;The&#160;G(Ox&#160;)-orbits&#160;on&#160;Gr<br/>
are&#160;indexed&#160;by&#160;ν&#160;∈&#160;f<br/>
W<br/>
0<br/>
G,x0<br/>
J&#160;\f<br/>
W&#160;/f<br/>
WJ&#160;.&#160;We&#160;denote&#160;the&#160;open&#160;orbit&#160;corresponding<br/>
to&#160;ν&#160;∈&#160;f<br/>
WJ&#160;\f<br/>
W&#160;/f<br/>
WJ&#160;by&#160;Gr=ν<br/>
G,x<br/>
and&#160;its&#160;closure&#160;by&#160;Gr≤ν&#160;.<br/>
0<br/>
G,x0<br/>
<hr/>
<a name=19></a>NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,&#160;AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
19<br/>
•&#160;There&#160;is&#160;a&#160;partial&#160;order&#160;on&#160;f<br/>
WJ&#160;\f<br/>
W&#160;/f<br/>
WJ&#160;such&#160;that&#160;µ&#160;≥&#160;ν&#160;if&#160;and&#160;only&#160;if&#160;Gr≤µ&#160;⊃&#160;Gr=ν&#160;.<br/>
G,x0<br/>
G,x0<br/>
Definition&#160;5.16.&#160;Since&#160;RΨ(SatGr&#160;(µ))&#160;is&#160;a&#160;J-equivariant&#160;perverse&#160;sheaf&#160;on&#160;Gr<br/>
(<a href="1711.02243s.html#39">[Gai01]&#160;</a>Theorem&#160;1),&#160;its<br/>
G<br/>
G,x0<br/>
stalks&#160;are&#160;the&#160;same&#160;on&#160;any&#160;open&#160;Schubert&#160;cell&#160;Gr=ν<br/>
G&#160;.&#160;We&#160;denote&#160;this&#160;common&#160;stalk&#160;by&#160;RΨ(SatGr(µ))ν&#160;.<br/>
Lemma&#160;5.17.&#160;We&#160;have<br/>
X<br/>
ψ′µ&#160;=<br/>
Tr(Frob,&#160;RΨ(SatGr&#160;(µ))<br/>
G<br/>
ν&#160;)fν<br/>
ν≤µ<br/>
Proof.&#160;The&#160;argument&#160;is&#160;the&#160;same&#160;as&#160;for&#160;Lemma&#160;<a href="1711.02243s.html#16">5.4.</a><br/>
<br/>
5.4.&#160;Local&#160;models&#160;for&#160;shtukas.<br/>
Definition&#160;5.18.&#160;Let&#160;X&#160;and&#160;Y&#160;be&#160;Artin&#160;stacks.&#160;We&#160;say&#160;that&#160;Y&#160;is&#160;an&#160;étale&#160;local&#160;model&#160;for&#160;X&#160;if&#160;there&#160;exists<br/>an&#160;Artin&#160;stack&#160;W&#160;and&#160;a&#160;diagram<br/>
W<br/>
étale<br/>
étale<br/>
f<br/>
g<br/>
X<br/>
Y<br/>
A&#160;diagram&#160;as&#160;above&#160;is&#160;called&#160;a&#160;local&#160;model&#160;diagram.<br/>
Theorem&#160;5.19&#160;(Varshavsky,&#160;V.&#160;Lafforgue).&#160;The&#160;stack&#160;Gr≤(µ1,...,µr)<br/>
.<br/>
G,Xr<br/>
is&#160;an&#160;étale&#160;local&#160;model&#160;for&#160;Sht≤(µ1,...,µr)<br/>
G<br/>
Remark&#160;5.20.&#160;This&#160;is&#160;a&#160;variation&#160;on&#160;well-known&#160;results,&#160;which&#160;are&#160;not&#160;quite&#160;stated&#160;in&#160;the&#160;literature&#160;at<br/>the&#160;level&#160;of&#160;generality&#160;needed&#160;here.&#160;Varshavsky&#160;proved&#160;this&#160;(<a href="1711.02243s.html#40">[Var04]&#160;</a>Theorem&#160;2.20)&#160;for&#160;a&#160;constant&#160;group<br/>G&#160;=&#160;G&#160;×&#160;X,&#160;while&#160;the&#160;general&#160;case&#160;is&#160;essentially&#160;implicit&#160;in&#160;<a href="1711.02243s.html#40">[Laf12]</a>,&#160;so&#160;we&#160;credit&#160;it&#160;to&#160;both&#160;of&#160;them.<br/>
Proof.&#160;For&#160;ease&#160;of&#160;presentation,&#160;we&#160;assume&#160;that&#160;r&#160;=&#160;1&#160;in&#160;the&#160;proof;&#160;the&#160;argument&#160;for&#160;the&#160;general&#160;case&#160;is<br/>a&#160;completely&#160;straightforward&#160;generalization.&#160;Since&#160;for&#160;any&#160;given&#160;µ&#160;the&#160;L+G-action&#160;on&#160;Hecke≤µ&#160;and&#160;Gr≤µ<br/>
G<br/>
G<br/>
factors&#160;through&#160;a&#160;finite&#160;étale&#160;quotient,&#160;Proposition&#160;<a href="1711.02243s.html#10">4.8&#160;</a>implies&#160;that&#160;there&#160;is&#160;an&#160;étale&#160;cover&#160;Hecke≤µ&#160;→<br/>
G,N<br/>
Hecke≤µ,&#160;obtained&#160;by&#160;adding&#160;a&#160;finite&#160;level&#160;structure,&#160;equipped&#160;with&#160;an&#160;étale&#160;map&#160;Hecke≤µ&#160;→&#160;Gr≤µ&#160;×&#160;Bun<br/>
G<br/>
G,N<br/>
G<br/>
G&#160;.<br/>
Define&#160;Sht≤µ&#160;by&#160;the&#160;cartesian&#160;diagram<br/>
G,N<br/>
Sht≤µ<br/>
Bun<br/>
G,N<br/>
G<br/>
Id&#160;×&#160;Frob<br/>
Hecke≤µ&#160;h←×h→&#160;Bun<br/>
G,N<br/>
G&#160;×&#160;BunG<br/>
Then&#160;we&#160;have&#160;a&#160;finite&#160;étale&#160;cover&#160;Sht≤µ&#160;→&#160;Sht≤µ,&#160;which&#160;concretely&#160;is&#160;the&#160;covering&#160;map&#160;for&#160;a&#160;finite&#160;level<br/>
G,N<br/>
G<br/>
structure.&#160;This&#160;fits&#160;into&#160;a&#160;diagram<br/>
Sht≤µ<br/>
Bun<br/>
G,N<br/>
G<br/>
étale<br/>
Id&#160;×&#160;Frob<br/>
Sht≤µ<br/>
Hecke≤µ&#160;h←×h→&#160;Bun<br/>
(5.4)<br/>
G<br/>
G,N<br/>
G&#160;×&#160;BunG<br/>
étale<br/>
BunG&#160;×&#160;Gr≤µ<br/>
G<br/>
It&#160;is&#160;a&#160;general&#160;fact&#160;that&#160;in&#160;this&#160;situation&#160;that&#160;the&#160;vertical&#160;composition&#160;Sht≤µ&#160;→&#160;Gr≤µ&#160;is&#160;étale.&#160;Indeed,&#160;since<br/>
G,N<br/>
G<br/>
the&#160;claim&#160;is&#160;local&#160;in&#160;the&#160;smooth&#160;topology,&#160;we&#160;may&#160;perform&#160;a&#160;base&#160;change&#160;to&#160;make&#160;everything&#160;into&#160;a&#160;scheme,<br/>and&#160;apply&#160;<a href="1711.02243s.html#40">[Laf12]&#160;</a>Lemma&#160;2.13&#160;to&#160;W&#160;=&#160;Hecke≤µ&#160;,&#160;T&#160;=&#160;Gr≤µ,&#160;and&#160;Z&#160;=&#160;Bun<br/>
G,N<br/>
G<br/>
G&#160;.<br/>
<br/>
<hr/>
<a name=20></a><img class="yflip" src="html/1711.02243-20_1.png"/><br/>
<img class="yflip" src="html/1711.02243-20_2.png"/><br/>
<img class="yflip" src="html/1711.02243-20_3.png"/><br/>
<img class="yflip" src="html/1711.02243-20_4.png"/><br/>
<img class="yflip" src="html/1711.02243-20_5.png"/><br/>
<img class="yflip" src="html/1711.02243-20_6.png"/><br/>
<img class="yflip" src="html/1711.02243-20_7.png"/><br/>
<img class="yflip" src="html/1711.02243-20_8.png"/><br/>
<img class="yflip" src="html/1711.02243-20_9.png"/><br/>
<img class="yflip" src="html/1711.02243-20_10.png"/><br/>
<img class="yflip" src="html/1711.02243-20_11.png"/><br/>
<img class="yflip" src="html/1711.02243-20_12.png"/><br/>
<img class="yflip" src="html/1711.02243-20_13.png"/><br/>
<img class="yflip" src="html/1711.02243-20_14.png"/><br/>
<img class="yflip" src="html/1711.02243-20_15.png"/><br/>
<img class="yflip" src="html/1711.02243-20_16.png"/><br/>
<img class="yflip" src="html/1711.02243-20_17.png"/><br/>
<img class="yflip" src="html/1711.02243-20_18.png"/><br/>
<img class="yflip" src="html/1711.02243-20_19.png"/><br/>
<img class="yflip" src="html/1711.02243-20_20.png"/><br/>
<img class="yflip" src="html/1711.02243-20_21.png"/><br/>
<img class="yflip" src="html/1711.02243-20_22.png"/><br/>
<img class="yflip" src="html/1711.02243-20_23.png"/><br/>
<img class="yflip" src="html/1711.02243-20_24.png"/><br/>
<img class="yflip" src="html/1711.02243-20_25.png"/><br/>
<img class="yflip" src="html/1711.02243-20_26.png"/><br/>
<img class="yflip" src="html/1711.02243-20_27.png"/><br/>
<img class="yflip" src="html/1711.02243-20_28.png"/><br/>
20<br/>
TONY&#160;FENG<br/>
Corollary&#160;5.21.&#160;Let&#160;µ&#160;∈&#160;X∗(T&#160;)r.&#160;There&#160;is&#160;an&#160;étale&#160;local&#160;model&#160;diagram<br/>
W≤µ<br/>
étale<br/>
étale<br/>
f<br/>
g<br/>
≤µ<br/>
≤µ<br/>
Sht<br/>
Gr<br/>
G<br/>
G<br/>
Xr<br/>
with<br/>
f&#160;∗&#160;SatSht&#160;(µ)&#160;=&#160;g∗&#160;Sat<br/>
(µ).<br/>
G<br/>
GrG<br/>
≤µ<br/>
Proof.&#160;This&#160;follows&#160;from&#160;the&#160;diagram&#160;<a href="1711.02243s.html#19">(5.4)&#160;</a>and&#160;the&#160;definition&#160;of&#160;the&#160;Satake&#160;sheaves,&#160;taking&#160;W≤µ&#160;=&#160;Sht<br/>
.<br/>
G,N<br/>
<br/>
Let&#160;µ&#160;∈&#160;X∗(T&#160;)r.&#160;By&#160;Corollary&#160;<a href="1711.02243s.html#20">5.21,&#160;</a>we&#160;may&#160;set<br/>
SatW&#160;(µ)&#160;:=&#160;f&#160;∗&#160;SatSht&#160;(µ)&#160;=&#160;g∗&#160;Sat<br/>
(µ).<br/>
G<br/>
GrG<br/>
We&#160;write&#160;RΨx&#160;to&#160;emphasize&#160;that&#160;we&#160;are&#160;taking&#160;nearby&#160;cycles&#160;over&#160;the&#160;point&#160;x<br/>
0<br/>
0.<br/>
By&#160;Lemma&#160;<a href="1711.02243s.html#17">5.11,&#160;</a>and<br/>
implicitly&#160;using&#160;Corollary&#160;<a href="1711.02243s.html#20">5.21,&#160;</a>we&#160;have<br/>
f&#160;∗RΨx&#160;(Sat<br/>
(µ))&#160;=&#160;RΨ&#160;(Sat<br/>
(Sat<br/>
(µ)).<br/>
0<br/>
ShtG<br/>
x0<br/>
W&#160;(µ))&#160;=&#160;g∗RΨx0<br/>
GrG<br/>
Thus,&#160;for&#160;w&#160;∈&#160;W(k)&#160;lying&#160;over&#160;y&#160;∈&#160;ShtG(k)&#160;and&#160;z&#160;∈&#160;GrG(k),&#160;we&#160;have<br/>
Tr(Frob,&#160;RΨx&#160;(Sat<br/>
(µ))<br/>
(Sat<br/>
(Sat<br/>
(µ))<br/>
0<br/>
ShtG<br/>
y&#160;)&#160;=&#160;Tr(Frob,&#160;RΨx0<br/>
W&#160;(µ))w&#160;)&#160;=&#160;Tr(Frob,&#160;RΨx0<br/>
GrG<br/>
z&#160;).<br/>
Therefore,&#160;the&#160;stalks&#160;of&#160;RΨx&#160;(Sat<br/>
(µ))&#160;are&#160;constant&#160;along&#160;the&#160;stratification<br/>
0<br/>
ShtG<br/>
≤µ<br/>
a<br/>
Sht<br/>
=<br/>
Sht=ν,<br/>
G<br/>
G<br/>
ν≤µ<br/>
and&#160;we&#160;deduce:<br/>
Corollary&#160;5.22.&#160;For&#160;ν&#160;∈&#160;X∗(T&#160;)+,&#160;we&#160;have<br/>
Tr(Frob,&#160;RΨx&#160;(Sat<br/>
(µ))<br/>
(Sat<br/>
(µ))<br/>
0<br/>
ShtG<br/>
ν&#160;)&#160;=&#160;Tr(Frob,&#160;RΨx0<br/>
GrG<br/>
ν&#160;).<br/>
Remark&#160;5.23.&#160;We&#160;will&#160;actually&#160;need&#160;to&#160;work&#160;with&#160;ShtG&#160;/aZ&#160;instead.&#160;Since&#160;this&#160;is&#160;obtained&#160;from&#160;ShtG&#160;by<br/>gluing&#160;isomorphic&#160;components,&#160;the&#160;result&#160;is&#160;exactly&#160;the&#160;same.<br/>
6.&#160;Counting&#160;parahoric&#160;shtukas<br/>
Our&#160;eventual&#160;goal&#160;is&#160;establish&#160;a&#160;formula&#160;for&#160;the&#160;trace&#160;of&#160;an&#160;operator,&#160;formed&#160;as&#160;a&#160;composition&#160;of&#160;Hecke<br/>
operators&#160;and&#160;Frobenius,&#160;on&#160;the&#160;cohomology&#160;of&#160;the&#160;nearby&#160;cycles&#160;sheaf&#160;of&#160;(a&#160;variant&#160;of)&#160;ShtG&#160;/aZ&#160;→&#160;X,&#160;at<br/>a&#160;place&#160;of&#160;parahoric&#160;bad&#160;reduction.&#160;The&#160;mold&#160;for&#160;such&#160;calculations&#160;was&#160;set&#160;by&#160;Kottwitz&#160;in&#160;<a href="1711.02243s.html#39">[Kot92]</a>,&#160;who<br/>computed&#160;this&#160;sort&#160;of&#160;trace&#160;for&#160;certain&#160;PEL&#160;Shimura&#160;varieties,&#160;at&#160;places&#160;of&#160;good&#160;(hyperspecial)&#160;reduction.&#160;It<br/>has&#160;since&#160;been&#160;extended&#160;vastly&#160;by&#160;work&#160;of&#160;many&#160;authors;&#160;we&#160;note&#160;that&#160;in&#160;particular&#160;that&#160;Kisin&#160;and&#160;Pappas<br/>constructed&#160;integral&#160;models&#160;for&#160;Shimura&#160;varieties&#160;with&#160;parahoric&#160;level&#160;structure&#160;and&#160;computed&#160;the&#160;trace&#160;of<br/>Frobenius&#160;on&#160;nearby&#160;cycles&#160;in&#160;<a href="1711.02243s.html#40">[KP]</a>.&#160;Our&#160;result&#160;is&#160;a&#160;function&#160;field&#160;analogue&#160;of&#160;this&#160;computation.<br/>
In&#160;this&#160;section&#160;we&#160;carry&#160;out&#160;one&#160;step&#160;of&#160;this&#160;calculation,&#160;which&#160;deals&#160;with&#160;counting&#160;the&#160;number&#160;of&#160;fixed<br/>
points&#160;of&#160;Frobenius&#160;composed&#160;with&#160;Hecke&#160;correspondences.&#160;(The&#160;precise&#160;setup&#160;will&#160;be&#160;explained&#160;in&#160;<a href="1711.02243s.html#21">§6.1.</a>)&#160;In<br/>fact&#160;most&#160;of&#160;the&#160;work&#160;has&#160;already&#160;been&#160;done&#160;by&#160;B.C.&#160;Ngô&#160;and&#160;T.&#160;Ngô&#160;Dac,&#160;who&#160;studied&#160;the&#160;case&#160;of&#160;moduli<br/>of&#160;shtukas&#160;with&#160;hyperspecial&#160;reduction&#160;in&#160;the&#160;series&#160;of&#160;papers&#160;<a href="1711.02243s.html#40">[Ngo06]</a>,&#160;<a href="1711.02243s.html#40">[NND08]</a>,&#160;<a href="1711.02243s.html#40">[ND13]</a>,&#160;and&#160;<a href="1711.02243s.html#40">[ND15]</a>.&#160;The<br/>only&#160;new&#160;element&#160;here&#160;is&#160;that&#160;we&#160;are&#160;considering&#160;parahoric&#160;reduction.&#160;We&#160;note&#160;also&#160;that&#160;our&#160;results&#160;should<br/>follow&#160;from&#160;work&#160;of&#160;Hartl&#160;and&#160;Arasteh&#160;Rad&#160;proving&#160;the&#160;analogue&#160;of&#160;the&#160;Langlands-Rapoport&#160;Conjecture&#160;for<br/>shtukas&#160;<a href="1711.02243s.html#39">[HRb]</a>.<br/>
<hr/>
<a name=21></a><img class="yflip" src="html/1711.02243-21_1.png"/><br/>
<img class="yflip" src="html/1711.02243-21_2.png"/><br/>
<img class="yflip" src="html/1711.02243-21_3.png"/><br/>
<img class="yflip" src="html/1711.02243-21_4.png"/><br/>
<img class="yflip" src="html/1711.02243-21_5.png"/><br/>
<img class="yflip" src="html/1711.02243-21_6.png"/><br/>
NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,&#160;AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
21<br/>
6.1.&#160;Setup.&#160;Throughout&#160;this&#160;section&#160;X◦&#160;is&#160;an&#160;unspecified&#160;open&#160;subset&#160;X,&#160;which&#160;in&#160;the&#160;case&#160;of&#160;D-shtukas<br/>will&#160;be&#160;X&#160;−&#160;Z&#160;where&#160;Z&#160;is&#160;the&#160;set&#160;of&#160;ramification&#160;places&#160;of&#160;D.&#160;We&#160;let&#160;G&#160;be&#160;a&#160;quasi-split,&#160;connected&#160;reductive<br/>group&#160;over&#160;F&#160;with&#160;simply-connected&#160;derived&#160;group,&#160;or&#160;the&#160;group&#160;attached&#160;to&#160;a&#160;division&#160;algebra&#160;D&#160;as&#160;in&#160;<a href="1711.02243s.html#13">§4.5.<br/></a>(This&#160;unwieldy&#160;hypothesis&#160;is&#160;in&#160;place&#160;because&#160;the&#160;statements&#160;of&#160;<a href="1711.02243s.html#40">[NND08]&#160;</a>and&#160;<a href="1711.02243s.html#40">[ND13]&#160;</a>use&#160;the&#160;first&#160;general<br/>hypothesis,&#160;but&#160;apply&#160;also&#160;D-shtukas,&#160;cf.&#160;<a href="1711.02243s.html#40">[Ngo06]&#160;</a>§4,&#160;and&#160;we&#160;are&#160;also&#160;interested&#160;in&#160;the&#160;latter.)&#160;Let&#160;G&#160;→&#160;X&#160;a<br/>parahoric&#160;group&#160;scheme,&#160;with&#160;parahoric&#160;reduction&#160;at&#160;x0.<br/>
Let&#160;Kv&#160;=&#160;G(Ov).&#160;Let&#160;Kvtβv&#160;Kv&#160;∈&#160;Kv\G(Fv)/Kv&#160;be&#160;a&#160;choice&#160;of&#160;double&#160;coset&#160;for&#160;all&#160;v,&#160;trivial&#160;for&#160;almost<br/>
all&#160;v.&#160;Let&#160;T&#160;′&#160;⊂&#160;X◦&#160;be&#160;the&#160;set&#160;of&#160;all&#160;v&#160;where&#160;βv&#160;6=&#160;0,&#160;i.e.&#160;where&#160;the&#160;corresponding&#160;Hecke&#160;operator&#160;hβ&#160;is&#160;not<br/>
v<br/>
the&#160;identity.&#160;We&#160;assume&#160;that&#160;Kv&#160;is&#160;hyperspecial&#160;for&#160;all&#160;v&#160;∈&#160;T&#160;′.<br/>
There&#160;is&#160;a&#160;Hecke&#160;correspondence&#160;(<a href="1711.02243s.html#12">§4.3.4)</a><br/>
Hecke(ShtG)≤βv<br/>
v<br/>
/aZ<br/>
h←<br/>
h→<br/>
(6.1)<br/>
ShtG&#160;/aZ<br/>
ShtG&#160;/aZ<br/>
π<br/>
π<br/>
X<br/>
for&#160;each&#160;βv.&#160;This&#160;induces&#160;a&#160;Hecke&#160;operator&#160;hβ&#160;on&#160;the&#160;cohomology&#160;of&#160;Sht<br/>
v<br/>
G&#160;/aZ&#160;(Definition&#160;<a href="1711.02243s.html#12">4.14)</a>.&#160;See&#160;<a href="1711.02243s.html#40">[NND08]</a><br/>
§3&#160;for&#160;more&#160;discussion&#160;about&#160;the&#160;Hecke&#160;correspondences.<br/>
Q<br/>
We&#160;abbreviate&#160;β&#160;:=&#160;(βv)v∈T′&#160;and&#160;denote&#160;the&#160;corresponding&#160;Hecke&#160;operator<br/>
hβ&#160;by&#160;h<br/>
v<br/>
β,T&#160;′&#160;.&#160;We&#160;want&#160;to<br/>
compute&#160;(a&#160;variant&#160;of)<br/>
Tr(hβ,T′&#160;◦&#160;Frob,&#160;π!RΨx&#160;(Sat<br/>
(µ)))<br/>
0<br/>
ShtG<br/>
where&#160;x0&#160;is&#160;our&#160;fixed&#160;place&#160;of&#160;parahoric&#160;reduction.&#160;By&#160;the&#160;Grothendieck-Lefschetz&#160;trace&#160;formula,&#160;we&#160;have<br/>
Tr(hβ,T′&#160;◦&#160;Frob,&#160;RΨx&#160;(Sat<br/>
(µ)))<br/>
0<br/>
ShtG<br/>
X<br/>
1<br/>
=<br/>
Tr(h<br/>
(Sat<br/>
(µ))<br/>
#&#160;Aut&#160;Ξ<br/>
β,T&#160;′&#160;◦&#160;FrobΞ,&#160;RΨx0<br/>
ShtG<br/>
Ξ).<br/>
Ξ∈Fix(hβ,T′&#160;◦Frob)<br/>
We&#160;will&#160;compute&#160;this&#160;by&#160;focusing&#160;first&#160;on&#160;counting&#160;Fix(Φβ,T&#160;◦&#160;Frob).&#160;This&#160;was&#160;done&#160;by&#160;<a href="1711.02243s.html#40">[Ngo06]&#160;</a>for&#160;D-<br/>
shtukas&#160;at&#160;points&#160;of&#160;with&#160;no&#160;level&#160;structure&#160;(good&#160;reduction),&#160;and&#160;extended&#160;by&#160;<a href="1711.02243s.html#40">[NND08]&#160;</a>for&#160;general&#160;reductive<br/>groups&#160;and&#160;<a href="1711.02243s.html#40">[ND13]&#160;</a>for&#160;more&#160;complicated&#160;setups;&#160;however,&#160;these&#160;counts&#160;only&#160;account&#160;for&#160;the&#160;contribution<br/>from&#160;the&#160;“elliptic&#160;part”.<br/>
In&#160;the&#160;case&#160;where&#160;GF&#160;is&#160;anisotropic&#160;mod&#160;center,&#160;the&#160;elliptic&#160;part&#160;will&#160;obviously&#160;compose&#160;everything.&#160;This<br/>
is&#160;one&#160;of&#160;the&#160;reasons&#160;why&#160;it&#160;is&#160;convenient&#160;to&#160;work&#160;with&#160;division&#160;algebras,&#160;and&#160;one&#160;of&#160;the&#160;difficulties&#160;in&#160;carrying<br/>out&#160;the&#160;strategy&#160;for&#160;general&#160;groups.&#160;Since&#160;ShtG&#160;is&#160;of&#160;infinite&#160;type&#160;in&#160;general,&#160;it&#160;will&#160;have&#160;infinitely&#160;many<br/>points&#160;even&#160;over&#160;finite&#160;fields,&#160;although&#160;the&#160;sum&#160;can&#160;still&#160;converge&#160;because&#160;of&#160;the&#160;weighting&#160;of&#160;automorphisms.<br/>
6.2.&#160;The&#160;groupoid&#160;of&#160;fixed&#160;points.&#160;We&#160;consider&#160;a&#160;slightly&#160;more&#160;general&#160;situation.&#160;We’ll&#160;define&#160;a&#160;groupoid<br/>C(α,&#160;β;&#160;T,&#160;T&#160;′;&#160;d)&#160;which&#160;occurs&#160;as&#160;the&#160;fixed&#160;points&#160;of&#160;a&#160;composition&#160;of&#160;Hecke&#160;and&#160;Frobenius&#160;operators&#160;on&#160;a<br/>certain&#160;moduli&#160;stack&#160;of&#160;shtukas.&#160;Then&#160;we&#160;will&#160;count&#160;its&#160;mass&#160;in&#160;the&#160;sense&#160;of&#160;groupoids.<br/>
Definition&#160;6.1.&#160;If&#160;C&#160;is&#160;a&#160;finite&#160;groupoid&#160;with&#160;finite&#160;automorphism&#160;groups&#160;then&#160;we&#160;define<br/>
X<br/>
1<br/>
#C&#160;:=<br/>
.<br/>
#&#160;Aut(c)<br/>
c∈C<br/>
Note&#160;that&#160;the&#160;Fq-points&#160;of&#160;a&#160;finite&#160;type&#160;Deligne-Mumford&#160;stack,&#160;which&#160;includes&#160;any&#160;Schubert&#160;cell&#160;in&#160;a&#160;moduli<br/>stack&#160;of&#160;shtukas,&#160;satisfies&#160;this&#160;assumption.<br/>
Definition&#160;6.2&#160;(<a href="1711.02243s.html#40">[NND08]&#160;</a>§4).&#160;Let&#160;T,&#160;T&#160;′&#160;⊂&#160;|X|&#160;−&#160;I.&#160;Let<br/>
α&#160;=&#160;(αv&#160;∈&#160;Kv\G(Fv)/Kv)v∈T<br/>β&#160;=&#160;(βv&#160;∈&#160;Kv\G(Fv)/Kv)v∈T′<br/>
(In&#160;terms&#160;of&#160;the&#160;notation&#160;of&#160;<a href="1711.02243s.html#21">§6.1,&#160;</a>we&#160;are&#160;identifying&#160;βv&#160;with&#160;Kvtβv&#160;Kv.)&#160;We&#160;define&#160;the&#160;groupoid&#160;of&#160;fixed<br/>points&#160;C(α,&#160;β;&#160;T,&#160;T&#160;′;&#160;d)&#160;as&#160;follows:&#160;its&#160;objects&#160;are&#160;triples&#160;(E,&#160;t,&#160;t′)&#160;with<br/>
(1)&#160;t&#160;:&#160;Eσ|<br/>
∼<br/>
−<br/>
→&#160;E|<br/>
,&#160;with&#160;modification&#160;type&#160;α&#160;on&#160;T&#160;,&#160;and<br/>
X−T<br/>
X−T<br/>
<hr/>
<a name=22></a><img class="yflip" src="html/1711.02243-22_1.png"/><br/>
<img class="yflip" src="html/1711.02243-22_2.png"/><br/>
<img class="yflip" src="html/1711.02243-22_3.png"/><br/>
<img class="yflip" src="html/1711.02243-22_4.png"/><br/>
<img class="yflip" src="html/1711.02243-22_5.png"/><br/>
<img class="yflip" src="html/1711.02243-22_6.png"/><br/>
<img class="yflip" src="html/1711.02243-22_7.png"/><br/>
<img class="yflip" src="html/1711.02243-22_8.png"/><br/>
<img class="yflip" src="html/1711.02243-22_9.png"/><br/>
<img class="yflip" src="html/1711.02243-22_10.png"/><br/>
<img class="yflip" src="html/1711.02243-22_11.png"/><br/>
<img class="yflip" src="html/1711.02243-22_12.png"/><br/>
<img class="yflip" src="html/1711.02243-22_13.png"/><br/>
<img class="yflip" src="html/1711.02243-22_14.png"/><br/>
<img class="yflip" src="html/1711.02243-22_15.png"/><br/>
<img class="yflip" src="html/1711.02243-22_16.png"/><br/>
<img class="yflip" src="html/1711.02243-22_17.png"/><br/>
<img class="yflip" src="html/1711.02243-22_18.png"/><br/>
<img class="yflip" src="html/1711.02243-22_19.png"/><br/>
<img class="yflip" src="html/1711.02243-22_20.png"/><br/>
<img class="yflip" src="html/1711.02243-22_21.png"/><br/>
<img class="yflip" src="html/1711.02243-22_22.png"/><br/>
22<br/>
TONY&#160;FENG<br/>
(2)&#160;t′&#160;:&#160;Eσd&#160;|<br/>
∼<br/>
′&#160;−<br/>
→&#160;E|<br/>
′&#160;,&#160;with&#160;modification&#160;type&#160;β&#160;on&#160;T&#160;′,<br/>
X−T<br/>
X−T<br/>
(3)&#160;satisfying&#160;the&#160;following&#160;compatibility:<br/>
σd(t)<br/>
Eσd+1&#160;|X−T−T′<br/>
Eσd&#160;|X−T−T′<br/>
σ(t′)<br/>
t′<br/>
Eσ|<br/>
t<br/>
X−T&#160;−T&#160;′<br/>
E|X−T−T′<br/>
The&#160;automorphisms&#160;of&#160;(E,&#160;t,&#160;t′)&#160;are&#160;defined&#160;to&#160;be&#160;automorphisms&#160;of&#160;E&#160;commuting&#160;with&#160;t&#160;and&#160;t′.<br/>
The&#160;relation&#160;to&#160;our&#160;initial&#160;problem&#160;is&#160;given&#160;by&#160;the&#160;following.<br/>
Lemma&#160;6.3.&#160;Suppose&#160;x&#160;∈&#160;|X|&#160;is&#160;a&#160;point&#160;of&#160;degree&#160;d.&#160;Then&#160;we&#160;have&#160;an&#160;isomorphism&#160;of&#160;groupoids<br/>
Fix(hβ,T′&#160;◦&#160;Frob,&#160;Sht=µ&#160;|<br/>
G<br/>
x)&#160;∼<br/>
=&#160;C(µ,&#160;β;&#160;{x},&#160;T&#160;′;&#160;d).<br/>
Proof.&#160;This&#160;is&#160;immediate&#160;upon&#160;writing&#160;down&#160;the&#160;definitions.<br/>
<br/>
We&#160;actually&#160;want&#160;to&#160;study&#160;the&#160;truncated&#160;space&#160;Sht=µ&#160;/aZ,&#160;so&#160;we&#160;modify&#160;the&#160;discussion&#160;accordingly.&#160;Let<br/>
G<br/>
J&#160;⊂&#160;Z(G)(A)&#160;be&#160;a&#160;cocompact&#160;lattice.&#160;Then&#160;J&#160;acts&#160;on&#160;Sht=µ&#160;via&#160;Hecke&#160;correspondences,&#160;and&#160;we&#160;define<br/>
G<br/>
Sht=µ&#160;/J&#160;to&#160;be&#160;the&#160;quotient.&#160;Similarly&#160;we&#160;define&#160;C(µ,&#160;β;&#160;{x},&#160;T&#160;′;&#160;d)<br/>
G<br/>
J&#160;to&#160;be&#160;the&#160;quotient&#160;by&#160;the&#160;J&#160;-action.&#160;(See<br/>
<a href="1711.02243s.html#40">[NND08]</a>,&#160;near&#160;the&#160;end&#160;of&#160;§4,&#160;for&#160;more&#160;details.)<br/>
Lemma&#160;6.4.&#160;Suppose&#160;x&#160;∈&#160;|X|&#160;is&#160;a&#160;point&#160;of&#160;degree&#160;d.&#160;Then&#160;we&#160;have&#160;an&#160;isomorphism&#160;of&#160;groupoids<br/>
Fix(hβ,T′&#160;◦&#160;Frobx,&#160;Sht=µ&#160;/J|<br/>
G<br/>
x)&#160;∼<br/>
=&#160;C(µ,&#160;β;&#160;{x},&#160;T&#160;′;&#160;d)J&#160;.<br/>
Hence&#160;we&#160;want&#160;to&#160;study&#160;#C(µ,&#160;β;&#160;{x},&#160;T&#160;′;&#160;d)J&#160;.&#160;The&#160;strategy&#160;for&#160;these&#160;counts&#160;goes&#160;back&#160;to&#160;Kottwitz’s&#160;study<br/>
of&#160;points&#160;of&#160;Shimura&#160;varieties&#160;(with&#160;hyperspecial&#160;level&#160;structure)&#160;over&#160;finite&#160;fields&#160;<a href="1711.02243s.html#39">[Kot92]</a>.<br/>
(1)&#160;We&#160;first&#160;show&#160;that&#160;there&#160;is&#160;a&#160;cohomological&#160;invariant,&#160;the&#160;Kottwitz&#160;invariant,&#160;which&#160;controls&#160;the<br/>
possible&#160;“generic&#160;fibers”&#160;of&#160;members&#160;of&#160;C(α,&#160;β;&#160;T,&#160;T&#160;′;&#160;d).<br/>
(2)&#160;We&#160;then&#160;express&#160;the&#160;size&#160;of&#160;an&#160;isogeny&#160;class&#160;as&#160;a&#160;product&#160;of&#160;(twisted)&#160;orbital&#160;integrals.<br/>(3)&#160;We&#160;then&#160;express&#160;the&#160;number&#160;of&#160;isogeny&#160;classes&#160;associated&#160;to&#160;each&#160;Kottwitz&#160;invariant&#160;in&#160;terms&#160;of<br/>
certain&#160;cohomology&#160;groups.<br/>
These&#160;steps&#160;have&#160;been&#160;carried&#160;out&#160;in&#160;papers&#160;of&#160;B.C.&#160;Ngô&#160;and&#160;T.&#160;Ngô&#160;Dac,&#160;as&#160;already&#160;mentioned,&#160;but&#160;not<br/>quite&#160;in&#160;the&#160;generality&#160;required&#160;here.&#160;In&#160;particular,&#160;these&#160;previous&#160;papers&#160;avoid&#160;the&#160;case&#160;where&#160;T&#160;meets&#160;a<br/>point&#160;with&#160;non-trivial&#160;level&#160;structure&#160;(because&#160;the&#160;moduli&#160;problem&#160;was&#160;not&#160;defined&#160;over&#160;such&#160;points),&#160;which<br/>is&#160;exactly&#160;the&#160;situation&#160;that&#160;we&#160;are&#160;interested&#160;in.&#160;So&#160;we&#160;will&#160;describe&#160;the&#160;modifications&#160;needed&#160;to&#160;extend<br/>the&#160;argument&#160;to&#160;our&#160;setting,&#160;and&#160;only&#160;briefly&#160;summarize&#160;the&#160;parts&#160;that&#160;are&#160;already&#160;covered&#160;in&#160;the&#160;papers&#160;of<br/>B.C.&#160;Ngô&#160;and&#160;T.&#160;Ngô&#160;Dac.<br/>
6.3.&#160;Kottwitz&#160;triples&#160;and&#160;classification&#160;of&#160;generic&#160;fibers.&#160;Our&#160;first&#160;step&#160;is&#160;to&#160;define&#160;a&#160;category&#160;that<br/>looks&#160;like&#160;the&#160;category&#160;of&#160;“generic&#160;fibers&#160;of&#160;C(α,&#160;β;&#160;T,&#160;T&#160;′;&#160;d)”.<br/>
Definition&#160;6.5&#160;(<a href="1711.02243s.html#40">[NND08]&#160;</a>§5).&#160;Let&#160;T,&#160;T&#160;′&#160;⊂&#160;|X|&#160;−&#160;I.&#160;We&#160;define&#160;the&#160;groupoid&#160;C(T,&#160;T&#160;′;&#160;d)&#160;as&#160;follows:&#160;its&#160;objects<br/>are&#160;triples&#160;(V,&#160;τ,&#160;τ&#160;′)&#160;with<br/>
(1)&#160;V&#160;a&#160;G-torsor&#160;over&#160;F&#160;:=&#160;F&#160;⊗<br/>
k<br/>
k&#160;k,<br/>
(2)&#160;an&#160;isomorphism&#160;τ&#160;:&#160;V&#160;σ&#160;∼<br/>
−<br/>
→&#160;V&#160;,&#160;where&#160;V&#160;σ&#160;=&#160;V&#160;⊗F&#160;,σ&#160;F&#160;,<br/>
k<br/>
k<br/>
(3)&#160;τ&#160;′&#160;:&#160;V&#160;σd&#160;∼<br/>
−<br/>
→&#160;V&#160;,<br/>
satisfying&#160;the&#160;following&#160;conditions:<br/>
(1)&#160;(“commutativity”)&#160;The&#160;following&#160;diagram&#160;commutes:<br/>
σd(τ&#160;)<br/>
V&#160;σd+1<br/>
V&#160;σd<br/>
σ(τ&#160;′)<br/>
τ&#160;′<br/>
V&#160;σ<br/>
τ<br/>
E<br/>
(2)&#160;For&#160;x&#160;/<br/>
∈&#160;T&#160;,&#160;(Vx,&#160;τx)&#160;is&#160;isomorphic&#160;to&#160;the&#160;trivial&#160;isocrystal&#160;(G(Fx&#160;b<br/>
⊗F&#160;F<br/>
σ).<br/>
q<br/>
q),&#160;Id&#160;b<br/>
⊗Fq<br/>
(3)&#160;For&#160;x&#160;∈&#160;T&#160;,&#160;(Vx,&#160;τ′x)&#160;is&#160;isomorphic&#160;to&#160;the&#160;trivial&#160;isocrystal&#160;(G(Fx&#160;b<br/>
⊗F&#160;F<br/>
σd).<br/>
q<br/>
q),&#160;Id&#160;b<br/>
⊗Fqd<br/>
<hr/>
<a name=23></a><img class="yflip" src="html/1711.02243-23_1.png"/><br/>
<img class="yflip" src="html/1711.02243-23_2.png"/><br/>
<img class="yflip" src="html/1711.02243-23_3.png"/><br/>
<img class="yflip" src="html/1711.02243-23_4.png"/><br/>
<img class="yflip" src="html/1711.02243-23_5.png"/><br/>
<img class="yflip" src="html/1711.02243-23_6.png"/><br/>
<img class="yflip" src="html/1711.02243-23_7.png"/><br/>
<img class="yflip" src="html/1711.02243-23_8.png"/><br/>
<img class="yflip" src="html/1711.02243-23_9.png"/><br/>
<img class="yflip" src="html/1711.02243-23_10.png"/><br/>
<img class="yflip" src="html/1711.02243-23_11.png"/><br/>
NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,&#160;AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
23<br/>
The&#160;automorphisms&#160;of&#160;(V,&#160;τ,&#160;τ&#160;′)&#160;are&#160;automorphisms&#160;of&#160;E&#160;commuting&#160;with&#160;τ&#160;and&#160;τ&#160;′.<br/>
The&#160;operation&#160;of&#160;“taking&#160;the&#160;generic&#160;fiber”&#160;defines&#160;a&#160;functor&#160;(<a href="1711.02243s.html#40">[NND08]&#160;</a>§5.2)<br/>
C(α,&#160;β;&#160;T,&#160;T&#160;′;&#160;d)&#160;→&#160;C(T,&#160;T&#160;′;&#160;d).<br/>
6.3.1.&#160;Kottwitz&#160;triples.&#160;Recall&#160;that&#160;a&#160;Kottwitz&#160;triple&#160;is&#160;a&#160;datum&#160;(γ0,&#160;(γx)x/∈T&#160;,&#160;(δx)x∈T&#160;)&#160;where:<br/>
•&#160;γ0&#160;is&#160;a&#160;stable&#160;conjugacy&#160;class&#160;of&#160;G(F&#160;),<br/>•&#160;γx&#160;is&#160;a&#160;conjugacy&#160;class&#160;of&#160;G(Fx)&#160;for&#160;each&#160;x&#160;/<br/>
∈&#160;T&#160;,&#160;and&#160;is&#160;stably&#160;conjugate&#160;to&#160;γ0,<br/>
•&#160;δx&#160;is&#160;a&#160;σ-conjugacy&#160;class&#160;of&#160;G(Fx&#160;b<br/>
⊗F&#160;F<br/>
q<br/>
qd&#160;),&#160;whose&#160;norm<br/>
N&#160;(δx)&#160;:=&#160;δx&#160;·&#160;σ(δx)&#160;·&#160;.&#160;.&#160;.&#160;·&#160;σd−1(δx)<br/>
is&#160;stably&#160;conjugate&#160;to&#160;γ0.<br/>
Construction&#160;6.6.&#160;We&#160;now&#160;recall&#160;from&#160;<a href="1711.02243s.html#40">[NND08]&#160;</a>§6.1&#160;how&#160;to&#160;attach&#160;to&#160;each&#160;(V,&#160;τ,&#160;τ&#160;′)&#160;∈&#160;C(T,&#160;T&#160;′;&#160;d)&#160;a<br/>Kottwitz&#160;triple&#160;(γ0,&#160;(γx)x/∈T&#160;,&#160;(δx)x∈T&#160;).<br/>
First&#160;a&#160;remark&#160;on&#160;notation:&#160;for&#160;a&#160;map&#160;τ&#160;:&#160;V&#160;σ&#160;→&#160;V&#160;,&#160;we&#160;denote&#160;by&#160;τ&#160;n&#160;:&#160;V&#160;σn&#160;→&#160;V&#160;the&#160;map&#160;τ&#160;◦&#160;σ(τ&#160;)&#160;◦&#160;.&#160;.&#160;.&#160;◦<br/>
σn−1(τ&#160;).<br/>
(1)&#160;Definition&#160;of&#160;γ0.&#160;Since&#160;F&#160;has&#160;cohomological&#160;dimension&#160;1,&#160;the&#160;G-torsor&#160;V&#160;is&#160;split&#160;over&#160;F&#160;.&#160;Consider<br/>
k<br/>
k<br/>
γ&#160;=&#160;τ&#160;d(τ&#160;′)−1,&#160;which&#160;is&#160;a&#160;linear&#160;automorphism&#160;of&#160;V&#160;.&#160;Using&#160;the&#160;“commutativity”&#160;axiom&#160;we&#160;find&#160;that<br/>
σ(γ)&#160;=&#160;σ(τ&#160;)&#160;◦&#160;σ2(τ&#160;)&#160;◦&#160;.&#160;.&#160;.&#160;◦&#160;σd(τ&#160;)&#160;◦&#160;σ(τ&#160;′)−1&#160;=&#160;τ&#160;−1γτ.<br/>
This&#160;shows&#160;that&#160;the&#160;conjugacy&#160;class&#160;of&#160;γ&#160;is&#160;stable&#160;under&#160;σ,&#160;hence&#160;defined&#160;over&#160;F&#160;.&#160;Since&#160;G&#160;was<br/>assumed&#160;to&#160;be&#160;quasi-split&#160;with&#160;simply&#160;connected&#160;derived&#160;subgroup,&#160;this&#160;conjugacy&#160;class&#160;must&#160;then<br/>contain&#160;an&#160;F&#160;-point.&#160;Thus,&#160;we&#160;have&#160;an&#160;element&#160;γ0&#160;∈&#160;G(F&#160;)&#160;with&#160;a&#160;well-defined&#160;stable&#160;conjugacy&#160;class.<br/>
(2)&#160;Definition&#160;of&#160;γx,&#160;x&#160;/<br/>
∈&#160;T&#160;.&#160;By&#160;assumption,&#160;we&#160;can&#160;pick&#160;an&#160;isomorphism<br/>
(Vx,&#160;τx)&#160;∼<br/>
=&#160;(G(Fx&#160;b<br/>
⊗F&#160;F<br/>
σ).<br/>
q<br/>
q&#160;),&#160;Id&#160;b<br/>
⊗Fq<br/>
Since&#160;τ&#160;and&#160;τ&#160;′&#160;commute,&#160;so&#160;do&#160;τx&#160;and&#160;τ′x,&#160;so&#160;that&#160;τ′x&#160;defines&#160;an&#160;automorphism&#160;of&#160;(G(Fx&#160;b<br/>
⊗F&#160;F<br/>
σ).<br/>
q<br/>
q&#160;),&#160;Id&#160;b<br/>
⊗Fq<br/>
We&#160;can&#160;then&#160;write&#160;τ&#160;′x&#160;=&#160;γ−1<br/>
x<br/>
⊗&#160;σd,&#160;for&#160;some&#160;γx&#160;∈&#160;G(Fx)&#160;which&#160;is&#160;stably&#160;conjugate&#160;to&#160;γ0.&#160;(The&#160;point<br/>
is&#160;that&#160;picking&#160;this&#160;trivialization&#160;of&#160;τx&#160;amounts&#160;to&#160;setting&#160;“τx&#160;=&#160;Id”&#160;in&#160;the&#160;equation&#160;γx&#160;=&#160;τdx(τ′x)−1.)<br/>
(3)&#160;Definition&#160;of&#160;δx,&#160;x&#160;∈&#160;T&#160;.&#160;By&#160;assumption,&#160;we&#160;can&#160;pick&#160;an&#160;isomorphism<br/>
(Vx,&#160;τ′x)&#160;∼<br/>
=&#160;(G(Fx&#160;b<br/>
⊗F&#160;F<br/>
σd).<br/>
q<br/>
q),&#160;Id&#160;b<br/>
⊗Fdq<br/>
Since&#160;τ&#160;and&#160;τ&#160;′&#160;commute,&#160;so&#160;do&#160;τx&#160;and&#160;τ′x,&#160;so&#160;that&#160;τx&#160;defines&#160;an&#160;automorphism&#160;of&#160;(G(Fx&#160;b<br/>
⊗F&#160;F<br/>
σ).<br/>
q<br/>
q&#160;),&#160;Id&#160;b<br/>
⊗Fq<br/>
We&#160;can&#160;then&#160;write&#160;τx&#160;=&#160;δx&#160;⊗&#160;σ,&#160;for&#160;some&#160;δx&#160;∈&#160;G(Fx),&#160;well-defined&#160;up&#160;to&#160;σ-conjugacy,&#160;whose&#160;norm<br/>N&#160;(δx)&#160;=&#160;δx&#160;·&#160;σ(δx)&#160;·&#160;.&#160;.&#160;.&#160;·&#160;σr−1(δx)&#160;is&#160;stably&#160;conjugate&#160;to&#160;γ0.<br/>
Definition&#160;6.7.&#160;We&#160;say&#160;that&#160;(V,&#160;τ,&#160;τ&#160;′)&#160;∈&#160;C(T,&#160;T&#160;′;&#160;d)&#160;is&#160;semisimple&#160;if&#160;γ0&#160;is&#160;semisimple,&#160;and&#160;elliptic&#160;if&#160;γ0&#160;is<br/>elliptic.<br/>
We&#160;say&#160;(E,&#160;t,&#160;t′)&#160;∈&#160;C(α,&#160;β;&#160;T,&#160;T&#160;′;&#160;d)&#160;is&#160;semisimple&#160;(resp.&#160;elliptic)&#160;if&#160;the&#160;associated&#160;(V,&#160;τ,&#160;τ&#160;′)&#160;is&#160;semisimple<br/>
(resp.&#160;elliptic).<br/>
6.3.2.&#160;The&#160;Kottwitz&#160;invariant.&#160;Following&#160;<a href="1711.02243s.html#40">[NND08]&#160;</a>§6.2&#160;we&#160;can&#160;attach&#160;to&#160;the&#160;Kottwitz&#160;triple&#160;(γ0,&#160;(γx),&#160;(δx))<br/>a&#160;character&#160;inv(γ0,&#160;(γx),&#160;(δx))&#160;∈&#160;X∗(Z(&#160;b<br/>
Gγ&#160;)Γ).&#160;Briefly,&#160;this&#160;is&#160;done&#160;as&#160;follows.<br/>
0<br/>
•&#160;For&#160;x&#160;/<br/>
∈&#160;T&#160;,&#160;since&#160;γx&#160;and&#160;γ0&#160;are&#160;stably&#160;conjugate,&#160;by&#160;a&#160;theorem&#160;of&#160;Steinberg&#160;we&#160;can&#160;find&#160;g&#160;∈&#160;G(Fx&#160;b<br/>
⊗kk)<br/>
such&#160;that<br/>
gγ0g−1&#160;=&#160;γx.<br/>
Then&#160;(using&#160;that&#160;γ0&#160;∈&#160;G(F&#160;))&#160;we&#160;have<br/>
gγ0g−1&#160;=&#160;γx&#160;=&#160;σ(γx)&#160;=&#160;σ(g)γ0σ(g)−1.<br/>
This&#160;shows&#160;that&#160;g−1σ(g)&#160;is&#160;in&#160;the&#160;centralizer&#160;of&#160;γ0&#160;in&#160;G(Fx&#160;b<br/>
⊗kk),&#160;hence&#160;defines&#160;a&#160;class&#160;in&#160;B(Gγ0,x)&#160;=<br/>
G(Fx&#160;b<br/>
⊗kk)/σ-conjugacy.<br/>
•&#160;For&#160;x&#160;∈&#160;T&#160;,&#160;we&#160;have&#160;g&#160;∈&#160;G(Fx&#160;b<br/>
⊗kk)&#160;such&#160;that&#160;N&#160;δx&#160;=&#160;gγ0g−1.&#160;Then&#160;g−1δxσ(g)&#160;is&#160;in&#160;Gγ&#160;(F<br/>
0<br/>
x&#160;b<br/>
⊗kk)&#160;and<br/>
defines&#160;a&#160;class&#160;in&#160;B(Gγ0,x).<br/>
<hr/>
<a name=24></a><img class="yflip" src="html/1711.02243-24_1.png"/><br/>
<img class="yflip" src="html/1711.02243-24_2.png"/><br/>
24<br/>
TONY&#160;FENG<br/>
For&#160;each&#160;x,&#160;we&#160;apply&#160;the&#160;map&#160;B(Gγ<br/>
)Γx&#160;)&#160;of&#160;<a href="1711.02243s.html#39">[Kot90]&#160;</a>§6&#160;to&#160;get&#160;a&#160;local&#160;character&#160;inv<br/>
0&#160;,x)&#160;→&#160;X&#160;∗(Z&#160;(&#160;b<br/>
Gγ0<br/>
x(γ0,&#160;(γx),&#160;(δx))&#160;∈<br/>
X∗(Z(&#160;b<br/>
Gγ&#160;)Γx&#160;).&#160;Almost&#160;all&#160;of&#160;the&#160;resulting&#160;characters&#160;are&#160;trivial,&#160;so&#160;that&#160;it&#160;makes&#160;sense&#160;to&#160;sum&#160;the&#160;restrictions<br/>
0<br/>
of&#160;all&#160;these&#160;characters&#160;to&#160;Z(&#160;b<br/>
Gγ&#160;)Γ,&#160;and&#160;we&#160;define&#160;this&#160;sum&#160;to&#160;be&#160;inv(γ<br/>
0<br/>
0,&#160;(γx),&#160;(δx)).<br/>
Proposition&#160;6.8.&#160;<a href="1711.02243s.html#40">[NND08]&#160;</a>For&#160;elliptic&#160;(V,&#160;τ,&#160;τ&#160;′)&#160;∈&#160;C(T,&#160;T&#160;′;&#160;d),&#160;and&#160;(γ0,&#160;(γx),&#160;(δx))&#160;the&#160;associated&#160;Kottwitz<br/>triple,&#160;if&#160;γ0&#160;is&#160;semisimple&#160;then&#160;we&#160;have&#160;inv(γ0,&#160;(γx),&#160;(δx))&#160;=&#160;0.<br/>
Proposition&#160;6.9.&#160;There&#160;exists&#160;(V,&#160;τ,&#160;τ&#160;′)&#160;∈&#160;C(T,&#160;T&#160;′;&#160;d)&#160;having&#160;a&#160;given&#160;elliptic&#160;Kottwitz&#160;triple&#160;(γ0,&#160;(γx),&#160;(δx))<br/>if&#160;and&#160;only&#160;if&#160;inv(γ0,&#160;(γx),&#160;(δx))&#160;=&#160;0.&#160;If&#160;the&#160;set&#160;of&#160;such&#160;is&#160;non-empty,&#160;then&#160;the&#160;number&#160;of&#160;isogeny&#160;classes<br/>within&#160;C(T,&#160;T&#160;′;&#160;d)&#160;having&#160;the&#160;same&#160;Kottwitz&#160;triple&#160;is&#160;the&#160;cardinality&#160;of<br/>
Y<br/>
ker1(F,&#160;Gγ&#160;)&#160;:=&#160;ker(H1(F,&#160;G&#160;)&#160;→<br/>
H1(F<br/>
)).<br/>
0<br/>
γ0<br/>
x,&#160;Gγ0<br/>
x<br/>
Proof.&#160;This&#160;follows&#160;from&#160;the&#160;proof&#160;of&#160;<a href="1711.02243s.html#40">[NND08]&#160;</a>Proposition&#160;11.1&#160;combined&#160;with&#160;<a href="1711.02243s.html#40">[ND13]&#160;</a>Proposition&#160;4.3.&#160;<br/>
6.3.3.&#160;Automorphisms&#160;of&#160;the&#160;generic&#160;fiber.&#160;Let&#160;(V,&#160;τ,&#160;τ&#160;′)&#160;∈&#160;C(T,&#160;T&#160;′;&#160;d)&#160;with&#160;elliptic&#160;Kottwitz&#160;triple&#160;(γ0,&#160;(γx),&#160;(δx)).<br/>By&#160;<a href="1711.02243s.html#40">[ND13]&#160;</a>§3.9,&#160;the&#160;automorphisms&#160;of&#160;(V,&#160;τ,&#160;τ&#160;′)&#160;are&#160;the&#160;Fx-points&#160;of&#160;an&#160;inner&#160;form&#160;Jγ&#160;of&#160;G<br/>
defined&#160;over<br/>
0<br/>
γ0<br/>
F&#160;.<br/>
Remark&#160;6.10.&#160;As&#160;pointed&#160;out&#160;in&#160;<a href="1711.02243s.html#40">[ND13]&#160;</a>§3.9,&#160;the&#160;Hasse&#160;principle&#160;implies&#160;that&#160;Jγ&#160;is&#160;determined&#160;by&#160;its<br/>
0<br/>
local&#160;components:<br/>
•&#160;For&#160;x&#160;/<br/>
∈&#160;T&#160;,&#160;Jγ0,x&#160;is&#160;the&#160;centralizer&#160;of&#160;γx&#160;in&#160;G(Fx),<br/>
•&#160;For&#160;x&#160;∈&#160;T&#160;,&#160;Jγ<br/>
F<br/>
0&#160;,x&#160;is&#160;the&#160;twisted&#160;centralizer&#160;of&#160;δx&#160;in&#160;G(Fx&#160;⊗Fq<br/>
qd&#160;).<br/>
6.4.&#160;Counting&#160;lattices.&#160;We&#160;now&#160;study&#160;the&#160;fibers&#160;of&#160;the&#160;functor&#160;C(α,&#160;β;&#160;T,&#160;T&#160;′;&#160;d)&#160;→&#160;C(T,&#160;T&#160;′;&#160;d).<br/>
Proposition&#160;6.11.&#160;Fix&#160;an&#160;elliptic&#160;(V,&#160;τ,&#160;τ&#160;′)&#160;∈&#160;C(T,&#160;T&#160;′;&#160;d).&#160;Suppose&#160;(E,&#160;t,&#160;t′)&#160;∈&#160;C(α,&#160;β;&#160;T,&#160;T&#160;′;&#160;d)&#160;lies&#160;over<br/>(V,&#160;τ,&#160;τ&#160;′).&#160;The&#160;size&#160;of&#160;the&#160;isogeny&#160;class&#160;of&#160;(E,&#160;t,&#160;t′)&#160;is<br/>
Y<br/>
Y<br/>
vol(J&#160;·&#160;Jγ&#160;(F&#160;)\G&#160;(A))&#160;·<br/>
O&#160;(φ&#160;)<br/>
TO<br/>
).<br/>
0<br/>
γ0<br/>
γx<br/>
βx<br/>
δxσ&#160;(φαx<br/>
x&#160;/<br/>
∈T<br/>
x∈T<br/>
Here&#160;we&#160;normalize&#160;Haar&#160;measures&#160;as&#160;in&#160;<a href="1711.02243s.html#4">§2.1.1.</a><br/>
Proof.&#160;Promoting&#160;(V,&#160;τ,&#160;τ&#160;′)&#160;to&#160;(E,&#160;t,&#160;t′)&#160;amounts&#160;to&#160;choosing&#160;a&#160;Gx&#160;b<br/>
⊗kk-bundle&#160;over&#160;Spec&#160;Ox&#160;for&#160;all&#160;x&#160;∈&#160;X,&#160;plus<br/>
an&#160;I-level&#160;structure,&#160;such&#160;that<br/>
•&#160;for&#160;v&#160;/<br/>
∈&#160;|T&#160;|,&#160;Ex&#160;is&#160;fixed&#160;by&#160;τ,<br/>
•&#160;for&#160;v&#160;/<br/>
∈&#160;|T&#160;|′,&#160;Ex&#160;is&#160;fixed&#160;by&#160;τ′,<br/>
•&#160;for&#160;x&#160;∈&#160;|T&#160;|,&#160;the&#160;relative&#160;position&#160;of&#160;Ex&#160;and&#160;τ(Ex)&#160;is&#160;given&#160;by&#160;αx,<br/>•&#160;for&#160;v&#160;∈&#160;|T&#160;|′&#160;(hence&#160;outside&#160;|T&#160;|),&#160;the&#160;relative&#160;position&#160;of&#160;Ev&#160;and&#160;τ′(Ev)&#160;is&#160;given&#160;by&#160;βv.<br/>
As&#160;is&#160;well-known&#160;(cf.&#160;<a href="1711.02243s.html#40">[NND08]&#160;</a>§9&#160;or&#160;<a href="1711.02243s.html#40">[ND13]&#160;</a>§5&#160;for&#160;the&#160;present&#160;situation;&#160;the&#160;earliest&#160;reference&#160;we&#160;know&#160;is<br/><a href="1711.02243s.html#39">[Kot80]</a>),&#160;this&#160;is&#160;counted&#160;by<br/>
Z<br/>
O<br/>
O<br/>
φ<br/>
(h−1<br/>
φ&#160;(h−1<br/>
Q<br/>
αx<br/>
x&#160;δxσ(hx))<br/>
βx<br/>
x&#160;γxhx)&#160;dh.<br/>
J·Jγ&#160;(F&#160;)\<br/>
G(F<br/>
F<br/>
0<br/>
x∈T<br/>
x&#160;⊗Fq<br/>
qd&#160;)×G(AT&#160;)&#160;x∈T<br/>
x&#160;/<br/>
∈T<br/>
Here&#160;we&#160;use&#160;Remark&#160;<a href="1711.02243s.html#24">6.10&#160;</a>to&#160;view&#160;Jγ&#160;(F&#160;)&#160;as&#160;a&#160;subset&#160;of&#160;G(F<br/>
0<br/>
x).<br/>
The&#160;statement&#160;of&#160;the&#160;proposition&#160;is&#160;a<br/>
straightforward&#160;rewriting&#160;of&#160;this&#160;formula.<br/>
<br/>
6.5.&#160;Count&#160;of&#160;elliptic&#160;elements.&#160;Define<br/>
X<br/>
1<br/>
#C(α,&#160;β;&#160;T,&#160;T&#160;′;&#160;d)ell&#160;:=<br/>
.<br/>
#&#160;Aut(E,&#160;t,&#160;t′)<br/>
(E,t,t′)&#160;elliptic<br/>
Combining&#160;Proposition&#160;<a href="1711.02243s.html#24">6.9,&#160;§6.3.3,&#160;</a>and&#160;Proposition&#160;<a href="1711.02243s.html#24">6.11,&#160;</a>we&#160;obtain:<br/>
<hr/>
<a name=25></a><img class="yflip" src="html/1711.02243-25_1.png"/><br/>
NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,&#160;AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
25<br/>
Theorem&#160;6.12.&#160;We&#160;have<br/>
X<br/>
#C(α,&#160;β;&#160;T,&#160;T&#160;′;&#160;d)ell&#160;=<br/>
ker1(F,&#160;Gγ&#160;)&#160;·&#160;vol(J&#160;·&#160;J&#160;(F&#160;)\J&#160;(A<br/>
0<br/>
γ0<br/>
γ0<br/>
F&#160;))&#160;·&#160;dg(K&#160;)−1<br/>
(γ0,(γx),(δx))<br/>
inv(γ0,(γx),(δx))=0<br/>
γ0&#160;elliptic<br/>
&#160;<br/>
!<br/>
Y<br/>
Y<br/>
·<br/>
Oγ&#160;(f&#160;)<br/>
TO<br/>
)<br/>
x<br/>
βv<br/>
δxσ&#160;(fαx<br/>
x&#160;/<br/>
∈T<br/>
x∈|T&#160;|<br/>
Remark&#160;6.13.&#160;This&#160;is&#160;the&#160;analogue&#160;of&#160;<a href="1711.02243s.html#40">[ND13]&#160;</a>Théorème&#160;5.1.&#160;The&#160;expressions&#160;look&#160;almost&#160;the&#160;same,&#160;but<br/>one&#160;should&#160;keep&#160;in&#160;mind&#160;that&#160;in&#160;our&#160;applications&#160;T&#160;=&#160;{x0},&#160;and&#160;fα<br/>
should&#160;be&#160;thought&#160;of&#160;as&#160;an&#160;indicator<br/>
x0<br/>
function&#160;on&#160;a&#160;partial&#160;affine&#160;flag&#160;variety&#160;rather&#160;than&#160;an&#160;affine&#160;Grassmannian.&#160;In&#160;addition,&#160;the&#160;measure&#160;of&#160;Kx0<br/>is&#160;adapted&#160;accordingly.<br/>
Corollary&#160;6.14.&#160;Let&#160;Sht≤µ&#160;/aZ&#160;be&#160;the&#160;moduli&#160;stack&#160;of&#160;D-shtukas&#160;with&#160;parahoric&#160;level&#160;structure&#160;at&#160;x<br/>
G<br/>
0,&#160;as&#160;in<br/>
<a href="1711.02243s.html#13">§4.5.&#160;</a>Then<br/>
X<br/>
#&#160;Fix(hβ,T′&#160;◦&#160;Frob,&#160;Sht=µ&#160;/aZ|&#160;)&#160;=<br/>
ker1(F,&#160;G&#160;)&#160;·&#160;vol(aZ&#160;·&#160;J&#160;(F&#160;)\J&#160;(A<br/>
G<br/>
x0<br/>
γ0<br/>
γ0<br/>
γ0<br/>
F&#160;))·<br/>
(γ0,(γx),(δx))<br/>
inv(γ0,(γx),(δx))=0<br/>
&#160;<br/>
!<br/>
Y<br/>
·&#160;dg(K)−1&#160;·<br/>
Oγ&#160;(f&#160;)&#160;·&#160;TO<br/>
x<br/>
βv<br/>
δx&#160;σ&#160;(fµ).<br/>
0<br/>
x&#160;/<br/>
∈T<br/>
Proof.&#160;This&#160;is&#160;immediate&#160;from&#160;Lemma&#160;<a href="1711.02243s.html#22">6.4&#160;</a>and&#160;the&#160;observation&#160;that&#160;every&#160;non-zero&#160;element&#160;of&#160;a&#160;division<br/>algebra&#160;is&#160;elliptic,&#160;since&#160;the&#160;associated&#160;group&#160;of&#160;units&#160;is&#160;anisotropic&#160;mod&#160;center.&#160;(As&#160;mentioned&#160;at&#160;the<br/>beginning&#160;of&#160;<a href="1711.02243s.html#20">§6,&#160;</a>the&#160;results&#160;used&#160;from&#160;<a href="1711.02243s.html#40">[NND08]&#160;</a>and&#160;<a href="1711.02243s.html#40">[ND13]&#160;</a>also&#160;apply&#160;to&#160;D-shtukas,&#160;and&#160;in&#160;fact&#160;were<br/>originally&#160;proved&#160;for&#160;this&#160;case&#160;in&#160;<a href="1711.02243s.html#40">[Ngo06]&#160;</a>§4.)<br/>
<br/>
7.&#160;Geometrization&#160;of&#160;base&#160;change&#160;for&#160;Hecke&#160;algebras<br/>
In&#160;this&#160;section&#160;we&#160;present&#160;a&#160;geometric&#160;interpretation&#160;of&#160;the&#160;base&#160;change&#160;homomorphism&#160;for&#160;spherical<br/>
Hecke&#160;algebras,&#160;and&#160;then&#160;for&#160;the&#160;center&#160;of&#160;parahoric&#160;Hecke&#160;algebras.&#160;The&#160;results&#160;here&#160;are&#160;a&#160;generalization<br/>to&#160;arbitrary&#160;split&#160;reductive&#160;groups&#160;G&#160;of&#160;results&#160;from&#160;<a href="1711.02243s.html#40">[Ngo99]</a>,&#160;which&#160;proved&#160;the&#160;result&#160;for&#160;GLn.<br/>
Using&#160;the&#160;work&#160;of&#160;Gaitsgory&#160;on&#160;realizing&#160;central&#160;sheaves&#160;on&#160;the&#160;affine&#160;flag&#160;variety&#160;as&#160;nearby&#160;cycles,&#160;we<br/>
then&#160;deduce&#160;a&#160;geometric&#160;interpretation&#160;of&#160;base&#160;change&#160;for&#160;the&#160;center&#160;of&#160;the&#160;parahoric&#160;Hecke&#160;algebra.<br/>
7.1.&#160;Definition&#160;of&#160;base&#160;change&#160;homomorphism.&#160;For&#160;this&#160;section&#160;only,&#160;we&#160;let&#160;F&#160;be&#160;a&#160;local&#160;field&#160;and&#160;G<br/>be&#160;a&#160;reductive&#160;group&#160;over&#160;F&#160;.&#160;Given&#160;a&#160;compact&#160;open&#160;subgroup&#160;H&#160;⊂&#160;G(F&#160;),&#160;we&#160;have&#160;the&#160;Hecke&#160;algebra<br/>
HG,H&#160;:=&#160;Func(H\G(F&#160;)/H,&#160;Qℓ).<br/>
We&#160;begin&#160;by&#160;defining&#160;base&#160;change&#160;homomorphisms&#160;for&#160;some&#160;Hecke&#160;algebras&#160;with&#160;respect&#160;to&#160;a&#160;degree&#160;r<br/>unramified&#160;extension&#160;of&#160;local&#160;fields&#160;E/F&#160;.<br/>
For&#160;simplicity&#160;we&#160;assume&#160;that&#160;G&#160;is&#160;split&#160;over&#160;F&#160;.&#160;(Our&#160;results&#160;should&#160;extend&#160;at&#160;least&#160;to&#160;quasi-split&#160;G<br/>
without&#160;much&#160;difficulty.)&#160;We&#160;let&#160;E/F&#160;be&#160;the&#160;unramified&#160;extension&#160;of&#160;degree&#160;r.<br/>
Definition&#160;7.1&#160;(<a href="1711.02243s.html#39">[Hai09]&#160;</a>§1).&#160;Let&#160;K&#160;⊂&#160;G(F&#160;)&#160;be&#160;a&#160;hyperspecial&#160;maximal&#160;compact&#160;subgroup.&#160;The&#160;base&#160;change<br/>homomorphism&#160;for&#160;spherical&#160;Hecke&#160;algebras&#160;(with&#160;respect&#160;to&#160;E/F&#160;)&#160;is&#160;the&#160;homomorphism&#160;of&#160;C-algebras<br/>
HG(E),K&#160;→&#160;HG(F),K<br/>
characterized&#160;by&#160;the&#160;following&#160;property.&#160;Let&#160;WF&#160;be&#160;the&#160;Weil&#160;group&#160;of&#160;F&#160;.&#160;For&#160;an&#160;admissible&#160;unramified<br/>homomorphism&#160;ψ&#160;:&#160;WF&#160;→&#160;LG&#160;let&#160;ψ′&#160;:&#160;WE&#160;→&#160;LG&#160;denote&#160;the&#160;restriction&#160;to&#160;WE&#160;⊂&#160;WF&#160;.&#160;Let&#160;πψ&#160;and&#160;πψ′&#160;denote<br/>the&#160;corresponding&#160;representations&#160;of&#160;G(E)&#160;and&#160;G(F&#160;)&#160;under&#160;the&#160;Local&#160;Langlands&#160;Correspondence.&#160;Then&#160;for<br/>any&#160;φ&#160;∈&#160;HG(E),K&#160;we&#160;have<br/>
htrace&#160;πψ′,&#160;φi&#160;=&#160;htrace&#160;πψ,&#160;b(φ)i<br/>
Definition&#160;7.2&#160;(<a href="1711.02243s.html#39">[Hai09]&#160;</a>§1).&#160;Let&#160;J&#160;⊂&#160;K&#160;be&#160;a&#160;parahoric&#160;subgroup&#160;and&#160;IK&#160;denote&#160;the&#160;characteristic&#160;function<br/>of&#160;K&#160;⊂&#160;G(F&#160;).&#160;By&#160;a&#160;theorem&#160;of&#160;Bernstein&#160;(cf.&#160;<a href="1711.02243s.html#39">[Hai09]&#160;</a>Theorem&#160;3.1.1),&#160;convolution&#160;with&#160;IK&#160;defines&#160;an<br/>isomorphism<br/>
−&#160;∗J&#160;IK&#160;:&#160;Z(HG,J)&#160;∼<br/>
−<br/>
→&#160;HG,K.<br/>
<hr/>
<a name=26></a><img class="yflip" src="html/1711.02243-26_1.png"/><br/>
<img class="yflip" src="html/1711.02243-26_2.png"/><br/>
<img class="yflip" src="html/1711.02243-26_3.png"/><br/>
<img class="yflip" src="html/1711.02243-26_4.png"/><br/>
<img class="yflip" src="html/1711.02243-26_5.png"/><br/>
26<br/>
TONY&#160;FENG<br/>
We&#160;define&#160;the&#160;base&#160;change&#160;homomorphism&#160;for&#160;parahoric&#160;Hecke&#160;algebras&#160;to&#160;be&#160;the&#160;homomorphism<br/>
b&#160;:&#160;HG(E),J&#160;→&#160;HG(F),J<br/>
making&#160;the&#160;following&#160;diagram&#160;commute:<br/>
Z(H<br/>
b<br/>
G(E),J&#160;)<br/>
Z(HG(F),J&#160;)<br/>
∼&#160;−∗<br/>
(7.1)<br/>
J&#160;IK<br/>
∼&#160;−∗J&#160;IK<br/>
H<br/>
b<br/>
G(E),K<br/>
HG(F),K<br/>
7.1.1.&#160;Interpretation&#160;under&#160;Satake&#160;isomorphism.&#160;Let&#160;T&#160;⊂&#160;G&#160;be&#160;a&#160;maximal&#160;torus.&#160;We&#160;have&#160;the&#160;Satake<br/>isomorphism<br/>
S&#160;:&#160;H<br/>
∼<br/>
G,K&#160;−<br/>
→&#160;Qℓ[X∗(T&#160;)]W<br/>
where&#160;W&#160;is&#160;the&#160;Weyl&#160;group&#160;of&#160;G&#160;relative&#160;to&#160;T&#160;.&#160;We&#160;also&#160;have&#160;the&#160;Bernstein&#160;isomorphism<br/>
B&#160;:&#160;Z(HG,J&#160;)&#160;∼<br/>
−<br/>
→&#160;HG,K.<br/>
We&#160;can&#160;define&#160;the&#160;base&#160;change&#160;homomorphism&#160;on&#160;the&#160;Satake&#160;side&#160;as&#160;follows.&#160;We&#160;define&#160;the&#160;norm&#160;homo-<br/>
morphism<br/>
N&#160;:&#160;Qℓ[X∗(TE)]W&#160;→&#160;Qℓ[X∗(TF&#160;)]W<br/>
to&#160;be&#160;that&#160;induced&#160;by&#160;the&#160;norm&#160;TE&#160;→&#160;TF&#160;.&#160;Since&#160;we&#160;are&#160;working&#160;in&#160;the&#160;split&#160;setting,&#160;this&#160;simply&#160;corresponds<br/>
∼<br/>
to&#160;multiplication&#160;by&#160;r&#160;on&#160;X∗(TE)&#160;−→&#160;Zn.<br/>
Then&#160;b&#160;:&#160;HG(E),J&#160;→&#160;HG(F),J&#160;is&#160;determined&#160;by&#160;the&#160;commutativity&#160;of&#160;the&#160;following&#160;diagram&#160;(<a href="1711.02243s.html#39">[Hai09]</a>,&#160;§3.2)<br/>
Z(H<br/>
b<br/>
G(E),J&#160;)<br/>
Z(HG(F),J)<br/>
∼&#160;−∗J&#160;IK<br/>
∼&#160;−∗J&#160;IK<br/>
H<br/>
b<br/>
(7.2)<br/>
G(E),K<br/>
HG(F),K<br/>
∼&#160;S<br/>
∼&#160;S<br/>
C[X<br/>
N<br/>
∗(TE&#160;)]W<br/>
C[X∗(TF&#160;)]W&#160;(F&#160;)<br/>
For&#160;more&#160;on&#160;the&#160;base&#160;change&#160;homomorphism,&#160;see&#160;<a href="1711.02243s.html#39">[Hai09]&#160;</a>§3.<br/>
7.2.&#160;Geometrization&#160;of&#160;the&#160;Satake&#160;transform.&#160;In&#160;this&#160;section&#160;we&#160;will&#160;recall&#160;a&#160;geometric&#160;interpretation<br/>of&#160;the&#160;Satake&#160;transform.<br/>
7.2.1.&#160;The&#160;classical&#160;Satake&#160;transform.&#160;We&#160;first&#160;review&#160;the&#160;Satake&#160;transform&#160;(cf.&#160;<a href="1711.02243s.html#39">[Gro98]</a>).&#160;Let&#160;HG,K&#160;be<br/>the&#160;spherical&#160;Hecke&#160;algebra&#160;of&#160;G(F&#160;)&#160;with&#160;respect&#160;to&#160;a&#160;hyperspecial&#160;maximal&#160;compact&#160;subgroup&#160;K.&#160;Let<br/>HT&#160;=&#160;Qℓ[X∗(T&#160;)].<br/>
We&#160;choose&#160;a&#160;Borel&#160;subgroup&#160;B&#160;containing&#160;T&#160;and&#160;let&#160;N&#160;be&#160;its&#160;unipotent&#160;radical.&#160;There&#160;is&#160;a&#160;Satake<br/>
transform&#160;S&#160;:&#160;HG,K&#160;→&#160;HT&#160;given&#160;by<br/>
Z<br/>
Sf&#160;(t)&#160;=&#160;δ(t)1/2<br/>
f&#160;(tx)dx,<br/>
N<br/>
where&#160;the&#160;Haar&#160;measure&#160;dx&#160;is&#160;normalized&#160;to&#160;assign&#160;volume&#160;1&#160;to&#160;N&#160;(Ot).<br/>
Theorem&#160;7.3&#160;(Satake).&#160;The&#160;Satake&#160;transform&#160;gives&#160;a&#160;ring&#160;isomorphism<br/>
S&#160;:&#160;H<br/>
∼<br/>
G,K&#160;=&#160;R(&#160;b<br/>
G)&#160;∼<br/>
=&#160;HW<br/>
T<br/>
where&#160;R(&#160;b<br/>
G)&#160;is&#160;the&#160;representation&#160;ring&#160;of&#160;b<br/>
G&#160;with&#160;Qℓ-coefficients.<br/>
We&#160;have&#160;an&#160;isomorphism<br/>
H&#160;∼<br/>
T&#160;=&#160;Qℓ[X∗(T&#160;)].<br/>
For&#160;λ&#160;∈&#160;X∗(T&#160;),&#160;write&#160;tλ&#160;for&#160;the&#160;corresponding&#160;element&#160;of&#160;HT&#160;.&#160;Then&#160;we&#160;may&#160;write<br/>
Z<br/>
Sf&#160;(tλ)&#160;=&#160;δ(tλ)1/2<br/>
f&#160;(tλx)dx.<br/>
(7.3)<br/>
N<br/>
<hr/>
<a name=27></a><img class="yflip" src="html/1711.02243-27_1.png"/><br/>
<img class="yflip" src="html/1711.02243-27_2.png"/><br/>
<img class="yflip" src="html/1711.02243-27_3.png"/><br/>
<img class="yflip" src="html/1711.02243-27_4.png"/><br/>
NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,&#160;AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
27<br/>
7.2.2.&#160;Interpretation&#160;via&#160;semi-infinite&#160;orbits.&#160;We&#160;will&#160;interpret&#160;the&#160;function&#160;<a href="1711.02243s.html#26">(7.3)&#160;</a>geometrically,&#160;as&#160;the&#160;trace<br/>function&#160;associated&#160;to&#160;a&#160;certain&#160;subscheme&#160;Sλ,&#160;studied&#160;by&#160;Mirkovic-Vilonen&#160;in&#160;<a href="1711.02243s.html#40">[MV07]&#160;</a>§3,&#160;in&#160;the&#160;sense&#160;that<br/>if&#160;fF&#160;is&#160;the&#160;trace&#160;function&#160;associated&#160;to&#160;F,&#160;then<br/>
SfF&#160;(tλ)&#160;=&#160;q−ρ(λ)&#160;Tr(Frob,&#160;RΓc(Sλ&#160;⊗k&#160;k,&#160;F))<br/>
where&#160;ρ&#160;is&#160;the&#160;usual&#160;half&#160;sum&#160;of&#160;the&#160;positive&#160;roots.<br/>
Following&#160;the&#160;notation&#160;of&#160;<a href="1711.02243s.html#40">[MV07]</a>,&#160;for&#160;λ&#160;∈&#160;X∗(T&#160;)&#160;we&#160;let&#160;Lλ&#160;=&#160;tλG(O)&#160;denote&#160;the&#160;image&#160;of&#160;λ&#160;in&#160;the&#160;affine<br/>
Grassmannian&#160;GrG,&#160;and&#160;Sλ&#160;be&#160;its&#160;orbit&#160;under&#160;NF&#160;.<br/>
Lemma&#160;7.4.&#160;Let&#160;F&#160;be&#160;a&#160;sheaf&#160;on&#160;GrG&#160;defined&#160;over&#160;k,&#160;and&#160;fF&#160;its&#160;associated&#160;trace&#160;function&#160;(cf.&#160;<a href="1711.02243s.html#16">(5.2)</a>).&#160;Then<br/>we&#160;have<br/>
SfF&#160;(tλ)&#160;=&#160;q−ρ(λ)&#160;Tr(Frob,&#160;RΓc(Sλ&#160;⊗k&#160;k,&#160;F)).<br/>
Proof.&#160;We&#160;study&#160;the&#160;rational&#160;points&#160;Sλ(k),&#160;in&#160;preparation&#160;for&#160;an&#160;application&#160;of&#160;the&#160;Grothendieck-Lefschetz<br/>trace&#160;formula.&#160;The&#160;stabilizer&#160;of&#160;tλ&#160;is<br/>
StabN(F)(Lλ)&#160;=&#160;{n&#160;∈&#160;N&#160;(F&#160;):&#160;ntλG(O)&#160;=&#160;tλG(O)}<br/>
=&#160;{n&#160;∈&#160;N&#160;(F&#160;)&#160;:&#160;t−λntλ&#160;∈&#160;G(O)}.<br/>
This&#160;says&#160;that&#160;the&#160;map&#160;n&#160;7→&#160;t−λntλ&#160;defines&#160;a&#160;bijection&#160;between&#160;StabN(F)(Lλ)&#160;and&#160;N&#160;(O).&#160;Therefore&#160;the&#160;map<br/>n&#160;7→&#160;tλn&#160;defines&#160;a&#160;bijection&#160;between&#160;Sλ&#160;=&#160;[N&#160;(F&#160;)/&#160;StabN(F)(Lλ)]&#160;·&#160;Lλ&#160;and&#160;N&#160;(F&#160;)/N&#160;(O).&#160;An&#160;application&#160;of<br/>the&#160;Grothendieck-Lefschetz&#160;trace&#160;formula&#160;then&#160;yields<br/>
X<br/>
Tr(Frob,&#160;RΓc(Sλ&#160;⊗k&#160;k,&#160;F))&#160;=<br/>
fF&#160;(n)<br/>
n∈Sλ(k)<br/>
X<br/>
=<br/>
fF&#160;(tλ&#160;·&#160;n)<br/>
n∈N&#160;(F&#160;)/N&#160;(O)<br/>
which&#160;is&#160;exactly&#160;what&#160;was&#160;claimed&#160;upon&#160;recalling&#160;that&#160;δ(tλ)&#160;=&#160;qρ(λ).<br/>
<br/>
Theorem&#160;7.5&#160;(Mirkovic-Vilonen).&#160;There&#160;is&#160;a&#160;natural&#160;equivalence&#160;of&#160;functors<br/>
M<br/>
H∗(−)&#160;∼<br/>
=<br/>
H2ρ(λ)<br/>
c<br/>
(Sλ,&#160;−):&#160;PG&#160;(Gr<br/>
.<br/>
O<br/>
G,&#160;Qℓ)&#160;→&#160;ModQℓ<br/>
λ∈X∗(T&#160;)<br/>
Proof.&#160;This&#160;is&#160;a&#160;result&#160;of&#160;Mirkovic-Vilonen&#160;for&#160;the&#160;affine&#160;Grassmannian&#160;over&#160;C&#160;(<a href="1711.02243s.html#40">[MV07]</a>,&#160;Theorem&#160;3.6).&#160;For<br/>the&#160;generality&#160;we&#160;require,&#160;namely&#160;GrG&#160;over&#160;k&#160;=&#160;Fq,&#160;see&#160;<a href="1711.02243s.html#40">[Zhu]&#160;</a>Theorem&#160;5.3.9&#160;and&#160;the&#160;references&#160;indicated&#160;in<br/><a href="1711.02243s.html#40">[Zhu]&#160;</a>Remark&#160;5.3.10.<br/>
<br/>
Proposition&#160;7.6.&#160;We&#160;have<br/>
M<br/>
H∗c(Sλ,&#160;Fµ&#160;∗&#160;Fµ′)&#160;∼<br/>
=<br/>
H∗c(Sλ&#160;,&#160;F<br/>
,&#160;F<br/>
1<br/>
µ)&#160;⊗&#160;H&#160;∗<br/>
c&#160;(Sλ2<br/>
µ′&#160;)<br/>
λ1+λ2=λ<br/>
Proof.&#160;This&#160;statement&#160;is&#160;proved&#160;implicitly&#160;in&#160;<a href="1711.02243s.html#40">[MV07]&#160;</a>Proposition&#160;6.4.&#160;In&#160;fact,&#160;in&#160;view&#160;of&#160;Theorem&#160;<a href="1711.02243s.html#27">7.5&#160;</a>it&#160;is<br/>equivalent&#160;to&#160;<a href="1711.02243s.html#40">[MV07]&#160;</a>Proposition&#160;6.4.<br/>
Although&#160;the&#160;paper&#160;<a href="1711.02243s.html#40">[MV07]&#160;</a>works&#160;with&#160;the&#160;affine&#160;Grassmannian&#160;over&#160;C,&#160;this&#160;result&#160;is&#160;valid&#160;in&#160;general;&#160;it<br/>
is&#160;formulated&#160;in&#160;the&#160;general&#160;setting&#160;in&#160;<a href="1711.02243s.html#40">[Zhu]&#160;</a>Proposition&#160;5.3.14,&#160;and&#160;a&#160;proof&#160;is&#160;sketched&#160;there.<br/>
<br/>
Remark&#160;7.7.&#160;We&#160;thank&#160;Timo&#160;Richarz&#160;for&#160;informing&#160;us&#160;that&#160;both&#160;Theorem&#160;<a href="1711.02243s.html#27">7.5&#160;</a>and&#160;Proposition&#160;<a href="1711.02243s.html#27">7.6&#160;</a>are&#160;now<br/>formally&#160;written&#160;up&#160;in&#160;full&#160;generality&#160;in&#160;<a href="1711.02243s.html#39">[HRa]&#160;</a>Theorem&#160;3.16&#160;(proof&#160;of&#160;part&#160;ii).<br/>
7.3.&#160;Base&#160;change&#160;for&#160;spherical&#160;Hecke&#160;algebras.&#160;For&#160;r&#160;∈&#160;N,&#160;let&#160;kr&#160;be&#160;the&#160;(unique)&#160;extension&#160;of&#160;k&#160;of<br/>degree&#160;r&#160;and&#160;Fr&#160;denote&#160;the&#160;unique&#160;unramified&#160;field&#160;extension&#160;of&#160;F&#160;of&#160;degree&#160;r.&#160;For&#160;each&#160;µ&#160;∈&#160;X∗(T&#160;),&#160;we&#160;let<br/>SatGr<br/>
and&#160;we&#160;let&#160;ψ<br/>
G&#160;,r&#160;(µ)&#160;be&#160;the&#160;associated&#160;perverse&#160;sheaf&#160;on&#160;GrG,kr<br/>
r,µ&#160;be&#160;the&#160;trace&#160;function&#160;on&#160;GrG(kr&#160;)<br/>
associated&#160;to&#160;SatGrG,r(µ).&#160;We&#160;will&#160;give&#160;a&#160;geometric&#160;interpretation&#160;for&#160;b(ψr,µ).<br/>
<hr/>
<a name=28></a><img class="yflip" src="html/1711.02243-28_1.png"/><br/>
<img class="yflip" src="html/1711.02243-28_2.png"/><br/>
<img class="yflip" src="html/1711.02243-28_3.png"/><br/>
<img class="yflip" src="html/1711.02243-28_4.png"/><br/>
28<br/>
TONY&#160;FENG<br/>
7.3.1.&#160;Weil&#160;restriction.&#160;It&#160;will&#160;be&#160;useful&#160;to&#160;adopt&#160;a&#160;different&#160;perspective&#160;on&#160;the&#160;Hecke&#160;algebra&#160;HG(Fr),K.&#160;As<br/>is&#160;usual,&#160;we&#160;can&#160;think&#160;of&#160;HG(Fr),K&#160;as&#160;functions&#160;on&#160;GrG(kr)&#160;→&#160;Qℓ&#160;which&#160;are&#160;invariant&#160;with&#160;respect&#160;to&#160;the<br/>left&#160;K-action.&#160;(We&#160;are&#160;abusing&#160;notation&#160;here&#160;by&#160;using&#160;K&#160;to&#160;denote&#160;both&#160;the&#160;maximal&#160;compact&#160;subgroups&#160;of<br/>G(Fr)&#160;and&#160;G(F&#160;)&#160;corresponding&#160;to&#160;our&#160;chosen&#160;hyperspecial&#160;vertex.)&#160;However,&#160;using&#160;the&#160;identification<br/>
GrG(kr)&#160;=&#160;(Resk<br/>
)(k)<br/>
r&#160;/k&#160;GrG,kr<br/>
we&#160;can&#160;instead&#160;consider&#160;HG(F<br/>
)(k).&#160;Let&#160;τ&#160;be&#160;the&#160;cyclic&#160;permutation&#160;on<br/>
r&#160;),K&#160;as&#160;functions&#160;on&#160;(Reskr&#160;/k&#160;GrG,kr<br/>
GrrG,X&#160;given&#160;by<br/>
τ&#160;(y1,&#160;.&#160;.&#160;.&#160;,&#160;yr)&#160;=&#160;(yr,&#160;y1,&#160;.&#160;.&#160;.&#160;,&#160;yr−1).<br/>
By&#160;the&#160;definition&#160;of&#160;Weil&#160;restriction,&#160;we&#160;have&#160;a&#160;canonical&#160;bijection<br/>
GrG(kr)&#160;∼<br/>
−<br/>
→&#160;Fix(Frob&#160;◦τ,&#160;GrrG)<br/>
sending<br/>
y&#160;7→&#160;(y,&#160;Frob(y),&#160;.&#160;.&#160;.&#160;,&#160;Frobr−1(y)).<br/>
Definition&#160;7.8.&#160;For&#160;each&#160;µ&#160;∈&#160;X∗(T&#160;),&#160;we&#160;let&#160;Fµ&#160;:=&#160;SatGr&#160;(µ)&#160;be&#160;the&#160;perverse&#160;sheaf&#160;on&#160;Gr<br/>
G<br/>
G.&#160;Consider&#160;the<br/>
perverse&#160;sheaf<br/>
F&#160;(1)<br/>
µ<br/>
⊠&#160;.&#160;.&#160;.&#160;⊠&#160;F(r)<br/>
µ<br/>
∈&#160;Dbc(GrrG)<br/>
where&#160;F(1)&#160;∼<br/>
µ<br/>
=&#160;Fµ;&#160;the&#160;superscripts&#160;are&#160;just&#160;labellings.&#160;The&#160;endomorphism&#160;τ&#160;on&#160;GrrG&#160;lifts&#160;to&#160;an&#160;endomorphism<br/>
e<br/>
τ&#160;of&#160;F&#160;(1)<br/>
µ<br/>
⊠&#160;.&#160;.&#160;.&#160;⊠&#160;F(r)<br/>
µ<br/>
in&#160;an&#160;obvious&#160;way.&#160;Define&#160;a&#160;function<br/>
ζr,µ&#160;:&#160;Fix(Frob&#160;◦τ,&#160;GrrG)&#160;→&#160;Qℓ<br/>
by<br/>
ζr,µ(y)&#160;:=&#160;Tr(Frob&#160;◦e<br/>
τ&#160;,&#160;(F&#160;(1)<br/>
µ<br/>
⊠&#160;.&#160;.&#160;.&#160;⊠&#160;F(r)<br/>
µ&#160;)y&#160;).<br/>
Proposition&#160;7.9.&#160;The&#160;ζr,µ&#160;form&#160;a&#160;basis&#160;for&#160;HG(Fr),K.<br/>
Proof.&#160;This&#160;is&#160;well-known.&#160;It&#160;amounts&#160;to&#160;the&#160;fact&#160;that&#160;the&#160;change-of-basis&#160;matrix&#160;between&#160;the&#160;standard<br/>(double&#160;coset)&#160;basis&#160;of&#160;the&#160;Hecke&#160;algebra&#160;and&#160;the&#160;basis&#160;consisting&#160;of&#160;the&#160;ζr,µ&#160;is&#160;upper-triangular&#160;for&#160;the<br/>Bruhat&#160;order.<br/>
<br/>
7.3.2.&#160;Convolution&#160;product.&#160;Recall&#160;that&#160;there&#160;is&#160;a&#160;convolution&#160;product&#160;∗&#160;on&#160;PervG(O)(GrG)&#160;(<a href="1711.02243s.html#40">[Zhu]&#160;</a>§5).<br/>
Definition&#160;7.10.&#160;Consider&#160;rth&#160;convolution&#160;product<br/>
F&#160;∗r<br/>
µ<br/>
:=&#160;F&#160;(1)<br/>
µ<br/>
∗&#160;.&#160;.&#160;.&#160;∗&#160;F&#160;(r)<br/>
µ<br/>
as&#160;a&#160;perverse&#160;sheaf&#160;on&#160;GrG.&#160;This&#160;has&#160;an&#160;automorphism&#160;κ′&#160;of&#160;order&#160;r&#160;given&#160;by&#160;the&#160;composition<br/>
F&#160;(1)<br/>
κ<br/>
ι<br/>
µ<br/>
∗&#160;.&#160;.&#160;.&#160;∗&#160;F&#160;(r)<br/>
µ<br/>
−<br/>
→&#160;F&#160;(r)<br/>
µ<br/>
∗&#160;F&#160;(1)<br/>
µ<br/>
∗&#160;.&#160;.&#160;.&#160;∗&#160;F&#160;(r−1)<br/>
µ<br/>
−<br/>
→&#160;F&#160;(1)<br/>
µ<br/>
∗&#160;.&#160;.&#160;.&#160;∗&#160;F&#160;(r)<br/>
µ<br/>
where&#160;κ&#160;is&#160;the&#160;cyclic&#160;permutation&#160;obtained&#160;from&#160;the&#160;commutativity&#160;constraint&#160;F&#160;∗&#160;B&#160;∼<br/>
=&#160;B&#160;∗&#160;F&#160;of&#160;Geometric<br/>
Satake&#160;(<a href="1711.02243s.html#40">[Zhu]&#160;</a>Proposition&#160;5.2.6),&#160;and&#160;ι&#160;is&#160;the&#160;tautological&#160;isomorphism&#160;F(i&#160;mod&#160;r)&#160;∼<br/>
µ<br/>
=&#160;F&#160;(i+1&#160;mod&#160;r)<br/>
µ<br/>
coming<br/>
from&#160;the&#160;fact&#160;that&#160;all&#160;the&#160;F(i)<br/>
µ<br/>
are&#160;defined&#160;to&#160;be&#160;the&#160;same&#160;perverse&#160;sheaf.<br/>
Define&#160;φr,µ&#160;:&#160;Fix(Frob&#160;◦κ′,&#160;F(1)<br/>
µ<br/>
∗&#160;.&#160;.&#160;.&#160;∗&#160;F&#160;(r)<br/>
µ&#160;)&#160;→&#160;Qℓ&#160;by<br/>
φr,µ(y)&#160;=&#160;Tr(Frob&#160;◦κ′,&#160;(F(1)<br/>
µ<br/>
∗&#160;.&#160;.&#160;.&#160;∗&#160;F&#160;(r)<br/>
µ&#160;)y&#160;).<br/>
7.3.3.&#160;The&#160;base&#160;change&#160;identity.&#160;We&#160;now&#160;explain&#160;the&#160;relationship&#160;between&#160;these&#160;functions&#160;and&#160;the&#160;base<br/>change&#160;homomorphism.<br/>
Proposition&#160;7.11.&#160;We&#160;have&#160;b(ζr,µ)&#160;=&#160;φr,µ.<br/>
Proof.&#160;By&#160;Theorem&#160;<a href="1711.02243s.html#26">7.3&#160;</a>it&#160;suffices&#160;to&#160;equate&#160;the&#160;Satake&#160;transforms&#160;of&#160;both&#160;sides.&#160;In&#160;other&#160;words,&#160;we&#160;must<br/>prove&#160;the&#160;following&#160;identity:<br/>
Z<br/>
Z<br/>
b(ζr,µ)(tλx)&#160;dx&#160;=<br/>
φr,µ(tλx)&#160;dx&#160;for&#160;all&#160;λ&#160;∈&#160;X∗(T&#160;).<br/>
N&#160;(F&#160;)<br/>
N&#160;(F&#160;)<br/>
By&#160;<a href="1711.02243s.html#26">(7.2)</a>,&#160;this&#160;is&#160;equivalent&#160;to&#160;showing&#160;that<br/>
Z<br/>
Z<br/>
ζr,µ(tλxr)&#160;dxr&#160;=<br/>
φr,µ(trλx)&#160;dx<br/>
(7.4)<br/>
N&#160;(Fr&#160;)<br/>
N&#160;(F&#160;)<br/>
<hr/>
<a name=29></a><img class="yflip" src="html/1711.02243-29_1.png"/><br/>
<img class="yflip" src="html/1711.02243-29_2.png"/><br/>
<img class="yflip" src="html/1711.02243-29_3.png"/><br/>
<img class="yflip" src="html/1711.02243-29_4.png"/><br/>
<img class="yflip" src="html/1711.02243-29_5.png"/><br/>
<img class="yflip" src="html/1711.02243-29_6.png"/><br/>
<img class="yflip" src="html/1711.02243-29_7.png"/><br/>
<img class="yflip" src="html/1711.02243-29_8.png"/><br/>
<img class="yflip" src="html/1711.02243-29_9.png"/><br/>
<img class="yflip" src="html/1711.02243-29_10.png"/><br/>
<img class="yflip" src="html/1711.02243-29_11.png"/><br/>
<img class="yflip" src="html/1711.02243-29_12.png"/><br/>
<img class="yflip" src="html/1711.02243-29_13.png"/><br/>
<img class="yflip" src="html/1711.02243-29_14.png"/><br/>
<img class="yflip" src="html/1711.02243-29_15.png"/><br/>
<img class="yflip" src="html/1711.02243-29_16.png"/><br/>
<img class="yflip" src="html/1711.02243-29_17.png"/><br/>
<img class="yflip" src="html/1711.02243-29_18.png"/><br/>
<img class="yflip" src="html/1711.02243-29_19.png"/><br/>
<img class="yflip" src="html/1711.02243-29_20.png"/><br/>
<img class="yflip" src="html/1711.02243-29_21.png"/><br/>
<img class="yflip" src="html/1711.02243-29_22.png"/><br/>
<img class="yflip" src="html/1711.02243-29_23.png"/><br/>
<img class="yflip" src="html/1711.02243-29_24.png"/><br/>
<img class="yflip" src="html/1711.02243-29_25.png"/><br/>
NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,&#160;AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
29<br/>
and&#160;that<br/>
Z<br/>
φr,µ(tλx)&#160;dx&#160;=&#160;0<br/>
if&#160;r&#160;∤&#160;λ&#160;.<br/>
(7.5)<br/>
N&#160;(F&#160;)<br/>
To&#160;do&#160;this&#160;we&#160;use&#160;the&#160;Lefschetz&#160;trace&#160;formul<a href="1711.02243s.html#29">a4:</a><br/>
X<br/>
Tr(Frob&#160;◦e<br/>
τ&#160;,&#160;Fy)&#160;=&#160;Tr(Frob&#160;◦e<br/>
τ&#160;,&#160;RΓc(Y&#160;⊗k&#160;k,&#160;F)).<br/>
(7.6)<br/>
y∈Fix(Frob&#160;◦τ,Y&#160;(k))<br/>
X<br/>
Tr(Frob&#160;◦κ′,&#160;Fy)&#160;=&#160;Tr(Frob&#160;◦κ′,&#160;RΓc(Y&#160;⊗k&#160;k,&#160;F)).<br/>
(7.7)<br/>
y∈Fix(Frob&#160;◦κ′,Y&#160;(k))<br/>
Applying&#160;<a href="1711.02243s.html#29">(7.6)&#160;</a>to&#160;Y&#160;:=&#160;Sλ&#160;×&#160;.&#160;.&#160;.&#160;×&#160;Sλ&#160;and&#160;F&#160;:=&#160;F(1)<br/>
µ<br/>
⊠&#160;.&#160;.&#160;.&#160;⊠&#160;F(r)<br/>
µ<br/>
and&#160;using&#160;Lemma&#160;<a href="1711.02243s.html#27">7.4&#160;</a>plus&#160;the&#160;Künneth<br/>
theorem&#160;gives<br/>
Z<br/>
ζr,µ(tλxr)dxr&#160;=&#160;q−ρ(λ)&#160;Tr(Frob&#160;◦e<br/>
τ&#160;,&#160;RΓc(Sλ&#160;⊗k&#160;k,&#160;Fµ)⊗r).<br/>
N&#160;(Fr)<br/>
We&#160;note&#160;that&#160;here&#160;e<br/>
τ&#160;acts&#160;by&#160;cyclically&#160;permuting&#160;the&#160;tensor&#160;factors&#160;RΓc(Sλ&#160;⊗k&#160;k,&#160;Fµ)⊗r,&#160;and&#160;Frob&#160;acts<br/>
factorwise.<br/>
Applying&#160;<a href="1711.02243s.html#29">(7.7)&#160;</a>to&#160;Y&#160;=&#160;Sλ&#160;and&#160;F&#160;=&#160;F∗r<br/>
µ<br/>
=&#160;F&#160;(1)<br/>
µ<br/>
∗&#160;.&#160;.&#160;.&#160;∗&#160;F&#160;(r)<br/>
µ<br/>
and&#160;using&#160;Lemma&#160;<a href="1711.02243s.html#27">7.4&#160;</a>gives<br/>
Z<br/>
φr,µ(tλx)dx&#160;=&#160;q−ρ(λ)&#160;Tr(Frob&#160;◦κ′,&#160;RΓc(Sλ&#160;⊗k&#160;k,&#160;F∗r<br/>
µ&#160;)).<br/>
(7.8)<br/>
N&#160;(F&#160;)<br/>
We&#160;first&#160;digest&#160;the&#160;expression&#160;<a href="1711.02243s.html#29">(7.8)</a>.&#160;By&#160;Proposition&#160;<a href="1711.02243s.html#27">7.6&#160;</a>we&#160;have<br/>
M<br/>
r<br/>
O<br/>
RΓc(Sλ&#160;⊗k&#160;k,&#160;F(1)<br/>
µ<br/>
∗&#160;.&#160;.&#160;.&#160;∗&#160;F&#160;(r)<br/>
µ&#160;)&#160;∼<br/>
=<br/>
RΓc(Sλ&#160;⊗<br/>
i<br/>
k&#160;k,&#160;Fµ).<br/>
λ1+...+λr=λ&#160;i=1<br/>
Let’s&#160;try&#160;to&#160;understand&#160;the&#160;action&#160;of&#160;κ′,&#160;which&#160;is&#160;a&#160;composition&#160;κ′&#160;=&#160;ι&#160;◦&#160;κ.&#160;The&#160;map&#160;κ&#160;acts&#160;by&#160;cyclic<br/>permutation&#160;of&#160;both&#160;the&#160;spaces&#160;and&#160;sheaves,&#160;so&#160;it&#160;induces&#160;the&#160;permutation<br/>
κ∗&#160;:&#160;H∗c(Sλ&#160;⊗<br/>
⊗<br/>
⊗<br/>
1<br/>
k&#160;k,&#160;F&#160;(1)<br/>
µ&#160;)&#160;⊗&#160;H&#160;∗<br/>
c&#160;(Sλ2<br/>
k&#160;k,&#160;F&#160;(2)<br/>
µ&#160;)&#160;⊗&#160;.&#160;.&#160;.&#160;⊗&#160;RΓc(Sλr<br/>
k&#160;k,&#160;F&#160;(r)<br/>
µ&#160;)<br/>
→&#160;H∗c(Sλ&#160;⊗<br/>
⊗<br/>
⊗<br/>
r<br/>
k&#160;k,&#160;F&#160;(r)<br/>
µ&#160;)&#160;⊗&#160;H&#160;∗<br/>
c&#160;(Sλ1<br/>
k&#160;k,&#160;F&#160;(1)<br/>
µ&#160;)&#160;⊗&#160;.&#160;.&#160;.&#160;⊗&#160;RΓc(Sλr−1<br/>
k&#160;k,&#160;F&#160;(r−1)<br/>
µ<br/>
).<br/>
Next,&#160;the&#160;map&#160;ι&#160;relabels&#160;the&#160;sheaves&#160;only,&#160;so&#160;the&#160;conclusion&#160;is&#160;that&#160;κ′&#160;induces<br/>
(κ′)∗&#160;:&#160;H∗c(Sλ&#160;⊗<br/>
⊗<br/>
⊗<br/>
1<br/>
k&#160;k,&#160;F&#160;(1)<br/>
µ&#160;)&#160;⊗&#160;H&#160;∗<br/>
c&#160;(Sλ2<br/>
k&#160;k,&#160;F&#160;(2)<br/>
µ&#160;)&#160;⊗&#160;.&#160;.&#160;.&#160;⊗&#160;RΓc(Sλr<br/>
k&#160;k,&#160;F&#160;(r)<br/>
µ&#160;)<br/>
→&#160;H∗c(Sλ&#160;⊗<br/>
⊗<br/>
⊗<br/>
r<br/>
k&#160;k,&#160;F&#160;(1)<br/>
µ&#160;)&#160;⊗&#160;H&#160;∗<br/>
c&#160;(Sλ1<br/>
k&#160;k,&#160;F&#160;(2))&#160;⊗&#160;.&#160;.&#160;.&#160;⊗&#160;RΓc(Sλr−1<br/>
k&#160;k,&#160;F&#160;(r)<br/>
µ&#160;).<br/>
In&#160;particular,&#160;we&#160;emphasize&#160;that&#160;the&#160;composition,&#160;at&#160;the&#160;level&#160;of&#160;cohomology,&#160;effects&#160;a&#160;permutation&#160;of&#160;the<br/>spaces.&#160;Now,&#160;Frobenius&#160;preserves&#160;each&#160;tensor&#160;and&#160;summand.&#160;Therefore,&#160;Frob&#160;◦κ′&#160;acts&#160;on&#160;the&#160;summands&#160;of<br/>the&#160;form<br/>
r−1<br/>
M&#160;r<br/>
O&#160;H∗c(Sλ<br/>
⊗<br/>
i+j<br/>
(mod&#160;r)<br/>
k&#160;k,&#160;Fµ)<br/>
j=0&#160;i=1<br/>
by&#160;a&#160;cyclic&#160;permutation&#160;followed&#160;by&#160;a&#160;factorwise&#160;endomorphism.&#160;From&#160;this&#160;form&#160;we&#160;see&#160;that&#160;if&#160;λ1,&#160;.&#160;.&#160;.&#160;,&#160;λr<br/>are&#160;not&#160;all&#160;equal&#160;then&#160;Frob&#160;◦κ′&#160;permutes&#160;the&#160;summands&#160;freely,&#160;so&#160;Frob&#160;◦κ′&#160;has&#160;trace&#160;0.&#160;In&#160;particular,&#160;if&#160;λ&#160;is<br/>not&#160;divisible&#160;by&#160;r&#160;then&#160;the&#160;λi&#160;cannot&#160;be&#160;all&#160;equal,&#160;so&#160;that&#160;the&#160;trace&#160;is&#160;0.&#160;This&#160;establishes&#160;<a href="1711.02243s.html#29">(7.5)</a>.<br/>
On&#160;the&#160;other&#160;hand,&#160;our&#160;analysis&#160;above&#160;implies&#160;that&#160;if&#160;λ&#160;=&#160;rλ′&#160;then&#160;the&#160;contribution&#160;to&#160;Tr(Frob&#160;◦κ′)&#160;all<br/>
comes&#160;from&#160;the&#160;terms&#160;with&#160;all&#160;λ1&#160;=&#160;.&#160;.&#160;.&#160;=&#160;λr&#160;=&#160;λ′,&#160;and&#160;we&#160;have<br/>
Frob&#160;◦κ′|<br/>
=&#160;Frob&#160;◦<br/>
H∗(S<br/>
e<br/>
τ&#160;|H∗(S<br/>
c<br/>
λ′&#160;⊗k&#160;k,Fµ)⊗r<br/>
c<br/>
λ′&#160;⊗k&#160;k,Fµ)⊗r<br/>
so&#160;that<br/>
Z<br/>
Z<br/>
ψr,µ(tλ′xr)dxr&#160;=<br/>
φr,µ(tλx)&#160;dx<br/>
N&#160;(Fr,t)<br/>
N&#160;(Ft)<br/>
which&#160;establishes&#160;<a href="1711.02243s.html#28">(7.4)</a>.<br/>
<br/>
Lemma&#160;7.12.&#160;We&#160;have&#160;ζr,µ&#160;=&#160;ψr,µ.<br/>
4Note&#160;that&#160;this&#160;is&#160;applicable&#160;because&#160;Frob&#160;◦τ&#160;is&#160;the&#160;Frobenius&#160;for&#160;a&#160;twisted&#160;form&#160;of&#160;Y&#160;:&#160;see&#160;the&#160;discussion&#160;beginning&#160;in&#160;the<br/>
last&#160;sentence&#160;of&#160;<a href="1711.02243s.html#40">[Ngo99]&#160;</a>p.&#160;651.<br/>
<hr/>
<a name=30></a><img class="yflip" src="html/1711.02243-30_1.png"/><br/>
<img class="yflip" src="html/1711.02243-30_2.png"/><br/>
<img class="yflip" src="html/1711.02243-30_3.png"/><br/>
30<br/>
TONY&#160;FENG<br/>
Proof.&#160;By&#160;Theorem&#160;<a href="1711.02243s.html#26">7.3&#160;</a>it&#160;suffices&#160;to&#160;check&#160;equality&#160;of&#160;the&#160;Satake&#160;transforms&#160;of&#160;both&#160;sides.&#160;Using&#160;Lemma<br/><a href="1711.02243s.html#27">7.4,&#160;</a>this&#160;amounts&#160;to&#160;showing<br/>
Tr(Frobr,&#160;RΓc(Sλ&#160;⊗k&#160;k,&#160;Fµ))&#160;=&#160;Tr(Frob&#160;◦e<br/>
τ&#160;,&#160;RΓc(Sλ&#160;⊗k&#160;k,&#160;Fµ)⊗r).<br/>
This&#160;follows&#160;from&#160;the&#160;general&#160;linear&#160;algebra&#160;fact&#160;asserted&#160;in&#160;Lemma&#160;<a href="1711.02243s.html#30">7.13&#160;</a>below.<br/>
<br/>
Lemma&#160;7.13&#160;(Saito-Shintan<a href="1711.02243s.html#30">i5</a>).&#160;Let&#160;V&#160;be&#160;a&#160;finite-dimensional&#160;representation&#160;over&#160;a&#160;field&#160;k.&#160;Let&#160;τ&#160;be&#160;the<br/>endomorphism&#160;of&#160;V&#160;⊗r&#160;defined&#160;by<br/>
v1&#160;⊗&#160;.&#160;.&#160;.&#160;⊗&#160;vr&#160;7→&#160;vr&#160;⊗&#160;v1&#160;⊗&#160;.&#160;.&#160;.&#160;⊗&#160;vr−1.<br/>
Then&#160;for&#160;all&#160;T1,&#160;.&#160;.&#160;.&#160;,&#160;Tr&#160;∈&#160;End(V&#160;),&#160;we&#160;have<br/>
Tr(T1&#160;.&#160;.&#160;.&#160;Tr,&#160;V&#160;)&#160;=&#160;Tr((T1&#160;⊗&#160;.&#160;.&#160;.&#160;⊗&#160;Tr)τ,&#160;V&#160;⊗r).<br/>
Proof.&#160;If&#160;{ei}&#160;is&#160;a&#160;basis&#160;for&#160;V&#160;,&#160;then<br/>
(T1&#160;⊗&#160;.&#160;.&#160;.&#160;⊗&#160;Tr)τ(ei&#160;⊗&#160;.&#160;.&#160;.&#160;⊗&#160;e&#160;)&#160;=&#160;T<br/>
)&#160;⊗&#160;.&#160;.&#160;.&#160;⊗&#160;T<br/>
).<br/>
1<br/>
ir<br/>
1(eir<br/>
r&#160;(eir−1<br/>
We&#160;expand&#160;out&#160;both&#160;sides&#160;of&#160;the&#160;desired&#160;equality:<br/>
X<br/>
Tr((T1&#160;⊗&#160;.&#160;.&#160;.&#160;⊗&#160;Tr)τ)&#160;=<br/>
hei&#160;⊗&#160;.&#160;.&#160;.&#160;⊗&#160;e&#160;,&#160;T<br/>
)&#160;⊗&#160;.&#160;.&#160;.&#160;⊗&#160;T<br/>
)i<br/>
1<br/>
ir<br/>
1(eir<br/>
r(eir−1<br/>
i1,...,ir<br/>
X<br/>
=<br/>
hei&#160;,&#160;T<br/>
)i&#160;.&#160;.&#160;.&#160;he&#160;,&#160;T<br/>
)i<br/>
1<br/>
1(eir<br/>
ir<br/>
r(eir−1<br/>
i1...,ir<br/>
and<br/>
X<br/>
Tr(T1&#160;.&#160;.&#160;.&#160;Tr)&#160;=<br/>
hei,&#160;T1&#160;·&#160;·&#160;·&#160;Treii.<br/>
i<br/>
Thus&#160;want&#160;to&#160;show&#160;that&#160;X<br/>
X<br/>
hei&#160;,&#160;T<br/>
)i&#160;.&#160;.&#160;.&#160;he&#160;,&#160;T<br/>
)i&#160;=<br/>
he<br/>
1<br/>
1(eir<br/>
ir<br/>
r&#160;(eir−1<br/>
i,&#160;T1&#160;·&#160;·&#160;·&#160;Treii.<br/>
i1,...,ir<br/>
i<br/>
This&#160;follows&#160;by&#160;repeated&#160;iteration&#160;of&#160;the&#160;following&#160;more&#160;general&#160;identity.<br/>
<br/>
Lemma&#160;7.14.&#160;Let&#160;V&#160;be&#160;a&#160;finite-dimensional&#160;vector&#160;space&#160;with&#160;basis&#160;{ei}.&#160;For&#160;any&#160;T&#160;∈&#160;End(V&#160;),&#160;we&#160;have<br/>
Xhx,Tejihej,yi&#160;=&#160;hx,Tyi.<br/>
(7.9)<br/>
j<br/>
Proof.&#160;It&#160;suffices&#160;to&#160;establish&#160;the&#160;equation&#160;for&#160;y&#160;ranging&#160;over&#160;a&#160;basis&#160;of&#160;V&#160;;&#160;taking&#160;y&#160;=&#160;ei&#160;the&#160;left&#160;hand&#160;side<br/>is&#160;hx,&#160;T&#160;eii,&#160;and&#160;so&#160;is&#160;the&#160;right&#160;hand&#160;side.<br/>
<br/>
Combining&#160;these&#160;results,&#160;we&#160;obtain&#160;the&#160;main&#160;formula&#160;of&#160;interest:<br/>
Theorem&#160;7.15.&#160;We&#160;have&#160;b(ψr,µ)&#160;=&#160;φr,µ.<br/>Proof.&#160;This&#160;follows&#160;immediately&#160;upon&#160;combining&#160;Proposition&#160;<a href="1711.02243s.html#28">7.11&#160;</a>and&#160;Lemma&#160;<a href="1711.02243s.html#29">7.12.</a><br/>
<br/>
7.4.&#160;Base&#160;change&#160;for&#160;the&#160;centers&#160;of&#160;parahoric&#160;Hecke&#160;algebras.&#160;We&#160;now&#160;establish&#160;an&#160;identity&#160;for<br/>central&#160;functions&#160;of&#160;parahoric&#160;Hecke&#160;algebras&#160;analogous&#160;to&#160;Theorem&#160;<a href="1711.02243s.html#30">7.15.&#160;</a>Not&#160;surprisingly,&#160;this&#160;will&#160;involve<br/>globalizing&#160;to&#160;a&#160;degeneration&#160;from&#160;the&#160;spherical&#160;case.<br/>
7.4.1.&#160;Setup.&#160;We&#160;first&#160;set&#160;some&#160;notation.&#160;Pick&#160;a&#160;smooth&#160;global&#160;curve&#160;X/Fq&#160;(not&#160;necessarily&#160;projective)&#160;with<br/>a&#160;rational&#160;point&#160;x<br/>
∼<br/>
0&#160;∈&#160;X&#160;(Fq).&#160;Let&#160;G&#160;→&#160;X&#160;be&#160;a&#160;parahoric&#160;group&#160;scheme,&#160;such&#160;that&#160;G|X−x<br/>
=&#160;G&#160;×&#160;X&#160;and<br/>
0<br/>
G(Ox&#160;)&#160;=&#160;J&#160;is&#160;a&#160;parahoric&#160;subgroup.&#160;We&#160;form&#160;the&#160;affine&#160;Grassmannian<br/>
0<br/>
π&#160;:&#160;GrG&#160;→&#160;X.<br/>
Note&#160;that&#160;for&#160;x&#160;∈&#160;X&#160;−&#160;x0&#160;we&#160;have<br/>
Gr<br/>
∼<br/>
G&#160;|x&#160;=&#160;GrG&#160;×kk(x).<br/>
For&#160;each&#160;µ&#160;∈&#160;X∗(T&#160;),&#160;we&#160;let&#160;Fµ&#160;:=&#160;SatGr&#160;(µ)&#160;be&#160;the&#160;(shifted)&#160;perverse&#160;sheaf&#160;on&#160;Gr<br/>
be&#160;the&#160;re-<br/>
G<br/>
G&#160;and&#160;Fµ,x0<br/>
striction&#160;to&#160;GrG,x&#160;.&#160;(We&#160;have&#160;normalized&#160;our&#160;shifts&#160;so&#160;that&#160;F<br/>
is&#160;perverse.)&#160;We&#160;let&#160;ψ′<br/>
0<br/>
µ,x0<br/>
r,µ&#160;∈&#160;HG(Fx&#160;⊗<br/>
F<br/>
0<br/>
Fq<br/>
qr&#160;),J<br/>
be&#160;the&#160;function&#160;as&#160;in&#160;Definition&#160;<a href="1711.02243s.html#16">5.6.</a><br/>
5We&#160;ﬁrst&#160;found&#160;this&#160;explicitly&#160;stated,&#160;without&#160;proof,&#160;in&#160;<a href="1711.02243s.html#40">[Ngo06]</a>,&#160;where&#160;it&#160;is&#160;said&#160;to&#160;be&#160;implicit&#160;in&#160;the&#160;work&#160;of&#160;Saito&#160;and<br/>
Shintani&#160;on&#160;base&#160;change.<br/>
<hr/>
<a name=31></a><img class="yflip" src="html/1711.02243-31_1.png"/><br/>
<img class="yflip" src="html/1711.02243-31_2.png"/><br/>
<img class="yflip" src="html/1711.02243-31_3.png"/><br/>
NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,&#160;AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
31<br/>
7.4.2.&#160;Convolution&#160;product.&#160;By&#160;Theorem&#160;<a href="1711.02243s.html#18">5.12,&#160;</a>RΨ(Fµ)&#160;:=&#160;RΨx&#160;(F<br/>
.&#160;We<br/>
0<br/>
µ)&#160;is&#160;a&#160;central&#160;sheaf&#160;on&#160;GrG,x0<br/>
therefore&#160;have,&#160;as&#160;in&#160;Definition&#160;<a href="1711.02243s.html#28">7.10,&#160;</a>a&#160;map<br/>
κ′&#160;:&#160;RΨ(Fµ)(1)&#160;∗&#160;.&#160;.&#160;.&#160;∗&#160;RΨ(Fµ)(r)<br/>
κ<br/>
−<br/>
→&#160;RΨ(Fµ)(r)&#160;∗&#160;RΨ(Fµ)(1)&#160;∗&#160;.&#160;.&#160;.&#160;∗&#160;RΨ(Fµ)(r−1)<br/>
ι<br/>
−<br/>
→&#160;RΨ(Fµ)(1)&#160;∗&#160;.&#160;.&#160;.&#160;∗&#160;RΨ(Fµ)(r).<br/>
Definition&#160;7.16.&#160;Let<br/>
RΨ(Fµ)∗r&#160;:=&#160;RΨ(Fµ)(1)&#160;∗&#160;.&#160;.&#160;.&#160;∗&#160;RΨ(Fµ)(r)&#160;.<br/>
|<br/>
{z<br/>
}<br/>
r&#160;times<br/>
Define&#160;φ′µ&#160;:&#160;Fix(Frob&#160;◦κ′,&#160;RΨ(Fµ)∗r)&#160;→&#160;Qℓ&#160;by<br/>
φ′µ(y)&#160;=&#160;Tr(Frob&#160;◦κ′,&#160;(RΨ(Fµ)∗r)y).<br/>
Theorem&#160;7.17.&#160;We&#160;have&#160;b(ψ′r,µ)&#160;=&#160;φ′µ.<br/>
Proof.&#160;By&#160;Theorem&#160;<a href="1711.02243s.html#18">5.12,&#160;</a>φ′r,µ(y)&#160;is&#160;in&#160;the&#160;center&#160;of&#160;the&#160;Iwahori-Hecke&#160;algebra.&#160;(Since&#160;RΨ(Fµ)&#160;is&#160;central&#160;by<br/>Theorem&#160;<a href="1711.02243s.html#18">5.12,&#160;</a>φ′r,µ(y)&#160;clearly&#160;commutes&#160;with&#160;all&#160;the&#160;other&#160;functions&#160;of&#160;the&#160;form&#160;φ′r,ν(y);&#160;then&#160;use&#160;that&#160;such<br/>things&#160;form&#160;a&#160;basis&#160;for&#160;the&#160;Iwahori&#160;Hecke&#160;algebra&#160;as&#160;ν&#160;runs&#160;over&#160;the&#160;extended&#160;affine&#160;Weyl&#160;group.)<br/>
Now&#160;the&#160;argument&#160;is&#160;essentially&#160;the&#160;same&#160;as&#160;for&#160;Corollary&#160;<a href="1711.02243s.html#18">5.14.&#160;</a>Consider&#160;the&#160;map<br/>
pr&#160;:&#160;Gr≤µ&#160;→&#160;Gr≤µ<br/>
G<br/>
G×X<br/>
induced&#160;by&#160;forgetting&#160;the&#160;level&#160;structure&#160;at&#160;x0.&#160;Since&#160;pr&#160;is&#160;proper,&#160;by&#160;Lemma&#160;<a href="1711.02243s.html#17">5.9&#160;</a>and&#160;the&#160;fact&#160;that&#160;pr&#160;is&#160;an<br/>isomorphism&#160;away&#160;from&#160;x0&#160;we&#160;have<br/>
pr!RΨGrG<br/>
x<br/>
(Fµ)&#160;=&#160;RΨGrG×X&#160;(SatGr<br/>
(µ)).<br/>
0<br/>
x0<br/>
G×X<br/>
By&#160;Lemma&#160;<a href="1711.02243s.html#17">5.11&#160;</a>and&#160;the&#160;fact&#160;that&#160;GrG×X&#160;→&#160;X&#160;is&#160;smooth,&#160;we&#160;have<br/>
RΨGrG×X<br/>
x<br/>
(Sat<br/>
(µ))&#160;∼<br/>
=&#160;Sat<br/>
(µ).<br/>
0<br/>
GrG×X<br/>
GrG×X<br/>
Since&#160;pr!&#160;corresponds&#160;to&#160;−&#160;∗J&#160;IK&#160;at&#160;the&#160;level&#160;functions,&#160;this&#160;implies<br/>
φ′µ&#160;∗J&#160;IK&#160;=&#160;φµ.<br/>
Thus&#160;by&#160;Theorem&#160;<a href="1711.02243s.html#30">7.15&#160;</a>and&#160;<a href="1711.02243s.html#26">(7.1)</a>,&#160;we&#160;have&#160;that<br/>
φ′µ&#160;∗J&#160;IK&#160;=&#160;φµ&#160;=&#160;b(ψr,µ)&#160;=&#160;b(ψ′r,µ)&#160;∗J&#160;IK.<br/>
(7.10)<br/>
In&#160;view&#160;of&#160;the&#160;Bernstein&#160;isomorphism&#160;(Theorem&#160;<a href="1711.02243s.html#16">5.5)</a>,&#160;the&#160;fact&#160;that&#160;φ′µ&#160;and&#160;b(ψ′r,µ)&#160;are&#160;central&#160;plus&#160;<a href="1711.02243s.html#31">(7.10)<br/></a>implies&#160;that&#160;they&#160;are&#160;equal.<br/>
<br/>
7.4.3.&#160;A&#160;global&#160;reformulation.&#160;We&#160;now&#160;recast&#160;Theorem&#160;<a href="1711.02243s.html#31">7.17&#160;</a>into&#160;a&#160;form&#160;that&#160;will&#160;be&#160;more&#160;suitable&#160;for&#160;our<br/>eventual&#160;needs.<br/>
Let&#160;G&#160;and&#160;GrG&#160;be&#160;as&#160;in&#160;<a href="1711.02243s.html#30">§7.4.1.&#160;</a>We&#160;first&#160;recall&#160;a&#160;construction&#160;of&#160;the&#160;convolution&#160;product&#160;Fµ&#160;∗&#160;Fµ′.<br/>
Recall&#160;the&#160;iterated&#160;global&#160;affine&#160;Grassmannian&#160;GrG,X2&#160;from&#160;<a href="1711.02243s.html#13">§4.4.1.&#160;</a>We&#160;can&#160;form&#160;the&#160;twisted&#160;tensor&#160;product<br/>F&#160;e<br/>
µ⊠Fµ′&#160;:=&#160;SatGr<br/>
(µ,&#160;µ′)&#160;on&#160;GrG,X2&#160;(<a href="1711.02243s.html#40">[Zhu]&#160;</a>§A),&#160;which&#160;is&#160;supported&#160;on&#160;the&#160;Schubert&#160;variety&#160;Gr≤(µ,µ′).<br/>
G,X2<br/>
G,X<br/>
Restricting&#160;to&#160;the&#160;diagonal&#160;X&#160;⊂&#160;X2,&#160;we&#160;have&#160;the&#160;multiplication&#160;map<br/>
m&#160;:&#160;Gr≤(µ,µ′)&#160;|<br/>
G,X2<br/>
∆&#160;→&#160;Gr≤µ+µ′<br/>
G<br/>
defined&#160;on&#160;points&#160;by<br/>
ϕ<br/>
β<br/>
β◦ϕ<br/>
(x,&#160;x,&#160;E1&#160;99K&#160;E2&#160;99K&#160;E0)&#160;7→&#160;(x,&#160;E1&#160;99K&#160;E0).<br/>
Then&#160;the&#160;convolution&#160;product&#160;is&#160;defined&#160;by&#160;(cf.&#160;<a href="1711.02243s.html#40">[MV07]&#160;</a>§4&#160;or&#160;<a href="1711.02243s.html#40">[Zhu]&#160;</a>§5.1)<br/>
F<br/>
e<br/>
µ&#160;∗&#160;Fµ′&#160;:=&#160;Rm!(Fµ⊠Fµ′&#160;)&#160;∈&#160;PervL+G&#160;(Gr≤µ+µ′&#160;).<br/>
(7.11)<br/>
G<br/>
<hr/>
<a name=32></a><img class="yflip" src="html/1711.02243-32_1.png"/><br/>
<img class="yflip" src="html/1711.02243-32_2.png"/><br/>
32<br/>
TONY&#160;FENG<br/>
Let&#160;us&#160;now&#160;write&#160;down&#160;our&#160;particular&#160;situation&#160;of&#160;interest.&#160;Consider&#160;the&#160;diagram<br/>
Gr≤(µ1,...,µr)<br/>
G,Xr<br/>
|∆<br/>
∆(X)&#160;⊂&#160;Xr<br/>
m<br/>
Gr≤µ1+...+µr<br/>
X<br/>
G,X<br/>
Then&#160;by&#160;<a href="1711.02243s.html#31">(7.11)&#160;</a>we&#160;have<br/>
F&#160;(µ1)&#160;∗&#160;.&#160;.&#160;.&#160;∗&#160;F(µr)&#160;=&#160;Rm!(SatGrG,Xr(µ1,&#160;.&#160;.&#160;.&#160;,&#160;µr))<br/>
Now&#160;Theorem&#160;<a href="1711.02243s.html#31">7.17&#160;</a>can&#160;be&#160;reformulated&#160;as&#160;follows,&#160;using&#160;Corollary&#160;<a href="1711.02243s.html#17">5.9&#160;</a>to&#160;commute&#160;Rm!&#160;and&#160;nearby&#160;cycles.<br/>
Proposition&#160;7.18.&#160;Let&#160;r.µ&#160;:=&#160;(µ,&#160;.&#160;.&#160;.&#160;,&#160;µ)&#160;∈&#160;X∗(T&#160;)r+.&#160;Let&#160;fν,x&#160;∈&#160;H<br/>
0<br/>
G(Fx&#160;),J&#160;be&#160;the&#160;function&#160;fν&#160;viewed&#160;in&#160;the<br/>
0<br/>
parahoric&#160;Hecke&#160;algebra&#160;of&#160;Fx&#160;,&#160;and&#160;define&#160;ψ′<br/>
∈&#160;Z(H<br/>
0<br/>
rµ,x0<br/>
G(Fx&#160;),J&#160;)&#160;similarly.&#160;Then&#160;we&#160;have<br/>
0<br/>
X<br/>
b(ψ′r,rµ,x&#160;)&#160;=<br/>
Tr(σ&#160;◦&#160;κ′,&#160;RΨX&#160;(Rm!&#160;Sat<br/>
(r.µ))ν&#160;)fν,x&#160;.<br/>
0<br/>
x0<br/>
Gr≤r.µ,Xr<br/>
0<br/>
G<br/>
ν≤rµ<br/>
8.&#160;Comparison&#160;of&#160;two&#160;moduli&#160;problems<br/>
8.1.&#160;Setup.&#160;We&#160;now&#160;let&#160;G&#160;be&#160;the&#160;group&#160;scheme&#160;of&#160;units&#160;of&#160;a&#160;global&#160;algebra&#160;D&#160;as&#160;in&#160;<a href="1711.02243s.html#13">§4.5&#160;</a>and&#160;G&#160;a&#160;parahoric<br/>group&#160;scheme&#160;corresponding&#160;to&#160;some&#160;choice&#160;of&#160;level&#160;structure&#160;at&#160;x0,&#160;so&#160;ShtG&#160;are&#160;the&#160;D-shtukas&#160;studied&#160;in<br/><a href="1711.02243s.html#13">§4.5.</a><br/>
Let&#160;Z&#160;⊂&#160;X&#160;be&#160;the&#160;set&#160;of&#160;places&#160;of&#160;ramification&#160;for&#160;D.&#160;We&#160;assume&#160;throughout&#160;that&#160;#Z&#160;≥&#160;n2(||µ1||&#160;+&#160;.&#160;.&#160;.&#160;+<br/>
||µr||),&#160;so&#160;as&#160;to&#160;be&#160;able&#160;to&#160;apply&#160;Proposition&#160;<a href="1711.02243s.html#15">4.20.</a><br/>
Let&#160;X◦&#160;:=&#160;(X&#160;−&#160;Z&#160;−&#160;{x0}).&#160;We&#160;will&#160;now&#160;define&#160;and&#160;compare&#160;two&#160;different&#160;moduli&#160;stacks&#160;of&#160;shtukas.<br/>
8.2.&#160;Situation&#160;A.&#160;Let<br/>
Shtµ&#160;:=&#160;(Sht≤µ&#160;/aZ)r.<br/>
A<br/>
G,X<br/>
We&#160;have&#160;a&#160;map<br/>
πA&#160;:&#160;Shtµ&#160;|<br/>
A&#160;(X−Z)r&#160;→&#160;(X&#160;−&#160;Z&#160;)r.<br/>
By&#160;Proposition&#160;<a href="1711.02243s.html#15">4.20&#160;</a>the&#160;restriction&#160;π◦&#160;:=&#160;π<br/>
A<br/>
A|(X◦)r&#160;is&#160;proper.<br/>
Definition&#160;8.1.&#160;Let&#160;r.µ&#160;=&#160;(µ,&#160;.&#160;.&#160;.&#160;,&#160;µ).&#160;We&#160;define&#160;the&#160;following&#160;“sheaf”&#160;Aµ<br/>
|<br/>
{z<br/>
}<br/>
r&#160;∈&#160;Db<br/>
c((X&#160;◦)r&#160;):<br/>
r&#160;times<br/>
Aµr&#160;:=&#160;Rπ◦A∗(SatShtµ&#160;(r.µ)).<br/>
A<br/>
We&#160;have&#160;the&#160;following&#160;easy&#160;but&#160;crucial&#160;property.<br/>
Proposition&#160;8.2.&#160;The&#160;complex&#160;Aµr&#160;∈&#160;is&#160;locally&#160;constant&#160;on&#160;(X◦)r,&#160;in&#160;the&#160;sense&#160;that&#160;each&#160;Riπ◦&#160;(Sat<br/>
(r.µ))<br/>
A∗<br/>
Shtµ<br/>
A<br/>
is&#160;a&#160;local&#160;system.<br/>
Proof.&#160;By&#160;the&#160;properness&#160;of&#160;π◦&#160;we&#160;know&#160;that&#160;Riπ◦&#160;(Sat<br/>
(r.µ))&#160;is&#160;constructible,&#160;and&#160;the&#160;local&#160;acyclicity<br/>
A∗<br/>
A∗<br/>
Shtµ<br/>
A<br/>
(Proposition&#160;<a href="1711.02243s.html#14">4.19)&#160;</a>then&#160;implies&#160;that&#160;it&#160;is&#160;locally&#160;constant.<br/>
<br/>
Note&#160;that&#160;by&#160;the&#160;Künneth&#160;formula,&#160;we&#160;have<br/>
Aµ&#160;∼<br/>
r&#160;=&#160;(Aµ<br/>
1&#160;)⊠r<br/>
Choose&#160;a&#160;basepoint&#160;x&#160;∈&#160;X◦,&#160;and&#160;let&#160;xr&#160;∈&#160;(X◦)r&#160;denote&#160;the&#160;diagonal&#160;point&#160;(x,&#160;.&#160;.&#160;.&#160;,&#160;x).&#160;Then&#160;the&#160;symmetric<br/>group&#160;Sr&#160;acts&#160;on&#160;(X◦)r,&#160;hence&#160;also&#160;π1((X◦)r,&#160;xr).&#160;This&#160;lifts&#160;to&#160;an&#160;Sr-equivariant&#160;structure&#160;on&#160;the&#160;local<br/>system&#160;Aµr,&#160;i.e.&#160;an&#160;action&#160;of&#160;π1((X◦)r,&#160;xr)&#160;⋊&#160;Sr&#160;on&#160;(Aµr)xr&#160;,&#160;commuting&#160;with&#160;the&#160;action&#160;of&#160;the&#160;global&#160;Hecke<br/>algebra&#160;H⊗r.<br/>
<hr/>
<a name=33></a><img class="yflip" src="html/1711.02243-33_1.png"/><br/>
<img class="yflip" src="html/1711.02243-33_2.png"/><br/>
<img class="yflip" src="html/1711.02243-33_3.png"/><br/>
NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,&#160;AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
33<br/>
8.3.&#160;Situation&#160;B.&#160;Let<br/>
Shtµ&#160;:=&#160;Sht≤r.µ<br/>
B<br/>
G,Xr&#160;/aZ<br/>
where&#160;r.µ&#160;=&#160;(µ,&#160;.&#160;.&#160;.&#160;,&#160;µ).&#160;We&#160;have&#160;a&#160;map<br/>
|<br/>
{z<br/>
}<br/>
r&#160;times<br/>
πB&#160;:&#160;Shtµ&#160;|<br/>
B&#160;(X−Z)r&#160;→&#160;(X&#160;−&#160;Z&#160;)r.<br/>
By&#160;the&#160;assumption&#160;that&#160;D&#160;is&#160;totally&#160;ramified&#160;at&#160;sufficiently&#160;many&#160;places,&#160;the&#160;map&#160;π◦&#160;:=&#160;π<br/>
B<br/>
B&#160;|(X◦)r&#160;is&#160;proper<br/>
by&#160;Proposition&#160;<a href="1711.02243s.html#15">4.20.</a><br/>
Definition&#160;8.3.&#160;We&#160;define&#160;the&#160;sheaf&#160;Bµ<br/>
r&#160;on&#160;(X&#160;◦)r&#160;:<br/>
Bµ<br/>
r&#160;:=&#160;Rπ◦<br/>
B∗(SatShtµ&#160;(r.µ)).<br/>
B<br/>
Proposition&#160;8.4.&#160;The&#160;complex&#160;Bµ<br/>
r<br/>
∈&#160;Dbc((X◦)r)&#160;is&#160;locally&#160;constant&#160;on&#160;(X◦)r,&#160;in&#160;the&#160;sense&#160;that&#160;each<br/>
Riπ◦&#160;(Sat<br/>
(r.µ))&#160;is&#160;a&#160;local&#160;system.<br/>
B∗<br/>
Shtµ<br/>
B<br/>
Proof.&#160;The&#160;proof&#160;is&#160;the&#160;same&#160;as&#160;for&#160;Proposition&#160;<a href="1711.02243s.html#32">8.2.</a><br/>
<br/>
Again,&#160;we&#160;have&#160;commuting&#160;actions&#160;of&#160;the&#160;Hecke&#160;algebra&#160;H&#160;and&#160;π1((X◦)r,&#160;xr)&#160;⋊&#160;Sr&#160;on&#160;Bµr.<br/>
8.4.&#160;The&#160;comparison&#160;theorem.<br/>
Theorem&#160;8.5&#160;(<a href="1711.02243s.html#40">[Ngo06]</a>).&#160;Let&#160;τ&#160;∈&#160;Sr&#160;be&#160;an&#160;r-cycle,&#160;i.e.&#160;hτi&#160;∼<br/>
=&#160;Z/rZ.&#160;For&#160;g&#160;∈&#160;π1((X◦)r,&#160;xr)&#160;and&#160;h&#160;∈&#160;H&#160;we<br/>
have<br/>
Tr((h&#160;⊗&#160;1&#160;.&#160;.&#160;.&#160;⊗&#160;1)gτ,&#160;(Aµr)xr)&#160;=&#160;Tr(hgτ,&#160;(Bµr)xr&#160;).<br/>
Proof.&#160;This&#160;is&#160;<a href="1711.02243s.html#40">[Ngo06]&#160;</a>§3.3&#160;Theorem&#160;1.&#160;Since&#160;this&#160;is&#160;really&#160;crucial&#160;for&#160;us,&#160;we&#160;outline&#160;for&#160;the&#160;sake&#160;of&#160;exposition<br/>how&#160;the&#160;proof&#160;goes.&#160;Keep&#160;in&#160;mind&#160;that&#160;Aµr&#160;and&#160;Bµr&#160;are&#160;both&#160;local&#160;systems.<br/>
By&#160;an&#160;application&#160;of&#160;the&#160;Cebotarev&#160;density&#160;theorem,&#160;it&#160;suffices&#160;to&#160;prove&#160;the&#160;equality&#160;for&#160;g&#160;=&#160;Frob(x1,...,xr)<br/>
for&#160;a&#160;dense&#160;open&#160;subset&#160;of&#160;Xr,&#160;and&#160;in&#160;particular&#160;on&#160;the&#160;locus&#160;(x1,&#160;.&#160;.&#160;.&#160;,&#160;xr)&#160;where&#160;the&#160;xi&#160;are&#160;pairwise&#160;distinct.<br/>On&#160;this&#160;locus&#160;(and&#160;under&#160;a&#160;certain&#160;further&#160;restriction&#160;on&#160;the&#160;points&#160;(x1,&#160;.&#160;.&#160;.&#160;,&#160;xr))&#160;Ngô&#160;independently&#160;computes<br/>both&#160;sides&#160;of&#160;the&#160;equation,&#160;and&#160;verifies&#160;that&#160;they&#160;are&#160;equal&#160;by&#160;direct&#160;comparison.<br/>
Let&#160;us&#160;say&#160;a&#160;little&#160;more&#160;about&#160;this&#160;computation,&#160;which&#160;is&#160;carried&#160;out&#160;in&#160;<a href="1711.02243s.html#40">[Ngo06]&#160;</a>§5.&#160;Using&#160;the&#160;Grothendieck-<br/>
Lefschetz&#160;trace&#160;formula&#160;to&#160;re-express&#160;both&#160;sides,&#160;there&#160;are&#160;two&#160;main&#160;inputs:&#160;(1)&#160;a&#160;count&#160;of&#160;fixed&#160;points,&#160;and<br/>(2)&#160;a&#160;computation&#160;of&#160;the&#160;trace&#160;of&#160;Frobenius&#160;on&#160;the&#160;stalks&#160;of&#160;the&#160;relevant&#160;sheaves.&#160;The&#160;counting&#160;step&#160;is<br/>done&#160;as&#160;in&#160;<a href="1711.02243s.html#20">§6,&#160;</a>and&#160;the&#160;analysis&#160;of&#160;the&#160;stalks&#160;enters&#160;via&#160;results&#160;as&#160;in&#160;<a href="1711.02243s.html#27">§7.3.&#160;</a>The&#160;interesting&#160;feature&#160;is&#160;that&#160;the<br/>pairwise&#160;distinctness&#160;of&#160;the&#160;points&#160;(x1,&#160;.&#160;.&#160;.&#160;,&#160;xr),&#160;plus&#160;the&#160;extra&#160;restriction&#160;that&#160;we&#160;have&#160;omitted,&#160;turns&#160;out&#160;to<br/>imply&#160;that&#160;the&#160;point&#160;counting&#160;formulas&#160;involve&#160;no&#160;twisted&#160;orbital&#160;integrals.&#160;Thus,&#160;no&#160;fundamental&#160;lemma&#160;is<br/>required&#160;to&#160;prove&#160;the&#160;desired&#160;equality.<br/>
<br/>
Remark&#160;8.6.&#160;For&#160;a&#160;heuristic&#160;that&#160;underlies&#160;the&#160;theorem,&#160;coming&#160;from&#160;a&#160;conjectural&#160;description&#160;of&#160;the&#160;coho-<br/>mology&#160;of&#160;shtukas,&#160;see&#160;<a href="1711.02243s.html#40">[Ngo06]&#160;</a>§2.2,&#160;3.3.&#160;The&#160;punchline&#160;is&#160;that&#160;after&#160;admitting&#160;this&#160;conjectural&#160;description,<br/>the&#160;identity&#160;in&#160;Theorem&#160;<a href="1711.02243s.html#33">8.5&#160;</a>reduces&#160;to&#160;Lemma&#160;<a href="1711.02243s.html#30">7.13.</a><br/>
Definition&#160;8.7.&#160;Let<br/>
RΨxr(Aµ<br/>
(Sat<br/>
(r.µ)|<br/>
0<br/>
r&#160;)&#160;:=&#160;RπA!RΨxr0<br/>
Shtµ<br/>
∆(X◦))&#160;∈&#160;Db<br/>
c(x0)<br/>
A<br/>
be&#160;the&#160;cohomology&#160;of&#160;nearby&#160;cycles&#160;at&#160;xr0&#160;∈&#160;∆(X&#160;−&#160;Z),&#160;and&#160;let<br/>
RΨxr(Bµ<br/>
(Sat<br/>
(r.µ)|<br/>
0<br/>
r&#160;)&#160;:=&#160;RπB!RΨxr0<br/>
Shtµ<br/>
∆(X◦))&#160;∈&#160;Db<br/>
c(x0)<br/>
B<br/>
be&#160;the&#160;cohomology&#160;of&#160;nearby&#160;cycles&#160;at&#160;xr0&#160;∈&#160;∆(X&#160;−&#160;Z)<a href="1711.02243s.html#33">.6&#160;</a>Again&#160;we&#160;apply&#160;Remark&#160;<a href="1711.02243s.html#17">5.8&#160;</a>to&#160;equip&#160;RΨxr(Aµ<br/>
0<br/>
r&#160;)<br/>
and&#160;RΨxr&#160;(Bµ<br/>
0<br/>
r&#160;)&#160;with&#160;Fq&#160;-structures.<br/>
Thanks&#160;to&#160;Proposition&#160;<a href="1711.02243s.html#32">8.2&#160;</a>and&#160;Proposition&#160;<a href="1711.02243s.html#33">8.4,&#160;</a>the&#160;complex&#160;RΨxr&#160;(Aµ<br/>
0<br/>
r&#160;)&#160;is&#160;equipped&#160;with&#160;commuting&#160;ac-<br/>
tions&#160;of&#160;π1((X◦)r,&#160;xr)⋊Sr&#160;and&#160;(H)⊗r,&#160;while&#160;RΨxr(Bµ<br/>
0<br/>
r&#160;)&#160;is&#160;equipped&#160;with&#160;commuting&#160;actions&#160;of&#160;π1((X&#160;◦)r&#160;,&#160;xr&#160;)⋊<br/>
Sr&#160;and&#160;H.<br/>
Corollary&#160;8.8.&#160;For&#160;g&#160;∈&#160;π1((X◦)r,&#160;xr)&#160;and&#160;h&#160;∈&#160;H&#160;we&#160;have<br/>
Tr((h&#160;⊗&#160;1&#160;.&#160;.&#160;.&#160;⊗&#160;1)&#160;◦&#160;Frob&#160;◦τ,&#160;RΨxr(Aµ<br/>
(Bµ<br/>
0<br/>
r&#160;))&#160;=&#160;Tr(h&#160;◦&#160;Frob&#160;◦τ,&#160;RΨxr0<br/>
r&#160;)).<br/>
(8.1)<br/>
6This&#160;is&#160;a&#160;small&#160;abuse&#160;of&#160;the&#160;notation&#160;used&#160;in&#160;<a href="1711.02243s.html#17">§5.2.</a><br/>
<hr/>
<a name=34></a>34<br/>
TONY&#160;FENG<br/>
Proof.&#160;This&#160;immediate&#160;from&#160;Theorem&#160;<a href="1711.02243s.html#33">8.5,&#160;</a>Proposition&#160;<a href="1711.02243s.html#15">4.21&#160;</a>plus&#160;Corollary&#160;<a href="1711.02243s.html#17">5.10,&#160;</a>and&#160;the&#160;Cebotarev&#160;density<br/>theorem.<br/>
<br/>
9.&#160;Calculation&#160;of&#160;traces&#160;on&#160;the&#160;cohomology&#160;of&#160;nearby&#160;cycles<br/>
Our&#160;next&#160;step&#160;is&#160;to&#160;combine&#160;the&#160;work&#160;of&#160;<a href="1711.02243s.html#16">§5,&#160;</a><a href="1711.02243s.html#20">§6&#160;</a>and&#160;<a href="1711.02243s.html#25">§7&#160;</a>to&#160;prove&#160;Kottwitz-style&#160;formulas&#160;for&#160;both&#160;sides&#160;of<br/>
<a href="1711.02243s.html#33">(8.1)</a>.&#160;We&#160;maintain&#160;the&#160;notation&#160;of&#160;those&#160;preceding&#160;sections.<br/>
9.1.&#160;Calculating&#160;the&#160;trace&#160;in&#160;situation&#160;A.<br/>
Definition&#160;9.1.&#160;For&#160;a&#160;Kottwitz&#160;triple&#160;(γ0,&#160;(γx),&#160;(δx))&#160;write<br/>
c(γ0,&#160;(γx),&#160;(δx))&#160;:=&#160;ker1(F,&#160;Gγ&#160;)&#160;·&#160;vol(J&#160;·&#160;J&#160;(F&#160;)\J&#160;(A<br/>
0<br/>
γ0<br/>
γ0<br/>
F&#160;))&#160;·&#160;dg(K&#160;)−1<br/>
where&#160;the&#160;notation&#160;is&#160;as&#160;in&#160;<a href="1711.02243s.html#20">§6.</a><br/>
Theorem&#160;9.2.&#160;Let&#160;T&#160;′&#160;⊂&#160;|X◦|.&#160;Assume&#160;that&#160;Kv&#160;:=&#160;G(Ov)&#160;is&#160;spherical&#160;at&#160;all&#160;v&#160;∈&#160;T&#160;′.&#160;Let<br/>
β&#160;=&#160;(βv&#160;∈&#160;Kv\G(Fv)/Kv)v∈T′<br/>
and&#160;hβ&#160;∈&#160;H&#160;be&#160;the&#160;corresponding&#160;Hecke&#160;operator.&#160;Let&#160;RΨxr&#160;(Aµ<br/>
0<br/>
r&#160;)&#160;be&#160;as&#160;in&#160;Definition&#160;<a href="1711.02243s.html#33">8.7,&#160;</a>let&#160;τ&#160;be&#160;as&#160;in<br/>
Theorem&#160;<a href="1711.02243s.html#33">8.5,&#160;</a>let&#160;fβ&#160;be&#160;as&#160;in&#160;Definition&#160;<a href="1711.02243s.html#16">5.1,&#160;</a>and&#160;let&#160;ψ<br/>
v<br/>
r,µ′&#160;be&#160;as&#160;in&#160;<a href="1711.02243s.html#30">§7.4.1.&#160;</a>Then&#160;we&#160;have<br/>
Tr((hβ&#160;⊗&#160;1&#160;.&#160;.&#160;.&#160;⊗&#160;1)&#160;◦&#160;Frobx&#160;◦τ,&#160;RΨ&#160;(Aµ<br/>
0<br/>
xr0<br/>
r&#160;))<br/>
<br/>
X<br/>
Y<br/>
=<br/>
c(γ0,&#160;(γx),&#160;(δx))&#160;·&#160;<br/>
Oγ&#160;(f&#160;)&#160;TO<br/>
v<br/>
βv<br/>
δx&#160;σ(ψ′<br/>
0<br/>
r,µ)<br/>
(γ0,(γx),(δx))<br/>
v6=x0<br/>
inv(γ0,(γx),(δx))=0<br/>
Proof.&#160;We’ll&#160;use&#160;the&#160;Lefschetz&#160;trace&#160;formula&#160;to&#160;rewrite&#160;the&#160;trace&#160;in&#160;terms&#160;of&#160;a&#160;sum&#160;of&#160;traces&#160;over&#160;fixed&#160;points.<br/>The&#160;effect&#160;of&#160;στ&#160;on&#160;a&#160;point&#160;of&#160;ShtA&#160;is&#160;illustrated&#160;below:<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
≤µ<br/>
≤µ<br/>
σ<br/>
<br/>
<br/>
σ2<br/>
<br/>
&#160;E<br/>
−−→&#160;E<br/>
<br/>
<br/>
E<br/>
−−→&#160;σE<br/>
<br/>
&#160;1|X−x0<br/>
1|X−x0&#160;<br/>
<br/>
r|X−x0<br/>
r|X−x0<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
σ<br/>
≤µ<br/>
<br/>
<br/>
≤µ<br/>
<br/>
E<br/>
<br/>
<br/>
σ2<br/>
<br/>
2|X−x<br/>
−−→&#160;E<br/>
E<br/>
−−→&#160;σE<br/>
0<br/>
2|X−x0<br/>
στ<br/>
1|X−x<br/>
1|X−x<br/>
−−→<br/>
0<br/>
0<br/>
.<br/>
<br/>
.<br/>
.<br/>
<br/>
.<br/>
<br/>
<br/>
.<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
.<br/>
<br/>
<br/>
.<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
σ<br/>
≤µ<br/>
≤µ<br/>
E<br/>
<br/>
σ2<br/>
<br/>
r|X−x<br/>
−−→&#160;E<br/>
E<br/>
−−→&#160;σE<br/>
.<br/>
0<br/>
r|X−x0<br/>
r−1|X−x0<br/>
r−1|X−x0<br/>
Therefore,&#160;a&#160;fixed&#160;point&#160;of&#160;the&#160;correspondence&#160;(hβ&#160;⊗&#160;1&#160;.&#160;.&#160;.&#160;⊗&#160;1)&#160;◦&#160;Frobx&#160;◦τ&#160;corresponds&#160;to&#160;a&#160;point&#160;as&#160;above<br/>
0<br/>
such&#160;that<br/>
E2&#160;=&#160;σE1<br/>
...<br/>
Er&#160;=&#160;σEr−1<br/>
=β<br/>
E1&#160;−−→&#160;σEr.<br/>
Hence&#160;a&#160;fixed&#160;point&#160;is&#160;equivalent&#160;to&#160;the&#160;data&#160;of&#160;commuting&#160;modifications<br/>
≤µ<br/>
t&#160;:&#160;σE1|X−x&#160;−−→&#160;E<br/>
0<br/>
1|X−x0<br/>
=β<br/>
t′&#160;:&#160;σr&#160;E1|X−T′&#160;−−→&#160;E1|X−T′.<br/>
Hence&#160;in&#160;the&#160;notation&#160;of&#160;<a href="1711.02243s.html#20">§6&#160;</a>we&#160;see&#160;that<br/>
[<br/>
Fix((hβ&#160;⊗&#160;1&#160;.&#160;.&#160;.&#160;⊗&#160;1)&#160;◦&#160;Frobx&#160;◦τ)&#160;=<br/>
C(ν&#160;,&#160;β;&#160;x<br/>
0<br/>
x0<br/>
0,&#160;T&#160;′;&#160;r).<br/>
ν≤µ<br/>
By&#160;Lemma&#160;<a href="1711.02243s.html#17">5.9&#160;</a>plus&#160;Proposition&#160;<a href="1711.02243s.html#15">4.21,&#160;</a>we&#160;have<br/>
RΨxr(Aµ<br/>
(SatSht&#160;(r.µ))).<br/>
0<br/>
r&#160;)&#160;∼<br/>
=&#160;RπA!(RΨxr0<br/>
A<br/>
<hr/>
<a name=35></a><img class="yflip" src="html/1711.02243-35_1.png"/><br/>
NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,&#160;AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
35<br/>
Now&#160;invoking&#160;the&#160;Grothendieck-Lefschetz&#160;trace&#160;formula,&#160;we&#160;have<br/>
Tr((hβ&#160;⊗&#160;1&#160;.&#160;.&#160;.&#160;⊗&#160;1)&#160;◦&#160;Frobx&#160;◦τ,&#160;RΨ&#160;(Aµ<br/>
0<br/>
xr0<br/>
r&#160;))<br/>
X<br/>
X<br/>
=<br/>
Tr((hβ&#160;⊗&#160;1&#160;.&#160;.&#160;.&#160;⊗&#160;1)&#160;◦&#160;Frob&#160;◦τ,&#160;RΨxr(SatSht&#160;(r.µ))Ξ).<br/>
0<br/>
A<br/>
ν≤µ&#160;Ξ∈C(νx&#160;,β;x<br/>
0<br/>
0,T&#160;′;r)<br/>
By&#160;Corollary&#160;<a href="1711.02243s.html#20">5.22,&#160;</a>for&#160;all&#160;Ξ&#160;∈&#160;C(νx&#160;,&#160;β;&#160;x<br/>
0<br/>
0,&#160;T&#160;′;&#160;r)&#160;we&#160;have<br/>
RΨxr(SatSht&#160;(r.µ))Ξ&#160;=&#160;RΨxr&#160;(SatGrr&#160;(r.µ))ν.<br/>
0<br/>
A<br/>
0<br/>
G<br/>
Now&#160;using&#160;Corollary&#160;<a href="1711.02243s.html#25">6.14,&#160;</a>we&#160;can&#160;rewrite&#160;our&#160;formula&#160;as<br/>
Tr((hβ&#160;⊗&#160;1&#160;.&#160;.&#160;.&#160;⊗&#160;1)&#160;◦&#160;Frobx&#160;◦τ,&#160;RΨ&#160;(Aµ<br/>
0<br/>
xr0<br/>
r&#160;))<br/>
X<br/>
Y<br/>
=<br/>
c(γ0,&#160;(γx),&#160;(δx))&#160;·<br/>
Oγ&#160;(f&#160;)<br/>
v<br/>
βv<br/>
(γ0,(γx),(δx))<br/>
v6=x0<br/>
inv(γ0,(γx),(δx))=0<br/>
X<br/>
·<br/>
TOδ<br/>
(Sat<br/>
(r.µ))<br/>
x&#160;σ&#160;(fν&#160;)&#160;·&#160;Tr((hβ&#160;⊗&#160;1&#160;.&#160;.&#160;.&#160;⊗&#160;1)&#160;◦&#160;Frob&#160;◦τ&#160;,&#160;RΨxr<br/>
Grr<br/>
ν&#160;).<br/>
(9.1)<br/>
0<br/>
0<br/>
G<br/>
ν≤µ<br/>
Since&#160;the&#160;Hecke&#160;operator&#160;hβ&#160;supports&#160;a&#160;modification&#160;at&#160;T&#160;′,&#160;which&#160;is&#160;disjoint&#160;from&#160;x0,&#160;it&#160;acts&#160;trivially&#160;on&#160;all<br/>the&#160;stalks&#160;lying&#160;over&#160;xr0,&#160;so&#160;we&#160;may&#160;ignore&#160;it&#160;when&#160;computing&#160;the&#160;trace&#160;in&#160;<a href="1711.02243s.html#35">(9.1)</a>.&#160;Since<br/>
RΨxr(SatGrr&#160;(r.µ))&#160;∼<br/>
=&#160;RΨx&#160;(SatGr&#160;(µ))⊠r,<br/>
(9.2)<br/>
0<br/>
G<br/>
0<br/>
G<br/>
the&#160;trace&#160;of&#160;Frob&#160;◦τ&#160;coincides&#160;with&#160;the&#160;trace&#160;of&#160;Frobenius&#160;for&#160;the&#160;Satake&#160;sheaf&#160;on&#160;the&#160;Weil&#160;restriction<br/>Resk<br/>
⊗<br/>
F<br/>
r&#160;/k&#160;(Gr≤µ<br/>
G<br/>
Fq<br/>
qr&#160;).&#160;Therefore,&#160;by&#160;<a href="1711.02243s.html#40">[Ngo06]&#160;</a>§5.2&#160;Proposition&#160;3,&#160;we&#160;hav<a href="1711.02243s.html#35">e7</a><br/>
Tr(Frob&#160;◦τ,&#160;RΨxr(SatGrr&#160;(r.µ))ν&#160;)&#160;=&#160;Tr(Frobr,&#160;RΨxr(SatGr&#160;(µ))ν&#160;).<br/>
(9.3)<br/>
0<br/>
G<br/>
0<br/>
G<br/>
Substituting&#160;<a href="1711.02243s.html#35">(9.3)&#160;</a>into&#160;<a href="1711.02243s.html#35">(9.1)&#160;</a>we&#160;arrive&#160;at<br/>
Tr((hβ&#160;⊗&#160;1&#160;.&#160;.&#160;.&#160;⊗&#160;1)&#160;◦&#160;Frobx&#160;◦τ,&#160;RΨ&#160;(Aµ<br/>
0<br/>
xr0<br/>
r&#160;))<br/>
X<br/>
Y<br/>
=<br/>
c(γ0,&#160;(γx),&#160;(δx))&#160;·<br/>
Oγ&#160;(f&#160;)<br/>
v<br/>
βv<br/>
(γ0,(γx),(δx))<br/>
v6=x0<br/>
inv(γ0,(γx),(δx))=0<br/>
X<br/>
·<br/>
TOδ<br/>
(Sat<br/>
(µ))<br/>
x&#160;σ&#160;(fν&#160;)&#160;·&#160;Tr(Frobr&#160;,&#160;RΨxr<br/>
Gr<br/>
ν&#160;).<br/>
(9.4)<br/>
0<br/>
0<br/>
G<br/>
ν≤µ<br/>
By&#160;Lemma&#160;<a href="1711.02243s.html#19">5.17&#160;</a>we&#160;have&#160;the&#160;following&#160;identity:<br/>
X<br/>
ψ′r,µ&#160;=<br/>
Tr(Frobr,&#160;RΨxr(SatGr&#160;(µ))ν)fν.<br/>
0<br/>
G<br/>
ν≤µ<br/>
Substituting&#160;this&#160;in&#160;<a href="1711.02243s.html#35">(9.4)</a>,&#160;we&#160;finally&#160;find<br/>
Tr((hβ&#160;⊗&#160;1&#160;.&#160;.&#160;.&#160;⊗&#160;1)&#160;◦&#160;Frobx&#160;◦τ,&#160;RΨ&#160;(Aµ<br/>
0<br/>
xr0<br/>
r&#160;))<br/>
<br/>
X<br/>
Y<br/>
=<br/>
c(γ<br/>
<br/>
<br/>
0,&#160;(γx),&#160;(δx))&#160;·<br/>
Oγ&#160;(f&#160;)<br/>
·&#160;TO<br/>
v<br/>
βv<br/>
δx&#160;σ(ψ′<br/>
0<br/>
r,µ)<br/>
(γ0,(γx),(δx&#160;))<br/>
v6=x<br/>
0<br/>
0<br/>
inv(γ0,(γx),(δx))=0<br/>
which&#160;is&#160;what&#160;we&#160;wanted&#160;to&#160;show.<br/>
<br/>
7The&#160;proof&#160;of&#160;this&#160;formula,&#160;which&#160;is&#160;not&#160;explicitly&#160;written&#160;in&#160;<a href="1711.02243s.html#40">[Ngo06]</a>,&#160;goes&#160;as&#160;follows.&#160;By&#160;<a href="1711.02243s.html#35">(9.2)&#160;</a>we&#160;have<br/>
Tr(Frob&#160;◦τ,&#160;RΨ&#160;r&#160;(Sat<br/>
(r.µ))&#160;)&#160;=&#160;Tr(Frob<br/>
(Sat<br/>
(µ))⊠r&#160;)<br/>
x<br/>
Grr<br/>
ν<br/>
◦τ,&#160;RΨx<br/>
Gr<br/>
0<br/>
G<br/>
0<br/>
G<br/>
ν<br/>
=&#160;Tr(Frobr,&#160;RΨ<br/>
(Sat<br/>
(µ))&#160;),<br/>
x0<br/>
GrG<br/>
ν<br/>
where&#160;in&#160;the&#160;last&#160;equality&#160;we&#160;used&#160;Lemma&#160;<a href="1711.02243s.html#30">7.13.</a><br/>
<hr/>
<a name=36></a>36<br/>
TONY&#160;FENG<br/>
9.2.&#160;Calculating&#160;the&#160;trace&#160;in&#160;situation&#160;B.&#160;We&#160;now&#160;want&#160;to&#160;prove&#160;an&#160;analogous&#160;formula&#160;for&#160;the&#160;trace&#160;in<br/>situation&#160;B.&#160;The&#160;computation&#160;in&#160;this&#160;case&#160;is&#160;a&#160;little&#160;more&#160;involved.&#160;The&#160;main&#160;reason&#160;is&#160;that&#160;the&#160;action&#160;of&#160;Sr<br/>on&#160;Bxr&#160;is&#160;difficult&#160;to&#160;understand&#160;explicitly.&#160;Recall&#160;that&#160;is&#160;was&#160;obtained&#160;from&#160;the&#160;fact&#160;that&#160;B|U&#160;was&#160;a&#160;local<br/>
0<br/>
system,&#160;so&#160;that&#160;we&#160;could&#160;extend&#160;it&#160;over&#160;X.&#160;However,&#160;this&#160;process&#160;obfuscates&#160;the&#160;geometric&#160;meaning&#160;of&#160;this<br/>action,&#160;and&#160;we&#160;will&#160;need&#160;to&#160;use&#160;the&#160;results&#160;of&#160;<a href="1711.02243s.html#25">§7,&#160;</a>particularly&#160;the&#160;geometric&#160;model&#160;of&#160;base&#160;change&#160;studied&#160;in<br/><a href="1711.02243s.html#31">§7.4.3,&#160;</a>in&#160;order&#160;to&#160;understand&#160;it.<br/>
Theorem&#160;9.3.&#160;Let&#160;T&#160;′&#160;⊂&#160;|X◦|.&#160;Assume&#160;that&#160;Kv&#160;:=&#160;G(Ov)&#160;is&#160;spherical&#160;at&#160;all&#160;v&#160;∈&#160;T&#160;′.&#160;Let<br/>
β&#160;=&#160;(βv&#160;∈&#160;Kv\G(Fv)/Kv)v∈T′<br/>
and&#160;hβ&#160;∈&#160;H&#160;be&#160;the&#160;corresponding&#160;Hecke&#160;operator.&#160;Let&#160;RΨxr(Bµ<br/>
0<br/>
r&#160;)&#160;be&#160;as&#160;in&#160;Definition&#160;<a href="1711.02243s.html#33">8.7,&#160;</a>let&#160;τ&#160;be&#160;as&#160;in<br/>
Theorem&#160;<a href="1711.02243s.html#33">8.5,&#160;</a>and&#160;let&#160;ψr,µ′&#160;be&#160;as&#160;in&#160;<a href="1711.02243s.html#30">§7.4.1.&#160;</a>Then&#160;we&#160;have<br/>
Tr(hβ&#160;◦&#160;Frobx&#160;◦τ,&#160;RΨ&#160;(Bµ<br/>
0<br/>
xr0<br/>
r&#160;))<br/>
<br/>
<br/>
X<br/>
Y<br/>
=<br/>
c(γ0,&#160;(γx),&#160;(δx))&#160;·&#160;<br/>
Oγ&#160;(f&#160;)&#160;·&#160;O<br/>
(b(ψ′<br/>
v<br/>
βv<br/>
γx0<br/>
r,µ)).<br/>
(γ0,(γx),(δx))<br/>
v6=x0<br/>
inv(γ0,(γx),(δx))=0<br/>
Proof.&#160;Let&#160;X(r)&#160;=&#160;Symr(X)&#160;by&#160;the&#160;rth&#160;symmetric&#160;power&#160;of&#160;X,&#160;and<br/>
Shtµ<br/>
:=&#160;Sht≤r.µ&#160;/aZ.<br/>
B,X(r)<br/>
G,X(r)<br/>
The&#160;idea&#160;here&#160;is&#160;to&#160;push&#160;down&#160;the&#160;computation&#160;from&#160;Xr&#160;to&#160;X(r),&#160;which&#160;trivializes&#160;the&#160;Sr&#160;action&#160;on&#160;the&#160;fiber<br/>ShtB,X(r)&#160;over&#160;a&#160;point,&#160;transferring&#160;the&#160;effect&#160;of&#160;this&#160;action&#160;completely&#160;to&#160;the&#160;sheaf&#160;theory,&#160;where&#160;it&#160;was<br/>studied&#160;in&#160;<a href="1711.02243s.html#25">§7.&#160;</a>Consider&#160;the&#160;following&#160;commutative&#160;diagram,&#160;in&#160;which&#160;the&#160;front&#160;cartesian&#160;square&#160;is&#160;the&#160;fiber<br/>of&#160;the&#160;back&#160;cartesian&#160;square&#160;over&#160;the&#160;diagonal&#160;copy&#160;of&#160;X&#160;in&#160;X(r).<br/>
Shtµ<br/>
Xr<br/>
B<br/>
m<br/>
add<br/>
Shtµ<br/>
X(r)<br/>
B,X(r)<br/>
(9.5)<br/>
Sht≤r.µ&#160;|<br/>
B<br/>
∆<br/>
∆(X)<br/>
m<br/>
add<br/>
Sht≤rµ&#160;/aZ<br/>
π<br/>
∆(X)<br/>
G,X<br/>
The&#160;map&#160;add&#160;:&#160;Xr&#160;→&#160;X(r)&#160;is&#160;totally&#160;ramified&#160;over&#160;the&#160;diagonal&#160;∆(X)&#160;⊂&#160;Xr,&#160;so&#160;for&#160;any&#160;étale&#160;sheaf&#160;F&#160;on&#160;Xr<br/>the&#160;stalk&#160;of&#160;F&#160;at&#160;xr&#160;∈&#160;Xr&#160;is&#160;canonically&#160;identified&#160;with&#160;the&#160;stalk&#160;of&#160;add∗F&#160;at&#160;add(xr)&#160;∈&#160;X(r).&#160;Therefore,<br/>from&#160;the&#160;front&#160;cartesian&#160;square&#160;we&#160;have<br/>
Tr(hβ&#160;◦&#160;Frobx&#160;◦τ,&#160;RΨ&#160;(Bµ<br/>
◦τ,&#160;RΨ&#160;(Rπ◦<br/>
(r.µ)))<br/>
0<br/>
xr<br/>
xr<br/>
0<br/>
r&#160;))&#160;=&#160;Tr(hβ&#160;◦&#160;Frobx0<br/>
0<br/>
!&#160;Rm!&#160;SatShtµ<br/>
B<br/>
where&#160;π◦&#160;is&#160;the&#160;restriction&#160;of&#160;π&#160;to&#160;the&#160;fiber&#160;over&#160;(the&#160;diagonal&#160;embedding&#160;of)&#160;X◦.&#160;We&#160;now&#160;proceeding&#160;as<br/>before,&#160;using&#160;the&#160;Grothendieck-Lefschetz&#160;trace&#160;formula&#160;to&#160;rewrite&#160;the&#160;trace&#160;in&#160;terms&#160;of&#160;a&#160;sum&#160;of&#160;traces&#160;over<br/>fixed&#160;points.&#160;We&#160;begin&#160;by&#160;describing&#160;the&#160;fixed&#160;points&#160;of&#160;hβ&#160;◦&#160;Frobx&#160;◦τ&#160;on&#160;Sht≤rµ&#160;/aZ.<br/>
0<br/>
G,X<br/>
Now,&#160;on&#160;Shtµ<br/>
the&#160;permutation&#160;τ&#160;evidently&#160;acts&#160;trivially.&#160;A&#160;point&#160;of&#160;Sht<br/>
is&#160;a&#160;modification<br/>
B,X(r)<br/>
G,X&#160;/aZ|x0<br/>
σ<br/>
≤rµ<br/>
E1|X−x&#160;−−−→&#160;E<br/>
0<br/>
1|X−x0<br/>
occurring&#160;over&#160;x0.&#160;The&#160;map&#160;σ&#160;takes&#160;this&#160;to<br/>
σ2<br/>
≤rµ<br/>
E1|X−x&#160;−−−→&#160;σE<br/>
.<br/>
0<br/>
1|X−x0<br/>
<hr/>
<a name=37></a>NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,&#160;AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
37<br/>
Therefore,&#160;a&#160;fixed&#160;point&#160;of&#160;the&#160;correspondence&#160;hβ&#160;◦&#160;Frobx&#160;◦τ&#160;is&#160;equivalent&#160;to&#160;the&#160;data&#160;of&#160;commuting&#160;modi-<br/>
0<br/>
fications<br/>
≤rµ<br/>
t&#160;:&#160;σE1|X−x&#160;−−−→&#160;E<br/>
0<br/>
1|X−x0<br/>
=β<br/>
t′&#160;:&#160;σE1|X−T′&#160;−−→&#160;E1|X−T′.<br/>
Hence&#160;we&#160;see&#160;that&#160;(remember&#160;that&#160;x0&#160;is&#160;assumed&#160;to&#160;have&#160;degree&#160;1)<br/>
[<br/>
Fix(hβ&#160;◦&#160;Frobx&#160;◦τ)&#160;=<br/>
C(ν&#160;,&#160;β;&#160;x<br/>
0<br/>
x0<br/>
0,&#160;T&#160;′;&#160;1)<br/>
ν≤rµ<br/>
so&#160;by&#160;the&#160;Grothendieck-Lefschetz&#160;trace&#160;and&#160;arguing&#160;as&#160;in&#160;<a href="1711.02243s.html#34">§9.1&#160;</a>for&#160;situation&#160;A,<br/>
X<br/>
Tr(hβ&#160;◦&#160;Frobx&#160;◦τ,&#160;RΨ&#160;(Bµ<br/>
#C(ν&#160;,&#160;β;&#160;x<br/>
0<br/>
xr<br/>
x<br/>
0,&#160;T&#160;′;&#160;1)<br/>
0<br/>
r&#160;))&#160;=<br/>
0<br/>
ν≤rµ<br/>
·&#160;Tr(hβ&#160;◦&#160;Frob&#160;◦τ,&#160;RΨxr(Rm!&#160;Sat<br/>
(r.µ))ν).<br/>
0<br/>
Shtµ<br/>
B<br/>
Using&#160;Theorem&#160;<a href="1711.02243s.html#25">6.14,&#160;</a>we&#160;rewrite&#160;this&#160;as<br/>
Tr(hβ&#160;◦&#160;Frobx&#160;◦τ,&#160;RΨ&#160;(Bµ<br/>
0<br/>
xr0<br/>
r&#160;))<br/>
X<br/>
Y<br/>
=<br/>
c(γ0,&#160;(γx),&#160;(δx))&#160;·<br/>
Oγ&#160;(f&#160;)<br/>
v<br/>
βv<br/>
(γ0,(γx),(δx))<br/>
v6=x0<br/>
inv(γ0,(γx),(δx))=0<br/>
X<br/>
·<br/>
TOδ&#160;(f<br/>
(Rm<br/>
(r.µ))<br/>
x<br/>
ν&#160;)&#160;·&#160;Tr(hβ&#160;◦&#160;Frob&#160;◦τ,&#160;RΨxr<br/>
!&#160;Sat<br/>
ν&#160;).<br/>
(9.6)<br/>
0<br/>
0<br/>
Shtµ<br/>
B<br/>
ν≤µ<br/>
As&#160;in&#160;the&#160;previous&#160;calculation&#160;for&#160;situation&#160;A,&#160;the&#160;Hecke&#160;operator&#160;acts&#160;trivially&#160;on&#160;the&#160;stalk&#160;at&#160;x0&#160;because<br/>
is&#160;supported&#160;on&#160;a&#160;disjoint&#160;set&#160;of&#160;points.&#160;We&#160;use&#160;the&#160;affine&#160;Grassmannian&#160;as&#160;a&#160;local&#160;model&#160;to&#160;calculate<br/>Tr(Frobx&#160;◦τ,&#160;RΨ&#160;(Rm<br/>
(r.µ))<br/>
0<br/>
xr<br/>
!SatSht<br/>
ν&#160;).&#160;By&#160;Theorem&#160;<a href="1711.02243s.html#19">5.19,&#160;</a>we&#160;have<br/>
0<br/>
B<br/>
Tr(Frobx&#160;◦τ,&#160;RΨ&#160;(Rm<br/>
(r.µ))<br/>
◦κ′,&#160;RΨ&#160;(Rm<br/>
(r.µ))<br/>
0<br/>
xr<br/>
!&#160;Sat<br/>
ν&#160;)&#160;=&#160;Tr(Frobx<br/>
xr<br/>
!&#160;Sat<br/>
ν&#160;),<br/>
(9.7)<br/>
0<br/>
Shtµ<br/>
B<br/>
0<br/>
0<br/>
Gr≤r.µ<br/>
G,Xr<br/>
where&#160;the&#160;notation&#160;on&#160;the&#160;right&#160;hand&#160;side&#160;is&#160;as&#160;in&#160;Corollary&#160;<a href="1711.02243s.html#32">7.18,&#160;</a>if&#160;we&#160;can&#160;show&#160;that&#160;the&#160;permutation&#160;τ&#160;on<br/>the&#160;left&#160;side&#160;is&#160;carried&#160;by&#160;Theorem&#160;<a href="1711.02243s.html#19">5.19&#160;</a>to&#160;the&#160;permutation&#160;κ′&#160;studied&#160;in&#160;<a href="1711.02243s.html#31">§7.4.3.&#160;</a>(The&#160;same&#160;issue&#160;is&#160;raised<br/>and&#160;explained&#160;in&#160;<a href="1711.02243s.html#40">[Ngo06]&#160;</a>§5.6&#160;Proposition&#160;3.)&#160;To&#160;prove&#160;it,&#160;consider&#160;the&#160;diagram<br/>
f<br/>
W&#160;≤r.µ<br/>
Xr<br/>
étale<br/>
m<br/>
Gr≤r.µ<br/>
f<br/>
W&#160;≤rµ<br/>
Shtµ<br/>
Xr<br/>
G,Xr<br/>
X(r)<br/>
B<br/>
m<br/>
étale<br/>
m<br/>
add<br/>
Gr≤rµ<br/>
Shtµ<br/>
X(r)<br/>
G,X(r)<br/>
B,X(r)<br/>
Here&#160;f<br/>
W&#160;≤r.µ<br/>
|<br/>
expresses&#160;Gr≤rµ<br/>
as&#160;a&#160;local&#160;model<br/>
Xr<br/>
expresses&#160;Gr≤r.µ<br/>
G,Xr&#160;as&#160;a&#160;local&#160;model&#160;for&#160;Sht≤r.µ<br/>
B<br/>
∆&#160;and&#160;f<br/>
W&#160;≤rµ<br/>
X(r)<br/>
G,X(r)<br/>
for&#160;Shtµ<br/>
.&#160;The&#160;existence&#160;of&#160;such&#160;a&#160;commutive&#160;diagram&#160;is&#160;immediate&#160;from&#160;the&#160;proof&#160;of&#160;Theorem&#160;<a href="1711.02243s.html#19">5.19.</a><br/>
B,X(r)<br/>
The&#160;claim&#160;is&#160;then&#160;that&#160;the&#160;permutation&#160;actions&#160;on&#160;RΨxr(Rm!&#160;SatGr<br/>
(r.µ))&#160;and&#160;RΨxr(Rm!SatSht&#160;(r.µ)),<br/>
0<br/>
G,Xr<br/>
0<br/>
B<br/>
induced&#160;by&#160;middle&#160;extension&#160;from&#160;(X◦)r&#160;to&#160;(X&#160;−&#160;Z)r,&#160;are&#160;compatible.&#160;This&#160;is&#160;clear&#160;from&#160;the&#160;diagram&#160;and<br/>the&#160;fact&#160;that&#160;the&#160;identity&#160;can&#160;be&#160;checked&#160;on&#160;the&#160;locus&#160;where&#160;the&#160;points&#160;(x1,&#160;.&#160;.&#160;.&#160;,&#160;xr)&#160;are&#160;distinct,&#160;where&#160;it&#160;is<br/>evidently&#160;given&#160;by&#160;the&#160;same&#160;geometric&#160;permutation&#160;action&#160;in&#160;both&#160;cases.<br/>
Now&#160;combining&#160;Proposition&#160;<a href="1711.02243s.html#32">7.18,&#160;</a>Corollary&#160;<a href="1711.02243s.html#20">5.22,&#160;</a>and&#160;Lemma&#160;<a href="1711.02243s.html#19">5.17,&#160;</a>we&#160;have<br/>
X<br/>
b(ψ′r,µ)&#160;=<br/>
Tr(Frob&#160;◦κ′,&#160;RΨxr(Rm!&#160;SatGr&#160;(µ))ν)fν.<br/>
(9.8)<br/>
0<br/>
G<br/>
ν≤rµ<br/>
<hr/>
<a name=38></a><img class="yflip" src="html/1711.02243-38_1.png"/><br/>
38<br/>
TONY&#160;FENG<br/>
Putting&#160;together&#160;<a href="1711.02243s.html#37">(9.6)</a>,&#160;<a href="1711.02243s.html#37">(9.7)</a>,&#160;and&#160;<a href="1711.02243s.html#37">(9.8)&#160;</a>gives<br/>
Tr((hβ&#160;⊗&#160;1&#160;.&#160;.&#160;.&#160;⊗&#160;1)&#160;◦&#160;Frobx&#160;◦τ,&#160;RΨ&#160;(Bµ<br/>
0<br/>
xr0<br/>
r&#160;))<br/>
<br/>
X<br/>
Y<br/>
=<br/>
c(γ0,&#160;(γx),&#160;(δx))&#160;·&#160;<br/>
Oγ&#160;(f&#160;)&#160;TO<br/>
(b(ψ′<br/>
v<br/>
βv<br/>
δx0<br/>
r,µ))<br/>
(γ0,(γx),(δx&#160;))<br/>
v6=x<br/>
0<br/>
0<br/>
inv(γ0,(γx),(δx))=0<br/>
which&#160;is&#160;what&#160;we&#160;wanted&#160;to&#160;show.<br/>
<br/>
9.3.&#160;The&#160;base&#160;change&#160;fundamental&#160;lemma&#160;for&#160;parahoric&#160;Hecke&#160;algebras.&#160;We&#160;can&#160;now&#160;deduce&#160;some<br/>cases&#160;of&#160;the&#160;base&#160;change&#160;fundamental&#160;lemma.<br/>
Corollary&#160;9.4.&#160;Let&#160;T&#160;′&#160;⊂&#160;|X◦|.&#160;Assume&#160;that&#160;Kv&#160;:=&#160;G(Ov)&#160;is&#160;spherical&#160;at&#160;all&#160;v&#160;∈&#160;T&#160;′.&#160;Let<br/>
β&#160;=&#160;(βv&#160;∈&#160;Kv\G(Fv)/Kv)v∈T′<br/>
and&#160;hβ&#160;∈&#160;H&#160;be&#160;the&#160;corresponding&#160;Hecke&#160;operator.&#160;Let&#160;ψr,µ′&#160;be&#160;as&#160;in&#160;<a href="1711.02243s.html#30">§7.4.1&#160;</a>and&#160;the&#160;base&#160;change&#160;homomorphim<br/>ψr,µ′&#160;7→&#160;b(ψr,µ′)&#160;be&#160;as&#160;in&#160;<a href="1711.02243s.html#25">§7.1.&#160;</a>Then&#160;we&#160;have<br/>
<br/>
<br/>
X<br/>
Y<br/>
c(γ0,&#160;(γx),&#160;(δx))&#160;·&#160;<br/>
Oγ&#160;(f&#160;)&#160;·&#160;TO<br/>
0<br/>
βv<br/>
δx&#160;σ&#160;(ψ′<br/>
0<br/>
r,µ)<br/>
(γ0,(γx),(δx))<br/>
v6=x0<br/>
inv(γ0,(γx),(δx))=0<br/>
<br/>
<br/>
X<br/>
Y<br/>
=<br/>
c(γ<br/>
<br/>
<br/>
0,&#160;(γx),&#160;(δx))&#160;·<br/>
Oγ&#160;(f&#160;)<br/>
·&#160;O&#160;(b(ψ′<br/>
0<br/>
βv<br/>
γ0<br/>
r,µ))<br/>
(γ0,(γx),(δx&#160;))<br/>
v6=x<br/>
0<br/>
0<br/>
inv(γ0,(γx),(δx))=0<br/>
Proof.&#160;This&#160;follows&#160;immediately&#160;from&#160;substituting&#160;Theorem&#160;<a href="1711.02243s.html#34">9.2&#160;</a>and&#160;Theorem&#160;<a href="1711.02243s.html#36">9.3&#160;</a>into&#160;Corollary&#160;<a href="1711.02243s.html#33">8.8,&#160;</a>and&#160;the<br/>following&#160;comment&#160;about&#160;changing&#160;the&#160;γv&#160;to&#160;γ0:&#160;since&#160;by&#160;definition&#160;of&#160;X&#160;−&#160;Z&#160;we&#160;have&#160;that&#160;G(Fx)&#160;∼<br/>
=&#160;GLn(Fx)<br/>
for&#160;all&#160;x&#160;∈&#160;X&#160;−&#160;Z,&#160;the&#160;notion&#160;of&#160;stable&#160;conjugacy&#160;coincides&#160;with&#160;the&#160;notion&#160;of&#160;conjugacy.<br/>
<br/>
It&#160;seems&#160;to&#160;be&#160;“well-known”&#160;how&#160;to&#160;deduce&#160;a&#160;fundamental&#160;lemma&#160;from&#160;a&#160;statement&#160;such&#160;as&#160;Corollary&#160;<a href="1711.02243s.html#38">9.4.8</a><br/>
Nevertheless,&#160;let&#160;us&#160;give&#160;a&#160;proof&#160;for&#160;completeness,&#160;following&#160;<a href="1711.02243s.html#40">[Ngo06]&#160;</a>§5.7&#160;Théorème&#160;1.&#160;First&#160;we&#160;introduce&#160;a<br/>piece&#160;of&#160;notation.<br/>
Definition&#160;9.5.&#160;For&#160;µ&#160;=&#160;(µ1,&#160;.&#160;.&#160;.&#160;,&#160;µn)&#160;∈&#160;X∗(GLn)&#160;∼<br/>
=&#160;Zn,&#160;we&#160;define<br/>
|µ|&#160;:=&#160;µ1&#160;+&#160;.&#160;.&#160;.&#160;+&#160;µn.<br/>
The&#160;stack&#160;Sht≤µ&#160;is&#160;non-empty&#160;if&#160;and&#160;only&#160;if&#160;|µ|&#160;=&#160;0,&#160;because&#160;a&#160;G-bundle&#160;has&#160;the&#160;notion&#160;of&#160;degree&#160;on&#160;X,<br/>
G<br/>
which&#160;is&#160;preserved&#160;by&#160;the&#160;Frobenius&#160;twist&#160;σ&#160;on&#160;S.&#160;Let<br/>
Z(HG(Fx<br/>
),J&#160;)<br/>
0,r&#160;),J&#160;)0&#160;⊂&#160;Z&#160;(HG(Fx0<br/>
be&#160;the&#160;subspace&#160;generated&#160;by&#160;the&#160;ψ′r,µ&#160;with&#160;|µ|&#160;=&#160;0,&#160;which&#160;is&#160;the&#160;same&#160;as&#160;the&#160;subspace&#160;generated&#160;by&#160;the&#160;ψr,µ<br/>with&#160;|µ|&#160;=&#160;0.<br/>
Theorem&#160;9.6.&#160;Let&#160;Fx&#160;be&#160;a&#160;local&#160;field&#160;of&#160;characteristic&#160;p,&#160;and&#160;F<br/>
the&#160;unramified&#160;extension&#160;of&#160;degree<br/>
0<br/>
x0,r/Fx0<br/>
r.&#160;Let&#160;δ&#160;be&#160;a&#160;σ-conjugacy&#160;class&#160;in&#160;GLn(Fx<br/>
=&#160;γ<br/>
∈&#160;GL<br/>
).&#160;Assume&#160;γ<br/>
is&#160;regular<br/>
0&#160;,r&#160;),&#160;with&#160;norm&#160;N&#160;δx0<br/>
x0<br/>
n(Fx0<br/>
x0<br/>
semisimple&#160;and&#160;separable.&#160;If&#160;φ&#160;∈&#160;Z(HG(Fx0,r),J)0,&#160;then&#160;we&#160;have<br/>
TOδ<br/>
(b(φ)).<br/>
x&#160;σ&#160;(φ)&#160;=&#160;Oγ<br/>
0<br/>
x0<br/>
Proof.&#160;Choose&#160;a&#160;global&#160;curve&#160;X&#160;with&#160;function&#160;field&#160;F&#160;,&#160;and&#160;write&#160;F<br/>
∼<br/>
x<br/>
=&#160;F<br/>
0<br/>
q&#160;((t)).&#160;Choose&#160;a&#160;division&#160;algebra<br/>
D&#160;as&#160;in&#160;<a href="1711.02243s.html#32">§8.1,&#160;</a>and&#160;define&#160;G&#160;and&#160;G&#160;as&#160;in&#160;<a href="1711.02243s.html#13">§4.5.&#160;</a>We&#160;can&#160;then&#160;apply&#160;Corollary&#160;<a href="1711.02243s.html#38">9.4.</a><br/>
For&#160;a&#160;fixed&#160;function&#160;h&#160;∈&#160;HG,K(A)&#160;the&#160;orbital&#160;integrals&#160;and&#160;twisted&#160;orbital&#160;integrals&#160;are&#160;locally&#160;constant<br/>
near&#160;regular&#160;semisimple&#160;separable&#160;elements.&#160;Therefore,&#160;by&#160;weak&#160;approximation&#160;we&#160;can&#160;choose&#160;eγ&#160;∈&#160;G(F&#160;)<br/>
8It&#160;is&#160;remarked&#160;on&#160;p.84&#160;of&#160;the&#160;Arxiv&#160;version&#160;2&#160;of&#160;<a href="1711.02243s.html#40">[Ngo06]&#160;</a>that&#160;this&#160;is&#160;“standard”,&#160;and&#160;a&#160;reference&#160;is&#160;given&#160;to&#160;<a href="1711.02243s.html#39">[Clo90]</a>.<br/>
<hr/>
<a name=39></a><img class="yflip" src="html/1711.02243-39_1.png"/><br/>
<img class="yflip" src="html/1711.02243-39_2.png"/><br/>
<img class="yflip" src="html/1711.02243-39_3.png"/><br/>
NEARBY&#160;CYCLES&#160;OF&#160;PARAHORIC&#160;SHTUKAS,&#160;AND&#160;A&#160;FUNDAMENTAL&#160;LEMMA&#160;FOR&#160;BASE&#160;CHANGE<br/>
39<br/>
close&#160;enough&#160;to&#160;γt&#160;in&#160;the&#160;t-adic&#160;topology&#160;so&#160;that&#160;eγ&#160;=&#160;N(e<br/>
δx&#160;)&#160;∈&#160;G(F<br/>
F<br/>
∈&#160;G(F<br/>
F<br/>
0<br/>
t&#160;⊗Fq<br/>
qr&#160;)&#160;for&#160;some&#160;e<br/>
δx0<br/>
t&#160;⊗Fq<br/>
qr&#160;),<br/>
and&#160;such&#160;that<br/>
Oγ&#160;(b(ψ<br/>
x<br/>
µ))&#160;=&#160;O<br/>
0<br/>
e<br/>
γ&#160;(b(ψµ))<br/>
TOδ<br/>
(ψ<br/>
(ψ<br/>
x&#160;σ<br/>
µ)&#160;=&#160;TO<br/>
µ).<br/>
0<br/>
x0<br/>
e<br/>
δx&#160;σ<br/>
0<br/>
x0<br/>
We&#160;can&#160;choose&#160;an&#160;appropriate&#160;Hecke&#160;operator&#160;h&#160;=&#160;(hv)&#160;∈&#160;HG(A)&#160;so&#160;that&#160;Oeγ(hv)&#160;6=&#160;0&#160;for&#160;v&#160;6=&#160;x.<br/>
Because&#160;a&#160;fixed&#160;choice&#160;of&#160;h&#160;is&#160;the&#160;identity&#160;at&#160;all&#160;but&#160;finitely&#160;many&#160;places,&#160;any&#160;Kottwitz&#160;triple&#160;for&#160;which<br/>
the&#160;product&#160;of&#160;orbital&#160;integrals&#160;is&#160;non-zero&#160;forces&#160;the&#160;γv&#160;to&#160;be&#160;in&#160;Kv&#160;at&#160;all&#160;but&#160;finitely&#160;many&#160;v.&#160;Then&#160;by<br/><a href="1711.02243s.html#39">[Kot86b]&#160;</a>Proposition&#160;7.1&#160;there&#160;are&#160;only&#160;finitely&#160;many&#160;possibilities&#160;for&#160;the&#160;Kottwitz&#160;triple,&#160;as&#160;all&#160;γv&#160;outside&#160;a<br/>fixed&#160;finite&#160;set&#160;must&#160;be&#160;(rationally)&#160;conjugate&#160;to&#160;γ.&#160;(Technically&#160;this&#160;discussion&#160;is&#160;unnecessary&#160;here&#160;because<br/>we&#160;are&#160;only&#160;dealing&#160;with&#160;GLn&#160;at&#160;this&#160;point.)&#160;Therefore,&#160;since&#160;the&#160;support&#160;of&#160;any&#160;adelic&#160;Hecke&#160;operator&#160;is<br/>compact&#160;open&#160;in&#160;G(A),&#160;while&#160;G(F&#160;)&#160;is&#160;discrete,&#160;for&#160;any&#160;fixed&#160;h&#160;∈&#160;HG,K(A)&#160;there&#160;are&#160;only&#160;finitely&#160;many<br/>non-zero&#160;summands&#160;in&#160;Corollary&#160;<a href="1711.02243s.html#38">9.4.</a><br/>
Again&#160;by&#160;the&#160;discreteness&#160;of&#160;G(F&#160;)&#160;in&#160;G(A),&#160;we&#160;may&#160;shrink&#160;the&#160;support&#160;of&#160;the&#160;chosen&#160;Hecke&#160;operator<br/>
appropriately&#160;so&#160;that&#160;all&#160;the&#160;terms<br/>
<br/>
<br/>
<br/>
<br/>
Y<br/>
Y<br/>
<br/>
O<br/>
<br/>
<br/>
<br/>
γ&#160;(h<br/>
·&#160;TO<br/>
O&#160;(h<br/>
·&#160;O&#160;(b(ψ′<br/>
0<br/>
v&#160;)<br/>
δx&#160;σ(ψ′<br/>
γ<br/>
v&#160;)<br/>
γ<br/>
0<br/>
r,µ)<br/>
and<br/>
0<br/>
0<br/>
r,µ))<br/>
v6=x0<br/>
v6=x0<br/>
vanish&#160;except&#160;for&#160;the&#160;chosen&#160;γx&#160;.&#160;Then&#160;we&#160;have<br/>
0<br/>
<br/>
<br/>
Y<br/>
c(γ<br/>
<br/>
<br/>
0,&#160;(γx),&#160;(δx))&#160;·<br/>
Oγ&#160;(h<br/>
·&#160;TO<br/>
0<br/>
v&#160;)<br/>
δx&#160;σ(ψ′<br/>
0<br/>
r,µ)<br/>
v6=x0<br/>
<br/>
<br/>
Y<br/>
=&#160;c(γ<br/>
<br/>
<br/>
0,&#160;(γx),&#160;(δx))&#160;·<br/>
Oγ&#160;(h<br/>
·&#160;O&#160;(b(ψ′<br/>
0<br/>
v&#160;)<br/>
γ0<br/>
r,µ))<br/>
v6=x0<br/>
Since&#160;|µ|&#160;=&#160;0,&#160;Sht≤µ&#160;is&#160;non-empty&#160;so&#160;these&#160;terms&#160;are&#160;not&#160;0.&#160;Dividing&#160;out&#160;by&#160;the&#160;common&#160;(necessarily<br/>
G<br/>
Q<br/>
<br/>
non-zero)&#160;factor&#160;c(γ0,&#160;(γx),&#160;(δx))&#160;·<br/>
O&#160;(h<br/>
then&#160;yields&#160;the&#160;desired&#160;equality&#160;for&#160;all&#160;ψ′<br/>
v6=x<br/>
γ<br/>
v&#160;)<br/>
0<br/>
0<br/>
r,µ&#160;with&#160;|µ|&#160;=&#160;0.<br/>
We&#160;conclude&#160;by&#160;observing&#160;that&#160;these&#160;span&#160;Z(HG(Fx0,r),J)0.<br/>
<br/>
References<br/>
[Bro13]<br/>
Michael&#160;Broshi,&#160;G-torsors&#160;over&#160;a&#160;Dedekind&#160;scheme,&#160;J.&#160;Pure&#160;Appl.&#160;Algebra&#160;217&#160;(2013),&#160;no.&#160;1,&#160;11–19.&#160;MR&#160;2965898<br/>
[Clo90]<br/>
Laurent&#160;Clozel,&#160;The&#160;fundamental&#160;lemma&#160;for&#160;stable&#160;base&#160;change,&#160;Duke&#160;Math.&#160;J.&#160;61&#160;(1990),&#160;no.&#160;1,&#160;255–302.&#160;MR&#160;1068388<br/>
[Del73]<br/>
P.&#160;Deligne,&#160;Séminaire&#160;de&#160;géométrie&#160;algébrique&#160;du&#160;Bois&#160;Marie:&#160;Groupes&#160;de&#160;Monodromie&#160;en&#160;Géometrie&#160;Algébrique<br/>(SGA&#160;7&#160;II).,&#160;Lecture&#160;Notes&#160;in&#160;Mathematics,&#160;vol.&#160;569,&#160;Springer-Verlag,&#160;1973.<br/>
[Dri87]<br/>
V.&#160;G.&#160;Drinfel’d,&#160;Cohomology&#160;of&#160;compactified&#160;moduli&#160;varieties&#160;of&#160;F&#160;-sheaves&#160;of&#160;rank&#160;2,&#160;Zap.&#160;Nauchn.&#160;Sem.&#160;Leningrad.<br/>Otdel.&#160;Mat.&#160;Inst.&#160;Steklov.&#160;(LOMI)&#160;162&#160;(1987),&#160;no.&#160;Avtomorfn.&#160;Funkts.&#160;i&#160;Teor.&#160;Chisel.&#160;III,&#160;107–158,&#160;189.&#160;MR&#160;918745<br/>
[Gai01]<br/>
D.&#160;Gaitsgory,&#160;Construction&#160;of&#160;central&#160;elements&#160;in&#160;the&#160;affine&#160;Hecke&#160;algebra&#160;via&#160;nearby&#160;cycles,&#160;Invent.&#160;Math.&#160;144<br/>(2001),&#160;no.&#160;2,&#160;253–280.&#160;MR&#160;1826370<br/>
[Gro98]<br/>
Benedict&#160;H.&#160;Gross,&#160;On&#160;the&#160;Satake&#160;isomorphism,&#160;Galois&#160;representations&#160;in&#160;arithmetic&#160;algebraic&#160;geometry&#160;(Durham,<br/>1996),&#160;London&#160;Math.&#160;Soc.&#160;Lecture&#160;Note&#160;Ser.,&#160;vol.&#160;254,&#160;Cambridge&#160;Univ.&#160;Press,&#160;Cambridge,&#160;1998,&#160;pp.&#160;223–237.<br/>MR&#160;1696481<br/>
[Hai09]<br/>
Thomas&#160;J.&#160;Haines,&#160;The&#160;base&#160;change&#160;fundamental&#160;lemma&#160;for&#160;central&#160;elements&#160;in&#160;parahoric&#160;Hecke&#160;algebras,&#160;Duke&#160;Math.<br/>J.&#160;149&#160;(2009),&#160;no.&#160;3,&#160;569–643.&#160;MR&#160;2553880<br/>
[HRa]<br/>
Thomas&#160;Haines&#160;and&#160;Timo&#160;Richarz,&#160;The&#160;test&#160;function&#160;conjecture&#160;for&#160;parahoric&#160;local&#160;models,&#160;Preprint&#160;available&#160;at<br/><a href="https://arxiv.org/pdf/1801.07094.pdf">https://arxiv.org/pdf/1801.07094.pdf.</a><br/>
[HRb]<br/>
Urs&#160;Hartl&#160;and&#160;Esmail&#160;Arasteh&#160;Rad,&#160;Langlands-rapoport&#160;conjecture&#160;over&#160;function&#160;fields,&#160;Preprint&#160;available&#160;at<br/><a href="https://arxiv.org/pdf/1605.01575.pdf">https://arxiv.org/pdf/1605.01575.pdf.</a><br/>
[Kot80]<br/>
Robert&#160;Edward&#160;Kottwitz,&#160;Orbital&#160;integrals&#160;on&#160;GL3,&#160;Amer.&#160;J.&#160;Math.&#160;102&#160;(1980),&#160;no.&#160;2,&#160;327–384.&#160;MR&#160;564478<br/>
[Kot86a]&#160;Robert&#160;E.&#160;Kottwitz,&#160;Base&#160;change&#160;for&#160;unit&#160;elements&#160;of&#160;Hecke&#160;algebras,&#160;Compositio&#160;Math.&#160;60&#160;(1986),&#160;no.&#160;2,&#160;237–250.<br/>
MR&#160;868140<br/>
[Kot86b]<br/>
,&#160;Stable&#160;trace&#160;formula:&#160;elliptic&#160;singular&#160;terms,&#160;Math.&#160;Ann.&#160;275&#160;(1986),&#160;no.&#160;3,&#160;365–399.&#160;MR&#160;858284<br/>
[Kot90]<br/>
,&#160;Shimura&#160;varieties&#160;and&#160;λ-adic&#160;representations,&#160;Automorphic&#160;forms,&#160;Shimura&#160;varieties,&#160;and&#160;L-functions,&#160;Vol.<br/>
I&#160;(Ann&#160;Arbor,&#160;MI,&#160;1988),&#160;Perspect.&#160;Math.,&#160;vol.&#160;10,&#160;Academic&#160;Press,&#160;Boston,&#160;MA,&#160;1990,&#160;pp.&#160;161–209.&#160;MR&#160;1044820<br/>
[Kot92]<br/>
,&#160;Points&#160;on&#160;some&#160;Shimura&#160;varieties&#160;over&#160;finite&#160;fields,&#160;J.&#160;Amer.&#160;Math.&#160;Soc.&#160;5&#160;(1992),&#160;no.&#160;2,&#160;373–444.&#160;MR&#160;1124982<br/>
<hr/>
<a name=40></a><img class="yflip" src="html/1711.02243-40_1.png"/><br/>
<img class="yflip" src="html/1711.02243-40_2.png"/><br/>
<img class="yflip" src="html/1711.02243-40_3.png"/><br/>
<img class="yflip" src="html/1711.02243-40_4.png"/><br/>
40<br/>
TONY&#160;FENG<br/>
[KP]<br/>
Mark&#160;Kisin&#160;and&#160;Georgios&#160;Pappas,&#160;Integral&#160;models&#160;of&#160;Shimura&#160;varieties&#160;with&#160;parahoric&#160;level&#160;structure,&#160;Preprint&#160;avail-<br/>able&#160;at&#160;<a href="https://arxiv.org/pdf/1512.01149.pdf">https://arxiv.org/pdf/1512.01149.pdf.</a><br/>
[KW01]&#160;Reinhardt&#160;Kiehl&#160;and&#160;Rainer&#160;Weissauer,&#160;Weil&#160;conjectures,&#160;perverse&#160;sheaves&#160;and&#160;l’adic&#160;Fourier&#160;transform,&#160;Ergebnisse<br/>
der&#160;Mathematik&#160;und&#160;ihrer&#160;Grenzgebiete.&#160;3.&#160;Folge.&#160;A&#160;Series&#160;of&#160;Modern&#160;Surveys&#160;in&#160;Mathematics&#160;[Results&#160;in&#160;Mathematics<br/>and&#160;Related&#160;Areas.&#160;3rd&#160;Series.&#160;A&#160;Series&#160;of&#160;Modern&#160;Surveys&#160;in&#160;Mathematics],&#160;vol.&#160;42,&#160;Springer-Verlag,&#160;Berlin,&#160;2001.<br/>MR&#160;1855066<br/>
[Lab90]<br/>
J.-P.&#160;Labesse,&#160;Fonctions&#160;élémentaires&#160;et&#160;lemme&#160;fondamental&#160;pour&#160;le&#160;changement&#160;de&#160;base&#160;stable,&#160;Duke&#160;Math.&#160;J.&#160;61<br/>(1990),&#160;no.&#160;2,&#160;519–530.&#160;MR&#160;1074306<br/>
[Laf97]<br/>
Laurent&#160;Laﬀorgue,&#160;Chtoucas&#160;de&#160;Drinfeld&#160;et&#160;conjecture&#160;de&#160;Ramanujan-Petersson,&#160;Astérisque&#160;(1997),&#160;no.&#160;243,&#160;ii+329.<br/>MR&#160;1600006<br/>
[Laf02]<br/>
,&#160;Chtoucas&#160;de&#160;Drinfeld&#160;et&#160;correspondance&#160;de&#160;Langlands,&#160;Invent.&#160;Math.&#160;147&#160;(2002),&#160;no.&#160;1,&#160;1–241.&#160;MR&#160;1875184<br/>
[Laf12]<br/>
Vincent&#160;Laﬀorgue,&#160;Chtoucas&#160;pour&#160;les&#160;groupes&#160;réductifs&#160;et&#160;paramétrisation&#160;de&#160;Langlands&#160;globale,&#160;preprint,<br/>https://arxiv.org/pdf/1209.5352.pdf&#160;(2012).<br/>
[Lau04]<br/>
Eike&#160;Sören&#160;Lau,&#160;On&#160;generalised&#160;D-shtukas,&#160;Bonner&#160;Mathematische&#160;Schriften&#160;[Bonn&#160;Mathematical&#160;Publications],&#160;vol.<br/>369,&#160;Universität&#160;Bonn,&#160;Mathematisches&#160;Institut,&#160;Bonn,&#160;2004,&#160;Dissertation,&#160;Rheinische&#160;Friedrich-Wilhelms-Universität<br/>Bonn,&#160;Bonn,&#160;2004.&#160;MR&#160;2206061<br/>
[MV07]<br/>
I.&#160;Mirković&#160;and&#160;K.&#160;Vilonen,&#160;Geometric&#160;Langlands&#160;duality&#160;and&#160;representations&#160;of&#160;algebraic&#160;groups&#160;over&#160;commutative<br/>rings,&#160;Ann.&#160;of&#160;Math.&#160;(2)&#160;166&#160;(2007),&#160;no.&#160;1,&#160;95–143.&#160;MR&#160;2342692<br/>
[ND13]<br/>
Tuan&#160;Ngo&#160;Dac,&#160;Comptage&#160;des&#160;G-chtoucas:&#160;la&#160;partie&#160;elliptique,&#160;Compos.&#160;Math.&#160;149&#160;(2013),&#160;no.&#160;12,&#160;2169–2183.<br/>MR&#160;3143709<br/>
[ND15]<br/>
,&#160;On&#160;a&#160;counting&#160;problem&#160;for&#160;G-shtukas,&#160;Arithmetic&#160;and&#160;geometry,&#160;London&#160;Math.&#160;Soc.&#160;Lecture&#160;Note&#160;Ser.,&#160;vol.<br/>
420,&#160;Cambridge&#160;Univ.&#160;Press,&#160;Cambridge,&#160;2015,&#160;pp.&#160;318–350.&#160;MR&#160;3467129<br/>
[Ngo99]&#160;Bao&#160;Châu&#160;Ngo,&#160;Faisceaux&#160;pervers,&#160;homomorphisme&#160;de&#160;changement&#160;de&#160;base&#160;et&#160;lemme&#160;fondamental&#160;de&#160;Jacquet&#160;et&#160;Ye,<br/>
Ann.&#160;Sci.&#160;École&#160;Norm.&#160;Sup.&#160;(4)&#160;32&#160;(1999),&#160;no.&#160;5,&#160;619–679.&#160;MR&#160;1710755<br/>
[Ngo06]<br/>
,&#160;D-chtoucas&#160;de&#160;Drinfeld&#160;à&#160;modifications&#160;symétriques&#160;et&#160;identité&#160;de&#160;changement&#160;de&#160;base,&#160;Ann.&#160;Sci.&#160;École&#160;Norm.<br/>
Sup.&#160;(4)&#160;39&#160;(2006),&#160;no.&#160;2,&#160;197–243.&#160;MR&#160;2245532<br/>
[NND08]&#160;Bao&#160;Châu&#160;Ngô&#160;and&#160;Tuân&#160;Ngô&#160;Dac,&#160;Comptage&#160;de&#160;G-chtoucas:&#160;la&#160;partie&#160;régulière&#160;elliptique,&#160;J.&#160;Inst.&#160;Math.&#160;Jussieu&#160;7<br/>
(2008),&#160;no.&#160;1,&#160;181–203.&#160;MR&#160;2398149<br/>
[PR10]<br/>
Georgios&#160;Pappas&#160;and&#160;Michael&#160;Rapoport,&#160;Some&#160;questions&#160;about&#160;G-bundles&#160;on&#160;curves,&#160;Algebraic&#160;and&#160;arithmetic&#160;struc-<br/>tures&#160;of&#160;moduli&#160;spaces&#160;(Sapporo&#160;2007),&#160;Adv.&#160;Stud.&#160;Pure&#160;Math.,&#160;vol.&#160;58,&#160;Math.&#160;Soc.&#160;Japan,&#160;Tokyo,&#160;2010,&#160;pp.&#160;159–171.<br/>MR&#160;2676160<br/>
[PZ13]<br/>
G.&#160;Pappas&#160;and&#160;X.&#160;Zhu,&#160;Local&#160;models&#160;of&#160;Shimura&#160;varieties&#160;and&#160;a&#160;conjecture&#160;of&#160;Kottwitz,&#160;Invent.&#160;Math.&#160;194&#160;(2013),<br/>no.&#160;1,&#160;147–254.&#160;MR&#160;3103258<br/>
[RD]<br/>
Walter&#160;Randolph&#160;Ray-Dulany,&#160;Base&#160;change&#160;for&#160;the&#160;iwahori-hecke&#160;algebra&#160;of&#160;gl2,&#160;Ph.D.&#160;thesis.&#160;Available&#160;at<br/><a href="https://drum.lib.umd.edu/bitstream/handle/1903/10963/RayDulany_umd_0117E_11632.pdf?sequence=1&isAllowed=y">https://drum.lib.umd.edu/bitstream/handle/1903/10963/RayDulany_umd_0117E_11632.pdf?sequence=1&amp;isAllowed=y&#160;.</a><br/>
[Ric16]<br/>
Timo&#160;Richarz,&#160;Affine&#160;Grassmannians&#160;and&#160;geometric&#160;Satake&#160;equivalences,&#160;Int.&#160;Math.&#160;Res.&#160;Not.&#160;IMRN&#160;(2016),&#160;no.&#160;12,<br/>3717–3767.&#160;MR&#160;3544618<br/>
[Var04]<br/>
Yakov&#160;Varshavsky,&#160;Moduli&#160;spaces&#160;of&#160;principal&#160;F&#160;-bundles,&#160;Selecta&#160;Math.&#160;(N.S.)&#160;10&#160;(2004),&#160;no.&#160;1,&#160;131–166.&#160;MR&#160;2061225<br/>
[Zhu]<br/>
Xinwen&#160;Zhu,&#160;An&#160;introduction&#160;to&#160;affine&#160;Grassmannians&#160;and&#160;the&#160;geometric&#160;Satake&#160;equivalence,&#160;To&#160;appear&#160;in&#160;Proceedings<br/>of&#160;the&#160;IAS/Park&#160;City&#160;Mathematics&#160;Series.&#160;Preprint&#160;available&#160;at&#160;<a href="https://arxiv.org/pdf/1603.05593.pdf">https://arxiv.org/pdf/1603.05593.pdf.</a><br/>
[Zhu14]<br/>
,&#160;On&#160;the&#160;coherence&#160;conjecture&#160;of&#160;Pappas&#160;and&#160;Rapoport,&#160;Ann.&#160;of&#160;Math.&#160;(2)&#160;180&#160;(2014),&#160;no.&#160;1,&#160;1–85.&#160;MR&#160;3194811<br/>
<hr/>
<a name="outline"></a><h1>Document Outline</h1>
<ul>
<li><a href="1711.02243s.html#1">1. Introduction</a></li>
<li><a href="1711.02243s.html#4">2. Statement of results and overview of the paper</a></li>
<li><a href="1711.02243s.html#8">3. Notation</a></li>
<li><a href="1711.02243s.html#9">4. Moduli of shtukas</a></li>
<li><a href="1711.02243s.html#16">5. The Kottwitz Conjecture for shtukas</a></li>
<li><a href="1711.02243s.html#20">6. Counting parahoric shtukas</a></li>
<li><a href="1711.02243s.html#25">7. Geometrization of base change for Hecke algebras</a></li>
<li><a href="1711.02243s.html#32">8. Comparison of two moduli problems</a></li>
<li><a href="1711.02243s.html#34">9. Calculation of traces on the cohomology of nearby cycles&#160;</a></li>
<li><a href="1711.02243s.html#39">References</a></li>
</ul>
<hr/>
</body>
</html>
