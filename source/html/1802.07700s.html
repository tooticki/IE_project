<!DOCTYPE html><html>
<head>
<title></title>
<style type="text/css">
<!--
.xflip {
    -moz-transform: scaleX(-1);
    -webkit-transform: scaleX(-1);
    -o-transform: scaleX(-1);
    transform: scaleX(-1);
    filter: fliph;
}
.yflip {
    -moz-transform: scaleY(-1);
    -webkit-transform: scaleY(-1);
    -o-transform: scaleY(-1);
    transform: scaleY(-1);
    filter: flipv;
}
.xyflip {
    -moz-transform: scaleX(-1) scaleY(-1);
    -webkit-transform: scaleX(-1) scaleY(-1);
    -o-transform: scaleX(-1) scaleY(-1);
    transform: scaleX(-1) scaleY(-1);
    filter: fliph + flipv;
}
-->
</style>
</head>
<body>
<a name=1></a><img class="yflip" src="html/1802.07700-1_1.png"/><br/>
A&#160;RAINBOW&#160;BLOW-UP&#160;LEMMA<br/>
STEFAN&#160;GLOCK&#160;AND&#160;FELIX&#160;JOOS<br/>
Abstract.&#160;We&#160;prove&#160;a&#160;rainbow&#160;version&#160;of&#160;the&#160;blow-up&#160;lemma&#160;of&#160;Koml´<br/>
os,&#160;S´<br/>
ark¨<br/>
ozy&#160;and&#160;Szemer´<br/>
edi<br/>
for&#160;µn-bounded&#160;edge&#160;colourings.&#160;This&#160;enables&#160;the&#160;systematic&#160;study&#160;of&#160;rainbow&#160;embeddings&#160;of&#160;bounded<br/>degree&#160;spanning&#160;subgraphs.&#160;As&#160;one&#160;application,&#160;we&#160;show&#160;how&#160;our&#160;blow-up&#160;lemma&#160;can&#160;be&#160;used&#160;to&#160;transfer<br/>the&#160;bandwidth&#160;theorem&#160;of&#160;B¨<br/>
ottcher,&#160;Schacht&#160;and&#160;Taraz&#160;to&#160;the&#160;rainbow&#160;setting.&#160;It&#160;can&#160;also&#160;be&#160;employed<br/>
as&#160;a&#160;tool&#160;beyond&#160;the&#160;setting&#160;of&#160;µn-bounded&#160;edge&#160;colourings.&#160;Kim,&#160;K¨<br/>
uhn,&#160;Kupavskii&#160;and&#160;Osthus&#160;exploit<br/>
this&#160;to&#160;prove&#160;several&#160;rainbow&#160;decomposition&#160;results.&#160;Our&#160;proof&#160;methods&#160;include&#160;the&#160;strategy&#160;of&#160;an<br/>alternative&#160;proof&#160;of&#160;the&#160;blow-up&#160;lemma&#160;given&#160;by&#160;R¨<br/>
odl&#160;and&#160;Ruci´<br/>
nski,&#160;the&#160;switching&#160;method,&#160;and&#160;the<br/>
partial&#160;resampling&#160;algorithm&#160;developed&#160;by&#160;Harris&#160;and&#160;Srinivasan.<br/>
1.&#160;Introduction<br/>
A&#160;subgraph&#160;H&#160;of&#160;an&#160;edge-coloured&#160;graph&#160;G&#160;is&#160;called&#160;<i>rainbow&#160;</i>if&#160;all&#160;its&#160;edges&#160;have&#160;different&#160;colours.&#160;Rain-<br/>
bow&#160;colourings&#160;appear&#160;for&#160;example&#160;in&#160;canonical&#160;Ramsey&#160;theory,&#160;and&#160;many&#160;open&#160;problems&#160;in&#160;combinator-<br/>ics&#160;such&#160;as&#160;the&#160;Ryser–Brualdi–Stein&#160;conjecture&#160;on&#160;partial&#160;transversals&#160;in&#160;Latin&#160;squares&#160;and&#160;the&#160;graceful<br/>labelling&#160;conjecture&#160;can&#160;be&#160;phrased&#160;as&#160;rainbow&#160;subgraph&#160;problems.&#160;The&#160;central&#160;question&#160;is&#160;under&#160;which<br/>conditions&#160;on&#160;G&#160;and&#160;its&#160;edge&#160;colouring&#160;a&#160;rainbow&#160;copy&#160;of&#160;H&#160;is&#160;guaranteed.&#160;Here,&#160;H&#160;is&#160;usually&#160;a&#160;spanning<br/>subgraph&#160;such&#160;as&#160;a&#160;perfect&#160;matching&#160;<a href="1802.07700s.html#29">[10,&#160;12,&#160;22,&#160;26,&#160;41],&#160;</a>Hamilton&#160;cycle&#160;<a href="1802.07700s.html#28">[1,&#160;2,&#160;</a><a href="1802.07700s.html#29">6,&#160;7,&#160;10,&#160;14,&#160;16,&#160;17],&#160;</a>span-<br/>ning&#160;tree&#160;<a href="1802.07700s.html#29">[5,&#160;7,&#160;15,&#160;42],&#160;</a>or&#160;a&#160;general&#160;bounded&#160;degree&#160;graph&#160;<a href="1802.07700s.html#29">[8,&#160;24,&#160;44].&#160;</a>Closely&#160;related&#160;questions&#160;concern<br/>properly&#160;coloured&#160;subgraphs&#160;and&#160;rainbow&#160;decompositions,&#160;which&#160;we&#160;shall&#160;discuss&#160;briefly&#160;in&#160;Section&#160;<a href="1802.07700s.html#4">1.3.</a><br/>
Clearly,&#160;a&#160;necessary&#160;condition&#160;for&#160;the&#160;existence&#160;of&#160;a&#160;rainbow&#160;copy&#160;of&#160;H&#160;in&#160;G&#160;is&#160;that&#160;H&#160;is&#160;at&#160;least<br/>
a&#160;subgraph&#160;of&#160;G.&#160;Thus,&#160;the&#160;best&#160;one&#160;can&#160;hope&#160;for&#160;is&#160;to&#160;find&#160;a&#160;rainbow&#160;copy&#160;of&#160;H&#160;in&#160;G&#160;‘whenever’<br/>H&#160;is&#160;a&#160;subgraph&#160;of&#160;G.&#160;The&#160;blow-up&#160;lemma&#160;of&#160;Koml´os,&#160;S´<br/>
ark¨ozy&#160;and&#160;Szemer´edi&#160;is&#160;a&#160;powerful&#160;tool&#160;to<br/>
find&#160;spanning&#160;subgraphs,&#160;which,&#160;since&#160;its&#160;invention&#160;roughly&#160;20&#160;years&#160;ago,&#160;has&#160;significantly&#160;shaped&#160;the<br/>landscape&#160;of&#160;extremal&#160;combinatorics&#160;<a href="1802.07700s.html#29">[9,&#160;31,&#160;32,&#160;33,&#160;34,&#160;35].&#160;</a>It&#160;is&#160;tailored&#160;to&#160;be&#160;used&#160;after&#160;an&#160;application<br/>of&#160;Szemer´edi’s&#160;regularity&#160;lemma&#160;and&#160;roughly&#160;says&#160;that&#160;super-regular&#160;pairs&#160;behave&#160;like&#160;complete&#160;bipartite<br/>graphs&#160;in&#160;terms&#160;of&#160;embedding&#160;bounded&#160;degree&#160;subgraphs.&#160;In&#160;the&#160;present&#160;paper,&#160;we&#160;prove&#160;a&#160;rainbow&#160;blow-<br/>up&#160;lemma.&#160;As&#160;one&#160;application,&#160;we&#160;transfer&#160;the&#160;bandwidth&#160;theorem&#160;of&#160;B¨ottcher,&#160;Schacht&#160;and&#160;Taraz&#160;<a href="1802.07700s.html#29">[9]<br/></a>to&#160;the&#160;rainbow&#160;setting.&#160;It&#160;would&#160;be&#160;interesting&#160;to&#160;find&#160;out&#160;whether&#160;other&#160;results&#160;can&#160;be&#160;transferred&#160;in&#160;a<br/>similar&#160;way.<br/>
In&#160;many&#160;of&#160;the&#160;classical&#160;rainbow&#160;problems,&#160;the&#160;host&#160;graph&#160;G&#160;is&#160;complete.&#160;For&#160;instance,&#160;Erd˝<br/>
os&#160;and&#160;Stein<br/>
asked&#160;for&#160;the&#160;maximal&#160;k&#160;such&#160;that&#160;any&#160;k-bounded&#160;edge&#160;colouring&#160;of&#160;Kn&#160;contains&#160;a&#160;rainbow&#160;Hamilton&#160;cycle<br/>(cf.&#160;<a href="1802.07700s.html#29">[14])</a>.&#160;Here,&#160;an&#160;edge&#160;colouring&#160;is&#160;k<i>-bounded&#160;</i>if&#160;each&#160;colour&#160;appears&#160;on&#160;at&#160;most&#160;k&#160;edges.&#160;After&#160;several<br/>subsequent&#160;improvements,&#160;Albert,&#160;Frieze,&#160;and&#160;Reed&#160;<a href="1802.07700s.html#28">[1]&#160;</a>showed&#160;that&#160;k&#160;=&#160;Ω(n),&#160;i.e.&#160;there&#160;exists&#160;a&#160;constant<br/>µ&#160;&gt;&#160;0&#160;such&#160;that&#160;for&#160;any&#160;µn-bounded&#160;edge&#160;colouring&#160;of&#160;Kn,&#160;there&#160;exists&#160;a&#160;rainbow&#160;Hamilton&#160;cycle.&#160;Note<br/>that&#160;this&#160;is&#160;best&#160;possible&#160;up&#160;to&#160;the&#160;value&#160;of&#160;the&#160;constant&#160;µ.&#160;A&#160;natural&#160;generalization&#160;is&#160;to&#160;ask&#160;for&#160;general<br/>
<a href="http://arxiv.org/abs/1802.07700v2">arXiv:1802.07700v2 &#160;[math.CO] &#160;8 Jun 2018</a><br/>
rainbow&#160;(spanning)&#160;subgraphs.&#160;For&#160;example,&#160;Frieze&#160;and&#160;Krivelevich&#160;<a href="1802.07700s.html#29">[15]&#160;</a>showed&#160;that&#160;there&#160;exists&#160;some<br/>µ&#160;&gt;&#160;0&#160;such&#160;that&#160;any&#160;almost&#160;spanning&#160;tree&#160;with&#160;bounded&#160;degree&#160;is&#160;contained&#160;as&#160;a&#160;rainbow&#160;copy&#160;in&#160;Kn<br/>for&#160;any&#160;µn-bounded&#160;edge&#160;colouring&#160;of&#160;Kn.&#160;This&#160;was&#160;greatly&#160;improved&#160;by&#160;B¨ottcher,&#160;Kohayakawa,&#160;and<br/>Procacci&#160;<a href="1802.07700s.html#29">[8],&#160;</a>who&#160;showed&#160;the&#160;following&#160;very&#160;general&#160;result.&#160;Given&#160;any&#160;n/(51∆2)-bounded&#160;edge&#160;colouring<br/>of&#160;Kn&#160;and&#160;any&#160;graph&#160;H&#160;on&#160;n&#160;vertices&#160;with&#160;∆(H)&#160;≤&#160;∆,&#160;one&#160;can&#160;find&#160;a&#160;rainbow&#160;copy&#160;of&#160;H.&#160;Their&#160;proof&#160;is<br/>based&#160;on&#160;the&#160;Lopsided&#160;Lov´asz&#160;local&#160;lemma&#160;as&#160;well&#160;as&#160;the&#160;framework&#160;of&#160;Lu&#160;and&#160;Sz´ekely&#160;<a href="1802.07700s.html#29">[36]&#160;</a>for&#160;random<br/>injections.&#160;Using&#160;these&#160;tools,&#160;they&#160;show&#160;that&#160;a&#160;random&#160;injection&#160;V&#160;(H)&#160;→&#160;V&#160;(Kn)&#160;yields&#160;with&#160;positive<br/>probability&#160;a&#160;rainbow&#160;copy&#160;of&#160;H.&#160;Kamˇcev,&#160;Sudakov,&#160;and&#160;Volec&#160;<a href="1802.07700s.html#29">[24]&#160;</a>recently&#160;extended&#160;this&#160;result&#160;to<br/>the&#160;setting&#160;where&#160;G&#160;is&#160;complete&#160;multipartite,&#160;and&#160;Sudakov&#160;and&#160;Volec&#160;<a href="1802.07700s.html#29">[44]&#160;</a>considered&#160;the&#160;case&#160;when&#160;the<br/>number&#160;of&#160;cherries&#160;in&#160;H&#160;is&#160;restricted&#160;(instead&#160;of&#160;the&#160;maximum&#160;degree).<br/>
There&#160;is&#160;a&#160;major&#160;stumbling&#160;stone&#160;if&#160;one&#160;wants&#160;to&#160;consider&#160;the&#160;above&#160;problem&#160;for&#160;incomplete&#160;host<br/>
graphs,&#160;say,&#160;for&#160;example&#160;quasi-random&#160;graphs&#160;with&#160;density&#160;d&#160;for&#160;some&#160;arbitrarily&#160;small&#160;(fixed)&#160;d&#160;&gt;&#160;0.<br/>
Date:&#160;11th&#160;June&#160;2018.<br/>The&#160;research&#160;leading&#160;to&#160;these&#160;results&#160;was&#160;partially&#160;supported&#160;by&#160;the&#160;European&#160;Research&#160;Council&#160;under&#160;the&#160;European<br/>
Union’s&#160;Seventh&#160;Framework&#160;Programme&#160;(FP/2007–2013)&#160;/&#160;ERC&#160;Grant&#160;Agreement&#160;no.&#160;306349&#160;(S.&#160;Glock)&#160;and&#160;the&#160;DFG,<br/>grant&#160;no.&#160;JO&#160;1457/1-1&#160;(F.&#160;Joos).<br/>
1<br/>
<hr/>
<a name=2></a><img class="yflip" src="html/1802.07700-2_1.png"/><br/>
2<br/>
S.&#160;GLOCK&#160;AND&#160;F.&#160;JOOS<br/>
If&#160;G&#160;is&#160;complete,&#160;then&#160;any&#160;injection&#160;V&#160;(H)&#160;→&#160;V&#160;(G)&#160;yields&#160;a&#160;valid&#160;embedding&#160;of&#160;H&#160;(similarly&#160;for&#160;the<br/>multipartite&#160;setting).&#160;However,&#160;this&#160;is&#160;not&#160;the&#160;case&#160;for&#160;general&#160;host&#160;graphs&#160;G,&#160;where&#160;a&#160;random&#160;injection<br/>yields&#160;a&#160;valid&#160;embedding&#160;with&#160;exponentially&#160;small&#160;probability.&#160;Restricting&#160;the&#160;probability&#160;space&#160;to&#160;the<br/>‘valid’&#160;injections&#160;does&#160;not&#160;seem&#160;to&#160;work&#160;with&#160;the&#160;Lu–Sz´ekely&#160;framework,&#160;as&#160;the&#160;latter&#160;relies&#160;on&#160;the&#160;perfect<br/>symmetry&#160;of&#160;the&#160;setup.<br/>
Some&#160;recent&#160;results&#160;on&#160;rainbow&#160;subgraphs&#160;in&#160;incomplete&#160;host&#160;graphs&#160;with&#160;µn-bounded&#160;edge&#160;colourings<br/>
were&#160;obtained&#160;using&#160;the&#160;so-called&#160;‘switching&#160;method’.&#160;For&#160;example,&#160;Coulson&#160;and&#160;Perarnau&#160;<a href="1802.07700s.html#29">[12]&#160;</a>found<br/>rainbow&#160;perfect&#160;matchings&#160;in&#160;Dirac&#160;bipartite&#160;graphs,&#160;improving&#160;an&#160;approximate&#160;result&#160;of&#160;<a href="1802.07700s.html#29">[10].&#160;</a>The<br/>crucial&#160;property&#160;is&#160;that&#160;given&#160;a&#160;perfect&#160;matching&#160;M&#160;and&#160;an&#160;edge&#160;e&#160;∈&#160;M&#160;(which&#160;is&#160;in&#160;conflict&#160;with&#160;another<br/>edge&#160;in&#160;M&#160;),&#160;there&#160;are&#160;many&#160;ways&#160;of&#160;‘switching&#160;e&#160;out&#160;of&#160;M&#160;’&#160;to&#160;obtain&#160;a&#160;new&#160;perfect&#160;matching&#160;which<br/>does&#160;not&#160;contain&#160;e.&#160;As&#160;another&#160;example,&#160;Coulson,&#160;Keevash,&#160;Perarnau,&#160;and&#160;Yepremyan&#160;<a href="1802.07700s.html#29">[11]&#160;</a>show&#160;the<br/>existence&#160;of&#160;a&#160;rainbow&#160;F&#160;-factor&#160;in&#160;a&#160;graph&#160;G&#160;whenever&#160;δ(G)&#160;≥&#160;(δF&#160;+&#160;o(1))n,&#160;where&#160;δF&#160;is&#160;the&#160;minimum<br/>degree&#160;threshold&#160;for&#160;the&#160;existence&#160;of&#160;an&#160;F&#160;-factor&#160;(cf.&#160;<a href="1802.07700s.html#29">[34])</a>.&#160;(Here&#160;F&#160;is&#160;an&#160;arbitrary&#160;fixed&#160;hypergraph&#160;as<br/>their&#160;results&#160;also&#160;apply&#160;to&#160;hypergraphs.)&#160;However,&#160;the&#160;switching&#160;method&#160;seems&#160;to&#160;be&#160;limited&#160;to&#160;‘simply<br/>structured’&#160;spanning&#160;graphs&#160;H&#160;with&#160;rich&#160;symmetry&#160;properties.<br/>
We&#160;are&#160;motivated&#160;by&#160;the&#160;following&#160;question:<br/>
<i>Given&#160;a&#160;(dense)&#160;graph&#160;</i>G&#160;<i>on&#160;</i>n&#160;<i>vertices&#160;with&#160;a&#160;</i>µn<i>-bounded&#160;edge&#160;colouring&#160;and&#160;a&#160;(bounded<br/>degree)&#160;graph&#160;</i>H&#160;<i>on&#160;</i>n&#160;<i>vertices,&#160;is&#160;there&#160;a&#160;rainbow&#160;copy&#160;of&#160;</i>H&#160;<i>in&#160;</i>G<i>?</i><br/>
By&#160;proving&#160;a&#160;rainbow&#160;blow-up&#160;lemma,&#160;we&#160;provide&#160;a&#160;tool&#160;which&#160;allows&#160;for&#160;the&#160;systematic&#160;study&#160;of&#160;this<br/>question,&#160;profiting&#160;from&#160;various&#160;techniques&#160;and&#160;methods&#160;which&#160;have&#160;been&#160;developed&#160;in&#160;the&#160;non-coloured<br/>setting.&#160;In&#160;particular,&#160;we&#160;give&#160;affirmative&#160;answers&#160;to&#160;the&#160;above&#160;question&#160;if&#160;G&#160;is&#160;quasi-random&#160;(see<br/>Corollary&#160;<a href="1802.07700s.html#4">1.3)&#160;</a>or&#160;has&#160;sufficiently&#160;high&#160;minimum&#160;degree&#160;(see&#160;Section&#160;<a href="1802.07700s.html#24">6)</a>.&#160;We&#160;remark&#160;that&#160;the&#160;constant<br/>µ&#160;&gt;&#160;0&#160;we&#160;obtain&#160;is&#160;very&#160;small.<br/>
Nevertheless,&#160;our&#160;rainbow&#160;blow-up&#160;lemma&#160;has&#160;applications&#160;beyond&#160;this&#160;setting,&#160;in&#160;at&#160;least&#160;the&#160;following<br/>
two&#160;aspects.&#160;Firstly,&#160;it&#160;can&#160;still&#160;be&#160;applied&#160;even&#160;if&#160;the&#160;number&#160;of&#160;available&#160;colours&#160;is&#160;only&#160;slightly<br/>larger&#160;than&#160;the&#160;number&#160;of&#160;edges&#160;in&#160;the&#160;desired&#160;subgraph.&#160;Secondly,&#160;one&#160;can&#160;even&#160;obtain&#160;approximate<br/>decompositions,&#160;for&#160;example&#160;into&#160;Hamilton&#160;cycles&#160;and&#160;H-factors.&#160;This&#160;has&#160;recently&#160;been&#160;demonstrated<br/>by&#160;Kim,&#160;K¨<br/>
uhn,&#160;Kupavskii&#160;and&#160;Osthus&#160;(see&#160;Section&#160;<a href="1802.07700s.html#4">1.3&#160;</a>for&#160;further&#160;details).<br/>
We&#160;will&#160;discuss&#160;the&#160;blow-up&#160;lemma&#160;in&#160;more&#160;detail&#160;in&#160;the&#160;next&#160;subsection.&#160;As&#160;mentioned&#160;above,<br/>
commonly&#160;used&#160;techniques&#160;like&#160;the&#160;Lu–Sz´ekely&#160;framework&#160;and&#160;the&#160;switching&#160;method&#160;do&#160;not&#160;seem&#160;capable<br/>of&#160;dealing&#160;with&#160;quasi-random&#160;host&#160;graphs&#160;G&#160;and/or&#160;general&#160;graphs&#160;H.&#160;(Here,&#160;the&#160;idea&#160;would&#160;have&#160;been&#160;to<br/>use&#160;the&#160;original&#160;blow-up&#160;lemma&#160;as&#160;a&#160;‘blackbox’&#160;result.)&#160;Another&#160;natural&#160;question&#160;is&#160;whether&#160;the&#160;proof&#160;of<br/>the&#160;blow-up&#160;lemma&#160;can&#160;be&#160;adapted&#160;to&#160;work&#160;in&#160;the&#160;rainbow&#160;setting.&#160;In&#160;the&#160;original&#160;proof&#160;due&#160;to&#160;Koml´os,<br/>S´<br/>
ark¨ozy&#160;and&#160;Szemer´edi,&#160;the&#160;vertices&#160;of&#160;H&#160;are&#160;embedded&#160;one&#160;by&#160;one&#160;using&#160;a&#160;randomized&#160;algorithm,&#160;until<br/>
all&#160;but&#160;a&#160;small&#160;fraction&#160;of&#160;the&#160;vertices&#160;are&#160;embedded,&#160;and&#160;the&#160;embedding&#160;is&#160;then&#160;completed&#160;using&#160;the<br/>K¨onig-Hall&#160;theorem.&#160;Note&#160;that&#160;this&#160;approach&#160;is&#160;extremely&#160;vulnerable&#160;in&#160;the&#160;rainbow&#160;setting,&#160;as&#160;already<br/>a&#160;constant&#160;number&#160;of&#160;choices&#160;can&#160;render&#160;the&#160;algorithm&#160;unsuccessful&#160;(as&#160;a&#160;vertex&#160;may&#160;be&#160;incident&#160;to&#160;only<br/>a&#160;constant&#160;number&#160;of&#160;different&#160;colours),&#160;which&#160;seems&#160;rather&#160;hopeless.<br/>
To&#160;overcome&#160;these&#160;obstacles,&#160;several&#160;new&#160;ideas&#160;are&#160;needed.&#160;As&#160;an&#160;underlying&#160;strategy,&#160;we&#160;employ<br/>
the&#160;alternative&#160;proof&#160;of&#160;the&#160;blow-up&#160;lemma&#160;given&#160;by&#160;R¨<br/>
odl&#160;and&#160;Ruci´<br/>
nski,&#160;and&#160;combine&#160;it&#160;with&#160;various<br/>
techniques&#160;such&#160;as&#160;the&#160;partial&#160;resampling&#160;algorithm,&#160;the&#160;switching&#160;method,&#160;and&#160;a&#160;parallelization&#160;of&#160;the<br/>embedding&#160;procedure.&#160;We&#160;will&#160;provide&#160;a&#160;detailed&#160;proof&#160;overview&#160;in&#160;Section&#160;<a href="1802.07700s.html#4">2.&#160;</a>Sections&#160;<a href="1802.07700s.html#6">4&#160;</a>and&#160;<a href="1802.07700s.html#13">5&#160;</a>contain<br/>the&#160;main&#160;proof.&#160;In&#160;Section&#160;<a href="1802.07700s.html#24">6,&#160;</a>we&#160;demonstrate&#160;the&#160;applicability&#160;of&#160;our&#160;rainbow&#160;blow-up&#160;lemma.<br/>
1.1.&#160;Rainbow&#160;blow-up&#160;lemma.&#160;In&#160;order&#160;to&#160;state&#160;a&#160;simplified&#160;version&#160;of&#160;our&#160;rainbow&#160;blow-up&#160;lemma,<br/>we&#160;need&#160;some&#160;more&#160;terminology.&#160;For&#160;k&#160;∈&#160;N,&#160;we&#160;write&#160;[k]0&#160;:=&#160;[k]&#160;∪&#160;{0}&#160;=&#160;{0,&#160;1,&#160;.&#160;.&#160;.&#160;,&#160;k}.&#160;We&#160;say&#160;that<br/>(H,&#160;G,&#160;R,&#160;(Xi)i∈[r]&#160;,&#160;(V<br/>
)&#160;is&#160;a&#160;<i>blow-up&#160;instance&#160;</i>if&#160;the&#160;following&#160;hold:<br/>
0<br/>
i)i∈[r]0<br/>
•&#160;H&#160;and&#160;G&#160;are&#160;graphs,&#160;(Xi)i∈[r]&#160;is&#160;a&#160;partition&#160;of&#160;V&#160;(H)&#160;into&#160;independent&#160;sets,&#160;(V<br/>
is&#160;a<br/>
0<br/>
i)i∈[r]0<br/>
partition&#160;of&#160;V&#160;(G),&#160;and&#160;|Xi|&#160;=&#160;|Vi|&#160;for&#160;all&#160;i&#160;∈&#160;[r]0;<br/>
•&#160;R&#160;is&#160;a&#160;graph&#160;on&#160;[r]&#160;such&#160;that&#160;for&#160;all&#160;distinct&#160;i,&#160;j&#160;∈&#160;[r],&#160;the&#160;graph&#160;H[Xi,&#160;Xj]&#160;is&#160;empty&#160;if&#160;ij&#160;/<br/>
∈&#160;E(R).<br/>
Here,&#160;X0&#160;and&#160;V0&#160;are&#160;so-called&#160;‘exceptional&#160;sets’.&#160;For&#160;simplicity,&#160;we&#160;assume&#160;in&#160;this&#160;subsection&#160;that&#160;they<br/>are&#160;empty.<br/>
For&#160;a&#160;graph&#160;G&#160;and&#160;two&#160;disjoint&#160;subsets&#160;S,&#160;T&#160;⊆&#160;V&#160;(G),&#160;denote&#160;by&#160;eG(S,&#160;T&#160;)&#160;the&#160;number&#160;of&#160;edges&#160;of&#160;G<br/>
with&#160;one&#160;endpoint&#160;in&#160;S&#160;and&#160;the&#160;other&#160;one&#160;in&#160;T&#160;,&#160;and&#160;define<br/>
e<br/>
d<br/>
G(S,&#160;T&#160;)<br/>
G(S,&#160;T&#160;)&#160;:=<br/>
|S||T&#160;|<br/>
<hr/>
<a name=3></a>3<br/>
as&#160;the&#160;<i>density&#160;</i>of&#160;the&#160;pair&#160;S,&#160;T&#160;in&#160;G.&#160;We&#160;say&#160;that&#160;the&#160;bipartite&#160;graph&#160;G[V1,&#160;V2]&#160;is&#160;<i>lower&#160;</i>(ε,&#160;d)<i>-super-regular<br/></i>if<br/>
•&#160;for&#160;all&#160;S&#160;⊆&#160;V1&#160;and&#160;T&#160;⊆&#160;V2&#160;with&#160;|S|&#160;≥&#160;ε|V1|,&#160;|T&#160;|&#160;≥&#160;ε|V2|,&#160;we&#160;have&#160;dG(S,&#160;T&#160;)&#160;≥&#160;d&#160;−&#160;ε;<br/>•&#160;for&#160;all&#160;i&#160;∈&#160;[2]&#160;and&#160;v&#160;∈&#160;Vi,&#160;we&#160;have&#160;|NG(v)&#160;∩&#160;V3−i|&#160;≥&#160;(d&#160;−&#160;ε)|V3−i|.<br/>
We&#160;say&#160;that&#160;the&#160;blow-up&#160;instance&#160;(H,&#160;G,&#160;R,&#160;(Xi)i∈[r]&#160;,&#160;(V<br/>
)&#160;is&#160;<i>lower&#160;</i>(ε,&#160;d)<i>-super-regular&#160;</i>if&#160;for&#160;all<br/>
0<br/>
i)i∈[r]0<br/>
ij&#160;∈&#160;E(R),&#160;the&#160;bipartite&#160;graph&#160;G[Vi,&#160;Vj]&#160;is&#160;lower&#160;(ε,&#160;d)-super-regular.<br/>
We&#160;now&#160;state&#160;a&#160;simplified&#160;version&#160;of&#160;the&#160;rainbow&#160;blow-up&#160;lemma.&#160;The&#160;full&#160;statement&#160;can&#160;be&#160;found&#160;in<br/>
Lemma&#160;<a href="1802.07700s.html#14">5.1&#160;</a>and&#160;also&#160;allows&#160;exceptional&#160;vertices&#160;and&#160;candidate&#160;sets.&#160;Moreover,&#160;it&#160;does&#160;not&#160;only&#160;apply&#160;to<br/>rainbow&#160;embeddings,&#160;but&#160;to&#160;slightly&#160;more&#160;general&#160;conflict-free&#160;embeddings.<br/>
Lemma&#160;1.1&#160;(Rainbow&#160;blow-up&#160;lemma—simplified).&#160;<i>For&#160;all&#160;</i>d,&#160;∆,&#160;r<i>,&#160;there&#160;exist&#160;</i>ε&#160;=&#160;ε(d,&#160;∆)<i>,&#160;</i>µ&#160;=<br/>µ(d,&#160;∆,&#160;r)&#160;&gt;&#160;0&#160;<i>and&#160;an&#160;</i>n0&#160;∈&#160;N&#160;<i>such&#160;that&#160;the&#160;following&#160;holds&#160;for&#160;all&#160;</i>n&#160;≥&#160;n0<i>.</i><br/>
<i>Let&#160;</i>(H,&#160;G,&#160;R,&#160;(Xi)i∈[r],&#160;(Vi)i∈[r])&#160;<i>be&#160;a&#160;lower&#160;</i>(ε,&#160;d)<i>-super-regular&#160;blow-up&#160;instance.&#160;Assume&#160;further&#160;that</i><br/>
(i)&#160;∆(H),&#160;∆(R)&#160;≤&#160;∆<i>,</i><br/>
(ii)&#160;|Vi|&#160;=&#160;(1&#160;±&#160;ε)n/r&#160;<i>for&#160;all&#160;</i>i&#160;∈&#160;[r]<i>.</i><br/>
<i>Then,&#160;given&#160;any&#160;</i>µn<i>-bounded&#160;edge&#160;colouring&#160;of&#160;</i>G<i>,&#160;there&#160;exists&#160;a&#160;rainbow&#160;embedding&#160;of&#160;</i>H&#160;<i>into&#160;</i>G&#160;<i>(where<br/></i>Xi&#160;<i>is&#160;mapped&#160;to&#160;</i>Vi&#160;<i>for&#160;all&#160;</i>i&#160;∈&#160;[r]<i>).</i><br/>
Observe&#160;that&#160;ε&#160;does&#160;not&#160;depend&#160;on&#160;r,&#160;which&#160;is&#160;crucial&#160;in&#160;applications.&#160;Originally&#160;the&#160;blow-up&#160;lemma<br/>
was&#160;formulated&#160;with&#160;R&#160;being&#160;the&#160;clique&#160;on&#160;at&#160;most&#160;∆&#160;vertices.&#160;In&#160;essentially&#160;all&#160;applications&#160;it&#160;is&#160;applied<br/>to&#160;many&#160;clique&#160;blow-ups&#160;iteratively.&#160;However,&#160;in&#160;order&#160;to&#160;have&#160;a&#160;useful&#160;rainbow&#160;blow-up&#160;lemma,&#160;we<br/>cannot&#160;apply&#160;it&#160;independently&#160;to&#160;two&#160;or&#160;more&#160;clique&#160;blow-ups&#160;as&#160;in&#160;both&#160;parts&#160;the&#160;blow-up&#160;lemma&#160;may<br/>use&#160;the&#160;same&#160;colour.&#160;We&#160;will&#160;discuss&#160;this&#160;issue&#160;further&#160;in&#160;Section&#160;<a href="1802.07700s.html#4">2.</a><br/>
1.2.&#160;A&#160;rainbow&#160;bandwidth&#160;theorem&#160;and&#160;quasirandom&#160;host&#160;graphs.&#160;One&#160;of&#160;the&#160;fundamental<br/>results&#160;of&#160;extremal&#160;combinatorics&#160;is&#160;the&#160;Erd˝<br/>
os–Stone&#160;theorem,&#160;stating&#160;that&#160;for&#160;a&#160;fixed&#160;graph&#160;H,&#160;every&#160;large<br/>
graph&#160;G&#160;on&#160;n&#160;vertices&#160;with&#160;average&#160;degree&#160;at&#160;least&#160;(1&#160;−&#160;1/(χ(H)&#160;−&#160;1)&#160;+&#160;o(1))n&#160;contains&#160;H&#160;as&#160;a&#160;subgraph.<br/>The&#160;bandwidth&#160;theorem&#160;can&#160;be&#160;viewed&#160;as&#160;an&#160;analogue&#160;of&#160;the&#160;Erd˝<br/>
os–Stone&#160;theorem&#160;when&#160;H&#160;is&#160;a&#160;spanning<br/>
subgraph&#160;of&#160;G.&#160;Clearly,&#160;in&#160;this&#160;setting,&#160;one&#160;has&#160;to&#160;replace&#160;the&#160;average&#160;degree&#160;condition&#160;by&#160;a&#160;minimum<br/>degree&#160;condition&#160;in&#160;order&#160;to&#160;obtain&#160;sensible&#160;results.&#160;Let&#160;ℓ&#160;:=&#160;χ(H)&#160;and&#160;assume&#160;that&#160;H&#160;has&#160;bounded<br/>degree.&#160;A&#160;long&#160;line&#160;of&#160;research&#160;confirmed&#160;for&#160;various&#160;cases&#160;that&#160;δ(G)&#160;≥&#160;(1−1/ℓ+o(1))n&#160;suffices&#160;to&#160;find&#160;H<br/>as&#160;a&#160;spanning&#160;subgraph&#160;in&#160;G,&#160;for&#160;instance&#160;when&#160;H&#160;is&#160;a&#160;spanning&#160;tree,&#160;a&#160;(power&#160;of&#160;a)&#160;Hamilton&#160;cycle,&#160;or&#160;a<br/>clique&#160;factor.&#160;A&#160;conjecture&#160;of&#160;Bollob´<br/>
as&#160;and&#160;Koml´os,&#160;which&#160;became&#160;known&#160;as&#160;the&#160;bandwidth&#160;conjecture,<br/>
attempted&#160;to&#160;generalize&#160;all&#160;the&#160;mentioned&#160;results&#160;by&#160;claiming&#160;that&#160;δ(G)&#160;≥&#160;(1&#160;−&#160;1/ℓ&#160;+&#160;o(1))n&#160;suffices<br/>whenever&#160;H&#160;has&#160;not&#160;too&#160;strong&#160;expansion&#160;properties&#160;(in&#160;this&#160;case&#160;measured&#160;by&#160;the&#160;parameter&#160;bandwidth).<br/>The&#160;<i>bandwidth&#160;</i>of&#160;a&#160;graph&#160;H&#160;with&#160;vertex&#160;set&#160;[n]&#160;is&#160;defined&#160;as&#160;minπ&#160;max{|π(i)&#160;−&#160;π(j)|:&#160;ij&#160;∈&#160;E(H)}&#160;where<br/>the&#160;minimum&#160;ranges&#160;over&#160;all&#160;permutations&#160;on&#160;[n].<br/>
B¨ottcher,&#160;Schacht&#160;and&#160;Taraz&#160;<a href="1802.07700s.html#29">[9]&#160;</a>proved&#160;the&#160;bandwidth&#160;conjecture&#160;roughly&#160;ten&#160;years&#160;ago.&#160;We&#160;refer<br/>
to&#160;their&#160;paper&#160;for&#160;more&#160;information&#160;on&#160;the&#160;history&#160;of&#160;the&#160;conjecture.&#160;Graph&#160;classes&#160;with&#160;appropriately<br/>small&#160;bandwidth&#160;include&#160;for&#160;example&#160;powers&#160;of&#160;Hamilton&#160;cycles,&#160;F&#160;-factors&#160;and&#160;bounded&#160;degree&#160;trees<br/>and&#160;planar&#160;graphs.&#160;We&#160;also&#160;remark&#160;that&#160;the&#160;minimum&#160;degree&#160;bound&#160;given&#160;by&#160;the&#160;bandwidth&#160;theorem<br/>is&#160;not&#160;necessarily&#160;the&#160;optimal&#160;threshold&#160;(cf.&#160;Section&#160;<a href="1802.07700s.html#25">6.2)</a>.&#160;Here,&#160;we&#160;extend&#160;the&#160;bandwidth&#160;theorem&#160;to<br/>the&#160;rainbow&#160;setting.&#160;We&#160;will&#160;prove&#160;the&#160;following&#160;theorem&#160;in&#160;Section&#160;<a href="1802.07700s.html#25">6.2&#160;</a>by&#160;replacing&#160;the&#160;usual&#160;blow-up<br/>lemma&#160;with&#160;our&#160;rainbow&#160;blow-up&#160;lemma&#160;in&#160;the&#160;approach&#160;of&#160;<a href="1802.07700s.html#29">[9].</a><br/>
Theorem&#160;1.2.&#160;<i>For&#160;all&#160;</i>δ,&#160;∆,&#160;ℓ<i>,&#160;there&#160;are&#160;</i>β,&#160;µ&#160;&gt;&#160;0&#160;<i>and&#160;an&#160;</i>n0&#160;∈&#160;N&#160;<i>such&#160;that&#160;the&#160;following&#160;holds&#160;for&#160;all<br/></i>n&#160;≥&#160;n0<i>.&#160;Suppose&#160;</i>G&#160;<i>is&#160;a&#160;graph&#160;on&#160;</i>n&#160;<i>vertices&#160;with&#160;</i>δ(G)&#160;≥&#160;(1&#160;−&#160;1/ℓ&#160;+&#160;δ)n<i>.&#160;Suppose&#160;</i>H&#160;<i>is&#160;a&#160;graph&#160;on<br/></i>n&#160;<i>vertices&#160;with&#160;</i>∆(H)&#160;≤&#160;∆<i>,&#160;bandwidth&#160;at&#160;most&#160;</i>βn<i>,&#160;and&#160;</i>χ(H)&#160;≤&#160;ℓ<i>.&#160;Then,&#160;given&#160;any&#160;</i>µn<i>-bounded&#160;edge<br/>colouring&#160;of&#160;</i>G<i>,&#160;the&#160;graph&#160;</i>G&#160;<i>contains&#160;a&#160;rainbow&#160;copy&#160;of&#160;</i>H<i>.</i><br/>
A&#160;particular&#160;example&#160;which&#160;is&#160;covered&#160;by&#160;the&#160;bandwidth&#160;theorem&#160;is&#160;the&#160;case&#160;when&#160;H&#160;is&#160;a&#160;tree.&#160;This&#160;was<br/>
known&#160;as&#160;Bollob´<br/>
as’&#160;conjecture&#160;and&#160;was&#160;proved&#160;by&#160;Koml´os,&#160;S´<br/>
ark¨ozy&#160;and&#160;Szemer´edi&#160;<a href="1802.07700s.html#29">[29].&#160;</a>In&#160;Section&#160;<a href="1802.07700s.html#24">6.1,</a><br/>
we&#160;present&#160;an&#160;easy&#160;proof&#160;of&#160;this&#160;result&#160;in&#160;the&#160;rainbow&#160;setting.&#160;Our&#160;main&#160;motivation&#160;is&#160;to&#160;give&#160;the&#160;reader<br/>a&#160;straightforward&#160;example&#160;of&#160;how&#160;to&#160;apply&#160;our&#160;rainbow&#160;blow-up&#160;lemma.&#160;(The&#160;proof&#160;in&#160;<a href="1802.07700s.html#29">[29]&#160;</a>is&#160;without<br/>the&#160;blow-up&#160;lemma&#160;and&#160;thus&#160;much&#160;longer.)<br/>
Another&#160;straightforward&#160;corollary&#160;of&#160;our&#160;rainbow&#160;blow-up&#160;lemma&#160;is&#160;the&#160;existence&#160;of&#160;rainbow&#160;bounded<br/>
degree&#160;graphs&#160;in&#160;quasi-random&#160;host&#160;graphs.&#160;Let&#160;us&#160;say&#160;a&#160;graph&#160;G&#160;on&#160;n&#160;vertices&#160;is&#160;(ε,&#160;d)<i>-dense&#160;</i>if&#160;for&#160;all<br/>disjoint&#160;S,&#160;T&#160;⊆&#160;V&#160;(G)&#160;with&#160;|S|,&#160;|T&#160;|&#160;≥&#160;εn,&#160;we&#160;have&#160;eG(S,&#160;T&#160;)&#160;≥&#160;d|S||T&#160;|.<br/>
<hr/>
<a name=4></a>4<br/>
S.&#160;GLOCK&#160;AND&#160;F.&#160;JOOS<br/>
Corollary&#160;1.3.&#160;<i>For&#160;all&#160;</i>d,&#160;∆<i>,&#160;there&#160;are&#160;</i>ε,&#160;µ&#160;&gt;&#160;0&#160;<i>and&#160;an&#160;</i>n0&#160;∈&#160;N&#160;<i>such&#160;that&#160;the&#160;following&#160;holds&#160;for&#160;all<br/></i>n&#160;≥&#160;n0<i>.&#160;Suppose&#160;</i>G,&#160;H&#160;<i>are&#160;graphs&#160;on&#160;</i>n&#160;<i>vertices,&#160;</i>δ(G)&#160;≥&#160;dn<i>,&#160;the&#160;graph&#160;</i>G&#160;<i>is&#160;</i>(ε,&#160;d)<i>-dense,&#160;and&#160;</i>∆(H)&#160;≤&#160;∆<i>.<br/>Then,&#160;given&#160;any&#160;</i>µn<i>-bounded&#160;edge&#160;colouring&#160;of&#160;</i>G<i>,&#160;the&#160;graph&#160;</i>G&#160;<i>contains&#160;a&#160;rainbow&#160;copy&#160;of&#160;</i>H<i>.</i><br/>
This&#160;is&#160;the&#160;first&#160;result&#160;that&#160;considers&#160;spanning&#160;rainbow&#160;embeddings&#160;in&#160;graphs&#160;of&#160;arbitrarily&#160;small&#160;(but<br/>
fixed)&#160;density.<br/>
1.3.&#160;Further&#160;applications&#160;and&#160;related&#160;problems.&#160;An&#160;edge&#160;colouring&#160;is&#160;<i>locally&#160;</i>k<i>-bounded&#160;</i>if&#160;each<br/>colour&#160;appears&#160;at&#160;most&#160;k&#160;times&#160;on&#160;the&#160;edges&#160;which&#160;are&#160;incident&#160;to&#160;a&#160;single&#160;vertex.&#160;(For&#160;instance,&#160;a<br/>locally&#160;1-bounded&#160;colouring&#160;is&#160;proper.)&#160;For&#160;many&#160;of&#160;the&#160;aforementioned&#160;results,&#160;there&#160;is&#160;a&#160;corresponding<br/>result&#160;where&#160;the&#160;colouring&#160;is&#160;not&#160;k-bounded,&#160;but&#160;only&#160;locally&#160;k-bounded,&#160;and&#160;instead&#160;of&#160;aiming&#160;for&#160;a<br/>rainbow&#160;copy&#160;of&#160;H,&#160;one&#160;aims&#160;for&#160;a&#160;properly&#160;coloured&#160;copy&#160;of&#160;H.&#160;Our&#160;proof&#160;of&#160;the&#160;rainbow&#160;blow-up<br/>lemma&#160;transfers&#160;to&#160;this&#160;setting&#160;as&#160;well&#160;(with&#160;k&#160;=&#160;µn).&#160;In&#160;fact,&#160;it&#160;is&#160;then&#160;much&#160;easier,&#160;because&#160;there&#160;are<br/>only&#160;local&#160;conflicts&#160;and&#160;no&#160;global&#160;conflicts,&#160;and&#160;a&#160;simple&#160;modification&#160;of&#160;the&#160;original&#160;proofs&#160;already&#160;yields<br/>such&#160;a&#160;result.<br/>
Note&#160;that&#160;every&#160;locally&#160;O(1)-bounded&#160;edge&#160;colouring&#160;is&#160;(globally)&#160;O(n)-bounded.&#160;For&#160;example,&#160;every<br/>
proper&#160;edge&#160;colouring&#160;is&#160;n/2-bounded.&#160;Quite&#160;a&#160;few&#160;open&#160;problems&#160;are&#160;formulated&#160;in&#160;this&#160;setting.&#160;For<br/>example,&#160;the&#160;Ryser–Brualdi–Stein&#160;conjecture&#160;asks&#160;for&#160;a&#160;rainbow&#160;matching&#160;of&#160;size&#160;n&#160;−&#160;1&#160;in&#160;every&#160;properly<br/>n-edge-coloured&#160;Kn,n,&#160;and&#160;Andersen&#160;<a href="1802.07700s.html#29">[4]&#160;</a>conjectured&#160;that&#160;there&#160;is&#160;a&#160;rainbow&#160;path&#160;of&#160;length&#160;n&#160;−&#160;2&#160;in&#160;every<br/>properly&#160;edge-coloured&#160;Kn.&#160;The&#160;currently&#160;best&#160;approximate&#160;result&#160;for&#160;the&#160;first&#160;problem&#160;is&#160;due&#160;to&#160;Hatami<br/>and&#160;Shor&#160;<a href="1802.07700s.html#29">[22].&#160;</a>An&#160;approximate&#160;result&#160;for&#160;the&#160;second&#160;problem&#160;was&#160;achieved&#160;in&#160;a&#160;breakthrough&#160;result&#160;by<br/>Alon,&#160;Pokrovskiy&#160;and&#160;Sudakov&#160;<a href="1802.07700s.html#28">[2]&#160;</a>and&#160;slightly&#160;improved&#160;by&#160;Balogh&#160;and&#160;Molla&#160;<a href="1802.07700s.html#29">[6].&#160;</a>One&#160;may&#160;also&#160;ask&#160;for<br/>any&#160;other&#160;rainbow&#160;subgraph&#160;with&#160;at&#160;most&#160;n&#160;edges,&#160;for&#160;instance&#160;a&#160;particular&#160;(almost)&#160;spanning&#160;tree&#160;or&#160;an<br/>(almost)&#160;spanning&#160;collection&#160;of&#160;cycles.&#160;(Observe&#160;that&#160;a&#160;proper&#160;edge-colouring&#160;may&#160;only&#160;use&#160;n&#160;colours.<br/>Hence&#160;it&#160;only&#160;makes&#160;sense&#160;to&#160;ask&#160;for&#160;rainbow&#160;subgraphs&#160;with&#160;at&#160;most&#160;n&#160;edges.)<br/>
Recently,&#160;Montgomery,&#160;Pokrovskiy&#160;and&#160;Sudakov&#160;<a href="1802.07700s.html#29">[39]&#160;</a>showed&#160;that&#160;Kn&#160;equipped&#160;with&#160;a&#160;locally&#160;k-<br/>
bounded&#160;edge&#160;colouring&#160;contains&#160;any&#160;tree&#160;with&#160;at&#160;most&#160;(1&#160;−&#160;o(1))n/k&#160;vertices&#160;as&#160;a&#160;rainbow&#160;subgraph.<br/>This&#160;also&#160;implies&#160;an&#160;approximate&#160;version&#160;of&#160;Ringel’s&#160;conjecture&#160;on&#160;decompositions&#160;of&#160;Kn&#160;into&#160;a&#160;given<br/>tree.<br/>
Instead&#160;of&#160;finding&#160;a&#160;single&#160;rainbow&#160;subgraph,&#160;it&#160;is&#160;also&#160;natural&#160;to&#160;ask&#160;for&#160;decompositions&#160;into&#160;rainbow<br/>
subgraphs.&#160;For&#160;instance,&#160;there&#160;are&#160;three&#160;conjectures&#160;due&#160;to&#160;Brualdi–Hollingsworth,&#160;Kaneko–Kano–<br/>Suzuki,&#160;and&#160;Constantine&#160;regarding&#160;the&#160;decomposition&#160;of&#160;properly&#160;edge-coloured&#160;complete&#160;graphs&#160;into<br/>rainbow&#160;(isomorphic)&#160;spanning&#160;trees.&#160;Montgomery,&#160;Pokrovskiy&#160;and&#160;Sudakov&#160;<a href="1802.07700s.html#29">[38]&#160;</a>obtain&#160;strong&#160;results<br/>which&#160;prove&#160;these&#160;conjectures&#160;approximately&#160;(for&#160;not&#160;necessarily&#160;isomorphic&#160;trees).&#160;Independently,&#160;Kim,<br/>K¨<br/>
uhn,&#160;Kupavskii&#160;and&#160;Osthus&#160;<a href="1802.07700s.html#29">[27]&#160;</a>use&#160;our&#160;blow-up&#160;lemma&#160;to&#160;prove&#160;several&#160;related&#160;results.&#160;In&#160;their&#160;setting,<br/>
the&#160;given&#160;colouring&#160;does&#160;not&#160;need&#160;to&#160;be&#160;proper,&#160;but&#160;can&#160;be&#160;locally&#160;n/&#160;log5&#160;n-bounded,&#160;say.&#160;On&#160;the&#160;other<br/>hand,&#160;the&#160;global&#160;condition&#160;is&#160;slightly&#160;more&#160;restrictive&#160;than&#160;in&#160;a&#160;proper&#160;colouring.&#160;As&#160;one&#160;example,&#160;they<br/>show&#160;the&#160;following.<br/>
Theorem&#160;1.4&#160;(Kim,&#160;K¨<br/>
uhn,&#160;Kupavskii&#160;and&#160;Osthus&#160;<a href="1802.07700s.html#29">[27])</a>.&#160;<i>For&#160;any&#160;</i>ε&#160;&gt;&#160;0<i>,&#160;there&#160;exists&#160;</i>n0&#160;∈&#160;N&#160;<i>such&#160;that&#160;for</i><br/>
<i>all&#160;</i>n&#160;≥&#160;n0<i>,&#160;any&#160;</i>(1&#160;−&#160;ε)n/2<i>-bounded,&#160;locally&#160;</i>n/&#160;log5&#160;n<i>-bounded&#160;edge-colouring&#160;of&#160;</i>Kn&#160;<i>contains&#160;</i>(1/2&#160;−&#160;ε)n<br/><i>edge-disjoint&#160;rainbow&#160;Hamilton&#160;cycles.</i><br/>
This&#160;also&#160;establishes&#160;approximate&#160;solutions&#160;to&#160;the&#160;above&#160;tree&#160;decomposition&#160;conjectures.&#160;Analogous<br/>
results&#160;hold&#160;for&#160;approximate&#160;decompositions&#160;into&#160;rainbow&#160;H-factors&#160;<a href="1802.07700s.html#29">[27].</a><br/>
The&#160;following&#160;observation&#160;indicates&#160;why&#160;our&#160;rainbow&#160;blow-up&#160;lemma&#160;can&#160;be&#160;applied&#160;in&#160;this&#160;setting.<br/>
Suppose&#160;for&#160;simplicity&#160;that&#160;we&#160;consider&#160;a&#160;properly&#160;edge-coloured&#160;complete&#160;graph.&#160;If&#160;one&#160;chooses&#160;a&#160;random<br/>subset&#160;U&#160;of&#160;vertices&#160;of&#160;size&#160;µn,&#160;then&#160;with&#160;high&#160;probability,&#160;the&#160;colouring&#160;restricted&#160;to&#160;this&#160;subset&#160;is&#160;µ|U|-<br/>bounded,&#160;and&#160;the&#160;blow-up&#160;lemma&#160;can&#160;be&#160;applied&#160;to&#160;U&#160;to&#160;complete&#160;a&#160;partial&#160;embedding&#160;(constructed<br/>outside&#160;U&#160;using&#160;different&#160;methods,&#160;e.g.&#160;via&#160;a&#160;hypergraph&#160;matching&#160;argument).<br/>
Rainbow&#160;decomposition&#160;results&#160;may&#160;in&#160;fact&#160;hold&#160;in&#160;a&#160;more&#160;general&#160;setting.&#160;Kim,&#160;K¨<br/>
uhn,&#160;Osthus&#160;and<br/>
Tyomkyn&#160;<a href="1802.07700s.html#29">[28]&#160;</a>proved&#160;a&#160;blow-up&#160;lemma&#160;for&#160;approximate&#160;decompositions&#160;into&#160;arbitrary&#160;(bounded&#160;degree)<br/>graphs.&#160;In&#160;combination&#160;with&#160;our&#160;result&#160;and&#160;methods&#160;there&#160;is&#160;hope&#160;for&#160;a&#160;rainbow&#160;blow-up&#160;lemma&#160;for<br/>approximate&#160;decompositions.<br/>
2.&#160;Proof&#160;overview<br/>
Our&#160;starting&#160;point&#160;is&#160;the&#160;alternative&#160;proof&#160;of&#160;the&#160;blow-up&#160;lemma&#160;given&#160;by&#160;R¨<br/>
odl&#160;and&#160;Ruci´<br/>
nski&#160;<a href="1802.07700s.html#29">[43].&#160;</a>We<br/>
briefly&#160;sketch&#160;their&#160;approach,&#160;before&#160;considering&#160;the&#160;rainbow&#160;setting.<br/>
Suppose&#160;that&#160;(H,&#160;G,&#160;R,&#160;(Xi)i∈[r],&#160;(Vi)i∈[r])&#160;is&#160;a&#160;blow-up&#160;instance.&#160;Assume&#160;that&#160;∆(H)&#160;≤&#160;∆&#160;and&#160;that<br/>
G[Vi,&#160;Vj]&#160;is&#160;super-regular&#160;for&#160;all&#160;1&#160;≤&#160;i&#160;&lt;&#160;j&#160;≤&#160;r,&#160;i.e.&#160;R&#160;=&#160;Kr.&#160;We&#160;want&#160;to&#160;find&#160;an&#160;embedding&#160;φ&#160;of&#160;H&#160;into<br/>
<hr/>
<a name=5></a><img class="yflip" src="html/1802.07700-5_1.png"/><br/>
5<br/>
G&#160;(where&#160;Xi&#160;is&#160;mapped&#160;onto&#160;Vi).&#160;The&#160;strategy&#160;is&#160;to&#160;embed&#160;H&#160;in&#160;r&#160;rounds,&#160;where&#160;in&#160;round&#160;i,&#160;all&#160;vertices<br/>of&#160;Xi&#160;are&#160;embedded&#160;simultaneously&#160;into&#160;Vi.&#160;Clearly,&#160;this&#160;corresponds&#160;to&#160;a&#160;perfect&#160;matching&#160;between&#160;Xi<br/>and&#160;Vi.&#160;Yet&#160;not&#160;every&#160;perfect&#160;matching&#160;yields&#160;a&#160;valid&#160;embedding.&#160;They&#160;keep&#160;track&#160;of&#160;this&#160;by&#160;defining<br/>a&#160;(dynamic)&#160;‘candidacy&#160;graph’&#160;Aj&#160;for&#160;each&#160;pair&#160;of&#160;clusters&#160;(Xj,&#160;Vj).&#160;This&#160;candidacy&#160;graph&#160;depends&#160;on<br/>the&#160;partial&#160;embedding&#160;up&#160;to&#160;round&#160;i.&#160;More&#160;precisely,&#160;for&#160;j&#160;&gt;&#160;i,&#160;let&#160;Aj&#160;denote&#160;the&#160;candidacy&#160;graph&#160;for<br/>
i<br/>
(Xj,&#160;Vj)&#160;after&#160;X1,&#160;.&#160;.&#160;.&#160;,&#160;Xi&#160;have&#160;been&#160;embedded,&#160;where&#160;xv&#160;∈&#160;E(Aj)&#160;if&#160;and&#160;only&#160;if&#160;v&#160;is&#160;still&#160;a&#160;candidate<br/>
i<br/>
to&#160;be&#160;the&#160;image&#160;of&#160;x.&#160;In&#160;the&#160;beginning,&#160;all&#160;candidacy&#160;graphs&#160;are&#160;complete&#160;bipartite&#160;graphs,&#160;but&#160;during<br/>the&#160;embedding,&#160;they&#160;become&#160;gradually&#160;sparser.&#160;The&#160;main&#160;idea&#160;is&#160;to&#160;maintain&#160;super-regularity&#160;of&#160;the<br/>candidacy&#160;graphs.&#160;More&#160;precisely,&#160;given&#160;an&#160;embedding&#160;of&#160;the&#160;clusters&#160;X1,&#160;.&#160;.&#160;.&#160;,&#160;Xi,&#160;we&#160;assume&#160;that&#160;the<br/>candidacy&#160;graphs&#160;Ai+1,&#160;.&#160;.&#160;.&#160;,&#160;Ar<br/>
i<br/>
i&#160;are&#160;super-regular&#160;(which&#160;is&#160;true&#160;for&#160;i&#160;=&#160;0),&#160;and&#160;now&#160;have&#160;to&#160;find&#160;a&#160;perfect<br/>
matching&#160;σ&#160;of&#160;Ai+1&#160;(which&#160;defines&#160;an&#160;embedding&#160;of&#160;X<br/>
i<br/>
i+1&#160;into&#160;Vi+1)&#160;in&#160;such&#160;a&#160;way&#160;that&#160;the&#160;updated<br/>
candidacy&#160;graphs&#160;Ai+2,&#160;.&#160;.&#160;.&#160;,&#160;Ar<br/>
i+1<br/>
i+1&#160;are&#160;again&#160;super-regular.&#160;Fortunately,&#160;it&#160;turns&#160;out&#160;that&#160;if&#160;σ&#160;is&#160;chosen<br/>
randomly&#160;among&#160;all&#160;perfect&#160;matchings&#160;of&#160;Ai+1,&#160;then&#160;this&#160;desired&#160;property&#160;holds&#160;with&#160;high&#160;probability.<br/>
i<br/>
The&#160;key&#160;tool&#160;to&#160;show&#160;this&#160;is&#160;the&#160;so-called&#160;Four&#160;graphs&#160;lemma&#160;from&#160;<a href="1802.07700s.html#29">[43]&#160;</a>(see&#160;Lemma&#160;<a href="1802.07700s.html#17">5.6)</a>.&#160;For&#160;this&#160;to<br/>work,&#160;we&#160;actually&#160;need&#160;a&#160;stronger&#160;assumption&#160;on&#160;H,&#160;that&#160;is,&#160;we&#160;require&#160;that&#160;the&#160;clusters&#160;Xi&#160;are&#160;not&#160;only<br/>independent&#160;in&#160;H,&#160;but&#160;2-independent.&#160;However,&#160;using&#160;the&#160;Hajnal–Szemer´edi&#160;theorem,&#160;it&#160;is&#160;not&#160;hard&#160;to<br/>reduce&#160;the&#160;general&#160;case&#160;to&#160;this&#160;setting.&#160;This&#160;will&#160;also&#160;be&#160;the&#160;first&#160;step&#160;in&#160;our&#160;proof&#160;(see&#160;Section&#160;<a href="1802.07700s.html#14">5.1)</a>.<br/>
Now,&#160;assume&#160;that&#160;c&#160;:&#160;E(G)&#160;→&#160;C&#160;is&#160;a&#160;µn-bounded&#160;edge&#160;colouring&#160;of&#160;G.&#160;We&#160;might&#160;try&#160;to&#160;proceed&#160;as<br/>
above.&#160;Suppose&#160;that&#160;we&#160;have&#160;already&#160;found&#160;a&#160;rainbow&#160;embedding&#160;φi&#160;of&#160;H[X1∪·&#160;·&#160;·∪Xi]&#160;into&#160;G[V1∪·&#160;·&#160;·∪Vi]<br/>and&#160;that&#160;the&#160;candidacy&#160;graphs&#160;Ai+1,&#160;.&#160;.&#160;.&#160;,&#160;Ar<br/>
i<br/>
i&#160;are&#160;super-regular.&#160;Clearly,&#160;the&#160;definition&#160;of&#160;candidacy&#160;graphs<br/>
needs&#160;to&#160;be&#160;adapted&#160;to&#160;the&#160;rainbow&#160;setting.&#160;Consider&#160;x&#160;∈&#160;Xj&#160;and&#160;v&#160;∈&#160;Vj&#160;for&#160;j&#160;&gt;&#160;i.&#160;Let&#160;Fxv&#160;denote&#160;the<br/>set&#160;of&#160;edges&#160;φi(y)v&#160;where&#160;y&#160;∈&#160;NH(x)&#160;∩&#160;(X1&#160;∪&#160;·&#160;·&#160;·&#160;∪&#160;Xi).&#160;Previously,&#160;v&#160;was&#160;a&#160;candidate&#160;for&#160;x&#160;if&#160;and&#160;only&#160;if<br/>Fxv&#160;⊆&#160;E(G),&#160;where&#160;Fxv&#160;is&#160;the&#160;set&#160;of&#160;edges&#160;in&#160;G&#160;which&#160;are&#160;used&#160;if&#160;x&#160;is&#160;embedded&#160;at&#160;v.&#160;Now,&#160;we&#160;need&#160;in<br/>addition&#160;that&#160;the&#160;edges&#160;of&#160;Fxv&#160;have&#160;mutually&#160;distinct&#160;colours,&#160;and&#160;do&#160;not&#160;have&#160;a&#160;colour&#160;which&#160;is&#160;already<br/>used&#160;by&#160;φi.&#160;Suppose&#160;that&#160;this&#160;is&#160;the&#160;case&#160;and&#160;Ai+1&#160;is&#160;the&#160;candidacy&#160;graph&#160;for&#160;(X<br/>
i<br/>
i+1,&#160;Vi+1).<br/>
In&#160;the<br/>
uncoloured&#160;setting,&#160;any&#160;perfect&#160;matching&#160;σ&#160;of&#160;Ai+1&#160;yields&#160;a&#160;valid&#160;embedding&#160;of&#160;H[X<br/>
i<br/>
1&#160;∪&#160;·&#160;·&#160;·&#160;∪&#160;Xi+1]&#160;into<br/>
G[V1&#160;∪&#160;·&#160;·&#160;·∪&#160;Vi+1]&#160;(and&#160;almost&#160;all&#160;of&#160;them&#160;leave&#160;the&#160;updated&#160;candidacy&#160;graphs&#160;super-regular).&#160;In&#160;contrast<br/>to&#160;this,&#160;by&#160;far&#160;not&#160;every&#160;perfect&#160;matching&#160;σ&#160;of&#160;Ai+1&#160;yields&#160;a&#160;rainbow&#160;embedding&#160;of&#160;H[X<br/>
i<br/>
1&#160;∪&#160;·&#160;·&#160;·&#160;∪&#160;Xi+1].<br/>
For&#160;this&#160;to&#160;be&#160;the&#160;case,&#160;we&#160;need&#160;that&#160;c(Fxσ(x))&#160;∩&#160;c(Fx′σ(x′))&#160;=&#160;∅&#160;for&#160;all&#160;distinct&#160;x,&#160;x′&#160;∈&#160;Xi+1.&#160;This&#160;can&#160;be<br/>modelled&#160;by&#160;defining&#160;a&#160;suitable&#160;conflict&#160;system&#160;on&#160;the&#160;edges&#160;of&#160;Ai+1,&#160;where&#160;two&#160;edges&#160;xv,&#160;x′v′&#160;<i>conflict</i><br/>
i<br/>
if&#160;c(Fxv)&#160;∩&#160;c(Fx′v′)&#160;6=&#160;∅.&#160;Observe&#160;that&#160;a&#160;conflict-free&#160;perfect&#160;matching&#160;would&#160;yield&#160;a&#160;rainbow&#160;embedding<br/>of&#160;H[X1&#160;∪&#160;·&#160;·&#160;·&#160;∪&#160;Xi+1].&#160;Crucially,&#160;since&#160;c&#160;is&#160;µn-bounded,&#160;every&#160;edge&#160;conflicts&#160;with&#160;at&#160;most&#160;∆(H)µn<br/>other&#160;edges.&#160;Using&#160;the&#160;switching&#160;method,&#160;we&#160;can&#160;show&#160;that&#160;a&#160;uniformly&#160;random&#160;perfect&#160;matching&#160;is<br/>conflict-free&#160;with&#160;positive&#160;probability.&#160;This&#160;step&#160;uses&#160;a&#160;recent&#160;result&#160;of&#160;Coulson&#160;and&#160;Perarnau&#160;<a href="1802.07700s.html#29">[12].</a><br/>
For&#160;the&#160;embedding&#160;procedure&#160;to&#160;work,&#160;we&#160;have&#160;to&#160;make&#160;sure&#160;that&#160;the&#160;updated&#160;candidacy&#160;graphs&#160;are<br/>
again&#160;super-regular.&#160;However,&#160;this&#160;might&#160;easily&#160;be&#160;wrong,&#160;as&#160;we&#160;might&#160;accidentally&#160;isolate&#160;a&#160;vertex.&#160;For<br/>instance,&#160;vertex&#160;v&#160;∈&#160;Vi+2&#160;might&#160;only&#160;see&#160;µ−2&#160;colours,&#160;say,&#160;but&#160;all&#160;of&#160;those&#160;colours&#160;might&#160;already&#160;be&#160;used<br/>in&#160;the&#160;embedding&#160;φi+1.&#160;Then&#160;vertex&#160;v&#160;cannot&#160;be&#160;a&#160;candidate&#160;for&#160;any&#160;x&#160;∈&#160;Xi+2&#160;and&#160;thus&#160;the&#160;embedding<br/>is&#160;stuck.<br/>
To&#160;overcome&#160;this&#160;issue,&#160;we&#160;reserve&#160;an&#160;exclusive&#160;set&#160;of&#160;colours&#160;for&#160;each&#160;embedding&#160;round&#160;in&#160;the&#160;begin-<br/>
ning.&#160;For&#160;instance,&#160;we&#160;might&#160;partition&#160;the&#160;colour&#160;set&#160;C&#160;into&#160;sets&#160;(Cij)1≤i&lt;j≤r,&#160;and&#160;instead&#160;of&#160;embedding<br/>H&#160;into&#160;G,&#160;we&#160;embed&#160;H&#160;into&#160;the&#160;graph&#160;G∗&#160;which&#160;between&#160;clusters&#160;Vi,&#160;Vj&#160;only&#160;contains&#160;those&#160;edges&#160;of<br/>G[Vi,&#160;Vj]&#160;whose&#160;colour&#160;is&#160;contained&#160;in&#160;Cij.&#160;This&#160;decouples&#160;much&#160;of&#160;the&#160;colour&#160;dependency&#160;between&#160;the<br/>embedding&#160;rounds&#160;and&#160;allows&#160;us&#160;to&#160;analyse&#160;the&#160;updated&#160;candidacy&#160;graphs&#160;as&#160;before&#160;using&#160;the&#160;Four&#160;graphs<br/>lemma.&#160;Of&#160;course,&#160;this&#160;strategy&#160;only&#160;works&#160;if&#160;the&#160;pairs&#160;G∗[Vi,&#160;Vj]&#160;are&#160;super-regular.&#160;A&#160;natural&#160;approach<br/>to&#160;show&#160;the&#160;existence&#160;of&#160;a&#160;suitable&#160;partition&#160;of&#160;C&#160;is&#160;to&#160;partition&#160;C&#160;randomly.&#160;Simplified,&#160;the&#160;problem&#160;we<br/>face&#160;here&#160;is&#160;as&#160;follows:&#160;Consider&#160;the&#160;complete&#160;bipartite&#160;graph&#160;Kn,n&#160;with&#160;any&#160;µn-bounded&#160;edge&#160;colouring.<br/>If&#160;we&#160;‘activate’&#160;each&#160;colour&#160;independently&#160;with&#160;probability&#160;1/2,&#160;what&#160;is&#160;the&#160;probability&#160;that&#160;the&#160;activated<br/>
√<br/>
edges&#160;induce&#160;a&#160;(&#160;µ,&#160;1/2)-super-regular&#160;pair,&#160;say?&#160;This&#160;seems&#160;to&#160;be&#160;an&#160;interesting&#160;problem&#160;in&#160;its&#160;own<br/>right,&#160;and&#160;we&#160;are&#160;not&#160;aware&#160;of&#160;any&#160;coverage&#160;in&#160;the&#160;literature.&#160;Heuristically&#160;one&#160;expects&#160;this&#160;to&#160;be&#160;a<br/>rare&#160;event&#160;of&#160;exponentially&#160;small&#160;probability.&#160;However,&#160;the&#160;Lov´asz&#160;local&#160;lemma&#160;does&#160;not&#160;seem&#160;flexible<br/>enough&#160;to&#160;solve&#160;this&#160;problem.&#160;We&#160;will&#160;use&#160;the&#160;partial&#160;resampling&#160;algorithm&#160;introduced&#160;by&#160;Harris&#160;and<br/>Srinivasan&#160;<a href="1802.07700s.html#29">[21]&#160;</a>to&#160;deal&#160;with&#160;this&#160;problem&#160;(see&#160;Section&#160;<a href="1802.07700s.html#6">4)</a>.<br/>
One&#160;remaining&#160;issue&#160;arises&#160;from&#160;the&#160;applicability&#160;of&#160;the&#160;blow-up&#160;lemma.&#160;In&#160;the&#160;original&#160;version&#160;of&#160;the<br/>
blow-up&#160;lemma,&#160;the&#160;regularity&#160;parameter&#160;ε&#160;needs&#160;to&#160;be&#160;small&#160;as&#160;a&#160;function&#160;of&#160;the&#160;number&#160;of&#160;clusters&#160;r.<br/>However,&#160;in&#160;a&#160;regularity&#160;partition&#160;obtained&#160;via&#160;an&#160;application&#160;of&#160;Szemer´edi’s&#160;regularity&#160;lemma,&#160;the<br/>number&#160;of&#160;clusters&#160;r&#160;is&#160;large&#160;as&#160;a&#160;function&#160;of&#160;ε.&#160;Usually,&#160;this&#160;is&#160;dealt&#160;with&#160;roughly&#160;as&#160;follows:&#160;one&#160;finds&#160;a<br/>
<hr/>
<a name=6></a>6<br/>
S.&#160;GLOCK&#160;AND&#160;F.&#160;JOOS<br/>
vertex&#160;partition&#160;of&#160;the&#160;reduced&#160;graph&#160;R&#160;into&#160;r/k&#160;cliques&#160;of&#160;order&#160;k,&#160;where&#160;k&#160;is&#160;‘small’,&#160;and&#160;then&#160;applies<br/>the&#160;blow-up&#160;lemma&#160;to&#160;each&#160;clique&#160;independently.&#160;This&#160;approach&#160;is&#160;not&#160;feasible&#160;in&#160;the&#160;rainbow&#160;setting,<br/>as&#160;the&#160;union&#160;of&#160;rainbow&#160;subgraphs&#160;does&#160;not&#160;necessarily&#160;yield&#160;a&#160;rainbow&#160;subgraph.&#160;Also,&#160;splitting&#160;the<br/>colour&#160;set&#160;in&#160;the&#160;beginning&#160;in&#160;order&#160;to&#160;reserve&#160;an&#160;exclusive&#160;set&#160;of&#160;colours&#160;for&#160;each&#160;application&#160;of&#160;the<br/>blow-up&#160;lemma&#160;does&#160;not&#160;solve&#160;this&#160;problem,&#160;as&#160;the&#160;density&#160;of&#160;the&#160;regular&#160;pairs&#160;is&#160;divided&#160;by&#160;r/k&#160;through<br/>the&#160;splitting&#160;and&#160;will&#160;thus&#160;be&#160;too&#160;small&#160;compared&#160;to&#160;ε.&#160;We&#160;thus&#160;prove&#160;a&#160;‘global’&#160;version&#160;of&#160;the&#160;blow-up<br/>lemma&#160;which&#160;allows&#160;the&#160;number&#160;of&#160;clusters&#160;r&#160;to&#160;be&#160;large,&#160;but&#160;requires&#160;that&#160;∆(R)&#160;≤&#160;∆.&#160;Such&#160;a&#160;version<br/>of&#160;the&#160;blow-up&#160;lemma&#160;was&#160;first&#160;proved&#160;by&#160;Csaba&#160;<a href="1802.07700s.html#29">[13]&#160;</a>following&#160;the&#160;proof&#160;in&#160;<a href="1802.07700s.html#29">[30].&#160;</a>The&#160;proof&#160;of&#160;R¨<br/>
odl&#160;and<br/>
Ruci´<br/>
nski&#160;<a href="1802.07700s.html#29">[43]&#160;</a>can&#160;also&#160;be&#160;adapted&#160;to&#160;work&#160;in&#160;this&#160;setting&#160;(see&#160;e.g.&#160;<a href="1802.07700s.html#29">[28])</a>.&#160;However,&#160;we&#160;have&#160;to&#160;be&#160;careful<br/>
with&#160;the&#160;colour&#160;splitting,&#160;for&#160;the&#160;very&#160;reason&#160;discussed&#160;above:&#160;if&#160;we&#160;reserved&#160;an&#160;exclusive&#160;colour&#160;set&#160;for<br/>each&#160;pair&#160;Vi,&#160;Vj&#160;with&#160;ij&#160;∈&#160;E(R),&#160;the&#160;density&#160;of&#160;the&#160;regular&#160;pairs&#160;would&#160;be&#160;far&#160;too&#160;low.&#160;This&#160;can&#160;be<br/>dealt&#160;with&#160;by&#160;‘parallelizing’&#160;the&#160;embedding&#160;(for&#160;different&#160;reasons,&#160;this&#160;has&#160;also&#160;been&#160;done&#160;in&#160;<a href="1802.07700s.html#29">[28])</a>.&#160;We<br/>split&#160;V&#160;(R)&#160;into&#160;2-independent&#160;sets&#160;J1,&#160;.&#160;.&#160;.&#160;,&#160;JT&#160;,&#160;where&#160;we&#160;might&#160;take&#160;T&#160;=&#160;∆(R)2&#160;+&#160;1.&#160;We&#160;then&#160;reserve<br/>an&#160;exclusive&#160;colour&#160;set&#160;Ct<br/>
for&#160;each&#160;pair&#160;1&#160;≤&#160;t<br/>
1&#160;t2<br/>
1&#160;&lt;&#160;t2&#160;≤&#160;T&#160;.&#160;The&#160;sparsified&#160;graph&#160;G∗&#160;contains&#160;between<br/>
clusters&#160;Vi,&#160;Vj&#160;only&#160;those&#160;edges&#160;whose&#160;colour&#160;is&#160;contained&#160;in&#160;Ct<br/>
,&#160;where&#160;i&#160;∈&#160;J&#160;and&#160;j&#160;∈&#160;J&#160;.&#160;We&#160;now<br/>
1&#160;t2<br/>
t1<br/>
t2<br/>
embed&#160;H&#160;in&#160;just&#160;T&#160;rounds,&#160;where&#160;in&#160;round&#160;t&#160;∈&#160;[T&#160;],&#160;we&#160;embed&#160;all&#160;clusters&#160;Xi&#160;with&#160;i&#160;∈&#160;Jt&#160;simultaneously.<br/>Consequently,&#160;the&#160;perfect&#160;matching&#160;σ&#160;is&#160;not&#160;drawn&#160;as&#160;a&#160;uniform&#160;perfect&#160;matching&#160;of&#160;one&#160;candidacy&#160;graph,<br/>but&#160;is&#160;the&#160;union&#160;of&#160;|Jt|&#160;such&#160;perfect&#160;matchings.&#160;Fortunately,&#160;this&#160;still&#160;works&#160;nicely&#160;with&#160;the&#160;switching<br/>method&#160;and&#160;the&#160;Four&#160;graphs&#160;lemma.<br/>
The&#160;resulting&#160;proof&#160;can&#160;be&#160;found&#160;in&#160;Section&#160;<a href="1802.07700s.html#18">5.4.</a><br/>
3.&#160;Notation<br/>
We&#160;only&#160;consider&#160;finite,&#160;undirected&#160;and&#160;simple&#160;graphs.&#160;For&#160;a&#160;graph&#160;G,&#160;we&#160;let&#160;V&#160;(G)&#160;and&#160;E(G)&#160;denote<br/>
the&#160;vertex&#160;set&#160;and&#160;edge&#160;set,&#160;respectively.&#160;Moreover,&#160;for&#160;a&#160;vertex&#160;v,&#160;let&#160;dG(v)&#160;denote&#160;the&#160;degree&#160;of&#160;v,<br/>and&#160;let&#160;dG(v,&#160;A)&#160;denote&#160;the&#160;number&#160;of&#160;neighbours&#160;of&#160;v&#160;in&#160;A&#160;⊆&#160;V&#160;(G).&#160;If&#160;we&#160;deal&#160;with&#160;several&#160;graphs<br/>simultaneously,&#160;we&#160;say&#160;G<i>-neighbour&#160;</i>to&#160;clarify&#160;which&#160;graph&#160;we&#160;refer&#160;to.&#160;As&#160;usual,&#160;δ(G)&#160;and&#160;∆(G)&#160;denote<br/>the&#160;minimum&#160;and&#160;maximum&#160;degree&#160;of&#160;G,&#160;respectively.&#160;For&#160;disjoint&#160;subsets&#160;A,&#160;B&#160;⊆&#160;V&#160;(G),&#160;let&#160;G[A,&#160;B]<br/>denote&#160;the&#160;bipartite&#160;subgraph&#160;of&#160;G&#160;between&#160;A&#160;and&#160;B&#160;and&#160;G[A]&#160;the&#160;subgraph&#160;in&#160;G&#160;induced&#160;by&#160;A.&#160;We&#160;let<br/>G2&#160;denote&#160;the&#160;square&#160;of&#160;G,&#160;i.e.&#160;the&#160;graph&#160;obtained&#160;from&#160;G&#160;by&#160;adding&#160;edges&#160;between&#160;vertices&#160;which&#160;have<br/>a&#160;common&#160;neighbour&#160;in&#160;G.&#160;A&#160;subset&#160;X&#160;⊆&#160;V&#160;(G)&#160;is&#160;2-independent&#160;if&#160;it&#160;is&#160;independent&#160;in&#160;G2.<br/>
Let&#160;G&#160;be&#160;a&#160;graph.&#160;Given&#160;a&#160;set&#160;C,&#160;a&#160;function&#160;c&#160;:&#160;E(G)&#160;→&#160;2C&#160;is&#160;called&#160;an&#160;<i>edge&#160;set&#160;colouring&#160;</i>of&#160;G.<br/>
A&#160;colour&#160;α&#160;∈&#160;C&#160;<i>appears&#160;</i>on&#160;an&#160;edge&#160;e&#160;if&#160;α&#160;∈&#160;c(e).&#160;We&#160;say&#160;that&#160;c&#160;is&#160;k<i>-bounded&#160;</i>if&#160;each&#160;colour&#160;appears<br/>on&#160;at&#160;most&#160;k&#160;edges.&#160;Moreover,&#160;we&#160;say&#160;that&#160;c&#160;is&#160;(k,&#160;∆)<i>-bounded&#160;</i>if&#160;it&#160;is&#160;k-bounded&#160;and&#160;|c(e)|&#160;≤&#160;∆&#160;for<br/>all&#160;e&#160;∈&#160;E(G).&#160;For&#160;C′&#160;⊆&#160;C,&#160;let&#160;GC′&#160;denote&#160;the&#160;subgraph&#160;of&#160;G&#160;with&#160;vertex&#160;set&#160;V&#160;(G)&#160;and&#160;edge&#160;set<br/>{e&#160;∈&#160;E(G)&#160;:&#160;c(e)&#160;⊆&#160;C′}.&#160;We&#160;let&#160;dα&#160;(v)&#160;denote&#160;the&#160;number&#160;of&#160;edges&#160;incident&#160;to&#160;v&#160;on&#160;which&#160;α&#160;appears.<br/>
G<br/>
If&#160;G&#160;is&#160;clear&#160;from&#160;the&#160;context,&#160;we&#160;may&#160;simply&#160;write&#160;dC′(v)&#160;and&#160;dα(v)&#160;instead&#160;of&#160;dG&#160;(v)&#160;and&#160;dα&#160;(v),<br/>
C′<br/>
G<br/>
respectively.<br/>
Given&#160;ε&#160;&gt;&#160;0&#160;and&#160;d&#160;∈&#160;[0,&#160;1],&#160;a&#160;bipartite&#160;graph&#160;G&#160;with&#160;vertex&#160;classes&#160;V1,&#160;V2&#160;is&#160;called&#160;(ε,&#160;d)<i>-regular&#160;</i>if&#160;for<br/>
all&#160;pairs&#160;S&#160;⊆&#160;V1&#160;and&#160;T&#160;⊆&#160;V2&#160;with&#160;|S|&#160;≥&#160;ε|V1|,&#160;|T&#160;|&#160;≥&#160;ε|V2|,&#160;we&#160;have&#160;|dG(S,&#160;T&#160;)&#160;−&#160;d|&#160;≤&#160;ε.&#160;We&#160;simply&#160;say<br/>that&#160;G&#160;is&#160;ε<i>-regular&#160;</i>if&#160;G&#160;is&#160;(ε,&#160;dG(V1,&#160;V2))-regular.&#160;Moreover,&#160;an&#160;(ε,&#160;d)-regular&#160;graph&#160;G&#160;is&#160;called&#160;(ε,&#160;d)<i>-<br/>super-regular&#160;</i>if&#160;for&#160;all&#160;v&#160;∈&#160;V1,&#160;we&#160;have&#160;dG(v)&#160;=&#160;(d&#160;±&#160;ε)|V2|&#160;and&#160;for&#160;all&#160;v&#160;∈&#160;V2&#160;we&#160;have&#160;dG(v)&#160;=&#160;(d&#160;±&#160;ε)|V1|.<br/>Clearly,&#160;if&#160;G&#160;is&#160;(ε,&#160;d)-super-regular,&#160;it&#160;is&#160;also&#160;lower&#160;(ε,&#160;d)-super-regular.<br/>
<br/>
For&#160;a&#160;finite&#160;set&#160;S&#160;and&#160;i&#160;∈&#160;N,&#160;we&#160;write&#160;S&#160;for&#160;the&#160;set&#160;of&#160;all&#160;subsets&#160;of&#160;S&#160;of&#160;size&#160;i&#160;and&#160;2S&#160;for&#160;the<br/>
i<br/>
powerset&#160;of&#160;S.&#160;For&#160;a&#160;set&#160;{i,&#160;j},&#160;we&#160;sometimes&#160;simply&#160;write&#160;ij.&#160;For&#160;a,&#160;b,&#160;c&#160;∈&#160;R,&#160;we&#160;write&#160;a&#160;=&#160;b±c&#160;whenever<br/>a&#160;∈&#160;[b&#160;−&#160;c,&#160;b&#160;+&#160;c].&#160;For&#160;a,&#160;b,&#160;c&#160;∈&#160;(0,&#160;1],&#160;we&#160;sometimes&#160;write&#160;a&#160;≪&#160;b&#160;≪&#160;c&#160;in&#160;our&#160;statements&#160;meaning&#160;that<br/>there&#160;are&#160;increasing&#160;functions&#160;f,&#160;g&#160;:&#160;(0,&#160;1]&#160;→&#160;(0,&#160;1]&#160;such&#160;that&#160;whenever&#160;a&#160;≤&#160;f(b)&#160;and&#160;b&#160;≤&#160;g(c),&#160;then&#160;the<br/>subsequent&#160;result&#160;holds.<br/>
4.&#160;Colour&#160;splitting<br/>
The&#160;goal&#160;of&#160;this&#160;section&#160;is&#160;to&#160;prove&#160;the&#160;following&#160;lemma,&#160;which&#160;will&#160;allow&#160;us&#160;to&#160;reserve&#160;exclusive&#160;colour<br/>
sets&#160;for&#160;our&#160;embedding&#160;rounds&#160;in&#160;the&#160;proof&#160;of&#160;the&#160;rainbow&#160;blow-up&#160;lemma.&#160;Our&#160;main&#160;tools&#160;are&#160;the&#160;partial<br/>resampling&#160;algorithm&#160;introduced&#160;by&#160;Harris&#160;and&#160;Srinivasan&#160;<a href="1802.07700s.html#29">[21]&#160;</a>and&#160;McDiarmid’s&#160;inequality.<br/>
Lemma&#160;4.1.&#160;<i>Let&#160;</i>1/n&#160;≪&#160;µ&#160;≪&#160;1/r,&#160;ε,&#160;1/t,&#160;d,&#160;1/∆<i>.&#160;Suppose&#160;that&#160;</i>G&#160;<i>is&#160;a&#160;graph&#160;with&#160;vertex&#160;partition<br/></i>V&#160;(G)&#160;=&#160;V1&#160;·∪&#160;·&#160;·&#160;·&#160;·∪&#160;Vr&#160;<i>and&#160;</i>RS&#160;⊆&#160;R&#160;<i>are&#160;graphs&#160;on&#160;</i>[r]&#160;<i>such&#160;that</i><br/>
(i)&#160;n&#160;≤&#160;|Vi|&#160;≤&#160;2n&#160;<i>for&#160;all&#160;</i>i&#160;∈&#160;[r]<i>;</i><br/>
(ii)&#160;G[Vi,&#160;Vj]&#160;<i>is&#160;(lower)&#160;</i>(ε,&#160;d)<i>-regular&#160;for&#160;all&#160;</i>ij&#160;∈&#160;E(R)<i>;</i><br/>
(iii)&#160;G[Vi,&#160;Vj]&#160;<i>is&#160;(lower)&#160;</i>(ε,&#160;d)<i>-super-regular&#160;for&#160;all&#160;</i>ij&#160;∈&#160;E(RS)<i>.</i><br/>
<hr/>
<a name=7></a><img class="yflip" src="html/1802.07700-7_1.png"/><br/>
<img class="yflip" src="html/1802.07700-7_2.png"/><br/>
<img class="yflip" src="html/1802.07700-7_3.png"/><br/>
<img class="yflip" src="html/1802.07700-7_4.png"/><br/>
7<br/>
<i>Let&#160;</i>c&#160;:&#160;E(G)&#160;→&#160;2C&#160;<i>be&#160;a&#160;</i>(µn,&#160;∆)<i>-bounded&#160;edge&#160;set&#160;colouring&#160;of&#160;</i>G&#160;<i>with&#160;</i>|C|&#160;≤&#160;µ−1.3n<i>.&#160;Then&#160;there&#160;exists&#160;a<br/>partition&#160;</i>(Cℓ)ℓ∈[t]&#160;<i>of&#160;</i>C&#160;<i>such&#160;that&#160;for&#160;all&#160;</i>ℓ&#160;∈&#160;[t]&#160;<i>and&#160;all&#160;</i>ij&#160;∈&#160;E(R)<i>,&#160;there&#160;is&#160;a&#160;subgraph&#160;</i>Gij<br/>
[V<br/>
ℓ&#160;⊆&#160;GCℓ<br/>
i,&#160;Vj&#160;]<br/>
<i>such&#160;that&#160;</i>Gij&#160;<i>is&#160;(lower)&#160;</i>(2ε,&#160;d/t∆)<i>-regular,&#160;and&#160;(lower)&#160;</i>(2ε,&#160;d/t∆)<i>-super-regular&#160;if&#160;</i>ij<br/>
ℓ<br/>
∈&#160;E(RS)<i>.</i><br/>
We&#160;remark&#160;that&#160;if&#160;c&#160;is&#160;uniform,&#160;i.e.&#160;c(e)&#160;=&#160;∆&#160;for&#160;all&#160;e&#160;∈&#160;E(G),&#160;for&#160;some&#160;∆&#160;∈&#160;N,&#160;then&#160;we&#160;can&#160;take<br/>
Gij&#160;=&#160;G&#160;[V<br/>
ℓ<br/>
Cℓ<br/>
i,&#160;Vj&#160;].&#160;In&#160;particular,&#160;this&#160;applies&#160;if&#160;c&#160;is&#160;a&#160;normal&#160;edge&#160;colouring.&#160;In&#160;the&#160;general&#160;case,&#160;we<br/>
introduce&#160;‘dummy&#160;colours’&#160;to&#160;make&#160;c&#160;uniform.<br/>
In&#160;the&#160;proof&#160;of&#160;Lemma&#160;<a href="1802.07700s.html#6">4.1,&#160;</a>we&#160;will&#160;partition&#160;C&#160;randomly&#160;and&#160;then&#160;show&#160;that&#160;with&#160;positive&#160;probability,<br/>
all&#160;the&#160;obtained&#160;subpairs&#160;are&#160;(super-)regular.&#160;In&#160;order&#160;to&#160;motivate&#160;our&#160;approach,&#160;we&#160;briefly&#160;discuss&#160;the<br/>following&#160;simplified&#160;variant&#160;of&#160;the&#160;problem&#160;(which&#160;will&#160;be&#160;the&#160;running&#160;example&#160;throughout&#160;this&#160;section):<br/>Consider&#160;Kn,n&#160;with&#160;any&#160;µn-bounded&#160;edge&#160;colouring.&#160;If&#160;we&#160;‘activate’&#160;each&#160;colour&#160;independently&#160;with<br/>probability&#160;1/2,&#160;what&#160;is&#160;the&#160;probability&#160;that&#160;the&#160;activated&#160;edges&#160;induce&#160;a&#160;super-regular&#160;pair?&#160;(An&#160;edge<br/>is&#160;activated&#160;if&#160;its&#160;colour&#160;is&#160;activated.)&#160;Using&#160;McDiarmid’s&#160;inequality,&#160;it&#160;is&#160;not&#160;hard&#160;to&#160;see&#160;that&#160;with&#160;high<br/>probability,&#160;the&#160;activated&#160;subgraph&#160;is&#160;indeed&#160;(ε,&#160;1/2)-regular.&#160;We&#160;first&#160;recall&#160;McDiarmid’s&#160;inequality&#160;and<br/>then&#160;prove&#160;a&#160;more&#160;elaborated&#160;version&#160;of&#160;what&#160;we&#160;just&#160;indicated.<br/>
Theorem&#160;4.2&#160;(McDiarmid’s&#160;inequality,&#160;see&#160;<a href="1802.07700s.html#29">[37])</a>.&#160;<i>Suppose&#160;</i>X1,&#160;.&#160;.&#160;.&#160;,&#160;Xm&#160;<i>are&#160;independent&#160;Bernoulli&#160;ran-<br/>dom&#160;variables&#160;and&#160;suppose&#160;</i>w1,&#160;.&#160;.&#160;.&#160;,&#160;wm&#160;∈&#160;[0,&#160;W&#160;]<i>.&#160;Suppose&#160;</i>X&#160;<i>is&#160;a&#160;real-valued&#160;random&#160;variable&#160;determined<br/>by&#160;</i>X1,&#160;.&#160;.&#160;.&#160;,&#160;Xm&#160;<i>such&#160;that&#160;changing&#160;the&#160;outcome&#160;of&#160;</i>Xi&#160;<i>changes&#160;</i>X&#160;<i>by&#160;at&#160;most&#160;</i>wi&#160;<i>for&#160;all&#160;</i>i&#160;∈&#160;[m]<i>.&#160;Then,&#160;for<br/>all&#160;</i>t&#160;&gt;&#160;0<i>,&#160;we&#160;have</i><br/>
−<br/>
2t2<br/>
P<br/>
P&#160;[|X&#160;−&#160;E&#160;[X]&#160;|&#160;≥&#160;t]&#160;≤&#160;2e&#160;W&#160;m&#160;w<br/>
i=1<br/>
i&#160;.<br/>
Proposition&#160;4.3.&#160;<i>Let&#160;</i>1/n&#160;≪&#160;µ&#160;≪&#160;ε,&#160;p,&#160;d,&#160;1/∆<i>.&#160;Suppose&#160;that&#160;</i>G&#160;<i>is&#160;a&#160;(lower)&#160;</i>(ε,&#160;d)<i>-regular&#160;graph&#160;between</i><br/>
<br/>
V,&#160;V&#160;′&#160;<i>with&#160;</i>εn&#160;≤&#160;|V&#160;|,&#160;|V&#160;′|&#160;≤&#160;2n&#160;<i>and&#160;let&#160;</i>c:&#160;E(G)&#160;→&#160;C&#160;<i>be&#160;a&#160;</i>µn<i>-bounded&#160;edge&#160;set&#160;colouring&#160;of&#160;</i>G<i>.&#160;Suppose</i><br/>
∆<br/>
<i>we&#160;choose&#160;a&#160;random&#160;subset&#160;</i>C′&#160;<i>of&#160;</i>C&#160;<i>by&#160;including&#160;every&#160;colour&#160;</i>α&#160;∈&#160;C&#160;<i>independently&#160;with&#160;probability&#160;</i>p<i>.<br/>Then&#160;with&#160;probability&#160;at&#160;least&#160;</i>1&#160;−&#160;e−µ−0.9n<i>,&#160;the&#160;graph&#160;</i>GC′&#160;<i>is&#160;(lower)&#160;</i>(2ε,&#160;p∆d)<i>-regular.</i><br/>
Proof.&#160;We&#160;only&#160;consider&#160;the&#160;case&#160;when&#160;G&#160;is&#160;(ε,&#160;d)-regular.&#160;If&#160;G&#160;is&#160;lower&#160;(ε,&#160;d)-regular,&#160;the&#160;proof&#160;is<br/>similar.&#160;Consider&#160;sets&#160;S&#160;⊆&#160;V&#160;,&#160;T&#160;⊆&#160;V&#160;′&#160;with&#160;|S|&#160;≥&#160;ε|V&#160;|&#160;and&#160;|T&#160;|&#160;≥&#160;ε|V&#160;′|.&#160;Let&#160;X(S,&#160;T&#160;)&#160;=&#160;eG&#160;(S,&#160;T&#160;)&#160;denote<br/>
C′<br/>
the&#160;number&#160;of&#160;edges&#160;e&#160;between&#160;S&#160;and&#160;T&#160;such&#160;that&#160;c(e)&#160;⊆&#160;C′.&#160;Clearly,&#160;E&#160;[X(S,&#160;T&#160;)]&#160;=&#160;p∆eG(S,&#160;T&#160;)&#160;=<br/>p∆d|S||T&#160;|&#160;±&#160;ε|S||T&#160;|.&#160;Moreover,&#160;X(S,&#160;T&#160;)&#160;is&#160;a&#160;random&#160;variable&#160;where&#160;a&#160;single&#160;choice&#160;of&#160;whether&#160;α&#160;∈&#160;C′<br/>changes&#160;X(S,&#160;T&#160;)&#160;by&#160;at&#160;most&#160;µn.&#160;Hence,&#160;by&#160;Theorem&#160;<a href="1802.07700s.html#7">4.2,</a><br/>
P&#160;[|X(S,&#160;T&#160;)&#160;−&#160;E&#160;[X(S,&#160;T&#160;)]&#160;|&#160;&gt;&#160;ε|S||T&#160;|]&#160;≤&#160;2e−&#160;2(ε|S||T|)2<br/>
n<br/>
µn∆e(G)<br/>
≤&#160;2e−&#160;ε10<br/>
2µ∆<br/>
.<br/>
Thus,&#160;a&#160;union&#160;bound&#160;shows&#160;that&#160;the&#160;activated&#160;subgraph&#160;is&#160;not&#160;(2ε,&#160;p∆d)-regular&#160;with&#160;probability&#160;at&#160;most<br/>
24n2e−&#160;ε10&#160;n<br/>
2µ∆<br/>
≤&#160;e−µ−0.9n.<br/>
<br/>
However,&#160;in&#160;order&#160;to&#160;show&#160;that&#160;the&#160;activated&#160;subgraph&#160;is&#160;super-regular,&#160;we&#160;have&#160;to&#160;control&#160;the&#160;degree<br/>
of&#160;every&#160;vertex&#160;as&#160;well.&#160;Whilst&#160;for&#160;sets&#160;S,&#160;T&#160;as&#160;above,&#160;the&#160;activation&#160;or&#160;deactivation&#160;of&#160;one&#160;colour&#160;has&#160;only<br/>a&#160;small&#160;effect,&#160;this&#160;is&#160;very&#160;different&#160;for&#160;the&#160;degree&#160;of&#160;a&#160;single&#160;vertex.&#160;To&#160;appreciate&#160;this&#160;issue,&#160;note&#160;that<br/>there&#160;might&#160;only&#160;be&#160;µ−1&#160;colours&#160;present&#160;at&#160;a&#160;particular&#160;vertex&#160;at&#160;all.&#160;Hence,&#160;if&#160;we&#160;suppose&#160;the&#160;‘activated’<br/>degrees&#160;of&#160;the&#160;vertices&#160;are&#160;mutually&#160;independent,&#160;then&#160;the&#160;probability&#160;that&#160;all&#160;‘activated’&#160;degrees&#160;are&#160;in<br/>the&#160;desired&#160;range&#160;decays&#160;exponentially&#160;with&#160;n.&#160;We&#160;note&#160;that&#160;under&#160;the&#160;additional&#160;assumption&#160;that&#160;the<br/>given&#160;colouring&#160;is&#160;locally&#160;o(n/&#160;log&#160;n)-bounded,&#160;we&#160;could&#160;apply&#160;McDiarmid’s&#160;inequality&#160;for&#160;each&#160;vertex<br/>and&#160;conclude&#160;with&#160;a&#160;union&#160;bound&#160;that&#160;our&#160;desired&#160;properties&#160;hold&#160;with&#160;probability&#160;close&#160;to&#160;1.&#160;We&#160;remark<br/>that&#160;in&#160;<a href="1802.07700s.html#28">[2],&#160;</a>the&#160;authors&#160;considered&#160;a&#160;problem&#160;of&#160;a&#160;similar&#160;kind.&#160;They&#160;prove&#160;that&#160;if&#160;the&#160;colours&#160;of&#160;a&#160;proper<br/>edge&#160;colouring&#160;of&#160;Kn&#160;are&#160;activated&#160;with&#160;probability&#160;1/2,&#160;say,&#160;then&#160;with&#160;high&#160;probability,&#160;the&#160;activated<br/>subgraph&#160;has&#160;very&#160;good&#160;expansion&#160;properties.<br/>
Our&#160;efforts&#160;in&#160;the&#160;rest&#160;of&#160;this&#160;section&#160;focus&#160;on&#160;overcoming&#160;this&#160;local&#160;barrier.&#160;As&#160;a&#160;consequence,&#160;we<br/>
cannot&#160;hope&#160;that&#160;a&#160;random&#160;partition&#160;satisfies&#160;the&#160;desired&#160;properties&#160;with&#160;high&#160;probability.&#160;The&#160;approach<br/>we&#160;pursue&#160;is&#160;motivated&#160;by&#160;the&#160;Lov´asz&#160;local&#160;lemma,&#160;but&#160;the&#160;Lov´asz&#160;local&#160;lemma&#160;itself&#160;does&#160;not&#160;seem<br/>flexible&#160;enough&#160;for&#160;our&#160;purposes.&#160;We&#160;will&#160;discuss&#160;this&#160;in&#160;more&#160;detail&#160;in&#160;the&#160;next&#160;subsection.<br/>
In&#160;order&#160;to&#160;motivate&#160;the&#160;next&#160;result,&#160;which&#160;allows&#160;us&#160;to&#160;split&#160;the&#160;degree&#160;of&#160;each&#160;vertex&#160;evenly&#160;among<br/>
the&#160;colour&#160;sets,&#160;we&#160;note&#160;that&#160;(the&#160;simplified&#160;version&#160;of)&#160;this&#160;problem&#160;can&#160;be&#160;phrased&#160;as&#160;a&#160;‘column-sparse<br/>assignment-packing&#160;problem’.&#160;Let&#160;G&#160;be&#160;a&#160;graph&#160;on&#160;n&#160;vertices&#160;and&#160;c&#160;:&#160;E(G)&#160;→&#160;C&#160;a&#160;µn-bounded&#160;edge<br/>colouring.&#160;Our&#160;aim&#160;is&#160;to&#160;find&#160;a&#160;subset&#160;C′&#160;of&#160;‘activated’&#160;colours&#160;such&#160;that&#160;for&#160;every&#160;vertex&#160;v&#160;∈&#160;V&#160;(G),&#160;we<br/>have&#160;dC′(v)&#160;=&#160;dG(v)/2&#160;±&#160;2µn,&#160;say.&#160;Define&#160;the&#160;matrix&#160;ˆ<br/>
A&#160;whose&#160;rows&#160;are&#160;indexed&#160;by&#160;V&#160;(G)&#160;and&#160;whose<br/>
<hr/>
<a name=8></a><img class="yflip" src="html/1802.07700-8_1.png"/><br/>
<img class="yflip" src="html/1802.07700-8_2.png"/><br/>
<img class="yflip" src="html/1802.07700-8_3.png"/><br/>
<img class="yflip" src="html/1802.07700-8_4.png"/><br/>
<img class="yflip" src="html/1802.07700-8_5.png"/><br/>
8<br/>
S.&#160;GLOCK&#160;AND&#160;F.&#160;JOOS<br/>
columns&#160;are&#160;indexed&#160;by&#160;C,&#160;where&#160;ˆ<br/>
Av,i&#160;:=&#160;di(v)&#160;is&#160;the&#160;number&#160;of&#160;edges&#160;at&#160;v&#160;coloured&#160;i.&#160;Let<br/>
X<br/>
D&#160;:=&#160;max<br/>
di(v)<br/>
i∈C&#160;v∈V&#160;(G)<br/>
denote&#160;the&#160;maximum&#160;column&#160;sum&#160;of&#160;ˆ<br/>
A.&#160;Let&#160;ˆ<br/>
c&#160;denote&#160;the&#160;vector&#160;indexed&#160;by&#160;V&#160;(G)&#160;with&#160;ˆ<br/>
cv&#160;:=&#160;dG(v)/2.<br/>
Define<br/>
<br/>
ˆ&#160;<br/>
<br/>
<br/>
A<br/>
ˆ<br/>
c<br/>
A&#160;:=<br/>
and&#160;c&#160;:=<br/>
.<br/>
−&#160;ˆ<br/>
A<br/>
−ˆc<br/>
Let&#160;x&#160;be&#160;a&#160;vector&#160;indexed&#160;by&#160;C.&#160;Clearly,&#160;the&#160;linear&#160;system&#160;Ax&#160;=&#160;c&#160;has&#160;the&#160;solution&#160;x∗i&#160;=&#160;1/2&#160;for&#160;all<br/>i&#160;∈&#160;C.&#160;The&#160;rounding&#160;theorem&#160;of&#160;Karp&#160;et&#160;al.&#160;<a href="1802.07700s.html#29">[25]&#160;</a>implies&#160;the&#160;existence&#160;of&#160;an&#160;integral&#160;vector&#160;x&#160;such<br/>that&#160;|xi&#160;−&#160;x∗i|&#160;&lt;&#160;1&#160;for&#160;all&#160;i&#160;∈&#160;C&#160;and&#160;such&#160;that&#160;(&#160;ˆ<br/>
Ax)v&#160;=&#160;(&#160;ˆ<br/>
Ax∗)v&#160;±&#160;D&#160;for&#160;all&#160;v&#160;∈&#160;V&#160;(G).&#160;Clearly,&#160;x<br/>
is&#160;a&#160;0/1-vector.&#160;Let&#160;C′&#160;be&#160;the&#160;subset&#160;of&#160;C&#160;which&#160;represents&#160;the&#160;1-coordinates&#160;of&#160;x.&#160;Then&#160;we&#160;have<br/>dC′(v)&#160;=&#160;(&#160;ˆ<br/>
Ax)v&#160;=&#160;ˆcv&#160;±&#160;D&#160;=&#160;dG(v)/2&#160;±&#160;D&#160;for&#160;all&#160;v&#160;∈&#160;V&#160;(G).&#160;Crucially,&#160;since&#160;c&#160;is&#160;µn-bounded,&#160;we&#160;have<br/>
that&#160;D&#160;≤&#160;2µn,&#160;as&#160;desired.<br/>
This&#160;is&#160;good&#160;news&#160;for&#160;our&#160;problem.&#160;However,&#160;in&#160;order&#160;to&#160;prove&#160;Lemma&#160;<a href="1802.07700s.html#6">4.1,&#160;</a>we&#160;need&#160;that&#160;a&#160;random<br/>
partition&#160;of&#160;C&#160;satisfies&#160;the&#160;desired&#160;degree&#160;properties&#160;with&#160;high&#160;enough&#160;probability&#160;so&#160;that&#160;after&#160;applying<br/>Proposition&#160;<a href="1802.07700s.html#7">4.3,&#160;</a>we&#160;can&#160;use&#160;a&#160;union&#160;bound&#160;to&#160;conclude&#160;that&#160;the&#160;sliced&#160;pairs&#160;are&#160;super-regular.&#160;We&#160;will<br/>deal&#160;with&#160;this&#160;in&#160;the&#160;next&#160;two&#160;subsections.&#160;The&#160;following&#160;corollary&#160;is&#160;the&#160;result&#160;of&#160;these&#160;efforts.&#160;With&#160;this<br/>tool&#160;at&#160;hand,&#160;we&#160;can&#160;deduce&#160;that&#160;the&#160;sliced&#160;pairs&#160;do&#160;not&#160;only&#160;inherit&#160;regularity,&#160;but&#160;also&#160;super-regularity,<br/>all&#160;we&#160;need&#160;to&#160;prove&#160;Lemma&#160;<a href="1802.07700s.html#6">4.1.</a><br/>
p<br/>
Corollary&#160;4.4.&#160;<i>Suppose&#160;</i>1/n&#160;≪&#160;µ&#160;≪&#160;1/t,&#160;d,&#160;1/∆,&#160;1/r&#160;<i>and&#160;let&#160;</i>κ&#160;:=&#160;4&#160;t∆d−1µ<i>.&#160;Let&#160;</i>G&#160;<i>be&#160;a&#160;graph&#160;on</i><br/>
<br/>
n&#160;<i>vertices&#160;and&#160;let&#160;</i>c&#160;:&#160;E(G)&#160;→&#160;C&#160;<i>be&#160;</i>µn<i>-bounded.&#160;Suppose&#160;for&#160;every&#160;vertex&#160;</i>v&#160;∈&#160;V&#160;(G)<i>,&#160;we&#160;are&#160;given&#160;a</i><br/>
∆<br/>
<i>partition&#160;</i>Sv1,&#160;.&#160;.&#160;.&#160;,&#160;Svm&#160;<i>of&#160;</i>N<br/>
v<br/>
G(v)&#160;<i>into&#160;at&#160;most&#160;</i>r&#160;<i>sets&#160;of&#160;size&#160;at&#160;least&#160;</i>drn&#160;<i>each.&#160;Suppose&#160;we&#160;split&#160;</i>C&#160;<i>randomly</i><br/>
<i>into&#160;</i>C1,&#160;.&#160;.&#160;.&#160;,&#160;Ct<i>,&#160;by&#160;independently&#160;assigning&#160;</i>α&#160;∈&#160;C&#160;<i>to&#160;</i>Cℓ&#160;<i>with&#160;probability&#160;</i>1/t<i>.&#160;Then&#160;with&#160;probability&#160;at<br/>least&#160;</i>κ&#160;(1&#160;+&#160;κ)−|C|<i>,&#160;the&#160;following&#160;holds:&#160;</i>d&#160;(v,&#160;Sv<br/>
3<br/>
Cℓ<br/>
i&#160;)&#160;=&#160;t−∆|Sv<br/>
i&#160;|&#160;±&#160;(2t)∆κrn&#160;<i>for&#160;all&#160;</i>v&#160;∈&#160;V&#160;(G)<i>,&#160;</i>i&#160;∈&#160;[mv&#160;]<i>,&#160;and</i><br/>
ℓ&#160;∈&#160;[t]<i>.</i><br/>
Proof&#160;of&#160;Lemma&#160;<a href="1802.07700s.html#6">4.1.</a><br/>
We&#160;only&#160;consider&#160;the&#160;case&#160;when&#160;G[Vi,&#160;Vj]&#160;is&#160;in&#160;fact&#160;(ε,&#160;d)-(super)-regular.&#160;If<br/>
G[Vi,&#160;Vj]&#160;is&#160;only&#160;lower&#160;(ε,&#160;d)-(super)-regular,&#160;the&#160;proof&#160;is&#160;similar.&#160;If&#160;2ε&#160;≥&#160;d,&#160;there&#160;is&#160;nothing&#160;to&#160;prove,&#160;so<br/>let&#160;us&#160;assume&#160;that&#160;ε&#160;≤&#160;d/2.<br/>
In&#160;order&#160;to&#160;apply&#160;Proposition&#160;<a href="1802.07700s.html#7">4.3&#160;</a>and&#160;Corollary&#160;<a href="1802.07700s.html#8">4.4,&#160;</a>we&#160;need&#160;the&#160;edge&#160;set&#160;colouring&#160;to&#160;be&#160;uniform.<br/>
We&#160;thus&#160;add&#160;a&#160;set&#160;of&#160;new&#160;‘dummy’&#160;colours&#160;C′&#160;with&#160;|C′|&#160;=&#160;⌈µ−1∆n⌉.&#160;Let<br/>
C∗&#160;:=&#160;C&#160;·∪&#160;C′<br/>
<br/>
be&#160;the&#160;extended&#160;colour&#160;set&#160;and&#160;note&#160;that&#160;|C∗|&#160;≤&#160;2µ−1.3n.&#160;Let&#160;c′&#160;:&#160;E(G)&#160;→&#160;C′&#160;be&#160;any&#160;µn-bounded&#160;edge<br/>
∆<br/>
set&#160;colouring.&#160;Clearly,&#160;c′&#160;exists&#160;since&#160;∆e(G)&#160;≤&#160;|C′|.<br/>
µn<br/>
<br/>
Now,&#160;let&#160;c∗&#160;:&#160;E(G)&#160;→&#160;C∗&#160;be&#160;such&#160;that<br/>
∆<br/>
(4.1)<br/>
c∗(e)&#160;⊆&#160;c(e)&#160;∪&#160;c′(e)&#160;and&#160;c(e)&#160;⊆&#160;c∗(e)&#160;for&#160;all&#160;e&#160;∈&#160;E(G).<br/>
Clearly,&#160;c∗&#160;is&#160;µn-bounded.<br/>
Split&#160;C∗&#160;randomly&#160;into&#160;C∗1,&#160;.&#160;.&#160;.&#160;,&#160;C∗t,&#160;by&#160;independently&#160;assigning&#160;α&#160;∈&#160;C∗&#160;to&#160;C∗&#160;with&#160;probability&#160;1/t.&#160;By<br/>
ℓ<br/>
Proposition&#160;<a href="1802.07700s.html#7">4.3,&#160;</a>we&#160;conclude&#160;that&#160;with&#160;probability&#160;at&#160;least&#160;1&#160;−&#160;tr2e−µ−0.9n,&#160;the&#160;graph&#160;Gij&#160;:=&#160;G&#160;[V<br/>
ℓ<br/>
C∗<br/>
i,&#160;Vj&#160;]<br/>
ℓ<br/>
is&#160;(2ε,&#160;d/t∆)-regular&#160;for&#160;all&#160;ℓ&#160;∈&#160;[t]&#160;and&#160;all&#160;ij&#160;∈&#160;E(R).<br/>
S<br/>
In&#160;order&#160;to&#160;apply&#160;Corollary&#160;<a href="1802.07700s.html#8">4.4,&#160;</a>define&#160;G∗&#160;:=<br/>
G[V<br/>
ij∈E(R<br/>
i,&#160;Vj&#160;].&#160;Consider&#160;i&#160;∈&#160;[r]&#160;and&#160;v&#160;∈&#160;Vi.&#160;For<br/>
S&#160;)<br/>
j&#160;∈&#160;NR&#160;(i),&#160;define&#160;Sv<br/>
S<br/>
j&#160;:=&#160;NG(v)∩Vj&#160;.&#160;Note&#160;that&#160;(Sv<br/>
j&#160;)j∈NR&#160;(i)&#160;partitions&#160;NG∗&#160;(v),&#160;and&#160;that&#160;|Sv<br/>
S<br/>
j&#160;|&#160;=&#160;(d±ε)|Vj&#160;|<br/>
since&#160;G[Vi,&#160;Vj]&#160;is&#160;(ε,&#160;d)-super-regular.&#160;In&#160;particular,&#160;|Svj|&#160;≥&#160;d|Vj|/2.<br/>
By&#160;Corollary&#160;<a href="1802.07700s.html#8">4.4&#160;</a>(with&#160;G∗,&#160;d/4r2&#160;playing&#160;the&#160;roles&#160;of&#160;G,&#160;d),&#160;we&#160;have&#160;with&#160;probability&#160;at&#160;least&#160;µ(1&#160;+<br/>
√µ)−|C∗|&#160;that<br/>
(4.2)<br/>
dG∗&#160;(v,&#160;Vj)&#160;=&#160;t−∆(d&#160;±&#160;ε)|Vj|&#160;±&#160;µ1/3n<br/>
C∗<br/>
ℓ<br/>
for&#160;all&#160;ij&#160;∈&#160;E(RS),&#160;v&#160;∈&#160;Vi,&#160;and&#160;ℓ&#160;∈&#160;[t].<br/>
Since&#160;|C∗|&#160;≤&#160;2µ−1.3n,&#160;we&#160;have<br/>
√<br/>
µ(1&#160;+<br/>
µ)−|C∗|&#160;−&#160;tr2e−µ−0.9n&#160;≥&#160;µe−2µ−0.8n&#160;−&#160;tr2e−µ−0.9n&#160;&gt;&#160;0.<br/>
Therefore,&#160;there&#160;exists&#160;a&#160;partition&#160;(C∗)<br/>
ℓ&#160;ℓ∈[t]&#160;of&#160;C∗&#160;with&#160;the&#160;above&#160;properties.&#160;From&#160;<a href="1802.07700s.html#8">(4.2)</a>,&#160;we&#160;can&#160;infer<br/>
that&#160;Gij&#160;is&#160;(2ε,&#160;d/t∆)-super-regular&#160;for&#160;all&#160;ℓ<br/>
for<br/>
ℓ<br/>
∈&#160;[t]&#160;and&#160;all&#160;ij&#160;∈&#160;E(RS).&#160;Finally,&#160;define&#160;Cℓ&#160;:=&#160;C&#160;∩&#160;C∗ℓ<br/>
<hr/>
<a name=9></a><img class="yflip" src="html/1802.07700-9_1.png"/><br/>
9<br/>
all&#160;ℓ&#160;∈&#160;[t].&#160;Clearly,&#160;(Cℓ)ℓ∈[t]&#160;is&#160;a&#160;partition&#160;of&#160;C,&#160;and&#160;we&#160;have&#160;Gij<br/>
[V<br/>
ℓ&#160;⊆&#160;GCℓ<br/>
i,&#160;Vj&#160;]&#160;by&#160;<a href="1802.07700s.html#8">(4.1)&#160;</a>for&#160;all&#160;ℓ&#160;∈&#160;[t]&#160;and<br/>
all&#160;ij&#160;∈&#160;E(R).<br/>
<br/>
4.1.&#160;The&#160;partial&#160;resampling&#160;algorithm.&#160;The&#160;proof&#160;of&#160;Corollary&#160;<a href="1802.07700s.html#8">4.4&#160;</a>is&#160;based&#160;on&#160;the&#160;partial&#160;resampling<br/>algorithm&#160;introduced&#160;by&#160;Harris&#160;and&#160;Srinivasan,&#160;which&#160;is&#160;a&#160;relative&#160;of&#160;the&#160;Moser-Tardos&#160;resampling<br/>algorithm.&#160;These&#160;algorithms&#160;are&#160;set&#160;in&#160;the&#160;so-called&#160;‘variable&#160;model’&#160;of&#160;the&#160;Lov´asz&#160;local&#160;lemma.&#160;Let<br/>X1,&#160;.&#160;.&#160;.&#160;,&#160;XN&#160;be&#160;independent&#160;random&#160;variables,&#160;and&#160;suppose&#160;we&#160;want&#160;to&#160;avoid&#160;a&#160;set&#160;of&#160;bad&#160;events&#160;B.&#160;For<br/>every&#160;A&#160;∈&#160;B,&#160;let&#160;vbl(A)&#160;be&#160;the&#160;set&#160;of&#160;variables&#160;which&#160;determine&#160;A.&#160;This&#160;naturally&#160;defines&#160;a&#160;dependency<br/>graph&#160;Γ&#160;on&#160;B&#160;as&#160;follows:&#160;AB&#160;∈&#160;E(Γ)&#160;if&#160;vbl(A)∩vbl(B)&#160;6=&#160;∅.&#160;The&#160;(symmetric)&#160;Lov´asz&#160;local&#160;lemma&#160;implies<br/>that&#160;if&#160;each&#160;bad&#160;event&#160;has&#160;probability&#160;at&#160;most&#160;p&#160;and&#160;4p∆(Γ)&#160;≤&#160;1,&#160;then&#160;there&#160;exists&#160;an&#160;assignment&#160;of<br/>the&#160;variables&#160;X1,&#160;.&#160;.&#160;.&#160;,&#160;XN&#160;which&#160;avoids&#160;all&#160;bad&#160;events.&#160;In&#160;their&#160;well-known&#160;paper,&#160;Moser&#160;and&#160;Tardos&#160;<a href="1802.07700s.html#29">[40]<br/></a>provided&#160;an&#160;algorithmic&#160;version&#160;thereof.&#160;Their&#160;so-called&#160;resampling&#160;algorithm&#160;is&#160;as&#160;simple&#160;as&#160;it&#160;could<br/>be:&#160;Start&#160;with&#160;a&#160;random&#160;assignment&#160;of&#160;the&#160;variables&#160;X1,&#160;.&#160;.&#160;.&#160;,&#160;XN&#160;.&#160;As&#160;long&#160;as&#160;some&#160;bad&#160;event&#160;A&#160;∈&#160;B&#160;is<br/>still&#160;true,&#160;resample&#160;all&#160;the&#160;variables&#160;in&#160;vbl(A)&#160;(according&#160;to&#160;their&#160;respective&#160;distribution).&#160;Clearly,&#160;if&#160;the<br/>algorithm&#160;terminates,&#160;then&#160;this&#160;yields&#160;an&#160;assignment&#160;of&#160;the&#160;variables&#160;which&#160;avoids&#160;all&#160;bad&#160;events.&#160;Moser<br/>and&#160;Tardos&#160;showed&#160;that,&#160;under&#160;the&#160;assumptions&#160;of&#160;the&#160;Lov´asz&#160;local&#160;lemma,&#160;the&#160;algorithm&#160;terminates<br/>with&#160;probability&#160;1.<br/>
In&#160;our&#160;(simplified)&#160;setting,&#160;let&#160;Xi&#160;denote&#160;the&#160;Bernoulli&#160;random&#160;variable&#160;indicating&#160;whether&#160;colour<br/>
P<br/>
i&#160;∈&#160;C&#160;is&#160;activated&#160;or&#160;not.&#160;For&#160;each&#160;vertex&#160;v&#160;∈&#160;V&#160;(G),&#160;let&#160;Av&#160;be&#160;the&#160;bad&#160;event&#160;that<br/>
di&#160;(v)<br/>
i∈C<br/>
G<br/>
1{Xi=1}&#160;6=<br/>
√<br/>
dG(v)/2&#160;±&#160;µn,&#160;say.&#160;Note&#160;that&#160;Av&#160;depends&#160;on&#160;all&#160;colours&#160;which&#160;are&#160;present&#160;at&#160;v.&#160;This&#160;may&#160;lead&#160;to&#160;a<br/>very&#160;dense&#160;dependency&#160;graph,&#160;possibly&#160;far&#160;too&#160;dense&#160;to&#160;apply&#160;the&#160;Lov´asz&#160;local&#160;lemma.<br/>
Nonetheless,&#160;a&#160;lot&#160;of&#160;these&#160;dependencies&#160;might&#160;be&#160;very&#160;weak.&#160;For&#160;example,&#160;given&#160;a&#160;vertex&#160;v&#160;and<br/>
colours&#160;i,&#160;j&#160;∈&#160;C,&#160;where&#160;di(v)&#160;is&#160;much&#160;larger&#160;than&#160;dj(v),&#160;the&#160;dependency&#160;of&#160;Av&#160;on&#160;Xi&#160;should&#160;intuitively&#160;be<br/>much&#160;more&#160;significant&#160;than&#160;its&#160;dependency&#160;on&#160;Xj.&#160;A&#160;variant&#160;of&#160;the&#160;resampling&#160;algorithm&#160;of&#160;Moser&#160;and<br/>Tardos&#160;tailored&#160;towards&#160;this&#160;problem&#160;could&#160;thus&#160;vaguely&#160;look&#160;as&#160;follows:&#160;Start&#160;with&#160;a&#160;random&#160;assignment<br/>of&#160;the&#160;variables&#160;(Xi)i∈C&#160;.&#160;As&#160;long&#160;as&#160;some&#160;bad&#160;event&#160;Av&#160;is&#160;still&#160;true,&#160;choose&#160;randomly&#160;a&#160;subset&#160;C′&#160;of<br/>colours,&#160;where&#160;a&#160;colour&#160;is&#160;more&#160;likely&#160;to&#160;be&#160;chosen&#160;if&#160;many&#160;edges&#160;at&#160;v&#160;are&#160;coloured&#160;with&#160;this&#160;colour.&#160;Now<br/>only&#160;resample&#160;(Xi)i∈C′.<br/>
This&#160;‘partial&#160;resampling&#160;algorithm’&#160;falls&#160;into&#160;a&#160;very&#160;general&#160;framework,&#160;which&#160;was&#160;introduced&#160;by&#160;Harris<br/>
and&#160;Srinivasan&#160;<a href="1802.07700s.html#29">[19,&#160;20,&#160;21].&#160;</a>They&#160;eliminated&#160;the&#160;need&#160;of&#160;a&#160;dependency&#160;graph&#160;by&#160;introducing&#160;‘fractional<br/>hitting&#160;sets’&#160;instead,&#160;which&#160;capture&#160;‘how&#160;dependent’&#160;a&#160;bad&#160;event&#160;A&#160;is&#160;on&#160;a&#160;variable&#160;Xi&#160;(or&#160;more&#160;generally,<br/>a&#160;set&#160;of&#160;variables).<br/>
We&#160;now&#160;introduce&#160;this&#160;framework,&#160;following&#160;their&#160;exposition&#160;in&#160;<a href="1802.07700s.html#29">[21].&#160;</a>Let&#160;X1,&#160;.&#160;.&#160;.&#160;,&#160;XN&#160;be&#160;independent<br/>
random&#160;variables,&#160;where&#160;each&#160;Xi&#160;has&#160;a&#160;finite&#160;set&#160;Li&#160;of&#160;possible&#160;assignments.&#160;For&#160;i&#160;∈&#160;[N]&#160;and&#160;j&#160;∈&#160;Li,&#160;let<br/>
P<br/>
pi,j&#160;=&#160;P&#160;[Xi&#160;=&#160;j].&#160;Hence,<br/>
p<br/>
j∈L<br/>
i,j&#160;=&#160;1.&#160;Let&#160;(Ω,&#160;P)&#160;be&#160;the&#160;respective&#160;product&#160;probability&#160;space.<br/>
i<br/>
An&#160;ordered&#160;pair&#160;(i,&#160;j)&#160;with&#160;i&#160;∈&#160;[N]&#160;and&#160;j&#160;∈&#160;Li&#160;is&#160;referred&#160;to&#160;as&#160;an&#160;<i>element</i>,&#160;and&#160;X&#160;denotes&#160;the&#160;set&#160;of&#160;all<br/>
elements.&#160;An&#160;<i>atomic&#160;event&#160;</i>is&#160;a&#160;set&#160;Y&#160;⊆&#160;X&#160;such&#160;that&#160;if&#160;(i,&#160;j),&#160;(i,&#160;j′)&#160;∈&#160;Y&#160;,&#160;then&#160;j&#160;=&#160;j′.&#160;Let&#160;A&#160;denote&#160;the<br/>family&#160;of&#160;all&#160;atomic&#160;events.&#160;A&#160;set&#160;B&#160;⊆&#160;A&#160;is&#160;called&#160;a&#160;<i>complex&#160;event</i>.&#160;An&#160;<i>assignment&#160;</i>is&#160;an&#160;atomic&#160;event&#160;A<br/>such&#160;that&#160;|A|&#160;=&#160;N.&#160;We&#160;say&#160;that&#160;an&#160;assignment&#160;A&#160;<i>avoids&#160;</i>B&#160;⊆&#160;A&#160;if&#160;there&#160;is&#160;no&#160;B&#160;∈&#160;B&#160;with&#160;B&#160;⊆&#160;A.<br/>
These&#160;definitions&#160;naturally&#160;relate&#160;to&#160;the&#160;more&#160;standard&#160;notation&#160;for&#160;events.&#160;For&#160;an&#160;element&#160;ω&#160;=<br/>
(j1,&#160;.&#160;.&#160;.&#160;,&#160;jN&#160;)&#160;of&#160;the&#160;probability&#160;space&#160;Ω,&#160;define&#160;Aω&#160;:=&#160;{(1,&#160;j1),&#160;.&#160;.&#160;.&#160;,&#160;(N,&#160;jN&#160;)}.&#160;Then&#160;Aω&#160;is&#160;an&#160;assignment.<br/>For&#160;an&#160;event&#160;E&#160;⊆&#160;Ω,&#160;define&#160;BE&#160;:=&#160;{Aω&#160;:&#160;ω&#160;∈&#160;E}.&#160;Clearly,&#160;we&#160;have&#160;ω&#160;∈&#160;E&#160;if&#160;and&#160;only&#160;if&#160;Aω&#160;does&#160;not<br/>avoid&#160;BE.&#160;Note&#160;that&#160;our&#160;complex&#160;events&#160;BE&#160;only&#160;contain&#160;assignments.&#160;In&#160;general,&#160;it&#160;is&#160;also&#160;possible&#160;to<br/>deal&#160;with&#160;complex&#160;events&#160;which&#160;contain&#160;atomic&#160;events&#160;A&#160;with&#160;|A|&#160;&lt;&#160;N.<br/>
Given&#160;a&#160;function&#160;λ&#160;:&#160;X&#160;→&#160;R,&#160;we&#160;use&#160;the&#160;following&#160;shorthand&#160;notation:&#160;for&#160;an&#160;element&#160;(i,&#160;j)&#160;∈&#160;X&#160;,&#160;we<br/>
write&#160;λi,j&#160;:=&#160;λ((i,&#160;j)),&#160;and&#160;for&#160;a&#160;set&#160;Y&#160;⊆&#160;X&#160;,&#160;we&#160;writeY<br/>
λY&#160;:=<br/>
λi,j.<br/>
(i,j)∈Y<br/>
For&#160;Y&#160;⊆&#160;X&#160;and&#160;i&#160;∈&#160;[N],&#160;we&#160;write&#160;Y&#160;∼&#160;i&#160;if&#160;there&#160;exists&#160;some&#160;j&#160;∈&#160;Li&#160;such&#160;that&#160;(i,&#160;j)&#160;∈&#160;Y&#160;.<br/>
Definition&#160;4.5&#160;(fractional&#160;hitting&#160;set,&#160;cf.&#160;<a href="1802.07700s.html#29">[21,&#160;</a>Definition&#160;2.1]).&#160;Let&#160;Q&#160;:&#160;A&#160;→&#160;[0,&#160;1].&#160;For&#160;a&#160;set&#160;B&#160;∈&#160;A,&#160;we<br/>say&#160;that&#160;Q&#160;is&#160;a&#160;<i>fractional&#160;hitting&#160;set&#160;for&#160;</i>B&#160;if&#160;Q(∅)&#160;=&#160;0&#160;and<br/>
X&#160;Q(Y&#160;)&#160;≥&#160;1.<br/>
Y&#160;⊆B<br/>
For&#160;a&#160;complex&#160;event&#160;B&#160;⊆&#160;A,&#160;we&#160;say&#160;that&#160;Q&#160;is&#160;a&#160;<i>fractional&#160;hitting&#160;set&#160;for&#160;</i>B&#160;if&#160;it&#160;is&#160;a&#160;fractional&#160;hitting<br/>set&#160;for&#160;all&#160;B&#160;∈&#160;B.&#160;Moreover,&#160;for&#160;an&#160;event&#160;E&#160;⊆&#160;Ω,&#160;we&#160;say&#160;that&#160;Q&#160;is&#160;a&#160;<i>fractional&#160;hitting&#160;set&#160;for&#160;</i>E&#160;if&#160;it&#160;is&#160;a<br/>fractional&#160;hitting&#160;set&#160;for&#160;BE.<br/>
<hr/>
<a name=10></a><img class="yflip" src="html/1802.07700-10_1.png"/><br/>
<img class="yflip" src="html/1802.07700-10_2.png"/><br/>
<img class="yflip" src="html/1802.07700-10_3.png"/><br/>
<img class="yflip" src="html/1802.07700-10_4.png"/><br/>
<img class="yflip" src="html/1802.07700-10_5.png"/><br/>
<img class="yflip" src="html/1802.07700-10_6.png"/><br/>
<img class="yflip" src="html/1802.07700-10_7.png"/><br/>
<img class="yflip" src="html/1802.07700-10_8.png"/><br/>
<img class="yflip" src="html/1802.07700-10_9.png"/><br/>
10<br/>
S.&#160;GLOCK&#160;AND&#160;F.&#160;JOOS<br/>
The&#160;intention&#160;of&#160;this&#160;definition&#160;is&#160;to&#160;offer&#160;a&#160;more&#160;flexible&#160;notion&#160;of&#160;dependency&#160;within&#160;the&#160;framework,<br/>
which&#160;finally&#160;eliminates&#160;the&#160;need&#160;for&#160;a&#160;dependency&#160;graph.&#160;Suppose&#160;we&#160;want&#160;to&#160;find&#160;an&#160;assignment<br/>that&#160;avoids&#160;the&#160;complex&#160;events&#160;B1,&#160;.&#160;.&#160;.&#160;,&#160;BK,&#160;for&#160;which&#160;we&#160;are&#160;given&#160;fractional&#160;hitting&#160;sets&#160;Q1,&#160;.&#160;.&#160;.&#160;,&#160;QK,<br/>respectively.<br/>
The&#160;<i>partial&#160;resampling&#160;algorithm&#160;(PRA)&#160;</i>starts&#160;with&#160;a&#160;random&#160;assignment&#160;of&#160;the&#160;Xi.&#160;Then&#160;it&#160;repeats<br/>
the&#160;following,&#160;as&#160;long&#160;as&#160;some&#160;bad&#160;event&#160;is&#160;true:&#160;choose&#160;any&#160;B&#160;∈&#160;Bk&#160;which&#160;is&#160;true.&#160;Now,&#160;select&#160;randomly<br/>a&#160;set&#160;Y&#160;⊆&#160;B,&#160;where&#160;the&#160;probability&#160;of&#160;selecting&#160;Y&#160;is&#160;given&#160;by<br/>
Qk(Y&#160;)<br/>
P<br/>
.&#160;Then&#160;resample&#160;all&#160;X<br/>
Q<br/>
i&#160;with<br/>
Y&#160;′&#160;⊆B<br/>
k&#160;(Y&#160;′)<br/>
Y&#160;∼&#160;i&#160;(according&#160;to&#160;their&#160;distribution).&#160;Clearly,&#160;if&#160;the&#160;algorithm&#160;terminates,&#160;it&#160;outputs&#160;an&#160;assignment<br/>of&#160;the&#160;Xi&#160;which&#160;avoids&#160;all&#160;bad&#160;events.<br/>
The&#160;next&#160;definition&#160;is&#160;the&#160;final&#160;ingredient&#160;before&#160;we&#160;can&#160;state&#160;the&#160;result&#160;of&#160;Harris&#160;and&#160;Srinivasan.<br/>
Therein,&#160;the&#160;function&#160;λ&#160;may&#160;be&#160;thought&#160;of&#160;as&#160;an&#160;‘inflated’&#160;probability&#160;vector.<br/>
Definition&#160;4.6.&#160;Let&#160;Q&#160;:&#160;A&#160;→&#160;[0,&#160;1]&#160;and&#160;λ:&#160;X&#160;→&#160;[0,&#160;∞).&#160;We&#160;define<br/>
X<br/>
Γ(Q,&#160;λ)&#160;:=<br/>
Q(Y&#160;)λY&#160;,<br/>
Y&#160;∈A<br/>
and&#160;for&#160;each&#160;i&#160;∈&#160;[N],&#160;we&#160;define<br/>
X<br/>
Γi(Q,&#160;λ)&#160;:=<br/>
Q(Y&#160;)λY&#160;.<br/>
Y&#160;∈A&#160;:&#160;Y&#160;∼i<br/>
Theorem&#160;4.7&#160;(Harris&#160;and&#160;Srinivasan&#160;<a href="1802.07700s.html#29">[21,&#160;</a>Theorem&#160;3.8,&#160;see&#160;also&#160;Equation&#160;(10)]).&#160;<i>Let&#160;</i>B1,&#160;.&#160;.&#160;.&#160;,&#160;BK&#160;⊆&#160;A&#160;<i>be<br/>complex&#160;(bad)&#160;events.&#160;Let&#160;</i>λ&#160;:&#160;X&#160;→&#160;[0,&#160;∞)&#160;<i>be&#160;such&#160;that&#160;</i>pi,j&#160;=<br/>
λi,j<br/>
P<br/>
<i>.&#160;Suppose&#160;we&#160;are&#160;given&#160;fractional</i><br/>
λ<br/>
j∈L<br/>
i,j<br/>
i<br/>
<i>hitting&#160;sets&#160;</i>Q1,&#160;.&#160;.&#160;.&#160;,&#160;QK&#160;<i>for&#160;</i>B1,&#160;.&#160;.&#160;.&#160;,&#160;BK<i>,&#160;respectively.&#160;Assume&#160;that&#160;the&#160;following&#160;conditions&#160;are&#160;satisfied:</i><br/>
(i)&#160;<i>for&#160;all&#160;</i>k&#160;∈&#160;[K]<i>,&#160;we&#160;have&#160;</i>Γ(Qk,&#160;λ)&#160;&lt;&#160;1<i>;</i><br/>
P<br/>
P<br/>
(ii)&#160;<i>for&#160;all&#160;</i>i&#160;∈&#160;[N]<i>,&#160;we&#160;have</i><br/>
Γi(Qk,λ)&#160;+&#160;1<br/>
λ<br/>
k∈[K]<br/>
≤<br/>
1−Γ(Q<br/>
i,j&#160;<i>.</i><br/>
k&#160;,λ)<br/>
j∈Li<br/>
P<br/>
<i>Then&#160;the&#160;expected&#160;number&#160;of&#160;resamplings&#160;of&#160;the&#160;PRA&#160;for&#160;these&#160;parameters&#160;is&#160;at&#160;most</i><br/>
λ<br/>
(i,j)∈X<br/>
i,j&#160;<i>.&#160;In</i><br/>
<i>particular,&#160;the&#160;PRA&#160;terminates&#160;with&#160;probability&#160;</i>1<i>.</i><br/>
4.2.&#160;Proof&#160;of&#160;Corollary&#160;<a href="1802.07700s.html#8">4.4.&#160;</a>Theorem&#160;<a href="1802.07700s.html#10">4.7&#160;</a>guarantees&#160;that&#160;there&#160;exists&#160;an&#160;assignment&#160;which&#160;avoids&#160;all<br/>of&#160;B1,&#160;.&#160;.&#160;.&#160;,&#160;BK.&#160;It&#160;does&#160;however&#160;not&#160;state&#160;a&#160;lower&#160;bound&#160;on&#160;the&#160;probability&#160;(in&#160;the&#160;space&#160;(Ω,&#160;P))&#160;that&#160;no<br/>bad&#160;event&#160;happens.&#160;Fortunately,&#160;we&#160;can&#160;deduce&#160;the&#160;following&#160;corollary,&#160;which&#160;yields&#160;such&#160;a&#160;lower&#160;bound.<br/>For&#160;this,&#160;we&#160;use&#160;the&#160;PRA&#160;in&#160;an&#160;indirect&#160;proof.&#160;It&#160;would&#160;be&#160;interesting&#160;to&#160;know&#160;whether&#160;there&#160;exists&#160;an<br/>appropriately&#160;formulated&#160;generalized&#160;Lov´asz&#160;local&#160;lemma&#160;with&#160;a&#160;direct&#160;proof.<br/>
Corollary&#160;4.8.&#160;<i>Let&#160;</i>E1,&#160;.&#160;.&#160;.&#160;,&#160;EK&#160;⊆&#160;Ω&#160;<i>be&#160;(bad)&#160;events.&#160;Let&#160;</i>λ:&#160;X&#160;→&#160;[0,&#160;∞)&#160;<i>be&#160;defined&#160;as&#160;</i>λi,j&#160;:=&#160;(1&#160;+&#160;κ)pi,j<i>,<br/>where&#160;</i>κ&#160;∈&#160;(0,&#160;1)<i>.&#160;Suppose&#160;there&#160;are&#160;fractional&#160;hitting&#160;sets&#160;</i>Q1,&#160;.&#160;.&#160;.&#160;,&#160;QK&#160;<i>for&#160;</i>E1,&#160;.&#160;.&#160;.&#160;,&#160;EK<i>,&#160;respectively,&#160;which<br/>satisfy&#160;the&#160;following&#160;conditions:</i><br/>
(i)&#160;<i>for&#160;all&#160;</i>k&#160;∈&#160;[K]<i>,&#160;we&#160;have&#160;</i>Γ(Qk,&#160;λ)&#160;&lt;&#160;1<i>;</i><br/>
P<br/>
(ii)&#160;<i>for&#160;all&#160;</i>i&#160;∈&#160;[N]<i>,&#160;we&#160;have</i><br/>
Γi(Qk,λ)<br/>
k∈[K]<br/>
≤&#160;κ/2<i>.</i><br/>
1−Γ(Qk,λ)<br/>
hT<br/>
i<br/>
<i>Then&#160;</i>P<br/>
(1&#160;+&#160;κ)−N&#160;<i>.</i><br/>
k∈[K]&#160;Ek<br/>
≥&#160;κ3<br/>
P<br/>
P<br/>
Q<br/>
Proof.&#160;For&#160;any&#160;event&#160;E&#160;⊆&#160;Ω,&#160;we&#160;have&#160;that&#160;P&#160;[E]&#160;=<br/>
P&#160;[<br/>
p<br/>
ω∈E<br/>
{ω}]&#160;=<br/>
ω∈E<br/>
(i,j)∈A<br/>
i,j&#160;.&#160;Therefore,<br/>
ω<br/>
<br/>
<br/>
\<br/>
X<br/>
Y<br/>
P<br/>
(4.3)<br/>
<br/>
E&#160;<br/>
k<br/>
=&#160;P&#160;[E∗]&#160;=<br/>
pi,j,<br/>
k∈[K]<br/>
A∈B∗&#160;(i,j)∈A<br/>
S<br/>
S<br/>
where&#160;E∗&#160;:=&#160;Ω&#160;\<br/>
for&#160;all&#160;k<br/>
k∈[K]&#160;Ek,&#160;B∗&#160;:=&#160;BE∗&#160;,&#160;and&#160;Bk&#160;:=&#160;BE<br/>
∈&#160;[K].&#160;Observe&#160;that<br/>
k<br/>
k∈[K]∪{∗}&#160;Bk&#160;=&#160;BΩ<br/>
and&#160;hence&#160;there&#160;is&#160;no&#160;assignment&#160;which&#160;avoids&#160;all&#160;of&#160;B1,&#160;.&#160;.&#160;.&#160;,&#160;BK,&#160;B∗.<br/>
Suppose,&#160;for&#160;a&#160;contradiction,&#160;that&#160;P&#160;[E∗]&#160;≤&#160;p∗&#160;:=&#160;κ&#160;(1&#160;+&#160;κ)−N&#160;.&#160;Let&#160;Q<br/>
3<br/>
∗&#160;:&#160;A&#160;→&#160;[0,&#160;1]&#160;be&#160;the&#160;trivial<br/>
fractional&#160;hitting&#160;set&#160;for&#160;B∗,&#160;that&#160;is&#160;Q∗(Y&#160;)&#160;:=&#160;1&#160;if&#160;Y&#160;∈&#160;B∗&#160;and&#160;Q∗(Y&#160;)&#160;:=&#160;0&#160;otherwise.&#160;We&#160;emphasize&#160;that<br/>B∗&#160;only&#160;contains&#160;assignments&#160;and&#160;hence<br/>
X<br/>
X<br/>
Y<br/>
<a href="1802.07700s.html#10">(4.3)</a><br/>
(4.4)<br/>
Γ(Q∗,&#160;λ)&#160;=<br/>
λY&#160;=<br/>
(1&#160;+&#160;κ)pi,j&#160;=&#160;(1&#160;+&#160;κ)N&#160;P&#160;[E∗]&#160;≤&#160;p∗(1&#160;+&#160;κ)N&#160;=&#160;κ/3.<br/>
Y&#160;∈B∗<br/>
Y&#160;∈B∗&#160;(i,j)∈Y<br/>
Trivially,&#160;for&#160;all&#160;i&#160;∈&#160;[N],&#160;we&#160;have&#160;Γi(Q∗,&#160;λ)&#160;≤&#160;Γ(Q∗,&#160;λ)&#160;≤&#160;κ/3,&#160;which&#160;implies&#160;Γi(Q∗,λ)<br/>
1−Γ(Q∗,λ)&#160;≤&#160;κ/2.&#160;We&#160;now<br/>
apply&#160;Theorem&#160;<a href="1802.07700s.html#10">4.7&#160;</a>to&#160;the&#160;complex&#160;events&#160;B1,&#160;.&#160;.&#160;.&#160;,&#160;BK,&#160;B∗&#160;with&#160;fractional&#160;hitting&#160;sets&#160;Q1,&#160;.&#160;.&#160;.&#160;,&#160;QK,&#160;Q∗,<br/>
<hr/>
<a name=11></a><img class="yflip" src="html/1802.07700-11_1.png"/><br/>
<img class="yflip" src="html/1802.07700-11_2.png"/><br/>
<img class="yflip" src="html/1802.07700-11_3.png"/><br/>
<img class="yflip" src="html/1802.07700-11_4.png"/><br/>
<img class="yflip" src="html/1802.07700-11_5.png"/><br/>
<img class="yflip" src="html/1802.07700-11_6.png"/><br/>
<img class="yflip" src="html/1802.07700-11_7.png"/><br/>
11<br/>
respectively.&#160;For&#160;all&#160;k&#160;∈&#160;[K]&#160;∪&#160;{∗},&#160;we&#160;have&#160;Γ(Qk,&#160;λ)&#160;&lt;&#160;1&#160;by&#160;(i)&#160;and&#160;<a href="1802.07700s.html#10">(4.4)</a>.&#160;Moreover,&#160;for&#160;all&#160;i&#160;∈&#160;[N],&#160;we<br/>have<br/>
X<br/>
Γ<br/>
X<br/>
i(Qk,&#160;λ)<br/>
+&#160;1&#160;≤&#160;κ/2&#160;+&#160;κ/2&#160;+&#160;1&#160;=&#160;κ&#160;+&#160;1&#160;=<br/>
λ<br/>
1&#160;−&#160;Γ(Q<br/>
i,j&#160;.<br/>
k,&#160;λ)<br/>
k∈[K]∪{∗}<br/>
j∈[t]<br/>
Thus,&#160;by&#160;Theorem&#160;<a href="1802.07700s.html#10">4.7,&#160;</a>there&#160;exists&#160;an&#160;assignment&#160;A&#160;⊆&#160;X&#160;which&#160;avoids&#160;all&#160;of&#160;B1,&#160;.&#160;.&#160;.&#160;,&#160;BK,&#160;B∗.&#160;This&#160;clearly<br/>is&#160;a&#160;contradiction,&#160;which&#160;completes&#160;the&#160;proof.<br/>
<br/>
We&#160;now&#160;use&#160;Corollary&#160;<a href="1802.07700s.html#10">4.8&#160;</a>to&#160;prove&#160;Corollary&#160;<a href="1802.07700s.html#8">4.4.&#160;</a>To&#160;this&#160;end,&#160;we&#160;need&#160;to&#160;introduce&#160;some&#160;more<br/>
notation.<br/>
P<br/>
Let&#160;St&#160;:=<br/>
t<br/>
s<br/>
∆<br/>
{(s1,&#160;.&#160;.&#160;.&#160;,&#160;st)&#160;:<br/>
j=1&#160;j&#160;=&#160;∆,&#160;sj&#160;∈&#160;N0}&#160;denote&#160;the&#160;t-dimensional&#160;discrete&#160;simplex.<br/>
For<br/>
<br/>
s&#160;=&#160;(s1,&#160;.&#160;.&#160;.&#160;,&#160;st)&#160;∈&#160;St&#160;,&#160;let&#160;∆&#160;:=<br/>
∆!<br/>
denote&#160;the&#160;multinomial&#160;coefficient.&#160;Recall&#160;that<br/>
∆<br/>
s<br/>
s1!···st!<br/>
X&#160;&#160;<br/>
∆<br/>
(4.5)<br/>
=&#160;t∆.<br/>
s<br/>
s∈S&#160;t<br/>
∆<br/>
<br/>
Let&#160;G&#160;be&#160;a&#160;graph,&#160;c&#160;:&#160;E(G)&#160;→&#160;C&#160;and&#160;suppose&#160;that&#160;C<br/>
∆<br/>
1,&#160;.&#160;.&#160;.&#160;,&#160;Ct&#160;is&#160;a&#160;(random)&#160;partition&#160;of&#160;C.&#160;For<br/>
a&#160;vertex&#160;v&#160;and&#160;s&#160;=&#160;(s1,&#160;.&#160;.&#160;.&#160;,&#160;st)&#160;∈&#160;St∆,&#160;let&#160;ds,v&#160;be&#160;the&#160;(random)&#160;number&#160;of&#160;edges&#160;e&#160;incident&#160;to&#160;v&#160;with<br/>
|c(e)&#160;∩&#160;Cj|&#160;=&#160;sj&#160;for&#160;all&#160;j&#160;∈&#160;[t].&#160;For&#160;instance,&#160;for&#160;s&#160;=&#160;(∆,&#160;0,&#160;.&#160;.&#160;.&#160;,&#160;0),&#160;we&#160;have&#160;d<br/>
(v).&#160;Observe&#160;that<br/>
s,v&#160;=&#160;dGC1<br/>
<br/>
if&#160;each&#160;i&#160;∈&#160;C&#160;is&#160;independently&#160;assigned&#160;to&#160;Cj&#160;with&#160;probability&#160;1/t,&#160;then&#160;E&#160;[d<br/>
t−∆d<br/>
s,v&#160;]&#160;=<br/>
∆<br/>
G(v).<br/>
s<br/>
p<br/>
Lemma&#160;4.9.&#160;<i>Suppose&#160;</i>1/n&#160;≪&#160;µ&#160;≪&#160;1/t,&#160;d,&#160;1/∆&#160;<i>and&#160;let&#160;</i>κ&#160;:=&#160;4&#160;t∆d−1µ<i>.&#160;Let&#160;</i>G&#160;<i>be&#160;a&#160;graph&#160;on&#160;</i>n&#160;<i>vertices</i><br/>
<br/>
<i>with&#160;</i>δ(G)&#160;≥&#160;dn<i>,&#160;and&#160;let&#160;</i>c:&#160;E(G)&#160;→&#160;C&#160;<i>be&#160;</i>µn<i>-bounded.&#160;Suppose&#160;we&#160;split&#160;</i>C&#160;<i>randomly&#160;into&#160;</i>C<br/>
∆<br/>
1,&#160;.&#160;.&#160;.&#160;,&#160;Ct<i>,</i><br/>
<i>by&#160;independently&#160;assigning&#160;</i>i&#160;∈&#160;C&#160;<i>to&#160;</i>Cj&#160;<i>with&#160;probability&#160;</i>1/t<i>.&#160;Then&#160;with&#160;probability&#160;at&#160;least&#160;</i>κ&#160;(1&#160;+&#160;κ)−|C|<i>,</i><br/>
3<br/>
<i>the&#160;following&#160;holds:</i><br/>
&#160;<br/>
∆<br/>
d<br/>
t−∆d<br/>
s,v&#160;=<br/>
G(v)&#160;±&#160;(2t)∆κn<br/>
s<br/>
<i>for&#160;all&#160;</i>v&#160;∈&#160;V&#160;(G)&#160;<i>and&#160;</i>s&#160;∈&#160;St&#160;<i>.</i><br/>
∆<br/>
We&#160;remark&#160;that&#160;for&#160;any&#160;1&#160;≤&#160;K&#160;≤&#160;2−∆κ−1,&#160;the&#160;above&#160;probability&#160;bound&#160;can&#160;be&#160;improved&#160;to&#160;κ&#160;(1&#160;+<br/>
3K<br/>
κ/K)−|C|&#160;on&#160;the&#160;expense&#160;of&#160;an&#160;extra&#160;factor&#160;K&#160;in&#160;the&#160;degree&#160;error&#160;term,&#160;with&#160;the&#160;same&#160;proof.<br/>
Proof.<br/>
We&#160;may&#160;assume&#160;that&#160;C&#160;=&#160;[N&#160;].&#160;Let&#160;X1,&#160;.&#160;.&#160;.&#160;,&#160;XN&#160;be&#160;independent&#160;random&#160;variables&#160;taking<br/>
values&#160;in&#160;[t]&#160;uniformly&#160;at&#160;random.&#160;(Hence,&#160;the&#160;probability&#160;space&#160;is&#160;Ω&#160;=&#160;[t]N&#160;and&#160;the&#160;set&#160;of&#160;elements&#160;is<br/>X&#160;=&#160;[N]&#160;×&#160;[t].)&#160;For&#160;j&#160;∈&#160;[t],&#160;define&#160;the&#160;random&#160;sets&#160;Cj&#160;:=&#160;{i&#160;∈&#160;[N]&#160;:&#160;Xi&#160;=&#160;j}.&#160;Thus,&#160;the&#160;Cj&#160;are&#160;as&#160;in&#160;the<br/>statement&#160;of&#160;the&#160;lemma.<br/>
For&#160;every&#160;vertex&#160;v&#160;∈&#160;V&#160;(G)&#160;and&#160;every&#160;s&#160;∈&#160;St&#160;,&#160;we&#160;define<br/>
as&#160;the&#160;(bad)&#160;event&#160;that&#160;d<br/>
∆<br/>
Ev,s<br/>
s,v<br/>
≥<br/>
<br/>
∆&#160;t−∆dG(v)&#160;+&#160;2∆κn.&#160;We&#160;will&#160;show&#160;that<br/>
s<br/>
<br/>
<br/>
\<br/>
κ<br/>
P<br/>
(4.6)<br/>
<br/>
Ev,&#160;&#160;≥&#160;(1&#160;+&#160;κ)−N&#160;.<br/>
s<br/>
3<br/>
v∈V&#160;(G),s∈St∆<br/>
<br/>
Observe&#160;that&#160;<a href="1802.07700s.html#11">(4.6)&#160;</a>would&#160;complete&#160;the&#160;proof:&#160;if&#160;no&#160;bad&#160;event&#160;Ev,&#160;happens,&#160;we&#160;have&#160;d<br/>
t−∆d<br/>
s<br/>
s,v&#160;≤<br/>
∆<br/>
G(v)+<br/>
s<br/>
2∆κn&#160;for&#160;every&#160;vertex&#160;v&#160;∈&#160;V&#160;(G)&#160;and&#160;every&#160;s&#160;∈&#160;St&#160;.&#160;We&#160;can&#160;then&#160;use&#160;<a href="1802.07700s.html#11">(4.5)&#160;</a>to&#160;also&#160;establish&#160;the&#160;lower<br/>
∆<br/>
bound<br/>
<br/>
<br/>
X<br/>
X<br/>
&#160;<br/>
∆<br/>
d<br/>
d&#160;′<br/>
1&#160;−<br/>
t−∆&#160;d<br/>
s,v&#160;=&#160;dG&#160;(v)&#160;−<br/>
s&#160;,v&#160;≥<br/>
G(v)&#160;−&#160;2∆(|St<br/>
s′<br/>
∆|&#160;−&#160;1)κn<br/>
′<br/>
′<br/>
s&#160;∈S&#160;t&#160;\{s}<br/>
s&#160;∈S&#160;t&#160;\{s}<br/>
∆<br/>
∆<br/>
&#160;<br/>
∆<br/>
≥<br/>
t−∆dG(v)&#160;−&#160;(2t)∆κn.<br/>
s<br/>
We&#160;will&#160;obtain&#160;<a href="1802.07700s.html#11">(4.6)&#160;</a>by&#160;applying&#160;Corollary&#160;<a href="1802.07700s.html#10">4.8.&#160;</a>To&#160;this&#160;end,&#160;we&#160;first&#160;define&#160;fractional&#160;hitting&#160;sets&#160;for&#160;our<br/>bad&#160;events.<br/>
<i>Step&#160;</i>1<i>:&#160;Defining&#160;fractional&#160;hitting&#160;sets</i><br/>
<br/>
Fix&#160;v&#160;∈&#160;V&#160;(G)&#160;and&#160;s&#160;∈&#160;St&#160;throughout&#160;Step&#160;1.&#160;For&#160;I<br/>
,&#160;let&#160;d<br/>
∆<br/>
∈&#160;[N]<br/>
∆<br/>
I&#160;(v)&#160;denote&#160;the&#160;number&#160;of&#160;edges<br/>
e&#160;incident&#160;to&#160;v&#160;with&#160;c(e)&#160;=&#160;I.&#160;We&#160;say&#160;that&#160;Y&#160;∈&#160;A&#160;is&#160;of&#160;type&#160;(I,&#160;s)&#160;if&#160;Y&#160;=&#160;{(i1,&#160;j1),&#160;.&#160;.&#160;.&#160;,&#160;(i∆,&#160;j∆)}&#160;with<br/>{i1,&#160;.&#160;.&#160;.&#160;,&#160;i∆}&#160;=&#160;I&#160;and&#160;for&#160;each&#160;j&#160;∈&#160;[t],&#160;the&#160;number&#160;of&#160;indices&#160;k&#160;∈&#160;[∆]&#160;with&#160;jk&#160;=&#160;j&#160;is&#160;equal&#160;to&#160;sj.&#160;Let&#160;T&#160;(I,&#160;s)<br/>denote&#160;the&#160;set&#160;of&#160;all&#160;Y&#160;∈&#160;A&#160;of&#160;type&#160;(I,&#160;s).&#160;This&#160;means&#160;that&#160;the&#160;edges&#160;e&#160;at&#160;v&#160;with&#160;c(e)&#160;=&#160;I&#160;contribute&#160;to<br/>
<hr/>
<a name=12></a><img class="yflip" src="html/1802.07700-12_1.png"/><br/>
<img class="yflip" src="html/1802.07700-12_2.png"/><br/>
<img class="yflip" src="html/1802.07700-12_3.png"/><br/>
<img class="yflip" src="html/1802.07700-12_4.png"/><br/>
<img class="yflip" src="html/1802.07700-12_5.png"/><br/>
<img class="yflip" src="html/1802.07700-12_6.png"/><br/>
<img class="yflip" src="html/1802.07700-12_7.png"/><br/>
<img class="yflip" src="html/1802.07700-12_8.png"/><br/>
<img class="yflip" src="html/1802.07700-12_9.png"/><br/>
<img class="yflip" src="html/1802.07700-12_10.png"/><br/>
<img class="yflip" src="html/1802.07700-12_11.png"/><br/>
12<br/>
S.&#160;GLOCK&#160;AND&#160;F.&#160;JOOS<br/>
the&#160;value&#160;of&#160;the&#160;random&#160;variable&#160;ds,v&#160;if&#160;and&#160;only&#160;if&#160;Y&#160;is&#160;a&#160;subset&#160;of&#160;the&#160;assignment&#160;given&#160;by&#160;the&#160;outcome<br/>of&#160;X1,&#160;.&#160;.&#160;.&#160;,&#160;XN&#160;.&#160;More&#160;formally,&#160;given&#160;an&#160;assignment&#160;A,&#160;we&#160;have<br/>
X<br/>
(4.7)<br/>
dI&#160;(v)&#160;=&#160;ds,v(A),<br/>
I∈([N]),Y&#160;∈T&#160;(I,s)&#160;:&#160;Y&#160;⊆A<br/>
∆<br/>
where&#160;ds,v(A)&#160;refers&#160;to&#160;the&#160;value&#160;of&#160;ds,v&#160;if&#160;X1,&#160;.&#160;.&#160;.&#160;,&#160;XN&#160;have&#160;outcome&#160;A.<br/>
Observe&#160;that<br/>
&#160;<br/>
∆<br/>
(4.8)<br/>
|T&#160;(I,&#160;s)|&#160;=<br/>
.<br/>
s<br/>
We&#160;make&#160;another&#160;remark&#160;for&#160;later&#160;use.&#160;We&#160;have<br/>
X<br/>
&#160;<br/>
&#160;<br/>
<a href="1802.07700s.html#12">(4.8)</a><br/>
X<br/>
∆<br/>
∆<br/>
(4.9)<br/>
dI(v)&#160;=<br/>
dI&#160;(v)&#160;=<br/>
dG(v).<br/>
s<br/>
s<br/>
I∈([N]),Y&#160;∈T&#160;(I,s)<br/>
I∈([N])<br/>
∆<br/>
∆<br/>
<br/>
Next&#160;we&#160;define&#160;a&#160;fractional&#160;hitting&#160;set&#160;Qv,&#160;for&#160;the&#160;event&#160;E&#160;.&#160;Define&#160;Q<br/>
:&#160;A&#160;→&#160;[0,&#160;∞)&#160;for&#160;all&#160;I&#160;∈&#160;[N]<br/>
s<br/>
v,s<br/>
v,s<br/>
∆<br/>
and&#160;all&#160;Y&#160;∈&#160;T&#160;(I,&#160;s)&#160;as<br/>
d<br/>
(4.10)<br/>
Q<br/>
I&#160;(v)<br/>
v,&#160;(Y&#160;)&#160;:=<br/>
s<br/>
<br/>
∆&#160;t−∆dG(v)&#160;+&#160;2∆κn<br/>
s<br/>
and&#160;set&#160;Qv,&#160;(Y&#160;)&#160;:=&#160;0&#160;for&#160;all&#160;other&#160;Y&#160;∈&#160;A.&#160;We&#160;claim&#160;that&#160;Q<br/>
is&#160;indeed&#160;a&#160;fractional&#160;hitting&#160;set&#160;for&#160;E&#160;.<br/>
s<br/>
v,s<br/>
v,s<br/>
Recall&#160;that&#160;Bv,&#160;is&#160;the&#160;corresponding&#160;set&#160;of&#160;assignments.&#160;Hence&#160;we&#160;need&#160;to&#160;check&#160;that&#160;Q<br/>
is&#160;a&#160;fractional<br/>
s<br/>
v,s<br/>
hitting&#160;set&#160;for&#160;all&#160;assignments&#160;A&#160;∈&#160;Bv,&#160;.<br/>
s<br/>
Consider&#160;first&#160;any&#160;assignment&#160;A.&#160;Then<br/>
X<br/>
X<br/>
<a href="1802.07700s.html#12">(4.7)</a>,<a href="1802.07700s.html#12">(4.10)</a><br/>
d<br/>
Q<br/>
s,v&#160;(A)<br/>
v,&#160;(Y&#160;)&#160;=<br/>
Q<br/>
(Y&#160;)<br/>
=<br/>
.<br/>
s<br/>
v,s<br/>
<br/>
∆&#160;t−∆d<br/>
Y&#160;⊆A<br/>
G(v)&#160;+&#160;2∆κn<br/>
I∈([N]),Y&#160;∈T&#160;(I,<br/>
s<br/>
s)&#160;:&#160;Y&#160;⊆A<br/>
∆<br/>
<br/>
Since&#160;d<br/>
t−∆d<br/>
by&#160;definition&#160;of&#160;E&#160;,&#160;we&#160;conclude&#160;that&#160;for&#160;any<br/>
s,v&#160;(A)&#160;≥<br/>
∆<br/>
G(v)&#160;+&#160;2∆κn&#160;for&#160;all&#160;A&#160;∈&#160;Bv,s<br/>
v,s<br/>
s&#160;P<br/>
A&#160;∈&#160;BE&#160;,&#160;we&#160;have<br/>
Q<br/>
(Y&#160;)&#160;≥&#160;1,&#160;as&#160;required.<br/>
v,<br/>
v,s<br/>
s<br/>
Y&#160;⊆A<br/>
<i>Step&#160;</i>2<i>:&#160;Verification&#160;of&#160;the&#160;conditions&#160;in&#160;Corollary&#160;4.8</i><br/>
Now,&#160;define&#160;λ&#160;:&#160;X&#160;→&#160;[0,&#160;∞)&#160;as&#160;λi,j&#160;:=&#160;(1&#160;+&#160;κ)/t&#160;for&#160;all&#160;(i,&#160;j)&#160;∈&#160;X&#160;.&#160;We&#160;need&#160;to&#160;check&#160;conditions&#160;(i)<br/>
and&#160;(ii)&#160;from&#160;Corollary&#160;<a href="1802.07700s.html#10">4.8.&#160;</a>In&#160;order&#160;to&#160;check&#160;(i),&#160;consider&#160;v&#160;∈&#160;V&#160;(G)&#160;and&#160;s&#160;∈&#160;St&#160;.&#160;We&#160;have<br/>
∆<br/>
X<br/>
X<br/>
<br/>
<br/>
1&#160;+&#160;κ&#160;∆<br/>
Γ(Qv,&#160;,&#160;λ)<br/>
=<br/>
Q<br/>
(Y&#160;)λY&#160;=<br/>
Q<br/>
(Y&#160;)<br/>
s<br/>
v,s<br/>
v,s<br/>
t<br/>
Y&#160;∈A<br/>
I∈([N]),Y&#160;∈T&#160;(I,s)<br/>
∆<br/>
<br/>
∆<br/>
<br/>
∆<br/>
<a href="1802.07700s.html#12">(4.9)</a>,<a href="1802.07700s.html#12">(4.10)</a><br/>
1&#160;+&#160;κ<br/>
dG(v)<br/>
=<br/>
·<br/>
s<br/>
<br/>
t<br/>
∆&#160;t−∆dG(v)&#160;+&#160;2∆κn<br/>
s<br/>
(1&#160;+&#160;κ)∆<br/>
1&#160;+&#160;(2∆&#160;−&#160;1)κ<br/>
κ<br/>
≤<br/>
≤<br/>
=&#160;1&#160;−<br/>
1&#160;+&#160;2∆κ<br/>
1&#160;+&#160;2∆κ<br/>
1&#160;+&#160;2∆κ<br/>
and&#160;thus&#160;(as&#160;2∆κ&#160;≤&#160;1)<br/>(4.11)<br/>
Γ(Qv,&#160;,&#160;λ)&#160;≤&#160;1&#160;−&#160;κ/2&#160;&lt;&#160;1.<br/>
s<br/>
We&#160;now&#160;check&#160;(ii).&#160;Consider&#160;i&#160;∈&#160;[N].&#160;First&#160;observe&#160;that&#160;for&#160;any&#160;v&#160;∈&#160;V&#160;(G),&#160;s&#160;∈&#160;St&#160;,&#160;we&#160;have<br/>
∆<br/>
X<br/>
X<br/>
<br/>
<br/>
1&#160;+&#160;κ&#160;∆<br/>
(4.12)<br/>
Γi(Qv,&#160;,&#160;λ)&#160;=<br/>
Q<br/>
(Y&#160;)λY&#160;=<br/>
Q<br/>
(Y&#160;)<br/>
.<br/>
s<br/>
v,s<br/>
v,s<br/>
t<br/>
Y&#160;∈A&#160;:&#160;Y&#160;∼i<br/>
I∈([N]),Y&#160;∈T&#160;(I,s)&#160;:&#160;I∋i<br/>
∆<br/>
Crucially,&#160;we&#160;have&#160;for&#160;all&#160;i&#160;∈&#160;[N]<br/>
X<br/>
X<br/>
(4.13)<br/>
dI(v)&#160;≤&#160;2µn<br/>
v∈V&#160;(G)&#160;I∈([N]):&#160;I∋i<br/>
∆<br/>
since&#160;c&#160;is&#160;µn-bounded&#160;and&#160;every&#160;edge&#160;e&#160;∈&#160;E(G)&#160;with&#160;i&#160;∈&#160;c(e)&#160;is&#160;counted&#160;twice&#160;on&#160;the&#160;left&#160;hand&#160;side.<br/>Therefore,&#160;for&#160;any&#160;s&#160;∈&#160;St&#160;,&#160;we&#160;have<br/>
∆<br/>
<br/>
X<br/>
X<br/>
<a href="1802.07700s.html#12">(4.8)</a>,<a href="1802.07700s.html#12">(4.10)</a>,<a href="1802.07700s.html#12">(4.13)</a><br/>
∆&#160;·&#160;2µn<br/>
Q<br/>
s<br/>
v,&#160;(Y&#160;)<br/>
≤<br/>
≤&#160;t∆&#160;2µ&#160;.<br/>
s<br/>
<br/>
∆&#160;t−∆d<br/>
d<br/>
v∈V&#160;(G)<br/>
G(v)&#160;+&#160;2∆κn<br/>
I∈([N]),Y&#160;∈T&#160;(I,<br/>
s<br/>
s)&#160;:&#160;I&#160;∋i<br/>
∆<br/>
<hr/>
<a name=13></a><img class="yflip" src="html/1802.07700-13_1.png"/><br/>
<img class="yflip" src="html/1802.07700-13_2.png"/><br/>
<img class="yflip" src="html/1802.07700-13_3.png"/><br/>
<img class="yflip" src="html/1802.07700-13_4.png"/><br/>
<img class="yflip" src="html/1802.07700-13_5.png"/><br/>
<img class="yflip" src="html/1802.07700-13_6.png"/><br/>
<img class="yflip" src="html/1802.07700-13_7.png"/><br/>
13<br/>
Using&#160;<a href="1802.07700s.html#11">(4.5)&#160;</a>and&#160;<a href="1802.07700s.html#12">(4.12)</a>,&#160;we&#160;deduce&#160;that<br/>
X<br/>
<br/>
<br/>
1&#160;+&#160;κ&#160;∆<br/>
2µ<br/>
3t∆µ<br/>
Γi(Qv,&#160;,&#160;λ)&#160;≤&#160;|St<br/>
·&#160;t∆&#160;·<br/>
≤<br/>
.<br/>
s<br/>
∆|<br/>
t<br/>
d<br/>
d<br/>
v∈V&#160;(G),s∈St∆<br/>
Altogether,&#160;with&#160;<a href="1802.07700s.html#12">(4.11)</a>,&#160;we&#160;conclude&#160;that<br/>
X<br/>
Γi(Qv,&#160;,&#160;λ)<br/>
2&#160;3t∆µ<br/>
s<br/>
≤<br/>
·<br/>
≤&#160;κ/2<br/>
1&#160;−&#160;Γ(Qv,&#160;,&#160;λ)<br/>
κ<br/>
d<br/>
s<br/>
v∈V&#160;(G),s∈St∆<br/>
by&#160;definition&#160;of&#160;κ.&#160;Thus,&#160;<a href="1802.07700s.html#11">(4.6)&#160;</a>follows&#160;from&#160;Corollary&#160;<a href="1802.07700s.html#10">4.8.</a><br/>
<br/>
For&#160;the&#160;proof&#160;of&#160;Lemma&#160;<a href="1802.07700s.html#6">4.1,&#160;</a>we&#160;need&#160;the&#160;additional&#160;flexibility&#160;that&#160;not&#160;only&#160;the&#160;total&#160;degree&#160;of&#160;a<br/>
vertex&#160;is&#160;of&#160;interest,&#160;but&#160;its&#160;degree&#160;into&#160;each&#160;of&#160;the&#160;clusters&#160;of&#160;a&#160;regularity&#160;partition.&#160;By&#160;splitting&#160;every<br/>vertex&#160;we&#160;can&#160;deduce&#160;this&#160;easily&#160;from&#160;Lemma&#160;<a href="1802.07700s.html#11">4.9.</a><br/>
Proof&#160;of&#160;Corollary&#160;<a href="1802.07700s.html#8">4.4.</a><br/>
We&#160;apply&#160;Lemma&#160;<a href="1802.07700s.html#11">4.9&#160;</a>to&#160;the&#160;graph&#160;G∗,&#160;which&#160;is&#160;obtained&#160;from&#160;G&#160;by<br/>
splitting&#160;each&#160;vertex&#160;as&#160;follows:&#160;for&#160;each&#160;v&#160;∈&#160;V&#160;(G),&#160;let&#160;v1,&#160;.&#160;.&#160;.&#160;,&#160;vm&#160;be&#160;new&#160;vertices.&#160;Let&#160;V&#160;(G∗)&#160;=<br/>
v<br/>
S<br/>
v∈V&#160;(G){v1,&#160;.&#160;.&#160;.&#160;,&#160;vm&#160;}.&#160;For&#160;every&#160;edge&#160;uv&#160;∈&#160;E(G),&#160;there&#160;are&#160;unique&#160;i&#160;∈&#160;[m<br/>
v<br/>
u]&#160;and&#160;j&#160;∈&#160;[mv&#160;]&#160;such&#160;that<br/>
v&#160;∈&#160;Sui&#160;and&#160;u&#160;∈&#160;Svj.&#160;Add&#160;the&#160;edge&#160;uivj&#160;to&#160;G∗&#160;and&#160;define&#160;c∗(uivj)&#160;:=&#160;c(uv).&#160;Clearly,&#160;n∗&#160;:=&#160;|V&#160;(G∗)|&#160;≤&#160;rn<br/>and&#160;for&#160;all&#160;v&#160;∈&#160;V&#160;(G)&#160;and&#160;i&#160;∈&#160;[mv],&#160;we&#160;have&#160;|NG∗(vi)|&#160;=&#160;|Svi|.&#160;In&#160;particular,&#160;δ(G∗)&#160;≥&#160;drn&#160;≥&#160;dn∗.<br/>
<br/>
Moreover,&#160;c∗&#160;:&#160;E(G∗)&#160;→&#160;C&#160;is&#160;µn∗-bounded.&#160;By&#160;Lemma&#160;<a href="1802.07700s.html#11">4.9&#160;</a>(with&#160;G∗&#160;playing&#160;the&#160;role&#160;of&#160;G),&#160;the<br/>
∆<br/>
following&#160;holds&#160;with&#160;probability&#160;at&#160;least&#160;κ&#160;(1&#160;+&#160;κ)−|C|:<br/>
3<br/>
dG∗&#160;(vi)&#160;=&#160;t−∆dG∗(vi)&#160;±&#160;(2t)∆κn∗<br/>
Cℓ<br/>
for&#160;all&#160;v&#160;∈&#160;V&#160;(G),&#160;i&#160;∈&#160;[mv]&#160;and&#160;ℓ&#160;∈&#160;[t].&#160;Since&#160;dC&#160;(v,&#160;Sv<br/>
(v<br/>
ℓ<br/>
i&#160;)&#160;=&#160;dG∗<br/>
i)&#160;and&#160;|Sv<br/>
C<br/>
i&#160;|&#160;=&#160;dG∗&#160;(vi),&#160;this&#160;completes<br/>
ℓ<br/>
the&#160;proof.<br/>
<br/>
5.&#160;Proof&#160;of&#160;the&#160;rainbow&#160;blow-up&#160;lemma<br/>
In&#160;this&#160;section,&#160;we&#160;state&#160;and&#160;prove&#160;the&#160;full&#160;version&#160;of&#160;the&#160;rainbow&#160;blow-up&#160;lemma.&#160;As&#160;indicated<br/>
in&#160;Section&#160;<a href="1802.07700s.html#2">1.1,&#160;</a>we&#160;also&#160;include&#160;exceptional&#160;vertices&#160;and&#160;candidate&#160;graphs&#160;in&#160;the&#160;statement.&#160;In&#160;<a href="1802.07700s.html#29">[30],<br/></a>the&#160;authors&#160;provided&#160;a&#160;version&#160;of&#160;the&#160;blow-up&#160;lemma&#160;which&#160;also&#160;allowed&#160;for&#160;the&#160;assignment&#160;of&#160;certain<br/>‘candidate&#160;sets’&#160;for&#160;some&#160;of&#160;the&#160;vertices.&#160;More&#160;precisely,&#160;for&#160;sufficiently&#160;small&#160;α,&#160;it&#160;is&#160;possible&#160;to&#160;assign<br/>for&#160;every&#160;cluster&#160;Xi&#160;to&#160;α|Xi|&#160;vertices&#160;x&#160;of&#160;Xi&#160;a&#160;candidate&#160;set&#160;Ax&#160;⊆&#160;Vi,&#160;which&#160;needs&#160;to&#160;be&#160;of&#160;size&#160;at&#160;least<br/>β|Vi|,&#160;such&#160;that&#160;the&#160;blow-up&#160;lemma&#160;still&#160;holds&#160;with&#160;the&#160;additional&#160;property&#160;that&#160;the&#160;image&#160;of&#160;x&#160;will&#160;lie<br/>inside&#160;Ax.&#160;We&#160;keep&#160;track&#160;of&#160;candidate&#160;sets&#160;by&#160;storing&#160;the&#160;essential&#160;information&#160;in&#160;a&#160;‘candidacy&#160;graph’<br/>Ai&#160;with&#160;bipartition&#160;(Xi,&#160;Vi),&#160;where&#160;NAi(x)&#160;encodes&#160;the&#160;candidate&#160;set&#160;for&#160;x.&#160;Thus,&#160;we&#160;allow&#160;candidate<br/>sets&#160;for&#160;all&#160;vertices,&#160;not&#160;only&#160;a&#160;small&#160;fraction.&#160;However,&#160;we&#160;require&#160;that&#160;the&#160;resulting&#160;candidacy&#160;graph<br/>for&#160;each&#160;cluster&#160;is&#160;lower&#160;super-regular.&#160;Clearly&#160;this&#160;includes&#160;the&#160;original&#160;framework.&#160;More&#160;formally,&#160;a<br/>bipartite&#160;graph&#160;Ai&#160;with&#160;bipartition&#160;(Xi,&#160;Vi)&#160;is&#160;a&#160;<i>candidacy&#160;graph&#160;for&#160;</i>(Xi,&#160;Vi).&#160;We&#160;say&#160;that&#160;the&#160;blow-up<br/>instance&#160;(H,&#160;G,&#160;R,&#160;(Xi)i∈[r]&#160;,&#160;(V<br/>
)&#160;with&#160;candidacy&#160;graphs&#160;(Ai)<br/>
0<br/>
i)i∈[r]0<br/>
i∈[r]&#160;is&#160;<i>(lower)&#160;</i>(ε,&#160;d)<i>-super-regular&#160;</i>if<br/>
for&#160;all&#160;ij&#160;∈&#160;E(R),&#160;the&#160;bipartite&#160;graph&#160;G[Vi,&#160;Vj]&#160;is&#160;(lower)&#160;(ε,&#160;d)-super-regular,&#160;and&#160;for&#160;all&#160;i&#160;∈&#160;[r],&#160;the<br/>graph&#160;Ai&#160;is&#160;(lower)&#160;(ε,&#160;d)-super-regular.<br/>
Candidate&#160;sets&#160;are&#160;especially&#160;helpful&#160;if&#160;a&#160;part&#160;of&#160;H&#160;is&#160;already&#160;embedded,&#160;for&#160;example&#160;if&#160;one&#160;has&#160;to<br/>
deal&#160;with&#160;‘exceptional&#160;vertices’&#160;before&#160;the&#160;application&#160;of&#160;the&#160;blow-up&#160;lemma.&#160;For&#160;instance,&#160;if&#160;x0&#160;is&#160;an<br/>exceptional&#160;vertex&#160;which&#160;already&#160;has&#160;been&#160;assigned&#160;its&#160;image&#160;v0,&#160;and&#160;x&#160;is&#160;an&#160;H-neighbour&#160;of&#160;x0&#160;to&#160;be<br/>embedded&#160;by&#160;the&#160;blow-up&#160;lemma,&#160;then&#160;the&#160;image&#160;of&#160;x&#160;better&#160;lies&#160;NG(v0).&#160;This&#160;can&#160;be&#160;achieved&#160;by<br/>assigning&#160;x&#160;a&#160;candidate&#160;set&#160;which&#160;is&#160;a&#160;subset&#160;of&#160;NG(v0).&#160;In&#160;the&#160;rainbow&#160;setting,&#160;we&#160;face&#160;the&#160;additional<br/>challenge&#160;that,&#160;depending&#160;on&#160;which&#160;of&#160;the&#160;candidates&#160;v&#160;we&#160;pick&#160;as&#160;the&#160;image&#160;of&#160;x,&#160;the&#160;edge&#160;vv0&#160;will<br/>already&#160;use&#160;a&#160;colour&#160;which&#160;is&#160;then&#160;forbidden&#160;for&#160;the&#160;rest&#160;of&#160;the&#160;embedding.&#160;In&#160;the&#160;full&#160;statement&#160;of&#160;our<br/>rainbow&#160;blow-up&#160;lemma,&#160;we&#160;thus&#160;already&#160;include&#160;the&#160;exceptional&#160;vertices.&#160;For&#160;the&#160;proof&#160;to&#160;work,&#160;we&#160;put<br/>the&#160;following&#160;restrictions&#160;on&#160;the&#160;partial&#160;embedding&#160;of&#160;the&#160;exceptional&#160;vertices.&#160;We&#160;will&#160;see&#160;in&#160;Section&#160;<a href="1802.07700s.html#24">6<br/></a>that&#160;these&#160;criteria&#160;can&#160;be&#160;met&#160;in&#160;applications&#160;easily.<br/>
Given&#160;a&#160;blow-up&#160;instance&#160;(H,&#160;G,&#160;R,&#160;(Xi)i∈[r]&#160;,&#160;(V<br/>
)&#160;with&#160;candidacy&#160;graphs&#160;(Ai)<br/>
0<br/>
i)i∈[r]0<br/>
i∈[r]&#160;and&#160;an&#160;edge<br/>
set&#160;colouring&#160;c&#160;:&#160;E(G)&#160;→&#160;2C,&#160;we&#160;say&#160;that&#160;the&#160;bijection&#160;φ0&#160;:&#160;X0&#160;→&#160;V0&#160;is&#160;D<i>-feasible&#160;</i>if&#160;the&#160;following&#160;hold:<br/>
(EXC1)&#160;for&#160;all&#160;x&#160;∈&#160;X0,&#160;j&#160;∈&#160;[r]&#160;and&#160;y&#160;∈&#160;NH(x)&#160;∩&#160;Xj,&#160;we&#160;have&#160;NAj&#160;(y)&#160;⊆&#160;NG(φ0(x));<br/>(EXC2)&#160;for&#160;all&#160;j&#160;∈&#160;[r],&#160;x&#160;∈&#160;Xj,&#160;v&#160;∈&#160;NAj&#160;(x)&#160;and&#160;distinct&#160;x0,&#160;x′0&#160;∈&#160;NH(x)&#160;∩&#160;X0,&#160;we&#160;have&#160;c(φ0(x0)v)&#160;∩<br/>
c(φ0(x′0)v)&#160;=&#160;∅&#160;;<br/>
P<br/>
(EXC3)&#160;for&#160;all&#160;colours&#160;α&#160;∈&#160;C,&#160;we&#160;have<br/>
dα&#160;(φ<br/>
x∈X<br/>
0(x))&#160;·&#160;dH&#160;(x)&#160;≤&#160;D.<br/>
0<br/>
G<br/>
<hr/>
<a name=14></a><img class="yflip" src="html/1802.07700-14_1.png"/><br/>
<img class="yflip" src="html/1802.07700-14_2.png"/><br/>
14<br/>
S.&#160;GLOCK&#160;AND&#160;F.&#160;JOOS<br/>
Condition&#160;<a href="1802.07700s.html#13">(EXC1)&#160;</a>ensures&#160;that&#160;whenever&#160;we&#160;pick&#160;for&#160;y&#160;∈&#160;V&#160;(H)&#160;\&#160;X0&#160;an&#160;image&#160;v&#160;from&#160;its&#160;candidate<br/>
set,&#160;then&#160;v&#160;is&#160;appropriately&#160;connected&#160;to&#160;V0.&#160;Condition&#160;<a href="1802.07700s.html#13">(EXC2)&#160;</a>in&#160;turn&#160;ensures&#160;that&#160;no&#160;conflict&#160;arises<br/>from&#160;this,&#160;i.e.&#160;the&#160;star&#160;with&#160;center&#160;v&#160;and&#160;the&#160;images&#160;of&#160;the&#160;neighbours&#160;of&#160;v&#160;in&#160;X0&#160;is&#160;rainbow.&#160;Condition<br/><a href="1802.07700s.html#13">(EXC3)&#160;</a>is&#160;designed&#160;for&#160;an&#160;application&#160;where&#160;the&#160;exceptional&#160;vertices&#160;are&#160;not&#160;required&#160;to&#160;have&#160;bounded<br/>degree.&#160;Note&#160;that&#160;<a href="1802.07700s.html#13">(EXC1)–(EXC3)&#160;</a>are&#160;trivially&#160;satisfied&#160;if&#160;X0&#160;is&#160;empty.&#160;Moreover,&#160;<a href="1802.07700s.html#13">(EXC2)&#160;</a>is&#160;clearly<br/>satisfied&#160;if&#160;X0&#160;is&#160;2-independent.&#160;Note&#160;that&#160;if&#160;c&#160;is&#160;k-bounded&#160;and&#160;∆(H)&#160;≤&#160;∆,&#160;then&#160;<a href="1802.07700s.html#13">(EXC3)&#160;</a>holds&#160;with<br/>D&#160;=&#160;2∆k.<br/>
Given&#160;an&#160;edge&#160;set&#160;colouring&#160;c&#160;of&#160;G,&#160;we&#160;say&#160;that&#160;a&#160;subgraph&#160;H&#160;is&#160;<i>rainbow&#160;</i>if&#160;c(e)&#160;∩&#160;c(e′)&#160;=&#160;∅&#160;for&#160;all<br/>
distinct&#160;e,&#160;e′&#160;∈&#160;E(H).&#160;This&#160;allows&#160;to&#160;model&#160;slightly&#160;more&#160;general&#160;systems&#160;of&#160;conflicts.&#160;For&#160;instance,&#160;if<br/>c1,&#160;.&#160;.&#160;.&#160;,&#160;c∆&#160;are&#160;edge&#160;colourings&#160;of&#160;G,&#160;we&#160;can&#160;define&#160;c∗(e)&#160;:=&#160;{c1(e),&#160;.&#160;.&#160;.&#160;,&#160;c∆(e)}&#160;for&#160;all&#160;e&#160;∈&#160;E(G).&#160;If&#160;H&#160;is<br/>rainbow&#160;with&#160;respect&#160;to&#160;the&#160;edge&#160;set&#160;colouring&#160;c∗,&#160;then&#160;H&#160;is&#160;simultaneously&#160;rainbow&#160;with&#160;respect&#160;to&#160;all<br/>the&#160;ci.<br/>
We&#160;also&#160;note&#160;that,&#160;even&#160;if&#160;the&#160;given&#160;colouring&#160;of&#160;G&#160;is&#160;a&#160;‘normal’&#160;edge&#160;colouring,&#160;the&#160;ability&#160;to&#160;handle<br/>
edge&#160;set&#160;colourings&#160;is&#160;crucial&#160;when&#160;dealing&#160;with&#160;exceptional&#160;vertices&#160;(see&#160;Step&#160;2&#160;in&#160;the&#160;proof&#160;of&#160;Lemma&#160;<a href="1802.07700s.html#14">5.2)</a>.<br/>
We&#160;now&#160;state&#160;the&#160;full&#160;version&#160;of&#160;the&#160;rainbow&#160;blow-up&#160;lemma.&#160;It&#160;clearly&#160;implies&#160;Lemma&#160;<a href="1802.07700s.html#3">1.1.</a><br/>
Lemma&#160;5.1&#160;(Rainbow&#160;blow-up&#160;lemma).&#160;<i>Let&#160;</i>1/n&#160;≪&#160;µ,&#160;ε&#160;≪&#160;d,&#160;1/∆&#160;<i>and&#160;</i>µ&#160;≪&#160;1/r<i>.&#160;Let&#160;</i>(H,&#160;G,&#160;R,&#160;(Xi)i∈[r]&#160;,&#160;(V<br/>
)<br/>
0<br/>
i)i∈[r]0<br/>
<i>with&#160;candidacy&#160;graphs&#160;</i>(Ai)i∈[r]&#160;<i>be&#160;a&#160;lower&#160;</i>(ε,&#160;d)<i>-super-regular&#160;blow-up&#160;instance&#160;and&#160;assume&#160;further&#160;that</i><br/>
(i)&#160;∆(R)&#160;≤&#160;∆&#160;<i>and&#160;</i>dH(x)&#160;≤&#160;∆&#160;<i>for&#160;all&#160;</i>x&#160;∈&#160;V&#160;(H)&#160;\&#160;X0<i>;</i><br/>
(ii)&#160;|Vi|&#160;=&#160;(1&#160;±&#160;ε)n/r&#160;<i>for&#160;all&#160;</i>i&#160;∈&#160;[r]<i>;</i><br/>
(iii)&#160;<i>for&#160;all&#160;</i>i&#160;∈&#160;[r]<i>,&#160;at&#160;most&#160;</i>(2∆)−4|Xi|&#160;<i>vertices&#160;in&#160;</i>Xi&#160;<i>have&#160;a&#160;neighbour&#160;in&#160;</i>X0<i>.</i><br/>
<i>Let&#160;</i>c&#160;:&#160;E(G)&#160;→&#160;2C&#160;<i>be&#160;</i>(µn,&#160;∆)<i>-bounded.&#160;Suppose&#160;a&#160;</i>2∆µn<i>-feasible&#160;bijection&#160;</i>φ0&#160;:&#160;X0&#160;→&#160;V0&#160;<i>is&#160;given.&#160;Then<br/>there&#160;exists&#160;a&#160;rainbow&#160;embedding&#160;</i>φ&#160;<i>of&#160;</i>H&#160;<i>into&#160;</i>G&#160;<i>which&#160;extends&#160;</i>φ0&#160;<i>such&#160;that&#160;</i>φ(x)&#160;∈&#160;NAi(x)&#160;<i>for&#160;all&#160;</i>i&#160;∈&#160;[r]<br/><i>and&#160;</i>x&#160;∈&#160;Xi<i>.</i><br/>
In&#160;the&#160;remaining&#160;four&#160;subsections&#160;of&#160;this&#160;section,&#160;we&#160;prove&#160;Lemma&#160;<a href="1802.07700s.html#14">5.1.&#160;</a>In&#160;the&#160;first&#160;subsection,<br/>
we&#160;deduce&#160;Lemma&#160;<a href="1802.07700s.html#14">5.1&#160;</a>from&#160;a&#160;similar&#160;statement&#160;(Lemma&#160;<a href="1802.07700s.html#14">5.2)</a>,&#160;where&#160;we&#160;impose&#160;considerably&#160;stronger<br/>assumptions&#160;on&#160;G&#160;and&#160;H.&#160;In&#160;Subsection&#160;<a href="1802.07700s.html#17">5.2,&#160;</a>we&#160;introduce&#160;the&#160;so-called&#160;‘Four&#160;graphs&#160;lemma’&#160;from&#160;<a href="1802.07700s.html#29">[43],<br/></a>which&#160;we&#160;use&#160;in&#160;the&#160;proof&#160;of&#160;Lemma&#160;<a href="1802.07700s.html#14">5.2.&#160;</a>In&#160;Subsection&#160;<a href="1802.07700s.html#18">5.3,&#160;</a>we&#160;discuss&#160;‘conflict-free’&#160;matchings&#160;and&#160;see<br/>how&#160;a&#160;recent&#160;result&#160;of&#160;Coulson&#160;and&#160;Perarnau&#160;<a href="1802.07700s.html#29">[12]&#160;</a>via&#160;the&#160;switching&#160;method&#160;can&#160;be&#160;used&#160;to&#160;find&#160;perfect<br/>conflict-free&#160;matchings&#160;in&#160;super-regular&#160;pairs.&#160;This&#160;will&#160;be&#160;another&#160;important&#160;ingredient&#160;for&#160;the&#160;proof&#160;of<br/>Lemma&#160;<a href="1802.07700s.html#14">5.2.&#160;</a>In&#160;the&#160;last&#160;subsection&#160;we&#160;finally&#160;prove&#160;Lemma&#160;<a href="1802.07700s.html#14">5.2.</a><br/>
5.1.&#160;Split&#160;into&#160;matchings.&#160;Our&#160;first&#160;step&#160;in&#160;proving&#160;Lemma&#160;<a href="1802.07700s.html#14">5.1&#160;</a>is&#160;to&#160;reduce&#160;it&#160;to&#160;a&#160;similar&#160;statement<br/>where&#160;H&#160;is&#160;highly&#160;structured&#160;in&#160;the&#160;sense&#160;that&#160;H&#160;only&#160;induces&#160;(perfect)&#160;matchings&#160;between&#160;its&#160;partition<br/>classes.&#160;The&#160;main&#160;steps&#160;of&#160;this&#160;reduction&#160;are&#160;essentially&#160;the&#160;same&#160;as&#160;in&#160;<a href="1802.07700s.html#29">[43]:&#160;</a>we&#160;apply&#160;the&#160;Hajnal–<br/>Szemer´edi&#160;theorem&#160;to&#160;H2[Xi]&#160;for&#160;each&#160;vertex&#160;class&#160;Xi&#160;to&#160;obtain&#160;a&#160;refined&#160;partition&#160;of&#160;H&#160;where&#160;every<br/>vertex&#160;class&#160;is&#160;now&#160;2-independent.&#160;We&#160;refine&#160;the&#160;partition&#160;of&#160;G&#160;randomly&#160;such&#160;that&#160;super-regularity&#160;is<br/>preserved.&#160;Our&#160;reduction&#160;is&#160;more&#160;intricate&#160;than&#160;the&#160;one&#160;in&#160;<a href="1802.07700s.html#29">[43]&#160;</a>as&#160;we&#160;also&#160;consider&#160;candidacy&#160;graphs&#160;and<br/>exceptional&#160;vertices&#160;and&#160;allow&#160;the&#160;cluster&#160;sizes&#160;to&#160;be&#160;slighty&#160;unbalanced.<br/>
We&#160;now&#160;state&#160;the&#160;auxiliary&#160;lemma,&#160;which&#160;we&#160;will&#160;prove&#160;in&#160;Section&#160;<a href="1802.07700s.html#18">5.4.&#160;</a>In&#160;this&#160;subsection,&#160;we&#160;deduce<br/>
the&#160;rainbow&#160;blow-up&#160;lemma&#160;(Lemma&#160;<a href="1802.07700s.html#14">5.1)&#160;</a>from&#160;Lemma&#160;<a href="1802.07700s.html#14">5.2.</a><br/>
Lemma&#160;5.2.&#160;<i>Suppose&#160;</i>1/n&#160;≪&#160;µ&#160;≪&#160;ε&#160;≪&#160;d,&#160;1/∆&#160;<i>and&#160;</i>µ&#160;≪&#160;1/r&#160;<i>such&#160;that&#160;</i>r&#160;<i>divides&#160;</i>n<i>.&#160;Let&#160;</i>(H,&#160;G,&#160;R,&#160;(Xi)i∈[r]&#160;,&#160;(V<br/>
)<br/>
0<br/>
i)i∈[r]0<br/>
<i>with&#160;candidacy&#160;graphs&#160;</i>(Ai)i∈[r]&#160;<i>be&#160;an&#160;</i>(ε,&#160;d)<i>-super-regular&#160;blow-up&#160;instance&#160;and&#160;assume&#160;further&#160;that</i><br/>
(i)&#160;∆(R)&#160;≤&#160;∆&#160;<i>and&#160;</i>dH(x,&#160;X0)&#160;≤&#160;∆&#160;<i>for&#160;all&#160;</i>x&#160;∈&#160;V&#160;(H)&#160;\&#160;X0<i>;</i><br/>
(ii)&#160;|Vi|&#160;=&#160;n/r&#160;<i>for&#160;all&#160;</i>i&#160;∈&#160;[r]<i>;</i><br/>
<br/>
(iii)&#160;<i>for&#160;all&#160;</i>ij&#160;∈&#160;[r]&#160;<i>,&#160;the&#160;graph&#160;</i>H[X<br/>
2<br/>
i,&#160;Xj&#160;]&#160;<i>is&#160;a&#160;perfect&#160;matching&#160;if&#160;</i>ij&#160;∈&#160;E(R)&#160;<i>and&#160;empty&#160;otherwise.</i><br/>
<i>Let&#160;</i>c&#160;:&#160;E(G)&#160;→&#160;2C&#160;<i>be&#160;</i>(µn,&#160;∆)<i>-bounded.&#160;Suppose&#160;a&#160;</i>µn<i>-feasible&#160;bijection&#160;</i>φ0&#160;:&#160;X0&#160;→&#160;V0&#160;<i>is&#160;given.&#160;Then<br/>there&#160;exists&#160;a&#160;rainbow&#160;embedding&#160;</i>φ&#160;<i>of&#160;</i>H&#160;<i>into&#160;</i>G&#160;<i>which&#160;extends&#160;</i>φ0&#160;<i>such&#160;that&#160;</i>φ(x)&#160;∈&#160;NAj&#160;(x)&#160;<i>for&#160;all&#160;</i>j&#160;∈&#160;[r]<br/><i>and&#160;</i>x&#160;∈&#160;Xj<i>.</i><br/>
In&#160;the&#160;reduction,&#160;we&#160;will&#160;need&#160;the&#160;classical&#160;Hajnal–Szemer´edi&#160;theorem&#160;and&#160;two&#160;facts&#160;about&#160;regular<br/>
pairs.<br/>
Theorem&#160;5.3&#160;(<a href="1802.07700s.html#29">[18])</a>.&#160;<i>Let&#160;</i>G&#160;<i>be&#160;a&#160;graph&#160;on&#160;</i>n&#160;<i>vertices&#160;with&#160;</i>∆(G)&#160;&lt;&#160;k&#160;≤&#160;n<i>.&#160;Then&#160;</i>V&#160;(G)&#160;<i>can&#160;be&#160;partitioned<br/>into&#160;</i>k&#160;<i>independent&#160;sets&#160;of&#160;size&#160;</i>⌊&#160;n&#160;⌋&#160;<i>or&#160;</i>⌈&#160;n⌉<i>.</i><br/>
k<br/>
k<br/>
Proposition&#160;5.4&#160;(<a href="1802.07700s.html#29">[43,&#160;</a>Fact&#160;2]).&#160;<i>Let&#160;</i>1/n&#160;≪&#160;ε&#160;≪&#160;ε′&#160;≪&#160;d<i>.&#160;Let&#160;</i>G&#160;<i>be&#160;a&#160;bipartite&#160;graph&#160;with&#160;bipartition<br/></i>(V1,&#160;V2)<i>,&#160;where&#160;</i>|V1|&#160;=&#160;|V2|&#160;=&#160;n<i>.&#160;If&#160;</i>G&#160;<i>is&#160;lower&#160;</i>(ε,&#160;d)<i>-super-regular,&#160;then&#160;</i>G&#160;<i>contains&#160;a&#160;spanning&#160;subgraph<br/></i>G′&#160;<i>which&#160;is&#160;</i>(ε′,&#160;d2/2)<i>-super-regular.</i><br/>
<hr/>
<a name=15></a>15<br/>
Fact&#160;5.5.&#160;<i>Let&#160;</i>G&#160;<i>be&#160;a&#160;bipartite&#160;graph&#160;with&#160;vertex&#160;partition&#160;</i>(A,&#160;B)<i>.&#160;Suppose&#160;</i>G&#160;<i>is&#160;lower&#160;</i>(ε,&#160;d)<i>-regular&#160;and<br/></i>Y&#160;⊆&#160;B&#160;<i>with&#160;</i>|Y&#160;|&#160;≥&#160;ε|B|<i>.&#160;Then&#160;all&#160;but&#160;at&#160;most&#160;</i>ε|A|&#160;<i>vertices&#160;of&#160;</i>A&#160;<i>have&#160;at&#160;least&#160;</i>(d&#160;−&#160;ε)|Y&#160;|&#160;<i>neighbours&#160;in&#160;</i>Y&#160;<i>.</i><br/>
Proof&#160;of&#160;Lemma&#160;<a href="1802.07700s.html#14">5.1.</a><br/>
The&#160;proof&#160;divides&#160;into&#160;four&#160;steps.&#160;Firstly,&#160;we&#160;modify&#160;the&#160;partition&#160;of&#160;H.&#160;From<br/>
this,&#160;we&#160;obtain&#160;a&#160;few&#160;more&#160;exceptional&#160;vertices.&#160;In&#160;Step&#160;2,&#160;we&#160;then&#160;extend&#160;φ0&#160;to&#160;the&#160;new&#160;exceptional&#160;set.<br/>Subsequently,&#160;in&#160;Step&#160;3&#160;we&#160;refine&#160;the&#160;partition&#160;of&#160;G&#160;accordingly,&#160;and&#160;finally&#160;we&#160;apply&#160;Lemma&#160;<a href="1802.07700s.html#14">5.2.</a><br/>
Choose&#160;a&#160;new&#160;constant&#160;ε∗&#160;such&#160;that&#160;1/n&#160;≪&#160;µ,&#160;ε&#160;≪&#160;ε∗&#160;≪&#160;d,&#160;1/∆.&#160;Let&#160;n′&#160;be&#160;the&#160;largest&#160;integer&#160;not<br/>
exceeding&#160;(1&#160;−&#160;ε)n/r&#160;which&#160;is&#160;divisible&#160;by&#160;∆2.&#160;For&#160;i&#160;∈&#160;[r],&#160;define&#160;ai&#160;:=&#160;|Xi|&#160;−&#160;n′.&#160;Note&#160;that<br/>(5.1)<br/>
0&#160;≤&#160;ai&#160;≤&#160;3εn/r.<br/>
Let&#160;R∗&#160;be&#160;the&#160;graph&#160;with&#160;vertex&#160;set&#160;[r]&#160;×&#160;[∆2]&#160;and&#160;edges&#160;(i,&#160;j)(i′,&#160;j′)&#160;∈&#160;E(R∗)&#160;whenever&#160;ii′&#160;∈&#160;E(R).<br/>
Clearly,&#160;∆(R∗)&#160;≤&#160;∆3.&#160;Let&#160;r∗&#160;:=&#160;r∆2&#160;and&#160;n∗&#160;:=&#160;n′r.&#160;So&#160;(1&#160;−&#160;2ε)n&#160;≤&#160;n∗&#160;≤&#160;n.&#160;Later,&#160;we&#160;will&#160;apply<br/>Lemma&#160;<a href="1802.07700s.html#14">5.2&#160;</a>with&#160;n∗,&#160;r∗,&#160;R∗&#160;playing&#160;the&#160;roles&#160;of&#160;n,&#160;r,&#160;R,&#160;respectively.<br/>
<i>Step&#160;</i>1<i>:&#160;Refining&#160;</i>H<br/>
First,&#160;we&#160;move&#160;ai&#160;vertices&#160;from&#160;each&#160;cluster&#160;Xi&#160;to&#160;the&#160;exceptional&#160;set&#160;in&#160;order&#160;to&#160;adjust&#160;the&#160;sizes.&#160;For<br/>
vertex&#160;sets&#160;U1&#160;⊆&#160;U2&#160;⊆&#160;V&#160;(H),&#160;we&#160;say&#160;that&#160;(U2,&#160;U1)&#160;is&#160;(2,&#160;1)<i>-independent&#160;</i>if&#160;U2&#160;is&#160;independent&#160;in&#160;H&#160;and<br/>whenever&#160;u,&#160;u′&#160;∈&#160;U2&#160;have&#160;a&#160;common&#160;neighbour&#160;in&#160;H,&#160;then&#160;u,&#160;u′&#160;∈&#160;U1.<br/>
<i>Claim&#160;</i>1<i>:&#160;There&#160;is&#160;a&#160;set&#160;</i>B&#160;⊆&#160;V&#160;(H)\X0&#160;<i>such&#160;that&#160;</i>|B&#160;∩Xi|&#160;=&#160;ai&#160;<i>for&#160;all&#160;</i>i&#160;∈&#160;[r]&#160;<i>and&#160;such&#160;that&#160;</i>(X0&#160;∪B,&#160;X0)<br/>
<i>is&#160;</i>(2,&#160;1)<i>-independent&#160;in&#160;</i>H<i>.</i><br/>
<i>Proof&#160;of&#160;claim:&#160;</i>The&#160;set&#160;B&#160;can&#160;be&#160;constructed&#160;greedily.&#160;Assume&#160;that&#160;for&#160;some&#160;i&#160;∈&#160;[r&#160;−&#160;1]0,&#160;we&#160;have&#160;found<br/>a&#160;set&#160;Bi&#160;such&#160;that&#160;|Bi&#160;∩&#160;Xj|&#160;=&#160;aj&#160;for&#160;all&#160;j&#160;∈&#160;[i]&#160;and&#160;(X0&#160;∪&#160;Bi,&#160;X0)&#160;is&#160;(2,&#160;1)-independent&#160;in&#160;H.&#160;(Note&#160;that<br/>B0&#160;=&#160;∅&#160;satisfies&#160;this&#160;for&#160;i&#160;=&#160;0.)&#160;Using&#160;<a href="1802.07700s.html#15">(5.1)&#160;</a>and&#160;the&#160;fact&#160;that&#160;∆(R)&#160;≤&#160;∆&#160;and&#160;∆(H)&#160;≤&#160;∆,&#160;it&#160;is&#160;not&#160;hard<br/>to&#160;see&#160;that&#160;at&#160;most&#160;(2∆)−2n/r&#160;vertices&#160;in&#160;Xi+1&#160;are&#160;at&#160;distance&#160;at&#160;most&#160;2&#160;from&#160;X0&#160;∪&#160;Bi.<br/>
Now,&#160;since&#160;∆(H2[Xi+1])&#160;≤&#160;∆2&#160;−&#160;1,&#160;there&#160;exists&#160;a&#160;2-independent&#160;subset&#160;of&#160;Xi+1&#160;of&#160;size&#160;at&#160;least<br/>
|Xi+1|/∆2.&#160;Thus,&#160;since&#160;|Xi+1|/∆2&#160;−&#160;(2∆)−2n/r&#160;≥&#160;ai+1,&#160;we&#160;can&#160;pick&#160;ai+1&#160;2-independent&#160;vertices&#160;from<br/>Xi+1&#160;which&#160;are&#160;at&#160;distance&#160;at&#160;least&#160;3&#160;from&#160;X0&#160;∪&#160;Bi&#160;and&#160;add&#160;them&#160;to&#160;Bi&#160;to&#160;obtain&#160;Bi+1.&#160;Observe&#160;that<br/>then&#160;(X0&#160;∪&#160;Bi+1,&#160;X0)&#160;is&#160;(2,&#160;1)-independent&#160;in&#160;H.<br/>
−<br/>
Define&#160;X∗0&#160;:=&#160;X0&#160;∪B&#160;and&#160;X′i&#160;:=&#160;Xi&#160;\&#160;B&#160;for&#160;i&#160;∈&#160;[r].&#160;Clearly,&#160;we&#160;have&#160;|X′i|&#160;=&#160;n′.&#160;For&#160;all&#160;i&#160;∈&#160;[r],&#160;apply&#160;the<br/>
Hajnal–Szemer´edi&#160;theorem&#160;(Theorem&#160;<a href="1802.07700s.html#14">5.3)&#160;</a>to&#160;H2[X′i].&#160;Note&#160;that&#160;∆(H2[X′i])&#160;≤&#160;∆(∆&#160;−&#160;1)&#160;&lt;&#160;∆2.&#160;Recall<br/>that&#160;n′&#160;is&#160;divisible&#160;by&#160;∆2.&#160;Thus,&#160;there&#160;exists&#160;a&#160;partition&#160;of&#160;X′i&#160;into&#160;2-independent&#160;sets&#160;X∗i,1,&#160;.&#160;.&#160;.&#160;,&#160;X∗i,∆2&#160;in<br/>H&#160;of&#160;size&#160;exactly&#160;n′/∆2&#160;each.&#160;For&#160;all&#160;(i,&#160;j),&#160;(i′,&#160;j′)&#160;∈&#160;[r]&#160;×&#160;[∆2],&#160;we&#160;have&#160;that&#160;H[X∗i,j,&#160;X∗i′,j′]&#160;is&#160;a&#160;matching<br/>if&#160;(i,&#160;j)(i′,&#160;j′)&#160;∈&#160;E(R∗)&#160;and&#160;empty&#160;otherwise.&#160;Thus,&#160;R∗&#160;is&#160;a&#160;suitable&#160;reduced&#160;graph&#160;for&#160;the&#160;new&#160;partition<br/>(X∗i,j)(i,j)∈[r]×[∆2]&#160;of&#160;V&#160;(H)&#160;\&#160;X∗0,&#160;and&#160;X∗0&#160;is&#160;the&#160;new&#160;exceptional&#160;set.&#160;Surely,&#160;we&#160;can&#160;add&#160;edges&#160;to&#160;H&#160;to<br/>obtain&#160;a&#160;supergraph&#160;H∗&#160;such&#160;that&#160;H∗[X∗i,j,&#160;X∗i′,j′]&#160;forms&#160;a&#160;perfect&#160;matching&#160;for&#160;all&#160;(i,&#160;j)(i′,&#160;j′)&#160;∈&#160;E(R∗)<br/>Clearly,&#160;any&#160;rainbow&#160;embedding&#160;of&#160;H∗&#160;induces&#160;a&#160;rainbow&#160;embedding&#160;of&#160;H.<br/>
We&#160;observe&#160;that&#160;by&#160;the&#160;(2,&#160;1)-independence&#160;of&#160;(X∗0,&#160;X0),&#160;we&#160;have&#160;that&#160;for&#160;all&#160;i&#160;∈&#160;[r]&#160;and&#160;y&#160;∈&#160;X′i,<br/>
exactly&#160;one&#160;of&#160;the&#160;following&#160;alternatives&#160;applies:<br/>
(a)&#160;NH(y)&#160;∩&#160;X∗0&#160;=&#160;NH(y)&#160;∩&#160;X0;<br/>
(b)&#160;NH(y)&#160;∩&#160;X∗0&#160;=&#160;{x}&#160;for&#160;a&#160;unique&#160;x&#160;∈&#160;Xj&#160;with&#160;j&#160;∈&#160;NR(i);<br/>
(c)&#160;NH(y)&#160;∩&#160;X∗0&#160;=&#160;∅.<br/>
Let&#160;Wa&#160;be&#160;the&#160;set&#160;of&#160;all&#160;vertices&#160;y&#160;∈&#160;V&#160;(H)&#160;\&#160;X∗0&#160;for&#160;which&#160;<a href="1802.07700s.html#15">(a)&#160;</a>applies,&#160;and&#160;let&#160;Wb&#160;be&#160;the&#160;set&#160;of&#160;all&#160;vertices<br/>y&#160;∈&#160;V&#160;(H)&#160;\&#160;X∗0&#160;for&#160;which&#160;<a href="1802.07700s.html#15">(b)&#160;</a>applies.&#160;For&#160;i&#160;∈&#160;[r],&#160;we&#160;have<br/>
X<br/>
<a href="1802.07700s.html#15">(5.1)</a><br/>
(5.2)<br/>
|Wb&#160;∩&#160;Xi|&#160;≤<br/>
∆aj&#160;≤&#160;∆2&#160;·&#160;3εn/r.<br/>
j∈NR(i)<br/>
<i>Step&#160;</i>2<i>:&#160;Extending&#160;</i>φ0<br/>
We&#160;want&#160;to&#160;find&#160;a&#160;suitable&#160;set&#160;V&#160;∗<br/>
0<br/>
⊇&#160;V0&#160;and&#160;extend&#160;φ0&#160;to&#160;a&#160;bijection&#160;φ∗0&#160;:&#160;X∗0&#160;→&#160;V&#160;∗<br/>
0<br/>
such&#160;that<br/>
φ∗0(x)&#160;∈&#160;NAj&#160;(x)&#160;for&#160;all&#160;j&#160;∈&#160;[r]&#160;and&#160;x&#160;∈&#160;X∗0&#160;∩&#160;Xj,&#160;and&#160;such&#160;that&#160;for&#160;all&#160;x&#160;∈&#160;X∗0&#160;\&#160;X0,&#160;all&#160;i&#160;∈&#160;[r]&#160;and&#160;all<br/>y&#160;∈&#160;NH(x)&#160;∩&#160;Xi,&#160;we&#160;have<br/>(5.3)<br/>
|NAi(y)&#160;∩&#160;NG(φ∗0(x))|&#160;≥&#160;(d&#160;−&#160;ε)|NAi(y)|.<br/>
We&#160;can&#160;find&#160;V&#160;∗<br/>
0&#160;and&#160;φ∗<br/>
0&#160;by&#160;successively&#160;picking&#160;a&#160;suitable&#160;image&#160;for&#160;each&#160;x&#160;∈&#160;X&#160;∗<br/>
0&#160;\&#160;X0.&#160;Suppose&#160;we&#160;have<br/>
already&#160;defined&#160;images&#160;for&#160;Z&#160;⊆&#160;X∗0&#160;\&#160;X0&#160;and&#160;now&#160;want&#160;to&#160;find&#160;a&#160;suitable&#160;image&#160;for&#160;x&#160;∈&#160;X∗0&#160;\&#160;(X0&#160;∪&#160;Z).<br/>Let&#160;j&#160;∈&#160;[r]&#160;be&#160;such&#160;that&#160;x&#160;∈&#160;Xj.&#160;We&#160;want&#160;to&#160;pick&#160;φ∗0(x)&#160;from&#160;NAj&#160;(x).&#160;A&#160;vertex&#160;v&#160;∈&#160;NAj&#160;(x)&#160;is&#160;a&#160;suitable<br/>image&#160;if&#160;for&#160;all&#160;i&#160;∈&#160;[r]&#160;and&#160;all&#160;y&#160;∈&#160;NH(x)&#160;∩&#160;Xi,&#160;we&#160;have&#160;dG(v,&#160;NAi(y))&#160;≥&#160;(d&#160;−&#160;ε)|NAi(y)|.&#160;For&#160;fixed&#160;i&#160;∈&#160;[r]<br/>
<hr/>
<a name=16></a><img class="yflip" src="html/1802.07700-16_1.png"/><br/>
<img class="yflip" src="html/1802.07700-16_2.png"/><br/>
<img class="yflip" src="html/1802.07700-16_3.png"/><br/>
<img class="yflip" src="html/1802.07700-16_4.png"/><br/>
<img class="yflip" src="html/1802.07700-16_5.png"/><br/>
<img class="yflip" src="html/1802.07700-16_6.png"/><br/>
<img class="yflip" src="html/1802.07700-16_7.png"/><br/>
<img class="yflip" src="html/1802.07700-16_8.png"/><br/>
<img class="yflip" src="html/1802.07700-16_9.png"/><br/>
<img class="yflip" src="html/1802.07700-16_10.png"/><br/>
<img class="yflip" src="html/1802.07700-16_11.png"/><br/>
16<br/>
S.&#160;GLOCK&#160;AND&#160;F.&#160;JOOS<br/>
and&#160;y&#160;∈&#160;NH(x)&#160;∩&#160;Xi,&#160;since&#160;ij&#160;∈&#160;E(R)&#160;and&#160;G[Vi,&#160;Vj]&#160;is&#160;lower&#160;(ε,&#160;d)-regular,&#160;Fact&#160;<a href="1802.07700s.html#15">5.5&#160;</a>implies&#160;that&#160;all&#160;but<br/>at&#160;most&#160;ε|Vj|&#160;vertices&#160;in&#160;Vj&#160;have&#160;at&#160;least&#160;(d&#160;−&#160;ε)|NAi(y)|&#160;neighbours&#160;in&#160;NAi(y).&#160;Thus,&#160;at&#160;most&#160;∆ε|Vj|<br/>vertices&#160;of&#160;Vj&#160;are&#160;not&#160;suitable&#160;images&#160;for&#160;x.&#160;Moreover,&#160;at&#160;most&#160;aj&#160;vertices&#160;of&#160;Vj&#160;have&#160;already&#160;been&#160;used<br/>as&#160;images&#160;for&#160;the&#160;vertices&#160;in&#160;Z.&#160;Thus,&#160;there&#160;exists&#160;a&#160;suitable&#160;image&#160;φ∗0(x)&#160;for&#160;x.<br/>
Let&#160;V&#160;∗<br/>
0&#160;:=&#160;φ∗<br/>
0&#160;(X&#160;∗<br/>
0&#160;).&#160;Clearly,&#160;we&#160;have&#160;|V&#160;∗<br/>
0&#160;∩&#160;Vi|&#160;=&#160;ai&#160;for&#160;all&#160;i&#160;∈&#160;[r].&#160;Before&#160;we&#160;continue&#160;to&#160;refine&#160;the<br/>
partition&#160;of&#160;G,&#160;we&#160;have&#160;to&#160;redefine&#160;the&#160;neighbourhoods&#160;of&#160;the&#160;vertices&#160;in&#160;Wb&#160;in&#160;their&#160;respective&#160;candidate<br/>graphs&#160;in&#160;order&#160;to&#160;meet&#160;condition&#160;<a href="1802.07700s.html#13">(EXC1)&#160;</a>for&#160;φ∗0&#160;(see&#160;Step&#160;4).&#160;Consider&#160;i&#160;∈&#160;[r].&#160;Let&#160;A′i&#160;be&#160;the&#160;spanning<br/>subgraph&#160;of&#160;Ai&#160;obtained&#160;by&#160;deleting&#160;for&#160;every&#160;vertex&#160;y&#160;∈&#160;Xi&#160;∩&#160;Wb&#160;all&#160;edges&#160;yv&#160;for&#160;which&#160;v&#160;/<br/>
∈&#160;NG(φ∗0(x)),<br/>
where&#160;x&#160;is&#160;the&#160;unique&#160;H-neighbour&#160;of&#160;y&#160;in&#160;X∗0&#160;(cf.&#160;<a href="1802.07700s.html#15">(b))</a>.&#160;Note&#160;that&#160;A′i&#160;still&#160;contains&#160;vertices&#160;from&#160;X∗0<br/>and&#160;V&#160;∗<br/>
0&#160;.&#160;We&#160;might&#160;as&#160;well&#160;remove&#160;them,&#160;but&#160;it&#160;is&#160;more&#160;convenient&#160;to&#160;leave&#160;them&#160;in&#160;for&#160;now.<br/>
Note&#160;that&#160;by&#160;<a href="1802.07700s.html#15">(5.3)</a>,&#160;we&#160;still&#160;have&#160;that&#160;dA′i(y)&#160;≥&#160;(d−ε)|NAi(y)|&#160;≥&#160;d2|Vi|/2&#160;for&#160;all&#160;y&#160;∈&#160;Xi∩Wb.&#160;Moreover,<br/>
since&#160;|Xi&#160;∩&#160;Wb|&#160;≤&#160;4∆2ε|Xi|&#160;by&#160;<a href="1802.07700s.html#15">(5.2)</a>,&#160;it&#160;is&#160;easy&#160;to&#160;see&#160;that&#160;A′i&#160;is&#160;still&#160;lower&#160;(8∆2ε,&#160;d2/2)-super-regular.<br/>
<i>Step&#160;</i>3<i>:&#160;Refining&#160;</i>G<br/>
Let&#160;d′&#160;:=&#160;d2/2.&#160;For&#160;i&#160;∈&#160;[r],&#160;let&#160;V&#160;′i&#160;:=&#160;Vi&#160;\&#160;V&#160;∗<br/>
0&#160;.&#160;Clearly,&#160;|V&#160;′<br/>
i&#160;|&#160;=&#160;|X&#160;′i|&#160;=&#160;n′.&#160;We&#160;will&#160;partition&#160;each&#160;V&#160;′<br/>
i<br/>
randomly&#160;into&#160;∆2&#160;equal-sized&#160;parts&#160;and&#160;then&#160;match&#160;those&#160;with&#160;the&#160;refined&#160;parts&#160;X∗i,j&#160;of&#160;X′i.&#160;In&#160;order&#160;to<br/>obtain&#160;super-regular&#160;new&#160;candidacy&#160;graphs,&#160;we&#160;need&#160;to&#160;take&#160;special&#160;care&#160;of&#160;some&#160;vertices.<br/>
Consider&#160;i&#160;∈&#160;[r].&#160;We&#160;say&#160;that&#160;a&#160;vertex&#160;v&#160;∈&#160;V&#160;′i&#160;is&#160;<i>good&#160;</i>if<br/>
(5.4)<br/>
dA′i(v,&#160;X∗i,j)&#160;≥&#160;(d′&#160;−&#160;8∆2ε)|X∗i,j|<br/>
for&#160;all&#160;j&#160;∈&#160;[∆2].&#160;By&#160;Fact&#160;<a href="1802.07700s.html#15">5.5&#160;</a>and&#160;since&#160;A′i&#160;is&#160;lower&#160;(8∆2ε,&#160;d′)-regular,&#160;all&#160;but&#160;at&#160;most&#160;8∆4ε|Vi|&#160;vertices<br/>of&#160;Vi&#160;are&#160;good.&#160;Let&#160;V&#160;′′<br/>
i<br/>
be&#160;the&#160;set&#160;of&#160;good&#160;vertices&#160;of&#160;V&#160;′i.&#160;Thus,√<br/>
(5.5)<br/>
|Vi&#160;\&#160;V&#160;′′<br/>
i&#160;|&#160;≤&#160;8∆4ε|Vi|&#160;+&#160;ai&#160;≤<br/>
ε|Vi|.<br/>
We&#160;now&#160;partition&#160;V&#160;′i&#160;into&#160;equal-sized&#160;parts&#160;V&#160;∗<br/>
i,1,&#160;.&#160;.&#160;.&#160;,&#160;V&#160;∗<br/>
i,∆2&#160;of&#160;size&#160;exactly&#160;n′/∆2&#160;=&#160;n∗/r∗&#160;each.&#160;First,<br/>
we&#160;take&#160;care&#160;of&#160;the&#160;vertices&#160;which&#160;are&#160;not&#160;good.&#160;For&#160;every&#160;v&#160;∈&#160;V&#160;′i&#160;\&#160;V&#160;′′<br/>
i&#160;,&#160;choose&#160;j&#160;∈&#160;[∆2]&#160;such&#160;that<br/>
√<br/>
dA′i(v,&#160;X∗i,j)&#160;≥&#160;(d′&#160;−&#160;ε)|X∗i,j|.&#160;Clearly,&#160;such&#160;an&#160;index&#160;j&#160;∈&#160;[∆2]&#160;exists&#160;since&#160;dA′i(v)&#160;≥&#160;(d′&#160;−&#160;8∆2ε)|Xi|&#160;≥<br/>
√<br/>
(d′&#160;−&#160;ε)|X′i|.&#160;For&#160;j&#160;∈&#160;[∆2],&#160;let&#160;V&#160;′i,j&#160;be&#160;the&#160;set&#160;of&#160;all&#160;vertices&#160;v&#160;∈&#160;V&#160;′i&#160;\&#160;V&#160;′′<br/>
i<br/>
which&#160;have&#160;been&#160;assigned&#160;to&#160;j<br/>
in&#160;this&#160;way.<br/>
Now,&#160;for&#160;each&#160;i&#160;∈&#160;[r],&#160;let&#160;V&#160;′′<br/>
i,1,&#160;.&#160;.&#160;.&#160;,&#160;V&#160;′′<br/>
i,∆2&#160;be&#160;a&#160;partition&#160;of&#160;V&#160;′′<br/>
i<br/>
such&#160;that&#160;|V&#160;′′<br/>
i,j&#160;|&#160;=&#160;n′/∆2&#160;−&#160;|V&#160;′<br/>
i,j&#160;|&#160;and&#160;such<br/>
that&#160;the&#160;following&#160;hold:&#160;for&#160;all&#160;i&#160;∈&#160;[r],&#160;i′&#160;∈&#160;NR(i),&#160;v&#160;∈&#160;Vi&#160;and&#160;j′&#160;∈&#160;[∆2],&#160;we&#160;have<br/>
√<br/>
(5.6)<br/>
dG(v,&#160;V&#160;′′<br/>
i′,j′&#160;)&#160;≥&#160;(d&#160;−&#160;3<br/>
ε)|V&#160;′′<br/>
i′,j′&#160;|,<br/>
and&#160;for&#160;all&#160;i&#160;∈&#160;[r],&#160;x&#160;∈&#160;Xi&#160;and&#160;j&#160;∈&#160;[∆2],&#160;we&#160;have<br/>
√<br/>
(5.7)<br/>
dA′i(x,&#160;V&#160;′′<br/>
i,j&#160;)&#160;≥&#160;(d′&#160;−&#160;3<br/>
ε)|V&#160;′′<br/>
i,j&#160;|.<br/>
That&#160;such&#160;partitions&#160;exist&#160;can&#160;be&#160;seen&#160;using&#160;a&#160;probabilistic&#160;argument&#160;as&#160;follows:&#160;For&#160;each&#160;i&#160;∈&#160;[r],&#160;let<br/>
V&#160;′′<br/>
i,1,&#160;.&#160;.&#160;.&#160;,&#160;V&#160;′′<br/>
i,∆2&#160;be&#160;a&#160;partition&#160;of&#160;V&#160;′′<br/>
i<br/>
such&#160;that&#160;|V&#160;′′<br/>
i,j&#160;|&#160;=&#160;n′/∆2&#160;−&#160;|V&#160;′<br/>
i,j&#160;|,&#160;chosen&#160;uniformly&#160;at&#160;random&#160;amongst<br/>
all&#160;such&#160;partitions.&#160;(We&#160;may&#160;also&#160;assume&#160;that&#160;the&#160;partitions&#160;of&#160;V&#160;′′<br/>
i<br/>
and&#160;V&#160;′′<br/>
i′&#160;,&#160;say,&#160;are&#160;independent,&#160;but<br/>
this&#160;is&#160;not&#160;even&#160;necessary.)&#160;In&#160;particular,&#160;for&#160;all&#160;(i,&#160;j)&#160;∈&#160;[r]&#160;×&#160;[∆2],&#160;the&#160;set&#160;V&#160;′′<br/>
i,j&#160;is&#160;a&#160;uniformly&#160;random<br/>
subset&#160;of&#160;V&#160;′′<br/>
i<br/>
of&#160;size&#160;n′/∆2&#160;−&#160;|V&#160;′i,j|.&#160;Note&#160;that&#160;for&#160;all&#160;i&#160;∈&#160;[r],&#160;i′&#160;∈&#160;NR(i),&#160;v&#160;∈&#160;Vi,&#160;we&#160;have<br/>
<a href="1802.07700s.html#16">(5.5)</a><br/>
√<br/>
√<br/>
dG(v,&#160;V&#160;′′<br/>
i′&#160;)<br/>
≥&#160;(d&#160;−&#160;ε)|Vi′&#160;|&#160;−&#160;ε|Vi′&#160;|&#160;≥&#160;(d&#160;−&#160;2&#160;ε)|V&#160;′′<br/>
i′&#160;|.<br/>
<br/>
<br/>
√<br/>
Thus,&#160;for&#160;all&#160;j′&#160;∈&#160;[∆2],&#160;we&#160;have&#160;E&#160;dG(v,&#160;V&#160;′′<br/>
ε)<br/>
i′,j′&#160;)<br/>
≥&#160;(d&#160;−&#160;2<br/>
|V&#160;′′<br/>
i′,j′&#160;|.&#160;Similarly,&#160;for&#160;all&#160;i&#160;∈&#160;[r],&#160;x&#160;∈&#160;Xi<br/>
<br/>
<br/>
√<br/>
and&#160;j&#160;∈&#160;[∆2],&#160;we&#160;have&#160;E&#160;dA′i(x,&#160;V&#160;′′<br/>
i,j&#160;)<br/>
≥&#160;(d′&#160;−&#160;2&#160;ε)|V&#160;′′<br/>
i,j&#160;|.&#160;Using&#160;a&#160;Chernoff-Hoeffding-type&#160;bound&#160;for<br/>
the&#160;hypergeometric&#160;distribution&#160;and&#160;a&#160;union&#160;bound,&#160;we&#160;can&#160;see&#160;that&#160;<a href="1802.07700s.html#16">(5.6)&#160;</a>and&#160;<a href="1802.07700s.html#16">(5.7)&#160;</a>are&#160;satisfied&#160;with<br/>positive&#160;probability.<br/>
Finally,&#160;for&#160;(i,&#160;j)&#160;∈&#160;[r]&#160;×&#160;[∆2],&#160;let&#160;V&#160;∗<br/>
i,j&#160;:=&#160;V&#160;′<br/>
i,j&#160;∪&#160;V&#160;′′<br/>
i,j&#160;.&#160;We&#160;claim&#160;that&#160;for&#160;all&#160;(i,&#160;j)(i′,&#160;j′)&#160;∈&#160;E(R∗),&#160;the<br/>
√<br/>
bipartite&#160;graph&#160;G[V&#160;∗<br/>
i,j&#160;,&#160;V&#160;∗<br/>
ε,&#160;d)-super-regular.&#160;Indeed,&#160;it&#160;follows&#160;simply&#160;from&#160;the&#160;lower<br/>
i′,j′&#160;]&#160;is&#160;lower&#160;(3<br/>
(ε,&#160;d)-regularity&#160;of&#160;the&#160;pairs&#160;G[Vi,&#160;Vi′&#160;]&#160;for&#160;ii′&#160;∈&#160;E(R)&#160;that&#160;G[V&#160;∗<br/>
i,j&#160;,&#160;V&#160;∗<br/>
i′,j′&#160;]&#160;is&#160;lower&#160;(2∆2ε,&#160;d)-regular,&#160;say.<br/>
That&#160;every&#160;vertex&#160;has&#160;large&#160;enough&#160;degree&#160;in&#160;the&#160;respective&#160;pair&#160;follows&#160;from&#160;<a href="1802.07700s.html#16">(5.6)</a>.<br/>
√<br/>
Similarly,&#160;for&#160;all&#160;(i,&#160;j)&#160;∈&#160;[r]&#160;×&#160;[∆2],&#160;the&#160;new&#160;candidacy&#160;graph&#160;A(i,j)&#160;:=&#160;A′i[X∗i,j,&#160;V&#160;∗<br/>
i,j&#160;]&#160;is&#160;lower&#160;(3<br/>
ε,&#160;d′)-<br/>
super-regular.&#160;Here,&#160;every&#160;vertex&#160;x&#160;∈&#160;X∗i,j&#160;has&#160;sufficiently&#160;high&#160;degree&#160;in&#160;V&#160;∗<br/>
i,j&#160;by&#160;<a href="1802.07700s.html#16">(5.7)</a>.&#160;Moreover,&#160;all<br/>
good&#160;vertices&#160;of&#160;V&#160;′i&#160;have&#160;automatically&#160;sufficiently&#160;high&#160;degree&#160;by&#160;<a href="1802.07700s.html#16">(5.4)</a>,&#160;and&#160;all&#160;vertices&#160;which&#160;are&#160;not<br/>good&#160;have&#160;sufficiently&#160;high&#160;degree&#160;in&#160;their&#160;new&#160;candidate&#160;graph&#160;because&#160;of&#160;their&#160;assignment&#160;to&#160;a&#160;set&#160;V&#160;′i,j.<br/>
Finally,&#160;using&#160;Proposition&#160;<a href="1802.07700s.html#14">5.4,&#160;</a>we&#160;can&#160;transition&#160;to&#160;a&#160;spanning&#160;subgraph&#160;G∗&#160;of&#160;G&#160;such&#160;that&#160;G∗[V&#160;∗<br/>
i,j&#160;,&#160;V&#160;∗<br/>
i,j′&#160;]<br/>
is&#160;(ε∗,&#160;d2/2)-super-regular&#160;for&#160;all&#160;(i,&#160;j)(i′,&#160;j′)&#160;∈&#160;E(R∗),&#160;and&#160;for&#160;each&#160;(i,&#160;j)&#160;∈&#160;[r]&#160;×&#160;[∆2],&#160;we&#160;can&#160;transition<br/>
<hr/>
<a name=17></a><img class="yflip" src="html/1802.07700-17_1.png"/><br/>
<img class="yflip" src="html/1802.07700-17_2.png"/><br/>
<img class="yflip" src="html/1802.07700-17_3.png"/><br/>
<img class="yflip" src="html/1802.07700-17_4.png"/><br/>
<img class="yflip" src="html/1802.07700-17_5.png"/><br/>
<img class="yflip" src="html/1802.07700-17_6.png"/><br/>
<img class="yflip" src="html/1802.07700-17_7.png"/><br/>
<img class="yflip" src="html/1802.07700-17_8.png"/><br/>
<img class="yflip" src="html/1802.07700-17_9.png"/><br/>
<img class="yflip" src="html/1802.07700-17_10.png"/><br/>
<img class="yflip" src="html/1802.07700-17_11.png"/><br/>
<img class="yflip" src="html/1802.07700-17_12.png"/><br/>
<img class="yflip" src="html/1802.07700-17_13.png"/><br/>
<img class="yflip" src="html/1802.07700-17_14.png"/><br/>
<img class="yflip" src="html/1802.07700-17_15.png"/><br/>
<img class="yflip" src="html/1802.07700-17_16.png"/><br/>
<img class="yflip" src="html/1802.07700-17_17.png"/><br/>
<img class="yflip" src="html/1802.07700-17_18.png"/><br/>
<img class="yflip" src="html/1802.07700-17_19.png"/><br/>
<img class="yflip" src="html/1802.07700-17_20.png"/><br/>
<img class="yflip" src="html/1802.07700-17_21.png"/><br/>
<img class="yflip" src="html/1802.07700-17_22.png"/><br/>
<img class="yflip" src="html/1802.07700-17_23.png"/><br/>
<img class="yflip" src="html/1802.07700-17_24.png"/><br/>
<img class="yflip" src="html/1802.07700-17_25.png"/><br/>
<img class="yflip" src="html/1802.07700-17_26.png"/><br/>
<img class="yflip" src="html/1802.07700-17_27.png"/><br/>
<img class="yflip" src="html/1802.07700-17_28.png"/><br/>
17<br/>
to&#160;a&#160;spanning&#160;subgraph&#160;A∗(i,j)&#160;of&#160;A(i,j)&#160;such&#160;that&#160;A∗(i,j)&#160;is&#160;(ε∗,&#160;d′2/2)-super-regular.&#160;Note&#160;that&#160;we&#160;do<br/>not&#160;delete&#160;any&#160;edges&#160;incident&#160;to&#160;V&#160;∗<br/>
0&#160;.<br/>
<i>Step&#160;</i>4<i>:&#160;Applying&#160;Lemma&#160;5.2</i><br/>
We&#160;can&#160;now&#160;complete&#160;the&#160;proof.&#160;It&#160;remains&#160;to&#160;check&#160;that&#160;φ∗0&#160;is&#160;feasible.<br/>First,&#160;consider&#160;x&#160;∈&#160;X∗0,&#160;(i,&#160;j)&#160;∈&#160;[r]&#160;×&#160;[∆2]&#160;and&#160;y&#160;∈&#160;NH∗(x)&#160;∩&#160;X∗i,j.&#160;If&#160;y&#160;∈&#160;Wa,&#160;then&#160;we&#160;must&#160;have<br/>
x&#160;∈&#160;X0&#160;and&#160;thus&#160;NAi(y)&#160;⊆&#160;NG(φ0(x))&#160;by&#160;<a href="1802.07700s.html#13">(EXC1)&#160;</a>for&#160;φ0.&#160;If&#160;y&#160;∈&#160;Wb,&#160;then&#160;we&#160;have&#160;NA′i(y)&#160;⊆&#160;NG(φ∗0(x))<br/>by&#160;the&#160;definition&#160;of&#160;A′i.&#160;In&#160;both&#160;cases,&#160;we&#160;conclude&#160;that&#160;NA′i(y)&#160;⊆&#160;NG∗(φ∗0(x))&#160;since&#160;edges&#160;in&#160;G&#160;are&#160;only<br/>removed&#160;between&#160;regular&#160;pairs.&#160;Since&#160;A∗(i,j)&#160;is&#160;a&#160;subgraph&#160;of&#160;A′i,&#160;we&#160;have&#160;NA∗(i,j)(y)&#160;⊆&#160;NG∗(φ∗0(x)).<br/>Thus,&#160;<a href="1802.07700s.html#13">(EXC1)&#160;</a>holds&#160;for&#160;φ∗0.<br/>
Condition&#160;<a href="1802.07700s.html#13">(EXC2)&#160;</a>also&#160;holds&#160;for&#160;φ∗0&#160;because&#160;only&#160;the&#160;vertices&#160;in&#160;Wb&#160;gained&#160;a&#160;new&#160;neighbour&#160;in&#160;X∗0.<br/>
However,&#160;as&#160;each&#160;y&#160;∈&#160;Wb&#160;only&#160;has&#160;one&#160;neighbour&#160;in&#160;X∗0,&#160;the&#160;condition&#160;holds&#160;trivially.<br/>
Finally,&#160;consider&#160;<a href="1802.07700s.html#13">(EXC3).&#160;</a>Let&#160;α&#160;∈&#160;C.&#160;Note&#160;that&#160;dH∗(x)&#160;=&#160;dH(x)&#160;≤&#160;∆&#160;for&#160;all&#160;x&#160;∈&#160;X∗0&#160;\&#160;X0.&#160;Thus,<br/>
X<br/>
dG∗&#160;(φ∗<br/>
α<br/>
0&#160;(x))&#160;·&#160;dH∗&#160;(x)&#160;≤&#160;2∆µn<br/>
x∈X∗\X<br/>
0<br/>
0<br/>
P<br/>
and&#160;hence<br/>
d<br/>
(φ∗<br/>
x∈X∗<br/>
G∗<br/>
0&#160;(x))&#160;·&#160;dH∗&#160;(x)&#160;≤&#160;2∆µn&#160;+&#160;2∆µn&#160;≤&#160;µ0.9n∗.<br/>
0<br/>
α<br/>
Therefore,&#160;φ∗0&#160;is&#160;µ0.9n∗-feasible.&#160;Now&#160;apply&#160;Lemma&#160;<a href="1802.07700s.html#14">5.2&#160;</a>as&#160;follows:<br/>
n<br/>
µ<br/>
ε<br/>
d<br/>
∆<br/>
r<br/>
H<br/>
G<br/>
R<br/>
Xi<br/>
Vi<br/>
Ai<br/>
c<br/>
φ0<br/>
n∗<br/>
µ0.9<br/>
ε∗<br/>
d4/8<br/>
∆3<br/>
r∗<br/>
H∗<br/>
G∗<br/>
R∗<br/>
X∗i,j&#160;V&#160;∗<br/>
i,j<br/>
A∗(i,j)<br/>
c↾E(G∗)&#160;φ∗0<br/>
This&#160;yields&#160;a&#160;rainbow&#160;embedding&#160;φ&#160;of&#160;H∗&#160;into&#160;G∗&#160;which&#160;extends&#160;φ∗0&#160;such&#160;that&#160;φ(x)&#160;∈&#160;NA∗(i,j)(x)&#160;for<br/>
all&#160;(i,&#160;j)&#160;∈&#160;[r]&#160;×&#160;[∆2]&#160;and&#160;x&#160;∈&#160;X∗i,j.&#160;Clearly,&#160;φ&#160;is&#160;thus&#160;a&#160;rainbow&#160;embedding&#160;of&#160;H&#160;into&#160;G&#160;which&#160;extends<br/>φ0&#160;such&#160;that&#160;φ(x)&#160;∈&#160;NAi(x)&#160;for&#160;all&#160;i&#160;∈&#160;[r]&#160;and&#160;x&#160;∈&#160;Xi.<br/>
<br/>
5.2.&#160;The&#160;Four&#160;graphs&#160;lemma.&#160;In&#160;this&#160;subsection,&#160;we&#160;state&#160;the&#160;so-called&#160;‘Four&#160;graphs&#160;lemma’&#160;due&#160;to<br/>R¨<br/>
odl&#160;and&#160;Ruci´<br/>
nski,&#160;which&#160;is&#160;an&#160;important&#160;ingredient&#160;in&#160;the&#160;proof&#160;of&#160;the&#160;blow-up&#160;lemma.<br/>
Let&#160;V1,&#160;V2,&#160;V3&#160;be&#160;three&#160;disjoint&#160;sets&#160;of&#160;size&#160;n.&#160;Suppose&#160;Gi,j,&#160;for&#160;1&#160;≤&#160;i&#160;&lt;&#160;j&#160;≤&#160;3,&#160;is&#160;an&#160;(ε,&#160;di,j)-super-<br/>
regular&#160;bipartite&#160;graph&#160;with&#160;vertex&#160;partition&#160;(Vi,&#160;Vj)&#160;and&#160;for&#160;all&#160;v1v2&#160;∈&#160;E(G1,2)&#160;(with&#160;v1&#160;∈&#160;V1),&#160;we<br/>have<br/>
(5.8)<br/>
|NG&#160;(v<br/>
(v<br/>
1,3<br/>
1)&#160;∩&#160;NG2,3<br/>
2)|&#160;=&#160;(d1,3d2,3&#160;±&#160;ε)n.<br/>
In&#160;such&#160;a&#160;case&#160;we&#160;say&#160;that&#160;the&#160;triple&#160;(G1,2,&#160;G1,3,&#160;G2,3)&#160;is&#160;(ε,&#160;d1,2,&#160;d1,3,&#160;d2,3)-regular.&#160;For&#160;a&#160;perfect&#160;matching<br/>σ&#160;:&#160;V1&#160;→&#160;V2&#160;of&#160;G1,2,&#160;let&#160;Aσ&#160;be&#160;the&#160;spanning&#160;subgraph&#160;of&#160;G1,3&#160;such&#160;that&#160;v1v3&#160;∈&#160;E(Aσ)&#160;(with&#160;vi&#160;∈&#160;Vi&#160;for<br/>i&#160;∈&#160;{1,&#160;3})&#160;if&#160;σ(v1)v3&#160;∈&#160;E(G2,3).<br/>
Lemma&#160;5.6&#160;(Four&#160;graphs&#160;lemma,&#160;see&#160;<a href="1802.07700s.html#29">[43])</a>.&#160;<i>Suppose&#160;</i>1/n&#160;≪&#160;a&#160;≪&#160;ε&#160;≪&#160;ε′&#160;≪&#160;d1,2,&#160;d1,3,&#160;d2,3<i>.&#160;Suppose<br/></i>(G1,2,&#160;G1,3,&#160;G2,3)&#160;<i>is&#160;</i>(ε,&#160;d1,2,&#160;d1,3,&#160;d2,3)<i>-regular&#160;on&#160;the&#160;vertex&#160;set&#160;</i>V1&#160;∪&#160;V2&#160;∪&#160;V3<i>.&#160;Suppose&#160;</i>σ&#160;:&#160;V1&#160;→&#160;V2&#160;<i>is&#160;a<br/>perfect&#160;matching&#160;of&#160;</i>G1,2&#160;<i>drawn&#160;uniformly&#160;at&#160;random,&#160;then</i><br/>
P&#160;[Aσ&#160;<i>is&#160;</i>(ε′,&#160;d1,3d2,3)<i>-super-regular</i>]&#160;≥&#160;1&#160;−&#160;(1&#160;−&#160;a)n.<br/>
The&#160;following&#160;proposition&#160;is&#160;useful&#160;when&#160;the&#160;graphs&#160;Gi,j&#160;are&#160;super-regular,&#160;but&#160;<a href="1802.07700s.html#17">(5.8)&#160;</a>is&#160;not&#160;satisfied.<br/>
One&#160;can&#160;always&#160;delete&#160;a&#160;small&#160;fraction&#160;of&#160;the&#160;edges&#160;of&#160;G1,2&#160;such&#160;that&#160;<a href="1802.07700s.html#17">(5.8)&#160;</a>is&#160;then&#160;satisfied.&#160;The&#160;proof<br/>is&#160;based&#160;on&#160;standard&#160;regularity&#160;methods&#160;and&#160;thus&#160;omitted.&#160;(See&#160;also&#160;Fact&#160;1&#160;in&#160;<a href="1802.07700s.html#29">[43]&#160;</a>for&#160;a&#160;very&#160;similar<br/>statement.)<br/>
Proposition&#160;5.7.&#160;<i>Let&#160;</i>1/n&#160;≪&#160;ε&#160;≪&#160;d,&#160;1/k<i>.&#160;Let&#160;</i>V1,&#160;.&#160;.&#160;.&#160;,&#160;Vk+2&#160;<i>be&#160;disjoint&#160;vertex&#160;sets&#160;of&#160;size&#160;</i>n<i>.&#160;Suppose<br/>that&#160;</i>G1,2&#160;<i>is&#160;an&#160;</i>(ε,&#160;d1,2)<i>-super-regular&#160;bipartite&#160;graph&#160;with&#160;bipartition&#160;</i>(V1,&#160;V2)<i>,&#160;where&#160;</i>d1,2&#160;≥&#160;d<i>,&#160;and&#160;for&#160;all<br/></i>i&#160;∈&#160;[2]&#160;<i>and&#160;</i>j&#160;∈&#160;{3,&#160;.&#160;.&#160;.&#160;,&#160;k&#160;+&#160;2}<i>,&#160;</i>Gi,j&#160;<i>is&#160;an&#160;</i>(ε,&#160;di,j)<i>-super-regular&#160;bipartite&#160;graph&#160;with&#160;bipartition&#160;</i>(Vi,&#160;Vj)<i>,<br/>where&#160;</i>di,j&#160;≥&#160;d<i>.&#160;Let&#160;</i>G′1,2&#160;<i>be&#160;the&#160;spanning&#160;subgraph&#160;of&#160;</i>G1,2&#160;<i>consisting&#160;of&#160;those&#160;edges&#160;</i>v1v2&#160;∈&#160;E(G1,2)<br/><i>(with&#160;</i>v1&#160;∈&#160;V1,&#160;v2&#160;∈&#160;V2<i>)&#160;which&#160;satisfy&#160;the&#160;following:&#160;</i>|NG&#160;(v<br/>
(v<br/>
1,j<br/>
1)&#160;∩&#160;NG2,j<br/>
2)|&#160;=&#160;(d1,j&#160;d2,j&#160;±&#160;ε)n&#160;<i>for&#160;all</i><br/>
√<br/>
j&#160;∈&#160;{3,&#160;.&#160;.&#160;.&#160;,&#160;k&#160;+&#160;2}<i>.&#160;Then&#160;</i>G′1,2&#160;<i>is&#160;still&#160;</i>(2k&#160;ε,&#160;d1,2)<i>-super-regular.</i><br/>
We&#160;close&#160;this&#160;subsection&#160;by&#160;giving&#160;some&#160;intuition&#160;as&#160;to&#160;how&#160;the&#160;Four&#160;graphs&#160;lemma&#160;is&#160;applied.&#160;Suppose<br/>
that&#160;we&#160;embed&#160;cluster&#160;Xi&#160;into&#160;Vi&#160;by&#160;choosing&#160;a&#160;perfect&#160;matching&#160;σ&#160;in&#160;a&#160;suitable&#160;candidacy&#160;graph&#160;Ai<br/>with&#160;bipartition&#160;(Xi,&#160;Vi).&#160;Suppose&#160;we&#160;have&#160;not&#160;embedded&#160;cluster&#160;Xj&#160;yet.&#160;In&#160;order&#160;to&#160;proceed&#160;with&#160;the<br/>embedding,&#160;we&#160;need&#160;to&#160;update&#160;the&#160;candidacy&#160;graph&#160;Aj.&#160;This&#160;involves&#160;the&#160;graphs&#160;H[Xi,&#160;Xj],&#160;Ai,&#160;Aj,<br/>and&#160;G[Vi,&#160;Vj].&#160;More&#160;precisely,&#160;suppose&#160;that&#160;x&#160;∈&#160;Xj&#160;and&#160;that&#160;v&#160;∈&#160;Vj&#160;is&#160;a&#160;candidate&#160;for&#160;x&#160;before&#160;the<br/>embedding&#160;of&#160;Xi.&#160;After&#160;embedding&#160;Xi,&#160;vertex&#160;v&#160;remains&#160;a&#160;valid&#160;candidate&#160;for&#160;x&#160;if&#160;and&#160;only&#160;if&#160;it&#160;is<br/>suitably&#160;connected&#160;to&#160;the&#160;images&#160;of&#160;the&#160;neighbours&#160;of&#160;x&#160;which&#160;are&#160;already&#160;embedded.&#160;Now,&#160;if&#160;H[Xi,&#160;Xj]<br/>
<hr/>
<a name=18></a><img class="yflip" src="html/1802.07700-18_1.png"/><br/>
18<br/>
S.&#160;GLOCK&#160;AND&#160;F.&#160;JOOS<br/>
is&#160;a&#160;perfect&#160;matching,&#160;we&#160;can&#160;define&#160;the&#160;bijection&#160;π&#160;:&#160;Xj&#160;→&#160;Xi&#160;where&#160;π(x)&#160;is&#160;the&#160;unique&#160;H-neighbour&#160;of<br/>x&#160;in&#160;Xi.&#160;With&#160;this&#160;notation,&#160;v&#160;remains&#160;a&#160;valid&#160;candidate&#160;for&#160;x&#160;if&#160;and&#160;only&#160;if&#160;σ(π(x))v&#160;∈&#160;E(G[Vi,&#160;Vj]).<br/>We&#160;can&#160;now&#160;identify&#160;Xj&#160;with&#160;Xi&#160;according&#160;to&#160;π.&#160;More&#160;precisely,&#160;define&#160;the&#160;graph&#160;P&#160;with&#160;bipartition<br/>(Xi,&#160;Vj)&#160;which&#160;is&#160;isomorphic&#160;to&#160;Aj,&#160;where&#160;π(x)&#160;plays&#160;the&#160;role&#160;of&#160;x.&#160;We&#160;are&#160;now&#160;left&#160;with&#160;three&#160;vertex<br/>sets&#160;Xi,&#160;Vi,&#160;Vj&#160;and&#160;the&#160;three&#160;graphs&#160;Ai,&#160;P,&#160;G[Vi,&#160;Vj].&#160;In&#160;this&#160;setting,&#160;we&#160;can&#160;apply&#160;the&#160;Four&#160;graphs&#160;lemma,<br/>which&#160;yields&#160;a&#160;super-regular&#160;spanning&#160;subgraph&#160;Pσ&#160;of&#160;P&#160;,&#160;which,&#160;via&#160;π,&#160;translates&#160;back&#160;to&#160;the&#160;updated<br/>candidacy&#160;graph&#160;for&#160;(Xj,&#160;Vj).<br/>
5.3.&#160;Conflict-free&#160;perfect&#160;matchings.&#160;A&#160;<i>system&#160;of&#160;conflicts&#160;</i>in&#160;a&#160;graph&#160;G&#160;is&#160;a&#160;set&#160;F&#160;of&#160;unordered<br/>pairs&#160;of&#160;edges.&#160;If&#160;{e,&#160;f}&#160;∈&#160;F,&#160;we&#160;say&#160;that&#160;e&#160;and&#160;f&#160;<i>conflict</i>.&#160;We&#160;say&#160;that&#160;F&#160;is&#160;k-bounded&#160;if&#160;every&#160;edge&#160;is<br/>contained&#160;in&#160;at&#160;most&#160;k&#160;conflicts.&#160;A&#160;subgraph&#160;H&#160;is&#160;<i>conflict-free&#160;</i>if&#160;no&#160;two&#160;edges&#160;of&#160;H&#160;conflict.<br/>
Let&#160;G&#160;be&#160;a&#160;bipartite&#160;graph&#160;with&#160;vertex&#160;classes&#160;A,&#160;B&#160;such&#160;that&#160;|A|&#160;=&#160;|B|&#160;=&#160;n.&#160;Suppose&#160;M&#160;is&#160;a&#160;perfect<br/>
matching&#160;of&#160;G&#160;and&#160;e&#160;=&#160;a1b1&#160;∈&#160;M.&#160;An&#160;edge&#160;ab&#160;∈&#160;E(G)&#160;\&#160;M&#160;is&#160;(e,&#160;M)<i>-switchable&#160;</i>if&#160;a1b2,&#160;a2b1&#160;∈&#160;E(G),<br/>where&#160;a2&#160;and&#160;b2&#160;are&#160;matched&#160;to&#160;b&#160;and&#160;a&#160;by&#160;M&#160;,&#160;respectively,&#160;i.e.&#160;a2b,&#160;ab2&#160;∈&#160;M.<br/>
The&#160;following&#160;lemma&#160;from&#160;<a href="1802.07700s.html#29">[12]&#160;</a>is&#160;another&#160;important&#160;tool&#160;in&#160;our&#160;proof.&#160;Its&#160;proof&#160;is&#160;based&#160;on&#160;the<br/>
Lopsided&#160;Lov´asz&#160;local&#160;lemma.&#160;In&#160;<a href="1802.07700s.html#29">[12],&#160;</a>it&#160;is&#160;used&#160;to&#160;show&#160;the&#160;existence&#160;of&#160;conflict-free&#160;perfect&#160;matchings<br/>in&#160;Dirac&#160;bipartite&#160;graphs.<br/>
Lemma&#160;5.8&#160;(Coulson&#160;and&#160;Perarnau&#160;<a href="1802.07700s.html#29">[12,&#160;</a>Lemma&#160;6]).&#160;<i>Suppose&#160;</i>1/n&#160;≪&#160;µ&#160;≪&#160;γ<i>.&#160;Let&#160;</i>G&#160;<i>be&#160;a&#160;bipartite<br/>graph&#160;with&#160;bipartition&#160;</i>(A,&#160;B)&#160;<i>such&#160;that&#160;</i>|A|&#160;=&#160;|B|&#160;=&#160;n<i>.&#160;Assume&#160;that&#160;</i>G&#160;<i>has&#160;at&#160;least&#160;one&#160;perfect&#160;matching,<br/>and&#160;for&#160;every&#160;perfect&#160;matching&#160;</i>M&#160;<i>of&#160;</i>G&#160;<i>and&#160;for&#160;every&#160;</i>e&#160;∈&#160;M&#160;<i>there&#160;are&#160;at&#160;least&#160;</i>γn2&#160;<i>edges&#160;in&#160;</i>G&#160;<i>that&#160;are<br/></i>(e,&#160;M&#160;)<i>-switchable.&#160;Then,&#160;given&#160;any&#160;</i>µn<i>-bounded&#160;system&#160;of&#160;conflicts&#160;for&#160;</i>G<i>,&#160;a&#160;uniformly&#160;chosen&#160;perfect<br/>matching&#160;of&#160;</i>G&#160;<i>is&#160;conflict-free&#160;with&#160;probability&#160;at&#160;least&#160;</i>e−µ1/2n<i>.</i><br/>
We&#160;will&#160;apply&#160;it&#160;to&#160;find&#160;conflict-free&#160;perfect&#160;matchings&#160;of&#160;our&#160;candidacy&#160;graphs.&#160;It&#160;is&#160;easy&#160;to&#160;see&#160;that<br/>
there&#160;are&#160;many&#160;switchings&#160;in&#160;an&#160;(ε,&#160;d)-super-regular&#160;graph.<br/>
Proposition&#160;5.9.&#160;<i>Let&#160;</i>1/n&#160;≪&#160;ε&#160;≪&#160;d<i>.&#160;Let&#160;</i>G&#160;<i>be&#160;a&#160;bipartite&#160;graph&#160;with&#160;bipartition&#160;</i>(A,&#160;B)&#160;<i>such&#160;that<br/></i>|A|&#160;=&#160;|B|&#160;=&#160;n&#160;<i>and&#160;</i>G&#160;<i>is&#160;lower&#160;</i>(ε,&#160;d)<i>-super-regular.&#160;Then&#160;</i>G&#160;<i>has&#160;a&#160;perfect&#160;matching.&#160;Moreover,&#160;for<br/>every&#160;perfect&#160;matching&#160;</i>M&#160;<i>of&#160;</i>G&#160;<i>and&#160;every&#160;</i>e&#160;∈&#160;M<i>,&#160;there&#160;are&#160;at&#160;least&#160;</i>(d&#160;−&#160;2ε)3n2&#160;<i>edges&#160;in&#160;</i>G&#160;<i>that&#160;are<br/></i>(e,&#160;M&#160;)<i>-switchable.</i><br/>
Proof.&#160;It&#160;is&#160;well&#160;known&#160;that&#160;G&#160;has&#160;a&#160;perfect&#160;matching.&#160;Let&#160;M&#160;be&#160;a&#160;perfect&#160;matching&#160;of&#160;G&#160;and&#160;suppose<br/>e&#160;∈&#160;M.&#160;Let&#160;a&#160;∈&#160;A,&#160;b&#160;∈&#160;B&#160;with&#160;e&#160;=&#160;ab.&#160;Define&#160;Na&#160;:=&#160;NG(a)&#160;and&#160;Nb&#160;:=&#160;NG(b).&#160;Moreover,&#160;let&#160;N′a&#160;⊆&#160;A&#160;be<br/>the&#160;set&#160;of&#160;vertices&#160;which&#160;are&#160;matched&#160;to&#160;the&#160;vertices&#160;in&#160;Na&#160;by&#160;M&#160;,&#160;and&#160;let&#160;N&#160;′b&#160;⊆&#160;B&#160;be&#160;the&#160;set&#160;of&#160;vertices<br/>
which&#160;are&#160;matched&#160;to&#160;the&#160;vertices&#160;in&#160;Nb&#160;by&#160;M&#160;.&#160;Clearly,&#160;|N′a|&#160;=&#160;|Na|&#160;and&#160;|N′b|&#160;=&#160;|Nb|.&#160;Note&#160;that&#160;all<br/>edges&#160;in&#160;G[N&#160;′a,&#160;N′]&#160;are&#160;(e,&#160;M)-switchable,&#160;except&#160;those&#160;which&#160;already&#160;belong&#160;to&#160;M.&#160;Since&#160;d<br/>
b<br/>
G(a),&#160;dG(b)&#160;≥<br/>
(d−ε)n&#160;≥&#160;εn,&#160;we&#160;have&#160;dG(N′a,&#160;N′)<br/>
)<br/>
b<br/>
≥&#160;d−ε&#160;and&#160;hence&#160;eG(N′a,&#160;N′b&#160;−|M|&#160;≥&#160;(d−ε)|N′a||N′b|−n&#160;≥&#160;(d−2ε)3n2.<br/>
<br/>
5.4.&#160;Proof&#160;of&#160;Lemma&#160;<a href="1802.07700s.html#14">5.2.&#160;</a>We&#160;are&#160;now&#160;ready&#160;to&#160;prove&#160;the&#160;auxiliary&#160;blow-up&#160;lemma.&#160;We&#160;split&#160;the<br/>proof&#160;into&#160;four&#160;steps.&#160;In&#160;Step&#160;1,&#160;we&#160;show&#160;that&#160;we&#160;may&#160;assume&#160;that&#160;|C|&#160;is&#160;not&#160;too&#160;large.&#160;This&#160;is&#160;needed<br/>for&#160;the&#160;application&#160;of&#160;Lemma&#160;<a href="1802.07700s.html#6">4.1.&#160;</a>We&#160;embed&#160;H&#160;into&#160;G&#160;in&#160;a&#160;number&#160;of&#160;rounds,&#160;which&#160;depends&#160;only&#160;on<br/>∆;&#160;in&#160;particular,&#160;all&#160;vertices&#160;that&#160;belong&#160;to&#160;the&#160;same&#160;cluster&#160;are&#160;embedded&#160;simultaneously.&#160;As&#160;r&#160;may&#160;be<br/>much&#160;larger&#160;than&#160;∆,&#160;we&#160;even&#160;have&#160;to&#160;embed&#160;several&#160;clusters&#160;in&#160;a&#160;single&#160;round&#160;(cf.&#160;Section&#160;<a href="1802.07700s.html#4">2)</a>.&#160;In&#160;Step&#160;2,<br/>we&#160;reserve&#160;for&#160;each&#160;round&#160;a&#160;set&#160;of&#160;colours.&#160;During&#160;the&#160;embedding&#160;procedure,&#160;we&#160;will&#160;in&#160;each&#160;round&#160;only<br/>use&#160;colours&#160;of&#160;G&#160;which&#160;were&#160;assigned&#160;to&#160;this&#160;round.&#160;In&#160;Step&#160;3,&#160;we&#160;set&#160;up&#160;the&#160;induction&#160;statement&#160;and&#160;in<br/>Step&#160;4,&#160;we&#160;perform&#160;the&#160;induction&#160;step.<br/>
Proof&#160;of&#160;Lemma&#160;<a href="1802.07700s.html#14">5.2.</a><br/>
Let&#160;n′&#160;:=&#160;|V&#160;(G)|&#160;=&#160;n&#160;+&#160;|V0|.&#160;By&#160;removing&#160;isolated&#160;vertices&#160;from&#160;X0&#160;and&#160;their<br/>
images&#160;determined&#160;by&#160;φ0&#160;from&#160;V0,&#160;we&#160;can&#160;assume&#160;that&#160;|V0|&#160;≤&#160;∆n&#160;and&#160;hence&#160;n′&#160;≤&#160;(∆&#160;+&#160;1)n.&#160;We&#160;may<br/>clearly&#160;assume&#160;that&#160;V0,&#160;.&#160;.&#160;.&#160;,&#160;Vr&#160;are&#160;independent&#160;in&#160;G.&#160;Let<br/>
d<br/>
T&#160;:=&#160;∆2&#160;+&#160;1,<br/>
d′&#160;:=<br/>
<br/>
and&#160;ε0&#160;:=&#160;2ε.<br/>
T&#160;+1&#160;∆2<br/>
2<br/>
Choose&#160;new&#160;constants&#160;a,&#160;ε1,&#160;.&#160;.&#160;.&#160;,&#160;εT&#160;such&#160;that<br/>
1/n&#160;≪&#160;µ&#160;≪&#160;a&#160;≪&#160;ε&#160;≪&#160;ε1&#160;≪&#160;·&#160;·&#160;·&#160;≪&#160;εT&#160;≪&#160;d,&#160;1/∆.<br/>
<i>Step&#160;</i>1<i>:&#160;Modifying&#160;the&#160;colouring&#160;assignment</i><br/>
<hr/>
<a name=19></a>19<br/>
We&#160;claim&#160;that&#160;we&#160;may&#160;assume&#160;that&#160;|C|&#160;≤&#160;7µ−1∆2n.&#160;Roughly&#160;speaking,&#160;if&#160;two&#160;colours&#160;α,&#160;β&#160;appear&#160;on<br/>
at&#160;most&#160;µn/2&#160;edges&#160;each,&#160;say,&#160;then&#160;we&#160;wish&#160;to&#160;merge&#160;them&#160;to&#160;a&#160;single&#160;colour.&#160;Clearly,&#160;the&#160;new&#160;colouring<br/>will&#160;still&#160;be&#160;(µn,&#160;∆)-bounded&#160;and&#160;any&#160;rainbow&#160;embedding&#160;of&#160;H&#160;in&#160;the&#160;new&#160;colouring&#160;is&#160;also&#160;a&#160;rainbow<br/>embedding&#160;in&#160;the&#160;original&#160;colouring.&#160;However,&#160;we&#160;have&#160;to&#160;be&#160;a&#160;bit&#160;careful&#160;not&#160;to&#160;violate&#160;the&#160;feasibility<br/>of&#160;φ0.&#160;We&#160;start&#160;with&#160;a&#160;simple&#160;observation:<br/>
X&#160;X<br/>
X<br/>
X<br/>
dα<br/>
G(φ0(x))&#160;·&#160;dH&#160;(x)&#160;≤<br/>
dH(x)∆dG(φ0(x))&#160;≤&#160;∆n<br/>
dH(x)&#160;≤&#160;∆2n2.<br/>
α∈C&#160;x∈X0<br/>
x∈X0<br/>
x∈X0<br/>
P<br/>
Hence&#160;there&#160;are&#160;at&#160;most&#160;2µ−1∆2n&#160;colours&#160;α&#160;∈&#160;C&#160;for&#160;which<br/>
dα&#160;(φ<br/>
x∈X<br/>
0(x))&#160;·&#160;dH&#160;(x)&#160;≥&#160;µn/2&#160;holds.&#160;Let<br/>
0<br/>
G<br/>
us&#160;call&#160;these&#160;colours&#160;<i>critical</i>.&#160;In&#160;order&#160;to&#160;ensure&#160;that&#160;<a href="1802.07700s.html#13">(EXC3)&#160;</a>still&#160;holds,&#160;we&#160;will&#160;not&#160;merge&#160;colours&#160;where<br/>one&#160;is&#160;critical.<br/>
We&#160;say&#160;α,&#160;β&#160;∈&#160;C&#160;<i>block&#160;</i>each&#160;other&#160;if&#160;there&#160;exist&#160;distinct&#160;x,&#160;x′&#160;∈&#160;X0,&#160;x′′&#160;∈&#160;NH(x)&#160;∩&#160;NH(x′)&#160;and<br/>
v&#160;∈&#160;NAi(x′′)&#160;for&#160;some&#160;i&#160;∈&#160;[r]&#160;such&#160;that&#160;α&#160;∈&#160;c(φ0(x)v)&#160;and&#160;β&#160;∈&#160;c(φ0(x′)v).&#160;For&#160;<a href="1802.07700s.html#13">(EXC2)&#160;</a>to&#160;be&#160;preserved,<br/>we&#160;must&#160;not&#160;merge&#160;colours&#160;which&#160;block&#160;each&#160;other.&#160;Next&#160;we&#160;seek&#160;an&#160;upper&#160;bound&#160;on&#160;the&#160;number&#160;of<br/>pairs&#160;α,&#160;β&#160;that&#160;block&#160;each&#160;other.&#160;For&#160;any&#160;x,&#160;x′&#160;∈&#160;X0,&#160;x′′&#160;∈&#160;NH(x)&#160;∩&#160;NH(x′),&#160;there&#160;are&#160;clearly&#160;at&#160;most<br/>n&#160;vertices&#160;v&#160;∈&#160;NAi(x′′)&#160;and&#160;for&#160;each&#160;such&#160;v,&#160;there&#160;are&#160;at&#160;most&#160;∆2&#160;such&#160;pairs.&#160;We&#160;claim&#160;that&#160;there<br/>are&#160;at&#160;most&#160;∆2n&#160;choices&#160;for&#160;x,&#160;x′,&#160;x′′&#160;as&#160;above.&#160;Indeed,&#160;there&#160;are&#160;clearly&#160;at&#160;most&#160;n&#160;choices&#160;for&#160;x′′&#160;as<br/>x′′&#160;∈&#160;V&#160;(H)&#160;\&#160;X0&#160;and&#160;as&#160;dH(x′′,&#160;X0)&#160;≤&#160;∆,&#160;we&#160;have&#160;at&#160;most&#160;∆2&#160;choices&#160;for&#160;the&#160;pair&#160;x,&#160;x′.&#160;Hence&#160;there&#160;are<br/>at&#160;most&#160;n&#160;·&#160;∆2&#160;·&#160;n∆2&#160;=&#160;∆4n2&#160;pairs&#160;α,&#160;β&#160;that&#160;block&#160;each&#160;other.&#160;Therefore,&#160;any&#160;set&#160;of&#160;colours&#160;of&#160;size,&#160;say,<br/>10∆2n&#160;contains&#160;a&#160;pair&#160;α,&#160;β&#160;such&#160;that&#160;α,&#160;β&#160;do&#160;not&#160;block&#160;each&#160;other.<br/>
The&#160;following&#160;observation&#160;motivates&#160;our&#160;discussion&#160;above.&#160;Given&#160;α,&#160;β&#160;that&#160;do&#160;not&#160;block&#160;each&#160;other,<br/>
are&#160;both&#160;not&#160;critical,&#160;and&#160;there&#160;are&#160;at&#160;most&#160;µn&#160;edges&#160;on&#160;which&#160;α&#160;or&#160;β&#160;appear,&#160;then&#160;we&#160;may&#160;replace<br/>every&#160;appearance&#160;of&#160;β&#160;by&#160;α&#160;(some&#160;colour&#160;sets&#160;may&#160;become&#160;smaller)&#160;and&#160;the&#160;new&#160;edge&#160;set&#160;colouring&#160;is<br/>still&#160;(µn,&#160;∆)-bounded&#160;and&#160;φ0&#160;is&#160;still&#160;µn-feasible.&#160;In&#160;addition,&#160;any&#160;rainbow&#160;embedding&#160;of&#160;H&#160;in&#160;the&#160;new<br/>colouring&#160;is&#160;also&#160;a&#160;rainbow&#160;embedding&#160;in&#160;the&#160;original&#160;colouring.<br/>
Therefore,&#160;we&#160;may&#160;assume&#160;that&#160;there&#160;are&#160;at&#160;most&#160;2µ−1∆2n&#160;+&#160;10∆2n&#160;≤&#160;3µ−1∆2n&#160;colours&#160;α&#160;∈&#160;C&#160;such<br/>
that&#160;α&#160;appears&#160;on&#160;at&#160;most&#160;µn/2&#160;edges.&#160;Hence&#160;(|C|&#160;−&#160;3µ−1∆2n)&#160;·&#160;µn/2&#160;≤&#160;∆e(G)&#160;≤&#160;2∆2n2,&#160;which&#160;implies<br/>|C|&#160;≤&#160;7µ−1∆2n.<br/>
<i>Step&#160;</i>2<i>:&#160;Colour&#160;splitting</i><br/>
Let&#160;ψ&#160;:&#160;V&#160;(R)&#160;→&#160;[T&#160;]&#160;be&#160;a&#160;proper&#160;vertex&#160;colouring&#160;of&#160;R2.&#160;Moreover,&#160;set&#160;ψ(0)&#160;:=&#160;0.&#160;For&#160;t&#160;∈&#160;[T&#160;]0,&#160;let<br/>
[<br/>
Jt&#160;:=&#160;ψ−1(t)&#160;and&#160;J∗t&#160;:=<br/>
Jℓ.<br/>
ℓ∈[t]0<br/>
Note&#160;that&#160;the&#160;sets&#160;(Jt)t∈[T]&#160;are&#160;2-independent&#160;in&#160;R,&#160;and&#160;J0&#160;=&#160;{0}.<br/>
In&#160;round&#160;t&#160;∈&#160;[T&#160;],&#160;we&#160;will&#160;embed&#160;all&#160;vertices&#160;from&#160;clusters&#160;Xi&#160;with&#160;i&#160;∈&#160;Jt.&#160;In&#160;order&#160;to&#160;reserve&#160;colours<br/>
<br/>
for&#160;the&#160;respective&#160;rounds,&#160;we&#160;first&#160;partition&#160;E(R)&#160;according&#160;to&#160;the&#160;colouring&#160;ψ.&#160;For&#160;t1t2&#160;∈&#160;[T]&#160;,&#160;let<br/>
2<br/>
Et<br/>
:=&#160;{ij&#160;∈&#160;E(R)&#160;:&#160;ψ(i)&#160;=&#160;t<br/>
)<br/>
1&#160;t2<br/>
1,&#160;ψ(j)&#160;=&#160;t2}.&#160;Clearly,&#160;(Et1t2&#160;t1t2∈([T])&#160;is&#160;a&#160;partition&#160;of&#160;E(R)&#160;since<br/>
2<br/>
ψ(i)&#160;6=&#160;ψ(j)&#160;for&#160;all&#160;ij&#160;∈&#160;E(R).&#160;We&#160;will&#160;also&#160;reserve&#160;colours&#160;for&#160;the&#160;edges&#160;that&#160;have&#160;an&#160;endpoint&#160;in&#160;V0.<br/>For&#160;t&#160;∈&#160;[T&#160;],&#160;define&#160;E0t&#160;:=&#160;{{j,&#160;j&#160;+&#160;r}&#160;:&#160;j&#160;∈&#160;Jt}.<br/>
Our&#160;aim&#160;is&#160;now&#160;to&#160;use&#160;Lemma&#160;<a href="1802.07700s.html#6">4.1&#160;</a>to&#160;reserve&#160;for&#160;every&#160;set&#160;(Et<br/>
)<br/>
1&#160;t2&#160;t1t2∈([T&#160;]0)&#160;an&#160;exclusive&#160;set&#160;of&#160;colours,<br/>
2<br/>
and&#160;sparsify&#160;G&#160;accordingly.&#160;This&#160;will&#160;also&#160;let&#160;the&#160;neighbourhoods&#160;of&#160;exceptional&#160;vertices&#160;shrink,&#160;and<br/>thus&#160;we&#160;need&#160;to&#160;update&#160;the&#160;candidacy&#160;graphs&#160;Aj.&#160;To&#160;ensure&#160;that&#160;the&#160;new&#160;candidacy&#160;graphs&#160;are&#160;again<br/>super-regular,&#160;we&#160;define&#160;an&#160;auxiliary&#160;colouring&#160;of&#160;the&#160;candidacy&#160;graphs&#160;and&#160;apply&#160;Lemma&#160;<a href="1802.07700s.html#6">4.1&#160;</a>to&#160;the<br/>
S<br/>
somewhat&#160;artificial&#160;graph&#160;Gexc&#160;:=&#160;G[V&#160;(G)&#160;\&#160;V0]&#160;∪<br/>
Aj&#160;which&#160;is&#160;the&#160;union&#160;of&#160;G[V&#160;(G)<br/>
j∈[r]<br/>
\&#160;V0]&#160;and&#160;all<br/>
the&#160;candidacy&#160;graphs.&#160;For&#160;j&#160;∈&#160;[r],&#160;let&#160;Vj+r&#160;:=&#160;Xj.&#160;Let&#160;Rexc&#160;be&#160;the&#160;graph&#160;on&#160;[2r]&#160;which&#160;is&#160;the&#160;union<br/>of&#160;R&#160;and&#160;the&#160;perfect&#160;matching&#160;{{j,&#160;j&#160;+&#160;r}&#160;:&#160;j&#160;∈&#160;[r]}.&#160;Note&#160;that&#160;Rexc&#160;is&#160;a&#160;reduced&#160;graph&#160;for&#160;Gexc,&#160;and<br/>(Et<br/>
)<br/>
1&#160;t2&#160;t1t2∈([T]0)&#160;is&#160;a&#160;partition&#160;of&#160;E(Rexc).<br/>
2<br/>
We&#160;now&#160;transfer&#160;the&#160;colouring&#160;of&#160;G[V0,&#160;V&#160;(G)\V0]&#160;onto&#160;the&#160;candidacy&#160;graphs&#160;in&#160;a&#160;natural&#160;way:&#160;Consider<br/>
i&#160;∈&#160;[r],&#160;x&#160;∈&#160;Xi&#160;and&#160;v&#160;∈&#160;Vi&#160;with&#160;xv&#160;∈&#160;E(Ai).&#160;Define[<br/>
(5.9)<br/>
cexc(xv)&#160;:=<br/>
c(φ0(x′)v).<br/>
x′∈NH&#160;(x)∩X0<br/>
Note&#160;that&#160;|cexc(xv)|&#160;≤&#160;∆2&#160;since&#160;c&#160;is&#160;(µn,&#160;∆)-bounded&#160;and&#160;dH(x,&#160;X0)&#160;≤&#160;∆.&#160;We&#160;also&#160;define&#160;cexc(e)&#160;:=&#160;c(e)<br/>for&#160;all&#160;e&#160;∈&#160;E(G[V&#160;(G)&#160;\&#160;V0]).&#160;We&#160;claim&#160;that&#160;cexc&#160;is&#160;(2µn,&#160;∆2)-bounded.&#160;Consider&#160;any&#160;α&#160;∈&#160;C.&#160;Since<br/>
S<br/>
φ0&#160;is&#160;µn-feasible,&#160;we&#160;can&#160;deduce&#160;from&#160;<a href="1802.07700s.html#13">(EXC3)&#160;</a>that&#160;α&#160;appears&#160;on&#160;at&#160;most&#160;µn&#160;edges&#160;xv&#160;∈<br/>
E(Aj).<br/>
j∈[r]<br/>
Moreover,&#160;there&#160;are&#160;at&#160;most&#160;µn&#160;edges&#160;e&#160;∈&#160;E(G[V&#160;(G)&#160;\&#160;V0])&#160;on&#160;which&#160;α&#160;appears.<br/>
<hr/>
<a name=20></a><img class="yflip" src="html/1802.07700-20_1.png"/><br/>
20<br/>
S.&#160;GLOCK&#160;AND&#160;F.&#160;JOOS<br/>
Recall&#160;from&#160;Step&#160;1&#160;that&#160;we&#160;can&#160;assume&#160;that&#160;|C|&#160;≤&#160;7µ−1∆2n.&#160;We&#160;now&#160;apply&#160;Lemma&#160;<a href="1802.07700s.html#6">4.1&#160;</a>(with&#160;Gexc,<br/>
<br/>
cexc,&#160;Rexc,&#160;∆2,&#160;T&#160;+1&#160;playing&#160;the&#160;roles&#160;of&#160;G,&#160;c,&#160;R<br/>
)<br/>
2<br/>
S&#160;,&#160;∆,&#160;t)&#160;to&#160;obtain&#160;a&#160;partition&#160;(Ct1t2&#160;t1t2∈([T]0)&#160;of&#160;C<br/>
2<br/>
<br/>
such&#160;that&#160;for&#160;all&#160;t1t2&#160;∈&#160;[T]0&#160;and&#160;all&#160;ij&#160;∈&#160;E(Rexc),&#160;there&#160;is&#160;a&#160;subgraph&#160;Gij<br/>
of&#160;Gexc&#160;[V<br/>
2<br/>
t<br/>
i,&#160;Vj&#160;]&#160;which&#160;is<br/>
1&#160;t2<br/>
Ct1t2<br/>
<br/>
(ε0,&#160;d′)-super-regular.&#160;We&#160;will&#160;only&#160;keep&#160;those&#160;for&#160;which&#160;ψ(ij)&#160;=&#160;t1t2.&#160;More&#160;precisely,&#160;for&#160;all&#160;t1t2&#160;∈&#160;[T]<br/>
2<br/>
and&#160;all&#160;ij&#160;∈&#160;Et&#160;,&#160;we&#160;let&#160;Gij&#160;:=&#160;Gij<br/>
⊆&#160;G<br/>
[V<br/>
1t2<br/>
t<br/>
C<br/>
i,&#160;Vj&#160;],&#160;and&#160;for&#160;all&#160;1&#160;≤&#160;t&#160;≤&#160;T&#160;and&#160;all&#160;j&#160;∈&#160;Jt,&#160;we&#160;let<br/>
1&#160;t2<br/>
t1t2<br/>
Aj0&#160;:=&#160;G0j<br/>
0t&#160;⊆&#160;Aj<br/>
<a href="1802.07700s.html#20">.1&#160;</a>This&#160;means&#160;that&#160;we&#160;reserve&#160;the&#160;colours&#160;in&#160;C<br/>
for&#160;the&#160;edges&#160;in&#160;G[V<br/>
C<br/>
t<br/>
i,&#160;Vj&#160;]&#160;with<br/>
0t<br/>
1&#160;t2<br/>
ψ(ij)&#160;=&#160;t1t2.&#160;The&#160;colours&#160;in&#160;the&#160;sets&#160;C0t&#160;are&#160;‘reserved’&#160;for&#160;the&#160;candidacy&#160;graphs,&#160;which&#160;we&#160;now&#160;transfer<br/>back&#160;to&#160;the&#160;exceptional&#160;edges.&#160;For&#160;all&#160;t&#160;∈&#160;[T&#160;]&#160;and&#160;all&#160;j&#160;∈&#160;Jt,&#160;define&#160;the&#160;bipartite&#160;graph&#160;G0j&#160;with<br/>bipartition&#160;(V0,&#160;Vj)&#160;and&#160;edge&#160;set&#160;E(G0j)&#160;=&#160;{v0v&#160;∈&#160;E(G)&#160;:&#160;v0&#160;∈&#160;V0,&#160;v&#160;∈&#160;Vj,&#160;c(v0v)&#160;⊆&#160;C0,t}.<br/>
We&#160;now&#160;transition&#160;from&#160;G&#160;to&#160;the&#160;spanning&#160;subgraph&#160;G∗&#160;defined&#160;as<br/>
[<br/>
[<br/>
G∗&#160;:=<br/>
G0j&#160;∪<br/>
Gij<br/>
j∈[r]<br/>
ij∈E(R)<br/>
which&#160;is&#160;the&#160;spanning&#160;subgraph&#160;of&#160;G&#160;containing&#160;those&#160;edges&#160;of&#160;G&#160;which&#160;are&#160;‘admissibly’&#160;coloured.&#160;More<br/>
<br/>
precisely,&#160;for&#160;all&#160;t1t2&#160;∈&#160;[T]0&#160;and&#160;all&#160;ij&#160;∈&#160;E<br/>
,&#160;we&#160;have<br/>
2<br/>
t1t2<br/>
(5.10)<br/>
c(vw)&#160;⊆&#160;Ct<br/>
for&#160;all&#160;vw&#160;∈&#160;G∗[V<br/>
1&#160;t2<br/>
i,&#160;Vj&#160;].<br/>
The&#160;following&#160;is&#160;the&#160;reason&#160;why&#160;we&#160;transferred&#160;the&#160;colouring&#160;of&#160;the&#160;exceptional&#160;edges&#160;onto&#160;the&#160;candidacy<br/>graphs&#160;before&#160;applying&#160;Lemma&#160;<a href="1802.07700s.html#6">4.1.&#160;</a>Observe&#160;that&#160;for&#160;all&#160;j&#160;∈&#160;[r],&#160;x0&#160;∈&#160;X0&#160;and&#160;x&#160;∈&#160;NH(x0)&#160;∩&#160;Xj,&#160;we&#160;have<br/>(5.11)<br/>
N<br/>
(x)<br/>
Aj<br/>
⊆&#160;NG∗(φ0(x0)),<br/>
0<br/>
i.e.&#160;the&#160;new&#160;candidacy&#160;graphs&#160;satisfy&#160;<a href="1802.07700s.html#13">(EXC1)&#160;</a>with&#160;respect&#160;to&#160;the&#160;sparsified&#160;graph&#160;G∗.&#160;Indeed,&#160;given<br/>j,&#160;x0,&#160;x&#160;as&#160;above&#160;and&#160;v&#160;∈&#160;N&#160;(x),&#160;we&#160;have&#160;xv<br/>
Aj<br/>
∈&#160;Aj&#160;and&#160;cexc(xv)&#160;⊆&#160;C0,t,&#160;where&#160;t&#160;:=&#160;ψ(j).&#160;By&#160;<a href="1802.07700s.html#13">(EXC1),</a><br/>
0<br/>
we&#160;have&#160;φ0(x0)v&#160;∈&#160;E(G).&#160;Moreover,&#160;by&#160;definition&#160;of&#160;cexc,&#160;we&#160;have<br/>
<a href="1802.07700s.html#19">(5.9)</a><br/>
c(φ0(x0)v)&#160;⊆&#160;cexc(xv)&#160;⊆&#160;C0,t<br/>
and&#160;thus&#160;φ0(x0)v&#160;∈&#160;E(G0j)&#160;⊆&#160;E(G∗),&#160;as&#160;claimed.&#160;From&#160;now&#160;on,&#160;we&#160;do&#160;not&#160;need&#160;the&#160;colouring&#160;cexc<br/>anymore.<br/>
<i>Step&#160;</i>3<i>:&#160;Candidacy&#160;graphs&#160;and&#160;the&#160;inductive&#160;statement</i><br/>
We&#160;will&#160;embed&#160;H&#160;into&#160;G∗.&#160;For&#160;brevity,&#160;define&#160;for&#160;t&#160;∈&#160;[T&#160;]0:<br/>
[<br/>
[<br/>
[<br/>
Xt&#160;:=<br/>
Xi,<br/>
Vt&#160;:=<br/>
Vi,<br/>
Ct&#160;:=<br/>
Ckt,<br/>
i∈Jt<br/>
i∈Jt<br/>
k∈[t−1]0<br/>
[<br/>
[<br/>
[<br/>
X&#160;∗t&#160;:=<br/>
Xi,<br/>
V∗t&#160;:=<br/>
Vi,<br/>
C∗t&#160;:=<br/>
Cℓ,<br/>
i∈J∗<br/>
i∈J∗<br/>
t<br/>
t<br/>
ℓ∈[t]0<br/>
Ht&#160;:=&#160;H[X&#160;∗t],<br/>
Gt&#160;:=&#160;G∗[V∗t].<br/>
Note&#160;that&#160;X&#160;∗t&#160;contains&#160;X0&#160;and&#160;V∗t&#160;contains&#160;V0&#160;for&#160;all&#160;t&#160;∈&#160;[T&#160;]0.&#160;Moreover,&#160;X&#160;∗0&#160;=&#160;X0&#160;=&#160;X0,&#160;V∗0&#160;=&#160;V0&#160;=&#160;V0,<br/>and&#160;C∗0&#160;=&#160;C0&#160;=&#160;∅.&#160;After&#160;round&#160;t,&#160;we&#160;want&#160;to&#160;have&#160;embedded&#160;Ht&#160;into&#160;Gt,&#160;only&#160;using&#160;colours&#160;from&#160;C∗t.<br/>Given&#160;a&#160;partial&#160;embedding&#160;of&#160;H&#160;into&#160;G∗,&#160;an&#160;edge&#160;of&#160;G∗&#160;is&#160;called&#160;<i>used&#160;</i>if&#160;it&#160;is&#160;the&#160;image&#160;of&#160;an&#160;edge&#160;of&#160;H,<br/>and&#160;a&#160;colour&#160;is&#160;called&#160;<i>used&#160;</i>if&#160;some&#160;edge&#160;is&#160;used&#160;on&#160;which&#160;this&#160;colour&#160;appears.<br/>
A&#160;bijection&#160;φ&#160;:&#160;X&#160;∗t&#160;→&#160;V∗t&#160;is&#160;<i>valid&#160;</i>if&#160;φ↾X&#160;=&#160;φ<br/>
(x).<br/>
0<br/>
0&#160;and&#160;for&#160;all&#160;j&#160;∈&#160;J&#160;∗<br/>
t&#160;and&#160;all&#160;x&#160;∈&#160;Xj&#160;,&#160;we&#160;have&#160;φ(x)&#160;∈&#160;NAj0<br/>
In&#160;particular,&#160;this&#160;implies&#160;that&#160;φ(Xj)&#160;=&#160;Vj&#160;for&#160;all&#160;j&#160;∈&#160;J∗t.<br/>
The&#160;following&#160;claim&#160;ensures&#160;that&#160;edges&#160;which&#160;are&#160;embedded&#160;in&#160;different&#160;rounds&#160;have&#160;automatically<br/>
distinct&#160;colours.&#160;Moreover,&#160;it&#160;also&#160;ensures&#160;that&#160;the&#160;edges&#160;embedded&#160;at&#160;one&#160;vertex&#160;in&#160;the&#160;same&#160;round<br/>have&#160;distinct&#160;colours.<br/>
<i>Claim&#160;</i>1<i>:&#160;Let&#160;</i>t&#160;∈&#160;[T&#160;]0&#160;<i>and&#160;suppose&#160;that&#160;</i>φ:&#160;Ht&#160;→&#160;Gt&#160;<i>is&#160;a&#160;valid&#160;embedding.&#160;Then&#160;</i>φ&#160;<i>uses&#160;only&#160;colours</i><br/>
<i>from&#160;</i>C∗t<i>.&#160;Moreover,&#160;for&#160;all&#160;</i>z&#160;∈&#160;Xk<i>,&#160;</i>v&#160;∈&#160;Vk&#160;<i>with&#160;</i>zv&#160;∈&#160;E(Ak)&#160;<i>and&#160;</i>ℓ&#160;:=&#160;ψ(k)&#160;&gt;&#160;t&#160;<i>and&#160;all&#160;distinct&#160;</i>x,&#160;y&#160;∈<br/>NH(z)∩X&#160;∗t&#160;<i>such&#160;that&#160;</i>φ(x)v,&#160;φ(y)v&#160;∈&#160;E(G∗)<i>,&#160;we&#160;have&#160;</i>c(φ(x)v),&#160;c(φ(y)v)&#160;⊆&#160;Cℓ&#160;<i>and&#160;</i>c(φ(x)v)∩c(φ(y)v)&#160;=&#160;∅<i>.<br/>Proof&#160;of&#160;claim:&#160;</i>To&#160;prove&#160;the&#160;first&#160;part&#160;of&#160;the&#160;claim,&#160;assume&#160;that&#160;vw&#160;∈&#160;E(Gt).&#160;Thus,&#160;there&#160;are&#160;unique<br/>i,&#160;j&#160;∈&#160;J∗t&#160;with&#160;ij&#160;∈&#160;Et<br/>
such&#160;that&#160;v&#160;∈&#160;V<br/>
.&#160;Since&#160;i,&#160;j&#160;∈&#160;J∗<br/>
1&#160;t2<br/>
i&#160;and&#160;w&#160;∈&#160;Vj&#160;.&#160;By&#160;<a href="1802.07700s.html#20">(5.10)</a>,&#160;we&#160;have&#160;c(vw)&#160;⊆&#160;Ct1t2<br/>
t&#160;,<br/>
we&#160;have&#160;t1,&#160;t2&#160;≤&#160;t&#160;and&#160;thus&#160;Ct<br/>
⊆&#160;C∗<br/>
1&#160;t2<br/>
t&#160;,&#160;as&#160;claimed.<br/>
1The&#160;‘0’&#160;in&#160;Aj&#160;refers&#160;to&#160;the&#160;fact&#160;that&#160;these&#160;graphs&#160;are&#160;candidacy&#160;graphs&#160;after&#160;round&#160;0.&#160;Later&#160;we&#160;will&#160;also&#160;define&#160;Aj&#160;for<br/>
0<br/>
t<br/>
t&#160;≥&#160;1.<br/>
<hr/>
<a name=21></a>21<br/>
To&#160;prove&#160;the&#160;second&#160;part&#160;of&#160;the&#160;claim,&#160;suppose&#160;that&#160;z,&#160;v,&#160;ℓ,&#160;k,&#160;x,&#160;y&#160;are&#160;as&#160;in&#160;the&#160;statement.&#160;There&#160;are<br/>
unique&#160;i,&#160;j&#160;∈&#160;J∗t&#160;with&#160;x&#160;∈&#160;Xi&#160;and&#160;y&#160;∈&#160;Xj.&#160;Let&#160;ℓ1&#160;:=&#160;ψ(i)&#160;and&#160;ℓ2&#160;:=&#160;ψ(j).&#160;Without&#160;loss&#160;of&#160;generality,<br/>assume&#160;that&#160;ℓ1&#160;≤&#160;ℓ2&#160;≤&#160;t&#160;&lt;&#160;ℓ.&#160;By&#160;<a href="1802.07700s.html#20">(5.10)</a>,&#160;we&#160;have&#160;that&#160;c(φ(x)v)&#160;⊆&#160;Cℓ1ℓ&#160;and&#160;c(φ(y)v)&#160;⊆&#160;Cℓ2ℓ.&#160;If<br/>ℓ1&#160;6=&#160;ℓ2,&#160;then&#160;Cℓ1ℓ&#160;and&#160;Cℓ2ℓ&#160;are&#160;disjoint&#160;subsets&#160;of&#160;Cℓ,&#160;and&#160;the&#160;claim&#160;follows.&#160;If&#160;i,&#160;j&#160;&gt;&#160;0,&#160;this&#160;implies&#160;that<br/>ik,&#160;jk&#160;∈&#160;E(R)&#160;and&#160;we&#160;can&#160;conclude&#160;that&#160;ℓ1&#160;6=&#160;ℓ2&#160;by&#160;definition&#160;of&#160;ψ.&#160;If&#160;i&#160;=&#160;0&#160;and&#160;j&#160;&gt;&#160;0,&#160;we&#160;have&#160;ℓ1&#160;=&#160;0<br/>and&#160;ℓ2&#160;&gt;&#160;0.<br/>
The&#160;remaining&#160;case&#160;is&#160;when&#160;x,&#160;y&#160;∈&#160;X0.&#160;But&#160;then,&#160;since&#160;zv&#160;∈&#160;E(Ak),&#160;we&#160;have&#160;c(φ(x)v)&#160;∩&#160;c(φ(y)v)&#160;=&#160;∅<br/>
by&#160;<a href="1802.07700s.html#13">(EXC2)&#160;</a>since&#160;φ0&#160;feasible.<br/>
−<br/>
Given&#160;t&#160;∈&#160;[T&#160;]0&#160;and&#160;any&#160;bijection&#160;φ:&#160;X&#160;∗t&#160;→&#160;V∗t&#160;with&#160;φ↾X&#160;=&#160;φ<br/>
0<br/>
0&#160;(e.g.&#160;a&#160;valid&#160;embedding&#160;as&#160;above),&#160;we<br/>
define&#160;(for&#160;round&#160;t&#160;+&#160;1)&#160;updated&#160;candidacy&#160;graphs&#160;for&#160;the&#160;clusters&#160;still&#160;to&#160;be&#160;embedded.&#160;Let&#160;j&#160;∈&#160;[r]&#160;\&#160;J∗t.<br/>For&#160;vertices&#160;x&#160;∈&#160;Xj&#160;and&#160;v&#160;∈&#160;Vj,&#160;we&#160;say&#160;that&#160;v&#160;is&#160;a&#160;<i>candidate&#160;for&#160;</i>x&#160;if&#160;xv&#160;∈&#160;E(Aj0)&#160;and&#160;for&#160;all&#160;y&#160;∈&#160;NH(x)∩X&#160;∗t<br/>we&#160;have&#160;that&#160;φ(y)v&#160;∈&#160;E(G∗).<br/>
Let&#160;Ajt&#160;be&#160;the&#160;bipartite&#160;auxiliary&#160;graph&#160;with&#160;bipartition&#160;(Xj,&#160;Vj)&#160;and&#160;edge&#160;set<br/>
(5.12)<br/>
E(Ajt)&#160;:=&#160;{xv&#160;:&#160;x&#160;∈&#160;Xj,&#160;v&#160;∈&#160;Vj&#160;and&#160;v&#160;is&#160;a&#160;candidate&#160;for&#160;x}.<br/>
Note&#160;that&#160;Ajt&#160;depends&#160;on&#160;the&#160;specific&#160;choice&#160;of&#160;φ.&#160;We&#160;might&#160;write&#160;Ajt(φ)&#160;to&#160;indicate&#160;this&#160;dependency,<br/>but&#160;will&#160;just&#160;write&#160;Ajt&#160;if&#160;φ&#160;is&#160;clear&#160;from&#160;the&#160;context.&#160;Note&#160;that&#160;Aj0(φ0)&#160;=&#160;Aj0&#160;by&#160;<a href="1802.07700s.html#20">(5.11)</a>.<br/>
We&#160;will&#160;prove&#160;by&#160;induction&#160;that&#160;the&#160;following&#160;statement&#160;S(t)&#160;holds&#160;for&#160;all&#160;t&#160;∈&#160;[T&#160;]0.<br/>
S(t).&#160;There&#160;exists&#160;a&#160;valid&#160;rainbow&#160;embedding&#160;φt&#160;:&#160;Ht&#160;→&#160;Gt&#160;such&#160;that&#160;for&#160;all&#160;j&#160;∈&#160;[r]&#160;\&#160;J∗t,&#160;the&#160;candidacy<br/>
graph&#160;Ajt(φt)&#160;is&#160;(εt,&#160;dj)-super-regular&#160;for&#160;some&#160;dj&#160;≥&#160;d′t+1.<br/>
The&#160;instance&#160;S(0)&#160;holds&#160;since&#160;the&#160;graphs&#160;(Aj&#160;)<br/>
0&#160;j∈[r]&#160;are&#160;(ε0,&#160;d′)-super-regular.&#160;The&#160;instance&#160;S(T&#160;)&#160;completes<br/>
the&#160;proof&#160;since&#160;then&#160;φT&#160;is&#160;a&#160;valid&#160;rainbow&#160;embedding&#160;of&#160;H&#160;into&#160;G.<br/>
<i>Step&#160;</i>4<i>:&#160;The&#160;inductive&#160;step</i><br/>
Now,&#160;assume&#160;the&#160;truth&#160;of&#160;S(t)&#160;for&#160;some&#160;t&#160;∈&#160;[T&#160;−&#160;1]0,&#160;and&#160;let&#160;φt&#160;be&#160;as&#160;in&#160;S(t).&#160;We&#160;will&#160;extend&#160;φt&#160;to<br/>
φt+1&#160;such&#160;that&#160;S(t&#160;+&#160;1)&#160;holds.&#160;Any&#160;bijection&#160;σ&#160;:&#160;Xt+1&#160;→&#160;Vt+1&#160;induces&#160;a&#160;bijection&#160;φt+1&#160;:&#160;X&#160;∗t+1&#160;→&#160;V∗t+1<br/>which&#160;extends&#160;φt&#160;as&#160;follows:<br/>
(φ<br/>
(5.13)<br/>
φ<br/>
t(x)<br/>
if&#160;x&#160;∈&#160;X&#160;∗t,<br/>
t+1(x)&#160;:=<br/>
σ(x)<br/>
if&#160;x&#160;∈&#160;Xt+1.<br/>
We&#160;will&#160;choose&#160;σ&#160;as&#160;a&#160;perfect&#160;matching&#160;in&#160;a&#160;suitably&#160;defined&#160;bipartite&#160;graph&#160;with&#160;bipartition&#160;(Xt+1,&#160;Vt+1).<br/>
S<br/>
The&#160;natural&#160;choice&#160;for&#160;this&#160;graph&#160;is<br/>
Ai<br/>
i∈Jt+1<br/>
t.&#160;Indeed,&#160;if&#160;we&#160;pick&#160;for&#160;every&#160;x&#160;∈&#160;Xt+1&#160;its&#160;image&#160;σ(x)<br/>
among&#160;the&#160;neighbours&#160;of&#160;x&#160;in&#160;Ait,&#160;then,&#160;since&#160;every&#160;such&#160;neighbour&#160;v&#160;is&#160;a&#160;candidate&#160;for&#160;x,&#160;we&#160;will&#160;obtain<br/>
S<br/>
a&#160;valid&#160;embedding&#160;of&#160;Ht+1&#160;into&#160;Gt+1.&#160;However,&#160;not&#160;every&#160;perfect&#160;matching&#160;σ&#160;in<br/>
Ai<br/>
i∈Jt+1<br/>
t&#160;induces&#160;a<br/>
φt+1&#160;which&#160;satisfies&#160;S(t&#160;+&#160;1).&#160;For&#160;this,&#160;we&#160;also&#160;need&#160;to&#160;ensure&#160;that&#160;the&#160;embedding&#160;is&#160;rainbow,&#160;and&#160;that<br/>the&#160;new&#160;candidacy&#160;graphs&#160;are&#160;again&#160;super-regular.&#160;In&#160;order&#160;to&#160;show&#160;that&#160;a&#160;suitable&#160;σ&#160;exists,&#160;we&#160;pick&#160;σ<br/>randomly&#160;and&#160;show&#160;that&#160;the&#160;desired&#160;properties&#160;hold&#160;with&#160;positive&#160;probability.&#160;We&#160;will&#160;use&#160;Lemma&#160;<a href="1802.07700s.html#18">5.8<br/></a>to&#160;show&#160;that&#160;φt+1&#160;is&#160;rainbow&#160;(see&#160;Claim&#160;2),&#160;and&#160;the&#160;Four&#160;graphs&#160;lemma&#160;(Lemma&#160;<a href="1802.07700s.html#17">5.6)&#160;</a>to&#160;show&#160;that&#160;the<br/>new&#160;candidacy&#160;graphs&#160;are&#160;again&#160;super-regular&#160;(see&#160;Claim&#160;3).<br/>
We&#160;now&#160;prepare&#160;the&#160;application&#160;of&#160;the&#160;Four&#160;graphs&#160;lemma&#160;by&#160;finding&#160;a&#160;suitable&#160;spanning&#160;subgraph<br/>
˜<br/>
S<br/>
At&#160;of<br/>
Ai<br/>
i∈Jt+1<br/>
t&#160;of&#160;which&#160;we&#160;will&#160;pick&#160;the&#160;perfect&#160;matching&#160;σ&#160;uniformly&#160;at&#160;random.&#160;(The&#160;reason&#160;for&#160;the<br/>
transition&#160;to&#160;˜<br/>
At&#160;is&#160;to&#160;satisfy&#160;condition&#160;<a href="1802.07700s.html#17">(5.8)</a>.)<br/>
Recall&#160;that&#160;for&#160;every&#160;ij&#160;∈&#160;E(R),&#160;the&#160;graph&#160;H[Xi,&#160;Xj]&#160;is&#160;a&#160;perfect&#160;matching.&#160;For&#160;i,&#160;j&#160;∈&#160;V&#160;(R)&#160;with<br/>
ij&#160;∈&#160;E(R),&#160;we&#160;define&#160;the&#160;bijection&#160;πj→i&#160;:&#160;Xj&#160;→&#160;Xi&#160;where&#160;πj→i(x)&#160;is&#160;the&#160;unique&#160;H-neighbour&#160;of&#160;x&#160;in&#160;Xi.<br/>Clearly,&#160;π−1&#160;=&#160;π<br/>
j→i<br/>
i→j&#160;.<br/>
Let&#160;i&#160;∈&#160;Jt+1.&#160;For&#160;j&#160;∈&#160;NR(i)&#160;\&#160;J∗t+1,&#160;we&#160;define&#160;the&#160;new&#160;bipartite&#160;auxiliary&#160;graph&#160;P&#160;j&#160;with&#160;bipartition<br/>
i<br/>
(Xi,&#160;Vj),&#160;where&#160;xv&#160;∈&#160;P&#160;j&#160;if&#160;and&#160;only&#160;if&#160;π<br/>
is&#160;isomorphic&#160;to&#160;Aj<br/>
i<br/>
i→j&#160;(x)v&#160;∈&#160;E(Ajt&#160;).&#160;Clearly,&#160;P&#160;j<br/>
i<br/>
t&#160;by&#160;construction.<br/>
The&#160;reason&#160;for&#160;the&#160;definition&#160;of&#160;P&#160;j&#160;is&#160;that&#160;it&#160;forms&#160;a&#160;super-regular&#160;triple&#160;with&#160;Ai<br/>
i<br/>
t&#160;and&#160;G∗[Vi,&#160;Vj&#160;]&#160;on&#160;vertex<br/>
set&#160;Xi&#160;·∪&#160;Vi&#160;·∪&#160;Vj&#160;(cf.&#160;Figure&#160;<a href="1802.07700s.html#23">1)</a>.&#160;We&#160;would&#160;like&#160;to&#160;apply&#160;the&#160;Four&#160;graphs&#160;lemma&#160;with&#160;Ait,&#160;P&#160;j,&#160;and&#160;G∗[V<br/>
i<br/>
i,&#160;Vj&#160;]<br/>
playing&#160;the&#160;roles&#160;of&#160;G1,2,&#160;G1,3,&#160;and&#160;G2,3,&#160;respectively.&#160;However,&#160;in&#160;order&#160;to&#160;satisfy&#160;condition&#160;<a href="1802.07700s.html#17">(5.8)</a>,&#160;we<br/>define&#160;˜<br/>
Ait&#160;as&#160;the&#160;spanning&#160;subgraph&#160;of&#160;Ait&#160;which&#160;contains&#160;only&#160;those&#160;edges&#160;xv&#160;∈&#160;E(Ait),&#160;x&#160;∈&#160;Xi,&#160;v&#160;∈&#160;Vi,<br/>
that&#160;satisfy&#160;the&#160;following:&#160;for&#160;all&#160;j&#160;∈&#160;NR(i)&#160;\&#160;J∗t+1,&#160;we&#160;have<br/>
(5.14)<br/>
|N&#160;(x)<br/>
P&#160;j<br/>
∩&#160;NG∗[Vi,Vj](v)|&#160;=&#160;(djd′&#160;±&#160;εt)n/r.<br/>
i<br/>
<hr/>
<a name=22></a><img class="yflip" src="html/1802.07700-22_1.png"/><br/>
<img class="yflip" src="html/1802.07700-22_2.png"/><br/>
<img class="yflip" src="html/1802.07700-22_3.png"/><br/>
<img class="yflip" src="html/1802.07700-22_4.png"/><br/>
22<br/>
S.&#160;GLOCK&#160;AND&#160;F.&#160;JOOS<br/>
By&#160;Proposition&#160;<a href="1802.07700s.html#17">5.7,&#160;</a>we&#160;still&#160;have&#160;that&#160;for&#160;every&#160;i&#160;∈&#160;Jt+1,<br/>
˜<br/>
√<br/>
(5.15)<br/>
Ait&#160;is&#160;(2∆&#160;εt,&#160;di)-super-regular.<br/>
Now,&#160;define<br/>
[<br/>
˜<br/>
(5.16)<br/>
A<br/>
˜<br/>
t&#160;:=<br/>
Ait.<br/>
i∈Jt+1<br/>
Choose&#160;σ&#160;uniformly&#160;at&#160;random&#160;among&#160;all&#160;perfect&#160;matchings&#160;of&#160;˜<br/>
At.&#160;We&#160;will&#160;show&#160;that&#160;with&#160;positive<br/>
probability,&#160;φt+1&#160;as&#160;defined&#160;in&#160;<a href="1802.07700s.html#21">(5.13)&#160;</a>satisfies&#160;S(t&#160;+&#160;1),&#160;which&#160;then&#160;completes&#160;the&#160;proof.<br/>
Note&#160;first&#160;that&#160;the&#160;graphs&#160;(&#160;˜<br/>
Ait)i∈J<br/>
are&#160;all&#160;vertex-disjoint.&#160;In&#160;particular,&#160;every&#160;perfect&#160;matching&#160;σ<br/>
t+1<br/>
of&#160;˜<br/>
At&#160;is&#160;the&#160;union&#160;of&#160;|Jt+1|&#160;perfect&#160;matchings&#160;σi&#160;:&#160;Xi&#160;→&#160;Vi,&#160;where&#160;σi&#160;is&#160;a&#160;perfect&#160;matching&#160;in&#160;˜<br/>
Ait.&#160;In<br/>
particular,&#160;every&#160;choice&#160;of&#160;σ&#160;yields&#160;a&#160;φt+1&#160;which&#160;is&#160;valid.&#160;Moreover,&#160;a&#160;simple&#160;but&#160;crucial&#160;observation&#160;is<br/>that&#160;since&#160;σ&#160;is&#160;chosen&#160;uniformly&#160;at&#160;random,&#160;each&#160;σi&#160;is&#160;a&#160;uniformly&#160;random&#160;perfect&#160;matching&#160;of&#160;˜<br/>
Ait.<br/>
In&#160;order&#160;to&#160;make&#160;sure&#160;that&#160;φt+1&#160;is&#160;a&#160;rainbow&#160;embedding,&#160;we&#160;define&#160;a&#160;suitable&#160;system&#160;of&#160;conflicts<br/>
for&#160;˜<br/>
At&#160;and&#160;then&#160;use&#160;Lemma&#160;<a href="1802.07700s.html#18">5.8&#160;</a>to&#160;obtain&#160;a&#160;lower&#160;bound&#160;on&#160;the&#160;probability&#160;that&#160;σ&#160;is&#160;conflict-free.<br/>
We&#160;will&#160;subsequently&#160;use&#160;this&#160;lower&#160;bound&#160;in&#160;a&#160;union&#160;bound,&#160;hence&#160;a&#160;mere&#160;existence&#160;result&#160;would&#160;not<br/>be&#160;sufficient&#160;here.&#160;Consider&#160;xv&#160;∈&#160;E(&#160;˜<br/>
At)&#160;with&#160;x&#160;∈&#160;Xt+1,&#160;v&#160;∈&#160;Vt+1.&#160;There&#160;is&#160;a&#160;unique&#160;i&#160;∈&#160;Jt+1&#160;with<br/>
xv&#160;∈&#160;E(&#160;˜<br/>
Ait),&#160;i.e.&#160;x&#160;∈&#160;Xi,&#160;v&#160;∈&#160;Vi.&#160;Let<br/>
Fxv&#160;:=&#160;{φt(y)v&#160;:&#160;y&#160;∈&#160;NH(x)&#160;∩&#160;X&#160;∗t}.<br/>
By&#160;definition&#160;of&#160;Ait,&#160;we&#160;have&#160;that&#160;Fxv&#160;⊆&#160;E(G∗).&#160;In&#160;particular,&#160;Fxv&#160;is&#160;the&#160;set&#160;of&#160;edges&#160;of&#160;G∗&#160;which&#160;is&#160;used<br/>in&#160;the&#160;embedding&#160;of&#160;H&#160;if&#160;x&#160;is&#160;mapped&#160;to&#160;v.&#160;For&#160;our&#160;embedding&#160;to&#160;be&#160;rainbow,&#160;we&#160;clearly&#160;need&#160;that&#160;the<br/>colour&#160;sets&#160;(c(e))e∈F<br/>
of&#160;the&#160;edges&#160;in&#160;F<br/>
xv<br/>
xv&#160;are&#160;pairwise&#160;disjoint,&#160;and&#160;disjoint&#160;from&#160;the&#160;set&#160;of&#160;colours&#160;used<br/>
to&#160;embed&#160;Ht.&#160;That&#160;this&#160;is&#160;the&#160;case&#160;follows&#160;from&#160;Claim&#160;1.&#160;Recall&#160;from&#160;Claim&#160;1&#160;that&#160;the&#160;embedding&#160;of<br/>Ht&#160;only&#160;uses&#160;colours&#160;from&#160;C∗t.&#160;Moreover,&#160;since&#160;ψ(i)&#160;=&#160;t&#160;+&#160;1&#160;&gt;&#160;t,&#160;the&#160;second&#160;part&#160;of&#160;Claim&#160;1&#160;implies&#160;that<br/>the&#160;sets&#160;(c(e))e∈F<br/>
are&#160;pairwise&#160;disjoint&#160;subsets&#160;of&#160;C<br/>
xv<br/>
t+1.&#160;Recall&#160;that&#160;Ct+1&#160;∩&#160;C∗<br/>
t&#160;=&#160;∅.&#160;Let<br/>
[<br/>
Zxv&#160;:=<br/>
c(e)<br/>
e∈Fxv<br/>
be&#160;the&#160;set&#160;of&#160;all&#160;colours&#160;which&#160;appear&#160;on&#160;the&#160;edges&#160;in&#160;Fxv&#160;(cf.&#160;Figure&#160;<a href="1802.07700s.html#23">1)</a>.&#160;By&#160;the&#160;above,&#160;Zxv&#160;⊆&#160;Ct+1.&#160;We<br/>define&#160;a&#160;system&#160;of&#160;conflicts&#160;F&#160;for&#160;E(&#160;˜<br/>
At)&#160;as&#160;follows:&#160;two&#160;edges&#160;xv,&#160;x′v′&#160;∈&#160;E(&#160;˜<br/>
At)&#160;conflict,&#160;i.e.&#160;{xv,&#160;x′v′}&#160;∈&#160;F,<br/>
if&#160;and&#160;only&#160;if&#160;Zxv∩Zx′v′&#160;6=&#160;∅.&#160;Hence,&#160;if&#160;σ&#160;is&#160;a&#160;conflict-free&#160;perfect&#160;matching&#160;of&#160;˜<br/>
At,&#160;then&#160;φt+1&#160;:&#160;Ht+1&#160;→&#160;Gt+1<br/>
is&#160;a&#160;valid&#160;rainbow&#160;embedding.<br/>
<i>Claim&#160;</i>2<i>:&#160;The&#160;probability&#160;that&#160;</i>σ&#160;<i>is&#160;conflict-free&#160;is&#160;at&#160;least&#160;</i>e−µ1/3n<i>.</i><br/>
<i>Proof&#160;of&#160;claim:&#160;</i>We&#160;first&#160;claim&#160;that&#160;F&#160;is&#160;4µ∆2n-bounded.&#160;Fix&#160;any&#160;edge&#160;xv&#160;∈&#160;E(&#160;˜<br/>
At).&#160;Clearly,&#160;|Zxv|&#160;≤&#160;2∆2<br/>
since&#160;dH(x,&#160;X&#160;∗t)&#160;≤&#160;2∆&#160;and&#160;c&#160;is&#160;(µn,&#160;∆)-bounded.&#160;Fix&#160;a&#160;colour&#160;α&#160;∈&#160;Zxv.&#160;Note&#160;that&#160;if&#160;α&#160;∈&#160;Zx′v′,&#160;where<br/>x′&#160;∈&#160;Xt+1,&#160;v′&#160;∈&#160;Vt+1&#160;and&#160;x′v′&#160;∈&#160;E(&#160;˜<br/>
At),&#160;then&#160;α&#160;was&#160;<i>forced&#160;on&#160;</i>x′v′&#160;by&#160;some&#160;edge&#160;v′v′′&#160;∈&#160;E(G∗)&#160;with<br/>
v′′&#160;∈&#160;V∗t,&#160;φ−1<br/>
t<br/>
(v′′)x′&#160;∈&#160;E(H)&#160;and&#160;α&#160;∈&#160;c(v′v′′).&#160;Note&#160;that&#160;if&#160;v′′&#160;∈&#160;V∗t&#160;\&#160;V0,&#160;then&#160;x′′&#160;:=&#160;φ−1<br/>
t<br/>
(v′′)&#160;∈&#160;V&#160;(H)&#160;\&#160;X0<br/>
satisfies&#160;dH&#160;(x′′,&#160;Xt+1)&#160;=&#160;1&#160;by&#160;definition&#160;of&#160;ψ.&#160;Thus,&#160;v′v′′&#160;forces&#160;α&#160;on&#160;at&#160;most&#160;one&#160;edge&#160;x′v′&#160;∈&#160;E(&#160;˜<br/>
At).<br/>
Since&#160;there&#160;are&#160;at&#160;most&#160;µn&#160;edges&#160;v′v′′&#160;with&#160;α&#160;∈&#160;c(v′v′′),&#160;we&#160;conclude&#160;that&#160;α&#160;is&#160;forced&#160;on&#160;at&#160;most&#160;µn&#160;edges<br/>x′v′&#160;∈&#160;˜<br/>
At&#160;in&#160;this&#160;way.&#160;On&#160;the&#160;other&#160;hand,&#160;if&#160;v′′&#160;∈&#160;V0,&#160;then&#160;v′v′′&#160;forces&#160;α&#160;on&#160;at&#160;most&#160;dH(φ−1<br/>
0&#160;(v′′),&#160;Xt+1)&#160;≤<br/>
dH(φ−1<br/>
t<br/>
(v′′))&#160;edges&#160;x′v′&#160;∈&#160;˜<br/>
At.&#160;Since&#160;there&#160;are&#160;at&#160;most&#160;dα&#160;(v′′)&#160;vertices&#160;v′&#160;in<br/>
G<br/>
Vt+1&#160;such&#160;that&#160;α&#160;∈&#160;c(v′v′′),<br/>
the&#160;total&#160;number&#160;of&#160;edges&#160;x′v′&#160;∈&#160;˜<br/>
At&#160;on&#160;which&#160;α&#160;is&#160;forced&#160;by&#160;some&#160;v′v′′&#160;with&#160;v′′&#160;∈&#160;V0,&#160;can&#160;be&#160;bounded<br/>
from&#160;above&#160;by<br/>
X<br/>
X<br/>
<a href="1802.07700s.html#13">(EXC3)</a><br/>
dα<br/>
G(v′′)&#160;·&#160;dH&#160;(φ−1<br/>
0&#160;(v′′),&#160;Xt+1)&#160;≤<br/>
dα<br/>
G(φ0(x′′&#160;))&#160;·&#160;dH&#160;(x′′)<br/>
≤<br/>
µn.<br/>
v′′∈V0<br/>
x′′∈X0<br/>
Therefore,&#160;α&#160;appears&#160;on&#160;at&#160;most&#160;2µn&#160;edges&#160;in&#160;˜<br/>
At&#160;and&#160;hence&#160;F&#160;is&#160;4µ∆2n-bounded.<br/>
By&#160;<a href="1802.07700s.html#22">(5.15)&#160;</a>and&#160;Proposition&#160;<a href="1802.07700s.html#18">5.9&#160;</a>(applied&#160;for&#160;each&#160;i&#160;∈&#160;Jt+1),&#160;there&#160;exists&#160;a&#160;perfect&#160;matching&#160;of&#160;˜<br/>
At.<br/>
Let&#160;M&#160;be&#160;any&#160;perfect&#160;matching&#160;of&#160;˜<br/>
At,&#160;and&#160;e&#160;∈&#160;M.&#160;We&#160;need&#160;to&#160;show&#160;that&#160;there&#160;are&#160;many&#160;(e,&#160;M)-<br/>
switchable&#160;edges.&#160;Suppose&#160;that&#160;e&#160;∈&#160;E(&#160;˜<br/>
Ait)&#160;for&#160;i&#160;∈&#160;Jt+1.&#160;Let&#160;Mi&#160;be&#160;the&#160;perfect&#160;matching&#160;of&#160;˜<br/>
Ait&#160;induced<br/>
by&#160;M&#160;.&#160;Clearly,&#160;every&#160;(e,&#160;Mi)-switchable&#160;edge&#160;is&#160;also&#160;(e,&#160;M&#160;)-switchable.&#160;By&#160;<a href="1802.07700s.html#22">(5.15)</a>,&#160;we&#160;have&#160;that&#160;˜<br/>
Ait&#160;is<br/>
√<br/>
√<br/>
(2∆&#160;εt,&#160;di)-super-regular.&#160;By&#160;Proposition&#160;<a href="1802.07700s.html#18">5.9&#160;</a>(with&#160;n/r,&#160;2∆&#160;εt,&#160;d′t+1&#160;playing&#160;the&#160;roles&#160;of&#160;n,&#160;ε,&#160;d),&#160;there<br/>are&#160;at&#160;least&#160;d′3(t+1)&#160;(n/r)2&#160;edges&#160;in&#160;˜<br/>
Ai<br/>
2<br/>
t&#160;that&#160;are&#160;(e,&#160;Mi)-switchable,&#160;and&#160;thus&#160;(e,&#160;M&#160;)-switchable.<br/>
Hence,&#160;by&#160;Lemma&#160;<a href="1802.07700s.html#18">5.8&#160;</a>(with&#160;|Jt+1|n/r,&#160;4µr∆2/|Jt+1|,&#160;d′3(t+1)/2|Jt+1|2&#160;playing&#160;the&#160;roles&#160;of&#160;n,&#160;µ,&#160;γ),&#160;the<br/>
probability&#160;that&#160;σ&#160;is&#160;conflict-free&#160;is&#160;at&#160;least&#160;e−µ1/3n.<br/>
−<br/>
<hr/>
<a name=23></a><img class="yflip" src="html/1802.07700-23_1.png"/><br/>
<img class="yflip" src="html/1802.07700-23_2.png"/><br/>
<img class="yflip" src="html/1802.07700-23_3.png"/><br/>
<img class="yflip" src="html/1802.07700-23_4.png"/><br/>
<img class="yflip" src="html/1802.07700-23_5.png"/><br/>
<img class="yflip" src="html/1802.07700-23_6.png"/><br/>
<img class="yflip" src="html/1802.07700-23_7.png"/><br/>
<img class="yflip" src="html/1802.07700-23_8.png"/><br/>
<img class="yflip" src="html/1802.07700-23_9.png"/><br/>
<img class="yflip" src="html/1802.07700-23_10.png"/><br/>
<img class="yflip" src="html/1802.07700-23_11.png"/><br/>
<img class="yflip" src="html/1802.07700-23_12.png"/><br/>
<img class="yflip" src="html/1802.07700-23_13.png"/><br/>
<img class="yflip" src="html/1802.07700-23_14.png"/><br/>
<img class="yflip" src="html/1802.07700-23_15.png"/><br/>
<img class="yflip" src="html/1802.07700-23_16.png"/><br/>
<img class="yflip" src="html/1802.07700-23_17.png"/><br/>
<img class="yflip" src="html/1802.07700-23_18.png"/><br/>
<img class="yflip" src="html/1802.07700-23_19.png"/><br/>
<img class="yflip" src="html/1802.07700-23_20.png"/><br/>
<img class="yflip" src="html/1802.07700-23_21.png"/><br/>
<img class="yflip" src="html/1802.07700-23_22.png"/><br/>
<img class="yflip" src="html/1802.07700-23_23.png"/><br/>
<img class="yflip" src="html/1802.07700-23_24.png"/><br/>
23<br/>
Xi′<br/>
Xi′′<br/>
Xi<br/>
Xj<br/>
πi→j<br/>
x′′<br/>
x′<br/>
x<br/>
H<br/>
˜<br/>
π<br/>
Ai<br/>
j→i<br/>
t<br/>
φt<br/>
φt<br/>
σi<br/>
{α,&#160;β}<br/>
P&#160;j<br/>
Aj<br/>
i<br/>
t&#160;→&#160;Ajt+1<br/>
φ(x′)<br/>
φ(x′′)<br/>
β<br/>
G∗[Vi,&#160;Vj]<br/>
G∗<br/>
v<br/>
α<br/>
Vi′<br/>
Vi′′<br/>
Vi<br/>
Vj<br/>
Figure&#160;1.&#160;A&#160;sketch&#160;of&#160;the&#160;induction&#160;step.&#160;Here,&#160;i&#160;∈&#160;Jt+1,&#160;that&#160;is,&#160;the&#160;cluster&#160;Xi&#160;in&#160;the&#160;middle&#160;is<br/>currently&#160;embedded&#160;into&#160;Vi&#160;by&#160;choosing&#160;a&#160;random&#160;perfect&#160;matching&#160;σi&#160;in&#160;the&#160;candidacy&#160;graph&#160;˜<br/>
Ai.&#160;To<br/>
t<br/>
the&#160;left,&#160;we&#160;have&#160;clusters&#160;that&#160;are&#160;already&#160;embedded,&#160;so&#160;i′,&#160;i′′&#160;∈&#160;J∗.&#160;The&#160;edge&#160;xv&#160;receives&#160;all&#160;colours&#160;from<br/>
t<br/>
edges&#160;from&#160;v&#160;to&#160;already&#160;embedded&#160;neighbours&#160;of&#160;x.&#160;This&#160;produces&#160;a&#160;conflict&#160;system&#160;for&#160;˜<br/>
Ai.&#160;To&#160;the&#160;right,<br/>
t<br/>
we&#160;have&#160;a&#160;cluster&#160;which&#160;will&#160;be&#160;embedded&#160;in&#160;a&#160;later&#160;round,&#160;so&#160;j&#160;∈&#160;[r]&#160;\&#160;J∗<br/>
.&#160;The&#160;current&#160;candidacy<br/>
t+1<br/>
graph&#160;Aj&#160;is&#160;projected&#160;using&#160;the&#160;perfect&#160;matching&#160;H[X<br/>
t<br/>
i,&#160;Xj&#160;].<br/>
The&#160;random&#160;choice&#160;of&#160;σi&#160;produces&#160;a<br/>
subgraph&#160;P&#160;j(σ<br/>
,&#160;which&#160;translates&#160;back&#160;to&#160;the&#160;new&#160;candidacy<br/>
i<br/>
i&#160;)&#160;of&#160;this&#160;projected&#160;candidacy&#160;graph&#160;P&#160;j<br/>
i<br/>
graph&#160;Aj<br/>
for&#160;(X<br/>
t+1<br/>
j&#160;,&#160;Vj&#160;).<br/>
It&#160;remains&#160;to&#160;show&#160;that&#160;with&#160;high&#160;enough&#160;probability,&#160;the&#160;updated&#160;candidacy&#160;graphs&#160;Ajt+1&#160;are&#160;super-<br/>
regular.&#160;For&#160;this,&#160;we&#160;use&#160;the&#160;Four&#160;graphs&#160;lemma.<br/>
<i>Claim&#160;</i>3<i>:&#160;For&#160;all&#160;</i>j&#160;∈&#160;[r]&#160;\&#160;J∗t+1<i>,&#160;with&#160;probability&#160;at&#160;least&#160;</i>1&#160;−&#160;(1&#160;−&#160;a)n/r<i>,&#160;the&#160;candidacy&#160;graph&#160;</i>Aj<br/>
<i>is</i><br/>
t+1<br/>
(εt+1,&#160;d′′)<i>-super-regular&#160;for&#160;some&#160;</i>d′′&#160;≥&#160;d′t+2<i>.</i><br/>
<i>Proof&#160;of&#160;claim:&#160;</i>Crucially,&#160;Ajt+1&#160;only&#160;depends&#160;on&#160;(at&#160;most)&#160;one&#160;of&#160;the&#160;σi.&#160;Consider&#160;x&#160;∈&#160;Xj&#160;and&#160;v&#160;∈&#160;Vj.<br/>Observe&#160;first&#160;that&#160;by&#160;<a href="1802.07700s.html#21">(5.12)&#160;</a>and&#160;<a href="1802.07700s.html#21">(5.13)</a>,&#160;we&#160;have&#160;xv&#160;∈&#160;E(Ajt+1(φt+1))&#160;if&#160;and&#160;only&#160;if&#160;xv&#160;∈&#160;E(Ajt(φt))&#160;and<br/>σ(y)v&#160;∈&#160;E(G∗)&#160;for&#160;all&#160;y&#160;∈&#160;NH(x)&#160;∩&#160;Xt+1.&#160;Recall&#160;that&#160;j&#160;has&#160;at&#160;most&#160;one&#160;R-neighbour&#160;in&#160;Jt+1.&#160;If&#160;j&#160;has&#160;no<br/>such&#160;neighbour,&#160;then&#160;Ajt+1&#160;=&#160;Ajt&#160;and&#160;thus&#160;there&#160;is&#160;nothing&#160;to&#160;prove.&#160;Assume&#160;now&#160;that&#160;i&#160;is&#160;the&#160;unique<br/>R-neighbour&#160;of&#160;j&#160;in&#160;Jt+1.&#160;Thus,&#160;πj→i(x)&#160;is&#160;the&#160;unique&#160;H-neighbour&#160;of&#160;x&#160;in&#160;Xt+1.&#160;We&#160;conclude&#160;that<br/>xv&#160;∈&#160;E(Ajt+1)&#160;if&#160;and&#160;only&#160;if&#160;xv&#160;∈&#160;E(Ajt)&#160;and&#160;σi(πj→i(x))v&#160;∈&#160;E(G∗).&#160;Thus,&#160;Ajt+1&#160;only&#160;depends&#160;on&#160;σi.<br/>Moreover,&#160;recalling&#160;the&#160;definition&#160;of&#160;P&#160;j,&#160;we&#160;have&#160;that<br/>
i<br/>
(5.17)<br/>
xv&#160;∈&#160;E(Ajt+1)<br/>
⇔<br/>
πj→i(x)v&#160;∈&#160;E(P&#160;j)&#160;and&#160;σ<br/>
i<br/>
i(πj→i(x))v&#160;∈&#160;E(G∗).<br/>
Consider&#160;the&#160;triple&#160;(&#160;˜<br/>
Ait,&#160;P&#160;j,&#160;G∗[V<br/>
i<br/>
i,&#160;Vj&#160;])&#160;on&#160;vertex&#160;set&#160;Xi&#160;·<br/>
∪Vi&#160;·∪Vj.&#160;Recall&#160;that&#160;σi&#160;:&#160;Xi&#160;→&#160;Vi&#160;is&#160;a&#160;uniformly<br/>
random&#160;perfect&#160;matching&#160;of&#160;˜<br/>
Ait.&#160;Define&#160;P&#160;j(σ<br/>
which&#160;contains&#160;all&#160;edges<br/>
i<br/>
i)&#160;as&#160;the&#160;spanning&#160;subgraph&#160;of&#160;P&#160;j<br/>
i<br/>
x′v&#160;∈&#160;E(P&#160;j),&#160;with&#160;x′<br/>
(σ<br/>
i<br/>
∈&#160;Xi,&#160;v&#160;∈&#160;Vj,&#160;for&#160;which&#160;σi(x′)v&#160;∈&#160;E(G∗[Vi,&#160;Vj]).&#160;(Thus,&#160;P&#160;ji&#160;i)&#160;is&#160;the&#160;graph&#160;Aσ<br/>
defined&#160;in&#160;the&#160;Four&#160;graphs&#160;lemma.)&#160;By&#160;<a href="1802.07700s.html#23">(5.17)</a>,&#160;P&#160;j(σ<br/>
i<br/>
i)&#160;is&#160;isomorphic&#160;to&#160;Ajt+1.<br/>
√<br/>
By&#160;<a href="1802.07700s.html#22">(5.15)</a>,&#160;˜<br/>
Ait&#160;is&#160;(2∆&#160;εt,&#160;di)-super-regular.&#160;Moreover,&#160;by&#160;S(t),&#160;P&#160;j&#160;(which&#160;is&#160;isomorphic&#160;to&#160;Aj<br/>
i<br/>
t&#160;)&#160;is<br/>
(εt,&#160;dj)-super-regular.&#160;Also,&#160;recall&#160;that&#160;G∗[Vi,&#160;Vj]&#160;is&#160;(ε0,&#160;d′)-super-regular.&#160;Finally,&#160;condition&#160;<a href="1802.07700s.html#17">(5.8)&#160;</a>is<br/>satisfied&#160;by&#160;<a href="1802.07700s.html#21">(5.14)</a>.&#160;Therefore,&#160;we&#160;can&#160;apply&#160;the&#160;Four&#160;graphs&#160;lemma&#160;(Lemma&#160;<a href="1802.07700s.html#17">5.6)&#160;</a>as&#160;follows:<br/>
n/r<br/>
a<br/>
ε1/3<br/>
˜<br/>
t<br/>
εt+1<br/>
Ait<br/>
P&#160;j<br/>
G∗[V<br/>
(σ<br/>
i<br/>
i,&#160;Vj&#160;]<br/>
di<br/>
dj<br/>
d′<br/>
σi<br/>
P&#160;ji&#160;i)<br/>
n<br/>
a<br/>
ε<br/>
ε′<br/>
G1,2<br/>
G1,3<br/>
G2,3<br/>
d1,2<br/>
d1,3<br/>
d2,3<br/>
σ<br/>
Aσ<br/>
With&#160;probability&#160;at&#160;least&#160;1&#160;−(1−a)n/r,&#160;the&#160;graph&#160;P&#160;j(σ<br/>
)&#160;is&#160;(ε<br/>
i<br/>
i)&#160;(and&#160;thus&#160;Ajt+1<br/>
t+1,&#160;dj&#160;d′)-super-regular.<br/>
Note&#160;that&#160;djd′&#160;≥&#160;d′t+2,&#160;as&#160;required.<br/>
−<br/>
Using&#160;a&#160;union&#160;bound,&#160;it&#160;follows&#160;from&#160;Claims&#160;2&#160;and&#160;3&#160;that&#160;with&#160;probability&#160;at&#160;least<br/>
e−µ1/3n&#160;−&#160;r(1&#160;−&#160;a)n/r&#160;&gt;&#160;0,<br/>
σ&#160;has&#160;the&#160;property&#160;that&#160;φt+1&#160;satisfies&#160;S(t&#160;+&#160;1).&#160;This&#160;completes&#160;the&#160;proof.<br/>
<br/>
<hr/>
<a name=24></a>24<br/>
S.&#160;GLOCK&#160;AND&#160;F.&#160;JOOS<br/>
6.&#160;Applications<br/>
6.1.&#160;Rainbow&#160;spanning&#160;trees&#160;in&#160;Dirac&#160;graphs.&#160;Although&#160;the&#160;following&#160;result&#160;is&#160;implied&#160;by&#160;the<br/>rainbow&#160;bandwidth&#160;theorem&#160;which&#160;we&#160;prove&#160;in&#160;the&#160;next&#160;subsection,&#160;we&#160;state&#160;and&#160;prove&#160;it&#160;here&#160;to<br/>illustrate&#160;an&#160;easy&#160;application&#160;of&#160;our&#160;blow-up&#160;lemma.<br/>
Theorem&#160;6.1.&#160;<i>Suppose&#160;</i>1/n&#160;≪&#160;µ&#160;≪&#160;δ,&#160;1/∆<i>.&#160;Suppose&#160;</i>G&#160;<i>is&#160;a&#160;graph&#160;on&#160;</i>n&#160;<i>vertices&#160;such&#160;that&#160;</i>δ(G)&#160;≥<br/>(1/2&#160;+&#160;δ)n<i>.&#160;Then,&#160;given&#160;any&#160;</i>µn<i>-bounded&#160;edge&#160;colouring&#160;of&#160;</i>G<i>,&#160;the&#160;graph&#160;</i>G&#160;<i>contains&#160;any&#160;tree&#160;</i>T&#160;<i>on&#160;</i>n<br/><i>vertices&#160;with&#160;</i>∆(T&#160;)&#160;≤&#160;∆&#160;<i>as&#160;a&#160;rainbow&#160;subgraph.</i><br/>
Koml´os,&#160;S´<br/>
ark¨ozy&#160;and&#160;Szemer´edi&#160;<a href="1802.07700s.html#29">[29]&#160;</a>proved&#160;this&#160;result&#160;in&#160;the&#160;non-rainbow&#160;setting&#160;even&#160;before&#160;the<br/>
development&#160;of&#160;the&#160;blow-up&#160;lemma&#160;(some&#160;of&#160;the&#160;ideas&#160;which&#160;later&#160;led&#160;to&#160;the&#160;blow-up&#160;lemma&#160;were&#160;already<br/>present&#160;there).&#160;With&#160;a&#160;blow-up&#160;lemma&#160;at&#160;hand,&#160;the&#160;proof&#160;becomes&#160;much&#160;shorter.&#160;It&#160;essentially&#160;boils<br/>down&#160;to&#160;distributing&#160;the&#160;vertices&#160;of&#160;T&#160;evenly&#160;among&#160;the&#160;clusters&#160;of&#160;the&#160;regularity&#160;partition,&#160;with&#160;the<br/>reduced&#160;graph&#160;being&#160;a&#160;Hamilton&#160;cycle.&#160;For&#160;this,&#160;we&#160;need&#160;the&#160;following&#160;result,&#160;which&#160;essentially&#160;appears<br/>in&#160;<a href="1802.07700s.html#29">[23]&#160;</a>and&#160;uses&#160;the&#160;fact&#160;that&#160;the&#160;symmetric&#160;Markov&#160;chain&#160;on&#160;an&#160;odd&#160;cycle&#160;mixes&#160;rapidly.<br/>
Lemma&#160;6.2&#160;(<a href="1802.07700s.html#29">[23])</a>.&#160;<i>Suppose&#160;</i>1/n&#160;≪&#160;1/r,&#160;1/∆&#160;<i>and&#160;</i>r&#160;<i>is&#160;odd.&#160;Suppose&#160;</i>T&#160;<i>is&#160;a&#160;tree&#160;on&#160;</i>n&#160;<i>vertices&#160;with<br/></i>∆(T&#160;)&#160;≤&#160;∆<i>.&#160;Then&#160;there&#160;is&#160;a&#160;partition&#160;</i>(Xi)i∈[r]&#160;<i>of&#160;</i>V&#160;(T&#160;)&#160;<i>such&#160;that</i><br/>
(i)&#160;<i>the&#160;endvertices&#160;of&#160;any&#160;edge&#160;of&#160;</i>T&#160;<i>lie&#160;in&#160;two&#160;consecutive&#160;sets&#160;</i>Xi,&#160;Xi+1&#160;<i>(where&#160;</i>Xr+1&#160;<i>is&#160;identified</i><br/>
<i>with&#160;</i>X1<i>),</i><br/>
(ii)&#160;|Xi|&#160;=&#160;n/r&#160;±&#160;n/&#160;log2&#160;n&#160;<i>for&#160;all&#160;</i>i&#160;∈&#160;[r]<i>,&#160;and</i><br/>
(iii)&#160;<i>for&#160;every&#160;</i>i&#160;∈&#160;[r]<i>,&#160;the&#160;vertex&#160;set&#160;</i>Xi+1&#160;<i>contains&#160;at&#160;least&#160;</i>2−∆−3n/r&#160;<i>vertices&#160;</i>v&#160;∈&#160;V&#160;(T&#160;)&#160;<i>such&#160;that</i><br/>
NT&#160;(v)&#160;⊆&#160;Xi<i>.</i><br/>
We&#160;remark&#160;here&#160;that&#160;for&#160;a&#160;cycle&#160;on&#160;n&#160;vertices&#160;it&#160;is&#160;easy&#160;to&#160;find&#160;a&#160;vertex&#160;decomposition&#160;as&#160;described<br/>
in&#160;Lemma&#160;<a href="1802.07700s.html#24">6.2.&#160;</a>As&#160;the&#160;following&#160;proof&#160;only&#160;uses&#160;these&#160;properties&#160;of&#160;T&#160;and&#160;the&#160;fact&#160;that&#160;∆(T&#160;)&#160;≤&#160;∆,&#160;(the<br/>proof&#160;of)&#160;Theorem&#160;<a href="1802.07700s.html#24">6.1&#160;</a>also&#160;implies&#160;the&#160;existence&#160;of&#160;a&#160;rainbow&#160;Hamilton&#160;cycle&#160;under&#160;the&#160;same&#160;assumptions<br/>on&#160;G.<br/>
Proof&#160;of&#160;Theorem&#160;<a href="1802.07700s.html#24">6.1.</a><br/>
Let&#160;G&#160;and&#160;T&#160;be&#160;as&#160;in&#160;the&#160;statement;&#160;in&#160;particular,&#160;we&#160;assume&#160;that&#160;some<br/>
µn-bounded&#160;edge&#160;colouring&#160;of&#160;G&#160;is&#160;given.&#160;Choose&#160;new&#160;constants&#160;ε,&#160;d&#160;such&#160;that&#160;µ&#160;≪&#160;ε&#160;≪&#160;d&#160;≪&#160;δ,&#160;1/∆.&#160;We<br/>apply&#160;the&#160;regularity&#160;lemma&#160;to&#160;G&#160;and&#160;obtain&#160;a&#160;vertex&#160;partition&#160;(Vi)i∈[r]&#160;such&#160;that<br/>
0<br/>
•&#160;|V1|&#160;=&#160;.&#160;.&#160;.&#160;=&#160;|Vr|&#160;for&#160;some&#160;odd&#160;r&#160;(we&#160;may&#160;assume&#160;µ&#160;≪&#160;1/r&#160;≪&#160;ε),<br/>•&#160;|V0|&#160;≤&#160;εn,&#160;and<br/>•&#160;for&#160;every&#160;i&#160;∈&#160;[r]&#160;and&#160;for&#160;all&#160;but&#160;at&#160;most&#160;εr&#160;integers&#160;j&#160;∈&#160;[r]&#160;\&#160;{i},&#160;the&#160;graph&#160;G[Vi,&#160;Vj]&#160;is&#160;ε-regular.<br/>
Let&#160;R&#160;be&#160;the&#160;graph&#160;with&#160;vertex&#160;set&#160;[r]&#160;where&#160;two&#160;vertices&#160;i,&#160;j&#160;∈&#160;[r]&#160;are&#160;joined&#160;by&#160;an&#160;edge&#160;if&#160;G[Vi,&#160;Vj]&#160;is<br/>lower&#160;(ε,&#160;d)-regular.&#160;As&#160;δ(G)&#160;≥&#160;(1/2&#160;+&#160;δ)n,&#160;it&#160;is&#160;not&#160;hard&#160;to&#160;see&#160;that&#160;δ(R)&#160;≥&#160;(1/2&#160;+&#160;δ/2)r.&#160;Hence&#160;R<br/>contains&#160;a&#160;Hamilton&#160;cycle&#160;C.&#160;Without&#160;loss&#160;of&#160;generality,&#160;we&#160;may&#160;assume&#160;that&#160;1,&#160;2,&#160;.&#160;.&#160;.&#160;,&#160;r&#160;appear&#160;in&#160;this<br/>order&#160;on&#160;C.&#160;Below&#160;we&#160;always&#160;identify&#160;vertex&#160;sets&#160;Sr+1&#160;with&#160;S1.<br/>
By&#160;Fact&#160;<a href="1802.07700s.html#15">5.5,&#160;</a>one&#160;can&#160;remove&#160;at&#160;most&#160;2εn/r&#160;vertices&#160;from&#160;every&#160;Vi&#160;(call&#160;the&#160;new&#160;vertex&#160;sets&#160;e<br/>
V&#160;′i)&#160;such<br/>
that&#160;G[&#160;e<br/>
V&#160;′i,&#160;e<br/>
V&#160;′i+1]&#160;is&#160;lower&#160;(4ε,&#160;d)-super-regular&#160;for&#160;all&#160;i&#160;∈&#160;[r].&#160;For&#160;purposes&#160;that&#160;will&#160;become&#160;clear&#160;below,<br/>
we&#160;remove&#160;even&#160;more&#160;vertices.&#160;So&#160;let&#160;us&#160;remove&#160;from&#160;every&#160;Vi&#160;exactly&#160;ε1/2n/r&#160;vertices&#160;(in&#160;total)&#160;and<br/>add&#160;them&#160;to&#160;V0&#160;(call&#160;the&#160;new&#160;vertex&#160;sets&#160;V&#160;′i)&#160;such&#160;that&#160;G[V&#160;′i,&#160;V&#160;′i+1]&#160;is&#160;lower&#160;(2ε1/2,&#160;d)-super-regular&#160;for<br/>all&#160;i&#160;∈&#160;[r]&#160;(where&#160;V&#160;′r+1&#160;:=&#160;V&#160;′1).&#160;We&#160;claim&#160;that<br/>
(i)&#160;ε1/2n&#160;≤&#160;|V&#160;′0|&#160;≤&#160;(ε1/2&#160;+&#160;ε)n,<br/>
(ii)&#160;for&#160;every&#160;vertex&#160;v&#160;∈&#160;V&#160;′0,&#160;there&#160;are&#160;at&#160;least&#160;(1/2&#160;+&#160;δ/2)r&#160;integers&#160;i&#160;∈&#160;[r]&#160;such&#160;that&#160;v&#160;has&#160;at&#160;least<br/>
dn/2r&#160;neighbours&#160;in&#160;V&#160;′i,&#160;and<br/>
(iii)&#160;for&#160;every&#160;i&#160;∈&#160;[r],&#160;there&#160;are&#160;at&#160;least&#160;(1/2&#160;+&#160;δ/3)|V&#160;′0|&#160;vertices&#160;in&#160;V&#160;′0&#160;that&#160;have&#160;at&#160;least&#160;dn/2r<br/>
neighbours&#160;in&#160;V&#160;′i.<br/>
Indeed,&#160;(i)&#160;is&#160;trivial.&#160;To&#160;see&#160;(ii),&#160;consider&#160;v&#160;∈&#160;V&#160;′0.&#160;Clearly,&#160;v&#160;has&#160;at&#160;most&#160;|V&#160;′0|&#160;≤&#160;2ε1/2n&#160;neighbours&#160;in<br/>V&#160;′0&#160;and&#160;at&#160;most&#160;dn&#160;neighbours&#160;in&#160;clusters&#160;V&#160;′i&#160;in&#160;which&#160;v&#160;has&#160;less&#160;than&#160;dn/2r&#160;neighbours.&#160;As&#160;d&#160;≪&#160;δ&#160;and<br/>δ(G)&#160;≥&#160;(1/2&#160;+&#160;δ)n,&#160;statement&#160;(ii)&#160;follows.&#160;To&#160;see&#160;(iii),&#160;we&#160;fix&#160;some&#160;i&#160;∈&#160;[r]&#160;and&#160;let&#160;j&#160;∈&#160;NR(i).&#160;As&#160;G[Vi,&#160;Vj]<br/>is&#160;lower&#160;(ε,&#160;d)-regular,&#160;among&#160;the&#160;ε1/2n/r&#160;vertices&#160;we&#160;moved&#160;from&#160;Vj&#160;to&#160;V0,&#160;at&#160;least&#160;(ε1/2&#160;−&#160;2ε)n/r&#160;have<br/>at&#160;least&#160;(d&#160;−&#160;ε)|Vi|&#160;≥&#160;dn/2r&#160;neighbours&#160;in&#160;Vi&#160;by&#160;Fact&#160;<a href="1802.07700s.html#15">5.5.&#160;</a>Now&#160;(iii)&#160;follows&#160;as&#160;dR(i)&#160;≥&#160;(1/2&#160;+&#160;δ/2)r&#160;and<br/>by&#160;(i).<br/>
Next&#160;we&#160;apply&#160;Lemma&#160;<a href="1802.07700s.html#24">6.2&#160;</a>to&#160;T&#160;and&#160;obtain&#160;a&#160;vertex&#160;partition&#160;(Xi)i∈[r]&#160;of&#160;V&#160;(T&#160;)&#160;such&#160;that&#160;the&#160;endvertices<br/>
of&#160;every&#160;edge&#160;lie&#160;in&#160;consecutive&#160;parts&#160;(modulo&#160;r)&#160;and&#160;|Xi|&#160;=&#160;n/r&#160;±&#160;n/&#160;log2&#160;n&#160;for&#160;all&#160;i&#160;∈&#160;[r].&#160;Moreover,<br/>Xi+1&#160;contains&#160;at&#160;least&#160;2−∆−3n/r&#160;vertices&#160;such&#160;that&#160;all&#160;their&#160;neighbours&#160;lie&#160;in&#160;Xi;&#160;among&#160;those&#160;vertices&#160;we<br/>
<hr/>
<a name=25></a>25<br/>
select&#160;a&#160;2-independent&#160;set&#160;b<br/>
Xi+1&#160;of&#160;size&#160;exactly&#160;|Xi+1|&#160;−&#160;|V&#160;′i+1|.&#160;For&#160;all&#160;i&#160;∈&#160;[r],&#160;since&#160;|Xi|&#160;=&#160;n/r&#160;±&#160;n/&#160;log2&#160;n<br/>
and&#160;|V&#160;′i|&#160;=&#160;(1&#160;−&#160;ε1/2&#160;±&#160;ε)n/r,&#160;we&#160;have&#160;that<br/>
(6.1)<br/>
|&#160;b<br/>
Xi|&#160;=&#160;(1&#160;±&#160;δ/10)ε1/2n/r.<br/>
Let&#160;X′i&#160;:=&#160;Xi&#160;\&#160;b<br/>
Xi.&#160;Hence&#160;|X′i|&#160;=&#160;|V&#160;′i|.<br/>
Let&#160;X′0&#160;:=&#160;b<br/>
X1&#160;∪&#160;·&#160;·&#160;·&#160;∪&#160;b<br/>
Xr.&#160;It&#160;is&#160;easy&#160;to&#160;see&#160;that&#160;X′0&#160;is&#160;2-independent&#160;and&#160;|V&#160;′0|&#160;=&#160;|X′0|.&#160;We&#160;wish&#160;to<br/>
apply&#160;the&#160;rainbow&#160;blow-up&#160;lemma&#160;to&#160;the&#160;blow-up&#160;instance&#160;(T,&#160;G,&#160;C,&#160;(X′i)i∈[r]&#160;,&#160;(V&#160;′<br/>
).&#160;Before,&#160;we<br/>
0<br/>
i&#160;)i∈[r]0<br/>
need&#160;to&#160;find&#160;a&#160;feasible&#160;partial&#160;embedding&#160;φ0&#160;:&#160;X′0&#160;→&#160;V&#160;′0&#160;and&#160;define&#160;appropriate&#160;candidacy&#160;graphs&#160;for&#160;the<br/>remaining&#160;vertices.&#160;Next,&#160;we&#160;want&#160;to&#160;match&#160;the&#160;vertices&#160;in&#160;V&#160;′0&#160;and&#160;X′0&#160;such&#160;that&#160;whenever&#160;v&#160;∈&#160;V&#160;′0&#160;is<br/>matched&#160;to&#160;x&#160;∈&#160;b<br/>
Xi+1,&#160;the&#160;vertex&#160;v&#160;has&#160;at&#160;least&#160;dn/2r&#160;neighbours&#160;in&#160;V&#160;′i.&#160;To&#160;this&#160;end,&#160;let&#160;H&#160;be&#160;the<br/>
bipartite&#160;graph&#160;with&#160;bipartition&#160;(V&#160;′0,&#160;X′0)&#160;and&#160;join&#160;v&#160;∈&#160;V&#160;′0,&#160;x&#160;∈&#160;b<br/>
Xi+1&#160;whenever&#160;dG(v,&#160;V&#160;′i)&#160;≥&#160;dn/2r.&#160;By<br/>
(iii),&#160;we&#160;have&#160;dH(x)&#160;≥&#160;(1/2&#160;+&#160;δ/3)|V&#160;′0|&#160;for&#160;all&#160;x&#160;∈&#160;X′0.&#160;Moreover,&#160;for&#160;all&#160;v&#160;∈&#160;V&#160;′0,&#160;we&#160;have<br/>
(ii),<a href="1802.07700s.html#25">(6.1)</a><br/>
(i)<br/>
dH&#160;(v)<br/>
≥<br/>
(1/2&#160;+&#160;δ/2)r&#160;·&#160;(1&#160;−&#160;δ/10)ε1/2n/r&#160;≥&#160;(1/2&#160;+&#160;δ/3)|V&#160;′0|.<br/>
Clearly,&#160;by&#160;Hall’s&#160;theorem,&#160;H&#160;contains&#160;a&#160;perfect&#160;matching&#160;φ0&#160;:&#160;X′0&#160;→&#160;V&#160;′0.<br/>
Now,&#160;consider&#160;i&#160;∈&#160;[r].&#160;We&#160;need&#160;to&#160;define&#160;a&#160;suitable&#160;candidacy&#160;graph&#160;Ai.&#160;Note&#160;that&#160;at&#160;most&#160;2∆ε1/2|X′i|<br/>
vertices&#160;of&#160;X′i&#160;have&#160;a&#160;neighbour&#160;in&#160;X′0.&#160;For&#160;these&#160;vertices&#160;we&#160;have&#160;to&#160;restrict&#160;their&#160;candidate&#160;set.&#160;Now<br/>suppose&#160;that&#160;x&#160;∈&#160;X′i&#160;has&#160;a&#160;(unique)&#160;neighbour&#160;x′&#160;in&#160;X′0.&#160;Observe&#160;that&#160;we&#160;must&#160;have&#160;x′&#160;∈&#160;b<br/>
Xi+1.&#160;We<br/>
define&#160;NAi(x)&#160;:=&#160;NG(φ0(x′),&#160;V&#160;′i).&#160;By&#160;definition&#160;of&#160;H,&#160;we&#160;have&#160;that&#160;|NAi(x)|&#160;≥&#160;dn/2r.&#160;For&#160;the&#160;vertices<br/>x&#160;∈&#160;X′i&#160;\&#160;NT&#160;(X′0),&#160;we&#160;can&#160;define&#160;NAi(x)&#160;:=&#160;V&#160;′i.&#160;Thus,&#160;Ai&#160;is&#160;lower&#160;(ε1/3,&#160;d/2)-super-regular.&#160;Moreover,&#160;we<br/>have&#160;met&#160;condition&#160;<a href="1802.07700s.html#13">(EXC1),&#160;</a>and&#160;since&#160;X′0&#160;is&#160;2-independent,&#160;φ0&#160;is&#160;2∆µn-feasible.&#160;Thus,&#160;since&#160;the&#160;blow-up<br/>instance&#160;(T,&#160;G,&#160;C,&#160;(X′i)i∈[r]&#160;,&#160;(V&#160;′<br/>
)&#160;with&#160;candidacy&#160;graphs&#160;(Ai)<br/>
0<br/>
i&#160;)i∈[r]0<br/>
i∈[r]&#160;is&#160;lower&#160;(ε1/3,&#160;d/2)-super-regular,<br/>
an&#160;application&#160;of&#160;the&#160;rainbow&#160;blow-up&#160;lemma&#160;(Lemma&#160;<a href="1802.07700s.html#14">5.1)&#160;</a>yields&#160;a&#160;rainbow&#160;embedding&#160;of&#160;T&#160;into&#160;G.<br/>
<br/>
6.2.&#160;Rainbow&#160;bandwidth&#160;theorem.&#160;In&#160;this&#160;subsection,&#160;we&#160;apply&#160;the&#160;rainbow&#160;blow-up&#160;lemma&#160;to&#160;prove<br/>a&#160;rainbow&#160;bandwidth&#160;theorem&#160;(Theorem&#160;<a href="1802.07700s.html#3">1.2)</a>.&#160;Due&#160;to&#160;the&#160;proof&#160;in&#160;<a href="1802.07700s.html#29">[9]&#160;</a>being&#160;carried&#160;out&#160;in&#160;a&#160;very&#160;modular<br/>way,&#160;we&#160;can&#160;directly&#160;make&#160;use&#160;of&#160;important&#160;parts&#160;of&#160;the&#160;original&#160;proof.&#160;In&#160;fact,&#160;B¨ottcher,&#160;Schacht&#160;and<br/>Taraz&#160;<a href="1802.07700s.html#29">[9]&#160;</a>proved&#160;a&#160;slightly&#160;more&#160;general&#160;result&#160;(and&#160;so&#160;do&#160;we).&#160;As&#160;mentioned&#160;earlier,&#160;the&#160;minimum&#160;degree<br/>threshold&#160;in&#160;the&#160;bandwidth&#160;theorem&#160;is&#160;in&#160;general&#160;not&#160;optimal.&#160;For&#160;example,&#160;if&#160;H&#160;is&#160;a&#160;Hamilton&#160;cycle&#160;and<br/>n&#160;is&#160;odd,&#160;then&#160;χ(H)&#160;=&#160;3,&#160;yet&#160;δ(G)&#160;≥&#160;n/2&#160;already&#160;suffices&#160;to&#160;find&#160;H.&#160;Roughly&#160;speaking,&#160;this&#160;is&#160;because<br/>H&#160;is&#160;essentially&#160;2-colourable,&#160;except&#160;that&#160;we&#160;need&#160;an&#160;additional&#160;colour&#160;for&#160;one&#160;vertex.&#160;This&#160;motivates<br/>the&#160;following&#160;definition.&#160;Suppose&#160;the&#160;vertex&#160;set&#160;of&#160;H&#160;is&#160;[n].&#160;For&#160;ℓ,&#160;x,&#160;y&#160;∈&#160;N,&#160;we&#160;say&#160;an&#160;(ℓ&#160;+&#160;1)-colouring<br/>σ&#160;:&#160;V&#160;(H)&#160;→&#160;[ℓ]0&#160;of&#160;H&#160;is&#160;(x,&#160;y)<i>-zero&#160;free&#160;</i>if&#160;for&#160;each&#160;t&#160;∈&#160;[n],&#160;there&#160;exists&#160;a&#160;t′&#160;with&#160;t&#160;≤&#160;t′&#160;≤&#160;t&#160;+&#160;x&#160;such&#160;that<br/>σ(u)&#160;6=&#160;0&#160;for&#160;all&#160;u&#160;∈&#160;[t′,&#160;t′&#160;+&#160;y].<br/>
The&#160;following&#160;theorem&#160;can&#160;provide&#160;the&#160;optimal&#160;threshold&#160;for&#160;such&#160;graphs&#160;H,&#160;for&#160;example&#160;if&#160;H&#160;is&#160;the<br/>
(ℓ&#160;−&#160;1)-st&#160;power&#160;of&#160;a&#160;Hamilton&#160;cycle.&#160;We&#160;remark&#160;however&#160;that&#160;it&#160;does&#160;not&#160;always&#160;yield&#160;the&#160;optimal<br/>threshold,&#160;e.g.&#160;for&#160;C5-factors&#160;the&#160;optimal&#160;threshold&#160;is&#160;3/5&#160;(cf.&#160;<a href="1802.07700s.html#29">[34])</a>.<br/>
Theorem&#160;6.3.&#160;<i>Suppose&#160;</i>1/n&#160;≪&#160;µ,&#160;β&#160;≪&#160;δ,&#160;1/∆,&#160;1/ℓ<i>.&#160;Let&#160;</i>H&#160;<i>be&#160;a&#160;graph&#160;on&#160;vertex&#160;set&#160;</i>[n]&#160;<i>with&#160;</i>∆(H)&#160;≤&#160;∆<i>.<br/>Assume&#160;that&#160;</i>H&#160;<i>has&#160;an&#160;</i>(ℓ&#160;+&#160;1)<i>-colouring&#160;that&#160;is&#160;</i>(8ℓβn,&#160;4ℓβn)<i>-zero&#160;free&#160;and&#160;uses&#160;colour&#160;</i>0&#160;<i>at&#160;most&#160;</i>βn<br/><i>times.&#160;Also&#160;assume&#160;that&#160;</i>max{|i&#160;−&#160;j|:&#160;ij&#160;∈&#160;E(G)}&#160;≤&#160;βn<i>.&#160;Suppose&#160;</i>G&#160;<i>is&#160;a&#160;graph&#160;on&#160;</i>n&#160;<i>vertices&#160;with<br/></i>δ(G)&#160;≥&#160;(1&#160;−&#160;1/ℓ&#160;+&#160;δ)n<i>.&#160;Then,&#160;given&#160;any&#160;</i>µn<i>-bounded&#160;edge&#160;colouring&#160;of&#160;</i>G<i>,&#160;there&#160;is&#160;a&#160;rainbow&#160;copy&#160;of&#160;</i>H<br/><i>in&#160;</i>G<i>.</i><br/>
Obviously&#160;Theorem&#160;<a href="1802.07700s.html#25">6.3&#160;</a>implies&#160;Theorem&#160;<a href="1802.07700s.html#3">1.2,&#160;</a>and&#160;the&#160;remaining&#160;part&#160;of&#160;this&#160;section&#160;is&#160;devoted&#160;to<br/>
the&#160;proof&#160;of&#160;Theorem&#160;<a href="1802.07700s.html#25">6.3.&#160;</a>Its&#160;proof&#160;in&#160;<a href="1802.07700s.html#29">[9]&#160;</a>without&#160;the&#160;rainbow&#160;condition&#160;is&#160;based&#160;on&#160;three&#160;results,&#160;the<br/>so-called&#160;‘Lemma&#160;for&#160;G’,&#160;‘Lemma&#160;for&#160;H’&#160;and&#160;‘partial&#160;embedding&#160;lemma’&#160;(see&#160;Lemmas&#160;6,&#160;8&#160;and&#160;9&#160;in&#160;<a href="1802.07700s.html#29">[9])</a>.<br/>The&#160;first&#160;two&#160;are&#160;strong&#160;structural&#160;decomposition&#160;results&#160;for&#160;G&#160;and&#160;H,&#160;respectively,&#160;which&#160;prepare&#160;the<br/>application&#160;of&#160;the&#160;blow-up&#160;lemma&#160;and&#160;require&#160;the&#160;main&#160;part&#160;of&#160;the&#160;work&#160;done&#160;in&#160;<a href="1802.07700s.html#29">[9].&#160;</a>Fortunately,&#160;for&#160;the<br/>proof&#160;of&#160;Theorem&#160;<a href="1802.07700s.html#25">6.3&#160;</a>we&#160;can&#160;use&#160;the&#160;Lemmas&#160;for&#160;G&#160;and&#160;H&#160;without&#160;any&#160;alterations.<br/>
The&#160;partial&#160;embedding&#160;lemma&#160;deals&#160;with&#160;a&#160;very&#160;small&#160;set&#160;of&#160;exceptional&#160;vertices&#160;that&#160;cannot&#160;be<br/>
handled&#160;by&#160;the&#160;blow-up&#160;lemma&#160;directly.&#160;In&#160;<a href="1802.07700s.html#29">[9],&#160;</a>this&#160;is&#160;by&#160;far&#160;the&#160;easiest&#160;part&#160;and&#160;follows&#160;by&#160;standard<br/>techniques.&#160;However,&#160;it&#160;does&#160;not&#160;easily&#160;translate&#160;to&#160;the&#160;rainbow&#160;setting&#160;and&#160;hence&#160;we&#160;give&#160;a&#160;proof&#160;later&#160;in<br/>this&#160;section&#160;using&#160;the&#160;methods&#160;developed&#160;in&#160;this&#160;paper.&#160;We&#160;now&#160;state&#160;the&#160;partial&#160;embedding&#160;lemma&#160;for<br/>the&#160;rainbow&#160;setting,&#160;which&#160;replaces&#160;Lemma&#160;9&#160;from&#160;<a href="1802.07700s.html#29">[9].&#160;</a>Roughly&#160;speaking,&#160;it&#160;yields&#160;a&#160;rainbow&#160;embedding<br/>φ&#160;of&#160;a&#160;small&#160;exceptional&#160;set&#160;X&#160;such&#160;that&#160;every&#160;outside&#160;neighbour&#160;y&#160;∈&#160;Y&#160;:=&#160;NH(X)&#160;\&#160;X&#160;of&#160;vertices&#160;in&#160;X<br/>still&#160;has&#160;a&#160;large&#160;candidate&#160;set&#160;(and&#160;will&#160;later&#160;be&#160;embedded&#160;by&#160;the&#160;blow-up&#160;lemma).<br/>
<hr/>
<a name=26></a><img class="yflip" src="html/1802.07700-26_1.png"/><br/>
26<br/>
S.&#160;GLOCK&#160;AND&#160;F.&#160;JOOS<br/>
Lemma&#160;6.4.&#160;<i>Suppose&#160;</i>1/n&#160;≪&#160;µ,&#160;ε&#160;≪&#160;d′&#160;≪&#160;d,&#160;1/∆&#160;<i>and&#160;</i>µ&#160;≪&#160;1/r<i>.&#160;Suppose&#160;</i>R&#160;<i>is&#160;a&#160;graph&#160;on&#160;</i>[r]<i>.&#160;Suppose&#160;</i>G<br/><i>is&#160;a&#160;graph&#160;on&#160;</i>n&#160;<i>vertices&#160;with&#160;vertex&#160;partition&#160;</i>(Vi)i∈[r]&#160;<i>such&#160;that&#160;</i>G[Vi,&#160;Vj]&#160;<i>is&#160;lower&#160;</i>(ε,&#160;d)<i>-regular&#160;whenever<br/></i>ij&#160;∈&#160;E(R)&#160;<i>and&#160;</i>|Vi|&#160;=&#160;(1&#160;±&#160;ε)n/r<i>.&#160;Suppose&#160;</i>H&#160;<i>is&#160;a&#160;graph&#160;on&#160;at&#160;most&#160;</i>εn/r&#160;<i>vertices&#160;with&#160;vertex&#160;partition<br/></i>(X1,&#160;.&#160;.&#160;.&#160;,&#160;Xr,&#160;Y1,&#160;.&#160;.&#160;.&#160;,&#160;Yr)&#160;<i>such&#160;that&#160;</i>∆(H)&#160;≤&#160;∆&#160;<i>and&#160;</i>Zi&#160;:=&#160;Xi&#160;∪&#160;Yi&#160;<i>is&#160;an&#160;independent&#160;set&#160;for&#160;all&#160;</i>i&#160;∈&#160;[r]<i>.<br/>Moreover,&#160;whenever&#160;</i>zizj&#160;∈&#160;E(H)&#160;<i>with&#160;</i>zi&#160;∈&#160;Zi<i>,&#160;</i>zj&#160;∈&#160;Zj<i>,&#160;then&#160;</i>ij&#160;∈&#160;E(R)<i>.&#160;Let&#160;</i>X&#160;:=&#160;X1&#160;∪&#160;.&#160;.&#160;.&#160;∪&#160;Xr&#160;<i>and<br/></i>Y&#160;:=&#160;Y1&#160;∪&#160;.&#160;.&#160;.&#160;∪&#160;Yr<i>.&#160;Given&#160;any&#160;</i>µn<i>-bounded&#160;edge&#160;colouring&#160;</i>c:&#160;E(G)&#160;→&#160;C&#160;<i>of&#160;</i>G<i>,&#160;there&#160;exists&#160;a&#160;set&#160;of&#160;colours<br/></i>C′&#160;⊆&#160;C<i>,&#160;a&#160;rainbow&#160;embedding&#160;</i>φ:&#160;H[X]&#160;→&#160;GC\C′&#160;<i>and&#160;candidate&#160;sets&#160;</i>Sy&#160;⊆&#160;Vi&#160;<i>for&#160;all&#160;</i>y&#160;∈&#160;Yi&#160;<i>and&#160;</i>i&#160;∈&#160;[r]<br/><i>such&#160;that&#160;the&#160;following&#160;hold:</i><br/>
(i)&#160;φ(Xi)&#160;⊆&#160;Vi&#160;<i>for&#160;all&#160;</i>i&#160;∈&#160;[r]<i>;</i><br/>
(ii)&#160;<i>for&#160;all&#160;</i>y&#160;∈&#160;Y&#160;<i>,&#160;we&#160;have&#160;</i>|Sy|&#160;≥&#160;d′n/r&#160;<i>and&#160;for&#160;all&#160;</i>x&#160;∈&#160;NH(y)&#160;∩&#160;X&#160;<i>we&#160;have&#160;</i>Sy&#160;⊆&#160;NG&#160;(φ(x))<i>;</i><br/>
C′<br/>
(iii)&#160;<i>for&#160;all&#160;</i>y&#160;∈&#160;Y&#160;<i>,&#160;all&#160;distinct&#160;</i>x,&#160;x′&#160;∈&#160;NH(y)&#160;∩&#160;X&#160;<i>and&#160;all&#160;</i>v&#160;∈&#160;Sy<i>,&#160;we&#160;have&#160;</i>c(φ(x)v)&#160;6=&#160;c(φ(x′)v)<i>.</i><br/>
With&#160;the&#160;Lemmas&#160;for&#160;G&#160;and&#160;H&#160;at&#160;hand,&#160;the&#160;proof&#160;of&#160;Theorem&#160;<a href="1802.07700s.html#25">6.3&#160;</a>without&#160;the&#160;rainbow&#160;condition<br/>
works&#160;verbatim&#160;also&#160;for&#160;Theorem&#160;<a href="1802.07700s.html#25">6.3,&#160;</a>by&#160;replacing&#160;the&#160;partial&#160;embedding&#160;lemma&#160;with&#160;the&#160;rainbow&#160;partial<br/>embedding&#160;lemma&#160;and&#160;the&#160;blow-up&#160;lemma&#160;with&#160;the&#160;rainbow&#160;blow-up&#160;lemma.&#160;We&#160;provide&#160;a&#160;proof&#160;for<br/>completeness,&#160;but&#160;focus&#160;on&#160;the&#160;differences&#160;to&#160;the&#160;original&#160;proof.&#160;For&#160;integers&#160;r,&#160;ℓ,&#160;let&#160;Kr&#160;denote&#160;the<br/>
ℓ<br/>
vertex-disjoint&#160;union&#160;of&#160;r&#160;cliques&#160;of&#160;order&#160;ℓ.&#160;This&#160;will&#160;be&#160;a&#160;spanning&#160;subgraph&#160;of&#160;the&#160;reduced&#160;graph&#160;R<br/>indicating&#160;super-regular&#160;pairs,&#160;and&#160;the&#160;blow-up&#160;lemma&#160;will&#160;be&#160;applied&#160;with&#160;reduced&#160;graph&#160;Kr.&#160;In&#160;<a href="1802.07700s.html#29">[9],&#160;</a>Kr<br/>
ℓ<br/>
ℓ<br/>
is&#160;found&#160;within&#160;R&#160;inside&#160;a&#160;so-called&#160;‘backbone’,&#160;that&#160;is,&#160;the&#160;ℓ-cliques&#160;in&#160;Kr&#160;form&#160;a&#160;sequence&#160;where&#160;two<br/>
ℓ<br/>
consecutive&#160;cliques&#160;are&#160;joined&#160;almost&#160;completely&#160;in&#160;R.&#160;The&#160;purpose&#160;of&#160;this&#160;backbone&#160;is&#160;to&#160;allow&#160;changing<br/>the&#160;cluster&#160;sizes&#160;Vi&#160;in&#160;G&#160;slightly&#160;to&#160;match&#160;the&#160;cluster&#160;sizes&#160;of&#160;the&#160;H-partition&#160;given&#160;by&#160;the&#160;Lemma&#160;for&#160;H.<br/>
Proof&#160;of&#160;Theorem&#160;<a href="1802.07700s.html#25">6.3.</a><br/>
Choose&#160;new&#160;constants&#160;d,&#160;d′,&#160;ε,&#160;ξ,&#160;r′,&#160;r′′&#160;such&#160;that&#160;we&#160;have&#160;the&#160;following<br/>
hierarchy&#160;of&#160;parameters<br/>
1/n&#160;≪&#160;µ,&#160;β&#160;≪&#160;ξ&#160;≪&#160;1/r′′&#160;≪&#160;1/r′&#160;≪&#160;ε&#160;≪&#160;d′&#160;≪&#160;d&#160;≪&#160;δ,&#160;1/∆,&#160;1/ℓ.<br/>
Suppose&#160;now&#160;that&#160;G&#160;and&#160;H&#160;are&#160;as&#160;in&#160;the&#160;statement.&#160;In&#160;exactly&#160;the&#160;same&#160;way&#160;as&#160;in&#160;<a href="1802.07700s.html#29">[9],&#160;</a>we&#160;first&#160;use&#160;the<br/>structural&#160;results&#160;for&#160;G&#160;(Lemma&#160;6&#160;in&#160;<a href="1802.07700s.html#29">[9])&#160;</a>and&#160;H&#160;(Lemma&#160;8&#160;in&#160;<a href="1802.07700s.html#29">[9])</a>,&#160;respectively,&#160;to&#160;obtain&#160;a&#160;partition<br/>(Vi)i∈[ℓr]&#160;of&#160;V&#160;(G),&#160;a&#160;partition&#160;(Xi&#160;∪&#160;X′i)i∈[ℓr]&#160;of&#160;V&#160;(H)&#160;and&#160;a&#160;graph&#160;R&#160;on&#160;[ℓr]&#160;for&#160;some&#160;r′&#160;≤&#160;r&#160;≤&#160;r′′&#160;such<br/>that&#160;the&#160;following&#160;hold:<br/>
S<br/>
(i)&#160;|<br/>
X′<br/>
i∈[ℓr]<br/>
i&#160;|&#160;≤&#160;ξn;<br/>
(ii)&#160;|Xi&#160;∪&#160;X′i|&#160;=&#160;|Vi|&#160;=&#160;(1&#160;±&#160;ξ)&#160;n&#160;for&#160;all&#160;i&#160;∈&#160;[ℓr];<br/>
ℓr<br/>
(iii)&#160;R&#160;contains&#160;a&#160;Kℓ-factor&#160;Kr&#160;such&#160;that&#160;G[V<br/>
ℓ<br/>
i,&#160;Vj&#160;]&#160;is&#160;lower&#160;(ε,&#160;d)-regular&#160;for&#160;all&#160;ij&#160;∈&#160;E(R)&#160;and&#160;even<br/>
lower&#160;(ε,&#160;d)-super-regular&#160;if&#160;ij&#160;∈&#160;E(Kr);<br/>
ℓ<br/>
(iv)&#160;for&#160;all&#160;xy&#160;∈&#160;E(H)&#160;with&#160;x&#160;∈&#160;Xi&#160;∪&#160;X′i&#160;and&#160;y&#160;∈&#160;Xj&#160;∪&#160;X′j,&#160;we&#160;have&#160;ij&#160;∈&#160;E(R),&#160;and&#160;moreover&#160;we&#160;have<br/>
ij&#160;∈&#160;Kr&#160;if&#160;x<br/>
ℓ<br/>
∈&#160;Xi&#160;and&#160;y&#160;∈&#160;Xj.<br/>
For&#160;the&#160;first&#160;time,&#160;we&#160;need&#160;to&#160;make&#160;an&#160;easy&#160;amendment&#160;for&#160;the&#160;rainbow&#160;setting.&#160;Let&#160;c&#160;:&#160;E(G)&#160;→&#160;C<br/>
be&#160;any&#160;µn-bounded&#160;edge&#160;colouring.&#160;Note&#160;that&#160;we&#160;may&#160;assume&#160;that&#160;|C|&#160;≤&#160;3µ−1n,&#160;say.&#160;(Otherwise,&#160;there<br/>would&#160;be&#160;two&#160;colour&#160;classes&#160;with&#160;combined&#160;size&#160;at&#160;most&#160;µn&#160;and&#160;we&#160;could&#160;merge&#160;them.)&#160;We&#160;split&#160;the&#160;colour<br/>set&#160;C&#160;into&#160;two&#160;sets&#160;C1,&#160;C2&#160;such&#160;that&#160;GC&#160;has&#160;still&#160;R&#160;as&#160;a&#160;reduced&#160;graph&#160;and&#160;all&#160;lower&#160;(super-)regular<br/>
i<br/>
pairs&#160;halve&#160;their&#160;density.&#160;This&#160;can&#160;be&#160;achieved&#160;with&#160;Lemma&#160;<a href="1802.07700s.html#6">4.1.</a><br/>
S<br/>
Let&#160;X0&#160;:=<br/>
X′<br/>
i∈[ℓr]<br/>
i.&#160;Next&#160;we&#160;use&#160;the&#160;(rainbow)&#160;partial&#160;embedding&#160;lemma&#160;(Lemma&#160;<a href="1802.07700s.html#26">6.4&#160;</a>instead&#160;of<br/>
Lemma&#160;9&#160;in&#160;<a href="1802.07700s.html#29">[9])</a>,&#160;with&#160;X0,&#160;NH(X0)&#160;\&#160;X0,&#160;H[X0&#160;∪&#160;NH(X0)]&#160;playing&#160;the&#160;roles&#160;of&#160;X,&#160;Y,&#160;H,&#160;to&#160;obtain&#160;a&#160;set<br/>C′&#160;⊆&#160;C1,&#160;a&#160;rainbow&#160;embedding&#160;φ0&#160;:&#160;H[X0]&#160;→&#160;GC1\C′&#160;and&#160;a&#160;candidate&#160;set&#160;Sy&#160;for&#160;each&#160;y&#160;∈&#160;NH(X0)&#160;\&#160;X0<br/>such&#160;that&#160;the&#160;following&#160;hold:<br/>
(a)&#160;φ0(X′i)&#160;⊆&#160;Vi&#160;for&#160;all&#160;i&#160;∈&#160;[ℓr];<br/>
(b)&#160;for&#160;all&#160;y&#160;∈&#160;NH(X0)&#160;\&#160;X0&#160;with&#160;y&#160;∈&#160;Xi&#160;for&#160;some&#160;i&#160;∈&#160;[ℓr],&#160;we&#160;have&#160;Sy&#160;⊆&#160;Vi&#160;and&#160;|Sy|&#160;≥&#160;d′n/ℓr,&#160;and<br/>
for&#160;all&#160;x&#160;∈&#160;NH(y)&#160;∩&#160;X0,&#160;we&#160;have&#160;Sy&#160;⊆&#160;NG&#160;(φ<br/>
C′<br/>
0(x));<br/>
(c)&#160;for&#160;all&#160;y&#160;∈&#160;NH(X0)&#160;\&#160;X0,&#160;all&#160;distinct&#160;x,&#160;x′&#160;∈&#160;NH(y)&#160;∩&#160;X0&#160;and&#160;all&#160;v&#160;∈&#160;Sy,&#160;we&#160;have&#160;c(vφ(x))&#160;6=<br/>
c(vφ(x′)).<br/>
Let&#160;V&#160;′0&#160;:=&#160;φ0(X0)&#160;and&#160;V&#160;′i&#160;:=&#160;Vi&#160;\&#160;V0&#160;for&#160;all&#160;i&#160;∈&#160;[ℓr].&#160;By&#160;<a href="1802.07700s.html#26">(a),&#160;</a>we&#160;have&#160;|V&#160;′i|&#160;=&#160;|Xi|&#160;for&#160;all&#160;i&#160;∈&#160;[ℓr].&#160;Let<br/>
H′&#160;:=&#160;H&#160;−&#160;H[X0].<br/>
Now&#160;we&#160;want&#160;to&#160;use&#160;the&#160;rainbow&#160;blow-up&#160;lemma&#160;to&#160;embed&#160;H′&#160;into&#160;GC2∪C′.&#160;As&#160;a&#160;blow-up&#160;instance<br/>
we&#160;use&#160;(H′,&#160;GC<br/>
,&#160;(X<br/>
,&#160;(V&#160;′<br/>
)&#160;with&#160;the&#160;obvious&#160;candidacy&#160;graphs,&#160;where&#160;the&#160;candidate<br/>
2∪C&#160;′&#160;,&#160;K&#160;r<br/>
ℓ<br/>
i)i∈[ℓr]0<br/>
i&#160;)i∈[ℓr]0<br/>
set&#160;of&#160;y&#160;∈&#160;NH(X0)&#160;\&#160;X0&#160;is&#160;Sy&#160;and&#160;there&#160;are&#160;no&#160;restrictions&#160;for&#160;other&#160;vertices.&#160;From&#160;<a href="1802.07700s.html#26">(b),&#160;(c)&#160;</a>and&#160;the&#160;fact<br/>that&#160;∆(H)&#160;≤&#160;∆,&#160;we&#160;conclude&#160;that&#160;φ0&#160;is&#160;2∆µn-feasible.&#160;Thus,&#160;Lemma&#160;<a href="1802.07700s.html#14">5.1&#160;</a>yields&#160;a&#160;rainbow&#160;embedding&#160;φ<br/>of&#160;H′&#160;into&#160;GC2∪C′&#160;which&#160;extends&#160;φ0.&#160;Since&#160;φ0&#160;and&#160;φ&#160;use&#160;distinct&#160;colours,&#160;this&#160;is&#160;a&#160;rainbow&#160;embedding<br/>of&#160;H,&#160;completing&#160;the&#160;proof.<br/>
<br/>
<hr/>
<a name=27></a>27<br/>
It&#160;remains&#160;to&#160;prove&#160;Lemma&#160;<a href="1802.07700s.html#26">6.4,&#160;</a>for&#160;which&#160;we&#160;need&#160;the&#160;following&#160;straightforward&#160;consequence&#160;of<br/>
Lemma&#160;<a href="1802.07700s.html#18">5.8&#160;</a>and&#160;Proposition&#160;<a href="1802.07700s.html#18">5.9.</a><br/>
Corollary&#160;6.5.&#160;<i>Suppose&#160;</i>1/n&#160;≪&#160;µ,&#160;ε&#160;≪&#160;d&#160;<i>and&#160;</i>µ&#160;≪&#160;1/r<i>.&#160;Let&#160;</i>V1,&#160;.&#160;.&#160;.&#160;,&#160;Vr&#160;<i>be&#160;disjoint&#160;vertex&#160;sets&#160;such&#160;that</i><br/>
S<br/>
|V&#160;|&#160;=&#160;n<i>,&#160;where&#160;</i>V&#160;:=<br/>
V<br/>
i∈[r]<br/>
i<i>,&#160;and&#160;</i>n/(2r)&#160;≤&#160;|Vi|&#160;≤&#160;2n/r&#160;<i>for&#160;all&#160;</i>i&#160;∈&#160;[r]<i>.&#160;Suppose&#160;</i>X1,&#160;.&#160;.&#160;.&#160;,&#160;Xr&#160;<i>are&#160;disjoint</i><br/>
S<br/>
<i>vertex&#160;sets&#160;such&#160;that&#160;</i>|Xi|&#160;≤&#160;εn/r&#160;<i>for&#160;all&#160;</i>i&#160;∈&#160;[r]<i>.&#160;Let&#160;</i>X&#160;:=<br/>
X<br/>
i∈[r]<br/>
i<i>.&#160;Suppose&#160;</i>G&#160;<i>is&#160;a&#160;bipartite&#160;graph</i><br/>
<i>with&#160;vertex&#160;partition&#160;</i>(X,&#160;V&#160;)&#160;<i>and&#160;suppose&#160;every&#160;edge&#160;in&#160;</i>G&#160;<i>joins&#160;</i>Xi&#160;<i>and&#160;</i>Vi&#160;<i>for&#160;some&#160;</i>i&#160;∈&#160;[r]<i>.&#160;Suppose<br/>that&#160;</i>dG(x)&#160;≥&#160;dn/r&#160;<i>for&#160;all&#160;</i>x&#160;∈&#160;X<i>.&#160;Then,&#160;given&#160;any&#160;</i>µn<i>-bounded&#160;system&#160;of&#160;conflicts&#160;for&#160;</i>G<i>,&#160;there&#160;is&#160;a<br/>conflict-free&#160;matching&#160;covering&#160;</i>X<i>.</i><br/>
Proof.&#160;Define&#160;a&#160;supergraph&#160;G′&#160;of&#160;G&#160;on&#160;2n&#160;vertices&#160;as&#160;follows.&#160;First&#160;we&#160;add&#160;to&#160;every&#160;set&#160;Xi&#160;exactly<br/>
S<br/>
|Vi|&#160;−&#160;|Xi|&#160;new&#160;vertices&#160;and&#160;call&#160;the&#160;new&#160;set&#160;X′i.&#160;Let&#160;X′&#160;:=<br/>
X′<br/>
i∈[r]<br/>
i&#160;.<br/>
Next,&#160;we&#160;join&#160;every&#160;vertex<br/>
x&#160;∈&#160;X′i&#160;\&#160;Xi&#160;to&#160;all&#160;vertices&#160;in&#160;Vi.&#160;It&#160;is&#160;easy&#160;to&#160;see&#160;that&#160;G′[X′i,&#160;Vi]&#160;is&#160;lower&#160;(4ε,&#160;d/2)-super-regular&#160;for&#160;all<br/>i&#160;∈&#160;[r].&#160;Every&#160;conflict&#160;system&#160;of&#160;G&#160;easily&#160;transfers&#160;to&#160;a&#160;conflict&#160;system&#160;of&#160;G′.<br/>
Observe&#160;that&#160;by&#160;Proposition&#160;<a href="1802.07700s.html#18">5.9,&#160;</a>for&#160;every&#160;i&#160;∈&#160;[r],&#160;the&#160;graph&#160;G′[X′i,&#160;Vi]&#160;has&#160;a&#160;perfect&#160;matching,&#160;and<br/>
thus&#160;G′&#160;has&#160;one.&#160;In&#160;addition,&#160;for&#160;every&#160;perfect&#160;matching&#160;M&#160;of&#160;G′&#160;and&#160;every&#160;edge&#160;e&#160;∈&#160;M,&#160;there&#160;are<br/>at&#160;least&#160;d3/9&#160;·&#160;n2/(4r2)&#160;edges&#160;that&#160;are&#160;(e,&#160;M)-switchable.&#160;Hence,&#160;Lemma&#160;<a href="1802.07700s.html#18">5.8&#160;</a>implies&#160;the&#160;existence&#160;of&#160;a<br/>conflict-free&#160;perfect&#160;matching&#160;M&#160;′&#160;in&#160;G′.&#160;Let&#160;M&#160;⊆&#160;M′&#160;be&#160;the&#160;matching&#160;obtained&#160;by&#160;deleting&#160;all&#160;edges<br/>incident&#160;to&#160;X′&#160;\&#160;X.&#160;Consequently,&#160;M&#160;is&#160;a&#160;conflict-free&#160;matching&#160;of&#160;G&#160;covering&#160;X.<br/>
<br/>
The&#160;following&#160;proof&#160;is&#160;reminiscent&#160;of&#160;our&#160;main&#160;proof&#160;in&#160;Section&#160;<a href="1802.07700s.html#18">5.4&#160;</a>in&#160;that&#160;we&#160;proceed&#160;in&#160;rounds&#160;and<br/>
reserve&#160;exclusive&#160;colours&#160;for&#160;each&#160;round.&#160;It&#160;is&#160;much&#160;simpler&#160;though&#160;since&#160;we&#160;only&#160;need&#160;to&#160;embed&#160;a&#160;small<br/>fraction&#160;of&#160;all&#160;vertices.<br/>
Proof&#160;of&#160;Lemma&#160;<a href="1802.07700s.html#26">6.4.</a><br/>
As&#160;∆(H)&#160;≤&#160;∆,&#160;we&#160;can&#160;colour&#160;H2&#160;with&#160;T&#160;:=&#160;∆2&#160;+&#160;1&#160;colours.&#160;Hence,&#160;there<br/>
exists&#160;a&#160;partition&#160;of&#160;X&#160;into&#160;sets&#160;X1,&#160;.&#160;.&#160;.&#160;,&#160;XT&#160;which&#160;are&#160;2-independent&#160;in&#160;H.&#160;We&#160;define&#160;XT&#160;+1&#160;:=&#160;Y&#160;.&#160;We<br/>will&#160;proceed&#160;in&#160;T&#160;rounds&#160;and&#160;embed&#160;in&#160;round&#160;t&#160;∈&#160;[T&#160;]&#160;all&#160;vertices&#160;of&#160;Xt,&#160;whilst&#160;keeping&#160;track&#160;of&#160;candidate<br/>sets&#160;for&#160;the&#160;remaining&#160;vertices.<br/>
<br/>
Beforehand,&#160;we&#160;apply&#160;Lemma&#160;<a href="1802.07700s.html#6">4.1&#160;</a>to&#160;partition&#160;C&#160;into&#160;sets&#160;{Ct<br/>
:&#160;t<br/>
}&#160;such&#160;that&#160;G<br/>
[V<br/>
1t2<br/>
1t2&#160;∈&#160;[T&#160;+1]<br/>
2<br/>
Ct<br/>
i,&#160;Vj&#160;]<br/>
1&#160;t2<br/>
<br/>
<br/>
is&#160;lower&#160;(2ε,&#160;ˆ<br/>
d)-regular&#160;for&#160;all&#160;t1t2&#160;∈&#160;[T+1]&#160;and&#160;all&#160;ij<br/>
.&#160;Define&#160;Gt1t2&#160;:=<br/>
2<br/>
∈&#160;E(R),&#160;where&#160;ˆ<br/>
d&#160;:=&#160;d/&#160;T&#160;+1<br/>
2<br/>
GC<br/>
.<br/>
t1t2<br/>
In&#160;the&#160;beginning&#160;we&#160;set&#160;Sz(0)&#160;:=&#160;Vi&#160;for&#160;all&#160;i&#160;∈&#160;[r]&#160;and&#160;z&#160;∈&#160;Zi.&#160;We&#160;claim&#160;that&#160;after&#160;round&#160;t,&#160;we&#160;have<br/>
(a)&#160;a&#160;rainbow&#160;embedding&#160;φt&#160;of&#160;Ht&#160;:=&#160;H[X1&#160;∪&#160;·&#160;·&#160;·&#160;∪&#160;Xt]&#160;such&#160;that&#160;for&#160;every&#160;edge&#160;xy&#160;∈&#160;E(Ht)&#160;with<br/>
x&#160;∈&#160;Xt1&#160;and&#160;y&#160;∈&#160;Xt2,&#160;we&#160;have&#160;c(φt(xy))&#160;∈&#160;Ct&#160;;<br/>
1t2<br/>
(b)&#160;|Sz(t)|&#160;≥&#160;(&#160;ˆ<br/>
d/2)t&#160;·&#160;n/2r&#160;and&#160;Sz(t)&#160;⊆&#160;Vi&#160;\&#160;φt(V&#160;(Ht))&#160;for&#160;all&#160;i&#160;∈&#160;[r]&#160;and&#160;z&#160;∈&#160;Zi&#160;\&#160;V&#160;(Ht);<br/>
(c)&#160;for&#160;all&#160;t′&#160;∈&#160;[t],&#160;t′′&#160;∈&#160;[T&#160;+&#160;1]&#160;\&#160;[t],&#160;and&#160;all&#160;x′&#160;∈&#160;Xt′,&#160;x′′&#160;∈&#160;NH(x′)&#160;∩&#160;Xt′′,&#160;we&#160;have&#160;Sx′′(t)&#160;⊆<br/>
NGt′t′′&#160;(φt(x′)).<br/>
Indeed,&#160;our&#160;claim&#160;is&#160;true&#160;for&#160;t&#160;=&#160;0.&#160;Now&#160;let&#160;t&#160;&gt;&#160;0&#160;and&#160;suppose&#160;it&#160;is&#160;true&#160;for&#160;t&#160;−&#160;1.&#160;We&#160;first&#160;restrict&#160;the<br/>
candidate&#160;sets&#160;for&#160;the&#160;vertices&#160;in&#160;x&#160;∈&#160;Xt&#160;slightly.&#160;Consider&#160;any&#160;x&#160;∈&#160;Xt.&#160;By&#160;Fact&#160;<a href="1802.07700s.html#15">5.5,&#160;</a>for&#160;all&#160;but&#160;at&#160;most<br/>ε1/2n/r&#160;vertices&#160;v&#160;∈&#160;Sx(t&#160;−&#160;1),&#160;we&#160;have<br/>
(b)<br/>
(6.2)<br/>
dGtt′&#160;(v,&#160;Sx′(t&#160;−&#160;1))&#160;≥&#160;3&#160;ˆ<br/>
d/4&#160;·&#160;|Sx′(t&#160;−&#160;1)|&#160;≥&#160;3&#160;ˆ<br/>
d/4&#160;·&#160;(&#160;ˆ<br/>
d/2)t−1&#160;·&#160;n/2r.<br/>
for&#160;all&#160;t′&#160;&gt;&#160;t&#160;and&#160;x′&#160;∈&#160;NH(x)&#160;∩&#160;Xt′.&#160;Let&#160;Sx(t)&#160;be&#160;obtained&#160;from&#160;Sx(t&#160;−&#160;1)&#160;by&#160;removing&#160;all&#160;those&#160;vertices<br/>v&#160;∈&#160;Sx(t&#160;−&#160;1)&#160;for&#160;which&#160;<a href="1802.07700s.html#27">(6.2)&#160;</a>does&#160;not&#160;hold&#160;for&#160;some&#160;t′,&#160;x′.&#160;This&#160;will&#160;ensure&#160;that&#160;(b)&#160;and&#160;(c)&#160;hold&#160;again<br/>for&#160;the&#160;next&#160;step.<br/>
We&#160;now&#160;embed&#160;Xt&#160;by&#160;picking&#160;for&#160;every&#160;x&#160;∈&#160;Xt&#160;a&#160;suitable&#160;image&#160;from&#160;Sx(t).&#160;Let&#160;V&#160;:=&#160;V&#160;(G).&#160;We<br/>
define&#160;a&#160;bipartite&#160;graph&#160;J&#160;with&#160;bipartition&#160;(Xt,&#160;V&#160;\&#160;φt−1(V&#160;(Ht−1)))&#160;and&#160;we&#160;join&#160;every&#160;x&#160;∈&#160;Xt&#160;to&#160;all<br/>vertices&#160;in&#160;Sx(t).&#160;To&#160;ensure&#160;that&#160;the&#160;new&#160;embedding&#160;is&#160;again&#160;rainbow,&#160;we&#160;define&#160;a&#160;system&#160;of&#160;conflicts<br/>for&#160;E(J).&#160;For&#160;an&#160;edge&#160;xv&#160;∈&#160;E(J)&#160;with&#160;x&#160;∈&#160;Xt&#160;and&#160;v&#160;∈&#160;Sx(t),&#160;let&#160;Fxv&#160;be&#160;the&#160;set&#160;of&#160;edges&#160;φt−1(x′)v<br/>for&#160;x′&#160;∈&#160;NH(x)&#160;∩&#160;V&#160;(Ht−1).&#160;By&#160;(c),&#160;we&#160;have&#160;Fxv&#160;⊆&#160;E(G).&#160;Moreover,&#160;the&#160;colours&#160;of&#160;the&#160;edges&#160;in<br/>Fxv&#160;are&#160;distinct&#160;as&#160;the&#160;sets&#160;Xt′&#160;are&#160;2-independent.&#160;We&#160;let&#160;two&#160;distinct&#160;edges&#160;xv,&#160;x′v′&#160;∈&#160;E(J)&#160;conflict<br/>if&#160;c(Fxv)&#160;∩&#160;c(Fx′v′)&#160;6=&#160;∅.&#160;It&#160;is&#160;easy&#160;to&#160;see&#160;that&#160;this&#160;gives&#160;a&#160;µn-bounded&#160;conflict&#160;system.&#160;We&#160;apply<br/>Corollary&#160;<a href="1802.07700s.html#27">6.5&#160;</a>and&#160;obtain&#160;a&#160;conflict-free&#160;matching&#160;σ&#160;:&#160;Xt&#160;→&#160;V&#160;\&#160;φt−1(V&#160;(Ht−1)).&#160;Now,&#160;let&#160;φt&#160;be&#160;the<br/>extension&#160;of&#160;φt−1&#160;defined&#160;by&#160;φt(x)&#160;:=&#160;σ(x)&#160;for&#160;all&#160;x&#160;∈&#160;Xt.&#160;Observe&#160;that&#160;φt&#160;is&#160;a&#160;rainbow&#160;embedding&#160;of<br/>Ht&#160;with&#160;the&#160;properties&#160;required&#160;for&#160;(a).<br/>
Next&#160;we&#160;update&#160;the&#160;candidate&#160;sets&#160;Sx&#160;for&#160;all&#160;x&#160;∈&#160;Xt′&#160;with&#160;t′&#160;&gt;&#160;t.&#160;If&#160;x&#160;has&#160;no&#160;neighbour&#160;in&#160;Xt&#160;we&#160;only<br/>
remove&#160;φt(Xt)&#160;from&#160;Sx(t&#160;−&#160;1)&#160;to&#160;obtain&#160;Sx(t).&#160;If&#160;x′&#160;∈&#160;Xt&#160;is&#160;the&#160;neighbour&#160;of&#160;x&#160;(there&#160;is&#160;at&#160;most&#160;one&#160;for<br/>every&#160;x),&#160;we&#160;define<br/>
Sx(t)&#160;:=&#160;(Sx(t&#160;−&#160;1)&#160;∩&#160;NGtt′&#160;(σ(x′)))&#160;\&#160;φt(Xt).<br/>
<hr/>
<a name=28></a>28<br/>
S.&#160;GLOCK&#160;AND&#160;F.&#160;JOOS<br/>
This&#160;automatically&#160;ensures&#160;that&#160;(c)&#160;holds&#160;again&#160;for&#160;t.&#160;Moreover,&#160;by&#160;<a href="1802.07700s.html#27">(6.2)&#160;</a>and&#160;since&#160;|Xt|&#160;≤&#160;εn/r,&#160;we<br/>deduce&#160;that&#160;|Sx(t)|&#160;≥&#160;3&#160;ˆ<br/>
d/4&#160;·&#160;|Sx′(t&#160;−&#160;1)|&#160;−&#160;εn/r&#160;≥&#160;(&#160;ˆ<br/>
d/2)t&#160;·&#160;n/2r,&#160;hence&#160;(b)&#160;also&#160;holds&#160;for&#160;t.<br/>
S<br/>
Assume&#160;now&#160;that&#160;the&#160;claim&#160;holds&#160;for&#160;T&#160;.&#160;Let&#160;C′&#160;:=<br/>
C<br/>
t∈[T&#160;]<br/>
t,T&#160;+1.<br/>
By&#160;(a),&#160;φ&#160;:=&#160;φT&#160;is&#160;a&#160;rainbow<br/>
embedding&#160;of&#160;H[X]&#160;into&#160;GC\C′.&#160;For&#160;all&#160;y&#160;∈&#160;Y&#160;,&#160;let&#160;Sy&#160;:=&#160;Sy(T&#160;).&#160;It&#160;remains&#160;to&#160;check&#160;that&#160;(i)–(iii)&#160;hold.<br/>Clearly,&#160;(i)&#160;holds&#160;as&#160;we&#160;have&#160;Sz&#160;⊆&#160;Vi&#160;for&#160;all&#160;z&#160;∈&#160;Zi&#160;and&#160;all&#160;i&#160;∈&#160;[r]&#160;throughout&#160;the&#160;embedding.&#160;Since<br/>d′&#160;≤&#160;(&#160;ˆ<br/>
d/2)T&#160;/2,&#160;we&#160;have&#160;|Sy|&#160;≥&#160;d′n/r&#160;for&#160;all&#160;y&#160;∈&#160;Y&#160;by&#160;(b).&#160;Moreover,&#160;from&#160;(c)&#160;we&#160;deduce&#160;that&#160;for&#160;all&#160;y&#160;∈&#160;Y&#160;,<br/>
t&#160;∈&#160;[T&#160;]&#160;and&#160;x&#160;∈&#160;NH(y)&#160;∩&#160;Xt,&#160;we&#160;have&#160;Sy&#160;⊆&#160;NGt,T+1(φ(x)).&#160;Since&#160;Gt,T+1&#160;⊆&#160;GC′,&#160;this&#160;establishes&#160;(ii).<br/>Finally,&#160;for&#160;all&#160;y&#160;∈&#160;Y&#160;,&#160;all&#160;distinct&#160;x,&#160;x′&#160;∈&#160;NH(y)∩X&#160;and&#160;all&#160;v&#160;∈&#160;Sy,&#160;we&#160;have&#160;c(φ(x)v)&#160;6=&#160;c(φ(x′)v),&#160;i.e.&#160;(iii)<br/>holds.&#160;Indeed,&#160;by&#160;the&#160;above,&#160;we&#160;have&#160;c(φ(x)v)&#160;∈&#160;Ct,T+1&#160;and&#160;c(φ(x′)v)&#160;∈&#160;Ct′,T+1,&#160;where&#160;x&#160;∈&#160;Xt,&#160;x′&#160;∈&#160;Xt′.<br/>Since&#160;we&#160;partitioned&#160;X&#160;into&#160;2-independent&#160;sets,&#160;t&#160;and&#160;t′&#160;are&#160;distinct&#160;and&#160;thus&#160;Ct,T+1&#160;∩&#160;Ct′,T+1&#160;=&#160;∅.&#160;This<br/>completes&#160;the&#160;proof.<br/>
<br/>
7.&#160;Concluding&#160;remarks<br/>
We&#160;have&#160;proved&#160;a&#160;rainbow&#160;blow-up&#160;lemma&#160;for&#160;µn-bounded&#160;edge&#160;colourings&#160;and&#160;have&#160;used&#160;it&#160;to&#160;prove<br/>
a&#160;rainbow&#160;bandwidth&#160;theorem&#160;in&#160;this&#160;setting&#160;and&#160;to&#160;show&#160;that&#160;every&#160;bounded&#160;degree&#160;spanning&#160;graph<br/>exists&#160;as&#160;a&#160;rainbow&#160;subgraph&#160;in&#160;quasi-random&#160;graphs&#160;of&#160;arbitrarily&#160;small&#160;fixed&#160;density.&#160;We&#160;conclude&#160;this<br/>paper&#160;with&#160;the&#160;following&#160;remarks:<br/>
•&#160;In&#160;fact,&#160;our&#160;blow-up&#160;lemma&#160;applies&#160;to&#160;slightly&#160;more&#160;general&#160;systems&#160;of&#160;conflicts&#160;(see&#160;beginning<br/>
of&#160;Section&#160;<a href="1802.07700s.html#13">5)</a>,&#160;allowing&#160;for&#160;instance&#160;to&#160;obtain&#160;embeddings&#160;which&#160;are&#160;simultaneously&#160;rainbow&#160;with<br/>respect&#160;to&#160;several&#160;given&#160;edge&#160;colourings.&#160;A&#160;natural&#160;question&#160;is&#160;whether&#160;a&#160;blow-up&#160;lemma&#160;still<br/>holds&#160;for&#160;arbitrary&#160;µn-bounded&#160;conflict&#160;systems&#160;(as&#160;defined&#160;in&#160;Section&#160;<a href="1802.07700s.html#18">5.3)</a>.&#160;The&#160;bottleneck&#160;in<br/>the&#160;current&#160;proof&#160;is&#160;that&#160;it&#160;relies&#160;on&#160;the&#160;colour&#160;splitting&#160;technique,&#160;which&#160;seems&#160;to&#160;be&#160;limited&#160;to<br/>‘highly&#160;transitive’&#160;conflict&#160;systems.<br/>
•&#160;Note&#160;that&#160;in&#160;order&#160;to&#160;guarantee&#160;a&#160;rainbow&#160;copy&#160;of&#160;a&#160;graph&#160;H&#160;with&#160;maximum&#160;degree&#160;∆&#160;in&#160;a<br/>
graph&#160;G&#160;of&#160;density&#160;d,&#160;the&#160;given&#160;edge-colouring&#160;of&#160;G&#160;needs&#160;to&#160;be&#160;dn/∆-bounded,&#160;as&#160;otherwise<br/>there&#160;may&#160;be&#160;less&#160;than&#160;∆n/2&#160;different&#160;colours&#160;available.&#160;In&#160;particular,&#160;our&#160;theorems&#160;are&#160;optimal<br/>up&#160;to&#160;the&#160;value&#160;of&#160;the&#160;constant&#160;µ.&#160;As&#160;noted&#160;before,&#160;the&#160;constant&#160;µ&#160;in&#160;our&#160;theorems&#160;is&#160;very&#160;small.<br/>In&#160;particular,&#160;in&#160;an&#160;embedding&#160;obtained&#160;with&#160;the&#160;rainbow&#160;blow-up&#160;lemma,&#160;only&#160;a&#160;small&#160;fraction<br/>of&#160;the&#160;colours&#160;available&#160;in&#160;G&#160;is&#160;used&#160;for&#160;the&#160;embedding.&#160;On&#160;the&#160;contrary,&#160;affirmative&#160;answers<br/>to&#160;many&#160;open&#160;rainbow&#160;conjectures&#160;would&#160;imply&#160;that&#160;(almost)&#160;all&#160;colours&#160;need&#160;to&#160;be&#160;used.&#160;As<br/>mentioned&#160;in&#160;Section&#160;<a href="1802.07700s.html#1">1,&#160;</a>Kim,&#160;K¨<br/>
uhn,&#160;Kupavskii&#160;and&#160;Osthus&#160;used&#160;the&#160;rainbow&#160;blow-up&#160;lemma<br/>
on&#160;a&#160;small&#160;random&#160;subset&#160;(of&#160;vertices&#160;and&#160;colours)&#160;to&#160;complete&#160;a&#160;partial&#160;embedding&#160;(even&#160;a<br/>partial&#160;approximate&#160;decomposition),&#160;thus&#160;effectively&#160;using&#160;almost&#160;all&#160;colours.&#160;We&#160;expect&#160;further<br/>applications&#160;in&#160;this&#160;direction.<br/>
•&#160;There&#160;has&#160;been&#160;some&#160;exciting&#160;progress&#160;towards&#160;rainbow&#160;decompositions&#160;of&#160;properly&#160;edge-coloured<br/>
complete&#160;graphs,&#160;for&#160;instance&#160;in&#160;<a href="1802.07700s.html#29">[5,&#160;42]&#160;</a>it&#160;is&#160;shown&#160;that&#160;there&#160;are&#160;Ω(n)&#160;edge-disjoint&#160;rainbow<br/>spanning&#160;trees&#160;in&#160;every&#160;properly&#160;edge-coloured&#160;Kn.&#160;For&#160;µn-bounded&#160;edge&#160;colourings,&#160;it&#160;might<br/>be&#160;possible&#160;to&#160;achieve&#160;(approximate)&#160;rainbow&#160;decompositions&#160;for&#160;any&#160;prescribed&#160;collection&#160;of<br/>bounded&#160;degree&#160;graphs.&#160;For&#160;instance,&#160;it&#160;was&#160;proved&#160;in&#160;<a href="1802.07700s.html#28">[3]&#160;</a>that&#160;for&#160;every&#160;µn-bounded&#160;edge<br/>colouring&#160;of&#160;Kn,n,&#160;there&#160;is&#160;a&#160;decomposition&#160;into&#160;rainbow&#160;perfect&#160;matchings&#160;provided&#160;µ&#160;is&#160;small<br/>enough&#160;and&#160;n&#160;is&#160;a&#160;power&#160;of&#160;2.&#160;We&#160;conjecture&#160;that&#160;for&#160;any&#160;µn-bounded&#160;edge&#160;colouring&#160;of&#160;Kn,&#160;there<br/>exists&#160;a&#160;decomposition&#160;into&#160;rainbow&#160;Hamilton&#160;cycles&#160;(provided&#160;n&#160;is&#160;odd).&#160;Similarly,&#160;we&#160;conjecture<br/>
P<br/>
that&#160;for&#160;any&#160;collection&#160;of&#160;n-vertex&#160;graphs&#160;H<br/>
t<br/>
1,&#160;.&#160;.&#160;.&#160;,&#160;Ht&#160;with&#160;bounded&#160;degree&#160;and<br/>
e(H<br/>
i=1<br/>
i)&#160;≤<br/>
(1&#160;−&#160;α)e(Kn)&#160;and&#160;any&#160;µn-bounded&#160;edge&#160;colouring&#160;of&#160;Kn,&#160;where&#160;µ&#160;≪&#160;α,&#160;the&#160;graphs&#160;H1,&#160;.&#160;.&#160;.&#160;,&#160;Ht<br/>pack&#160;edge-disjointly&#160;into&#160;Kn&#160;such&#160;that&#160;each&#160;subgraph&#160;is&#160;rainbow.&#160;In&#160;the&#160;uncoloured&#160;setting,&#160;this<br/>was&#160;proved&#160;in&#160;<a href="1802.07700s.html#29">[28].</a><br/>
Acknowledgement<br/>
We&#160;are&#160;grateful&#160;to&#160;David&#160;Harris&#160;as&#160;well&#160;as&#160;Matthew&#160;Coulson&#160;and&#160;Guillem&#160;Perarnau&#160;for&#160;helpful&#160;dis-<br/>
cussions&#160;on&#160;their&#160;papers.<br/>
References<br/>
[1]&#160;M.&#160;Albert,&#160;A.&#160;Frieze,&#160;and&#160;B.&#160;Reed,&#160;Multicoloured&#160;Hamilton&#160;cycles,&#160;Electron.&#160;J.&#160;Combin.&#160;2&#160;(1995),&#160;Art.&#160;10,&#160;13&#160;pages.<br/>[2]&#160;N.&#160;Alon,&#160;A.&#160;Pokrovskiy,&#160;and&#160;B.&#160;Sudakov,&#160;Random&#160;subgraphs&#160;of&#160;properly&#160;edge-coloured&#160;complete&#160;graphs&#160;and&#160;long<br/>
rainbow&#160;cycles,&#160;Israel&#160;J.&#160;Math.&#160;222&#160;(2017),&#160;317–331.<br/>
[3]&#160;N.&#160;Alon,&#160;J.&#160;Spencer,&#160;and&#160;P.&#160;Tetali,&#160;Covering&#160;with&#160;Latin&#160;transversals,&#160;Discrete&#160;Appl.&#160;Math.&#160;57&#160;(1995),&#160;1–10.<br/>
<hr/>
<a name=29></a><img class="yflip" src="html/1802.07700-29_1.png"/><br/>
<img class="yflip" src="html/1802.07700-29_2.png"/><br/>
<img class="yflip" src="html/1802.07700-29_3.png"/><br/>
<img class="yflip" src="html/1802.07700-29_4.png"/><br/>
<img class="yflip" src="html/1802.07700-29_5.png"/><br/>
<img class="yflip" src="html/1802.07700-29_6.png"/><br/>
<img class="yflip" src="html/1802.07700-29_7.png"/><br/>
<img class="yflip" src="html/1802.07700-29_8.png"/><br/>
29<br/>
[4]&#160;L.D.&#160;Andersen,&#160;Hamilton&#160;circuits&#160;with&#160;many&#160;colours&#160;in&#160;properly&#160;edge-coloured&#160;complete&#160;graphs,&#160;Math.&#160;Scand.&#160;64<br/>
(1989),&#160;5–14.<br/>
[5]&#160;J.&#160;Balogh,&#160;H.&#160;Liu,&#160;and&#160;R.&#160;Montgomery,&#160;Rainbow&#160;spanning&#160;trees&#160;in&#160;properly&#160;coloured&#160;complete&#160;graphs,&#160;arXiv:1704.07200,<br/>
2017.<br/>
[6]&#160;J.&#160;Balogh&#160;and&#160;T.&#160;Molla,&#160;Long&#160;rainbow&#160;cycles&#160;and&#160;Hamiltonian&#160;cycles&#160;using&#160;many&#160;colors&#160;in&#160;properly&#160;edge-colored<br/>
complete&#160;graphs,&#160;arXiv:1706.04950,&#160;2017.<br/>
[7]&#160;F.&#160;Benzing,&#160;A.&#160;Pokrovskiy,&#160;and&#160;B.&#160;Sudakov,&#160;Long&#160;directed&#160;rainbow&#160;cycles&#160;and&#160;rainbow&#160;spanning&#160;trees,&#160;arXiv:1711.03772,<br/>
2017.<br/>
[8]&#160;J.&#160;B¨<br/>
ottcher,&#160;Y.&#160;Kohayakawa,&#160;and&#160;A.&#160;Procacci,&#160;Properly&#160;coloured&#160;copies&#160;and&#160;rainbow&#160;copies&#160;of&#160;large&#160;graphs&#160;with&#160;small<br/>
maximum&#160;degree,&#160;Random&#160;Structures&#160;Algorithms&#160;40&#160;(2012),&#160;425–436.<br/>
[9]&#160;J.&#160;B¨<br/>
ottcher,&#160;M.&#160;Schacht,&#160;and&#160;A.&#160;Taraz,&#160;Proof&#160;of&#160;the&#160;bandwidth&#160;conjecture&#160;of&#160;Bollob´<br/>
as&#160;and&#160;Koml´<br/>
os,&#160;Math.&#160;Ann.&#160;343<br/>
(2009),&#160;175–205.<br/>
[10]&#160;P.&#160;Cano,&#160;G.&#160;Perarnau,&#160;and&#160;O.&#160;Serra,&#160;Rainbow&#160;spanning&#160;subgraphs&#160;in&#160;bounded&#160;edge-colourings&#160;of&#160;graphs&#160;with&#160;large<br/>
minimum&#160;degree,&#160;Electron.&#160;Notes&#160;Discrete&#160;Math.&#160;61&#160;(2017),&#160;199–205.<br/>
[11]&#160;M.&#160;Coulson,&#160;P.&#160;Keevash,&#160;G.&#160;Perarnau,&#160;and&#160;L.&#160;Yepremyan,&#160;Rainbow&#160;factors&#160;in&#160;hypergraphs,&#160;arXiv:1803.10674,&#160;2018.<br/>[12]&#160;M.&#160;Coulson&#160;and&#160;G.&#160;Perarnau,&#160;Rainbow&#160;matchings&#160;in&#160;Dirac&#160;bipartite&#160;graphs,&#160;arXiv:1711.02916,&#160;2017.<br/>[13]&#160;B.&#160;Csaba,&#160;On&#160;the&#160;Bollob´<br/>
as-Eldridge&#160;conjecture&#160;for&#160;bipartite&#160;graphs,&#160;Combin.&#160;Probab.&#160;Comput.&#160;16&#160;(2007),&#160;661–691.<br/>
[14]&#160;P.&#160;Erd˝<br/>
os,&#160;J.&#160;Neˇsetˇril,&#160;and&#160;V.&#160;R¨<br/>
odl,&#160;On&#160;some&#160;problems&#160;related&#160;to&#160;partitions&#160;of&#160;edges&#160;of&#160;a&#160;graph,&#160;Graphs&#160;and&#160;other<br/>
combinatorial&#160;topics,&#160;Teubner-Texte&#160;Math.&#160;59,&#160;Teubner,&#160;1983,&#160;pp.&#160;54–63.<br/>
[15]&#160;A.&#160;Frieze&#160;and&#160;M.&#160;Krivelevich,&#160;On&#160;rainbow&#160;trees&#160;and&#160;cycles,&#160;Electron.&#160;J.&#160;Combin.&#160;15&#160;(2008),&#160;Art.&#160;59,&#160;9&#160;pages.<br/>[16]&#160;A.&#160;Frieze&#160;and&#160;B.&#160;Reed,&#160;Polychromatic&#160;Hamilton&#160;cycles,&#160;Discrete&#160;Math.&#160;118&#160;(1993),&#160;69–74.<br/>[17]&#160;G.&#160;Hahn&#160;and&#160;C.&#160;Thomassen,&#160;Path&#160;and&#160;cycle&#160;sub-Ramsey&#160;numbers&#160;and&#160;an&#160;edge-colouring&#160;conjecture,&#160;Discrete&#160;Math.&#160;62<br/>
(1986),&#160;29–33.<br/>
[18]&#160;A.&#160;Hajnal&#160;and&#160;E.&#160;Szemer´<br/>
edi,&#160;Proof&#160;of&#160;a&#160;conjecture&#160;of&#160;Erd˝<br/>
os,&#160;In:&#160;Combinatorial&#160;Theory&#160;and&#160;its&#160;Applications&#160;II&#160;(P.&#160;Erd˝<br/>
os,<br/>
A.&#160;R´<br/>
enyi,&#160;and&#160;V.T.&#160;S´<br/>
os,&#160;eds.),&#160;North&#160;Holland,&#160;1970,&#160;pp.&#160;601–623.<br/>
[19]&#160;D.G.&#160;Harris&#160;and&#160;A.&#160;Srinivasan,&#160;Constraint&#160;satisfaction,&#160;packet&#160;routing,&#160;and&#160;the&#160;Lov´<br/>
asz&#160;local&#160;lemma,&#160;STOC&#160;2013,<br/>
ACM,&#160;2013,&#160;pp.&#160;685–694.<br/>
[20]<br/>
,&#160;The&#160;Moser-Tardos&#160;framework&#160;with&#160;partial&#160;resampling,&#160;FOCS&#160;2013,&#160;IEEE&#160;Computer&#160;Soc.,&#160;2013,&#160;pp.&#160;469–478.<br/>
[21]<br/>
,&#160;The&#160;Moser-Tardos&#160;framework&#160;with&#160;partial&#160;resampling,&#160;arXiv:1406.5943v3,&#160;2018.<br/>
[22]&#160;P.&#160;Hatami&#160;and&#160;P.W.&#160;Shor,&#160;A&#160;lower&#160;bound&#160;for&#160;the&#160;length&#160;of&#160;a&#160;partial&#160;transversal&#160;in&#160;a&#160;Latin&#160;square,&#160;J.&#160;Combin.&#160;Theory<br/>
Ser.&#160;A&#160;115&#160;(2008),&#160;1103–1113.<br/>
[23]&#160;F.&#160;Joos,&#160;J.&#160;Kim,&#160;D.&#160;K¨<br/>
uhn,&#160;and&#160;D.&#160;Osthus,&#160;Optimal&#160;packings&#160;of&#160;bounded&#160;degree&#160;trees,&#160;J.&#160;Eur.&#160;Math.&#160;Soc.&#160;(to&#160;appear).<br/>
[24]&#160;N.&#160;Kamˇ<br/>
cev,&#160;B.&#160;Sudakov,&#160;and&#160;J.&#160;Volec,&#160;Bounded&#160;colorings&#160;of&#160;multipartite&#160;graphs&#160;and&#160;hypergraphs,&#160;European&#160;J.&#160;Com-<br/>
bin.&#160;66&#160;(2017),&#160;235–249.<br/>
[25]&#160;R.M.&#160;Karp,&#160;F.T.&#160;Leighton,&#160;R.L.&#160;Rivest,&#160;C.D.&#160;Thompson,&#160;U.V.&#160;Vazirani,&#160;and&#160;V.V.&#160;Vazirani,&#160;Global&#160;wire&#160;routing&#160;in<br/>
two-dimensional&#160;arrays,&#160;Algorithmica&#160;2&#160;(1987),&#160;113–129.<br/>
[26]&#160;P.&#160;Keevash&#160;and&#160;L.&#160;Yepremyan,<br/>
Linearly&#160;many&#160;rainbow&#160;trees&#160;in&#160;properly&#160;edge-coloured&#160;complete&#160;graphs,<br/>
arXiv:1710.03041,&#160;2017.<br/>
[27]&#160;J.&#160;Kim,&#160;D.&#160;K¨<br/>
uhn,&#160;A.&#160;Kupavskii,&#160;and&#160;D.&#160;Osthus,&#160;Rainbow&#160;structures&#160;in&#160;locally&#160;bounded&#160;colourings&#160;of&#160;graphs,<br/>
arXiv:1805.08424,&#160;2018.<br/>
[28]&#160;J.&#160;Kim,&#160;D.&#160;K¨<br/>
uhn,&#160;D.&#160;Osthus,&#160;and&#160;M.&#160;Tyomkyn,&#160;A&#160;blow-up&#160;lemma&#160;for&#160;approximate&#160;decompositions,&#160;Trans.&#160;Amer.<br/>
Math.&#160;Soc.&#160;(to&#160;appear).<br/>
[29]&#160;J.&#160;Koml´<br/>
os,&#160;G.N.&#160;S´<br/>
ark¨<br/>
ozy,&#160;and&#160;E.&#160;Szemer´<br/>
edi,&#160;Proof&#160;of&#160;a&#160;packing&#160;conjecture&#160;of&#160;Bollob´<br/>
as,&#160;Combin.&#160;Probab.&#160;Comput.&#160;4<br/>
(1995),&#160;241–255.<br/>
[30]<br/>
,&#160;Blow-up&#160;lemma,&#160;Combinatorica&#160;17&#160;(1997),&#160;109–123.<br/>
[31]<br/>
,&#160;On&#160;the&#160;P´<br/>
osa-Seymour&#160;conjecture,&#160;J.&#160;Graph&#160;Theory&#160;29&#160;(1998),&#160;167–176.<br/>
[32]<br/>
,&#160;Proof&#160;of&#160;the&#160;Seymour&#160;conjecture&#160;for&#160;large&#160;graphs,&#160;Ann.&#160;Comb.&#160;2&#160;(1998),&#160;43–60.<br/>
[33]<br/>
,&#160;Proof&#160;of&#160;the&#160;Alon-Yuster&#160;conjecture,&#160;Discrete&#160;Math.&#160;235&#160;(2001),&#160;255–269.<br/>
[34]&#160;D.&#160;K¨<br/>
uhn&#160;and&#160;D.&#160;Osthus,&#160;The&#160;minimum&#160;degree&#160;threshold&#160;for&#160;perfect&#160;graph&#160;packings,&#160;Combinatorica&#160;29&#160;(2009),&#160;65–107.<br/>
[35]<br/>
,&#160;Hamilton&#160;decompositions&#160;of&#160;regular&#160;expanders:&#160;A&#160;proof&#160;of&#160;Kelly’s&#160;conjecture&#160;for&#160;large&#160;tournaments,&#160;Adv.<br/>
Math.&#160;237&#160;(2013),&#160;62–146.<br/>
[36]&#160;L.&#160;Lu&#160;and&#160;L.&#160;Sz´<br/>
ekely,&#160;Using&#160;Lov´<br/>
asz&#160;local&#160;lemma&#160;in&#160;the&#160;space&#160;of&#160;random&#160;injections,&#160;Electron.&#160;J.&#160;Combin.&#160;14&#160;(2007),<br/>
Art.&#160;63,&#160;13&#160;pages.<br/>
[37]&#160;C.&#160;McDiarmid,&#160;On&#160;the&#160;method&#160;of&#160;bounded&#160;differences,&#160;Surveys&#160;in&#160;combinatorics,&#160;London&#160;Math.&#160;Soc.&#160;Lecture&#160;Note&#160;Ser.<br/>
141,&#160;Cambridge&#160;Univ.&#160;Press,&#160;1989,&#160;pp.&#160;148–188.<br/>
[38]&#160;R.&#160;Montgomery,&#160;A.&#160;Pokrovskiy,&#160;and&#160;B.&#160;Sudakov,&#160;Decompositions&#160;into&#160;spanning&#160;rainbow&#160;structures,&#160;arXiv:1805.07564,<br/>
2018.<br/>
[39]<br/>
,&#160;Embedding&#160;rainbow&#160;trees&#160;with&#160;applications&#160;to&#160;graph&#160;labelling&#160;and&#160;decomposition,&#160;arXiv:1803.03316,&#160;2018.<br/>
[40]&#160;R.A.&#160;Moser&#160;and&#160;G.&#160;Tardos,&#160;A&#160;constructive&#160;proof&#160;of&#160;the&#160;general&#160;Lov´<br/>
asz&#160;local&#160;lemma,&#160;J.&#160;ACM&#160;57&#160;(2010),&#160;Art.&#160;11,<br/>
15&#160;pages.<br/>
[41]&#160;A.&#160;Pokrovskiy,&#160;An&#160;approximate&#160;version&#160;of&#160;a&#160;conjecture&#160;of&#160;Aharoni&#160;and&#160;Berger,&#160;arXiv:1609.06346,&#160;2016.<br/>[42]&#160;A.&#160;Pokrovskiy&#160;and&#160;B.&#160;Sudakov,&#160;Linearly&#160;many&#160;rainbow&#160;trees&#160;in&#160;properly&#160;edge-coloured&#160;complete&#160;graphs,<br/>
arXiv:1703.07301,&#160;2017.<br/>
[43]&#160;V.&#160;R¨<br/>
odl&#160;and&#160;A.&#160;Ruci´<br/>
nski,&#160;Perfect&#160;matchings&#160;in&#160;ǫ-regular&#160;graphs&#160;and&#160;the&#160;blow-up&#160;lemma,&#160;Combinatorica&#160;19&#160;(1999),<br/>
437–452.<br/>
[44]&#160;B.&#160;Sudakov&#160;and&#160;J.&#160;Volec,&#160;Properly&#160;colored&#160;and&#160;rainbow&#160;copies&#160;of&#160;graphs&#160;with&#160;few&#160;cherries,&#160;J.&#160;Combin.&#160;Theory&#160;Ser.&#160;B&#160;122<br/>
(2017),&#160;391–416.<br/>
Version&#160;11th&#160;June&#160;2018<br/>
<hr/>
<a name=30></a>30<br/>
S.&#160;GLOCK&#160;AND&#160;F.&#160;JOOS<br/>
Stefan&#160;Glock&#160;&lt;s.glock@bham.ac.uk&gt;<br/>Felix&#160;Joos&#160;&lt;f.joos@bham.ac.uk&gt;<br/>School&#160;of&#160;Mathematics<br/>University&#160;of&#160;Birmingham<br/>United&#160;Kingdom<br/>
<hr/>
<a name="outline"></a><h1>Document Outline</h1>
<ul>
<li><a href="1802.07700s.html#1">1. Introduction</a>
<ul>
<li><a href="1802.07700s.html#2">1.1. Rainbow blow-up lemma</a></li>
<li><a href="1802.07700s.html#3">1.2. A rainbow bandwidth theorem and quasirandom host graphs</a></li>
<li><a href="1802.07700s.html#4">1.3. Further applications and related problems</a></li>
</ul>
</li>
<li><a href="1802.07700s.html#4">2. Proof overview</a></li>
<li><a href="1802.07700s.html#6">3. Notation</a></li>
<li><a href="1802.07700s.html#6">4. Colour splitting</a>
<ul>
<li><a href="1802.07700s.html#9">4.1. The partial resampling algorithm</a></li>
<li><a href="1802.07700s.html#10">4.2. Proof of Corollary 4.4</a></li>
</ul>
</li>
<li><a href="1802.07700s.html#13">5. Proof of the rainbow blow-up lemma</a>
<ul>
<li><a href="1802.07700s.html#14">5.1. Split into matchings</a></li>
<li><a href="1802.07700s.html#17">5.2. The Four graphs lemma</a></li>
<li><a href="1802.07700s.html#18">5.3. Conflict-free perfect matchings</a></li>
<li><a href="1802.07700s.html#18">5.4. Proof of Lemma 5.2</a></li>
</ul>
</li>
<li><a href="1802.07700s.html#24">6. Applications</a>
<ul>
<li><a href="1802.07700s.html#24">6.1. Rainbow spanning trees in Dirac graphs</a></li>
<li><a href="1802.07700s.html#25">6.2. Rainbow bandwidth theorem</a></li>
</ul>
</li>
<li><a href="1802.07700s.html#28">7. Concluding remarks</a></li>
<li><a href="1802.07700s.html#28">Acknowledgement</a></li>
<li><a href="1802.07700s.html#28">References</a></li>
</ul>
<hr/>
</body>
</html>
