<!DOCTYPE html><html>
<head>
<title></title>
<style type="text/css">
<!--
.xflip {
    -moz-transform: scaleX(-1);
    -webkit-transform: scaleX(-1);
    -o-transform: scaleX(-1);
    transform: scaleX(-1);
    filter: fliph;
}
.yflip {
    -moz-transform: scaleY(-1);
    -webkit-transform: scaleY(-1);
    -o-transform: scaleY(-1);
    transform: scaleY(-1);
    filter: flipv;
}
.xyflip {
    -moz-transform: scaleX(-1) scaleY(-1);
    -webkit-transform: scaleX(-1) scaleY(-1);
    -o-transform: scaleX(-1) scaleY(-1);
    transform: scaleX(-1) scaleY(-1);
    filter: fliph + flipv;
}
-->
</style>
</head>
<body>
<a name=1></a>Weakly&#160;chained&#160;matrices,<br/>
policy&#160;iteration,&#160;and&#160;impulse&#160;control<br/>
P.&#160;Azimzadeh∗<br/>
P.&#160;A.&#160;Forsyth∗<br/>
<b>Abstract</b><br/>
This&#160;work&#160;is&#160;motivated&#160;by&#160;numerical&#160;solutions&#160;to&#160;<i>Hamilton-Jacobi-Bellman&#160;quasi-</i><br/>
<i>variational&#160;inequalities&#160;</i>(HJBQVIs)&#160;associated&#160;with&#160;<i>combined&#160;stochastic&#160;and&#160;impulse<br/>control&#160;</i>problems.&#160;In&#160;particular,&#160;we&#160;consider&#160;(i)&#160;<i>direct&#160;control</i>,&#160;(ii)&#160;<i>penalized</i>,&#160;and&#160;(iii)<br/><i>semi-Lagrangian&#160;</i>discretization&#160;schemes&#160;applied&#160;to&#160;the&#160;HJBQVI&#160;problem.&#160;Scheme&#160;(i)<br/>
takes&#160;the&#160;form&#160;of&#160;a&#160;<i>Bellman&#160;problem&#160;</i>involving&#160;an&#160;operator&#160;which&#160;is&#160;not&#160;necessarily<br/>contractive.&#160;We&#160;consider&#160;the&#160;well-posedness&#160;of&#160;the&#160;Bellman&#160;problem&#160;and&#160;give&#160;sufficient<br/>conditions&#160;for&#160;convergence&#160;of&#160;the&#160;corresponding&#160;policy&#160;iteration.&#160;To&#160;do&#160;so,&#160;we&#160;use&#160;<i>weakly</i><br/>
<i>chained&#160;diagonally&#160;dominant&#160;matrices</i>,&#160;which&#160;give&#160;a&#160;graph-theoretic&#160;characterization<br/>
of&#160;weakly&#160;diagonally&#160;dominant&#160;M-matrices.&#160;We&#160;compare&#160;schemes&#160;(i)–(iii)&#160;under&#160;the<br/>following&#160;examples:&#160;(a)&#160;optimal&#160;control&#160;of&#160;the&#160;exchange&#160;rate,&#160;(b)&#160;optimal&#160;consumption<br/>
with&#160;fixed&#160;and&#160;proportional&#160;transaction&#160;costs,&#160;and&#160;(c)&#160;pricing&#160;guaranteed&#160;minimum<br/>withdrawal&#160;benefits&#160;in&#160;variable&#160;annuities.&#160;We&#160;find&#160;that&#160;one&#160;should&#160;abstain&#160;from&#160;using<br/>
scheme&#160;(i).<br/>
<b>Keywords.&#160;</b>Hamilton-Jacobi-Bellman&#160;equation,&#160;combined&#160;stochastic&#160;and&#160;impulse&#160;control,<br/>policy&#160;iteration,&#160;weakly&#160;chained&#160;diagonally&#160;dominant&#160;matrix,&#160;optimal&#160;exchange&#160;rate,&#160;optimal<br/>consumption,&#160;GMWB<br/>
<b>AMS&#160;subject&#160;classifications.&#160;</b>65N06,&#160;93E20<br/>
<b>1</b><br/>
<b>Introduction</b><br/>
This&#160;work&#160;is&#160;motivated&#160;by&#160;the&#160;computation&#160;of&#160;numerical&#160;solutions&#160;to&#160;<i>Hamilton-Jacobi-Bellman</i><br/>
arXiv:1510.03928v4 &#160;[math.NA] &#160;24 Sep 2017<br/>
<i>quasi-variational&#160;inequalities&#160;</i>(HJBQVI)&#160;associated&#160;with&#160;combined&#160;stochastic&#160;and&#160;impulse<br/>
control.&#160;These&#160;problems&#160;are&#160;of&#160;the&#160;form:<br/>
<b>Problem.&#160;</b><i>Find&#160;a&#160;viscosity&#160;solution&#160;(see&#160;[17,&#160;Definition&#160;2.2])&#160;of&#160;the&#160;HJBQVI</i><br/>
0&#160;=&#160;<i>F&#160;</i>(<i>t,&#160;x,&#160;u,&#160;Du</i>(<i>t,&#160;x</i>)<i>,&#160;D</i>2<i>u</i>(<i>t,&#160;x</i>))<br/>
<br/>
&#160;<br/>
(&#160;<i>∂u</i><br/>
)<br/>
!<br/>
<br/>
<br/>
max<br/>
sup<br/>
+&#160;Ł<i>wu&#160;</i>−&#160;<i>ρu&#160;</i>+&#160;<i>f&#160;w</i><br/>
<i>,&#160;</i>M<i>u&#160;</i>−&#160;<i>u</i><br/>
<i>on&#160;</i>[0<i>,&#160;T&#160;</i>)&#160;×&#160;(Ω&#160;\&#160;Λ)<br/>
:=&#160;−<br/>
<i>w</i>∈<i>W</i><br/>
<i>∂t</i><br/>
(1.1)<br/>
<br/>
<br/>
max&#160;(<i>g&#160;</i>−&#160;<i>u,&#160;</i>M<i>u&#160;</i>−&#160;<i>u</i>)<br/>
<i>on&#160;∂</i>+Ω<br/>
∗David&#160;R.&#160;Cheriton&#160;School&#160;of&#160;Computer&#160;Science,&#160;University&#160;of&#160;Waterloo,&#160;Waterloo&#160;ON,&#160;Canada&#160;N2L&#160;3G1<br/>
pazimzad@uwaterloo.ca&#160;and&#160;paforsyt@uwaterloo.ca<br/>
1<br/>
<hr/>
<a name=2></a><i>where&#160;</i>Ω&#160;⊂<br/>
<i>d</i><br/>
R&#160;<i>is&#160;open,&#160;</i>Λ&#160;⊂&#160;<i>∂</i>Ω<i>,&#160;∂</i>+Ω&#160;:=&#160;([0<i>,&#160;T&#160;</i>)&#160;×&#160;Λ)&#160;∪&#160;({<i>T&#160;</i>}&#160;×&#160;Ω)<i>,&#160;</i>Ł<i>w&#160;</i>:=&#160;Ł(<i>t,&#160;x,&#160;w</i>)&#160;<i>is&#160;the</i><br/>
<i>(possibly&#160;degenerate)&#160;generator&#160;of&#160;an&#160;SDE,&#160;f&#160;w&#160;</i>:=&#160;<i>f&#160;</i>(<i>t,&#160;x,&#160;w</i>)&#160;<i>is&#160;a&#160;forcing&#160;term,&#160;and&#160;</i>M&#160;<i>is&#160;the</i><br/>
<i>impulse&#160;(a.k.a.&#160;intervention)&#160;operator</i><br/>
M<i>u</i>(<i>t,&#160;x</i>)&#160;:=&#160;sup&#160;{<i>u</i>(<i>t,&#160;x&#160;</i>+&#160;Γ(<i>t,&#160;x,&#160;z</i>))&#160;+&#160;<i>K</i>(<i>t,&#160;x,&#160;z</i>)}&#160;<i>.</i><br/>
(1.2)<br/>
<i>z</i>∈<i>Z</i>(<i>t,x</i>)<br/>
<i>If&#160;Z</i>(<i>t,&#160;x</i>)&#160;<i>is&#160;empty&#160;at&#160;a&#160;particular&#160;point&#160;</i>(<i>t,&#160;x</i>)<i>,&#160;</i>M<i>u</i>(<i>t,&#160;x</i>)&#160;<i>is&#160;understood&#160;to&#160;take&#160;the&#160;value&#160;</i>−∞<i>,</i><br/>
<i>corresponding&#160;to&#160;no&#160;impulses&#160;being&#160;allowed&#160;at&#160;that&#160;point.</i><br/>
We&#160;focus&#160;on&#160;implicit&#160;discretization&#160;schemes&#160;for&#160;the&#160;HJBQVI&#160;problem&#160;that&#160;do&#160;not&#160;suffer<br/>
from&#160;the&#160;usual&#160;timestep&#160;restrictions&#160;of&#160;explicit&#160;schemes.&#160;In&#160;particular,&#160;we&#160;consider&#160;(i)&#160;<i>direct</i><br/>
<i>control</i>,&#160;(ii)&#160;<i>penalized&#160;</i>and&#160;(iii)&#160;<i>semi-Lagrangian&#160;</i>schemes.&#160;The&#160;semi-Lagrangian&#160;scheme&#160;(used<br/>
for&#160;HJBQVIs&#160;in&#160;[12])&#160;differs&#160;from&#160;its&#160;counterparts&#160;in&#160;that&#160;it&#160;handles&#160;controlled&#160;terms&#160;using<br/>information&#160;from&#160;the&#160;previous&#160;timestep.&#160;As&#160;such,&#160;computing&#160;the&#160;solution&#160;of&#160;this&#160;scheme<br/>does&#160;not&#160;require&#160;an&#160;iterative&#160;method.&#160;However,&#160;this&#160;scheme&#160;requires&#160;that&#160;the&#160;control&#160;<i>w&#160;</i>in<br/>Ł<i>w&#160;</i>appears&#160;only&#160;in&#160;the&#160;coefficient&#160;of&#160;the&#160;first-order&#160;term.&#160;For&#160;the&#160;other&#160;two&#160;schemes,&#160;an<br/>iterative&#160;method&#160;is&#160;needed.&#160;The&#160;particular&#160;iterative&#160;method&#160;analyzed&#160;herein&#160;is&#160;Howard’s<br/><i>policy&#160;iteration&#160;</i>algorithm.&#160;Not&#160;considered&#160;is&#160;the&#160;alternative&#160;<i>value&#160;iteration&#160;</i>algorithm,&#160;due<br/>to&#160;its&#160;poor&#160;performance&#160;as&#160;the&#160;numerical&#160;grid&#160;is&#160;refined&#160;[15,&#160;§6.1].&#160;Convergence&#160;of&#160;policy<br/>iteration&#160;applied&#160;to&#160;the&#160;penalized&#160;scheme&#160;turns&#160;out&#160;to&#160;be&#160;a&#160;trivial&#160;consequence&#160;of&#160;the&#160;strict<br/>diagonal&#160;dominance&#160;of&#160;the&#160;input&#160;matrices&#160;to&#160;policy&#160;iteration&#160;(5.2).&#160;Convergence&#160;of&#160;policy<br/>iteration&#160;applied&#160;to&#160;the&#160;direct&#160;control&#160;scheme&#160;is&#160;a&#160;more&#160;delicate&#160;matter,&#160;as&#160;discussed&#160;below.<br/>
The&#160;direct&#160;control&#160;scheme&#160;takes&#160;the&#160;form&#160;of&#160;the&#160;fixed&#160;point&#160;problem<br/>
&#160;<br/>
!<br/>
find&#160;<i>v&#160;</i>∈<br/>
<i>M</i><br/>
R<br/>
such&#160;that&#160;<i>v&#160;</i>=&#160;max<br/>
sup&#160;<i>L</i>(<i>w</i>)<i>v&#160;</i>+&#160;<i>c</i>(<i>w</i>)<i>,&#160;</i>sup&#160;<i>B</i>(<i>z</i>)<i>v&#160;</i>+&#160;<i>k</i>(<i>z</i>)<br/>
(1.3)<br/>
<i>w</i>∈W<br/>
<i>z</i>∈Z<br/>
where&#160;<i>L</i>(<i>w</i>)&#160;and&#160;<i>B</i>(<i>z</i>)&#160;are&#160;contractive&#160;and&#160;nonexpansive&#160;matrices,&#160;respectively.&#160;It&#160;is&#160;understood<br/>
that&#160;the&#160;supremum&#160;and&#160;maximum&#160;are&#160;element-wise&#160;and&#160;controls&#160;are&#160;“row-decoupled”&#160;(see&#160;§2).<br/>[10]&#160;gives&#160;sufficient&#160;conditions&#160;for&#160;convergence&#160;of&#160;a&#160;policy&#160;iteration&#160;to&#160;the&#160;unique&#160;solution&#160;of<br/>
(1.3).&#160;However,&#160;convergence&#160;in&#160;[10]&#160;is&#160;conditional&#160;on&#160;the&#160;choice&#160;of&#160;initial&#160;guess&#160;[10,&#160;Theorem<br/>
2&#160;(iii)].&#160;We&#160;remove&#160;this&#160;constraint.<br/>
More&#160;importantly,&#160;[10]&#160;restricts&#160;the&#160;admissible&#160;set&#160;of&#160;controls&#160;and&#160;imposes&#160;a&#160;strong<br/>
assumption&#160;on&#160;<i>B</i>(<i>z</i>)&#160;(of&#160;which&#160;assumption&#160;(H2)&#160;in&#160;this&#160;work&#160;is&#160;an&#160;analogue)&#160;to&#160;ensure<br/>convergence&#160;of&#160;policy&#160;iteration&#160;applied&#160;to&#160;(1.3).&#160;Unfortunately,&#160;reasonable&#160;instances&#160;of<br/>problem&#160;(1.3)&#160;(including&#160;examples&#160;in&#160;this&#160;work)&#160;do&#160;not&#160;necessarily&#160;satisfy&#160;this&#160;condition.<br/>
We&#160;show&#160;that,&#160;under&#160;a&#160;much&#160;weaker&#160;assumption,&#160;a&#160;solution&#160;to&#160;(1.3)&#160;is&#160;unique.&#160;Moreover,<br/>when&#160;(H2)&#160;is&#160;not&#160;satisfied&#160;directly,&#160;we&#160;provide&#160;a&#160;way&#160;to&#160;construct&#160;this&#160;solution&#160;by&#160;considering<br/>
a&#160;“modified&#160;problem”&#160;that&#160;satisfies&#160;(H2).&#160;Roughly&#160;speaking,&#160;one&#160;arrives&#160;at&#160;the&#160;modified<br/>problem&#160;by&#160;removing&#160;some&#160;suboptimal&#160;controls&#160;from&#160;the&#160;control&#160;set.&#160;However,&#160;this&#160;procedure<br/>is&#160;ad&#160;hoc&#160;(i.e.&#160;problem&#160;dependent).<br/>
To&#160;establish&#160;the&#160;above&#160;relaxations,&#160;we&#160;use&#160;<i>weakly&#160;chained&#160;diagonally&#160;dominant&#160;</i>(WCDD)<br/>
matrices.&#160;WCDD&#160;matrices&#160;give&#160;a&#160;graph-theoretic&#160;characterization&#160;of&#160;weakly&#160;diagonally<br/>dominant&#160;M-matrices&#160;(Theorem&#160;3.5).&#160;The&#160;WCDD&#160;matrix&#160;approach&#160;to&#160;the&#160;convergence&#160;of<br/>policy&#160;iteration&#160;applied&#160;to&#160;(1.3)&#160;is&#160;intuitive&#160;and&#160;established&#160;using&#160;well-known&#160;results&#160;on&#160;policy<br/>iteration&#160;(Proposition&#160;2.2).<br/>
2<br/>
<hr/>
<a name=3></a>The&#160;ad&#160;hoc&#160;removal&#160;of&#160;suboptimal&#160;controls&#160;makes&#160;the&#160;direct&#160;control&#160;scheme&#160;less&#160;robust<br/>
than&#160;its&#160;counterparts,&#160;for&#160;which&#160;control&#160;sets&#160;need&#160;not&#160;be&#160;altered&#160;to&#160;ensure&#160;convergence.&#160;It&#160;is<br/>thus&#160;natural&#160;to&#160;ask&#160;if&#160;there&#160;is&#160;an&#160;advantage&#160;to&#160;using&#160;a&#160;direct&#160;control&#160;scheme.&#160;To&#160;answer&#160;this,<br/>
we&#160;apply&#160;each&#160;scheme&#160;to&#160;the&#160;following&#160;examples:<br/>
•&#160;optimal&#160;control&#160;of&#160;the&#160;exchange&#160;rate;<br/>
•&#160;optimal&#160;consumption&#160;with&#160;fixed&#160;and&#160;proportional&#160;transaction&#160;costs;<br/>
•&#160;pricing&#160;guaranteed&#160;minimum&#160;withdrawal&#160;benefits&#160;in&#160;variable&#160;annuities.<br/>
The&#160;semi-Lagrangian&#160;scheme&#160;only&#160;requires&#160;a&#160;single&#160;linear&#160;solve&#160;per&#160;timestep&#160;since&#160;no&#160;iterative<br/>
method&#160;is&#160;needed.&#160;However,&#160;as&#160;mentioned&#160;above,&#160;such&#160;a&#160;scheme&#160;cannot&#160;be&#160;used&#160;if&#160;the&#160;control<br/><i>w&#160;</i>appears&#160;in&#160;the&#160;diffusion&#160;coefficient&#160;of&#160;Ł<i>w&#160;</i>(or&#160;if&#160;the&#160;underlying&#160;process&#160;is&#160;Lévy&#160;with&#160;controlled<br/>arrival&#160;rate).&#160;We&#160;find&#160;that&#160;the&#160;penalized&#160;scheme&#160;performs&#160;at&#160;least&#160;as&#160;well&#160;the&#160;direct&#160;control<br/>scheme.&#160;Both&#160;produce&#160;nearly&#160;identical&#160;results&#160;and&#160;often&#160;require&#160;roughly&#160;the&#160;same&#160;amount&#160;of<br/>computation.&#160;In&#160;the&#160;specific&#160;case&#160;of&#160;the&#160;optimal&#160;consumption&#160;problem,&#160;the&#160;penalized&#160;scheme<br/>even&#160;outperforms&#160;the&#160;direct&#160;control&#160;scheme,&#160;taking&#160;only&#160;a&#160;few&#160;policy&#160;iterations&#160;to&#160;converge<br/>per&#160;timestep.<br/>
We&#160;mention&#160;that&#160;in&#160;the&#160;infinite-horizon&#160;setting&#160;(<i>T&#160;</i>=&#160;∞),&#160;optimal&#160;consumption&#160;with&#160;fixed<br/>
and&#160;proportional&#160;transaction&#160;costs&#160;was&#160;considered&#160;numerically&#160;in&#160;[11]&#160;using&#160;iterated&#160;optimal<br/>stopping,&#160;a&#160;theoretical&#160;tool&#160;[24,&#160;Chapter&#160;7,&#160;Lemma&#160;7.1]&#160;for&#160;the&#160;construction&#160;of&#160;solutions&#160;that<br/>has&#160;found&#160;its&#160;way&#160;into&#160;numerical&#160;implementations&#160;[20,&#160;5].&#160;Computationally,&#160;for&#160;finite-horizon<br/>problems&#160;(<i>T&#160;&lt;&#160;</i>∞),&#160;iterated&#160;optimal&#160;stopping&#160;has&#160;high&#160;space&#160;complexity&#160;[3],&#160;and&#160;is&#160;thus&#160;not<br/>considered&#160;here.&#160;Also&#160;not&#160;considered&#160;here&#160;is&#160;the&#160;simulation&#160;of&#160;penalized&#160;backward&#160;stochastic<br/>differential&#160;equations&#160;[18],&#160;a&#160;recent&#160;alternative&#160;well-suited&#160;to&#160;high-dimensional&#160;problems.<br/>
In&#160;this&#160;work,&#160;we&#160;restrict&#160;our&#160;attention&#160;to&#160;problems&#160;of&#160;dimension&#160;three&#160;or&#160;lower.&#160;To&#160;keep<br/>
focus&#160;on&#160;the&#160;interesting&#160;aspects&#160;of&#160;impulse&#160;control,&#160;we&#160;assume&#160;that&#160;between&#160;impulses,&#160;the<br/>underlying&#160;stochastic&#160;process&#160;associated&#160;with&#160;the&#160;HJBQVI&#160;is&#160;a&#160;Brownian&#160;motion&#160;with&#160;drift<br/><i>µ&#160;</i>:=&#160;<i>µ</i>(<i>t,&#160;x,&#160;w</i>)&#160;and&#160;scaling&#160;<i>σ&#160;</i>:=&#160;<i>σ</i>(<i>t,&#160;x,&#160;w</i>)&#160;(we&#160;can&#160;extend&#160;to&#160;a&#160;Lévy&#160;process&#160;with&#160;nontrivial<br/>arrival&#160;rate&#160;by,&#160;e.g.,&#160;[13]).&#160;This&#160;allows&#160;us&#160;to&#160;write<br/>
1<br/>
<br/>
<br/>
Ł<i>wu</i>(<i>t,&#160;x</i>)&#160;:=<br/>
trace&#160;<i>σ</i>(<i>t,&#160;x,&#160;w</i>)<i>σ</i>|(<i>t,&#160;x,&#160;w</i>)<i>D</i>2<i>u</i>(<i>t,&#160;x</i>)&#160;+&#160;h<i>µ</i>(<i>t,&#160;x,&#160;w</i>)<i>,&#160;Dxu</i>(<i>t,&#160;x</i>)i&#160;<i>.</i><br/>
2<br/>
<i>x</i><br/>
We&#160;mention&#160;here&#160;that&#160;problem&#160;(1.3)&#160;can&#160;also&#160;be&#160;interpreted&#160;as&#160;a&#160;Bellman&#160;problem<br/>
associated&#160;with&#160;an&#160;infinite-horizon&#160;Markov&#160;decision&#160;process&#160;(MDP)&#160;with&#160;vanishing&#160;discount<br/>
(Example&#160;4.2).&#160;In&#160;fact,&#160;(1.3)&#160;is&#160;a&#160;generalization&#160;of&#160;a&#160;reflecting&#160;boundary&#160;problem&#160;(see,&#160;e.g.,<br/>
the&#160;monograph&#160;of&#160;Kushner&#160;and&#160;Dupuis&#160;[19,&#160;pg.&#160;39–40]).&#160;In&#160;the&#160;context&#160;of&#160;MDPs,&#160;<i>L</i>(<i>w</i>)<br/>and&#160;<i>B</i>(<i>z</i>)&#160;capture&#160;the&#160;transition&#160;probabilities&#160;at&#160;states&#160;with&#160;nonvanishing&#160;and&#160;vanishing<br/>discount&#160;factors,&#160;respectively.&#160;A&#160;WCDD&#160;matrix&#160;condition&#160;guarantees&#160;the&#160;convergence&#160;of<br/>policy&#160;iteration&#160;to&#160;the&#160;unique&#160;solution&#160;of&#160;the&#160;Bellman&#160;problem&#160;(Corollary&#160;4.4).&#160;Intuitively,<br/>this&#160;condition&#160;ensures&#160;that&#160;the&#160;underlying&#160;Markov&#160;chain&#160;arrives&#160;(with&#160;positive&#160;probability)&#160;at<br/>a&#160;state&#160;with&#160;nonvanishing&#160;discount&#160;independent&#160;of&#160;the&#160;initial&#160;state.<br/>
We&#160;summarize&#160;some&#160;of&#160;our&#160;main&#160;findings&#160;below:<br/>
•&#160;Policy&#160;iteration&#160;applied&#160;to&#160;a&#160;(monotone)&#160;direct&#160;control&#160;scheme&#160;frequently&#160;fails&#160;due&#160;to<br/>
the&#160;possible&#160;singularity&#160;of&#160;the&#160;matrix&#160;iterates.<br/>
3<br/>
<hr/>
<a name=4></a>•&#160;We&#160;establish&#160;provably&#160;convergent&#160;techniques&#160;to&#160;eliminate&#160;singularity.&#160;However,&#160;applying<br/>
these&#160;techniques&#160;is&#160;problem-dependent.<br/>
•&#160;We&#160;show&#160;that&#160;policy&#160;iteration&#160;applied&#160;to&#160;a&#160;(monotone)&#160;penalized&#160;scheme&#160;never&#160;fails.<br/>
Numerical&#160;tests&#160;on&#160;three&#160;problems&#160;confirm&#160;that&#160;such&#160;a&#160;scheme&#160;performs&#160;at&#160;least&#160;as&#160;well<br/>as&#160;(and&#160;sometimes&#160;better&#160;than)&#160;its&#160;direct&#160;control&#160;counterpart.<br/>
The&#160;additional&#160;effort&#160;required&#160;to&#160;ensure&#160;the&#160;convergence&#160;in&#160;the&#160;direct&#160;control&#160;case&#160;along&#160;with<br/>
the&#160;comparable&#160;(if&#160;not&#160;better)&#160;performance&#160;in&#160;the&#160;penalized&#160;case&#160;suggests&#160;that&#160;one&#160;should<br/>abstain&#160;from&#160;a&#160;direct&#160;control&#160;scheme.<br/>
An&#160;outline&#160;of&#160;this&#160;work&#160;is&#160;as&#160;follows.&#160;§2&#160;reminds&#160;the&#160;reader&#160;of&#160;a&#160;well-known&#160;result&#160;on&#160;the<br/>
convergence&#160;of&#160;policy&#160;iteration.&#160;§3&#160;discusses&#160;WCDD&#160;matrices.&#160;§4&#160;gives&#160;conditions&#160;for&#160;the<br/>convergence&#160;of&#160;policy&#160;iteration&#160;applied&#160;to&#160;problem&#160;(1.3)&#160;and&#160;its&#160;well-posedness&#160;under&#160;weaker<br/>assumptions.&#160;A&#160;self-contained&#160;MDP&#160;example&#160;is&#160;given&#160;therein&#160;(Example&#160;4.2).&#160;§5&#160;introduces<br/>numerical&#160;schemes&#160;for&#160;the&#160;HJBQVI&#160;problem&#160;(1.1),&#160;with&#160;numerical&#160;examples&#160;given&#160;in&#160;§6.<br/>
<b>2</b><br/>
<b>Policy&#160;iteration</b><br/>
In&#160;the&#160;sequel,&#160;we&#160;will&#160;see&#160;that&#160;each&#160;of&#160;the&#160;discretization&#160;schemes&#160;for&#160;(1.1)&#160;take&#160;the&#160;form&#160;of&#160;a<br/>Bellman&#160;problem:<br/>
find&#160;<i>v&#160;</i>∈<br/>
<i>M</i><br/>
R<br/>
such&#160;that&#160;sup&#160;{−<i>A</i>(<i>P&#160;</i>)<i>v&#160;</i>+&#160;<i>b</i>(<i>P&#160;</i>)}&#160;=&#160;0<br/>
(2.1)<br/>
<i>P&#160;</i>∈P<br/>
where&#160;<i>A&#160;</i>:&#160;P&#160;→<br/>
<i>M&#160;</i>×<i>M</i><br/>
<i>M</i><br/>
R<br/>
and&#160;<i>b&#160;</i>:&#160;P&#160;→&#160;R&#160;.&#160;It&#160;is&#160;understood&#160;that&#160;(i)&#160;P&#160;:=&#160;Q<i>M&#160;</i>P<br/>
<i>i</i>=1<br/>
<i>i&#160;</i>is&#160;a&#160;finite<br/>
product&#160;of&#160;nonempty&#160;sets,&#160;(ii)&#160;controls&#160;are&#160;row-decoupled:<br/>
[<i>A</i>(<i>P&#160;</i>)]<br/>
and&#160;[<i>b</i>(<i>P&#160;</i>)]&#160;depend&#160;only&#160;on&#160;<i>P</i><br/>
<i>ij</i><br/>
<i>i</i><br/>
<i>i&#160;</i>∈&#160;P<i>i,</i><br/>
(iii)&#160;the&#160;order&#160;on<br/>
<i>M</i><br/>
<i>M&#160;</i>×<i>M</i><br/>
R<br/>
(resp.&#160;R<br/>
)&#160;is&#160;element-wise:<br/>
for&#160;<i>x,&#160;y&#160;</i>∈<br/>
<i>M</i><br/>
R&#160;,&#160;<i>x&#160;</i>≥&#160;<i>y&#160;</i>if&#160;and&#160;only&#160;if&#160;<i>xi&#160;</i>≥&#160;<i>yi&#160;</i>for&#160;all&#160;<i>i,</i><br/>
and&#160;(iv)&#160;the&#160;supremum&#160;is&#160;induced&#160;by&#160;this&#160;order:<br/>
for&#160;{<i>x</i>(<i>P&#160;</i>)}<br/>
⊂<br/>
<i>M&#160;</i>,&#160;sup&#160;<i>x</i>(<i>P&#160;</i>)&#160;is&#160;a&#160;vector&#160;with&#160;components&#160;sup&#160;[<i>x</i>(<i>P&#160;</i>)]&#160;<i>.</i><br/>
<i>P&#160;</i>∈P<br/>
R<br/>
<i>i</i><br/>
<i>P&#160;</i>∈P<br/>
<i>P&#160;</i>∈P<br/>
Let&#160;Solve(<i>A,&#160;b,&#160;x</i>0)&#160;denote&#160;a&#160;call&#160;to&#160;a&#160;linear&#160;solver&#160;for&#160;<i>Ax&#160;</i>=&#160;<i>b&#160;</i>with&#160;initial&#160;guess&#160;<i>x</i>0<br/>
(algebraically,&#160;Solve&#160;computes&#160;<i>x&#160;</i>exactly;&#160;in&#160;practice,&#160;an&#160;iterative&#160;solver&#160;is&#160;used&#160;and&#160;the<br/>
choice&#160;of&#160;<i>x</i>0&#160;affects&#160;performance).&#160;A&#160;<i>policy&#160;iteration&#160;</i>algorithm&#160;is&#160;given&#160;by:<br/>
Policy-Iteration(P<i>,&#160;A</i>(·)<i>,&#160;b</i>(·)<i>,&#160;v</i>0)<br/>1<br/>
<b>for&#160;</b><i>`&#160;</i>=&#160;1<i>,&#160;</i>2<i>,&#160;.&#160;.&#160;.</i><br/>
2<br/>
Pick&#160;<i>P&#160;`&#160;</i>such&#160;that&#160;−<i>A</i>(<i>P&#160;`</i>)<i>v`</i>−1&#160;+&#160;<i>b</i>(<i>P&#160;`</i>)&#160;=&#160;sup<br/>
{−<i>A</i>(<i>P&#160;</i>)<i>v`</i>−1&#160;+&#160;<i>b</i>(<i>P&#160;</i>)}<br/>
<i>P&#160;</i>∈P<br/>
3<br/>
<i>v`&#160;</i>:=&#160;Solve(<i>A</i>(<i>P&#160;`</i>)<i>,&#160;b</i>(<i>P&#160;`</i>)<i>,&#160;v`</i>−1)<br/>
4<br/>
<hr/>
<a name=5></a><b>Definition&#160;2.1&#160;</b>(Monotone&#160;matrix)<b>.&#160;</b><i>A&#160;real&#160;square&#160;matrix&#160;A&#160;is&#160;monotone&#160;(in&#160;the&#160;sense&#160;of</i><br/>
<i>Collatz)&#160;if&#160;for&#160;all&#160;real&#160;vectors&#160;v,&#160;Av&#160;</i>≥&#160;0&#160;<i>implies&#160;v&#160;</i>≥&#160;0<i>.</i><br/>
We&#160;use&#160;the&#160;following&#160;assumptions:<br/>
(H0)&#160;<i>P&#160;</i>7→&#160;<i>A</i>(<i>P&#160;</i>)−1&#160;is&#160;bounded&#160;on&#160;the&#160;set&#160;{<i>P&#160;</i>∈&#160;P&#160;:&#160;<i>A</i>(<i>P&#160;</i>)&#160;is&#160;nonsingular}.<br/>
(H1)&#160;(i)&#160;<i>A&#160;</i>and&#160;<i>b&#160;</i>are&#160;bounded&#160;and&#160;(ii)&#160;for&#160;all&#160;<i>x&#160;</i>in<br/>
<i>M</i><br/>
R&#160;,&#160;there&#160;exists&#160;<i>Px&#160;</i>in&#160;P&#160;such&#160;that<br/>
−<i>A</i>(<i>Px</i>)<i>x&#160;</i>+&#160;<i>b</i>(<i>Px</i>)&#160;=&#160;sup<br/>
{−<i>A</i>(<i>P&#160;</i>)<i>x&#160;</i>+&#160;<i>b</i>(<i>P&#160;</i>)}.<br/>
<i>P&#160;</i>∈P<br/>
<b>Proposition&#160;2.2&#160;</b>(Convergence&#160;of&#160;policy&#160;iteration)<b>.&#160;</b><i>Suppose&#160;</i>(H0)<i>,&#160;</i>(H1)<i>,&#160;and&#160;that&#160;A</i>(<i>P&#160;</i>)&#160;<i>is&#160;a</i><br/>
<i>monotone&#160;matrix&#160;for&#160;all&#160;P&#160;in&#160;</i>P<i>.&#160;</i>(<i>v`</i>)<i>`</i>≥1&#160;<i>defined&#160;by&#160;</i>Policy-Iteration&#160;<i>is&#160;nondecreasing<br/>and&#160;converges&#160;to&#160;the&#160;unique&#160;solution&#160;v&#160;of&#160;</i>(2.1)<i>.&#160;Moreover,&#160;if&#160;</i>P&#160;<i>is&#160;finite,&#160;convergence&#160;occurs<br/>in&#160;at&#160;most&#160;</i>|P|&#160;<i>iterations&#160;(i.e.&#160;v</i>|P|&#160;=&#160;<i>v</i>|P|+1&#160;=&#160;·&#160;·&#160;·&#160;<i>).</i><br/>
The&#160;monotone&#160;convergence&#160;of&#160;(<i>v`</i>)<i>`</i>≥1&#160;to&#160;the&#160;unique&#160;solution&#160;of&#160;(2.1)&#160;can&#160;be&#160;proven&#160;similarly<br/>
to&#160;Theorem&#160;A.3&#160;of&#160;Appendix&#160;A.&#160;See&#160;[7,&#160;Theorem&#160;2.1]&#160;for&#160;a&#160;proof&#160;of&#160;the&#160;finite&#160;termination<br/>
when&#160;P&#160;is&#160;finite.&#160;In&#160;practice,&#160;P&#160;is&#160;often&#160;finite,&#160;in&#160;which&#160;case&#160;(H0)&#160;and&#160;(H1)&#160;are&#160;trivial.<br/>
<b>Remark&#160;2.3.&#160;</b><i>Theorem&#160;</i>A.3&#160;<i>establishes&#160;the&#160;existence&#160;and&#160;uniqueness&#160;of&#160;solutions&#160;to&#160;</i>(2.1)<br/>
<i>independent&#160;of&#160;</i>(H1.ii)<i>.&#160;Owing&#160;to&#160;this,&#160;results&#160;that&#160;rely&#160;on&#160;Proposition&#160;</i>2.2&#160;<i>can&#160;be&#160;relaxed&#160;to<br/>exclude&#160;</i>(H1.ii)<i>,&#160;with&#160;the&#160;caveat&#160;that&#160;when&#160;</i>P&#160;<i>is&#160;infinite,&#160;</i>Policy-Iteration&#160;<i>be&#160;replaced&#160;by</i><br/>
<i></i>-Policy-Iteration&#160;<i>(see&#160;Appendix&#160;</i>A<i>).&#160;In&#160;this&#160;case,&#160;the&#160;resulting&#160;sequence&#160;</i>(<i>v`</i>)<i>`</i>≥1&#160;<i>is&#160;not</i><br/>
<i>necessarily&#160;nondecreasing.</i><br/>
<b>3</b><br/>
<b>Weakly&#160;chained&#160;diagonally&#160;dominant&#160;matrices</b><br/>
We&#160;say&#160;row&#160;<i>i&#160;</i>of&#160;a&#160;complex&#160;matrix&#160;<i>A&#160;</i>:=&#160;(<i>aij</i>)&#160;is&#160;strictly&#160;diagonally&#160;dominant&#160;(SDD)&#160;if<br/>
|<i>aii</i>|&#160;<i>&gt;&#160;</i>P<br/>
|<br/>
<i>j</i>6=<i>i&#160;aij&#160;</i>|.&#160;We&#160;say&#160;<i>A&#160;</i>is&#160;SDD&#160;if&#160;all&#160;of&#160;its&#160;rows&#160;are&#160;SDD.&#160;Weakly&#160;diagonally&#160;dominant<br/>
(WDD)&#160;is&#160;defined&#160;with&#160;weak&#160;inequality&#160;instead.<br/>
<b>Definition&#160;3.1.&#160;</b><i>A&#160;complex&#160;square&#160;matrix&#160;A&#160;is&#160;said&#160;to&#160;be&#160;a&#160;weakly&#160;chained&#160;diagonally</i><br/>
<i>dominant&#160;(WCDD)&#160;if:</i><br/>
<i>(i)&#160;A&#160;is&#160;WDD;<br/>(ii)&#160;for&#160;each&#160;row&#160;r,&#160;there&#160;exists&#160;a&#160;path&#160;in&#160;the&#160;graph&#160;of&#160;A&#160;from&#160;r&#160;to&#160;an&#160;SDD&#160;row&#160;p.</i><br/>
Recall&#160;that&#160;the&#160;directed&#160;graph&#160;of&#160;an&#160;<i>M&#160;</i>×&#160;<i>M&#160;</i>complex&#160;matrix&#160;<i>A&#160;</i>:=&#160;(<i>aij</i>)&#160;is&#160;given&#160;by&#160;the<br/>
vertices&#160;{1<i>,&#160;.&#160;.&#160;.&#160;,&#160;M&#160;</i>}&#160;and&#160;edges&#160;defined&#160;as&#160;follows:&#160;there&#160;exists&#160;an&#160;edge&#160;from&#160;<i>i&#160;</i>to&#160;<i>j&#160;</i>if&#160;and&#160;only<br/>
if&#160;<i>aij&#160;</i>6=&#160;0.&#160;Note&#160;that&#160;if&#160;<i>r&#160;</i>is&#160;itself&#160;an&#160;SDD&#160;row,&#160;the&#160;trivial&#160;path&#160;<i>r&#160;</i>→&#160;<i>r&#160;</i>satisfies&#160;the&#160;requirement<br/>of&#160;(ii)&#160;in&#160;the&#160;above.<br/>
The&#160;nonsingularity&#160;of&#160;WCDD&#160;matrices&#160;is&#160;proven&#160;in&#160;[27].&#160;We&#160;provide&#160;an&#160;elementary&#160;proof<br/>
for&#160;the&#160;convenience&#160;of&#160;the&#160;reader:<br/>
<b>Lemma&#160;3.2.&#160;</b><i>A&#160;WCDD&#160;matrix&#160;is&#160;nonsingular.</i><br/>
5<br/>
<hr/>
<a name=6></a><i>Proof.&#160;</i>Suppose&#160;<i>λ&#160;</i>=&#160;0&#160;is&#160;an&#160;eigenvalue&#160;of&#160;<i>A&#160;</i>:=&#160;(<i>aij</i>).&#160;Let&#160;<i>v&#160;</i>6=&#160;0&#160;be&#160;an&#160;associated&#160;eigenvector<br/>
with&#160;components&#160;of&#160;modulus&#160;at&#160;most&#160;unity.&#160;Let&#160;<i>r&#160;</i>be&#160;such&#160;that&#160;|<i>vr</i>|&#160;=&#160;1&#160;≥&#160;|<i>vj</i>|&#160;for&#160;all&#160;<i>j</i>.&#160;By<br/>
the&#160;Gershgorin&#160;circle&#160;theorem,<br/>
|<i>λ&#160;</i>−&#160;<i>arr</i>|&#160;=&#160;|<i>arr</i>|&#160;≤&#160;X&#160;|<i>arj</i>|&#160;|<i>vj</i>|&#160;≤&#160;X&#160;|<i>arj</i>|&#160;<i>.</i><br/>
<i>j</i>6=<i>r</i><br/>
<i>j</i>6=<i>r</i><br/>
Since&#160;<i>A&#160;</i>is&#160;WDD,&#160;it&#160;follows&#160;that&#160;|<i>arr</i>|&#160;=&#160;P<br/>
|<br/>
<i>j</i>6=<i>r&#160;arj&#160;</i>|,&#160;and&#160;hence&#160;<i>r&#160;</i>is&#160;not&#160;an&#160;SDD&#160;row.&#160;Therefore,<br/>
there&#160;exists&#160;a&#160;path&#160;<i>r&#160;</i>→&#160;<i>p</i>1&#160;→&#160;·&#160;·&#160;·&#160;→&#160;<i>pk&#160;</i>where&#160;<i>pk&#160;</i>is&#160;an&#160;SDD&#160;row.&#160;Since<br/>
|<i>arr</i>|&#160;=&#160;X&#160;|<i>arj</i>|&#160;|<i>vj</i>|&#160;=&#160;X&#160;|<i>arj</i>|&#160;<i>,</i><br/>
<i>j</i>6=<i>r</i><br/>
<i>j</i>6=<i>r</i><br/>
it&#160;follows&#160;that&#160;|<i>vj</i>|&#160;=&#160;1&#160;whenever&#160;|<i>arj</i>|&#160;6=&#160;0.&#160;Because&#160;|<i>arp&#160;</i>|&#160;6=&#160;0,&#160;|<i>v&#160;</i>|&#160;=&#160;1.&#160;Repeating&#160;the&#160;same<br/>
1<br/>
<i>p</i>1<br/>
argument&#160;as&#160;above&#160;with&#160;<i>r&#160;</i>=&#160;<i>p</i>1&#160;yields&#160;|<i>ap</i><br/>
|&#160;=&#160;P<br/>
|<i>a</i><br/>
1<i>p</i>1<br/>
<i>j</i>6=<i>p</i>1<br/>
<i>p</i>1<i>j&#160;</i>|,&#160;and&#160;hence&#160;<i>p</i>1&#160;is&#160;not&#160;an&#160;SDD&#160;row.<br/>
Continuing&#160;the&#160;procedure,&#160;<i>pk&#160;</i>is&#160;not&#160;SDD,&#160;a&#160;contradiction.<br/>
<br/>
We&#160;recall&#160;some&#160;well-known&#160;classes&#160;of&#160;matrices:<br/>
<b>Definition&#160;3.3.&#160;</b><i>A&#160;Z-matrix&#160;is&#160;a&#160;real&#160;matrix&#160;with&#160;nonpositive&#160;off-diagonals.</i><br/>
<b>Definition&#160;3.4.&#160;</b><i>An&#160;M-matrix&#160;is&#160;a&#160;monotone&#160;Z-matrix.</i><br/>
We&#160;are&#160;now&#160;ready&#160;to&#160;state&#160;a&#160;fundamental&#160;characterization&#160;of&#160;WDD&#160;M-matrices:<br/>
<b>Theorem&#160;3.5&#160;</b>(Characterization&#160;theorem)<b>.&#160;</b><i>The&#160;following&#160;are&#160;equivalent:</i><br/>
<i>(i)&#160;A&#160;is&#160;a&#160;WCDD&#160;Z-matrix&#160;with&#160;positive&#160;diagonals;<br/>(ii)&#160;A&#160;is&#160;a&#160;WDD&#160;M-matrix.</i><br/>
<i>Proof.&#160;</i>Since&#160;a&#160;nonsingular&#160;WDD&#160;Z-matrix&#160;with&#160;positive&#160;diagonals&#160;is&#160;an&#160;M-matrix&#160;(a&#160;conse-<br/>quence&#160;of,&#160;e.g.,&#160;[25,&#160;Theorem&#160;1.<i>A</i>3]),&#160;(i)&#160;implies&#160;(ii)&#160;follows&#160;by&#160;Lemma&#160;3.2.<br/>
As&#160;for&#160;the&#160;converse,&#160;since&#160;an&#160;M-matrix&#160;has&#160;positive&#160;diagonal&#160;elements&#160;(a&#160;consequence<br/>
of,&#160;e.g.,&#160;[25,&#160;Theorem&#160;1.<i>K</i><br/>
<i>n</i>×<i>n</i><br/>
35]),&#160;it&#160;is&#160;sufficient&#160;to&#160;show&#160;that&#160;a&#160;WDD&#160;Z-matrix&#160;<i>A&#160;</i>∈&#160;R<br/>
with<br/>
positive&#160;diagonals&#160;not&#160;satisfying&#160;Definition&#160;3.1&#160;(ii)&#160;is&#160;singular.&#160;Let&#160;<i>R&#160;</i>⊂&#160;{1<i>,&#160;.&#160;.&#160;.&#160;,&#160;n</i>}&#160;be&#160;the&#160;set<br/>of&#160;rows&#160;<i>r&#160;</i>of&#160;<i>A&#160;</i>violating&#160;Definition&#160;3.1&#160;(ii).&#160;Due&#160;to&#160;our&#160;assumptions,&#160;there&#160;is&#160;at&#160;least&#160;one&#160;such<br/>row,&#160;and&#160;hence&#160;<i>R&#160;</i>is&#160;nonempty.&#160;Without&#160;loss&#160;of&#160;generality,&#160;we&#160;can&#160;assume&#160;<i>R&#160;</i>=&#160;{1<i>,&#160;.&#160;.&#160;.&#160;,&#160;m</i>}<br/>for&#160;some&#160;1&#160;≤&#160;<i>m&#160;</i>≤&#160;<i>n&#160;</i>(otherwise,&#160;reorder&#160;<i>A</i>).&#160;Let&#160;<i>e&#160;</i>∈<br/>
<i>m</i><br/>
R<br/>
denote&#160;the&#160;column&#160;vector&#160;whose<br/>
elements&#160;are&#160;all&#160;unity.&#160;If&#160;<i>m&#160;</i>=&#160;<i>n</i>,&#160;each&#160;row&#160;sum&#160;of&#160;<i>A&#160;</i>is&#160;zero&#160;(i.e.,&#160;<i>Ae&#160;</i>=&#160;0),&#160;implying&#160;that&#160;<i>A&#160;</i>is<br/>singular.&#160;If&#160;<i>m&#160;&lt;&#160;n</i>,&#160;<i>A&#160;</i>has&#160;the&#160;block&#160;structure<br/>
&#160;<br/>
<i>B</i><br/>
0&#160;!<br/>
<i>A&#160;</i>=<br/>
where&#160;<i>B&#160;</i>∈<br/>
<i>m</i>×<i>m.</i><br/>
<i>C</i><br/>
<i>D</i><br/>
R<br/>
Because&#160;rows&#160;that&#160;violate&#160;Definition&#160;3.1&#160;(ii)&#160;were&#160;“isolated”&#160;to&#160;the&#160;block&#160;<i>B</i>,&#160;the&#160;partition<br/>above&#160;ensures&#160;that&#160;<i>D&#160;</i>is&#160;WCDD.&#160;Therefore,&#160;by&#160;Lemma&#160;3.2,&#160;the&#160;linear&#160;system&#160;<i>Dx&#160;</i>=&#160;−<i>Ce&#160;</i>has<br/>a&#160;unique&#160;solution&#160;<i>x</i>.&#160;Moreover,&#160;since&#160;the&#160;row&#160;sums&#160;of&#160;<i>B&#160;</i>are&#160;zero,&#160;<i>Be&#160;</i>=&#160;0.&#160;It&#160;follows&#160;that<br/>
&#160;<br/>
!<br/>
&#160;<br/>
!<br/>
<i>e</i><br/>
<i>Be</i><br/>
<i>A</i><br/>
=<br/>
=&#160;0<i>,</i><br/>
<i>x</i><br/>
<i>Ce&#160;</i>+&#160;<i>Dx</i><br/>
and&#160;hence&#160;<i>A&#160;</i>is&#160;singular.<br/>
<br/>
6<br/>
<hr/>
<a name=7></a><br/>
<br/>
This&#160;characterization&#160;is&#160;tight:&#160;an&#160;M-matrix&#160;need&#160;not&#160;be&#160;WCDD&#160;(e.g.<br/>
1<br/>
−2&#160;).<br/>
0<br/>
1<br/>
We&#160;mention&#160;that&#160;(i)&#160;implies&#160;(ii)&#160;of&#160;Theorem&#160;3.5&#160;appears&#160;in&#160;[8].&#160;Therein,&#160;WCDD&#160;Z-matrices<br/>
with&#160;positive&#160;diagonals&#160;are&#160;referred&#160;to&#160;as&#160;<i>matrices&#160;of&#160;positive&#160;type.&#160;</i>To&#160;the&#160;authors’&#160;best<br/>
knowledge,&#160;the&#160;converse&#160;does&#160;not&#160;appear&#160;in&#160;the&#160;literature.<br/>
<b>4</b><br/>
<b>The&#160;fixed&#160;point&#160;problem&#160;</b>(1.3)<br/>
<b>4.1</b><br/>
<b>Convergence&#160;of&#160;policy&#160;iteration</b><br/>
We&#160;assume&#160;W&#160;:=&#160;Q<i>M&#160;</i>W<br/>
Z<br/>
<i>i</i>=1<br/>
<i>i&#160;</i>and&#160;Z&#160;:=&#160;Q<i>M</i><br/>
<i>i</i>=1<br/>
<i>i&#160;</i>appearing&#160;in&#160;problem&#160;(1.3)&#160;are&#160;finite&#160;products<br/>
of&#160;nonempty&#160;sets.&#160;Let<br/>
P&#160;:=&#160;Q<i>M&#160;</i>P<br/>
<i>i</i>=1<br/>
<i>i&#160;</i>where&#160;P<i>i&#160;</i>:=&#160;W<i>i&#160;</i>×&#160;Z<i>i&#160;</i>×&#160;D<i>i&#160;</i>and&#160;∅&#160;6=&#160;D<i>i&#160;</i>⊂&#160;{0<i>,&#160;</i>1}&#160;<i>.</i><br/>
(4.1)<br/>
We&#160;associate&#160;with&#160;each&#160;<i>ψ&#160;</i>:=&#160;(<i>ψ</i>1<i>,&#160;.&#160;.&#160;.&#160;,&#160;ψM&#160;</i>)&#160;in&#160;D&#160;:=&#160;Q<i>M&#160;</i>D<br/>
<i>i</i>=1<br/>
<i>i&#160;</i>a&#160;diagonal&#160;matrix&#160;Ψ&#160;:=&#160;diag(<i>ψ</i>).<br/>
We&#160;use&#160;<i>ψ&#160;</i>and&#160;Ψ&#160;interchangeably.&#160;We&#160;write&#160;<i>P&#160;</i>:=&#160;(<i>w,&#160;z,&#160;ψ</i>)&#160;∈&#160;P&#160;where&#160;<i>w&#160;</i>∈&#160;W&#160;and&#160;<i>z&#160;</i>∈&#160;Z.&#160;We<br/>
can&#160;transform&#160;problem&#160;(1.3)&#160;into&#160;the&#160;form&#160;(2.1)&#160;by&#160;taking<br/>
<i>A</i>(<i>P&#160;</i>)&#160;:=&#160;(<i>I&#160;</i>−&#160;Ψ)&#160;(<i>I&#160;</i>−&#160;<i>L</i>(<i>w</i>))&#160;+&#160;<i>δ</i>Ψ&#160;(<i>I&#160;</i>−&#160;<i>B</i>(<i>z</i>))<br/>
<i>b</i>(<i>P&#160;</i>)&#160;:=&#160;(<i>I&#160;</i>−&#160;Ψ)&#160;<i>c</i>(<i>w</i>)&#160;+&#160;<i>δ</i>Ψ<i>k</i>(<i>z</i>)<br/>
(4.2)<br/>
where&#160;<i>δ&#160;</i>=&#160;1&#160;(<i>L</i>(<i>w</i>)&#160;and&#160;<i>B</i>(<i>z</i>)&#160;are&#160;matrices;&#160;<i>c</i>(<i>w</i>)&#160;and&#160;<i>k</i>(<i>z</i>)&#160;are&#160;vectors).&#160;To&#160;keep&#160;the&#160;material<br/>
general,&#160;we&#160;henceforth&#160;assume&#160;the&#160;less&#160;restrictive&#160;condition&#160;<i>δ&#160;&gt;&#160;</i>0&#160;instead&#160;of&#160;<i>δ&#160;</i>=&#160;1.&#160;Before<br/>considering&#160;the&#160;well-posedness&#160;of<br/>
problem&#160;(2.1)&#160;subject&#160;to&#160;(4.1)&#160;and&#160;(4.2)<i>,</i><br/>
(4.3)<br/>
we&#160;establish&#160;that&#160;the&#160;set&#160;of&#160;solutions&#160;to&#160;(4.3)&#160;is&#160;independent&#160;of&#160;the&#160;choice&#160;of&#160;<i>δ</i>:<br/>
<b>Lemma&#160;4.1.&#160;</b><i>v&#160;is&#160;a&#160;solution&#160;of&#160;</i>(4.3)&#160;<i>with&#160;δ&#160;</i>=&#160;1&#160;<i>if&#160;and&#160;only&#160;if&#160;it&#160;is&#160;a&#160;solution&#160;of&#160;</i>(4.3)&#160;<i>with</i><br/>
<i>arbitrary&#160;δ&#160;</i>=&#160;<i>δ</i>0&#160;<i>&gt;&#160;</i>0<i>.</i><br/>
A&#160;proof&#160;of&#160;the&#160;above&#160;is&#160;given&#160;in&#160;Appendix&#160;B.&#160;In&#160;the&#160;sequel,&#160;we&#160;exploit&#160;the&#160;fact&#160;that&#160;policy<br/>
iteration&#160;may&#160;converge&#160;more&#160;rapidly&#160;for&#160;particular&#160;choices&#160;of&#160;<i>δ</i>.&#160;We&#160;now&#160;visit,&#160;as&#160;a&#160;motivating<br/>example,&#160;an&#160;infinite-horizon&#160;MDP&#160;with&#160;vanishing&#160;discount:<br/>
<b>Example&#160;4.2.&#160;</b><i>Let&#160;</i>(<i>Xn</i>)<i>n</i>≥0&#160;<i>be&#160;a&#160;controlled&#160;homogeneous&#160;Markov&#160;chain&#160;on&#160;a&#160;finite&#160;state&#160;space<br/></i>{1<i>,&#160;.&#160;.&#160;.&#160;,&#160;M&#160;</i>}<i>.&#160;A&#160;control&#160;at&#160;state&#160;i&#160;is&#160;a&#160;member&#160;of&#160;</i>P<i>i&#160;in&#160;</i>(4.1)&#160;<i>and&#160;written&#160;Pi&#160;</i>:=&#160;(<i>wi,&#160;zi,&#160;ψi</i>)<i>.&#160;The</i><br/>
<i>transition&#160;probabilities&#160;of&#160;the&#160;Markov&#160;chain&#160;are</i><br/>
<br/>
<i>wij</i><br/>
<i>if&#160;ψi&#160;</i>=&#160;0<br/>
P(<i>Xn</i>+1&#160;=&#160;<i>j&#160;</i>|&#160;<i>Xn&#160;</i>=&#160;<i>i</i>)&#160;=<br/>
<i>zij</i><br/>
<i>if&#160;ψi&#160;</i>=&#160;1<br/>
<i>where&#160;wi&#160;</i>:=&#160;(<i>wi</i>1<i>,&#160;.&#160;.&#160;.&#160;,&#160;wiM&#160;</i>)&#160;≥&#160;0&#160;<i>and&#160;wie&#160;</i>=&#160;1&#160;<i>(similarly&#160;for&#160;zi).&#160;That&#160;is,&#160;members&#160;of&#160;</i>W<i>i&#160;and</i><br/>
Z<i>i&#160;are&#160;M&#160;-dimensional&#160;probability&#160;vectors.&#160;Let</i><br/>
&#34;&#160;∞<br/>
<i>n</i>−1<br/>
<br/>
#<br/>
<br/>
<i>v</i><br/>
X<br/>
Y<br/>
<br/>
<i>i&#160;</i>:=&#160;sup&#160;E<br/>
<i>U&#160;</i>(<i>Xn,&#160;P&#160;</i>)<br/>
<i>D</i>(<i>Xm,&#160;P&#160;</i>)&#160;<i>X</i>0&#160;=&#160;<i>i</i><br/>
<i>for&#160;all&#160;</i>1&#160;≤&#160;<i>i&#160;</i>≤&#160;<i>M</i><br/>
(4.4)<br/>
<br/>
<i>P&#160;</i>∈P<br/>
<i>n</i>=0<br/>
<i>m</i>=0<br/>
<br/>
7<br/>
<hr/>
<a name=8></a>1<br/>
2<br/>
3<br/>
·&#160;·&#160;·<br/>
<i>M</i><br/>
1<br/>
2<br/>
3<br/>
·&#160;·&#160;·<br/>
<i>M</i><br/>
<i>ψ</i>1&#160;=&#160;0<br/>
<i>ψi&#160;</i>=&#160;1<br/>
<i>ψ</i>1&#160;=&#160;0<br/>
<i>ψi&#160;</i>=&#160;1<br/>
(a)<br/>
(b)<br/>
Figure&#160;4.1.1:&#160;Graphs&#160;of&#160;possible&#160;matrices&#160;<i>B</i>(<i>z</i>)&#160;from&#160;Example&#160;4.5<br/>
<i>where</i><br/>
<br/>
<br/>
<i>ci</i>(<i>wi</i>)<br/>
<i>if&#160;ψi&#160;</i>=&#160;0<br/>
1<i>/&#160;</i>(1&#160;+&#160;<i>ρ</i>)<br/>
<i>if&#160;ψi&#160;</i>=&#160;0;<br/>
<i>U&#160;</i>(<i>i,&#160;P&#160;</i>)&#160;:=<br/>
<i>and&#160;D</i>(<i>i,&#160;P&#160;</i>)&#160;:=<br/>
<i>ki</i>(<i>zi</i>)<br/>
<i>if&#160;ψi&#160;</i>=&#160;1<br/>
1<br/>
<i>if&#160;ψi&#160;</i>=&#160;1<i>.</i><br/>
<i>In&#160;the&#160;above,&#160;ρ&#160;&gt;&#160;</i>0&#160;<i>is&#160;a&#160;discount&#160;factor.&#160;[10,&#160;Lemma&#160;5]&#160;establishes&#160;that&#160;the&#160;dynamic</i><br/>
<i>programming&#160;equation&#160;associated&#160;with&#160;</i>(4.4)&#160;<i>is&#160;exactly&#160;</i>(4.3)&#160;<i>with&#160;</i>[<i>L</i>(<i>w</i>)]<i>ij&#160;</i>:=&#160;<i>wij/</i>(1&#160;+&#160;<i>ρ</i>)<i>,<br/></i>[<i>B</i>(<i>z</i>)]<i>ij&#160;</i>:=&#160;<i>zij,&#160;</i>[<i>c</i>(<i>w</i>)]<i>i&#160;</i>:=&#160;<i>ci</i>(<i>wi</i>)<i>,&#160;and&#160;</i>[<i>k</i>(<i>z</i>)]<i>i&#160;</i>:=&#160;<i>ki</i>(<i>zi</i>)<i>.</i><br/>
In&#160;the&#160;above,&#160;states&#160;<i>i&#160;</i>on&#160;which&#160;<i>ψi&#160;</i>=&#160;1&#160;are&#160;the&#160;“trouble”&#160;states&#160;with&#160;vanishing&#160;discount<br/>
factor.&#160;In&#160;fact,&#160;requiring&#160;<i>ψi&#160;</i>=&#160;0&#160;for&#160;all&#160;<i>i&#160;</i>returns&#160;us&#160;to&#160;a&#160;nonvanishing&#160;discount&#160;factor&#160;problem<br/>
whose&#160;well-posedness&#160;is&#160;easy&#160;to&#160;establish.<br/>
The&#160;following&#160;assumptions&#160;will&#160;prove&#160;paramount:<br/>
(H2)&#160;For&#160;each&#160;<i>P&#160;</i>:=&#160;(<i>w,&#160;z,&#160;ψ</i>)&#160;in&#160;P&#160;and&#160;state&#160;<i>i&#160;</i>with&#160;<i>ψi&#160;</i>=&#160;1,&#160;there&#160;exists&#160;a&#160;path&#160;in&#160;the&#160;graph<br/>
of&#160;<i>B</i>(<i>z</i>)&#160;from&#160;<i>i&#160;</i>to&#160;some&#160;state&#160;<i>j</i>(<i>i</i>)&#160;with&#160;<i>ψj</i>(<i>i</i>)&#160;=&#160;0.<br/>
(H3)&#160;For&#160;each&#160;<i>P&#160;</i>:=&#160;(<i>w,&#160;z,&#160;ψ</i>)&#160;in&#160;P,&#160;<i>I&#160;</i>−&#160;<i>L</i>(<i>w</i>)&#160;is&#160;an&#160;SDD&#160;Z-matrix&#160;with&#160;positive&#160;diagonals&#160;and<br/>
<i>I&#160;</i>−&#160;<i>B</i>(<i>z</i>)&#160;is&#160;a&#160;WDD&#160;Z-matrix&#160;whose&#160;diagonals&#160;satisfy&#160;0&#160;≤&#160;[<i>B</i>(<i>z</i>)]<i>ii&#160;</i>≤&#160;1.<br/>
<b>Theorem&#160;4.3.&#160;</b><i>Suppose&#160;</i>(H0)–(H3)<i>.&#160;</i>(<i>v`</i>)<i>`</i>≥1&#160;<i>defined&#160;by&#160;</i>Policy-Iteration&#160;<i>is&#160;nondecreasing</i><br/>
<i>and&#160;converges&#160;to&#160;the&#160;unique&#160;solution&#160;v&#160;of&#160;</i>(4.3)<i>.&#160;Moreover,&#160;if&#160;</i>P&#160;<i>is&#160;finite,&#160;convergence&#160;occurs<br/>in&#160;at&#160;most&#160;</i>|P|&#160;<i>iterations.</i><br/>
<i>Proof.&#160;</i>(H2)&#160;and&#160;(H3)&#160;ensure&#160;that&#160;<i>A</i>(<i>P&#160;</i>)&#160;is&#160;a&#160;WCDD&#160;Z-matrix&#160;with&#160;positive&#160;diagonals.&#160;The<br/>desired&#160;result&#160;follows&#160;from&#160;Theorem&#160;3.5&#160;and&#160;Proposition&#160;2.2.<br/>
<br/>
<b>Corollary&#160;4.4.&#160;</b><i>Consider&#160;Example&#160;</i>4.2<i>.</i><br/>
<i>Suppose&#160;</i>(H0)–(H2)<i>.</i><br/>
(<i>v`</i>)<i>`</i>≥1&#160;<i>defined&#160;by</i><br/>
<i>M</i><br/>
Policy-Iteration&#160;<i>converges&#160;to&#160;v&#160;in&#160;</i>R<br/>
<i>satisfying&#160;</i>(4.4)<i>.</i><br/>
An&#160;example&#160;satisfying&#160;(H2)&#160;is&#160;given:<br/>
<b>Example&#160;4.5.&#160;</b><i>Consider&#160;Example&#160;</i>4.2<i>.&#160;Suppose&#160;all&#160;P&#160;</i>:=&#160;(<i>w,&#160;z,&#160;ψ</i>)&#160;<i>in&#160;</i>P&#160;<i>satisfy</i><br/>
<i>ψ</i>1&#160;=&#160;0&#160;<i>and&#160;zij&#160;</i>=&#160;0&#160;<i>if&#160;</i>1&#160;<i>&lt;&#160;i&#160;</i>≤&#160;<i>j.</i><br/>
(4.5)<br/>
<i>This&#160;corresponds&#160;to&#160;(i)&#160;a&#160;nonvanishing&#160;discount&#160;at&#160;state&#160;</i>1&#160;<i>and&#160;that&#160;(ii)&#160;transitions&#160;from&#160;a</i><br/>
<i>state&#160;with&#160;vanishing&#160;discount&#160;are&#160;unidirectional&#160;(if&#160;ψXn&#160;</i>=&#160;1<i>,&#160;Xn</i>+1&#160;<i>&lt;&#160;Xn&#160;a.s.).&#160;See&#160;Figure<br/></i>4.1.1&#160;<i>for&#160;example&#160;graphs&#160;of&#160;B</i>(<i>z</i>)&#160;<i>subject&#160;to&#160;</i>(4.5)<i>.</i><br/>
8<br/>
<hr/>
<a name=9></a><b>4.2</b><br/>
<b>Uniqueness</b><br/>
Let<br/>
L<i>v&#160;</i>:=&#160;sup&#160;{<i>L</i>(<i>w</i>)<i>v&#160;</i>+&#160;<i>c</i>(<i>w</i>)}&#160;and&#160;B<i>v&#160;</i>:=&#160;sup&#160;{<i>B</i>(<i>z</i>)<i>v&#160;</i>+&#160;<i>k</i>(<i>z</i>)}&#160;<i>.</i><br/>
(4.6)<br/>
<i>w</i>∈W<br/>
<i>z</i>∈Z<br/>
The&#160;condition&#160;(H2)&#160;turns&#160;out&#160;to&#160;be&#160;too&#160;restrictive&#160;for&#160;some&#160;problems&#160;of&#160;interest.&#160;However,<br/>
the&#160;following&#160;weaker&#160;property&#160;of&#160;B&#160;is&#160;not&#160;unusual:<br/>
(H4)&#160;For&#160;each&#160;solution&#160;<i>v&#160;</i>of&#160;(4.3)&#160;and&#160;each&#160;state&#160;<i>i</i>,&#160;there&#160;exist&#160;integers&#160;<i>m</i>(<i>i</i>)&#160;and&#160;<i>n</i>(<i>i</i>)&#160;such<br/>
that&#160;0&#160;≤&#160;<i>n</i>(<i>i</i>)&#160;<i>&lt;&#160;m</i>(<i>i</i>)&#160;and&#160;[&#160;<i>m</i>(<i>i</i>)<br/>
<i>n</i>(<i>i</i>)<br/>
B<br/>
<i>v</i>]<i>i&#160;&lt;&#160;</i>[B<br/>
<i>v</i>]<i>i</i>.<br/>
<b>Lemma&#160;4.6.&#160;</b><i>Suppose&#160;</i>(H3)&#160;<i>and&#160;</i>(H4)<i>.&#160;Let&#160;</i>(<i>P&#160;`</i>)<i>`</i>≥0&#160;:=&#160;(<i>w`,&#160;z`,&#160;ψ`</i>)<i>`</i>≥0&#160;<i>be&#160;a&#160;sequence&#160;in&#160;</i>P&#160;<i>and<br/>v&#160;a&#160;solution&#160;of&#160;</i>(4.3)&#160;<i>satisfying</i><br/>
−<i>A</i>(<i>P&#160;`</i>)<i>v&#160;</i>+&#160;<i>b</i>(<i>P&#160;`</i>)&#160;→&#160;sup&#160;{−<i>A</i>(<i>P&#160;</i>)<i>v&#160;</i>+&#160;<i>b</i>(<i>P&#160;</i>)}&#160;=&#160;0<i>.</i><br/>
<i>P&#160;</i>∈P<br/>
<i>There&#160;exists&#160;`</i>0&#160;≥&#160;0&#160;<i>such&#160;that&#160;for&#160;each&#160;`&#160;</i>≥&#160;<i>`</i>0&#160;<i>and&#160;state&#160;i&#160;with&#160;ψ`&#160;</i>=&#160;1<i>,&#160;there&#160;exists&#160;a&#160;path&#160;in</i><br/>
<i>i</i><br/>
<i>the&#160;graph&#160;of&#160;B</i>(<i>z`</i>)&#160;<i>from&#160;i&#160;to&#160;some&#160;state&#160;j</i>(<i>i,&#160;`</i>)&#160;<i>with&#160;ψ`</i><br/>
=&#160;0<i>.</i><br/>
<i>j</i>(<i>i,`</i>)<br/>
<i>Proof.&#160;</i>Suppose&#160;the&#160;contrary.&#160;A&#160;pigeonhole&#160;principle&#160;argument&#160;yields&#160;the&#160;existence&#160;of&#160;a<br/>subsequence&#160;(<i>P&#160;`q&#160;</i>)<i>q</i>≥0&#160;:=&#160;(<i>w`q&#160;,&#160;z`q&#160;,&#160;ψ`q&#160;</i>)<i>q</i>≥0&#160;of&#160;(<i>P&#160;`</i>)<i>`</i>≥0&#160;such&#160;that<br/>
•&#160;<i>ψ`q&#160;</i>=&#160;<i>ψ&#160;</i>is&#160;a&#160;constant&#160;independent&#160;of&#160;<i>q</i>;<br/>
•&#160;the&#160;graph&#160;of&#160;<i>B</i>(<i>z`q&#160;</i>)&#160;(call&#160;it&#160;<i>G</i>)&#160;is&#160;a&#160;constant&#160;independent&#160;of&#160;<i>q</i>;<br/>
•&#160;there&#160;exists&#160;<i>i&#160;</i>such&#160;that&#160;<i>ψi&#160;</i>=&#160;1&#160;and&#160;for&#160;all&#160;<i>j&#160;</i>reachable&#160;from&#160;<i>i&#160;</i>(in&#160;<i>G</i>),&#160;<i>ψj&#160;</i>=&#160;1.<br/>
Let&#160;<i>V&#160;</i>:=&#160;{<i>j</i>1<i>,&#160;.&#160;.&#160;.&#160;,&#160;jk</i>}&#160;be&#160;the&#160;states&#160;reachable&#160;from&#160;<i>i</i>.&#160;Let&#160;<i>r&#160;</i>∈&#160;<i>V&#160;</i>∪&#160;{<i>i</i>}&#160;be&#160;arbitrary.&#160;Since&#160;the<br/>limit&#160;of&#160;a&#160;convergent&#160;sequence&#160;equals&#160;to&#160;the&#160;limit&#160;of&#160;any&#160;of&#160;its&#160;subsequences,<br/>
h<br/>
i<br/>
1&#160;h<br/>
i<br/>
<i>B</i>(<i>z`q&#160;</i>)<i>v&#160;</i>+&#160;<i>k</i>(<i>z`q&#160;</i>)<br/>
−&#160;<i>vr&#160;</i>=<br/>
−<i>A</i>(<i>P&#160;`q&#160;</i>)<i>v&#160;</i>+&#160;<i>b</i>(<i>P&#160;`q&#160;</i>)<br/>
→&#160;0<i>,</i><br/>
<i>r</i><br/>
<i>δ</i><br/>
<i>r</i><br/>
and&#160;hence&#160;[B<i>v</i>]<i>r&#160;</i>≥&#160;<i>vr</i>.&#160;Now,&#160;since&#160;<i>v&#160;</i>is&#160;a&#160;solution&#160;of&#160;(4.3),&#160;it&#160;follows&#160;that&#160;B<i>v&#160;</i>≤&#160;<i>v</i>.&#160;Therefore,<br/>[B<i>v</i>]<i>r&#160;</i>=&#160;<i>vr</i>.&#160;Moreover,<br/>
[&#160;2<br/>
B&#160;<i>v</i>]<i>r&#160;</i>=&#160;[B(B<i>v</i>)]<i>r&#160;</i>≥&#160;[<i>B</i>(<i>z`q&#160;</i>)(B<i>v</i>)&#160;+&#160;<i>k</i>(<i>z`q&#160;</i>)]<i>r&#160;</i>=&#160;X&#160;[<i>B</i>(<i>z`q&#160;</i>)]<i>rj</i>[B<i>v</i>]<i>j&#160;</i>+&#160;[<i>k</i>(<i>z`q&#160;</i>)]<i>r</i><br/>
<i>j</i>∈<i>V</i><br/>
=&#160;X[<i>B</i>(<i>z`q&#160;</i>)]<i>rjvj&#160;</i>+&#160;[<i>k</i>(<i>z`q&#160;</i>)]<i>r&#160;</i>=&#160;[<i>B</i>(<i>z`q&#160;</i>)<i>v&#160;</i>+&#160;<i>k</i>(<i>z`q&#160;</i>)]<i>r&#160;</i>→&#160;[B<i>v</i>]<i>r</i><br/>
<i>j</i>∈<i>V</i><br/>
and&#160;hence&#160;[&#160;2<br/>
2<br/>
B&#160;<i>v</i>]<i>r&#160;</i>≥&#160;[B<i>v</i>]<i>r</i>.&#160;Since&#160;B&#160;is&#160;a&#160;monotone&#160;operator&#160;by&#160;(H3),&#160;B<i>v&#160;</i>≤&#160;<i>v&#160;</i>implies&#160;B&#160;<i>v&#160;</i>≤&#160;B<i>v</i>,<br/>
and&#160;hence&#160;[&#160;2<br/>
B&#160;<i>v</i>]<i>r&#160;</i>=&#160;[B<i>v</i>]<i>r</i>.&#160;We&#160;can&#160;continue&#160;this&#160;procedure&#160;to&#160;obtain<br/>
<i>v</i><br/>
2<br/>
3<br/>
<i>r&#160;</i>=&#160;[B<i>v</i>]<i>r&#160;</i>=&#160;[B&#160;<i>v</i>]<i>r&#160;</i>=&#160;[B&#160;<i>v</i>]<i>r&#160;</i>=&#160;·&#160;·&#160;·<br/>
Setting&#160;<i>r&#160;</i>=&#160;<i>i&#160;</i>in&#160;the&#160;above&#160;yields&#160;a&#160;contradiction&#160;to&#160;(H4).<br/>
<br/>
9<br/>
<hr/>
<a name=10></a>If&#160;we&#160;take&#160;the&#160;trivial&#160;path&#160;<i>i&#160;</i>→&#160;<i>i&#160;</i>as&#160;having&#160;length&#160;zero,&#160;the&#160;proof&#160;above&#160;also&#160;implies&#160;that<br/>
for&#160;<i>`&#160;</i>sufficiently&#160;large&#160;and&#160;for&#160;all&#160;<i>i</i>,&#160;there&#160;is&#160;a&#160;path&#160;of&#160;length&#160;<i>&lt;&#160;m</i>(<i>i</i>)&#160;(where&#160;<i>m</i>(<i>i</i>)&#160;is&#160;specified<br/>by&#160;(H4))&#160;in&#160;the&#160;graph&#160;of&#160;<i>B</i>(<i>z`</i>)&#160;from&#160;<i>i&#160;</i>to&#160;some&#160;state&#160;<i>j</i>(<i>i,&#160;`</i>)&#160;with&#160;<i>ψ`</i><br/>
=&#160;0.&#160;An&#160;example&#160;is<br/>
<i>j</i>(<i>i,`</i>)<br/>
given&#160;below:<br/>
<b>Example&#160;4.7.&#160;</b><i>Consider&#160;Example&#160;</i>4.2&#160;<i>with&#160;</i>Z<i>i&#160;</i>=&#160;Z<i>j&#160;for&#160;all&#160;states&#160;i&#160;and&#160;j.&#160;For&#160;all&#160;states&#160;i,</i><br/>
<i>let&#160;k</i><br/>
<i>M</i><br/>
<i>i</i>(<i>zi</i>)&#160;:=&#160;−<i>C&#160;&lt;&#160;</i>0<i>.&#160;It&#160;fol&#160;lows&#160;that&#160;for&#160;al&#160;l&#160;x&#160;in&#160;</i>R<br/>
<i>,</i><br/>
2<br/>
B&#160;<i>x&#160;</i>=&#160;sup&#160;{<i>B</i>(<i>z</i>)<i>B</i>(<i>z</i>0)<i>x</i>}&#160;−&#160;2<i>C&#160;&lt;&#160;</i>sup&#160;{<i>B</i>(<i>z</i>)<i>x</i>}&#160;−&#160;<i>C&#160;</i>=&#160;B<i>x,</i><br/>
<i>z,z</i>0∈Z<br/>
<i>z</i>∈Z<br/>
<i>so&#160;that&#160;</i>(H4)&#160;<i>is&#160;satisfied&#160;with&#160;</i>1&#160;=&#160;<i>n</i>(<i>i</i>)&#160;<i>&lt;&#160;m</i>(<i>i</i>)&#160;=&#160;2&#160;<i>for&#160;all&#160;i.&#160;Intuitively,&#160;the&#160;controller&#160;pays</i><br/>
<i>twice&#160;the&#160;cost&#160;to&#160;apply&#160;</i>B&#160;<i>twice.</i><br/>
<i>In&#160;this&#160;case,&#160;denoting&#160;by&#160;v&#160;a&#160;solution&#160;of&#160;</i>(4.3)<i>,&#160;the&#160;control&#160;shown&#160;in&#160;Figure&#160;</i>4.1.1a&#160;<i>cannot</i><br/>
<i>correspond&#160;to&#160;some&#160;Pv&#160;satisfying&#160;</i>−<i>A</i>(<i>Pv</i>)<i>v&#160;</i>+&#160;<i>b</i>(<i>Pv</i>)&#160;=&#160;sup<br/>
{−<i>A</i>(<i>P&#160;</i>)<i>v&#160;</i>+&#160;<i>b</i>(<i>P&#160;</i>)}&#160;=&#160;0&#160;<i>since&#160;any</i><br/>
<i>P&#160;</i>∈P<br/>
<i>path&#160;from&#160;i&#160;&gt;&#160;</i>2&#160;<i>to&#160;j&#160;</i>=&#160;1&#160;<i>is&#160;of&#160;length&#160;at&#160;least&#160;m</i>(<i>i</i>)&#160;=&#160;2<i>.</i><br/>
We&#160;can&#160;now&#160;prove&#160;uniqueness&#160;independent&#160;of&#160;(H2):<br/>
<b>Theorem&#160;4.8.&#160;</b><i>Suppose&#160;</i>(H0)<i>,&#160;</i>(H3)<i>,&#160;and&#160;</i>(H4)<i>.&#160;A&#160;solution&#160;of&#160;</i>(4.3)&#160;<i>is&#160;unique.</i><br/>
<i>Proof.&#160;</i>Let&#160;<i>x&#160;</i>and&#160;<i>y&#160;</i>be&#160;two&#160;solutions&#160;and&#160;(<i>P&#160;`</i>)<i>`</i>≥0&#160;be&#160;a&#160;sequence&#160;in&#160;P&#160;such&#160;that<br/>
−<i>A</i>(<i>P&#160;`</i>)<i>y&#160;</i>+&#160;<i>b</i>(<i>P&#160;`</i>)&#160;→&#160;sup&#160;{−<i>A</i>(<i>P&#160;</i>)<i>y&#160;</i>+&#160;<i>b</i>(<i>P&#160;</i>)}&#160;=&#160;0<i>.</i><br/>
<i>P&#160;</i>∈P<br/>
It&#160;follows&#160;from&#160;(H3),&#160;(H4),&#160;and&#160;Lemma&#160;4.6&#160;that&#160;we&#160;can,&#160;without&#160;loss&#160;of&#160;generality,&#160;assume<br/><i>A</i>(<i>P&#160;`</i>)&#160;is&#160;a&#160;WCDD&#160;Z-matrix&#160;with&#160;positive&#160;diagonals,&#160;and&#160;hence&#160;an&#160;M-matrix&#160;by&#160;Theorem&#160;3.5.<br/>For&#160;some&#160;sequence&#160;(<i>`</i>)<br/>
<i>M</i><br/>
<i>`</i>≥0&#160;in&#160;R<br/>
with&#160;<i>`&#160;</i>→&#160;0,&#160;we&#160;can&#160;write<br/>
−<i>A</i>(<i>P&#160;`</i>)<i>y&#160;</i>+&#160;<i>b</i>(<i>P&#160;`</i>)&#160;+&#160;<i>`&#160;</i>=&#160;0&#160;=&#160;sup&#160;{−<i>A</i>(<i>P&#160;</i>)<i>x&#160;</i>+&#160;<i>b</i>(<i>P&#160;</i>)}&#160;≥&#160;−<i>A</i>(<i>P&#160;`</i>)<i>x&#160;</i>+&#160;<i>b</i>(<i>P&#160;`</i>)<i>,</i><br/>
<i>P&#160;</i>∈P<br/>
so&#160;that&#160;<i>A</i>(<i>P&#160;`</i>)(<i>x&#160;</i>−&#160;<i>y</i>)&#160;≥&#160;−<i>`</i>.&#160;Since&#160;the&#160;inverse&#160;of&#160;a&#160;monotone&#160;matrix&#160;has&#160;nonnegative&#160;elements<br/>and&#160;<i>P&#160;</i>7→&#160;<i>A</i>(<i>P&#160;</i>)−1&#160;is&#160;bounded&#160;by&#160;(H0),&#160;<i>x&#160;</i>−&#160;<i>y&#160;</i>≥&#160;0.&#160;Similarly,&#160;<i>y&#160;</i>−&#160;<i>x&#160;</i>≥&#160;0.<br/>
<br/>
Unfortunately,&#160;the&#160;conditions&#160;of&#160;Theorem&#160;4.8&#160;cannot&#160;guarantee&#160;that&#160;the&#160;iterates&#160;(<i>v`</i>)<i>`</i>≥1<br/>
given&#160;by&#160;policy&#160;iteration&#160;are&#160;well-defined,&#160;as&#160;<i>A</i>(<i>P&#160;`</i>)&#160;may&#160;be&#160;singular&#160;for&#160;some&#160;<i>`&#160;</i>≥&#160;1.&#160;This&#160;is<br/>demonstrated&#160;in&#160;the&#160;following&#160;example,&#160;for&#160;which&#160;(H2)&#160;does&#160;not&#160;hold:<br/>
<b>Example&#160;4.9&#160;</b>(Failure&#160;of&#160;policy&#160;iteration)<b>.&#160;</b><i>Consider&#160;Example&#160;</i>4.2<i>.&#160;For&#160;all&#160;states&#160;i,&#160;let<br/></i>Z<i>i&#160;</i>:=&#160;{<i>ej</i>}<i>M&#160;be&#160;the&#160;set&#160;of&#160;standard&#160;basis&#160;vectors&#160;and</i><br/>
<i>j</i>=1<br/>
<i>ki</i>(<i>zi</i>)&#160;:=&#160;−<i>C&#160;</i>−&#160;X&#160;<i>zij&#160;</i>|<i>i&#160;</i>−&#160;<i>j</i>|&#160;<i>&lt;&#160;</i>0&#160;<i>where&#160;C&#160;&gt;&#160;</i>0<i>.</i><br/>
<i>j</i><br/>
<i>As&#160;in&#160;Example&#160;</i>4.7<i>,&#160;</i>(H4)&#160;<i>is&#160;satisfied&#160;due&#160;to&#160;the&#160;fixed&#160;cost&#160;C.</i><br/>
<i>Let&#160;δ&#160;</i>:=&#160;1<i>.&#160;Suppose&#160;there&#160;exists&#160;a&#160;state&#160;r&#160;with&#160;</i>1&#160;∈&#160;D<i>r&#160;and&#160;cr</i>(<i>wr</i>)&#160;<i>&lt;&#160;</i>−<i>C&#160;for&#160;all&#160;controls&#160;w</i><br/>
<i>in&#160;</i>W<i>.&#160;It&#160;is&#160;readily&#160;verified&#160;that&#160;</i>Policy-Iteration&#160;<i>initialized&#160;with&#160;the&#160;zero&#160;vector&#160;v</i>0&#160;:=&#160;0<br/>
<i>picks&#160;P&#160;</i>1&#160;:=&#160;(<i>w</i>1<i>,&#160;z</i>1<i>,&#160;ψ</i>1)&#160;<i>with&#160;z</i>1&#160;=&#160;<i>er&#160;and&#160;ψ</i>1&#160;=&#160;1<i>.&#160;It&#160;follows&#160;that</i><br/>
<i>r</i><br/>
<i>r</i><br/>
[<i>A</i>(<i>P&#160;</i>1)]<i>rj&#160;</i>=&#160;[<i>I&#160;</i>−&#160;<i>B</i>(<i>z</i>1)]<i>rj&#160;</i>=&#160;[<i>I</i>]<i>rj&#160;</i>−&#160;[<i>I</i>]<i>rj&#160;</i>=&#160;0&#160;<i>for&#160;all&#160;j</i><br/>
<i>so&#160;that&#160;A</i>(<i>P&#160;</i>1)&#160;<i>is&#160;singular,&#160;and&#160;hence&#160;v</i>1&#160;<i>is&#160;undefined.</i><br/>
For&#160;any&#160;<i>`&#160;</i>≥&#160;1,&#160;it&#160;is&#160;possible&#160;to&#160;construct&#160;more&#160;complicated&#160;examples&#160;in&#160;which&#160;the&#160;matrices<br/>
<i>A</i>(<i>P&#160;</i>1)<i>,&#160;.&#160;.&#160;.&#160;,&#160;A</i>(<i>P&#160;`</i>−1)&#160;are&#160;nonsingular&#160;while&#160;<i>A</i>(<i>P&#160;`</i>)&#160;is&#160;singular.&#160;That&#160;is,&#160;policy&#160;iteration&#160;can&#160;fail<br/>at&#160;any&#160;iterate.<br/>
10<br/>
<hr/>
<a name=11></a><b>4.3</b><br/>
<b>Policy&#160;iteration&#160;on&#160;a&#160;modified&#160;problem</b><br/>
As&#160;demonstrated&#160;in&#160;the&#160;previous&#160;section,&#160;if&#160;(H2)&#160;is&#160;not&#160;satisfied,&#160;policy&#160;iteration&#160;may&#160;fail.<br/>We&#160;may,&#160;however,&#160;hope&#160;to&#160;construct&#160;a&#160;solution&#160;by&#160;performing&#160;policy&#160;iteration&#160;on&#160;a&#160;“modified<br/>
problem”&#160;with&#160;control&#160;set&#160;P0&#160;obtained&#160;by&#160;removing&#160;controls&#160;<i>P&#160;</i>in&#160;P&#160;that&#160;render&#160;<i>A</i>(<i>P&#160;</i>)&#160;singular.<br/>
We&#160;define&#160;(H1)0&#160;by&#160;replacing&#160;all&#160;occurrences&#160;of&#160;P&#160;with&#160;P0&#160;in&#160;the&#160;definition&#160;of&#160;(H1).&#160;(H2)0<br/>
and&#160;(H3)0&#160;are&#160;defined&#160;similarly.&#160;We&#160;can&#160;now&#160;state&#160;the&#160;above&#160;idea&#160;precisely:<br/>
<b>Theorem&#160;4.10.&#160;</b><i>Let&#160;</i>P0&#160;:=&#160;Q<i>M&#160;</i>P0&#160;<i>where&#160;each&#160;</i>P0&#160;⊂&#160;P<br/>
<i>i</i>=1<br/>
<i>i</i><br/>
<i>i</i><br/>
<i>i&#160;is&#160;nonempty.&#160;Suppose&#160;</i>(H0)<i>,&#160;</i>(H1)0<i>,</i><br/>
(H2)0<i>,&#160;</i>(H3)<i>,&#160;</i>(H4)<i>,&#160;and</i><br/>
<i>for&#160;all&#160;v&#160;in</i><br/>
<i>M</i><br/>
R&#160;<i>,</i><br/>
sup&#160;{−<i>A</i>(<i>P&#160;</i>)<i>v&#160;</i>+&#160;<i>b</i>(<i>P&#160;</i>)}&#160;=&#160;0&#160;=⇒&#160;sup&#160;{−<i>A</i>(<i>P&#160;</i>)<i>v&#160;</i>+&#160;<i>b</i>(<i>P&#160;</i>)}&#160;=&#160;0<i>.</i><br/>
(4.7)<br/>
<i>P&#160;</i>∈P0<br/>
<i>P&#160;</i>∈P<br/>
(<i>v`</i>)<i>`</i>≥1&#160;<i>defined&#160;by&#160;</i>Policy-Iteration(P0<i>,&#160;A</i>(·)<i>,&#160;b</i>(·)<i>,&#160;v</i>0)&#160;<i>is&#160;nondecreasing&#160;and&#160;converges&#160;to</i><br/>
<i>the&#160;unique&#160;solution&#160;of&#160;</i>(4.3)<i>.&#160;Moreover,&#160;if&#160;</i>P0&#160;<i>is&#160;finite,&#160;convergence&#160;occurs&#160;in&#160;at&#160;most&#160;</i>|P0|<br/><i>iterations.</i><br/>
<i>Proof.&#160;</i>Since&#160;P0&#160;⊂&#160;P,&#160;it&#160;follows&#160;immediately&#160;that&#160;(H0)0&#160;and&#160;(H3)0&#160;are&#160;satisfied,&#160;so&#160;that&#160;by<br/>
Theorem&#160;4.3,&#160;(<i>v`</i>)<i>`</i>≥1&#160;is&#160;well-defined&#160;and&#160;converges&#160;to&#160;the&#160;unique&#160;solution&#160;<i>v&#160;</i>of&#160;the&#160;modified<br/>
problem.&#160;That&#160;is,&#160;<i>v`&#160;</i>→&#160;<i>v&#160;</i>and&#160;sup<i>P</i>∈P0&#160;{−<i>A</i>(<i>P&#160;</i>)<i>v&#160;</i>+&#160;<i>b</i>(<i>P&#160;</i>)}&#160;=&#160;0.&#160;By&#160;(4.7),&#160;<i>v&#160;</i>solves&#160;the<br/>original&#160;problem&#160;(4.3).&#160;Since&#160;solutions&#160;to&#160;(4.3)&#160;are&#160;unique&#160;by&#160;Theorem&#160;4.8,&#160;the&#160;desired&#160;result<br/>follows.<br/>
<br/>
We&#160;now&#160;give&#160;a&#160;nontrivial&#160;example&#160;(in&#160;the&#160;sense&#160;that&#160;(H2)&#160;fails)&#160;for&#160;which&#160;we&#160;can&#160;apply<br/>
Theorem&#160;4.10:<br/>
<b>Example&#160;4.11.&#160;</b><i>Consider&#160;Example&#160;</i>4.2<i>.&#160;Let&#160;(i)&#160;</i>Z&#160;<i>and&#160;k&#160;be&#160;given&#160;as&#160;in&#160;Example&#160;</i>4.9<i>,&#160;(ii)&#160;</i>W<i>i</i><br/>
<i>be&#160;the&#160;set&#160;of&#160;all&#160;M&#160;-dimensional&#160;probability&#160;vectors&#160;wi&#160;with&#160;wij&#160;</i>=&#160;0&#160;<i>whenever&#160;</i>|<i>i&#160;</i>−&#160;<i>j</i>|&#160;<i>&gt;&#160;</i>1<i>,&#160;(iii)</i><br/>
<i>c&#160;be&#160;continuous&#160;and&#160;bounded,&#160;and&#160;(iv)&#160;c&#160;</i>:=&#160;max<i>w</i>∈W&#160;<i>c</i>(<i>w</i>)&#160;<i>with&#160;ci</i>−1&#160;≥&#160;<i>ci&#160;for&#160;all&#160;</i>1&#160;<i>&lt;&#160;i&#160;</i>≤&#160;<i>M&#160;.</i><br/>
<i>Let&#160;</i>P0&#160;<i>be&#160;all&#160;P&#160;</i>:=&#160;(<i>w,&#160;z,&#160;ψ</i>)&#160;<i>in&#160;</i>P&#160;<i>satisfying&#160;</i>(4.5)<i>.&#160;Then,&#160;the&#160;conditions&#160;of&#160;Theorem&#160;</i>4.10&#160;<i>are<br/>satisfied.</i><br/>
<i>Proof.&#160;</i>It&#160;is&#160;straightforward&#160;to&#160;verify&#160;(H0),&#160;(H1)0,&#160;(H2)0,&#160;(H3),&#160;and&#160;(H4).&#160;Thus,&#160;it&#160;is&#160;sufficient<br/>to&#160;show&#160;(4.7).&#160;We&#160;write&#160;P0&#160;:=&#160;W<br/>
×&#160;D0&#160;and&#160;define&#160;[&#160;0<i>x</i>]<br/>
<i>i</i><br/>
<i>i&#160;</i>×&#160;Z&#160;0<i>i</i><br/>
<i>i</i><br/>
B<br/>
<i>i&#160;</i>for&#160;<i>i&#160;&gt;&#160;</i>1&#160;by&#160;replacing&#160;Z&#160;with<br/>
Z0&#160;:=&#160;Q<i>M&#160;</i>Z0&#160;in&#160;(4.6).<br/>
<i>i</i>=1<br/>
<i>i</i><br/>
We&#160;first&#160;show&#160;that&#160;the&#160;solution&#160;<i>v&#160;</i>to&#160;the&#160;modified&#160;problem&#160;is&#160;nonincreasing:<br/>
<i>vi</i>−1&#160;≥&#160;<i>vi&#160;</i>for&#160;all&#160;1&#160;<i>&lt;&#160;i&#160;</i>≤&#160;<i>M.</i><br/>
Suppose&#160;the&#160;contrary.&#160;Let&#160;<i>r&#160;&gt;&#160;</i>1&#160;be&#160;the&#160;minimal&#160;element&#160;such&#160;that&#160;<i>v</i><br/>
0<br/>
<i>r</i>−1&#160;<i>&lt;&#160;vr&#160;</i>.&#160;If&#160;<i>vr&#160;</i>=&#160;[B&#160;<i>v</i>]<i>r</i>,<br/>
then&#160;<i>vr&#160;</i>=&#160;<i>vj&#160;</i>−&#160;<i>C&#160;</i>−&#160;|<i>r&#160;</i>−&#160;<i>j</i>|&#160;for&#160;some&#160;<i>j&#160;&lt;&#160;r</i>.&#160;Either&#160;<i>j&#160;</i>=&#160;<i>r&#160;</i>−&#160;1&#160;or<br/>
<i>v</i><br/>
0<br/>
<i>r</i>−1&#160;≥&#160;[B&#160;<i>v</i>]<br/>
≥&#160;<i>v</i><br/>
<i>r</i>−1<br/>
<i>j&#160;</i>−&#160;<i>C&#160;</i>−&#160;|(<i>r&#160;</i>−&#160;1)&#160;−&#160;<i>j</i>|&#160;≥&#160;<i>vr</i><br/>
(both&#160;are&#160;contradictions).&#160;It&#160;follows&#160;that&#160;<i>vr&#160;</i>=&#160;[L<i>v</i>]<i>r</i>.&#160;Letting&#160;<i>w</i>0<i>j,&#160;v</i>0&#160;:=&#160;0&#160;for&#160;notational<br/>
convenience,&#160;assumption&#160;(ii)&#160;implies<br/>
<br/>
<br/>
<i>r</i><br/>
<br/>
<i>w</i><br/>
<br/>
<i>v</i><br/>
<i>v</i><br/>
X<br/>
<i>r</i>−1<i>,j</i><br/>
<i>r</i>−1<br/>
<i>r</i>−1&#160;≥&#160;[L<i>v</i>]<br/>
=&#160;max<br/>
<i>v</i><br/>
≥<br/>
+&#160;<i>c</i><br/>
<i>r</i>−1<br/>
<i>j&#160;</i>+&#160;[<i>c</i>(<i>w</i>)]<i>r</i>−1<br/>
<i>r</i>−1<br/>
<i>w</i>∈W<br/>
1&#160;+&#160;<i>ρ</i><br/>
1&#160;+&#160;<i>ρ</i><br/>
<i>j</i>=<i>r</i>−2<br/>
<br/>
11<br/>
<hr/>
<a name=12></a>so&#160;that&#160;<i>vr</i>−1&#160;≥&#160;(1&#160;+&#160;1<i>/ρ</i>)<i>cr</i>−1.&#160;If&#160;<i>vr&#160;</i>≥&#160;<i>vr</i>+1,&#160;it&#160;follows&#160;similarly&#160;from&#160;<i>vr&#160;</i>=&#160;[L<i>v</i>]<i>r&#160;</i>that<br/><i>vr&#160;</i>≤&#160;(1&#160;+&#160;1<i>/ρ</i>)<i>cr&#160;</i>so&#160;that&#160;<i>vr</i>−1&#160;≥&#160;<i>vr&#160;</i>(a&#160;contradiction)&#160;and&#160;hence&#160;it&#160;must&#160;be&#160;the&#160;case&#160;that<br/><i>vr&#160;&lt;&#160;vr</i>+1.&#160;We&#160;can&#160;repeat&#160;this&#160;argument&#160;inductively&#160;to&#160;arrive&#160;at&#160;the&#160;contradiction<br/>
<i>vr</i>−1&#160;<i>&lt;&#160;vr&#160;&lt;&#160;</i>·&#160;·&#160;·&#160;<i>&lt;&#160;vM&#160;</i>and&#160;<i>vr</i>−1&#160;≥&#160;(1&#160;+&#160;1<i>/ρ</i>)<i>cr</i>−1&#160;≥&#160;(1&#160;+&#160;1<i>/ρ</i>)<i>cM&#160;</i>≥&#160;<i>vM&#160;.</i><br/>
Since&#160;<i>v&#160;</i>is&#160;nonincreasing,&#160;<i>v&#160;</i>≥&#160;B<i>v&#160;</i>(it&#160;is&#160;suboptimal&#160;to&#160;take&#160;<i>ψi&#160;</i>=&#160;1&#160;and&#160;<i>zij&#160;</i>=&#160;1&#160;for&#160;states&#160;<i>i</i><br/>
and&#160;<i>j&#160;</i>with&#160;<i>j&#160;</i>≥&#160;<i>i</i>),&#160;and&#160;hence&#160;(4.7)&#160;holds.<br/>
<br/>
<b>5</b><br/>
<b>Numerical&#160;schemes&#160;for&#160;the&#160;HJBQVI&#160;problem</b><br/>
All&#160;numerical&#160;schemes&#160;herein&#160;are&#160;on&#160;a&#160;rectilinear&#160;grid<br/>
n<br/>
n<br/>
o<br/>
n<br/>
o<br/>
<i>t</i>1<i>,&#160;.&#160;.&#160;.&#160;,&#160;tN&#160;</i>o&#160;×&#160;<i>x</i>1<i>,&#160;x</i>1<i>,&#160;.&#160;.&#160;.&#160;</i>×&#160;·&#160;·&#160;·&#160;×&#160;<i>xd,&#160;xd,&#160;.&#160;.&#160;.</i><br/>
1<br/>
2<br/>
1<br/>
2<br/>
where&#160;0&#160;=:&#160;<i>t</i>1&#160;<i>&lt;&#160;</i>·&#160;·&#160;·&#160;<i>&lt;&#160;tN&#160;</i>:=&#160;<i>T&#160;</i>and&#160;<i>xj&#160;&lt;&#160;xj&#160;&lt;&#160;</i>·&#160;·&#160;·&#160;for&#160;all&#160;<i>j</i>.&#160;Multi-indices&#160;are&#160;used&#160;(i.e.<br/>
1<br/>
2<br/>
<i>xi&#160;</i>:=&#160;(<i>xi&#160;,&#160;.&#160;.&#160;.&#160;,&#160;x&#160;</i>)).&#160;<i>M&#160;</i>denotes&#160;the&#160;number&#160;of&#160;spatial&#160;points&#160;<i>x</i><br/>
1<br/>
<i>id</i><br/>
<i>i</i>.&#160;For&#160;functions&#160;<i>q&#160;</i>:=&#160;<i>q</i>(<i>t,&#160;x</i>)<br/>
defined&#160;on&#160;[0<i>,&#160;T&#160;</i>]&#160;×<br/>
<i>d</i><br/>
R&#160;,&#160;the&#160;shorthands&#160;<i>qn&#160;</i>:=&#160;<i>q</i>(<i>tn,&#160;x</i><br/>
<i>i</i><br/>
<i>i</i>)&#160;and&#160;<i>qn</i>(<i>x</i>)&#160;:=&#160;<i>q</i>(<i>tn,&#160;x</i>)&#160;are&#160;employed.<br/>
In&#160;the&#160;absence&#160;of&#160;ambiguity,&#160;we&#160;use&#160;<i>qn&#160;</i>to&#160;denote&#160;the&#160;vector&#160;with&#160;components&#160;<i>qn&#160;</i>and&#160;take<br/>
<i>i</i><br/>
∆<i>t&#160;</i>:=&#160;<i>tn</i>+1&#160;−&#160;<i>tn</i>.&#160;It&#160;is&#160;understood&#160;that&#160;max<i>n</i>{<i>tn</i>+1&#160;−&#160;<i>tn</i>}&#160;→&#160;0&#160;and&#160;max<i>i</i>{<i>xi</i>+1&#160;−&#160;<i>xi</i>}&#160;→&#160;0&#160;as<br/>
<i>h&#160;</i>→&#160;0,&#160;where&#160;<i>h&#160;</i>denotes&#160;a&#160;“global”&#160;discretization&#160;parameter&#160;that&#160;controls&#160;the&#160;coarseness&#160;of<br/>the&#160;grid.<br/>
Control&#160;sets&#160;<i>W&#160;</i>and&#160;<i>Z</i>(<i>t,&#160;x</i>)&#160;are&#160;approximated&#160;by&#160;finite&#160;sets&#160;∅&#160;6=&#160;<i>Wh&#160;</i>⊂&#160;<i>W&#160;</i>and&#160;<i>Zh</i>(<i>t,&#160;x</i>)&#160;⊂<br/>
<i>Z</i>(<i>t,&#160;x</i>).&#160;The&#160;reader&#160;concerned&#160;with&#160;consistency&#160;should&#160;impose&#160;some&#160;regularity&#160;to&#160;justify&#160;this<br/>approximation,&#160;such&#160;as:&#160;(i)&#160;<i>W&#160;</i>is&#160;compact,&#160;(ii)&#160;<i>Z&#160;</i>is&#160;everywhere&#160;compact&#160;and&#160;continuous&#160;with<br/>respect&#160;to&#160;the&#160;Hausdorff&#160;metric,&#160;and&#160;(iii)&#160;max<i>w</i>∈<i>W&#160;</i>min<i>w</i><br/>
|<i>w&#160;</i>−&#160;<i>w</i><br/>
<i>h</i>∈<i>Wh</i><br/>
<i>h</i>|&#160;→&#160;0&#160;as&#160;the&#160;discretization<br/>
parameter&#160;<i>h&#160;</i>→&#160;0&#160;along&#160;with&#160;an&#160;identical&#160;pointwise&#160;condition&#160;for&#160;<i>Z&#160;</i>and&#160;<i>Zh</i>.<br/>
The&#160;discretized&#160;impulse&#160;operator&#160;(1.2)&#160;is<br/>
[M<i>nun</i>]&#160;:=&#160;max&#160;{<i>un&#160;x</i><br/>
(<i>z</i>)&#160;+&#160;<i>Kn</i>(<i>z</i>)}<br/>
<i>h</i><br/>
<i>i</i><br/>
J<br/>
<i>i&#160;</i>+&#160;Γ<i>n</i><br/>
<i>i</i><br/>
K<br/>
<i>i</i><br/>
<i>z</i>∈(<i>Zh</i>)<i>n</i><br/>
<i>i</i><br/>
where&#160;<i>ϕ&#160;x&#160;</i>denotes&#160;linear&#160;interpolation&#160;using&#160;the&#160;value&#160;of&#160;<i>ϕ&#160;</i>on&#160;grid&#160;nodes.&#160;It&#160;is&#160;understood<br/>
J<br/>
K<br/>
that&#160;controls&#160;<i>z&#160;</i>that&#160;cause&#160;<i>xi&#160;</i>+&#160;Γ<i>n</i>(<i>z</i>)&#160;to&#160;exit&#160;the&#160;numerical&#160;grid&#160;are&#160;not&#160;included&#160;in&#160;(<i>Z</i><br/>
.<br/>
<i>i</i><br/>
<i>h</i>)<i>n</i><br/>
<i>i</i><br/>
We&#160;use&#160;Ł<i>n</i>(<i>w</i>)&#160;to&#160;denote&#160;a&#160;consistent&#160;discretization&#160;of&#160;Ł<i>w&#160;</i>with&#160;coefficients&#160;frozen&#160;at&#160;<i>t&#160;</i>=&#160;<i>tn</i>.<br/>
<i>h</i><br/>
Recall&#160;that&#160;in&#160;(1.1),&#160;Λ&#160;⊂&#160;<i>∂</i>Ω&#160;is&#160;a&#160;special&#160;subset&#160;of&#160;the&#160;boundary&#160;at&#160;which&#160;a&#160;Dirichlet-like<br/>
condition&#160;is&#160;applied.&#160;To&#160;distinguish&#160;points,&#160;we&#160;denote&#160;by&#160;Φ&#160;a&#160;diagonal&#160;matrix&#160;satisfying<br/>[Φ]<i>ii&#160;</i>=&#160;0&#160;whenever&#160;<i>xi&#160;</i>is&#160;in&#160;Λ&#160;and&#160;[Φ]<i>ii&#160;</i>=&#160;1&#160;otherwise.<br/>
Since&#160;the&#160;Dirichlet-like&#160;condition&#160;is&#160;imposed&#160;at&#160;the&#160;final&#160;time&#160;<i>t&#160;</i>=&#160;<i>T&#160;</i>,&#160;the&#160;numerical&#160;method<br/>
proceeds&#160;backwards&#160;in&#160;time&#160;(i.e.&#160;from&#160;<i>tn</i>+1&#160;to&#160;<i>tn</i>).&#160;More&#160;precisely,&#160;letting&#160;<i>uN&#160;</i>:=&#160;<i>gN&#160;</i>,&#160;the<br/>
<i>i</i><br/>
<i>i</i><br/>
numerical&#160;solution&#160;<i>un&#160;</i>at&#160;timestep&#160;1&#160;≤&#160;<i>n&#160;&lt;&#160;N&#160;</i>produced&#160;by&#160;each&#160;scheme&#160;(given&#160;the&#160;solution&#160;at<br/>the&#160;previous&#160;timestep,&#160;<i>un</i>+1)&#160;is&#160;written&#160;as&#160;a&#160;solution&#160;of&#160;(2.1)&#160;with&#160;<i>A&#160;</i>and&#160;<i>b&#160;</i>picked&#160;appropriately.<br/>Control&#160;sets&#160;are&#160;given&#160;by&#160;(4.1)&#160;and<br/>
<br/>
<br/>
(<i>Z</i><br/>
if&#160;(<i>Z</i><br/>
6=&#160;∅<br/>
{0<i>,&#160;</i>1}<br/>
if&#160;(<i>Z</i><br/>
6=&#160;∅<br/>
W<br/>
<i>h</i>)<i>n</i>0<br/>
<i>i</i><br/>
<i>h</i>)<i>n</i>0<br/>
<i>i</i><br/>
<i>h</i>)<i>n</i>0<br/>
<i>i</i><br/>
<i>i&#160;</i>:=&#160;<i>Wh</i>,&#160;Z<i>i&#160;</i>:=<br/>
,&#160;and&#160;D<i>i&#160;</i>:=<br/>
(5.1)<br/>
{∅}<br/>
otherwise<br/>
{0}<br/>
otherwise<br/>
12<br/>
<hr/>
<a name=13></a>where&#160;<i>n</i>0&#160;is&#160;<i>n&#160;</i>+&#160;1&#160;for&#160;the&#160;semi-Lagrangian&#160;scheme&#160;(see&#160;§5.3)&#160;and&#160;<i>n&#160;</i>otherwise.&#160;As&#160;a&#160;technical<br/>
detail,&#160;we&#160;take&#160;Z<i>i&#160;</i>to&#160;be&#160;a&#160;nonempty&#160;set&#160;(we&#160;choose&#160;{∅}&#160;arbitrarily)&#160;whenever&#160;(<i>Zh</i>)<i>n</i>0&#160;is&#160;empty<br/>
<i>i</i><br/>
to&#160;ensure&#160;that&#160;the&#160;product&#160;W<i>i&#160;</i>×&#160;Z<i>i&#160;</i>×&#160;D<i>i&#160;</i>of&#160;(4.1)&#160;is&#160;nonempty.<br/>
We&#160;make&#160;the&#160;following&#160;assumptions:<br/>
(A0)&#160;W&#160;:=&#160;Q<i>M&#160;</i>W<br/>
Z<br/>
<i>i</i>=1<br/>
<i>i&#160;</i>and&#160;Z&#160;:=&#160;Q<i>M</i><br/>
<i>i</i>=1<br/>
<i>i&#160;</i>are&#160;finite.<br/>
(A1)&#160;For&#160;all&#160;<i>w&#160;</i>in&#160;W,&#160;−Ł<i>n</i>(<i>w</i>)&#160;is&#160;a&#160;WDD&#160;Z-matrix&#160;with&#160;nonnegative&#160;diagonals.<br/>
<i>h</i><br/>
(A2)&#160;For&#160;all&#160;<i>z&#160;</i>in&#160;Z,&#160;<i>Bn</i>(<i>z</i>)&#160;is&#160;a&#160;right&#160;stochastic&#160;(a.k.a.&#160;Markov)&#160;matrix&#160;with&#160;[<i>Bn</i>(<i>z</i>)<i>v</i>]<i>i&#160;</i>=<br/>
<i>v&#160;x</i><br/>
(<i>z</i><br/>
.<br/>
J<br/>
<i>i&#160;</i>+&#160;Γ<i>n</i><br/>
<i>i</i><br/>
<i>i</i>)K<br/>
(A3)&#160;<i>ρ&#160;</i>≥&#160;0&#160;and&#160;<i>δ,&#160;&#160;&gt;&#160;</i>0.<br/>
Since&#160;(A0)&#160;ensures&#160;that&#160;P&#160;is&#160;finite,&#160;all&#160;schemes&#160;in&#160;the&#160;sequel&#160;satisfy&#160;(H0)&#160;and&#160;(H1).<br/>
<b>Remark&#160;5.1.&#160;</b><i>Barles&#160;and&#160;Souganidis&#160;[4]&#160;prove&#160;that&#160;a&#160;numerical&#160;scheme&#160;converges&#160;to&#160;the</i><br/>
<i>unique&#160;viscosity&#160;solution&#160;of&#160;a&#160;fully&#160;nonlinear&#160;second&#160;order&#160;equation&#160;(such&#160;as&#160;</i>(1.1)<i>)&#160;satisfying<br/>a&#160;comparison&#160;result&#160;if&#160;it&#160;is&#160;monotone&#160;in&#160;the&#160;viscosity&#160;sense,&#160;`</i>∞&#160;<i>stable,&#160;and&#160;consistent.</i><br/>
<i>Comparison&#160;results&#160;for&#160;the&#160;HJBQVI&#160;</i>(1.1)&#160;<i>are&#160;provided&#160;in&#160;[26,&#160;Theorem&#160;5.11].&#160;</i>(A1)&#160;<i>and&#160;</i>(A2)<br/>
<i>ensure&#160;monotonicity&#160;(see&#160;[23,&#160;Section&#160;1.3]&#160;for&#160;an&#160;example&#160;of&#160;a&#160;stable&#160;nonmonotone&#160;scheme<br/>that&#160;fails&#160;to&#160;converge).&#160;For&#160;brevity,&#160;we&#160;do&#160;not&#160;give&#160;proofs&#160;of&#160;consistency&#160;or&#160;discuss&#160;stability</i><br/>
<i>here.</i><br/>
<b>5.1</b><br/>
<b>Direct&#160;control</b><br/>
In&#160;a&#160;direct&#160;control&#160;formulation,&#160;either&#160;the&#160;generator&#160;(sup<br/>
{<i>∂u/∂t&#160;</i>+&#160;Ł<i>wu&#160;</i>−&#160;<i>ρu&#160;</i>+&#160;<i>f&#160;w</i>})&#160;or<br/>
<i>w</i>∈<i>W</i><br/>
impulse&#160;(M<i>u&#160;</i>−&#160;<i>u</i>)&#160;component&#160;is&#160;active&#160;at&#160;any&#160;grid&#160;point.&#160;Since&#160;these&#160;have&#160;different&#160;units,<br/>comparing&#160;them&#160;in&#160;floating&#160;point&#160;arithmetic&#160;requires&#160;a&#160;scaling&#160;factor&#160;<i>δ&#160;&gt;&#160;</i>0&#160;to&#160;ensure&#160;fast<br/>convergence&#160;[16]&#160;(see&#160;also&#160;Lemma&#160;4.1).&#160;Scaling&#160;by&#160;<i>δ&#160;</i>and&#160;discretizing&#160;(1.1)&#160;(ignoring&#160;boundary<br/>conditions)&#160;yields<br/>
&#160;<br/>
(&#160;<i>un</i>+1&#160;−&#160;<i>un</i><br/>
)<br/>
!<br/>
max&#160;max<br/>
<i>i</i><br/>
<i>i&#160;</i>+&#160;[Ł<i>n</i>(<i>w</i>)<i>un</i>]&#160;−&#160;<i>ρun&#160;</i>+&#160;<i>fn</i>(<i>w</i>)&#160;<i>,&#160;δ&#160;</i>([M<i>nun</i>]&#160;−&#160;<i>un</i>)&#160;=&#160;0<i>.</i><br/>
<i>h</i><br/>
<i>i</i><br/>
<i>i</i><br/>
<i>i</i><br/>
<i>h</i><br/>
<i>i</i><br/>
<i>i</i><br/>
<i>w</i>∈<i>Wh</i><br/>
∆<i>t</i><br/>
Including&#160;boundary&#160;conditions,&#160;this&#160;is&#160;put&#160;in&#160;the&#160;form&#160;of&#160;(4.3)&#160;by&#160;taking<br/>
<br/>
<br/>
<i>L</i>(<i>w</i>)&#160;:=&#160;Φ&#160;(Ł<i>n</i>(<i>w</i>)&#160;−&#160;<i>ρI</i>)&#160;∆<i>t</i>;<br/>
<i>c</i>(<i>w</i>)&#160;:=&#160;Φ&#160;<i>un</i>+1&#160;+&#160;<i>f&#160;n</i>(<i>w</i>)∆<i>t&#160;</i>+&#160;(<i>I&#160;</i>−&#160;Φ)&#160;<i>gn</i>;<br/>
<i>h</i><br/>
<i>B</i>(<i>z</i>)&#160;:=&#160;<i>Bn</i>(<i>z</i>);<br/>
<i>k</i>(<i>z</i>)&#160;:=&#160;<i>Kn</i>(<i>z</i>)<i>.</i><br/>
(5.2)<br/>
With&#160;<i>B&#160;</i>and&#160;<i>k&#160;</i>given&#160;above,&#160;the&#160;operator&#160;M<i>n&#160;</i>is&#160;equivalent&#160;to<br/>
<i>h</i><br/>
B&#160;defined&#160;in&#160;(4.6).<br/>
<i>L&#160;</i>and&#160;<i>B&#160;</i>given&#160;above&#160;satisfy&#160;(H3)&#160;due&#160;to&#160;(A1)–(A3).&#160;Therefore,&#160;(H4)&#160;is&#160;a&#160;sufficient<br/>
condition&#160;for&#160;uniqueness&#160;of&#160;solutions&#160;(Theorem&#160;4.8).&#160;Similarly,&#160;(H2)&#160;is&#160;a&#160;sufficient&#160;condition<br/>for&#160;convergence&#160;of&#160;the&#160;corresponding&#160;policy&#160;iteration&#160;(Theorem&#160;4.3).<br/>
13<br/>
<hr/>
<a name=14></a><b>5.2</b><br/>
<b>Penalized</b><br/>
A&#160;penalized&#160;formulation&#160;(treated&#160;in&#160;detail&#160;in&#160;[28])&#160;imposes&#160;a&#160;penalty&#160;scaled&#160;by&#160;1<i>/</i>0&#160;&#160;0<br/>whenever&#160;M<i>u&#160;&gt;&#160;u</i>.&#160;The&#160;scheme&#160;is&#160;given&#160;by:<br/>
(&#160;<i>un</i>+1&#160;−&#160;<i>un</i><br/>
)<br/>
max<br/>
<i>i</i><br/>
<i>i&#160;</i>+&#160;[Ł<i>n</i>(<i>w</i>)<i>un</i>]&#160;−&#160;<i>ρun&#160;</i>+&#160;<i>fn</i>(<i>w</i>)&#160;+&#160;max&#160;([M<i>nun</i>]&#160;−&#160;<i>un,&#160;</i>0)&#160;<i>/</i>0&#160;=&#160;0<i>.</i><br/>
<i>h</i><br/>
<i>i</i><br/>
<i>i</i><br/>
<i>i</i><br/>
<i>h</i><br/>
<i>i</i><br/>
<i>i</i><br/>
<i>w</i>∈<i>Wh</i><br/>
∆<i>t</i><br/>
For&#160;simplicity,&#160;we&#160;take&#160;<i></i>0&#160;:=&#160;<i></i>∆<i>t&#160;</i>for&#160;some&#160;<i>&#160;&gt;&#160;</i>0.&#160;Including&#160;boundary&#160;conditions,&#160;this&#160;is&#160;put<br/>in&#160;the&#160;form&#160;(2.1)&#160;by&#160;taking<br/>
<i>A</i>(<i>P&#160;</i>)&#160;:=&#160;<i>I&#160;</i>+&#160;Φ&#160;(<i>ρI&#160;</i>−&#160;Ł<i>n</i>(<i>w</i>))&#160;∆<i>t&#160;</i>+&#160;Ψ&#160;(<i>I&#160;</i>−&#160;<i>Bn</i>(<i>z</i>))&#160;<i>/</i>;<br/>
<i>h</i><br/>
<br/>
<br/>
<i>b</i>(<i>P&#160;</i>)&#160;:=&#160;Φ&#160;<i>un</i>+1&#160;+&#160;<i>f&#160;n</i>(<i>w</i>)∆<i>t&#160;</i>+&#160;(<i>I&#160;</i>−&#160;Φ)&#160;<i>gn&#160;</i>+&#160;Ψ<i>Kn</i>(<i>z</i>)<i>/.</i><br/>
Convergence&#160;of&#160;the&#160;corresponding&#160;policy&#160;iteration&#160;is&#160;trivial&#160;since&#160;<i>A</i>(<i>P&#160;</i>)&#160;is&#160;an&#160;SDD&#160;Z-matrix<br/>
with&#160;positive&#160;diagonals&#160;(by&#160;virtue&#160;of&#160;(A1)–(A3)),&#160;and&#160;hence&#160;an&#160;M-matrix.<br/>
<b>5.3</b><br/>
<b>Semi-Lagrangian</b><br/>
The&#160;crux&#160;of&#160;a&#160;semi-Lagrangian&#160;scheme&#160;is&#160;the&#160;use&#160;of&#160;a&#160;<i>Lagrangian&#160;derivative&#160;</i>to&#160;remove&#160;the<br/>
<i>Dx&#160;</i>coefficient’s&#160;dependency&#160;on&#160;the&#160;control&#160;<i>w</i>.&#160;It&#160;is&#160;assumed&#160;that&#160;(i)&#160;<i>σ&#160;</i>is&#160;independent&#160;of&#160;the<br/>control&#160;and&#160;(ii)&#160;the&#160;drift&#160;<i>µ&#160;</i>and&#160;forcing&#160;term&#160;<i>f&#160;</i>can&#160;be&#160;split&#160;into&#160;(sufficiently&#160;regular)&#160;controlled<br/>and&#160;uncontrolled&#160;components:<br/>
<i>µ</i>(<i>y,&#160;w</i>)&#160;=&#160;ˆ<br/>
<i>µ</i>(<i>y</i>)&#160;+&#160;ˆ<br/>
<i>µ</i>(<i>y,&#160;w</i>)&#160;and&#160;<i>f&#160;</i>(<i>y,&#160;w</i>)&#160;=&#160;ˆ<br/>
<i>f&#160;</i>(<i>y</i>)&#160;+&#160;ˆ<br/>
<i>f&#160;</i>(<i>y,&#160;w</i>)<i>.</i><br/>
We&#160;now&#160;give&#160;some&#160;intuition&#160;behind&#160;a&#160;semi-Lagrangian&#160;scheme.&#160;Consider&#160;a&#160;generator&#160;ˆ<br/>
Ł<br/>
corresponding&#160;to&#160;an&#160;uncontrolled&#160;SDE:<br/>
ˆ<br/>
D<br/>
E<br/>
Ł<i>u</i>(<i>y</i>)&#160;:=&#160;Ł(<i>w</i>)<i>u</i>(<i>y</i>)&#160;−&#160;ˆ<br/>
<i>µ</i>(<i>y,&#160;w</i>)<i>,&#160;Dxu</i>(<i>y</i>)&#160;<i>.</i><br/>
Letting&#160;<i>X&#160;</i>:=&#160;<i>X</i>(<i>t</i>)&#160;denote&#160;a&#160;<i>d</i>-dimensional&#160;trajectory&#160;satisfying<br/>
<i>X</i>(<i>tn</i>)&#160;=&#160;<i>xi&#160;</i>and&#160;<i>dX</i>(<i>t</i>)&#160;=&#160;ˆ<br/>
<i>µ</i>(<i>t,&#160;X</i>(<i>t</i>)<i>,&#160;w</i>)<i>dt&#160;</i>on&#160;(<i>tn,&#160;tn</i>+1]<br/>
so&#160;that&#160;<i>X</i>(<i>tn</i>+1)&#160;≈&#160;<i>X</i>(<i>tn</i>)&#160;+&#160;ˆ<br/>
<i>µ</i>(<i>tn,&#160;X</i>(<i>tn</i>)<i>,&#160;w</i>)∆<i>t&#160;</i>=&#160;<i>xi&#160;</i>+&#160;ˆ<br/>
<i>µn</i>(<i>w</i>)∆<i>t</i>,&#160;we&#160;define&#160;the&#160;Lagrangian<br/>
<i>i</i><br/>
derivative&#160;with&#160;respect&#160;to&#160;<i>X&#160;</i>as<br/>
<i>Du</i><br/>
<i>∂</i><br/>
<i>∂u</i><br/>
D<br/>
E<br/>
(<i>t,&#160;X</i>(<i>t</i>)<i>,&#160;w</i>)&#160;:=<br/>
[<i>u</i>(<i>t,&#160;X</i>(<i>t</i>))]&#160;=<br/>
(<i>t,&#160;X</i>(<i>t</i>))&#160;+&#160;ˆ<br/>
<i>µ</i>(<i>t,&#160;X</i>(<i>t</i>)<i>,&#160;w</i>)<i>,&#160;Dxu</i>(<i>t,&#160;X</i>(<i>t</i>))&#160;<i>.</i><br/>
<i>Dt</i><br/>
<i>∂t</i><br/>
<i>∂t</i><br/>
<i>Du</i><br/>
Ignoring&#160;boundary&#160;conditions,&#160;we&#160;substitute<br/>
into&#160;(1.1)&#160;to&#160;get<br/>
<i>Dt</i><br/>
&#160;<br/>
(&#160;<i>Duw</i><br/>
)<br/>
!<br/>
max<br/>
sup<br/>
+&#160;ˆ<br/>
Ł<i>u&#160;</i>−&#160;<i>ρu&#160;</i>+&#160;<i>f&#160;w</i><br/>
<i>,&#160;</i>M<i>u&#160;</i>−&#160;<i>u</i><br/>
=&#160;0<i>.</i><br/>
<i>w</i>∈<i>W</i><br/>
<i>Dt</i><br/>
14<br/>
<hr/>
<a name=15></a>A&#160;discretization&#160;of&#160;the&#160;above&#160;is<br/>
<br/>
<br/>
<br/>
<br/>
h<br/>
max<br/>
max<br/>
<i>un</i>+1&#160;q<i>xi&#160;</i>+&#160;ˆ<br/>
<i>µn</i>(<i>w</i>)∆<i>t</i>y&#160;+&#160;ˆ<br/>
<i>f&#160;n</i>+1(<i>w</i>)∆<i>t&#160;,&#160;</i>M<i>n</i>+1<i>un</i>+1i<br/>
<i>i</i><br/>
<i>i</i><br/>
<i>h</i><br/>
<i>w</i>∈<i>Wh</i><br/>
<i>i</i><br/>
h<br/>
<br/>
−&#160;<i>un&#160;</i>+<br/>
ˆ<br/>
Ł<i>nun</i>i&#160;−&#160;<i>ρun&#160;</i>+&#160;ˆ<br/>
<i>f&#160;n&#160;</i>∆<i>t&#160;</i>=&#160;0<i>.</i><br/>
<i>i</i><br/>
<i>h</i><br/>
<i>i</i><br/>
<i>i</i><br/>
<i>i</i><br/>
It&#160;is&#160;understood&#160;that&#160;controls&#160;<i>w&#160;</i>that&#160;cause&#160;<i>xi&#160;</i>+&#160;ˆ<br/>
<i>µn</i>(<i>w</i>)∆<i>t&#160;</i>to&#160;exit&#160;the&#160;numerical&#160;grid&#160;are&#160;not<br/>
<i>i</i><br/>
considered&#160;at&#160;node&#160;<i>i</i>.&#160;Consistency&#160;of&#160;this&#160;scheme&#160;(subject&#160;to&#160;some&#160;mild&#160;assumptions)&#160;can&#160;be<br/>shown&#160;similarly&#160;to&#160;[12,&#160;Lemma&#160;6.6].<br/>
In&#160;lieu&#160;of&#160;(A1),&#160;we&#160;assume:<br/>
(A10)&#160;−ˆ<br/>
Ł<i>n&#160;</i>is&#160;a&#160;WDD&#160;Z-matrix&#160;with&#160;nonnegative&#160;diagonals.<br/>
<i>h</i><br/>
Let&#160;<i>~</i><br/>
<i>x&#160;</i>denote&#160;a&#160;vector&#160;with&#160;components&#160;<i>xi</i>.&#160;Including&#160;boundary&#160;conditions,&#160;this&#160;is&#160;put&#160;in&#160;the<br/>
form&#160;(2.1)&#160;by&#160;taking<br/>
<br/>
<br/>
<i>A&#160;</i>:=&#160;<i>I&#160;</i>+&#160;Φ&#160;<i>ρI&#160;</i>−&#160;ˆ<br/>
Ł<i>n&#160;</i>∆<i>t</i>;<br/>
<i>h</i><br/>
<br/>
<br/>
<br/>
<i>b</i>(<i>P&#160;</i>)&#160;:=&#160;Φ<br/>
ˆ<br/>
<i>f&#160;n</i>∆<i>t&#160;</i>+&#160;(<i>I&#160;</i>−&#160;Ψ)&#160;<i>un</i>+1&#160;q<i>~</i><br/>
<i>x&#160;</i>+&#160;ˆ<br/>
<i>µn</i>(<i>w</i>)∆<i>t</i>y&#160;+&#160;ˆ<br/>
<i>f&#160;n</i>+1(<i>w</i>)∆<i>t</i><br/>
<br/>
<br/>
+&#160;(<i>I&#160;</i>−&#160;Φ)&#160;<i>gn&#160;</i>+&#160;Ψ&#160;<i>Bn</i>+1(<i>z</i>)<i>un</i>+1&#160;+&#160;<i>Kn</i>+1(<i>z</i>)&#160;<i>.</i><br/>
Since&#160;<i>A&#160;</i>is&#160;independent&#160;of&#160;<i>P&#160;</i>,&#160;(2.1)&#160;becomes&#160;<i>Av&#160;</i>=&#160;max<i>P&#160;</i>∈P{<i>b</i>(<i>P&#160;</i>)};&#160;no&#160;iterative&#160;method&#160;is<br/>required.&#160;<i>A&#160;</i>is&#160;nonsingular&#160;since&#160;it&#160;is&#160;SDD&#160;(by&#160;virtue&#160;of&#160;(A10)&#160;and&#160;(A3)).<br/>
<b>6</b><br/>
<b>Examples</b><br/>
The&#160;remainder&#160;of&#160;this&#160;work&#160;focuses&#160;on&#160;numerical&#160;examples.<br/>
<b>6.1</b><br/>
<b>Optimal&#160;combined&#160;control&#160;of&#160;the&#160;exchange&#160;rate</b><br/>
The&#160;following&#160;is&#160;studied&#160;in&#160;[22,&#160;9].&#160;Consider&#160;a&#160;government&#160;able&#160;to&#160;influence&#160;the&#160;foreign<br/>
exchange&#160;(FEX)&#160;rate&#160;of&#160;its&#160;currency&#160;by:<br/>
•&#160;choosing&#160;the&#160;domestic&#160;interest&#160;rate&#160;<b>(stochastic&#160;control)</b>;<br/>
•&#160;buying&#160;or&#160;selling&#160;foreign&#160;currency&#160;<b>(impulse&#160;control)</b>.<br/>
Let&#160;(<i>rt</i>)<i>t</i>≥0&#160;denote&#160;the&#160;domestic&#160;interest&#160;rate&#160;process&#160;and&#160;<i>r&#160;</i>the&#160;foreign&#160;interest&#160;rate.&#160;At&#160;any<br/>point&#160;in&#160;time,&#160;the&#160;government&#160;can&#160;buy&#160;(<i>z&#160;&gt;&#160;</i>0)&#160;or&#160;sell&#160;(<i>z&#160;&lt;&#160;</i>0)&#160;foreign&#160;currency&#160;to&#160;influence<br/>the&#160;FEX&#160;market.&#160;(<i>Xt</i>)<i>t</i>≥0,&#160;the&#160;log&#160;of&#160;the&#160;FEX&#160;rate,&#160;follows<br/>
<i>dXt&#160;</i>=&#160;−<i>a&#160;</i>(<i>rt&#160;</i>−&#160;<i>r</i>)&#160;<i>dt&#160;</i>+&#160;<i>σd</i>W<i>t</i><br/>
if&#160;<i>τj&#160;&lt;&#160;t&#160;&lt;&#160;τj</i>+1<br/>
(stochastic&#160;control);<br/>
<i>Xτ</i><br/>
=&#160;<i>X</i><br/>
(impulse&#160;control)<i>.</i><br/>
<i>j</i>+1<br/>
<i>τj</i>+1−&#160;+&#160;<i>zτj</i>+1<br/>
(W<i>t</i>)<i>t</i>≥0&#160;is&#160;a&#160;standard&#160;Brownian&#160;motion.&#160;<i>a&#160;&gt;&#160;</i>0&#160;parameterizes&#160;the&#160;effect&#160;of&#160;the&#160;interest&#160;rate<br/>
differential,&#160;<i>wt&#160;</i>:=&#160;<i>rt&#160;</i>−&#160;<i>r</i>,&#160;on&#160;the&#160;FEX&#160;rate.<br/>
15<br/>
<hr/>
<a name=16></a>Parameter<br/>
Value<br/>
Discount&#160;factor<br/>
<i>ρ</i><br/>
2%<br/>
per&#160;annum<br/>
Volatility<br/>
<i>σ</i><br/>
30%<br/>
per&#160;annum<br/>
Expiry<br/>
<i>T</i><br/>
10<br/>
years<br/>
Optimal&#160;parity<br/>
<i>x?</i><br/>
0<br/>
Interest&#160;rate&#160;differential<br/>
<i>W</i><br/>
0-7%<br/>
per&#160;annum<br/>
Interest&#160;rate&#160;differential&#160;effect<br/>
<i>a</i><br/>
0.25<br/>
Interest&#160;rate&#160;differential&#160;cost<br/>
<i>b</i><br/>
3<br/>
Scaled&#160;transaction&#160;cost<br/>
<i>λ</i><br/>
1<br/>
Fixed&#160;transaction&#160;cost<br/>
<i>C</i><br/>
0.1<br/>
Table&#160;6.1.1:&#160;Optimal&#160;combined&#160;control&#160;of&#160;the&#160;exchange&#160;rate:&#160;parameters<br/>
Let&#160;<i>θ&#160;</i>:=&#160;(<i>w,&#160;τ</i>1<i>,&#160;τ</i>2<i>,&#160;.&#160;.&#160;.&#160;,&#160;zτ&#160;,&#160;z&#160;,&#160;.&#160;.&#160;.</i>)&#160;where&#160;(i)&#160;(<i>w</i><br/>
1<br/>
<i>τ</i>2<br/>
<i>t</i>)<i>t</i>≥0&#160;is&#160;an&#160;adapted&#160;process,&#160;(ii)&#160;<i>τ</i>1<i>,&#160;τ</i>2<i>,&#160;.&#160;.&#160;.</i><br/>
are&#160;stopping&#160;times&#160;with&#160;0&#160;=:&#160;<i>τ</i>0&#160;≤&#160;<i>τ</i>1&#160;≤&#160;<i>τ</i>2&#160;≤&#160;<i>.&#160;.&#160;.&#160;</i>≤&#160;<i>T&#160;</i>,&#160;and&#160;(iii)&#160;<i>zτ&#160;</i>is&#160;a&#160;<i>τ</i><br/>
<i>k</i><br/>
<i>k&#160;</i>-measurable&#160;random<br/>
variable&#160;taking&#160;values&#160;from&#160;some&#160;set&#160;<i>Z</i>(<i>τk,&#160;Xτ&#160;</i>).&#160;Any&#160;such&#160;<i>θ&#160;</i>satisfying&#160;these&#160;properties&#160;is<br/>
<i>k</i><br/>
referred&#160;to&#160;as&#160;a&#160;<i>combined&#160;control</i>.<br/>
A&#160;combined&#160;control&#160;is&#160;<i>admissible&#160;</i>if&#160;at&#160;all&#160;times&#160;<i>t</i>,&#160;<i>w</i>min&#160;≤&#160;<i>wt&#160;</i>≤&#160;<i>w</i>max&#160;(alternatively,&#160;we<br/>
could&#160;impose&#160;this&#160;up&#160;to&#160;null&#160;sets).&#160;Let&#160;Θ&#160;denote&#160;the&#160;set&#160;of&#160;all&#160;admissible&#160;controls.&#160;The<br/>optimal&#160;cost&#160;at&#160;time&#160;<i>t&#160;</i>when&#160;<i>Xt&#160;</i>=&#160;<i>x&#160;</i>is&#160;given&#160;by<br/>
<br/>
<br/>
Z<br/>
<i>T</i><br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<i>u</i>(<i>t,&#160;x</i>)&#160;:=&#160;<i>eρt&#160;</i>sup&#160;(<i>t,x</i>)<br/>
E<br/>
−<br/>
<br/>
&#160;+<br/>
<br/>
<i>e</i>−<i>ρs&#160;</i><i>p</i>(<i>Xs</i>)&#160;+&#160;<i>bw</i>2&#160;<i>ds&#160;</i>−&#160;X&#160;<i>e</i>−<i>ρτj&#160;λ&#160;z</i><br/>
<i>C</i><br/>
<i>s</i><br/>
&#160;<i>.</i><br/>
(6.1)<br/>
<br/>
<i>τj&#160;</i><br/>
<i>θ</i>∈Θ<br/>
<i>t</i><br/>
<i>τj&#160;</i>≤<i>T</i><br/>
The&#160;cost&#160;of&#160;the&#160;distance&#160;of&#160;the&#160;FEX&#160;rate&#160;to&#160;the&#160;optimal&#160;parity&#160;<i>x?&#160;</i>is&#160;parameterized&#160;by&#160;the<br/>
function&#160;<i>p</i>.&#160;We&#160;take&#160;<i>p</i>(<i>x</i>)&#160;:=&#160;(max(<i>x&#160;</i>−&#160;<i>x?,&#160;</i>0))2.&#160;The&#160;constant&#160;<i>b&#160;</i>≥&#160;0&#160;parameterizes&#160;the&#160;cost<br/>associated&#160;with&#160;a&#160;nonzero&#160;interest&#160;rate&#160;differential.&#160;<i>λ&#160;</i>≥&#160;0&#160;and&#160;<i>C&#160;&gt;&#160;</i>0&#160;parameterize&#160;the&#160;cost&#160;of<br/>an&#160;impulse.&#160;<i>ρ&#160;</i>≥&#160;0&#160;is&#160;a&#160;discount&#160;factor.<br/>
It&#160;is&#160;well-known&#160;[6]&#160;that&#160;the&#160;dynamic&#160;programming&#160;equation&#160;associated&#160;to&#160;(6.1)&#160;is&#160;the<br/>
HJBQVI&#160;on&#160;Ω&#160;:=&#160;R&#160;and&#160;Λ&#160;:=&#160;∅&#160;given&#160;by&#160;(1.1)&#160;with&#160;<i>g</i>(<i>T,&#160;x</i>)&#160;:=&#160;0&#160;and<br/>
<i>W&#160;</i>:=&#160;[<i>w</i>min<i>,&#160;w</i>max];<br/>
<i>Z</i>(<i>t,&#160;x</i>)&#160;:=&#160;R;<br/>
<i>∂u</i><br/>
1<br/>
<i>∂</i>2<i>u</i><br/>
Ł(<i>t,&#160;x,&#160;w</i>)&#160;:=&#160;−<i>aw</i><br/>
+<br/>
<i>σ</i>2<br/>
;<br/>
Γ(<i>t,&#160;x,&#160;z</i>)&#160;:=&#160;<i>z</i>;<br/>
<i>∂x</i><br/>
2<br/>
<i>∂x</i>2<br/>
<i>f&#160;</i>(<i>t,&#160;x,&#160;w</i>)&#160;:=&#160;−<i>p</i>(<i>x</i>)&#160;−&#160;<i>bw</i>2;<br/>
<i>K</i>(<i>t,&#160;x,&#160;z</i>)&#160;:=&#160;−<i>λ</i>|<i>z</i>|&#160;−&#160;<i>C.</i><br/>
<b>6.1.1</b><br/>
<b>Convergence&#160;of&#160;the&#160;direct&#160;control&#160;scheme</b><br/>
Discretization&#160;requires&#160;that&#160;we&#160;truncate&#160;[0<i>,&#160;T&#160;</i>]&#160;×&#160;R&#160;to&#160;[0<i>,&#160;T&#160;</i>]&#160;×&#160;[<i>x</i>1<i>,&#160;xM&#160;</i>]&#160;and&#160;<i>Z</i>(<i>t,&#160;x</i>)&#160;=&#160;R&#160;to<br/>[<i>x</i>1<i>,&#160;xM&#160;</i>]&#160;−&#160;<i>x&#160;</i>so&#160;that&#160;the&#160;exchange&#160;rate&#160;after&#160;an&#160;impulse,&#160;<i>x&#160;</i>+&#160;Γ(<i>t,&#160;x,&#160;z</i>)&#160;=&#160;<i>x&#160;</i>+&#160;<i>z</i>,&#160;remains&#160;in&#160;the<br/>computational&#160;domain.&#160;Let&#160;∆<i>z&#160;&gt;&#160;</i>0&#160;divide&#160;<i>xM&#160;</i>−&#160;<i>x</i>1.&#160;A&#160;discretization&#160;of&#160;the&#160;truncated&#160;<i>Z</i>(<i>t,&#160;x</i>)<br/>is<br/>
(<i>Zn</i>)&#160;:=&#160;{0<i>,&#160;</i>∆<i>z,&#160;</i>2∆<i>z,&#160;.&#160;.&#160;.&#160;,&#160;x</i><br/>
<i>h&#160;i</i><br/>
<i>M&#160;</i>−&#160;<i>x</i>1}&#160;+&#160;(<i>x</i>1&#160;−&#160;<i>xi</i>)&#160;<i>.</i><br/>
An&#160;artificial&#160;Neumann&#160;boundary&#160;condition&#160;<i>∂u/∂x&#160;</i>=&#160;0&#160;is&#160;used&#160;at&#160;<i>x</i>1&#160;and&#160;<i>xM&#160;</i>so&#160;that&#160;the<br/>
first&#160;and&#160;last&#160;rows&#160;of&#160;Ł<i>n</i>(<i>w</i>)&#160;are&#160;zero.&#160;In&#160;particular,&#160;we&#160;assume&#160;an&#160;upwind&#160;three-point&#160;stencil<br/>
<i>h</i><br/>
16<br/>
<hr/>
<a name=17></a>)<br/>(w&#160;0.06<br/>
0.0<br/>
))<br/>
0.05<br/>
T<br/>
0,x&#160;−0.5<br/>
=<br/>
=<br/>
2<br/>
0.04<br/>
differential<br/>
(t<br/>
T<br/>
Impulse<br/>
−1.0<br/>
(u<br/>
=<br/>
0.03<br/>
rate<br/>
10<br/>
−1.5<br/>
cost<br/>
T&#160;=<br/>
0.02<br/>
32<br/>
T<br/>
interest<br/>
−2.0<br/>
=<br/>
0.01<br/>
Optimal<br/>
∞<br/>
x&#160;=&#160;η<br/>
−2.5<br/>
0<br/>
x&#160;=&#160;η<br/>
0.00<br/>
−3.0<br/>
−2.5<br/>
−2.0<br/>
−1.5<br/>
−1.0<br/>
−0.5<br/>
0.0<br/>
0.5<br/>
1.0<br/>
Optimal<br/>
−3.0<br/>
−2.5<br/>
−2.0<br/>
−1.5<br/>
−1.0<br/>
−0.5<br/>
0.0<br/>
0.5<br/>
1.0<br/>
Log-transformed&#160;FEX&#160;rate&#160;(x)<br/>
Log-transformed&#160;FEX&#160;rate&#160;(x)<br/>
(a)&#160;Optimal&#160;control&#160;(<i>T&#160;</i>=&#160;10)<br/>
(b)&#160;Values&#160;for&#160;several&#160;times-to-expiry<br/>
Figure&#160;6.1.1:&#160;Optimal&#160;combined&#160;control&#160;of&#160;the&#160;exchange&#160;rate&#160;at&#160;initial&#160;time<br/>
[15,&#160;Appendix&#160;C]&#160;so&#160;that<br/>
<br/>
0<br/>
if&#160;<i>i&#160;</i>=&#160;1&#160;or&#160;<i>i&#160;</i>=&#160;<i>M</i><br/>
[Ł<i>n</i>(<i>w</i>)<i>v</i>]&#160;:=<br/>
<i>h</i><br/>
<i>i</i><br/>
(<i>vi</i>−1&#160;−&#160;<i>vi</i>)&#160;<i>αn</i>(<i>w</i>)&#160;+&#160;(<i>v</i><br/>
(<i>w</i>)<br/>
otherwise<br/>
<i>i</i><br/>
<i>i</i>+1&#160;−&#160;<i>vi</i>)&#160;<i>βn</i><br/>
<i>i</i><br/>
where&#160;<i>αn</i>(<i>w</i>)&#160;and&#160;<i>βn</i>(<i>w</i>)&#160;are&#160;nonnegative&#160;constants&#160;arising&#160;from&#160;the&#160;discretization.<br/>
<i>i</i><br/>
<i>i</i><br/>
The&#160;direct&#160;control&#160;problem&#160;is&#160;given&#160;by&#160;(4.3)&#160;subject&#160;to&#160;(5.1)&#160;and&#160;(5.2).&#160;It&#160;is&#160;easy&#160;to<br/>
verify&#160;that<br/>
2<br/>
B&#160;<i>x&#160;&lt;&#160;</i>B<i>x&#160;</i>for&#160;all&#160;<i>x&#160;</i>so&#160;that&#160;(H4)&#160;is&#160;satisfied&#160;(recall&#160;B&#160;=&#160;M<i>n</i>).&#160;By&#160;Theorem&#160;4.8,<br/>
<i>h</i><br/>
solutions&#160;to&#160;the&#160;problem&#160;are&#160;unique.&#160;However,&#160;policy&#160;iteration&#160;may&#160;fail&#160;since&#160;(H2)&#160;is&#160;not<br/>satisfied.&#160;A&#160;trivial&#160;example&#160;violating&#160;(H2)&#160;is&#160;that&#160;of&#160;a&#160;cycle&#160;between&#160;two&#160;nodes&#160;<i>xi&#160;</i>6=&#160;<i>xj&#160;</i>(e.g.<br/><i>xi&#160;</i>+&#160;Γ(<i>t,&#160;xi,&#160;xj&#160;</i>−&#160;<i>xi</i>)&#160;=&#160;<i>xj&#160;</i>and&#160;<i>xj&#160;</i>+&#160;Γ(<i>t,&#160;xj,&#160;xi&#160;</i>−&#160;<i>xj</i>)&#160;=&#160;<i>xi</i>).<br/>
We&#160;perform&#160;policy&#160;iteration&#160;on&#160;a&#160;modified&#160;problem&#160;with&#160;control&#160;set&#160;P0&#160;(&#160;P&#160;consisting&#160;of<br/>
all&#160;controls&#160;<i>P&#160;</i>:=&#160;(<i>w,&#160;z,&#160;ψ</i>)&#160;in&#160;P&#160;satisfying<br/>
<i>ψ</i>1&#160;=&#160;0&#160;and&#160;<i>zi&#160;&lt;&#160;</i>0&#160;for&#160;all&#160;<i>i&#160;&gt;&#160;</i>1<br/>
so&#160;that&#160;(H2)0&#160;holds.&#160;If&#160;<i>un</i>+1&#160;is&#160;nonincreasing&#160;(i.e.&#160;<i>un</i>+1&#160;≥&#160;<i>un</i>+1),&#160;we&#160;can&#160;use&#160;the&#160;same<br/>
<i>i</i>−1<br/>
<i>i</i><br/>
arguments&#160;as&#160;in&#160;Example&#160;4.11&#160;to&#160;establish&#160;that&#160;the&#160;solution&#160;<i>v&#160;</i>=&#160;<i>un&#160;</i>of&#160;the&#160;modified&#160;problem<br/>solves&#160;the&#160;original&#160;problem&#160;(i.e.&#160;(4.7)&#160;is&#160;satisfied)&#160;and&#160;is&#160;nonincreasing.&#160;Since&#160;<i>uN&#160;</i>=&#160;0&#160;is<br/>nonincreasing,&#160;induction&#160;yields&#160;convergence&#160;of&#160;the&#160;scheme&#160;at&#160;each&#160;timestep.<br/>
<b>Remark&#160;6.1.&#160;</b><i>The&#160;condition&#160;zi&#160;&lt;&#160;</i>0&#160;<i>appeals&#160;to&#160;intuition:&#160;the&#160;domestic&#160;government&#160;should</i><br/>
<i>never&#160;perform&#160;an&#160;impulse&#160;that&#160;weakens&#160;the&#160;domestic&#160;currency&#160;(i.e.&#160;zi&#160;</i>≥&#160;0<i>).</i><br/>
<b>6.1.2</b><br/>
<b>Optimal&#160;control</b><br/>
If&#160;the&#160;currency&#160;is&#160;sufficiently&#160;weak,&#160;the&#160;government&#160;intervenes&#160;in&#160;the&#160;FEX&#160;market.&#160;That&#160;is,<br/>at&#160;time&#160;<i>t</i>,&#160;the&#160;impulse&#160;occurs&#160;only&#160;on&#160;[<i>η</i>(<i>t</i>)<i>,&#160;</i>∞)&#160;for&#160;some&#160;<i>η</i>(<i>t</i>)&#160;(the&#160;region&#160;(−∞<i>,&#160;η</i>(<i>t</i>))&#160;on&#160;which<br/>the&#160;impulse&#160;is&#160;not&#160;applied&#160;is&#160;referred&#160;to&#160;as&#160;the&#160;<i>continuation&#160;region</i>,&#160;corresponding&#160;to&#160;nodes&#160;<i>i</i><br/>
with&#160;<i>ψi&#160;</i>=&#160;0&#160;in&#160;the&#160;numerical&#160;solution).&#160;When&#160;the&#160;FEX&#160;rate&#160;at&#160;time&#160;<i>t&#160;</i>enters&#160;[<i>η</i>(<i>t</i>)<i>,&#160;</i>∞),&#160;the<br/>
government&#160;intervenes&#160;to&#160;bring&#160;it&#160;back&#160;to&#160;<i>η</i>0(<i>t</i>)&#160;<i>&lt;&#160;η</i>(<i>t</i>).&#160;This&#160;phenomenon&#160;is&#160;shown&#160;in&#160;Figure<br/>6.1.1a.&#160;The&#160;optimal&#160;cost&#160;<i>u&#160;</i>for&#160;varying&#160;expiry&#160;times&#160;<i>T&#160;</i>is&#160;shown&#160;in&#160;Figure&#160;6.1.1b.<br/>
17<br/>
<hr/>
<a name=18></a><i>h</i><br/>
<i>x&#160;</i>nodes<br/>
<i>w&#160;</i>nodes<br/>
<i>z&#160;</i>nodes<br/>
Timesteps<br/>
1<br/>
32<br/>
8<br/>
16<br/>
16<br/>
1/2<br/>
64<br/>
16<br/>
32<br/>
32<br/>
..<br/>
.<br/>
.<br/>
.<br/>
.<br/>
.<br/>
..<br/>
..<br/>
..<br/>
..<br/>
Table&#160;6.1.2:&#160;Optimal&#160;combined&#160;control&#160;of&#160;the&#160;exchange&#160;rate:&#160;numerical&#160;grid<br/>
<b>6.1.3</b><br/>
<b>Convergence&#160;tests</b><br/>
Convergence&#160;tests&#160;are&#160;shown&#160;in&#160;Table&#160;6.1.3.&#160;Times&#160;are&#160;normalized&#160;to&#160;the&#160;fastest&#160;semi-<br/>Lagrangian&#160;solve.&#160;The&#160;ratio&#160;of&#160;successive&#160;changes&#160;in&#160;the&#160;solution&#160;(at&#160;a&#160;point)&#160;is&#160;reported.<br/>
BiCGSTAB&#160;with&#160;an&#160;ILUT&#160;preconditioner&#160;is&#160;used&#160;for&#160;the&#160;Solve&#160;routine&#160;(line&#160;3&#160;of<br/>
Policy-Iteration)&#160;in&#160;this&#160;and&#160;all&#160;subsequent&#160;sections.&#160;In&#160;the&#160;specific&#160;case&#160;of&#160;the&#160;semi-<br/>Lagrangian&#160;scheme&#160;for&#160;the&#160;exchange&#160;rate&#160;problem,&#160;a&#160;simple&#160;tridiagonal&#160;solve&#160;can&#160;be&#160;used<br/>since&#160;the&#160;problem&#160;is&#160;a&#160;one-dimensional&#160;diffusion.<br/>
Policy-Iteration&#160;is&#160;terminated&#160;upon&#160;achieving&#160;a&#160;desired&#160;error&#160;tolerance:<br/>
<br/>
<br/>
<br/>
<br/>
<i>vk&#160;</i>−&#160;<i>vk</i>−1<br/>
<br/>
<br/>
<i>i</i><br/>
<i>i</i><br/>
<br/>
<br/>
max<br/>
<i>&lt;&#160;</i>tol<i>.</i><br/>
<br/>
<br/>
<br/>
<i>i</i><br/>
&#160;max<br/>
<i>vk</i>&#160;<i>,&#160;</i>scale&#160;<br/>
<br/>
<i>i&#160;</i><br/>
The&#160;scale&#160;parameter&#160;ensures&#160;that&#160;unrealistic&#160;levels&#160;of&#160;accuracy&#160;are&#160;not&#160;imposed&#160;on&#160;the&#160;solution.<br/>We&#160;take&#160;tol&#160;=&#160;10−6&#160;and&#160;scale&#160;=&#160;1&#160;for&#160;this&#160;and&#160;all&#160;future&#160;tests.&#160;The&#160;initial&#160;guess&#160;<i>v</i>0&#160;is&#160;taken&#160;to<br/>
be&#160;the&#160;solution&#160;at&#160;the&#160;previous&#160;timestep,&#160;<i>un</i>+1.<br/>
Following&#160;[16],&#160;we&#160;take&#160;<i>&#160;</i>:=&#160;<i>D</i>∆<i>t&#160;</i>and&#160;<i>δ&#160;</i>:=&#160;1<i>/&#160;</i>with&#160;<i>D&#160;</i>=&#160;10−2.<br/>For&#160;completeness,&#160;we&#160;mention&#160;that&#160;the&#160;obvious&#160;splitting&#160;with&#160;ˆ<br/>
<i>µ</i>(<i>t,&#160;x</i>)&#160;:=&#160;0&#160;and&#160;ˆ<br/>
<i>f&#160;</i>(<i>t,&#160;x</i>)&#160;:=<br/>
−<i>p</i>(<i>x</i>)&#160;is&#160;used&#160;in&#160;the&#160;semi-Lagrangian&#160;scheme.&#160;The&#160;numerical&#160;examples&#160;of&#160;the&#160;sequel&#160;(6.2&#160;and<br/>6.3)&#160;also&#160;use&#160;the&#160;obvious&#160;splittings.<br/>
The&#160;direct&#160;control&#160;and&#160;penalized&#160;schemes&#160;converge&#160;superlinearly.&#160;We&#160;speculate&#160;that<br/>
this&#160;occurs&#160;since&#160;<i>x&#160;</i>7→&#160;<i>u</i>(<i>t,&#160;x</i>)&#160;is&#160;linear&#160;to&#160;the&#160;right&#160;of&#160;<i>x&#160;</i>=&#160;<i>η</i>0(<i>t</i>),&#160;and&#160;hence&#160;no&#160;error&#160;is<br/>made&#160;in&#160;approximating&#160;the&#160;term&#160;<i>Dxu&#160;</i>and&#160;<i>D</i>2<i>u&#160;</i>there.&#160;Assuming&#160;the&#160;solution&#160;<i>un</i>+1&#160;of&#160;the<br/>
<i>x</i><br/>
semi-Lagrangian&#160;scheme&#160;is&#160;linear&#160;to&#160;the&#160;right&#160;of&#160;<i>η</i>0(<i>tn</i>+1),&#160;error&#160;is&#160;introduced&#160;due&#160;to&#160;the<br/>approximation&#160;of&#160;<i>η</i>0(<i>tn</i>)&#160;by&#160;<i>η</i>0(<i>tn</i>+1).&#160;This&#160;suggests&#160;that&#160;the&#160;direct&#160;control&#160;and&#160;penalized<br/>schemes&#160;may&#160;outperform&#160;the&#160;semi-Lagrangian&#160;scheme&#160;for&#160;problems&#160;with&#160;simple&#160;continuation<br/>regions&#160;and&#160;linear&#160;transaction&#160;costs.<br/>
Unsurprisingly,&#160;the&#160;direct&#160;control&#160;and&#160;penalized&#160;schemes&#160;are&#160;near-identical&#160;in&#160;performance<br/>
and&#160;accuracy&#160;since&#160;the&#160;scaling&#160;and&#160;penalty&#160;factors&#160;are&#160;chosen&#160;identically&#160;(i.e.&#160;<i>δ&#160;</i>=&#160;1<i>/</i>).&#160;We<br/>mention&#160;that&#160;the&#160;choice&#160;of&#160;<i>δ&#160;</i>=&#160;1&#160;(i.e.&#160;no&#160;scaling)&#160;yields&#160;poor&#160;performance&#160;in&#160;the&#160;direct&#160;control<br/>setting&#160;(see&#160;[16]&#160;for&#160;an&#160;explanation).<br/>
Note&#160;that&#160;the&#160;average&#160;number&#160;of&#160;BiCGSTAB&#160;iterations&#160;per&#160;call&#160;to&#160;Solve&#160;can&#160;be&#160;less<br/>
than&#160;one,&#160;suggesting&#160;that&#160;sometimes,&#160;no&#160;BiCGSTAB&#160;iterations&#160;are&#160;required&#160;on&#160;line&#160;3&#160;of<br/>
Policy-Iteration.&#160;This&#160;occurs&#160;when&#160;the&#160;initial&#160;residual,&#160;<i>b</i>(<i>P&#160;`</i>)−<i>A</i>(<i>P&#160;`</i>)<i>v`</i>−1,&#160;is&#160;small&#160;enough<br/>in&#160;magnitude&#160;(i.e.&#160;at&#160;the&#160;last&#160;policy&#160;iteration&#160;before&#160;convergence).<br/>
18<br/>
<hr/>
<a name=19></a><i>h</i><br/>
<i>u</i>(<i>t&#160;</i>=&#160;0<i>,&#160;x&#160;</i>=&#160;0)<br/>
Avg.&#160;policy&#160;its.<br/>
Avg.&#160;BiCGSTAB&#160;its.<br/>
Ratio<br/>
Norm.&#160;time<br/>
1<br/>
-0.60685256<br/>
3.13<br/>
0.74<br/>
1.32e+01<br/>
1/2<br/>
-0.61187228<br/>
2.88<br/>
0.90<br/>
6.99e+01<br/>
1/4<br/>
-0.61300925<br/>
2.58<br/>
0.93<br/>
4.42<br/>
3.98e+02<br/>
1/8<br/>
-0.61317577<br/>
2.49<br/>
0.94<br/>
6.83<br/>
2.77e+03<br/>
1/16<br/>
-0.61321292<br/>
2.48<br/>
0.95<br/>
4.48<br/>
2.09e+04<br/>
1/32<br/>
-0.61321903<br/>
2.46<br/>
0.95<br/>
6.08<br/>
1.61e+05<br/>
(a)&#160;Direct&#160;control<br/>
<i>h</i><br/>
<i>u</i>(<i>t&#160;</i>=&#160;0<i>,&#160;x&#160;</i>=&#160;0)<br/>
Avg.&#160;policy&#160;its.<br/>
Avg.&#160;BiCGSTAB&#160;its.<br/>
Ratio<br/>
Norm.&#160;time<br/>
1<br/>
-0.60717652<br/>
3.19<br/>
0.71<br/>
1.38e+01<br/>
1/2<br/>
-0.61194960<br/>
2.88<br/>
0.76<br/>
6.96e+01<br/>
1/4<br/>
-0.61302973<br/>
2.55<br/>
0.91<br/>
4.42<br/>
3.95e+02<br/>
1/8<br/>
-0.61317966<br/>
2.48<br/>
1.28<br/>
7.20<br/>
2.76e+03<br/>
1/16<br/>
-0.61321390<br/>
2.48<br/>
1.33<br/>
4.38<br/>
2.09e+04<br/>
1/32<br/>
-0.61321928<br/>
2.46<br/>
0.99<br/>
6.36<br/>
1.61e+05<br/>
(b)&#160;Penalized<br/>
<i>h</i><br/>
<i>u</i>(<i>t&#160;</i>=&#160;0<i>,&#160;x&#160;</i>=&#160;0)<br/>
Ratio<br/>
Norm.&#160;time<br/>
1<br/>
-0.69277804<br/>
1.00e+00<br/>
1/2<br/>
-0.64806716<br/>
6.49e+00<br/>
1/4<br/>
-0.62865965<br/>
2.30<br/>
4.90e+01<br/>
1/8<br/>
-0.62027822<br/>
2.32<br/>
3.86e+02<br/>
1/16<br/>
-0.61653511<br/>
2.24<br/>
3.17e+03<br/>
1/32<br/>
-0.61480123<br/>
2.16<br/>
2.64e+04<br/>
1/64<br/>
-0.61398311<br/>
2.12<br/>
2.17e+05<br/>
(c)&#160;Semi-Lagrangian<br/>
Table&#160;6.1.3:&#160;Optimal&#160;combined&#160;control&#160;of&#160;the&#160;exchange&#160;rate:&#160;convergence&#160;tests<br/>
19<br/>
<hr/>
<a name=20></a><b>6.2</b><br/>
<b>Optimal&#160;consumption&#160;and&#160;portfolio&#160;with&#160;both&#160;fixed&#160;and&#160;pro-<br/>portional&#160;transaction&#160;costs</b><br/>
The&#160;following&#160;is&#160;studied&#160;in&#160;[11].&#160;Consider&#160;an&#160;investor&#160;that,&#160;at&#160;any&#160;point&#160;in&#160;time,&#160;has&#160;two<br/>
investment&#160;opportunities:&#160;a&#160;stock&#160;and&#160;a&#160;bank&#160;account.&#160;Let&#160;(<i>St</i>)<i>t</i>≥0&#160;and&#160;(<i>Bt</i>)<i>t</i>≥0&#160;denote&#160;the<br/>amount&#160;of&#160;money&#160;invested&#160;in&#160;these&#160;two,&#160;respectively.&#160;The&#160;investor&#160;is&#160;able&#160;to<br/>
•&#160;consume&#160;continuously&#160;<b>(stochastic&#160;control)</b>;<br/>
•&#160;transfer&#160;money&#160;from&#160;the&#160;bank&#160;to&#160;the&#160;stock&#160;(or&#160;vice&#160;versa)&#160;subject&#160;to&#160;a&#160;transaction&#160;cost<br/>
<b>(impulse&#160;control)</b>.<br/>
Denote&#160;by&#160;(<i>wt</i>)<i>t</i>≥0&#160;the&#160;consumption&#160;rate&#160;with&#160;0&#160;≤&#160;<i>wt&#160;</i>≤&#160;<i>w</i>max.&#160;At&#160;any&#160;point&#160;in&#160;time,&#160;the<br/>
investor&#160;can&#160;move&#160;money&#160;to&#160;(<i>z&#160;&gt;&#160;</i>0)&#160;or&#160;from&#160;(<i>z&#160;&lt;&#160;</i>0)&#160;the&#160;stock&#160;incurring&#160;a&#160;transaction&#160;cost&#160;of<br/><i>λ</i>|<i>z</i>|&#160;+&#160;<i>C&#160;</i>where&#160;<i>C&#160;&gt;&#160;</i>0&#160;and&#160;0&#160;≤&#160;<i>λ&#160;&lt;&#160;</i>1.&#160;This&#160;is&#160;captured&#160;by<br/>
<i>dSt&#160;</i>=&#160;<i>µStdt&#160;</i>+&#160;<i>ξStd</i>W<i>t</i><br/>
if&#160;<i>τj&#160;&lt;&#160;t&#160;&lt;&#160;τj</i>+1<br/>
(stochastic&#160;control);<br/>
<i>dBt&#160;</i>=&#160;(<i>rBt&#160;</i>−&#160;<i>wt</i>)&#160;<i>dt</i><br/>
if&#160;<i>τj&#160;&lt;&#160;t&#160;&lt;&#160;τj</i>+1<br/>
(stochastic&#160;control);<br/>
<i>Sτ</i><br/>
=&#160;<i>S</i><br/>
(impulse&#160;control);<br/>
<i>j</i>+1<br/>
<i>τj</i>+1−&#160;+&#160;<i>zτj</i>+1<br/>
<br/>
<br/>
<i>B</i><br/>
<br/>
<br/>
<i>τ</i><br/>
=&#160;<i>B</i><br/>
−&#160;<i>λ&#160;z</i><br/>
−&#160;<i>C</i><br/>
(impulse&#160;control)<i>.</i><br/>
<i>j</i>+1<br/>
<i>τj</i>+1−&#160;−&#160;<i>zτj</i>+1<br/>
<br/>
<i>τj</i>+1&#160;<br/>
A&#160;combined&#160;control&#160;<i>θ&#160;</i>:=&#160;(<i>w,&#160;τ</i>1<i>,&#160;τ</i>2<i>,&#160;.&#160;.&#160;.&#160;,&#160;zτ&#160;,&#160;z&#160;,&#160;.&#160;.&#160;.</i>)&#160;is&#160;admissible&#160;if&#160;at&#160;all&#160;times,&#160;the&#160;stock<br/>
1<br/>
<i>τ</i>2<br/>
holdings&#160;and&#160;bank&#160;account&#160;are&#160;nonnegative.&#160;Let&#160;Θ&#160;denote&#160;the&#160;set&#160;of&#160;all&#160;admissible&#160;controls.<br/>
The&#160;investor’s&#160;maximal&#160;expected&#160;utility&#160;at&#160;time&#160;<i>t&#160;</i>with&#160;amount&#160;<i>St&#160;</i>=&#160;<i>s&#160;</i>in&#160;the&#160;stock&#160;and<br/>
<i>Bt&#160;</i>=&#160;<i>b&#160;</i>in&#160;the&#160;bank&#160;account&#160;is&#160;given&#160;by<br/>
&#34;<br/>
#<br/>
Z<br/>
<i>T</i><br/>
max&#160;(<i>B</i><br/>
<i>u</i>(<i>t,&#160;s,&#160;b</i>)&#160;:=&#160;<i>eρt&#160;</i>sup&#160;(<i>t,s,b</i>)<br/>
<i>T&#160;</i>+&#160;(1&#160;−&#160;<i>λ</i>)&#160;<i>ST&#160;</i>−&#160;<i>C,&#160;</i>0)<i>γ</i><br/>
E<br/>
<i>e</i>−<i>ρt</i>0&#160;<i>wγt</i>0&#160;<i>dt</i>0&#160;+&#160;<i>e</i>−<i>ρT</i><br/>
<i>θ</i>∈Θ<br/>
<i>t</i><br/>
<i>γ</i><br/>
<i>γ</i><br/>
where&#160;0&#160;≤&#160;1&#160;−&#160;<i>γ&#160;&lt;&#160;</i>1&#160;is&#160;the&#160;investor’s&#160;relative&#160;risk-aversion&#160;and&#160;<i>ρ&#160;</i>≥&#160;0&#160;is&#160;the&#160;rate&#160;of&#160;time<br/>
preference.&#160;The&#160;utility&#160;received&#160;at&#160;the&#160;expiry&#160;corresponds&#160;to&#160;liquidating&#160;the&#160;asset&#160;and<br/>consuming&#160;everything&#160;instantaneously.<br/>
The&#160;associated&#160;HJBQVI&#160;on&#160;Ω&#160;:=&#160;(0<i>,&#160;</i>∞)2&#160;and&#160;Λ&#160;:=&#160;∅&#160;is&#160;given&#160;by&#160;(1.1)&#160;with&#160;<i>g</i>(<i>T,&#160;x</i>)&#160;:=<br/>
max(<i>b&#160;</i>+&#160;(1&#160;−&#160;<i>λ</i>)<i>s&#160;</i>−&#160;<i>C,&#160;</i>0)<i>γ/γ&#160;</i>and<br/>
<i>W&#160;</i>:=&#160;[0<i>,&#160;w</i>max]&#160;;<br/>
<i>Z</i>(<i>t,&#160;x</i>)&#160;:=&#160;{<i>z&#160;</i>:&#160;<i>x&#160;</i>+&#160;Γ(<i>t,&#160;x,&#160;z</i>)&#160;≥&#160;0}&#160;;<br/>
<br/>
1<br/>
<i>∂</i>2<br/>
<i>∂</i><br/>
(<i>rb&#160;</i>−&#160;<i>w</i>)&#160;<i>∂</i><br/>
if&#160;<i>b&#160;&gt;&#160;</i>0;<br/>
Ł<i>w&#160;</i>:=<br/>
<i>ξ</i>2<i>s</i>2<br/>
+&#160;<i>µs</i><br/>
+<br/>
<i>∂b</i><br/>
Γ(<i>t,&#160;x,&#160;z</i>)&#160;:=&#160;(<i>z,&#160;</i>−<i>z&#160;</i>−&#160;<i>λ</i>|<i>z</i>|&#160;−&#160;<i>C</i>);<br/>
2<br/>
<i>∂s</i>2<br/>
<i>∂s</i><br/>
0<br/>
otherwise;<br/>
<br/>
<i>wγ&#160;/γ</i><br/>
if&#160;<i>b&#160;&gt;&#160;</i>0;<br/>
<i>f&#160;w&#160;</i>:=<br/>
<i>K</i>(<i>t,&#160;x,&#160;z</i>)&#160;:=&#160;0<i>.</i><br/>
0<br/>
otherwise;<br/>
In&#160;the&#160;above,&#160;expressions&#160;such&#160;as&#160;<i>s&#160;</i>·&#160;<i>∂/∂s&#160;</i>are&#160;to&#160;be&#160;interpreted&#160;as&#160;identically&#160;zero&#160;when&#160;<i>s&#160;</i>=&#160;0.<br/>
The&#160;convention&#160;[<i>q</i>1<i>,&#160;q</i>2]&#160;=&#160;∅&#160;if&#160;<i>q</i>1&#160;<i>&gt;&#160;q</i>2&#160;is&#160;used.<br/>
20<br/>
<hr/>
<a name=21></a>Parameter<br/>
Value<br/>
Discount&#160;factor<br/>
<i>ρ</i><br/>
10%<br/>
per&#160;annum<br/>
Interest&#160;rate<br/>
<i>r</i><br/>
7%<br/>
per&#160;annum<br/>
Drift<br/>
<i>µ</i><br/>
11%<br/>
per&#160;annum<br/>
Volatility<br/>
<i>ξ</i><br/>
30%<br/>
per&#160;annum<br/>
Expiry<br/>
<i>T</i><br/>
40<br/>
years<br/>
Relative&#160;risk&#160;aversion<br/>
1&#160;−&#160;<i>γ</i><br/>
0.7<br/>
Scaled&#160;transaction&#160;cost<br/>
<i>λ</i><br/>
0.1<br/>
Fixed&#160;transaction&#160;cost<br/>
<i>C</i><br/>
0.05<br/>
Maximum&#160;withdrawal&#160;rate<br/>
<i>w</i>max<br/>
100<br/>
Initial&#160;stock&#160;value<br/>
<i>s</i>0<br/>
$45.20<br/>
Initial&#160;bank&#160;account&#160;value<br/>
<i>b</i>0<br/>
$45.20<br/>
Table&#160;6.2.1:&#160;Optimal&#160;consumption:&#160;parameters&#160;from&#160;[11]<br/>
<b>6.2.1</b><br/>
<b>Convergence&#160;of&#160;the&#160;direct&#160;control&#160;scheme</b><br/>
As&#160;in&#160;§6.1.1,&#160;the&#160;domain&#160;[0<i>,&#160;T&#160;</i>]&#160;×&#160;[0<i>,&#160;</i>∞)2&#160;and&#160;<i>Z</i>(<i>t,&#160;x</i>)&#160;are&#160;truncated&#160;so&#160;that&#160;the&#160;state&#160;after&#160;an<br/>
impulse&#160;<i>xi&#160;</i>+&#160;Γ(<i>t,&#160;xi,&#160;zi</i>)&#160;remains&#160;in&#160;the&#160;truncated&#160;domain.&#160;We&#160;use&#160;the&#160;notation&#160;<i>xi&#160;</i>=&#160;(<i>si,&#160;bi</i>).<br/>
The&#160;direct&#160;control&#160;problem&#160;is&#160;given&#160;by&#160;(4.3)&#160;subject&#160;to&#160;(5.1)&#160;and&#160;(5.2).<br/>
Suppose&#160;there&#160;exists&#160;a&#160;grid&#160;node&#160;<i>xi</i>1&#160;and&#160;<i>P&#160;</i>:=&#160;(<i>w,&#160;z,&#160;ψ</i>)&#160;such&#160;that&#160;<i>ψi</i>1&#160;=&#160;1&#160;and&#160;that&#160;there<br/>
exists&#160;no&#160;path&#160;in&#160;<i>B</i>(<i>z</i>)&#160;from&#160;<i>i</i>1&#160;to&#160;some&#160;<i>j&#160;</i>with&#160;<i>ψj&#160;</i>=&#160;0.&#160;Since&#160;<i>C&#160;&gt;&#160;</i>0,&#160;there&#160;exists&#160;a&#160;path<br/><i>i</i>1&#160;→&#160;<i>i</i>2&#160;→&#160;·&#160;·&#160;·&#160;of&#160;infinite&#160;length&#160;such&#160;that&#160;<i>si</i>1&#160;+&#160;<i>bi</i>1&#160;<i>&gt;&#160;si</i>2&#160;+&#160;<i>bi</i>2&#160;<i>&gt;&#160;</i>·&#160;·&#160;·&#160;and&#160;<i>ψiq&#160;</i>=&#160;1&#160;for&#160;all&#160;<i>q</i>.<br/>Due&#160;to&#160;the&#160;finitude&#160;of&#160;the&#160;grid,&#160;<i>xiq&#160;</i>=&#160;<i>xi`&#160;</i>(and&#160;hence&#160;<i>siq&#160;</i>+&#160;<i>biq&#160;</i>=&#160;<i>si`&#160;</i>+&#160;<i>bi`</i>)&#160;for&#160;some&#160;<i>q&#160;&lt;&#160;`</i>,&#160;a<br/>contradiction.&#160;It&#160;follows&#160;that&#160;no&#160;such&#160;<i>xi</i>1&#160;exists:&#160;(H2)&#160;is&#160;satisfied.<br/>
<b>6.2.2</b><br/>
<b>Optimal&#160;control</b><br/>
As&#160;in&#160;[11],&#160;three&#160;regions&#160;are&#160;observed&#160;in&#160;an&#160;optimal&#160;control:&#160;the&#160;<i>buy&#160;</i>(B),&#160;<i>sell&#160;</i>(S),&#160;and<br/>
<i>continuation/no&#160;transaction&#160;</i>(NT)&#160;regions.&#160;In&#160;the&#160;B&#160;and&#160;S&#160;regions,&#160;the&#160;controller&#160;intervenes<br/>
by&#160;jumping&#160;back&#160;to&#160;the&#160;closest&#160;of&#160;the&#160;two&#160;lines&#160;marked&#160;∆1&#160;and&#160;∆2.&#160;In&#160;NT,&#160;the&#160;controller<br/>consumes&#160;continuously.<br/>
<b>6.2.3</b><br/>
<b>Convergence&#160;tests</b><br/>
Convergence&#160;tests&#160;are&#160;shown&#160;in&#160;Table&#160;6.2.3.&#160;We&#160;mention&#160;that&#160;artificial&#160;Neumann&#160;boundary<br/>conditions&#160;<i>∂qu/∂sq&#160;</i>=&#160;0&#160;and&#160;<i>∂u/∂b&#160;</i>=&#160;0&#160;are&#160;used&#160;at&#160;the&#160;truncated&#160;boundaries&#160;<i>s&#160;</i>=&#160;<i>s</i>max&#160;and<br/><i>b&#160;</i>=&#160;<i>b</i>max.&#160;The&#160;results&#160;for&#160;the&#160;direct&#160;control&#160;and&#160;penalized&#160;schemes&#160;are&#160;near-identical,&#160;though<br/>the&#160;former&#160;requires&#160;significantly&#160;more&#160;policy&#160;iterations&#160;per&#160;timestep.&#160;The&#160;rate&#160;of&#160;convergence<br/>for&#160;the&#160;semi-Lagrangian&#160;scheme&#160;becomes&#160;sublinear&#160;for&#160;higher&#160;levels&#160;of&#160;refinement.<br/>
<b>6.3</b><br/>
<b>Guaranteed&#160;minimum&#160;withdrawal&#160;benefit&#160;(GMWB)&#160;in&#160;vari-<br/>able&#160;annuities</b><br/>
Guaranteed&#160;minimum&#160;withdrawal&#160;benefits&#160;(GMWB)&#160;in&#160;variable&#160;annuities&#160;provide&#160;investors<br/>
with&#160;the&#160;tax-deferred&#160;nature&#160;of&#160;variable&#160;annuities&#160;along&#160;with&#160;a&#160;guaranteed&#160;minimum&#160;payment.<br/>
GMWB&#160;pricing&#160;has&#160;been&#160;previously&#160;considered&#160;as&#160;a&#160;singular&#160;control&#160;problem&#160;in&#160;[21,&#160;14]&#160;and<br/>
21<br/>
<hr/>
<a name=22></a><i>h</i><br/>
<i>s&#160;</i>nodes<br/>
<i>b&#160;</i>nodes<br/>
<i>w&#160;</i>nodes<br/>
<i>z&#160;</i>nodes<br/>
Timesteps<br/>
1<br/>
20<br/>
20<br/>
15<br/>
15<br/>
32<br/>
1/2<br/>
40<br/>
40<br/>
30<br/>
30<br/>
64<br/>
..<br/>
.<br/>
.<br/>
.<br/>
.<br/>
.<br/>
.<br/>
..<br/>
..<br/>
..<br/>
..<br/>
..<br/>
Table&#160;6.2.2:&#160;Optimal&#160;consumption:&#160;numerical&#160;grid<br/>
<i>h</i><br/>
<i>u</i>(<i>t&#160;</i>=&#160;0<i>,&#160;s</i>0<i>,&#160;b</i>0)<br/>
Avg.&#160;policy&#160;its.<br/>
Avg.&#160;BiCGSTAB&#160;its.<br/>
Ratio<br/>
Norm.&#160;time<br/>
1<br/>
56.062123<br/>
7.63<br/>
1.28<br/>
1.63e+01<br/>
1/2<br/>
58.739224<br/>
8.80<br/>
1.90<br/>
2.93e+02<br/>
1/4<br/>
59.420125<br/>
10.4<br/>
2.28<br/>
3.93<br/>
5.66e+03<br/>
1/8<br/>
59.658413<br/>
11.8<br/>
3.28<br/>
2.86<br/>
1.03e+05<br/>
1/16<br/>
59.754780<br/>
13.3<br/>
4.45<br/>
2.47<br/>
1.85e+06<br/>
1/32<br/>
59.797206<br/>
14.2<br/>
6.54<br/>
2.27<br/>
3.05e+07<br/>
(a)&#160;Direct&#160;control<br/>
<i>h</i><br/>
<i>u</i>(<i>t&#160;</i>=&#160;0<i>,&#160;s</i>0<i>,&#160;b</i>0)<br/>
Avg.&#160;policy&#160;its.<br/>
Avg.&#160;BiCGSTAB&#160;its.<br/>
Ratio<br/>
Norm.&#160;time<br/>
1<br/>
56.058496<br/>
4.09<br/>
1.43<br/>
1.03e+01<br/>
1/2<br/>
58.739041<br/>
3.95<br/>
1.77<br/>
1.47e+02<br/>
1/4<br/>
59.420075<br/>
3.40<br/>
2.35<br/>
3.94<br/>
1.99e+03<br/>
1/8<br/>
59.658399<br/>
3.04<br/>
3.69<br/>
2.86<br/>
2.69e+04<br/>
1/16<br/>
59.754778<br/>
2.80<br/>
5.50<br/>
2.47<br/>
4.02e+05<br/>
1/32<br/>
59.797215<br/>
2.58<br/>
5.98<br/>
2.27<br/>
5.86e+06<br/>
(b)&#160;Penalized<br/>
<i>h</i><br/>
<i>u</i>(<i>t&#160;</i>=&#160;0<i>,&#160;s</i>0<i>,&#160;b</i>0)<br/>
Avg.&#160;BiCGSTAB&#160;its.<br/>
Ratio<br/>
Norm.&#160;time<br/>
1<br/>
55.621632<br/>
1.00<br/>
1.00e+00<br/>
1/2<br/>
58.782064<br/>
2.00<br/>
1.55e+01<br/>
1/4<br/>
59.404576<br/>
3.00<br/>
5.08<br/>
2.60e+02<br/>
1/8<br/>
59.569370<br/>
4.00<br/>
3.78<br/>
4.05e+03<br/>
1/16<br/>
59.651186<br/>
6.00<br/>
2.01<br/>
6.68e+04<br/>
1/32<br/>
59.705315<br/>
8.00<br/>
1.51<br/>
1.11e+06<br/>
1/64<br/>
59.748325<br/>
10.8<br/>
1.26<br/>
1.85e+07<br/>
(c)&#160;Semi-Lagrangian<br/>
Table&#160;6.2.3:&#160;Optimal&#160;consumption:&#160;convergence&#160;tests<br/>
22<br/>
<hr/>
<a name=23></a>100<br/>
25<br/>
)<br/>
S<br/>
(w<br/>
100<br/>
b))<br/>
80<br/>
)<br/>
20<br/>
(s<br/>
80<br/>
0,s,<br/>
60<br/>
=<br/>
60<br/>
15<br/>
(t<br/>
40<br/>
(u<br/>
holdings&#160;40<br/>
k<br/>
∆<br/>
NT<br/>
1<br/>
10<br/>
consumption<br/>
20<br/>
Value<br/>
Stoc<br/>
0<br/>
20<br/>
∆<br/>
5<br/>
100<br/>
2<br/>
Optimal<br/>
80<br/>
0<br/>
(b)<br/>
60<br/>
B<br/>
20<br/>
0<br/>
0<br/>
Stock&#160;40<br/>
40<br/>
0<br/>
20<br/>
40<br/>
60<br/>
80<br/>
100<br/>
holdings<br/>
60<br/>
account<br/>
20<br/>
Bank&#160;account&#160;(b)<br/>
(s)&#160;80<br/>
0<br/>
Bank<br/>
100<br/>
(a)&#160;Optimal&#160;control<br/>
(b)&#160;Value<br/>
Figure&#160;6.2.1:&#160;Optimal&#160;consumption&#160;at&#160;initial&#160;time&#160;(compare&#160;with&#160;[11,&#160;Figures&#160;1&#160;and&#160;2])<br/>
as&#160;an&#160;impulse&#160;control&#160;problem&#160;in&#160;[12].&#160;Optimal&#160;controls&#160;for&#160;GMWBs&#160;with&#160;annual&#160;withdrawals<br/>is&#160;considered&#160;in&#160;[1].<br/>
A&#160;GMWB&#160;is&#160;composed&#160;of&#160;investment&#160;and&#160;guarantee&#160;accounts,&#160;(<i>St</i>)<i>t</i>≥0&#160;and&#160;(<i>At</i>)<i>t</i>≥0,&#160;respec-<br/>
tively.&#160;It&#160;is&#160;bootstrapped&#160;via&#160;a&#160;lump&#160;sum&#160;payment&#160;<i>s</i>0&#160;to&#160;an&#160;insurer,&#160;placed&#160;in&#160;the&#160;(risky)<br/>investment&#160;account&#160;(i.e.&#160;<i>S</i>0&#160;=&#160;<i>s</i>0).&#160;A&#160;GMWB&#160;promises&#160;to&#160;pay&#160;back&#160;at&#160;least&#160;the&#160;lump&#160;sum<br/><i>s</i>0,&#160;assuming&#160;that&#160;the&#160;holder&#160;of&#160;the&#160;contract&#160;does&#160;not&#160;withdraw&#160;above&#160;a&#160;certain&#160;rate.&#160;This<br/>is&#160;captured&#160;by&#160;setting&#160;<i>A</i>0&#160;=&#160;<i>s</i>0&#160;and&#160;reducing&#160;both&#160;investment&#160;and&#160;guarantee&#160;accounts&#160;on&#160;a<br/>dollar-for-dollar&#160;basis&#160;upon&#160;withdrawals.&#160;The&#160;holder&#160;can&#160;continue&#160;to&#160;withdraw&#160;as&#160;long&#160;as&#160;the<br/>guarantee&#160;account&#160;remains&#160;positive.&#160;In&#160;particular,&#160;at&#160;any&#160;point&#160;in&#160;time&#160;until&#160;the&#160;expiry&#160;of<br/>the&#160;contract&#160;<i>T&#160;</i>,&#160;the&#160;holder&#160;may:<br/>
•&#160;withdraw&#160;continuously&#160;at&#160;a&#160;rate&#160;of&#160;<i>G&#160;</i>≥&#160;0&#160;per&#160;annum&#160;regardless&#160;of&#160;the&#160;performance&#160;of<br/>
the&#160;investment&#160;<b>(stochastic&#160;control)</b>;<br/>
•&#160;withdraw&#160;a&#160;finite&#160;amount&#160;<i>z&#160;</i>instantaneously&#160;reduced&#160;by&#160;the&#160;excess&#160;withdrawal&#160;rate<br/>
0&#160;≤&#160;<i>κ&#160;</i>≤&#160;1&#160;<b>(impulse&#160;control)</b>.<br/>
The&#160;holder&#160;gets&#160;the&#160;larger&#160;of&#160;the&#160;investment&#160;account&#160;and&#160;a&#160;full&#160;withdrawal&#160;at&#160;expiry.<br/>
The&#160;guarantee&#160;account&#160;can&#160;be&#160;withdrawn&#160;from&#160;continuously&#160;or&#160;instantaneously:<br/>
<i>dAt&#160;</i>=&#160;−<i>wtdt</i><br/>
if&#160;<i>τj&#160;&lt;&#160;t&#160;&lt;&#160;τj</i>+1<br/>
(stochastic&#160;control);<br/>
<i>Aτ</i><br/>
=&#160;<i>A</i><br/>
(impulse&#160;control)<i>.</i><br/>
<i>j</i>+1<br/>
<i>τj</i>+1−&#160;−&#160;<i>zτj</i>+1<br/>
Let&#160;<i>ρ&#160;</i>≥&#160;0&#160;denote&#160;the&#160;risk-free&#160;rate.&#160;Consider&#160;an&#160;index&#160;(<i>Yt</i>)<i>t</i>≥0&#160;following<br/>
<i>dYt&#160;</i>=&#160;<i>ρYtdt&#160;</i>+&#160;<i>ξYtd</i>W<i>t</i><br/>
under&#160;the&#160;risk-neutral&#160;measure.&#160;The&#160;investment&#160;account&#160;tracks&#160;the&#160;index&#160;and&#160;is&#160;adjusted&#160;by<br/>
withdrawals&#160;from&#160;the&#160;guarantee&#160;account:<br/>
<br/>
<br/>
<i>dSt&#160;</i>=&#160;(<i>ρ&#160;</i>−&#160;<i>η</i>)&#160;<i>St&#160;</i>−&#160;<i>wt</i>1{<i>S</i><br/>
<i>dt&#160;</i>+&#160;<i>ξS</i><br/>
<i>t&gt;</i>0}<br/>
<i>td</i>W<i>t</i><br/>
if&#160;<i>τj&#160;&lt;&#160;t&#160;&lt;&#160;τj</i>+1;<br/>
<br/>
<br/>
<i>Sτ</i><br/>
=&#160;max&#160;<i>S</i><br/>
<i>,&#160;</i>0&#160;<i>.</i><br/>
<i>j</i>+1<br/>
<i>τj</i>+1−&#160;−&#160;<i>zτj</i>+1<br/>
23<br/>
<hr/>
<a name=24></a>Parameter<br/>
Value<br/>
Risk-free&#160;rate<br/>
<i>ρ</i><br/>
5%<br/>
per&#160;annum<br/>
Premium<br/>
<i>η</i><br/>
0%<br/>
per&#160;annum<br/>
Volatility<br/>
<i>ξ</i><br/>
30%<br/>
per&#160;annum<br/>
Expiry<br/>
<i>T</i><br/>
10<br/>
years<br/>
Withdrawal&#160;rate<br/>
<i>G</i><br/>
$10<br/>
per&#160;annum<br/>
Excess&#160;withdrawal&#160;rate<br/>
<i>κ</i><br/>
10%<br/>
Fixed&#160;transaction&#160;cost<br/>
<i>C</i><br/>
1<i>/</i>106<br/>
Initial&#160;lump&#160;sum&#160;payment<br/>
<i>s</i>0<br/>
$100<br/>
Table&#160;6.3.1:&#160;GMWB:&#160;parameters&#160;from&#160;[12]<br/>
0&#160;≤&#160;<i>η&#160;</i>≤&#160;<i>ρ&#160;</i>is&#160;the&#160;proportional&#160;rate&#160;deducted&#160;from&#160;the&#160;investment&#160;account&#160;and&#160;serves&#160;as&#160;a<br/>premium&#160;for&#160;the&#160;guarantee.&#160;A&#160;combined&#160;control&#160;<i>θ&#160;</i>:=&#160;(<i>w,&#160;τ</i>1<i>,&#160;τ</i>2<i>,&#160;.&#160;.&#160;.&#160;,&#160;z</i>1<i>,&#160;z</i>2<i>,&#160;.&#160;.&#160;.</i>)&#160;is&#160;admissible&#160;if<br/>at&#160;all&#160;times,&#160;the&#160;guarantee&#160;account&#160;is&#160;nonnegative.&#160;Let&#160;Θ&#160;denote&#160;the&#160;set&#160;of&#160;all&#160;admissible<br/>controls.<br/>
The&#160;insurer’s&#160;worst-case&#160;cost&#160;of&#160;hedging&#160;(discussed&#160;in&#160;[2])&#160;a&#160;GMWB&#160;at&#160;time&#160;<i>t&#160;</i>with&#160;amount<br/>
<i>St&#160;</i>=&#160;<i>s&#160;</i>in&#160;the&#160;risky&#160;account&#160;and&#160;amount&#160;<i>At&#160;</i>=&#160;<i>a&#160;</i>is<br/>
&#34;Z&#160;<i>T</i><br/>
<i>u</i>(<i>t,&#160;s,&#160;a</i>)&#160;:=&#160;<i>eρt&#160;</i>sup&#160;(<i>t,s,a</i>)<br/>
E<br/>
<i>e</i>−<i>ρt</i>0<i>wt</i>0<i>dt</i>0&#160;+&#160;<i>e</i>−<i>ρT&#160;</i>max&#160;(<i>ST&#160;,&#160;</i>(1&#160;−&#160;<i>κ</i>)&#160;<i>AT&#160;</i>−&#160;<i>C</i>)<br/>
<i>θ</i>∈Θ<br/>
<i>t</i><br/>
#<br/>
<br/>
<br/>
+&#160;X&#160;<i>e</i>−<i>ρτj&#160;</i>(1&#160;−&#160;<i>κ</i>)&#160;<i>zτ&#160;</i>−&#160;<i>C</i><br/>
<i>j</i><br/>
<i>τj&#160;</i>≤<i>T</i><br/>
where&#160;<i>C&#160;&gt;&#160;</i>0&#160;is&#160;a&#160;fixed&#160;transaction&#160;cost.&#160;The&#160;terminal&#160;payoff&#160;corresponds&#160;to&#160;the&#160;maximum&#160;of<br/>
the&#160;investment&#160;account&#160;or&#160;withdrawing&#160;the&#160;entirety&#160;of&#160;the&#160;guarantee&#160;account&#160;at&#160;the&#160;excess<br/>
withdrawal&#160;rate.<br/>
Let&#160;<i>x&#160;</i>:=&#160;(<i>s,&#160;a</i>)&#160;and&#160;<i>ζ&#160;</i>:=&#160;<i>ρ&#160;</i>−&#160;<i>η</i>.&#160;The&#160;associated&#160;HJBQVI&#160;on&#160;Ω&#160;:=&#160;(0<i>,&#160;</i>∞)2&#160;and&#160;Λ&#160;:=&#160;∅&#160;is<br/>
given&#160;by&#160;(1.1)&#160;with&#160;<i>g</i>(<i>T,&#160;x</i>)&#160;:=&#160;max(<i>s,&#160;</i>(1&#160;−&#160;<i>κ</i>)<i>a&#160;</i>−&#160;<i>C</i>)&#160;and<br/>
<i>W&#160;</i>:=&#160;[0<i>,&#160;G</i>]&#160;;<br/>
<i>Z</i>(<i>t,&#160;x</i>)&#160;:=&#160;[0<i>,&#160;a</i>]&#160;;<br/>
<br/>
<br/>
<br/>
−<i>w</i><br/>
<i>∂&#160;</i>+&#160;<i>∂</i><br/>
if&#160;<i>s,&#160;a&#160;&gt;&#160;</i>0;<br/>
<i>ξ</i>2<i>s</i>2&#160;<i>∂</i>2<br/>
<i>∂</i><br/>
<br/>
<br/>
<i>∂a</i><br/>
<i>∂s</i><br/>
<br/>
Ł<i>w&#160;</i>:=<br/>
+&#160;<i>ζs</i><br/>
+<br/>
−<i>w&#160;∂</i><br/>
if&#160;<i>a&#160;&gt;&#160;</i>0;<br/>
Γ(<i>t,&#160;x,&#160;z</i>)&#160;:=&#160;−&#160;(min&#160;(<i>z,&#160;s</i>)&#160;<i>,&#160;z</i>)&#160;;<br/>
2&#160;<i>∂s</i>2<br/>
<i>∂s</i><br/>
<i>∂a</i><br/>
<br/>
<br/>
0<br/>
otherwise;<br/>
<br/>
<i>w</i><br/>
if&#160;<i>a&#160;&gt;&#160;</i>0;<br/>
<i>f&#160;w&#160;</i>:=<br/>
<i>K</i>(<i>t,&#160;x,&#160;z</i>)&#160;:=&#160;(1&#160;−&#160;<i>κ</i>)&#160;<i>z&#160;</i>−&#160;<i>C.</i><br/>
0<br/>
otherwise;<br/>
<b>6.3.1</b><br/>
<b>Convergence&#160;of&#160;the&#160;direct&#160;control&#160;scheme</b><br/>
We&#160;use&#160;the&#160;notation&#160;<i>xi&#160;</i>=&#160;(<i>si,&#160;ai</i>)&#160;and&#160;assume&#160;the&#160;origin&#160;(0<i>,&#160;</i>0)&#160;is&#160;part&#160;of&#160;the&#160;numerical&#160;grid.<br/>The&#160;direct&#160;control&#160;problem&#160;is&#160;given&#160;by&#160;(4.3)&#160;subject&#160;to&#160;(5.1)&#160;and&#160;(5.2).<br/>
Suppose&#160;(H4)&#160;is&#160;not&#160;satisfied&#160;so&#160;that&#160;for&#160;some&#160;solution&#160;<i>v</i>,&#160;there&#160;exists&#160;<i>i&#160;</i>such&#160;that&#160;<i>vi&#160;</i>=<br/>
[<br/>
2<br/>
B<i>v</i>]<i>i&#160;</i>=&#160;[B&#160;<i>v</i>]<i>i&#160;</i>=&#160;·&#160;·&#160;·&#160;.&#160;Since&#160;<i>C&#160;&gt;&#160;</i>0,&#160;it&#160;follows&#160;that&#160;<i>vi&#160;</i>=&#160;−∞,&#160;a&#160;contradiction.&#160;Hence,&#160;(H4)<br/>
holds.<br/>
24<br/>
<hr/>
<a name=25></a>)<br/>
100<br/>
80<br/>
(z<br/>
)<br/>
G<br/>
70<br/>
al<br/>
(a<br/>
w<br/>
80<br/>
rate<br/>
at<br/>
60<br/>
al<br/>
50<br/>
60<br/>
w<br/>
account<br/>
withdra<br/>
40<br/>
ithdra<br/>
40<br/>
W<br/>
30<br/>
impulse<br/>
20<br/>
20<br/>
Guarantee<br/>
Withdraw&#160;finite&#160;amount&#160;z<br/>
10<br/>
0<br/>
0<br/>
Optimal<br/>
0<br/>
50<br/>
100<br/>
150<br/>
200<br/>
250<br/>
300<br/>
Investment&#160;account&#160;(s)<br/>
Figure&#160;6.3.1:&#160;GMWB:&#160;optimal&#160;control&#160;at&#160;initial&#160;time&#160;with&#160;<i>η&#160;</i>=&#160;0<i>.</i>03126&#160;from&#160;[12]<br/>
We&#160;perform&#160;policy&#160;iteration&#160;on&#160;a&#160;modified&#160;problem&#160;with&#160;control&#160;set&#160;P0&#160;consisting&#160;of&#160;all<br/>
controls&#160;<i>P&#160;</i>:=&#160;(<i>w,&#160;z,&#160;ψ</i>)&#160;in&#160;P&#160;satisfying<br/>
<i>ψi&#160;</i>=&#160;0&#160;whenever&#160;<i>ai&#160;</i>=&#160;0&#160;and&#160;<i>zi&#160;</i>6=&#160;0&#160;whenever&#160;<i>ai&#160;</i>6=&#160;0<i>.</i><br/>
As&#160;in&#160;Example&#160;4.5,&#160;(H2)0&#160;follows&#160;from&#160;the&#160;unidirectionality&#160;of&#160;<i>zi</i>.&#160;(4.7)&#160;is&#160;established&#160;by<br/>
noting&#160;that&#160;<i>zi&#160;</i>=&#160;0&#160;incurs&#160;an&#160;infinite&#160;cost&#160;(and&#160;is&#160;therefore&#160;suboptimal).&#160;Convergence&#160;then<br/>follows&#160;from&#160;an&#160;application&#160;of&#160;Theorem&#160;4.10<br/>
<b>Remark&#160;6.2.&#160;</b><i>The&#160;condition&#160;zi&#160;</i>6=&#160;0&#160;<i>appeals&#160;to&#160;intuition:&#160;the&#160;holder&#160;should&#160;never&#160;pay&#160;C&#160;&gt;&#160;</i>0<br/><i>for&#160;a&#160;withdrawal&#160;of&#160;zero&#160;dollars.</i><br/>
<b>6.3.2</b><br/>
<b>Optimal&#160;control</b><br/>
Figure&#160;6.3.1&#160;shows&#160;an&#160;optimal&#160;control&#160;for&#160;a&#160;GMWB,&#160;corresponding&#160;to&#160;a&#160;worst-case&#160;cost&#160;of<br/>hedging&#160;from&#160;the&#160;perspective&#160;of&#160;the&#160;insurer&#160;(optimality&#160;from&#160;the&#160;holder’s&#160;perspective,&#160;who<br/>may&#160;have&#160;to&#160;take&#160;into&#160;consideration&#160;consumption,&#160;taxation,&#160;etc.,&#160;is&#160;explored&#160;in&#160;[2]).&#160;We&#160;refer<br/>to&#160;[12]&#160;for&#160;an&#160;explanation&#160;of&#160;the&#160;three&#160;distinct&#160;withdrawal&#160;regions.<br/>
<b>6.3.3</b><br/>
<b>Convergence&#160;tests</b><br/>
Convergence&#160;tests&#160;are&#160;shown&#160;in&#160;Table&#160;6.3.3.&#160;Since&#160;<i>w&#160;</i>7→&#160;Ł(<i>t,&#160;x,&#160;w</i>)&#160;is&#160;linear,&#160;we&#160;take&#160;<i>Wh&#160;</i>=<br/>{0<i>,&#160;G</i>}&#160;independent&#160;of&#160;<i>h</i>.&#160;An&#160;asymptotic&#160;boundary&#160;condition&#160;is&#160;used&#160;at&#160;the&#160;truncated&#160;boundary<br/><i>s&#160;</i>=&#160;<i>s</i>max&#160;(no&#160;boundary&#160;condition&#160;is&#160;needed&#160;at&#160;<i>a&#160;</i>=&#160;<i>a</i>max&#160;since&#160;the&#160;characteristics&#160;are&#160;outgoing<br/>in&#160;the&#160;<i>a&#160;</i>direction).&#160;For&#160;details,&#160;see&#160;[12].&#160;The&#160;direct&#160;control&#160;and&#160;penalized&#160;scheme&#160;produce<br/>near-identical&#160;results&#160;and&#160;exhibit&#160;similar&#160;execution&#160;times.<br/>
<b>7</b><br/>
<b>Concluding&#160;remarks</b><br/>
This&#160;work&#160;establishes&#160;the&#160;well-posedness&#160;of&#160;(1.3)&#160;and&#160;gives&#160;sufficient&#160;conditions&#160;for&#160;convergence<br/>
of&#160;the&#160;corresponding&#160;policy&#160;iteration.&#160;(1.3)&#160;has&#160;applications&#160;to&#160;the&#160;numerical&#160;solutions&#160;of<br/>
25<br/>
<hr/>
<a name=26></a><i>h</i><br/>
<i>w&#160;</i>nodes<br/>
<i>a&#160;</i>nodes<br/>
<i>z&#160;</i>nodes<br/>
Timesteps<br/>
1<br/>
64<br/>
50<br/>
2<br/>
32<br/>
1/2<br/>
128<br/>
100<br/>
4<br/>
64<br/>
..<br/>
.<br/>
.<br/>
.<br/>
.<br/>
.<br/>
..<br/>
..<br/>
..<br/>
..<br/>
Table&#160;6.3.2:&#160;GMWB:&#160;numerical&#160;grid<br/>
<i>h</i><br/>
<i>u</i>(<i>t&#160;</i>=&#160;0<i>,&#160;s</i>0<i>,&#160;s</i>0)<br/>
Avg.&#160;policy&#160;its.<br/>
Avg.&#160;BiCGSTAB&#160;its.<br/>
Ratio<br/>
Norm.&#160;time<br/>
1<br/>
107.68342<br/>
3.47<br/>
1.47<br/>
1.71e+01<br/>
1/2<br/>
107.70679<br/>
4.25<br/>
1.64<br/>
2.03e+02<br/>
1/4<br/>
107.71878<br/>
4.34<br/>
1.85<br/>
1.95<br/>
2.60e+03<br/>
1/8<br/>
107.72578<br/>
4.43<br/>
2.22<br/>
1.71<br/>
3.46e+04<br/>
1/16<br/>
107.72964<br/>
4.31<br/>
2.71<br/>
1.81<br/>
4.75e+05<br/>
1/32<br/>
107.73176<br/>
4.15<br/>
3.40<br/>
1.83<br/>
7.55e+06<br/>
(a)&#160;Direct&#160;control<br/>
<i>h</i><br/>
<i>u</i>(<i>t&#160;</i>=&#160;0<i>,&#160;s</i>0<i>,&#160;s</i>0)<br/>
Avg.&#160;policy&#160;its.<br/>
Avg.&#160;BiCGSTAB&#160;its.<br/>
Ratio<br/>
Norm.&#160;time<br/>
1<br/>
107.68243<br/>
3.47<br/>
1.58<br/>
1.80e+01<br/>
1/2<br/>
107.70639<br/>
4.08<br/>
1.65<br/>
2.06e+02<br/>
1/4<br/>
107.71870<br/>
3.95<br/>
1.76<br/>
1.95<br/>
2.45e+03<br/>
1/8<br/>
107.72576<br/>
3.98<br/>
1.97<br/>
1.74<br/>
3.22e+04<br/>
1/16<br/>
107.72964<br/>
3.71<br/>
2.39<br/>
1.82<br/>
4.34e+05<br/>
1/32<br/>
107.73175<br/>
3.32<br/>
3.01<br/>
1.83<br/>
6.62e+06<br/>
(b)&#160;Penalized<br/>
<i>h</i><br/>
<i>u</i>(<i>t&#160;</i>=&#160;0<i>,&#160;s</i>0<i>,&#160;s</i>0)<br/>
Avg.&#160;BiCGSTAB&#160;its.<br/>
Ratio<br/>
Norm.&#160;time<br/>
1<br/>
107.42351<br/>
1.00<br/>
1.00e+00<br/>
1/2<br/>
107.68443<br/>
1.00<br/>
1.02e+01<br/>
1/4<br/>
107.70841<br/>
1.00<br/>
10.9<br/>
1.39e+02<br/>
1/8<br/>
107.72257<br/>
1.00<br/>
1.70<br/>
2.03e+03<br/>
1/16<br/>
107.73015<br/>
1.00<br/>
1.87<br/>
3.31e+04<br/>
1/32<br/>
107.73224<br/>
1.98<br/>
3.62<br/>
6.10e+05<br/>
1/64<br/>
107.73337<br/>
2.90<br/>
1.85<br/>
1.13e+07<br/>
(c)&#160;Semi-Lagrangian<br/>
Table&#160;6.3.3:&#160;GMWB:&#160;convergence&#160;tests<br/>
26<br/>
<hr/>
<a name=27></a>HJBQVIs&#160;(§5–6)&#160;and&#160;infinite-horizon&#160;MDPs&#160;with&#160;vanishing&#160;discount&#160;factor&#160;(Corollary&#160;4.4).<br/>
A&#160;semi-Lagrangian&#160;scheme&#160;for&#160;the&#160;HJBQVI&#160;(1.1)&#160;is&#160;both&#160;easy&#160;to&#160;implement&#160;and&#160;requires<br/>
only&#160;one&#160;linear&#160;solve&#160;per&#160;timestep.&#160;However,&#160;it&#160;cannot&#160;be&#160;used&#160;if&#160;the&#160;diffusion&#160;or&#160;jump&#160;arrival<br/>rate&#160;of&#160;the&#160;underlying&#160;stochastic&#160;process&#160;are&#160;control-dependent.<br/>
The&#160;direct&#160;control&#160;and&#160;penalized&#160;schemes&#160;do&#160;not&#160;suffer&#160;these&#160;limitations.&#160;Numerical<br/>
evidence&#160;suggests&#160;that&#160;both&#160;schemes&#160;perform&#160;similarly.&#160;However,&#160;policy&#160;iteration&#160;applied&#160;to<br/>the&#160;direct&#160;control&#160;scheme&#160;can&#160;fail&#160;(Example&#160;4.9)&#160;unless&#160;additional&#160;care&#160;is&#160;taken&#160;to&#160;remove<br/>certain&#160;suboptimal&#160;controls.&#160;The&#160;removal&#160;of&#160;these&#160;controls&#160;is&#160;ad&#160;hoc&#160;(i.e.&#160;problem&#160;dependent).<br/>
Therefore,&#160;we&#160;recommend&#160;discretizing&#160;the&#160;problem&#160;with&#160;a&#160;penalized&#160;scheme,&#160;applying&#160;policy<br/>
iteration&#160;to&#160;solve&#160;the&#160;resulting&#160;nonlinear&#160;equations.<br/>
<b>A</b><br/>
<b>General&#160;well-posedness&#160;of&#160;the&#160;Bellman&#160;problem&#160;</b>(2.1)<br/>
By&#160;modifying&#160;policy&#160;iteration,&#160;it&#160;is&#160;possible&#160;to&#160;arrive&#160;at&#160;a&#160;version&#160;of&#160;Proposition&#160;2.2&#160;independent<br/>of&#160;(H1.ii).&#160;We&#160;can&#160;interpret&#160;this&#160;algorithm&#160;as&#160;taking&#160;into&#160;account&#160;the&#160;error&#160;from&#160;approximating<br/>the&#160;supremum&#160;in&#160;Policy-Iteration.&#160;The&#160;algorithm,&#160;closely&#160;related&#160;to&#160;[7,&#160;Algorithm&#160;Ho-4],<br/>is&#160;given&#160;below&#160;(subject&#160;to&#160;the&#160;convention&#160;that&#160;for&#160;<i>x&#160;</i>in<br/>
<i>M</i><br/>
R<br/>
and&#160;<i>c&#160;</i>in&#160;R,&#160;<i>x&#160;</i>+&#160;<i>c&#160;</i>is&#160;the&#160;vector&#160;<i>x</i><br/>
with&#160;<i>c&#160;</i>added&#160;to&#160;each&#160;component):<br/>
<i></i>-Policy-Iteration(P<i>,&#160;A</i>(·)<i>,&#160;b</i>(·)<i>,&#160;v</i>0)<br/>1<br/>
Pick&#160;a&#160;positive&#160;sequence&#160;(<i>`</i>)<i>`</i>≥1&#160;in&#160;R&#160;such&#160;that&#160;P<i>`</i>≥1&#160;<i>`&#160;&lt;&#160;</i>∞<br/>
2<br/>
<b>for&#160;</b><i>`&#160;</i>=&#160;1<i>,&#160;</i>2<i>,&#160;.&#160;.&#160;.</i><br/>
3<br/>
Pick&#160;<i>P&#160;`&#160;</i>such&#160;that&#160;−<i>A</i>(<i>P&#160;`</i>)<i>v`</i>−1&#160;+&#160;<i>b</i>(<i>P&#160;`</i>)&#160;+&#160;<i>`&#160;</i>≥&#160;sup<br/>
{−<i>A</i>(<i>P&#160;</i>)<i>v`</i>−1&#160;+&#160;<i>b</i>(<i>P&#160;</i>)}<br/>
<i>P&#160;</i>∈P<br/>
4<br/>
<i>v`&#160;</i>:=&#160;Solve(<i>A</i>(<i>P&#160;`</i>)<i>,&#160;b</i>(<i>P&#160;`</i>)<i>,&#160;v`</i>−1)<br/>
The&#160;following&#160;appears&#160;in&#160;[7]:<br/>
<b>Lemma&#160;A.1.&#160;</b><i>A&#160;bounded&#160;sequence&#160;</i>(<i>v`</i>)<i>`</i>≥0&#160;<i>in&#160;</i>R&#160;<i>converges&#160;if&#160;there&#160;exists&#160;a&#160;positive&#160;sequence</i><br/>
(<i>`</i>)<i>`</i>≥1&#160;<i>in&#160;</i>R&#160;<i>such&#160;that&#160;</i>P<i>`</i>≥1&#160;<i>`&#160;&lt;&#160;</i>∞&#160;<i>and&#160;v`&#160;</i>−&#160;<i>v`</i>−1&#160;≥&#160;−<i>`&#160;for&#160;`&#160;</i>≥&#160;1<i>.</i><br/>
We&#160;require&#160;the&#160;following&#160;lemma,&#160;whose&#160;proof&#160;is&#160;trivial&#160;and&#160;thus&#160;omitted:<br/>
<b>Lemma&#160;A.2.&#160;</b><i>Let&#160;X&#160;be&#160;a&#160;set,&#160;Y&#160;a&#160;normed&#160;linear&#160;space,&#160;T&#160;</i>:&#160;<i>X&#160;</i>×&#160;<i>Y&#160;</i>→&#160;R<i>,&#160;and&#160;Q&#160;</i>:&#160;<i>X&#160;</i>→&#160;R<br/>
<i>with&#160;Q&#160;bounded&#160;above.&#160;Suppose&#160;that&#160;for&#160;each&#160;x&#160;in&#160;X,&#160;Tx&#160;</i>:&#160;<i>Y&#160;</i>→&#160;R&#160;<i>defined&#160;by&#160;Tx</i>(<i>y</i>)&#160;:=&#160;<i>T&#160;</i>(<i>x,&#160;y</i>)<br/><i>is&#160;linear&#160;and&#160;that&#160;Tx&#160;has&#160;operator&#160;norm&#160;bounded&#160;uniformly&#160;with&#160;respect&#160;to&#160;x.&#160;The&#160;map</i><br/>
<i>y&#160;</i>7→&#160;sup<br/>
{<i>T&#160;</i>(<i>x,&#160;y</i>)&#160;+&#160;<i>Q</i>(<i>x</i>)}&#160;<i>is&#160;uniformly&#160;continuous.</i><br/>
<i>x</i>∈<i>X</i><br/>
<b>Theorem&#160;A.3.&#160;</b><i>Suppose&#160;</i>(H0)<i>,&#160;</i>(H1.i)<i>,&#160;and&#160;that&#160;A</i>(<i>P&#160;</i>)&#160;<i>is&#160;a&#160;monotone&#160;matrix&#160;for&#160;all&#160;P&#160;in&#160;</i>P<i>.</i><br/>
(<i>v`</i>)<i>`</i>≥1&#160;<i>defined&#160;by&#160;</i>-Policy-Iteration&#160;<i>converges&#160;to&#160;the&#160;unique&#160;solution&#160;v&#160;of&#160;</i>(2.1)<i>.</i><br/>
<i>Proof.&#160;</i>First,&#160;note&#160;that<br/>
<br/>
n<br/>
o<br/>
<i>A</i>(<i>P&#160;`</i>)&#160;<i>v`&#160;</i>−&#160;<i>v`</i>−1&#160;=&#160;−<i>A</i>(<i>P&#160;`</i>)<i>v`</i>−1&#160;+&#160;<i>b</i>(<i>P&#160;`</i>)&#160;≥&#160;sup&#160;−<i>A</i>(<i>P&#160;</i>)<i>v`</i>−1&#160;+&#160;<i>b</i>(<i>P&#160;</i>)&#160;−&#160;<i>`.</i><br/>
(A.1)<br/>
<i>P&#160;</i>∈P<br/>
For&#160;<i>`&#160;&gt;&#160;</i>1,<br/>
n<br/>
o<br/>
sup&#160;−<i>A</i>(<i>P&#160;</i>)<i>v`</i>−1&#160;+&#160;<i>b</i>(<i>P&#160;</i>)&#160;≥&#160;−<i>A</i>(<i>P&#160;`</i>−1)<i>v`</i>−1&#160;+&#160;<i>b</i>(<i>P&#160;`</i>−1)&#160;=&#160;0<i>.</i><br/>
<i>P&#160;</i>∈P<br/>
27<br/>
<hr/>
<a name=28></a>Combining&#160;this&#160;with&#160;(A.1),<br/>
<i>v`&#160;</i>−&#160;<i>v`</i>−1&#160;≥&#160;−<i>A</i>(<i>P&#160;`</i>)−1(<i>`,&#160;.&#160;.&#160;.&#160;,&#160;`</i>)|&#160;≥&#160;−<i>C`&#160;</i>for&#160;some&#160;<i>C&#160;</i>≥&#160;0<i>.</i><br/>
The&#160;last&#160;inequality&#160;follows&#160;from&#160;the&#160;boundedness&#160;of&#160;<i>P&#160;</i>7→&#160;<i>A</i>(<i>P&#160;</i>)−1&#160;in&#160;(H0).&#160;By&#160;Lemma&#160;A.1,<br/>
<i>v`&#160;</i>→&#160;<i>v&#160;</i>for&#160;some&#160;<i>v&#160;</i>in<br/>
<i>M</i><br/>
R&#160;.&#160;Taking&#160;limits&#160;in&#160;(A.1)&#160;and&#160;applying&#160;Lemma&#160;A.2,<br/>
&#160;<br/>
!<br/>
n<br/>
o<br/>
0&#160;=&#160;lim<br/>
sup&#160;−<i>A</i>(<i>P&#160;</i>)<i>v`</i>−1&#160;+&#160;<i>b</i>(<i>P&#160;</i>)<br/>
=&#160;sup&#160;{−<i>A</i>(<i>P&#160;</i>)<i>v&#160;</i>+&#160;<i>b</i>(<i>P&#160;</i>)}&#160;<i>.</i><br/>
<i>`</i>→∞<br/>
<i>P&#160;</i>∈P<br/>
<i>P&#160;</i>∈P<br/>
Hence,&#160;<i>v&#160;</i>is&#160;a&#160;solution&#160;to&#160;(2.1).&#160;Uniqueness&#160;is&#160;proven&#160;similarly&#160;to&#160;Theorem&#160;4.8.<br/>
<br/>
<b>B</b><br/>
<b>Proof&#160;of&#160;Lemma&#160;4.1</b><br/>
<i>Proof.&#160;</i>We&#160;write&#160;<i>Aδ&#160;</i>and&#160;<i>bδ&#160;</i>to&#160;stress&#160;dependence&#160;on&#160;<i>δ</i>.&#160;Let&#160;<i>v&#160;</i>be&#160;a&#160;solution&#160;of&#160;(4.3)&#160;with&#160;<i>δ&#160;</i>=&#160;1.&#160;A<br/>pigeonhole&#160;principle&#160;argument&#160;allows&#160;us&#160;to&#160;pick&#160;a&#160;sequence&#160;(<i>P&#160;`</i>)<i>`</i>≥0&#160;:=&#160;(<i>w`,&#160;z`,&#160;ψ`</i>)<i>`</i>≥0&#160;in&#160;P&#160;such<br/>that&#160;<i>ψ`&#160;</i>=&#160;<i>ψ&#160;</i>is&#160;constant&#160;and&#160;−<i>A</i>1(<i>P&#160;`</i>)<i>v&#160;</i>+&#160;<i>b</i>1(<i>P&#160;`</i>)&#160;→&#160;0.&#160;Multiplying&#160;both&#160;sides&#160;by&#160;<i>I&#160;</i>−&#160;Ψ&#160;+&#160;<i>δ</i>0Ψ<br/>
(where&#160;Ψ&#160;:=&#160;diag(<i>ψ</i>))&#160;yields&#160;−<i>Aδ&#160;</i>(<i>P&#160;`</i>)<i>v&#160;</i>+&#160;<i>b&#160;</i>(<i>P&#160;`</i>)&#160;→&#160;0,&#160;and&#160;hence&#160;sup<br/>
{−<i>A&#160;</i>(<i>P&#160;</i>)<i>v&#160;</i>+<br/>
0<br/>
<i>δ</i>0<br/>
<i>P&#160;</i>∈P<br/>
<i>δ</i>0<br/>
<i>bδ&#160;</i>(<i>P&#160;</i>)}&#160;≥&#160;0.&#160;Supposing&#160;that&#160;this&#160;inequality&#160;is&#160;strict,&#160;it&#160;follows&#160;that&#160;for&#160;some&#160;<i>P&#160;</i>and&#160;<i>i</i>,<br/>
0<br/>
[−<i>Aδ&#160;</i>(<i>P&#160;</i>)<i>v&#160;</i>+&#160;<i>b&#160;</i>(<i>P&#160;</i>)]<br/>
Ψ]<br/>
0<br/>
<i>δ</i>0<br/>
<i>i&#160;&gt;&#160;</i>0.&#160;Multiplying&#160;both&#160;sides&#160;by&#160;[<i>I&#160;</i>−&#160;Ψ&#160;+&#160;<i>δ</i>−1<br/>
0<br/>
<i>i&#160;</i>yields&#160;[−<i>Aδ</i>=1(<i>P&#160;</i>)<i>v&#160;</i>+<br/>
<i>bδ</i>=1(<i>P&#160;</i>)]<i>i&#160;&gt;&#160;</i>0,&#160;contradicting&#160;that&#160;<i>v&#160;</i>is&#160;a&#160;solution.&#160;The&#160;converse&#160;is&#160;handled&#160;similarly.<br/>
<br/>
<b>References</b><br/>
[1]&#160;P.&#160;Azimzadeh&#160;and&#160;P.&#160;A.&#160;Forsyth.&#160;The&#160;existence&#160;of&#160;optimal&#160;bang-bang&#160;controls&#160;for&#160;GMxB<br/>
contracts.&#160;<i>SIAM&#160;J.&#160;Financial&#160;Math.</i>,&#160;6(1):117–139,&#160;2015.<br/>
[2]&#160;P.&#160;Azimzadeh,&#160;P.&#160;A.&#160;Forsyth,&#160;and&#160;K.&#160;R.&#160;Vetzal.&#160;Hedging&#160;costs&#160;for&#160;variable&#160;annuities<br/>
under&#160;regime-switching.&#160;In&#160;<i>Hidden&#160;Markov&#160;Models&#160;in&#160;Finance</i>,&#160;pages&#160;133–166.&#160;Springer,<br/>
2014.<br/>
[3]&#160;J.&#160;Babbin,&#160;P.&#160;A.&#160;Forsyth,&#160;and&#160;G.&#160;Labahn.&#160;A&#160;comparison&#160;of&#160;iterated&#160;optimal&#160;stopping<br/>
and&#160;local&#160;policy&#160;iteration&#160;for&#160;American&#160;options&#160;under&#160;regime&#160;switching.&#160;<i>J.&#160;Sci.&#160;Comput.</i>,<br/>58(2):409–430,&#160;2014.<br/>
[4]&#160;G.&#160;Barles&#160;and&#160;P.&#160;E.&#160;Souganidis.&#160;Convergence&#160;of&#160;approximation&#160;schemes&#160;for&#160;fully&#160;nonlinear<br/>
second&#160;order&#160;equations.&#160;<i>Asymptot.&#160;Anal.</i>,&#160;4(3):271–283,&#160;1991.<br/>
[5]&#160;E.&#160;Bayraktar&#160;and&#160;H.&#160;Xing.&#160;Pricing&#160;Asian&#160;options&#160;for&#160;jump&#160;diffusion.&#160;<i>Math.&#160;Finance</i>,<br/>
21(1):117–143,&#160;2011.<br/>
[6]&#160;A.&#160;Bensoussan&#160;and&#160;J.&#160;L.&#160;Lions.&#160;<i>Impulse&#160;control&#160;and&#160;quasi-variational&#160;inequalities</i>.<br/>
Gaunthier-Villars,&#160;Paris,&#160;1984.<br/>
[7]&#160;O.&#160;Bokanowski,&#160;S.&#160;Maroso,&#160;and&#160;H.&#160;Zidani.&#160;Some&#160;convergence&#160;results&#160;for&#160;Howard’s<br/>
algorithm.&#160;<i>SIAM&#160;J.&#160;Numer.&#160;Anal.</i>,&#160;47(4):3001–3026,&#160;2009.<br/>
28<br/>
<hr/>
<a name=29></a>[8]&#160;J.&#160;H.&#160;Bramble&#160;and&#160;B.&#160;E.&#160;Hubbard.&#160;On&#160;a&#160;finite&#160;difference&#160;analogue&#160;of&#160;an&#160;elliptic&#160;boundary<br/>
problem&#160;which&#160;is&#160;neither&#160;diagonally&#160;dominant&#160;nor&#160;of&#160;non-negative&#160;type.&#160;<i>J.&#160;Math.&#160;Phys.</i>,<br/>
43(2):117,&#160;1964.<br/>
[9]&#160;A.&#160;Cadenillas&#160;and&#160;F.&#160;Zapatero.&#160;Optimal&#160;central&#160;bank&#160;intervention&#160;in&#160;the&#160;foreign&#160;exchange<br/>
market.&#160;<i>J.&#160;Econom.&#160;Theory</i>,&#160;87(1):218–242,&#160;1999.<br/>
[10]&#160;J.&#160;P.&#160;Chancelier,&#160;M.&#160;Messaoud,&#160;and&#160;A.&#160;Sulem.&#160;A&#160;policy&#160;iteration&#160;algorithm&#160;for&#160;fixed<br/>
point&#160;problems&#160;with&#160;nonexpansive&#160;operators.&#160;<i>Math.&#160;Methods&#160;Oper.&#160;Res.</i>,&#160;65(2):239–259,<br/>
2007.<br/>
[11]&#160;J.&#160;P.&#160;Chancelier,&#160;B.&#160;Øksendal,&#160;and&#160;A.&#160;Sulem.&#160;Combined&#160;stochastic&#160;control&#160;and&#160;optimal<br/>
stopping,&#160;and&#160;application&#160;to&#160;numerical&#160;approximation&#160;of&#160;combined&#160;stochastic&#160;and&#160;impulse<br/>control.&#160;<i>Proc.&#160;Steklov&#160;Inst.&#160;Math.</i>,&#160;237(0):149–172,&#160;2002.<br/>
[12]&#160;Z.&#160;Chen&#160;and&#160;P.&#160;A.&#160;Forsyth.&#160;A&#160;numerical&#160;scheme&#160;for&#160;the&#160;impulse&#160;control&#160;formulation<br/>
for&#160;pricing&#160;variable&#160;annuities&#160;with&#160;a&#160;guaranteed&#160;minimum&#160;withdrawal&#160;benefit&#160;(GMWB).<br/>
<i>Numer.&#160;Math.</i>,&#160;109(4):535–569,&#160;2008.<br/>
[13]&#160;R.&#160;Cont&#160;and&#160;E.&#160;Voltchkova.&#160;A&#160;finite&#160;difference&#160;scheme&#160;for&#160;option&#160;pricing&#160;in&#160;jump&#160;diffusion<br/>
and&#160;exponential&#160;lévy&#160;models.&#160;<i>SIAM&#160;J.&#160;Numer.&#160;Anal.</i>,&#160;43(4):1596–1626,&#160;2005.<br/>
[14]&#160;M.&#160;Dai,&#160;Y.&#160;K.&#160;Kwok,&#160;and&#160;J.&#160;Zong.&#160;Guaranteed&#160;minimum&#160;withdrawal&#160;benefit&#160;in&#160;variable<br/>
annuities.&#160;<i>Math.&#160;Finance</i>,&#160;18(4):595–611,&#160;2008.<br/>
[15]&#160;P.&#160;A.&#160;Forsyth&#160;and&#160;G.&#160;Labahn.&#160;Numerical&#160;methods&#160;for&#160;controlled&#160;Hamilton-Jacobi-Bellman<br/>
PDEs&#160;in&#160;finance.&#160;<i>J.&#160;Comput.&#160;Finance</i>,&#160;11(2):1,&#160;2007.<br/>
[16]&#160;Y.&#160;Huang,&#160;P.&#160;A.&#160;Forsyth,&#160;and&#160;G.&#160;Labahn.&#160;Inexact&#160;arithmetic&#160;considerations&#160;for&#160;direct<br/>
control&#160;and&#160;penalty&#160;methods:&#160;American&#160;options&#160;under&#160;jump&#160;diffusion.&#160;<i>Appl.&#160;Numer.</i><br/>
<i>Math.</i>,&#160;72:33–51,&#160;2013.<br/>
[17]&#160;K.&#160;Ishii.&#160;Viscosity&#160;solutions&#160;of&#160;nonlinear&#160;second&#160;order&#160;elliptic&#160;PDEs&#160;associated&#160;with<br/>
impulse&#160;control&#160;problems.&#160;<i>Funkcial.&#160;Ekvac.</i>,&#160;36(1):123–141,&#160;1993.<br/>
[18]&#160;I.&#160;Kharroubi,&#160;J.&#160;Ma,&#160;H.&#160;Pham,&#160;J.&#160;Zhang,&#160;et&#160;al.&#160;Backward&#160;SDEs&#160;with&#160;constrained&#160;jumps<br/>
and&#160;quasi-variational&#160;inequalities.&#160;<i>Ann.&#160;Appl.&#160;Probab.</i>,&#160;38(2):794–840,&#160;2010.<br/>
[19]&#160;H.&#160;J.&#160;Kushner&#160;and&#160;P.&#160;G.&#160;Dupuis.&#160;<i>Numerical&#160;methods&#160;for&#160;stochastic&#160;control&#160;problems&#160;in</i><br/>
<i>continuous&#160;time</i>.&#160;Springer-Verlag,&#160;New&#160;York,&#160;1992.<br/>
[20]&#160;H.&#160;Le&#160;and&#160;C.&#160;Wang.&#160;A&#160;finite&#160;time&#160;horizon&#160;optimal&#160;stopping&#160;problem&#160;with&#160;regime<br/>
switching.&#160;<i>SIAM&#160;J.&#160;Control&#160;Optim.</i>,&#160;48(8):5193–5213,&#160;2010.<br/>
[21]&#160;M.&#160;A.&#160;Milevsky&#160;and&#160;T.&#160;S.&#160;Salisbury.&#160;Financial&#160;valuation&#160;of&#160;guaranteed&#160;minimum<br/>
withdrawal&#160;benefits.&#160;<i>Insurance&#160;Math.&#160;Econom.</i>,&#160;38(1):21–38,&#160;2006.<br/>
[22]&#160;G.&#160;Mundaca&#160;and&#160;B.&#160;Øksendal.&#160;Optimal&#160;stochastic&#160;intervention&#160;control&#160;with&#160;application<br/>
to&#160;the&#160;exchange&#160;rate.&#160;<i>J.&#160;Math.&#160;Econom.</i>,&#160;29(2):225–243,&#160;1998.<br/>
29<br/>
<hr/>
<a name=30></a>[23]&#160;A.&#160;M.&#160;Oberman.&#160;Convergent&#160;difference&#160;schemes&#160;for&#160;degenerate&#160;elliptic&#160;and&#160;parabolic<br/>
equations:&#160;Hamilton-Jacobi&#160;equations&#160;and&#160;free&#160;boundary&#160;problems.&#160;<i>SIAM&#160;J.&#160;Numer.</i><br/>
<i>Anal.</i>,&#160;44(2):879–895,&#160;2006.<br/>
[24]&#160;B.&#160;Øksendal&#160;and&#160;A.&#160;Sulem.&#160;<i>Applied&#160;stochastic&#160;control&#160;of&#160;jump&#160;diffusions</i>,&#160;volume&#160;498.<br/>
Springer,&#160;2005.<br/>
[25]&#160;R.&#160;J.&#160;Plemmons.&#160;M-matrix&#160;characterizations.I–Nonsingular&#160;M-matrices.&#160;<i>Linear&#160;Algebra</i><br/>
<i>Appl.</i>,&#160;18(2):175–188,&#160;1977.<br/>
[26]&#160;R.&#160;C.&#160;Seydel.&#160;Existence&#160;and&#160;uniqueness&#160;of&#160;viscosity&#160;solutions&#160;for&#160;QVI&#160;associated&#160;with<br/>
impulse&#160;control&#160;of&#160;jump-diffusions.&#160;<i>Stochastic&#160;Process.&#160;Appl.</i>,&#160;119(10):3719–3748,&#160;2009.<br/>
[27]&#160;P.&#160;N.&#160;Shivakumar&#160;and&#160;K.&#160;H.&#160;Chew.&#160;A&#160;sufficient&#160;condition&#160;for&#160;nonvanishing&#160;of&#160;determinants.<br/>
<i>Proc.&#160;Amer.&#160;Math.&#160;Soc.</i>,&#160;pages&#160;63–66,&#160;1974.<br/>
[28]&#160;J.&#160;H.&#160;Witte&#160;and&#160;C.&#160;Reisinger.&#160;Penalty&#160;methods&#160;for&#160;the&#160;solution&#160;of&#160;discrete&#160;HJB&#160;equations-<br/>
continuous&#160;control&#160;and&#160;obstacle&#160;problems.&#160;<i>SIAM&#160;J.&#160;Numer.&#160;Anal.</i>,&#160;50(2):595–625,&#160;2012.<br/>
30<br/>
<hr/>
</body>
</html>
