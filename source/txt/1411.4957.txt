TIGHT CYCLES AND REGULAR SLICES IN DENSE HYPERGRAPHS

arXiv:1411.4957v1 [math.CO] 18 Nov 2014

PETER ALLEN, JULIA BÖTTCHER, OLIVER COOLEY, AND RICHARD MYCROFT
Abstract. We study properties of random subcomplexes of partitions returned by (a
suitable form of) the Strong Hypergraph Regularity Lemma, which we call regular slices.
We argue that these subcomplexes capture many important structural properties of the
original hypergraph. Accordingly we advocate their use in extremal hypergraph theory,
and explain how they can lead to considerable simpliﬁcations in existing proofs in this
ﬁeld. We also use them for establishing the following two new results.
Firstly, we prove a hypergraph extension of the Erdős-Gallai Theorem:
 for every δ > 0
every suﬃciently large k-uniform hypergraph with at least (α + δ) nk edges contains a
tight cycle of length αn for each α ∈ [0, 1].
Secondly, we ﬁnd (asymptotically) the minimum codegree requirement for a k-uniform
k-partite hypergraph, each of whose parts has n vertices, to contain a tight cycle of length
αkn, for each 0 < α < 1.

1. Introduction
The Szemerédi Regularity Lemma [35] is a powerful tool in extremal graph theory. It is
probably fair to say that the majority of the advances in the last decade in extremal graph
theory either rely on, or at least were inspired by, the Regularity Lemma. Finding the
right extension of this result for hypergraphs turned out to be a challenging endeavour,
which culminated in the proof of the Strong Hypergraph Regularity Lemma together with
a corresponding Counting Lemma (see [11, 25, 31, 32, 33]), which provide an analogous
machinery for extremal problems in hypergraphs. The diﬃculty with these tools is their
technical intricacy, which leads to signiﬁcant additional complexity in applications of the
regularity method in extremal hypergraph theory.
In this paper we argue that often much of this complexity can be avoided by using instead of the complicated structure returned by the Strong Hypergraph Regularity Lemma
a more accessible structure, which we call a regular slice. We provide a lemma (which is
a consequence of the Strong Hypergraph Regularity Lemma) that asserts the existence
of such regular slices which inherit enough structure from the original hypergraph to be
useful for embedding problems. In addition we provide two applications of this lemma
concerning the existence of tight cycles in dense hypergraphs.
In the remainder of this introduction we will ﬁrst describe these applications, and then
provide more details on our lemma concerning regular slices.
1.1. Cycles in dense graphs and hypergraphs. Dirac’s Theorem [9] asserts that
any n-vertex graph G with minimum degree δ(G) ≥ n/2 contains a Hamilton cycle.
Bondy [4] extended this result and showed that Hamiltonian n-vertex graphs with at
least n2 /4 edges are in fact either complete bipartite or pancyclic, that is, they contain
Date: August 20, 2018.
PA was partially supported by FAPESP (Proc. 2010/09555-7); JB by FAPESP (Proc. 2009/178317); PA and JB by CNPq (Proc. 484154/2010-9); OC by the DFG (TA 309/2-2); The cooperation
of the authors was supported by a joint CAPES-DAAD project (415/ppp-probral/po/D08/11629,
Proj. no. 333/09). The authors are grateful to NUMEC/USP, Núcleo de Modelagem Estocástica e
Complexidade of the University of São Paulo, and Project MaCLinC/USP, for supporting this research.
1

cycles of all lengths ℓ ≤ n. Cycles of shorter lengths were also considered by Erdős and
Gallai [10], whose celebrated theorem states that for any integer d ≥ 3, any n-vertex
graph with at least (d − 1)(n − 1)/2 + 1 edges contains a cycle of length at least d. This is
the best possible bound which is linear in d. The analogous problem for minimum degree
conditions was settled by Alon [2], who proved that large graphs with minimum degree at
least n/k contain a cycle of length at least n/(k −1). Nikiforov and Schelp [26] considered
exact cycle lengths. They showed that for all α > 0 there is n0 such that for n ≥ n0 all
n-vertex graphs G with δ(G) ≥ αn contain all even ℓ-cycles with 4 ≤ ℓ ≤ δ(G) + 1 (they
also considered odd cycles for non-bipartite G; and even sharper results are obtained
in [1]).
For hypergraphs much less is known. A tight cycle 1 in a k-uniform hypergraph G is a
cyclically ordered list of vertices such that every k consecutive vertices form an edge in G.
Only recently Rödl, Ruciński and Szemerédi [29] established an approximate extension
of Dirac’s Theorem for k-uniform hypergraphs (the 3-uniform case was resolved exactly
by the same authors in [30]): for all γ > 0 every suﬃciently large k-uniform hypergraph
such that every (k − 1)-set of vertices lies in at least ( 21 + γ)n edges has a tight Hamilton
cycle. A hypergraph analogue of the Erdős-Gallai Theorem is not yet known. Győri,
Katona and Lemons [12] made a ﬁrst step in this direction. They showed that k-uniform
n
hypergraphs G with more than (αn − k) k−1
edges contain a tight path on αn vertices.
Note that this statement is vacuous for α > 1/k.
Our ﬁrst result is an approximate Erdős-Gallai type result that establishes (up to the
error term δ) the best possible linear density bound for the containment of tight cycles
of a given length.
Theorem 1. For every positive δ and every integer k ≥ 3, there is an integer n∗ such
that the following holds for all
 α ∈ [0, 1]. If G is a k-uniform hypergraph on n ≥ n∗
n
vertices with e(G) ≥ (α + δ) k , then G contains a tight cycle of length ℓ for every ℓ ≤ αn
that is divisible by k.
Partite versions of the graph embedding results mentioned above also have been studied
extensively. Moon and Moser [24] showed that the minimum degree condition in Dirac’s
Theorem can (almost) be halved when G is balanced bipartite. They proved that a
bipartite graph G with n vertices in each partition class contains a Hamilton cycle if
δ(G) ≥ (n/2) + 1. A corresponding (bi)pancyclicity result was established by Schmeichel
and Mitchem [34] and balanced k-partite graphs were considered by Chen, Faudree,
Gould, Jacobson and Lesniak in [5]. For hypergraphs, Rödl and Ruciński [28] proved
that for all γ > 0 every suﬃciently large k-uniform hypergraph which is k-partite with n
vertices in each part, such that each (k − 1)-set of vertices, one from each partition class,
is contained in at least ( 21 + γ)n edges, contains a tight Hamilton cycle.
Our second result establishes asymptotically best possible codegree bounds for the
containment of tight cycles of a given length in the partite setting.
Theorem 2. For every positive δ and every integer k ≥ 3 there is an integer n∗ such
that the following holds for each α ∈ [0, 1]. If G is a k-uniform k-partite hypergraph with
parts of size n ≥ n∗ , such that any collection of k − 1 vertices, one in each of k − 1 parts
of G, lies in at least (α + δ)n edges of G, then
(a ) G contains a tight cycle of length ℓ for every ℓ ≤ αkn that is divisible by k, and
1There

are several other notions of cycles in hypergraphs. Since our results are about tight cycles we
concentrate on these here.
2

(b ) if α ≥ 21 then G contains a tight cycle of length ℓ for every ℓ ≤ (1 − δ)kn that is
divisible by k.
We believe that with substantial additional work part (b ) of this Theorem would also
follow from the proof in [28]. However, our new tools allow for a much simpler proof.
1.2. Regular slices. Brieﬂy, given an n-vertex graph G the Regularity Lemma returns
an equipartition of the vertices of G into a constant number of parts such that almost
all of the bipartite subgraphs induced by pairs of parts approximate random graphs.
This so-called regular partition can be represented by a constant size weighted graph,
the weighted reduced graph, in which the (weighted) density of copies of any small graph
approximates the density of copies in the original graph. In fact, we can use a regular
partition and the reduced graph also to ﬁnd copies of large bounded degree subgraphs
in G, among other things. In this way we can reduce diﬃcult extremal graph problems
to relatively simple problems on the weighted reduced graph. This approach to extremal
graph theory is called the regularity method.
It is then natural to ask for an analogue of regular partitions and reduced graphs
for hypergraphs. However, the partition returned by the Strong Hypergraph Regularity
Lemma is no longer given by a vertex partition and cannot be represented by a weighted
hypergraph. Instead, the partition has the structure of a weighted multi-complex with
edges of sizes up to and including k, which makes applications of the Strong Hypergraph
Regularity Lemma signiﬁcantly harder. Whilst simpler forms of hypergraph regularity
do exist (see [7, 19]), they are substantially less powerful for hypergraph embedding.
The Regular Slice Lemma (Lemma 6) that we propose in this paper for approaching
problems in extremal hypergraph theory bypasses these diﬃculties by taking a random
subcomplex of the weighted multi-complex returned by the Strong Hypergraph Regularity Lemma (after a considerable number of suitable modiﬁcations). Related ideas were
applied already by Haxell, Luczak, Peng, Rödl, Ruciński and Skokan [13]. The advantage
of this random subcomplex, which we call a regular slice, is that it does correspond to a
vertex partition and a weighted reduced hypergraph. The disadvantage of this approach
is that a regular slice discards most of the hyperedges of the original hypergraph. However, as our lemma asserts, a lot of information about the original hypergraph is still
captured: edge densities, and more generally small subgraph densities, minimum degree
and codegree conditions, and edge densities in link hypergraphs are approximated in
regular slices. Since these are exactly the type of conditions which typically appear in
extremal hypergraph theory we believe that regular slices will be useful for solving many
problems in this area.
1.3. Structure of the paper. In the next section we give the deﬁnitions needed to
work with hypergraphs, then in Section 3 we discuss lower bounds for Theorems 1 and 2.
Section 4 introduces the deﬁnitions required for and the statement of the Regular Slice
Lemma. It also includes the statement of a Cycle Embedding Lemma, which enables us
to apply the Regular Slice Lemma to prove our two main theorems. In Sections 5 and 6
we assume these results to prove Theorems 1 and 2 respectively. Section 7 deals with the
deﬁnitions and machinery of hypergraph regularity, while Section 8 contains the proof
of the Regular Slice Lemma, and in Section 9, we prove the Cycle Embedding Lemma.
We conclude with a discussion of open problems and possible further applications in
Section 10. Finally, Appendix A contains the derivation of the version of the Hypergraph
Counting Lemma we use, and Appendix B contains the proof of a variant of the Strong
Hypergraph Regularity Lemma which is used in the proof of the Regular Slice Lemma.
3

2. Preliminaries
A hypergraph consists of a vertex set V and an edge set E, where each edge e ∈ E is a
subset of V . We frequently identify a hypergraph H with its edge set, writing e ∈ H to
mean that e is an edge of H, and |H| for e(H), the number of edges of H. A k-uniform
hypergraph, or k-graph, is a hypergraph in which every edge has size k; it is ℓ-partite for
ℓ ≥ k if there exists a partition of the vertex set into ℓ parts so that every edge has at
most one vertex in each part. Given a hypergraph H, we denote by H(i) the i-graph on
V (H) formed by the i-edges of H, i.e. the edges of cardinality i, and write ei (H) := |H(i) |
for the number of such edges. The order of a hypergraph is the number of vertices
v(H) := |V (H)|. The degree of a set of i vertices in a k-graph, where 1 ≤ i ≤ k − 1, is
the number of edges containing all i vertices. In the case when i = k − 1 we talk of the
codegree. If H is a hypergraph on V , and V ′ ⊆ V , then the induced subgraph H[V ′ ] is the
hypergraph on V ′ whose edges are all e ∈ H with e ⊆ V ′ . A k-complex H is a hypergraph
in which all edges have size at most k, and which is down-closed: that is, if e ∈ H is
an edge, and e′ ⊆ e, then e′ ∈ H. Note that for any non-empty complex H we have
∅ ∈ H. We prefer the terms subgraph and subcomplex to subhypergraph, sub-i-graph, or
sub-k-complex.
Throughout this paper we will maintain the convention of using normal letters for
uniform hypergraphs, and calligraphic letters for not necessarily uniform hypergraphs
(which will usually be complexes). The exceptions to this rule are the deﬁnition of H(i)
above and of HX in Section 4: both deﬁne a speciﬁc uniform subgraph of a not necessarily
uniform hypergraph H.
Let G be a k-graph. A tight path in G is an ordered list of distinct vertices of G, such
that each set of k consecutive vertices induces an edge of G; a tight cycle is a cyclically
ordered list with the same property. The length of a tight path or cycle is the number of
edges in the path or cycle; the number of vertices in a tight cycle is therefore equal to its
length, whilst the number of vertices in a tight path is k − 1 greater than its length. We
will denote the tight cycle or path on ℓ vertices by Cℓ or Pℓ respectively.
Any k-graph G naturally corresponds to a k-complex G, whose edges are all subsets
′
e ⊆ e of edges e ∈ G. We refer to G as the complex generated by the down-closure of G.
We can then work with the k-complex G to obtain useful information about the k-graph
G. We say that a set S of k + 1 vertices of G is supported on G if every subset S ′ ⊆ S of
size k is an edge of G (i.e. S forms a clique in G). Similarly, we say that a (k + 1)-graph
G′ on V (G) is supported on G if every edge of G′ is supported on G. Note in particular
that if H is a k-complex, then H(i) is supported on H(i−1) for any 1 ≤ i ≤ k. 
We write [r] to denote the set {1, 2, . . . , r}. For a set A, we often write Ar to denote
the collection of subsets of A of size r. We use the notation x = a ± b to denote
a − b ≤ x ≤ a + b. If S(x, y) is a statement, we say ‘S(x, y) holds for x ≪ y’ if for any
y > 0 there exists x0 > 0 such that for any 0 < x ≤ x0 the statement S(x, y) holds;
similar expressions with more constants are deﬁned analogously. Throughout this paper
ﬂoors and ceilings are often omitted where they do not aﬀect the argument.

3. Lower bounds
3.1. Lower bounds for Theorem 1. Given a k-graph H, we deﬁne ex(n, H) to be
the maximum number of edges an n-vertex k-graph
 can have without containing
  H as a
subgraph. Then Theorem 1 says that ex n, Pαn , ex n, Cαn ≤ α + o(1) nk . We will
now establish several lower bounds on ex n, Pαn and ex n, Cαn .
4

Győri, Katona and Lemons [12] (who were interested in the case αn = ℓ where ℓ is
constant) observed that given any set system S on n vertices with sets of size at most
αn−1, no pair of which intersect in more than k −2 vertices, one can construct a k-graph
G without any tight path on αn = ℓ vertices by taking every k-set contained in a set of
S. In the event that all members of S have size exactly αn − 1 and every (k − 1)-set
in [n] is in some member of S, S is a combinatorial design and the corresponding G
n
has (αn − k) k−1
/k ≈ α nk edges. A celebrated recent result of Keevash [16] states
that for each ﬁxed αn = ℓ and k, these combinatorial designs exist for all suﬃciently
large n satisfying a necessary divisibility condition. Győri, Katona and Lemons (writing
before [16] appeared) used Rödl’s solution [27] of the Erdős-Hanani
Conjecture to prove,

for each δ > 0, the existence of hypergraphs with (1 − δ)α nk edges and no ℓ-vertex tight
path, provided
that n is
large compared to α. This provides the lower bound

 suﬃciently

ex n, Pαn ≥ 1 − o(1) α nk . Unfortunately both Keevash’s and Rödl’s proofs only work
when n is superexponentially large in ℓ, and it is easy to see that in fact no designs (or
even approximations to designs) can exist if ℓ ≫ n1/2 , so that this construction does not
work in the constant α range where Theorem 1 gives a non-trivial result.
A very similar construction gives G without tight cycles on ℓ or more vertices. Namely,
if there exists a set system S on n − 1 vertices with all sets of size ℓ − 2, covering each
(k − 1)-set exactly once, then we can construct a graph G whose edges are all k-sets
contained in members
of S together with all k-sets containing the nth vertex. We have

n−1
e(G) = ℓ−1
,
and
it is easy to check that G contains no tight cycle on ℓ or more
k
k−1
vertices. However, if we only want to exclude tight cycles on exactly ℓ vertices, we obtain

ex n, Cℓ ≥

k−1
 ℓ
1 1 ℓ−1 k−1+ ℓ−1
n
2 k!

by deleting an edge from each copy of Cℓ in the random k-graph with edge probability
p=

 1
2 k−ℓ ℓ−1
n
k!

.



A simple lower bound on both ex n, Pαn and ex n, Cαn is provided by the following
construction. Let G be the k-graph on vertex set V = A ∪˙ B,where |A| = αn/k − 1 and
|B| = (1 − α/k)n + 1, and whose edge set is E(G) := {e ∈ Vk : e ∩ A 6= ∅}. It is easy to
see that the longest tight path in G has at most k|A| + k − 1 < αn vertices (the longest
tight cycle is even slightly shorter). For large n, the number of edges in G is
! 
 
 
k
X


k
n
n
i
α
+ o(nk ) =
(−1)i−1
+ o(nk ) .
1 − (1 − αk )k
k
i
k
k
i=1


 
Hence ex n, Cαn , ex n, Pαn ≥ α + O(α2) nk , matching the ﬁrst order asymptotics in
Theorem 1 for small α.
Moreover, for each 2 ≤ r ≤ k, if αnr/k > (1 − α)n + 1, then the k-graph G on vertex
set V = A ∪˙ B, where |A| = αn − 1 and |B| = (1 − α)n + 1, with edge set consisting of all
k-sets either contained in A or with at least r vertices in B, contains no αn-vertex tight
cycle. The densest of these isthe construction with r = 2, which
 is permissible when
1 − α is small, giving ex n, Cαn ≥ 1 − kαk−1 (1 − α) + O(1/n) nk . (Minor modiﬁcations
of the construction give the same asymptotic bound for ex n, Pαn .) This tends to 1 as
1 − α tends to zero, but does not match the ﬁrst order asymptotics of Theorem 1.
Finally, we note that the divisibility condition on ℓ in Theorem 1 is necessary, at least
for α ≤ k!/k k , as can be seen by considering the complete k-partite k-graph with vertex
classes of size n/k.
5

3.2. Lower bounds for Theorem 2. Clearly Theorem 2 part (b ) is asymptotically best
possible. For part (a ), consider the following construction. Given the k-partite vertex
set V1 ∪ · · · ∪ Vk with |Vi | = n for each i and α ≤ 12 , we partition each Vi into sets Vi0 and
Vi1 of sizes respectively (1 − α)n and αn. We let a set of k vertices e, with one vertex
in each of V1j1 , . . . , Vkjk , where ji ∈ {0, 1} for each i ∈ [k], be an edge of the k-graph G if
and only if j1 + · · · + jk is odd. It is easy to check that the partite codegree condition of
Theorem 2 is almost satisﬁed, and similarly easy to check that a tight cycle with one edge
e whose vertices are in V1j1 , . . . , Vkjk must have all its vertices in V1j1 , . . . , Vkjk , from which
it follows that we cannot have tight cycles on more than k min(|V1j1 |, . . . , |Vkjk |) = kαn
vertices in G. This shows that Theorem 2 part (a ) is asymptotically best possible.
4. Regular Slices
In this section we state our Regular Slice Lemma. We ﬁrst need to introduce the
required notation. Much of this notation is standard, and will also be needed in Section 7
for the Strong Hypergraph Regularity Lemma. We will then state a Cycle Embedding
Lemma, which allows us to use the nice properties of regular slices to ﬁnd tight cycles in
a hypergraph satisfying the appropriate conditions.
4.1. Multipartite hypergraphs and regular complexes. Let P partition a vertex
set V into parts V1 , . . . , Vs . Then we say that a subset S ⊆ V is P-partite if |S ∩ Vi | ≤ 1
for every i ∈ [s]. Similarly, we say that a hypergraph H is P-partite if all of its edges are
P-partite. In this case we refer to the parts of P as the vertex classes of H. As deﬁned
previously for k-graphs, we say that a hypergraph H is s-partite if there is some partition
P of V (H) into s parts for which H is P-partite.
S
Let H be a P-partite hypergraph. Then for any A ⊆ [s] we write VA for i∈A Vi . The
index of a P-partite set S ⊆ V is i(S) := {i ∈ [s] : |S ∩ Vi | = 1}. We write HA to denote
the collection of edges in H with index A. So HA can be regarded as an |A|-partite
|A|-graph on vertex set VA , with vertex classes Vi for i ∈ A. It is often convenient to refer
to the subgraph induced by a set of vertex classes rather than with a given index; if X is
a k-set of vertex
classes of H we write HX for the k-partite k-uniform subgraph of H(k)
S
induced by X, whose vertex classes are the members of X. Note that HX =SH{i:Vi ∈X} .
In a similar S
manner we write HX < for the k-partite hypergraph on vertex set X whose
edge set is X ′ (X HX . Note that if H is a complex, then HX < is a (k − 1)-complex
because X is a k-set.
Let i ≥ 2, let Hi be any i-partite i-graph, and let Hi−1 be any i-partite (i−1)-graph, on
a common vertex set V partitioned into i common vertex classes. We denote by Ki (Hi−1 )
the i-partite i-graph on V whose edges are all i-sets in V which are supported on Hi−1
(i.e. induce a copy of the complete (i − 1)-graph Kii−1 on i vertices in Hi−1 ). The density
of Hi with respect to Hi−1 is then deﬁned to be
d(Hi |Hi−1 ) :=

|Ki (Hi−1 ) ∩ Hi |
|Ki (Hi−1 )|

if |Ki (Hi−1 )| > 0. For convenience we take d(Hi |Hi−1 ) := 0 if |Ki (Hi−1 )| = 0. So
d(Hi |Hi−1) is the proportion of copies of Kii−1 in Hi−1 which are also edges of Hi . When
Hi−1 is clear from the context, we simply refer to d(Hi |Hi−1 ) as the relative density of
Hi . More generally, if Q := (Q1 , Q2 , . . .S, Qr ) is a collection of r not necessarily disjoint
subgraphs of Hi−1 , we deﬁne Ki (Q) := rj=1 Ki (Qj ) and
d(Hi |Q) :=

|Ki (Q) ∩ Hi |
|Ki (Q)|
6

if |Ki (Q)| > 0. Similarly as before we take d(Hi |Q) := 0 if |Ki (Q)| = 0. We say that
Hi is (di , ε, r)-regular with respect to Hi−1 if we have d(Hi |Q) = di ± ε for every r-set
Q of subgraphs of Hi−1 such that |Ki (Q)| > ε|Ki (Hi−1 )|. We often refer to (di , ε, 1)regularity simply as (di , ε)-regularity; also, we say simply that Hi is (ε, r)-regular with
respect to Hi−1 to mean that there exists some di for which Hi is (di , ε, r)-regular with
respect to Hi−1 . Finally, given an i-graph G whose vertex set contains that of Hi−1 , we
say that G is (di , ε, r)-regular with respect to Hi−1 if the i-partite subgraph of G induced
by the vertex classes of Hi−1 is (di , ε, r)-regular with respect to Hi−1 . Similarly as before,
when Hi−1 is clear from the context, we refer to the relative density of this i-partite
subgraph of G with respect to Hi−1 as the relative density of G.
Now let H be an s-partite k-complex on vertex classes V1 , . . . , Vs , where s ≥ k ≥ 3.
Recall that this means that if e ∈ H and e′ ⊆ e then e′ ∈ H. So if e ∈ H(i) for some
2 ≤ i ≤ k, then the
a copy of Kii−1 in H(i−1) . This means that for
 vertices of e induce
[s]
any index A ∈ i the density d(H(i) [VA ]|H(i−1) [VA ]) can be regarded as the proportion
of ‘possible edges’ of H(i) [VA ] which are indeed edges. (Here a ‘possible edge’ is a subset
of V (H) of index A all of whose proper subsets are edges of H). We therefore say that H
is (dk , . . . , d2 , εk , ε, r)-regular if

(a ) for any 2 ≤ i ≤ k − 1 and any A ∈ [s]i , the induced subgraph H(i) [VA ] is (di , ε)regular with respect to H(i−1) [VA ], and

(b ) for any A ∈ [s]
, the induced subgraph H(k) [VA ] is (dk , εk , r)-regular with respect
k
to H(k−1) [VA ].
So each constant di approximates the relative density of each subgraph H(i) [VA ] for A ∈
[s]
for which H(i) [VA ] is non-empty. For a (k − 1)-tuple d = (dk , . . . , d2 ) we write
i
(d, εk , ε, r)-regular to mean (dk , . . . , d2, εk , ε, r)-regular. A regular complex is the correct
notion of ‘approximately random’ for hypergraph regularity.

4.2. Regular slices and the reduced k-graph. The Regular Slice Lemma says that
any k-graph G admits a ‘regular slice’. This is a multipartite (k − 1)-complex J whose
vertex classes have equal size, which is regular, and which moreover has the property that
G is regular with respect to J . The ﬁrst two of these conditions are formalised in the
following deﬁnition: we say that a (k − 1)-complex J is (t0 , t1 , ε)-equitable if it has the
following properties.
(a ) J is P-partite for some P which partitions V (J ) into t parts, where t0 ≤ t ≤ t1 , of
equal size. We refer to P as the ground partition of J , and to the parts of P as the
clusters of J .
(b ) There exists a density vector d = (dk−1 , . . . , d2 ) such that for each 2 ≤ i ≤ k − 1 we
have di ≥ 1/t1 and 1/di ∈ N, and the (k − 1)-complex J is (d, ε, ε, 1)-regular.
(k−1)
For any k-set X of clusters of J , we write JˆX for the k-partite (k − 1)-graph JX < .
For reasons that will become apparent later, we sometimes refer to JˆX as a polyad. The
following well-known fact, a special case of the Dense Counting Lemma (see [20, Theorem
6.5]), tells us approximately the number of edges in each layer of J , and also how many
k-sets are supported on any polyad. Note that the deﬁnition of an equitable complex
implies that ε ≪ 1/t1 ≤ di in this fact.
Fact 3. Suppose that 1/m0 ≪ ε ≪ 1/t1 , 1/t0 , β, 1/k, and that J is a (t0 , t1 , ε)-equitable
(k − 1)-complex with density vector (dk−1 , . . . , d2) whose clusters each have size m ≥ m0 .
7

Let X be a set of k clusters of J . Then
|Kk (JˆX )| = (1 ± β)mk
′

and for any proper subset X ( X we have

k−1
Y

(k )
di i ,

i=2

′

|X ′ |

|JX ′ | = (1 ± β)m

|X |
′
Y
(|Xi |)
.
di
i=2



Given a (t0 , t1 , ε)-equitable (k −1)-complex J and a k-graph G on V (J ), we say that G
is (εk , r)-regular with respect to a k-set X of clusters of J if there exists some d such that
G is (d, εk , r)-regular with respect to the polyad JˆX . We also write d∗J (X) for the relative
density of G with respect to JˆX , or simply d∗ (X) if J is clear from the context, which will
usually be the case in applications. Note in particular that Fact 3 then implies that the
Qk−1 (ki)
di .
number of edges of G which are supported on JˆX is approximately d∗ (X)mk i=2
We now give the key deﬁnition of the Regular Slice Lemma.

Definition 4 (Regular slice). Given ε, εk > 0, r, t0 , t1 ∈ N, a k-graph G and a (k − 1)complex J on V (G), we call J a (t0 , t1 , ε, εk , r)-regular slice for G if J is (t0 , t1 , ε)equitable and G is (εk , r)-regular with respect to all but at most εk kt of the k-sets of
clusters of J , where t is the number of clusters of J .
It will sometimes be convenient not to specify all of the parameters: we may write that
J is (·, ·, ε)-equitable, or is a (·, ·, ε, εk , r)-slice for G, if we do not wish to specify t0 or t1
(as will be the case if we specify instead the density vector d and the number of clusters
t).
Given a regular slice J for a k-graph G, it will be important to know the relative
densities d∗ (X) for k-sets X of clusters of J . To keep track of these we make the
following deﬁnition.

Definition 5 (Weighted reduced k-graph). Given a k-graph G and a (t0 , t1 , ε)-equitable
(k−1)-complex J on V (G), we let RJ (G) be the complete weighted k-graph whose vertices
are the clusters of J , and where each edge X is given weight d∗ (X) (in particular, the
weight is in [0, 1]). When J is clear from the context we often simply write R(G) instead
of RJ (G).
In applications we will usually take J to be a regular slice for G. In this case we
will want to ensure that G is regular with respect to all k-sets X of clusters of J with
d∗ (X) > 0, which can be achieved by the simple expedient of deleting all edges of G
lying in k-sets with respect to which G is not regular; the deﬁnition of a regular slice
implies that there are few such edges. The reason that we do not specify this in the
deﬁnition of a regular slice, or specify that only k-sets with respect to which G is regular
are given positive weight in the weighted reduced graph, is that we will also make use
of this deﬁnition in the process of proving that a certain equitable (k − 1)-complex is in
fact a regular slice. Note that although diﬀerent choices of J may well produce diﬀerent
weighted reduced k-graphs (and only some of these will have ‘good’ properties), since J
will always be clear from the context we will speak of ‘the’ reduced k-graph R(G) of G.
In general, it is not very helpful to know that J is a regular slice for a k-graph G; the
reduced graph of G with respect to J does not necessarily resemble G in the way that the
reduced 2-graph of a 2-graph H with respect to a Szemerédi partition resembles H. The
8

Regular Slice Lemma states that there is a regular slice J with respect to which R(G)
does resemble G, in the sense that densities of small subgraphs (part (a ) of the Regular
Slice Lemma) and degree conditions (part (b )) are preserved. Furthermore, all vertices of
G are in some sense ‘represented’ on J (part (c ))—this is useful for embedding spanning
subgraphs. In order to make this precise, we need the following further deﬁnitions.
Given hypergraphs G and H, we write nH (G) for the number of labelled copies of H
in G. In order to extend this deﬁnition to weighted k-graphs G, we let
X
Y

nH (G) :=
d∗ φ(e)
φ:V (H)→V (G) e∈E(H)

where φ ranges over all injective maps and d∗ is the weight function on E(G). We then
deﬁne the H-density of G as
nH (G)
dH (G) := v(G) 
.
·
v(H)!
v(H)
Q
In other words, dH (G) is the expectation of e∈E(H) d∗ (φ(e)) for an injective map φ :
V (H) → V (G) chosen uniformly at random. In the special case that H consists of a
single edge, we will write simply d(G), and speak of the density of G or the edge-density
of G.
Now let G be a k-graph on n vertices. Given a set S ⊆ V (G) of size j for some
1 ≤ j ≤ k − 1, and a subset X ⊆ V (G), the relative degree deg(S; G, X) of S in X with
respect to G is deﬁned to be


{e ∈ G[S ∪ X] : S ⊆ e}
.
deg(S; G, X) :=

|X\S|
k−j

In other words, deg(S; G, X) is the proportion of k-sets of vertices of G[X ∪ S] extending
S which are in fact edges of G. To extend this deﬁnition to weighted k-graphs G, we
replace the number of edges in G[X ∪ S] including S with the sum of the weights of edges
of G[X ∪ S] including S. Finally, if S is a collection of j-sets in V (G), then deg(S; G, X)
is deﬁned to be the mean of deg(S; G, X) over all sets S ∈ S.
Given a k-graph G and distinct ‘root’ vertices v1 , . . . , vℓ of G, and a k-graph H equipped
with a set of distinct ‘root’ vertices x1 , . . . , xℓ , we deﬁne the number of labelled rooted
copies of H in G, written nH (G; v1 , . . . , vℓ ), to be the number of injective maps from
V (H) to V (G) which embed H in G and take xj to vj for each 1 ≤ j ≤ ℓ. Then the
density of rooted copies of H in G is deﬁned to be
nH (G; v1 , . . . , vℓ )
dH (G; v1 , . . . , vℓ ) := v(G)−ℓ 
 .
·
v(H)
−
ℓ
!
v(H)−ℓ
This density has a natural probabilistic interpretation: choose uniformly at random
an injective map ψ : V (H) → V (G) such that ψ(xj ) = vj for every j ∈ [ℓ]. Then
dH (G; v1 , . . . , vℓ ) is the probability that ψ embeds H in G. Next, we deﬁne Hskel to be
the (k − 1)-complex on V (H) − ℓ vertices which is obtained from the complex H generated by the down-closure of H by deleting the vertices x1 , . . . , xℓ (and all edges containing
them) and deleting all edges of size k. Given a (t0 , t1 , ε)-equitable (k − 1)-complex J
on V (G), the number of rooted copies of H supported by J , written nH (G; v1 , . . . , vℓ , J ),
is deﬁned to be the number of labelled rooted copies of H in G such that each vertex
of Hskel lies in a distinct cluster of J and the image of Hskel is in J (but note that we
do not require the edges involving v1 , . . . , vℓ to be contained in or supported by J , and
indeed typically they will not be). We also deﬁne n′Hskel (J ) to be the number of labelled
9

copies of Hskel in J with each vertex of Hskel embedded in a distinct cluster of J . Then
the density dH (G; v1 , . . . , vℓ , J ) of rooted copies of H in G supported by J is then deﬁned
by
nH (G; v1 , . . . , vℓ , J )
dH (G; v1 , . . . , vℓ , J ) :=
.
n′Hskel (J )

Again we have a natural probabilistic interpretation: let ψ : V (Hskel ) → V (G) be an
injective map chosen uniformly at random, and extend ψ to a map ψ ′ : V (H) → V (G)
by taking ψ ′ (xi ) = vi for each i ∈ [ℓ]. Then dH (G; v1 , . . . , vℓ , J ) is the conditional
probability that ψ ′ embeds H in G given that ψ embeds Hskel in J with each vertex
of Hskel embedded in a diﬀerent cluster of J .
We can now state the Regular Slice Lemma. We remark that for many applications it
suﬃces to take q = s = 1, with Q being the trivial partition of V with one part.
Lemma 6 (Regular Slice Lemma). Let k ≥ 3 be a fixed integer. For all positive integers
q, t0 and s, positive εk and all functions r : N → N and ε : N → (0, 1], there are integers t1
and n0 such that the following holds for all n ≥ n0 which are divisible by t1 !. Let V be a
set of n vertices, and suppose that G1 , . . . , Gs are edge-disjoint k-graphs on V , and that Q
is a partition of V into at most q parts of equal size. Then there exists a (k − 1)-complex
J on V which is a (t0 , t1 , ε(t1 ), εk , r(t1))-regular slice for each Gi , such that the ground
partition P of J refines Q, and such that J has the following additional properties.
(a ) For each 1 ≤ i ≤ s, any k-graph H with v(H) ≤ 1/εk and each set X of at least εk t
clusters of J (where t is the total number of clusters of J ), we have

 h[ i


X  < εk .
dH (R(Gi )[X]) − dH Gi
(b ) For each 1 ≤ i ≤ s, each 1 ≤ S
j ≤ k − 1, each set Y of j clusters of J , and each set
X of clusters of J for which X is the union of some parts of Q, we have
[ 

deg(Y ; R(Gi ), X) − deg(JY ; Gi , X) < εk .
(c ) For each 1 ≤ i ≤ s, each 1 ≤ ℓ ≤ 1/εk , each k-graph H equipped with a set of
distinct root vertices x1 , . . . , xℓ such that v(H) ≤ 1/εk , and any distinct vertices
v1 , . . . , vℓ in V , we have


dH (Gi ; v1 , . . . , vℓ , J ) − dH (Gi ; v1 , . . . , vℓ ) < εk .

To understand this lemma consider ﬁrst the special case of regularising only one graph
G = G1 , i.e. s = 1, with Q being the trivial partition with one part, i.e. q = 1, and
where (for properties (a ) and (c )) H consists of a single edge (in the latter case, rooted
at one vertex v). Then the result is that J is a regular slice for G, with not too few
clusters (bounded below by t0 ) but also not too many (bounded above by t1 ), with very
strong regularity properties (typically ε is much smaller than any density di ) and G is
(εk , r)-regular with respect to J . This looks so far very much like the ‘usual’ hypergraph
regularity (see Lemma 20 later for a statement) except that the statement that G is
regular with respect to J says something only about a very small part of G. Then
property (a ) states that R(G) ‘looks like’ G in that edge densities on large sets agree.
Property (b ) tells us that degree conditions on G transfer to R(G). Finally property (c )
says: for every vertex v of G, the fraction of (k − 1)-sets of V (G) which make edges with
v is close to the fraction of (k − 1)-edges of J which make edges with v. That is, vertex
degrees in G are inherited when we consider only extensions supported on J .
We note that it is often necessary to estimate (for example) the number of edges of G
which have one vertex in each of some pairwise-disjoint sets X1 , . . . , Xk rather than just
10

the number of edges in a set X: provided that each of the Xi is large, it follows by use of
the inclusion-exclusion principle and the ability conferred by (a ) to estimate the number
of edges in a large set X that we can also make such estimates.
For embedding subgraphs, it is important to distinguish dense regular k-sets (i.e. ksets on which G is dense and regular with respect to J ). In order to state our Cycle
Embedding Lemma we therefore give the following variation of the deﬁnition of the
reduced graph.
Definition 7 (The d-reduced k-graph). Let G be a k-graph and let J be a (t0 , t1 , ε, εk , r)regular slice for G. Then for d > 0 we define the d-reduced k-graph Rd (G) to be the
k-graph whose vertices are the clusters of J and whose edges are all k-sets X of clusters
of J such that G is (εk , r)-regular with respect to X and d∗ (X) ≥ d.
The next lemma states that for regular slices J from Lemma 6, H-densities and degrees
are also preserved by Rd (G), allowing us to work with this structure also.
Lemma 8. Let G be a k-graph and let J be a (t0 , t1 , ε, εk , r)-regular slice for G with t
clusters. Also let X be a set of clusters of J . Then for any k-graph H we have



εk e(H) kt
dH Rd (G)[X] ≥ dH R(G)[X] − d −
 ,
|X|
k

and for any set Y of at most k − 1 clusters of J we have

deg(Y ; Rd (G), X) ≥ deg(Y ; R(G), X) − d − ζ(Y ),

where ζ(Y ) is defined to be the proportion of k-sets of clusters Z with Y ⊆ Z ⊆ Y ∪ X
which are not (εk , r)-regular with respect to G.
Proof. Observe that we can transform R(G) to Rd (G) by editing the edge-weights of R(G)
in three stages. First, for any edge S of R(G) with d∗ (S) ≥ d, we increase the weight of S
from d∗ (S) to 1. Second, for any edge S of R(G) with d∗ (S) < d, we decrease the weight
of S from d∗ (S) to zero. Finally, for any edge S of R(G) such that G is not (εk , r)-regular
with respect to S, we reduce theweight of S to zero. Note that the number of k-sets S
of the latter type is at most εk kt since J is a (t0 , t1 , ε, εk , r)-regular slice for G.
To prove the ﬁrst equation,
we consider the eﬀect of each of these changes
on the

Q
∗
quantity dH R(G)[X] . Recall that this was deﬁned to be the average of e∈H d (φ(e))

taken over all the |X|
h! injections φ : V (H) → X, where h := |V (H)|. If the weight of
h
any edge of R(G) is increased, this average cannot decrease. Likewise, if the weights of
any subset of edges of R(G) are decreased from at most d to zero, then this average will
decrease by at most d also. Finally, if the
of some set of m chosen edges of R(G)
Q weights
∗
are reduced to zero, then this reduces e∈H d (φ(e)) by at most one for each of the at

most e(H)m |X|−k
(h − k)!k! injections φ for which φ(e) is a chosen edge for some e ∈ H.
h−k

So dH R(G)[X] decreases by at most

e(H)m |X|−k
(h − k)!k!
e(H)m
h−k
=

 .
|X|
|X|
h!
h
k
Combining these changes for the three steps described above, we obtain the ﬁrst equation.
Similarly, for the second equation we consider the eﬀect of each change on the quantity
deg(Y ; R(G), X), which was deﬁned to be the average of d∗ (Z) over all k-sets Z with
Y ⊆ Z ⊆ Y ∪ X. As before, increasing the weight of any edge of R(G) cannot cause
this average to decrease, and decreasing the weights of any subset of edges of R(G) by
at most d will cause this average to decrease by at most d. Finally, since d∗ (Z) must be
11

between zero and one for any Z, reducing the weight of a ζ-proportion of the k-sets Z to
zero will reduce this average by at most ζ; combining these changes for the three steps
gives the second equation.

4.3. Cycle Embedding Lemma. A standard and very useful result (originally proved
by Luczak [22]) in extremal graph theory is that for all d > 0 and suﬃciently small
ε > 0, the following holds. Given a graph G and a partition of V (G) into clusters of
equal size, let Rd (G) be the graph whose vertices correspond to clusters and where an
edge indicates that the bipartite graph induced by the corresponding clusters is ε-regular
with density at least d. If there is a connected component of Rd (G) which contains a
matching covering at least (α + d)v(Rd(G)) of the vertices of Rd (G), then there are paths
and even cycles in G of each length up to αv(G). In fact, a stronger result is true, as
observed by Hladký, Král’ and Piguet (see [6], where this idea was also used): we need
only a fractional matching with weight (α + d)v(Rd (G)). In this subsection we state the
corresponding result for tight paths and cycles in k-graphs.
Let G be an n-vertex k-graph. Then a matching in G is a set M ⊆ E(G) of vertexdisjoint edges of G, and the matching number ν(G) denotes the maximum size of a
matching in G. A fractional matching M in G assigns
P a weight we ∈ [0, 1] to each edge
e ∈ G so that for every vertex v ∈ V (G) we have e: v∈e we ≤ 1. The weight of M is
the sum of all the edge weights, which must lie between zero and n/k. We say that M is
perfect if it has weight n/k.
Next, we deﬁne a tight walk W in G to be a sequence of vertices of G such that each
set of k consecutive vertices induces an edge of G. For edges e, f ∈ G we say that W
is a walk from e to f if W begins with the vertices of e (in some order) and concludes
with the vertices of the vertices of f (in some order). If such a walk exists then we say
that e and f are tightly connected. This gives an equivalence relation on the edges of G.
To see this, observe that if e and f are edges of G with |e ∩ f | = k − 1, then given
any (k − 1)-tuple in e and (k − 1)-set in f , there is a tight walk in G whose ﬁrst k − 1
vertices are the chosen (k − 1)-tuple in e (in order) and whose last k − 1 vertices are the
chosen (k −1)-set in f (in some order which we cannot choose). Applying this observation
repeatedly establishes the transitivity of the ‘tightly connected’ relation, and moreover
shows that the observation still holds if we replace the assumption |e ∩ f | = k − 1 by the
weaker assumption that e and f are tightly connected in G. A tight component of G is
an equivalence class of this relation, that is, an edge maximal set C ⊆ G such that each
pair e, f of edges in C are tightly
S connected (recall we identify this edge set with the
subgraph of G with vertex set C and edge set C). A tightly connected matching in G
is a matching in which all edges are tightly connected (that is, they all lie in the same
tight component of G). Finally, a tightly connected fractional matching is a fractional
matching in which the same is true of all edges of non-zero weight.
We can now state our main embedding result, which we prove in Section 9.
Lemma 9 (Cycle Embedding Lemma). Let k, r, n0 , t be positive integers, and ψ, d2 , . . . , dk , ε, εk
be positive constants such that 1/di ∈ N for each 2 ≤ i ≤ k −1, and such that 1/n0 ≪ 1/t,
1
1
≪ , ε ≪ εk , d2 , . . . , dk−1
n0
r

and

εk ≪ ψ, dk ,

1
.
k

Then the following holds for all integers n ≥ n0 . Let G be a k-graph on n vertices, and
J be a (·, ·, ε, εk , r)-regular slice for G with t clusters and density vector (dk−1, . . . , d2 ).
Suppose that Rdk (G) contains a tightly connected fractional matching with weight µ. Then
G contains a tight cycle of length ℓ for every ℓ ≤ (1 − ψ)kµn/t that is divisible by k.
12

5. Erdős-Gallai for hypergraphs
In this section we aim to demonstrate the value of the tools presented in the previous
section by proving Theorem 1.
Our strategy is simple: by Lemmas 6 and 9 it is enough to show that any k-graph G
with edge density α contains a tightly connected matching with at least αv(G)/k edges.
To obtain this, we show (Proposition 10) that any G with edge density α contains a tight
component G∗ with ek (G ∗ ) ≥ αek−1 (G ∗ ), and then that any k-graph which satisﬁes this
inequality contains the desired matching (Lemma 11).
We ﬁrst justify our assertion that there is a dense tight component.
Proposition 10. Let G be a k-graph on n vertices. Then there is a tight component G∗
of G such that
ek−1 (G ∗ )
 e(G),
ek (G ∗ ) ≥
n
k−1

where G ∗ denotes the k-complex generated by the down-closure of G∗ .

Proof. Let G1 , . . . , Gs be the tight components of G, and let Gi denote the k-complex
generated by the down-closure of Gi . Fix ℓP
∈ [s] which maximises
 ek (Gℓ )/ek−1 (Gℓ ). By
n
the deﬁnition of tight components we have i∈[s] ek−1 (Gi ) ≤ k−1
. Hence


X
ek (Gℓ )
n
ek (Gℓ ) X
.
ek−1 (Gi ) ≤
e(G) =
ek (Gi ) ≤
ek−1 (Gℓ )
ek−1 (Gℓ ) k − 1
i∈[s]

i∈[s]



We next state the lemma guaranteeing that a dense k-graph has a large matching.
Lemma 11. Let k, r be any natural numbers and let G be a k-complex in which
(1)

Then ν G


(k)

≥ r.

ek (G) ≥ (r − 1)ek−1 (G) + 1 .

The proof of this lemma proceeds inductively and uses a classical concept from extremal
set theory called compression. Let H be a hypergraph on vertex set [n], and choose
i, j ∈ [n] with i < j. Then the ij-compression Sij performs the following operation on
H. For every edge e ∈ E(H) such that i ∈
/ e, j ∈ e and {i} ∪ e \ {j} ∈
/ E(H), delete e
from E(H) and replace it by {i} ∪ e \ {j}. We denote the resulting hypergraph by Sij (H).
If Sij (H) = H for every i < j, then we say that H is fully-compressed.
The next proposition sets out various properties of compressions of complexes which
we shall use.
Proposition 12. Let H be a k-complex on vertex set [n]. Then for any 1 ≤ i < j ≤ n
we have that
(a ) Sij (H) is a k-complex with eℓ (Sij (H)) = eℓ (H) for any ℓ,

(b ) ν Sij (H(k) ) ≤ ν(H(k) ), and
(c ) if H is fully-compressed, then for any edge e ∈ H such that j ∈ e and i ∈
/ e we have
that {i} ∪ e \ {j} ∈ H.
Proof. (a ) is immediate from the deﬁnition, whilst (b ) follows from Lemma 2.1 in [14],
or is easy to prove directly. Finally (c ) follows since in this case Sij (H) = H.

The second proposition needed to prove Lemma 11 shows that if G satisﬁes (1) and
some edge of G is contained in few higher-level edges of G, then removing this edge and
all edges containing it from G gives a subcomplex which also satisﬁes (1).
13

Proposition 13. Let k, r be any natural numbers and let G be a k-complex in which
ek (G) ≥ (r − 1)ek−1 (G) + 1. Fix 0 ≤ j ≤ k − 1, and suppose that e ∈ E(G (j) ) lies in fewer
than (k − j)r edges of G (j+1) . Let G ′ be the k-complex obtained by deleting e and any edge
of G which contains e from G. Then ek (G ′ ) ≥ (r − 1)ek−1 (G ′ ) + 1.
To prove this we use the local LYM inequality, which can be found in e.g. [3].

Theorem 14 (Local LYM inequality). Let G be an i-complex on n vertices. Then
i
ei−1 (G) ≥ n−i+1
ei (G).

Proof of Proposition 13. Let A = {x ∈ V (G) : e ∪ {x} ∈ G (j+1) }. By assumption we
have |A| ≤ (k − j)r − 1. Let H be the (k − j)-complex on vertex set A with edge set
{e′ \ e : e ⊆ e′ ∈ G}. Note that when we delete e and all edges containing it from G,
we delete exactly d := ek−j (H) edges from G (k) and exactly d′ := ek−j−1(H) edges from
G (k−1) . By Theorem 14,
d′
ek−j−1 (H)
k−j
k−j
=
≥
≥
d
ek−j (H)
|A| − k + j + 1
(k − j)r − 1 − k + j + 1
k−j
1
=
=
.
(k − j)(r − 1)
r−1
Thus the complex G ′ obtained from our deletions satisﬁes
ek (G ′ ) = ek (G) − d ≥ ek (G) − (r − 1)d′
≥ (r − 1)ek−1 (G) + 1 − (r − 1)d′ = (r − 1)ek−1 (G ′ ) + 1

where we used the assumption that ek (G) ≥ (r − 1)ek−1 (G) + 1 for the second inequality.

The case j = 0 of Proposition 13 immediately gives the following corollary, which we
use in the proof of Lemma 11.
Corollary 15. Let k, r be any natural numbers and let G be a k-complex in which ek (G) ≥
(r − 1)ek−1 (G) + 1. Then |V (G)| ≥ kr.

We now give the proof of Lemma 11.

Proof of Lemma 11. Let G be a k-complex on vertex set [n] in which ek (G) ≥ (r −
1)ek−1 (G) + 1. First, we perform repeatedly the following two operations. If for some
ℓ ∈ [k − 1] there is an edge e ∈ G (ℓ) which is contained in fewer than (k − ℓ)r edges
of G (ℓ+1) , we delete it and all its supersets from G. If there are 1 ≤ i < j ≤ n such
that Sij (G) 6= G then we replace G with Sij (G). Eventually we reach a complex H where
neither operation is possible.
Observe that Proposition 12 part (a ) and Proposition 13 together tell us that, since
we started with a complex G satisfying (1), H satisﬁes (1) also. Moreover, Proposition 12
part (b ) together with the trivial fact that deleting edges from a complex does not increase

the matching number of any level of the complex implies that ν H(k) ≤ ν G (k) . By
deﬁnition, H is fully-compressed. Now given 1 ≤ ℓ ≤ k − 1, let e be an edge of H(ℓ) .
Because e is in H, there are at least (k −ℓ)r edges of H(ℓ+1) containing e, and in particular
there is some j ≥ (k − ℓ)r such that e ∪ {j} is in H(ℓ+1) . Now Proposition 12 part (c )
states that for any i < j with i ∈
/ e we have {i} ∪ e ∪ {j} \ {j} ∈ H(ℓ+1) , and thus we have


(2)
{i} ∪ e ∈ H(ℓ+1) for each i ∈ (k − ℓ)r such that i ∈
/ e.
We will now show by induction on ℓ that the ℓ-edges

	
eℓ,m := (k − ℓ)r + m, (k − ℓ + 1)r + m, . . . , (k − 1)r + m
14

for m = 1, . . . , r form a matching in H(ℓ) . Note that for any ℓ ∈ [k] the sets eℓ,m for
m ∈ [r] are by deﬁnition pairwise-disjoint; it remains to show that all eℓ,m are edges of
H.
The base case ℓ = 1 is trivial, since we are looking only for distinct vertices, and the
singletons (k − 1)r + 1, (k − 1)r + 2, . . . , kr are in H by Corollary 15.
Now for some 1 ≤ ℓ ≤ k − 1 and m ∈ [r] suppose that eℓ,m is an edge of H(ℓ) . Let
i = (k − ℓ − 1)r + m ≤ (k − ℓ)r. By deﬁnition we have i ∈
/ eℓ,m , and so by (2) we have
(ℓ+1)
eℓ+1,m = {i} ∪ eℓ,m ∈ H
, as desired.

We conclude that the sets ek,m for m ∈ [r] form a matching in H(k) , so r ≤ ν H(k) ≤
ν G (k) as desired.

We note that Lemma 11 is tight. Indeed, for any k and r, let K be the k-complex
(k)
generated by the down-closure of the complete k-graph Kkr−1 on kr − 1 vertices. Then




kr − 1
kr − 1
= (r − 1)ek−1(K) ,
= (r − 1)
ek (K) =
k−1
k

and ν K(k) = r − 1.
We can now complete our proof of Theorem 1, which we restate for the convenience of
the reader.

Theorem 1. For every positive δ and every integer k ≥ 3, there is an integer n∗ such
that the following holds for all
 α ∈ [0, 1]. If G is a k-uniform hypergraph on n ≥ n∗
n
vertices with e(G) ≥ (α + δ) k , then G contains a tight cycle of length ℓ for every ℓ ≤ αn
that is divisible by k.

Proof. Given k ≥ 3 and δ > 0, we choose dk = δ/3, t0 = 24k/δ and ψ = δ/8. We
let εk ≤ δ/12 be suﬃciently small for Lemma 9. We choose functions ε(·) tending to
zero suﬃciently rapidly, and r(·) growing suﬃciently rapidly, so that for any t ∈ N and
d2 , . . . , dk−1 ≥ 1/t we may apply Lemma 9 with r(t), ε(t). Obtain t1 and n0 by applying
Lemma 6 with inputs t0 , εk , r(·) and ε(·) (taking q = s = 1); for the rest of this proof we
write r and ε for r(t1 ) and ε(t1 ) respectively. Then by Lemma 6, for any k-graph G on n
vertices, where
 n ≥ n0 is divisible by t1 !, there is a (t0 , t1 , ε, εk , r)-regular slice for G such
that d R(G) ≥ d(G) − εk . Finally, we choose n1 ≥ n0 suﬃciently large for us to apply
Lemma 9 with t1 in place
of t, n1 in place of n0 and all other constants as above, and

n1
also such that t1 ! k−1 < δ nk1 /12.
′
Set n∗ := n1 + t1 !, and let G′ be a k-graph on n′ ≥ n∗ vertices with e(G′ ) ≥ (α + δ) nk .
Delete at most t1 ! − 1 vertices from G′ to obtain a k-graph G on n vertices,
where n

is divisible by t1 !. By choice of n1 we have e(G) ≥ (α + 11δ/12) nk . So Lemma 6
gives us a (t0, t1 , ε, εk , r)-regular slice J for G with t clusters (where t0 ≤ t ≤ t1 ) such

that d R(G)
≥
d(G)
−
ε
≥
α
+
10δ/12.
Finally
by
Lemma
8
we
have
d
R
(G)
≥
k
d
k

d R(G) − dk − εk ≥ α + 5δ/12.

The total number of edges in Rdk (G) is therefore at least (α + 5δ/12) kt . It follows by
Proposition 10 that there is a tight component R of Rdk (G) such that the k-complex R
generated by the down-closure of R satisﬁes

 


ek−1 (R)
t−k+1
5δ
t
5δ

ek (R) ≥
=
α+
α+
ek−1 (R)
t
k
12
k
12
k−1


ek−1 (R)
4δ
t
≥ α+
12
k
where the ﬁnal inequality is guaranteed by t ≥ t0 = 24k/δ.
15

By Lemma 11 it follows that R contains a matching of at least (α + δ/4)t/k edges.
Since this matching is contained in R it is tightly connected. Lemma 9 then implies
that

G contains a tight cycle of length ℓ for every ℓ at most (1 − ψ)k (α + δ/4)t/k n/t ≥ αn
which is divisible by k (where the inequality follows from ψ = δ/8).

6. Cycles in k-partite hypergraphs
In this section we will prove Theorem 2. As in the previous section, our strategy is
to show that the partite codegree condition implies the existence of a suﬃciently large
(this time fractional) matching in a connected component of Rd (G), after which applying
Lemma 9 will give the existence of the desired tight paths and cycles in G. Unfortunately,
while the minimum codegree of G transfers to R(G) by Lemma 6, as we saw in Lemma 8
it does not transfer perfectly to Rd (G): some (k − 1)-sets of clusters may lie in many
irregular k-sets of clusters, and so have small relative degree in Rd (G). To handle this,
we follow the approach of Keevash and Mycroft [18], moving to non-uniform hypergraphs
R in which an edge of R(k−1) corresponds to a (k − 1)-set of Rd (G) which does acquire
the desired codegree from G, and the presence of an edge of R of size j < k − 1 implies
that most of the (j + 1)-supersets of this edge are also edges. The hypergraph-theoretic
core of our proof of Theorem 2 is Lemma 17; to prove this we use the following special
case of Lemma 7.2 of [18], which was proved by a straightforward application of Farkas’s
Lemma.
Lemma 16. Let H be a k-partite hypergraph whose parts X1 , . . . , Xk each have size t.
Suppose that ∅ ∈ H and that for any 0 ≤ i ≤ k − 1 and j ∈ [k], any edge of H(i) which
does not intersect Xj is contained in at least t − it/k edges of H(i+1) which do intersect
Xj . Then H(k) admits a perfect fractional matching.

Lemma 17. Given 0 ≤ α < 1 and β > 0, let R be a k-partite hypergraph with vertex
classes X1 , . . . , Xk of size t with the following properties.
S
(i ) ∅ ∈ R, and {v} ∈ R for any v ∈ V (R) = i∈[k] Xi .
(ii ) For any 1 ≤ i ≤ k − 2 and j ∈ [k], any edge of R(i) which has no vertex in Xj is
contained in at least (1 − β)t edges of R(i+1) which intersect Xj .
(iii ) Each edge of R(k−1) is contained in at least (α + (2k + 1)β)t edges of R(k) .
Then
(a ) R(k) contains a tightly connected matching of αt edges, and
(b ) if α ≥ 21 then R(k) contains a tightly connected perfect fractional matching.
Proof. First note that for any 1 ≤ i ≤ k, if some edge e ∈ R(i) does not include any
edge of R(i−1) as a subset, then deleting e from R yields a subgraph which also meets
the conditions of the lemma. So we may assume that every edge in R(i) includes at least
one edge of R(i−1) as a subset.
The edges f ∈ R(k) for which every subset of f is an edge of R are the most useful in
the sense that for each subset of f we can apply the degree conditions (ii ) and (iii ). We
say that such edges are excellent. We will show that each tightly connected component
of R(k) contains a matching of αt excellent edges, giving (a ).
Claim 18. Each edge of R(k) is tightly connected to an excellent edge of R(k) .

Proof. Let e = {v1 , . . . , vk } be an edge of R(k) with vi ∈ Xi for each i. Since every edge
in R(i) includes at least one edge of R(i−1) as a subset, we may assume without loss of
generality that the subsets {v1 , . . . , vj } are in R for each 1 ≤ j ≤ k − 1. Choose wk ∈ Xk
16

such that {v1 , . . . , vj , wk } is in R for each 0 ≤ j ≤ k − 1. This is possible because
{v1 , . . . , vj } is in R for each j, and so at most (k − 2)βt + (1 − α − (2k + 1)β)t < t vertices
in Xk do not satisfy the given condition. Now for each i = k − 1, . . . , 1 in that order, we
choose a vertex wi ∈ Xi such that {v1 , . . . , vj , S} is an edge of R for each 0 ≤ j ≤ i − 1
and each subset S of {wi , . . . , wk }. Again, since 2k−1 βt + (1 − α − (2k + 1)β)t < t this
is always possible. Then the sequence of edges of the form {v1 , . . . , vi , wi+1 , . . . , wk } for
0 ≤ i ≤ k is a tight walk between e and {w1 , . . . , wk } in R (since by construction each of
these k-sets is in R) and also by construction {w1 , . . . , wk } is an excellent edge.

We next show that for any small vertex set S and any excellent edge e, there is a tight
walk from e to another excellent edge outside S.
Claim 19. Given any set S of vertices of R such that |S ∩ Xi | < αt for each 1 ≤ i ≤ k,
and an excellent edge e, there is a tight walk from e to an excellent edge e′ of R(k) with
e′ ∩ S = ∅.
Proof. Let e = {u1 , . . . , uk }, where ui ∈ Xi for each i. For each i = 1, . . . , k in that order,
we wish to choose vi to be a vertex of Xi \ S such that {v1 , . . . , vi , ui+1 , . . . , uk } is an
excellent edge. This means that for each subset T of {v1 , . . . , vi−1 , ui+1 , . . . , uk }, we need
to guarantee that T ∪ {vi } is an edge of R. In total, at most
2k−1 βt + (1 − α − (2k + 1)β)t < t − αt − βt

vertices of Xi are not suitable. Thus at least (α + β)t > |S ∩ Xi | vertices are suitable,
and it is always possible to choose vi ∈ Xi \ S as desired. Now the sequence of edges of
the form {v1 , . . . , vi , ui+1 , . . . , uk } for 0 ≤ i ≤ k is a tight walk from e to an excellent edge
e′ = {v1 , . . . , vk } which does not intersect S as desired.


Next we show that any tight component of R(k) has a matching with at least αt edges.
So let C be a tight component of R(k) ; then C contains at least one edge. Since by
Claim 18 any edge of R(k) is tightly connected to an excellent edge of R(k) , C contains
an excellent edge e1 .
We construct a matching in C as follows. We let M1 = {e1 }. Now for each 2 ≤ i ≤ αt,
let ei be the edge returned by applying Claim 19 with e = ei−1 and S consisting of all
vertices covered by Mi−1 , and let Mi = Mi−1 ∪ {ei }. Then Mαt is the desired matching in
C. (In fact, this process actually returns a tight path in C on αt vertices. The matching
Mαt consists of every kth edge of this path.)
To complete the proof we show that in the case α ≥ 21 we have more: R(k) is tightly
connected and admits a perfect fractional matching. For the latter we use Lemma 16.
Indeed, any edge of R(k−1) is contained in at least αt ≥ t/k = t − k−1
t edges of R(k) ,
k
the edge of R(0) (i.e. ∅) is contained in the edges {v} ∈ R(1) for v ∈ V (R), and for any
1 ≤ i ≤ k − 2, any edge of R(i) which does not intersect some part Xj is contained in
at least (1 − β)t ≥ (k − 1)t/k ≥ t − ki t edges of R(i+1) which do intersect Xj (the ﬁrst
inequality follows from α + (2k−1 + 1)β ≤ 1). So R meets the conditions of Lemma 16,
from which we deduce that R(k) admits a perfect fractional matching.
To show that R(k) is tightly connected, it is by Claim 18 enough to show that any
two excellent edges are tightly connected. Given two excellent edges {u1 , . . . , uk } and
{v1 , . . . , vk }, where ui , vi ∈ Xi for each i, we have that both e := {u1 , . . . , uk−1} and
f := {v1 , . . . , vk−1 } are edges of R: in particular there are at least 2(α + (2k + 1)β)t − t ≥
(2k + 1)βt vertices in Xk which form edges with both e and f . Of these, all but at most
2 · 2k−1 βt form excellent edges with both e and f , so we can choose a vertex wk ∈ Xk
so that e ∪ {wk } and f ∪ {wk } are both excellent edges of R(k) . We repeat the same
17

process for each i = k − 1, . . . , 1 in that order to ﬁnd wi ∈ Xi which forms excellent edges
with each of {u1 , . . . , ui−1, wi+1 , . . . , wk } and {v1 , . . . , vi−1 , wi+1 , . . . , wk }. We have thus
constructed tight walks from each of {u1 , . . . , uk } and {v1 , . . . , vk } to {w1 , . . . , wk }, and
thus the two edges are tightly connected, as desired.

We now prove Theorem 2, which we restate for the reader’s convenience. We note that
an ordering of constants and functions:
1/n1 ≪ ε(·), 1/r(·) ≪ 1/t1 ≪ εk ≪ β, dk , ψ ≪ δ, 1/k

would be enough in the proof, but for convenience we will give values explicitly.
Theorem 2. For every positive δ and every integer k ≥ 3 there is an integer n∗ such
that the following holds for each α ∈ [0, 1]. If G is a k-uniform k-partite hypergraph with
parts of size n ≥ n∗ , such that any collection of k − 1 vertices, one in each of k − 1 parts
of G, lies in at least (α + δ)n edges of G, then
(a ) G contains a tight cycle of length ℓ for every ℓ ≤ αkn that is divisible by k, and
(b ) if α ≥ 21 then G contains a tight cycle of length ℓ for every ℓ ≤ (1 − δ)kn that is
divisible by k.
Proof. Given 0 < δ < 1 and k ≥ 3, we choose
δ
δ
δ
ψ=
, dk = , β =
,
k
28
7
7(2 + 1)
We let

t0 = 1 .

β k−1δ
7 · 2k−1
be suﬃciently small for applying Lemma 9 with constants ψ, εk and dk . Next we choose
functions r : N → N growing suﬃciently rapidly and ε : N → (0, 1] tending to zero
suﬃciently rapidly so that for any t ∈ N we can apply Lemma 9 with εk as chosen
above, r(t), ε(t) and any d2 , . . . , dk ≥ 1/t. Now Lemma 6 returns t1 and n0 such that
for any n ≥ n0 divisible by t1 !, any kn-vertex k-graph
 G and any partition Q of V (G)
into k parts of size n, there is a t0 , t1 , ε(t1 ), εk , r(t1 ) -regular slice for G which satisﬁes
conditions (a ) and (b ) of Lemma 6 and whose ground partition reﬁnes Q. Fix this t1 ;
for the rest of the proof we will write ε and r for ε(t1 ) and r(t1 ) respectively. Finally we
choose n1 ≥ max (n0 , 7t1 !/δ) to be suﬃciently large to apply Lemma 9 with t1 in place of
t, n1 in place of n0 and all other constants as above.
Let G′ be a k-partite k-graph with parts U1′ , . . . , Uk′ of size n′ ≥ n∗ := n1 + t1 ! such that
any (k −1)-set of vertices, one in each of k −1 parts of G′ , lies in at least (α +δ)n′ edges of
G′ . Choose n divisible by t1 ! with n′ − t1 ! ≤ n ≤ n′ and
a subset Ui ⊆ Ui′ of size n for each
S
i ∈ [k], and let G be the subgraph of G′ induced by i∈[k] Ui . Let Q denote the partition
of V (G) into the classes Ui . Since at most t1 ! vertices were deleted from each vertex class
of G′ , and n′ ≥ n1 ≥ 7t1 !/δ, any Q-partite (k − 1)-set S of vertices of G lies in at least
(α + 6δ/7)n′ edges of G, so deg(S; G, Ui ) ≥ α + 6δ/7, where Ui is
 the part of Q which
S does not intersect. By Lemma 6 we may choose a t0 , t1 , ε, εk , r -regular slice J for G
which has the properties (a ) and (b ) of Lemma 6 and whose ground partition reﬁnes Q.
Since each cluster of J has the same size, and the same is true of the parts of Q, the
number of clusters of J must be divisible by k. So let t be such that kt is the number of
clusters. Then each cluster has size m := n/t, and since J is (t0 , t1 , ε)-equitable we have
t0 ≤ kt ≤ t1 .
Let QR denote the natural partition of the clusters of J ; so the parts of QR are
V1 , . . . , Vk , where Vi consists of all clusters which are subsets of Ui . Observe that we
εk ≤

18

have |Vi | = t, and that the reduced k-graph Rdk (G) is QR -partite. We would like to
immediately apply Lemma 17 to the k-complex generated by the down-closure of Rdk (G),
but unfortunately this complex may not satisfy the required degree conditions. Instead
we obtain a subcomplex which does satisfy the necessary conditions.
To do this, consider a QR -partite set X of k − 1 clusters. There is exactly one vertex
class Vi which X does not intersect, and we say that X is good if there are fewer than
δt/7 clusters X ∈ Vi such that G is not (εk , r)-regular with respect to the k-set X ∪ {X}
(for convenience, we henceforth refer to such k-sets simply as irregular k-sets). Next, for
ℓ = k − 2, . . . , 0 (in that order) we say that a QR -partite set X of ℓ clusters is good if it is
contained in at most βt/2 QR -partite sets of ℓ + 1 clusters which are bad, i.e. not good.
At the end of this process we have labelled each individual cluster as good or bad.
Suppose that at least βt/2 clusters are bad. Then we can construct an irregular k-set in
R(G) by choosing any one of these bad clusters, any of the at least βt/2 clusters with
which it forms a bad pair, and so on up to any of the at least δt/7 irregular k-sets which
contain the bad (k − 1)-set so constructed. Since we could construct a given irregular
k-set in at most k! ways, we conclude that R(G) contains at least(βt/2)k−1(δt/7)/k!
t
k−1
irregular k-sets. Since εk ≤ β k−1
 δ/(7 · 2 ), this is greater than εk k , contradicting the
fact that J is an t0 , t1 , ε, εk , r -regular slice for G.
We conclude that fewer than βt/2 clusters are bad. So for each 1 ≤ i ≤ k we may
choose a set Vi′ of t′ := (1 − β/2)t clusters from Vi , all of which are good. We now deﬁne
a k-partite hypergraph R on V ′ := V1′ ∪ · · · ∪ Vk′ as follows. For each 0 ≤ j ≤ k − 1 we
take R(j) to consist of all good j-sets of clusters (so in particular, ∅ ∈ R and {v} ∈ R for
any v ∈ V ′ ). For R(k) we instead take all edges of Rdk (G) which are contained in V ′ .
We want to apply Lemma 17 with t′ and α + δ/7 in place of t and α respectively.
Observe that condition (i ) is satisﬁed. For condition (ii ) note that by deﬁnition of R,
for any 1 ≤ i ≤ k − 2 and j ∈ [k], any edge X ∈ R(i) which does not intersect Vj′ is
contained in at least |Vj′ | − βt/2 ≥ (1 − β)t′ edges of R(i+1) which do intersect Vj′ .
We now check condition (iii ). Consider any edge X of R(k−1) , so X is a good set of
k − 1 clusters, and let j be such that X does not intersect Vj . Recall that deg(S; G, Uj ) ≥
α+6δ/7 for any Q-partite (k−1)-set of vertices of G which does not intersect Uj ; it follows
that deg(JX ; G, Uj ) ≥ α+6δ/7. By property (b ) of Lemma 6 we have |deg(X ; R(G), Vj )−
deg(JX ; G, Uj )| < εk , so deg(X ; R(G), Vj ) ≥ α + 5δ/7. Since X is good, the proportion of
clusters X in Vj for which X ∪ {X} is an irregular k-set is at most δ/7, and so Lemma 8
implies that deg(X ; Rdk (G), Vj ) ≥ deg(X ; R(G), Vj ) − dk − δ/7 ≥ α + 3δ/7, and therefore
deg(X ; Rdk (G), Vj′ ) ≥ α + 2δ/7. As (2k + 1)β = δ/7, it follows that any edge X of R(k−1)
lies in at least (α + δ/7 + (2k + 1)β)t′ edges of R(k) .
So R also satisﬁes condition (iii ) of Lemma 17. It follows that R(k) has a tight
component with a matching containing (α + δ/7)t′ = (α + δ/7)(1 − β/2)t ≥ (α + δ/14)t
edges. Since R(k) is a subgraph of Rdk (G), by Lemma 9 G contains a tight cycle of length
ℓ for any k < ℓ ≤ (1−ψ)(α+δ/14)kn which is divisible by k. Since (1−ψ)(α+δ/14)kn ≥
αkn this completes the proof of (a ). If α ≥ 21 then Lemma 17 also shows that R(k) admits
a tightly connected perfect fractional matching, and (b ) follows analogously.


7. Strong Hypergraph Regularity
In this section we introduce the Strong Hypergraph Regularity Lemma and some related
tools.
19

7.1. Families of partitions and the Strong Hypergraph Regularity Lemma. In
order to state the Strong Hypergraph Regularity Lemma we need some more notation.
Fix k ≥ 3, and let P partition a vertex set V into parts V1 , . . . , Vt . For any A ⊆ [t], we
denote by CrossA the collection of P-partite subsets S ⊆ V of
 index i(S) = A. Likewise,
[t]
we denote by Crossj the union of CrossA for each A ∈ j , so Crossj contains all Ppartite subsets S ⊆ V of size j. Note that CrossA and Crossj are dependent on the choice
of partition
P, but this will always be clear from the context. For each 2 ≤ j ≤ k − 1 and

A ∈ [t]j let PA be a partition of CrossA . For consistency of notation we also deﬁne the
trivial partitions P{s} := {Vs } for s ∈ [t] and P∅ := {∅}. Let P ∗ consist of the partitions

PA for each A ∈ [t]j and each 0 ≤ j ≤ k − 1. We say that P ∗ is a (k − 1)-family of
partitions
on V if whenever
S, T ∈ CrossA lie in the same part of PA and B ⊆ A, then

S
S
S ∩ j∈B Vj and T ∩ j∈B Vj lie in the same part of PB . In other words, given A ∈ [t]j ,

A
if we specify one part of each PB with B ∈ j−1
, then we obtain a subset of CrossA
consisting of all S ∈ CrossA whose (j − 1)-subsets are in the speciﬁed parts. Thus the
partitions PB give a natural partition of CrossA , and we are saying that PA must reﬁne
it.
We refer to the parts of each member of P ∗ as cells. Also, we refer to P as the ground
partition of P ∗ , and the parts of P (i.e. the vertex classes Vi ) as the clusters of P ∗ . For
each 0 ≤ j ≤ k − 1 let P (j) denote the partition of Crossj formed by the parts (which we

call j-cells) of each of the partitions PA with A ∈ [t]j (so in particular P (1) = P).
The cells of
P ∗ naturally form (k − 1)-complexes on V . Indeed, for any 0 ≤ j ≤ k − 1,

any A ∈ [t]j and any Q′ ∈ CrossA , let CQ′ denote the cell of PA which contains Q′ .
Then the S
fact that P ∗ is a family of partitions implies that for any Q ∈ Crossk the union
J (Q) := Q′ (Q CQ′ of cells containing subsets of Q is a k-partite (k − 1)-complex. We
say that the (k − 1)-family of partitions P ∗ is (t0 , t1 , ε)-equitable if
(a ) P partitions V into t clusters of equal size, where t0 ≤ t ≤ t1 ,
(b ) for each 2 ≤ j ≤ k − 1, P (j) partitions Crossj into at most t1 cells,
(c ) there exists d = (dk−1, . . . , d2 ) such that for each 2 ≤ j ≤ k − 1 we have dj ≥ 1/t1
and 1/dj ∈ N, and for every Q ∈ Crossk the k-partite (k − 1)-complex J (Q) is
(d, ε, ε, 1)-regular.
Note that conditions (a ) and (c ) imply that J (Q) is a (1, t1 , ε)-equitable (k − 1)-complex
(with the same density vector d) for any Q ∈ Crossk .
Next, for any P-partite set Q with 2 ≤ |Q| ≤ k, deﬁne P̂ (Q; P ∗ ) to be the |Q|-partite
S
(|Q| − 1)-graph on Vi(Q) with edge set Q′ ∈( Q ) CQ′ . We refer to P̂ (Q; P ∗ ) as a polyad ;
|Q|−1

∗

when the family of partitions P is clear from the context, we write simply P̂ (Q) rather
than P̂ (Q; P ∗ ). Note that the condition for P ∗ to be a (k − 1)-family of partitions can
then be rephrased as saying that if 2 ≤ |Q| ≤ k − 1 then the cell CQ is supported on
P̂ (Q). Moreover, we will show in the proof of Lemma 6 (Claim 28) that if P ∗ is (t0 , t1 , ε)equitable for suﬃciently small ε, then for any 2 ≤ j ≤ k − 1 and any Q ∈ Crossj the
number of j-cells of P ∗ supported on P̂ (Q) is precisely equal to 1/dj .
Now let G be a k-graph on V , and let P ∗ be a (k − 1)-family of partitions on V . Let
Q ∈ Crossk , so the polyad P̂ (Q) is a k-partite (k − 1)-graph. Recall (see Section 4.1) that
G is (εk , r)-regular with respect to P̂ (Q) if there is some d such that G is (d, εk , r)-regular
with respect to
P̂ (Q). We say that G is (εk , r)-regular with respect to P ∗ if there are

at most εk |Vk | sets Q ∈ Crossk for which G is not (εk , r)-regular with respect to the
20

polyad P̂ (Q). That is, at most an εk -proportion of subsets of V of size k yield polyads
with respect to which G is not regular (though some subsets of V of size k do not yield
any polyad due to not being members of Crossk ). Similarly, we say that G is perfectly
(εk , r)-regular with respect to P ∗ if for every set Q ∈ Crossk , the graph G is (εk , r)-regular
with respect to the polyad P̂ (Q), i.e. there are no polyads with respect to which G is not
regular.
Finally, we deﬁne the notion of a slice through a family of partitions. Indeed, if P ∗ is a
(k − 1)-family of partitions, then a slice through
P ∗ is a (k − 1)-complex J on V such that
S
for each 0 ≤ i ≤ k −1 we may write J (i) = A∈([t]) C(A), where each C(A) is a cell in PA .
i
That is, a slice consists of a single cell from each PA , but the requirement that J should
be a (k − 1)-complex requires that the choices of cells are ‘consistent’, meaning that each
chosen 3-cell is supported on the chosen 2-cells, and so forth. Observe in particular that
any slice through P ∗ must be P-partite. Moreover, if P ∗ is (t0 , t1 , ε)-equitable then any
slice through P ∗ must be (t0 , t1 , ε)-equitable also, and the polyads of any slice through P ∗
are also polyads of P ∗ . The reason for the term ‘regular slice’ should now be apparent:
we take a slice through a (k − 1)-family of partitions P ∗ so that the chosen slice has
desirable regularity properties.
We are now ready to state the Strong Hypergraph Regularity Lemma. The form we
consider, due to Rödl and Schacht, is Lemma 23 in [32]2.
Lemma 20 (Strong Hypergraph Regularity Lemma). Let k ≥ 3 be a fixed integer. For all
positive integers q, t0 and s, positive εk and functions r : N → N and ε : N → (0, 1], there
exist integers t1 and n0 such that the following holds for all n ≥ n0 which are divisible
by t1 !. Let V be a vertex set of size n, and suppose that G1 , . . . , Gs are edge-disjoint
k-graphs on V , and that Q is a partition of V into at most q parts of equal size. Then
there exists a (k − 1)-family of partitions P ∗ on V such that
(a ) the ground partition of P ∗ refines Q,
(b ) P ∗ is (t0 , t1 , ε(t1 ))-equitable, and
(c ) for each 1 ≤ i ≤ s, Gi is (εk , r(t1 ))-regular with respect to P ∗ .

Similar results were proved previously by Rödl and Skokan [33] and Gowers [11]. In
applications of Lemma 20, the regularity parameter εk of the graphs Gi is typically
much larger than the entries of the density vector of P ∗ , which may cause substantial
technical diﬃculties. The next result, also due to Rödl and Schacht (the form we state
is Theorem 25 in [32]), is a Regular Approximation Lemma, in which the regularity
parameter may be taken to be much smaller than the densities of P ∗ . However, the price
for this is that it is not our k-graph G which is regularised, but instead a k-graph G′
which diﬀers from G only in a small number of edges.
Lemma 21 (Regular Approximation Lemma). Let k ≥ 3 be a fixed integer. For all
positive integers q, t0 and s, positive ν and functions ε : N → (0, 1], there exist integers t1
and n0 such that the following holds for all n ≥ n0 which are divisible by t1 !. Let V be
a vertex set of size n, and suppose that G1 , . . . , Gs are edge-disjoint k-graphs on V , and
that Q is a partition of V into at most q parts of equal size. Then there exist k-graphs
G′1 , . . . , G′s on V and a (k − 1)-family of partitions P ∗ on V such that
(a ) the ground partition of P ∗ refines Q,
(b ) P ∗ is (t0 , t1 , ε(t1 ))-equitable,
2In

fact, their lemma allows for an initial family of partitions rather than just a partition Q of the
vertex set V .
21

(c ) for each 1 ≤ i ≤ s the graph G′i is perfectly (ε(t1 ), 1)-regular with respect to P ∗ , and
(d ) for each 1 ≤ i ≤ s, we have |G′i ∆Gi | ≤ νnk .

In fact, in order to prove Lemma 6 we need a slightly strengthened version of the Strong
Hypergraph Regularity Lemma, which we deduce from Lemma 21.
Given families of partitions P ∗ and P̃ ∗ , such that the ground partition P of P ∗ is a
reﬁnement of the ground partition P̃ of P̃ ∗ , we say that P ∗ is generated from P̃ ∗ by P
if every P̃-partite j-cell of P ∗ is an induced subgraph of a j-cell of P̃ ∗ . Note that this
condition does not determine a unique P ∗ , since the j-cells of P ∗ which are not P̃-partite
are not determined. However, if P̃ ∗ has many clusters, it does determine most j-cells of
P ∗ . If J˜ is a slice through P̃ ∗ and X̃ is a set of clusters of P̃, then J˜[X̃] is the subset
of elements of J˜ supported on X̃. Next, given a set X̃ of ℓ clusters of P̃ ∗ , we say that
a set X of clusters of P ∗ is X̃-consistent if X has precisely ℓ members, each of which is
a subset of precisely one member of X̃. Finally, given such X and X̃, for any slice J
through P ∗ we say that J [X] is contained in J˜[X̃], and write J [X] ⊆ J˜[X̃], if every
j-cell of J [X] is an induced subgraph of a cell of J˜[X̃].
The Strengthened Regularity Lemma we require follows. The diﬀerence between this
lemma and Lemma 20 is the appearance of a ‘coarse’ family of partitions P̃ ∗ containing
the ‘ﬁne’ family of partitions P ∗ on which we guarantee regularity properties. This lemma
guarantees that the neighbourhood of some root vertices looks about the same on a part
of the coarse family of partitions as on any of the corresponding parts in the ﬁne family
of partitions.
Lemma 22 (Strengthened Regularity Lemma). Let k ≥ 3 be a fixed integer. For all
positive integers q, t0 and s, positive εk , functions r : N → N, ε : N → (0, 1] and monotone
increasing functions p : N → N, there exist integers t∗1 , t1 and n0 with t1 = p(t∗1 )t∗1 such
that the following holds for all n ≥ n0 which are divisible by t1 !. Let V be a vertex set
of size n, and suppose that G1 , . . . , Gs are edge-disjoint k-graphs on V , and that Q is
a partition of V into at most q parts of equal size. Then there exist (k − 1)-families of
partitions P ∗ and P̃ ∗ on V with ground partitions P and P̃ respectively such that
(a ) P refines Q,
(b ) P ∗ is generated from P̃ ∗ by P,
(c ) P has t = p(t∗1 )t̃ parts, where t̃ is the number of parts of P̃,
(d ) P̃ ∗ and P ∗ are (t0 , t1 , ε(t1 ))-equitable with equal density vectors, and all densities are
at least 1/t∗1 ,
(e ) for each 1 ≤ i ≤ s, Gi is (εk , r(t1 ))-regular with respect to P ∗ ,
(f ) for each 1 ≤ i ≤ s, each 1 ≤ ℓ ≤ 1/εk , each k-graph H equipped with a set of distinct
root vertices x1 , . . . , xℓ such that v(H) ≤ 1/εk , any distinct vertices v1 , . . . , vℓ in V ,
any slices J˜ through P̃ ∗ and J through P ∗ , any (v(H) − ℓ)-set of clusters X̃ of P̃ ∗
and any X̃-consistent (v(H) − ℓ)-set X of clusters of P ∗ such that J [X] ⊆ J˜[X̃],
we have
dH (Gi ; v1 , . . . , vℓ , J˜[X̃]) = dH (Gi ; v1 , . . . , vℓ , J [X]) ± εk .
We will prove Lemma 22 in Appendix B. However, it is worth noting that we need it
only for proving property (c ) of Lemma 6. The only use of this property in this paper
is in the sketch proof of Theorem 39 given in Section 10, so the reader whose interest
lies only in verifying Theorems 1 and 2 can safely forget Lemma 22 and pretend that
Lemma 20 provides the (k − 1)-family of partitions P ∗ in the proof of Lemma 6.
22

7.2. Tools for working with regularity. We will need various standard results in the
proofs of Lemmas 6 and 9, which we present here.
We start with the Hypergraph Counting Lemma. The version we present here is slightly
modiﬁed from a result in [8], which in turn was derived from [31, Theorem 9]. We sketch
in Appendix A how this modiﬁed version can be obtained. Similar results were also
proved previously by Gowers [11] and by Nagle, Rödl and Schacht [25]. We remark that
Fact 3 is a special case of this lemma. Note though that in contrast to Fact 3, Lemma 23
allows for a k-graph G on top of the equitable complex J , whose regularity εk with
respect to J can be bigger than the entries of the density vector of J .
Lemma 23 (Counting Lemma, [8, Lemma 4]). Let k, s, r, m0 be positive integers, and let
d2 , . . . , dk−1, ε, εk , β be positive constants such that 1/di ∈ N for any 2 ≤ i ≤ k − 1 and
1
1
1
≪ , ε ≪ εk , d2 , . . . , dk−1 and εk ≪ β, .
m0
r
s
Then the following holds for all integers m ≥ m0 . Let H be a k-graph on s vertices
1, . . . , s, and let H be the k-complex generated by the down-closure of H. Also let J be a
(·, ·, ε)-equitable (k − 1)-complex with s clusters
V1 , . . . , Vs each of size m and with density
S
vector d. Finally, let G be a k-graph on i∈[s] Vi which is supported on J (k−1) such that
for any edge e ∈ H the graph G is (εk , r)-regular with respect to the k-set of clusters
{Vj : j ∈ e}. Then the number of copies of H in G such that i is in Vi for each i is
! k−1
!
Y
Y e (H)
d∗ ({Vj : j ∈ e}) ± β
di i
ms .
i=2

e∈H



A key property of regular complexes is that the restriction of such a complex to a
large subset of its vertex set is also a regular complex, with the same relative densities
at each level of the complex, albeit with somewhat degraded regularity properties. The
next lemma states this property formally. Its proof is as sketched for Lemma 4.1 in [21]
(the quantiﬁcation there is slightly diﬀerent but this does not aﬀect the proof).
Lemma 24 (Regular Restriction Lemma). Suppose integers k, m and real α, ε, εk , d2 , . . . , dk >
0 are such that
1
1
≪ ε ≪ εk , d2 , . . . , dk−1 and εk ≪ α, .
m
k
For any r, s ∈ N and dk > 0, set d = (dk , . . . , d2 ), and let G be an s-partite k-complex
whose vertex classes V1 , . . . , Vs each have size m and which is (d, εk , ε, r)-regular. Choose
any Vi′ ⊆ V√
with |Vi′ | ≥ αm for each i ∈ [s]. Then the induced subcomplex G[V1′ ∪ · · · ∪ Vs′ ]
√ i
is (d, εk , ε, r)-regular.

Given a copy of some subgraph H ′ ⊆ H in G (k) , how many ways are there to extend H ′
to a copy of H in G (k) ? The next lemma gives a lower bound on this number for almost
all copies of H ′ in G (k) . To state this precisely we make the following deﬁnitions.
Let G be an s-partite k-complex whose vertex classes V1 , . . . , Vs are each of size m, and
let H be an s-partite k-complex whose vertex classes X1 , . . . , Xs each have size at most
m. We say that an embedding of H in G is partition-respecting if for any i ∈ [s] the
vertices of Xi are embedded within Vi . We denote the set of labelled partition-respecting
copies of H in G by HG . The Extension Lemma [8, Lemma 5] states that if H′ is an
induced subcomplex of H, and G is regular with G (k) reasonably dense, then almost all
partition-respecting copies of H′ in G can be extended to a large number of copies of H
23

in G. We present a slightly modiﬁed form of this lemma, implied by [21, Lemma 4.6].
Again, we explain in Appendix A how the modiﬁcation can be obtained.
Lemma 25 (Extension Lemma, [21, Lemma 4.6]). Let k, s, r, b, b′ , m be positive integers,
where b′ < b, and let c, β, d2, . . . , dk , ε, εk be positive constants such that 1/di ∈ N for any
2 ≤ i ≤ k − 1 and
1
1
1 1
≪ , ε ≪ c ≪ εk , d2 , . . . , dk−1 and εk ≪ β, dk , , .
m
r
s b
Suppose that H is an s-partite k-complex on b vertices with vertex classes X1 , . . . , Xs
and let H′ be an induced subcomplex of H on b′ vertices. Suppose that
G is an s-partite
Sk−1
G (i) is (·, ·, ε)k-complex with vertex classes V1 , . . . , Vs , all of size m, such that i=0
equitable with density
vector (dk−1 , . . . , d2 ). Suppose further that for each e ∈ H(k) with

[s]
index A ∈ k , the k-graph G (k) [VA ] is (d, εk , r)-regular with respect to G (k−1) [VA ] for
some d ≥ dk . Then all but at most β|HG′ | labelled partition-respecting copies of H′ in G
′
extend to at least cmb−b labelled partition-respecting copies of H in G.

8. Proof of the Regular Slice Lemma
In this section we prove Lemma 6. We begin with an outline of the proof, considering
the case of regularising only one k-graph G = G1 . Let P ∗ be an equitable (k −1)-family of
partitions obtained from Lemma 22. As previously noted, we will take a ‘slice’ through
P ∗ so that the i-cells of this ‘slice’ are consistent. This can be done by the following
procedure: for each pair of clusters we choose one of the 2-cells of P ∗ on these clusters.
We then throw out all other 2-cells and everything in higher levels of P ∗ which is not
supported on our chosen 2-cells. Now for each triple of clusters we choose one of the
3-cells of P ∗ on these clusters, and so on.
Since the family of partitions P ∗ is (t0 , t1 , ε)-equitable, the procedure described will
always output a (t0 , t1 , ε)-equitable (k − 1)-complex J . Because G is also regular with
respect to P ∗ , we could hope that J will be a regular slice for G. But in order for
this to be true, it is necessary that we do not accidentally choose the (k − 1)-cells of
disproportionately many polyads P̂ (Q) such that G is not regular with respect to P̂ (Q).
This already suggests our proof method: we will follow the above procedure, and when we
are required to pick an i-cell for some i-set of clusters, we will choose uniformly at random
from the 1/di possibilities. It is easy to see that the expected fraction of irregular k-sets
of clusters of J is then equal to the fraction of irregular polyads in P ∗ . So by linearity
of expectation there exists a regular slice for G, an idea which was previously observed
in the k = 3 case by Haxell, Luczak, Peng, Rödl, Ruciński and Skokan [13]. However, a
straightforward application of McDiarmid’s inequality shows that the fraction of irregular
sets is actually sharply concentrated, so that the (k − 1)-complex J obtained from the
random procedure is very likely to be a regular slice. A similar argument together with
the union bound guarantees that J is very likely to satisfy both properties (a ) and (b )
of Lemma 6.
So far the properties of P ∗ we used would also be guaranteed by Lemma 20. However,
this will not be true for the argument proving property (c ). The obstacle to obtaining
property (c ) is as follows: for any H we are asking for roughly n1/εk distinct inequalities
to be satisﬁed, one for each choice of root vertices. Although each individual one of
these inequalities is very likely to be true, their success probability only depends on the
regularity εk and the number of clusters t, but not on n. Hence a union bound fails
miserably. In order to circumvent this, we make use of the coarse (k − 1)-family of
partitions P̃ ∗ given by Lemma 22. We will illustrate our strategy in the case that H is
24

a k-edge, rooted at a single vertex. Each vertex v of G deﬁnes a (k − 1)-graph, called
the link of v, whose edges are those (k − 1)-sets which together with v form edges of G.
Then in this case, property (c ) states that for each v ∈ V (G), the density of the link of
v is close to the density of the link of v supported on J .
Observe that most (k −1)-sets in V (G) are P̃-partite, and the P̃-partite (k −1)-sets are
partitioned by P̃ ∗ into its (k − 1)-cells. These (k − 1)-cells are of approximately equal size
by Fact 3, and it follows that for each v the density of the link of v is close to the average,
over (k − 1)-cells C of P̃ ∗ , of the density of the link of v on C. Now each (k − 1)-cell C
of P̃ ∗ is partitioned by P into a large number of (k − 1)-cells of P ∗ , and Lemma 22(f )
guarantees that for each v the link density of v on each of these parts is close to the
link density of v on C. It follows that if J is a slice through P ∗ whose (k − 1)-cells are
chosen with about equal frequency from the (k − 1)-cells of P̃ ∗ then J satisﬁes this case
of property (c ). We can again prove that this is the likely outcome using McDiarmid’s
inequality.
The form of McDiarmid’s inequality we use is the following.
Theorem 26 (McDiarmid’s inequality, [23]). Let f : Rn → R be such that there exists a
n
vector (c1 , . . . , cn ) ∈ R
property. For each x, if x′ differs from x only

 with the ′following
in coordinate i then f (x) − f (x ) ≤ ci . Now if (X1 , . . . , Xn ) is a vector of independent
random variables, then for each a > 0 we have


 −a2 

P
Pr f (X1 , . . . , Xn ) − E f (X1 , . . . , Xn ) ≥ a ≤ 2 exp
.
2 ni=1 c2i


We will also make several uses of the following probabilistic statement which shows
that P(E | C ∩ S) and P(E | S) are nearly the same when S ‘almost implies’ C.
Proposition 27. Let E, C and S be events in some probability space such that P(S) > 0
and P(C c | S) ≤ ε for some constant ε ≤ 21 . Then P(E | C ∩ S) = P(E | S) ± 2ε.

Proof. Observe that P(C ∩ S) = P(S)(1 − P(C c | S)) > 0, so P(E | C ∩ S) is well-deﬁned,
and
P(E ∩ S)
P(E ∩ S)
(1 + 2ε)P(E | S) ≥
≥
(1 − ε)P(S)
P(S) − P(C c ∩ S)
P(E ∩ S) − P(E ∩ C c ∩ S)
P(E ∩ C ∩ S)
≥
≥ P(E | C ∩ S) =
P(C ∩ S)
P(S)
c
P(E ∩ S) P(C ∩ S)
−
≥ P(E | S) − ε.
≥
P(S)
P(S)


Proof of Lemma 6. Given integers q, t0 and s, a constant εk , and functions r : N → N
and ε : N → (0, 1], we deﬁne further constants as follows. Without loss of generality we
assume that εk ≤ 1, and deﬁne
!
2
4
2k k 2
128k
4096k!
k2
q
s
(3)
t∗0 := max t0 , 2+2/ε +k ,
.
k
ε4k
εk
Next we choose a constant
(4)

ε∗k ≤

ε2k+1
k
.
40s · 2k
25

so that ε∗k is suﬃciently small to apply Lemma 23 with ε∗k , εk /100 and 1/εk in place of
εk , β and s respectively. We choose p : N → N to be any monotone increasing function
such that for all x ∈ N we have
k−1
k−1

Y (x)
Y
 x 
−xp(x)
−x−9 2
2
1 j
1 2( j )
<
2
(5)
2 exp − 2
εk p(x)
.
x
x
j=2

j=2

It may not be immediately
obvious that this is possible, but observe that if p(x) >

max 2x/c1 (x), 2/c2 (x) then we have


2 exp − c1 (x)p(x)2 < 2 exp − 2xp(x) < c2 (x)2−xp(x) ,

from which (5) follows by appropriate choice of c1 , c2 . We choose strictly monotone
functions r ∗ : N → N and ε∗ : N → (0, 1] such that


εk
1
∗
(6)
ε (t1 ) ≤ min ε(t1 ),
, 2 and r ∗ (t1 ) ≥ r(t1 )
1/εk
2
2t1
10 · 2
for any t1 ∈ N. Moreover, we make these choices so that for any t1 ∈ N we can apply
Lemma 23 to count graphs on up to 1/εk vertices, with r ∗ (t1 ), ε∗ (t1 ), ε∗k and εk /100 in
place of r, ε, εk and β respectively, with 1/t1 in place of each di , and so that we can
apply Fact 3 with εk /10 in place of β to any (t∗0 , t1 , ε∗ (t1 ))-equitable (k − 1)-complex with
suﬃciently large clusters. Let n∗0 , t∗1 and t1 be obtained by applying Lemma 22 with
inputs q, t∗0 , s, ε∗k and functions r ∗ (·), ε∗ (·) and p(·). Note that we have t1 = p(t∗1 )t∗1 by
Lemma 22. Finally, let n0 ≥ n∗0 be suﬃciently large to apply Lemma 23 and Fact 3 with
m0 = n0 /t1 and all other constants as before. For the remainder of the proof we write ε,
ε∗ , r and r ∗ to denote ε(t1 ), ε∗ (t1 ), r(t1 ) and r ∗ (t1 ) respectively.
Let V be a set of n ≥ n0 vertices, where n is divisible by t1 !, and let Q partition
V into at most q parts of equal size. Let G1 , . . . , Gs be edge-disjoint k-graphs on the
vertex set V . Then we must show that there exists a (k − 1)-complex J on V which is
a (t0 , t1 , ε, εk , r)-regular slice for each Gi , whose ground partition P reﬁnes Q, and which
satisﬁes properties (a ), (b ) and (c ) of the lemma. We start by applying Lemma 22 (with
the inputs stated above), which yields partitions P ∗ and P̃ ∗ with the properties stated
in that lemma. In particular, P ∗ and P˜∗ are both (t∗0 , t1 , ε∗)-equitable with the same
density vector d = (dk−1 , . . . , d2), the ground partition P of P ∗ reﬁnes Q, and each Gi is
(ε∗k , r ∗ )-regular with respect to P ∗ .

Claim 28. For each 2 ≤ i ≤ k − 1 and each P-partite set Q ∈ Vi , the number of i-cells
of P ∗ supported on the polyad P̂ (Q, P ∗ ) is precisely equal to 1/di . Moreover, the same
statement holds with P̃ and P˜∗ in place of P and P ∗ respectively.

Proof. We prove the claim for P ∗ ; the proof for P̃ ∗ is identical. Recall that part (c ) of
the deﬁnition of an equitable family of partitions implies that 1/di must be an integer,
and that each i-cell of P ∗ supported on P̂ (Q) is (di , ε∗ , 1)-regular with
respect

 to P̂ (Q).
∗ 
In particular, the number of i-sets in each of these i-cells is (di ± ε ) Ki P̂ (Q) . Suppose
for a contradiction that for some polyad P̂ (Q), the number of i-cells of P ∗ supported
 on
1
P̂ (Q) is at least di + 1. Since these i-cells are pairwise-disjoint and cover Ki P̂ (Q) , we
conclude that





Ki P̂ (Q)  ≥ 1 + 1 (di ± ε∗ )Ki P̂ (Q)  .
di

By Fact 3 this number is non-zero, hence 1 ≥ d1i + 1 (di ± ε∗ ), which is a contradiction,
since we have di ≥ 1/t1 and ε∗ ≤ 1/(2t21 ). A similar argument shows that the number of
i-cells of P ∗ supported on P̂ (Q) is bigger than d1i − 1, giving the desired result.

26

We now construct our regular slice J , whose clusters are the clusters of P ∗ (that is,
the parts of P), by applying Algorithm 1 to P ∗ . We claim that with positive probability
J satisﬁes the conclusions of Lemma 6.
Algorithm 1: Taking a slice
let J = {∅} ∪ {{v} : v ∈ V };
foreach 2 ≤ i ≤ k − 1 do
foreach X ∈ Pi do
(i−1)
let C := {C : C is an i-cell of P ∗ and is supported on JX < };
choose C ∈ C uniformly at random;
let J := J ∪ C;
end
end
return J ;
It is immediate from the algorithm that the output J is a (k − 1)-complex which is a
slice through P ∗ . Since P ∗ is (t∗0 , t1 , ε∗ )-equitable with density vector d = (dk−1, . . . , d2 ),
J is also (t∗0 , t1 , ε∗ )-equitable with the same density vector. Let t denote the number of
clusters of J , so t∗0 ≤ t ≤ t1 , and let m := n/t, so m is the common size of each cluster.
Qk−1 (ti)
Note that by Claim 28 every slice through P ∗ has probability precisely i=2
di of being
selected as J .
To show that J is likely to be a regular slice for each Gi , we must bound the number
of irregular polyads, that is, polyads JˆX for which some Gi with 1 ≤ i ≤ s is not (ε∗k , r ∗ )regular with respect to JˆX . Since
each Gi is (ε∗k , r ∗ )-regular with respect to P ∗ , the

number of P-partite sets Q ∈ Vk for which Gi is not (ε∗k , r ∗ )-regular with respect to

P̂ (Q) is at most ε∗k nk . On the other hand, since ε∗ is chosen small enough so that we
can apply Fact 3 with εk /10 in place of β, each polyad P̂ (Q) of P ∗ supports
1±
P-partite members of
most
(7)

V
k

εk
10

Y (k )
 k k−1
di i
m
i=2


. It follows that the number of irregular polyads in P ∗ is at


  k−1
Y −(k)
sε∗k nk
∗ t
di i .
≤
2sε
k
k

Q
)
(
k i=2
k−1
εk
1 − 10
mk i=2
di i

By Claim 28 the probability that a given polyad of P ∗ is chosen for J is precisely
Qk−1 (ki)
i=2 di . So by linearity of expectation, the expected number of k-sets of clusters
X such that JX is an irregular polyad is at most 2sε∗k kt . By Markov’s
 inequality, we
∗ t
conclude that
 with probability at least 1/2 this number is at most 4sεk k , which by (4) is
at most εk kt . In particular, J is a (t0 , t1 , ε, εk , r)-regular slice for each Gi with probability
at least 1/2. We stress however that later in this proof we will make use of the stronger
property that J contains at most 4sε∗k kt polyads with respect to which some Gi is not
(ε∗k , r ∗ )-regular.
It remains to show that properties (a ), (b ) and (c ) each hold with high probability.
In each case, this amounts to verifying that some random variables are likely to all be
27

close to certain values, and our proof in each case follows the pattern of ﬁrst showing that
the expectations of these random variables are indeed close to the desired values, then
showing that the random variables are suﬃciently concentrated to apply a union bound.
We begin with property (a ).
The following Claim 29 shows that for any i the reduced k-graph R(Gi ) of Gi (with
respect to J ) has approximately the same H-density as Gi for each small H in expectation, and that this remains true when considering the subgraph induced on a large subset
of the clusters. For this, we say that a copy of H in Gi is P-crossing if it has at most
one vertex in any part of P.
If it happens to be the case that the density of H-copies in G equals the density of
P-crossing H-copies, and εSand εk are zero, this claim is a triviality. The number of Pcrossing copies of H in Gi [ X] then equals the number
obtained by

S applying Lemma 23
∗
to P , which in this case means that dH R(Gi )[X] equals dH (G [ X]) precisely.
Of course none of these assumptions are true, and consequently errors are introduced:
the proof of the following claim amounts to showing that since the assumptions are
‘almost’ true, the errors are small. It is convenient in the proof to use probabilistic
language: the probability that a random injective map from V (H) to V (G) is a graph
embedding is exactly the density of H-copies in G.
Claim 29. Let H be a labelled k-graph on h ≤ 1/εk vertices, X be a set of at least εk t
clusters of J , and G = Gi for some i ∈ [s]. Then

 h[ i


E dH R(G)[X] − dH G
X  ≤ εk /2.
J

Proof. Let the vertices
of H be labelled with the integers 1, . . . , h. Choose an injective
S
map φ : V (H) → X uniformly at random. Say that φ is P-crossing if no two vertices
of H are mapped to the same part of P, and let CROSS be the event that φ is P-crossing.
Also let EMB denote the event that φ is an embedding of H into G. We prove the claim
by calculating the conditional probability P(EMB | CROSS)S(that is, the proportion of
P-crossing h-tuples which form P-crossing copies
S of H in G[ X]) in two diﬀerent ways.
First, note that we have P(EMB) = dH (G[ X]) by deﬁnition. Recall that m = n/t
 is
S
|X|m
|X|m
the size of each cluster of J . Then there are h! h h-tuples in X. At most h! h−1 hm
of these h-tuples are not P-crossing. Since t ≥ t∗0 ≥ 20/ε4k by (3) and |X| ≥ εk t we have
h ≤ 1/εk ≤ εk t ≤ |X|m/2. So the probability of the complement CROSSc is at most

|X|m
h!
hm
εk
2h2
2
h2 m
h−1
P(CROSSc ) ≤
≤
≤ 3 ≤
.
=

|X|m
|X|m − h + 1
|X|
εk t
10
h!
h

We may therefore apply Proposition 27 with EMB, CROSS and the certain event in place
of E, C and S respectively, which gives
 h[ i ε
εk
k
= dH G
(8)
P(EMB | CROSS) = P(EMB) ±
X ± .
5
5
We now turn tothe second way of evaluating P(EMB | CROSS), this time in terms
of EJ dH R(G)[X] . For any h-tuple C := (C1 , . . . , Ch ) of distinct clusters of J , we say
that a copy of H in G is C-crossing if vertex j of H lies in the cluster Cj for each j ∈ [h].
Similarly, we say that φ is C-crossing if φ(j) ∈ Cj for each j ∈ [h], an event which we
denote by CROSSC .
Fix some h-tuple C := (C1 , . . . , Ch ), and let H be the k-complex generated by the
down-closure of H. For any slice J though P ∗ and any
S e ∈ H let Je denote the cell of
J on the clusters {Cj : j ∈ e}, and deﬁne J (H, C) := e∈H Je (so if φ is C-crossing, then
28

J (H, C) is the subcomplex of J consisting of all cells of J on sets of clusters to which φ
maps an edge of H). We can then extend J (H, C) to a slice through P ∗ by appropriate
choices of cells on each remaining set of clusters, and by Claim 28, the number of such
extensions does not depend on J . We therefore have
Y
Y
(9)
d∗ ({Cj : j ∈ e}) = E
d∗ ({Cj : j ∈ e}) .
E
J

J (H,C)

e∈H

e∈H

Let qJ (H,C) denote the number of C-crossing copies of H in G which are supported on
J (H, C). Then for each ﬁxed J (H, C) we have
qJ (H,C)
P(EMB and φ(H) is supported on J (H, C) | CROSSC ) =
.
mh
Observe that for each C-crossing copy of H in G there is precisely one possibility for
J (H, C) on which this copy is supported. Moreover, by Claim 28 there are precisely
Qk−1 −ej (H)
diﬀerent choices for J (H, C), each of which is equally likely to occur. Hence
j=2 dj
we have
1 X
qJ (H,C)
P(EMB | CROSSC ) = h
m
J (H,C)
(10)
k−1
1  Y −ej (H) 
= h
d
E qJ (H,C) .
m j=2 j
J (H,C)
If J has the property that G is (ε∗k , r ∗ )-regular with respect to JˆZ for every k-set
Z ⊆ C, then, because we chose ε∗k , ε∗ and r ∗ such that we can apply Lemma 23 with
β = εk /100, the number of C-crossing copies of H in G which are supported on J (H, C)
is
! k−1
!
Y
Y

ε
e (H)
k
dj j
mh .
qJ (H,C) =
d∗ {Cj : j ∈ e} ±
100
j=2
e∈H

If on the other hand J does not satisfy this property, we also need some bound on
qJ (H,C) . This number is obviously at least zero, and is at most the number of copies of H
S
in the k-graph whose edges are all k-tuples supported on Z∈(C) JˆZ . Since this k-graph
k
is automatically (ε∗k , r ∗ )-regular with respect to J , we can apply Lemma 23 to ﬁnd that
the number of C-crossing copies of H in G supported on J (H, C) satisﬁes
!
!
k−1
k−1
Y e (H)
Y e (H)

εk
qJ (H,C) ≤ 1 + 100
dj j
mh ≤ 2
dj j
mh ,
j=2

j=2

and hence

qJ (H,C) =

Y

e∈H

∗



d {Cj : j ∈ e} ± 2

!

j=2

e (H)
dj j

!

mh .

Now let ζ(C) be the fraction of slices J through P for which G is not (ε∗k , r ∗ )-regular
with respect to JˆZ for some k-set Z ⊆ C. Putting the above two estimates for qJ (H,C)
together with (10), we have

Y
 
εk 
∗
P(EMB | CROSSC ) =
d
{C
:
j
∈
e}
±
2ζ(C)
+
E
j
100
J (H,C)
e∈H
 Y
 
εk 
(9)
.
= E
d∗ {Cj : j ∈ e} ± 2ζ(C) +
100
J
e∈H
29

∗

k−1
Y

We now condition on the event CROSS. Observe that there is then precisely one htuple C = (C1 , . . . , Ch ) for which the event CROSSC occurs (i.e. φ is C-crossing). We
take C to be this k-tuple, so C is now a random variable. Moreover, since φ was chosen
uniformly at random and each cluster has equal size, the k-tuple C is chosen uniformly
at random among all possibilities, which implies that



Y

εk
∗
(11)
P(EMB | CROSS) = E E
d {Cj : j ∈ e} ± 2 E ζ(C) +
.
100
C
C J
e∈H

However, EC ζ(C) is simply the probability that our uniformly random C has the property
that G is not (ε∗k , r ∗)-regular
with respect to JˆZ for some k-set Z ⊆ C. Taking a union

h
bound, this is at most k multiplied by the probability that G is not (ε∗k , r ∗ )-regular with
respect to JˆZ for a k-set Z of clusters of X chosen uniformly at random. Since there are

 Qk−1 −(kj)
at least εkk t k-sets Z of clusters in X, and by (7) there are at most 2ε∗k s kt
j=2 dj
k
Q
k−1 ( j )
irregular polyads of P ∗ , each of which is chosen for J with probability j=2
dj , we ﬁnd
that
  ∗ t
h 2εk s k (3) 2ε∗k stk hk (4) εk
 ≤
(12)
≤
.
E ζ(C) ≤
εk t
k
(εk t/2)k
20
C
k

Finally,
since
C
is
chosen
uniformly
at
random,
by
deﬁnition
we
have
d
R(G)[X]
=
H
Q
∗
d
({C
:
j
∈
e}),
and
so
EC e∈H
j
Y

(13)
d∗ ({Cj : j ∈ e}) .
E dH R(G)[X] = E E
J

C J

e∈H

Combining equations (11), (12) and (13) we conclude that

E dH R(G)[X]) = P(EMB | CROSS) ±
J

εk
5

and so by (8) we have
 h[ i ε
k
d
R(G)[X])
=
d
X ± .
E H
H G
2
J




We next show that the random variable dH R(Gi )[X] is concentrated about its mean

using McDiarmid’s inequality. We will require enough concentration of dH R(Gi )[X] to
make use of a union bound over all possible H and X.
Claim 30. Let H be a k-graph on h ≤ 1/εk vertices, X a set of at least εk t clusters of
J , and G = Gi for some i ∈ [s]. Then the probability that dH R(G)[X] deviates from
E dH R(G)[X] by more than εk /2 is at most
1/εk
k

2 −(

) 2−2t .

Proof. We want to apply McDiarmid’s inequality, which holds for a random variable which
can be written as f (x) for a vector x whose
entries are independent random variables.

Hence we ﬁrst argue that dH R(G)[X] is of this form. We put an arbitrary order on
the j-cells of P ∗ . Let Y be a j-set of clusters. Then observe that when Algorithm 1
chooses the j-cell of J for Y , we have already chosen the cells of J (j−1) , so, by Claim 28,
JY is chosen uniformly at random from the exactly d−1
j-cells supported on J (j−1) [Y ].
j
30

Equivalently, we choose a number p from 1 to d−1
j uniformly at random and take the pth
(j−1)
∗
j-cell supported on J
[Y ] in P . It follows that we can write

dH R(G)[X] = f (x)

where x is a vector of integers whose ﬁrst |X|
coordinates are chosen independently
2

|X|
−1
uniformly at random in [d2 ], whose next 3 coordinates are chosen independently and
uniformly at random in [d−1
3 ], and so on.


We now want to bound f (x) − f (x′ ) for two vectors x, x′ diﬀering in
 only one coordinate. In other words, we want to bound the change cY of dH R(G)[X] when we change

the choice of the j-cell on the set Y ∈ Xj in Algorithm 1. Observe that this change
can only aﬀect weighted copies of H which use the j-cell Y . Moreover, t ≥ t∗0 ≥ 2/ε3k by
deﬁnition of t∗0 , and therefore εk t ≥ 2/ε2k ≥ 2h2 . Consequently we have
(14)
We therefore have
(15)

|X|h−j
cY ≤ |X|
≤
· h!
h

k−1 X
X

j=2 Y ∈(X )
j

c2Y

k−1  
(14) X
t

≤

j=2

j

th−j
th−j
−j

≤
≤ 2ε−h
k t
εk t
h
(εk t − h)
· h!
h
−j
2ε−h
k t

2

≤

k−1
X
j=2

−j
−2
4ε−2h
≤ 4kε−2h
k t
k t

Hence using Theorem 26, the probability that f (x) diﬀers from E f (x) by more than
εk /2 is at most
2 exp

 −ε2+2h t2 
 −4t 
 −ε2 /4 
k
k
=
2
exp
≤
2
exp
−2
32k
εkk
8kε−2h
k t


 −1 
1/εk
exp
−
2t
< 2−( k ) 2−2t ,
< exp
k
εk

2+2/εk +k

where the ﬁrst inequality holds since h ≤ 1/ε − k and t ≥ t∗0 ≥ 128k 2 /εk
deﬁnition of t∗0 .

by


We can now prove that property (a ) holds with high probability by taking a union
1/εk
bound over the s diﬀerent k-graphs Gi , the at most 2t choices of X and the 2( k ) choices
of H. Applying Claims
that with probability at least 1 − s2−t we

S  29 and 30 we deduce
have that dH Gi [ X] = dH R(Gi )[X] ± εk for all 1 ≤ i ≤ s, all k-graphs H with at
most 1/εk vertices and all sets X of at least εk t clusters.

Next we show that (b ) holds with high probability also. This is achieved through a
similar but simpler argument as for (a ), so we will be brief.
Note ﬁrst that since each
S
part of Q has equal size, any set X of clusters for which X is the union of some parts
of Q has size at least t/q. So ﬁx some 1 ≤ j ≤ k − 1, a set X of at least t/q clusters
of J , a j-set Y of clusters of J , and some k-graph G on V . We ﬁrst prove an analogue
of Claim 29, that the expected value of deg(Y ; RJ (G), X)
S conditioned upon the choices
of all cells on subsets of Y , is within εk /2 of deg(JY ; G, X). To prove this we choose
uniformly at random an edge {v1 , . . . , vj } of JY (which is ﬁxed since we are conditioning
on theSchoice of cell for Y ), and also choose uniformly at random vertices vj+1 , . . . , vk
from X so that the vertices
vi with 1 ≤ i ≤ k are all distinct. Let e = {v1 , . . . , vk }.
S
By deﬁnition deg(JY ; G, X) = P(e ∈ G). Let CROSS be the event that e is P-partite.
31

Using the fact that the set {v1 , . . . , vj } is automatically P-partite, we have, similarly as
in the proof of Claim 29, that

|X|m−j
km
εk
k2m
k−j−1
P(CROSS) ≥ 1 − |X|m−j  ≥ 1 −
≥1−
,
|X|m
−
k
+
1
10
k−j
and therefore

εk
.
4
For each i ∈ [j] let Ci be the cluster containing vi . Now ﬁx any (k − j) distinct clusters
Cj+1, . . . , Ck , and deﬁne C to be the k-tuple (C1 , . . . , Ck ). Recall that J [C] was deﬁned to
be the subcomplex of J consisting of all cells of J which are supported on the clusters of
C. By deﬁnition of relative density and Fact 3, the number of edges in EC corresponding
to any given choice of J [C] is
(16)

deg(JY ; G,

[

X) = P(e ∈ G | CROSS) ±

d∗J [C] (C)Kk (JˆC )




εk
10

= 1±

k−1
Y (k )
 ∗
dJ [C] (C)
di i mk ,
i=2

Let EC consist of the edges f ∈ G which have precisely one vertex in each cluster of C
and which satisfy f ∩ Y ∈ JY . Then for each ﬁxed C, summing over all possibilities for
J [C] we have
  X
EC  =
1±

εk
10

i=2

J [C]

= 1±
= 1±

εk
10

εk
10




k−1
Y (k)
 ∗
dJ [C] (C)
di i mk

E

J [C]

d∗J [C] (C)
j

∗

E dJ (C)
J

j
Y
(j )
di i mk
i=2

Y (j )
di i mk .
i=2

Qk−1 −((ki)−(ji))
di
The second line comes from observing that by Claim 28, EC is partitioned into i=2
sets according to the choice of J [C], and the distribution over choices of J [C] given by J
is uniform, which also gives the third line. The total number of possibilities for e which
give C is |JY |mk−j , and by Fact 3 we have
k−j

|JY |m

= 1±

εk
10

j
Y
(j )
di i mk .
i=2

We conclude that, writing CROSSC for the event that φ(vi ) ∈ Ci for each i ∈ [k], we have
 
EC 

εk
∗
=
1
±
P(e ∈ G | CROSSC ) =
E[dJ (C)] ,
4
|JY |mk−j
J

We now condition on the event CROSS. This implies that there is precisely one choice
of distinct clusters Cj+1, . . . , Ck of X \ Y for which the event CROSSC occurs; we now
take C to be given by this choice. Since vj+1 , . . . , vk were chosen uniformly at random,
and each cluster has equal size, it follows that the (k − j)-set {Cj+1, . . . , Ck } is chosen
uniformly at random from all (k − j)-sets in X \ Y . This implies that
P(e ∈ G | CROSS) = E E[d∗J (C)] ± εk /4.
32

C J

Furthermore, by deﬁnition we have EC (d∗J (C)) = deg(Y ; RJ (G), X), so
[
ε (16)
E[deg(Y ; RJ (G), X)] = P(e ∈ G | CROSS) ± 4k = deg(JY ; G, X) ±
J

εk
2

,

proving the analogue of Claim 29.
Next, we prove an analogue of Claim 30, namely that for any k-graph G on V , any
1 ≤ j ≤ k − 1, any j-set Y of clusters of J and any set X of at least t/q clusters of J ,
with high probability the random variable deg(Y ; RJ (G), X) conditioned on the choice
of all cells on subsets of Y is within εk /2 of its expectation conditioned on the choice of
all cells on subsets of Y . This argument is very similar to the proof of Claim 30. As
there, we can write deg(Y ; RJ (G), X) conditioned on the choice of all cells on subsets of
Y as a function f ′ (x) where the entries of x are integers corresponding to the choice of
i-cell on each i-set in X ∪ Y not contained in Y , for each 2 ≤ i ≤ k − 1. Again, for each
Z
 ′⊆ X ∪ Y′ of′ size
 between 2 and k − 1 not contained in Y , we let cZ bound the diﬀerence
f (x) − f (x ) for pairs of vectors diﬀering only on the entry corresponding to Z. The
value of f ′ (x) is the average value of d∗J (C) for sets C of clusters in X containing Y , and
changing the cell on Z aﬀects only those containing Y ∪ Z, so we have

|X\Z|
cZ ≤

k−|Y ∪Z|

|X\Y |
k−|Y |

≤ 2k!|X|−|Z\Y | ,

where the last inequality is obtained by using |X| ≥ t/q and the choice of t ≥ t∗0 ≥
10q k k k ε−1
k in (3). Note that |Z \ Y | ≥ 1 by assumption, so summing over all choices of Z
(where we write |Z \ Y | = j) we have
 
k−1
X
X
4k!2 k2k q
2
|Y | |X|
4k!2 |X|−2j ≤ 4k!2 k2|Y | |X|−1 ≤
,
cZ ≤
2
j
t
j=1
Z

where the ﬁnal inequality uses |X| ≥ t/q and |Y | ≤ k.
By Theorem 26 we ﬁnd that the probability that deg(Y ; R(G), X) fails to be within
S
εk /2 of EJ [deg(Y ; R(G), X)] (and therefore also the probability that deg(JY ; G, X)
diﬀers from deg(Y ; R(G), X) by more than εk ) is at most
 −ε2 t  (3)
√ (3)
√
−2 t
− t
k
≤
2
≤
2
/(2q s) .
2 exp
2
k
32k! k2 q
q
for X (since we required that

S For property (b ) there are only at most 2 tpossibilities
t
X is a union of parts of Q), and at most 1 + · · · + k−1
≤ tk−1 possibilities for Y .
So we can take a union bound over all G = G1 , . . S
. , Gs , all sets Y of between 1 and k − 1
clusters of J , and all sets X of clusters such that X is a union
of parts of Q, to deduce
√
k−1 − t
that property (b ) holds with probability at least 1 − t 2 .
To complete the proof, we need to show that property (c ) holds with high probability;
the argument for this splits into two parts. The ‘probabilistic’ part is to show that J
takes about the same fraction of every slice (regular or otherwise) through P̃ ∗ . Let us
brieﬂy sketch how this helps us. We want to show that the density of rooted copies of H
is about equal to the density of rooted copies of H supported on J . The former density
is easily seen to be close to the average over slices J˜ through P̃ ∗ of the density of rooted
copies of H supported on J˜. Now Lemma 22(f ) implies that if J˜ is any slice through P˜∗ ,
and X is any P̃-consistent collection of t̃ clusters of P, then the density of rooted copies
of H supported on J˜ is close to the density of rooted copies of H supported on J˜[X].
Finally, since J contains about the same number of subcomplexes of the form J˜[X] for
33

each J˜, the density of rooted copies of H supported on J is close to the average over J˜
of the density of rooted copies of H supported on J˜, which is what we want to show.
The proof of the following ‘probabilistic part’ follows the same pattern as we saw for
parts (a ) and (b ), showing that a certain random variable has the desired expectation,
and then using McDiarmid’s inequality to establish concentration. We remark that the
latter depends on the fact that the number of clusters of J is much greater than the
number of slices through P̃ ∗ by choice of p(·).
Claim 31. With probability at least 1 − 2−t , for each slice J˜ through P̃ ∗ , the number of
sets X of t̃ clusters of P ∗ , one in each cluster of P̃, such that J [X] ⊆ J˜, is
(1 ±

(17)

εk
)p(t∗1 )t̃
16

k−1
Y
(t̃)
dj j .
j=2

Proof. Let J˜ be a slice through P̃ ∗ . If X is a ﬁxed set of t̃ clusters of P ∗ , one in each
cluster of P̃ ∗ , then,
by Lemma 22(b ), J [X] ⊆ J˜ exactly if for each 2 ≤ j ≤ k − 1

X
and set Y of j , we happened to choose the one j-cell on Y which is a subset of the
corresponding j-cell in J˜. Conditioning on having done this for j ′ -cells for j ′ < j, the
probability of doing
so for any given Y is dj by Claim 28, and these choices for diﬀerent

X
members of j are independent. It follows that the probability that J [X] ⊆ J˜ is
k−1
Y

(t̃)
dj j .

j=2

The total number of choices of X is p(t∗1 )t̃ , since each cluster of P̃ ∗ is split into p(t∗1 )
clusters of P ∗ by Lemma 22(c ). By linearity of expectation, the expected number of sets
X such that J [X] ⊆ J˜ is
p(t∗1 )t̃

k−1
Y

(t̃)
dj j

j=2

as desired. Similarly as for parts (a ) and (b ), we can write the number of P̃-consistent
′′
˜
sets X of t̃ clusters of P ∗ such that J [X]
 ⊆ J in the form f (x), where x represents the
P
choice of j-cell on Y for each Y ∈ j and each 2 ≤ j ≤ k − 1. As before, we let cY
be the maximum change in f ′′ (x) which can be obtained by changing the choice of cell
on Y . Observe that if Y contains two or more clusters from the same part of P̃ then we
have cY = 0, while otherwise changing the cell on Y can only aﬀect those P ∗ -consistent
sets X such that Y ⊆ X, of which there are exactly p(t∗1 )t̃−|Y | . So we have
X
Y

c2Y

k−1  
X
2
t̃
p(t∗1 )j p(t∗1 )t̃−j ≤ 2t̃ p(t∗1 )2t̃−2
≤
j
j=2

and hence by Theorem 26, the probability that the number of sets X with J [X] ⊆ J˜
deviates by more than
εk
p(t∗1 )t̃
16

k−1
Y
j=2

34

(t̃)
dj j

from its expectation is at most
t̃

2 exp

 −ε2 p(t∗ )2t̃ Qk−1 d2(j ) 
k

1

2 · 162 ·

j=2 j
t̃
2 p(t∗1 )2t̃−2



∗

≤ 2 exp −2−t1 −9 ε2k p(t∗1 )2

k−1
Y
j=2

1
t∗1

2(t∗1 )
j



,

where the inequality follows from Lemma 22(c ) and (d ), which imply that dj ≥ 1/t∗1 for
each j and t̃ ≤ t∗1 . Since we chose p(·) to satisfy (5) (which we apply with t∗1 in place of
x), and we have t ≤ t1 = p(t∗1 )t∗1 by Lemma 22(c ), this probability is smaller than
t∗

2

k−1  ( 1 )
Y
j
1
∗

−p(t∗1 )t1

j=2

t∗1

≤2

−t

k−1
Y
(jt̃)
dj .
j=2

We can therefore take a union bound over the (by Claim 28)
obtain the desired conclusion.

Qk−1

−(jt̃ )

j=2 dj

choices of J˜ to


We want to show that if the likely event of Claim 31 holds, then using Lemma 22(f ) we
can deduce property (c ). So ﬁx G = Gi for some i ∈ [s]. Now for any ﬁxed 1 ≤ ℓ ≤ 1/εk ,
any ﬁxed k-graph H equipped with a set of distinct root vertices x1 , . . . , xℓ such that
h = v(H) ≤ 1/εk and any ﬁxed set of distinct vertices v1 , . . . , vℓ in V , we would like to
show that the density dH (Gi ; v1 , . . . , vℓ ) of rooted H-copies in G is within εk of the density
dH (Gi ; v1 , . . . , vℓ , J ) of rooted H-copies in G supported on J . Recall that the vertex set
of Hskel consists of all vertices of H except for x1 , . . . , xℓ . Choose uniformly at random
a map ψ : V (Hskel) → V (G), and deﬁne ψ ′ : V (H) → V (G) by taking ψ ′ (xj ) = vj for
any j ∈ [ℓ] and ψ ′ (x) = ψ(x) for any x ∈ V (Hskel ) (note carefully that, unlike for the
previous cases, we do not insist that ψ is injective, and that even if ψ is injective the
same may not be true of ψ ′ ). Let INJ denote the event that ψ ′ is injective, and let EMB
denote the event that ψ ′ is an embedding of H into G (so EMB is a subset of INJ). Next,
let CROSSP denote the event that ψ is P-crossing, meaning as before that each vertex
of Hskel is mapped to a distinct part of P, and similarly let CROSSP̃ denote the event
that ψ is P̃-crossing. Finally, for any (k − 1)-complex L on V let SLL denote the event
that ψ is an embedding of Hskel into L. Then by deﬁnition we have
(18)

dH (Gi ; v1 , . . . , vℓ ) = P(EMB | INJ),

and
(19)

dH (Gi ; v1 , . . . , vℓ , J ) = P(EMB | SLJ ∩ CROSSP ),

and our aim is to show that these two conditional probabilities diﬀer by at most εk . We
shall frequently refer to events of the form SLL ∩ CROSSP̃ for some (k − 1)-complex L
on V , so for brevity we denote this event by SL∗L .
Our ﬁrst goal is to show that conditioning on CROSSP̃ instead of on INJ in (18) and
on CROSSP in (19) has an insigniﬁcant eﬀect on the probabilities expressed in these
equations, since these events are all highly probable (even after conditioning on SLJ ).
Indeed, similarly as before we have

n
h(n/t̃)
2h2 (3) εk
h(h − ℓ)n/t̃
h−ℓ−1
c

(20)
P(CROSSP̃ ) ≤
≤
≤
.
=
n
n−h+ℓ+1
t0
100
h−ℓ

Now observe that ψ can be obtained by selecting a uniformly-random image ψ(x) for
each x ∈ V (Hskel ) in turn. The event INJ will occur unless for some x we select ψ(x)
35

to be one of the at most h − ℓ previously-chosen images or one of the vertices v1 , . . . , vℓ .
Taking a union bound, it follows that for any X ∈ X we have
h
h2
εk
(21)
P(INJ ) ≤ (h − ℓ) ≤
≤
.
n
n
100
By (20) we may apply Proposition 27 with EMB and CROSSP̃ in place of E and C
respectively, and by (21) we may apply the same proposition with EMB and INJ in place
of E and C respectively (in each case we take S to be the event which always occurs and
εk
in place of ε). This gives our approximation for (18), namely
100
c

(22)

P(EMB | INJ) = P(EMB) ±

εk
50

= P(EMB | CROSSP̃ ) ±

2εk
.
50

We turn now to (19), beginning
with the next claim. We deﬁne X to be the set of all

P
P̃-consistent sets X ∈ t̃ . (Recall that this means that X is a set of t̃ clusters in P, one
contained in each part of P̃).
Claim 32. Let L be a slice through P ∗ . Then

εk Qk−1 ei (Hskel )
,
(a ) P(SLL | CROSSP ) = 1 ± 100
i=2 di

Q
skel )
e
(H
k−1
εk
i
(b ) P(SLL | CROSSP̃ ) = 1 ± 100
, and
i=2 di
 ∗ ℓ−h
εk
∗
∗
(c ) for any X ∈ X we have P(SLL[X] | SLL ) = 1 ± 20
p(t1 ) .

εk
Furthermore, for any slice J˜ through P̃ ∗ we have P(SLJ˜ | CROSSP̃ ) = 1± 100

 Qk−1
i=2

e (Hskel )

di i

Proof. Identify the vertices of Hskel with the integers of [h−ℓ]. Then for any (h−ℓ)-tuple
C = (C1 , . . . , Ch−ℓ ) of distinct clusters of L (i.e. parts of P), we say that a copy of Hskel in
L is C-distributed if for each j ∈ [h − ℓ] vertex j of Hskel lies in cluster Cj of L. Likewise,
we say that ψ is C-distributed if ψ(j) ∈ Cj for each j ∈ [h − ℓ], an event which we denote
by DISTC . Note that if we condition on the event DISTC , then for each j ∈ [h − ℓ] the
image ψ(j) is a uniformly-random vertex in Cj . It follows that P(SLL | DISTC ) is equal
to the number of C-distributed labelled copies of Hskel in L divided by mh−ℓ (the number
of possibilities for ψ given that DISTC occurs). So by Lemma 23 we obtain the estimate
P(SLL | DISTC ) = 1 ±

(23)

εk
100

k−1
Y

e (Hskel )

di i

.

i=2

Since the events DISTC partition the event CROSSP , this implies (a). Similarly we obtain
(b) since the event CROSSP̃ is partitioned by the events DISTC for those (h − ℓ)-tuples C
for which each Cj is a subset of a distinct part of P̃. Now, ﬁx X ∈ X , and let DISTX be the
event that ψ maps each vertex of Hskel to a distinct member of X (so DISTX ⊆ CROSSP̃ ).
Then the event DISTX is partitioned by the events DISTC for (h − ℓ)-tuples C of distinct
sets in X, each of which is equally likely to occur. Summing (23) over all such k-tuples
C,we obtain
P(SL∗L[X]

| DISTX ) =

P(SL∗L

| DISTX ) = 1 ±

Together with the fact that P(DISTX | CROSSP̃ ) =
uniformly at random), this gives
P(SL∗L[X] | CROSSP̃ ) = 1 ±
36

εk
100



εk
100

Y
 k−1

.

i=2

p(t∗1 )−(h−ℓ)

p(t∗1 )−(h−ℓ)

e (Hskel )

di i

k−1
Y
i=2

(since ψ was chosen

e (Hskel )

di i

.

.

Since SL∗L[X] ⊆ SL∗L , this equation and part (a) together prove (c). Finally, the proof of
the ﬁnal statement is almost identical to the proof of (a); the only diﬀerences are that we
instead consider k-tuples C of parts of P̃, and that the term mh−ℓ is replaced by (n/t̃)h−ℓ
(but this term is, as above, cancelled by the output from Lemma 23).

Note that P(CROSSP ∩ SLJ ) = P(SLJ | CROSSP )P(CROSSP ) ≤ P(SLJ | CROSSP ),
and Claim 32 part (a) gives an approximation for this probability. Similarly we have
P(CROSSP̃ ∩ SLJ ) = P(SLJ | CROSSP̃ )P(CROSSP̃ ), which we can approximate by
Claim 32 part (b) and (20). So, since CROSSP̃ ⊆ CROSSP , we obtain
P(CROSSP̃ ∩ SLJ )
P(CROSSP ∩ SLJ )

εk Qk−1 ei (Hskel )
1 − 100
(1 −
i=2 di
≥

Q
skel )
e
(H
k−1
εk
i
1 + 100
i=2 di
≥ 1 − ε20k .

P(CROSSP̃ | CROSSP ∩ SLJ ) =

εk
)
100

We may therefore apply Proposition 27 with EMB, CROSSP ∩ SLJ and CROSSP̃ in place
of E, S and C respectively to obtain
P(EMB | CROSSP ∩ SLJ ) = P(EMB | CROSSP̃ ∩ SLJ ) ±

εk
.
10

Combining this equation with (18), (19), (22) and the deﬁnition of SL∗J as SLJ ∩CROSSP̃ ,
we conclude that it is suﬃcient to prove that
(24)

P(EMB | CROSSP̃ ) = P(EMB | SL∗J ) ±

εk
2

.

Qk−1 −(jt̃ )
dj
We begin with the left hand side of (24). Recall that there are precisely j=2
∗
slices J˜ through P̃ , and observe that if the event CROSSP̃ occurs then by Claim 28
Qk−1 ej (Hskel )−(jt̃)
dj
there are precisely j=2
slices J˜ through P̃ ∗ for which the event SL∗J˜ occurs.
By deﬁnition we have SL∗J˜ ⊆ CROSSP̃ for any such slice, so summing over all slices J˜
through P̃ ∗ we obtain
(25) P(EMB | CROSSP̃ ) =

k−1
Y
j=2

(t̃)−ej (Hskel ) X
P(EMB | SL∗J˜ )P(SL∗J˜ | CROSSP̃ )
dj j
J˜

= (1 ±

εk
)
100

k−1
Y
(t̃) X
dj j
P(EMB | SL∗J˜ ) ,
j=2

J˜

where the ﬁnal equality holds by the ﬁnal part of Claim 32.
We next show that for any slice J˜ through P˜∗ and any X ∈ X the probabilities
P(EMB | SL∗J˜ ) and P(EMB | SL∗J˜[X] ) are roughly equal. To do this, ﬁx any X ∈ X , and

for any set Ỹ of h − ℓ parts of P̃, let Y be the (unique) Ỹ -consistent subset of X. Then
for any choice of Ỹ , Lemma 22(f ) states that we have

P(EMB | SL∗J˜[Ỹ ] ) = P(EMB | SL∗J˜[Y ] ) ± ε∗k .

P̃
Since the events SL∗J˜[Ỹ ] for Ỹ ∈ h−ℓ
partition the event SL∗J˜ , the events SL∗J˜[Y ] partition

P̃
εk
the event SL∗J˜[X] , and ε∗k ≤ 100
by (4), we may sum over all Ỹ ∈ h−ℓ
to obtain
(26)

P(EMB | SL∗J˜ ) = P(EMB | SL∗J˜[X] ) ±
37

εk
.
100

Turning to the right hand side of (24), we next show that P(EMB | SL∗J ) is close to the
average of P(EMB | SL∗J [X] ) over all of the p(t∗1 )t̃ sets X ∈ X . Observe that the events
SL∗J [X] for X ∈ X cover SL∗J , with each ψ ∈ SL∗J covered exactly p(t∗1 )t̃−h+ℓ times. We
thus obtain
X
(27) P(EMB | SL∗J ) = p(t∗1 )−t̃+h−ℓ
P(EMB | SL∗J [X] )P(SL∗J [X] | SL∗J )
X∈X


= 1±

εk
20



X
p(t∗1 )−t̃
P(EMB | SL∗J [X] ) .
X∈X

where the second equality holds by Claim 32 part (c).
Finally, we want to connect the averages in (25) and (27). Observe ﬁrst that for any
X ∈ X there is precisely one slice J˜ through P̃ ∗ such that J [X] ⊆ J˜, and for this J˜ we
have J [X] = J˜[X], which implies
(28)

(26)

P(EMB | SL∗J [X] ) = P(EMB | SL∗J˜[X] ) = P(EMB | SL∗J˜ ) ±

εk
100

Since the last term does not depend on X, we only need to know, for each J˜, how many
sets X ∈ X satisfy J [X] ⊆ J˜. If J satisﬁes the good event of Claim 31, then the answer
is given by (17), and so by summing (28) over all X ∈ X we obtain


X
X
X
εk
∗
∗
P(EMB | SLJ˜ ) ± 100
P(EMB | SLJ [X] ) =
J˜ X∈X : J [X]⊆J˜

X∈X

(17)

=

X
J˜

εk
)p(t∗1 )t̃
16

(1 ±

k−1
Y
(t̃)
dj j P(EMB | SL∗J˜ ) ±

εk
100

j=2

where the sum is over all slices J˜ through P˜∗ . Together with (27), this implies that
P(EMB |

SL∗J )

±

εk
20

=

X
J˜

(1 ±

εk
)
16

k−1
Y
(t̃ )
dj j P(EMB | SL∗J˜ ) ±
j=2

 k−1

Y (t̃) X
j
∗
=
dj
P(EMB | SLJ˜ ) ±
j=2

εk
8

εk
100



,



,

J˜

which together with (25) implies (24). This completes the proof that if J has the good
event of Claim 31 then it satisﬁes property (c ) of Lemma 6.
Finally, we conclude that the
probability that J satisﬁes all the conclusions of Lemma 6
√
is at least 1/2 − s2−t − tk−1 2− t − 2−t . Since t ≥ t∗0 , by choice of t∗0 in (3) this probability
is strictly greater than zero, and so some J exists as required.

9. Embedding tight cycles
Our aim in this section is to prove Lemma 9. We start with some deﬁnitions.
Recall the deﬁnition of a tight walk W from Section 4.3. As we did for tight paths,
we deﬁne the length ℓ(W ) of W to be the number of edges in W (i.e. the number of
consecutive k-sets of vertices). We refer to the ﬁrst s vertices of W , ordered as they
appear in W , as the initial s-tuple of W , and similarly to the ﬁnal s vertices as the
terminal s-tuple of W . Initial and terminal (k − 1)-tuples have particular importance,
as given tight walks W and W ′ for which the terminal (k − 1)-tuple of W is identical to
the initial (k − 1)-tuple of W ′ , we may concatenate W and W ′ to form a new tight walk,
38

which we denote W + W ′ ; when doing so, we always include the common (k − 1)-tuple
only once, so the edges of W + W ′ are precisely the edges of W followed by the edges of
W ′ . In particular, we have ℓ(W + W ′ ) = ℓ(W ) + ℓ(W ′). Note that this deﬁnition includes
the case where W and W ′ are tight paths, in which case W + W ′ is also a tight path
provided that W and W ′ have no common vertices outside this common (k − 1)-tuple.
Before giving the full proof of Lemma 9, we brieﬂy sketch our approach. We show that
for any k-tuple X = (X1 , . . . , Xk ) of clusters of J which forms an S
edge of R := Rdk (G),
we can ﬁnd a long tight path ‘winding around’ the k clusters in G[ i∈[k] Xi ] by repeated
use of the Extension Lemma. Indeed, we proceed in steps, at each time j ≥ 1 keeping
track of a tight path P (j) and a set P (j) of ‘possible extensions’ of P (j) : the latter are
short tight paths whose initial (k − 1)-tuples are equal to the terminal (k − 1)-tuple of
P (j) , and whose terminal (k − 1)-tuples are all distinct. The Extension Lemma tells us
that at each time step j there must exist some P ∈ P (j) so that, taking P (j+1) to be
P (j) + P , there is a family P (j+1) which are possible extensions of P (j+1) (this argument
is formalised in Claim 33). This procedure, which we refer to as ‘ﬁlling the edge X’, can
be continued until only few vertices remain in each cluster of X.
Of course, for large ℓ we need to cover more vertices than are contained in any k
clusters; this is the point at which the connectedness of the fractional matching comes
into play. By assumption we can ﬁnd a tight walk W in R which visits every edge e ∈ R
whose weight we is non-zero. Starting at some such edge e, we proceed to ‘ﬁll’ this edge
as described above, stopping when our tight path P (j) covers around a we -proportion of
the vertices of each cluster. We then extend P (j) by ‘traversing the walk W ’ to the next
edge e′ of non-zero weight. Since this extension of P (j) is short, few vertices are used in
total in walk-traversing steps. So the ﬁnal proportion of vertices covered by our tight
path in any cluster Xi is approximately the sum of the weights of edges of R containing
Xi . Overall, this gives a path covering suﬃciently many vertices for the bound given in
the lemma. To obtain a shorter tight path, we simply stop ‘ﬁlling’ each edge at an earlier
stage.
Finally, it remains to ‘join the ends’ of our tight path to form a tight cycle. For this, at
the very start of the argument we set aside some large subsets Z1 , . . . , Zk of some clusters
X1 , . . . , Xk which form an edge of R. We then choose our ﬁrst path P (0) so that, as well
as there being many extensions P (0) suitable for use to form P (1) , there are also many
(k − 1)-tuples f in Z1 , . . . , Zk−1 which can be extended to the initial (k − 1)-tuple of P (0) .
We now present the full details of the proof.
Proof of Lemma 9. We set
(29)

α=

ψ
5

and

β=

1
200

.

We will want to apply Lemma 24 to k-partite k-complexes (i.e. with s = k) with α as
given in (29) and with εk playing the same role here as there. Also, we will want to
apply Lemma 25 to both k-partite and (2k − 1)-partite k-complexes (i.e. with s = k and
with s = 2k − 1) whose top levels have relative density at least dk , with each choice of
√
1 ≤ b′ < b ≤ 3k, with β as given in (29), and with εk in place of εk . We require εk > 0
to be small enough for each of these applications.
Given d2 , . . . , dk−1 , the various applications of Lemma 25 mentioned above require
various suﬃciently small positive values for c. We take c > 0 to be the minimum of these
values (we will have a bounded number of choices of parameters, hence this minimum is
well-deﬁned).
39

We now require ε < c2 to be small enough for each of the applications of Lemmas
√ 24
and 25 mentioned above to k-complexes whose underlying (k − 1)-complex is (·, ·, ε)Qk−1 (k−1
)
equitable with density vector d = (dk−1 , . . . , d2 ). In addition, we require ε ≤ 12 i=2
di i
√
to be small enough that we can apply Fact 3 with 21 in place of β to (·, ·, ε)-equitable
k-partite k-complexes with density vector d. We require r to be large enough for the
above mentioned applications of Lemma 25. We also choose m0 ≥ 16(k − 1)/ε to be large
enough so that any m ≥ αm0 is acceptable for all of these applications.
Given t, we set
(30)


200k 8k 2(k + 1)t2k 
n0 = t · max m0 ,
.
, √ ,
ε α ε
α

Now let G be an n-vertex k-graph, where n ≥ n0 , and let J be a (·, ·, ε, εk , r)-regular
slice for G with t clusters and density vector d. Let R := Rdk (G), and let m := n/t,
so each cluster of J has size m. We write G for the k-complex obtained from J by
adding all S
edges of G supported on J (k−1) as the ‘k-th level’ of G. So for any edge
X ∈ R, G[ X ′ ∈X X ′ ] is a (d∗ (X), dk−1, . . . , d2, ε, εk , r)-regular k-partite k-complex with
d∗ (X) ≥ dk . Furthermore, for convenience of notation, for any s-tuple X = (X1 , . . . , Xs )
of clusters of J andSany subsets Yj ⊆ Xj for j ∈ [s] we write G(Y1 , . . . , Ys ) for the spartite s-graph GX [ j∈[s] Yj ], that is, whose edges are the edges of G (s) with one vertex
in each Yj . In addition, we say that an s-tuple (v1 , . . . , vs ) of vertices of G is an ordered
edge of G(Y1 , . . . , Ys ) if {v1 , . . . , vs } is an edge of G and vj ∈ Yj for each j ∈ [s].
Since J is a regular slice
S for G, for any set X of k clusters X1 , . . . , Xk of J the kpartite (k − 1)-complex J [ j∈[k] Xj ] is (d, ε, ε, 1)-regular. By adding all sets of k vertices
supported on the polyad JˆX as a ‘k-th level’, we may obtain a (1, dk−1, . . . , d2, ε, εk , r)regular k-partite k-complex, whose restriction
√ √ to any subsets Yj ⊆ Xj of size |Yj | = αm
for each j ∈ [k] is then (1, dk−1, . . . , d2 , ε, εk , r) by Lemma 24. We conclude by Fact 3
that for any subsets Y1 , . . . , Yk−1 of distinct clusters of J , each of size αm, we have

(31)
e G(Y1 , . . . , Yk−1) ≥ εmk−1 .
The heart of our embedding lemma is the following claim. We will use it in steps when
we ﬁll an edge of R with i = 0, and in walk-traversing steps with i = 1.

Claim 33. Let {X1 , . . . , Xk } be an edge of R, and choose any Yj ⊆ Xj for each j ∈ [k] so
that |Y1| = · · · = |Yk | = αm. Let P be S
a collection of at least 21 e(G(Y1 , . . . , Yk−1)) tight
paths in G (not necessarily contained in j∈[k] Yj ) each of length at most 2k +1 and whose
terminal (k − 1)-tuples are distinct members of G(Y1 , . . . , Yk−1). Then for each i ∈ {0, 1}
9
e(G(Yi+1 , . . . , Yi+k−1)) tight paths in G,
there is a path P ∈ P and a collection P ′ of 10
each of length k + i, all of whose initial (k − 1)-tuples are the terminal (k − 1)-tuple of
P , whose terminal (k − 1)-tuples are distinct members of G(Yi+1 , . . . , Yi+k−1 ), and where
the jth vertex of each path in P ′ lies in Yj and, if j ≥ k, is not contained in P .
One might expect to prove this claim by trying to extend the terminal (k − 1)-tuple
of a path in P in many diﬀerent ways using Lemma 25. But it turns out to be hard
to show that these many diﬀerent ways really go to many diﬀerent terminal (k − 1)tuples, and so what we actually do is show the stronger statement that most pairs of
disjoint (k − 1)-tuples are joined by many paths. That is, we apply Lemma 25 with H
the k-complex formed by a tight path and H′ the subcomplex induced by its initial and
terminal (k − 1)-tuples.
40

Proof. We take H to be the k-complex generated by the down-closure of a tight path of
length k + i (so H has 2k − 1 + i vertices), and consider its k-partition in which the ith
vertex of the path lies in the vertex class Vj with j = i modulo k. We take H′ to be the
subcomplex of H (with empty kth level) induced by the ﬁrst and lastSk − 1 vertices of
H. By our assumptions on our various constants and by Lemma 24, G[ j∈[k] Yj ] satisﬁes
the conditions to apply Lemma 25. Consider the pairs (e, f ), where e is an ordered
(k − 1)-edge of G(Y1 , . . . , Yk−1 ) and f is an ordered (k − 1)-edge of G(Yi+1 , . . . , Yi+k−1).
For any such ordered edge e there are at most kmk−2 such ordered edges f which intersect
e, so by (30) and (31), at most a 1/200-proportion of the pairs (e, f ) are not disjoint.
On the other hand, if e and f are
S disjoint, then (the down-closure of) the pair (e, f )
forms a labelled copy of H′ in G[ j∈[k] Yj ], so by Lemma 25 with b = 2k − 1 + i and
b′ = 2k − 2, for all√but at most a 1/200-proportion of the disjoint
S pairs (e, f ) there are at
i+1
i+1
least c(αm) ≥ ε(αm) extensions to copies of H in G[ j∈[k] Yj ]. Each such copy of
H corresponds to a tight path in G of length k + i with all vertices in the desired clusters.
We conclude that at least a 99/100-proportion of all pairs (e, f ) of ordered edges are
disjoint and are linked by at least this many tight paths in G of the desired type; we call
these pairs extensible.
Let us call an ordered edge e ∈ G(Y1 , . . . , Yk−1) good if at most one-twentieth of the
ordered edges f ∈ G(Yi+1 , . . . , Yi+k−1) do not make an extensible pair with e. Then at
most one-ﬁfth of the ordered edges in G(Y1 , . . . , Yk−1) are not good. In particular, there
must exist a path P ∈ P whose terminal (k − 1)-tuple is a good ordered edge e. Fix such
a P and e. Given any ordered edge f in G(Yi+1 , . . . , Yi+k−1) which is disjoint
P,
√ from i+1
suppose the pair (e, f ) is an extensible pair. By deﬁnition there are at least ε(αm)
tight paths in G from e to f where the jth vertex of each path lies in Yj . We claim that
at least one of these paths has the further property that if j ≥ k, then the jth vertex is
not contained in P (and we can therefore put this path in P ′ ). Indeed, as f is disjoint
from P , if i = 0 it suﬃces to show that one of these paths has the property that√its kth
vertex is in Yk \ V (P ). This is true because there are only V (P ) ≤ 2k + 1 < ε(αm)
(where the last inequality is by (30)) paths which do not have this property. If on the
other hand i = 1, then we need a path whose
√ kth2and (k + 1)st vertices are not in V (P ),
which is possible since 2(2k + 1)(αm) < ε(αm) by (30).
Finally, consider the ordered edges f ∈ G(Yi+1 , . . . , Yi+k−1). Since by (30) and (31)
we have 20|P |(αm)k−2 ≤ εmk−1 ≤ e(G(Yi+1 , . . . , Yi+k−1)), at most one-twentieth of these
edges f intersect P , and by choice of e at most one-twentieth of these edges f are such
that (e, f ) is not extensible. This leaves at least nine-tenths of the edges f remaining;
choosing a tight path for each such f as described above gives the desired set P ′ .

Now, let e1 , . . . , es be the edges of non-zero weight in our fractional matching in R, and
let w1 , . . . , ws be the corresponding weights. For each i ∈ [s] let ni be any integer with
(32)

0 ≤ ni ≤ (1 − 3α)wi m .

We next construct tight walks Wi in R for ‘traversing’ from ei to ei+1 for each 1 ≤ i ≤ s−1.
Since our fractional matching is tightly connected, we may choose a minimum length tight
walk W1 from e1 to e2 . Then for each 2 ≤ i ≤ s − 1, we may take a minimum length tight
walk Wi from ei to ei+1 whose initial (k − 1)-tuple is the terminal (k − 1)-tuple of Wi−1 .
Finally, we construct a tight walk Ws from es to e1 whose initial (k − 1)-tuple is the
terminal (k−1)-tuple of Ws−1 and whose terminal (k−1)-tuple is the initial (k−1)-tuple of
W1 . We do this construction diﬀerently in order to ensure that our ﬁnal cycles have length
divisible by k. Indeed, let W ′ be the concatenation W1 +· · ·+Ws−1 , so W ′ = (A1 , . . . , Aℓ′ )
is a tight walk in R from e1 to es . Now we let Ws be the sequence of clusters given by
41

writing down the terminal (k − 1)-tuple of W ′ , that is, Aℓ′ −k+2 , Aℓ′ −k+3 , . . . , Aℓ′ , followed
by the penultimate (k −1)-tuple Aℓ′ −k+1 , Aℓ′ −k+2 , . . . , Aℓ′ −1 , and so on until we eventually
write the initial (k−1)-tuple. Now any k consecutive vertices of Ws come from two (k−1)tuples in W ′ which share k − 2 vertices. Since W ′ is a tight walk in R, the vertices of
the two (k − 1)-tuples make an edge of R. In other words, Ws is a tight walk in R. Note
that by construction the terminal (k − 1)-tuple of Ws is the initial (k − 1)-tuple of W1 ,
and also that we have
s−1
X
′
ℓ(Ws ) = (k − 1)ℓ(W ) = (k − 1)
ℓ(Wi ) .
i=1

Note that any given (k − 1)-tuple can appear at most once (consecutively) in a minimum
length tight walk between two edges of R, or else we could contract the walk. It follows
that each of the walks Wi has length ℓ(Wi ) ≤ tk−1 . Since R has at most kt edges we
Ps−1
P
ℓ(Wi ) is a multiple of k and is at most t2k .
conclude that si=1 ℓ(Wi ) = k i=1
Let (X1 , . . . , Xk ) be the initial k-tuple of W1 (so X1 , . . . , Xk are the clusters of e1 in
the order in which they appear in W1 ). Given any subsets Yj ⊆ Xj of size |Yj | = αm for
j ∈ [k], we say that an edge e ∈ G(X1 , . . . , Xk−1 ) is well-connected to (Y1 , . . . , Yk−1) via
Yk if for at least nine-tenths of the (k − 1)-tuples f in G(Y1 , . . . , Yk−1 ) there exist distinct
vertices u, v ∈ Yk such that the concatenations e + (u) + f and e + (v) + f are tight
pathsSin G of length k. Now ﬁx a subset Zj ⊆ Xj of size αm for each j ∈ [k], and write
Z = j∈[k] Zj . We reserve the vertices of Z for joining together the ends of the tight path
we will construct to obtain a cycle; the following claim establishes the properties we will
need to do this.

Claim 34. For any subsets Yj ⊆ Xj of size αm for j ∈ [k] such that each Yj is disjoint
from Zj the following statements hold.
(a ) At least nine-tenths of the (k − 1)-tuples e in G(Z1 , . . . , Zk−1 ) are well-connected to
(Z1 , . . . , Zk−1) via Zk .
(b ) At least nine-tenths of the (k − 1)-tuples e in G(Z1 , . . . , Zk−1 ) are well-connected to
(Y1 , . . . , Yk−1 ) via Yk .
(c ) At least nine-tenths of the (k − 1)-tuples e in G(Y1 , . . . , Yk−1) are well-connected to
(Z1 , . . . , Zk−1) via Yk .
Proof. Observe that (a ) was in fact proved in the proof of Claim 33 (in the case i = 0),
with Y1 , . . . , Yk there corresponding to Z1 , . . . , Zk here. We here modify this argument
to prove (b ); a near-identical argument proves (c ). We apply Lemma 25 as in Claim 33,
with H being the k-complex generated by the down-closure of a tight path of length k
(that is, with 2k − 1 vertices), and H′ the subcomplex induced by its initial and terminal
(k − 1)-tuples. However, we now regard H as a (2k − 1)-partite k-complex, with one
vertex in each vertex class. The role of G in Lemma 25 is played by the (2k − 1)-partite
subcomplex of G with vertex classes Z1 , . . . , Zk−1 , Yk , Y1 , . . . , Yk−1; the ﬁrst vertex of H
is to be embedded in Z1 , the second in Z2 , and so forth. So by Lemmas 24 and 25 the
proportion of pairs (e, f ) for which there is no path as in (b ) is at most 1/200, and the
remainder of the argument then follows exactly as in Claim 33.

(0)

We are now ready to construct our cycle. Arbitrarily choose a subset Xj ⊆ Xj of
size αm which is disjoint from Zj for each j ∈ [k]. By Claim 34(a ) and (b ) we may ﬁx a
(k − 1)-tuple e ∈ G(Z1 , . . . , Zk−1) such that e is both well-connected to (Z1 , . . . , Zk−1) via
(0)
(0)
(0)
Zk and well-connected to (X1 , . . . , Xk−1) via Xk . Set P (0) to be the tight path with no
k-edges consisting simply of the vertices of e in their given order. By choice of e there is
42

(0)

(0)

(0)

a set P (0) of tight paths of the form e + (v) + f for v ∈ Xk and f ∈ G(X1 , . . . , Xk−1 )
for which the terminal (k − 1)-tuples of paths in P (0) are all distinct and constitute at
(0)
(0)
least half of the ordered edges of G(X1 , . . . , Xk−1). We now describe the algorithm we
use to construct the desired cycle. Set the initial state to be ‘ﬁlling the edge e1 ’. We
proceed for each time j ≥ 1 as follows, maintaining the following property (†).
(†) The terminal (k − 1)-tuples of the paths P (j) constitute at least half of the ordered
(j)
(j)
edges G(X1 , . . . , Xk−1).
Suppose ﬁrst that our current state is ‘ﬁlling the edge ei ’ for some i. If we have
previously completed ni steps in this state, then we do nothing, and immediately change
state to ‘position 1 in traversing the walk Wi ’. Otherwise, since (†) holds for j − 1, we
may apply Claim 33 with i = 0 to obtain a path P ∈ P (j−1) and a collection P (j)
(j−1)
(j−1)
9
of 10
e(G(X1
, . . . , Xk−1 )) tight paths of length k, all of whose initial (k − 1)-tuples
are the terminal (k − 1)-tuple of P , whose terminal (k − 1)-tuples are distinct members
(j−1)
(j−1)
of G(X1
, . . . , Xk−1 ) and are disjoint from V (P ), and whose remaining vertex lies in
(j−1)
Xk
\ V (P ). We deﬁne P (j) to be the concatenation P (j−1) + P . For each 1 ≤ p ≤ k
(j)
(j−1)
(j−1)
we generate Xp from Xp
by removing the (at most two) vertices of P (j) in Xp
and replacing them by vertices from the same cluster which do not lie in Z or in P (j) .
We will prove in Claim 35 that this is possible and that (†) is maintained.
Now suppose that our current state is ‘position q in traversing the walk Wi ’ for some
i. Since (†) holds for j − 1, we may apply Claim 33 with i = 1, which returns a path
(j−1)
(j−1)
9
e(G(X2
, . . . , Xk
)) tight paths of length
P ∈ P (j−1) and a collection P (j) of 10
k + 1, all of whose initial (k − 1)-tuples are the terminal (k − 1)-tuple of P , whose
(j−1)
(j−1)
terminal (k − 1)-tuples are distinct members of G(X2
, . . . , Xk
) which are disjoint
(j−1)
(j−1)
from V (P ), and whose two remaining vertices lie in Xk
\ V (P ) and X1
\ V (P )
(j)
(j−1)
respectively. Exactly as before we deﬁne P to be the concatenation P
+ P . We also
(j)
(j−1)
(j−1)
(j−1)
form Xp from Xp+1 for each 1 ≤ p ≤ k − 1 by removing the vertices of P
in Xp+1
and replacing them by vertices from the same cluster which do not lie in Z or P (j) . If we
have now reached the end of Wi , meaning that the (k − 1)-tuple of clusters containing
(j)
(j)
X1 , . . . , Xk−1 (in that order) is the terminal (k − 1)-tuple of Wi , then we choose the set
(j)
(j)
Xk as follows. If i < s then we let Xk be a subset of the remaining cluster of ei+1
(that is, the cluster not included in the terminal (k − 1)-tuple) which has size αm and
(j)
is disjoint from P (j) ∪ Z. If i = s we let Xk be a subset of Xk (which is the remaining
cluster of e1 ) of size αm disjoint from P (j) ∪ Z. We then change our state to ‘ﬁlling the
edge ei+1 ’ if i < s, or ‘completing the cycle’ if i = s. Alternatively, if we have not yet
(j)
reached the end of Wi , we instead choose Xk to be a subset of size αm of the cluster at
(j)
position q + k in the sequence Wi , again chosen so that Xk does not intersect P (j) or Z.
(j)
This ensures that for each p ∈ [k], Xp is a subset of the cluster at position p + q in the
sequence Wi ; in particular, these clusters form an edge of R since Wi is a tight walk. In
this case we now change our state to ‘position q + 1 in traversing Wi ’. Again, we prove
in Claim 35 that these choices are all possible and that (†) is maintained.
(j−1)
(j−1)
Finally, if our state is ‘completing the cycle’ then X1
, . . . , Xk
must be subsets
of X1 , . . . , Xk respectively. So by (†) and Claim 34(c ) we may choose a path P ∈ P (j−1)
(j−1)
(j−1)
such that the terminal (k − 1)-tuple f ∈ G(X1
, . . . , Xk−1 ) of P is well-connected to
(j−1)
(Z1 , . . . , Zk−1) via Xk
. Let P (j) be the concatenation P (j−1) + P , and recall that we
43

chose e, the initial (k − 1)-tuple of P (j−1) , to be well-connected to (Z1 , . . . , Zk−1 ) via Zk .
Together with the well-connectedness of f , and the fact that V (P ) ∩ Xk = 1, this implies
(j−1)
that we may choose a (k − 1)-tuple e′ in G(Z1 , . . . , Zk−1 ) and vertices v ∈ Xk
\ V (P )
and v ′ ∈ Zk such that e′ is disjoint from e and both Q := f +(v)+e′ and Q′ := e′ +(v ′)+e
are tight paths in G. Return P (j) + Q + Q′ as the output tight cycle in G.
Claim 35. The algorithm described above is well-defined (that is, it is always possible to
(j)
construct the sets Xp ), maintains (†), and returns a tight cycle of length




X
X
3 +
ni  · k + 
ℓ(Wi ) · (k + 1).
i∈[s]

i∈[s]

In particular, this length is divisible by k.

(j)

(j)

Proof. To see that the output is indeed a tight cycle, recall that we always chose X1 , . . . , Xk
to be disjoint from Z and P (j), and the vertices added to P (j) to form P (j+1) are always
S
(j−1)
taken from p∈[k] Xp
. So by construction, the ﬁnal P (j) is a tight path which only
meets Z in its initial (k − 1)-tuple e and does not contain the vertex v used in the ‘completing the cycle’ step. Since when completing the cycle e′ is chosen to be disjoint from
e, no vertices are repeated, and so the output is indeed a tight cycle.
(j)
(j) 
To see that (†) is maintained, observe that applying (31) we have e G(X1 , . . . , Xk−1) ≥
(j−1)
(j−1)
εmk−1 for each j. Fix some j. By construction, for either Ap := Xp
or Ap := Xp+1
(according to our current state) we obtain sets A1 , . . . , Ak−1 each of size αm such that
the terminal (k − 1)-tuples of P (j) constitute at least nine-tenths of the ordered edges of
(j)
G(A1 , . . . , Ak−1 ), and for each 1 ≤ i ≤ k −1 the set Xi is formed from Ai by removing at
most two vertices and replacing them with the same number of vertices. Since each vertex
(j)
(j)
is in at most mk−2 ordered (k − 1)-edges of either G(A1 , . . . , Ak−1 ) or G(X1 , . . . , Xk−1 ),
(j)
(j)
we conclude that the fraction of ordered (k − 1)-edges of G(X1 , . . . , Xk−1 ) which are
terminal (k − 1)-tuples of paths in P (j) is at least

9
e
G(A
,
.
.
.
,
A
)
− 2(k − 1)mk−2
1
k−1
10
(j)
(j) 
e G(X1 , . . . , Xk−1 )

(j)
(j) 
9
k−2
e
G(X
,
.
.
.
,
X
)
−
2(k
−
1)m
− 2(k − 1)mk−2
1
k−1
10
≥
(j)
(j) 
e G(X1 , . . . , Xk−1)

4(k − 1)mk−2
1
9
−
≥ ,
k−1
10
εm
2
where the ﬁnal inequality is because we have m ≥ m0 ≥ 16(k − 1)/ε. Thus (†) holds for
j as desired.
(j)
To see that we can always construct the sets Xp , observe that it is enough to check
that at termination every cluster still has at least 2αm vertices not in P (j), as then there
are at least αm such vertices outside Z. Observe that at each step we choose a set of
paths P (j) , precisely one member of which is then used to extend P (j) to P (j+1) in the
subsequent step. In each walk-traversing step each path in P (j) contains precisely k + 1
new verticesP
(i.e. vertices outside P (j) ), and the total number of walk-traversing steps
is precisely i∈[s] ℓ(Wi ). Recalling that this number is at most t2k , and using t ≤ t1 ,
by (30) we have (k + 1)t2k < αm/2, so in particular fewer than αm/2 vertices are added
to P (j) as a result of walk-traversing steps. On the other hand, we remain in the state
≥

44

‘ﬁlling the edge ei ’ for precisely ni steps, and in each of these steps each path in P (j)
contains precisely k new vertices, one from each cluster of ei . So for any cluster C,
(j)
the
P number ofPvertices of C which are added to P as a result of edge-ﬁlling steps is
i: C∈ei ni ≤
i: C∈ei (1 − 3α)wi m ≤ (1 − 3α)m, where the ﬁrst inequality holds by (32)
and the second by deﬁnition of a fractional matching. Together with the k − 1 vertices
of P (0) , and the k vertices of the chosen path in P (0) , we conclude that in total at most
(1−2α)m vertices of any cluster are contained in the path P (j) at termination, as desired.
Finally, the total length of the cycle is equal to the number of vertices it contains,
which we can calculate similarly. Recall that our initial P (0) contained k − 1 vertices,
to which k vertices
were added from some member of P (0) in the ﬁrst step to form P 1 .
P
Each of the i∈[s] ni edge-ﬁlling steps resulted in k new vertices being added to P (j) in
P
the subsequent step, and each of the i∈[s] ℓ(Wi ) walk-traversing steps resulted in k + 1
new vertices being added to P (j) in the subsequent step. Finally, when completing the
cycle we used k + 1 vertices which were not contained in our ﬁnal path P (j) (namely v, v ′
and the vertices of e′ ). In summation, the cycle formed has length




X
X
(k − 1) + k + 
ni  · k + 
ℓ(Wi ) · (k + 1) + (k + 1) ,
i∈[s]

giving the claimed expression. Since
this length.

i∈[s]

P

i∈[s] ℓ(Wi )

is divisible by k, the same is true of


P
Recall that i∈[s] ℓ(Wi ) ≤ t2k . So if we take ni = 0 for every i ∈ [s] then we obtain a
tight cycle of length at most 2kt2k . On the other hand, if we take
P the ni to be as large
as permitted, so ni = (1 − 3α)wi m for each i ∈ [s], then, since si=1 wi = µ, we obtain
a tight cycle of length at least (1 − 3α)µkm ≥ (1 − ψ)kµn/t. Clearly by choosing the
ni appropriately we may obtain tight cycles of any length between these two extremes
which is divisible by k. So it remains only to prove the lemma for cycle lengths ℓ < 2kt2k .
Note that 2kt2k < m, so the number of vertices in such a cycle is fewer than the number
of vertices in any cluster. Hence, we need only use one edge of the reduced graph to ﬁnd
the desired tight cycle in this case.
More precisely, ﬁx any edge e1 = {X1 , . . . , Xk } of R. If ℓ ≥ 3k, then we may proceed as
(0)
before with n1 := ℓ/k − 3. That is, we choose a (k − 1)-tuple e, disjoint sets Zj , Xj ⊆ Xj
of size αm, and a set of extensions P (0) of P (0) = e as previously, then enter state ‘ﬁlling
the edge e1 ’, where we remain for n1 steps. Following this, we move directly to the state
‘completing the cycle’ (since there is no walk to traverse), which proceeds as before. By
similar arguments as before, this process gives a tight cycle of length kn1 + 3k = ℓ, as
required.
Finally, if ℓ = 2k, we simply apply Lemma 25 with H the complex generated by the
down-closure of a tight cycle of length 2k, and H′ the subcomplex induced by any k − 1
consecutive vertices of this cycle, to G(X1 , . . . , Xk ), where X1 , . . . , Xk are the clusters of
any edge of R. This gives a cycle of length 2k in G.

To conclude this section, we note that by a similar approach it is possible to ﬁnd
paths of speciﬁed lengths whose initial and terminal (k − 1)-tuples lie in speciﬁed sets of
(k − 1)-tuples. We will not need this result here, but we state it for future convenience.
45

Lemma 36. Let k, r, n0 , t, B be positive integers, and ψ, d2 , . . . , dk , ε, εk , ν be positive
constants such that 1/di ∈ N for each 2 ≤ i ≤ k − 1, and such that 1/n0 ≪ 1/t,
1 1
1
, ≪ , ε ≪ εk , d2 , . . . , dk−1
n0 B
r

and εk ≪ ψ, dk , ν,

1
.
k

Then the following holds for all integers n ≥ n0 .
Let G be a k-graph on n vertices, and J be a (·, ·, ε, εk , r)-regular slice for G with t
clusters and density vector (dk−1, . . . , d2 ). Let M be a tightly connected fractional matching of weight µ in R := Rdk (G). Also let X and Y be (k − 1)-tuples of clusters which lie
in the same tight component of R as M, and let SX and SY be subsets of JX and JY of
sizes at least ν|JX | and ν|JY | respectively. Finally, let W be a tight walk in R from X
to Y of length at most t2k , and let p = ℓ(W ).
Then for any ℓ divisible by k with 3k ≤ ℓ ≤ (1 − ψ)kµn/t there is a tight path P in G
of length ℓ + p(k + 1) whose initial (k − 1)-tuple forms an edge of SX and whose terminal
(k − 1)-tuple forms an edge of SY , where the orders of these tuples are given by the orders
of X and Y respectively. Furthermore P uses at most µ(C)n/t + B vertices from any
cluster C, where µ(C) denotes the total weight of edges of M containing C.
Proof. We need to be able to apply Lemma 25 with β = min(ν/40, 1/100) rather than
1/100, and we need α ≪ ν, but the remaining constants only have to satisfy the given
order of magnitude hierarchy. We use the same notation as in the proof of Lemma 9.
So, writing X = (X1 , . . . , Xk−1) and Y = (Y1 , . . . , Yk−1) we can rewrite our assumption
on SX and SY in a more familiar form: that SX constitutes at least a ν-proportion of
G(X1 , . . . , Xk−1 ) and SY constitutes at least a ν-proportion of G(Y1 , . . . , Yk−1). Let Xk be
the cluster following X in W , and let Yk be the cluster preceding Y in W , so {X1 , . . . , Xk }
(0)
and {Y1, . . . , Yk } are edges of R. Then we choose subsets Zj ⊆ Yj and Xj ⊆ Xj of size
αn for each j ∈ [k]. A similar argument as in the proof of Lemma 9 implies that we may
choose e ∈ SY so that for at least half the members f of G(Z1 , . . . , Zk ) there is a tight
path of length k in G from f to e whose remaining vertex lies in Zk . Similarly, we may
choose a (k − 1)-tuple P (0) in SX and a set P (0) of tight paths of the form P (0) + v + e′
with v ∈ Yk and e′ ∈ G(Y1 , . . . , Yk−1) so that the members of P (0) have distinct terminal
(k − 1)-tuples which together occupy at least nine-tenths of G(Y1 , . . . , Yk−1). We then
proceed by exactly the same algorithm as in the proof of Lemma 9 to repeatedly extend
P (j) whilst avoiding Z1 , . . . , Zk and e. The only diﬀerence is that now in the ‘completing
the cycle’ state, when we identify tight paths Q and Q′ which together connect our ﬁnal
P (j) to e, this does not yield a tight cycle but rather a tight path whose initial (k−1)-tuple
lies in SX and whose ﬁnal (k − 1)-tuple lies in SY , as claimed.
It remains only to check the lengths of tight paths which can be obtained in this way.
As in Lemma 9 the shortest tight path is achieved by never entering the state of ‘ﬁlling
an edge’, in which case we obtain a tight path of length 3k + p(k + 1). On the other
hand, exactly as for Lemma 9, by extending W to include all edges of R of non-zero
weight before we implement the algorithm, we can obtain tight paths of length up to
(1 − ψ)kµn/t, but without using more than µ(C)n/t + B vertices from any cluster, where
B = B(t, k) does not depend on n.

10. Concluding remarks
Towards an extremal theorem for tight paths and cycles. We mentioned in the
introduction that our result is an approximate analogue of the Erdős-Gallai Theorem.
The exact analogue is the following, which we conjecture.
46


n
Conjecture 37. For any ℓ, all n-vertex k-graphs with more than ℓ−k
edges contain
k k−1

ℓ−1 n−1
a tight path on ℓ vertices, and all n-vertex k-graphs with more than k k−1 edges have
a tight cycle of length at least ℓ.

As we saw in Section 3, for any ﬁxed ℓ this conjecture is sharp for n satisfying certain
divisibility conditions. We also observed there that if p ≪ n−(ℓ−k)/(ℓ−1) then a random
hypergraph of density p has fewer ℓ-vertex tight cycles than edges, so we can easily delete
all short cycles without signiﬁcantly altering the density. Hence we cannot ask for the
existence of cycles of lengths up to ℓ.

n
Recall that Győri, Katona and Lemons [12] proved that more than (ℓ − k) k−1
edges
suﬃces to guarantee the existence of an ℓ-vertex tight path, which is weaker than the
conjecture both in that it only deals with tight paths and in that a factor k more edges
than conjectured are required.
However their result holds for all ℓ ≤ n. Our result is oﬀ

by a factor only 1 + o(1) from the conjectured number of edges, but we require ℓ to be
linear in n. Possibly one could even prove the conjecture exactly in our range of ℓ using
the Stability Method, but we do not believe an attempt to do so is worthwhile, for the
following reason.
For large cycles we do not believe Conjecture 37 is best possible. It is easy to check
that if α ≫ n−1/2 then no designs (or even set systems with nearly as many edges as a
design) with sets of size αn and without pairwise intersections of size two or greater exist:
The lines of F2p for prime p ≈ n1/2 form a design with all pairs covered exactly once, so
this is optimal.
The best lower bound we know of in this range of α is the simple construction presented
in Section 3 in which we take all edges meeting a ﬁxed (αn/k − 1)-vertex set. There
is a substantial gap between this lower bound and Conjecture 37. It would be very
interesting—but also, we suspect, very diﬃcult—to close this gap. In fact, we think that
it is already diﬃcult to solve the following problem for some ﬁxed α ∈ (0, 1).

Problem 38. Determine the limit of the maximum edge density of n-vertex 3-graphs
which do not contain αn-vertex tight paths.

We have no suggestions of good candidates for extremal structures, which would also
be interesting to obtain. For α close to 1, it even seems possible that the construction
presented in Section 3 in which we take an (αn − 1)-vertex clique and all further edges
which meet it in less than k − 1 vertices could be extremal.
Spanning structures and stability. Let us support our claim that Lemma 6 property (c ) can be useful for proving results involving spanning subgraphs. For this purpose
we ﬁrst brieﬂy sketch a proof of Rödl, Ruciński and Szemerédi [29] giving the following
Dirac-type condition for tight Hamilton cycles in k-graphs, and then explain how their
approach can be simpliﬁed with the help of Lemma 6.
Theorem 39 ([29], Theorem 1.1). For each k ≥ 3 and γ > 0 there exists n0 such that for
each n ≥ n0 the following holds. If G is a k-graph on n vertices and each (k − 1)-set of
vertices of G is contained in at least (1/2 + γ)n edges of G, then G has a tight Hamilton
cycle.
The strategy of Rödl, Ruciński and Szemerédi is as follows. First, they show
that

the codegree condition implies that for each vertex u of G, there are Θ n2k−2 ‘absorbing structures for u’, that is, vertex tuples (v1 , . . . , v2k−2 ) such that both of the tuples
(v1 , . . . , v2k−2 ) and (v1 , . . . , vk−1 , u, vk , . . . , v2k−2 ) form tight paths in G. Second, they use
a probabilistic argument to show that there is a collection of pairwise-disjoint (2k − 2)vertex tight paths which cover a small fraction of V (G) and which have the property that
47

for each u ∈ V (G), Θ(n) of these tight paths are absorbing structures for u. Third, they
establish a Connecting Lemma which allows them to connect the collection of (2k − 2)vertex tight paths into one ‘absorbing path’, which is a tight path P such that for any not
too large set S ⊆ V (G)\V (P ), there is a tight path on the vertices V (P )∪S with the same
endpoints as P . Fourth, they show that P can be extended to an almost-spanning tight
cycle. Then setting S = V (G) \ V (C) and using the absorbing property of P completes
their proof.
In their approach, the Regularity Lemma is used only to complete the fourth step, and
most of the work is in proving the Connecting Lemma. We can use Lemma 6 to simplify
this approach. Property (c ) implies that since each u ∈ V (G) has many absorbing
structures, so each u also has many absorbing structures supported on the regular slice
J returned by Lemma 6, and the same probabilistic argument as in their second step
then gives a collection of (2k − 2)-vertex tight paths supported on J with otherwise the
same properties. But now their third step can be replaced by showing that the reduced
graph R(G) is (after deleting a few vertices) tightly connected. This, however, is easy
and can be obtained as in our proof of Theorem 2. Their fourth step can be carried out
in more or less the same way on J , and the proof is then completed exactly as before.
Besides simplifying the proof, we also believe it would be much easier to prove a
‘stability version’ of Theorem 39 using our approach, because the tight connectivity of
R(G) we use is a comparatively easy concept to work with. It appears more challenging
to prove a stability version of the Connecting Lemma in their approach.
Furthermore, it would be interesting to prove similar results for more general ‘tightpath-like’ hypergraphs. To do this one will need a suitable ‘embedding lemma’ which can
complete the fourth step (in either approach) and this does not currently exist. Given
such an ‘embedding lemma’, it would be easy to modify our approach to complete the
proof of such a result.
Entropy preserving regular slices. We note that one can ask for the slice J provided
by Lemma 6 to satisfy further properties. In particular, one property which is useful in
enumeration is that entropy is preserved.
The binary entropy of a number x ∈ (0, 1) is deﬁned to be H(x) = −x log2 x − (1 −
x) log2 (1 − x), and we deﬁne H(0) = H(1) = 0. Given a weighted reduced k-graph R, we

∗
deﬁne the binary entropy H(R) of R to be the average over all e ∈ V (R)
of
H
d
(e)
.
k
Then we can ask for the following additional property of Lemma 6. The number
of
n
vertex k-graphs G whose reduced graph R(G) given by Lemma 6 has H R(G) ≤ x is at
n
k
most 2x(k )+εk n .
∗
We deﬁne the binary entropy H(G,
of partitions P ∗
 P ) of G with respect to a family
∗
to be the average of H d(G | P̂ (Q)) over the polyads P̂ (Q) of P (where d(G | P̂ (Q))
ˆ as deﬁned in Section 4.1). Then the
is the relative density of G with respect to P (Q)

method used in the proof of Lemma 6(a ) can be used to show that H R(G) is with high
probability close to H(G, P ∗ ), where P ∗ is as given in the proof of Lemma
6. Hence we

may ask that Lemma 6 returns a regular slice J such that H R(G) ≈ H(G, P ∗ ). Then
a standard and easy enumeration argument yields the desired conclusion.

Regular slices and the Hypergraph Blow-up Lemma. Recently, Keevash [17] provided a new major tool for extremal hypergraph theory, the Hypergraph Blow-up Lemma.
However, while our Regular Slice Lemma, Lemma 6, is based on the Strong Hypergraph
Regularity Lemma, Lemma 20, the Hypergraph Blow-up Lemma requires the stronger
regularity properties given by the Regular Approximation Lemma, Lemma 21. Hence
Lemma 6 is not suitable for an application together with the Hypergraph Blow-up Lemma.
48

We remark though that Lemma 6 can be modiﬁed appropriately to allow for such an
application. The proof of such a modiﬁed version is almost identical to the proof of
Lemma 6, but uses a version of the Strengthened Regularity Lemma, Lemma 22, which
gives regularity properties of comparable strength to those in Lemma 21. It is easy to
modify the proof of Lemma 22 to obtain this.
Appendix A. Derivation of Lemmas 23 and 25
We ﬁrst describe the diﬀerences between Lemma 23 and the Lemma provided by Cooley,
Fountoulakis, Kühn, and Osthus [8, Lemma 4]. Firstly, their version also allows to count
copies of H in which multiple vertices of H may be embedded within the same cluster.
We do not need this strengthening, so we omit it for notational convenience.
Secondly, their lemma includes an additional constant dk with εk ≪ dk and 1/dk ∈ N,
and requires for any edge e ∈ H that G is (dk , εk , r)-regular with respect to JˆX , where
X = {Vj : j ∈ e}, whereas our lemma only requires that G is (d, εk , r)-regular with
respect to JˆX for some d which may depend on X. We now describe how this apparently
stronger result may be derived.
Introduce a constant dk with dk ≪ β, and also a constant γ with ε ≪ γ ≪ εk , d2 , . . . , dk−1.
Let X be any k-set of clusters of J . The version of the Dense Extension Lemma [8,
Lemma 7], applied with J in place of G and H \ H(k−1) in place of H, implies that at
Qk−1 ei (H)−(ki)
copies of H.
di
most γ|Ki (JˆX )| edges of GX are contained in more than i=2
Also, the Slicing Lemma [8, Lemma 8] implies that we can partition GX into subgraphs
G0X , G1X , . . . , GpXX for some integer pX , so that |G0X | ≤ dk |Ki (JˆX )| and GiX is (dk , 2εk , r)regular with respect to JˆX for each i ≥ 1. However we choose qX ∈ [pX ] for each X,
Qk ei(H)
s
we may then apply
[8,
Lemma
4]
to
establish
that
there
are
(1
±
β/3)m
i=2 di
S
copies of H in X GqXX . Diﬀerent choices of qX give distinct copies of H, so summing
Q
Qk−1 ei (H)
over all possible choices we obtain ( e∈H d∗ (e) ± 2β/3)ms i=2
di
copies of H in
G, having counted all copies except for those which contain an edge from some G0X .
Qk−1 (ki) k
Fact 3 tells us that for any X there are at most dk |Ki (JˆX )| ≤ dk i=2
di m such
Qk−1 ei (H)−(ki) s−k
m
copies of H, except for at most
edges, each of which lies in at most i=2 di
Q
e
(H)
k−1
i
k
m edges, which each lie in up to ms−k copies of H. Overall
γ|Ki (JˆX )| ≤ dk i=2 di
Q
k−1 ei (H)
di
further copies of H in G, giving Lemma 23.
this adds at most (β/3)ms i=2
Similarly,
that for each
 [21, Lemma 4.6] diﬀers from our Lemma 25 in that it requires
(k)
A ∈ [s]
such
that
there
is
an
edge
of
H
with
index
A,
the
graph
G
[V
A ] is regular
k
(k−1)
with density exactly dk with respect to G
[A], whereas we require density at least
dk . Moreover, [21, Lemma 4.6] also gives a formula for the typical number of extensions,
whereas we give only a lower bound. This latter diﬀerence makes it elementary to reduce
our lemma to theirs by applying the Slicing Lemma [8, Lemma 8].
Appendix B. Proof of Lemma 22.
Let us ﬁrst justify why we need Lemma 22. As we saw in the proof of Lemma 6,
Lemma 22 is used to ensure that the link of every vertex of G is represented in the
regular slice. It may not be clear why Lemma 20 is not good enough for this purpose.
But observe that if G is a k-graph and P ∗ a family of partitions obtained by applying
Lemma 20, then we can construct a k-graph G′ from G by associating to each slice J
through P ∗ a vertex vJ of V (G), and then removing all edges of G of the form {vJ } ∪ e
where e ∈ J (k−1) . Then G′ is also regular with respect to P ∗ , but whatever slice J
49

through P ∗ is chosen, the link of vJ in G′ is not represented on J , so J does not satisfy
Lemma 6(c ).
Now we turn to the proof of Lemma 22. The basic idea is simple. We will apply
the Regular Approximation Lemma, Lemma 21, to our k-graph G to generate a family
of partitions P̃ ∗ with t̃ ≤ t∗1 clusters. We will then take a random equipartition of each
cluster into p(t∗1 ) parts to obtain a partition P, and let P ∗ be a reﬁnement of P̃ ∗ generated
by P. We will show that deterministically G has the desired regularity with respect to
P ∗ , and that with high probability, for any set X̃ of clusters of P̃ ∗ and any X̃-consistent
set X of clusters of P ∗ , the rooted H-densities on X of any slice through P ∗ are close to
the densities on X̃ of the corresponding slice through P̃ ∗ .
Let us explain why it is necessary in this proof to apply Lemma 21 rather than
Lemma 20 to obtain P̃ ∗ . The reason is that typically p(·) grows fast and we must
therefore split each cluster into parts which are too small to control using any regularity
obtainable from Lemma 20.
To analyse the random equipartition we need the following standard concentration
inequality for the hypergeometric distribution.
Theorem 40 (see [15, Theorem 2.10]). Given a set V and a subset
W of V , let V ′ be

|
chosen uniformly at random from all ℓ-subsets of V . We have P |V ′ ∩ W | = ℓ|W
±t ≥
|V |


t2
1 − 2 exp − 2|V
.

|
Proof of Lemma 22. Assume we are given integers q, t0 and s, a constant εk , functions
r : N → N and ε : N → (0, 1] and a monotone increasing function p : N → N. Without
loss of generality, we may assume that r is also monotone increasing while ε is monotone
decreasing. We set

ν = ε3k /(16k!) and t∗0 = max t0 , 4k 2 /εk .

We let ε∗ : N → (0, 1] be a monotone decreasing function such that for each x we have


2
ε4k
(33)
ε∗ (x) ≤ min ε p(x)x ,
2 .
16r p(x)x

We further require ε∗ (·) to be small enough that we can apply Lemma 24 with α = 1/p(x),
εk
and any s ≤ 1/εk , to (d, ε∗ (x), ε∗ (x), 1)-regular k-complexes,
and Lemma 23 with β = 10
provided that each di is at least 1/x.
Let t∗1 and n∗0 be returned by Lemma 21 with inputs q, t∗0 , s, ν and ε∗ (·). Let t1 :=
p(t∗1 )t∗1 , ε∗ := ε∗ (t∗1 ), ε := ε(t1 ) and r := r(t1 ), so in particular we have ε∗ ≤ ε2 by
deﬁnition of ε∗ . Let m0 ≥ n∗0 be large enough for the above applications of Lemmas 23
and 24 with x = t∗1 and clusters of size m ≥ m0 . We then choose n0 ≥ m0 t1 suﬃciently
large for the union bound at the end of the proof.
Let V be a set of n ≥ n0 vertices, where n is divisible by t1 !, and let Q partition V into
at most q parts of equal size. Let G1 , . . . , Gs be edge-disjoint k-graphs on the vertex set
V . We start by applying Lemma 21 (with the inputs stated above), which yields k-graphs
G′1 , . . . , G′s with |Gi ∆G′i | ≤ νnk for each 1 ≤ i ≤ s, and a (k − 1)-family of partitions
P̃ ∗ on V which is (t∗0 , t∗1 , ε∗)-equitable, whose ground partition P̃ reﬁnes Q, and which is
such that each G′i is perfectly (ε∗ , 1)-regular with respect to P̃ ∗ . Let the density vector
of P̃ ∗ be d = (d2 , . . . , dk−1). By deﬁnition of ‘equitable’, the entries of d are all at least
1/t∗1 .
We let the partition P of V be obtained by partitioning each cluster X of P̃ ∗ uniformly
at random into p(t∗1 ) parts of equal size. We let t̃ be the number of clusters of P̃, and t
50

be the number of clusters of P. Thus we have t = p(t∗1 )t̃, which is property (c ). Since P̃
reﬁnes Q, so also P reﬁnes Q, giving property (a ).
We now obtain a family of partitions P ∗ with ground partition P as follows. For each
2 ≤ i ≤ k − 1 and each i-cell C in P̃ ∗ on the i clusters C of P̃, we put into P ∗ each of
the i-uniform induced subgraphs of C obtained by choosing i clusters of P, one in each
cluster of C. We then need to add further 2-cells between pairs of clusters in P which
were both contained in one cluster of P̃. We do this by choosing for each such pair X1 , X2
of clusters in P an arbitrary equipartition of the complete
bipartite graph with vertex
√
classes X1 and X2 into 1/d2 cells which are each (d2 , ε∗ , 1)-regular with respect to the
1-graph formed by the vertices of X1 and X2 (for example, it is not hard to show that a
random partition has this property with high probability). We then need to choose all
those 3-cells whose supporting clusters do not lie in distinct parts of P̃, and so on. We
do this in the same way, while also ensuring that we are consistent with the 2-cells we
just chose, and so on, so that we obtain a family of partitions. By construction P ∗ is
generated from P̃ ∗ by P, giving property (b ). Now consider any P̃-partite set Q ∈ Vk ,
let J˜(Q) be the k-partite (k − 1)-complex whose edge set is the union of the cells C̃Q of
P̃ ∗ which contain proper subsets of Q, and similarly let J (Q) be the k-partite (k − 1)complex whose edge set is the union of the cells CQ of P ∗ which contain proper subsets
∗ ∗
˜
of Q. The fact that P̃ ∗ is (t∗0 , t∗1 , ε∗ )-equitable implies
√ √that J (Q) is (d, ε , ε , 1)-regular,
whereupon Lemma 24 implies that J (Q) is (d, ε∗ , ε∗ , 1)-regular. It follows that for
∗
any 2 ≤ i ≤ k − 1 and any i-cell
of
√ C of P , if C was obtained as an induced subgraph
∗
an i-cell of P̃ , then C is (di , ε∗ , 1)-regular with respect to the (i − 1)-cells of P ∗ on
which it is supported. On
√ the other hand, if C was not obtained in this manner,∗ then
ε∗ , 1)-regular with respect to these (i − 1)-cells. Since t0 ≥ t0 ,
by construction C is (d√
,
i
∗ ∗
∗
∗
t1 = p(t1 )t1 ≥ t1 and ε ≤ ε, we conclude that P ∗ is (t0 , t1 , ε)-equitable with density
vector d. This establishes property (d ).
We next want to establish property (e ). Fix a graph G = Gi , and let G′ = G′i . The
next claim shows that if G is not (εk , r)-regular with respect to some P̃-partite polyad of
P ∗ , then G∆G′ is dense on that polyad.

Claim 41. For any P̃-partite k-set Q ∈ Vk , if G is not (εk , r)-regular with respect to

the polyad P̂ = P̂ (Q; P ∗ ) of P ∗ , then d G′ ∆G | P̂ > (εk /2)2 .

Proof. Let W = (W1 , . . . , Wr ) be any collection of r subgraphs of P̂ such that |K√k (W)| ≥
εk |Kk (P̂ )|. We split these r subgraphs into large subgraphs Wj with |Kk (Wj )| ≥ ε∗ |Kk (P̂ )|,
and the remaining small subgraphs.
√
Since Q is P̃-partite, Lemma 24 implies that G′ is √
( ε∗ , 1)-regular with respect to P̂ ,
so on any large Wj we have d(G′ |Wj ) = d(G′ |P̂ ) ± ε∗ . On the other hand the total
number of k-cliques supported on small subgraphs Wj is by deﬁnition of ‘small’ less than
√
r ε∗ |Kk (P̂ )|. It follows that
d(G′ |W) = d(G′ |P̂ ) ±

√
2r ε∗
εk

.

If d(G′ ∆G|P̂ ) ≤ (εk /2)2 , then by deﬁnition we have d(G′ |P̂ ) = d(G|P̂ ) ± (εk /2)2 .
Furthermore, since we assumed |Kk (W)| ≥ εk |Kk (P̂ )|, we have
d(G′|W) = d(G|W) ± d(G′ ∆G|P̂ )
51

|Kk (P̂ )|
= d(G|W) ± εk /4 .
|Kk (W)|

Putting these together we have
d(G|W) = d(G|P̂ ) ±

ε2k
4

+

√
2r ε∗
εk

hence G is (εk , r)-regular with respect to P̂ .

+

εk
4

 (33)
= d(G|P̂ ) ± εk ,




V

Let B be the set of all polyads P̂ = P̂ (Q; P ∗ ) of P ∗ for which Q ∈ k is P̃-partite and
G is not (εk , r)-regular with respect to P̂ . Now using the fact that e(G∆G′ ) ≤ νnk and
Claim 41 we have
X
X



Kk (P̂ ) ,
d(G∆G′ | P̂ )Kk (P̂ ) > (εk /2)2
νnk ≥
P̂ ∈B

P̂ ∈B


V

and hence the number of P̃-partite sets Q ∈ k such that G is not (εk , r)-regular with

respect to P̂ (Q; P ∗ ) is at most νnk (εk /2)−2 ≤ 12 εk nk , where the inequality is by choice

of ν and n0 . Moreover, the number of k-sets Q ∈ Vk which are not P̃-partite is at most


n (k−1)n
n
1
∗
,
which
by
choice
of
t
is
at
most
ε
. Putting these together we see that
∗
k
0
k−1
t0
2

 k
n
V
there are at most εk k P-partite sets Q ∈ k such that G is not (εk , r)-regular with
respect to P̂ (Q; P ∗ ). In other words, G is (εk , r)-regular with respect to P ∗ , proving
property (e ).
It remains to show that property (f ) holds with positive probability. To that end, ﬁx
a k-graph G = Gi , 1 ≤ ℓ ≤ 1/εk , a k-graph H equipped with roots x1 , . . . , xℓ such that
v(H) ≤ 1/εk , vertices v1 , . . . , vℓ in V , a slice J˜ through P̃ ∗ and a v(Hskel)-tuple of clusters
X̃ of P̃ ∗ , and let h := v(Hskel). Now for any permutation φ of 1, . . . , h, the rooted copies
of H in G supported on J˜[X̃], with the ith vertex of Hskel in the φ(i)th cluster of X̃,
correspond to a h-uniform P̃-partite hypergraph Fφ . Let X be an X̃-consistent h-tuple
of clusters of P ∗ . Then we want to show that for any ﬁxed slice J through P ∗ such that
J [X] ⊆ J˜[X̃], with high probability we have
dH (G; v1 , . . . , vℓ , J˜[X̃]) = dH (G; v1 , . . . , vℓ , J [X]) ± εk .

By Lemma 23 the number of labelled Hskel -copies in J˜[X̃] for which no two vertices of
Hskel lie in the same cluster of J˜ is
n′Hskel (J˜[X̃])

= h! 1 ±

εk
10



 skel )
n v(H
t̃

k−1
Y

e (Hskel )

di i

,

i=2

where the h! term is the number of possible allocations of vertices of Hskel to clusters of
˜ Similarly
J.
Y e (Hskel )
 n v(Hskel ) k−1
εk
′
nHskel (J [X]) = h! 1 ± 10 t
di i
.
i=2

It therefore suﬃces to show that with high probability, for each of the h! permutations φ
we have
k−1
εk Y ei (Hskel )
d
.
(34)
d(Fφ ) = d(Fφ [X]) ±
2(h!) i=2 i
Fix any permutation φ, and for each 0 ≤ j ≤ h, let Fj denote the subgraph of Fφ given
by taking the ﬁrst j clusters from X and the last h − j clusters from X̃. Thus we have
F0 = Fφ and Fh = Fφ [X]. Observe that for each j, the distribution of the jth cluster
of X is the uniform distribution over all n/t-subsets of the jth cluster of X̃. We can
52

thus use the following claim to show that for each 1 ≤ j ≤ h, with high probability the
densities d(Fj−1) and d(Fj ) are close.
Claim 42. For each s, p ∈ N and each δ > 0, let B be an s-partite s-uniform hypergraph
with parts V1 , . . . , Vs . Choose uniformly at random a subset V ′ ⊆ V1 of size |V1 |/p, and
let B ′ = B[V ′ , V2 , . . . , Vs ]. Then with probability at least
4 |V | 
1
1 − 4δ exp − δ32p
,
2

we have d(B ′ ) = d(B) ± δ.

Proof. We partition the vertices V1 into sets W0 , W1 , . . . , W2/δ , with the property that all
vertices in Wj have degree in B in the interval
 (j − 1)δ|V | · · · |V | jδ|V | · · · |V | i
2
s
2
s
.
,
2
2
Let V ′ be a random subset of V1 of size ℓ = |V1 |/p, and B ′ = B[V ′ , V2 , . . . , Vs ]. By
Theorem 40, for each 1 ≤ j ≤ 2/δ we have


|W |
t2
.
P |V ′ ∩ Wj | = pj ± t ≥ 1 − 2 exp − 2|V
1|
Taking t = δ 2 |V1 |/(4p) and using a union bound, we conclude that we have
|V ′ ∩ Wj | =

|Wj |
p

for each 1 ≤ j ≤ 2/δ with probability at least

1 − 4δ exp −

Conditioning on this likely event, we have
′

e(B ) =

2/δ
X
j=1

=

2/δ 
X
|W
p

2/δ
X
|W
p

j=1

=

1
e(B)
p

=

1
e(B)
p

j|

δ2 |V1 |
4p

δ4 |V1 | 
.
32p2

|V ′ ∩ Wj | · j − 12 ±


1 δ|V2 |···|Vs |
2
2



· j − 12 ±

1 δ|V2 |···|Vs |
2
2

· j − 21 ±


1 δ|V2 |···|Vs |
2
2

±

j|

±
±

δ2 |V1 |
4p

±

j=1

=

±

2/δ
X

which gives the desired conclusion.

|Wj |
p

j=1

·

δ|V2 |···|Vs |
2

δ
|V | · · · |Vs | ,
p 1





±

δ
|V | · · · |Vs |
2p 1

δ
|V | · · · |Vs |
2p 1



Applying Claim 42 to B = Fj−1 and B ′ = Fj for each 1 ≤ j ≤ h, with
p=

p(t∗1 )

and

k−1
Y e (Hskel )
1
δ=
di
,
εk
2h(h!) i=2 i

we conclude that with probability at least
1−

4h
δ

exp −

δ4 n
32p2 t∗1



,

we have d(F0 ) = d(Fh ) ± δh. By choice of δ this implies that the equation (34) holds for
the permutation φ.
53

Now we take a union bound over the s choices of G = Gi , the 1/εk choices of ℓ, the at
1/εk
Qk−1 −(jt̃ )
most 2( k ) choices of rooted H, the at most n1/εk choices of v1 , . . . , vℓ , the j=2
dj
t

Qk−1 −(j)
choices of J˜, the at most 1/εt̃ k choices of X̃, the j=2
dj
choices of J , the at most

t
choices of X, and the h! ≤ (1/εk )! permutations φ of 1, . . . , h. Since we have the
1/εk
lower bound dj ≥ 1/t∗1 for each j, the total number of events over which we take a union
bound is polynomial in n. The failure probability of each good event is exponentially
small in n, so if n0 was chosen suﬃciently large, with positive probability all good events
hold. In other words, with positive probability (f ) holds, which completes the proof. 
References
[1] P. Allen, Minimum degree conditions for cycles, in preparation.
[2] N. Alon, The largest cycle of a graph with a large minimal degree, J. Graph Theory 10 (1986),
123–127.
[3] B. Bollobás, Combinatorics, Cambridge University Press, 1986.
[4] J. A. Bondy, Pancyclic graphs. I, J. Combinatorial Theory Ser. B 11 (1971), 80–84.
[5] G. Chen, R. J. Faudree, R. J. Gould, M. S. Jacobson, and L. Lesniak, Hamiltonicity in balanced
k-partite graphs, Graphs Combin. 11 (1995), no. 3, 221–231.
[6] D. Christoﬁdes, J. Hladký, and A. Máthé, Hamilton cycles in dense vertex-transitive graphs, J.
Combin. Theory Ser. B 109 (2014), 34–72.
[7] F. R. K. Chung, Regularity lemmas for hypergraphs and quasi-randomness, Random Structures
Algorithms 2 (1991), no. 2, 241–252.
[8] O. Cooley, N. Fountoulakis, D. Kühn, and D. Osthus, Embeddings and Ramsey numbers of sparse
k-uniform hypergraphs, Combinatorica 29 (2009), no. 3, 263–297.
[9] G. A. Dirac, Some theorems on abstract graphs, Proc. London Math. Soc. 2 (1952), 69–81.
[10] P. Erdős and T. Gallai, On maximal paths and circuits of graphs, Acta Math. Acad. Sci. Hungar 10
(1959), 337–356.
[11] W. T. Gowers, Hypergraph regularity and the multidimensional Szemerédi theorem, Ann. of Math.
(2) 166 (2007), no. 3, 897–946.
[12] E. Győri, G. Y. Katona, and N. Lemons, Hypergraph Extensions of the Erdős-Gallai Theorem, in
preparation.
[13] P. E. Haxell, T. Luczak, Y. Peng, V. Rödl, A. Ruciński, and J. Skokan, The Ramsey number for
3-uniform tight hypergraph cycles, Combin. Probab. Comput. 18 (2009), no. 1-2, 165–203.
[14] H. Huang, P.-S. Loh, and B. Sudakov, The size of a hypergraph and its matching number, Combin.
Probab. Comput. 21 (2012), no. 3, 442–450.
[15] S. Janson, T. Luczak, and A. Ruciński, Random graphs, Wiley-Interscience, New York, 2000.
[16] P. Keevash, The existence of designs, submitted (arXiv:1401.3665).
[17] P. Keevash, A hypergraph blow-up lemma, Random Structures Algorithms 39 (2011), no. 3, 275–376.
[18] P. Keevash and R. Mycroft, A geometric theory for hypergraph matching, Mem. Amer. Math. Soc.
233 (2014), no. 1098.
[19] Y. Kohayakawa, B. Nagle, V. Rödl, and M. Schacht, Weak hypergraph regularity and linear hypergraphs, J. Combin. Theory Ser. B 100 (2010), no. 2, 151–160.
[20] Y. Kohayakawa, V. Rödl, and J. Skokan, Hypergraphs, quasi-randomness, and conditions for regularity, J. Combin. Theory Ser. A 97 (2002), no. 2, 307–352.
[21] D. Kühn, R. Mycroft, and D. Osthus, Hamilton ℓ-cycles in uniform hypergraphs, J. Combin. Theory
Ser. A 117 (2010), no. 7, 910–927.
[22] T. Luczak, R(Cn , Cn , Cn ) ≤ (4 + o(1))n, J. Combin. Theory Ser. B 75 (1999), no. 2, 174–187.
[23] C. McDiarmid, On the method of bounded differences, Surveys in Combinatorics 141 (1989), 148–
188.
[24] J. Moon and L. Moser, On Hamiltonian bipartite graphs, Israel J. Math. 1 (1963), 163–165.
[25] B. Nagle, V. Rödl, and M. Schacht, The counting lemma for regular k-uniform hypergraphs, Random
Structures Algorithms 28 (2006), no. 2, 113–179.
[26] V. Nikiforov and R. H. Schelp, Cycle lengths in graphs with large minimum degree, J. Graph Theory
52 (2006), no. 2, 157–170.
[27] V. Rödl, On a packing and covering problem, European J. Combin. 6 (1985), 69–78.
54

[28] V. Rödl and A. Ruciński, Dirac-type questions for hypergraphs—a survey (or more problems for
Endre to solve), An irregular mind, Bolyai Soc. Math. Stud., vol. 21, János Bolyai Math. Soc.,
Budapest, 2010, pp. 561–590.
[29] V. Rödl, A. Ruciński, and E. Szemerédi, An approximate Dirac-type theorem for k-uniform hypergraphs, Combinatorica 28 (2008), no. 2, 229–260.
[30] V. Rödl, A. Ruciński, and E. Szemerédi, Dirac-type conditions for Hamiltonian paths and cycles in
3-uniform hypergraphs, Adv. Math. 227 (2011), no. 3, 1225–1299.
[31] V. Rödl and M. Schacht, Regular partitions of hypergraphs: counting lemmas, Combin. Probab.
Comput. 16 (2007), no. 6, 887–901.
[32]
, Regular partitions of hypergraphs: regularity lemmas, Combin. Probab. Comput. 16 (2007),
no. 6, 833–885.
[33] V. Rödl and J. Skokan, Regularity lemma for k-uniform hypergraphs, Random Structures Algorithms
25 (2004), no. 1, 1–42.
[34] E. Schmeichel and J. Mitchem, Bipartite graphs with cycles of all even lengths, J. Graph Theory 6
(1982), 429–439.
[35] E. Szemerédi, Regular partitions of graphs, Problèmes combinatoires et théorie des graphes (Orsay,
1976), Colloques Internationaux CNRS, vol. 260, CNRS, 1978, pp. 399–401.
Department of Mathematics, London School of Economics, Houghton Street, London
WC2A 2AE, U.K.
E-mail address: p.d.allen@lse.ac.uk
Department of Mathematics, London School of Economics, Houghton Street, London
WC2A 2AE, U.K.
E-mail address: j.boettcher@lse.ac.uk
Graz University of Technology, Institute of Optimization and Discrete Mathematics,
Steyrergasse 30, 8010 Graz, Austria
E-mail address: cooley@math.tugraz.at
School of Mathematics, University of Birmingham, Edgbaston, Birmingham B15 2TT,
UK
E-mail address: r.mycroft@bham.ac.uk

55

