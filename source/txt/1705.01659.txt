GRADED HYPOELLIPTICITY OF BGG SEQUENCES

arXiv:1705.01659v2 [math.DG] 20 Jul 2017

SHANTANU DAVE AND STEFAN HALLER
Abstract. In this paper we introduce the notion of Rockland sequences of diﬀerential
operators on ﬁltered manifolds. This concept generalizes the notion of elliptic sequences
and is formulated in terms of a Rockland condition. We show that these sequences are
hypoelliptic and have analytic properties similar to elliptic sequences, providing regularity,
maximal hypoelliptic estimates, and Hodge decomposition. These analytic properties follow
from a generalization of the Rockland theorem using the Heisenberg tangent groupoid construction. The main motivation lies in the fact that Bernstein–Gelfand–Gelfand sequences
over regular parabolic geometries are Rockland sequences in a graded sense. We use the
BGG machinery to construct similar sequences for a large class of ﬁltered manifolds, and
illustrate these results in some explicit examples.

Contents
1. Introduction
1.1. Filtered manifolds and their osculating groups
1.2. Analytic results
1.3. Construction of Rockland sequences
1.4. Motivation and outlook
2. Hypoelliptic sequences of diﬀerential operators
2.1. Preliminaries on operators with distributional kernels
2.2. Diﬀerential operators on ﬁltered manifolds
2.3. Parametrices
2.4. Rockland sequences
3. Pseudodiﬀerential operators on ﬁltered manifolds
3.1. Smooth groupoids
3.2. Groupoids on ﬁltered manifolds
3.3. Van Erp and Yuncken’s pseudodiﬀerential calculus
3.4. Parametrices and Rockland condition
3.5. The Heisenberg Sobolev scale
4. Graded hypoelliptic sequences
4.1. Filtered vector bundles and diﬀerential operators

2
2
3
5
8
10
10
12
15
18
20
21
25
27
33
39
45
46

2010 Mathematics Subject Classification. 58J40 (primary) and 58A30, 58A14, 58J10 (secondary).
Key words and phrases. Filtered manifold; pseudodiﬀerential operator; hypoelliptic operator; hypoelliptic
sequence; BGG sequence; Rockland sequence; Rumin–Seshadri operator; Engel structure; generic rank two
distribution in dimension ﬁve.
S. D. was supported by the Austrian Science Fund (FWF) grants P24420 and P28770.
The second author would like to express his gratitude to the Max Planck Institute for Mathematics in
Bonn for the hospitality and ﬁnancial support during an extended visit which enabled him to pursue this
project. Moreover, he gratefully acknowledges the support of the Austrian Science Fund (FWF) through the
START-Project Y963-N35 of Michael Eichmair.
1

4.2. Diﬀerential projectors
4.3. Splitting operators
4.4. Linear connections on ﬁltered manifolds
4.5. Subcomplexes of the de Rham complex
4.6. BGG sequences
5. Graded hypoelliptic sequences
5.1. Graded pseudodiﬀerential operators
5.2. Graded Heisenberg Sobolev scale
5.3. Graded Rockland operators
5.4. Graded Rockland sequences
Appendix A. Engel structures
Appendix B. Generic rank two distributions in dimension ﬁve
References

48
54
58
61
67
74
74
75
76
79
81
88
100

1. Introduction
A geometry in the sense of Cartan is a manifold that looks like a homogeneous space. A
homogeneous space is a space X with a large group of symmetries, a Lie group G that acts
transitively on X and thus X = G/H. A homogeneous space X has a principal H-bundle
G → X which comes equipped with the Maurer–Cartan form. Cartan’s notion of “looks
like a homogeneous space” is based upon similar data, the Cartan connection, on a principal
H-bundle over a smooth manifold. In the special case when G is a semisimple Lie group and
H is a parabolic subgroup, these geometries are known as parabolic geometries, see [11] for
an introduction.
Traditionally the Lie groups G and H and their representation theory are employed to
study Cartan geometries. For parabolic geometries, Čap, Slovák and Souček [12] have constructed a large class of natural diﬀerential operators called (curved) Bernstein–Gelfand–
Gelfand sequences or BGG sequences in short, see also [9, 14]. One aim of this article is to
show that BGG sequences over regular parabolic geometries enjoy hypoellipticity.
The manifold underlying a regular parabolic geometry inherits the structure of a ﬁltered
manifold. Using the BGG machinery, we will construct similar sequences for a large class
of ﬁltered manifolds, and describe in what sense they are hypoelliptic. These BGG type
sequences depend on a linear connection on a ﬁltered vector bundle and a Kostant type codiﬀerential. The classical BGG sequences over regular parabolic geometries can be recovered
from our construction by a suitable and natural choice of these ingredients.
1.1. Filtered manifolds and their osculating groups. A natural structure available on
every smooth manifold is its Lie algebra of vector ﬁelds. Various geometric structures on
smooth manifolds can be described in terms of a ﬁltration on the tangent bundle which
is compatible with the Lie bracket of vector ﬁelds. This compatibility is subsumed in the
concept of a ﬁltered manifold. A ﬁltered manifold is a smooth manifold M together with a
ﬁltration of its tangent bundle by smooth subbundles,
T M = T −r M ⊇ · · · ⊇ T −2 M ⊇ T −1 M ⊇ T 0 M = 0,
2

which is compatible with the Lie bracket of vector ﬁelds in the sense that [X, Y ] ∈ Γ∞ (T p+q M)
for all X ∈ Γ∞ (T p M) and Y ∈ Γ∞ (T q M).
To each point x in a ﬁltered manifold M one can assign a simply connected nilpotent Lie
group Tx M, called the osculating group at x, which can be regarded as a non-commutative
analogue of the tangent space at x. Its Lie algebra is given by
X
tx M := gr(Tx M) :=
Txp M/Txp+1 M
p

with the (Levi) bracket induced from the Lie bracket of vector ﬁelds. The osculating algebras
combine to form a smooth bundle of graded nilpotent Lie algebras tM over M, called the
bundle of osculating algebras. Correspondingly, the osculating groups combine to form a
smooth bundle of simply connected nilpotent Lie groups T M over M, called the bundle of
osculating groups. These play a crucial role in the analysis on ﬁltered manifolds.
Let us mention a few geometric structures that can be described as ﬁltered manifolds with
special osculating algebras. By Frobenius’ theorem, foliated manifolds can equivalently be
described as ﬁltered manifolds with abelian, but non-trivially graded osculating algebras. A
contact manifold is just a ﬁltered manifold with osculating algebras isomorphic to the Heisenberg algebra. An Engel manifold is a ﬁltered manifold with osculating algebras isomorphic
to a particular (generic) 4-dimensional graded nilpotent Lie algebra, see Example 4.22. A
generic rank two distribution in dimension ﬁve [15] is a ﬁltered manifold with osculating
algebras isomorphic to a particular (generic) 5-dimensional graded nilpotent Lie algebra, see
Example 4.24. Most regular normal parabolic geometries can equivalently be described as
ﬁltered manifolds with prescribed osculating algebras, see [11, Proposition 4.3.1]. Heisenberg
manifolds constitute a well studied [46] class of ﬁltered manifolds with varying osculating
algebras which is related to the geometry at the boundary of complex manifolds.
1.2. Analytic results. In this paper we will study operators on ﬁltered manifolds and
provide a criterion for their hypoellipticity. Our main analytic results are based on the
calculus for ﬁltered manifolds recently developed by van Erp and Yuncken. This calculus is
based on the construction of the Heisenberg tangent groupoid [62, 63, 16] and the idea of
essential homogeneity introduced in [22]. In this paper we extend their calculus to operators
acting between sections of vector bundles, and complement it with a general Rockland type
theorem. The proof of the latter builds upon harmonic analysis by Christ, Geller, Glowacki,
and Polin [18] and arguments due to Ponge [46]. If the underlying manifold is trivially
ﬁltered, we recover the classical pseudodiﬀerential calculus, see [22].
For two vector bundles E and F over a ﬁltered manifold M, and any complex number s, we
obtain a class of operators, denoted by Ψs (E, F ), we will refer to as pseudodiﬀerential oper∞
ators of Heisenberg order s. These are continuous operators Γ∞
c (E) → Γ (F ) which extend
−∞
continuously to pseudolocal operators on distributional sections, Γc (E) → Γ−∞ (F ). They
can be characterized as operators with a Schwartz kernel that admits an extension to the
Heisenberg tangent groupoid which is essentially homogeneous of order s. This extends the
Heisenberg ﬁltration on diﬀerential operators, that is, a diﬀerential operator has Heisenberg
order at most k ∈ N0 if and only if it is contained in Ψk (E, F ).
An operator A ∈ Ψs (E, F ) has a Heisenberg principal cosymbol σxs (A) ∈ Σsx (E, F ) at every point x ∈ M. Here Σsx (E, F ) denotes the space of regular distributional volume densities
on the osculating group Tx M with values in hom(Ex , Fx ) which are essentially homogeneous
3

of order s, modulo smooth volume densities. This cosymbol extends the Heisenberg principal (co)symbol of diﬀerential operators on ﬁltered manifolds. The basic properties of this
operator class and the Heisenberg principal cosymbol are summarized in Proposition 3.4
below.
Let π : Tx M → U(H) be a non-trivial irreducible unitary representation of the osculating
group on a Hilbert space H, and let H∞ denote the subspace of smooth vectors. If A ∈
Ψs (E, F ), then π̄(σxs (A)) is a well deﬁned closed unbounded operator on H, restricting to a
map π̄(σxs (A)) : H∞ ⊗Ex → H∞ ⊗Fx . The operator A is said to satisfy the Rockland condition
if π̄(σxs (A)) is injective on H∞ ⊗ Ex for all non-trivial irreducible unitary representations π
of Tx M and every x ∈ M.
The core analytic result is the following Rockland type theorem for general ﬁltered manifolds. For left invariant diﬀerential operators on graded nilpotent Lie groups this was conjectured by Rockland [50] and proved by Helﬀer and Nourrigat [32]. Christ, Geller, Glowacki,
and Polin constructed a pseudodiﬀerential operator calculus on graded nilpotent Lie groups
and established a Rockland type theorem, see [18]. For Heisenberg manifolds with varying
osculating algebras such a result has been obtained by Ponge [46].
Theorem A. Let E and F be two vector bundles over a filtered manifold M and suppose
A ∈ Ψs (E, F ) satisfies the Rockland condition. Then there exists a properly supported left
parametrix B ∈ Ψ−s
prop (F, E), that is, BA − id is a smoothing operator.
As a consequence, every operator A ∈ Ψs (E, F ) satisfying the Rockland condition is
hypoelliptic, that is, if ψ is a compactly supported distributional section of E such that Aψ
is smooth, then ψ was smooth. Over closed manifolds this implies that ker(A) is a ﬁnite
dimensional subspace of Γ∞ (E), see Theorem 3.13 below.
Combining this calculus with a result of Christ, Geller, Glowacki, and Polin, see [18,
Theorem 6.1], we construct, for each complex number s, an operator Λs ∈ Ψs (E) which is
invertible mod smoothing operators, see Lemma 3.16. This permits to introduce a Heisenberg Sobolev scale, see Proposition 3.21, and allows to formulate more reﬁned regularity
statements, including maximal hypoelliptic estimates, for operators satisfying the Rockland
condition, see Corollary 3.24.
We will use Theorem A to analyze Rockland sequences. A sequence of operators,
Ai−1

A

i
· · · → Γ∞ (Ei−1 ) −−−→ Γ∞ (Ei ) −→
Γ∞ (Ei+1 ) → · · · ,

where Ai ∈ Ψsi (Ei , Ei+1 ) will be called Rockland sequence if the corresponding principal
symbol sequence is exact in every non-trivial irreducible unitary representation π : Tx M →
U(H) at each x ∈ M, that is, the sequence
s

s

π̄(σxi−1 (Ai−1 ))

π̄(σxi (Ai ))

· · · → H∞ ⊗ Ex,i−1 −−−−−−−−−→ H∞ ⊗ Ex,i −−−−−−→ H∞ ⊗ Ex,i+1 → · · ·
is exact. On trivially ﬁltered manifolds this deﬁnition reduces to the well known concept of
elliptic sequences. To study these sequences we consider formal adjoints A∗i ∈ Ψs̄ (Ei+1 , Ei )
with respect to standard L2 inner products on Γ∞ (Ei ). Theorem A implies that (A∗i−1 , Ai )
is hypoelliptic, and more reﬁned regularity statements, including maximal hypoelliptic estimates, can be formulated using the Heisenberg Sobolev scale.
On closed manifolds, in case the Rockland sequence forms a complex, i.e. Ai Ai−1 = 0, it
is convenient to use suitable Sobolev adjoints, A♯i of Ai . These adjoints are constructed such
4

that Ai−1 A♯i−1 and A♯i Ai have the same Heisenberg order and thus Bi := Ai−1 A♯i−1 + A♯i Ai is
a Rockland operator. We obtain a Hodge decomposition
Γ∞ (Ei ) = img(Ai−1 ) ⊕ ker(Bi ) ⊕ img(A♯i )
where ker(Bi ) = ker(A♯i−1 ) ∩ ker(Ai ). In particular, each cohomology class has a unique
harmonic representative, that is, ker(Ai )/ img(Ai ) = ker(Bi ).
For Rockland complexes of diﬀerential operators of positive order, one can alternatively
follow the Rumin–Seshadri approach [55] and consider
∆i := (Ai−1 A∗i−1 )ai−1 + (A∗i Ai )ai

(1)

where the numbers ai ∈ N are chosen such that κ := si−1 ai−1 = si ai . Then ∆i is a diﬀerential
operator of order at most 2κ which satisﬁes the Rockland condition. We obtain a similar
Hodge decomposition, namely,
Γ∞ (Ei ) = img(Ai−1 ) ⊕ ker(∆i ) ⊕ img(A∗i ),
where ker(Ai )/ img(Ai ) = ker(∆i ) = ker(A∗i−1 ) ∩ ker(Ai ).
In order to study the BGG type sequences we will construct below, the analysis needs to
be modiﬁed to ﬁt the ﬁltered setup. For any two ﬁltered vector bundles E and F we consider
a class of operators, Ψ̃s (E, F ), which will be called pseudodiﬀerential operators of graded
Heisenberg order s. If we identify E and F with the associated graded using splittings of
the ﬁltrations, then an operator A ∈ Ψ̃s (E, F ) can be considered as a matrix with entries
Aqp ∈ Ψs+q−p (grp (E), grq (F )). The graded Heisenberg principal cosymbol, σ̃xs (A), can be
deﬁned as the matrix obtained by taking the (ordinary) Heisenberg principal symbol of each
entry, that is,
X
σ̃xs (A) =
σxs+q−p (Aqp ).
p,q

Neither the operator class Ψ̃s (E, F ), nor the graded Heisenberg principal cosymbol σ̃xs (A)
depend on the choice of splittings.
An operator A ∈ Ψ̃s (E, F ) is called graded Rockland operator if π̄(σ̃xs (A)) : H∞ ⊗gr(Ex ) →
H∞ ⊗ gr(Fx ) is injective for all non-trivial irreducible unitary representations π : Tx M →
U(H) and all x ∈ M. Similarly, a graded Rockland sequence is deﬁned to be a sequence
of operators such that its graded Heisenberg principal symbol sequence is exact in each
non-trivial irreducible unitary representation of Tx M and every x ∈ M. Theorem A has a
graded analogue, and all the analysis mentioned above generalizes to this graded setup, see
Section 5.

1.3. Construction of Rockland sequences. In this paper will shall construct several
examples of Rockland sequences. The most basic sequence we will consider is the de Rham
sequence associated with a linear connection ∇ on a ﬁltered vector bundle E over a ﬁltered
manifold M. This can be characterized as the unique extension of ∇,
d∇
k−1

d∇

k
Ωk+1 (M; E) → · · · ,
· · · → Ωk−1 (M; E) −−→ Ωk (M; E) −→

(2)

such that the Leibniz rule d∇ (α ∧ ψ) = dα ∧ ψ + (−1)k α ∧ d∇ ψ holds for all α ∈ Ωk (M)
and ψ ∈ Ω∗ (M; E). Here we use the notation Ωk (M; E) = Γ∞ (Λk T ∗ M ⊗ E) for the space of
E-valued diﬀerential forms.
5

We assume that ∇ is ﬁltration preserving, that is to say, we assume ∇X ψ ∈ Γ∞ (T p+q M)
for all X ∈ Γ∞ (T p M) and ψ ∈ Γ∞ (E q ). Then all operators in the sequence (2) are of graded
Heisenberg order at most zero with respect to the induced ﬁltration on the vector bundles
Λk T ∗ M ⊗ E. We will, furthermore, assume that the curvature of ∇ is contained in ﬁltration
degree one, that is, we assume Fx∇ (X1 , X2 )ψ ∈ Exp1 +p2 +p+1 for all Xi ∈ Txpi M and ψ ∈ Exp .
Linear connections of this kind exist on every ﬁltered vector bundle. If E is trivially ﬁltered,
then all linear connections on E satisfy the two assumptions. In general,
using a splitting
L
of the ﬁltration to identify E with its associated graded, gr(E) = p E p /E p+1, each linear
connection preserving the grading on gr(E) will satisfy the two assumptions. Moreover, all
tractor bundles associated with regular parabolic geometries come equipped with a natural
linear connection satisfying these assumptions, see Section 4.6 below.
Theorem B. Let E be a filtered vector bundle over a filtered manifold M and suppose ∇ is
a filtration preserving linear connection on E such that its curvature is contained in filtration
degree one. Then the de Rham sequence in (2) is a graded Rockland sequence.
Essentially, Theorem B follows from the fact that the Lie algebra cohomology H ∗ (g; H∞ )
vanishes for every ﬁnite dimensional nilpotent Lie algebra g and its representation on the
space of smooth vectors H∞ associated with any non-trivial irreducible unitary representation of the corresponding simply connected nilpotent Lie group on a Hilbert space H. This
will be established in Section 4.4, see Proposition 4.17 below.
To construct new sequences, we follow Čap, Slovák, and Souček, see [12], and consider
a Kostant type codiﬀerential. By this we mean a sequence of ﬁltration preserving vector
bundle homomorphisms,
δk+1

δ

k
−
Ωk (M; E) ←−− Ωk+1 (M; E) ← · · · ,
· · · ← Ωk−1 (M; E) ←

satisfying δk δk+1 = 0 and two more conditions formulated in Deﬁnition 4.8 below. Assuming
δk to have locally constant rank, we obtain smooth vector bundles ker(δk ), img(δk+1 ), and
Hk := ker(δk )/ img(δk+1 ), which are ﬁltered in a natural way. We let π̄k : ker(δk ) → Hk
denote the natural vector bundle projection.
Using the BGG machinery [12, 9, 13, 14] we will see that there exist operators analogous
to the splitting operators in parabolic geometry, see [13, Theorem 2.4]. More precisely,
there exists a unique diﬀerential operator L̄k : Γ∞ (Hk ) → Ωk (M; E) such that δk L̄k = 0,
π̄k L̄k = id, and δk+1 d∇
k L̄k = 0. These operators L̄k are of graded Heisenberg order zero and
permit to deﬁne a sequence of diﬀerential operators of graded Heisenberg order zero,
D̄k−1

D̄

k
Γ∞ (Hk+1 ) → · · · ,
· · · → Γ∞ (Hk−1 ) −−−→ Γ∞ (Hk ) −→

(3)

π̄k+1 d∇
k L̄k .

by setting D̄k :=
In Section 4.5 we will establish the following result, see Corollary 4.20.
Theorem C. The operators in (3) form a graded Rockland sequence.
A codiﬀerential δ of maximal rank exists, provided the dimension of the Lie algebra cohomology H ∗ (tx M; gr(Ex )) is locally constant in x. Note that the curvature assumption on ∇
implies that gr(Ex ) becomes a graded representation of the graded nilpotent Lie algebra tx M,
see Lemma 4.16. In this case the codiﬀerential δk can be constructed using splittings of the
ﬁltrations on the bundles Λk T ∗ M ⊗E ∼
= gr(Λk T ∗ M ⊗E) = Λk t∗ M ⊗gr(E) and the adjoint of
the ﬁber wise Chevalley–Eilenberg diﬀerential, ∂k−1 : Λk−1t∗ M ⊗gr(E) → Λk t∗ M ⊗gr(E), see
6

Remark 4.14 for details. For this codiﬀerential there exists a (non-canonical) isomorphism of
smooth vector bundles Hk ∼
= H k (tM; gr(E)) = ker(∂k )/ img(∂k−1 ) where the latter denotes
the vector bundle with ﬁbers H k (tx M; gr(Ex )).
For tractor bundles associated with regular parabolic geometries, however, there exists a
natural choice for δ which is called Kostant codifferential and often denoted by ∂ ∗ . In this
case the construction above reduces to the construction of the curved BGG sequences, and
the operators L̄k coincide with the well known splitting operators, see [13, Theorem 2.4] for
instance. As an immediate corollary of Theorem C we thus obtain, cf. Corollary 4.23:
Theorem D. All (curved, torsion free) BGG sequences associated with a regular parabolic
geometry are graded Rockland sequences.
To prove Theorem C, we shall construct another sequence that, at the principal symbol
level, can be combined with the sequence (3) to obtain the de Rham sequence of Theorem B, up to conjugation. The Rockland condition for both components then follows from
Theorem B. This construction is closely related to the standard BGG machinery.
∇
More precisely, we consider k := d∇
k−1 δk +δk+1 dk , a diﬀerential operator of graded Heisenberg order at most zero on Ωk (M; E). The associated graded vector bundle endomorphism
˜ k := gr(k ) on gr(Λk T ∗ M ⊗E) is analogous to Kostant’s box operator. Using the ﬁber wise

˜ k , we obtain a vector bundle projector
projection onto the generalized zero eigenspace of 
k ∗
P̃k on gr(Λ T M ⊗ E), providing a decomposition of smooth vector bundles
gr(Λk T ∗ M ⊗ E) = img(P̃k ) ⊕ ker(P̃k )
˜ k is nilpotent on img(P̃k ) and invertible on ker(P̃k ). We will construct two
such that 
sequences of diﬀerential operators of graded Heisenberg order at most zero,
Dk−1

D

k
Γ∞ (img(P̃k+1)) → · · ·
· · · → Γ∞ (img(P̃k−1)) −−−→ Γ∞ (img(P̃k )) −→

and

Bk−1

B

k
Γ∞ (ker(P̃k+1 )) → · · · ,
· · · → Γ∞ (ker(P̃k−1 )) −−−→ Γ∞ (ker(P̃k )) −→
as well as invertible diﬀerential operators

(4)
(5)

Lk : Γ∞ (gr(Λk T ∗ M ⊗ E)) → Ωk (M; E),
such that the graded Heisenberg principal symbols are related by
∇
0
0
σ̃x0 (L−1
k+1 dk Lk ) = σ̃x (Dk ) ⊕ σ̃x (Bk )

at each point x ∈ M. Theorem B readily implies that (4) and (5) are both graded Rockland sequences. Moreover, we will construct an invertible diﬀerential operator of graded
−1
Heisenberg order zero, Vk : Γ∞ (img(P̃k )) → Γ∞ (Hk ), such that Vk+1
D̄k Vk = Dk , whence
Theorem C.
The construction of the operators announced in the preceding paragraph is based on the
observation that there exists a unique ﬁltration preserving diﬀerential operator
Pk : Ωk (M; E) → Ωk (M; E)
characterized by Pk k = k Pk , Pk2 = Pk and gr(Pk ) = P̃k . This operator has graded
Heisenberg order zero. Using splittings of the ﬁltrations, Sk : gr(Λk T ∗ M ⊗E) → Λk T ∗ M ⊗E,
we deﬁne diﬀerential operators of graded Heisenberg order zero,
Lk := Pk Sk P̃k + (id −Pk )Sk (id −P̃k ).
7

Since gr(Lk ) = id, this diﬀerential operator is invertible and its inverse L−1
is a difk
ferential operator of graded Heisenberg order zero too. Moreover, it conjugates the differential projectors into vector bundle projectors, L−1
k Pk Lk = P̃k . We will verify that
−1 ∇
∇
the operators Dk := P̃k+1 Lk+1 dk Lk |Γ∞ (img(P̃k )) , Bk := (id −P̃k+1 )L−1
k+1 dk Lk |Γ∞ (ker(P̃k )) , and
Vk := π̄k Lk |Γ∞ (img(P̃k )) with inverse Vk−1 = L−1
k L̄k have all the desired properties. The operator Pk is related to the splitting operator L̄k considered above by L̄k π̄k = Pk |ker(δk ) . On
regular parabolic geometries Pk coincides with the composition of (5.1) and (5.2) in [9].
As another application, let us now suppose that the linear connection ∇ is ﬂat. In this case
∇
the sequence (2) is known as de Rham complex, d∇
k dk−1 = 0, and computes the cohomology
of M with coeﬃcients in the system of local coeﬃcients provided by the ﬂat connection on
∇
E. We will see that the sequence of operators L−1
k+1 dk Lk decouples into a Rumin complex
and an acyclic subcomplex. More precisely,
∇
L−1
k+1 dk Lk = Dk ⊕ Bk ,

and, in particular, Dk Dk−1 = 0 = Bk Bk−1 . In this situation the sequences in (3) and (4)
will be called Rumin complexes, for they generalize complexes on contact manifolds which
have been introduced by Rumin [54]. We will show that the sequence Bk is conjugate to an
acyclic tensorial complex. More precisely, we will see that there exist invertible diﬀerential
operators of graded Heisenberg order at most zero, Gk acting on Γ∞ (ker(P̃k )), such that
G−1
k+1 Bk Gk = ∂k |Γ∞ (ker(P̃k ))
where the right hand side denotes the restriction of the Chevalley–Eilenberg diﬀerential on
gr(Λk T ∗ M ⊗ E) = Λk tk M ⊗ gr(E) to the invariant acyclic subbundle ker(P̃k ), see Theorem 4.19. Summarizing, we obtain:
Theorem E. If the linear connection ∇ is a flat, then there exist invertible differential
operators of graded Heisenberg order zero, Wk : Γ∞ (Hk ⊕ ker(P̃k )) → Ωk (M; E), such that
−1 ∇
Wk+1
dk Wk = D̄k ⊕ (∂k |Γ∞ (ker(P̃k )) ).

On a contact manifold, the Rumin complex (3) is Rockland in the ungraded sense and
coincides with the complex introduced by Rumin, see Example 4.21 below. Hypoellipticity
of this complex has been established by Rumin in [54] using the classical Heisenberg calculus.
For generic rank two distributions in dimension ﬁve, the Rumin complex is Rockland in the
ungraded sense too, see Example 4.24. In general, the Rumin complex will only be Rockland
in the graded sense, and the graded analysis in Section 5 may be used to study them. For
instance, the Rumin complex associated with an Engel structure will only be Rockland in
the graded sense, see Example 4.22.
1.4. Motivation and outlook. The work in this paper provides a framework to study
ﬁltered manifolds by exploring the analogies to the elliptic case. Classically, the relation
between geometry and topology has been successfully studied by analyzing elliptic operators
that arise naturally. We hope that the hypoellipticity of the operators considered in this
paper will allow to relate the geometry of ﬁltered manifolds to global topological properties.
We will now mention some directions which have been motivating our investigations.
By hypoellipticity, Rockland operators on closed ﬁltered manifolds are Fredholm and there
is a clear candidate for the index formula. To be more speciﬁc, suppose E and F are two
vector bundles over a closed ﬁltered manifold, and consider A ∈ Ψs (E, F ) such that A and
8

At both satisfy the Rockland condition. In this situation, the analysis mentioned above implies that A induces a Fredholm operator between appropriate Heisenberg Sobolev spaces,
see Corollary 3.28. We expect that the index of this operator can be computed by an index formula similar to van Erp’s in the contact case, see [60] and [20]. More precisely, the
Rockland condition should guarantee that the Heisenberg principal symbol of A represents a
K-theory class on the non-commutative cotangent bundle, [σ s (A)] ∈ K0 (C ∗ (T M)), and we
expect the index formula ind(A) = t-ind(ψ([σ s (A)])) where ψ : K0 (C ∗ (T M)) → K 0 (T ∗ M)
denotes the abstract Connes–Thom isomorphism [19] and t-ind : K 0 (T ∗ M) → Z is the topological index map of Atiyah and Singer [1]. More generally, the Heisenberg principal symbol sequence of every Rockland complex should, in a natural way, represent an element in
K0 (C ∗ (T M)) which is mapped to the Euler characteristics of the Rockland complex via
t-ind ◦ψ : K0 (C ∗ (T M)) → Z. We expect explicit index formulas for various parabolic geometries, similar to van Erp’s formula on contact manifolds, see [61].
It seems promising to search for Weitzenböck formulas for the Rumin complex associated
with a trivial ﬂat line bundle over a ﬁltered manifold M and combine them with the Hodge
decomposition established in this paper, see Corollaries 2.20 and 5.9, to obtain analogues of
Bochner’s vanishing result. Assuming non-negative curvature, a Weitzenböck formula should
imply that every harmonic section of Hk is parallel. Over closed connected manifolds, the
Hodge decomposition would thus yield a bound on the k-th Betti number, bk (M) ≤ rank(Hk ).
If, moreover, the curvature is strictly positive at one point, one would expect bk (M) = 0.
Let us specialize the above remarks to a particular 5-dimensional Cartan geometry and
formulate a precise conjecture. To this end, consider a 5-manifold M equipped with a generic
rank two distribution [15, 8, 56]. More precisely, suppose T −1 M ⊆ T M is a distribution of
rank two with growth vector (2, 3, 5), that is, Lie brackets of sections of T −1 M span a rank
three subbundle T −2 M of T M and triple brackets of sections of T −1 M span all of T M. Such
a ﬁltered manifold can equivalently be described as a regular normal parabolic geometry of
type (G, P ) where G is the split real form of the exceptional Lie group G2 and P is a particular
parabolic subgroup. Cartan [15] constructed a curvature tensor κ ∈ Γ∞ (S 4 (T −1 M)∗ ) which is
a complete obstruction to local ﬂatness. More precisely, κ vanishes if and only if the ﬁltration
is locally diﬀeomorphic to the ﬂat model G/P . Regarding the curvature κx as a fourth order
polynomial on Tx−1 M, we call κx non-negative and write κx ≥ 0, if κx (X, X, X, X) ≥ 0 for
all X ∈ Tx−1 M. Since the corresponding Rumin complex for the trivial ﬂat line bundle has
rank(H1 ) = 2, see Example 4.24 below, we conjecture the following to hold true: If M is
closed, connected, and κ ≥ 0, then the ﬁrst Betti number is bounded by b1 (M) ≤ 2. If,
moreover, κx > 0 in at least one point x, then b1 (M) = 0.
Another application we have in mind concerns the extension of Ponge’s [46] spectral analysis on Heisenberg manifolds to more general ﬁltered manifolds. It appears that asymptotic
expansion of the heat kernel, complex powers, and Weyl’s law are all within reach for the
Rumin–Seshadri operators discussed in this paper. In particular, there is an obvious generalization of the Rumin–Seshadri analytic torsion [55] to closed ﬁltered manifolds which give
rise to ungraded Rumin complexes. Due to the rich structure available on regular parabolic
geometries it appears feasible to work out explicit anomaly formulas for the Rumin–Seshadri
analytic torsion, expressing to what extent this analytic torsion depends on the L2 inner
product used to deﬁne the formal adjoints, see (1). We hope that the decomposition of
the de Rham complex in Theorem E will prove helpful in establishing a comparison result
9

relating the Rumin–Seshadri analytic torsion of the Rumin complex with the Ray–Singer
torsion [48] of the full de Rham complex.
The existence of a regular parabolic geometry of a particular type on a given manifold
can often be described equivalently in terms of a diﬀerential relation. Formally, these can
be solved in terms of homotopy theory. The subtle question is to what extent Gromov’s
h-principle [31] holds true for regular parabolic geometries. We anticipate that the proposed
generalization of the Rumin–Seshadri analytic torsion has the potential to detect a possible
failure of the h-principle. In particular, this might lead to topological obstructions to the
existence of regular parabolic geometries on closed manifolds [21], and it might provide a
suﬃciently strong tool to show that formally homotopic regular parabolic geometries need
not be homotopic in general, see [47].

2. Hypoelliptic sequences of differential operators
Generalizing elliptic sequences of diﬀerential operators, we will, in this section, introduce the notion of Rockland sequences of differential operators on ﬁltered manifolds, see
Deﬁnition 2.14 below. We will formulate a hypoellipticity result for these sequences, see
Corollary 2.19, and a corresponding Hodge decomposition, see Corollary 2.20. These are
all immediate corollaries of a Rockland type theorem for diﬀerential operators on general
ﬁltered manifolds, see Theorem 2.8, that generalizes well known results for Heisenberg manifolds [2, 46, 58] and ﬁltered manifolds which are locally diﬀeomorphic to nilpotent Lie groups
[18]. The proof of Theorem 2.8 will be presented in Section 3.

2.1. Preliminaries on operators with distributional kernels. Let us start by recalling
standard facts about vector valued distributions and setting up our notation.
Let M be a smooth manifold and let |Λ|M denote the bundle of 1-densities on M. For
every smooth complex vector bundle E over M, we put E ′ := E ∗ ⊗ |Λ|M where E ∗ de∞
′
) × Γ∞ (E) → C, hφ ⊗ dx, ψi :=
Rnotes the dual bundle. There is a canonical pairing Γc (E
hφ, ψidx and this provides a continuous inclusion Γ∞ (E) ⊆ Γ−∞ (E) := D(E)∗ where
M
′
−∞
D(E) := Γ∞
(E) is the space of distributional
c (E ) denotes the space of test sections and Γ
∞
′
∞
sections. Similarly, the pairing Γ (E ) × Γc (E) → C gives rise to a continuous inclusion
−∞
∗
∞
′
−∞
Γ∞
c (E) ⊆ Γc (E) := E(E) where E(E) := Γ (E ) and Γc (E) denotes the space of compactly supported distributional sections. Note that one may identify E ′′ = E since the line
bundle |Λ|∗M ⊗ |Λ|M admits a canonical trivialization.
These inclusions extend continuously to L2loc (E) ⊆ Γ−∞ (E) and L2c (E) ⊆ Γ−∞
c (E). Moreover, the canonical pairing extends to a continuous pairing L2c (E ′ ) × L2loc (E) → C which
gives rise to isomorphisms L2loc (E)∗ = L2c (E ′ ) and L2c (E ′ )∗ = L2loc (E). If M is compact, then
L2c (E) = L2loc (E) is a Hilbert space and will be denoted by L2 (E).
Suppose F is another vector bundle over M. Recall that a continuous linear operator
−∞
A : Γ∞
(F ) can be described
equivalently by its distributional (Schwartz) kernel
c (E) → Γ
R
−∞
′
k ∈ Γ (F ⊠ E ) via (Aψ)(x) = M k(x, y)ψ(y)dy, where ψ ∈ Γ∞
c (E) and x ∈ M. Here we
are using the vector bundle F ⊠ E ′ := τ ∗ F ⊗ σ ∗ E ′ over M × M where σ : M × M → M,
σ(x, y) := y, and τ : M × M → M, τ (x, y) := x, denote the natural projections. More
10

∞
′
precisely, hφ, Aψi = hφ ⊠ ψ, ki, for all ψ ∈ Γ∞
c (E) and φ ∈ D(F ) = Γc (F ), where φ ⊠ ψ :=
1
∗
∗
∞
′
′
(τ φ) ⊗ (σ ψ) ∈ Γc (F ⊠ E) = D(F ⊠ E ).
−∞
If A : Γ∞
(F ) is an operator with Schwartz kernel k ∈ Γ−∞ (F ⊠ E ′ ), then
c (E) → Γ
the transposed kernel, k t ∈ Γ−∞ (E ′ ⊠ F ), k t (x, y) := k(y, x)t , corresponds to the transpose
′
−∞
operator, At : Γ∞
(E ′ ), characterized by hφ, Aψi = hAt φ, ψi, for all ψ ∈ Γ∞
c (F ) → Γ
c (E) =
′
∞
D(E ) and φ ∈ D(F ) = Γc (F ′ ). Clearly, (At )t = A up to the canonical identiﬁcations
E ′′ = E and F ′′ = F .
Smooth kernels k ∈ Γ∞ (F ⊠ E ′ ) correspond precisely to smoothing operators, i.e. con∞
tinuous operators Γ−∞
c (E) → Γ (F ). We will denote the space of smoothing operators by
−∞
−∞
O (E, F ). If A ∈ O (E, F ), then At ∈ O−∞ (F ′ , E ′ ).
We let DO(E, F ) denote the space of differential operators with smooth coeﬃcients,
D : Γ∞ (E) → Γ∞ (F ). The Schwartz kernels of diﬀerential operators are supported along
the diagonal in M × M. If D ∈ DO(E, F ), then D t ∈ DO(F ′, E ′ ).
−∞
Let O(E, F ) denote the space of operators Γ∞
(F ) corresponding to Schwartz
c (E) → Γ
kernels with wave front set contained in the conormal bundle of the diagonal. These are
precisely the operators whose kernel is smooth away from the diagonal and which map
∞
t
′
′
Γ∞
c (E) continuously into Γ (F ). If A ∈ O(E, F ), then A ∈ O(F , E ). The transpose
−∞
permits to extend A continuously to distributional sections, A : Γc (E) → Γ−∞ (F ), such
∞
′
that hAt φ, ψi = hφ, Aψi for all ψ ∈ Γ−∞
c (E) and φ ∈ D(F ) = Γc (F ), and this extension is
−∞
pseudolocal, i.e. sing-supp(Aψ) ⊆ sing-supp(ψ) for all ψ ∈ Γc (E). If A ∈ O(E, F ) is prop∞
erly supported, then it deﬁnes continuous linear maps: Γ∞ (E) → Γ∞ (F ), Γ∞
c (E) → Γc (F ),
−∞
−∞
−∞
−∞
Γ (E) → Γ (F ), and Γc (E) → Γc (F ). Recall that an operator with Schwartz kernel
k is called properly supported if the projections σ and τ both restrict to proper maps on
the support of k. If B ∈ O(F, G) and at least one of A or B is properly supported, then
BA ∈ O(E, G) and (BA)t = At B t . If both are properly supported, then so is their product.
If at least one of A or B is a smoothing operator, the same is true for their product. If both
are diﬀerential operators, then so is their product. Clearly,
−∞
DO(E, F ) ⊆ Oprop (E, F ) ⊇ Oprop
(E, F ),

where the subscript indicates properly supported operators. In particular, Oprop (E) :=
Oprop (E, E) is a unital algebra containing the algebra of diﬀerential operators DO(E) :=
−∞
−∞
DO(E, E) and the ideal of properly supported smoothing operators, Oprop
(E) := Oprop
(E, E).
A smooth volume density dx on M and a smooth ﬁberwise Hermitian inner product h on
E give rise to a positive deﬁnite sesquilinear form
Z
hhψ1 , ψ2 iiL2 (E) =
h(ψ1 (x), ψ2 (x))dx = h(h ⊗ dx)ψ1 , ψ2 i
(6)
M

′
where ψ1 , ψ2 ∈ Γ∞
c (E). Here we consider h ⊗ dx : Ē → E as an vector bundle isomorphism.
When restricted to sections supported in a ﬁxed compact set, this becomes a Hermitian
inner product generating the L2 -topology. This sesquilinear form extends continuously to
L2c (Ē)×L2loc (E) → C, inducing isomorphisms L2loc (E)∗ = L2c (Ē) and L2c (Ē)∗ = L2loc (E). With
−∞
respect to inner products of the form (6), an operator A : Γ∞
(F ) with Schwartz
c (E) → Γ
1For

the latter identiﬁcation note that the canonical isomorphism |Λ|M×M = |Λ|M ⊠ |Λ|M provides a
canonical identiﬁcation (F ⊠ E ′ )′ = F ′ ⊠ E ′′ = F ′ ⊠ E and thus a canonical isomorphism D(F ⊠ E ′ ) =
′ ′
∞
′
Γ∞
c ((F ⊠ E ) ) = Γc (F ⊠ E).
11

−∞
kernel k ∈ Γ−∞ (F ⊠ E ′ ) has a formal adjoint, A∗ : Γ∞
(E), characterized by
c (F ) → Γ

hhA∗ φ, ψiiL2 (E) = hhφ, AψiiL2 (F )

(7)

∞
for all φ ∈ Γ∞
c (F ) and ψ ∈ Γc (E). Indeed, in terms of the transpose,

A∗ = (hE ⊗ dx)−1 ◦ At ◦ (hF ⊗ dx),

(8)

where we consider hF ⊗dx : F̄ → F ′ and (hE ⊗dx)−1 : E ′ → Ē as vector bundle isomorphisms.
Its Schwartz kernel, k ∗ ∈ Γ−∞ (E ⊠ F ′ ), is given by k ∗ (x, y) = k(y, x)∗ . For A ∈ O(E, F )
and B ∈ O(F, G) we obtain A∗ ∈ O(F, E), (A∗ )∗ = A, and (BA)∗ = A∗ B ∗ provided at least
one of the two operators is properly supported. Clearly, the operator classes O−∞ and DO
are invariant under taking formal adjoints.
We let Γ(E) denote the space of continuous sections of E equipped with the topology
of uniform convergence on compact subsets. Moreover, we let Γc (E) denote the space of
compactly supported continuous sections equipped with the usual (inductive limit) topology.
−∞
Recall that the inclusions Γ∞ (E) ⊆ Γ−∞ (E) and Γ∞
c (E) ⊆ Γc (E) extend to continuous
−∞
−∞
inclusions Γ(E) ⊆ Γ (E) and Γc (E) ⊆ Γc (E), respectively.
2.2. Differential operators on filtered manifolds. A filtered manifold [40, 41, 43] is
a smooth manifold M whose tangent bundle comes equipped with a ﬁltration by smooth
subbundles,
T M = T −r M ⊇ · · · ⊇ T −2 M ⊇ T −1 M ⊇ T 0 M = 0,
which is compatible with the Lie bracket in the following sense: If X ∈ Γ∞ (T p M) and
Y ∈ Γ∞ (T q M), then [X, Y ] ∈ Γ∞ (T p+q M).
Let M be a ﬁltered manifold and consider the quotient bundle tp M := T p M/T p+1 M with
ﬁbers tpx M = Txp M/Txp+1M. Recall that the Lie bracket of vector ﬁelds induces
La tensorial
p
q
p+q
(Levi) bracket t M ⊗ t M → t M which turns the associated graded tM := p tp M into
a bundle
nilpotent Lie algebras called the bundle of osculating algebras. Each ﬁber
Lof graded
p
tx M = p tx M is a graded nilpotent Lie algebra which will be referred to as the osculating
algebra at x. The Lie algebra structure depends smoothly on x but is not assumed to be
locally trivial, that is, diﬀerent ﬁbers may be non-isomorphic as Lie algebras. In the literature
tx M is also known as the symbol algebra of M at x, see [40, 41, 43].
Remark 2.1 (Examples). Suppose n = n−r ⊕· · ·⊕n−1 is a graded nilpotent Lie algebra, and
let N be a L
Lie group with Lie algebra n. Then the ﬁltration n = n−r ⊇ · · · ⊇ n−1 ⊇ n0 = 0,
with np := p≤q nq , determines a left invariant ﬁltration of T N which turns N into a ﬁltered
manifold with (locally) trivial bundle of osculating algebras and typical ﬁber n.
Numerous regular normal parabolic geometries can be described equivalently as ﬁltered
manifolds with locally trivial bundle of osculating algebras, see [11, Proposition 4.3.1]. These
include generic rank two distributions in dimension ﬁve [15, 8, 56, 11, 21], generic rank three
distributions in dimension six [6], and quaternionic contact structures [3].
Heisenberg manifolds [46] constitute a class of ﬁltered manifolds for which the bundle of
osculating algebras need not be locally trivial. The latter occur naturally as boundaries of
complex manifolds.
Contact manifolds are arguably the best know ﬁltered manifolds. Their bundle of osculating algebras is locally trivial with the Heisenberg algebra as typical ﬁber. According to
Darboux’s theorem, the ﬁltration on a contact manifold is even locally diﬀeomorphic to the
12

left invariant ﬁltration on the Heisenberg group. Engel structures on 4-manifolds provide
further examples of ﬁltered manifolds that admit local normal forms, see [64].
Let us also point out, that foliated manifolds can be considered as ﬁltered manifolds. In
this case the osculating algebras are abelian but non-trivially graded.
Remark 2.2. There are various conventions on choosing orders/degrees on ﬁltrations and
gradings. Van Erp and Yuncken [62], for instance, assign positive values to gradings. We
follow the convention prevalent in parabolic geometry, see for example [11, 40]. In this
context the choice of negative degree/order is a well established convention.
A ﬁltration on M induces a (Heisenberg) ﬁltration on diﬀerential operators. If E and F
are two smooth vector bundles over M, then a diﬀerential operator in DO(E, F ) is said to
be of Heisenberg order at most k if, locally, it can be written as a ﬁnite linear combination
of operators of the form Φ∇Xm · · · ∇X1 where Φ ∈ Γ∞ (hom(E, F )), ∇ is a linear connection
on E, and Xi ∈ Γ∞ (T pi M) are vector ﬁelds such that −k ≤ pm + · · · + p1 . Denoting the
space of these diﬀerential operators by DOk (E, F ), we obtain a ﬁltration on DO(E, F ),
Γ∞ (hom(E, F )) = DO0 (E, F ) ⊆ DO1 (E, F ) ⊆ DO2 (E, F ) ⊆ · · · ,
which is compatible with composition and transposition. More explicitly, if A ∈ DOk (E, F )
and B ∈ DOl (F, G), then BA ∈ DOl+k (E, G) and At ∈ DOk (F ′ , E ′ ).
Remark 2.3 (The spaces Γr (E)). For r ∈ N0 we let Γr (E) denotes the Heisenberg analogue
of the space of r times continuously diﬀerentiable sections of E. More precisely, Γr (E)
denotes the space of all ψ ∈ Γ−∞ (E) such that Aψ ∈ Γ(F ) for all diﬀerential operators
A ∈ DOr (E, F ) of Heisenberg order at most r and all vector bundles F . Recall that Γ(F ) ⊆
Γ−∞ (F ) denotes the space of continuous sections equipped with the topology of uniform
convergence on compact subsets. We equip Γr (E) with the coarsest topology such that
the maps A : Γr (E) → Γ(F ) are continuous for all A ∈ DOr (E, F ). If r − k ≥ 0, then
each A ∈ DOk (E, F ) induces a continuous operator, A : Γr (E) → Γr−k (F ). Note that we
have continuous inclusions T· · · ⊆ Γ2 (E) ⊆ Γ1 (E) ⊆ Γ0 (E) and topological isomorphisms
Γ0 (E) = Γ(E) as well as r Γr (E) = Γ∞ (E). We will denote the compactly supported
analogue by Γrc (E).
Remark 2.4 (Universal diﬀerential operators). Consider a vector bundle E over M and let
J k E → E denote the bundle of Heisenberg k-jets of sections of E. This is a smooth vector
bundle whose ﬁber over x ∈ M coincides with the vector space of Heisenberg k-jets at x of
sections of E. Recall that two sections ψ1 , ψ2 ∈ Γ∞ (E) are said to represent the same Heisenberg k-jet at x if A(ψ2 −ψ1 )(x) = 0 for all diﬀerential operators A ∈ DOk (E, F ). Assigning to
a section of E its Heisenberg k-jet, we obtain a diﬀerential operator j k : Γ∞ (E) → Γ∞ (J k E).
In fact, j k ∈ DOk (E, J k E), and this diﬀerential operator is universal in the following sense:
For every A ∈ DOk (E, F ) there exists a unique smooth vector bundle homomorphism
α : J k E → F such that A = α ◦ j k . We refer to [41, Section 3.1], [43, Section 1.2.6] or
[42] for details.
A diﬀerential operator A ∈ DOk (E, F ) has a Heisenberg principal cosymbol at each x ∈ M,
σxk (A) ∈ U−k (tx M) ⊗ hom(Ex , Fx ),
where U−k (tx M) denotes the
−k part of the universal enveloping algebra of the
Ldegree
p
graded Lie algebra tx M =
t
M.
More explicitly, U−k (tx M) can be described as the
p x
13

linear subspace of U(tx M) spanned by all elements of the form Xm · · · X1 where Xi ∈ tpxi M
and −k = pm + · · · + p1 . The Heisenberg principal cosymbol provides a short exact sequence

σk
0 → DOk−1(E, F ) → DOk (E, F ) −→ Γ∞ U−k (tM) ⊗ hom(E, F ) → 0
F
where U−k (tM) := x∈M U−k (tx M) is a smooth vector bundle of ﬁnite rank according to the
Poincaré–Birkhoﬀ–Witt theorem. Details may be found in [43, Section 1.2.5].
If A ∈ DOk (E, F ) and B ∈ DOl (F, G) where G is another vector bundle over M, then
σxl+k (BA) = σxl (B)σxk (A)

and

σxk (At ) = σxk (A)t .

(9)

To explain the second equation in (9), we extend − id : tx M → tx M to an anti-automorphism
of U(tx M), X 7→ Xt . Hence, (Xt )t = X and (XY)t = Y t Xt for all X, Y ∈ U(tx M).
This antipode preserves the grading components U−k (tx M). We extend this further to a
transposition U(tx M) ⊗ hom(Ex , Fx ) → U(tx M) ⊗ hom(Fx′ , Ex′ ) characterized by (X ⊗ Φ)t :=
Xt ⊗ Φt ⊗ id|Λ|M,x for all Φ ∈ hom(Ex , Fx ) and X ∈ U(tx M) where Φt ∈ hom(Fx∗ , Ex∗ ) denotes
the linear map dual to Φ. This is the transposition used in σxk (A)t , see (9).
If ∇ is a linear connection on E and X ∈ Γ∞ (T −k M) then ∇X ∈ DOk (E) and

σ k (∇X ) = [X] ⊗ idE ∈ Γ∞ U−k (tM) ⊗ end(E)
(10)
where [X] denotes the section of t−k M = T −k M/T −k+1M represented by X. This property, together with the multiplicativity in (9) and the requirement σ 0 (A) = A for all
A ∈ DO0 (E, F ) = Γ∞ (hom(E, F )) = Γ∞ (U0 (tM) ⊗ hom(E, F )), characterizes the Heisenberg principal symbol uniquely.
Remark 2.5 (Formal adjoints). Suppose A ∈ DOk (E, F ) and let A∗ denote the formal
adjoint with respect to L2 inner products associated with a smooth volume density on M
and smooth ﬁber wise Hermitian inner products hE and hF on the vector bundles E and F ,
respectively, see (6) and (7). Then A∗ ∈ DOk (F, E) and
σxk (A∗ ) = σxk (A)∗ .

(11)

The involution U(tx M) ⊗ hom(Ex , Fx ) → U(tx M) ⊗ hom(Fx , Ex ) used on the right hand side
can be characterized by (X ⊗ Φ)∗ = Xt ⊗ Φ∗ for all Φ ∈ hom(Ex , Fx ) and X ∈ U(tx M) where
Φ∗ ∈ hom(Fx , Ex ) denotes the adjoint of Φ with respect to the inner products hE,x and hF,x .
Equation (11) follows from (8) and (9).
A graded Lie algebra has a natural group of dilation automorphisms. Thus, for λ > 0 we
let δ̇λ ∈ Aut(tM) denote the bundle automorphism given by multiplication with λ−p on the
grading component tp M. For each x ∈ M, this restricts to an automorphism δ̇λ,x ∈ Aut(tx M)
of the osculating algebra such that limλ→0 δ̇λ,x = 0. Clearly, δ̇λ1 λ2 = δ̇λ1 δ̇λ2 for all λ1 , λ2 > 0.
Extending δ̇λ,x to an automorphism of U(tx M), we can characterize the grading by

	
U−k (tx M) = X ∈ U(tx M) : δ̇λ,x (X) = λk X for all λ > 0 .
(12)
We let T M → M denote the bundle of osculating groups. For each x ∈ M, the ﬁber
Tx M is a simply connected nilpotent Lie group, called the osculating group at x, with Lie
algebra tx M. The ﬁber wise exponential map, exp : tM → T M, provides an isomorphism of
smooth ﬁber bundles. The Lie algebra automorphisms δ̇λ,x integrate to group automorphisms
δλ,x ∈ Aut(Tx M) which assemble to a smooth bundle automorphism δλ ∈ Aut(T M) such
that exp ◦δ̇λ = δλ ◦ exp. Clearly, δλ1 λ2 = δλ1 δλ2 , for all λ1 , λ2 > 0.
14

Since the universal enveloping algebra of tx M can be identiﬁed with the algebra of left
invariant diﬀerential operators on Tx M, and in view of (12), the Heisenberg principal symbol
of A ∈ DOk (E, F ) can equivalently be regarded as a left invariant differential operator,
σxk (A) : C ∞ (Tx M, Ex ) → C ∞ (Tx M, Fx ),

(13)

which is homogeneous of degree k, that is,
σxk (A) ◦ lg∗ = lg∗ ◦ σxk (A)

∗
∗
σxk (A) ◦ δλ,x
= λk · δλ,x
◦ σxk (A)

and

(14)

for all g ∈ Tx M and λ > 0. Here lg∗ denotes pull back along the left translation, lg : Tx M →
∗
Tx M, lg (h) := gh, and δλ,x
denotes pull back along the dilation discussed above.
Remark 2.6. If the ﬁltration on M is trivial, that is to say, if T −1 M = T M, then the
ﬁltration on diﬀerential operators is the usual one. In this case Tx M = Tx M is an Abelian
Lie group and the principal symbol σxk (A) of a diﬀerential operator A is a translation invariant
(constant coeﬃcient) diﬀerential operator on Tx M.
2.3. Parametrices. As we have seen above, the Heisenberg principal symbols of a diﬀerential operator can be described by homogeneous left invariant operators on the osculating
Lie groups. This is the primary reason why the osculating groups and their representation
theory, and particularly the Rockland condition, become relevant to the analysis of these
operators. We shall now brieﬂy recall some facts from representation theory necessary to
formulate the Rockland condition for diﬀerential operators, see Deﬁnition 2.7 below, and
state the corresponding Rockland type theorem, see Theorem 2.8.
Let G be a Lie group with Lie algebra g. Suppose π : G → U(H) is a unitary representation
of G on a Hilbert space H. These representations will always be assumed to be strongly
continuous, that is, the map G → H, g 7→ π(g)v, is assumed to be continuous for every
vector v ∈ H. For unitary representations, this is actually equivalent to weak continuity
which only asserts that the function G → C, g 7→ hhπ(g)v, wiiH, is continuous for any two
vectors v, w ∈ H, see [36, Theorem 1 in Appendix V]. Rarely will the representations we
shall encounter be continuous with respect to the norm topology on U(H).
Recall that v ∈ H is called smooth vector if the map G → H, g 7→ π(g)v, is (strongly)
smooth. According to [36, Theorem 3 in Appendix V] this is equivalent to the weak assumption: the function G → C, g 7→ hhπ(g)v, wiiH, is smooth for all vectors w ∈ H. We
will denote the subspace of smooth vectors by H∞ . This is a dense subspace in H which is
invariant under the operators π(g) for all g ∈ G, see [36, Theorem 4(1) in Appendix V]. For
each X ∈ g we may deﬁne, see [36, Theorem 4(2) in Appendix V],

π(X) : H∞ → H∞ ,
π(X)v := ∂  π(exp(tX))v,
∂t t=0

where v ∈ H∞ . By unitarity, hhπ(X)v, wiiH = hhv, π(−X)wiiH for all v, w ∈ H∞ . Hence,
π(X) has a densely deﬁned adjoint, π(X)∗ = π(−X), and, in particular, π(X) is closeable,
see [36, Theorem 4(2) in Appendix V]. Clearly, π([X, Y ]) = π(X)π(Y ) − π(Y )π(X) for any
two X, Y ∈ g. Extending the deﬁnition of π to the universal enveloping algebra of g, we
obtain π(X) : H∞ → H∞ for X ∈ U(g) such that
π(X)π(Y) = π(XY)

(15)

for all X, Y ∈ U(g). We let X 7→ Xt denote the antipode of U(g) obtained by extending
− id : g → g to the universal enveloping algebra. Hence, (Xt )t = X and (XY)t = Y t Xt for
15

all X, Y ∈ U(g). For each X ∈ U(g) we thus have
π(X)∗ = π(Xt )

(16)

as operators on H∞ .
If E0 and F0 are two ﬁnite dimensional vector spaces and a ∈ U(g) ⊗ hom(E0 , F0 ) we let
π(a) : H∞ ⊗ E0 → H∞ ⊗ F0
denote the linear operator obtained by linearly extending the deﬁnition π(X⊗Φ) := π(X)⊗Φ
for all Φ ∈ hom(E0 , F0 ) and X ∈ U(g). Equivalently, using bases of E0 and F0 to identify a
with a matrix with entries in U(g), the operator π(a) corresponds to a matrix of the same
size whose entries are operators on H∞ obtained by applying π to the corresponding entry
of a. The multiplicativity in (15) immediately implies
π(ba) = π(b)π(a)

(17)

for all a ∈ U(g) ⊗ hom(E0 , F0 ) and b ∈ U(g) ⊗ hom(F0 , G0 ) where G0 is another ﬁnite dimensional vector space. If, moreover, E0 and F0 are equipped with Hermitian inner products,
then (16) leads to
π(a)∗ = π(a∗ )
(18)
as operators H∞ ⊗ F0 → H∞ ⊗ E0 . Here the adjoint on the left hand side of (18) is with
respect to the inner products on H∞ ⊗ E0 and H∞ ⊗ F0 induced by inner products on
E0 and F0 and the restriction of the inner product on H. On the right hand side of (18),
a∗ ∈ U(g)⊗hom(F0 , E0 ) is deﬁned by linear extension of (X⊗Φ)∗ := Xt ⊗Φ∗ for all X ∈ U(g)
and Φ ∈ hom(E0 , F0 ) where Φ∗ ∈ hom(F0 , E0 ) denotes the adjoint of Φ. Equivalently, using
orthogonal bases of E0 and F0 to identify a with a matrix with entries in U(g), a∗ corresponds
to the matrix obtained by taking the transpose conjugate of a and applying the antipode
X 7→ Xt to each entry.
Definition 2.7 (Rockland condition). Let E and F be vector bundles over a ﬁltered manifold
M. A diﬀerential operator A ∈ DOk (E, F ) of Heisenberg order at most k is said to satisfy
the Rockland condition if π(σxk (A)) : H∞ ⊗ Ex → H∞ ⊗ Fx is injective for every point x ∈ M
and every non-trivial irreducible unitary representation π : Tx M → U(H) of the osculating
group Tx M on a Hilbert space H. Here H∞ denotes the subspace of smooth vectors in H.
In Section 3 below we will prove the following Rockland [50] type result:
Theorem 2.8 (Left parametrix). Let E and F be vector bundles over a filtered manifold M
and suppose A ∈ DOk (E, F ) is a differential operator of Heisenberg order at most k which
satisfies the Rockland condition, see Definition 2.7. Then there exists a properly supported
left parametrix B ∈ Oprop (F, E) such that BA − id is a smoothing operator.
Actually, we will show that the parametrix in the preceding theorem has order −k in
van Erp and Yuncken’s [62] pseudodiﬀerential calculus, see Theorem 3.13 below. This will
allow us to reﬁne the subsequent hypoellipticity statements, see Section 3.5.
Remark 2.9. Let us point out that several special cases of this result are well know. To begin
with, for trivially ﬁltered manifolds, i.e., T M = T −1 M, this reduces to the classical, elliptic
case. In this situation all irreducible unitary representations of the (abelian) osculating group
are one dimensional, and the Rockland condition at x ∈ M becomes the familiar condition
that the principal symbol of the operator is invertible at every 0 6= ξ ∈ Tx∗ M.
16

Another well studied class are the contact and (more generally) Heisenberg manifolds.
For Heisenberg manifolds, a pseudodiﬀerential calculus has been developed independently by
Beals–Greiner [2] and Taylor [58], see also [46]. Special cases of Theorem 2.8 for Heisenberg
manifolds can be found in [2, Theorem 8.4] or [46, Theorem 5.4.1]. These investigations can
be traced back to the work of Kohn [37], Boutet de Monvel [4], and Folland–Stein [27] on
CR manifolds. For more historical comments we refer to the Introduction of [2].
If the ﬁltration on M is locally diﬀeomorphic to that on a graded nilpotent Lie group,
then the scalar version of Theorem 2.8 can be found in [18, Theorem 2.5(d)]. This suﬃces
to study the ﬂat models in parabolic geometry given by the homogeneous spaces G/P , as
well as topologically stable [47] structures like contact and Engel manifolds.
Corollary 2.10 (Hypoellipticity). Let E and F be vector bundles over a filtered manifold M
and suppose A ∈ DOk (E, F ) is a differential operator of Heisenberg order at most k which
satisfies the Rockland condition. Then A is hypoelliptic, that is, if ψ is a compactly supported
distributional section of E and Aψ is smooth, then ψ was smooth. If, moreover, M is closed,
then ker(A) is a finite dimensional subspace of Γ∞ (E).
Proof. Let B ∈ Oprop (F, E) be a left parametrix as in Theorem 2.8. Hence, BA − id is a
smoothing operator and BAψ − ψ is a smooth section of E. Moreover, BAψ is a smooth,
for B maps smooth sections to smooth sections. Consequently, ψ is a smooth section of E.
Assume M to be closed. By hypoellipticity, ker(A) ⊆ Γ∞ (E) ⊆ L2 (E). Since BA − id
is a smoothing operator, the identical map on ker(A) coincides with the restriction of a
smoothing operator. The latter induces a compact operator on L2 (E) according to the
theorem of Arzelà–Ascoli. Hence, every bounded subset of ker(A) is precompact in L2 (E).
Consequently, ker(A) has to be ﬁnite dimensional.

Corollary 2.11 (Hodge decomposition). Let E be a vector bundle over a closed filtered manifold M. Suppose A ∈ DOk (E) satisfies the Rockland condition and is formally selfadjoint,
A∗ = A, with respect to an L2 inner product of the form (6). Moreover, let Q denote the
orthogonal projection onto the (finite dimensional) subspace ker(A) ⊆ Γ∞ (E). Then A+Q is
invertible with inverse (A + Q)−1 ∈ O(E). Consequently, we have topological isomorphisms
and Hodge type decompositions:
∼
=

Γ∞ (E) = ker(A) ⊕ A(Γ∞ (E)),

∼
=

Γ−∞ (E) = ker(A) ⊕ A(Γ−∞ (E)).

→ Γ∞ (E),
A + Q : Γ∞ (E) −
A + Q : Γ−∞ (E) −
→ Γ−∞ (E),

Proof. According to Theorem 2.8 there exists B ∈ O(E) such that BA − id is a smoothing
operator. Since A is formally selfadjoint, AB ∗ −id is a smoothing operator too. We conclude
that B and B ∗ diﬀer by a smoothing operator. Hence P ∗ = P := 21 (B + B ∗ ) ∈ O(E) is a
formally selfadjoint parametrix such that P A−id and AP −id are both smoothing operators.
Note that Q = Q∗ , the orthogonal projection onto ker(A), is a smoothing operator. In
particular, A + Q is hypoelliptic. Moreover, ker(A + Q) = 0 in view of A∗ = A. Since
AP − id is a smoothing operator, arguing as in the proof of Corollary 2.10 shows that P is
hypoelliptic and ker(P ) is a ﬁnite dimensional subspace of Γ∞ (E). Adding the orthogonal
projection onto ker(P ) to P = P ∗, we may furthermore assume ker(P ) = 0.
Consider G := (A + Q)P ∈ O(E). Since G − id is a smoothing operator, it induces a
s
compact operator on every classical Sobolev space Hclassical
(E). Hence, G induces a Fredholm
s
operator with vanishing index on Hclassical (E) for all real numbers s. By construction, G
17

s
is injective, whence invertible with bounded inverse on Hclassical
(E). Using the classical
Sobolev embedding theorem, we conclude that G is invertible on Γ∞ (E) with continuous
inverse, G−1 : Γ∞ (E) → Γ∞ (E). Using G∗ = P (A + Q), the same argument shows that G∗ is
invertible on Γ∞ (E) with continuous inverse, (G∗ )−1 : Γ∞ (E) → Γ∞ (E). Since (G∗ )−1 is the
formal adjoint of G−1 , we conclude that G−1 extends continuously to distributional sections,
G−1 : Γ−∞ (E) → Γ−∞ (E). Thus, according to the Schwartz kernel theorem, G−1 is given
by a (distributional) kernel we will denote by G−1 too. The obvious relation G−1 − id =
−(G −id)G−1 implies that G−1 −id is a smoothing operator and, consequently, G−1 ∈ O(E).
We conclude (A + Q)−1 = P G−1 ∈ O(E). The remaining assertions follow at once.


Corollary 2.12. Let E and F be a vector bundle over a closed filtered manifold M. Suppose
A ∈ DOk (E, F ) satisfies the Rockland condition, and let A∗ ∈ DOk (F, E) denote the formal
adjoint with respect to L2 inner products of the form (6). Then
Γ∞ (E) = ker(A) ⊕ A∗ (Γ∞ (F ))

and

Γ−∞ (E) = ker(A) ⊕ A∗ (Γ−∞ (F )).

Proof. In view of (9), (11), (17), and (18), the operator A∗ A ∈ DO2k (E) satisﬁes the Rockland condition. Now apply Corollary 2.11 to this operator, and use ker(A∗ A) = ker(A). 
Corollary 2.13 (Pseudo inverse). Let E and F be smooth vector bundles over a closed
filtered manifold M, consider A ∈ DOk (E, F ), and let A∗ ∈ DOk (F, E) denote the formal
adjoint with respect to L2 inner products of the form (6). Assume A and A∗ both satisfy
the Rockland condition. Moreover, let Q denote the orthogonal projection onto the (finite
dimensional) subspace ker(A) ⊆ Γ∞ (E), and let P denote the orthogonal projection onto the
(finite dimensional) subspace ker(A∗ ) ⊆ Γ∞ (F ). Then the pseudo inverse,
A+ := (A∗ A + Q)−1 A∗ = A∗ (AA∗ + P )−1 ,
uniquely characterized by the relations
AA+ = id −P,

A+ A = id −Q,

A+ P = 0 = QA+ ,

and

satisfies A+ ∈ O(F, E).
2.4. Rockland sequences. Let us now generalize the concept of elliptic sequences of differential operators to ﬁltered manifolds. In subsequent sections we will generalize further to
the graded setup, see Deﬁnition 4.2, and pseudodiﬀerential operators, see Deﬁnition 5.7.
Definition 2.14 (Rockland sequences of diﬀerential operators). Let Ei be smooth vector
bundles over a ﬁltered manifold M. A sequence of diﬀerential operators,
Ai−1

A

i
Γ∞ (Ei+1 ) → · · · ,
· · · → Γ∞ (Ei−1 ) −−−→ Γ∞ (Ei ) −→

(19)

with Ai ∈ DOki (Ei , Ei+1 ), is called Rockland sequence if for every x ∈ M and every nontrivial irreducible unitary representation of the osculating group, π : Tx M → U(H), the
sequence
k

k

π(σxi−1 (Ai−1 ))

π(σxi (Ai ))

· · · → H∞ ⊗ Ei−1,x −−−−−−−−−→ H∞ ⊗ Ei,x −−−−−−→ H∞ ⊗ Ei+1,x → · · ·

(20)

is weakly exact, i.e., the image of the left arrow is contained and dense in the kernel of the
right arrow. Here H∞ denotes the subspace of smooth vectors in the Hilbert space H.
18

Remark 2.15. For every Rockland sequence of diﬀerential operators, the sequence (20) is
actually exact in the strict (algebraic) sense. Indeed, this follows from Lemma 2.18 and
Remark 3.19 below.
Remark 2.16. If a sequence of diﬀerential operators as in (19) is a Rockland sequence, then
so are the transposed sequence,
Ati−1

At

′
′
) ← ··· ,
· · · ← Γ∞ (Ei−1
) ←−−− Γ∞ (Ei′ ) ←−i Γ∞ (Ei+1

and the sequence of formal adjoints with respect to L2 inner products of the form (6).
Remark 2.17. Consider the case Ei = 0 for all i 6= 1, 2. In other words, consider a sequence
with a single diﬀerential operator of Heisenberg order at most k1 ,
A

1
0 → Γ∞ (E1 ) −→
Γ∞ (E2 ) → 0.

Such a sequence is hypoelliptic in the sense of Deﬁnition 2.14 iﬀ, for all points x ∈ M,
π(σxk1 (A1 )) : H∞ ⊗ E1,x → H∞ ⊗ E2,x
is injective with dense image for all non-trivial irreducible unitary representations π : Tx M →
U(H). Equivalently, A1 and At1 both satisfy the Rockland condition, see Deﬁnition 2.7.
Consider a Rockland sequence of diﬀerential operators as in (19). To study this sequence
we shall introduce certain additional structures and operators in analogy with the standard
elliptic sequences. Fix a smooth volume density dx on M, let hi be smooth ﬁber wise
Hermitian inner products on Ei , and consider the associated L2 inner products on Γ∞
c (Ei ),
Z
hhψ1 , ψ2 iiL2 (Ei ) =
hi (ψ1 (x), ψ2 (x))dx = h(hi ⊗ dx)ψ1 , ψ2 i
(21)
M

∗
ki
where ψ1 , ψ2 ∈ Γ∞
c (Ei ). Moreover, let Ai ∈ DO (Ei+1 , Ei ) denote the corresponding formal
∗
∞
adjoint, that is, hhAi φ, ψiiL2 (Ei ) = hhφ, Ai ψiiL2 (Ei+1 ) for ψ ∈ Γ∞
c (Ei ) and φ ∈ Γc (Ei+1 ).
Assume ki ≥ 1, choose positive integers ai such that

ki−1 ai−1 = ki ai =: κ,

(22)

and consider the diﬀerential operator ∆i ∈ DO2κ (Ei ),
∆i := (Ai−1 A∗i−1 )ai−1 + (A∗i Ai )ai .

(23)

We will refer to these operators as Rumin–Seshadri operators since they generalize the fourth
order Laplacians associated with the Rumin complex in [55, Section 2.3].
Lemma 2.18. The Rumin–Seshadri operators satisfy the Rockland condition.
Proof. Consider x ∈ M and let π : Tx M → U(H) be a non-trivial irreducible unitary representation. We equip H∞ ⊗ Ei,x with the Hermitian inner product provided by the restriction
of the scalar product of the Hilbert space H and the inner product hi,x on Ei,x . Using (9),
(11), (17) and (18), we obtain:
∗
π(σxκ (∆i ))) = (Bi−1 Bi−1
)ai−1 + (Bi∗ Bi )ai

19

where we abbreviate Bi := π(σxki (Ai )) : H∞ ⊗ Ei,x → H∞ ⊗ Ei+1,x and we are consider
Bi∗ = π(σxki (A∗i )) : H∞ ⊗ Ei+1,x → H∞ ⊗ Ei,x . Due to positivity,


∗
ker(π(σx2κ (∆i ))) = ker (Bi−1 Bi−1
)ai−1 ∩ ker (Bi∗ Bi )ai ,

∗
∗
ker (Bi−1 Bi−1
)ai−1 = ker(Bi−1
), and

ker (Bi∗ Bi )ai = ker(Bi ).

∗
Since Ai is a Rockland sequence, we also have ker(Bi ) ⊆ img(Bi−1 ) ⊥ ker(Bi−1
) and
∗
thus ker(Bi ) ∩ ker(Bi−1
) = 0. Combining this with the preceding equalities, we obtain
ker(π(σx2κ (∆i ))) = 0, i.e., ∆i satisﬁes the Rockland condition.


Combining Corollary 2.10 and Lemma 2.18 we see that each Rumin–Seshadri operator is
hypoelliptic, that is, if ψ is a distributional section of Ei and ∆i ψ is smooth, then ψ was
smooth. For Rockland sequences this immediately implies:
Corollary 2.19. The differential operator (A∗i−1 , Ai ) : Γ∞ (Ei ) → Γ∞ (Ei−1 ⊕ Ei+1 ) is hypoelliptic, that is, if ψ is a distributional section of Ei such that A∗i−1 ψ and Ai ψ are both smooth,
then ψ was smooth. Moreover,
∗
ker(∆i |Γ−∞
(Ei ) ) = ker(Ai−1 |Γ−∞
(Ei ) ) ∩ ker(Ai |Γ−∞
(Ei ) )
c
c
c

= ker(A∗i−1 |Γ∞
) ∩ ker(Ai |Γ∞
). (24)
c (Ei )
c (Ei )
Over closed manifolds Corollary 2.11 applies to ∆i = ∆∗i , hence ker(∆i ) is a ﬁnite dimensional subspace of Γ∞ (Ei ), and we get Hodge type decompositions as in Corollary 2.11 for
the Rumin–Seshadri operators. For Rockland complexes over closed manifolds this implies:
Corollary 2.20. If M is closed and Ai Ai−1 = 0, then we have Hodge type decompositions
Γ∞ (Ei ) = Ai−1 (Γ∞ (Ei−1 )) ⊕ ker(∆i ) ⊕ A∗i (Γ∞ (Ei+1 )),
Γ−∞ (Ei ) = Ai−1 (Γ−∞ (Ei−1 )) ⊕ ker(∆i ) ⊕ A∗i (Γ−∞ (Ei+1 )),
and
ker(Ai |Γ∞ (Ei ) ) = Ai−1 (Γ∞ (Ei−1 )) ⊕ ker(∆i ),
ker(Ai |Γ−∞ (Ei ) ) = Ai−1 (Γ−∞ (Ei−1 )) ⊕ ker(∆i ).
In particular, every cohomology class admits a unique harmonic representative:
ker(Ai |Γ−∞ (Ei ) )
ker(Ai |Γ∞ (Ei ) )
=
= ker(∆i ) = ker(A∗i−1 ) ∩ ker(Ai ).
img(Ai−1 |Γ−∞ (Ei−1 ) )
img(Ai−1 |Γ∞ (Ei−1 ) )
In the subsequent section these regularity statements will be reﬁned by maximal hypoelliptic estimates. We postpone these more elaborate results because their formulation requires
a pseudodiﬀerential calculus for ﬁltered manifolds.
3. Pseudodifferential operators on filtered manifolds
The aim of this section is to prove Theorem 2.8 above which lies at the core of the
hypoellipticity results discussed in Sections 2.3 and 2.4. The proof we will give relies on
the pseudodiﬀerential calculus for ﬁltered manifolds that has recently been developed by
van Erp and Yuncken, see [62, 63]. Their calculus has only been formulated for scalar
valued operators, but can readily be extended to pseudodiﬀerential operators acting between
20

sections of vector bundles, see Proposition 3.4. Combining this with harmonic analysis due
to Christ, Geller, Glowacki and Polin [18], and using arguments of Ponge [46], we obtain a
Rockland type theorem for general ﬁltered manifolds, see Theorem 3.13 below. In Section 3.5
we use this calculus to introduce a Heisenberg Sobolev scale, see Proposition 3.21, and
improve upon Corollaries 2.19 and 2.20 by establishing maximal hypoelliptic estimates, see
Corollaries 3.29 and 3.30 below.
3.1. Smooth groupoids. Van Erp and Yuncken’s pseudodiﬀerential calculus [62] has been
formulated using the notion of smooth groupoids. In this section we set up our notations for
groupoids and discuss vector bundle valued distributional kernels whose wave front set are
conormal to the space of units. These kernels can be transposed and convolved. They give
rise to a convenient small class of right invariant vertical operators containing smoothing
operators and diﬀerential operators.
Suppose G is a smooth groupoid [49]. Let G (0) denote the set of objects or units, let G (1)
the set of arrows, and let ι : G (0) → G (1) denote the inclusion of the objects as identical
morphisms. Moreover, σ : G (1) → G (0) and τ : G (1) → G (0) denote source and target map,
respectively, G (2) := {(g, h) ∈ G (1) × G (1) : σ(g) = τ (h)} denotes the set of composeable
pairs, µ : G (2) → G (1) denotes the multiplication, and ν : G (1) → G (1) denotes the inversion.
These maps are subject to the relations: σ ◦ ι = id = τ ◦ ι, σ ◦ µ = σ ◦ pr2 , τ ◦ µ = τ ◦ pr1 ,
µ ◦ (id, ι ◦ σ) = id = µ ◦ (ι ◦ τ, id) µ ◦ (µ, id) = µ ◦ (id, µ), σ ◦ ν = τ , τ ◦ ν = σ, µ ◦ (id, ν) = ι ◦ τ ,
and µ ◦ (ν, id) = ι ◦ σ.
The smoothness of the groupoid implies that G (0) and G (1) are smooth manifolds; ι is
a closed embedding; σ and τ are surjective submersions; G (2) is a closed submanifold of
G (1) × G (1) ; ν is an involutive diﬀeomorphisms, ν 2 = id, which ﬁxes the units, ν ◦ ι = ι.
Moreover, Gx := σ −1 (x) and G x := τ −1 (x) are closed submanifolds of G (1) for all x ∈ G (0) ; left
multiplication µg := µ(g, −) with a g ∈ G (1) provides diﬀeomorphisms µg : G σ(g) → G τ (g) with
g
inverse µ−1
g = µν(g) ; and right multiplication µ := µ(−, g) : Gτ (g) → Gσ(g) is a diﬀeomorphism
with inverse (µg )−1 = µν(g) . We will denote the restriction of τ to Gx by τx : Gx → G (0) .
We let Ωσ denote the (trivializable) line bundle over G (1) obtained by applying the representation | det−1 | of the general linear group to the vertical bundle ker(T σ) of the submersion
σ. Analogously, we let Ωτ denote the density bundle of the vertical bundle ker(T τ ). Note
that the restriction of Ωσ to the submanifold Gx identiﬁes canonically with the bundle of
volume densities on Gx , and similarly for Ωτ , that is:
Ωσ |Gx = |Λ|Gx

and

Ωτ |G x = |Λ|G x .

(25)

Right and left multiplication provide canonical isomorphisms of vector bundles ker(T σ) =
τ ∗ ι∗ ker(T σ) and ker(T τ ) = σ ∗ ι∗ ker(T τ ) which give rise to canonical isomorphisms of line
bundles
τ ∗ ι∗ Ωσ = Ωσ
and
σ ∗ ι∗ Ωτ = Ωτ .
(26)
Moreover, the inversion induces canonical isomorphisms ν ∗ ker(T σ) = ker(T τ ), ν ∗ ker(T τ ) =
ker(T σ), and ι∗ ker(T σ) = ι∗ ker(T τ ) which in turn induce canonical isomorphisms of line
bundles:
ν ∗ Ωσ = Ωτ ,
ν ∗ Ωτ = Ωσ ,
and
ι∗ Ωσ = ι∗ Ωτ .
(27)
Definition 3.1. For every smooth groupoid G and any two vector bundles E
 and F over
G (0) we let K(G; E, F ) denote the space of all k ∈ Γ−∞ hom(σ ∗ E, τ ∗ F ) ⊗ Ωτ whose wave
21

front set is contained in the conormal of the embedding ι : G (0) → G (1) . In particular, these k
are assumed to be smooth on G (1) \ ι(G (0) ). We also introduce the notation K∞ (G; E, F ) :=
Γ∞ hom(σ ∗ E, τ ∗ F ) ⊗ Ωτ for the subspace of smooth kernels. A kernel k ∈ K(G; E, F ) is
called properly supported if σ and τ both restrict to proper maps on the support of k.
The (left) regular representation of k ∈ K(G; E, F ) at x ∈ G (0) is the continuous operator
∗
∞ ∗
Opkx : Γ∞
c (τx E) → Γ (τx F ),

deﬁned by
(k ∗ ψ)(g) :=

Z

h∈Gx
∞ ∗
Γc (τx E)

Opkx (ψ) := k ∗ ψ,

k(gh−1 )ψ(h) := h(µg ◦ ν)|∗Gx k τ (g) , ψi

(28)

(29)

where k ∈ K(G; E, F ), ψ ∈
and g ∈ Gx . To explain the second expression above,
recall that conormality permits to regard k as a family of distributions k y on G y which depend
smoothly on y ∈ G (0) , see [39]. Restricting k to G τ (g) , pulling back along the diﬀeomorphisms
(µg ◦ ν)|Gx : Gx → G x → G τ (g) , (µg ◦ ν)(h) := µ(g, ν(h)), and using the canonical isomorphism
of lines (µg ◦ ν)|∗Gx Ωτ = |Λ|Gx , see (25) and
 (27), we obtain a family of distributions (µg ◦
τ (g)
−∞
∗
∗
∈Γ
hom(τx E, Fτ (g) ) ⊗ |Λ|Gx which depend smoothly on g ∈ Gx . The brackets
ν)|Gx k
on the right hand side in (29) denote the canonical pairing

∗
Γ−∞ hom(τx∗ E, Fτ (g) ) ⊗ |Λ|Gx × Γ∞
c (τx E) → Fτ (g) .

∗
∞ ∗
Note that if k is σ-proper then we obtain a continuous operator Opkx : Γ∞
c (τx E) → Γc (τx F );
k
and if k is τ -proper then the same expression deﬁnes a continuous operator Opx : Γ∞ (τx∗ E) →
Γ∞ (τx∗ F ).
Note that the left regular representation is right invariant, that is, the following diagram
commutes, for all k ∈ K(G; E, F ) and g ∈ G (1) :
∗
Γ∞
c (τσ(g) E)

Opkσ(g)

∗
Γ∞ (τσ(g)
F)

/

∼
= (µg )∗

(µg )∗ ∼
=


∗
Γ∞
c (ττ (g) E)

Opkτ (g)

(30)

/



Γ∞ (ττ∗(g) F )

Here µg : Gτ (g) → Gσ(g) denotes the diﬀeomorphism given by right multiplication, µg (h) :=
µ(h, g), which, in view of the relation τ ◦ µg = τ , provides isomorphisms (µg )∗ as indicated
in the diagram above.
Rather than considering k as a right invariant family of operators Opkx depending smoothly
on x ∈ G (0) , one can alternatively think of k as representing a continuous operator
∗
∞ ∗
Opk : Γ∞
σ-prop (τ E) → Γ (τ F ).

This operator is σ-vertical in the sense that it commutes with functions in the image of the
homomorphism σ ∗ : C ∞ (G (0) ) → C ∞ (G (1) ).
Let us next describe the transpose of a kernel in K(G; E, F ). For every vector bundle E over
(0)
G we let E ′ := E ∗ ⊗ι∗ Ωσ where E ∗ denotes the dual bundle. Note that we have a canonical
isomorphism E ′′ = E since the line bundle Ω∗σ ⊗ Ωσ admits a canonical trivialization. If
k ∈ K(G; E, F ) the transposed kernel, k t ∈ K(G; F ′ , E ′ ), is deﬁned by k t (g) := k(g −1)t . More
precisely, pulling with the inversion and using the canonical isomorphisms ν ∗ σ ∗ E = τ ∗ E,
22


ν ∗ τ ∗ F = σ ∗ F , ν ∗ Ωτ = Ωσ we obtain ν ∗ k ∈ Γ−∞ hom(τ ∗ E, σ ∗ F ) ⊗ Ωσ . Applying the vector
bundle isomorphism
t

hom(τ ∗ E, σ ∗ F ) ⊗ Ωσ −
→ hom(σ ∗ F ∗ , τ ∗ E ∗ ) ⊗ Ωσ = hom(σ ∗ F ′ , τ ∗ E ′ ) ⊗ Ωτ

obtained from ﬁber wise transposition and the canonical isomorphism of lines
Ωσ = σ ∗ ι∗ Ω∗σ ⊗

τ ∗ ι∗ Ωσ ⊗ Ωτ , see (26) and (27), we obtain k t ∈ Γ−∞ hom(σ ∗ F ′ , τ ∗ E ′ ) ⊗ Ωτ . Since ν ◦ ι = ι,
the wave front set of k t is contained in the conormal of the embedding ι and thus k t ∈
K(G; F ′ , E ′ ). Note that k t is properly supported iﬀ k is. Clearly, (k t )t = k up to the
canonical isomorphisms E ′′ = E and F ′′ = F . Moreover, this transposition maps smooth
kernels to smooth kernels.
The transpose kernel corresponds to the transposed operator and allows the extension
of the regular representation to distributions. We shall provide a short description here.
Using the canonical identiﬁcation τx∗ ι∗ Ωσ = |Λ|Gx , see (25) and (26), we obtain isomorphisms
kt
∗ ′
∗
∞ ∗ ′
D(τx∗ F ) = Γ∞
c (τx F ) and E(τx E) = Γ (τx E ). Hence, Opx can be regarded as operator
Opk

t

∗ ′
D(τx∗ F ) = Γ∞
−−x→ Γ∞ (τx∗ E ′ ) = E(τx∗ E)
c (τx F ) −

(31)

kt

∗
∗
satisfying hφ, Opkx (ψ)i = hOpx (φ), ψi for all ψ ∈ Γ∞
c (τx E) and φ ∈ D(τx F ). This permits
to extend the regular representation, see (29), to distributional sections,
t

hφ, Opkx (ψ)i := hOpkx (φ), ψi,

∗
−∞ ∗
(τx F ),
Opkx : Γ−∞
c (τx E) → Γ

(32)

∗
∗
where ψ ∈ Γ−∞
c (τx E) and φ ∈ D(τx F ). This extension is pseudolocal, that is,

sing-supp(Opkx (ψ)) ⊆ sing-supp(ψ)

(33)

∞
∗
for all ψ ∈ Γ−∞
c (τx E). For smooth kernels, k ∈ K (G; E, F ), we obtain continuous (smooth∞ ∗
∗
ing) operators Opkx : Γ−∞
c (τx E) → Γ (τx F ). If k is properly supported then the operator in
(31) extends to a continuous operator E(τx∗ F ) → E(τx∗ E) and corestricts to a continuous operator D(τx∗ F ) → D(τx∗ E). Consequently, a properly supported kernel, k ∈ Kprop (G; E, F ), pro∗
−∞ ∗
vides continuous operators Opkx : Γ−∞ (τx∗ E) → Γ−∞ (τx∗ F ) and Opkx : Γ−∞
c (τx E) → Γc (τx F ).
Let us now move to the convolution product of the kernels. Suppose k ∈ K(G; E, F ) and
l ∈ K(G; F, G) where G is another vector bundle over G (0) . If at least one of k or l is properly
supported, then one can deﬁne a convolution product l ∗ k ∈ K(G; E, G) such that

Oplx ◦ Opkx = Opl∗k
x

(34)

for all x ∈ G (0) . To see this note that there is a canonical isomorphism of vector bundles
(hom(σ ∗ E, τ ∗ F ) ⊗ Ωτ )|Gx = τx∗ F ⊗ Ex′ , see (26). Hence, the conormality property permits
to regard k as a family of distributions kx ∈ Γ−∞ (τx∗ F ) ⊗ Ex′ on Gx depending smoothly
on x ∈ G (0) . Using the extension of Oplx to distributions, we deﬁne (l ∗ k)x := Oplx (kx ) ∈
Γ−∞ (τx∗ G) ⊗ Ex′ . Note that this is well deﬁned if k or l is properly supported: If k has proper
support then kx is compactly supported and we can apply Oplx ; if l has proper support then
Oplx can be applied to distributions with arbitrary support. Note that (l ∗k)x is smooth away
from ι(x) since kx is smooth away from ι(x) and Oplx is pseudolocal, see (33). Moreover,
(l ∗ k)x depends smoothly on x since kx depends smoothly on x and the family of operators
(32) depends smoothly on x too. We conclude that the family (l ∗ k)x , x ∈ G (0) , deﬁnes
a kernel l ∗ k ∈ K(G; E, G). If k and l are both properly supported, then so is l ∗ k. If k
or l is smooth, then so is l ∗ k. It is straight forward to check (34). Associativity of the
23

convolution follows immediately from (34) since k is completely determined by the collections
of operators Opkx , x ∈ G (0) . Analogously, we obtain
(l ∗ k)t = k t ∗ lt
provide at least one of k or l has proper support.
Let us denote the space of complete cosymbols by
Σ(G; E, F ) :=

Kprop (G; E, F )
K(G; E, F )
= ∞
.
∞
Kprop (G; E, F )
K (G; E, F )

∞
To see the canonical identiﬁcation on the right hand side, choose χ ∈ Cprop
(G (1) ) such
that χ ≡ 1 in a neighborhood of ι(G (0) ). For each k ∈ K(G; E, F ) we thus obtain χk ∈
Kprop (G; E, F ) and χk − k ∈ K∞ (G; E, F ). The convolution product induces an associative
multiplication and a compatible transposition,
∗

Σ(G; E, F ) × Σ(G; F, G) −
→ Σ(G; E, G),

t

Σ(G; E, F ) −
→ Σ(G; F ′ , E ′ ).

To discuss differential operators, let KG (0) (G; E, F ) denote the space of all kernels in k ∈
K(G; E, F ) which are supported on the space of units, supp(k) ⊆ ι(G (0) ). This class of
kernels is invariant under convolution and transposition. The regular representation Opkx
of such a kernel is a diﬀerential operator with smooth coeﬃcients. Every family of right
invariant diﬀerential operators depending smoothly on x ∈ G (0) can be obtained in this way.
Equivalently, we have a canonical isomorphism, see [62, Proposition 84] for the scalar valued
case,
(35)
DOσ (G; τ ∗ E, τ ∗ F )G = KG (0) (G; E, F )
where the left hand side denotes the space of all diﬀerential operators Γ∞ (τ ∗ E) → Γ∞ (τ ∗ F )
on G (1) which are σ-vertical, that is, commute with multiplication by functions in the image
of the homomorphism σ ∗ : C ∞ (G (0) ) → C ∞ (G (1) ), and which are right invariant, cf. (30).
Let us describe these diﬀerential operators more explicitly. There is the obvious inclusion
Γ∞ (hom(E, F )) ⊆ DOσ (G; τ ∗ E, τ ∗ F )G .

(36)

Next, by restriction to the space of units, one obtains an isomorphism of Lie algebras
Xσ (G)G = Γ∞ (AG).

(37)

Here AG := ι∗ ker(T σ) denotes the vector bundle underlying the Lie algebroid of G, and
in the left hand side Xσ (G)G denotes the Lie algebra of σ-vertical vector ﬁelds on G which
are right invariant. A vector ﬁeld is called σ-vertical if it is a section of ker(T σ) ⊆ T G,
equivalently, if it is tangential to the submanifolds Gx .
Every linear connection on E pulls back to a right invariant connection τ ∗ ∇ on τ ∗ E and
provides an injective linear map
∇

Γ∞ (AG) −
→ DOσ (G; τ ∗ E, τ ∗ E)G ,

X 7→ (τ ∗ ∇)X̃ ,

(38)

where X̃ ∈ Xσ (G)G denotes the right invariant extension of X ∈ Γ∞ (AG), see (37). Locally,
every right invariant σ-vertical diﬀerential operator can be written as a composition of operators of the form (36) and (38). More precise algebraic descriptions in terms of universal
enveloping algebras can be found in [45, Theorem 3] or [62, Section 7.1].
24

3.2. Groupoids on filtered manifolds. Let us now discuss four groupoids that play an
important role in van Erp and Yuncken’s pseudodiﬀerential calculus: the pair groupoid, the
osculating groupoid, the individual osculating groups, and the Heisenberg tangent groupoid.
For every smooth manifold M the pair groupoid has objects G (0) = M, arrows G (1) =
M × M, units ι(x) = (x, x), source map σ(x, y) = y, target map τ (x, y) = x, multiplication
µ((x, y), (y, z)) = (x, z) and inversion ν(x, y) = (y, x), where x, y, z ∈ G (0) = M. For any
two x, y ∈ G (0) there exists a unique g ∈ G (1) such that τ (g) = x and σ(g) = y. For any two
vector bundles E and F over G (0) = M this provides a canonical isomorphism identifying the
regular representation at x with the regular representation at y, see (30). More explicitly,
τx : Gx → G (0) = M is a diﬀeomorphism which identiﬁes all the operators Opkx with a single
∞
(0)
operator Opk : Γ∞
:
c (E) → Γ (F ) such that the following diagram commutes for all x ∈ G
Γ∞
c (E)

Opk

/

Γ∞ (F )

τx∗ ∼
=


∗
Γ∞
c (τx E)

∼
= τx∗
Opkx

(39)



Γ∞ (τx∗ F )
/

For the pair groupoid the kernels K(M × M; E, F ) introduced in the preceding section, see
Deﬁnition 3.1, correspond precisely to operators in the class O(E, F ) with composition and
transposition of operators as discussed in Section 2.1. The kernels which are supported on
the space of units correspond precisely to DO(E, F ), the space of diﬀerential operators with
smooth coeﬃcients.
For every ﬁltered manifold M the bundle of osculating groups π : T M → M is a bundle
of (nilpotent) Lie groups and gives rise to osculating groupoid with objects G (0) = M and
arrows G (1) = T M. In this case σ = π = τ and ι : M → T M is the zero section, assigning
the neutral element in the group Tx M to x ∈ M. Two arrows g and h are composeable
iﬀ they lie in the same ﬁber, g, h ∈ Tx M say, and µ(g, h) is given by multiplication in the
group Tx M. If E and F are two vector bundles over M, then the regular representation of
k ∈ K(T M; E, F ) at x ∈ M identiﬁes to a right invariant operator on the group Tx M with
matrix valued convolution kernel k x ∈ Γ−∞ (|Λ|Tx M ) ⊗ hom(Ex , Fx ):
Cc∞ (Tx M, Ex )

k x ∗−

/

C ∞ (Tx M, Fx )
(40)

∗
Γ∞
c (τx E)

Opkx

/

Γ∞ (τx∗ F )

The kernels which are supported on the space of units correspond precisely to the space of
diﬀerential operators Γ∞ (π ∗ E) → Γ∞ (π ∗ F ) which are vertical, i.e. commute with functions
in the image of the homomorphism π ∗ : C ∞ (M) → C ∞ (T M), and restrict to right invariant
operators on each ﬁber Tx M.
Each osculating group Tx M can be considered as a groupoid, and the inclusion Tx M ⊆ T M
is a map of groupoids. Correspondingly, restriction provides a map
ev∗x : K(T M; E, F ) → K(Tx M; Ex , Fx )
which is compatible with composition and transposition.
25

(41)

For each λ > 0, the scaling automorphism δλ : T M → T M is an automorphisms of
groupoids. It induces an action on K(T M; E, F ) such that
(δx,λ )∗ ◦ Opkx = Opx(δλ )∗ k ◦(δx,λ)∗
for all x ∈ G (0) where (δx,λ )∗ denotes the action on Cc∞ (Tx M, Ex ) and C ∞ (Tx M, Fx ) induced
by the scaling automorphism δx,λ : Tx M → Tx M. Clearly, the map (41) intertwines the
actions induced by δλ and δx,λ .
Let us ﬁnally consider the Heisenberg tangent groupoid TM which has recently been constructed by van Erp and Yuncken [62, 63], see also [16]. This is a smooth groupoid associated
to a ﬁltered manifold M with objects G (0) = M × R and arrows
G (1) = TM = (T op M × {0}) ⊔ (M × M × R× ).
Here T op M denotes the groupoid T M discussed in the preceding paragraph, equipped with
the opposite multiplication, µop (g, h) = µ(h, g), so that restriction along M ⊆ T M provides
an isomorphism of Lie algebroids tM = A(T op M). 2 The decomposition above only describes
TM “algebraically”, the subtle ingredient is the smooth structure along T op M × {0}. We
refer to [62, 63] for details. The evaluations ev0 : TM → T op M and evt : TM → M × M are
smooth maps of groupoids for all t ∈ R× . These give rise to homomorphisms of Lie algebras
ev

ev

t
0
Γ∞ (tM) = Γ∞ (A(T op M)) ←−−
Γ∞ (A(TM)) −→
Γ∞ (A(M × M)) = X(M).

Using the evaluations evt for t 6= 0, we obtain an isomorphism of Lie algebras

	
Γ∞ (A(TM)) = X ∈ Γ∞ (T M × R) : ∂tk |t=0 X ∈ Γ∞ (T −k M) for all k ∈ N0

(42)

in such a way that the bracket and anchor correspond to the (constant) bracket and anchor
of the Lie algebroid T M × R, see [62, Section 3.5]. Moreover, for every X ∈ Γ∞ (A(TM)),
ev0 (X) = lim δt S −1 evt (X),
t→0

(43)

where S : tM → T M is any splitting of the ﬁltration,3 see [62, Section 3.5]. This is indeed
independent of the splitting S, see [62, Lemma 32]. Every splitting S provides a noncanonical isomorphism of C ∞ (M × R) modules,

X 7→ (x, t) 7→ δt S −1 X(x, t)
Γ∞ (A(TM)) ∼
= Γ∞ (tM × R),

see [62, Lemma 30]. The construction of the tangent groupoid in [62, 63] is accomplished by
integrating the Lie algebroid A(TM), using a theorem of Nistor, see [44].
The scaling automorphism δλ on T M can be extended to an automorphism of the groupoid
TM, called the zoom action, by putting δλ (x, y, t) := (x, y, λ−1t) for all x, y ∈ M, t ∈ R×
and λ > 0, see [62, Deﬁnition 34]. If E and F are two vector bundles over M, we will
consider the vector bundles E := E × R and F := F × R over the space of units M × R.
2The

opposite groupoid T op M mediates between two conﬂicting, yet common, conventions we are following: The Lie algebra of a Lie group is usually deﬁned by restricting the Lie bracket to left invariant vector
ﬁelds, while the Lie algebroid of a smooth groupoid is deﬁned using right invariant vector ﬁelds, see (37).
3These splittings are called degradings by van Erp and Yuncken.
26

Although the dilations δλ do not restrict to the identical map on the space of units, they
still act canonically on K(TM; E, F) such that the diagram
K(T op M; E, F ) o

ev∗0

K(TM; E, F)

(δλ )∗



K(T op M; E, F ) o

ev∗t

K(M × M; E, F )
/

(44)

(δλ )∗
ev∗0



K(TM; E, F)

ev∗t/λ

/

K(M × M; E, F )

commutes for all t ∈ R× and λ > 0. Clearly, the evaluation maps ev∗0 and ev∗t above are
compatible with composition and transposition.
The zoom action was introduced in [22] for Connes’ tangent groupoid. It provides a way
to describe the classical pseudodiﬀerential operators. The main intention here is to recover
a similar calculus.
3.3. Van Erp and Yuncken’s pseudodifferential calculus. Following van Erp and
Yuncken [62, Section 4.1], we will now introduce vector valued Heisenberg classical pseudodifferential operators. The basic properties of this calculus are summarized in Propositions 3.4
and 3.9 below, the Rockland theorem can be found in Theorem 3.13.
In the ﬂat case, that is, if the ﬁltration on M locally is diﬀeomorphic to the left invariant ﬁltration on a graded nilpotent Lie group, the calculus described below (in the scalar
case) coincides with the one constructed by Christ, Geller, Glowacki, and Polin in [18], see
Remark 3.20 below. On Heisenberg manifolds it reduces to the calculus in [46].
Definition 3.2 (van Erp and Yuncken). For each complex number s we let Ψs (E, F ) ⊆
O(E, F ) denote the space of operators whose Schwartz kernel k ∈ K(M × M; E, F ) can
be extended across the tangent groupoid to a kernel K ∈ K(TM; E, F) which is essentially
homogeneous of order s, that is, ev∗1 K = k and, for all λ > 0,
(δλ )∗ K = λs K mod K∞ (TM; E, F).
These are called kernels or pseudodifferential operators of Heisenberg order s.
Deﬁning the space of principal cosymbols of order s by


K(T M; E, F )
s
s
Σ (E, F ) := k ∈ ∞
: (δλ )∗ k = λ k for all λ > 0 ,
K (T M; E, F )
cf. [62, Deﬁnition 46], we obtain a principal cosymbol map,
σ s : Ψs (E, F ) → Σs (E, F ),

σ s (A) := ν ∗ ev∗0 K,

where K ∈ K(TM; E, F ) is any essentially homogeneous kernel of order s extending the
Schwartz kernel of A, cf. [62, Deﬁnition 48]. Here ν : T M → T op M denotes the isomorphism
of groupoids given by inversion. For this symbol map to be well deﬁned one needs to show
that if K is essentially homogeneous of order s and ev∗1 K is smooth, then ev∗0 K is smooth
too. The argument for this is the same as in the scalar case given in [62, Proposition 45].
For k ∈ N0 there is a canonical inclusion,
Γ∞ (U−k (tM) ⊗ hom(E, F )) ⊆ Σk (E, F )
provided by regarding both sides as right invariant σ-vertical operators on T op M.
27

(45)

Remark 3.3. Note that in the original deﬁnition in [62] the kernel K is a priori not assumed
to be smooth away from the units but the essential homogeneity forces this conormality, see
[62, Proposition 41]. Hence, the calculus obtained here is equivalent to the original one.
The following basic properties of the Heisenberg calculus have been established in [62] for
scalar valued operators.
Proposition 3.4 (Van Erp–Yuncken). Let E, F and G be vector bundles over a filtered
manifold M and let s be any complex number. Then the following hold true:
(a) We have Ψs (E, F ) ⊆ O(E, F ). Hence, every A ∈ Ψs (E, F ) induces continuous operators
∞
−∞
−∞
A : Γ∞
(F ). If, moreover, A is properly supported,
c (E) → Γ (F ) and A : Γc (E) → Γ
∞
∞
−∞
then we obtain continuous operators Γ (E) → Γ∞ (F ), Γ∞
(E) →
c (E) → Γc (F ), Γ
−∞
Γ−∞ (F ), and Γ−∞
(E)
→
Γ
(F
).
c
c
(b) We have Ψs−1 (E, F ) ⊆ Ψs (E, F ), and the following sequence is exact:
σs

0 → Ψs−1(E, F ) → Ψs (E, F ) −→ Σs (E, F ) → 0
T
(c) k∈N Ψs−k (E, F ) = O−∞ (E, F ).
(d) If A ∈ Ψs1 (E, F ), B ∈ Ψs2 (F, G), and at least one of the two is properly supported, then
BA ∈ Ψs2 +s1 (E, G) and σ s2 +s1 (BA) = σ s2 (B)σ s1 (A).
(e) If A ∈ Ψs (E, F ), then At ∈ Ψs (F ′ , E ′ ) and σ s (At ) = σ s (A)t .
(f ) DOk (E, F ) = DO(E, F ) ∩ Ψk (E, F ) for all k ∈ N0 , and the principal symbol considered
here extends the one for differential operators via the canonical inclusion (45).
(g) Let A ∈ Ψs (E, F ) and assume that there exists b ∈ Σ−s (F, E) such that b σ s (A) = 1.
−s
Then there exists a left parametrix B ∈ Ψ−s
prop (F, E) such that σ (B) = b and BA − id
is a smoothing operator. Moreover, an analogous statement involving right parametrices
holds true.
Proof. The proof is a straight forward generalization of the arguments in [62]. The statement
Ψs (E, F ) ⊆ O(E, F ) in (a) is trivial, given our deﬁnition, cf. Remark 3.3. Every operator in
O(E, F ) induces continuous maps as indicated, see Section 2.1.
Part (b) can be proved exactly as in [62, Lemma 50 and Corollary 53].
Part (c) can be proved exactly as in [62, Corollary 73].
Part (d) can be proved exactly as in [62, Proposition 49]: Let K ∈ K(TM; E, F) and
L ∈ K(TM; F, G) be essentially homogeneous of order s1 and s2 , respectively, such that ev∗1 K
and ev∗1 L are the Schwartz kernels of A and B, respectively. If one of A or B is properly
supported, then the corresponding K or L, can be chosen properly supported too. Then,
L ∗ K ∈ K(TM; E, G) and (δλ )∗ (L ∗ K) = (δλ )∗ L ∗ (δλ )∗ K = λs2 +s1 L ∗ K mod K∞ (TM; E, G).
Hence, L ∗ K is essentially homogeneous of order s1 + s2 , and since ev∗1 (L ∗ K) = ev∗1 L ∗ ev∗1 K
is the Schwartz kernel of BA, we obtain BA ∈ Ψs1 +s2 (E, G). Moreover, σ s1 +s2 (BA) =
ν ∗ ev∗0 (L ∗ K) = ν ∗ ev∗0 L ∗ ν ∗ ev∗0 L = σ s2 (B)σ s1 (A).
To see (e) let K ∈ K(TM; E, F) be essentially homogeneous of order s such that ev∗1 K
is the Schwartz kernel of A. Then Kt ∈ K(TM; F′ , E′ ) and (δλ )∗ Kt = ((δλ )∗ K)t = λs Kt
mod K∞ (TM; F′ , E′ ). Hence, Kt is essentially homogeneous of order s, and since ev∗1 Kt =
(ev∗1 K)t ∈ K(M × M; F ′ , E ′ ) is the Schwartz kernel of At , we obtain At ∈ Ψs (F ′ , E ′ ).
Moreover, σ s (At ) = ν ∗ ev∗0 Kt = (ν ∗ ev∗0 K)t = σ s (A)t .
28

Part (f) can be proof exactly as in [62, Section 7.3]. Let us ﬁrst consider A ∈ Γ∞ (hom(E, F )) =
DO0 (E, F ). In view of (35) and (36), the pull back pr∗1 A ∈ Γ∞ (hom(E, F)) provides a kernel in KM ×R (TM; E, F) which is strictly homogeneous of order zero, and such that ev∗1 K
is the Schwartz kernel of A. Hence, A ∈ Ψ0 (E, F ) and ν ∗ σ 0 (A) = ev∗0 K = A. To discuss
actual diﬀerential operators note that if X ∈ Γ∞ (T −k M) then X(x, t) := tk X(x) provides
an extension X ∈ Γ∞ (A(TM)) which is strictly homogeneous of order k and such that
ev∗1 X = X, see (42) or [62, Section 7.3]. Moreover, in view of (43), ev∗0 X = π−k (X) where
π−k : T −k M → gr−k (T M) denotes the canonical vector bundle projection. Now suppose ∇ is
a linear connection on E and consider the induced connection ∇E := pr∗1 ∇ on E. Using (35)
and (38) we see that ∇EX provides a kernel K ∈ KM ×R (TM; E, E) which is strictly homogeneous of order k and such that ev∗1 K is the Schwartz kernel of the operator ∇X ∈ DOk (E).
Hence, ∇X ∈ Ψk (E) and ν ∗ σ k (∇X ) = ev∗0 (∇EX ) = π−k (X) ⊗ id which coincides with the principal symbol for diﬀerential operators, see (10). This completes the proof of part (f) since,
locally, every diﬀerential operator can be written as a ﬁnite composition of vector bundle
homomorphisms and operators of the form ∇X .
Part (g) can be proved in the standard way, assuming that the calculus is asymptotically
complete. In the scalar case this is described in [62, Theorem 76] similar to the standard
argument and generalizes to the vector valued case. W.l.o.g. we may assume A ∈ Ψsprop (E, F ).
−s
In view of (b), there exists B̃ ∈ Ψ−s
prop (F, E) such that σ (B̃) = b. Using (d), we obtain
id −B̃A ∈ Ψ0prop (E) and σ 0 (id −B̃A) = σ 0 (id) − σ −s (B̃)σ s (A) = 1 − b σ s (A) = 0. In view of
(b), we conclude R := id −B̃A ∈ Ψ−1
prop (E). Hence, by asymptotic completeness, there exists
S ∈ Ψ0prop (E) such that
k−1
X
S−
Rj ∈ Ψ−k
prop (E),
j=0

0
0
for all k ∈ N. In particular, S − id ∈ Ψ−1
prop (E) and thus σ (S) = σ (id) = 1, see (b).
Moreover, S(id −R) − id ∈ Ψ−k
prop (E), for all k ∈ N. Using (c), we conclude S(id −R) = id
−∞
−s
0
−s
mod O (E). Putting B := S B̃ ∈ Ψ−s
prop (F, E), we obtain σ (B) = σ (S)σ (B̃) = 1·b = b
and BA = S B̃A = S(id −R) = id mod O−∞ (E). The construction of right parametrices
can be reduced to the construction of left parametrices using transposition.


Remark 3.5. For Heisenberg manifolds, a statement similar to Proposition 3.4(g) can be
found in [46, Proposition 3.3.1].
Remark 3.6 (Formal adjoints). If A ∈ Ψs (E, F ) and A∗ denotes the formal adjoint w.r. to
inner products of the form (6), then A∗ ∈ Ψs̄ (F, E) and σ s (A∗ ) = σ s̄ (A)∗ . Indeed, in view
of (8) this follows immediately from the assertions (d), (e), and (f) of Proposition 3.4. Here
the adjoint of the cosymbol, σ s (A)∗ , is understood as follows: If k ∈ K(T M; E, F ), then
k ∗ ∈ K(T M; F, E) is deﬁned by k ∗ (g) = k(g −1 )∗ where g ∈ Tx M, and the right hand side
denotes the adjoint of k(g −1 ) with respect to the inner products hE,x and hF,x on Ex and Fx ,
respectively. Since this star preserves the subspace K∞ (T M; E, F ) and commutes with δλ ,
∗
it induces an involution Σs̄ (F, E) −
→ Σs (E, F ), for each complex s. For s ∈ N0 this extends
the involution in Remark 2.5 via the inclusion (45).
Remark 3.7 (Asymptotic expansion in exponential coordinates). Let us use exponential
coordinates as in [62] to identify an open neighborhood U of the zero section in T M with
29

an open neighborhood V of the diagonal in M × M,
ϕ

TM ⊇U −
→ V ⊆ M × M.
This diﬀeomorphism is obtained by restricting the composition
exp

(p,exp∇ )

−S

T M ←−− tM −−→ T M ⊇ U ′ −−−−−→ M × M.
Here exp denotes the ﬁber wise exponential map; S is a splitting of the ﬁltration; exp∇
denotes the exponential map associated
with a linear connection on the tangent bundle which
L
p
′
preserves the grading T M =
p S(t M); U is an open neighborhood of the zero section
∇
in T M on which exp is deﬁned and a diﬀeomorphism onto its image; and p : T M → M
denotes the canonical projection, cf. [62, Equation (22) in Section 3.7]. Let π : T M → M
denote the canonical projection and, after possibly shrinking U, ﬁx an isomorphism of vector
bundles ϕ̃ over ϕ,

ϕ̃
π ∗ hom(E, F ) ⊗ Ωπ |U ∼ / (F ⊠ E ′ )|V
=



ϕ
∼
=

U


/

V,

which restricts to the tautological identiﬁcation over the zero section/diagonal. For every
Schwartz kernel k ∈ Γ−∞ (F ⊠ E ′ ) we obtain ϕ̃∗ (k|V ) ∈ Γ−∞ ((π ∗ hom(E, F ) ⊗ Ωπ )|U ). If k
is the kernel of an operator A ∈ Ψs (E, F ), then there exist an asymptotic expansion of the
form
ϕ̃∗ (k|V ) ∼ k0 + k1 + k2 + · · · ,
(46)
s−j
s
where kj ∈ Σ (E, F ) and σ (A) = k0 . More precisely, for every r ∈ N there exists
P
r
N ∈ N such that ϕ̃∗ (k|V ) − N
j=0 kj is of class C on U. Indeed, if l ∈ K(T M; E, F ) is
∞
essentially homogeneous of order s and χ ∈ C (M × M) is supported in V and s ≡ 1 in
a neighborhood of the diagonal, then χ · (ϕ̃∗ l) ∈ Γ−∞ (F ⊠ E ′ ) is the Schwartz kernel of an
operator B ∈ Ψs (E, F ) with σ s (B) = l, cf. the proof of [62, Lemma 50]. Combining this
P
with Proposition 3.4(b), we inductively obtain kj as above such that k − χ · ϕ̃∗ ( N
j=0 kj ) ∈
s−N −1
Ψ
(E, F ). Moreover, the proof of Proposition 3.4(c) shows that for each r ∈ N there
exists N0 such that for all N1 ≥ N0 the kernels of operators in Ψs−N1 (E, F ) are in Γr (F ⊠
E ′ ), whence the asymptotic expansion (46). Conversely, if a Schwartz kernel k is smooth
away from the diagonal and admits an asymptotic expansion of the form (46), then the
corresponding operator is in Ψs (E, F ), see [62, Theorem 76]. Actually, any sequence kj can
be realized.
Let us now link the principal cosymbols of van Erp and Yuncken with the principal cosymbols used by Christ, Geller, Glowacki, and Polin in [18]. For every complex s, put

	
P s (T M; E, F ) := k ∈ K∞ (T M; E, F ) : (δλ )∗ k = λs k for all λ > 0 .

Clearly, P s (T M; E, F ) = 0 if −s − n ∈
/ N0 where
X
X
n := −
p · rank(tp M) = −
p · rank(T p M/T p+1 M)
p

(47)

p

denotes the homogeneous dimension of M. For −s − n ∈ N0 , by Taylor’s theorem, this is
the space of smooth kernels which restrict to (matrices of) polynomial volume densities of
30

homogeneous degree s on each ﬁber Tx M, using the exponential map to canonically identify
Tx M with the graded vector space tx M. Equivalently, these can be characterized as smooth
families of polynomial volume densities of homogeneous degree s on the ﬁbers Tx M = tx M,
smoothly parametrized by x ∈ M.
Lemma 3.8. The identical map on K(T M; E, F ) induces a canonical identification


K(T M; E, F )
s
s
Σ (E, F ) = k ∈ s
: (δλ )∗ k = λ k for all λ > 0 .
P (T M; E, F )

Moreover, with respect to a homogeneous norm | −| on tM, and using the fiber wise exponential map, exp : tM → T M, every kernel k ∈ K(T M; E, F ) which is essentially homogeneous
of order s can be written in the form
k = k∞ + ks + ps log | exp−1 (−)|

(48)

where k∞ ∈ K∞ (T M; E, F ), ks ∈ K(T M; E, F ) homogeneous of order s, that is, (δλ )∗ ks =
λs ks for all λ > 0, and ps ∈ P s (T M; E, F ). If −s − n ∈
/ N0 , then ps = 0 and the decomposition in (48) is unique. If −s − n ∈ N0 , then the decomposition in (48) is unique up to
adding a kernel in P s (T M; E, F ) to ks and subtracting it from k∞ in turn.
Proof. We begin by showing that each element of Σs (E, F ) admits a representative in
K(T M; E, F ) which is homogeneous of order s mod P s (T M; E, F ). To this end let k ∈
Kprop (T M; E, F ) be properly supported and essentially homogeneous of order s. Use the
diﬀeomorphism T M = tM provided by the ﬁber wise exponential map, to identify k with an
∗
∞ ∗
∗
element in Γ−∞
prop (tM; p hom(E, F )⊗Ωp ), and let k̂ ∈ Γ (t M; π hom(E, F )) denote its ﬁber
wise Fourier transform, see for instance [62, Section 5]. Here p : tM → M and π : t∗ M → M
denote the canonical vector bundle projections. More explicitly, for ξ ∈ t∗x M we have
Z
−i(ξ,−)
k̂(ξ) = hkx , e
i=
kx (X)e−i(ξ,X) dX ∈ hom(Ex , Fx ).
tx M

Recall that the restriction of k to the ﬁber tx M is a volume density with values in hom(Ex , Fx ),
whence this pairing (integral) is unambiguously deﬁned. Since k is essentially homogeneous
of order s and properly supported, k̂ is homogeneous of order s mod S(t∗ M; π ∗ hom(E, F )),
the ﬁber wise Schwartz space. More precisely,
(δ̇λ′ )∗ k̂ − λs k̂ ∈ S(t∗ M; π ∗ hom(E, F )),
for all λ > 0. Here δ̇λ′ := δ̇λ∗ : t∗ M → t∗ M denotes the vector bundle automorphism dual to
δ̇λ : tM → tM, that is, hδ̇λ′ ξ, Xi = hξ, δ̇λXi for all ξ ∈ t∗x M and X ∈ tx M.
According to [62, Lemma 58], there exists f ∈ Γ∞ (t∗ M \ M; π ∗ hom(E, F )) such that
(δ̇λ′ )∗ f = λs f for all λ > 0, and
(1 − η) · (k̂ − f ) ∈ S(t∗ M, π ∗ hom(E, F )),

(49)

∞
where η ∈ Cprop
(t∗ M) is a properly supported smooth bump function on t∗ M such that
η ≡ 1 in a neighborhood of M ⊆ t∗ M.
We extend f to a globally deﬁned distribution f˜ ∈ Γ−∞ (t∗ M; π ∗ hom(E, F )) by putting
!
Z
Z
N
X
X
(i + s)−1 µ(ψi f )
hψ, f˜i :=
ψf +
ψ−
ψi f +
|ξ|≥1

|ξ|≤1

i=n

31

n≤i≤N
i+s6=0

∗
∗
for every test section ψ ∈ D(π ∗ hom(E, F )) = Γ∞
c ((π hom(E, F )) ⊗ |Λ|t∗ M ), see [18, Section 3] or [27, Proof of Proposition 6.15]. Here |−| is a ﬁber wise homogeneous norm on t∗ M,
i.e., |δ̇λ′ ξ| = λ|ξ| for all ξ ∈ t∗ M and λ > 0; N is any integer such that N + 1 + ℜ(s) > 0; and
ψi ∈ Γ∞ ((π ∗ hom(E, F ))∗ ⊗ |Λ|t∗ M ) are homogeneous (ﬁber wise Taylor polynomials) such
P
N +1
that (δ̇λ′ )∗ ψi = λi ψi for all λ > 0 and (δ̇λ′ )∗ ψ − N
) as λ → 0. Moreover, for
i=n ψi = O(λ
∞
∗
every g ∈ Γ (|Λ|t M \M ) which is homogeneous of degree z, i.e., (δ̇λ′ )∗ g = λz g for all λ > 0,
and such that π(supp(g)) has compact closure, µ(g) denotes the unique number such that,
for all 0 < r < R, we have

Z

(
µ(g)z −1 (Rz − r z ) if z =
6 0, and
g=
µ(g) log(R/r)
if z = 0.
r≤|ξ|≤R

If −s − n ∈
/ N0 , then f˜ is the unique distributional extension of f , and (δ̇λ′ )∗ f˜ = λs f˜,
for all λ > 0. If −s − n ∈ N0 , then hψ, ∆i := µ(ψ−s f ) deﬁnes a distribution ∆ ∈
Γ−∞ (t∗ M; π ∗ hom(E, F )) which is supported on M ⊆ t∗ M, and homogeneous of order s,
that is (δ̇λ′ )∗ ∆ = λs ∆ for all λ > 0. Moreover, (δ̇λ′ )∗ f˜ = λs f˜ + λs log(λ)∆, for all λ > 0.
Let l ∈ K(T M; E, F ) be the unique ﬁber wise tempered distribution with Fourier transform ˆl = f˜. In view of (49), we have k−l ∈ K∞ (T M; E, F ). If −s−n ∈
/ N0 , then (δλ )∗ l = λs l,
s
for all λ > 0. If −s − n ∈ N0 , we let p ∈ P (T M; E, F ) denote the unique ﬁber wise tempered distribution with Fourier transform p̂ = ∆, and obtain (δλ )∗ l = λs l + λs log(λ)p, for
all λ > 0. In either case l is homogeneous mod P s (T M; E, F ). To establish a decomposition
as in (48), it remains to observe that l − p log | exp−1 (−)| ∈ K(T M; E, F ) is homogeneous of
order s, for we have (δλ )∗ (l − p log | exp−1 (−)|) = λs (l − p log | exp−1 (−)|) for all λ > 0.
To complete the proof, it remains to observe that every smooth kernel k ∈ K∞ (T M; E, F )
which is homogeneous mod P s (T M; E, F ) is actually contained in P s (T M; E, F ). Indeed,
if λ−s (δλ )∗ k = k + pλ with pλ ∈ P s (T M; E, F ), then the ﬁber wise Taylor series of f along
M ⊆ T M contains only terms which are homogeneous of order s. Hence, λ−s (δλ )∗ k converges
to an element in P s (T M; E, F ) as λ → 0, and, thus, k ∈ P s (T M; E, F ).

Proposition 3.9. Let E and F be vector bundles over a filtered manifold M of homogeneous
dimension n, see (47). Consider A ∈ Ψs (E, F ) where s is some complex number, and let
k ∈ Γ−∞ (F ⊠ E ′ ) denote the corresponding Schwartz kernel. Then the following hold true:
(a) If ℜs ≤ 0, then A induces a continuous operator A : L2c (E) → L2loc (F ). If, moreover,
A is properly supported, then we obtain continuous operators A : L2c (E) → L2c (F ) and
A : L2loc (E) → L2loc (F ). For closed M we have a bounded operator A : L2 (E) → L2 (F ).
(b) If ℜs < 0, then A induces a compact operator A : L2c (E) → L2loc (F ). If, moreover,
A is properly supported, then it induces compact operators A : L2loc (E) → L2loc (F ) and
A : L2c (E) → L2c (F ). For closed M we obtain a compact operator A : L2 (E) → L2 (F ).
(c) If ℜs < −n/2, then A induces a continuous operator A : L2c (E) → Γ(F ). If A is properly
supported, then it induces continuous operators A : L2loc (E) → Γ(F ) and A : L2c (E) →
Γc (F ). For closed M we obtain a continuous operator A : L2 (E) → Γ(F ). 4

4Recall

that Γ(F ) and Γc (F ) denote the standard spaces of (compactly supported) continuous sections.
32

(d) If ℜs < −n, then the kernel k is continuous. If, moreover, M is closed and E = F , then
A : L2 (E) → L2 (E) is trace class and
Z
Z
∗
trL2 (E) (A) =
trE (ι k) =
trEx (k(x, x))
M

∗

x∈M

∞

where ι k ∈ Γ (end(E) ⊗ |Λ|M ) denotes the restriction of the kernel to the diagonal.

Proof. To show (a), suppose ℜs ≤ 0. The symbol estimate in [62, Corollary 67] implies that
the full symbol of A, i.e. the ﬁber wise Fourier transform of the full cosymbol, with respect
s/m
to exponential coordinates as in Remark 3.7, is in the standard class S1/m,0 where m is such
Lm −j
that tM = j=1 t M, cf. [2, Proposition 10.22]. This symbol class is not invariant under
general coordinate change. Nevertheless, boundedness on L2 is a well known consequence,
see for instance [57, Theorem 6.1].
To show (b) suppose ℜs < 0. Using Remark 3.7 and Lemma 3.8 we see that the kernel
provides a family k(x, −) ∈ L1loc (Fx ⊗ E ′ ), smoothly parametrized by x ∈ M; and the same
holds true for the transposed kernel, see Proposition 3.4(e). In particular, Rgiven two compact
subsets K and
R L of M, there exists a constant C ≥ 0 such that supx∈L K |k(x, y)|dy ≤ C
and supy∈K L |k(x, y)|dx ≤ C. Hence, according to Schur’s lemma, see [57, Lemma 9.1] or
[27, Lemma 15.2] for instance, the operator norm of the composition
A

L2K (E) ⊆ L2c (E) −
→ L2loc (F ) → L2L (F )

(50)

is bounded by C, i.e., kAψkL2L (F ) ≤ CkψkL2K (E) for all ψ ∈ L2K (E). Writing k = χk +(1−χ)k,
where χ ∈ C ∞ (M × M, [0, 1]) and χ ≡ 1 in a neighborhood of the diagonal, we obtain a
decomposition A = A′ + R where R is a smoothing operator with kernelR(1 − χ)k and A′ ∈
Ψs (E, F ) hasR kernel χk. Given ε > 0, we may choose χ such that supx∈L K |χk(x, y)|dy ≤ ε
and supy∈K L |χk(x, y)|dx ≤ ε and, consequently, kA′ ψkL2L (F ) ≤ εkψkL2K (E) . We conclude
that the composition in (50) can be approximated by smoothing operators. Since the latter
are compact, we conclude that the composition in (50) is compact too.
To show (c) we suppose ℜs < −n/2. Using Remark 3.7 and Lemma 3.8 we see that
the kernel provides a smooth family k(x, −) ∈ L2loc (Fx ⊗ E ′ ), parametrized by x ∈ M.
In particular, given
subsets K and L of M, there exists a constant C ≥ 0
R two compact
2
such that supx∈L K |k(x, y)| dy ≤ C 2 . Using the Cauchy–Schwarz inequality, we obtain
supx∈L |(Aψ)(x)| ≤ CkψkL2K (E) for all ψ ∈ L2K (E). Hence, A maps L2c (E) continuously into
Γ(F ). The remaining statements are now obvious.
To show (d), we suppose ℜs < −n. Using Remark 3.7 and Lemma 3.8 we see that the
kernel provides a smooth family k(x, −) ∈ Γ(Fx ⊗ E ′ ), parametrized by x ∈ M. Clearly, this
implies that k is continuous. The remaining assertions are now obvious.

3.4. Parametrices and Rockland condition. In this section we will establish a Rockland [50] type result characterizing (left) invertible cosymbols and the existence of (left)
parametrices in terms of irreducible unitary representations of the osculating groups, see
Theorem 3.13 below. This generalizes [18, Theorem 2.5(d)] in two ways: (1) The geometry
need not be ﬂat, that is, the ﬁltered manifold need not by locally diﬀeomorphic to the left
invariant ﬁltration on a graded nilpotent Lie group; and (2) we treat operators acting on sections of vector bundles. For Heisenberg manifolds this can be found in [46, Theorems 3.3.10
and 5.4.1].
33

For every x ∈ M we let


K(Tx M; Ex , Fx )
s
s
Σx (E, F ) := k ∈ ∞
: (δλ )∗ k = λ k for all λ > 0
K (Tx M; Ex , Fx )
denote the space principal cosymbols of order s at x. Restriction provides a linear map
evx : Σs (E, F ) → Σsx (E, F ) which is compatible with convolution and transposition. Composing this with the principal symbol map, we obtain
σxs : Ψs (E, F ) → Σsx (E, F ).
We will refer to σxs (A) as the principal cosymbol of A ∈ Ψs (E, F ) at x.
Following [18] and [46, Section 3.3.2], we will now formulate
a (matrix) Rockland type
L
−n−j
P
(Tx M) denote the space
condition for cosymbols in Σsx (E, F ). Let P(Tx M) = ∞
j=0
of polynomial volume densities on Tx M, where n denotes the homogeneous dimension of
M, see (47). Recall that P(Tx M) is invariant under translation and inversion. For a ﬁnite
dimensional vector space E0 , we let S0 (TRx M; E0 ) denote the subspace of all f in the E0 -valued
Schwartz space S(Tx M; E0 ) such that Tx M pf = 0 for all p ∈ P(Tx M).
In view of Lemma 3.8, every cosymbol a ∈ Σsx (E, F ) can be represented in the form
a = k + p log | exp−1 (−)|

(51)

s

where k ∈ K(Tx M; Ex , Fx ) is homogeneous of order s, that is (δλ )∗ k = λ k for all λ > 0, and
p ∈ P s (Tx M; Ex , Fx ). If −s − n ∈
/ N0 , then p = 0 and k is unique. If −s − n ∈ N0 , then p
is unique but k comes with an ambiguity in P s (Tx M; Ex , Fx ). Hence, the restriction of the
left regular representation,
S0 (Tx M; Ex ) → S0 (Tx M; Fx ),

f 7→ a ∗ f,

(52)

Σsx (E, F ),

does not depend on the representative for a ∈
provided it is of the form (51).
Suppose π : Tx M → U(H) is a non-trivial irreducible unitary representation of the osculating group Tx M on a Hilbert space H. Let H0 denote the subspace of H spanned by
elements of the form π(f dg)v where v ∈ RH, f ∈ S0 (Tx M), dg denotes a (left) invariant
volume density on Tx M, and π(f dg) := Tx M π(g)f (g)dg ∈ K(H). Since H0 non-trivial
and invariant under π(g) for all g ∈ Tx M, the subspace H0 is dense in H. Note that
H0 ⊗ Ex isR spanned by vectors of the form π(f dg)v where v ∈ H, f ∈ S0 (Tx M; Ex ), and
π(f dg) := Tx M π(g)f (g)dg ∈ K(H, H ⊗ Ex ).
Still assuming a representative of the form (51), we deﬁne an unbounded operator π(a)
from H ⊗ Ex to H ⊗ Fx by
π(a) : H0 ⊗ Ex → H0 ⊗ Fx ,

π(a)π(f dg)v := π(a ∗ f dg)v,

for all f ∈ S0 (Tx M; Ex ) and v ∈ H, cf. (52). As explained in [18, Section 2], this deﬁnition
of π(a) is unambiguous. Moreover, π(a) is closeable, for π(a∗ ) is a densely deﬁned adjoint.
We denote its closure by π̄(a). It is well know, see [18], [29], or [46, Proposition 3.3.6], that
the domain of deﬁnition of π̄(a) contains the space of smooth vectors, H∞ ⊗ Ex , and this
subspace is mapped into H∞ ⊗ Fx by π̄(a). Furthermore, on H∞ ⊗ Ex , we have
π̄(ba) = π̄(b)π̄(a)
Σsx (E, F )

(53)

Σs̃x (F, G).

whenever a ∈
and b ∈
Moreover, with respect to inner products on Ex
and Fx and the associated inner products on H ⊗ Ex and H ⊗ Fx , we have
π̄(a)∗ = π̄(a∗ )
34

(54)

on H∞ ⊗ Fx . If a is the cosymbol of a diﬀerential operator then, on H∞ ⊗ Ex , the operator
π̄(a) coincides with π(a) considered in Section 2.3, see [46, Remark 3.3.7], and thus the
following deﬁnition is consistent with Deﬁnition 2.7.
Definition 3.10 (Matrix Rockland condition). A principal cosymbol a ∈ Σsx (E, F ) at x ∈ M
is said to satisfy the Rockland condition if, for every non-trivial irreducible unitary representation π : Tx M → U(H), the unbounded operator π̄(a) is injective on H∞ ⊗ Ex . An
operator A ∈ Ψs (E, F ) is said to satisfy the Rockland condition if its principal cosymbol,
σxs (A) ∈ Σsx (E, F ), satisﬁes the Rockland condition at each point x ∈ M.
We will need the following matrix version of a Rockland [50] type theorem due to Christ,
Geller, Glowacki, and Polin, see [18, Theorem 6.2] or [29] for the order zero case. For
diﬀerential operators such a statement can be found in van Erp’s thesis [59].
Lemma 3.11 (Christ–Geller–Glowacki–Polin). A principal cosymbol a ∈ Σsx (E, F ) at x ∈ M
satisfies the Rockland condition iff it admits a left inverse b ∈ Σ−s
x (F, E), that is, ba = 1.
Proof. The necessity of the Rockland condition is obvious, see (53). To prove the non-trivial
implication, we will present an elementary argument, reducing the statement to the well
known scalar case due to Christ–Geller–Glowacki–Polin, see [18, Theorem 6.2]. For s = 0
this has been proved in [29].
With respect to bases of Ex and Fx , the cosymbol a ∈ Σsx (E, F ) corresponds to a matrix
A with entries in Σsx , the space of principal cosymbols of order s at x for scalar operators.
Moreover, π̄(a) corresponds to the matrix π̄(A) obtained by applying the representation π
to each entry of A, that is, (π̄(A))ij = π̄(Aij ). Hence, a satisﬁes the Rockland condition in
Deﬁnition 3.10 iﬀ the matrix π̄(A) acts injectively on (H∞ )m . Here m := dim(Ex ) is the
number of columns of A. Using induction on m, we will show that there exists a matrix B
with entries in Σ−s
x such that BA = Im where Im denotes the m × m unit matrix.
∗
Clearly, A A is an (m × m)-matrixPwith entries in Σ2s
x which satisﬁes the Rockland condition, see (53) and (54). Let y := j (Aj1)∗ Aj1 ∈ Σ2s
x denote the entry in the upper left
∗
corner of A A. Clearly, y satisﬁes the (scalar) Rockland condition. Hence, according to [18,
Theorem 6.2], there exists z ∈ Σx−2s such that zy = 1. Since y ∗ = y, we also have yz = 1,
whence z is invertible. Hence the diagonal matrix D := zIm is invertible and, thus, DA∗ A
satisﬁes the Rockland condition. The matrix DA∗ A has entries in Σ0x and, by construction,
its entry in the upper left corner is 1. Performing elementary row operations, we ﬁnd an
invertible matrix L with entries in Σ0x such that


1 ∗
∗
LDA A =
0 Y
where Y is an (m − 1) × (m − 1)-matrix with entries in Σ0x . Since L is invertible, LDA∗ A
satisﬁes the Rockland condition and, thus, Y satisﬁes the Rockland condition too. By
0
induction, there exists
 an(m−1)×(m−1)-matrix Z with entries in Σx such that ZY = Im−1 .
1 0
The matrix C :=
has entries in Σ0x and, by construction,
0 Z


1
∗
∗
CLDA A =
.
0 Im−1
35

Performing further elementary row operations, we ﬁnd an invertible matrix U with entries
in Σ0x such that UCLDA∗ A = Im . Hence, the matrix B := UCLDA∗ has entries in Σ−s
x and
satisﬁes BA = Im .

Lemma 3.12. Let E and F be two vector bundles over a filtered manifold M. Consider
a ∈ Σs (E, F ) and suppose evx0 (a) is left invertible at some point x0 ∈ M, that is, there
exists bx0 ∈ Σ−s
x0 (F, E) such that bx0 ev x0 (a) = 1. Then there exists an open neighborhood U
of x0 and b ∈ Σ−s (F |U , E|U ) such that ba|U = 1. Moreover, a similar statement involving
right inverses holds true.
Proof. If the bundle of osculating algebras is locally trivial, then this follows from [18], at
least in the scalar case. To handle general bundles of osculating algebras, we will proceed as
in [46, Section 3.3.3] where Ponge considers (in general non-contact) Heisenberg manifolds
with varying osculating algebras.
Choose b̃ ∈ Σ−s (F, E) such that evx0 (b̃) = bx0 . Putting c := b̃a, we have c ∈ Σ0 (E) and
evx0 (c) = 1. It suﬃces to ﬁnd an open neighborhood U of x0 in M such that c|U is invertible
in Σ0 (E|U ), for then b := c|−1
U b̃ is the desired local left inverse of a.
0
We will identify Σ (E) = Σ̂0 (E) where Σ̂0 (E) denotes the space of all k ∈ K(T M; E, E)
which are strictly homogeneous of order zero, that is, (δλ )∗ k = k for all λ > 0, see Lemma 3.8.
Convolution with k ∈ Σ̂0x (E) gives rise to a bounded operator on L2 (Tx M)⊗Ex , see [28, Theorem 6.19]. We ﬁx an auxiliary ﬁber wise Hermitian inner product on E, as well as a smooth
family of invariant volume densities on the osculating groups Tx M, and let |||k|||x denote the
operator norm with respect to the associated Hermitian inner product on L2 (Tx M) ⊗ Ex .
We ﬁx a ﬁber wise homogeneous norm | − | on T M which is smooth on T M \ M. This
permits to decompose each k ∈ Σ̂0x (E) uniquely in the form k = cx (k)δx + pvx (k) where
cx (k) ∈ end(Ex ), and pvx (k) ∈ Σ̂0x (E) is the principal value distribution
Z
kψ,
hpvx (k), ψi := lim
ε→0

{g∈Tx M :|g|≥ε}

see [28, Proposition 6.13]. For each r ∈ N0 we consider the norm
Z
1/2
r
2
kkkx,r := |cx (k)| +
|j (k|Sx M )| µx
,
Sx M

Σ̂0x (E).

r

where k ∈
Here j (k|Sx M ) denotes the r-jet of the restriction of k to the sphere
Sx M := {g ∈ Tx M : |g| = 1}, and we use smooth ﬁber wise Hermitian metric on the rjet bundle J r (Sx M, Ex ) which depends smoothly on x, and we are using a smooth volume
density µx on the sphere Sx M which depends smoothly on x.
There exists r0 ∈ N0 and constants Cx ≥ 0 such that |||k|||x ≤ Cx kkkx,r0 for all k ∈ Σ̂0x (E).
This follows from a result due to Folland and Stein, see [28, Theorem 6.19], and the Sobolev
embedding theorem. Ponge observed, see [46, Lemma 3.3.13], that the proof of Folland and
Stein allows to choose the constants Cx uniformly over compact subsets of M. To make this
more precise, we put, for every compact subset L of M and each k ∈ Σ̂0 (E),
|||k|||L := sup ||| evx (k)|||x

and

x∈L

kkkL,r := sup k evx (k)kx,r .
x∈L

Then there exists a constant CL ≥ 0 such that
|||k|||L ≤ CL kkkL,r0
36

(55)

holds for all k ∈ Σ̂0 (E).5 Moreover, see [46, Lemma 3.3.15] and [18, Lemma 5.7], for every
r ≥ r0 there exists a constant CL,r ≥ 0 such that


kk2 ∗ k1 kL,r ≤ CL,r kk2 kL,r · |||k1|||L + |||k2|||L · kk1 kL,r
holds for all k1 , k2 ∈ Σ̂0 (E). As in [17, Lemma 4], this gives
q
q
q
p
1/i
1/i
1/i
2i 1/2i
1/2i
1/2i
i
i
kk kL,r ≤ (2CL,r )
|||k |||L
kk kL,r ≤ (2CL,r )
|||k|||L kk i kL,r

and passing to the limit, we obtain

1/i

lim kk i kL,r ≤ |||k|||L

i→∞

(56)

for all r ≥ r0 and all k ∈ Σ̂0 (E).
To invert c we write c = 1 − k where k ∈ Σ̂0 (E). Then evx0 (k) = 0, and there exists a
compact
L of x0 such that |||k|||L < 1, see (55). In view of (56), the Neumann
P neighborhood
i
k
converges
with respect to the norm k − kL,r for all r ≥ r0 . For each x ∈ L
series ∞
i=0
P
i
we conclude that evx (c) is invertible in Σ̂0x (E) with inverse evx (c)−1 = ∞
i=0 evx (k) . This
also shows that evx (c)−1 depends continuously on x ∈ L. Proceeding as in the proof of
[46, Proposition 3.3.11], we see that evx (c)−1 actually depends smoothly on x in the interior
U of L,Psee also [18, Proposition 5.10]. Hence, c|U is invertible in Σ̂0 (E|U ) with inverse
∞
i
c|−1

U =
i=0 k|U .

Combining these results, we obtain the following Rockland [50] type theorem generalizing
[18, Theorem 2.5(d)], see also [32, Theorem 0.1] and [46, Theorem 3.3.10 and 5.4.1].

Theorem 3.13. Let E and F be vector bundles over a filtered manifold M. Let s be a
complex number, and suppose A ∈ Ψs (E, F ) satisfies the Rockland condition. Then there
exists a left parametrix B ∈ Ψ−s
prop (F, E) such that BA − id is a smoothing operator. In
particular, A is hypoelliptic, that is, if ψ is a compactly supported distributional section of
E and Aψ is smooth, then ψ was smooth. If, moreover, M is closed, then ker(A) is a finite
dimensional subspace of Γ∞ (E).
Proof. According to Lemma 3.11 the principal cosymbol σxs (A) admits a left inverse at each
point x ∈ M. Hence, in view of Lemma 3.12, we see that the principal cosymbol σ s (A)
locally admits left inverses. Using a smooth partition of unity on M, we obtain a global
left inverse b ∈ Σ−s (F, E) such that bσ s (A) = 1. Applying Proposition 3.4(g), we obtain
B ∈ Ψ−s
prop (F, E) such that BA − id is a smoothing operator. The remaining assertions are
now obvious, cf. the proof of Corollary 2.10 above.

Note that Theorem 2.8 follows immediately from Theorem 3.13.
Corollary 3.14. Let E be a vector bundle over a closed filtered manifold M. Suppose
A ∈ Ψs (E) satisfies the Rockland condition and is formally selfadjoint, A∗ = A, with respect
to an L2 inner product of the form (6), and let Q denote the orthogonal projection onto
the (finite dimensional) subspace ker(A) ⊆ Γ∞ (E). Then A + Q is invertible with inverse
(A + Q)−1 ∈ Ψ−s (E).
5Actually,

r0 = 0 appears to be suﬃcient, see [17] and [46, Remark 3.3.14], but we won’t need that.
37

Proof. Proceeding exactly as in the proof of Corollary 2.11, we start with a left parametrix
B ∈ Ψ−s (E), see Theorem 3.13, and observe that the injective and formally selfadjoint
parametrix P constructed there is contained in Ψ−s (E). As explained in the proof of Corollary 2.11, G := (A + Q)P ∈ Ψ0 (E) is invertible, and G−1 − id is a smoothing operator.
Clearly, this implies G−1 ∈ Ψ0 (E), whence (A + Q)−1 = P G−1 ∈ Ψ−s (E).

Corollary 3.15 (Pseudo inverse). Let E and F be smooth vector bundles over a closed
filtered manifold M, consider A ∈ Ψs (E, F ), and let A∗ ∈ DOs̄ (F, E) denote the formal
adjoint with respect to L2 inner products of the form (6). Assume A and A∗ both satisfy
the Rockland condition. Moreover, let Q denote the orthogonal projection onto the (finite
dimensional) subspace ker(A) ⊆ Γ∞ (E), and let P denote the orthogonal projection onto the
(finite dimensional) subspace ker(A∗ ) ⊆ Γ∞ (F ). Then the pseudo inverse,
A+ := (A∗ A + Q)−1 A∗ = A∗ (AA∗ + P )−1 ,
uniquely characterized by the relations
AA+ = id −P,

A+ A = id −Q,

and

A+ P = 0 = QA+ ,

satisfies A+ ∈ Ψ−s (F, E).
Combining these observations with a result from [18] permits to construct operators of
arbitrary order which are invertible up to smoothing operators. More precisely, we have the
following:
Lemma 3.16. Let E be a vector bundle over a filtered manifold M. Then, for every complex
′
′
number s, there exist Λ ∈ Ψsprop (E) and Λ′ ∈ Ψ−s
prop (E) such that ΛΛ − id and Λ Λ − id are
′
both smoothing operators. Moreover, Λ and Λ may be chosen so that they act injectively
s
′
−s
on Γ−∞
c (E). On a closed manifold there even exist Λ ∈ Ψ (E) and Λ ∈ Ψ (E) such that
′
′
ΛΛ = id = Λ Λ.
s/4

Proof. For each x ∈ M we ﬁx an invertible cosymbol ax ∈ Σx (E) at x, see [18, Theorem 6.1].
We extend these to cosymbols ãx ∈ Σs/4 (E) such that evx (ãx ) = ax . By Lemma 3.12, for
each x ∈ M, there exists an open neighborhood Ux of x such that ãx |Ux is invertible in
Σs/4 (E|Ux ). Fix a smooth partition of unity λx , x ∈ M, such that supp(λx ) ⊆ Ux for each
x ∈ M. With respect to a ﬁber wise Hermitian metric on E, we consider
X
a :=
λx ã∗x ãx ∈ Σs/2 (E).
x∈M

We claim that a is an invertible cosymbol. To see this note ﬁrst that, in view of Lemma 3.12,
−s/2
it suﬃces to show that evy (a) admits an inverse in Σy (E) for each y ∈ M. For ﬁxed y ∈ M,
there exists x ∈ M such that λx (y) > 0 and, by construction, evy (ãx ) is invertible. Using (53)
and (54) we conclude that evy (a) satisﬁes the Rockland condition and, thus, admits a left
−s/2
inverse in Σy (E), see Lemma 3.11. Actually, evy (a) is invertible since evy (a) = evy (a)∗ .
This shows that a is invertible, hence there exists a′ ∈ Σ−s/2 (E) such that aa′ = 1 = a′ a.
s/2
According to Proposition 3.4(b) there exist A ∈ Ψprop (E) such that σ s/2 (A) = a. Using
−s/2
Proposition 3.4(g) we obtain A′ ∈ Ψprop (E) such that R := A′ A−id is a smoothing operator.
−s/2
Proposition 3.4(g) also gives A′′ ∈ Ψprop (E) such that AA′′ − id is a smoothing operator.
Since A′′ diﬀers from A′ by a smoothing operator, AA′ − id is a smoothing operator too.
38

Consider Λ ∈ Ψsprop (E) and Λ′ ∈ Ψ−s
prop (E) deﬁned by
Λ := A∗ A + R∗ R

and

Λ′ := A′ (A′ )∗ + RR∗ ,

where the adjoints are with respect to an L2 inner product of the form (6). One readily veriﬁes
that Λ′ Λ − id and ΛΛ′ − id are both smoothing operators. In particular, Λ is hypoelliptic
and, thus, every distributional section in the kernel of Λ has to be smooth. Using (7), we
′
conclude, ker(Λ|Γ−∞
(E) ) ⊆ ker(A) ∩ ker(R) ⊆ ker(id) = 0. Analogously, ker(Λ |Γ−∞
(E) ) ⊆
c
c
′ ∗
∗
∗
∗
′ ∗
ker((A ) ) ∩ ker(R ) ⊆ ker(id) = 0 in view of R = A (A ) − id. If the underlying manifold
is closed, then Λ−1 ∈ Ψ−s (E) according to Corollary 3.14.

Remark 3.17 (Right parametrix). If A ∈ Ψs (E, F ) and At satisﬁes the Rockland condition,
then there exists a right parametrix B ∈ Ψ−s
prop (F, E) such that AB − id is a smoothing
′
′
′ t
operator. Indeed, by Theorem 3.13 there exists B ′ ∈ Ψ−s
prop (E , F ) such that B A − id is a
smoothing operator. Hence, B := (B ′ )t is the desired right parametrix for A.
Remark 3.18. If A ∈ Ψs (E, F ) is such that A and At both satisﬁes the Rockland condition,
then there exists a parametrix B ∈ Ψ−s
prop (F, E) such that AB − id and BA − id are both
smoothing operators. This follows immediately from Theorem 3.13 and Remark 3.17 since
every left parametrix diﬀers from any right parametrix by a smoothing operator.
Remark 3.19. For A ∈ Ψs (E, F ) and x ∈ M the following are equivalent:
(a) At satisﬁes the Rockland condition at x.
(b) A∗ satisﬁes the Rockland condition at x.
(c) π̄(σxs (A)) : H∞ ⊗ Ex → H∞ ⊗ Fx has dense image, for all non-trivial irreducible unitary
representations π : Tx M → U(H).
(d) π̄(σxs (A)) : H∞ ⊗ Ex → H∞ ⊗ Fx is onto, for all non-trivial irreducible unitary representations π : Tx M → U(H).
Indeed, the equivalence (a)⇔(b) is clear in view of (8). The equivalence (b)⇔(c) follows
from π̄(σxs (A))∗ = π̄(σxs̄ (A∗ )), see (54) and Remark 3.6. To see the implication (a)⇒(d)
suppose At satisﬁes the Rockland condition at x. According to Lemma 3.11, there exists
t
t
s
′
′
s
b ∈ Σ−s
x (E , F ) such that bσx (A ) = 1. Transposing this equation, we obtain σx (A)b = 1, see
Proposition 3.4(e). In view of (53), this implies (d), for π̄(bt ) maps H∞ ⊗ Fx into H∞ ⊗ Ex .
Remark 3.20. In the ﬂat case, that is to say, if the ﬁltration on M is locally diﬀeomorphic
to the left invariant ﬁltration on a graded nilpotent Lie group, the calculus described above
coincides with the calculus of Christ, Geller, Glowacki, and Polin [18], cf. Remark 3.7. On
Heisenberg manifolds it specializes to the Heisenberg calculus, see [2, 46, 58], which builds
upon work of Boutet de Monvel [4], Folland–Stein [27] and Dynin [24, 25], see also [5],
[26], [30], [35], and [51]. The equivalence with the Heisenberg calculus follows from [2,
Theorems 15.39 and 15.49], see also [46, Proposition 3.1.15], for the exponential coordinates
used in Remark 3.7 are clearly privileged coordinates in the sense of [46, Deﬁnition 2.1.10].
For trivially ﬁltered manifolds, that is T M = T −1 M, we recover classical pseudodiﬀerential
operators, see [62, Section 8] and [22].
3.5. The Heisenberg Sobolev scale. The properties of the operator class Ψs (E, F ) discussed above permit to introduce a Heisenberg Sobolev scale on ﬁltered manifolds which can
be used to reﬁne the hypoellipticity results in Section 2.4, see Corollaries 3.29 and 3.30 at
39

the end of this section. The main properties of this Sobolev scale are summarized in Proposition 3.21 below, a reﬁned regularity statement including maximal hypoelliptic estimates
can be found in Corollary 3.24.
For non-degenerate CR manifolds the origins of this Sobolev scale can be traced back to
a paper of Folland and Stein [27] where Lp Sobolev spaces for integral s are constructed
using diﬀerential operators, see [27, Section 15], and maximal hypoelliptic estimates for
Kohn’s Laplacian are established, see [27, Theorem 16.6] and also [27, Theorem 16.7]. For
Heisenberg manifolds satisfying only the bracket generating condition H + [H, H] = T M, a
full Sobolev scale has been constructed by Ponge using complex powers of subLaplacians,
see [46, Section 5.5] and [46, Propositions 5.5.9 ad 5.5.14]. Maximal hypoelliptic estimates
can also be found in [33] and the work of Beals and Greiner, see [2, Theorem 18.31].
s
For every real s we let Hloc
(E) denote the space of all distributional sections ψ ∈ Γ−∞ (E)
s
such that Aψ ∈ L2loc (F ) for all A ∈ Ψsprop (E, F ) and all vector bundles F . We equip Hloc
(E)
s
2
with the coarsest topology such that the maps A : Hloc (E) → Lloc (F ) are continuous, for
all A ∈ Ψsprop (E, F ). Analogously, let Hcs (E) denote the space of compactly supported
2
s
distributional sections ψ ∈ Γ−∞
c (E) such that Aψ ∈ Lloc (F ) for all A ∈ Ψ (E, F ), and equip
s
Hc (E) with the coarsest topology such that the corresponding maps A : Hcs (E) → L2loc (F )
are continuous, for all A ∈ Ψs (E, F ) and all vector bundles F .
Proposition 3.21. Let E and F be vector bundles over a filtered manifold M.
s
(a) Hloc
(E) is a complete locally convex vector space, and we have continuous inclusions
s2
s1
Γ∞ (E) ⊆ Hloc
(E) ⊆ Hloc
(E) ⊆ Γ−∞ (E)
0
whenever s1 ≤ s2 . Moreover, Hloc
(E) = L2loc (E) as locally convex spaces.
(b) Hcs (E) is a complete locally convex vector space, and we have continuous inclusions
s2
s1
−∞
Γ∞
c (E) ⊆ Hc (E) ⊆ Hc (E) ⊆ Γc (E)

whenever s1 ≤ s2 . Moreover, Hc0(E) = L2c (E) as locally convex spaces.
′
∞
(c) The canonical pairing Γ∞
c (E ) × Γ (E) → C extends to a pairing
s
Hc−s (E ′ ) × Hloc
(E) → C
s
s
(E). If, moreover,
(E)∗ = Hc−s (E ′ ) and Hc−s (E ′ )∗ = Hloc
inducing linear bijections Hloc
s
s
M is closed, then Hc (E) = Hloc (E) is a Hilbert space we denote by H s (E), and the
pairing induces an isomorphism of Hilbert spaces, H s (E)∗ = H −s (E ′ ).
s−ℜ(r)
(d) Each A ∈ Ψr (E, F ) restricts to continuous operator A : Hcs (E) → Hloc
(F ). Moreover,
s−ℜ(r)
s
if A is properly supported, then we obtain continuous operators A : Hc (E) → Hc
(F )
s−ℜ(r)
s
and A : Hloc (E) → Hloc
(F ). On a closed manifold we obtain a bounded operator
s
s−ℜ(r)
A : H (E) → H
(F ).
−s
(e) Assume M closed and let Λs ∈ Ψs (E) be invertible with Λ−1
s ∈ Ψ (E), see Lemma 3.16.
If hh−, −iiL2 (E) is any Hermitian inner product generating the topology on L2 (E), then

hhψ1 , ψ2 iiH s (E) := hhΛs ψ1 , Λs ψ2 iiL2 (E) ,

(57)

ψ1 , ψ2 ∈ H s (E), is a Hermitian inner product generating the topology on H s (E).
s1
s2
(E) and Hcs2 (E) ⊆ Hcs1 (E) are compact.
(E) ⊆ Hloc
(f ) If s1 < s2 , then the inclusions Hloc
For closed M we obtain a compact inclusion H s2 (E) ⊆ H s1 (E).
40

(g) If M has homogeneous dimension n, see (47), then we have continuous Sobolev ems
beddings Hloc
(E) ⊆ Γr (E) and Hcs (E) ⊆ Γrc (E) for all r ∈ N0 with r < s − n/2, see
Remark 2.3. In particular, we obtain isomorphisms of locally convex spaces,
\
\
s
Γ∞ (E) =
Hloc
(E)
and
Γ∞
(E)
=
Hcs (E),
c
s

as well as Γ−∞ (E) =

S

s

s

s
Hloc
(E) and Γ−∞
c (E) =

S

s

Hcs (E).

Proof. The proof is a routine extension, cf. for instance [57, Section §7] for the classical case,
of the results established in the preceding sections. For each complex number s we choose
−∞
operators Λs ∈ Ψsprop (E), Λ′s ∈ Ψ−s
prop (E), and Rs ∈ Oprop (E) such that, see Lemma 3.16,
Λ′s Λs = id +Rs .
s
We have a continuous inclusion Γ∞ (E) ⊆ Hloc
(E) since every operator A ∈ Ψsprop (E, F )
induces a continuous map A : Γ∞ (E) → Γ∞ (F ), see Proposition 3.4(a), and the inclusion
Γ∞ (F ) ⊆ L2loc (F ) is continuous. Using Proposition 3.4(a) we see that the composition
Λ

Λ′

s
s
s
−∞
Hloc
(E) −→
L2loc (E) ⊆ Γ−∞ (E) −→
Γ−∞ (E) is continuous. Moreover, Oprop
(E) ⊆ Ψsprop (E),

R

s
s
see Proposition 3.4(c), and thus the composition Hloc
(E) −→
L2loc (E) ⊆ Γ−∞ (E) is contins
(E) ⊆ Γ−∞ (E).
uous. We conclude that id = Λ′s Λs − Rs induces a continuous map Hloc
s2
s1
To see that we have continuous inclusions Hloc (E) ⊆ Hloc (E) for all s1 ≤ s2 , we have to
s2
1
(E) → L2loc (E). To
show that each A ∈ Ψsprop
(E, F ) induces a continuous operator A : Hloc
′
2
achieve that, note that A = Λs2 −s1 Λs2−s1 A − Rs2 −s1 A. Moreover, Λs2 −s1 A ∈ Ψsprop
(E, F ),
s2
2
see Proposition 3.4(d), and thus Λs2 −s1 A : Hloc (E) → Lloc (F ) is continuous. Moreover,
Λ′s2 −s1 induces a continuous operator L2loc (F ) → L2loc (F ) since s1 − s2 ≤ 0, see Propo−∞
2
sition 3.9(a). Furthermore, Rs2 −s1 A ∈ Oprop
(E, F ) ⊆ Ψsprop
(E, F ) in view of Proposis2
2
tion 3.4(c) and thus Rs2 −s1 A : Hloc (E) → Lloc (F ) is continuous. We conclude that A =
s2
(E) → L2loc (F ), whence the continΛ′s2 −s1 Λs2 −s1 A − Rs2 −s1 A induces a continuous map Hloc
s1
s2
s
(E) follows from the continuity
uous inclusion Hloc (E) ⊆ Hloc (E). The completeness of Hloc
s
−∞
of the inclusion Hloc (E) ⊆ Γ (E), the completeness of the spaces Γ−∞ (E), the fact that
each A ∈ Ψsprop (E, F ) induces a continuous operator A : Γ−∞ (E) → Γ−∞ (F ), see Proposition 3.4(a), and the completeness of the spaces L2loc (F ). We have a continuous inclusion
0
Hloc
(E) ⊆ L2loc (E) since id ∈ Ψ0prop (E), see Proposition 3.4(f). By Proposition 3.9(a), we also
0
0
(E) = L2loc (E)
(E). This shows Hloc
have the converse continuous inclusion L2loc (E) ⊆ Hloc
and completes the proof of (a). Part (b) can be proved analogously.
To see (c), note that the canonical pairing can be written as

hφ, ψi = h(Λ′s )t φ, Λs ψi − hφ, Rs ψi,

(58)

′
∞
′ t
−s
′
where φ ∈ Γ∞
c (E ), ψ ∈ Γc (E), and (Λs ) ∈ Ψprop (E ) according to Proposition 3.4(e). Recall
s
that the canonical pairing extends to a pairing L2c (E ′ ) × L2loc (E) → C. Since Λs : Hloc
(E) →
2
′ t
−s
′
2
′
′ t
Lloc (E) and (Λs ) : Hc (E ) → Lc (E ) are continuous, we see that the term h(Λs ) φ, Λs ψi
s
extends to a separately continuous bilinear map Hc−s (E ′ ) × Hloc
(E) → C. Since Rs in−∞
∞
duces a continuous operator Rs : Γloc (E) → Γloc (E), the term hφ, Rs ψi actually extends
−∞
′
to a separately continuous bilinear map Γ−∞
c (E ) × Γloc (E) → C. Using (a), (b) and (58)
we conclude that the canonical pairing extends to a separately continuous bilinear map

41

s
Hc−s (E ′ ) × Hloc
(E) → C. Let us now verify that the induced linear map
s
Hloc
(E) → Hc−s (E ′ )∗
′
Γ∞
c (E )

(59)

Hc−s (E ′ )

is bijective. Since the inclusion D(E) =
⊆
is continuous, we obtain a
−s
′ ∗
∗
−∞
continuous map Hc (E ) → D(E) = Γ (E) which, when composed with (59), yields the
s
canonical inclusion Hloc
(E) ⊆ Γ−∞ (E). This immediately implies that (59) is injective. To
see that it is onto, suppose α ∈ Hc−s (E ′ )∗ . The preceding considerations show that there
exists ψ ∈ Γ−∞ (E) such that hφ, ψi = α(φ) for all φ ∈ D(E). It remains to show that
s
ψ ∈ Hloc
(E). To check this, let A ∈ Ψsprop (E, F ). Then hφ̃, Aψi = hAt φ̃, ψi = (α ◦ At )(φ̃)
extends continuously to all φ̃ ∈ L2c (F ′ ). Since the pairing L2c (F ′ ) × L2loc (F ) → C induces
s
a linear bijection L2loc (F ) = L2c (F ′ )∗ , we conclude Aψ ∈ L2loc (F ), whence ψ ∈ Hloc
(E).
−s
′
s
∗
Analogously, one can verify that the induced linear map Hc (E ) → Hloc (E) is a bijection.
If M is closed, then Λs may be assumed to be invertible with inverse Λ−1
∈ Ψ−s (E), see
s
2
s
∼
Lemma 3.16, hence Λs induces a topological isomorphism H (E) = L (E), whence H s (E)
is a Hilbert space. This also implies that the canonical pairing induces an isomorphism of
t
Hilbert spaces, H s (E)∗ = H −s (E ′ ), for we have hφ, ψi = h(Λ−1
s ) φ, Λs ψi and the canonical
pairing induces an isomorphism of Hilbert spaces L2 (E)∗ = L2 (E ′ ).
The mapping properties in (d) are immediate consequences of Proposition 3.4(d), provided
r is real. For complex r, we use Lemma 3.16 and Proposition 3.9(a).
The statement in (e) is now obvious, for Λs : H s (E) → L2 (E) is a topological isomorphism
2
0
s
with inverse induced by Λ−1
s : L (E) = H (E) → H (E), see (d).
′
s1 −s2
To prove (f), note that Λs1 Λs2 ∈ Ψprop (E) and s1 −s2 < 0, hence Λs1 Λ′s2 induces a compact
s2
(E) →
operator on L2loc (E), see Proposition 3.9(b). Hence, the operator Λ′s1 Λs1 Λ′s2 Λs2 : Hloc
s1
Hloc (E) is compact. The latter operator diﬀers from the canonical inclusion by a properly
smoothing operator for we have Λ′s1 Λs1 Λ′s2 Λs2 = id +Rs1 + Rs2 + Rs1 Rs2 . Moreover, properly
s
supported smoothing operators induce compact operators on each Sobolev space Hloc
(E) for
∞
s
the continuous inclusion Γ (E) ⊆ Hloc (E) is compact in view of the Heine–Borel property
of Γ∞ (E) which asserts that the identical map on Γ∞ (E) is compact (Arzelà–Ascoli). We
s2
s1
conclude that the inclusion Hloc
(E) ⊆ Hloc
(E) is compact. Similarly, one shows that the
inclusion Hcs2 (E) ⊆ Hcs1 (E) is compact.
To prove (g) we have to show that every diﬀerential operator D ∈ DOr (E, F ) of Heisens
berg order at most r < s − n/2 induces a continuous operator Hloc
(E) → Γ(F ). By Propo′
r−s
sition 3.9(c), DΛs ∈ Ψprop (E, F ) induces a continuous operator DΛ′s : L2loc (E) → Γ(F ) and,
s
thus, DΛ′s Λs : Hloc
(E) → Γ(F ) is continuous. Since the inclusion Γ∞ (E) ⊆ Γ(E) is con−∞
tinuous, DRs ∈ Oprop
(E, F ) induces a continuous operator DRs : L2 (E) → Γ(F ). Using
′
s
D = DΛs Λs + DRs , we conclude that D : Hloc
(E) → Γ(F ) is indeed continuous, whence the
s
r
continuous inclusion Hloc (E) ⊆ Γ (E). Analogously, one veriﬁes the continuous inclusion
Hcs (E) ⊆ Γrc (E), provided r < s − n/2.

Remark 3.22. For non-degenerate CR manifolds a boundedness statement as in Proposition 3.21(d) can be traced back to [27, Theorem 15.19]. For Heisenberg manifolds satisfying
the bracket generating condition H + [H, H] = T M a similar statement has been established
in [46, Proposition 5.5.8].
r
Remark 3.23. Given r ∈ N0 one might wonder if the space Hloc
(E) can be characterized as the space of all ψ ∈ Γ−∞ (E) such that Dψ ∈ L2loc (F ) for all diﬀerential operators
D ∈ DOr (E, F ) of Heisenberg order at most r; and if these diﬀerential operators suﬃce to

42

r
generate the topology on Hloc
(E). Moreover, one might ask if Γr (E) includes (continuously)
r
in Hloc (E), see Remark 2.3. For general M and r neither of these properties will
true.
Lhold
m
−j
However, if r is a common multiple of {1, 2, . . . , m} where m is such that tM = j=1 t M,
then the universal diﬀerential operator j r ∈ DOr (E, J r E), see Remark 2.4, satisﬁes the
Rockland condition and we obtain aﬃrmative answers to all the questions above. This will
remain true for the more values of r, the more non-commutative the osculating algebras are.
If T −1 M is bracket generating, this holds true for all r, cf. [27, 2, 46]. Similar remarks apply
to the compactly supported case.

This Sobolev scale permits to reﬁne the hypoellipticity statement in Theorem 3.13, providing a common generalization of well known results, see for instance [46, Propositions 5.5.9
and 5.5.14], [27, Theorem 16.6], [33], and [2, Theorem 18.31].
Corollary 3.24 (Regularity and maximal hypoelliptic estimate). Let E and F be vector
bundles over a filtered manifold M, and suppose A ∈ Ψk (E, F ) satisfies the Rockland cons−ℜ(k)
dition where k is some complex number. If ψ ∈ Γ−∞
(F ) for some
c (E) and Aψ ∈ Hloc
real number s, then ψ ∈ Hcs (E). If, moreover, M is closed and s̃ ≤ s, then there exists a
constant C = CA,s,s̃ ≥ 0 such that the maximal hypoelliptic estimate

kψkH s(E) ≤ C kψkH s̃ (E) + kAψkH s−ℜ(k) (F )

holds for all ψ ∈ H s (E). Here we are using any norms generating the Hilbert space topologies
on the corresponding Heisenberg Sobolev spaces. If, moreover, Q denotes the orthogonal
projection, with respect to an inner product of the form (6), onto the (finite dimensional)
subspace ker(A) ⊆ Γ∞ (E), then there exists a constant C = CA,s ≥ 0 such that the maximal
hypoelliptic estimate

kψkH s (E) ≤ C kQψkker(A) + kAψkH s−ℜ(k) (F )
holds for all ψ ∈ H s (E). Here k − kker(A) denotes any norm on ker(A).

Proof. For the ﬁrst part use a left parametrix as in Theorem 3.13 and Proposition 3.21(a)&(d).
To see the second hypoelliptic estimate, observe that A∗ A ∈ Ψ2ℜ(k) (E) satisﬁes the Rockland condition and ker(A∗ A) = ker(A). Hence, B := (A∗ A + Q)−1 A∗ ∈ Ψ−k (F, E), see
Corollary 3.14, and id = Q + BA.

Remark 3.25. Let us complement the regularity statement above with the following description of the topologies on the Heisenberg Sobolev spaces. Suppose A ∈ Ψkprop (E, F )
s
satisﬁes the Rockland condition and put s = ℜ(k). Then the topologies on Hloc
(E) and
s
Hc (E) coincide with the topologies induced from the embeddings
(A,id)

s
Hloc
(E) −−−→ L2loc (F ) × Γ−∞ (E)

and

(A,id)

Hcs (E) −−−→ L2c (F ) × Γ−∞
c (E),

respectively. Moreover, if B ∈ Ψ−r
prop (F, E) is a left parametrix such that R := BA − id is a
s
smoothing operator, see Theorem 3.13, then the topologies on Hloc
(E) and Hcs (E) coincide
with the topologies induced from the embeddings
(A,R)

s
Hloc
(E) −−−→ L2loc (F ) × Γ∞ (E)

and

(A,R)

Hcs (E) −−−→ L2c (F ) × Γ∞
c (E),

respectively. Indeed, B − R provides a continuous left inverse for the ﬁrst two inclusions;
and B − id provides a continuous left inverse for the other two inclusions.
43

Accordingly, the Hodge type decomposition for formally selfadjoint Rockland operators
on closed ﬁltered manifolds in Corollary 2.11 admits the following reﬁnement:
Corollary 3.26 (Hodge decomposition). Let E be a vector bundle over a closed filtered
manifold M. Suppose A ∈ Ψk (E) satisfies the Rockland condition and is formally selfadjoint,
A∗ = A, with respect to an L2 inner product of the form (6). Moreover, let Q denote the
orthogonal projection onto the (finite dimensional) subspace ker(A) ⊆ Γ∞ (E). Then, for
every real number s, we have a topological isomorphism and a Hodge type decomposition

∼
=
→ H s (E),
H s (E) = ker(A) ⊕ A H s+ℜ(k) (E) .
A + Q : H s+ℜ(k) (E) −
Proof. This follows from Corollary 3.14 and Proposition 3.21(d).



Corollary 2.12 admits the following reﬁnement:
Corollary 3.27. Let E and F be a vector bundles over a closed filtered manifold M. Suppose
A ∈ Ψk (E, F ) satisfies the Rockland condition, and let A∗ ∈ Ψk̄ (F, E) denote the formal
adjoint with respect to L2 inner products of the form (6). Then, for every real number s, we
have a Hodge type decomposition

H s (E) = ker(A) ⊕ A∗ H s+ℜ(k)(F ) .
Proof. Apply Corollary 3.26 to the operator A∗ A, observe that A∗ A satisﬁes the Rockland
condition, and use ker(A∗ A) = ker(A).


Corollary 3.28 (Fredholm operators and index). Let E and F be a vector bundles over a
closed filtered manifold M. Suppose A ∈ Ψk (E, F ) is such that A and At both satisfy the
Rockland condition, cf. Remark 3.19. Then, for every real number s, we have an induced
Fredholm operator A : H s (E) → H s−ℜ(k) (F ) whose index is independent of s and can be
expressed as
ind(A) = dim ker(A) − dim ker(At ).
Moreover, this index only depends on the Heisenberg principal cosymbol σ k (A) ∈ Σk (E, F ).
Proof. According to Remark 3.18 there exists a parametrix B ∈ Ψ−k (F, E) such that BA−id
and AB − id are both smoothing operators. Since the inclusion Γ∞ (E) ⊆ H s (E) is compact,
see Proposition 3.21(f), smoothing operators are compact on the Sobolev spaces H s (E)
and H s−ℜ(k) (F ), respectively. Hence, B : H s−ℜ(k)(F ) → H s (E) provides an inverse of A
mod compact operators. Consequently, A : H s (E) → H s−ℜ(k) (F ) is Fredholm. Moreover,
the canonical pairing induces a canonical isomorphism coker(A) = ker(At ), see Proposition 3.21(c), whence the index formula above. By regularity, ker(A) and ker(At ) consist of
smooth sections and, thus, do not depend on s. If A′ ∈ Ψk (E, F ) is another operator with
the same Heisenberg principal cosymbol, σ k (A′ ) = σ k (A), then A′ − A ∈ Ψk−1(E, F ) in view
of Proposition 3.4(b), hence A′ − A : H s (E) → H s−ℜ(k) (F ) is a compact operator according
to Proposition 3.21(d)&(f), and thus ind(A′ ) = ind(A).

Let us now apply these results to the Rockland sequences considered in Section 2.4. Recall
that the Rumin–Seshadri operators ∆i satisfy the Rockland condition, see Lemma 2.18.
Hence, the reﬁned regularity statement in Corollary 3.24 applies to ∆i . Moreover, since
∆i is formally selfadjoint, we have Hodge type decompositions and maximal hypoelliptic
estimates for ∆i as in Corollary 3.26, provided the underlying manifold is closed. For the
Rockland sequences, we immediately obtain the following reﬁnement of Corollary 2.19.
44

Corollary 3.29 (Regularity and maximal hypoelliptic estimate). In the situation of Corols−k
s−ki
lary 2.19, if ψ ∈ Γ−∞ (Ei ) is such that Ai ψ ∈ Hloc
(Ei+1 ) and A∗i−1 ∈ Hloc i−1 (Ei−1 ) for
s
some real number s, then ψ ∈ Hloc
(Ei ). Moreover, if M is closed, then there exists a constant C = CAi ,s ≥ 0 such that the maximal hypoelliptic estimate


∗
kψkH s (Ei ) ≤ C kAi−1 ψkH s−ki−1 (Ei−1 ) + kQi ψkker(∆i ) + kAi ψkH s−ki (Ei+1 )

holds for all ψ ∈ H s (Ei ). Here k − kH s (Ei ) are any norms generating the Hilbert space
topology on the Heisenberg Sobolev spaces H s (Ei ), Qi denotes the orthogonal projection onto
the (finite dimensional) subspace ker(∆i ) = ker(A∗i−1 ) ∩ ker(Ai ) ⊆ Γ∞ (Ei ), and k − kker(∆i )
denotes any norm on ker(∆i ).
For Rockland complexes over closed manifolds we immediately obtain the following Hodge
decomposition, reﬁning the statement in Corollary 2.20:
Corollary 3.30 (Hodge decomposition). In the situation of Corollary 2.20 we have
H s (Ei ) = Ai−1 (H s+ki−1 (Ei−1 )) ⊕ ker(∆i ) ⊕ A∗i (H s+ki (Ei+1 ))
and
ker(Ai |H s (Ei ) ) = Ai−1 (H s+ki−1 (Ei−1 )) ⊕ ker(∆i ),
for every real number s.
Remark 3.31. For the ∂¯ complex on a non-degenerate CR manifold the preceding statement
can be found in [27, Theorem 17.1] for s = 0.
The preceding two corollaries remain true for Rockland sequences of pseudodiﬀerential
operators. We will formulate this precisely and more generally in Section 5 below.
4. Graded hypoelliptic sequences

The de Rham diﬀerentials on a ﬁltered manifold will in general have Heisenberg order
strictly larger than one, and the de Rham complex will in general not be Rockland in the
sense of Deﬁnition 2.14. In this section we will see that the de Rham complex is, however,
Rockland in an appropriate graded sense. More generally, this remains true for the sequence
obtained by extending a linear connection to vector bundle valued diﬀerential forms, provided
the curvature satisﬁes an algebraic condition, see Proposition 4.17 below. Regarding these
de Rham sequences as graded Rockland sequences, permits to extract (split oﬀ) graded
Rockland sequences of (higher order) diﬀerential operators acting between vector bundles of
smaller rank, see Theorem 4.19 and Corollary 4.20 below. Since all curved BGG sequences
[12, 9] of regular parabolic geometries appear in this way, the latter are all graded Rockland,
see Corollary 4.23 below. In some cases, the sequences thus obtain are even Rockland in
the ungraded sense of Section 2.4. In particular, this is happens for the BGG sequences
associated with a generic rank two distribution in dimension ﬁve, see Example 4.24 below.
The construction we will present in Sections 4.2 and 4.3 below extends parts of the BGG
machinery [12, 9, 14] to more general ﬁltered manifolds, and reproduces the “torsion free”
[9] BGG sequences on regular parabolic geometries, see Section 4.6. We will keep track of
the graded Heisenberg principal symbol throughout the construction to conclude that the
resulting sequence is graded Rockland. The fundamental object we construct is a natural differential projector, see Lemma 4.4(b), which restricts and descends to the splitting operator
45

in the classical BGG setup. Combining this diﬀerential projector with splittings of the ﬁltrations, we obtain an (unnatural) invertible diﬀerential operator which we use to conjugate
the original sequence. On the level of graded principal Heisenberg symbol, the conjugated
sequence decouples as a direct sum of two graded Rockland sequences, see Proposition 4.5
below. One of these two sequences generalizes the curved BGG sequence. If the original
sequence was a complex, then the conjugated complex decomposes as a direct sum of this
generalized BGG complex and a complementary complex which is conjugate to an acyclic
tensorial complex. We hope that this decomposition will prove useful when comparing analytic torsion of BGG complexes [55] with the Ray–Singer torsion [48] of the full de Rham
complex. As an example we will work out explicitly, how the Rumin complex appears as a
direct summand in the de Rham complex, see Example 4.21 below.
4.1. Filtered vector bundles and differential operators. In this section we introduce
the ﬁltration by graded Heisenberg order on diﬀerential operators acting between sections
of ﬁltered vector bundles over ﬁltered manifolds. We discuss the corresponding graded
Heisenberg principal symbol and establish some of its basic properties. For trivially ﬁltered
vector bundles these concepts reduce to the ﬁltration by Heisenberg order and the principal
Heisenberg symbol discussed in Section 2.2 above.
Let M be a ﬁltered manifold. Suppose E is a ﬁltered vector bundle over M, i.e., a smooth
vector bundle which comes equipped with a ﬁltration by smooth subbundles,
· · · ⊇ E p−1 ⊇ E p ⊇ E p+1 ⊇ · · · .
S
T
We will always assume that the ﬁltration is full, that is, E = p E p and p E p = 0. Put
L
grp (E) := E p /E p+1 and let gr(E) := p grp (E) denote the associated graded vector bundle
L
equipped with the ﬁltration by the subbundles grq (E) := q≤p grp (E). By a splitting of the
filtration on E we mean a ﬁltration preserving vector bundle isomorphism SE : gr(E) → E
which induces the identity on the level of associated graded, gr(SE ) = idgr(E) . More explicitly,
SE maps grp (E) into E p such that the composition with the projection E p → E p /E p+1 =
grp (E) is the identity. Such splittings always exist, in fact the space of all splittings is convex,
hence contractible.
Suppose F is another ﬁltered vector bundle over M, and let SF : gr(F ) → F be a splitting
for its ﬁltration. A diﬀerential operator A ∈ DO(E, F ) is said to have graded Heisenberg
order at most k if the operator SF−1 ASE ∈ DO(gr(E), gr(F )) has the following property:
The component (SF−1 ASE )q,p ∈ DO(grp (E), grq (F )) in the decomposition according to the
P
gradings, SF−1 ASE = p,q (SF−1 ASE )q,p , has Heisenberg order at most k + q − p. Consider
the Heisenberg principal symbols of these components,
σxk+q−p ((SF−1 ASE )q,p ) : C ∞ (Tx M, grp (Ex )) → C ∞ (Tx M, grq (Fx )),
see Section 2.2, and deﬁne the graded Heisenberg principal symbol
σ̃xk (A) : C ∞ (Tx M, gr(Ex )) → C ∞ (Tx M, gr(Fx ))
by
σ̃xk (A) :=

X
p,q


σxk+q−p (SF−1 ASE )q,p .
46

This is a left invariant diﬀerential operator which is homogeneous of degree k in the graded
sense, that is, σ̃xk (A) ◦ lg∗ = lg∗ ◦ σ̃xk (A) and
∗
∗
◦ σ̃xk (A)
= λk · δλFx ◦ δλ,x
σ̃xk (A) ◦ δλEx ◦ δλ,x

for all g ∈ Tx M and λ > 0, see (14). Here δλEx ∈ Aut(gr(Ex )) denotes the isomorphism given
by multiplication with λp on the component grp (Ex ). Equivalently, the graded Heisenberg
principal symbol at x can be considered as an element of the degree −k component of
U(tx M) ⊗ hom(gr(Ex ), gr(Fx )), that is,
M

σ̃xk (A) ∈ U(tx M) ⊗ hom(gr(Ex ), gr(Fx )) −k :=
U−k+q−p (tx M) ⊗ hom(grp (Ex ), grq (Fx )).
p,q

Note that any two splittings of a ﬁltered vector bundle diﬀer (multiplicatively) by a ﬁltration
preserving vector bundle isomorphism inducing the identity on the associated graded. Thus,
the ﬁltration of diﬀerential operators by graded Heisenberg order does not depend on the
choice of splittings SE and SF , and the graded principal Heisenberg symbol is independent
of this choice too. We obtain a short exact sequence

 
σ̃k
g k (E, F ) −
g k−1 (E, F ) → DO
→ Γ∞ U(tM) ⊗ hom(gr(E), gr(F )) −k → 0
0 → DO
k

g (E, F ) denotes the space of diﬀerential operators in DO(E, F ) which are of graded
where DO
Heisenberg order at most k.
If G is another ﬁltered vector bundle, and B ∈ DO(F, G) is a diﬀerential operator of graded
Heisenberg order at most l, then the composition BA ∈ DO(E, G) has graded Heisenberg
order at most l + k and
σ̃xl+k (BA) = σ̃xl (B)σ̃xk (A).
(60)
t
′
′
This follows readily from (9). Moreover, the transposed operator A ∈ DO(F , E ) is of
graded Heisenberg order at most k and
σ̃xk (At ) = σ̃xk (A)t .

(61)

Here the ﬁltration on the bundle E ′ = E ∗ ⊗ |Λ|M = hom(E, |Λ|M ) is deﬁned such that a
section of E ′ is in ﬁltration degree p iﬀ it pairs E q into the (p + q)-th ﬁltration subspace
of the trivially ﬁltered line bundle |Λ|M = |Λ|0M ⊇ |Λ|1M = 0, i.e. iﬀ it vanishes on E −p+1 .
Note that the canonical isomorphism grp (E ′ ) = hom(E −p /E −p+1, |Λ|M ) = gr−p (E)′ provides
a canonical isomorphism of ﬁltered vector bundles gr(E ′ ) = gr(E)′ . 6 If SE : gr(E) → E is
a splitting of the ﬁltration on E, then SEt : E ′ → gr(E)′ = gr(E ′ ) is ﬁltration preserving and
SE ′ := (SEt )−1 : gr(E ′ ) → E ′ is a splitting of the ﬁltration on E ′ . Moreover, (SE−1′ At SF ′ )p,q =
((SF−1 ASE )−q,−p )t = ((SF−1 ASE )t )p,q and thus (61) follows at once from (9).
g k (E, F ) of graded Heisenberg order at
Remark 4.1. Every diﬀerential operator A ∈ DO
most k maps Γ∞ (E p ) into Γ∞ (F p−k ). Indeed, (SF−1 ASE )q,p = 0 for k + q − p < 0 since there
are no non-trivial diﬀerential operators of negative order. Moreover, the induced operator
grk (A) : Γ∞ (grp (E)) → Γ∞ (grp−k (F )) is tensorial and the corresponding vector bundle homomorphism grk (A) : grp (E) → grp−k (F ) coincides with the corresponding component of
the graded principal Heisenberg symbol, (σ̃ k (A))p−k,p.
L
degree p ﬁltration subbundle of gr(E) is gr(E)p = q≥p grq (E) and thus the ﬁltration on gr(E)′
L
L
canonically identiﬁes to (gr(E)′ )p = q≤−p grq (E)′ = q≤−p gr−q (E ′ ) = gr(E ′ )p .
6The

47

Generalizing Deﬁnition 2.14 we have:
Definition 4.2 (Graded Rockland sequences of diﬀerential operators). Let Ei be ﬁltered
vector bundles over a ﬁltered manifold M. A sequence of diﬀerential operators
Ai−1

A

i
· · · → Γ∞ (Ei−1 ) −−−→ Γ∞ (Ei ) −→
Γ∞ (Ei+1 ) → · · ·

which are of graded Heisenberg order at most ki , respectively, is said to be graded Rockland sequence if, for each x ∈ M and every non-trivial irreducible unitary representation
π : Tx M → U(H) of the osculating group Tx M the sequence
k

k

π(σ̃xi−1 (Ai−1 ))

π(σ̃xi (Ai ))

· · · → H∞ ⊗ gr(Ei−1,x ) −−−−−−−−−→ H∞ ⊗ gr(Ei,x ) −−−−−−→ H∞ ⊗ gr(Ei+1,x ) → · · ·
is weakly exact, i.e., the image of each arrow is contained and dense in the kernel of the
subsequent arrow. Here H∞ denotes the subspace of smooth vectors in the Hilbert space H.
4.2. Differential projectors. In this section we consider a sequence of diﬀerential operators
acting between sections of ﬁltered vector bundles over a ﬁltered manifold. Following the
BGG machinery [12, 9, 14] we will present a construction which permits to extract (split
oﬀ) sequences of diﬀerential operators acting between sections of certain subbundles. If the
original sequence was graded Rockland, then so is the new one, see Proposition 4.5(b) below.
The construction is based on the following simple fact which will be used repeatedly below.
A similar argument can be found in the construction of curved BGG sequences, see [12] and
[9, Theorem 5.2].
Lemma 4.3. Let E and F be filtered vector bundles over a filtered manifold M. Suppose
A : Γ∞ (E) → Γ∞ (F ) is a differential operator of graded Heisenberg order at most zero and
suppose the induced vector bundle homomorphism, Ã : gr(E) → gr(F ), is invertible, cf.
Remark 4.1. Then A is invertible and its inverse, A−1 : Γ∞ (F ) → Γ∞ (E), is a differential
operator of graded Heisenberg order at most zero.
Proof. Choose splittings of the ﬁltrations SE : gr(E) → E and SF : gr(F ) → F . Then the
diﬀerential operator
id −ASE Ã−1 SF−1 : Γ∞ (F ) → Γ∞ (F )
is nilpotent for it induces zero on the associated graded. Hence, the inverse of A can be
expressed using the ﬁnite Neumann series,
∞ 
n
X
A−1 = SE Ã−1 SF−1
id −ASE Ã−1 SF−1 .
(62)
n=0

In view of this formula, A−1 has graded Heisenberg order at most zero.



Lemma 4.4. Consider a filtered vector bundle E over a filtered manifold M. Suppose
 : Γ∞ (E) → Γ∞ (E) is a differential operator of graded Heisenberg order at most zero,
˜ : gr(E) → gr(E) denote the associated graded vector bundle endomorphism, see
and let 
Remark 4.1. For each x ∈ M let P̃x ∈ end(gr(Ex )) denote the spectral projection onto the
˜ x ∈ end(gr(Ex )). Assume that the rank of P̃x is locally
generalized zero eigenspace of 
constant in x ∈ M.
48

˜ =
˜ P̃ ,
(a) Then P̃ : gr(E) → gr(E) is a smooth vector bundle homomorphism, P̃ 2 = P̃ , P̃ 
and we obtain a decomposition of graded vector bundles,
gr(E) = img(P̃ ) ⊕ ker(P̃ ),
(63)
˜ and such that 
˜ is nilpotent on img(P̃ ) and invertible on ker(P̃ ).
invariant under ,
(b) There exists a unique filtration preserving differential operator P : Γ∞ (E) → Γ∞ (E) such
˜ This operator P has graded Heisenberg order
that P 2 = P , P  = P , and gr() = .
at most zero and provides a decomposition of filtered vector spaces,
Γ∞ (E) = img(P ) ⊕ ker(P ),

(64)

which is invariant under  and such that  is nilpotent on img(P ) := P (Γ∞ (E)) and
invertible on ker(P ) := {ψ ∈ Γ∞ (E) : ψ = 0}.
(c) Let S : gr(E) → E be a splitting of the filtration. Then
L : Γ∞ (gr(E)) → Γ∞ (E),

L := P S P̃ + (id −P )S(id −P̃ ),

(65)

is an invertible differential operator of graded Heisenberg order at most zero such that
gr(L) = id and L−1 P L = P̃ . Hence, L induces filtration preserving isomorphisms
∼
=

L : Γ∞ (img(P̃ )) −
→ img(P )

and

∼
=

L : Γ∞ (ker(P̃ )) −
→ ker(P ).

Moreover, L−1 L is a differential operator of graded Heisenberg order at most zero
˜ Furthermore, L−1 L preserves the decomposition (63), its
satisfying gr(L−1 L) = .
∞
restriction to Γ (img(P̃ )) is nilpotent, and its restriction to Γ∞ (ker(P̃ )) is invertible.
Proof. Part (a) is well known. To prove the existence of an operator P as in (b) we assume,
˜ x lie outside
for a moment, that there exists ε > 0 such that all non-trivial eigenvalues of 
the disk of radius 2ε centered at the origin in the complex plane for all x ∈ M. Hence,
˜ is invertible, for all 0 < |z| < 2ε. According to
the vector bundle homomorphism z − 
−1
Lemma 4.3, (z − ) is a family of diﬀerential operators of graded Heisenberg order at
most zero depending rationally on z for |z| < 2ε. Hence,
I
1
P :=
(z − )−1 dz,
(66)
2πi |z|=ε

deﬁnes a diﬀerential operator of graded Heisenberg order at most zero. Clearly, P 2 = P
˜x =
andH P = P . Moreover, P is ﬁltration preserving and gr(P ) = P̃ in view of 
1
−1
˜ x ) dz. In particular, P gives rise to a decomposition of ﬁltered vector spaces
(z − 
2πi |z|=ε
which is invariant under  as indicated in (64). In general, the ε used above, will only exist
locally. However, since the operator in (66) does not depend on the choice of ε, these locally
deﬁned diﬀerential operators match up and give rise to a globally deﬁned diﬀerential operator
P with said properties. Using P 2 = P and P̃ 2 = P̃ , we immediately obtain P L = LP̃ . In
view of gr(P ) = P̃ and gr(S) = id, we have gr(L) = id, hence L is invertible according
to Lemma 4.3 and L−1 is a diﬀerential operator of graded Heisenberg order at most zero.
Since  preserves the decomposition (64), L−1 L preserves the decomposition (63). From
˜ Using the latter it is easy to see that  is nilpotent on
gr(L) = id, we get gr(L−1 L) = .
˜ is nilpotent on img(P̃ ), we conclude that
img(P ) and invertible on ker(P ). Indeed, since 
L−1 L is nilpotent on Γ∞ (img(P̃ )), and thus  is nilpotent on img(P ). Furthermore, since
˜ is invertible on ker(P̃ ), Lemma 4.3 implies that L−1 L is invertible on Γ∞ (ker(P̃ )), and

49

thus  is invertible on ker(P ). Using the latter property one readily checks the uniqueness
assertion in (b).

After these preparations let us now turn to the construction of the sequences mentioned
at the beginning of this section. Let Ei be ﬁltered vector bundles over a ﬁltered manifold
M, and consider a sequence of diﬀerential operators,
Ai−1

A

i
· · · → Γ∞ (Ei−1 ) −−−→ Γ∞ (Ei ) −→
Γ∞ (Ei+1 ) → · · · ,

(67)

such that Ai is of graded Heisenberg order at most ki . Suppose
δi+1

δ

· · · ← Γ∞ (Ei−1 ) ←
−i Γ∞ (Ei ) ←−− Γ∞ (Ei+1 ) ← · · ·

(68)

is a sequence of diﬀerential operators such that δi is of graded Heisenberg order at most
−ki−1 . Then the diﬀerential operators
i : Γ∞ (Ei ) → Γ∞ (Ei ),

i := Ai−1 δi + δi+1 Ai ,

(69)

are of graded Heisenberg order at most zero, see Section 4.1. 7
˜ i : gr(Ei ) → gr(Ei ), 
˜ i := gr(i ), denote the associated graded vector bundle
We let 
homomorphism, see Remark 4.1. Moreover, for each x ∈ M, we let P̃x,i : gr(Ex,i ) → gr(Ex,i )
˜ x,i ∈ end(gr(Ex,i )).
denote the spectral projection onto the generalized zero eigenspace of 
Note that the projectors P̃x,i preserve the grading on gr(Ex,i ). We assume that the rank
of P̃x,i is locally constant in x. Consequently, these ﬁber wise projectors provide a smooth
vector bundle projector P̃i : gr(Ei ) → gr(Ei ) and we obtain a decomposition of graded vector
bundles,
gr(Ei ) = img(P̃i ) ⊕ ker(P̃i ),
(70)
˜ i , see Lemma 4.4(a). By construction, 
˜ i is nilpotent on img(P̃i )
which is invariant under 
and invertible on ker(P̃i ). We let Ãi : gr∗ (Ei ) → gr∗−ki (Ei+1 ) and δ̃i : gr∗ (Ei ) → gr∗+ki−1 (Ei−1 )
denote the associated graded vector bundle homomorphisms of Ai and δi , respectively, see Re˜ i = Ãi−1 δ̃i + δ̃i+1 Ãi , see (69). If Ãi Ãi−1 = 0 for all i, then 
˜ i+1 Ãi = Ãi 
˜ i,
mark 4.1. Clearly, 
P̃i+1 Ãi = Ãi P̃i , and, thus, Ãi preserves the decompositions (70). Similarly, if δ̃i−1 δ̃i = 0 for
˜ i−1 δ̃i = δ̃i 
˜ i , P̃i−1 δ̃i = δ̃i P̃i , and δ̃i preserves the decompositions in (70).
all i, then 
According to Lemma 4.4(b), there exists a unique ﬁltration preserving diﬀerential operator
Pi : Γ∞ (Ei ) → Γ∞ (Ei )
such that Pi2 = Pi , Pi i = i Pi , and gr(Pi ) = P̃i . These projectors are of graded Heisenberg
order at most zero and provide a decomposition Γ∞ (Ei ) = img(Pi ) ⊕ ker(Pi ) such that i is
nilpotent on img(Pi ) and invertible on ker(Pi ).
We ﬁx splittings for the ﬁltrations, Si : gr(Ei ) → Ei , and consider the diﬀerential operators
Li : Γ∞ (gr(Ei )) → Γ∞ (Ei ),

Li := Pi Si P̃i + (id −Pi )Si (id −P̃i ).

In view of Lemma 4.4(c), Li is an invertible diﬀerential operator of graded Heisenberg order
−1
at most zero such that gr(Li ) = id and L−1
i Pi Li = P̃i . Moreover, Li i Li is a diﬀerential
˜
operator of graded Heisenberg order at most zero such that gr(L−1
i i Li ) = i . Furthermore,
7In

subsequent sections we will restrict our attention to the case when δi are (tensorial) vector bundle
homomorphisms satisfying δi δi+1 = 0, but these restrictions would not be helpful here.
50

∞
L−1
i i Li preserves the decomposition (70), its restriction to Γ (img(P̃i )) is nilpotent and its
restriction to Γ∞ (ker(P̃i )) is invertible.
Conjugating the original sequence (67) by Li , we obtain two sequences,
Di−1

D

i
· · · → Γ∞ (img(P̃i−1 )) −−−→ Γ∞ (img(P̃i )) −→
Γ∞ (img(P̃i+1 )) → · · ·

and

Bi−1

B

i
· · · → Γ∞ (ker(P̃i−1 )) −−−→ Γ∞ (ker(P̃i )) −→
Γ∞ (ker(P̃i+1 )) → · · · ,

(71)
(72)

where
Di := P̃i+1 L−1
i+1 Ai Li |Γ∞ (img(P̃i ))

Bi := (id −P̃i+1 )L−1
i+1 Ai Li |Γ∞ (ker(P̃i ))

and

(73)

are diﬀerential operators of graded Heisenberg order at most ki .
Proposition 4.5. In this situation the following hold true:
k

(a) If σ̃xki (Ai )σ̃xi−1 (Ai−1 ) = 0 for all i and x, then
ki
ki
σ̃xki (L−1
i+1 Ai Li ) = σ̃x (Di ) ⊕ σ̃x (Bi ).

(b) If the sequence (67) is graded Rockland, then so are the sequences (71) and (72).
(c) If Ai Ai−1 = 0 for all i, then the operator L−1
i+1 Ai Li decouples,
L−1
i+1 Ai Li = Di ⊕ Bi ,
and we have Di Di−1 = 0 = Bi Bi−1 . In this situation, Gi : Γ∞ (ker(P̃i )) → Γ∞ (ker(P̃i )),
˜ −1 + (id −P̃i )δ̃i+1 
˜ −1 Ãi ,
Gi := Bi−1 (id −P̃i−1 )δ̃i 
i
i+1
is an invertible differential operator of graded Heisenberg order at most zero with gr(Gi ) =
id that conjugates the complex (72) into an acyclic tensorial complex, that is,
G−1
i+1 Bi Gi = Ãi |Γ∞ (ker(P̃i )) .
Moreover, the restriction Li : Γ∞ (img(P̃i )) → Γ∞ (Ei ) provides a chain map, that is,
Ai Li |Γ∞ (img(P̃i )) = Li+1 Di , which induces an isomorphism between the cohomologies of
∞
∞
(71) and (67). More precisely, πi := P̃i L−1
i : Γ (Ei ) → Γ (img(P̃i )), is a chain map,
Di πi = πi+1 Ai , which is inverse up to homotopy, i.e., πi Li |Γ∞ (img(P̃i )) = id and id −Li πi =
Ai−1 hi +hi+1 Ai where hi : Γ∞ (Ei ) → Γ∞ (Ei−1 ) is a differential operator of graded Heisen−1
−1
˜ −1
berg order at most −ki−1 given by hi := Li−1 Gi−1 (id −P̃i )δ̃i 
i Gi (id −P̃i )Li .
Proof. To show part (c) suppose Ai Ai−1 = 0 for all i. Then i+1 Ai = Ai i , see (69), and
thus Pi+1 Ai = Ai Pi , see (66). Using the relation L−1
i Pi Li = P̃i from Lemma 4.4(c), we obtain
−1
−1
−1
P̃i+1 (Li+1 Ai Li ) = (Li+1 Ai Li )P̃i , hence P̃i+1 (Li+1 Ai Li )(id −P̃i ) = 0 = (id −P̃i+1 )(L−1
i+1 Ai Li )P̃i ,
−1
−1
L−1
i+1 Ai Li = P̃i+1 (Li+1 Ai Li )P̃i + (id −P̃i+1 )(Li+1 Ai Li )(id −P̃i ),

and thus L−1
i+1 Ai L = Di ⊕ Bi , cf. (73). Clearly, Ai Ai−1 = 0 implies Di Di−1 = 0 = Bi Bi−1
and Bi Gi = Gi+1 Ãi . Clearly, gr(Gi ) = id and, thus, Gi is invertible according to Lemma 4.3.
The remaining assertions in (c) are now straight forward.
k
To show part (a) suppose σ̃xki (Ai )σ̃xi−1 (Ai−1 ) = 0 for all i and all x ∈ M. Using the multiplicativity of the graded Heisenberg principal symbol, see (60), we conclude σ̃x0 (i+1 )σ̃xki (Ai ) =
σ̃xki (Ai )σ̃x0 (i ), see (69), and thus σ̃x0 (Pi+1 )σ̃xki (Ai ) = σ̃xki (Ai )σ̃x0 (Pi ), see (66). Combining this
51



with L−1
we obtain σ̃xki P̃i+1 (L−1
Ai Li ) = σ̃xki (L−1
Ai Li )P̃i ,
i Pi Li = P̃i from Lemma 4.4(c),
i+1
i+1


−1
ki
hence σ̃xki P̃i+1 (L−1
i+1 Ai Li )(id −P̃i ) = 0 = σ̃x (id −P̃i+1 )(Li+1 Ai Li )P̃i ,


ki
−1
ki
−1
σ̃xki (L−1
i+1 Ai Li ) = σ̃x P̃i+1 (Li+1 Ai Li )P̃i + σ̃x (id −P̃i+1 )(Li+1 Ai Li )(id −P̃i ) ,

ki
ki
and thus σ̃xki (L−1
i+1 Ai Li ) = σ̃x (Di ) ⊕ σ̃x (Bi ).
To see (b) suppose the sequence (67) is graded Rockland, that is, the graded Heisenberg
principal symbol sequences σxki (Ai ) are exact in every non-trivial irreducible unitary represen0
−1 ki
0
tation of Tx M. Clearly, the conjugated sequence σ̃xki (L−1
i+1 Ai Li ) = σ̃x (Li+1 ) σ̃x (Ai )σ̃x (Li )
k
has the same property. Note that σ̃xki (Ai )σ̃xi−1 (Ai−1 ) = 0 since this relation holds true in
every irreducible unitary representation of Tx M. Hence part (a), permits to conclude that
the graded Heisenberg principal symbol sequences σ̃xki (Di ) and σ̃xki (Bi ) are exact in every
non-trivial irreducible unitary representation of Tx M too. Hence, the sequences Di and Bi
are graded Rockland.


˜ i,x are locally constant in x ∈ M, then
Remark 4.6. If the δi are such that the spectra of 
˜ i,x , we
the construction discussed above can be reﬁned. In this case, for each eigenvalue λ of 
(λ)
let P̃i,x denote the spectral projection onto the corresponding generalized eigenspace. These
(λ)
ﬁber wise projectors give rise to a vector bundle projector P̃i on gr(Ei ) which preserves the
P (λ)
(λ) (µ)
(µ) (λ)
˜ i . Clearly,
grading and commutes with 
= id and P̃i P̃i = 0 = P̃i P̃i for any
λ P̃i
two diﬀerent eigenvalues λ 6= µ, and we obtain a decomposition of graded vector bundles,
M
(λ) 
img P̃i
(74)
gr(Ei ) =
λ

˜ i . Proceeding as in Lemma 4.4 above
where the ﬁnite direct sum is over all eigenvalues λ of 
one readily shows that there exists a unique ﬁltration preserving diﬀerential operator
(λ)

Pi
(λ)

(λ)

(λ)

: Γ∞ (Ei ) → Γ∞ (Ei )
(λ)

(λ)

(λ)

such that (Pi )2 = Pi , Pi i = i Pi , and gr(Pi ) = P̃i . These diﬀerential projectors
can be constructed using a contour integral as in (66), they are of Heisenberg order at most
P (λ)
(λ) (µ)
(µ) (λ)
zero, they satisfy the completeness relation λ Pi = id and Pi Pi = 0 = Pi Pi for
any two diﬀerent eigenvalues λ 6= µ, and they provide a ﬁnite decomposition of ﬁltered vector
spaces,
M
(λ) 
Γ∞ (Ei ) =
img Pi
λ

(λ)

such that i −λ is nilpotent on img(Pi ). Using splittings of the ﬁltrations, Si : gr(Ei ) → Ei ,
we obtain an invertible diﬀerential operator of graded Heisenberg order at most zero,
X (λ)
(λ)
L̂i : Γ∞ (gr(Ei )) → Γ∞ (Ei ),
L̂i :=
Pi Si P̃i ,
λ

(λ)

(λ)

such that gr(L̂i ) = id and L̂−1
i Pi L̂i = P̃i . Hence, L̂i restricts to isomorphisms of ﬁltered
vector spaces,
=
(λ)  ∼
(λ) 
Γ∞ img P̃i
−
→ img Pi
52

and L̂−1
i i L̂i is a diﬀerential operator of graded Heisenberg order at most zero which pre˜
serves the decomposition (74) and satisﬁes gr(L̂−1
i i L̂i ) = i . Conjugating the original
sequence (67) with L̂i we obtain sequences of diﬀerential operators, one for each λ,
(λ)

··· → Γ
(λ)

where Di

∞

Di−1
(λ)
(img(P̃i−1 )) −−−→

(λ)

D

(λ)

(λ)

Γ∞ (img(P̃i )) −−i→ Γ∞ (img(P̃i+1 )) → · · ·

(75)

(λ)

:= P̃i+1 L̂−1
i+1 Ai L̂i |img(P̃ (λ) ) is of graded Heisenberg order at most zero. For λ = 0
i

(0)

we recover the sequence discussed before, i.e., Di
have:

= Di . Similar to Proposition 4.5, we

L ki (λ)
k
(a) If σ̃xki (Ai )σ̃xi−1 (Ai−1 ) = 0 for all i and x, then σ̃xki (L̂−1
i+1 Ai L̂i ) =
λ σ̃x (Di ).
(b) If the sequence (67) is graded Rockland, then so is the sequence (75) for each λ.
L (λ)
−1
(c) If Ai Ai−1 = 0 for all i, then the operator L̂−1
and
i+1 Ai L̂i decouples as L̂i+1 Ai L̂i =
λ Di
(λ) (λ)
we have Di Di−1 = 0 for all λ and all i. For all λ 6= 0, the complex (75) is acyclic and
conjugate to an algebraic complex, that is, there exist invertible diﬀerential operators of
(λ)
(λ)
(λ)
graded Heisenberg order at most zero, Gi : Γ∞ (img(P̃i )) → Γ∞ (img(P̃i )), such that
(λ) (λ)
(λ)
(λ)
gr(Gi ) = id and (Gi+1 )−1 Di Gi = Ãi |Γ∞ (P̃ (λ) ) .
i

We conclude this section with an example for which we describe the operators P , L, D
and B more explicitly. The choice of ﬁltration is motivated by the ﬁltration on diﬀerential
forms on contact manifolds which will be discussed subsequently in Example 4.21.
Example 4.7. Consider vector bundles Ek = Ek′ ⊕ Ek′′ over a ﬁltered manifold, and a
sequence of diﬀerential operators, Ak : Γ∞ (Ek ) → Γ∞ (Ek+1 ). Introduce a ﬁltration on Ek
such that
Ek = Ekk ⊇ Ekk+1 ⊇ Ekk+2 = 0
where
Ekk+1 = Ek′′ .
We assume Ak is of graded Heisenberg order at most zero. Equivalently, Ak is of the form

 ′
ak ek
Ak =
bk −a′′k
′′
where bk : Γ∞ (Ek′ ) → Γ∞ (Ek+1
) is a diﬀerential operator of Heisenberg order at most two,
′
∞
′
∞
′
′′
ak : Γ (Ek ) → Γ (Ek+1 ) and a′′k : Γ∞ (Ek′′ ) → Γ∞ (Ek+1
) are two diﬀerential operators of
′′
′
Heisenberg order at most one, and ek : Ek → Ek+1 is a vector bundle homomorphism. Moreover, we consider an operator δk : Γ∞ (Ek ) → Γ∞ (Ek−1 ) of Heisenberg order at most zero,
that is, δk has the form


0 0
δk =
fk 0

′′
where fk : Ek′ → Ek−1
is a vector bundle homomorphism. For sake of simplicity in notation,
we will drop the subscript of the operators indicating the vector bundle. Clearly,








ef
0
0 e
0 0
ef 0
˜
 = [A, δ] =
, Ã =
, δ̃ =
, =
.
f a′ − a′′ f f e
0 0
f 0
0 fe

˜ is locally constant, i.e., the ranks of ef and f e are both locally
We assume that the rank of 
constant. Let P̃ = 1 − Q̃ denote the ﬁber wise spectral projection onto the generalized zero
53

˜ Introduce vector bundle projectors P̃ ′ = 1 − Q̃′ and P̃ ′′ = 1 − Q̃′′ such that
eigenspace of .


 ′
 ′
Q̃ 0
P̃
0
.
and
Q̃ =
P̃ =
0 Q̃′′
0 P̃ ′′
˜ is invertible
Since P̃ commutes with Ã and δ̃, we have P̃ ′ e = eP̃ ′′ and P̃ ′′ f = f P̃ ′. As 
†
′
′′
on ker P̃ , we may deﬁne a vector bundle homomorphism ek : Ek+1 → Ek such that ee† = Q̃′ ,
e† e = Q̃′′ , and e† P̃ ′ = 0 = P̃ ′′ e† .
Assume, moreover, A2 = 0, that is, (a′ )2 + eb = 0, (a′′ )2 + be = 0, a′ e = ea′′ , and ba′ = a′′ b.
In this situation, the diﬀerential projector P characterized in Lemma 4.4(b) is given by
 ′

P̃
0
P =
where
R := a′′ e† − e† a′ .
R P̃ ′′
Indeed, using Q̃′′ a′′ e† = e† a′ Q̃′ , we ﬁnd R = RP̃ ′ + P̃ ′′R and thus P 2 = P . Moreover,
[P̃ ′ , a′ ] = eR, [P̃ ′′ , a′′ ] = Re, bP̃ ′ − P̃ ′′ b = a′′ R + Ra′ and thus [A, P ] = 0. Obviously,
[δ, P ] = 0 and, consequently, [, P ] = 0. For the operator L in Lemma 4.4(c) we ﬁnd


id
0
L = P P̃ + QQ̃ =
,
−P̃ ′′ a′′ e† − e† a′ P̃ ′ id
where Q = id −P . Moreover, L−1 δL = δ̃,


ef
0
−1
L L =
,
P̃ ′′ (f a′ − a′′ f )P̃ ′ + Q̃′′ (f a′ − a′′ f )Q̃′ f e
and
−1

L AL =




P̃ ′a′ P̃ ′ + Q̃′ a′ Q̃′
e
.
P̃ ′′(a′′ e† a′ + b)P̃ ′ − Q̃′′ a′′ e† a′ Q̃′ −P̃ ′′ a′′ P̃ ′′ − Q̃′′ a′′ Q̃′′

The operators Dk : Γ∞ (img(P̃k )) → Γ∞ (img(P̃k+1 )) and Bk : Γ∞ (ker(P̃k )) → Γ∞ (ker(P̃k+1 ))
thus take the form




P̃ ′ a′ P̃ ′
P̃ ′ eP̃ ′′
Q̃′ a′ Q̃′
Q̃′ eQ̃′′
D=
and
B=
P̃ ′′ (a′′ e† a′ + b)P̃ ′ −P̃ ′′ a′′ P̃ ′′
−Q̃′′ a′′ e† a′ Q̃′ −Q̃′′ a′′ Q̃′′
w.r. to the decompositions img(P̃k ) = img(P̃k′ ) ⊕ img(P̃k′′ ) and ker(P̃k ) = ker(P̃k′ ) ⊕ ker(P̃k′′ ).
4.3. Splitting operators. The sequences (71) and (72) constructed above depend on the
operators Ai and δi , see (67) and (68) but also on the splittings Si : gr(Ei ) → Ei . We will
now specialize to a situation in which one can construct a variant of the sequence (71) which
does not depend on the splittings Si , but only on Ai and δi . The sequences obtain in this
way, see Proposition 4.10 below, generalize the curved BGG sequences [12, 9] discussed in
Section 4.6.
We continue to use the notation from the preceding sections. In particular, Ei are ﬁltered
vector bundles over a ﬁltered manifold M, and we consider a sequence,
Ai−1

A

i
· · · → Γ∞ (Ei−1 ) −−−→ Γ∞ (Ei ) −→
Γ∞ (Ei+1 ) → · · · ,

where Ai is a diﬀerential operator of graded Heisenberg order at most ki .
54

(76)

Definition 4.8 (Codiﬀerential of Kostant type). A sequence of vector bundle homomorphisms,
δi+1

δ

· · · ← Ei−1 ←
−i Ei ←−− Ei+1 ← · · · ,

(77)

will be called a codifferential of Kostant type for the sequence (76) if it has the following
properties:
(i)
(ii)
(iii)
(iv)

δi δi+1 = 0 for all i.
p+k
δi maps the ﬁltration space Eip into Ei−1 i−1 .8
−1
There exist splittings of the ﬁltrations, Si : gr(Ei ) → Ei , such that δ̃i = Si−1
δi Si . 9
δ̃i,x P̃i,x = 0 for each x ∈ M.
˜ i : gr∗ (Ei ) → gr∗ (Ei )
Here Ãi : gr∗ (Ei ) → gr∗−ki (Ei+1 ), δ̃i : gr∗ (Ei ) → gr∗+ki−1 (Ei−1 ), and 
denote the vector bundle homomorphisms induced by Ai , δi and i = Ai−1 δi + δi+1 Ai on the
associated graded vector bundles, respectively, see Remark 4.1. Moreover, P̃i,x : Ei,x → Ei,x
˜ i,x .
denotes the spectral projection onto the generalized zero eigenspace of 
Lemma 4.9. Consider a sequence of vector bundle homomorphisms δi as in (77) which is a
codifferential of Kostant type for the sequence (76), see Definition 4.8, and assume that the
rank of δx,i is locally constant in x, for each i. Then the following hold true:
(a) The rank of P̃i,x is locally constant in x, these families provide smooth vector bundle
˜ i−1 δ̃i = δ̃i 
˜ i , P̃i 
˜i = 
˜ i P̃i ,
projectors, P̃i : gr(Ei ) → gr(Ei ), such that δ̃i δ̃i+1 = 0, 
P̃i−1 δ̃i = δ̃i P̃i = 0, and we have a decomposition of graded vector bundles,
ker(δ̃i ) = img(P̃i ) ⊕ img(δ̃i+1 ).

(78)

(b) Let Pi : Γ∞ (Ei ) → Γ∞ (Ei ) denote the unique filtration preserving differential operator
such that Pi2 = Pi , Pi i = i Pi and gr(Pi ) = P̃i , see Lemma 4.4(b). Then i−1 δi = δi i ,
Pi−1 δi = δi Pi = 0, and we obtain a decomposition of filtered spaces,
Γ∞ (ker(δi )) = img(Pi ) ⊕ Γ∞ (img(δi+1 )).

(79)

Moreover, the quotient bundle Hi := ker(δi )/ img(δi+1 ) is a filtered vector bundle and Pi
factors to a differential operator of graded Heisenberg order at most zero,
∼
=

→ img(Pi ) ⊆ Γ∞ (Ei ),
L̄i : Γ∞ (Hi ) −
which is inverse to the restriction of the canonical projection π̄i : ker(δi ) → Hi , that is,
π̄i L̄i = id and L̄i π̄i = Pi .
˜ i+1 Ãi = Ãi 
˜ i , P̃i+1 Ãi = Ãi P̃i ,
(c) Assume, moreover, Ãi+1 Ãi = 0 for all i. Then 
δ̃i+1 Ãi P̃i = 0, and
˜ i ) = ker(δ̃i ) ∩ ker(δ̃i+1 Ãi ).
img(P̃i ) = ker(

(80)

Moreover, δi+1 Ai Pi = 0, and
img(Pi ) = ker(i ) = ker(δi ) ∩ ker(δi+1 Ai ).
8In

particular, δi is of graded Heisenberg order at most −ki−1 .
the existence of such splittings is required, Si is not part of the data.

9Only

55

(81)

˜ i−1,x δ̃i,x = δ̃i,x 
˜ i,x and
Proof. In view of δ̃i−1,x δ̃i,x = 0 and δ̃i,x P̃i,x = 0 we also have 
˜
P̃i−1,x δ̃i,x = δ̃i,x P̃i,x = 0. Moreover, since Ãi−1,x δ̃i,x + δ̃i+1,x Ãi,x = i,x is invertible on
ker(P̃i,x ), it is straight forward to establish the ﬁnite dimensional decomposition ker(δ̃i,x ) =
img(P̃i,x ) ⊕ img(δ̃i+1,x ) for each x ∈ M. Since δ̃i,x is assumed to have locally constant rank,
the same must be true for P̃i,x . Hence, P̃i is a smooth vector bundle homomorphism, and (78)
is a decomposition of smooth vector bundles. The remaining assertions in (a) are obvious.
Clearly, δi i = i−1 δi and δi Pi = Pi−1 δi , see (69) and (66). To show δi Pi = 0, we consider
the operator
Li : Γ∞ (gr(Ei )) → Γ∞ (Ei ),

Li = Pi Si P̃i + (id −Pi )Si (id −P̃i ),

(82)

cf. (65) in Lemma 4.4, where the splittings Si are as in Deﬁnition 4.8(iii). Then L−1
i−1 δi Li = δ̃i
−1
and Li Pi Li = P̃i . The assertion δi Pi = 0 thus follows from δ̃i P̃i = 0, see Deﬁnition 4.8(iv).
Since Ai−1 δi + δi+1 Ai = i is invertible on ker(Pi ), it is now straight forward to establish
the decomposition (79). Clearly, img(δi+1 ), ker(δi ) and Hi = ker(δi )/ img(δi+1 ) are smooth
vector bundles. Moreover, Pi factorizes to a linear map L̄i : Γ∞ (Hi ) → img(Pi ) such that
L̄i π̄i = Pi and π̄i L̄i = id. To see that L̄i is a diﬀerential operator of graded Heisenberg order
at most zero, it suﬃces to observe that L̄i can be written as the composition of Pi with a
ﬁltration preserving vector bundle homomorphism Hi → ker(δi ).
˜ i+1 Ãi = Ãi 
˜ i , P̃i+1 Ãi = Ãi P̃i , and δ̃i+1 Ãi P̃i = 0, as
If Ãi Ãi−1 = 0, then the assertions 
well as the equalities in (80) are now obvious. Using i = δi+1 Ai + Ai−1 δi , δi Pi = 0 = Pi−1 δi ,
i Pi = Pi i and Pi2 = Pi , we obtain δi+1 Ai Pi = i Pi = Pi i Pi = 0, whence the equalities
in (81). The remaining assertions follow at once.

Proposition 4.10. Let Ei be filtered vector bundles over a filtered manifold M, and consider
a sequence of differential operators,
Ai−1

A

i
Γ∞ (Ei+1 ) → · · · ,
· · · → Γ∞ (Ei−1 ) −−−→ Γ∞ (Ei ) −→

(83)

such that Ai is of graded Heisenberg order at most ki and Ãi Ãi−1 = 0 for all i. Moreover, let
δi+1

δ

· · · ← Ei−1 ←
−i Ei ←−− Ei+1 ← · · ·
be a codifferential of Kostant type for the sequence (83), see Definition 4.8. Assume that
each δi has locally constant rank, and let π̄i : ker(δi ) → Hi := ker(δi )/ img(δi+1 ) denote the
canonical vector bundle projection. Then the following hold true:
(a) There exists a unique differential operator L̄i : Γ∞ (Hi ) → Γ∞ (Ei ) such that δi L̄i = 0,
π̄i L̄i = id, and δi+1 Ai L̄i = 0. Moreover, L̄i is of graded Heisenberg order at most zero,
and the differential operator
D̄i : Γ∞ (Hi ) → Γ∞ (Hi+1 ),

D̄i := π̄i+1 Ai L̄i ,

(84)

is of graded Heisenberg order at most ki .
(b) If the sequence (83) is graded Rockland, then so is the sequence:
D̄i−1

D̄

i
· · · → Γ∞ (Hi−1 ) −−−→ Γ∞ (Hi ) −→
Γ∞ (Hi+1 ) → · · · .

(85)

(c) If Ai Ai−1 = 0, then D̄i D̄i−1 = 0, and L̄i : Γ∞ (Hi ) → Γ∞ (Ei ) is a chain map, Ai L̄i =
L̄i+1 D̄i , inducing an isomorphism between the cohomologies of (85) and (83).
56

(d) There exist invertible differential operators, Vi : Γ∞ (img(P̃i )) → Γ∞ (Hi ) with inverse
Vi−1 : Γ∞ (Hi ) → Γ∞ (img(P̃i )), both of graded Heisenberg order at most zero, such that
−1
Vi+1
D̄i Vi = Di ,

where Di : Γ∞ (img(P̃i )) → Γ∞ (img(P̃i+1 )) denotes the operator considered in Section 4.2,
see (73), associated with splittings Si as in Definition 4.8(iii).
Proof. Part (a) follows immediately from Lemma 4.9(b)&(c). Recall the diﬀerential operator
Li associated with the splittings Si , see (82). The diﬀerential operator Vi : Γ∞ (img(P̃i )) →
Γ∞ (Hi ), Vi := π̄i Li |img(P̃i ) has graded Heisenberg order at most zero and so does its in−1
verse, Vi−1 : Γ∞ (Hi ) → Γ∞ (img(P̃i )), Vi−1 = L−1
i L̄i . Clearly, Vi+1 D̄i Vi = Di , whence (d).
Combining this with Proposition 4.5(b)&(c), we obtain the statements in (b) in (c).

The operators L̄i in Proposition 4.10(a) above are direct generalizations of the well known
splitting operators in parabolic geometry, see [13, Theorem 2.4]. The operators D̄i generalize
the BGG operators.
Remark 4.11. If the ﬁltration on each Hi is trivial, then (85) is a Rockland sequence in
the ungraded sense of Deﬁnition 2.14.
Remark 4.12. For the Kostant type codiﬀerential δi = 0 all statements in Proposition 4.10
are trivially true, π̄i = id = L̄i .
Remark 4.13. If Ãi Ãi−1 = 0, then the rank of a Kostant type codiﬀerential is bounded by
X
X
rank(δi,x ) ≤
rank(Ãi,x ).
(86)
i

i

Indeed, from δ̃i δ̃i+1 = 0 and δ̃i P̃i = 0 we get ker(δ̃i,x ) = img(P̃i,x ) ⊕ img(δ̃i+1,x ) and, consequently, ker(δi,x )/ img(δi+1,x ) ∼
= img(P̃i,x ). Moreover, Ãi,x preserves
= ker(δ̃i,x )/ img(δ̃i+1,x ) ∼
the decomposition gr(Ei ) = img(P̃i,x ) ⊕ ker(P̃i,x ) and its restriction to ker(P̃i,x ) is acyclic
˜ i,x is invertible on ker(P̃i,x ). We conclude
since 


dim ker(Ãi,x )/ img(Ãi−1,x ) ≤ dim ker(δi,x )/ img(δi+1,x )
(87)

for all i. To show (86) it thus remains to recall that the equation dim(C) = 2 rank(d) +
dim(ker(d)/ img(d)) holds for every ﬁnite dimensional vector space C and every linear map
d : C → C satisfying d2 = 0. Also note that we have equality in (86) if and only if we have
equality in (87) for all i. In this case the codiﬀerential is of maximal rank, and we have
Hx,i ∼
= ker(Ãi,x )/ img(Ãi−1,x ).

Remark 4.14. If Ãi Ãi−1 = 0, then there exists a Kostant type codiﬀerential of maximal
rank. To construct such a codiﬀerential, ﬁx ﬁber wise graded Hermitian inner products on the
graded vector bundles gr(Ei ), let Ã∗i : gr∗ (Ei+1 ) → gr∗−ki (Ei ) denote the ﬁber wise adjoint
of Ãi : gr∗ (Ei ) → gr∗+ki (Ei+1 ), and consider δi := Si−1 Ã∗i−1 Si−1 where Si : gr(Ei ) → Ei are
˜ i = Ã∗i Ãi + Ãi−1 Ã∗i−1 , hence img(P̃i,x ) =
some splittings for the ﬁltrations. In this case 
˜ i,x ) = ker(Ãi,x ) ∩ ker(δ̃i,x ) and
ker(
gr(Ei,x ) = img(Ãi−1,x ) ⊕ img(P̃i,x ) ⊕ img(δ̃i+1,x )
57

for each x ∈ M. We conclude that δ is a Kostant type codiﬀerential of maximal rank,
see Deﬁnition 4.8 and Remark 4.13. If the dimension of ker(Ãi,x )/ img(Ãi−1,x ) is locally
constant for all i, then δi,x has locally constant rank for all i, hence δi meets the assumptions
in Proposition 4.10, we obtain a sequence of operators D̄i as in (85), acting between sections
of the vector bundles
Hi ∼
= ker(Ãi )/ img(Ãi−1 ),
and this is a graded Rockland sequence provided the original sequence Ai was.
4.4. Linear connections on filtered manifolds. In this section we consider a linear connection on a ﬁltered vector bundle over a ﬁltered manifold and its extension to bundle valued
diﬀerential forms. We will show that this is a graded Rockland sequence in the sense of Deﬁnition 4.2 provided the linear connection is ﬁltration preserving and its curvature is contained
in ﬁltration degree one, see Proposition 4.17 below.
Suppose E is a ﬁltered vector bundle over a ﬁltered manifold M. We consider the induced
ﬁltration on the vector bundles Λk T ∗ M ⊗ E. To be explicit, ψ ∈ Λk Tx∗ M ⊗ Ex is in ﬁltration
degree p iﬀ, for all tangent vectors Xi ∈ Txpi M, we have ψ(X1 , . . . , Xk ) ∈ Exp+p1 +···+pk . Let
us introduce the following notation for the associated graded vector bundle:
C k (M; E) := gr(Λk T ∗ M ⊗ E) = Λk t∗ M ⊗ gr(E).
(88)
L
We will denote the grading by C k (M; E) = p C k (M; E)p .
Suppose ∇ is a linear connection on E such that ∇X ψ ∈ Γ∞ (E p+q ) for all X ∈ Γ∞ (T p M)
and ψ ∈ Γ∞ (E q ). In other words, ∇ : Γ∞ (E) → Ω1 (M; E), is assumed to be ﬁltration preserving. It is easy to see that ﬁltration preserving connections always exist, the space of
all such connections is aﬃne over the space of ﬁltration preserving vector bundle homomorphisms E → T ∗ M ⊗ E. The Leibniz rule implies that the induced operator on the associated
graded bundles, ω := gr(∇) : Γ∞ (gr(E)) → Γ∞ (gr(T ∗ M ⊗ E)), is tensorial, i.e.

ω ∈ Γ∞ C 1 (M; end(E))0
∗
where C 1 (M; end(E))
M ⊗end(E)) = t∗ M ⊗end(gr(E)) with 0-th grading component
L = gr(T
1
p
∗
C (M; end(E))0 = p,q (t M) ⊗ hom(grq (E), grp+q (E)). Let

d∇ : Ω∗ (M; E) → Ω∗+1 (M; E)

(89)

denote the usual extension of ∇ characterized by the Leibniz rule,
d∇ (α ∧ ψ) = dα ∧ ψ + (−1)k α ∧ d∇ ψ,

(90)

for all α ∈ Ωk (M) and all ψ ∈ Ω∗ (M; E). Recall the explicit formula
∇

(d ψ)(X0 , . . . , Xk ) =

k
X

(−1)i ∇Xi ψ(X0 , . . . , î, . . . , Xk )

i=0

+

X

(−1)i+j ψ([Xi , Xj ], X0 , . . . , î, . . . , ĵ, . . . , Xk ) (91)

0≤i<j≤k
k

for ψ ∈ Ω (M; E) and vector ﬁelds X0 , . . . , Xk .
Lemma 4.15. Let ∇ : Γ∞ (E) → Ω1 (M; E) be a filtration preserving linear connection on a
filtered vector bundle E over a filtered manifold M. Then the extension d∇ : Ωk (M; E) →
58

Ωk+1 (M; E) is a differential operator of graded Heisenberg order at most zero. Moreover, the
graded principal Heisenberg symbol at x ∈ M fits into the following commutative diagram:


C ∞ Tx M, Cxk (M; E)
Ωk Tx M; gr(Ex )
σ̃x0 (d∇ )



C ∞ Tx M, Cxk+1(M; E)

d+ωx ∧−





Ωk+1 Tx M; gr(Ex )



Here the horizontal identifications are obtained by tensorizing the identity on gr(Ex ) with
the identification C ∞ (Tx M, Λk t∗x M) = Ωk (Tx M) induced by left trivialization of the tangent
bundle of the group Tx M. Moreover, ωx ∈ Cx1 (M; end(E))0 is considered as a left invariant
end(gr(Ex ))-valued 1-form on Tx M.
Proof. This follows readily from (91) and (10). Alternatively, this can be understood as
follows. Let A : E → T ∗ M ⊗E be a ﬁltration preserving vector bundle homomorphism. Then
∇+A is another ﬁltration preserving linear connection on E, and ω ∇+A = ω ∇ + Ã where Ã =
gr(A) : gr(E) → gr(T ∗ M ⊗ E) denotes the associate graded vector bundle homomorphism
induced by A. Moreover, d∇+A = d∇ + A ∧ − and thus σ̃x0 (d∇+A ) = σ̃x0 (d∇ ) + Ãx ∧ −. We
conclude that the statement of the lemma holds for ∇ iﬀ it holds for ∇ + A. Since this
statement is local, and since the space of ﬁltration preserving linear connections on E is
aﬃne over the space of ﬁltration preserving vector bundle homomorphisms E → T ∗ M ⊗ E,
we may w.l.o.g. assume that ∇ is the trivial connection on a trivial bundle E = M × E0 .
By compatibility with direct sums, it suﬃces to consider the trivial line bundle E = M × C,
that is, we may assume d∇ = d, the de Rham diﬀerential on Ω∗ (M). In view of the Leibniz
rule, it suﬃces to show that d : Ωk (M) → Ωk+1 (M) has graded Heisenberg order at most
zero and σ̃x0 (d) = d, for k = 0, 1. This, however, can readily be checked.

Using the Leibniz rule (or Lemma 4.15 above), one readily checks that the diﬀerential
operator (89) is ﬁltration preserving. Moreover, the operator induced on the associated
graded is tensorial, given by a vector bundle homomorphism of bidegree (1, 0),
∂ ω : C k (M; E)p → C k+1 (M; E)p ,

∂ ω := gr(d∇ ),

(92)

ω

which can be characterized as the unique extension of C 0 (M; E) −
→ C 1 (M; E) satisfying the
Leibniz rule
∂ ω (α ∧ ψ) = ∂α ∧ ψ + (−1)k α ∧ ∂ ω ψ,
(93)
k ∗
∗
k ∗
k+1 ∗
for all α ∈ Λ tx M and ψ ∈ Cx (M; E). Here ∂ : Λ t M → Λ t M denotes the ﬁber wise
Chevalley–Eilenberg diﬀerential.
Lemma 4.16. For each x ∈ M the following are equivalent:
(a) The curvature Fx∇ ∈ Ω2x (M; end(E)) is contained in filtration degree one, that is, for all
Xi ∈ Txpi M and ψ ∈ Exp we have Fx∇ (X1 , X2 )ψ ∈ Exp+p1 +p2 +1 .
(b) ωx : tx M → end(gr(Ex )) provides a graded representation of the graded nilpotent Lie
algebra tx M on the graded vector space gr(Ex ).
(c) (∂xω )2 = 0.
(d) σ̃x0 (d∇ )2 = 0.
In this case, the Chevalley–Eilenberg differential of the Lie algebra tx M with coefficients in
the representation gr(Ex ) coincides with (92) at the point x.
59

Proof. Recall that (d∇ )2 = F ∇ ∧ − is tensorial. Using using (60) and Remark 4.1, we obtain
σ̃x0 (d∇ )2 = σ̃x0 ((d∇ )2 ) = grx ((d∇ )2 ) = grx (d∇ )2 = (∂xω )2 ,
whence the equivalences (a)⇔(c)⇔(d). The equivalence (b)⇔(c) is well known, and so are
the remaining assertions.

Proposition 4.17. Let ∇ : Γ∞ (E) → Ω1 (M; E) be a filtration preserving linear connection
on a filtered vector bundle E over a filtered manifold M. If the curvature of ∇ is contained
in filtration degree one, see Lemma 4.16, then
d∇

d∇

· · · → Ωk−1 (M; E) −→ Ωk (M; E) −→ Ωk+1 (M; E) → · · ·

(94)

is a graded Rockland sequence.
Proof. Fix x ∈ M, consider the nilpotent Lie group G := Tx M with Lie algebra g := tx M
and the g-module V := gr(Ex ), see Lemma 4.16. Hence, Cxk (M; E) = Λk g∗ ⊗ V . According
to Lemma 4.15, the Heisenberg principal symbol sequence
σ̃0 (d∇ )

x
· · · → C ∞ (G, Λk g∗ ⊗ V ) −−
−−→ C ∞ (G, Λk+1g∗ ⊗ V ) → · · ·

is isomorphic to the Chevalley–Eilenberg complex of the Lie algebra g with values in the
g-representation C ∞ (G) ⊗ V . More explicitley, if Xj is a basis of g and αj denotes the dual
basis of g∗ then, in U(g) ⊗ hom Λk g∗ ⊗ V, Λk+1g∗ ⊗ V , we have
X
X
(95)
1 ⊗ edαj iXj + 1 ⊗ ωx
σ̃x0 (d∇ ) =
Xj ⊗ eαj +
j

j



Here eαj ∈ hom Λk g∗ ⊗ V, Λk+1g∗ ⊗ V denotes the exterior product with αj ∈ g∗ ; iXj ∈
hom Λk g∗ ⊗ V, Λk−1 g∗ ⊗ V denotes the contraction with Xj ∈ g; edαj ∈ hom Λk−1g∗ ⊗
V, Λk+1 g∗ ⊗ V denotes the exterior product with dαj ∈ Λ2 g∗ ; and ωx ∈ hom Λk g∗ ⊗
V, Λk+1 g∗ ⊗ V denotes the exterior product with the representation ωx : g → end(V ).
Suppose π : G → U(H) is a non-trivial irreducible unitary representation on a Hilbert
space H, and let H∞ denote the space of smooth vectors. Using (95) one readily checks, see
Section 2.3, that the sequence
π(σ̃0 (d∇ ))

· · · → H∞ ⊗ Λk g∗ ⊗ V −−−x−−−→ H∞ ⊗ Λk+1 g∗ ⊗ V → · · ·
is isomorphic to the Chevalley–Eilenberg complex of the Lie algebra g with values in the grepresentation H∞ ⊗ V . Consequently, it remains to show that the Lie algebra cohomology
of g with coeﬃcients in the g-module H∞ ⊗ V vanishes, that is, H ∗ (g; H∞ ⊗ V ) = 0.
Since g is nilpotent, there exists a 1-dimensional subspace W ⊆ V on which g acts trivially.
The corresponding short exact sequence of g-modules, 0 → W → V → V /W → 0, yields a
short exact sequence of g-modules 0 → H∞ → H∞ ⊗ V → H∞ ⊗ V /W → 0 which, in turn,
gives rise to a long exact sequence:
∂

· · · → H q (g; H∞ ) → H q (g; H∞ ⊗ V ) → H q (g; H∞ ⊗ V /W ) −
→ H q+1 (g; H∞ ) → · · ·
Hence, by induction on the dimension of V , it suﬃces to show H q (g; H∞ ) = 0, for all q. The
statement thus follows from Lemma 4.18 below.

60

Lemma 4.18. Consider a non-trivial irreducible unitary representation of a finite dimensional simply connected nilpotent Lie group G on a Hilbert space H, and the associated
representation of the corresponding Lie algebra g on the space of smooth vectors H∞ . Then
the Lie algebra cohomology of g with coefficients in H∞ is trivial, that is, H ∗ (g; H∞ ) = 0.
Proof. The proof proceeds by induction on the dimension of g. Since g is nilpotent, there
exists a 1-dimensional central subalgebra z ⊆ g. Recall that there is a Hochschild–Serre
spectral sequence [34] converging to H ∗ (g; H∞ ) with E2 -term

E p,q ∼
= H p g/z; H q (z; H∞ ) .
2

Since the representation of G on the Hilbert space H is irreducible, z acts by scalars on H∞ ,
see [36, Theorem 5 in Appendix V]. If this action is non-trivial, then H ∗ (z; H∞ ) = 0 and,
consequently, the E2 -term vanishes. We may thus assume that the action of z on H∞ is
trivial. Hence, H ∗ (z; H∞ ) = H 0 (z; H∞ ) ⊕ H 1 (z; H∞ ) ∼
= H∞ ⊕ H∞ as g/z-modules.
Consider the closed connected central ideal Z := exp(z) in G, and note that G/Z is a
simply connected nilpotent Lie group with Lie algebra g/z. Since H∞ is dense in the Hilbert
space H, the ideal Z acts trivially on H, see [36, Theorem 4 in Appendix V]. Hence the
representation of G factors through a representation of G/Z on H. Clearly, this is a nontrivial irreducible unitary representation of G/Z whose space of smooth vectors coincides
with H∞ . Hence, H ∗ (g/z; H∞ ) = 0, by induction. We conclude H p (g/z; H ∗ (z; H∞ )) ∼
=
H p (g/z; H∞ ⊕ H∞ ) = H p (g/z; H∞ ) ⊕ H p (g/z; H∞ ) = 0. Thus the E2 -term vanishes, and the
proof is complete.

4.5. Subcomplexes of the de Rham complex. In this section we apply the observations
and constructions from Sections 4.2 and 4.3 to the de Rham sequence associated with a
ﬁltration preserving linear connection. This directly leads to the main result of this section,
see Theorem 4.19 and Corollary 4.20 below. In the subsequent Section 4.6 we will apply this
to the curved BGG sequences in parabolic geometry which appear as a special case of the
sequences considered here. In this section we will discuss how the Rumin complex ﬁts into
our picture and present a graded Rockland sequence for Engel structures.
Let ∇ be a ﬁltration preserving linear connection on a ﬁltered vector bundle E over a
ﬁltered manifold M, and consider its extension to E-valued diﬀerential forms characterized
by the Leibniz rule in (90),
d∇
k−1

d∇

k
· · · → Ωk−1 (M; E) −−→ Ωk (M; E) −→
Ωk+1 (M; E) → · · · .

(96)

Consider a sequence of diﬀerential operators
δk+1

δ

k
· · · ← Ωk−1 (M; E) ←
−
Ωk (M; E) ←−− Ωk+1 (M; E) ← · · ·

which are of graded Heisenberg order at most zero. Then the diﬀerential operator
k : Ωk (M; E) → Ωk (M; E),

∇
k := d∇
k−1 δk + δk+1 dk ,

is of graded Heisenberg order at most zero. Let
∂kω : C k (M; E) → C k+1 (M; E),

∂kω := gr(d∇
k ),

δ̃k : C k (M; E) → C k−1 (M; E),
˜ k : C k (M; E) → C k (M; E),


δ̃k := gr(δk ),
ω
˜ k := gr(k ) = ∂k−1

δ̃k + δ̃k+1 ∂kω ,
61

(97)

denote the associated graded vector bundle homomorphisms, see Remark 4.1, (88), and (92).
For each x ∈ M, let P̃k,x : Cxk (M; E) → Cxk (M; E) denote the spectral projection onto
˜ x,k : Cxk (M; E) → Cxk (M; E), the restriction of 
˜ k to
the generalized zero eigenspace of 
the ﬁber over x. Assume that the rank of P̃k,x is locally constant in x for each k. Then,
see Lemma 4.4(a), P̃k : C k (M; E) → C k (M; E) is a smooth vector bundle homomorphism,
˜k = 
˜ k P̃k , and we obtain a decomposition of graded vector bundles,
P̃k2 = P̃k , P̃k 
C k (M; E) = img(P̃k ) ⊕ ker(P̃k ),
(98)
˜ k . Moreover, 
˜ k is nilpotent on img(P̃k ) and invertible on ker(P̃k ).
which is invariant under 
According to Lemma 4.4(b), there exists a unique ﬁltration preserving diﬀerential operator
Pk : Ωk (M; E) → Ωk (M; E)
such that Pk2 = Pk , Pk k = k Pk , and gr(Pk ) = P̃k . This operator Pk has graded Heisenberg
order at most zero and provides a decomposition of ﬁltered vector spaces,
Ωk (M; E) = img(Pk ) ⊕ ker(Pk ),

(99)

invariant under k and such that k is nilpotent on img(Pk ) and invertible on ker(Pk ). If
S

k
Λk T ∗ M ⊗ E,
C k (M, E) = gr(Λk T ∗ M ⊗ E) −→

are splittings of the ﬁltrations, then according to Lemma 4.4(c)
Lk : Γ∞ (C k (M; E)) → Ωk (M; E),

Lk := Pk Sk P̃k + (id −Pk )Sk (id −P̃k ),

(100)

is an invertible diﬀerential operator of graded Heisenberg order at most zero such that
gr(Lk ) = id and L−1
k Pk Lk = P̃k . Hence, Lk induces ﬁltration preserving isomorphisms
∼
=

→ img(Pk )
Lk : Γ∞ (img(P̃k )) −

and

∼
=

→ ker(Pk ).
Lk : Γ∞ (ker(P̃k )) −

Moreover, L−1
k k Lk is a diﬀerential operator of graded Heisenberg order at most zero pre˜
serving the decomposition (98) and satisfying gr(L−1
k k Lk ) = k . Putting
∇
Dk := P̃k+1 L−1
k+1 dk Lk |Γ∞ (img(P̃k ))

∇
Bk := (id −P̃k+1 )L−1
k+1 dk Lk |Γ∞ (ker(P̃k ))

and

(101)

we obtain two sequences of diﬀerential operators,
Dk−1

D

k
Γ∞ (img(P̃k+1)) → · · ·
· · · → Γ∞ (img(P̃k−1)) −−−→ Γ∞ (img(P̃k )) −→

and

Bk−1

B

k
Γ∞ (ker(P̃k+1 )) → · · · ,
· · · → Γ∞ (ker(P̃k−1 )) −−−→ Γ∞ (ker(P̃k )) −→
all of which have graded Heisenberg order at most zero.
Combining Proposition 4.5 with Proposition 4.17, we immediately obtain:

(102)
(103)

Theorem 4.19. In this situation the following hold true:
(a) If the curvature of ∇ is contained in filtration degree one, cf. Lemma 4.16, then (102)
and (103) are both graded Rockland sequences.
∇
(b) If the curvature of ∇ vanishes, then the operator L−1
k+1 dk Lk decouples,
∇
L−1
k+1 dk Lk = Dk ⊕ Bk ,

and Dk Dk−1 = 0 = Bk Bk−1 for all k. In this situation, Gk : Γ∞ (ker(P̃k )) → Γ∞ (ker(P̃k )),
˜ −1 + (id −P̃k )δ̃k+1 
˜ −1 ∂kω ,
Gk := Bk−1 (id −P̃k−1 )δ̃k 
k

62

k+1

is an invertible differential operator of graded Heisenberg order at most zero with gr(Gk ) =
id that conjugates the complex (103) into an acyclic tensorial complex, that is,
ω
G−1
k+1 Bk Gk = ∂k |Γ∞ (ker(P̃k )) .

Moreover, the restriction Lk : Γ∞ (img(P̃k )) → Ωk (M; E) provides a chain map, d∇
k Lk |Γ∞ (img(P̃k )) =
Lk+1 Dk , inducing an isomorphism between the cohomologies of (102) and (96). More
k
∞
∇
precisely, πk := P̃k L−1
k : Ω (M; E) → Γ (img(P̃k )), is a chain map, Dk πk = πk+1 dk ,
∇
which is inverse up to homotopy, i.e., πk Lk |Γ∞ (img(P̃k )) = id and id −Lk πk = dk−1 hk +
k
k−1
hk+1 d∇
(M; E) is a differential operator of
k where the homotopy hk : Ω (M; E) → Ω
˜ −1 G−1 (id −P̃k )L−1 .
graded Heisenberg order at most zero given by hk := Lk−1 Gk−1(id −P̃k )δ̃k 
k
k
k
Combining Proposition 4.10 with Proposition 4.17 we immediately obtain:
Corollary 4.20. Let ∇ be a filtration preserving linear connection on a filtered vector bundle
E over a filtered manifold M whose curvature is contained in filtration degree one, and consider its extension to E-valued differential forms characterized by the Leibniz rule, see (90),
d∇

d∇

· · · → Ωk−1 (M; E) −→ Ωk (M; E) −→ Ωk+1 (M; E) → · · · .

(104)

Moreover, consider a codifferential of Kostant type, see Definition 4.8,
δi+1

δ

· · · ← Λk−1T ∗ M ⊗ E ←
−i Λk T ∗ M ⊗ E ←−− Λk+1T ∗ M ⊗ E ← · · · ,
which has locally constant rank, and let π̄k : ker(δk ) → Hk := ker(δk )/ img(δk+1 ) denote the
canonical vector bundle projection. Then the following hold true:
(a) There exists a unique differential operator L̄k : Γ∞ (Hk ) → Ωk (M; E) such that δk L̄k = 0,
π̄k L̄k = id, and δk+1 d∇
k L̄k = 0. Moreover, L̄k is of graded Heisenberg order at most zero.
(b) The differential operator
D̄k : Γ∞ (Hk ) → Γ∞ (Hk+1 ),

D̄k := π̄k+1 d∇
k Lk ,

is of graded Heisenberg order at most zero, and
D̄k−1

D̄

k
Γ∞ (Hk+1) → · · ·
· · · → Γ∞ (Hk−1 ) −−−→ Γ∞ (Hk ) −→

(105)

is graded Rockland sequence.
(c) If ∇ has vanishing curvature, then D̄k D̄k−1 = 0, and L̄k : Γ∞ (Hk ) → Ωk (M; E) provides
a chain map, d∇
k L̄k = L̄k+1 D̄k , inducing an isomorphism between the cohomologies of
(105) and (104).
(d) There exist invertible differential operators, Vi : Γ∞ (img(P̃i )) → Γ∞ (Hi ) with inverse
Vi−1 : Γ∞ (Hi ) → Γ∞ (img(P̃i )), both of graded Heisenberg order at most zero, such that
−1
Vi+1
D̄i Vi = Di ,

where Di : Γ∞ (img(P̃i )) → Γ∞ (img(P̃i+1 )) denotes the operator considered in Theorem 4.19, see (101), corresponding to splittings Sk as in Definition 4.8(iii).
The operators L̄k and D̄k in Corollary 4.20 are direct generalizations of the splitting
operators and the curved BGG operators in parabolic geometry, respectively. This aspect
will be addressed in Section 4.6 below. The diﬀerential projector Pk generalizes the operator
obtained by composing (5.1) with (5.2) in [9].
63

As a ﬁrst example we will now explain how Rumin’s complex [52, 53] appears among
the sequences (105) considered in Corollary 4.20. Hypoellipticity of this sequence has been
established by Rumin, see [53, Section 3]. Let us mention that Rumin and Seshadri [55] have
introduced an analytic torsion based on hypoelliptic Laplacians associated with Rumin’s
complex. We expect that their construction can be be extended to all (ungraded) sequences
appearing in Corollary 4.20(b).
We will present an approach to Rumin’s complex which uses a contact form and the associated splitting of the contact distribution. This leads to diﬀerential operators Lk providing a
decomposition of the de Rham complex as in Theorem 4.19(b). The Rumin complex appears
as a direct summand in the de Rham complex, the complementary complex is conjugate to
an acyclic tensorial complex.
Example 4.21 (Rumin complex). Let η be a contact form on a manifold M of dimension
2n + 1. The contact distribution turns M into a ﬁltered manifold,
T M = T −2 M ⊇ T −1 M ⊇ T 0 M = 0,

where

T −1 M := H := ker(η).

The induced ﬁltration on the de Rham complex takes has form
Ωk (M) = Ωk (M)k ⊇ Ωk (M)k+1 ⊇ Ωk (M)k+2 = 0
where Ωk (M)k+1 = {α ∈ Ωk (M) : ι∗ α = 0} denotes the space of diﬀerential forms which
vanish on the contact distribution. Here ι : H → T M denotes the inclusion and ι∗ : Ωk (M) →
Γ∞ (Λk H ∗ ) the corresponding restriction. The contact form provides a splitting for this
ﬁltration and gives rise to an identiﬁcation
α 7→ (ι∗ α, ι∗ iX α).
(106)
Ωk (M) ∼
= Γ∞ (Λk H ∗ ) ⊕ Γ∞ (Λk−1 H ∗ ),
Here X ∈ X(M) denotes the Reeb vector ﬁeld associated with η, that is, the unique vector
ﬁeld such that η(X) = 1 and iX dη = 0. Via the identiﬁcation (106), the non-trivial ﬁltration
subspace Ωk (M)k+1 corresponds to the second factor, Γ∞ (Λk−1H ∗ ).
To describe the de Rham diﬀerential, put ω := ι∗ dη ∈ Γ∞ (Λ2 H ∗ ) and let
ek : Λk H ∗ → Λk+2 H ∗ ,

ek ψ := ω ∧ ψ,

denote the vector bundle homomorphism given by wedge product with ω. Furthermore, let
ak : Γ∞ (Λk H ∗ ) → Γ∞ (Λk+1 H ∗ ),

ak ψ := ι∗ dψ̃,

where ψ̃ ∈ Ωk (M) denotes the unique form such that ι∗ ψ̃ = ψ and iX ψ̃ = 0. One readily
veriﬁes that ak is a diﬀerential operator of Heisenberg order at most one. Moreover, let
bk : Γ∞ (Λk H ∗ ) → Γ∞ (Λk H ∗ ),

bk ψ := LX ψ,

denote the operator given by Lie derivative with respect to the Reeb vector ﬁeld. Note
that the ﬂow of the Reeb vector ﬁeld preserves the contact bundle and, thus, gives rise to a
Lie derivative on sections of Λk H ∗ as indicated. Also note that bk is a diﬀerential operator
of Heisenberg order at most two. Via the identiﬁcation (106), the de Rham diﬀerential
dk : Ωk (M) → Ωk+1 (M) takes the form, see [54, Section 2],


ak ek−1
dk =
.
bk −ak−1
The contact form also provides an codiﬀerential δk : Ωk (M) → Ωk−2 (M). Indeed, since
ω ∈ Λ2 H ∗ is non-degenerate in each ﬁber, it provides an isomorphism of vector bundles,
64

♯ : H∗ ∼
= H, which leads to the symplectic dual, ♯ω ∈ Γ∞ (Λ2 H). Contraction with ♯ω
provides a vector bundle homomorphism
fk : Λk H ∗ → Λk−2 H ∗ ,

fk ψ := i♯ω ψ.

Via the identiﬁcation (106), the codiﬀerential is given by the matrix


0 0
δk :=
.
fk 0
Via the identiﬁcation (106) we have, cf. Example 4.7,


ek−2 fk
0
˜
k =
.
0
fk+1 ek−1

˜ recall that the action of e and f turn
To describe the
zero eigenspaces of 
L generalized
k ∗
the ﬁbers of
H into sl2 -modules, that is, ek−2 fk − fk+2 ek = (k − n) id. Hence,
k ΛL
k ∗
the vector bundle
k Λ H decomposed canonically into isotypical sl2 -components. This
decomposition gives rise to canonical vector bundle projections
P̃k′ : Λk H ∗ → ker(fk )

and

P̃k′′ : Λk H ∗ → ker(ek )

onto the primitive elements. One readily checks that

 ′
P̃k
0
P̃k =
′′
0 P̃k−1

˜ k.
coincides with the ﬁber wise spectral projection onto the generalized zero eigenspace of 
We conclude that δk is a Kostant type codiﬀerential of constant rank, see Deﬁnition 4.8.
Note that P̃k′ = 0 for all k > n, P̃n′ = P̃n′′ , and P̃k′′ = 0 for all k < n. Thus, the sequence
(102) is ungraded, taking the form:
D

D

0
1
0 → Γ∞ (ker(f0 )) −→
Γ∞ (ker(f1 )) −→
Γ∞ (ker(f2 )) → · · ·

Dn−1

Dn+1

D

n
· · · → Γ∞ (ker(fn−1 )) −−−→ Γ∞ (ker(fn )) −−→
Γ∞ (ker(en )) −−−→ Γ∞ (ker(en+1 )) → · · ·

D2n−1

D

· · · → Γ∞ (ker(e2n−2 )) −−−→ Γ∞ (ker(e2n−1 )) −−2n
→ Γ∞ (ker(e2n )) → 0. (107)
From Example 4.7 we obtain


P̃k′
0
Pk =
′′
ak−2 e†k − e†k+1 ak P̃k−1

and

Lk =




id
0
′′
−P̃k−1
ak−2 e†k − e†k+1 ak P̃k′ id

where the vector bundle homomorphism e†k : Λk H ∗ → Λk−2H ∗ is uniquely characterized by
′′
ek−2 e†k = Q̃′k := id −P̃k′ , e†k+2 ek = Q̃′′k := id −P̃k′′ and e†k P̃k′ = 0 = P̃k−2
e†k . Moreover,

′

for 0 ≤ k < n,
P̃k+1 ak |Γ∞ (ker(fk ))
†
′′
Dk = P̃n (an−1 en+1 an + bn )|Γ∞ (ker(fn )) for k = n, and
(108)

−P̃ ′′ a | ∞
for n < k ≤ 2n.
k k−1 Γ (ker(ek−1 ))
Using the identiﬁcation (106) to deﬁne invertible diﬀerential operators,


id
0
∞
k ∗
∞
k−1 ∗
k
,
Uk : Γ (Λ H ) ⊕ Γ (Λ H ) → Ω (M),
Uk :=
−ak−2 e†k − e†k+1 ak P̃k′ id
65

we ﬁnd
−1
Uk+1
dk Uk


 
′
P̃k+1
ak P̃k′
0
0 Q̃′k+1 ek−1 Q̃′′k−1
+
=
′′
0
0
P̃k′′(ak−1 e†k+1 ak + bk )P̃k′ −P̃k′′ ak−1 P̃k−1
|
{z
}


Dk

In other words, conjugating the de Rham complex with the diﬀerential operators Uk above,
it decomposes as a direct sum of the complex (107) and the acyclic tensorial complex:


· · · → Γ∞







0 ek 
0 ek−1 


0 0


 0 0
ker(P̃k−1 ) −−−−−−−−→ Γ∞ ker(P̃k ) −−−−−−→ Γ∞ ker(P̃k+1 ) → · · · .

Up to a conformal factor, the codiﬀerential δk : Ωk (M) → Ωk−1 (M) considered above does
not depend on the contact form η, but only on the contact distribution H. Consequently, the
vector bundle projections π̄k : ker(δk ) → Hk := ker(δk )/ img(δk+1 ) and the splitting operator
L̄k : Γ∞ (Hk ) → Ωk (M) in Corollary 4.20(a) only depend on the contact distribution too.
Hence, the corresponding Rockland complex, see (105) in Corollary 4.20(b),
D̄k−1

D̄

k
Γ∞ (Hk+1 ) → · · · ,
· · · → Γ∞ (Hk−1 ) −−−→ Γ∞ (Hk ) −→

D̄k = π̄k+1 dk L̄k , only depends on the contact distribution. One readily veriﬁes that this
complex is canonically isomorphic to Rumin’s complex, see [54]. By Corollary 4.20(d) the
latter is conjugate to the complex (107). Actually, a description of Rumin’s complex in the
form (107) with diﬀerential (108) is implicit in [54, Section 3].
We conclude this section with a 4-dimensional geometry for which the sequence in Theorem 4.19(b) turns out to be graded Rockland but not Rockland in the ungraded sense.
Example 4.22 (Engel structures). Recall that an Engel structure [47] on a smooth 4manifold M is a smooth rank two distribution T −1 M ⊆ T M with growth vector (2, 3, 4).
More explicitly, Lie brackets of sections of T −1 M generate a rank three bundle T −2 M, and
triple brackets of sections of T −1 M generate all of T M. Hence, M is a ﬁltered manifold,
T M = T −3 M ⊇ T −2 M ⊇ T −1 M ⊇ T 0 M = 0.
One readily checks that the bundle of osculating algebras is locally trivial with typical ﬁber
isomorphic to the graded nilpotent Lie algebra g = g−3 ⊕ g−2 ⊕ g−1 with non-trivial brackets
[X1 , X2 ] = X3 ,

[X1 , X3 ] = X4 ,

[X2 , X3 ] = 0,

where X1 , X2 is a basis of g−1 , X3 is a basis of g−2 and X4 is a basis of g−3 . If G denotes the
simply connected nilpotent Lie group with Lie algebra g, then the left invariant distribution
corresponding to g−1 provides an Engel structure on G. Locally, every Engel structure is
diﬀeomorphic to this left invariant structure. According to a result of Vogel [64], every closed
parallelizable smooth 4-manifold admits an (orientable) Engel structure.
We will exhibit explicit formulas for the graded Heisenberg principal symbol of the operators Dk in Theorem 4.19 corresponding to the de Rham complex, that is, the trivial ﬂat line
bundle E. We work on M = G equipped with the left invariant Engel structure mentioned
before. We use the left invariant splitting for S : gr(Λk T ∗ G) → Λk T ∗ G provided by the
decomposition g = g−3 ⊕ g−2 ⊕ g−1 . Moreover, we consider the left invariant codiﬀerential
δk : Λk T ∗ G → Λk−1T ∗ G which, at the identity, is dual to the Chevalley–Eilenberg diﬀerential ∂k−1 : Λk−1g∗ → Λk g∗ with respect to the basis X1 , . . . , X4 . Clearly, this is a Kostant
66

type codiﬀerential of maximal rank. In this situation, Theorem 4.19(b) provides a graded
Rockland complex of left invariant operators, see also [7]:
C ∞ (G)
D2
D3
⊕
−→
C ∞ (G)2 −→
C ∞ (G).
C ∞ (G) −→ C ∞ (G) −→
∞
C (G)
D0

2 D1

(109)

Using matrices with entries in the universal enveloping algebra of g, and using the notation
Xi1 ...ik = Xi1 · · · Xik , these operators can be expressed as:


X1
D0 =
X2


−X22
X12 − 2X3
D1 =
−X4 − X112 − X13
X111


−X3 − X12
X111
D2 =
3X4 − 3X13 + X112
−X22

D3 = −X2 X1
A detailed veriﬁcation of these claims can be found in Appendix A. The direct sum symbol at the middle space in the sequence (109) indicates that its ﬁltration is non-trivial.
Correspondingly, the operators D1 and D2 are not homogeneous, whence the lines in their
matrices separating diﬀerent degrees. Evidently, the sequence (109) fails to be Rockland in
the ungraded sense.
4.6. BGG sequences. Every regular parabolic geometry has an underlying ﬁltered manifold M whose bundle of osculating Lie algebras is locally trivial. The Cartan connection
induces a linear connection ∇ on every associated tractor bundle E over M. This linear connection is ﬁltration preserving and its curvature is contained in ﬁltration degree one.
Moreover, Kostant’s codiﬀerential provides a vector bundle homomorphism δ : Λk T ∗ M ⊗E →
Λk−1 T ∗ M ⊗ E, satisfying the assumptions in Corollary 4.20. In this situation, the operator
L̄ in Corollary 4.20(a) coincides with the splitting operator in [13, Theorem 2.4], see also
[12, 9]. Furthermore, the sequence in Corollary 4.20(b) reduces to the “torsion free BGG
sequence” in [9, Section 5] and coincides with the sequence considered in [13, Section 2.4].
For torsion free parabolic geometries this coincides with the original curved BGG sequence
constructed by Čap, Slovák and Souček in [12]. From Corollary 4.20(b) we conclude that
these BGG operators have graded Heisenberg order at most zero and form a graded Rockland
sequence, see Corollary 4.23 below.
Let us point out that there is a normalization condition for the curvature of the Cartan connection such that normal regular parabolic geometries can equivalently be described
by underlying geometric structures, see Theorem 3.1.14, Section 3.1.16, and the historical
remarks at the end of Section 3 in [11]. For a large class of parabolic geometries this underlying geometric structure consists merely of the underlying ﬁltered manifold, [11, Proposition 4.3.1]. These provide intriguing classes of ﬁltered manifolds to which one can associate
graded Rockland sequences of diﬀerential operators in a natural way.
In the remaining part of this section we will, for the reader’s convenience, brieﬂy recall
basic facts on parabolic geometries and provided detailed references supporting the claims
made above. We closely follow the presentation in [11], [12] and [13, Section 2].
67

Consider a |k|-graded semisimple Lie algebra
g = g−k ⊕ · · · ⊕ g−1 ⊕ g0 ⊕ g1 ⊕ · · · ⊕ gk .

(110)

More precisely, [gi , gj ] ⊆ gi+j for all i, j, and the subalgebra g− := g−k ⊕· · ·⊕g−1 is generated
by g−1 , see [11, Deﬁnition 3.1.2]. Consider the ﬁltration
g = g−k ⊇ g−k+1 ⊇ · · · ⊇ g−1 ⊇ g0 ⊇ g1 ⊇ · · · ⊇ gk−1 ⊇ gk

(111)

where gi := gi ⊕ · · · ⊕ gk . The subalgebras g0 and p := g0 = g0 ⊕ · · ·⊕ gk can be characterized
as grading and ﬁltration preserving subalgebras, respectively. More precisely, g0 = {X ∈ g |
∀i : adX (gi ) ⊆ gi } and p = {X ∈ g | ∀i : adX (gi ) ⊆ gi }, see[11, Lemma 3.1.3(1)]. Also note
that p+ := g1 = g1 ⊕ · · · ⊕ gk is a nilpotent ideal in p.
Let G be a not necessarily connected Lie group with Lie algebra g. Then
{g ∈ G | ∀i : Adg (gi ) ⊆ gi }

(112)

is a closed subgroup of G with Lie algebra p, see [11, Lemma 3.1.3(2)]. Let P be a parabolic
subgroup of G corresponding to the |k|-grading (110), i.e. a subgroup between (112) and
its connected component, see [11, Deﬁnition 3.1.3]. Hence, P has Lie algebra p, and the
corresponding Levi subgroup,
G0 := {g ∈ P | ∀i : Adg (gi ) ⊆ gi },
has Lie algebra g0 . According to [11, Theorem 3.1.3] we have a diﬀeomorphism
(g, X) 7→ g exp(X).
G0 × p + ∼
= P,

(113)

In particular, P+ := exp(p+ ) is a closed normal nilpotent subgroup of P , and the inclusion
G0 ⊆ P induces a canonical isomorphism G0 = P/P+ . Note that P+ acts trivially on the
associated graded, gr(g), of the ﬁltration (111). In particular, gr(g/p) can be considered as
a representation of P/P+ = G0 . The inclusion g− ⊆ g induces a canonical isomorphism of
G0 -modules,
g− = gr(g/p).
(114)
A parabolic geometry of type (G, P ) consists of a principal P -bundle p : G → M and
a Cartan connection ω ∈ Ω1 (G; g), see [11, Deﬁnition 3.1.4 and Section 1.5]. Hence, the
g-valued 1-form ω provides a P -equivariant trivialization of the tangent bundle T G, that
is, ωu : Tu G → g is a linear isomorphism for each u ∈ G, and (r g )∗ ω = Adg−1 ω for all
g ∈ P , where r g denotes the principal right action of g ∈ P on G. Moreover, ω reproduces
the generators of the right P -action, i.e. for all X ∈ p, we have ω(ζX ) = X where ζX :=
d
| r exp(tX) denotes the fundamental vector ﬁeld. The prototypical example of a parabolic
dt 0
geometry of type (G, P ) is its ﬂat model, that is, the generalized ﬂag variety G/P with the
canonical projection G → G/P and the Maurer–Cartan form on G.
Using the Cartan connection, the ﬁltration (111) provides a ﬁltration of the tangent bundle
T G by P -invariant subbundles,
T G = T −k G ⊇ T −k+1 G ⊇ · · · ⊇ T k G,
where Tui G := ωu−1(gi ) for u ∈ G. Note that T 0 G coincides with the vertical bundle of the
projection p : G → M. Hence there exists a unique ﬁltration of T M by subbundles,
T M = T −k M ⊇ T −k+1M ⊇ · · · ⊇ T −1 M,
68

(115)

such that (T p)−1 (T i M) = T i G. The Cartan connection induces an isomorphism
TM ∼
= G ×P (g/p)

(116)

intertwining the ﬁltration (115) with the ﬁltration induced from (111). Using (114) for the
associated graded we obtain an isomorphism of vector bundles,
gr(T M) ∼
= G0 ×G0 g− .

(117)

Here G0 := G/P+ is considered as a principal G0 -bundle over M.
We assume that the Cartan connection ω is regular, see [11, Deﬁnition 3.1.7]. Hence, the
ﬁltration on T M, see (115), turns M into a ﬁltered manifold, and the corresponding Levi
bracket gr(T M) ⊗ gr(T M) → gr(T M) induced by the Lie bracket of vector ﬁelds coincides
with the algebraic bracket induced by the Lie bracket g− ⊗ g− → g− via (117). In other
words, using the notation from Section 2.2, the Cartan connection of a regular parabolic
geometry provides an isomorphism of bundles of graded nilpotent Lie algebras
tM ∼
= G0 ×G0 g− .

(118)

Recall that the Cartan connection induces a principal connection on P ×P G. More
precisely, there exists a unique principal connection on the principal G-bundle G ×P G →
M which restricts to the Cartan connection ω along the inclusion G ⊆ G ×P G, see [11,
Theorem 1.5.6]. Consequently, for every ﬁnite dimensional G-representation E, the Cartan
connection induces a linear connection ∇ on the associated tractor bundle
E := G ×P E = (G ×P G) ×G E.
Recall that E admits a grading, E = E−l ⊕ · · · ⊕ El , which is compatible with the grading of
g, i.e. X · v ∈ Ei+j for all X ∈ gi and X ∈ Ej . Indeed, there exists a unique grading element
in g which acts by multiplication with j on the component gj , see [11, Proposition 3.1.2(1)],
and the eigenspaces of its action on E provide the desired decomposition. The grading of E
is G0 -invariant since the uniqueness of the the
L grading element implies that it is stabilized by
i
G0 . Hence, the associated ﬁltration E := j≥i Ej is P -invariant, see (113). Moreover, P+
acts trivially on the associated graded, and gr(E) = E as representations of P/P+ = G0 . The
P -invariant ﬁltration of E induces a ﬁltration of E by subbundles E i := G ×P Ei . Clearly, the
linear connection ∇ is ﬁltration preserving, that is, for all X ∈ Γ∞ (T p M) and ψ ∈ Γ∞ (E q ) we
have ∇X ψ ∈ Γ∞ (E p+q ). Since the Cartan connection is assumed to be regular, its curvature
F ∇ ∈ Ω2 (M; end(E)) is contained in ﬁltration degree one, that is, for all Xi ∈ Γ∞ (T pi M)
and ψ ∈ Γ∞ (E q ) we have F ∇ (X1 , X2 )ψ ∈ Γ∞ (E p1 +p2 +q+1 ), see [11, Corollary 3.1.8(2) and
Theorem 3.1.22(3)]. The isomorphism (116) induces an isomorphism
Λk T ∗ M ⊗ E ∼
= G ×P (Λk (g/p)∗ ⊗ E)

(119)

which intertwines the ﬁltration on Λk T ∗ M ⊗ E with the one induced from the ﬁltration on
Λk (g/p)∗ ⊗ E. Moreover, (114) provides an isomorphism of G0 -modules,

gr Λk (g/p)∗ ⊗ E = C k (g− ; E),
(120)
where C k (g− ; E) := Λk g∗− ⊗ E. Hence, (119) induces an isomorphism

gr Λk T ∗ M ⊗ E ∼
= G0 ×G0 C k (g− ; E).
69

(121)

The extension d∇ : Ωk (M; E) → Ωk+1 (M; E) characterized by the Leibniz rule, see (90), is
ﬁltration preserving, and via (121) we have
gr(d∇ ) = G0 ×G0 ∂g−

(122)

where ∂g− : C k (g− ; E) → C k+1 (g− ; E) denotes the diﬀerential in the standard complex computing Lie algebra cohomology H ∗ (g− ; E), see Lemma 4.16.
Let δp+ : Λk p+ ⊗E → Λk−1 p+ ⊗E denote the diﬀerential in the standard complex computing
the Lie algebra homology H∗ (p+ ; E) with coeﬃcients in E. Since δp+ is P -equivariant, and
since the Killing form provides an isomorphism of P -modules (g/p)∗ ∼
= p+ , the diﬀerential
δp+ dualizes to a P -equivariant map
δg/p : Λk (g/p)∗ ⊗ E → Λk−1 (g/p)∗ ⊗ E.

(123)

Via the identiﬁcation (119), it gives rise to a vector bundle homomorphism,
δ : Λk T ∗ M ⊗ E → Λk−1 T ∗ M ⊗ E,

δ := G ×P δg/p .

(124)

In the literature [12, 13, 11] this homomorphism is often denoted ∂ ∗ . Clearly, δ 2 = 0.
Moreover, δ is ﬁltration preserving and via (121)
gr(δ) = G0 ×G0 δg− ,

(125)

where δg− : C k (g− ; E) → C k−1 (g− ; E) is obtained from (123) by passing to the associated
graded and using the identiﬁcation (120), that is, δg− = gr(δg/p ). Actually, δg/p is grading
preserving, hence δg− = δg/p via the isomorphism of G0 -modules
Λk g∗− ⊗ E = Λk (g/p)∗ ⊗ E

(126)

induced by the identiﬁcation g− = g/p.
Recall that a Weyl structure is a G0 -equivariant section of the principal P+ -bundle G →
G0 = G/P+ , see [11, Deﬁnition 5.1.1]. Global Weyl structures always exist, see [11, Proposition 5.1.1]. Moreover, the (contractible) space of sections of the bundle of groups G0 ×G0 P+
acts free and transitively on the space of Weyl structures. Using the isomorphism of G0 modules (126), every Weyl structure G0 → G induces a ﬁltration preserving isomorphism of
vector bundles,

∼
=
→ G ×P (Λk (g/p)∗ ⊗ E ,
G0 ×G0 C k (g− ; E) −
inducing the identity on the associated graded, see (120). Via (119) and (121) this corresponds to a splitting of the ﬁltration
S : gr(Λk T ∗ M ⊗ E) → Λk T ∗ M ⊗ E
satisfying δ ◦ S = S ◦ gr(δ).
Kostant [38] observed that δg− and ∂g− are adjoint with respect to positive deﬁnite inner
products on the spaces C k (g− ; E), see [11, Proposition 3.1.1]. Hence the Laplacian
g− : C ∗ (g− ; E) → C ∗ (g− ; E),

g− := δg− ◦ ∂g− + ∂g− ◦ δg− ,

gives rise to a ﬁnite dimensional Hodge decomposition
C ∗ (g− ; E) = img(δg− ) ⊕ ker(g− ) ⊕ img(∂g− ).

(127)

Using (122) and (125) we see that  : Ω∗ (M; E) → Ω∗ (M; E),  = δ ◦d∇ +d∇ ◦δ, is ﬁltration
preserving, and via the identiﬁcation (121) we have
gr() = G0 ×G0 g− .
70

(128)

For the ﬁber wise projection P̃ : gr(Λk T ∗ M ⊗ E) → gr(Λk T ∗ M ⊗ E) onto the (generalized)
zero eigenspace of gr(), we obtain, via (121),
P̃ = G0 ×G0 Pg−
∗

∗

where Pg− : C (g− ; E) → C (g− ; E) denotes the projection onto ker(g− ) along the decomposition (127). In particular, gr(δ) ◦ P̃ = 0.
From the discussion above we conclude that the homomorphism δ, see (124), is a Kostant
type codiﬀerential of maximal rank for the linear connection ∇ on the tractor bundle E, see
Deﬁnition 4.8 and Remark 4.13. In this situation Corollary 4.20(a) reduces to the statement
in [13, Theorem 2.4], see also [12, 9]. Since P+ acts trivially on H∗ (p+ ; E) the P -action on
H∗ (p+ ; E) factors to an action by P/P+ = G0 and we have canonical identiﬁcations:
H∗ = G0 ×G0 H∗ (p+ ; E) = G0 ×G0 ker(g− ) = G0 ×G0 H ∗ (g− ; E).
The corresponding sequence of diﬀerential operators in Corollary 4.20(b) coincides with
one version of (curved) BGG sequences that can be found in the literature. This is called
“torsion free BGG sequence” in [9, Section 5] and coincides with the sequence constructed in
[13, Section 2.4]. For torsion free parabolic geometries, see [11, Section 1.5.7], this coincides
with the original curved BGG sequence constructed by Čap, Slovák and Souček in [12]. From
Corollary 4.20(b) we thus obtain
Corollary 4.23. The (torsion free) BGG sequence associated to a regular parabolic geometry
of type (G, P ) and a finite dimensional G-representation is a graded Rockland sequence of
differential operators which have graded Heisenberg order at most zero.
Kostant’s version of the Bott–Borel–Weil theorem permits to eﬀectively compute the homologies Hk (p+ ; E) as modules over g0 . More precisely, Hk (p+ ; E) decomposes as a direct
sum of irreducible g0 -modules whose dominant weights can be read oﬀ the Hasse diagram
of p, see [38] or [11, Theorem 3.3.5 and Proposition 3.3.6]. Moreover, the grading element
acts as a scalar on each of these irreducible components which can easily be computed too,
see [11, Section 3.2.12]. Consequently, representation
L theory permits to determine the decomposition according to the grading Hk (p+ ; E) = p Hk (p+ ; E)p . Decomposing the BGG
P
operators accordingly, D̄k = p,q (D̄k )qp , with
 (D̄k )qp

Γ∞ G0 ×G0 Hk (p+ ; E)p −−−−→ Γ∞ G0 ×G0 Hk+1 (p+ ; E)q ,
(129)
one part of Corollary 4.23 asserts that the diﬀerential operator in (129) is of Heisenberg
order at most q − p, a statement which appears to be well known. Using a frame (G0 )x ∼
= G0
at x ∈ M, the Heisenberg principal symbol of the operator (129) at x can be regarded as a
left invariant diﬀerential operator
 σxq−p ((D̄k )qp )

C ∞ Tx M, Hk (p+ ; E)p −−−−−−−→ C ∞ Tx M, Hk+1 (p+ ; E)q

which is homogeneous of order q − p. The second part of Corollary 4.23 asserts that these
Heisenberg principal symbols combine to form a sequence of left invariant diﬀerential operators
 σ̃x0 (D̄k ) ∞

· · · → C ∞ Tx M, Hk (p+ ; E) −−
−−→ C Tx M, Hk+1 (p+ ; E) → · · ·
(130)
P
0
q−p
where σ̃x (D̄k ) = p,q σx ((D̄k )qp ), which is Rockland in the sense that it becomes exact in
every non-trivial irreducible unitary representation of Tx M. Up to the isomorphism Tx M ∼
=
71

G− := exp(g− ) provided by the frame, the graded Heisenberg principal symbol of a BGG
operator in (130) coincides with the corresponding BGG operator on the ﬂat model G/P
restricted along the local diﬀeomorphism G− → G/P obtained form the inclusion G− ⊆ G.
If the homology Hk (p+ ; E) is concentrated in a single degree for each k, that is, if there
exist numbers pk such that Hk (p+ ; E) = Hk (p+ ; E)pk , then the corresponding BGG operator
D̄k : Γ∞ (Hk ) → Γ∞ (Hk+1 ) is of Heisenberg order at most pk+1 − pk and the BGG sequence
is Rockland in the ungraded sense, see Deﬁnition 2.14. If, moreover, pk+1 − pk ≥ 1, then
the analytic results established in the preceding sections are applicable, see, in particular,
Corollaries 2.19, 2.20, 3.29, and 3.30. Below we will discuss a classical example of this type.
The analysis for genuinely ﬁltered sequences will be provided in Section 5.
Example 4.24 (Generic rank two distributions in dimension ﬁve). Let M be a 5-manifold
equipped with a rank two distribution of Cartan type, T −1 M ⊆ T M, see [15, 8, 56]. In other
words, T −1 M is a rank two subbundle of T M with growth vector (2, 3, 5), that is, Lie brackets
of sections of T −1 M span a rank three subbundle T −2 M of T M and triple brackets of sections
of T −1 M span all of T M. These geometric structures are also known as generic rank two
distributions in dimension ﬁve, see [56, 10]. The topological obstructions to global existence
of such a distribution are well understood in the orientable case, see [21, Theorem 1]. On
open 5-manifolds, Gromov’s h-principle is applicable and permits to establish existence once
the topological requirements are met, see [21, Theorem 2]. It is unclear, however, if there
are further geometric obstructions on closed 5-manifolds. Whether rank two distributions of
Cartan type also abide by an h-principle on closed manifolds, appears to be an intriguing
open question and is a major motivation for our investigation of hypoelliptic sequences.
In his celebrated paper [15] Cartan has shown that, up to isomorphism, there exists a
unique regular normal parabolic geometry of type (G, P ) on M with underlying ﬁltration:
T M = T −3 M ⊇ T −2 M ⊇ T −1 M ⊇ T 0 M = 0.
Here G denotes the split real form of the exceptional Lie group G2 and P denotes the
maximal parabolic subgroup corresponding to the shorter simple root. Hence, every ﬁnite
dimensional representation E of G gives rise to a curved BGG sequence on M,
D̄

D̄

D̄

D̄

D̄

0
1
2
3
4
Γ∞ (H0 ) −→
Γ∞ (H1 ) −→
Γ∞ (H2 ) −→
Γ∞ (H3 ) −→
Γ∞ (H4 ) −→
Γ∞ (H5 ),

(131)

where Hk := G0 ×G0 Hk (p+ ; E). We label the longer simple root of the G2 root system by
α1 and let α2 denote the shorter simple root. Hence, 2α1 + 3α2 is the highest root, and
the corresponding fundamental weights are λ1 = 2α1 + 3α2 and λ2 = α1 + 2α2 . Suppose
E is the irreducible complex representation with highest weight aλ1 + bλ2 where a, b ∈
N0 . Then Hk (p+ ; E) is an irreducible complex module of g0 ⊆ gC0 ∼
= gl2 (C) which can
C
readily be determined by working out the Hasse diagram of p , see [11, Section 3.2.16],
and using Kostant’s version of the Bott–Borel–Weil theorem, see [11, Theorem 3.3.5 and
Proposition 3.3.6]. Denoting the highest weight of Hk (p+ ; E) by ak λ1 + bk λ2 , we obtain the
72

ﬁrst three columns in the following table:

10

k
ak
bk dim Hk (p+ ; E)
pk
0
a
−3a − b
a+1
−3a − 2b
a + b + 2 −3a − b + 1
1 a + b + 1 −3a − 2b − 1
2 2a + b + 2 −3a − 2b − 1
2a + b + 3
−b + 4
3 2a + b + 2
−3a − b
2a + b + 3
b+6
4 a+b+1
−b + 3
a+b+2
3a + b + 9
a
b+5
a + 1 3a + 2b + 10
5

(132)

The grading element acts by multiplication with the scalar pk = 3ak + 2bk on Hk (p+ ; E), see
[11, Section 3.2.12], whence the last column. Moreover, the highest weight of Hk (p+ ; E) considered as sl2 (C)-module is ak times the fundamental weight of sl2 (C), hence dim Hk (p+ ; E) =
ak + 1, whence the remaining column. Since D̄k is of Heisenberg order pk+1 − pk , we conclude
that D̄0 and D̄4 are of Heisenberg order b + 1; D̄1 and D̄3 are of Heisenberg order 3(a + 1);
and D̄2 is of Heisenberg order 2(b + 1). According to Corollary 4.23 the sequence (131) is
Rockland in the ungraded sense, see Deﬁnition 2.14. In particular, the diﬀerential operators
D̄0∗ D̄0 , (D̄0 D̄0∗ )3(a+1) + (D̄1∗D̄1 )b+1 , (D̄1 D̄1∗ )2(b+1) + (D̄2∗ D̄2 )3(a+1) , (D̄2 D̄2∗ )3(a+1) + (D̄3∗ D̄3 )2(b+1) ,
(D̄3 D̄3∗ )b+1 + (D̄4∗ D̄4 )3(a+1) , and D̄4 D̄4∗ are all hypoelliptic and maximal hypoelliptic estimates
are available, see Lemma 2.18, Theorem 3.13, as well as, Corollaries 3.14, 3.24, and 3.26.
Here D̄k∗ denotes the formal adjoint of D̄k with respect to any ﬁber wise Hermitian metrics
on the vector bundles Hk and any volume density on M.
Let us ﬁnally put down explicit formulas for the Heisenberg principal symbol of the BGG
operators corresponding to the trivial representation E. We consider these operators as left
invariant diﬀerential operators on the simply connected nilpotent Lie group G− . According
to the discussion above, this BGG sequence has the form
D

D

D

D

D

0
1
2
3
4
C ∞ (G− ) −→
C ∞ (G− )2 −→
C ∞ (G− )3 −→
C ∞ (G− )3 −→
C ∞ (G− )2 −→
C ∞ (G− )

(133)

where D0 and D4 are homogeneous of degree 1; D1 and D3 are homogeneous of degree 3;
and D2 is homogeneous of degree 2, see also [7]. Using matrices with entries in the universal
enveloping algebra of g− these operators can be expressed as:


X1
D0 =
X2


−X4 − X112 − X13
X111
−X5 − X122
X112 − 2X13 
D1 = 
−X222
X122 − 3X23


−X12 − X3 X11
0

−X22
−3X3
X11
D2 = 
0
−X22 X12 − 2X3
10As

formulated in [11, Theorem 3.3.5], Kostant’s version of the Bott–Borel–Weil theorem computes the
cohomology H k (p+ ; E). Using the following facts, this permits to work out the homology Hk (p+ ; E) as well:
H k (p+ ; E∗ ) ∼
= Hk (p+ ; E)∗ as g0 -modules; E ∼
= E∗ as g-modules; If W is an irreducible g0 module with highest
∗
weight aλ1 + bλ2 , then W is an irreducible g0 module with highest weight a′ λ1 + b′ λ2 , where a′ = a and
b′ = −3a − b.
73



X122 + X23 − 2X5 −X112 + X4
X111
D3 =
X222
−X122 + 2X32 X112 − 3X13 + 3X4

D4 = −X2 X1
Here X5 , X4 |X3 |X2 , X1 is a graded basis of g− = g−3 ⊕ g−2 ⊕ g−1 such that
[X1 , X2 ] = X3 ,

[X1 , X3 ] = X4 ,



[X2 , X3 ] = X5 .

The vertical bars above indicate that X1 , X2 is a basis of g−1 , X3 is a basis of g−2 , and
X4 , X5 is a basis of g−3 . Moreover, we use the notation Xi1 ...ik = Xi1 · · · Xik . These formulas
are derived in Appendix B below.
5. Graded hypoelliptic sequences
In this section we adapt the analysis discussed in Section 3 to the ﬁltered setup required to
deal with the sequences constructed in Section 4. Everything generalizes eﬀortlessly, but one
bit: Formal adjoints of graded (pseudo)diﬀerential operators are in general only available if
the underlying manifold is closed. This is related to the fact that we can construct invertible
−s
Λs ∈ Ψs (E) with Λ−1
s ∈ Ψ (E) only on closed manifolds, see Lemma 3.16 and (140) below.
5.1. Graded pseudodifferential operators. The concept of graded Heisenberg order for
diﬀerential operators introduced in Section 4.1 can be generalized to pseudodiﬀerential operators in a straight forward manner as follows. Let E and F be two ﬁltered vector bundles
over a ﬁltered manifold M, suppose A ∈ O(E, F ), and let s be a complex number. Choose
splittings of the ﬁltrations, SP
E : gr(E) → E and SF : gr(F ) → F and decompose the operator accordingly, SF−1 ASE = q,p (SF−1 ASE )q,p , where (SF−1 ASE )q,p ∈ O(grp (E), grq (F )). We
say A has graded Heisenberg order s if (SF−1 ASE )q,p ∈ Ψs+q−p(grp (E), grq (F )) for all p and q.
We let Ψ̃s (E, F ) denote the space of pseudodiﬀerential operators of graded Heisenberg order
s. One readily checks that this space does not depend on the choice of splittings SE and SF .
Let us deﬁne the space of principal cosymbols of graded order s by


K(T M; gr(E), gr(F ))
s
s F
E
Σ̃ (E, F ) := k ∈ ∞
: (δλ )∗ k = λ δλ kδ1/λ for all λ > 0 ,
K (T M; gr(E), gr(F ))

where δλE ∈ Aut(gr(E)) denotes the automorphism given by multiplication with λp on the
grading component grp (E). These are essentially homogeneous kernels in a graded sense,
taking the grading on gr(E) and gr(F ) into account. They can be canonically identiﬁed with
matrices of ordinary principal cosymbols,
M
Σ̃s (E, F ) =
Σs+q−p (grp (E), grq (F )).
(134)
q,p

s
For A ∈ Ψ̃P
(E, F ) we deﬁne the graded
Heisenberg principal cosymbol σ̃ s (A) ∈ Σ̃s (E, F )

−1
s
s+q−p
by σ̃ (A) := p,q σ
(SF ASE )q,p where σ s+q−p ((SF−1 ASE )q,p ) ∈ Σs (grp (E), grq (F )) are
the Heisenberg principal symbols of the components. One readily checks that the graded
principal Heisenberg cosymbol is independent of the choice of splittings SE and SF . From
Proposition 3.4(b) we immediately obtain a short exact sequence:
σ̃s

0 → Ψ̃s−1 (E, F ) → Ψ̃s (E, F ) −→ Σ̃s (E, F ) → 0.
74

If A ∈ Ψ̃s (E, F ) and B ∈ Ψ̃r (F, G), then BA ∈ Ψ̃r+s (E, G) and
σ̃ r+s (BA) = σ̃ r (B)σ̃ s (A),

(135)

provided at least one operator is properly supported. Moreover, At ∈ Ψ̃s (F ′ , E ′ ) and
σ̃ s (At ) = σ̃ s (A)t .

(136)

These two properties follow immediately from the corresponding statements in the ungraded
case, see Proposition 3.4(d)&(e). Recall that the bundle E ′ = E ∗ ⊗ |Λ|M is equipped with
the dual ﬁltration as explained in Section 4.1.
For trivially ﬁltered vector bundles these concepts clearly reduce the ungraded case discussed in Section 3.3. Moreover, for diﬀerential operators we recover the graded Heisenberg
order and graded Heisenberg symbol from Section 4.1. More precisely, for every non-negative
g k (E, F ), and the graded Heisenberg principal
integer k, we have DO(E, F ) ∩ Ψ̃k (E, F ) = DO
symbol from Section 4.1 coincides with principal Heisenberg cosymbol introduced in this
section via the canonical inclusion

U(tM) ⊗ hom(gr(E), gr(F )) −k ⊆ Σ̃k (E, F ),
(137)
see Proposition 3.4(f) and (45).

Lemma 5.1. Let E be a filtered vector bundle over a filtered manifold M, and let E denote
the same vector bundle equipped with the trivial filtration, E = E0 ⊇ E1 = 0. For every
′
complex number s there exist Λ̃s ∈ Ψ̃sprop (E, E) and Λ̃′s ∈ Ψ̃−s
prop (E, E) such that Λ̃s Λ̃s − id and
Λ̃′s Λ̃s − id are both smoothing operators. Moreover, these operators may be chosen such that
−∞
′
−∞
−∞
Λ̃s : Γ−∞
c (E) → Γc (E) and Λ̃s : Γc (E) → Γc (E) are injective. On a closed manifold
these operators may even be chosen such that Λ̃s Λ̃′s = id and Λ̃′s Λ̃s = id.
s−p
Proof. Choose a splitting of the ﬁltration, S : gr(E) → E. Let Λs−p ∈ Ψprop
(grp (E)) and
−(s−p)
Λ′s−p ∈ Ψprop (grp (E)) be as in Lemma 3.16. Then the operators
 −1
L
L ′  −1
Λ̃s := S
and
Λ̃′s := S
p Λs−p S
p Λs−p S

have the desired properties.



5.2. Graded Heisenberg Sobolev scale. Let E be a ﬁltered vector bundle over a ﬁltered
s
manifold M. For each real number s we let H̃loc
(E) denote the space of all distributional
−∞
2
sections ψ ∈ Γ (E) such that Aψ ∈ Lloc (F) for all A ∈ Ψ̃sprop (E, F) and all trivially
s
ﬁltered vector bundles F over M, that is, F = F0 ⊇ F1 = 0. We equip H̃loc
(E) with the
s
2
coarsest topology such that A : H̃loc (E) → Lloc (F) is continuous for all such A ∈ Ψ̃sprop (E, F).
Similarly, we let H̃cs (E) denote the space of all compactly supported distributional sections
2
s
ψ ∈ Γ−∞
c (E) such that Aψ ∈ Lloc (F) for all A ∈ Ψ̃ (E, F) and all trivially ﬁltered vector
bundles F over M. We equip H̃cs (E) with the coarsest topology such that A : H̃cs (E) →
L2loc (F) is continuous for all such A ∈ Ψ̃s (E, F). We will refer to these spaces as graded
Heisenberg Sobolev spaces. Any splitting of the ﬁltration on E gives rise to non-canonical
topological isomorphisms
M
M s−p


s
Hcs−p grp (E) .
and
H̃cs (E) ∼
Hloc grp (E)
H̃loc
(E) ∼
=
=
p

p

75

Generalizing Proposition 3.21(a)&(b), we have continuous inclusions
s1
s2
(E) ⊆ Γ−∞ (E)
(E) ⊆ H̃loc
Γ∞ (E) ⊆ H̃loc

and
s2
s1
−∞
Γ∞
c (E) ⊆ H̃c (E) ⊆ H̃c (E) ⊆ Γc (E)
for all real numbers s1 ≤ s2 . Moreover, if F is another ﬁltered vector bundle over M,
s−ℜ(k)
then each A ∈ Ψ̃k (E, F ) induces continuous operators A : H̃cs (E) → H̃loc
(F ) for all real
k
s, cf. Proposition 3.21(d). For properly supported A ∈ Ψ̃prop (E, F ) we obtain continuous
s−ℜ(k)
s−ℜ(k)
s
operators A : H̃cs (E) → H̃c
(F ) and A : H̃loc
(E) → H̃loc
(F ) for all real s. As in
∞
′
∞
Proposition 3.21(c), the canonical pairing Γc (E ) × Γ (E) → C extends to a pairing
s
H̃c−s (E ′ ) × H̃loc
(E) → C
s
s
inducing linear bijections H̃loc
(E)∗ = H̃c−s (E ′ ) and H̃c−s (E ′ )∗ = H̃loc
(E). If, moreover, M
s
s
is closed, then H̃c (E) = H̃loc (E) is a Hilbert space we denote by H̃ s (E), and the pairing
induces an isomorphism of Hilbert spaces, H̃ s (E)∗ = H̃ −s (E ′ ). This can all be proved as in
Proposition 3.21 using Lemma 5.1.
Suppose M is closed. Fix a smooth volume density on M and a smooth ﬁber wise Hermitian metric h on E. Moreover, let s be a real number, choose invertible Λ̃s ∈ Ψ̃s (E, E)
−s
with inverse Λ̃−1
s ∈ Ψ̃ (E, E), see Lemma 5.1, and consider the associated Hermitian inner
product, cf. (6),

hhψ1 , ψ2 iiH̃ s (E) := hhΛ̃s ψ1 , Λ̃s ψ2 iiL2 (E) = hΛ̃ts (h ⊗ dx)Λ̃s ψ1 , ψ2 i

(138)

where ψ1 , ψ2 ∈ Γ∞ (E). In the expression on the right hand side h⊗dx : Ē → E′ is considered
as a vector bundle isomorphism, Λ̃ts ∈ Ψ̃s (E′, E ′ ), and h−, −i denotes the canonical pairing
for sections of E. The sesquilinear form in (138) extends to an inner product generating the
Hilbert space topology on the graded Heisenberg Sobolev space H̃ s (E).
With respect to inner products on H̃ s1 (E) and H̃ s2 (F ) as above, every A ∈ Ψ̃k (E, F )
admits a formal adjoint, A♯ ∈ Ψ̃k̄+2(s2 −s1 ) (F, E) such that
hhA♯ φ, ψiiH̃ s1 (E) = hhφ, AψiiH̃ s2 (F )

(139)

for all ψ ∈ Γ∞ (E) and φ ∈ Γ∞ (F ). Indeed,
−1 ∗
t
−1 t t
A♯ = Λ̃−1
A Λ̃F,s2 (hF ⊗ dx)Λ̃F,s2 .
E,s1 (Λ̃F,s2 AΛ̃E,s1 ) Λ̃F,s2 = (Λ̃E,s1 (hE ⊗ dx)Λ̃E,s1 )

(140)

k+s2 −s1
In the ﬁrst expression the star denotes the adjoint of Λ̃F,s2 AΛ̃−1
(E, F) with
E,s1 ∈ Ψ
2
respect to the L inner products associated with the ﬁber wise Hermitian metrics hE and
hF and the volume density dx. One readily veriﬁes:

(BA)♯ = A♯ B ♯

and

(A♯ )♯ = A.

(141)

5.3. Graded Rockland operators. Let E and F be ﬁltered vector bundles over a ﬁltered
manifold M. To formulate the graded Rockland condition for operators in Ψ̃s (E, F ), we
begin by extending the deﬁnition of π̄(a) to graded cosymbols a ∈ Σ̃sx (E, F ) at x ∈ M, where
π : Tx M →P
U(H) is a non-trivial irreducible unitary representation of the osculating group:
Write a = p,q ap,q according to the decomposition (134) with aq,p ∈ Σs+q−p
(grp (E), grq (F )),
x
P
and put π̄(a) := p,q π̄(aq,p ) where π̄(aq,p ) denotes the unbounded operator from H⊗grp (Ex )
to H ⊗ grq (Fx ) described in Section 3.4. Hence, π̄(a) is an unbounded operator form H ⊗
76

gr(Ex ) to H ⊗ gr(Fx ). Moreover, the subspace H∞ ⊗ gr(Ex ) is contained in the domain of
deﬁnition and mapped into H∞ ⊗ gr(Fx ). From (53) we immediately obtain
π̄(ba) = π̄(b)π̄(a)

(142)

′

for all a ∈ Σ̃sx (E, F ) and b ∈ Σ̃sx (F, G). For trivially ﬁltered vector bundles, this clearly
specializes to the deﬁnition in Section
3.4. If k is a non-negative integer and, see (137),

a ∈ U(tx M) ⊗ hom(gr(Ex ), gr(Fx )) −k ⊆ Σ̃kx (E, F ) then, on H∞ ⊗ gr(Ex ), the operator π̄(a)
coincides with π(a) considered in Section 4.1, cf. Deﬁnition 4.2.
Generalizing Deﬁnition 3.10 to the graded situation we have:
Definition 5.2 (Graded Rockland condition). Let E and F be ﬁltered vector bundles over
a ﬁltered manifold M. A graded principal cosymbol a ∈ Σ̃sx (E, F ) at x ∈ M is said to satisfy
the graded Rockland condition if, for every non-trivial irreducible unitary representation
π : Tx M → U(H), the unbounded operator π̄(a) is injective on H∞ ⊗ gr(Ex ). An operator
A ∈ Ψ̃s (E, F ) is said to satisfy the graded Rockland condition if its graded principal cosymbol,
σ̃xs (A) ∈ Σ̃sx (E, F ), satisﬁes the graded Rockland condition at each point x ∈ M.
We obtain the following generalization of Theorem 3.13 and Corollary 3.24.
Corollary 5.3 (Left parametrix and graded regularity). Let E and F be two filtered vector
bundles over a filtered manifold M, let k be a complex number, and suppose A ∈ Ψ̃k (E, F )
satisfies the graded Rockland condition. Then there exists a properly supported left parametrix
B ∈ Ψ̃−k
prop (F, E) such that BA − id is a smoothing operator. In particular, A is hypoelliptic,
that is, if ψ is a compactly supported distributional section of E and Aψ is smooth, then
r−ℜ(k)
ψ was smooth. More precisely, ψ ∈ Γ−∞
(F ), then ψ ∈ H̃cr (E).
c (E) and Aψ ∈ H̃loc
If, moreover, M is closed, then ker(A) is a finite dimensional subspace of Γ∞ (E), and for
every r ′ ≤ r there exists a constant C = CA,r,r′ ≥ 0 such that the maximal graded hypoelliptic
estimate


(143)
kψkH̃ r (E) ≤ C kψkH̃ r′ (E) + kAψkH̃ r−ℜ(k) (F )

holds for all ψ ∈ H̃ r (E). Here we are using any norms generating the Hilbert space topologies
on the corresponding graded Heisenberg Sobolev spaces. Moreover, if Q denotes the orthogonal
projection, with respect to an inner product of the form (138), onto the (finite dimensional)
subspace ker(A) ⊆ Γ∞ (E), then there exists a constant C = CA,r,s ≥ 0 such that the maximal
graded hypoelliptic estimate


kψkH̃ r (E) ≤ C kQψk + kAψkH̃ r−ℜ(k) (F )
(144)
holds for all ψ ∈ H̃ r (E). Here k − k denotes any norm on ker(A).

Proof. Let E and F denote the vector bundles E and F equipped with the trivial ﬁltrations,
respectively, that is to say, E = E0 ⊇ E1 = 0 and F = F0 ⊇ F1 = 0. According to
Lemma 5.1 there exist Λ̃E ∈ Ψ̃0 (E, E), Λ̃′E ∈ Ψ̃0 (E, E), Λ̃F ∈ Ψ̃0 (F, F), Λ̃′F ∈ Ψ̃0 (F, F ) such
that Λ̃E Λ̃′E − id, Λ̃′E Λ̃E − id, Λ̃F Λ̃′F − id, and Λ̃′F Λ̃F − id are all smoothing operators. Then
A := Λ̃F AΛ̃′E ∈ Ψk (E, F) has Heisenberg order k in the ungraded sense, and
σxk (A) = σ̃xk (A) = σ̃x0 (Λ̃F )σ̃xk (A)σ̃x0 (Λ̃′E ),
77

see (135). Since A satisﬁes the graded Rockland condition, and since σ̃x0 (Λ̃F ) and σ̃x0 (Λ̃′E )
are invertible with inverses σ̃x0 (Λ̃′F ) and σ̃x0 (Λ̃E ), respectively, we conclude that A satisﬁes
the (ungraded) Rockland condition, see (142). Hence, by Theorem 3.13, there exists a
left parametrix B ∈ Ψ−k
prop (F, E) such that BA − id is a smoothing operator. Putting
′
−k
B := Λ̃E BΛ̃F ∈ Ψ̃ (F, E) and using the fact that Λ̃′E Λ̃E − id is a smoothing operator, we
see that BA − id is a smoothing operator. Hence, B is the desired left parametrix. The
hypoellipticity statements follow immediately from the mapping properties of B, that is,
r−ℜ(k)
r
B : Γ∞ (F ) → Γ∞ (E) and B : H̃loc
(F ) → H̃loc
(E). Assume M closed. As in Corollary 2.10
we see that ker(A) is a ﬁnite dimensional subspace of Γ∞ (E). For the maximal graded
hypoelliptic estimate (143) we use boundedness of B : H̃ r−ℜ(k)(F ) → H̃ r (E) and the fact
′
that smoothing operators induce bounded operators H̃ r (E) → H̃ r (E). To see the other
hypoelliptic estimate, we consider the formal adjoint A♯ ∈ Ψ̃k̄ (F, E) with respect to inner
products of the form (138), see (140) with s1 = s2 = s. Clearly, A♯ A ∈ Ψ̃2ℜ(k) (E) satisﬁes the
graded Rockland condition and ker(A♯ A) = ker(A). Hence, Corollary 5.4 below implies that
A♯ A + Q is invertible with inverse (A♯ A + Q)−1 ∈ Ψ̃−2ℜ(k) (E). Thus, B ′ := (A♯ A + Q)−1 A♯ ∈
Ψ̃−k (F, E) is a parametrix such that B ′ A = id −Q, whence (144).

We obtain the following generalization of Corollaries 2.11, 3.14, and 3.26.
Corollary 5.4 (Graded Hodge decomposition). Let E be a filtered vector bundle over a
closed filtered manifold M. Suppose A ∈ Ψ̃k (E) satisfies the graded Rockland condition
and is formally selfadjoint, A♯ = A, with respect to a graded Sobolev inner product of the
form (138). Moreover, let Q denotes the orthogonal projection onto the (finite dimensional)
subspace ker(A) ⊆ Γ∞ (E) with respect to the inner product (138). Then A + Q is invertible
with inverse (A + Q)−1 ∈ Ψ̃−k (E). Consequently, we have topological isomorphisms and
Hodge type decompositions:
∼
=

Γ∞ (E) = ker(A) ⊕ A(Γ∞ (E))

∼
=

H̃ r−ℜ(k) (E) = ker(A) ⊕ A(H̃ r (E))

→ Γ∞ (E)
A + Q : Γ∞ (E) −
A + Q : H̃ r (E) −
→ H̃ r−ℜ(k) (E)
∼
=

→ Γ−∞ (E)
A + Q : Γ−∞ (E) −

Γ−∞ (E) = ker(A) ⊕ A(Γ−∞ (E))

Proof. Let E denote the vector bundle E equipped with the trivial ﬁltration, E = E0 ⊇
−1 ∗
♯
E1 = 0. Recall that A♯ = Λ̃−1
s (Λ̃s AΛ̃s ) Λ̃s , see (140). Hence, the assumption A = A
implies that A := Λ̃s AΛ̃−1
∈ Ψk (E) is formally selfadjoint with respect to the L2 inner
s
∗
product (6), that is, A = A. Moreover, A satisﬁes the (ungraded) Rockland condition for
σ̃xs (Λ̃s ) is invertible with inverse σ̃x−s (Λ̃−1
s ), see (135). Hence, according to Corollary 3.14,
k
A + Q ∈ Ψ (E) is invertible with inverse (A + Q)−1 ∈ Ψ−k (E), where Q ∈ O−∞ (E) denotes
the orthogonal projection onto ker(A), a ﬁnite dimensional subspace of Γ∞ (E). Note that
−∞
Q := Λ̃−1
(E) is the orthogonal projection onto ker(A) with respect to the
s QΛ̃s ∈ O
inner product (138). Conjugating with Λ̃s , we conclude that A + Q ∈ Ψ̃k (E) is invertible
−1
−k
with inverse (A + Q)−1 = Λ̃−1
s (A + Q) Λ̃s ∈ Ψ̃ (E). The remaining assertions follow at
once.

We obtain the following generalization of Corollaries 2.12 and 3.27:
78

Corollary 5.5. Let E and F be two filtered vector bundles over a closed filtered manifold M,
suppose A ∈ Ψ̃k (E, F ) satisfies the graded Rockland condition, and let A♯ ∈ Ψ̃k̄+2(s2 −s1 ) (F, E)
denote the formal adjoint with respect to inner products of the form (138), see (140). Then:
Γ∞ (E) = ker(A) ⊕ A♯ (Γ∞ (F ))
H̃ r (E) = ker(A) ⊕ A♯ (H̃ r+ℜ(k)+2(s2 −s1 ) (F ))
Γ−∞ (E) = ker(A) ⊕ A♯ (Γ−∞ (F ))
Proof. Observe that A♯ A ∈ Ψ̃2ℜ(k)+2(s2 −s1 ) (E) satisﬁes the graded Rockland condition. Apply
Corollary 5.4 to this operator and use ker(A♯ A) = ker(A).

We have the following generalization of Corollary 3.28:
Corollary 5.6 (Fredholm operators and index). Let E and F be a filtered vector bundles
over a closed filtered manifold M. Suppose A ∈ Ψ̃k (E, F ) is such that A and At both satisfy
the graded Rockland condition. Then, for every real number r, we have an induced Fredholm
operator A : H̃ r (E) → H̃ r−ℜ(k) (F ) whose index is independent of r and can be expressed as
ind(A) = dim ker A − dim ker At .
Moreover, this index depends only on the graded Heisenberg principal cosymbol σ̃ k (A) ∈
Σ̃k (E, F ).
Proof. Using Corollary 5.3 we obtain a parametrix B ∈ Ψ̃−k (F, E) such that BA − id and
AB − id are both smoothing operators, cf. Remark 3.18. We may now proceed exactly as in
the proof of Corollary 3.28.

5.4. Graded Rockland sequences. Throughout this section we assume M to be a closed
ﬁltered manifold. Suppose Ei are ﬁltered vector bundles over M, and consider a sequence of
operators
Ai−1

A

i
· · · → Γ∞ (Ei−1 ) −−−→ Γ∞ (Ei ) −→
Γ∞ (Ei+1 ) → · · ·
(145)
ki
where Ai ∈ Ψ̃ (Ei , Ei+1 ) for some complex numbers ki . Generalizing Deﬁnition 4.2 for
sequences of diﬀerential operators, we make the following

Definition 5.7 (Graded Rockland sequence). A sequence of operators as above is said to
be a graded Rockland sequence if, for every x ∈ M and every non-trivial irreducible unitary
representation π : Tx M → U(H), the sequence
k

k

π̄(σ̃xi−1 (Ai−1 ))

π̄(σ̃xi (Ai ))

· · · → H∞ ⊗ gr(Ei−1,x ) −−−−−−−−−→ H∞ ⊗ gr(Ei,x ) −−−−−−→ H∞ ⊗ gr(Ei+1,x ) → · · ·
is weakly exact, that is, the image of each arrow is contained and dense in the kernel of the
subsequent arrow. Here H∞ denotes the subspace of smooth vectors in H.
Suppose the sequence in (145) is a Rockland sequence. Fix real numbers si such that
ℜ(ki ) + si+1 − si is independent of i, and put
κ := ℜ(ki ) + si+1 − si .

(146)

Let Ei denote the vector bundle Ei considered as a trivially ﬁltered bundle, that is, equipped
with the ﬁltration Ei = E0i ⊇ E1i = 0. Fix a smooth volume density on M as well as smooth
ﬁber wise Hermitian inner products hi on Ei and let hh−, −iiL2 (Ei ) denote the associated
79

L2 inner product on sections of Ei , see (6). Moreover, choose invertible Λ̃i ∈ Ψ̃si (Ei , Ei )
with Λ̃−1
∈ Ψ̃−si (Ei , Ei ), see Lemma 5.1, and consider the associated graded Sobolev inner
i
product on sections of Ei ,
hhψ1 , ψ2 iiH̃ si (Ei ) := hhΛ̃i ψ1 , Λ̃i ψiiL2 (Ei ) = hΛ̃ti (hi ⊗ dx)Λ̃i ψ1 , ψ2 i

(147)

where ψ1 , ψ2 ∈ Γ∞ (Ei ). Let A♯i ∈ Ψ̃2κ−ki (Ei+1 , Ei ),
−1 ∗
t
−1 t t
A♯i = Λ̃−1
Ai Λ̃i+1 (hi+1 ⊗ dx)Λ̃i+1
i (Λ̃i+1 Ai Λ̃i ) Λ̃i+1 = (Λ̃i (hi ⊗ dx)Λ̃i )

denote the formal adjoint of Ai with respect to these inner products, that is,
hhA♯i φ, ψiiH̃ si (Ei ) = hhφ, Ai ψiiH̃ si+1 (Ei+1 )
for all ψ ∈ Γ∞ (Ei ) and φ ∈ Γ∞ (Ei+1 ). Let us ﬁnally consider the Laplace type operators
Bi := Ai−1 A♯i−1 + A♯i Ai .
Note that Bi = Bi♯ ∈ Ψ̃2κ (Ei ), see (146) and (141).
Lemma 5.8. The operator Bi satisfies the graded Rockland condition.
Proof. Note that Bi := Λ̃i Bi Λ̃−1
∈ Ψ2κ (Ei ) is of the form Bi = A∗i Ai + Ai−1 A∗i−1 where
i
−1
ki +si+1 −si
(Ei , Ei+1). Using (53), (54), and Remark 3.6, we obtain
Ai := Λ̃i+1 Ai Λ̃i ∈ Ψ
π̄(σx2κ (Bi )) = π̄(σxki−1 +si −si−1 (Ai−1))π̄(σxki−1 +si −si−1 (Ai−1 ))∗
+ π̄(σxki +si+1 −si (Ai ))∗ π̄(σxki +si+1 −si (Ai )).
Since the operators Ai form an (ungraded) Rockland sequence, one readily concludes that
Bi satisﬁes the (ungraded) Rockland condition, cf. the proof of Lemma 2.18. Clearly, this
implies that Bi satisﬁes the graded Rockland condition, see (142).

In view of Lemma 5.8, Corollary 5.4 applies to each of the operators Bi and we obtain the
following generalization of Corollaries 2.19, 2.20, 3.29, and 3.30:
Corollary 5.9. The operator (A♯i−1 , Ai ) is hypoelliptic, that is, if ψ is a distributional section
of Ei such that A♯i−1 ψ and Ai ψ are both smooth, then ψ was smooth. More precisely, if
ψ ∈ Γ−∞ (Ei ) is such that A♯i−1 ψ ∈ H̃ r−2κ+ℜ(ki−1 ) (Ei−1 ) and Ai ψ ∈ H̃ r−ℜ(ki ) (Ei+1 ), then
ψ ∈ H̃ r (Ei ). Moreover, there exists a constant C = CAi ,r ≥ 0 such that the maximal graded
hypoelliptic estimate


kψkH̃ r (Ei ) ≤ C kA♯i−1 ψkH̃ r−2κ+ℜ(ki−1 ) (Ei−1 ) + kQi ψkker(Bi ) + kAi ψkH̃ r−ℜ(ki ) (Ei+1 )

holds for all ψ ∈ H̃ r (Ei ). Here r is any real number, Qi denotes the orthogonal projection
onto the (finite dimensional) subspace ker(Bi ) ⊆ Γ∞ (Ei ) with respect to the inner product (147), k − kker(Bi ) denotes any norm on ker(Bi ), and k − kH̃ r (Ei ) is any norm generating
the Hilbert space topology on the graded Sobolev space H̃ r (Ei ). Furthermore,
ker(Bi ) = ker(A♯i−1 |Γ−∞ (Ei ) ) ∩ ker(Ai |Γ−∞ (Ei ) ) = ker(A♯i−1 |Γ∞ (Ei ) ) ∩ ker(Ai |Γ∞ (Ei ) ).
80

If, moreover, Ai Ai−1 = 0, then we have Hodge type decompositions
Γ∞ (Ei ) = Ai−1 (Γ∞ (Ei−1 )) ⊕ ker(Bi ) ⊕ A♯i (Γ∞ (Ei+1 ))


H̃ r (Ei ) = Ai−1 H̃ r+ℜ(ki−1 ) (Ei−1 ) ⊕ ker(Bi ) ⊕ A♯i H̃ 2κ−ℜ(ki ) (Ei+1 )

Γ−∞ (Ei ) = Ai−1 (Γ−∞ (Ei−1 )) ⊕ ker(Bi ) ⊕ A♯i (Γ−∞ (Ei+1 ))
as well as:
ker(Ai |Γ∞ (Ei ) ) = Ai−1 (Γ∞ (Ei−1 )) ⊕ ker(Bi )

ker(Ai |H̃ r (Ei ) ) = Ai−1 (H̃ r+ℜ(ki−1 ) (Ei−1 )) ⊕ ker(Bi )
ker(Ai |Γ−∞ (Ei ) ) = Ai−1 (Γ−∞ (Ei−1 )) ⊕ ker(Bi )
In particular, every cohomology class admits a unique harmonic representative:
ker(Ai |Γ−∞ (Ei ) )
ker(Ai |Γ∞ (Ei ) )
=
= ker(Bi ) = ker(A♯i−1 ) ∩ ker(Ai ).
∞
img(Ai−1 |Γ−∞ (Ei−1 ) )
img(Ai−1 |Γ (Ei−1 ) )
Appendix A. Engel structures
The purpose of this appendix is to verify the formulas for the Rockland complex (109)
in Example 4.22. Some of the subsequent computations have been carried out using the
computer algebra system Singular [23].
Let g = g−3 ⊕ g−2 ⊕ g−1 denote the graded nilpotent Lie algebra with graded basis
X4 |X3 |X2 , X1 and non-trivial brackets
[X1 , X2 ] = X3 ,

[X1 , X3 ] = X4 ,

[X2 , X3 ] = 0.

The vertical bars above indicate that X1 , X2 is a basis of g−1 , X3 is a basis of g−2 , and X4
is a basis of g−3 . Note that the osculating algebras of an Engel structure are isomorphic to
this graded nilpotent Lie algebra g.
Let α1 , α2 |α3 |α4 denote the dual basis of g∗ = g∗1 ⊕ g∗2 ⊕ g∗3 , that is αi (Xj ) = δji . We use
the following ordered basis of Λq g∗ :
Λ0 g∗ : 1
Λ1 g∗ : α1 , α2 |α3 |α4
Λ2 g∗ : α12 |α13 , α23 |α14 , α24 |α34
Λ3 g∗ : α123 |α124 |α134 , α234
Λ4 g∗ : α1234
Here we use the notation αi1 ···ik = αi1 ∧ · · · ∧ αik .
With respect to the ordered bases above, the Chevalley–Eilenberg diﬀerentials ∂q : Λq g∗ →
Λq+1 g∗ correspond to the following matrices where the lines indicate the diﬀerent degrees:
 
0
 0 

∂0 = 
 0 
0
81






∂1 = 





0
 0
∂2 = 
 0
0

0
0
0
0
0
0


0 −1 0
0 0 −1 

0 0
0 

0 0
0 

0 0
0 
0 0
0

0
0
0
0

0
0
0
0

∂3 =
q


0 −1 0
0 0 −1 

0 0
0 
0 0
0

0 0 0 0

∞

q ∗



∞

 
4
(G) q

Using the identiﬁcation Ω (G) = C (G)⊗Λ g = C
provided by left trivialization
of T G and the graded basis above, the exterior derivative dq : Ωq (G) → Ωq+1 (G) on the
nilpotent Lie group G can be expressed by the following matrices. Here Xi can be understood
as a left invariant diﬀerential operator, more precisely, diﬀerentiation with respect to the left
invariant vector ﬁeld Xi . Equivalently, we may regard these matrices to have entries in the
universal enveloping algebra of g.







d1 = 





X1
 X2 

d0 = 
 X3 
X4
−1
−X2 X1
−X3
0
X1
0
−X3 X2
−X4
0
0
0
0
−X4
0
0
−X4

0
−1
0
X1
X2
X3













X3 −X2 X1
0
−1
0
 X4
0
0 −X2 X1 −1 

d2 = 
 0
X4
0 −X3
0
X1 
0
X4
0
−X3 X2
0
d3 =

−X4 X3 −X2 X1



For the codiﬀerential δq : Λq g∗ → Λq−1 g∗ we use the adjoint of ∂ with respect to the inner
product which makes our basis αi1 ···ik orthonormal. In matrix form this reads:
δ̃1 = δ1 =

0 0 0 0
82






0
0 0 0 0 0
 0
0 0 0 0 0 

δ̃2 = δ2 = 
 −1 0 0 0 0 0 
0 −1 0 0 0 0


0 0 0
0
 0
0 0 0 



 0
0
0
0

δ̃3 = δ3 = 
 0
0 0 0 


 −1 0 0 0 
0 −1 0 0
 
0
 0 

δ̃4 = δ4 = 
 0 
0
˜ q : Λq g∗ → Λq g∗ , 
˜ q = δ̃q+1 ∂q + ∂q−1 δ̃q , we obtain:
For the algebraic 
˜0 =



0
 0
˜1 = 

 0
0

1 0
 0 1

 0 0
˜
2 = 
 0 0

 0 0
0 0

1
 0
˜3 = 

 0
0

0



0
0
0
0

0
0
1
0

0
0
0
0
0
0

0
0
0
0
0
0

0
1
0
0

0
0
0
0


˜4 =


0


0
0 

0 
1
0
0
0
0
1
0

0
0
0
0
0
1


0
0 

0 
0










For the spectral projectors onto the zero eigenspaces, P̃ : Λq g∗ → Λq g∗ , we ﬁnd:
1

P̃0 =


1
 0
P̃1 = 
 0
0

0
1
0
0
83



0
0
0
0


0
0 

0 
0



0
0
0
0
0
0


0
0
1
0
0
0

0
0
0
1
0
0

0
0
0
0
0
0

0 0
 0 0
P̃3 = 
 0 0
0 0

0
0
1
0

0
0 

0 
1




P̃2 = 




0
0
0
0
0
0

P̃4 =

1



0
0
0
0
0
0











Moreover, q : Ωq (G) → Ωq (G), q = δq+1 dq + dq−1 δq , becomes:
0 =

0





0
0
0
 0
0
0
1 = 
 X2 −X1
1
X3
0
−X1

1
0
0
0
 −X1
1
0
0

 −X2
0
0
0
2 = 
 0
−X1
0
0

 −X3
0
−X1 0
0
−X3
0
X2

1
0
0
 −X1
1
0
3 = 
 0
−X1 0
X3 −X2 0
4 =

0




0
0 

0 
1

0
0
0
0
1
−X1

0
0 

0 
0

For the diﬀerential projectors Pq : Ωq (G) → Ωq (G) we ﬁnd:
P0 =


1



1
0

0
1
P1 = 

−X2
X1
−X12 − X3 X11
84

0
0
0
0


0
0 

0 
0

0
0
0
0
0
1















P2 = 




0
0
0
0
0
0
X2
0
1
X11
X1
0
0
X1
X12
2X13 − X4 X3 − X12 X11

0 0
0

0
0 0
P3 = 

X11
X1 1
X12 − 2X3 X2 0

P4 = 1

0
0
0
1
0
−X2

0
0 

0 
1

0
0
0
0
0
0

0
0
0
0
0
0










For Lq : Ωq (G) → Ωq (G), Lq = Pq P̃q + (1 − Pq )(1 − P̃q ), we obtain:
L0 =

1








L2 = 






1
0

0
1
L1 = 

−X2
X1
−X12 − X3 X11

0
0
1
0

0
0
1
0
1
0
−X2
0
1
−X11
−X1
0
−X12
0
X1
X4 − 2X13 X12 − X3 X11

1
0
0

1
0
0
L3 = 
 −X11
−X1 1
2X3 − X12 −X2 0

L4 = 1


0
0 

0 
1

0
0
0
1
0
−X2

0
0 

0 
1

q
q
And for their inverses, L−1
q : Ω (G) → Ω (G), we have:

L−1
0 =

L−1
1



1



1
0

0
1
=

X2
−X1
X12 + X3 −X11
85

0
0
1
0


0
0 

0 
1

0
0
0
0
1
0

0
0
0
0
0
1












1
0
0
0
 0
1
0
0


0
1
0
X
 2
L−1
2 = 
0
1
 X11 X1
 0
0 −X1 0
0
0 −X11 X2

1
0 0

0
1 0

L−1
3 = 
X11
X1 1
X12 − 2X3 X2 0

1
L−1
4 =

0
0
0
0
1
0


0
0 

0 

0 

0 
1


0
0 

0 
1

q
q+1
The conjugates L−1
(G) are:
q+1 dq Lq : Ω (G) → Ω


X1
 X2 


L−1
1 d0 L0 =  0 
0


−1
0
0
0

0
0
X1
−1 




0
0
−X
X
−
2X
22
12
3
−1

L2 d1 L1 = 
 −X4 − X112 − X13
X111
0
0 



0
0
−X12
X2 
0
0
−X112 − X4 X12


X3 −X2
0
0
−1 0
 X4
0
0
0
X1 −1 


L−1
d
L
=
2
2
3
 0
0
X111
−X3 − X12 0
0 
0
0
3X4 − 3X13 + X112
−X22
0
0

0 0 −X2 X1
L−1
4 d3 L3 =

We will use the following ordered bases of img(P̃q ) and ker(P̃q ):
ker(P̃0 ) : ∅

img(P̃0 ) : 1
1

img(P̃1 ) : α , α

2

ker(P̃1 ) : α3 |α4

img(P̃2 ) : α23 |α14

ker(P̃2 ) : α12 |α13 |α24 |α34

img(P̃3 ) : α134 , α234

ker(P̃3 ) : α123 |α124

img(P̃4 ) : α1234

ker(P̃4 ) : ∅

∞
∞
Then Dq = P̃q+1 L−1
q+1 dq Lq |img(P̃q ) : Γ (img(P̃q )) → Γ (img(P̃q+1 )) becomes:


X1
D0 =
X2

86

D1 =





−X22
X12 − 2X3
−X4 − X112 − X13
X111




−X3 − X12
X111
D2 =
3X4 − 3X13 + X112
−X22

D3 = −X2 X1
This proves the formulas for the Rockland complex (109) in Example 4.22. Let us also
∞
∞
point out that Bq = (id −P̃q+1 )L−1
q+1 dq Lq |ker(P̃q ) : Γ (ker(P̃q )) → Γ (ker(P̃q+1 )) become:


−1
0

X1
−1 

B1 = 

−X12
X2 
−X112 − X4 X12


X3 −X2 −1 0
B2 =
X4
0
X1 −1
Furthermore, the operators Gq : Γ∞ (ker(P̃q )) → Γ∞ (ker(P̃q )) satisfying


−1 0
 0 −1 


G−1
2 B1 G1 = ∂1 |ker(P̃1 ) =  0
0 
0
0


0 0 −1 0
−1
G3 B2 G2 = ∂2 |ker(P̃2 ) =
,
0 0 0 −1
see Theorem 4.19(b), are given by:


1 0
G1 =
0 1


1
0
0 0

−X1
1
0 0 

G2 = 

X12
−X2 1 0 
X112 + X4 −X12 0 1


1
0
G3 =
−X1 1

∞
∞
And their inverses, G−1
q : Γ (ker(P̃q )) → Γ (ker(P̃q )), are:


1 0
−1
G1 =
0 1

1
0 0 0

X
1 0 0
1

G−1
2 = 
−X3
X2 1 0
−X13 − X4 X12 0 1

87






G−1
3

=



1 0
X1 1



Appendix B. Generic rank two distributions in dimension five
The purpose of this appendix is to verify the formulas for the Rockland complex (133)
in Example 4.24. Most of the subsequent computations have been carried out using the
computer algebra system Singular [23].
Let g− = g−3 ⊕ g−2 ⊕ g−1 denote the graded nilpotent Lie algebra with graded basis
X5 , X4 |X3 |X2 , X1 and non-trivial brackets
[X1 , X2 ] = X3 ,

[X1 , X3 ] = X4 ,

[X2 , X3 ] = X5 .

The vertical bars above indicate that X1 , X2 is a basis of g−1 , X3 is a basis of g−2 , and
X4 , X5 is a basis of g−3 . Note that the osculating algebras of a generic rank two distribution
in dimension ﬁve are isomorphic to this graded nilpotent Lie algebra g− .
Let α1 , α2 |α3 |α4 , α5 denote the dual basis of g∗− = g∗1 ⊕ g∗2 ⊕ g∗3 , that is αi (Xj ) = δji . We
use the following ordered basis of Λq g∗− :
Λ0 g∗− : 1
Λ1 g∗− : α1 , α2 |α3 |α4 , α5
Λ2 g∗− : α12 |α13 , α23 |α14 , α15 , α24 , α25 |α34 , α35 |α45
Λ3 g∗− : α123 |α124 , α125 |α134 , α135 , α234 , α235 |α145 , α245 |α345
Λ4 g∗− : α1234 , α1235 |α1245 |α1345 , α2345
Λ5 g∗− : α12345
Here we use the notation αi1 ···ik = αi1 ∧ · · · ∧ αik .
With respect to the ordered bases above, the Chevalley–Eilenberg diﬀerentials ∂q : Λq g∗− →
q+1 ∗
Λ g− correspond to the following matrices where the lines indicate the diﬀerent degrees:
 
0
 0 
 

∂0 = 
 0 
 0 
0


0 0 −1 0
0
 0 0 0 −1 0 


0 −1 
 0 0 0


0
0 
 0 0 0


0
0 
 0 0 0
∂1 = 

0
0 
 0 0 0
 0 0 0
0
0 


 0 0 0

0
0


 0 0 0
0
0 
0 0 0
0
0
88










∂2 = 











∂3 = 



0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

0
0
0
0
0
0
0
0
0
0

0
0
0
0
0
0
0
0
0
0

0
0
0
0
0

0
0
0
0
0

∂4 =
q

∞


1 −1 0 0
0
0
0 0 0 −1 0
0 

0 0 0 0 −1 0 

0 0 0 0
0
0 

0 0 0 0
0 −1 

0 0 0 0
0
1 
0 0 0 0
0
0 

0 0 0 0
0
0 

0 0 0 0
0
0 
0 0 0 0
0
0
0
0
0
0
0

0
0
0
0
0


0 −1 0
0
0 0 −1 0 

0 0
0 −1 

0 0
0
0 
0 0
0
0

0 0 0 0 0
(G− ) ⊗ Λq g∗−



 
5
) q

∞

provided by left trivialUsing the identiﬁcation Ω (G− ) = C
= C (G−
ization of T G− and the graded basis above, the exterior derivative dq : Ωq (G− ) → Ωq+1 (G− )
on the nilpotent Lie group G− can be expressed by the following matrices. Here Xi can
be understood as a left invariant diﬀerential operator, more precisely, diﬀerentiation withe
respect to the left invariant vector ﬁeld Xi . Equivalently, we may regard these matrices to
have entries in the universal enveloping algebra of g− .











d1 = 









d0 = 



X1
X2
X3
X4
X5








−X2 X1
−1
0
−X3
0
X1
−1
0
−X3 X2
0
−X4
0
0
X1
−X5
0
0
0
0
−X4
0
X2
0
−X5
0
0
0
0
−X4 X3
0
0
−X5
0
0
0
0
−X5
89

0
0
−1
0
X1
0
X2
0
X3
X4


























d2 = 










d3 = 



0
1
−1
0
X3 −X2 X1
X4
0
0 −X2
0
X1
0
X5
0
0
0
−X2
0
X1
0
X4
0 −X3
0
0
0
0
X5
0
0
−X3
0
0
0
0
X4
0
0
−X3
0
0
X5
0
0
0
−X3
0
0
0
0
X5 −X4
0
0
0
0
0
0
X5 −X4
0
0
0
0
0
0
0
0

0
0
−1
0
0
−1
X1
0
0
X1
X2
0
0
X2
0
0
0
0
X5 −X4

0
0
0
0
−1
1
0
X1
X2
X3


















−X4 X3
0 −X2
0
X1
0
−1
0
0
0
X3
0
−X2
0
X1
0
−1
0 
−X5

0
−X5 X4
0
0
0
0 −X2 X1 −1 

0
0
0 −X5 X4
0
0 −X3
0
X1 
0
0
0
0
0
−X5 X4
0
−X3 X2
d4 =



X5 −X4 X3 −X2 X1

For the codiﬀerential δq : Λq g∗− → Λq−1 g∗− we use the adjoint of ∂ with respect to the inner
product which makes our basis αi1 ···ik orthonormal. In matrix form this reads:
δ̃1 = δ1 =




δ̃2 = δ2 = 











δ̃3 = δ3 = 







0 0 0 0 0

0
0
0
0
0
0
−1 0
0
0 −1 0
0 −1
0

0
0
0
0
0

0
0
0
0
0

0
0
0 0 0
0
0
0 0 0
0
0
0 0 0
0
0
0 0 0
1
0
0 0 0
−1 0
0 0 0
0
0
0 0 0
0 −1 0 0 0
0 −1 0 0
0
0
0
0 0 −1
90

0
0
0
0
0
0
0
0
0
0
0
0
0
0
1


0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
































δ̃4 = δ4 = 







0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
−1 0
0
0 −1 0
0
0 −1




δ̃5 = δ5 = 



0
0
0
0
0

0
0
0
0
0
0
0
0
0
0

0
0
0
0
0
0
0
0
0
0
























˜ q : Λq g∗− → Λq g∗− , 
˜ q = δ̃q+1 ∂q + ∂q−1 δ̃q , we obtain:
For the algebraic 
˜0 =






˜1 = 












˜
2 = 







1
0
0
0
0
0
0
0
0
0

0
1
0
0
0
0
0
0
0
0

0
0
1
0
0
0
0
0
0
0

0
0
0
0
0

0
0
0
0
0

0

0
0
1
0
0


0
0
0
1
0

0
0
0
0
1








0 0
0 0 0 0 0
0 0
0 0 0 0 0
0 0
0 0 0 0 0
0 0
0 0 0 0 0
0 1 −1 0 0 0 0
0 −1 1 0 0 0 0
0 0
0 0 0 0 0
0 0
0 0 1 0 0
0 0
0 0 0 1 0
0 0
0 0 0 0 2
91

























˜3 = 









2
0
0
0
0
0
0
0
0
0

0
1
0
0
0
0
0
0
0
0

0
0
1
0
0
0
0
0
0
0

0 0
0 0 0 0 0
0 0
0 0 0 0 0
0 0
0 0 0 0 0
0 0
0 0 0 0 0
0 1 −1 0 0 0 0
0 −1 1 0 0 0 0
0 0
0 0 0 0 0
0 0
0 0 1 0 0
0 0
0 0 0 1 0
0 0
0 0 0 0 1





˜
4 = 



1
0
0
0
0

0
1
0
0
0

˜5 =


0
0
1
0
0

0

0
0
0
0
0

0
0
0
0
0


























For the spectral projectors onto the zero eigenspaces, P̃q : Λq g∗− → Λq g∗− , we ﬁnd:
P̃0 =




P̃1 = 











P̃2 = 







0
0
0
0
0
0
0
0
0
0

0
0
0
0
0
0
0
0
0
0

0
0
0
0
0
0
0
0
0
0

1
0
0
0
0

0
1
0
0
0

1

0
0
0
0
0


0
0
0
0
0

0
0
0
0
0








0 0
0 0 0 0 0
0 0
0 0 0 0 0
0 0
0 0 0 0 0
1 0
0 0 0 0 0
0 1/2 1/2 0 0 0 0
0 1/2 1/2 0 0 0 0
0 0
0 1 0 0 0
0 0
0 0 0 0 0
0 0
0 0 0 0 0
0 0
0 0 0 0 0
92


























P̃3 = 







0
0
0
0
0
0
0
0
0
0

0
0
0
0
0
0
0
0
0
0

0
0
0
0
0
0
0
0
0
0

0 0
0 0 0 0 0
0 0
0 0 0 0 0
0 0
0 0 0 0 0
1 0
0 0 0 0 0
0 1/2 1/2 0 0 0 0
0 1/2 1/2 0 0 0 0
0 0
0 1 0 0 0
0 0
0 0 0 0 0
0 0
0 0 0 0 0
0 0
0 0 0 0 0





P̃4 = 



0
0
0
0
0

0
0
0
0
0

P̃5 =

0
0
0
0
0

1

0
0
0
1
0

0
0
0
0
1


























Moreover, q : Ωq (G− ) → Ωq (G− ), q = δq+1 dq + dq−1 δq , becomes:
0 =




1 = 











2 = 







0



0
0
0
0
0
0
X2 −X1
1
X3
0
−X1
0
X3 −X2

0
0
0
1
0

0
0
0
0
1








0
0
0
0
0
0
0
0
1
−X1
1
0
0
0
0
0
0
0
−X2
0
1
0
0
0
0
0
0
0
−X1
0
0
0
0
0
0
0
X3 −X2
0
0
1
−1
0
0
0
−X3
0
−X1 0 −1
1
0
0
0
0
0
−X2 0
0
0
0
0
0
0
−X3
0
X2 0 −X1
0
1
0
0
−X3 0 X2
0
−X1 0
1
0
0
0
0
0 X3 −X3
0
X2 −X1
93

0
0
0
0
0
0
0
0
0
2



















0
0
0
0
0
0
0
0
2
 −X1
1
0
0
0
0
0
0
0

0
1
0
0
0
0
0
0
 −X2

−X1
0
0
0
0
0
0
0
 0

0
−X1 0
1
−1
0
0
0
 −X3
3 = 
X
−X
0
0
−1
1
0
0
0

3
2
 0
0
−X2 0
0
0
0
0
0

 0
−X
0
X
−X
0
0
1
0

3
2
1
 0
0
−X3 0
0
X2 −X1 0
1
0
0
0
0 −X3 X3
0
X2 −X1


0
0 0
1
0
 0
1
0
0 0 



X
−X
1
0
0
4 = 
2
1


 X3
0
−X1 0 0 
0
X3 −X2 0 0

5 = 0
For the diﬀerential projectors Pq : Ωq (G− ) → Ωq (G− ) we ﬁnd:
P0 =







P2 = 





P1 = 



0
0
0
X11
X12 − 1
X
2 3
X
X12 − 1
2 3
X22
3X
− X4
2 13
3X
− X5
2 23
3X
1
+ 2 X24 − 1
X
4 33
2 15






P3 = 



0
0
0
1X
2 11
1X
− 1
X
2 12
4 3
1X
− 1
X
2 12
4 3
1X
2 22
3X
1
− 2 X4
4 13
3X
− 1
X
4 23
2 5
3X
1X
+
− 1
X
33
4
2 24
2 15

0
0
0
X1
1X
2 2
1X
2 2
0
1X
X3 − 2
12
1
− 2 X22
1X − 3X
2 5
2 23



P4 = 





1
0
0
1
−X2
X1
−X12 − X3
X11
−X22
X12 − 2X3

0
0
0
X1
1X
2 2
1X
2 2
0
X3 − 1
X
2 12
1
− 2 X22
1X − 3X
4 5
4 23



1

0
0
0
0
1X
2 1
1X
2 1
X2
1X
2 11
1X
+ 1
X
2 12
2 3
3X
1X
−
13
4
4 4
0
0
0
0
1X
2 1
1X
2 1
X2
1X
2 11
1X
1X
+ 2
3
2 12
3X
1X
−
13
2
2 4

0
0
0
1
0
0
0
−X2
0
1X
2 22
0
0
0
1
0
0
0
−X2
0
X22

0
0
0
0
0

0
0
0
0
1/2
1/2
0
1X
2 1
1
− 2 X2
1X − 1X
4 3
2 12
0
0
0
0
1/2
1/2
0
1X
2 1
1
− 2 X2
1X − X
12
2 3

0
0
0
0
0
0
0
0
0
−X12 − X3
X11
X1
−X22
X12 − 2X3 X2
94

0
0
0
0
0

0
0
0
1
0

0
0
0
0
0
























0
0
0
0
1/2
1/2
0
1X
2 1
1
− 2 X2
1X − 1X
4 3
2 12
0
0
0
0
1/2
1/2
0
1X
2 1
1
− 2 X2
1X − X
12
2 3

0
0
0
0
1

0
0
0
0
0
0
0
0
0
1








0
0
0
0
0
0
1
0
X1
1X
2 11
0
0
0
0
0
0
1
0
X1
X11

0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

0
0
0
0
0
0
0
0
0
0

0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

0
0
0
0
0
0
0
0
0
0

















P5 =



1

For Lq : Ωq (G− ) → Ωq (G− ), Lq = Pq P̃q + (1 − Pq )(1 − P̃q ), we obtain:
L0 =







L2 = 





L1 = 


1
0
0
−X11
1X
−X12 + 2
3
1X
−X12 + 2
3
−X22
3
− 2 X13 + X4
3X
−2
23 + X5
3
1X
− 4 X33 − 1
X
+ 2
15
2 24






L3 = 



1
0
0
1
− 2 X11
1
1X
− 2 X12 + 4
3
1
1X
−2
12 + 4 X3
1
− 2 X22
1
3X
−4
13 + 2 X4
1X
3
− 4 X23 + 2
5
3X
1
1
−4
33 − 2 X24 + 2 X15

1
0
0
1
−X2
X1
−X12 − X3
X11
−X22
X12 − 2X3

0
1
0
−X1
1
− 2 X2
1X
−2
2
0
1X
− X3
2 12
1X
2 22
3X
− 1
X
4 23
4 5

0
1
0
−X1
1
− 2 X2
1X
−2
2
0
1X
− X3
2 12
1X
2 22
3X
− 1
X
2 23
2 5





L4 = 





1

0
0
1
0
1
− 2 X1
1
− 2 X1
−X2
−1
X
2 11
1
− 2 X12 − 1
X
2 3
3
− 4 X13 + 1
X
4 4

0
0
0
1
0
0
0
−X2
0
1X
2 22

0
0
1
0
1
− 2 X1
1
− 2 X1
−X2
1X
−2
11
1
− 2 X12 − 1
X
2 3
3
1X
− 2 X13 + 2
4

0
0
1
0
0

1



0
0
0
0
1







0
0
0
0
1
0
0
1X
2 1
1
− 2 X2
1X − 1X
4 3
2 12

0
0
0
1
0
0
0
−X2
0
X22

0
0
0
0
0
1
0
1X
2 1
1
− 2 X2
1X − 1X
4 3
2 12

0
0
0
0
1
0
0
1X
2 1
1
− 2 X2
1X − X
12
2 3

0
1
0
0
1
0
0
0
1
X12 + X3
−X11
−X1
X22
−X12 + 2X3 −X2
L5 =

0
0
0
1
0

0
0
0
1
0

0
0
0
0
0
1
0
1X
2 1
1
− 2 X2
1X − X
12
2 3

0
0
0
0
1










q
q
And for their inverses, L−1
q : Ω (G− ) → Ω (G− ), we have:

L−1
0 =

L−1
1





=



1



1
0
0
1
X2
−X1
X12 + X3
−X11
X22
−X12 + 2X3
95

0
0
1
0
0

0
0
0
1
0

0
0
0
0
1








0
0
0
0
0
0
1
0
X1
1X
2 11

0
0
0
0
0
0
1
0
X1
X11

0
0
0
0
0
0
0
1
0
0

0
0
0
0
0
0
0
1
0
0

0
0
0
0
0
0
0
0
1
0

0
0
0
0
0
0
0
0
1
0

0
0
0
0
0
0
0
0
0
1

0
0
0
0
0
0
0
0
0
1



















L−1
2








=








1
0
0
X11
X12 − 21 X3
X12 − 21 X3
X22
0
0
0



L−1
3








=








0
1
0
X1
1
X
2 2
1
X
2 2
0
0
0
0

1
0
0
1
X
2 11
1
X − 14 X3
2 12
1
X − 14 X3
2 12
1
X
2 22
0
0
0

L−1
4

0
0
0
0
1
0
0
1
1
X
0
2 1
1
X
0
2 1
X2
0
0
X2
0
0
1
0 − 2 X22

0
1
0
X1
1
X
2 2
1
X
2 2
0
0
0
0




=



0
0
0
0
1
0
0
− 12 X1
1
X
2 2
1
X − 41 X3
2 12

0
0
0
0
0
0
0
0
0
0
1
0
0
1
− 12 X1
0
1
X
−X1
2 2
1
1
X − 4 X3 − 12 X11
2 12

0
0
0
0
0
0
0
0
0
0
1
0
0
0
0
0
1
0
0
0
1
X
0
1
0
0
2 1
1
X
0
0
1
0
2 1
X2
0
0
0
1
− 12 X1
0
0
X2
− 12 X1
1
1
X
X
−X1
0
0
2 2
2 2
1
0 −X22 X12 − 2 X3 X12 − 12 X3 −X11

0
1
0
0
1
0
0
0
1
−X12 − X3
X11
X1
−X22
X12 − 2X3 X2

L−1
5 =

1



q
q+1
The conjugates L−1
(G− ) are:
q+1 dq Lq : Ω (G− ) → Ω

L−1
1 d0 L0





=


96

X1
X2
0
0
0








0
0
0
1
0

0
0
0
0
1








0
0
0
0
0
0
0
1
0
0

0
0
0
0
0
0
0
1
0
0

0
0
0
0
0
0
0
0
1
0

0
0
0
0
0
0
0
0
1
0

0
0
0
0
0
0
0
0
0
1

0
0
0
0
0
0
0
0
0
1












































−1
L2 d1 L1 = 












L−1
d
L
=

2 2
3


L−1
4 d3 L3 =

−1
0
0
0
0
X1
0
0
X2
−X112 − X13 − X4
X111
0
−X122 − X5
X112 − 2X13
0
0
−X122 − X5
X112 − 2X13
0
−X222
X122 − 3X23
0
0
−X4
0
0
−X5
0
0
0

X3
X4
X5
0
0
0
0
0
0
0

−X2
0
0
0
1X
2 5
1
− 2 X5
0
X
X24 − 1
2 15
1X
2 25
1X
X125 − X224 − 2
35
X3
0
−X5
0
0

−X4
−X5
0
0
0

0
X3
X4
0
0

X1
0
0
0
1
− 2 X4
1X
2 4
0
1X
−2
14
1X
− X15
2 24
X124 − X115 − 1
X
2 34

0
0
0
X122 + X23 − 2X5
X222

L−1
5 d4 L4 =

0
0
−1
0
0
−1
0
0
1
X
− 12 X2
2 1
1
1
X
−
X
2
2
2 1
0
0
1
X
− 21 X11
2 12
1
1
X
− 2 X12 + 12 X3
2 22
3
X − 45 X5 − 34 X13 + 54 X4
4 23

0
0
0
−X12 − X3
1
− 2 X22
1X
−2
22
0
0
0
0

−1
X
2 1
−1
X
2 2
0
−X112 + X4
2X23 − X122 − 2X5

1
1X
−2
1
1
− 2 X2
1X
2 11
5X
−4
3
1X
−4
3
1
− 2 X22
1
− 2 X4
1X
−2
5
0

−1
1X
2 1
1X
2 2
1X
2 11
−1
X
4 3
−5
X
4 3
1
− 2 X22
1X
2 4
1X
2 5

0

0
0
0
0
1X
2 11
1X
2 11
X12 − 2X3
0
0
0

1X
2 1
1X
2 2

0
−X112 + X4
2X23 − X122 − 2X5

0 0 0 −X2 X1


















0
−1
0
0
1
− 2 X2
1X
2 2
0
1X
− X3
2 12
1X
2 22
3X
1X
+ 2
5
2 23

0
0
0
X111
X112 − 3X13 + 3X4

−1
0
−X2
0
0



We will use the following ordered bases of img(P̃q ) and ker(P̃q ):
ker(P̃0 ) : ∅

img(P̃0 ) : 1
1

img(P̃1 ) : α , α

2

ker(P̃1 ) : α3 |α4 , α5

img(P̃2 ) : α14 , α15 + α24 , α25

ker(P̃2 ) : α12 |α13 , α23 | 21 (α15 − α24 )|α34 , α35 |α45

img(P̃3 ) : α134 , 21 (α135 + α234 ), α235

ker(P̃3 ) : α123 |α124 , α125 |α135 − α234 |α145 , α245 |α345

img(P̃4 ) : α1345 , α2345

ker(P̃4 ) : α1234 , α1235 |α1245

img(P̃5 ) : α12345

ker(P̃5 ) : ∅

∞
∞
Then Dq = P̃q+1 L−1
q+1 dq Lq |img(P̃q ) : Γ (img(P̃q )) → Γ (img(P̃q+1 )) becomes:


X1
D0 =
X2


−X112 − X13 − X4
X111
−X122 − X5
X112 − 2X13 
D1 = 
−X222
X122 − 3X23


−X12 − X3 X11
0

−X22
−3X3
X11
D2 = 
0
−X22 X12 − 2X3

97

0
0
−1
0
1X
2 1
1
− 2 X1
0
−1
X
2 11
−1
X − 1
X
2 12
2 3
−3
X − 1
X
2 13
2 4
0
−1
X1
0
0

0
0
−1
0
0

!

0
0
0
0
−1
1
0
X1
X2
X3

D3 =



X122 + X23 − 2X5
−X112 + X4
X111
X222
−X122 + 2X23 − 2X5 X112 − 3X13 + 3X4
D4 =

−X2 X1





This proves the formulas for the Rockland complex (133) in Example 4.24. Let us also
∞
∞
point out that Bq = (id −P̃q+1 )L−1
q+1 dq Lq |ker(P̃q ) : Γ (ker(P̃q )) → Γ (ker(P̃q+1 )) become:








B2 = 









B1 = 





−1
X1
X2
0
−X4
−X5
0

0
0
−1
0
0
−1
−X2
X1
1
1
X
−
X
2 12
2 11
1
1
X
− 2 X12 + 12 X3
2 22
3
5
X − 4 X5 − 34 X13 + 54 X4
4 23

−X2
X1
X3
X4
0
0
X5
0
0
1
1
X
− 2 X4
0
2 5
− 21 X14
0
X24 − 12 X15
1
1
X
X − X15
0
2 25
2 24
1
0 −X224 + X125 − 2 X35 X124 − X115 − 12 X34

1
1
− 2 X1
− 21 X2
− 21 X3
− 21 X4
− 21 X5
0











0
0
−1
0
0
−1
1
X
− 12 X2
2 1
1
1
X
−
X
−
X
3
2 12
2 11
1
1
X
− 2 X12 − 12 X3
2 22
1
3
X + 2 X5 − 32 X13 − 12 X4
2 23




−X4 X3
0 −X1 −1
0
0
0
X3 −X2
0
−1 0 
B3 =  −X5
0
−X5 X4
0
−X2 X1 −1

Furthermore, the operators Gq : Γ∞ (ker(P̃q )) → Γ∞ (ker(P̃q )) satisfying


G−1
2 B1 G1 = ∂1 |ker(P̃1 )



G−1
3 B2 G2 = ∂2 |ker(P̃2 )





=









=





0
0
0
0
0
0
0

98

0
0
0
0
0
0
0


−1 0
0
0 −1 0 

0
0 −1 

0
0
0 

0
0
0 

0
0 
0
0
0
0

0
0
0
0
0
0
0


1 0
0
0
0 −1 0
0 

0 0 −1 0 

0 0
0 −1 

0 0
0
0 

0 0
0
0 
0 0
0
0

0
0
0
−1
X1
X2
X3















0 0 0 0 −1 0
0
=  0 0 0 0 0 −1 0 
0 0 0 0 0
0 −1

G−1
4 B3 G3 = ∂3 |ker(P̃3 )
see Theorem 4.19(b), are given by:









G2 = 










G3 = 






1 0 0
G1 =  0 1 0 
0 0 1
0
1
−X1
1
−X2
0
0
X2
X4
− 21 X12
X5
− 21 X22
3
0
− 4 X23 + 54 X5

0
1
1
− 2 X1
1
0
− 12 X2
1
1
− 2 X3
X
2 2
1
1
− 2 X4 − 2 X12 + X3
− 12 X5
− 12 X22
0
− 23 X23 − 12 X5

0
0
1
−X1
1
X
2 11
1
X − 21 X3
2 12
3
X − 45 X4
4 13

0
0
0
1
0
0
0

0
0
0
0
1
0
0

0
0
0
0
1
0
1
1
− 2 X1
1
X
−X1
2 11
1
1
X
+
X
−X2
2 12
2 3
3
1
X + 2 X4 −X3
2 13

0
0
0
0
0
1
0
0
0
0
0
1
0
0

0
0
0
0
0
0
1
0
0
0
0
0
1
0











0
0
0
0
0
0
1


0
1
0
1
0 
G4 =  0
X2 −X1 1













∞
∞
Their inverses, G−1
q : Γ (ker(P̃q )) → Γ (ker(P̃q )), are:

G−1
1


G−1
2





=





1
X1
X2
X3
− 12 X13 − X4
− 21 X23 − X5
3
− 4 X33 + 12 X24 − 21 X15




1 0 0
= 0 1 0 
0 0 1
0
0
1
0
0
1
−X2
X1
1
1
X
−
X
2 12
2 11
1
1
X
− 2 X12 + 12 X3
2 22
3
5
X − 4 X5 − 34 X13 + 54 X4
4 23
99

0
0
0
1
0
0
0

0
0
0
0
1
0
0

0
0
0
0
0
1
0

0
0
0
0
0
0
1














G−1
3





=





0
0
0
1
1
X
1
0
0
2 1
1
X
0
1
0
2 2
1
1
3
X
−
X
X
1
4 3
2 2
2 1
X4
−X3
0
X1
X5
0
−X3
X2
−X24 + X15 X23 + X5 −X13 − X4 X3


1
0 0
 0
1 0 
G−1
4 =
−X2 X1 1

0
0
0
0
1
0
0

0
0
0
0
0
1
0

0
0
0
0
0
0
1












References
[1] M. F. Atiyah and I. M. Singer. The index of elliptic operators. I. Ann. of Math. (2), 87:484–530, 1968.
[2] R. Beals and P. Greiner. Calculus on Heisenberg manifolds, volume 119 of Annals of Mathematics
Studies. Princeton University Press, Princeton, NJ, 1988.
[3] O. Biquard. Métriques d’Einstein asymptotiquement symétriques. Astérisque, (265):vi+109, 2000.
[4] L. Boutet de Monvel. Hypoelliptic operators with double characteristics and related pseudo-diﬀerential
operators. Comm. Pure Appl. Math., 27:585–639, 1974.
[5] L. Boutet de Monvel, A. Grigis, and B. Helﬀer. Parametrixes d’opérateurs pseudo-diﬀérentiels à caractéristiques multiples. pages 93–121. Astérisque, No. 34–35, 1976.
[6] R. L. Bryant. Conformal geometry and 3-plane ﬁelds on 6-manifolds. In Developments of Cartan Geometry and Related Mathematical Problems, RIMS Symposium Proceedings, volume 1502, pages 1–15.
Kyoto University, 2006. Preprint available at https://arxiv.org/abs/math/0511110.
[7] R. L. Bryant, M. Eastwood, K. Neusser, and R. Gover. Some diﬀerential complexes within and beyond parabolic geometry, 2012. Adv. Stud. Pure Math., volume Diﬀerential Geometry and Tanaka
Theory, (in honour of Professors Reiko Miyaoka and Keizo Yamaguchi), to appear. Preprint available
at https://arxiv.org/abs/1112.2142.
[8] R. L. Bryant and L. Hsu. Rigidity of integral curves of rank 2 distributions. Invent. Math., 114(2):435–
461, 1993.
[9] D. M. J. Calderbank and T. Diemer. Diﬀerential invariants and curved Bernstein-Gelfand-Gelfand
sequences. J. Reine Angew. Math., 537:67–103, 2001.
[10] A. Čap and K. Sagerschnig. On Nurowski’s conformal structure associated to a generic rank two distribution in dimension ﬁve. J. Geom. Phys., 59(7):901–912, 2009.
[11] A. Čap and J. Slovák. Parabolic geometries. I, volume 154 of Mathematical Surveys and Monographs.
American Mathematical Society, Providence, RI, 2009. Background and general theory.
[12] A. Čap, J. Slovák, and V. Souček. Bernstein-Gelfand-Gelfand sequences. Ann. of Math. (2), 154(1):97–
113, 2001.
[13] A. Čap and V. Souček. Subcomplexes in curved BGG-sequences. Math. Ann., 354(1):111–136, 2012.
[14] A. Čap and V. Souček. Relative BGG sequences; II. BGG machinery and invariant operators, 2015.
Preprint available at https://arxiv.org/abs/1510.03986.
[15] E. Cartan. Les systèmes de Pfaﬀ, à cinq variables et les équations aux dérivées partielles du second
ordre. Ann. Sci. École Norm. Sup. (3), 27:109–192, 1910.
[16] W. Choi and R. Ponge. Privileged coordinates and tangent groupoid for Carnot manifolds, 2015. Preprint
available at https://arxiv.org/abs/1510.05851.
[17] M. Christ. Inversion in some algebras of singular integral operators. Rev. Mat. Iberoamericana, 4(2):219–
225, 1988.
[18] M. Christ, D. Geller, P. Glowacki, and L. Polin. Pseudodiﬀerential operators on groups with dilations.
Duke Math. J., 68(1):31–65, 1992.
100

[19] A. Connes. An analogue of the Thom isomorphism for crossed products of a C ∗ -algebra by an action of
R. Adv. in Math., 39(1):31–55, 1981.
[20] A. Connes. Noncommutative geometry. Academic Press, Inc., San Diego, CA, 1994.
[21] S. Dave and S. Haller. On 5-manifolds admitting rank two distributions of Cartan type, 2016. Preprint
available at https://arxiv.org/abs/1603.09700.
[22] C. Debord and G. Skandalis. Adiabatic groupoid, crossed product by R∗+ and pseudodiﬀerential calculus.
Adv. Math., 257:66–91, 2014.
[23] W. Decker, G.-M. Greuel, G. Pﬁster, and H. Schönemann. Singular 4-0-3 — A computer algebra
system for polynomial computations. http://www.singular.uni-kl.de, 2016.
[24] A. S. Dynin. Pseudodiﬀerential operators on the Heisenberg group. Dokl. Akad. Nauk SSSR,
225(6):1245–1248, 1975.
[25] A. S. Dynin. An algebra of pseudodiﬀerential operators on the Heisenberg groups. Symbolic calculus.
Dokl. Akad. Nauk SSSR, 227(4):792–795, 1976.
[26] C. Epstein and R. Melrose. The Heisenberg algebra, index theory and homology, 2000. Preprint available
at http://www-math.mit.edu/~rbm/book.html.
[27] G. B. Folland and E. M. Stein. Estimates for the ∂¯b complex and analysis on the Heisenberg group.
Comm. Pure Appl. Math., 27:429–522, 1974.
[28] G. B. Folland and E. M. Stein. Hardy spaces on homogeneous groups, volume 28 of Mathematical Notes.
Princeton University Press, Princeton, N.J.; University of Tokyo Press, Tokyo, 1982.
[29] P. Glowacki. The Rockland condition for nondiﬀerential convolution operators. II. Studia Math.,
98(2):99–114, 1991.
[30] A. Grigis. Hypoellipticité et paramétrix pour des opérateurs pseudodiﬀérentiels à caractéristiques doubles. pages 183–205. Astérisque, No. 34–35, 1976.
[31] M. Gromov. Partial differential relations, volume 9 of Ergebnisse der Mathematik und ihrer Grenzgebiete
(3) [Results in Mathematics and Related Areas (3)]. Springer-Verlag, Berlin, 1986.
[32] B. Helﬀer and J. Nourrigat. Caracterisation des opérateurs hypoelliptiques homogènes invariants à
gauche sur un groupe de Lie nilpotent gradué. Comm. Partial Differential Equations, 4(8):899–958,
1979.
[33] B. Helﬀer and J. Nourrigat. Hypoellipticité maximale pour des opérateurs polynômes de champs de
vecteurs, volume 58 of Progress in Mathematics. Birkhäuser Boston, Inc., Boston, MA, 1985.
[34] G. Hochschild and J.-P. Serre. Cohomology of Lie algebras. Ann. of Math. (2), 57:591–603, 1953.
[35] L. Hörmander. A class of hypoelliptic pseudodiﬀerential operators with double characteristics. Math.
Ann., 217(2):165–188, 1975.
[36] A. A. Kirillov. Lectures on the orbit method, volume 64 of Graduate Studies in Mathematics. American
Mathematical Society, Providence, RI, 2004.
[37] J. J. Kohn. Boundaries of complex manifolds. In Proc. Conf. Complex Analysis (Minneapolis, 1964),
pages 81–94. Springer, Berlin, 1965.
[38] B. Kostant. Lie algebra cohomology and the generalized Borel-Weil theorem. Ann. of Math. (2), 74:329–
387, 1961.
[39] J.-M. Lescure, D. Manchon, and S. Vassout. About the convolution of distributions on groupoids, 2015.
Preprint available at https://arxiv.org/abs/1502.02002.
[40] T. Morimoto. Geometric structures on ﬁltered manifolds. Hokkaido Math. J., 22(3):263–347, 1993.
[41] T. Morimoto. Lie algebras, geometric structures and diﬀerential equations on ﬁltered manifolds. In
Lie groups, geometric structures and differential equations—one hundred years after Sophus Lie (Kyoto/Nara, 1999), volume 37 of Adv. Stud. Pure Math., pages 205–252. Math. Soc. Japan, Tokyo, 2002.
Available at http://www.mathbooks.org/aspm/.
[42] K. Neusser. Universal prolongation of linear partial diﬀerential equations on ﬁltered manifolds. Arch.
Math. (Brno), 45(4):289–300, 2009.
[43] K. Neusser. Weighted jet bundles and differential operators for parabolic geometries. PhD thesis, University of Vienna, Vienna, Austria, 2010. Available at http://othes.univie.ac.at/9768/.
[44] V. Nistor. Groupoids and the integration of Lie algebroids. J. Math. Soc. Japan, 52(4):847–868, 2000.
[45] V. Nistor, A. Weinstein, and P. Xu. Pseudodiﬀerential operators on diﬀerential groupoids. Pacific J.
Math., 189(1):117–152, 1999.
101

[46] R. S. Ponge. Heisenberg calculus and spectral theory of hypoelliptic operators on Heisenberg manifolds.
Mem. Amer. Math. Soc., 194(906):viii+ 134, 2008.
[47] F. Presas. Non-integrable distributions and the h-principle. Eur. Math. Soc. Newsl., (99):18–26, 2016.
[48] D. B. Ray and I. M. Singer. R-torsion and the Laplacian on Riemannian manifolds. Advances in Math.,
7:145–210, 1971.
[49] J. Renault. A groupoid approach to C ∗ -algebras, volume 793 of Lecture Notes in Mathematics. Springer,
Berlin, 1980.
[50] C. Rockland. Hypoellipticity on the Heisenberg group-representation-theoretic criteria. Trans. Amer.
Math. Soc., 240:1–52, 1978.
[51] L. P. Rothschild and E. M. Stein. Hypoelliptic diﬀerential operators and nilpotent groups. Acta Math.,
137(3-4):247–320, 1976.
[52] M. Rumin. Un complexe de formes diﬀérentielles sur les variétés de contact. C. R. Acad. Sci. Paris Sér.
I Math., 310(6):401–404, 1990.
[53] M. Rumin. Formes diﬀérentielles sur les variétés de contact. J. Differential Geom., 39(2):281–330, 1994.
[54] M. Rumin. Sub-Riemannian limit of the diﬀerential form spectrum of contact manifolds. Geom. Funct.
Anal., 10(2):407–452, 2000.
[55] M. Rumin and N. Seshadri. Analytic torsions on contact manifolds. Ann. Inst. Fourier (Grenoble),
62(2):727–782, 2012.
[56] K. Sagerschnig. Weyl structures for generic rank two distributions in dimension five. PhD thesis, University of Vienna, Vienna, Austria, 2008. Available at http://othes.univie.ac.at/2186/.
[57] M. A. Shubin. Pseudodifferential operators and spectral theory. Springer-Verlag, Berlin, second edition,
2001. Translated from the 1978 Russian original by Stig I. Andersson.
[58] M. E. Taylor. Noncommutative microlocal analysis. I. Mem. Amer. Math. Soc., 52(313):iv+182, 1984.
[59] E. van Erp. The Atiyah–Singer formula for subelliptic operators on a contact manifold. PhD thesis, The
Pennsylvania State University, 2005.
[60] E. van Erp. The Atiyah-Singer index formula for subelliptic operators on contact manifolds. Part I.
Ann. of Math. (2), 171(3):1647–1681, 2010.
[61] E. van Erp. The Atiyah-Singer index formula for subelliptic operators on contact manifolds. Part II.
Ann. of Math. (2), 171(3):1683–1706, 2010.
[62] E. van Erp and R. Yuncken. A groupoid approach to pseudodiﬀerential calculi, 2015. Preprint available
at https://arxiv.org/abs/1511.01041v3.
[63] E. van Erp and R. Yuncken. On the tangent groupoid of a ﬁltered manifold, 2016. Preprint available at
https://arxiv.org/abs/1611.01081.
[64] T. Vogel. Existence of Engel structures. Ann. of Math. (2), 169(1):79–137, 2009.
Shantanu Dave, Wolfgang Pauli Institute c/o Faculty of Mathematics, University of
Vienna, Oskar-Morgenstern-Platz 1, 1090 Vienna, Austria.
E-mail address: shantanu.dave@univie.ac.at
Stefan Haller, Department of Mathematics, University of Vienna, Oskar-MorgensternPlatz 1, 1090 Vienna, Austria.
E-mail address: stefan.haller@univie.ac.at

102

