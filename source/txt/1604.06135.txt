arXiv:1604.06135v4 [math.CO] 2 Mar 2018

Stability for the Complete Intersection Theorem, and the
Forbidden Intersection Problem of Erdős and Sós
David Ellis∗, Nathan Keller† and Noam Lifshitz‡
March 5, 2018

Abstract
A family F of sets is said to be t-intersecting if |A∩B| ≥ t for any A, B ∈ F . The seminal
Complete Intersection Theorem of Ahlswede and Khachatrian (1997) gives the maximal size
f (n, k, t) of a t-intersecting family of k-element subsets of [n] = {1, 2, . . . , n}, together with
a characterisation of the extremal families.
The forbidden intersection problem, posed by Erdős and Sós in 1971, asks for a determination of the maximal size g(n, k, t) of a family F of k-element subsets of [n] such that
|A ∩ B| 6= t − 1 for any A, B ∈ F .
In this paper, we show that for any fixed t ∈ N, if o(n) ≤ k ≤ n/2 − o(n), then
g(n, k, t) = f (n, k, t). In combination with prior results, this solves the problem of Erdős
and Sós for any constant t, except for in the ranges n/2 − o(n) < k < n/2 + t/2 and k < 2t.
One key ingredient of the proof is the following sharp ‘stability’ result for the Complete
Intersection Theorem: if k/n is bounded away from 0 and 1/2, and F
 is a t-intersecting
family of k-element subsets of [n] such that |F | ≥ f (n, k, t) − O( n−d
k ), then there exists
a family G such that G is extremal for the Complete Intersection Theorem, and |F \ G| =
O( n−d
k−d ). This proves a conjecture of Friedgut (2008). We prove the result by combining
classical ‘shifting’ arguments with a ‘bootstrapping’ method based upon an isoperimetric
inequality.
Another key ingredient is a weak regularity lemma for families of k-element subsets
of [n], where k/n is bounded away from 0 and 1. This states that any such family F is
approximately contained within a junta, such that the restriction of F to each subcube
determined by the junta is pseudorandom in a certain sense.

1

Introduction


We write [n] := {1, 2, . . . , n}, and [n]
k := {A ⊂ [n] : |A| = k}. If X is a set, we write P(X) for
the power-set of X. A family F ⊂ P([n]) (i.e., a family of subsets of [n]) is said to be increasing
if A ⊃ B ∈ F implies A ∈ F, and intersecting if for any A, B ∈ F, we have A ∩ B 6= ∅. For
t ∈ N, F is said to be t-intersecting if for any A, B ∈ F, we have |A ∩ B| ≥ t. A dictatorship is
a family of the form {S|i ∈ S} := Di for some i ∈ [n], and a t-umvirate is a family of the form
{S|B ⊂ S} =: SB , for some B ∈ [n]
t . If X is a set, we write Sym(X) for the symmetric group
∗

School of Mathematical Sciences, Queen Mary, University of London, Mile End Road, London, E1 4NS,
United Kingdom. E-mail: d.ellis@qmul.ac.uk.
†
Department of Mathematics, Bar Ilan University, Ramat Gan, Israel. E-mail: nathan.keller27@gmail.com.
Research supported by the Israel Science Foundation (grant no. 402/13), the Binational US-Israel Science
Foundation (grant no. 2014290), and by the Alon Fellowship.
‡
Department of Mathematics, Bar Ilan University, Ramat Gan, Israel. E-mail: noamlifshitz@gmail.com.

1

on X. We say that two families F, G ⊂ P([n]) are isomorphic if there exists a permutation
σ ∈ Sym([n]) such that G = {σ(S) : S ∈ F}; in this case, we write F ∼
= G.
The classical Erdős-Ko-Rado theorem [14] determines the maximal size of an intersecting

family F ⊂ [n]
k .

Theorem 1.1 (Erdős-Ko-Rado, 1961). Let k < n/2, and let F ⊂ [n]
be an intersecting family.
k
n−1
Then |F| ≤ k−1 . Equality holds if and only if F is a dictatorship.

This theorem is the starting-point of an entire subfield of extremal combinatorics, concerned
with bounding the sizes of families of sets, under various intersection requirements on sets in
the family. Such results are often called Erdős-Ko-Rado type results. For more background and
history on Erdős-Ko-Rado type results, we refer the reader to the surveys [9, 21, 44] and the
references therein.
Also in [14], Erdős, Ko and Rado showed that for n sufficiently large depending on k and t,

n−t
3
the maximal size of a t-intersecting family F ⊂ [n]
k is k−t . For general (n, k, t) ∈ N , we write
f (n, k, t) for this maximum. The determination of f (n, k, t) for a general triple (n, k, t) ∈ N3
remained a major open problem for more than three decades. Frankl [18] conjectured that for
any (n, k, t) ∈ N3 , there exists r ∈ N ∪ {0} such that the family
 
[n]
Fn,k,t,r := {S ∈
: |S ∩ [t + 2r]| ≥ t + r}
k

is a t-intersecting subfamily of [n]
of maximal size. Following partial results by Frankl [18]
k
and Wilson [50], Frankl’s conjecture was eventually proved by Ahlswede and Khachatrian [2]:
Theorem 1.2 (Ahlswede-Khachatrian ‘Complete Intersection Theorem’, 1997). Let n, k, t ∈ N,

and let F ⊂ [n]
k be a t-intersecting family. Then |F| ≤ maxr |Fn,k,t,r |, and equality holds only
if F is isomorphic to Fn,k,t,r for some r ≥ 0. In particular, if n ≥ (t + 1)(k − t + 1), then
|F| ≤ |Fn,k,t,0 | = n−t
k−t .

In 1971, Erdős and Sós (see [13]) raised the question of what happens if the t-intersecting
condition is replaced by the weaker condition that no two sets in F have intersection of size
exactly t − 1.
Problem 1.3 (Erdős-Sós, 1971). For n, k, t ∈ N, what is the maximal size g (n, k, t) of a family

F ⊂ [n]
6 t − 1 for any A, B ∈ F?
k such that |A ∩ B| =

The first significant progress on this problem was made by Frankl and Füredi [20] in 1985;
they showed that g (n, k, t) = n−t
k−t provided k ≥ 2t and n is sufficiently large depending on k
and t.

Theorem 1.4 (Frankl-Füredi, 1985). For any k, t ∈ N such that k ≥ 2t, there exists n0 (k, t) ∈ N

such that the following holds. Let n ≥ n0 (k, t), and let F ⊂ [n]
6 t − 1 for
k such that |A ∩ B| =

n−t
any A, B ∈ F. Then |F| ≤ k−t . Equality holds if and only if F is a t-umvirate.

As pointed out
in [20], the hypothesis k ≥ 2t in Theorem 1.4 is necessary, in the sense that
n−t
g (n, k, t) > k−t if k < 2t, for all sufficiently large n.
In 2007, Keevash, Mubayi and Wilson [38] presented a complete solution of the case (k =
4, t = 2), for all n ∈ N. Recently, the second and third
authors [39] proved that for any t ∈ N,
n−t
there exists c = c(t) > 0 such that g(n, k, t) = k−t whenever 1/c ≤ k ≤ cn; the extremal
2

families in this range are precisely the t-umvirates. However, no general result was known for
k = Θ(n), and in particular, in any case where the the extremal families are not t-umvirates.
In this paper, we prove the following Ahlswede-Khachatrian type result for the Erdős-Sós
problem, resolving the latter in the case where t is fixed, k/n is bounded away from 0 and 1/2
and n is large.
Theorem 1.5. For any t ∈ N and any ζ > 0, there exists n0 (t, ζ) ∈ N such that the following

holds. Let n ≥ n0 (t, ζ, ), let n, k ∈ N with ζn < k < ( 12 − ζ)n, and let F ⊂ [n]
such that no
k
two sets in F have intersection of size t − 1. Then |F| ≤ f (n, k, t), and equality holds only if
F is isomorphic to Fn,k,t,r , for some r ≥ 0.
Combined with the aforementioned previous results, this resolves the Erdős-Sós problem for
all triples (n, k, t) ∈ N3 such that 2t ≤ k ≤ (1/2 − ζ)n and n is sufficiently large depending on
t and ζ, for any ζ > 0, giving also a characterisation of the extremal families in these cases.
Since Problem 1.3 is trivial for k ≥ (n + t)/2 (as in this case, any two distinct sets in [n]
k have
intersection of size at least t), the only remaining cases are k < 2t and n − o(n) < k < (n + t)/2.
Our first main tools in proving Theorem 1.5 is the following sharp ‘stability’ result for the
Ahlswede-Khachatrian theorem, which in itself proves a conjecture of Friedgut [23] from 2008.
Theorem 1.6. For any t ∈ N and any ζ > 0, there exists C = C(t, ζ) > 0 such that the

be a tfollowing holds. Let n, k, d ∈ N such that ζn < k < ( 21 − ζ)n, and let F ⊂ [n]
k

[n]
1 n−d
intersecting family such that |F| > f (n, k, t) − C k . Then there exists G ⊂ k isomorphic

to some Fn,k,t,r , such that |F\G| < C n−d
k−d , where r ≤ C.
Theorem 1.6 is tight, up to a factor depending only on t and ζ, as evidenced by the families

 

[n]
Hn,k,t,r,d := A ∈
: |A ∩ [t + 2r]| ≥ t + r, A ∩ {t + 2r + 1, . . . , t + 2r + d} =
6 ∅
k

 

[n]
∪ A∈
: |A ∩ [t + 2r]| = t + r − 1, {t + 2r + 1, . . . , t + 2r + d} ⊂ A ,
k

for sufficiently large n and d.
Our second
main tool in proving Theorem 1.5 is a ‘weak regularity lemma’ for families

F ⊂ [n]
,
where
k/n is bounded away from 0 and 1. This states that such a family F is
k
approximately contained within a ‘junta’ (i.e. a family depending upon few coordinates), such
that the restriction of F to each subcube determined by the junta is ‘pseudorandom’ in a certain
sense. To state it formally, we need some more definitions. 
For 0 ≤ k ≤ n, we write µ for the uniform measure on [n]
k , i.e.
 
 
n
[n]
µ(F) := |F|/
, F⊂
.
k
k

[n]\J 
B
For F ⊂ [n]
k and B ⊂ J ⊂ [n], we write FJ = {S \ B : S ∈ F, S ∩ J = B} ⊂ k−|B| . We call
these families ‘slices’ of F.

For J ⊂ [n], we say that a family J ⊂ [n]
if there exists a family G ⊂ P(J)
k is a J-junta
[n]
such that S ∈ J if and only if S ∩ J ∈ G, for all S ∈ k . In this case, we say that F is the
J-junta generated by G, and we write J = hGi.

The crucial definition is as follows. For δ > 0 and h ∈ N, we say a family F ⊂ [n]
k is (δ, h)slice-quasirandom if for any J ⊂ [n] with |J| ≤ h, and any B ⊂ J, we have |µ(FJB ) − µ(F)| < δ.
3

In other words, for every B ⊂ J, µ(FJB ) is close to µ(F), which of course would be the expected

value of µ(FJB ) if F were a random subset of [n]
with density µ(F). (We emphasise that we
k
n−|J| 
[n]\J 
B
B
.)
regard FJ as a subset of k−|B| , and so µ(FJ ) = |FJB |/ k−|B|
Here, then, is our ‘weak regularity lemma’.
Theorem 1.7. For any ζ, δ, ǫ ∈ (0, 1) and h ∈ N, there exists j = j(ζ, δ, h, ǫ) ∈ N and
n0 = n0 (ζ, δ, h, ǫ) ∈ N such that the following holds. Let n ≥ n0 , let ζn < k < (1 − ζ) n, and let

F ⊂ [n]
k . Then there exist a set J ⊂ [n] with |J| ≤ j, and a subset G ⊂ P(J), such that:
(1) µ (F\ hGi) < ǫ.

(2) For each B ∈ G, the family FJB is a (δ, h)-slice-quasirandom family satisfying µ(FJB ) > 2ǫ .

Informally, Theorem 1.7 says that for any family F ⊂ [n]
k , there exists a set J ⊂ [n] such
that the 2|J| slices {FJB : B ⊂ J} can be divided into two ‘types’: ‘good’ slices for which FJB is
‘random-like’ and not too small, and ‘bad’ slices, with small total size. Alternatively, condition
(1) says that F is almost contained within the J-junta hGi, and condition (2) says that for each
subcube of the form {S ⊂ [n] : S ∩ J = B} with B ∈ G, the restriction of F to that subcube
is ‘random-like’ and not too small.
The remainder of this paper is structured as follows. In subsection 1.1, we discuss some
related prior work on stability for Erdős-Ko-Rado type theorems. In subsection 1.2, we discuss
regularity lemmas in general, and compare some previously-known ones with ours. In subsection
1.3, we sketch the methods we will use to prove our main theorems. In Section 2 we present
some of the known results and techniques which we will use in our proofs – concerning juntas,
influences, shifting, cross-intersecting families, and reduction to the ‘biased measure’ setting.
In Section 3, we prove Theorem 1.6, our stability result for the Ahlswede-Khachatrian theorem.
In Section 4, we prove Theorem 1.7, our weak regularity lemma for hypergraphs of linear
uniformity. In Section 5, we prove Theorem 1.5, our main result on the Erdős-Sós problem. We
conclude with some open problems in Section 6.

1.1

Stability for the Erdős-Ko-Rado and Ahlswede-Khachatrian theorems

Over the last fifty years, several authors have obtained stability results for the Erdős-Ko-Rado
(EKR) and the Ahlswede-Khachatrian (AK) theorems. In general, a stability result asserts
that if the size of a family is ‘close’ to the maximum possible size, then that family is ‘close’ (in
an appropriate sense) to an extremal family.
One of the first such results is due to Hilton and
 Milner [30], who showed in 1967 that if the
size of an intersecting family is very close to n−1
k−1 , then the family is contained in a dictatorship.
A similar result for the complete intersection theorem in the domain n ≥ (k − t + 1)(t + 1) was
obtained in 1996 by Ahlswede and Khachatrian [1]. A simpler proof of the latter result was
presented by Balogh and Mubayi [5], and an alternative result of the same class was obtained
by Anstee and Keevash [3].
For families whose size is not very close to the maximum, Frankl [17] obtained in 1987
a strong stability version of the EKR theorem which implies that if an intersecting family F

log1−p p n
satisfies |F| ≥ (1−ǫ) n−1
) k ,
k−1 , then there exists a dictatorship D such that |F \D| = O(ǫ

but rather
where p ≈ k/n. Frankl’s result is tight and holds not only for |F| close to n−1
k−1
n−2
n−3
whenever |F| ≥ 3 k−2 − 2 k−3 . Proofs of somewhat weaker results using entirely different
techniques were later presented by Dinur and Friedgut [10], Friedgut [23] and Keevash [36].
In [37], Keevash and Mubayi used Frankl’s result to prove an EKR-type theorem on set systems
4

that do not contain a simplex or a cluster. Recently, a different notion of stability for the EKR
theorem was suggested by Bollobás, Narayanan and Raigorodskii [6]; this has been studied in
several subsequent papers (e.g., [4, 8]).
The case of the AK theorem appeared much harder. The
p first stability result was obtained
by Friedgut [23], who showed in 2008 that for any ǫ ≥ (log n)/n, ζ > 0 and ζn < k <

(1/(t + 1) − ζ)n, if a t-intersecting F ⊂ [n]
k  satisfies |F| ≥ f (n, k, t)(1 − ǫ), then there exists
a t-umvirate G such that |F \ G| = Ot,ζ (ǫ) nk . The proof of Friedgut uses Fourier analysis and
spectral methods. In [12], the authors proved a strong version of Friedgut’s
 result, which asserts
that under the conditions of Friedgut’s theorem, |F \ G| = O(ǫlog1−p p ) nk (where p ≈ k/n) for
some t-umvirate G, and showed that it is tight by an explicit example. The main technique
of [12] is to utilize isoperimetric inequalities on the hypercube.
All the results described above apply only in the so-called ‘principal domain’ k < n/(t + 1),
in which the extremal example has the simple structure of a t-umvirate. In the general case,
where the extremal examples are the more complex families Fn,k,t,r , no stability result has been
obtained so far (to the best of our knowledge). This situation resembles the history of the
‘exact’ results, where Theorem 1.2 was proved for k < n/(t + 1) by Wilson [50] in 1984, but it
was 13 more years until the general case was resolved by Ahlswede and Khachatrian.
The main conjecture stated in Friedgut’s 2008 paper [23] is that his stability result holds
for all ζn < k < (1/2 − ζ)n. To state the conjecture, we need some additional explanation.
A direct computation shows that for any β ∈ (0, 1/2) and any t ∈ N, there is either a unique
value of r or two consecutive values of r that asymptotically maximize |Fn,⌊βn⌋,t,r | (as n → ∞).
We say that β is non-singular for t if there is a unique such value of r, which we then denote
by r ∗ = r ∗ (β, t). Otherwise we say that β is singular for t, and we let r ∗ and r ∗ + 1 be the two
extremal values of r.
Conjecture 1.8. [23, Conjecture 4.1] Let t ∈ N, let ζ > 0, let β ∈ [ζ, 1/2 − ζ] be non
singular for t, let ǫ > 0, and let k = ⌊βn⌋. If F ⊂ [n]
is a t-intersecting family such
k
that |F| ≥ (1 − ǫ)|F(n, k, t, r ∗ )|, then there exists a set B ⊂ [n] of size t + 2r ∗ such that
|{A ∈ F : |A ∩ B| ≥ t + r ∗ }| ≥ (1 − Ot,ζ (ǫ))|F|. If β is singular for t, then either the above
holds or the corresponding statement for r ∗ + 1 holds.
It is easy to see that our Theorem 1.6 implies Conjecture 1.8. In fact, Theorem 1.6 implies
that the conclusion of Conjecture 1.8 can be strengthened to |{A ∈ F : |A ∩ B| ≥ t + r ∗ }| ≥
(1 − Ot,ζ (ǫlog1−β β ))|F| (or |{A ∈ F : |A ∩ B| ≥ t + r ∗ + 1}| ≥ (1 − Ot,ζ (ǫlog1−β β ))|F|), if β
is singular for t). Combining Theorem 1.6 with Theorem 1.5 in [12], one obtains a stability
version of the Complete Intersection Theorem for all k < (1/2 − ζ)n, sharp up to a constant
factor depending only upon t and ζ.

1.2

Regularity lemmas

Over the last forty years, ‘regularity lemmas’ have been crucial ingredients in a wide variety
of important results in Combinatorics. The earliest such lemma is the classical Szemerédi
Regularity Lemma for graphs [48]. Roughly speaking, this states that the vertex-set of any
large, dense graph G can be partitioned into a bounded number of parts
V0 , V1 , . . . , VN , where
[N ]
V0 is small, |V1 | = |V2 | = . . . = |VN |, and for most pairs {i, j} ∈ 2 , the induced bipartite
subgraph G[Vi , Vj ] of G with parts Vi and Vj is ‘pseudorandom’, in the sense that for any large
subsets A ⊂ Vi and B ⊂ Vj , e(G[A, B]) is close to what one would expect if G[Vi , Vj ] were a
random bipartite graph with the same edge-density.
5

Since Szemerédi proved his celebrated lemma, ‘regularity lemmas’ for a wide variety of
combinatorial structures have been obtained. Broadly speaking, such lemmas state that a
sufficiently large combinatorial structure can be partitioned into a bounded number of pieces
which are ‘random-like’ in the sense that they behave roughly as if they were ‘random’ structures
of the same density, together with a small amount of ‘waste’ or ‘noise’.
Gowers [26], and independently Rödl and Skokan [47], proved analogues of Szemerédi’s
regularity lemma for hypergraphs of fixed uniformity. Green [28] proved a regularity lemma
for Boolean functions on Abelian groups; the Zn2 case of this states that for any f : Zn2 →
{0, 1}, there exists a subgroup H ≤ Zn2 of bounded index, such that on most cosets C of H,
the restriction of f to C is ‘pseuodorandom’ in the sense of having small non-trivial Fourier
coefficients. Jones [31, Theorem 2] (following unpublished work of O’Donnell, Servedio, Tan
and Wan) and independently Mossel [43, Lemma 5.3], proved variants of the Zn2 -case of Green’s
regularity lemma, where the subgroup H is of the form {x ∈ Zn2 : xi = 0 ∀i ∈ S} for some
S ⊂ [n], and the notions of pseudorandomness are somewhat weaker than Green’s. Mossel’s
notion of pseudorandomness is termed ‘resilience’: a function f : Zn2 → R is said to be (r, α)resilient if |E[f |{S = z}] − E[f ]| ≤ α for all S ⊂ [n] with |S| ≤ r and all z ∈ ZS2 . Our notion of
1
pseudorandomness is precisely the analogue of resilience, for Boolean functions on [n]
k .
Our ‘weak regularity lemma’ (Theorem 1.7) is a natural variant of the above results of

Jones [31] and of Mossel [43], for Boolean functions on [n]
k , where k/n is bounded away from 0
and 1. In fact, the regularity lemma of Jones et al can be generalised straightforwardly to the
p-biased measure case, and it is not too hard to
lemma from this
p
 deduce our weak regularity
(log
n)/n
and applies
generalisation. Indeed, given a family F ⊂ [n]
,
one
takes
p
=
k/n
+
k
the aforementioned generalisation to the function
(
PrT ∈(S(x)) [T ∈ F] if |S(x)| ≥ k;
n
k
f : {0, 1} → [0, 1]; x 7→
0
if |S(x)| < k,
where S(x) = {i ∈ [n] : xi = 1}, and the above probability refers to T being chosen uniformly

at random from S(x)
k . We give a different, more self-contained proof of Theorem 1.7, one which
we believe to be more natural. (We remark that it does not seem possible to deduce Theorem 1.7
from the lemma of Mossel, even though his regularity lemma applies to the p-biased measure;
this is because we require a junta hGi such that all the slices of F corresponding to G are highly
pseudorandom.)
We call Theorem 1.7 a ‘weak regularity lemma’ because, as with the so-called ‘weak regularity lemma’ of Frieze and Kannan [25], our notion of (η, h)-slice-quasirandomness does not
imply a general ‘counting lemma’ for hypergraphs with a fixed number of edges, in the sense
of [26, 45] (see Remark 4.1). It should be noted, however, that our proof of Theorem 1.7 gives
j, n0 = 2 ↑↑ 1/(ζ O(h) δ2 ǫ), where for m > 0, 2 ↑↑ m denotes a tower of twos of height ⌈m⌉. Most
known regularity lemmas come with tower-type bounds or worse, and such bounds have been
shown to be necessary in many cases by Gowers [27], and by Conlon and Fox [7]. One exception
is the aforementioned ‘weak regularity lemma’ of Frieze and Kannan, where the bound on the
number of parts is only exponential.
Theorem 1.7 can be seen as a ‘regularity lemma’ for hypergraphs of linear uniformity (i.e.,
uniformity linear in the number of vertices). We remark that the hypergraph regularity lemmas
of Gowers [26] and of Rödl and Skokan [47] do not apply to hypergraphs of linear uniformity. The
1

The notion of pseudorandomness used by Jones [31] is stated in terms of the noise operator, and is somewhat
stronger than resilience.

6

notions of ‘pseudorandomness’ in these lemmas are very different from ours; unlike ours, both
notions admit general ‘counting lemmas’ [26, 45] giving asymptotic estimates on the number of
copies of a hypergraph with a fixed number of edges in a ‘pseudorandom’ hypergraph.

1.3

A sketch of our methods

Stability for t-intersecting families
We first outline our proof of Theorem 1.6. As in several previous works on stability for ErdősKo-Rado type theorems (e.g., [10, 12, 23]), it is more convenient for us to work first with

the biased measure on P([n]), rather than with the uniform measure on [n]
k . Hence, we first
consider t-intersectingPfamilies F ⊂ P([n]), and seek to maximize their p-biased measure µp (F),
defined by µp (F) := S∈F p|S| (1 − p)n−|S| . The biased version of the AK theorem (presented
clearly in [15]) is as follows.
Theorem 1.9 (Biased AK Theorem). Let t ∈ N, let 0 < p < 1/2, and let F ⊂ P([n]) be a
t-intersecting family. Then µp (F) ≤ f (n, p, t) := maxr µp (Fn,t,r ), where Fn,t,r := {S ⊂ [n] :
|S ∩ [t + 2r]| ≥ t + r}, and equality holds iff F is isomorphic to one of the Fn,t,r families. In
particular, if p < 1/(t + 1), then µp (F) ≤ µp (F̃n,t,0 ) = pt , with equality iff F ∼
= Fn,t,0 .
We prove the following stability version of Theorem 1.9.
Theorem 1.10. For any
 t ∈ N and any ζ > 0, there exists C = C(t, ζ) > 0 such that the
following holds. Let p ∈ ζ, 12 − ζ , and let ǫ > 0. If F ⊂ P([n]) is a t-intersecting family such
that µp (F) ≥ f (n, p, t) (1 − ǫ), then there exists a family G isomorphic to some Fn,t,r , such that
µp (F\G) ≤ Cǫlog1−p p .
In particular, if
G∼
= Fn,t,r∗ .

r∗
t+2r ∗ −1

+ζ < p <

r ∗ +1
t+2r ∗ +1

− ζ for some r ∗ ∈ N, then the above holds with

Theorem 1.10 is tight up to a factor depending only upon t and ζ, as evidenced by the families
H̃n,t,r,s = {A ⊂ P ([n]) : |A ∩ [t + 2r]| ≥ t + r, A ∩ {t + 2r + 1, . . . , t + 2r + s} =
6 ∅}

∪ {A ⊂ P ([n]) : |A ∩ [t + 2r]| = t + r − 1, {t + 2r + 1, . . . , t + 2r + s} ⊂ A} ,

for sufficiently large n and s. The computation showing this is presented in section 3.3.
Theorem 1.10 follows from combination of three ingredients:
• A bootstrapping lemma showing that if a t-intersecting F is somewhat close to some
Fn,t,r then it must be very close to that Fn,t,r . More precisely, there exists c > 0 such that
if µp (F \ Fn,t,r ) > c, and if G is another t-intersecting family which is a small modification
of F, in the sense that µp (F \ G) < c/2, then µp (G \ Fn,t,r ) > c. Hence, there is a ‘barrier’
which one cannot cross while making only small modifications.
• A shifting argument showing that given a t-intersecting family F, one can transform
it into a junta (i.e., a function that depends on only O(1) coordinates) F̃ with µp (F̃) ≥
µp (F) by a series of small modifications.
• An observation that if a t-intersecting junta F̃ satisfies µp (F̃ ) > f (n, p, t)(1 − ǫ) for a
sufficiently small ǫ, then it must be isomorphic to one of the Fn,t,r ’s.

7

While the shifting part is based on ‘classical’ shifting arguments summarized in [15], the bootstrapping relies on a recently introduced isoperimetric argument [12]. It seems that the combination of the classical shifting tools with isoperimetry is the main novelty of the proof.
Next, we deduce Theorem 1.6 from Theorem 1.10. For this, we first use a standard reduction
from the k-uniform setting to the biased-measure setting to obtain a ‘weak’ stability theorem
for t-intersecting families of k-element sets. Then, we ‘bootstrap’ this weak stability result to
obtain Theorem 1.6, using an argument recently introduced in [12], relying on the KruskalKatona theorem and some extremal results on cross-intersecting families.

Our weak regularity lemma
In common with many other regularity-type results, the proof of our ‘weak regularity lemma’
(Theorem 1.7) uses a potential argument. We define a non-positive potential function φ :

P( [n]
k ) × P([n]) → [−1/e, 0] such that:
• φ(F, S) ≤ φ(F, S ′ ) if S ⊂ S ′ ;


• If k/n is bounded away from 0 and 1, then for any F ⊂ [n]
k and any S ⊂ [n], either there
exists an S-junta G ⊂ P(S) such that G satisfies the conclusion of Theorem 1.7 (with
J = S), or there exists a set S ′ ⊃ S that is not much larger than S, such that φ (F, S ′ )
is significantly larger than φ (F, S).
Using our potential function φ, we prove the existence of a junta satisfying the conclusion
of Theorem 1.7, as follows. We start by setting S = ∅. By the second property of φ, either
there exists an S-junta GS ⊂ P(S) such that G satisfies the conclusion of Theorem 1.7 (with
J = S), or else there exists a set S ′ ⊃ S that is not much larger than S, such that φ (F, S ′ ) is
significantly larger than φ (F, S). In the former case, we are done; in the latter case, we replace
S by S ′ and repeat. Since φ is bounded from above by 0, the former case must occur after a
bounded number of steps.
Roughly speaking, our proof yields a sequence of juntas (depending on successively larger,
nested sets of coordinates) approximately containing F. At each stage, we have a set of coordinates S and an S-junta JS approximately containing F. If a significant part of the mass of F
lies in subcubes (determined by S) on which F is not sufficiently random-like, then φ may be
increased by a significant amount. When φ stops increasing by a significant amount, we have
our required junta.
The function φ is entropy-related, so loosely speaking, our method can be viewed as an
‘entropy-increment’ strategy, as opposed to the more common ‘energy-increment’ strategy. The
former turns out to be slightly cleaner in our case, but the exact choice of φ is not particularly
important, as we do not seek to optimise j = j(ζ, δ, h, ǫ) in the conclusion of Theorem 1.7.

Families with a forbidden intersection: a stability result and an exact result

Given a family F ⊂ [n]
k that contains no two sets with intersection of size t − 1 (where k/n
is bounded away from 0 and 1), we first apply Theorem 1.7 to find a junta J = hGi such
that F is approximately contained within J , and for each B ∈ G, the family FJB is highly
slice-quasirandom and not too small. Next, we prove a lemma about pairs of slice-quasirandom
families (Lemma 4.5): if k/n and l/n are bounded away from 0 and 1/2, then for any pair

[n]
A ⊂ [n]
of highly slice-quasirandom families which are not too small, and for
k and B ⊂
l
any fixed t ∈ N, there exist A ∈ A and B ∈ B such that |A ∩ B| = t − 1. In other words,
8

slice-quasirandomness allows one to achieve any fixed intersection-size. (We prove this by using
the slice-quasirandomness property to reduce to the case t = 1, i.e. to a statement about crossintersecting families; this can be tackled using known techniques, again translating from the
uniform setting to the biased-measure setting.)
We use Lemma 4.5 to show that the junta J must in fact be t-intersecting, so F is approximately contained within a t-intersecting family (namely, J ). It follows that if F has size close
to f (n, k, t), then the t-intersecting family J also has size close to f (n, k, t). We then apply
Theorem 1.6 to deduce that J (and therefore F) is close in symmetric difference to one of the
families Fn,k,t,r , where r is bounded.
To summarize, the above argument yields a stability result for families with a forbidden
intersection: if k/n is bounded away from 0 and 1/2, and F ⊂ [n]
is a family such that no
k
two sets in F have intersection of size t − 1 and |F| is close to f (n, k, t), then F has small
symmetric difference with some Fn,k,t,r , where r is bounded. Finally, we can show that if F is
a small perturbation of one of the families Fn,k,t,r (where r is bounded), then F is smaller than
Fn,k,t,r , hence deducing Theorem 1.5 from our stability result.

2

Prior results and techniques

Our proofs use several previous results and techniques from extremal and probabilistic combinatorics. In this section we present the notation, definitions, and previous results and techniques
that will be used in the sequel. As some of the results were not proved in the form we use them,
we present their proofs here for sake of completeness. The reader may find it helpful to look
through this section briefly at first, and then go back to specific results when they are used in
the sequel.

2.1

Notation

If F ⊂ P([n]), then we write F̄ := {[n] \ A : A ∈ F}, and we write F ∗ := P([n]) \ F̄ for the

(k) . If F ⊂ P([n]), we
dual of F. For each k ∈ [n] ∪ {0}, the kth layer of F is F ∩ [n]
k =: F
define the increasing family generated by F to be
F ↑ = {A ⊂ [n] : ∃B ∈ F with B ⊂ A},
i.e. it is the minimal increasing family that contains F.
In sections 2-3.2, we will often regard p ∈ (0, 1) as fixed, and we will sometimes suppress it
from our notation.
For fixed (n, p, t) with n, t ∈ N and 0 < p < 1/2, E will denote the collection of extremal families
for the biased AK theorem corresponding to (n, p, t) (i.e., the collection of all t-intersecting
F with µp (F) = f (n, p, t)). Note that for any A ∈ E and any p ∈ [ζ, 1/2 − ζ], we have
µp (A) = Θt,ζ (1).
For any F, we denote by µp (F \ E) the ‘minimal distance’ minG∈E µp (F \ G).

For k ∈ [n], (E)(k) denotes the kth layers of elements of E, i.e., {A ∩ [n]
: A ∈ E}. For
k

[n]
(k)
F ⊂ k , we denote by |F \ (E) | the ‘minimal distance’ minG∈(E)(k) |F \ G|.
For B ⊂ J ⊂ [n], we define FJB := {A ⊂ [n] \J : A ∪ B ∈ F}.

For a fixed c > 0, we say that G is a c-small modification of F if µp (F \ G) ≤ c.
9


A uniform family is a subset of [n]
for some k ∈ [n] ∪ {0}. When k is understood, we will
k

sometimes write µ for the uniform measure on [n]
k , defined by
 
[n]
|A|
.
µ(A) = n ∀A ⊂
k
k
The lower shadow of a uniform family A ⊂
A with B ⊂ A}.

[n]
k

is defined as ∂(A) := {B ∈

[n] 
k−1

: ∃A ∈

All logs in this paper are to the base e, unless otherwise indicated by a subscript, e.g. logb .
We use the (now standard) ‘asymptotic notation’, as follows. If f = f (x) and g = g(x) are
non-negative functions, we write f = O(g) if there exists C > 0 such that f (x) ≤ Cg(x) for
all x. We write f = Ω(g) if there exists c > 0 such that f (x) ≥ cg(x) for all x, and we write
f = Θ(g) if f = O(g) and f = Ω(g). If f = f (x; α) and g = g(x; α) are non-negative functions,
then we write f = Oα (g) if for all α, there exists C = C(α) > 0 such that f (x; α) ≤ Cg(x; α)
for all x. Similarly, we use the notation f = Ωα (g) and f = Θα (g). (Here, we view α as a
parameter; note that α may be vector-valued.)

2.2

The p-biased measure, influences and juntas

Let 0 < p < 1 and let n ∈ N. The p-biased measure on P([n]) is defined by
X
µp (F) =
p|A| (1 − p)n−|A| ∀F ⊂ P ([n]) .
A∈F

Definition. Let F ⊂ P([n]) and i ∈ [n]. The set of i-influential elements with respect to F is
Ii (F) := {S : |{S, S△{i}} ∩ F| = 1}.
The influence of the ith coordinate on F withPrespect to µp is Iip (F) := µp (Ii (F)). The total
influence of F with respect to µp is I p (F) := ni=1 Ii (F). When there is no risk of confusion,
we will often suppress p from this notation, writing Ii (F) = Iip (F) and I(F) = I p (F).
Influences play an important role in a variety of applications in combinatorics, theoretical
computer science, mathematical physics and social choice theory (see e.g. the survey [34]).
We need the following well-known isoperimetric inequality for total influence w.r.t. µp ; this
appears for example in [33].
Theorem 2.1. Let F ⊂ P([n]) be an increasing family, and let 0 < p < 1. Then
pI p (F) ≥ µp (F) log p (µp (F)).

(1)

We also need the well-known Margulis-Russo lemma (due independently to Margulis [42]
and Russo [49]), which relates the total influence of an increasing family F to the derivative of
the function p 7→ µp (F).
Lemma 2.2 (Margulis-Russo Lemma). Let F ⊂ P ([n]) be an increasing family and let 0 <
p0 < 1. Then
dµp (F) 
= I p0 (F) .

dp
p=p0
10

We will use the following consequence of the Margulis-Russo Lemma and Theorem 2.1 (this
appears e.g. in [29], Theorem 2.38).
Lemma 2.3. Let F ⊂ P([n]) be increasing. Then the function p 7→ logp (µp (F)) is monotone
non-increasing on (0, 1).
Proof. Let f (p) := logp (µp (F)) = log µp (F)/ log p. We have
df
=
dp

1 dµp (F )
µp (F ) dp

log p −

1
p

log(µp (F))

(log p)2

=

1
p
(log p)2

1
p
µp (F ) I (F) log p

−

log(µp (F))

≤ 0,

(2)

using the Margulis-Russo Lemma and (1).
Definition. If J ⊂ [n] and F ⊂ P([n]), F is said to be a J-junta if it depends only upon the
coordinates in J — formally, if there exists G ⊂ P(J) such that S ∈ F if and only if S ∩ J ∈ G,

for all S ⊂ [n]. A family F ⊂ P([n]) is said to be a j-junta if it is a J-junta for some J ∈ [n]
j .
Note that F ⊂ P([n]) is a j-junta if and only if Ii (F) = 0 for at least n − j coordinates i ∈ [n]
(provided 0 < p < 1).
Friedgut’s junta theorem [22] states that a family F ⊂ P([n]) with bounded total influence
w.r.t. the µp measure can be approximated by a junta depending upon a bounded number of
coordinates.
Theorem 2.4 (Friedgut’s Junta Theorem). For any ζ > 0, there exists C = C(ζ) > 0 such
that the following holds. Let ζ ≤ p ≤ 1 − ζ, let ǫ > 0, and let F ⊂ P ([n]). Then there exists a
j-junta J ⊂ P ([n]) such that µp (F∆J ) < ǫ, where j ≤ exp(CI p (F)/ǫ).
Friedgut’s proof of Theorem 2.4 is based upon the Fourier-analytic proof of the Kahn-KalaiLinial theorem [32].
We will also need another, simpler relation between influences and juntas: if all influences
of an increasing family are large, then the family must be a junta.
Proposition 2.5. Let F ⊂ P([n]) be increasing, let 0 < p < 1 and let c > 0. If mini (Iip (F)) ≥ c,
1
.
then n ≤ c2 p(1−p)
P
Proof. Let f = S⊂[n] fˆ(S)χS be the Fourier expansion of the characteristic function f = 1F ,
with respect to the measure µp . An easy calculation presented in [46, Proposition 8.45] shows
that
n
X
fˆ ({i})
p
.
I p (F) =
p (1 − p)
i=1
By the Cauchy-Schwarz inequality and Parseval’s identity,
qP
√
n
2
r
r
n
ˆ
X
ˆ
n
n
n
f ({i})
i=1 f ({i})
p
p
p
I (F) =
≤
≤
kf k2 ≤
.
p (1 − p)
p (1 − p)
p (1 − p)
p (1 − p)
i=1
If mini (Iip (F)) ≥ c, we have cn ≤ I p (F) ≤

q

n
p(1−p) .

Rearranging yields the assertion.

Another observation we use is that the measure of a t-intersecting junta F cannot be ‘too close’
to f (n, p, t), unless F is isomorphic to one of the Fn,t,r families (which are, of course, juntas).
11

Proposition 2.6. Let t ∈ N, let ζ > 0, and let m ∈ N. There exists ǫ = ǫ (t, ζ, m) > 0
such that if 0 < p ≤ 1/2 − ζ, and F ⊂ P ([m]) is a t-intersecting family satisfying µp (F) ≥
f (m, p, t) (1 − ǫ), then F ∈ AKm
p,t .
r
≤p≤
Proof. By Theorem 1.9, for any r ∈ N ∪ {0} and any t+2r−1

m
m
F ∈ P([m]) \ AKt,ζ satisfies µp (F) < µp Ft,r . Consider the set

r+1
t+2r+1 ,

any t-intersecting

Crm = {µq (Fm,t,r ) − µq (G) : G ∈ P([m]) \ AKm
q,t , G is t-intersecting,
r
r+1
≤q≤
}.
t + 2r − 1
t + 2r + 1

m
As m is fixed, Crm is compact and all its elements are positive. Hence, cm
r = min(Cr ) > 0. We
have

ℓ 
[
r+1
r
,
,
[0, 1/2 − ζ] ⊂
t + 2r − 1 t + 2r + 1
r=0

for some ℓ = ℓ (t, ζ) ∈ N. Let ǫ = min0≤r≤ℓ cm
r . It is clear by the choice of ǫ that for all
p ∈ (0, 1/2 − ζ], if F ⊂ P ([m]) is a t-intersecting family with µp (F) ≥ f (m, p, t) (1 − ǫ) >
f (m, p, t) − ǫ then we must have F ∈ AKm
p,t . This completes the proof.

2.3

Shifting

Shifting (a.k.a. ‘compression’) is one of the most classical techniques in extremal combinatorics
(see, e.g., [19]).
Definition. For F ⊂ P([n]), a set A ∈ F, and 1 ≤ j < i ≤ n, the shifting operator Sij is
defined as follows: Sij (A) = A\ {i} ∪ {j} if i ∈ A, j ∈
/ A, and A\ {i} ∪ {j} 6∈ F; and Sij (A) = A
otherwise. We define Sij (F) = {Sij (A) : A ∈ F}.
F is called n-compressed if A\ {n} ∪ {j} ∈ F for all A ∈ F such that A ∩ {j, n} = n, i.e., if
Snj (F) = F for all j < n. F is called shifted if Sij (F) = F for all j < i.
The following properties of the shifting operator are easy to check.
Claim 2.7. Let F ⊂ P ([n]) be increasing and t-intersecting, and let 0 < p < 1. Then Sij (F)
satisfies the following properties:
(a) µp (Sij (F)) = µp (F),
(b) µp (F\Sij (F)) ≤ Ii (F),
(c) Ii (Sij (F)) ≤ Ii (F), with equality if and only if Sij (F) = F,
(d) Sij (F) is increasing and t-intersecting.
2.3.1

n-compression by small modifications

The following proposition shows that any increasing t-intersecting F can be transformed into
an n-compressed increasing t-intersecting G with µp (G) = µp (F) by a sequence of c-small
modifications, where c = In (F).

12

Proposition 2.8. Let 0 < p < 1, and let F ⊂ P([n]) be an increasing t-intersecting family that
is not n-compressed. Denote δ = In (F). Then there exist families F = F0 , F1 , F2 , . . . , Fm ⊂
P([n]), such that Fm is n-compressed and for each i ∈ [m] we have:
(a) µp (Fi ) = µp (F),
(b) Fi is increasing and t-intersecting,
(c) µp (Fi−1 \Fi ) ≤ δ,
(d) In (Fi ) < δ.
Proof. We define Fi inductively. Suppose that Fi−1 is not n-compressed. Then for some j ∈ [n],
we have Snj (Fi−1 ) 6= Fi−1 . We choose such a j arbitrarily and define Fi = Snj (Fi−1 ). By
Claim 2.7, Fi satisfies the desired properties. Thus, we only need to show that for some m ∈ N,
Fm is n-compressed. Indeed, by Claim 2.7, In (Fi ) is strictly decreasing (as a function of i).
Since all of {In (Fi ) : i ∈ N} belong to a finite set of values, this process cannot last forever.
2.3.2

Increasing the measure by a small modification

Our next goal is to show that if F is an n-compressed, increasing, t-intersecting family, then it
can be transformed to a t-intersecting G with µp (G) > µp (F) by a c-small modification, where
c = In (F). That is, if F is already n-compressed, then its measure can be increased by a small
modification, without sacrificing the t-intersection property.
To show this, we need several claims. These claims were proved in [15] under the assumption
that F is shifted, but it turns out that the proof of [15] applies also under the weaker assumption
that F is n-compressed. For sake of completeness, we present the claims below.
Lemma 2.9. Let F ⊂ P([n]) be a t-intersecting n-compressed family and let a, b ∈ [n]. Let
A ∈ F (a) and B ∈ F (b) be such that |A ∩ B| = t and n ∈ A ∩ B. Then a + b = n + t, and
A ∪ B = [n].
Proof. It is clearly sufficient to show that A ∪ B = [n]. Suppose for a contradiction that
i∈
/ A ∪ B. As F is n-compressed, we have A′ = A\ {n} ∪ {i} ∈ F. However, |A′ ∩ B| = t − 1,
contradicting the fact that F is t-intersecting.
The next proposition shows that if an n-compressed t-intersecting family F satisfies F ∩In (F) *
[n] 
, then the measure of F can be increased by a small modification.
(n+t)/2

Proposition 2.10. Let 0 < p < 1/2. Let F ⊂ P([n]) be an increasing t-intersecting ncompressed family. Denote In = In (F). Let a 6= b ∈ [n] be such that a + b = n + t. Then the
families
G1 := (F\(In ∩ F)(a) ) ∪ (In \ F)(b−1)

and

G2 := (F\(In ∩ F)(b) ) ∪ (In \ F)(a−1)

are t-intersecting, and
µp (F) ≤ max {µp (G1 ) , µp (G2 )} ,

(3)

with equality only if G1 = G2 = F.
Proof. W.l.o.g. we show that G1 is t-intersecting. Let A, B ∈ G1 , and suppose for a contradiction
that |A ∩ B| ≤ t − 1. Hence, we have either A ∈ (In \ F)(b−1) or B ∈ (In \ F)(b−1) or both.
Assume, w.l.o.g., B ∈ (In \ F)(b−1) . Then B ′ := B ∪ {n} ∈ (In ∩ F)(b) . Note that we
13

have A′ := A ∪ {n} ∈ F. Indeed, either A ∈ F and then A′ ∈ F since F is increasing, or
A ∈ (In \ F)(b−1) and then A′ ∈ (In ∩ F)(b) . Since F is t-intersecting, this implies


t ≤ A′ ∩ B ′  ≤ |A ∩ B| + 1 ≤ t.
(4)

This allows applying Lemma 2.9 to A′ , B ′ , to get |A′ | = a.
Now, as |(A′ \ {n}) ∩ B ′ | = t − 1 and F is t-intersecting, we have A′ \ {n} ∈
/ F. Hence,
(a)
′
′
′
A ∈ (In ∩ F) , which yields A ∈
/ G1 . As A ∈ G1 , we must have A = A \ {n} ∈
/ F. By
(b−1)
′
the construction of G1 , this means that A ∈ (In \F)
, and therefore, |A | = a = b, a
contradiction.
The proof of (3) is a straightforward calculation. Write A1 = (In ∩ F)(a) and A2 =
(In ∩ F)(b) . Suppose w.l.o.g. that µp (A1 ) ≥ µp (A2 ). Then
µp (G2 ) = µp (F) − µp (A2 ) +

1−p
µp (A1 ) > µp (F) ,
p

as asserted. It is also clear that equality can hold only if A1 = A2 = ∅, that is, if G1 = G2 = F.
This completes the proof.
The following proposition complements the previous one by showing that the measure of an
n-compressed t-intersecting F can be increased by a small modification even if F ∩ In (F) ⊂
[n] 
. Recall that Di denotes a dictatorship Di := {A ∈ P([n]) : i ∈ A}.
(n+t)/2

Proposition 2.11. Let n, t ∈ N such that n + t is even, and let 0 < p < 1. Let F ⊂ P([n])
be an increasing n-compressed t-intersecting family such that In (F) > 0. Denote a = n+t
2 . For
1 ≤ i ≤ n − 1, let
Gi = (F\ (F ∩ In ∩ Di )(a) ) ∪ (In \ (F ∪ Di ))(a−1) .

Then the families Gi are t-intersecting. Moreover, if 0 < p ≤ 1/2 − ζ, n > t/(2ζ) and (In ∩
F)(a) 6= ∅, then
max {µp (Gi )} > µp (F) .
(5)
i∈[n−1]

Proof. First we prove that for all i, Gi is t-intersecting. Let A, B ∈ Gi , and suppose for a
contradiction that |A ∩ B| ≤ t − 1. Denote A′ := A ∪ {n} and B ′ := B ∪ {n}, and assume
w.l.o.g. B ∈
/ F, and hence, |B ′ | = a and i ∈
/ B ′.
By the same argument as in the proof of Proposition 2.10, we have A′ ∈ F ∩ In . On the
other hand, by Lemma 2.9 (applied for A′ , B ′ ) we have A′ ∪ B ′ = [n], and hence, i ∈ A′ and
|A′ | = a. Thus, A′ ∈ (F ∩ In ∩ Di )(a) , which implies A′ 6∈ Gi . This is a contradiction, as A ∈ Gi
and Gi is increasing.
Now we prove Equation (5). Note that for any i ≤ n−1, there is a one-to-one correspondence
between the families (In \ (F ∪ Di ))(a−1) and (F ∩ In ∩ Dic )(a) . Hence,

 1 − p 

(a)
µp (F ∩ In ∩ Dic )(a)
+
µp (Gi ) = µp (F) − µp (F ∩ In ∩ Di )
p
 1 − p 




(a)
c (a)
+
+ µp (F ∩ In ∩ Di )
= µp (F) − µp (F ∩ In )
µp (F ∩ In ∩ Dic )(a)
p

 1 

= µp (F) − µp (F ∩ In )(a) + µp (F ∩ In ∩ Dic )(a) .
p

14

Let Ki := F ∩ In ∩ Dic . We have
n−1
1
1 X X
µp (A) =
Ei [µp (Ki )] =
n−1
n−1
i=1 A∈Ki

X

A∈(F ∩In )(a) {i:i6∈A}

Thus, there exists i ∈ [n − 1] such that µp (Ki ) ≥
max {µp (Gi )} ≥ µp (F) +

X

n−a
n−1 µp ((F

µp (A) =

n−a
µp ((F ∩ In )(a) ).
n−1

∩ In )(a) ). This implies


n − a − (n − 1) p 
µp (F ∩ In )(a) > µp (F),
(n − 1) p

where the last inequality holds since n − a − (n − 1) p > 0 for all n > t/(2ζ). This completes
the proof.
Combining Propositions 2.10 and 2.11 we obtain:
Corollary 2.12. Let ζ > 0, let 0 < p ≤ 1/2 − ζ and let n ∈ N with n > t/(2ζ). Let F ⊂ P([n])
be an increasing n-compressed t-intersecting family that depends on the nth coordinate (i.e.,
In (F) > 0). Then there exists a t-intersecting family G ⊂ P([n]), such that µp (G) > µp (F)
and µp (F\G) ≤ In (F).
While G obtained in Corollary 2.12 is t-intersecting, it is not necessarily n-compressed. However,
by Proposition 2.8 it can be transformed into an n-compressed family G̃ by a sequence of small
modifications, without decreasing the measure. Then Corollary 2.12 can be applied to G̃ to
increase the measure again. As we show in section 3.2 below, the process can be continued until
the nth coordinate becomes non-influential, i.e., the effective number of coordinates decreases.
Then one may repeat the whole process with the (n − 1)th coordinate etc., so that ultimately,
F can be transformed into a junta by a sequence of small modifications.

2.4

Reduction from k-element sets to the biased measure setting

As shown in several previous works (e.g., [10, 23]), EKR-type results for (t)-intersecting subsets

of [n]
k , for a sufficiently large n, can be proved by reduction to similar results on the µp
measure of (t)-intersecting subsets of P([n]), for an appropriately chosen p. In this subsection
we present the lemmas required for performing such a reduction for the stability version of the
Ahlswede-Khachatrian theorem.

The reduction (in our case) works as follows. Let F ⊂ [n]
k be a t-intersecting family with
|F| > f (n, k, t) − ǫ nk . Recall that F ↑ denotes the increasing family generated by F (i.e., the
minimal increasing family that contains F). We take p slightly larger than nk , and show that:

− ǫ,
(a) µp F ↑ & |Fn | > f (n,k,t)
(k)
(nk)

(b) f (n, p, t) ∼

f (n,k,t)

(nk)

,

 |F \(E)(k) |
(c) µp F ↑ \E ∼
.
(nk)


This essentially reduces stability for subsets of [n]
k to stability in the µp setting. We present
now three propositions that justify the ‘∼’ in (a)-(c). These propositions, or close variants
thereof, were proved in previous works; as they do not appear in the exact form we use them,
we present the simple proofs here.
The first proposition, which was essentially proved by Friedgut [23], shows that (a) holds.
15

Proposition 2.13 (Friedgut). Let δ > 0, let n, k ∈ N with k ≤ n, let
let F ⊂ P ([n]) be increasing. Then
 (k) 
F 
µp (F) ≥ n (1 − δ) .

k+

q
2n log( 1δ )
n

≤ p ≤ 1 and

k

Proposition 2.13 can be proved using the following simple corollary of the local LYM inequality.
Proposition
Let F ⊂ P([n]) be an increasing family. For any 1 ≤ k ≤ m ≤ n, we have
 2.14.
n
(m)
(k)
|F |/ m ≥ |F |/ nk .
Proof of Proposition 2.13. By Proposition 2.14, we have
   (k)  X
   (k) 
n  (m) 
n
X
F
F
F
[n]
[n]
µp (F) ≥
µp
≥ n
= n µp ({S ⊂ [n] : |S| ≥ k})
n  µp
m
m
m
k
k
m=k
m=k
 (k) 
F 
≥ n (1 − δ) ,
k

where the last inequality follows from the choice of p by a standard Chernoff bound.
The second proposition, proved by Dinur and Safra [11], shows that (b) holds.

Proposition 2.15 (Dinur and Safra). Let j ∈ N, ζ, ǫ ∈ (0, 1), and p ∈ [ζ, 1 − ζ]. There exist
δ′ = δ′ (ǫ, j) and n0 = n0 (j, ζ, ǫ) ∈ N such that the following holds for all n > n0 . For any
k ∈ [ζn, (1 − ζ)n] ∩ N such that p − nk  < δ′ and for any j-junta J ⊂ P([n]), we have




[n] 

J
∩


k 
µp (J ) −
 < ǫ.

(6)
n




k

Proof. Assume w.l.o.g. that J depends only on the coordinates in [j]. Since j is fixed, it is
sufficient to prove that (6) holds when J = JC := {A ⊂ [n] : A ∩ [j] = C} for any C ⊂ [j].
And indeed,


n−j  

|{A ∈ [n]
k−|C| 
 |C|
j−|C|
k : A ∩ [j] = C}|
−
| = p (1 − p)
|µp (J ) −
n
n 

k
k


 |C|
k · . . . · (k − |C| + 1) · (n − k) · . . . · (n − k + 1 − j + |C|) 
j−|C|

= p (1 − p)
−

n · . . . · (n − j + 1)







k |C| n − k j−|C| 

< p|C| (1 − p)j−|C| −
 + on→∞ (1) < ǫ,


n
n
where n0 , δ′ clearly can be chosen such that the last inequality holds.

The third proposition, a variant of which was proved by Dinur and Friedgut [10], shows that (c)
holds.
Proposition 2.16 (Dinur and Friedgut). Let j ∈ N, ζ, δ′′ ∈ (0, 1) , and p ∈ [ζ, 1 − ζ]. There
exist C = C (ζ, j) > 0 and n0 (t, ζ, δ′′ ) √
∈ N such that the following holds for all n > n0 and all
log 2
k ∈ [ζn, (1 − ζ)n] ∩ N such that p > k+ 2n
. Let F ⊂ P([n]) be an increasing family, and let
n
′′
J be a j-junta such that µp (F\J ) < δ . Then
 



(k) 
′′ n
(F\J
)
<
Cδ
.


k
16

Proof. Suppose w.l.o.g. that J depends on the coordinates in [j]. Since j is fixed, it is sufficient
to prove that for any E ∈
/ J , we have
 
(k)
′ ′′ n
|{A ∈ F
: A ∩ [j] = E}| ≤ C δ
,
k
for some C ′ = C ′ (ζ, j) > 0. We show that
|{A ∈ F

(k)

: A ∩ [j] = E}| <

2δ′′




n−j
,
k − |E|

(7)
p|E| (1 − p)j−|E|

which is sufficient, as the right hand side of (7) is ≤ C ′ δ′′ nk by the proof of Proposition 2.15.
Suppose for a contradiction that (7) fails. By Proposition 2.13 (with δ′ = 1/2), we have


δ′′
2δ′′
E
·
(1
−
1/2)
=
.
µp F[j] >
p|E| (1 − p)j−|E|
p|E| (1 − p)j−|E|


E > δ ′′ , a contradiction. This completes the proof.
Hence, µp (F\J ) ≥ p|E| (1 − p)j−|E| µp F[j]

2.5

Cross-Intersecting Families

Definition. Families F, G ⊂ P([n]) are said to be cross-intersecting if A∩ B 6= ∅ for any A ∈ F
and B ∈ G.
The first generalization of the Erdős-Ko-Rado theorem to cross-intersecting families was
obtained in 1968 by Kleitman [40], and since then, many extremal results on cross-intersecting
families have been proved. Such results assert that if F, G are cross-intersecting then they
cannot be ‘simultaneously large’, where the latter can be expressed in various ways. We need
several such results. The first is a consequence of the Kruskal-Katona theorem [41, 35].

[n]
Lemma 2.17. Let n, k, l ∈ N with n ≥ k + l, letr ∈ N ∪ {0}, and let A ⊂ [n]
be
k , B ⊂
l
n
n−r
n−r
cross-intersecting families. Suppose that |A| ≥ k − k . Then |B| ≤ l−r .
 
n 
n−r 
Proof. Let Ā := {[n] \ A : A ∈ A}; then Ā ≥ n−k
− n−k−r
. By the Kruskal-Katona
 n−k−l 
n
n−r 


theorem, we have ∂
Ā ≥ l − l−r . Since A and B are cross-intersecting, we have

 


n−k−l
B∩∂
Ā = ∅. Hence, |B| ≤ nl − ∂ n−k−l Ā  ≤ n−r
l−r , as required.
Straightforward estimates for the binomial coefficients yield the following consequence.

Lemma 2.18. For each ζ > 0, there exists c = c(ζ) > 1 such that the following holds. Let

[n]
ζn ≤ k1 , k2 ≤ ( 21 − ζ)n, and let A ⊂ [n]
k1 , B ⊂ k2 be cross-intersecting families. If µ (A) >
1 − ǫ, then µ (B) = Oζ (ǫc ).
The second extremal result we need is a consequence of Lemma 2.3. It was first proved
in [12]; we reproduce the proof here, for completeness.
Proposition 2.19 ([12], Lemma 2.7). Let 0 < p ≤ 1/2, and let F, G ⊂ P([n]) be crossintersecting families. Then µp (F) ≤ (1 − µp (G))log1−p p .
Proof. Since F and G are cross-intersecting, we have F ⊂ G ∗ . Hence, µ1−p (F) ≤ µ1−p (G ∗ ) = 1−
µ1−p (Ḡ) = 1 − µp (G). Hence, by Lemma 2.3, µp (F) ≤ (µ1−p (F))log 1−p (p) ≤ (1 − µp (G))log 1−p (p) ,
as required.
17

Note that equality holds in Proposition 2.19 when F = {S ⊂ [n] : B ⊂ S} =: ANDB , and
G = {S ⊂ [n] : B ∩ S 6= ∅} =: ORB , where B ⊂ [n].
A special case of Proposition 2.19, with a much simpler proof, is as follows.
Lemma 2.20. If F, G ⊂ P ([n]) are cross-intersecting, then
µ1/2 (F) + µ1/2 (G) ≤ 1.
Proof. Let A ∼ µ1/2 . Then µ1/2 (F) = Pr[A ∈ F]. On the other hand, [n] \ A is also distributed
according to µ1/2 . Therefore, µ1/2 (G) = Pr[[n]\A ∈ G]. Since the families F, G are crossintersecting, the events {A ∈ F} and {[n]\A ∈ G} are disjoint. Therefore, we have
µ1/2 (F) + µ1/2 (G) = Pr[A ∈ F] + Pr[[n]\A ∈ G] = Pr[{A ∈ F} ∪ {[n]\A ∈ G}] ≤ 1,
as required.
Before we state the third extremal result, we need a few preliminaries.

Notation 2.21. For X ⊂ N, i ∈ N and F ⊂ Xi , we write L(F) for the initial segment of the


lexicographic order on Xi with size |F|. We say a family C ⊂ Xi is lexicographically ordered

if it is an initial segment of the lexicographic order on Xi , i.e., L(C) = C.

The following result was proved by Hilton (see [17], Theorem 1.2).

[n]
Proposition 2.22 (Hilton). If F ⊂ [n]
are cross-intersecting, then L(F), L(G) are
k , G ⊂ l
also cross-intersecting.

The third extremal result we need on cross-intersecting families is the following, which was first
proved in [12]; we reproduce the proof for completeness.
Lemma 2.23 ([12], Lemma 4.7). For any η > 0 and any C ≥ 0, there exists c0 = c0 (η, C) ∈ N
such that the following holds. Let n, l, k, d ∈ N ∪ {0} with n ≥ (1 + η)l + k + c0 and l ≥ k + c0 − 1.

[n]
Suppose that A ⊂ [n]
l , B ⊂ k are cross-intersecting, and that

    


n
[n] 
n−d

|A| ≤ OR[d] ∩
=
−
.
l
l 
l

Then

  



n
n−d
n−d
|A| + C |B| ≤
−
+C
.
l
l
k−d

Proof. We prove the lemma by induction on k. For k = 0 the lemma holds trivially. Assume
now that k ≥ 1, and that the statement of the lemma holds for k − 1. For d = 0, the statement
of the lemma holds trivially, so we may assume throughout that d ≥ 1. By Proposition 2.22,
we may assume that A and B are lexicographically
ordered. Since
n
o d ≥ 1, we have |A| ≤




(l)
(i)
n
n−1
n−1
[n]
= l−1 , so A ⊂ F1 , where F1 := A ∈ i : 1 ∈ A for each i ∈ [n].
l −
l
(l)

(l)

We split into two cases: A = F1 and A ( F1 .
(l)

(k)

Case 1: A = F1 . First note that B ⊂ F1 . Indeed, suppose on the contrary that B ∈ B

and 1 ∈
/ B. Since n ≥ k + l, there exists A ∈ [n]
such that 1 ∈ A and A ∩ B = ∅. Hence,
l
18

(l)

(k)

A ∈ F1 = A, and A ∩ B = ∅, a contradiction. Hence, we may assume that B = F1 . We must
prove that



   



n−1
n−1
n
n−d
n−d
+C
≤
−
+C
∀d ≥ 1.
(8)
l−1
k−1
l
l
k−d

This clearly holds (with equality) if d = 1. To verify it for all d ≥ 2 it suffices to show that



   

n−1
n−1
n
n−2
+C
≤
−
,
l−1
k−1
l
l
or equivalently,

 

n−1
n−2
C
≤
.
k−1
l−1

We have
n−1
k−1
n−2
l−1

n−2
n − 1 k−1
(l − 1)(l − 2) . . . k
=
 ≤2
n−2
n − k l−1
(n − k − 1)(n − k − 2) . . . (n − l)


l−k
c−1
l−1
l−2
1
≤2
≤2
≤ ,
n−k−1
l + ηl + c − 1
C

provided c0 is sufficiently large depending on η and C, as required.

(l)
Case 2: A ( F1 . If |A| ≤ n−2
l−2 , then


  
   



n−2
n
n−1
n
n−d
n−d
|A| + C |B| ≤
+C
≤
≤
−
+C
,
l−2
k
l−1
l
l
k−d
where the second inequality holds since
n−1
n
n
n
(l − 2)(l − 3) . . . (k + 1)
k
k
k
n−1
n−2 = n−1 = n − k n−1 ≤ 2 (n − k − 1)(n − k − 2) . . . (n − l + 2)
l−1 − l−2
l−2
l−2


l−k−2
c−3
l−2
l−2
1
≤2
≤2
≤ ,
n−k−1
l + ηl + c − 1
C
provided c0 is sufficiently large depending on η and C. Hence, we may assume that




n−2
n−1
≤ |A| ≤
.
l−2
l−1

Therefore, since A is lexicographically ordered, we have A ⊃ {S ∈ [n]
: 1, 2 ∈ S}. Hence,
l
B ∩{1, 2} =
6 ∅ for all B ∈ B. (If there exists B ∈ B with B ∩{1, 2} = ∅, then since n ≥ k+l, there

exists A ∈ [n]
with A ∩ B = ∅ and 1, 2 ∈ A, but the latter implies A ∈ A, a contradiction.)
l
(k)

Therefore, since B is lexicographically ordered, we have B ⊃ F1 .
Observe that
{2}
{1}
A{1,2} ⊆ ([n] \ [2])(l−1) , B{1,2} ⊂ ([n] \ [2])(k−1)

{1}
are cross-intersecting, and trivially |A{1,2} | ≤ n−2
l−1 . Hence, by the induction hypothesis (which
we may apply since (n − 2) ≥ (1 + η)(l − 1) + (k − 1) + c0 and l − 1 ≥ k − 1 + c0 − 1, choosing
d = n − 2), we have
 n − 2



 {2} 
 {1} 
,
B
+
C
A
 {1,2}  ≤
 {1,2} 
l−1
19

and therefore,



 




n−2
n−1
 {1} 
 {2} 
|A| + C|B| =
+ A{1,2}  + C
+ C B{1,2} 
l−2
k−1

 



n−2
n−2
n−1
≤
+
+C
l−2
l−1
k−1




n−1
n−1
=
+C
l−1
k−1
  



n
n−d
n−d
≤
−
+C
,
l
l
k−d
using (8) for the last inequality. This completes the proof.
We need the following consequence of Lemma 2.23.
Proposition 2.24. Let n, j, M ∈ N, ζ ∈ (0, 1/2), and let ζn ≤ k1 , k2 ≤ ( 21 − ζ)n be such that

|k2 − k1 | ≤ j. There exists c = c (M, ζ, j) ∈ N such that the following holds. Let F ⊂ [n]
k1 and

G ⊂ [n]
k2 be cross-intersecting families such that for some d ∈ {c, c + 1, . . . , k2 }, we have


Then |F| + M |G| ≤

n
k1

−

n−d
k1




n−d
n−c
≤ |G| ≤
.
k2 − d
k2 − c

+M

(9)

n−d 
k2 −d .

Proof. By Lemma 2.22, we may assume that F and G are lexicographically ordered. In addition,
by an appropriate choice of c, we may assume throughout that n ≥ n0 for any n0 = n0 (M, ζ, j) ∈
N.
[c]
∅
Consider the families F[c]
and G[c] (for c to be specified below), which are clearly crossintersecting. As G is lexicographically ordered, the assumption (9) implies G ⊂ S[c]. Moreover,
[c]

[c]

∅
G[c] is also lexicographically ordered, and hence, by (9) we have S{c+1,...,d} ⊂ G[c] . Since F[c]
[c]

∅
⊂ OR{c+1,...,d} , and thus,
cross-intersects G[c] , this implies F[c]
∅
|F[c]
|

≤



 

n−c
n−d
−
.
k1
k1

This allows us to apply Lemma 2.23 to the cross-intersecting families
∅
F[c]
⊂ ([n] \ [c]) (k1 ) ,

[c]

G[c] ⊂ ([n] \ [c])(k2 −c) ,

with the parameters n′ = n − c, l′ = k1 , k′ = k2 − c, d′ = d − c, C ′ = M and η ′ = ζ, provided
that c := c0 (ζ, M ) + j, to obtain


  n − c n − d


n−d
 [c] 
 ∅
G
F
+
M
≤
−
+
M
.
(10)
 [c] 
 [c] 
k1
k1
k2 − d

(Note that we have n′ ≥ (1 + η ′ )l′ + k′ + c0 , provided n0 (M, ζ, j) is sufficiently large.) Finally,
we clearly have

  
n−c
n
∅
+ |F[c]
|,
−
|F| ≤
k1
k1
20

[c]

and the assumption (9) implies |G[c] | = |G|. Therefore, (10) yields
  
 

 
n
n−c
 ∅
 [c] 
|F| + M |G| ≤
−
+ F[c]
 + M G[c] 
k1
k1
  
 
 



n
n−c
n−c
n−d
n−d
≤
−
+
−
+M
k1
k1
k1
k1
k2 − d
  



n
n−d
n−d
=
−
+M
,
k1
k1
k2 − d
as asserted.
We also need a ‘stability result’ for cross-intersecting families, giving structural information
about one of the families, when the other family is somewhat large. A similar result (with a
similar proof) appears in Dinur and Friedgut [10, Lemma 3.2]. One of the main tools is the
biased version of Friedgut’s Junta Theorem (Theorem 2.4).
Lemma 2.25. For any ζ, ǫ ∈ (0, 1), there exist s = s(ζ, ǫ), n0 = n0 (ζ, ǫ) ∈ N such that the

[n]
following holds. Let n ≥ n0 , let 0 ≤ k1 , k2 ≤ ( 21 − ζ)n, let F ⊂ [n]
k1 , G ⊂ k2 be crossintersecting,
 ǫ and suppose that µ (G) ≥ ǫ. Then there exists S ⊂ [n] such that |S| ≤ s and
∅
µ FS < 2 .

Informally, this lemma says that if we have a pair of cross-intersecting families of uniformity
bounded away from n/2, and one of the families occupies a positive fraction of its layer, then
all but a small number of the sets in the other family have nontrivial intersection with some
set of bounded size.
Proof of lemma 2.25. Clearly, the families F ↑ and G ↑ are cross-intersecting. Hence, by Lemma
2.20, we have
µ1/2 (F ↑ ) + µ1/2 (G ↑ ) ≤ 1.
Therefore, using Proposition 2.13, we have
µ1/2 (F ↑ ) ≤ 1 − µ1/2 (G ↑ ) ≤ 1 − µ(G) + exp(−ζ 2 n/2) ≤ 1 − ǫ + exp(−ζ 2 n/2) ≤ 1 − ǫ/2,
provided n is sufficiently large depending on ζ and ǫ. Let p = 21 ( kn1 + 21 ). The Margulis-Russo
Lemma and the Mean Value Inequality imply that there exists q ∈ (p, 1/2) such that

µ1/2 (F ↑ ) − µp (F ↑ )
dµq F ↑
2
q
↑


I (F ) =
≤ .
≤
k1
1 1
dq
ζ
2 2 − n

By Theorem 2.4, there exists J ⊂ [n] with |J| = Oζ,ǫ (1) and a J-junta hHi (i.e. H ⊂ P(J)),
ǫ2
. Note also that since q ≤ 1/2, F ↑ is monotone, and the function
such that µq (F ↑ ∆ hHi) < 16
x 7→ µx (A) is monotone non-decreasing for any increasing family A ⊂ P ([n]), we have
µq (F ↑ ) ≤ µ1/2 (F ↑ ) ≤ 1 − ǫ/2.
 ǫ
Claim 2.26. µq (F ↑ )∅
J < 4.

21

 ǫ
Proof. Suppose for a contradiction that µq (F ↑ )∅
J ≥ 4 . Then




X
q |B| (1 − q)|J|−|B| µq (F ↑ )B
µq F ↑ \hHi =
J
B ∈H
/

≥

X

B ∈H
/

q |B| (1 − q)|J|−|B|

ǫ
4

ǫ
(1 − µq (hHi))
4


 
ǫ
1 − µq F ↑ − µq hHi\(F ↑ )
≥
4

ǫ2
ǫ ǫ
−
≥
4 2 16
ǫ2
>
,
16
≥

a contradiction.
∅
↑
Since FJ∅ = F ↑ J , we have
µ

FJ∅



≤ µq



(F ↑ )∅
J



1
+ exp −
2



ζ
j
−
2 n

2 !
ǫ
n < ,
2

provided n is sufficiently large depending on ζ, ǫ and j, using Proposition 2.13 again. This
completes the proof.

3

Proof of our stability result for the Ahlswede-Khachatrian
theorem

In this section, we prove Theorem 1.6, our stability result for the Ahlswede-Khachatrian theorem.

3.1

A Bootstrapping Lemma

In this subsection, we present a bootstrapping argument showing that if a t-intersecting F is
already ‘somewhat’ close to E, then it must be ‘very’ close to E. We use this argument to show
that there exists a ‘barrier’ in the distance of F from E that cannot be crossed by performing
only small modifications.
Lemma 3.1 (Bootstrapping Lemma). Let t ∈ N and let ζ > 0. Then there exists C = C(t, ζ) >
0 such that the following holds. Let ζ ≤ p ≤ 1/2 − ζ, let ǫ > 0, let F ⊂ P([n]) be a t-intersecting
family, and let G ∈ E. If
µp (F ∩ G) ≥ µp (G) (1 − ǫ) ,
then
µp (F\G) ≤ Cǫlog1−p p .
Proof. Without loss of generality, we may assume that G = Fn,t,r for some r ∈ N. Note
that, since p ≤ 1/2 − ζ, we have r ≤ r0 (t, ζ) (this argument was already used in the proof

22

of Proposition 2.6). Hence, the assumption µp (F ∩ Fn,t,r ) ≥ µp (Fn,t,r ) (1 − ǫ) implies that for
any D ∈ F2r+t,t,r , we have


D
≥ 1 − Ot,ζ (ǫ) .
(11)
µp F[2r+t]

It is clear that for each E ∈
/ F2r+t,t,r , there exists D ∈ F2r+t,t,r such that |D ∩ E| ≤ t − 1. Since
D
E
F is t-intersecting, for any such D, E, the families F[2r+t]
and F[2r+t]
are cross-intersecting. By
Proposition 2.19 and (11), this implies


 
log1−p p


E
D
µp F[2t+r]
≤ 1 − µp F[2r+t]
≤ (Ot,ζ (ǫ))log1−p p = Ot,ζ ǫlog1−p p .

Therefore,

µp (F\Fn,t,r ) =

X

E ∈F
/ 2r+t,t,r



E
p|E| (1 − p)2r+t−|E| µp F[2r+t]



≤ Ot,ζ ǫlog1−p p

X

E∈P[2r+t]



p|E| (1 − p)2r+t−|E| = Ot,ζ ǫlog1−p p .

This completes the proof.
The following corollary shows that in order to prove Theorem 1.10, it is sufficient to show that
as µp (F) → f (n, p, t), the distance µp (F \ E) is smaller than a sufficiently small constant c.
Corollary 3.2. Let t ∈ N and ζ > 0. There exist positive constants C̃, c, ǫ0 depending only on
ζ and t, such that for any t-intersecting family F ⊂ P([n]) and any p ∈ [ζ, 1/2 − ζ], if
µp (F\E) ≤ c
for some ǫ ≤ ǫ0 , then

µp (F) ≥ f (n, p, t) (1 − ǫ)

and

µp (F\E) ≤ C̃ǫlog1−p p .

Proof. By the assumption on F, there exists G ∈ E such that
µp (F ∩ G) ≥ f (n, p, t)(1 − ǫ) − c.
Hence, by Lemma 3.1, we have µp (F\E) ≤ C(ǫ + c/f (n, p, t))log 1−p p for some C = C(t, ζ). Let
c be sufficiently small (as a function of t, ζ) such that C · (2c/f (n, p, t))log 1−p p ≤ c/2 for all
p ∈ [ζ, 1/2 − ζ]. If ǫ > c/f (n, p, t), then
µp (F\E) ≤ C(ǫ + c/f (n, p, t))log1−p p ≤ C · (2ǫ)log1−p p ≤ C̃ǫlog1−p p ,
and we are done. Otherwise, we have
µp (F\E) ≤ C(ǫ + c/f (n, p, t))log1−p p ≤ C · (2c/f (n, p, t))log 1−p p < c/2.
In such a case, we can repeat the process with the same ǫ and c/2 instead of c. At some stage
c will become sufficiently small so that ǫ > c/f (n, p, t), and then (as in the first case) we have
µp (F\E) ≤ C̃ǫlog1−p p , as asserted.
Finally, we can use the proof of Corollary 3.2 to show the existence of a barrier that cannot be
crossed by small modifications.
23

Corollary 3.3. Let t ∈ N and let ζ > 0. Let F ⊂ P([n]) be t-intersecting, and let p ∈ [ζ, 1/2−ζ].
Let c, ǫ0 be as in Corollary 3.2, and let ǫ1 := min(ǫ0 , c/f (n, p, t)). Suppose that
µp (F) ≥ f (n, p, t) (1 − ǫ1 )

and

µp (F\E) > c.

Let G ⊂ P([n]) be a t-intersecting family with µp (G) > µp (F) which is a (c/2)-small modification of F (i.e., µp (F\G) < 2c ). Then
µp (G\E) > c.
Proof. Suppose for a contradiction that µp (G\E) ≤ c. By the proof of Corollary 3.2, we have
µp (G\E) < 2c . This yields
µp (F\E) ≤ µp (F\G) + µp (G\E) < c,
a contradiction.

3.2

Proof of Theorem 1.10

Let us recall the statement of Theorem 1.10.
Theorem. For any t ∈ N
 and any ζ > 0, there exists C = C(t, ζ) > 0 such that the following
holds. Let p ∈ ζ, 12 − ζ , and let ǫ > 0. If F ⊂ P([n]) is a t-intersecting family such that
µp (F) ≥ f (n, p, t) (1 − ǫ), then there exists a family G isomorphic to some Fn,t,r , such that
µp (F\G) ≤ Cǫlog1−p p .



4
Proof. Let c, ǫ1 be as in Corollary 3.3, and let ǫ2 := ǫ t, ζ, max t + 2ℓ(t, ζ), t/(2ζ), c2 p(1−p)
in the notations of Proposition 2.6. Define ǫ3 := min(ǫ1 , ǫ2 ). Let r := ℓ(t, ζ).
Let F ⊂ P([n]) be a t-intersecting family. By replacing F with F ↑ , we may assume that
F is increasing. We may also assume that µp (F) ≥ f (n, p, t) (1 − ǫ3 ). (There is no loss of
generality in this assumption, as C can be chosen such that the theorem holds trivially for all
ǫ > ǫ3 .) We would like to show that µp (F\E) ≤ c. This will complete the proof of the theorem
by Corollary 3.2.
We let F0 = F and construct a sequence (Fi ) of increasing t-intersecting families such that
each Fi is obtained from Fi−1 by a series of c/2-small modifications. Each ‘step’ in the sequence
is composed of compression (using the process of section 2.3.1) and measure increase (using the
process of section 2.3.2). The construction of Fi from Fi−1 is defined as follows:
1. If either Fi−1 depends on at most max{t + 2r, t/(2ζ)} coordinates, or else
min

j: Ij (Fi−1 )>0

Ij (Fi−1 ) ≥ c/2,

then stop.
2. Consider the set of coordinates with non-zero influence on Fi−1 . Assume w.l.o.g. that this
set is [m], and that minj∈[m] Ij (Fi−1 ) = Im (Fi−1 ). Transform Fi−1 to an m-compressed
increasing t-intersecting family Gi−1 with µp (Gi−1 ) = µp (Fi−1 ) by a sequence of small
modifications (as described in Proposition 2.8).
3. Transform Gi−1 into an increasing t-intersecting family Fi with µp (Fi ) > µp (Gi−1 ) by a
small modification (as described in Corollary 2.12, which can be applied since m > t/(2ζ))
and then taking the up-closure to turn the family into an increasing family.
24

We claim that during all the process, all modifications are c/2-small, and that the process
terminates after a finite number of steps.
Indeed, Proposition 2.8 assures that all modifications in the m-compression process are
Im (Fi−1 )-small, and we have Im (Fi−1 ) < c/2, as otherwise the process terminates by (1.).
Similarly, Corollary 2.12 (which can be applied to Gi−1 , since Gi−1 is m-compressed) assures that
the transformation to Fi is an Im (Gi−1 )-small modification, and by Proposition 2.8, Im (Gi−1 ) ≤
Im (Fi−1 ) < c/2. By the construction, the sequence of measures (µp (Fi )) is strictly monotone
increasing in i. As the measure of a family Fi ⊂ P([n]) can assume only a finite number of
values, the sequence eventually terminates.
Let Fℓ be the last element of the sequence. As the sequence terminated at the ℓ’th step,
either Fℓ depends on at most max{t + 2r, t/(2ζ)} coordinates or else minj: Ij (Fℓ )6=0 Ij (Fℓ ) ≥ c/2.
4
coordinates. Thus, in either
In the latter case, by Proposition 2.5 Fℓ depends on at most c2 p(1−p)
o
n
4
coordinates. Since µp (Fℓ ) > µp (F) ≥
case Fℓ depends on at most max t + 2r, t/(2ζ), c2 p(1−p)
f (n, p, t) (1 − ǫ3 ), Proposition 2.6 implies that Fℓ ∈ E. In particular, µp (Fℓ \ E) = 0 < c.
Now, we unroll the steps of the sequence. As Fℓ was obtained from Fℓ−1 by a c/2-small
modification, Corollary 3.3 implies µp (Fℓ−1 \ E) < c. The same holds for any step of the
sequence, and thus, by (reverse) induction, we get µp (F \ E) = µp (F0 \ E) < c. As mentioned
above, this completes the proof of the theorem by Corollary 3.2.

3.3

Tightness of Theorem 1.10

As mentioned in the introduction, Theorem 1.10 is tight (up to a factor depending upon t and
ζ alone) for the families
H̃n,t,r,s := {A ⊂ P ([n]) : |A ∩ [t + 2r]| ≥ t + r, A ∩ {t + 2r + 1, . . . , t + 2r + s} =
6 ∅}

∪ {A ⊂ P ([n]) : |A ∩ [t + 2r]| = t + r − 1, {t + 2r + 1, . . . , t + 2r + s} ⊂ A} ,

for all sufficiently large n and s. Here
is the computation
showing this. Let ζ ≤ p ≤ 1/2 − ζ.
i
h
r+1
r
Choose r ∈ N ∪ {0} such that p ∈ t+2r−1 , t+2r+1 ; then we have
f (n, p, t) = µp (Fn,t,r ) =

t+2r
X

i=t+r




t + 2r i
p (1 − p)t+2r−i
i

(12)

for all n ≥ t + 2r. For all n ≥ t + 2r + s, we have

and





t + 2r
s
µp H̃n,t,r,s = f (n, p, t) (1 − (1 − p) ) +
pt+r−1 (1 − p)r+1 ps ,
t+r−1

(13)

  t + 2r 

µp H̃n,t,r,s \Fn,t,r =
pt+r−1 (1 − p)r+1 ps .
t+r−1

(14)

Note that all the expressions (12), (13) and (14) are independent of n. Moreover, since ζ < p <
t+2r
1/2 − ζ, we have r = Ot,ζ (1) and therefore t+r−1
pt+r−1 (1 − p)r+1 = Θt,ζ (1). Hence, for all
s ≥ s0 (t, ζ) and all n ≥ t + 2r + s, we have



µp H̃n,t,r,s = f (n, p, t) (1 − (1 − p)s ) + Θt,ζ (1)ps ≥ f (n, p, t) 1 − 12 (1 − p)s ,
25

while µp (H̃n,t,r,s \Fn,t,r ) = Θt,ζ (1)ps . Writing ǫ := 12 (1 − p)s , we have
µp (H̃n,t,r,s ) ≥ f (n, p, t) (1 − ǫ) ,

µp (H̃n,t,r,s \Fn,t,r ) = Θt,ζ (ǫlog1−p p ),

which is tight for Theorem 1.10.
We remark that it is very easy to see that the families Hn,k,t,r,d (defined in the Introduction)
are tight for Theorem 1.6, for n and d sufficiently large.

3.4

Proof of Theorem 1.6

In this section we present the proof of Theorem 1.6. First, we deduce a ‘weak stability’ result
from Theorem 1.10, using the reduction technique presented in section 2.4. Then, we use a
‘bootstrapping’ technique similar to in the proof of Lemma 3.1, to leverage the weak stability
result into the assertion of the theorem.
Proposition 3.4 (Weak stability theorem). Let t ∈ N and ζ, ǫ > 0. There exist C = C (t, ζ) > 0
and n0 (t,
ζ, ǫ) ∈ N such that the following holds for all n > n0 , all k ∈ [ζn, (1/2 − ζ)n] ∩ N and
√


k+ 4n log n
. Let F ⊂ [n]
be a t-intersecting family that satisfies |F| ≥ f (n, k, t) − ǫ nk .
p=
n
k

Then there exists G isomorphic to some Fn,k,t,r such that |F\G| ≤ Cǫlog1−p p nk , where r ≤ C.
Proof. Let F, k and p satisfy the assumption of the proposition, and let F ↑ ⊂ P([n]) be the
increasing family generated by F. By Proposition 2.13, for a sufficiently large n,
!

 
f
(n,
k,
t)
f (n, k, t)
1
↑
µp F ≥
≥
−ǫ
− 2ǫ.
1−
n
n
n
k
k

Let Fn,p,t,r ∈ E be a family for which the maximal µp measure is attained, i.e., µp (Fn,p,t,r ) =
f (n, p, t). As p ≤ 1/2 − ζ/2 (which holds assuming that n is sufficiently large), Fn,p,t,r depends
on at most j coordinates, for some j = j(t, ζ) ∈ N. Hence, by Proposition 2.15,
(k)

f (n, p, t) = µp (Fn,p,t,r ) <

|Fn,p,t,r |
f (n, k, t)
 +ǫ≤

+ ǫ.
n
n
k

Thus, µp F
get


↑

k

≥ f (n, p, t) − 3ǫ. Since F ↑ is t-intersecting, we can apply to it Theorem 1.10 to
µp (F ↑ \ G̃) ≤ C ′ ǫlogp (1−p) ,

for some G̃ ∈ E and C ′ = C ′ (t, ζ). Finally, denoting G := G̃ (k) , we obtain by Proposition 2.16
 
↑
(k)
log1−p p n
|F\G| = |(F \ G̃) | < Cǫ
,
k
for a sufficiently large C = C(t, ζ), as asserted.
Proposition 3.4 shows that the assertion of Theorem 1.6 holds for all n ≥ n0 (t, ζ, ǫ). This is
not sufficient for Theorem 1.6, in proving which we may only assume n to be large in terms of
t, ζ (and not in terms of ǫ). However, we can apply Proposition 3.4 with any moderately small
ǫ0 (t, ζ) > 0 to conclude that for any n ≥ n1 (t, ζ), if F satisfies
the assumption of Theorem 1.6

then there exists G ∼
= Fn,k,t,r such that |F\G| ≤ ǫ0 nk . In the proof of Theorem 1.6 below,
we use this weak stability version, with ǫ0 chosen in such a way that we will be able to use
Proposition 2.24 to bootstrap the ‘weak stability’ into ‘strong stability’.
Let us recall the formulation of Theorem 1.6.
26

 
Theorem. Let n, t, d ∈ N, ζ ∈ (0, 1/2), and k ∈ ζn, 12 − ζ n . There exists C = C (t, ζ) > 0


such the following holds. Let F ⊂ [n]
f (n, k, t) − C1 n−d
.
k
k be a t-intersecting family with |F| >

n−d
Then there exists G isomorphic to some Fn,k,t,r such that |F\G| < C k−d , where r ≤ C.

Proof of Theorem 1.6. Recall that for fixed t, ζ, all elements of E are juntas on at most j =
j(t, ζ) elements. Denote c = c 2j , t, ζ in the notations of Proposition 2.24. Let F be a family
that satisfies the assumption of the theorem (with a sufficiently large C = C(t, ζ) > 0 to be
specified below). Clearly, we may assume that d ≤ k + 1. By increasing C if necessary, we may
assume that d ≥ d0 (t, ζ) for any d0 (t, ζ) ∈ N and that n ≥ n0 (t,ζ) for any n
0 (t, ζ) ∈ N.
n
n−c−j
Provided n0 = n0 (t, ζ) is sufficiently large, we have k−c−j = Θt,ζ k . Hence, we can
apply Proposition 3.4 to conclude that there exists G ∈ (E)(k) such that


n−c−j
|F\G| <
.
(15)
k−c−j
′
Suppose w.l.o.g. that G depends only on the coordinates in [j], and denote
 by G the restriction
 O
of G to P ([j]) (i.e., G ′ = {A ∩ [j] : A ∈ G}). Let O ∈
/ G ′ be such that F[j]
 is maximal. We



 O
would like to show that F[j]
 ≤ n−d
k−d . This will complete the proof, as

|F \ G| =

X

S∈P([j])\G ′

Suppose for a contradiction that





 S
 O
F[j]  ≤ 2j F[j]
.


 n − d
 O
.
F[j]  >
k−d

It is clear that there exists I ∈ G ′ such that |I ∩ O| ≤ t − 1. We have





 
X
n−j
 I 
S
j  O
|F| =
|F[j] | ≤ F[j]  + 2 F[j]  + |G| −
k − |I|

(16)

(17)

S∈P([j])

P
P
S
S
(where the two last summands are upper bounds on
S∈G ′ \{I} |F[j] |,
S∈P([j])\G ′ |F[j] | and
I , F O are crossrespectively). Now, we note that since F is t-intersecting, the families F[j]
[j]
intersecting. We have






n−c−j
n−j−c
 O
≤
F[j]  ≤
k−c−j
k − |O| − c

(where the first inequality follows from (15) and the second holds provided n0 = n0 (t, ζ) is
sufficiently large), and on the other hand,

 n − d  n − j − d 
 O
≥
F[j]  ≥
k−d
k − |O| − d

(where the first inequality follows from (16) and the second holds trivially). Thus, we can apply
Proposition 2.24 to get





  n − j  n − j − d 
n−j−d
 I 
j  O
j
−
+2
.
F[j]  + 2 F[j]  ≤
k − |I|
k − |I|
k − |O| − d
27

By (17), this implies

 


 


n−j
n−j −d
n−j −d
n−j
j
|F| ≤
−
+2
+ |G| −
k − |I|
k − |I|
k − |O| − d
k − |I|




n−j−d
n−j−d
= |G| −
+ 2j
k − |I|
k − |O| − d


1 n−d
,
≤ f (n, k, t) −
C
k
where the last inequality holds for all d0 ≤ d ≤ k + 1 and all n ≥ n0 , provided C = C(t, ζ),
n0 = n0 (t, ζ) and d0 = d0 (t, ζ) are all sufficiently large. This contradicts our assumption on F,
completing the proof.

4

Proof of our weak regularity lemma

In this section we prove Theorem 1.7, our ‘weak regularity lemma’ for hypergraphs of uniformity
linear in the number of vertices. First, we need some preliminaries.
Jensen’s inequality states that for any convex function f : R → R, and for any real-valued,
integrable random variable X, we have
E[f (X)] ≥ f (E[X]).

(18)

It turns out that under certain conditions, if the inequality (18) is approximately an equality,
then X is ‘highly concentrated’ around its mean. The following is a restatement of Lemma 7 of
Fox [16]; it may be seen as a stability version of Jensen’s inequality for the function x 7→ x log x.
Lemma 4.1. Let Ω be a finite probability space, let X : Ω → R≥0 be a nonnegative random
variable, and let f : R≥0 → R be the convex function defined by
(
x log x x > 0
f (x) :=
0
x = 0,
and let β ∈ (0, 1). Then
E (f (X)) ≥ f (E (X)) + (1 − β + f (β)) Pr [X ≤ βE (X)] E (X) .
The following is an easy corollary of Lemma 4.1.
Corollary 4.2. Let f be the function in Lemma 4.1. For each λ, δ ∈ (0, 1) and C > 0, there
exists η = η (λ, δ, C) > 0 such that the following holds. Let Ω be finite probability space, and
suppose that Pr(ω) ≥ λ for all ω ∈ Ω. Let X : Ω → R≥0 be a nonnegative random variable such
that E[X] ≤ C and
E [f (X)] < f (E[X]) + η.
Then
kX − E[X]k∞ < δ.
Corollary 4.2 says that if Jensen’s inequality (18) is close to being an equality for the function
f and a ‘well-behaved’ random variable X, then the random variable X is highly concentrated
around its mean.
28

Proof of Corollary 4.2. Let η = η (λ, δ, C) > 0 to be chosen later. Suppose that
E [f (X)] < f (E[X]) + η,
and suppose for a contradiction that kX − E[X]k∞ ≥ δ. First suppose that minω∈Ω X(ω) ≤
E[X] − δ. Then




δ
E[X] ≥ λ,
Pr X ≤ 1 −
E[X]

so by applying Lemma 4.1 with β = 1 − δ/E[X], we have



δ
δ
E[f (X)] ≥ f (E[X]) +
+f 1−
λE[X].
E[X]
E[X]
Let γ := δ/E[X]; then γ ∈ [0, 1]. It is easily checked that
γ + f (1 − γ) ≥ γ 2 /2 ∀γ ∈ [0, 1].
It follows that
E[f (X)] ≥ f (E[X]) +

λδ2
λδ2
≥
.
2E[X]
2C

Second, suppose that minω∈Ω X(ω) > E[X] − δ; then maxω∈Ω X(ω) ≥ E[X] + δ. Let
M = minω∈Ω X(ω); then
(1 − λ)M + λ(E[X] + δ) ≤ E[X],
so

λδ
.
1−λ
Hence, by the argument above, replacing δ with λδ/(1 − λ), it follows that
M ≤ E[X] −

E[f (X)] ≥ f (E[X]) +
Choosing
η = min
yields a contradiction.



λ3 δ2
.
2(1 − λ)2 C

λδ2
λ3 δ2
,
2C 2(1 − λ)2 C



A ‘potential’ argument
The idea of the proof of Theorem 1.7 is to define a non-positive potential function φ : P
P([n]) → [−1/e, 0] with the following properties.





[n]
k

×

1. φ (F, S) = 0 if and only if F is an S-junta.
2. If S ⊂ S ′ ⊂ [n], then φ (F, S) ≤ φ (F, S ′ ).

3. If k/n is bounded away from 0 and 1, then for any F ⊂ [n]
and any S ⊂ [n], either
k
there exist sets B1 , . . . Bl ⊂ S such that the junta h{B1 , . . . , Bl }i satisfies the conclusion
of Theorem 1.7, or there exists a set S ′ ⊃ S that is not much larger than S, and such that
φ (F, S ′ ) is significantly larger than φ (F, S). In the latter case, we replace S by S ′ and
repeat; since φ is bounded from above by 0, the former case must occur after a bounded
number of steps.
29

We now proceed to define our potential function φ.
Definition (The (n, k, J)-biased distribution). For each J ⊂ [n], we define the (n, k, J)-biased
distribution on P (J) by
µ(n,k,J) (B) =

Pr

A∼([n]
k )

[A ∩ J = B]

∀B ⊂ J,


[n]
where A ∼ [n]
k denotes a uniform random element of k . We write B ∼ µ(n,k,J) if B is chosen
according this distribution.


B
B for each B ⊂ J. We define our potential
For F ⊂ [n]
k  andJ ⊂ [n], we define αJ := µ FJ

× P([n]) by
function φ : P [n]
k
φ (F, J) =

E

B∼µ(n,k,J )

αB
J

log αB
J

∀F ⊂




[n]
, J ⊂ [n].
k


Since −1/e ≤ f (x) ≤ 0 for all x ∈ [0, 1], we have −1/e ≤ φ(F, J) ≤ 0 for all F ⊂ [n]
k
and all J ⊂ [n]; we have φ (F, J) = 0 if and only if F is a J-junta. Moreover, it follows from
Jensen’s inequality that φ (F, S) ≤ φ (F, S ′ ) for any S ⊂ S ′ . We note the similarity between
the definition of φ and the definition of the entropy of a random variable. We note also that
the product space analogue of the function φ (in the slightly simpler setting where µ(n,k,J) is
replaced by a product distribution on P(J)) was considered by Friedgut and Regev in [24], and
used in a similar way to in the sequel.

Definition. We say that a family F ⊂ [n]
k is (η, h)-potentially stable if φ (F, J) < φ (F, ∅) + η
for all sets J ⊂ [n] with |J| ≤ h.
We recall from the Introduction the definition of slice-quasirandomness.

Definition. If η > 0 and h ∈ N, we say that a family F ⊂ [n]
k is (δ, h)-slice-quasirandom if
for any J ⊂ [n] with |J| ≤ h, and any B ⊂ J, we have |µ(FJB ) − µ(F)| < δ.
By virtue of Corollary 4.2, there is a close connection between potential stability and slicequasirandomness. Indeed, the following lemma says that if k/n is bounded away from 0 and
1, then (η, h)-potential stability implies (δ, h)-slice-quasirandomness, provided η is sufficiently
small.
Lemma 4.3. For any ζ, δ > 0, h ∈ N there exist η = η (δ, h, ζ) > 0 and n0 = n0 (ζ, h) ∈ N

such that the following holds. Let n ≥ n0 , let ζn ≤ k ≤ (1 − ζ) n, and let F ⊂ [n]
be
k
(η, h)-potentially stable. Then F is (δ, h)-slice-quasirandom.
Proof. Let F be as in the statement of the lemma, and let η = η(δ, h, ζ) > 0 to be chosen later.
Let J ⊂ [n] with |J| ≤ h. Let Ω = P(J), and equip Ω with the probability distribution µ(n,k,J).
Since ζn ≤ k ≤ (1 − ζ)n, we have
 

n−h
ζn − h + 1 h
⌈ζn⌉−h

≥ (ζ/2)h ∀ω ∈ Ω,
≥
Pr(ω) ≥
n
n
−
h
+
1
⌈ζn⌉

provided n ≥ 2h/ζ.
Let X be the non-negative random variable defined by X(B) = αB
J . Then we have E[X] =
µ(F), f (E[X]) = µ(F) log µ(F) = φ(F, ∅) and E[f (X)] = φ(F, J). The fact that F is (η, h)potentially stable implies that E[f (X)] < f (E[X]) + η. Corollary 4.2 (with λ = (ζ/2)h and
30

C = 1) implies that kX − E[X]k∞ < δ, provided η is sufficiently small depending on δ, h
and ζ. This in turn implies that |µ(FJB ) − µ(F)| < δ for any B ⊂ J. It follows that F is
(δ, h)-slice-quasirandom, as required.
Armed with this lemma, we can now prove Theorem 1.7.
Proof of Theorem 1.7. Let η = η(δ, h, ζ/2) be as in the statement of Lemma 4.3, and let n0 ∈ N
to be chosen later, depending on δ, h, ζ and ǫ. Given a set S ⊂ [n], we define a partition of
P(S) into three parts:

• We let GS ⊂ P (S) be the family of all sets B ⊂ S, such that µ FSB > 2ǫ , and such that
the family FSB is (η, h)-potentially stable. We call these the ‘good’ sets.

• We let BS ⊂ P(S) be the family of all sets B ⊂ S, such that µ FSB > 2ǫ , and such that
the family FSB is not (η, h)-potentially stable. We call these the ‘bad’ sets.

• We let ES ⊂ P(S) be the family of all sets B ⊂ S, such that µ FSB ≤ 2ǫ . We call these
the ‘exceptional’ sets.
By Lemma 4.3 (applied with ζ/2 in place of ζ), for each B ∈ GS , the family FSB is (δ, h)slice-quasirandom, provided η is sufficiently small depending on ζ, δ and h, and provided n is
sufficiently large depending on ζ, h and |S|. It suffices to show that there exists a set S of size
bounded from above in terms of ζ, δ, h and ǫ, such that µ (F\ hGS i) < ǫ. The next claim says
that if this does not hold, then S can be replaced by a set S ′ ⊃ S of size at most h · 2|S| , such
that φ (F, S ′ ) is significantly larger than φ (F, S).
Claim 4.4. For each S ⊂ [n], we either have µ (F\ hGS i) < ǫ, or else there exists a set S ′ ⊃ S
with |S ′ | ≤ h2|S| + |S|, such that

φ F, S ′ ≥ φ (F, S) + ηǫ/2.

Proof. Suppose that µ (F\ hGS i) ≥ ǫ. We have

ǫ ≤ µ (F\ hGS i)
X

µ(n,k,S) (B) µ FSB
=
B⊂S:
B ∈G
/ S

=

X

B∈BS

X


µ(n,k,S) (B) µ FSB +
µ(n,k,S) (B) µ FSB
B∈ES

≤ µ(n,k,S) (BS ) + ǫ/2,
and therefore

µ(n,k,S) (BS ) ≥ ǫ/2.
For each B ∈ BS , let SB ⊂ [n] \ S such that |SB | ≤ h and


φ FSB , SB ≥ φ FSB , ∅ + η.

Writing



S′ = 

[

B∈BS

31



SB  ∪˙ S,

we have

φ F, S ′ − φ(F, S) =

E

B∼µ(n,k,S)

E

≥

B∼µ(n,k,S)

≥

B∼µ(n,k,S)

E




φ FSB , S ′ \S − φ FSB , ∅




1B∈BS φ FSB , SB − φ FSB , ∅

[1B∈BS · η]

= η · µ(n,k,S)(BS )
≥ ηǫ/2.

This proves the claim.
Let J0 = ∅. By Claim 4.4, we either have µ (F\ hGJ0 i) < ǫ, or else there exists J1 ⊂ [n]
such that |J1 | ≤ h · 20 + 0 and
φ (F, J1 ) ≥ φ (F, J0 ) + ηǫ/2.
We now repeat the process with the set J1 , and so on, producing, for each m ∈ N with
m ≤ 2/(eηǫ), a set Jm ⊂ [n], such that either



µ F\ GJm−1 < ǫ,

or else


φ (F, Jm ) ≥ φ F, GJm−1 + ηǫ/2,

Since

there exists m ≤

1
φ (F, ∅) ≥ − ,
e

2
eηǫ

such that



µ F\ GJm−1 < ǫ.

The size of Jm−1 is bounded above by a constant depending only upon η, h and ǫ. By definition, FJBm−1 is (η, h)-potentially-stable, for each B ∈ GJm−1 . Provided n0 is sufficiently large
(depending on ζ, η, h and ǫ), we may apply Lemma 4.3 with ζ/2 in place of ζ, n − |Jm−1 | in
place of n and k − |B| in place of k, implying that FJBm−1 is (δ, h)-slice-quasirandom for each
B ∈ GJm−1 . Hence, we may take J = Jm−1 , completing the proof.
Remark 4.1. We note that there is no general ‘counting lemma’ for (η, h)-slice-quasirandom
families, for hypergraphs with a bounded number of edges — unsurprisingly perhaps, given
the relative weakness of the constraint. To see this, let n be even, let k = n/2, and consider
a random family F produced by including exactly one of S and [n] \ S (with probability 1/2
[n] 
. Clearly, µ(F) = 21 , and F
each), independently at random for each pair {S, [n] \ S} ⊂ n/2
contains no copy of the hypergraph consisting of two disjoint edges. Moreover, for any J ⊂ [n]
n−|J| 
, 1/2), and therefore by a Chernoff bound,
and any B ⊂ J, |FJB | ∼ Bin( k−|B|
Pr[|µ(FJB )





2 2 n − |J|
− 1/2| ≥ η] < 2 exp − η
.
3
k − |B|

32

Hence, using a union bound, the probability that there exists J ⊂ [n] with |J| ≤ h and B ⊂ J
such that |µ(FJB ) − 1/2| ≥ η is at most
X X

J ⊂[n]:
|J |≤h

B⊂J





2 2 n − |J|
2 exp − η
≤ 2 · 2h ·
3
k − |B|

!
h  
X
n
i=1

i



2 n−h
= o(1),
exp −
3 n/2 − h


as n → ∞ for any fixed η and h. Therefore, F is (η, h)-slice-quasirandom with high probability.
To obtain results on families with a forbidden intersection-size, we will need the following
property of pairs of slice-quasirandom families.
Lemma 4.5. For any ǫ, ζ ∈ (0, 1) and any t ∈ N, there exist η = η(ǫ) > 0, h0 = h0(ǫ, ζ, t) ∈ N
and n0 = n0 (ǫ, ζ, t) ∈ N such that the following holds. Let t − 1 ≤ k1 , k2 ≤ 12 − ζ n, and let

[n]
A ⊂ [n]
k1 , B ⊂ k2 be (ǫ/5, h0 )-slice-quasirandom families, with µ(A) ≥ ǫ and µ(B) ≥ ǫ. Then
there exist A ∈ A and B ∈ B such that |A ∩ B| = t − 1. (We may take η = ǫ/5.)
This lemma says that if A and B are sufficiently slice-quasirandom, and have uniformity
bounded away from n/2, then we can find a pair of sets A ∈ A, B ∈ B with any bounded
intersection-size. The idea of the proof is to use the slice-quasirandomness property to reduce
to the case of t = 1, where we can apply a result about cross-intersecting families (Lemma
2.25). Note that Lemma 2.25 immediately implies the t = 1 case of Lemma 4.5.

[n]
Proof of Lemma 4.5. Let n ≥ n0 and let A ⊂ [n]
and
B
⊂
k1
k2 be (η, h0 )-slice-quasirandom
families, such that µ (A) ≥ ǫ and µ (B) ≥ ǫ, where η = ǫ/5, and h0 , n0 are to be chosen later.
[t−1]
[t−1]
It is easy to check that the families A′ := A[t−1] , B ′ := B[t−1] are (2η, h0 − t + 1)-slicequasirandom families with


µ A′ , µ B ′ ≥ ǫ − η.
By Lemma 2.25, if A′ and B ′ were cross-intersecting, then there would exist S ⊂ [n] with
|S| ≤ s(ζ, ǫ − η) and µ((A′ )∅
S ) < (ǫ − η)/2, provided n0 is sufficiently large depending on ǫ and
ζ. But then
µ(A′ ) − µ((A′ )∅
S ) > ǫ − η − (ǫ − η)/2 ≥ 2η,

contradicting the fact that A′ is (2η, h0 −t+1)-slice-quasirandom, provided h0 −t+1 ≥ s(ǫ−η, ζ).
Hence, there exist C ∈ A′ and D ∈ B ′ such that C ∩ D = ∅. We have C ∪ [t − 1] ∈ A,
D ∪ [t − 1] ∈ B and |(C ∪ [t − 1]) ∩ (D ∪ [t − 1])| = t − 1, as required.

5
5.1

Proof of our forbidden intersection theorem
Approximations by juntas


We can now prove that if k/n is bounded away from 0 and 1/2, and F ⊂ [n]
k is a family such
that no pair of sets in F have intersection of size t − 1, then F is approximately contained
within a t-intersecting junta.
Theorem 5.1. For any ǫ, ζ > 0 and t ∈ N there exists j = j(t, ζ, ǫ) ∈ N and n1 = n1 (t, ζ, ǫ) ∈ N


such that the following holds. Let n ≥ n1 , let ζn ≤ k ≤ 21 − ζ n, and let F ⊂ [n]
k such that
no two sets in F haveintersection of size t − 1. Then there exists a t-intersecting j-junta J
such that |F\J | < ǫ nk .
33

The proof uses our ‘weak regularity lemma’ (Theorem 1.7) to find a J-junta J in which the
family F is approximately contained, and such that for each B ⊂ J with B ∈ J , the slice FJB
is highly slice-quasirandom and not too small; we then use Lemma 4.5 to show that the junta
J must be t-intersecting.
Proof of Theorem 5.1. Let t ∈ N, let ǫ, ζ > 0, let η = ǫ/10 and let h, n1 ∈ N to be chosen later

(depending on t, ζ and ǫ). Let n ≥ n1 , let ζn ≤ k ≤ ( 12 − ζ)n, and let F ⊂ [n]
k be a family
containing no pair of sets whose intersection has size t − 1.
By Theorem 1.7, there exists j = j(ζ, η, h, ǫ) ∈ N, a set J ⊂ [n] with |J| ≤ j, and a J-junta
J = hGi (i.e., G ⊂ P(J)), such that µ (F\J ) < ǫ, and such that for each B ∈ G, the family FJB
is an (η, h)-slice-quasirandom family with µ(FJB ) ≥ ǫ/2. It suffices to show that the junta J is
t-intersecting.
Suppose for a contradiction that there exist A1 , A2 ∈ J such that |A1 ∩ A2 | < t. Then there
exist B1 , B2 ∈ G and C1 , C2 ⊂ [n] \J, such that
FJB1

A1 = B1 ∪ C1 , A2 = B2 ∪ C2 .

Note that the families
and FJB2 are each (η, h)-slice quasirandom with measure at least ǫ/2.
Write |B1 ∩ B2 | =: t′ ≤ t − 1. Provided h ≥ maxt′′ ∈[t−1]∪{0} h0 (ǫ/2, ζ/2, t′′ ) and n1 is sufficiently
large depending on t, ζ and ǫ, Lemma 4.5 (applied with A = FJB1 , with B = FJB2 , with ǫ/2 in
place of ǫ and with ζ/2 in place of ζ) implies that there exist D1 ∈ FJB1 and D2 ∈ FJB2 such
that
|D1 ∩ D2 | = t − 1 − t′ .

This is a contradiction, since B1 ∪ D1 ∈ F, B2 ∪ D2 ∈ F and |(B1 ∪ D1 ) ∩ (B2 ∪ D2 )| = t − 1.

5.2

A stability result for the forbidden intersection problem

We now apply Theorems 1.6 and 5.1 to obtain the following stability version of Theorem
1.5.
[n] 
For brevity, we say that a family F ⊂ [n]
is
a
Frankl
family
if
there
exists
a
set
S
∈
such
t+2r
k

that F = {A ∈ [n]
:
|A
∩
S|
≥
t
+
r}.
If
t
∈
N
and
ζ
>
0
are
fixed
and
ζn
≤
k
≤
(1/2
− ζ)n,
k
we say such a Frankl family is a Frankl junta if r is bounded from above in terms of t and ζ.
Theorem 5.2. For any ǫ, ζ > 0 and any t ∈ N, there exists δ > 0and n0 ∈ N such that the
following holds. Let n ≥ n0 , let ζn ≤ k ≤ ( 21 − ζ)n, and let A ⊂ [n]
that does not
k be a family

contain two sets whose intersection is of size t − 1. If |A| ≥ f (n, k, t) − δ nk , then there exists

a Frankl family F ⊂ [n]
such that µ (A\F) < ǫ. Moreover, F can be taken to be a j-junta,
k
where j = j(t, ζ) ∈ N.

Proof. Let δ = δ(t, ζ, ǫ) > 0 and n0 = n0 (t, ζ, ǫ) ∈ N to be chosen later. Let n ≥ n0 , let

ζn ≤ k ≤ (1/2 − ζ)n, let A ⊂ [n]
be a family that does not contain a pair of sets with
k
intersection of size t − 1, and suppose that |A| ≥ f (n, k, t) − δ nk . By Theorem 5.1, provided
n0 is sufficiently large depending
 ǫ 	 on t, ζ, ǫ and δ, there exists a t-intersecting family J ⊂ P ([n])
such that µ (A\J ) < min δ, 2 . In particular, we have
 
 
n
n
|J | ≥ |A| − δ
≥ f (n, k, t) − 2δ
.
k
k

Provided δ is sufficiently small depending on t, ζ and ǫ, Theorem 1.6 implies that there exists
a Frankl family F, which is an Oζ,t (1)-junta, such that µ (J \F) < 2ǫ . We have
completing the proof.

µ (A\F) ≤ µ (A\J ) + µ (J \F) < ǫ,

34

5.3

The Frankl families are locally extremal


In the previous subsection, we showed that if A ⊂ [n]
k is a family that does not contain two sets
whose intersection is of size t − 1, and if |A| is close to f (n, k, t), then A has small symmetric
difference with a Frankl junta. In this subsection, we show that such a family A is no larger
than a Frankl junta. This will complete the proof of Theorem 1.5. The following lemma will
be a key tool.
Lemma 5.3. For any ζ > 0 and any j, t ∈ N, there exist ǫ0 = ǫ0 (t, ζ, j) > 0 and
 n0 =
n0 (t, ζ, j) ∈ N such that the following holds. Let n ≥ n0 , and let ζn ≤ k ≤ 12 − ζ n. Let

F ⊂ [n]
k be a family not containing a pair of sets whose intersection is of size t− 1. Let
B >1−ǫ
J ∈ [n]
0
j , and let G ⊂ P (J) be a maximal t-intersecting family. Suppose that µ FJ
for any B ∈ G. Then µ (F) ≤ µ (hGi), with equality only if F = hGi.


	
Proof. Let δ = maxB ∈G
µ FJB , and let ǫ = maxA∈G 1 − µ FJA . We observe the following.
/

Claim 5.4. There exists c = c (t, ζ, j) > 1 such that δ = Ot,ζ,j (ǫc ).

Proof. Let B ∈
/ G such that µ FJB = δ. Since G ⊂ P (J) is maximal t-intersecting, there exists
A ∈ G such that
 |A ∩ B| < t. By averaging, there exists C ⊂ [n] \J with |C| = t − 1 − |A ∩ B|
B∪C ≥ µ F B = δ. Note that F A∪C and F B∪C are cross-intersecting, otherwise F
and µ FJ∪C
J
J∪C
J∪C
would contain two sets whose intersection is of size t − 1. Note also that
n−j 



k−|A|
A∪C
1 − µ FJ∪C
≤ n−j−|C|  1 − µ FJA = Ot,ζ,j 1 − µ FJA = Ot,ζ,j (ǫ) .
k−|A|−|C|

A∪C and F B∪C .
The claim now follows by applying Lemma 2.18 to FJ∪C
J∪C
P
Since µ(F) = B⊂J µ(n,k,J)(B)µ(FJB ), and since µ(n,k,J)(B) = Ωζ,j (1) for all B ⊂ J (provided n is sufficiently large depending on ζ and j), we have

µ (F) ≤ µ (hGi) + δ − Ωt,ζ,j (ǫ) .
Therefore, by Claim 5.4, we have
µ (F) ≤ µ (hGi) + Ot,ζ,j (ǫc ) − Ωt,ζ,j (ǫ)
for some c > 1. Provided ǫ0 is sufficiently small (depending on t, ζ and j), this implies that
either µ (F) < µ (hGi) or F = hGi, proving the lemma.
We may now prove Theorem 1.5.
Proof of Theorem 1.5. Given ζ > 0 and t ∈ N, we choose j = j (t, ζ) ∈ N as in Theorem
5.2, we choose ǫ0 = ǫ0 (t, ζ, j) > 0 as in Lemma 5.3, and we let ǫ1 = ǫ1 (ǫ0 , ζ, j) > 0 and
n0 = n0 (t, ζ) ∈ N to be chosen later.

Let n ≥ n0 , let ζn ≤ k ≤ (1/2 − ζ)n, let A ⊂ [n]
k be a family that does not contain two
sets whose intersection is of size t − 1, and suppose that |A| ≥ f (n, k, t). We will show that A
is a Frankl family. By Theorem 5.2, provided n0 is sufficiently large depending on t, ζ and ǫ1 ,
there exists a Frankl family F such that F is a j-junta, and
µ (A\F) < ǫ1 .
35

Let J ∈

[n]
j

and let G ⊂ P(J) such that F = hGi. For any B ∈ G, we have
µ(n,k,J) (B) 1 − µ AB
J



≤ µ(F\A) ≤ µ (A\F) < ǫ1 .

Provided n is sufficiently large depending on ζ and j, we have µ(n,k,J)(B) = Ωζ,j (1) for all B ⊂ J.

Hence, provided ǫ1 is sufficiently small depending on ǫ0 , ζ and j, we have µ AB
J > 1 − ǫ0 for
all B ∈ G. Therefore, by Lemma 5.3, provided n0 is sufficiently large depending on t, ζ and j,
we have µ(A) ≤ µ(F), with equality only if A = F, proving the theorem.

6

Conclusion and open problems

For fixed t ∈ N, the results in this paper, combined with the previous results mentioned in the
Introduction, resolve the Erdős-Sós problem (i.e., Problem 1.3) for 2t ≤ k ≤ (1/2−o(1))n. However, the problem remains unsolved for k/n very close to 1/2. We believe that new techniques
will be required to tackle the case where k/n ≈ 1/2.
It would also be interesting to determine the optimal dependence of j = j(ζ, δ, h, ǫ) on ζ, δ, h
and ǫ, in Theorem 1.7. As stated above, our proof gives j ≤ 2 ↑↑ 1/(ζ O(h) δ2 ǫ).
Acknowledgements
We are grateful to Gil Kalai for several helpful discussions, and to Yuval Filmus for suggesting
a more elegant way of presenting the proof of Theorem 1.10, one which we have adopted.

References
[1] R. Ahlswede and L. H. Khachatrian, The complete nontrivial-intersection theorem for
systems of finite sets, J. Combin. Theory, Ser. A 76 (1996), pp. 121–138.
[2] R. Ahlswede and L. H. Khachatrian, The complete intersection theorem for systems of
finite sets, European J. Combin. 18 (1997), pp. 125–136.
[3] R. P. Anstee and P. Keevash, Pairwise intersections and forbidden configurations, European
J. Combin. 27 (2006), pp. 1235–1248.
[4] J. Balogh, B. Bollobas, and B. Narayanan, Transference for the Erdős-Ko-Rado theorem,
Forum of Mathematics, Sigma 3 (2015), e23.
[5] J. Balogh and D. Mubayi, A new short proof of a theorem of Ahlswede and Khachatrian,
J. Combin. Theory, Ser. A 115 (2008), pp. 326–330.
[6] B. Bollobas, B. Narayanan, and A. Raigorodskii, On the stability of the Erdős-Ko-Rado
theorem, J. Combin. Theory, Ser. A 137 (2016), pp. 64–78.
[7] D. Conlon and J. Fox, Bounds for graph regularity and removal lemmas, Geom. Funct.
Anal. 22 (2012), pp. 1191–1256.
[8] P. Devlin and J. Kahn, On ‘stability’ in the Erdős-Ko-Rado theorem, SIAM J. Disc. Math.
30(2) (2016), pp. 1283-1289.
[9] M. Deza and P. Frankl, Erdős-Ko-Rado theorem – 22 years later, SIAM J. Alg. Disc. Meth.
4 (1983), pp. 419–431.
36

[10] I. Dinur and E. Friedgut, Intersecting families are essentially contained in juntas, Combin.
Probab. Comput. 18 (2009), pp. 107–122.
[11] I. Dinur and S. Safra, On the hardness of approximating minimum vertex-cover, Ann.
Math. 162 (2005), pp. 439–485.
[12] D. Ellis, N. Keller, and N. Lifshitz, Stability versions of Erdős-Ko-Rado type theorems,
via isoperimetry, preprint, 2016. arXiv:1604.02160.
[13] P. Erdős, Problems and results in graph theory and combinatorial analysis, Proc. 5th
British Combinatorial Conference (1975), pp. 169–192.
[14] P. Erdős, C. Ko, and R. Rado, Intersection theorems for systems of finite sets, Quart. J.
Math. Oxford, Second Series, 12, pp.313–320, 1961.
[15] Y. Filmus, The weighted complete intersection theorem, J. Combin. Th. Ser. A 151 (2017),
pp. 84-101.
[16] J. Fox, A new proof of the graph removal lemma, Ann. Math. 174 (2011), pp. 561–579.
[17] P. Frankl, Erdős-Ko-Rado theorem with conditions on the maximal degree, J. Combin.
Theory, Ser. A 46 (1987), pp. 252–263.
[18] P. Frankl, The Erdős-Ko-Rado Theorem is true for n = ckt, Coll. Soc. Math. J. Bolyai 11
(1978), pp. 365–375.
[19] P. Frankl, The shifting technique in extremal set theory, in: Surveys in Combinatorics,
Lond. Math. Soc. Lect. Note Ser. 123 (1987), pp. 81–110.
[20] P. Frankl and Z. Füredi, Forbidding just one intersection, J. Combin. Theory, Ser. A 39
(1985), pp. 160–176.
[21] P. Frankl and N. Tokushige, An invitation to intersection problems for finite sets, J. Combin. Theory, Ser. A 144 (2016), pp. 157–211.
[22] E. Friedgut, Boolean functions with low average sensitivity depend on few coordinates,
Combinatorica 18 (1998), no. 1, pp. 27–35.
[23] E. Friedgut, On the measure of intersecting families, uniqueness and stability, Combinatorica 28 (2008), pp. 503–528.
[24] E. Friedgut and O. Regev, Kneser graphs are like Swiss cheese, Disc. Analysis 2018:2,
arXiv:1702.04073.
[25] A. Frieze and R. Kannan, Quick approximation to matrices and applications, Combinatorica 19 (1999), pp. 175–220.
[26] W. T. Gowers, Hypergraph regularity and the multidimensional Szemerédi theorem, Ann.
Math. 166 (2007), pp. 897–946.
[27] W. T. Gowers, Lower bounds of tower type for Szemerédis uniformity lemma, Geom. Funct.
Anal. 7 (1997), pp. 322–337.
[28] B. Green, A Szemerédi-type lemma in Abelian groups, with applications. Geom. Funct.
Anal. 15 (2005), pp. 340–376.
37

[29] G. R. G. Grimmett, Percolation (1st edition), Springer-Verlag, 1989.
[30] A. J. W. Hilton and E. C. Milner, Some intersection theorems for systems of finite sets,
Quart. J. Math. Oxford 18 (1967), pp. 369–384.
[31] C. Jones, A noisy-influence regularity lemma for Boolean functions, preprint, October
2016. arXiv:1610.06950.
[32] J. Kahn, G. Kalai, and N. Linial, The Influence of Variables on Boolean Functions, Proc.
29th Annual Symposium on the Foundations of Computer Science, pp. 68–80, Computer
Society Press, 1988.
[33] J. Kahn and G. Kalai, Thresholds and expectation thresholds, Combin. Probab. Comput.
16 (2007), pp. 495–502.
[34] G. Kalai and M. Safra, Threshold phenomena and influence, in: Computational Complexity
and Statistical Physics, (A.G. Percus, G. Istrate and C. Moore, eds.), Oxford University
Press, New York, 2006, pp. 25–60.
[35] G. O. H. Katona, A theorem of finite sets, in: Proceedings of Tihany Conference, 1966,
pp. 187–207.
[36] P. Keevash, Shadows and intersections: Stability and new proofs, Adv. Math. 218 (2008),
pp. 1685–1703.
[37] P. Keevash and D. Mubayi, Set systems without a simplex or a cluster, Combinatorica, 30
(2010), pp. 175–200.
[38] P. Keevash, D. Mubayi and R. Wilson, Set systems with no singleton intersection, SIAM
J. Discrete Math. 20 (2006), pp. 1031–1041.
[39] N. Keller and N. Lifshitz, The Junta Method for Hypergraphs, and Chvátal’s Simplex
Conjecture, preprint, July 2017. arXiv:1707.02643
[40] D. J. Kleitman, On a conjecture of Milner on K-graphs with non-disjoint edges, J. Combin.
Theory 5 (1968), pp. 153–156.
[41] J. B. Kruskal, The number of simplices in a complex, in Mathematical Optimization Techniques, Univ. California Press, Berkeley, 1963, pp. 251–278.
[42] G. A. Margulis, Probabilistic characteristics of graphs with large connectivity, Problems
Info. Transmission 10 (1977), pp. 174–179.
[43] E. Mossel, Gaussian bounds for noise correlation of resilient functions, preprint, April 2017.
arXiv:1704.04745.
[44] D. Mubayi and J. Verstraëte, A survey on Turán problems for expansions, Recent Trends
in Combinatorics (IMA volume 159), pp. 117–143, 2016.
[45] B. Nagle, V. Rödl and M. Schacht, The counting lemma for regular k-uniform hypergraphs,
Random Structures and Algorithms 28 (2006), pp. 113–179.
[46] R. O’Donnell, Analysis of Boolean functions, Cambridge University Press, 2014.

38

[47] V. Rödl and J. Skokan, Regularity lemma for k-uniform hypergraphs, Random Structures
and Algorithms 25 (2004), pp. 1–42.
[48] E. Szemerédi, Regular partitions of graphs, Problèmes combinatoires et théorie des graphes,
Colloq. Internat. CNRS, Univ. Orsay, Orsay, 1976.
[49] L. Russo, An approximate zero-one law, Z. Wahrsch. Verw. Gebiete 61 (1982), pp. 129–
139.
[50] R.M. Wilson, The exact bound in the Erdős-Ko-Rado theorem, Combinatorica 4 (1984),
pp. 247–257.

39

