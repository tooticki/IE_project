A RAINBOW BLOW-UP LEMMA

arXiv:1802.07700v2 [math.CO] 8 Jun 2018

STEFAN GLOCK AND FELIX JOOS
Abstract. We prove a rainbow version of the blow-up lemma of Komlós, Sárközy and Szemerédi
for µn-bounded edge colourings. This enables the systematic study of rainbow embeddings of bounded
degree spanning subgraphs. As one application, we show how our blow-up lemma can be used to transfer
the bandwidth theorem of Böttcher, Schacht and Taraz to the rainbow setting. It can also be employed
as a tool beyond the setting of µn-bounded edge colourings. Kim, Kühn, Kupavskii and Osthus exploit
this to prove several rainbow decomposition results. Our proof methods include the strategy of an
alternative proof of the blow-up lemma given by Rödl and Ruciński, the switching method, and the
partial resampling algorithm developed by Harris and Srinivasan.

1. Introduction
A subgraph H of an edge-coloured graph G is called rainbow if all its edges have different colours. Rainbow colourings appear for example in canonical Ramsey theory, and many open problems in combinatorics such as the Ryser–Brualdi–Stein conjecture on partial transversals in Latin squares and the graceful
labelling conjecture can be phrased as rainbow subgraph problems. The central question is under which
conditions on G and its edge colouring a rainbow copy of H is guaranteed. Here, H is usually a spanning
subgraph such as a perfect matching [10, 12, 22, 26, 41], Hamilton cycle [1, 2, 6, 7, 10, 14, 16, 17], spanning tree [5, 7, 15, 42], or a general bounded degree graph [8, 24, 44]. Closely related questions concern
properly coloured subgraphs and rainbow decompositions, which we shall discuss briefly in Section 1.3.
Clearly, a necessary condition for the existence of a rainbow copy of H in G is that H is at least
a subgraph of G. Thus, the best one can hope for is to find a rainbow copy of H in G ‘whenever’
H is a subgraph of G. The blow-up lemma of Komlós, Sárközy and Szemerédi is a powerful tool to
find spanning subgraphs, which, since its invention roughly 20 years ago, has significantly shaped the
landscape of extremal combinatorics [9, 31, 32, 33, 34, 35]. It is tailored to be used after an application
of Szemerédi’s regularity lemma and roughly says that super-regular pairs behave like complete bipartite
graphs in terms of embedding bounded degree subgraphs. In the present paper, we prove a rainbow blowup lemma. As one application, we transfer the bandwidth theorem of Böttcher, Schacht and Taraz [9]
to the rainbow setting. It would be interesting to find out whether other results can be transferred in a
similar way.
In many of the classical rainbow problems, the host graph G is complete. For instance, Erdős and Stein
asked for the maximal k such that any k-bounded edge colouring of Kn contains a rainbow Hamilton cycle
(cf. [14]). Here, an edge colouring is k-bounded if each colour appears on at most k edges. After several
subsequent improvements, Albert, Frieze, and Reed [1] showed that k = Ω(n), i.e. there exists a constant
µ > 0 such that for any µn-bounded edge colouring of Kn , there exists a rainbow Hamilton cycle. Note
that this is best possible up to the value of the constant µ. A natural generalization is to ask for general
rainbow (spanning) subgraphs. For example, Frieze and Krivelevich [15] showed that there exists some
µ > 0 such that any almost spanning tree with bounded degree is contained as a rainbow copy in Kn
for any µn-bounded edge colouring of Kn . This was greatly improved by Böttcher, Kohayakawa, and
Procacci [8], who showed the following very general result. Given any n/(51∆2 )-bounded edge colouring
of Kn and any graph H on n vertices with ∆(H) ≤ ∆, one can find a rainbow copy of H. Their proof is
based on the Lopsided Lovász local lemma as well as the framework of Lu and Székely [36] for random
injections. Using these tools, they show that a random injection V (H) → V (Kn ) yields with positive
probability a rainbow copy of H. Kamčev, Sudakov, and Volec [24] recently extended this result to
the setting where G is complete multipartite, and Sudakov and Volec [44] considered the case when the
number of cherries in H is restricted (instead of the maximum degree).
There is a major stumbling stone if one wants to consider the above problem for incomplete host
graphs, say, for example quasi-random graphs with density d for some arbitrarily small (fixed) d > 0.
Date: 11th June 2018.
The research leading to these results was partially supported by the European Research Council under the European
Union’s Seventh Framework Programme (FP/2007–2013) / ERC Grant Agreement no. 306349 (S. Glock) and the DFG,
grant no. JO 1457/1-1 (F. Joos).
1

2

S. GLOCK AND F. JOOS

If G is complete, then any injection V (H) → V (G) yields a valid embedding of H (similarly for the
multipartite setting). However, this is not the case for general host graphs G, where a random injection
yields a valid embedding with exponentially small probability. Restricting the probability space to the
‘valid’ injections does not seem to work with the Lu–Székely framework, as the latter relies on the perfect
symmetry of the setup.
Some recent results on rainbow subgraphs in incomplete host graphs with µn-bounded edge colourings
were obtained using the so-called ‘switching method’. For example, Coulson and Perarnau [12] found
rainbow perfect matchings in Dirac bipartite graphs, improving an approximate result of [10]. The
crucial property is that given a perfect matching M and an edge e ∈ M (which is in conflict with another
edge in M ), there are many ways of ‘switching e out of M ’ to obtain a new perfect matching which
does not contain e. As another example, Coulson, Keevash, Perarnau, and Yepremyan [11] show the
existence of a rainbow F -factor in a graph G whenever δ(G) ≥ (δF + o(1))n, where δF is the minimum
degree threshold for the existence of an F -factor (cf. [34]). (Here F is an arbitrary fixed hypergraph as
their results also apply to hypergraphs.) However, the switching method seems to be limited to ‘simply
structured’ spanning graphs H with rich symmetry properties.
We are motivated by the following question:
Given a (dense) graph G on n vertices with a µn-bounded edge colouring and a (bounded
degree) graph H on n vertices, is there a rainbow copy of H in G?
By proving a rainbow blow-up lemma, we provide a tool which allows for the systematic study of this
question, profiting from various techniques and methods which have been developed in the non-coloured
setting. In particular, we give affirmative answers to the above question if G is quasi-random (see
Corollary 1.3) or has sufficiently high minimum degree (see Section 6). We remark that the constant
µ > 0 we obtain is very small.
Nevertheless, our rainbow blow-up lemma has applications beyond this setting, in at least the following
two aspects. Firstly, it can still be applied even if the number of available colours is only slightly
larger than the number of edges in the desired subgraph. Secondly, one can even obtain approximate
decompositions, for example into Hamilton cycles and H-factors. This has recently been demonstrated
by Kim, Kühn, Kupavskii and Osthus (see Section 1.3 for further details).
We will discuss the blow-up lemma in more detail in the next subsection. As mentioned above,
commonly used techniques like the Lu–Székely framework and the switching method do not seem capable
of dealing with quasi-random host graphs G and/or general graphs H. (Here, the idea would have been to
use the original blow-up lemma as a ‘blackbox’ result.) Another natural question is whether the proof of
the blow-up lemma can be adapted to work in the rainbow setting. In the original proof due to Komlós,
Sárközy and Szemerédi, the vertices of H are embedded one by one using a randomized algorithm, until
all but a small fraction of the vertices are embedded, and the embedding is then completed using the
König-Hall theorem. Note that this approach is extremely vulnerable in the rainbow setting, as already
a constant number of choices can render the algorithm unsuccessful (as a vertex may be incident to only
a constant number of different colours), which seems rather hopeless.
To overcome these obstacles, several new ideas are needed. As an underlying strategy, we employ
the alternative proof of the blow-up lemma given by Rödl and Ruciński, and combine it with various
techniques such as the partial resampling algorithm, the switching method, and a parallelization of the
embedding procedure. We will provide a detailed proof overview in Section 2. Sections 4 and 5 contain
the main proof. In Section 6, we demonstrate the applicability of our rainbow blow-up lemma.
1.1. Rainbow blow-up lemma. In order to state a simplified version of our rainbow blow-up lemma,
we need some more terminology. For k ∈ N, we write [k]0 := [k] ∪ {0} = {0, 1, . . . , k}. We say that
(H, G, R, (Xi )i∈[r]0 , (Vi )i∈[r]0 ) is a blow-up instance if the following hold:
• H and G are graphs, (Xi )i∈[r]0 is a partition of V (H) into independent sets, (Vi )i∈[r]0 is a
partition of V (G), and |Xi | = |Vi | for all i ∈ [r]0 ;
• R is a graph on [r] such that for all distinct i, j ∈ [r], the graph H[Xi , Xj ] is empty if ij ∈
/ E(R).

Here, X0 and V0 are so-called ‘exceptional sets’. For simplicity, we assume in this subsection that they
are empty.
For a graph G and two disjoint subsets S, T ⊆ V (G), denote by eG (S, T ) the number of edges of G
with one endpoint in S and the other one in T , and define
dG (S, T ) :=

eG (S, T )
|S||T |

3

as the density of the pair S, T in G. We say that the bipartite graph G[V1 , V2 ] is lower (ε, d)-super-regular
if
• for all S ⊆ V1 and T ⊆ V2 with |S| ≥ ε|V1 |, |T | ≥ ε|V2 |, we have dG (S, T ) ≥ d − ε;
• for all i ∈ [2] and v ∈ Vi , we have |NG (v) ∩ V3−i | ≥ (d − ε)|V3−i |.

We say that the blow-up instance (H, G, R, (Xi )i∈[r]0 , (Vi )i∈[r]0 ) is lower (ε, d)-super-regular if for all
ij ∈ E(R), the bipartite graph G[Vi , Vj ] is lower (ε, d)-super-regular.
We now state a simplified version of the rainbow blow-up lemma. The full statement can be found in
Lemma 5.1 and also allows exceptional vertices and candidate sets. Moreover, it does not only apply to
rainbow embeddings, but to slightly more general conflict-free embeddings.
Lemma 1.1 (Rainbow blow-up lemma—simplified). For all d, ∆, r, there exist ε = ε(d, ∆), µ =
µ(d, ∆, r) > 0 and an n0 ∈ N such that the following holds for all n ≥ n0 .
Let (H, G, R, (Xi )i∈[r] , (Vi )i∈[r] ) be a lower (ε, d)-super-regular blow-up instance. Assume further that
(i) ∆(H), ∆(R) ≤ ∆,
(ii) |Vi | = (1 ± ε)n/r for all i ∈ [r].

Then, given any µn-bounded edge colouring of G, there exists a rainbow embedding of H into G (where
Xi is mapped to Vi for all i ∈ [r]).
Observe that ε does not depend on r, which is crucial in applications. Originally the blow-up lemma
was formulated with R being the clique on at most ∆ vertices. In essentially all applications it is applied
to many clique blow-ups iteratively. However, in order to have a useful rainbow blow-up lemma, we
cannot apply it independently to two or more clique blow-ups as in both parts the blow-up lemma may
use the same colour. We will discuss this issue further in Section 2.
1.2. A rainbow bandwidth theorem and quasirandom host graphs. One of the fundamental
results of extremal combinatorics is the Erdős–Stone theorem, stating that for a fixed graph H, every large
graph G on n vertices with average degree at least (1 − 1/(χ(H) − 1) + o(1))n contains H as a subgraph.
The bandwidth theorem can be viewed as an analogue of the Erdős–Stone theorem when H is a spanning
subgraph of G. Clearly, in this setting, one has to replace the average degree condition by a minimum
degree condition in order to obtain sensible results. Let ℓ := χ(H) and assume that H has bounded
degree. A long line of research confirmed for various cases that δ(G) ≥ (1 − 1/ℓ + o(1))n suffices to find H
as a spanning subgraph in G, for instance when H is a spanning tree, a (power of a) Hamilton cycle, or a
clique factor. A conjecture of Bollobás and Komlós, which became known as the bandwidth conjecture,
attempted to generalize all the mentioned results by claiming that δ(G) ≥ (1 − 1/ℓ + o(1))n suffices
whenever H has not too strong expansion properties (in this case measured by the parameter bandwidth).
The bandwidth of a graph H with vertex set [n] is defined as minπ max{|π(i) − π(j)| : ij ∈ E(H)} where
the minimum ranges over all permutations on [n].
Böttcher, Schacht and Taraz [9] proved the bandwidth conjecture roughly ten years ago. We refer
to their paper for more information on the history of the conjecture. Graph classes with appropriately
small bandwidth include for example powers of Hamilton cycles, F -factors and bounded degree trees
and planar graphs. We also remark that the minimum degree bound given by the bandwidth theorem
is not necessarily the optimal threshold (cf. Section 6.2). Here, we extend the bandwidth theorem to
the rainbow setting. We will prove the following theorem in Section 6.2 by replacing the usual blow-up
lemma with our rainbow blow-up lemma in the approach of [9].
Theorem 1.2. For all δ, ∆, ℓ, there are β, µ > 0 and an n0 ∈ N such that the following holds for all
n ≥ n0 . Suppose G is a graph on n vertices with δ(G) ≥ (1 − 1/ℓ + δ)n. Suppose H is a graph on
n vertices with ∆(H) ≤ ∆, bandwidth at most βn, and χ(H) ≤ ℓ. Then, given any µn-bounded edge
colouring of G, the graph G contains a rainbow copy of H.
A particular example which is covered by the bandwidth theorem is the case when H is a tree. This was
known as Bollobás’ conjecture and was proved by Komlós, Sárközy and Szemerédi [29]. In Section 6.1,
we present an easy proof of this result in the rainbow setting. Our main motivation is to give the reader
a straightforward example of how to apply our rainbow blow-up lemma. (The proof in [29] is without
the blow-up lemma and thus much longer.)
Another straightforward corollary of our rainbow blow-up lemma is the existence of rainbow bounded
degree graphs in quasi-random host graphs. Let us say a graph G on n vertices is (ε, d)-dense if for all
disjoint S, T ⊆ V (G) with |S|, |T | ≥ εn, we have eG (S, T ) ≥ d|S||T |.

4

S. GLOCK AND F. JOOS

Corollary 1.3. For all d, ∆, there are ε, µ > 0 and an n0 ∈ N such that the following holds for all
n ≥ n0 . Suppose G, H are graphs on n vertices, δ(G) ≥ dn, the graph G is (ε, d)-dense, and ∆(H) ≤ ∆.
Then, given any µn-bounded edge colouring of G, the graph G contains a rainbow copy of H.
This is the first result that considers spanning rainbow embeddings in graphs of arbitrarily small (but
fixed) density.
1.3. Further applications and related problems. An edge colouring is locally k-bounded if each
colour appears at most k times on the edges which are incident to a single vertex. (For instance, a
locally 1-bounded colouring is proper.) For many of the aforementioned results, there is a corresponding
result where the colouring is not k-bounded, but only locally k-bounded, and instead of aiming for a
rainbow copy of H, one aims for a properly coloured copy of H. Our proof of the rainbow blow-up
lemma transfers to this setting as well (with k = µn). In fact, it is then much easier, because there are
only local conflicts and no global conflicts, and a simple modification of the original proofs already yields
such a result.
Note that every locally O(1)-bounded edge colouring is (globally) O(n)-bounded. For example, every
proper edge colouring is n/2-bounded. Quite a few open problems are formulated in this setting. For
example, the Ryser–Brualdi–Stein conjecture asks for a rainbow matching of size n − 1 in every properly
n-edge-coloured Kn,n , and Andersen [4] conjectured that there is a rainbow path of length n − 2 in every
properly edge-coloured Kn . The currently best approximate result for the first problem is due to Hatami
and Shor [22]. An approximate result for the second problem was achieved in a breakthrough result by
Alon, Pokrovskiy and Sudakov [2] and slightly improved by Balogh and Molla [6]. One may also ask for
any other rainbow subgraph with at most n edges, for instance a particular (almost) spanning tree or an
(almost) spanning collection of cycles. (Observe that a proper edge-colouring may only use n colours.
Hence it only makes sense to ask for rainbow subgraphs with at most n edges.)
Recently, Montgomery, Pokrovskiy and Sudakov [39] showed that Kn equipped with a locally kbounded edge colouring contains any tree with at most (1 − o(1))n/k vertices as a rainbow subgraph.
This also implies an approximate version of Ringel’s conjecture on decompositions of Kn into a given
tree.
Instead of finding a single rainbow subgraph, it is also natural to ask for decompositions into rainbow
subgraphs. For instance, there are three conjectures due to Brualdi–Hollingsworth, Kaneko–Kano–
Suzuki, and Constantine regarding the decomposition of properly edge-coloured complete graphs into
rainbow (isomorphic) spanning trees. Montgomery, Pokrovskiy and Sudakov [38] obtain strong results
which prove these conjectures approximately (for not necessarily isomorphic trees). Independently, Kim,
Kühn, Kupavskii and Osthus [27] use our blow-up lemma to prove several related results. In their setting,
the given colouring does not need to be proper, but can be locally n/ log5 n-bounded, say. On the other
hand, the global condition is slightly more restrictive than in a proper colouring. As one example, they
show the following.
Theorem 1.4 (Kim, Kühn, Kupavskii and Osthus [27]). For any ε > 0, there exists n0 ∈ N such that for
all n ≥ n0 , any (1 − ε)n/2-bounded, locally n/ log5 n-bounded edge-colouring of Kn contains (1/2 − ε)n
edge-disjoint rainbow Hamilton cycles.
This also establishes approximate solutions to the above tree decomposition conjectures. Analogous
results hold for approximate decompositions into rainbow H-factors [27].
The following observation indicates why our rainbow blow-up lemma can be applied in this setting.
Suppose for simplicity that we consider a properly edge-coloured complete graph. If one chooses a random
subset U of vertices of size µn, then with high probability, the colouring restricted to this subset is µ|U |bounded, and the blow-up lemma can be applied to U to complete a partial embedding (constructed
outside U using different methods, e.g. via a hypergraph matching argument).
Rainbow decomposition results may in fact hold in a more general setting. Kim, Kühn, Osthus and
Tyomkyn [28] proved a blow-up lemma for approximate decompositions into arbitrary (bounded degree)
graphs. In combination with our result and methods there is hope for a rainbow blow-up lemma for
approximate decompositions.
2. Proof overview
Our starting point is the alternative proof of the blow-up lemma given by Rödl and Ruciński [43]. We
briefly sketch their approach, before considering the rainbow setting.
Suppose that (H, G, R, (Xi )i∈[r] , (Vi )i∈[r] ) is a blow-up instance. Assume that ∆(H) ≤ ∆ and that
G[Vi , Vj ] is super-regular for all 1 ≤ i < j ≤ r, i.e. R = Kr . We want to find an embedding φ of H into

5

G (where Xi is mapped onto Vi ). The strategy is to embed H in r rounds, where in round i, all vertices
of Xi are embedded simultaneously into Vi . Clearly, this corresponds to a perfect matching between Xi
and Vi . Yet not every perfect matching yields a valid embedding. They keep track of this by defining
a (dynamic) ‘candidacy graph’ Aj for each pair of clusters (Xj , Vj ). This candidacy graph depends on
the partial embedding up to round i. More precisely, for j > i, let Aji denote the candidacy graph for
(Xj , Vj ) after X1 , . . . , Xi have been embedded, where xv ∈ E(Aji ) if and only if v is still a candidate
to be the image of x. In the beginning, all candidacy graphs are complete bipartite graphs, but during
the embedding, they become gradually sparser. The main idea is to maintain super-regularity of the
candidacy graphs. More precisely, given an embedding of the clusters X1 , . . . , Xi , we assume that the
candidacy graphs Ai+1
, . . . , Ari are super-regular (which is true for i = 0), and now have to find a perfect
i
i+1
matching σ of Ai (which defines an embedding of Xi+1 into Vi+1 ) in such a way that the updated
r
candidacy graphs Ai+2
i+1 , . . . , Ai+1 are again super-regular. Fortunately, it turns out that if σ is chosen
randomly among all perfect matchings of Ai+1
, then this desired property holds with high probability.
i
The key tool to show this is the so-called Four graphs lemma from [43] (see Lemma 5.6). For this to
work, we actually need a stronger assumption on H, that is, we require that the clusters Xi are not only
independent in H, but 2-independent. However, using the Hajnal–Szemerédi theorem, it is not hard to
reduce the general case to this setting. This will also be the first step in our proof (see Section 5.1).
Now, assume that c : E(G) → C is a µn-bounded edge colouring of G. We might try to proceed as
above. Suppose that we have already found a rainbow embedding φi of H[X1 ∪· · ·∪Xi ] into G[V1 ∪· · ·∪Vi ]
and that the candidacy graphs Ai+1
, . . . , Ari are super-regular. Clearly, the definition of candidacy graphs
i
needs to be adapted to the rainbow setting. Consider x ∈ Xj and v ∈ Vj for j > i. Let Fxv denote the
set of edges φi (y)v where y ∈ NH (x) ∩ (X1 ∪ · · · ∪ Xi ). Previously, v was a candidate for x if and only if
Fxv ⊆ E(G), where Fxv is the set of edges in G which are used if x is embedded at v. Now, we need in
addition that the edges of Fxv have mutually distinct colours, and do not have a colour which is already
used by φi . Suppose that this is the case and Ai+1
is the candidacy graph for (Xi+1 , Vi+1 ). In the
i
uncoloured setting, any perfect matching σ of Ai+1
yields
a valid embedding of H[X1 ∪ · · · ∪ Xi+1 ] into
i
G[V1 ∪ · · · ∪ Vi+1 ] (and almost all of them leave the updated candidacy graphs super-regular). In contrast
to this, by far not every perfect matching σ of Ai+1
yields a rainbow embedding of H[X1 ∪ · · · ∪ Xi+1 ].
i
For this to be the case, we need that c(Fxσ(x) ) ∩ c(Fx′ σ(x′ ) ) = ∅ for all distinct x, x′ ∈ Xi+1 . This can be
modelled by defining a suitable conflict system on the edges of Ai+1
, where two edges xv, x′ v ′ conflict
i
if c(Fxv ) ∩ c(Fx′ v′ ) 6= ∅. Observe that a conflict-free perfect matching would yield a rainbow embedding
of H[X1 ∪ · · · ∪ Xi+1 ]. Crucially, since c is µn-bounded, every edge conflicts with at most ∆(H)µn
other edges. Using the switching method, we can show that a uniformly random perfect matching is
conflict-free with positive probability. This step uses a recent result of Coulson and Perarnau [12].
For the embedding procedure to work, we have to make sure that the updated candidacy graphs are
again super-regular. However, this might easily be wrong, as we might accidentally isolate a vertex. For
instance, vertex v ∈ Vi+2 might only see µ−2 colours, say, but all of those colours might already be used
in the embedding φi+1 . Then vertex v cannot be a candidate for any x ∈ Xi+2 and thus the embedding
is stuck.
To overcome this issue, we reserve an exclusive set of colours for each embedding round in the beginning. For instance, we might partition the colour set C into sets (Cij )1≤i<j≤r , and instead of embedding
H into G, we embed H into the graph G∗ which between clusters Vi , Vj only contains those edges of
G[Vi , Vj ] whose colour is contained in Cij . This decouples much of the colour dependency between the
embedding rounds and allows us to analyse the updated candidacy graphs as before using the Four graphs
lemma. Of course, this strategy only works if the pairs G∗ [Vi , Vj ] are super-regular. A natural approach
to show the existence of a suitable partition of C is to partition C randomly. Simplified, the problem we
face here is as follows: Consider the complete bipartite graph Kn,n with any µn-bounded edge colouring.
If we ‘activate’ each colour independently with probability 1/2, what is the probability that the activated
√
edges induce a ( µ, 1/2)-super-regular pair, say? This seems to be an interesting problem in its own
right, and we are not aware of any coverage in the literature. Heuristically one expects this to be a
rare event of exponentially small probability. However, the Lovász local lemma does not seem flexible
enough to solve this problem. We will use the partial resampling algorithm introduced by Harris and
Srinivasan [21] to deal with this problem (see Section 4).
One remaining issue arises from the applicability of the blow-up lemma. In the original version of the
blow-up lemma, the regularity parameter ε needs to be small as a function of the number of clusters r.
However, in a regularity partition obtained via an application of Szemerédi’s regularity lemma, the
number of clusters r is large as a function of ε. Usually, this is dealt with roughly as follows: one finds a

6

S. GLOCK AND F. JOOS

vertex partition of the reduced graph R into r/k cliques of order k, where k is ‘small’, and then applies
the blow-up lemma to each clique independently. This approach is not feasible in the rainbow setting,
as the union of rainbow subgraphs does not necessarily yield a rainbow subgraph. Also, splitting the
colour set in the beginning in order to reserve an exclusive set of colours for each application of the
blow-up lemma does not solve this problem, as the density of the regular pairs is divided by r/k through
the splitting and will thus be too small compared to ε. We thus prove a ‘global’ version of the blow-up
lemma which allows the number of clusters r to be large, but requires that ∆(R) ≤ ∆. Such a version
of the blow-up lemma was first proved by Csaba [13] following the proof in [30]. The proof of Rödl and
Ruciński [43] can also be adapted to work in this setting (see e.g. [28]). However, we have to be careful
with the colour splitting, for the very reason discussed above: if we reserved an exclusive colour set for
each pair Vi , Vj with ij ∈ E(R), the density of the regular pairs would be far too low. This can be
dealt with by ‘parallelizing’ the embedding (for different reasons, this has also been done in [28]). We
split V (R) into 2-independent sets J1 , . . . , JT , where we might take T = ∆(R)2 + 1. We then reserve
an exclusive colour set Ct1 t2 for each pair 1 ≤ t1 < t2 ≤ T . The sparsified graph G∗ contains between
clusters Vi , Vj only those edges whose colour is contained in Ct1 t2 , where i ∈ Jt1 and j ∈ Jt2 . We now
embed H in just T rounds, where in round t ∈ [T ], we embed all clusters Xi with i ∈ Jt simultaneously.
Consequently, the perfect matching σ is not drawn as a uniform perfect matching of one candidacy graph,
but is the union of |Jt | such perfect matchings. Fortunately, this still works nicely with the switching
method and the Four graphs lemma.
The resulting proof can be found in Section 5.4.
3. Notation
We only consider finite, undirected and simple graphs. For a graph G, we let V (G) and E(G) denote
the vertex set and edge set, respectively. Moreover, for a vertex v, let dG (v) denote the degree of v,
and let dG (v, A) denote the number of neighbours of v in A ⊆ V (G). If we deal with several graphs
simultaneously, we say G-neighbour to clarify which graph we refer to. As usual, δ(G) and ∆(G) denote
the minimum and maximum degree of G, respectively. For disjoint subsets A, B ⊆ V (G), let G[A, B]
denote the bipartite subgraph of G between A and B and G[A] the subgraph in G induced by A. We let
G2 denote the square of G, i.e. the graph obtained from G by adding edges between vertices which have
a common neighbour in G. A subset X ⊆ V (G) is 2-independent if it is independent in G2 .
Let G be a graph. Given a set C, a function c : E(G) → 2C is called an edge set colouring of G.
A colour α ∈ C appears on an edge e if α ∈ c(e). We say that c is k-bounded if each colour appears
on at most k edges. Moreover, we say that c is (k, ∆)-bounded if it is k-bounded and |c(e)| ≤ ∆ for
all e ∈ E(G). For C ′ ⊆ C, let GC ′ denote the subgraph of G with vertex set V (G) and edge set
{e ∈ E(G) : c(e) ⊆ C ′ }. We let dα
G (v) denote the number of edges incident to v on which α appears.
If G is clear from the context, we may simply write dC ′ (v) and dα (v) instead of dGC ′ (v) and dα
G (v),
respectively.
Given ε > 0 and d ∈ [0, 1], a bipartite graph G with vertex classes V1 , V2 is called (ε, d)-regular if for
all pairs S ⊆ V1 and T ⊆ V2 with |S| ≥ ε|V1 |, |T | ≥ ε|V2 |, we have |dG (S, T ) − d| ≤ ε. We simply say
that G is ε-regular if G is (ε, dG (V1 , V2 ))-regular. Moreover, an (ε, d)-regular graph G is called (ε, d)super-regular if for all v ∈ V1 , we have dG (v) = (d ± ε)|V2 | and for all v ∈ V2 we have dG (v) = (d ± ε)|V1 |.
Clearly, if G is (ε, d)-super-regular, it is also lower
(ε, d)-super-regular.

For a finite set S and i ∈ N, we write Si for the set of all subsets of S of size i and 2S for the
powerset of S. For a set {i, j}, we sometimes simply write ij. For a, b, c ∈ R, we write a = b ± c whenever
a ∈ [b − c, b + c]. For a, b, c ∈ (0, 1], we sometimes write a ≪ b ≪ c in our statements meaning that
there are increasing functions f, g : (0, 1] → (0, 1] such that whenever a ≤ f (b) and b ≤ g(c), then the
subsequent result holds.
4. Colour splitting
The goal of this section is to prove the following lemma, which will allow us to reserve exclusive colour
sets for our embedding rounds in the proof of the rainbow blow-up lemma. Our main tools are the partial
resampling algorithm introduced by Harris and Srinivasan [21] and McDiarmid’s inequality.
Lemma 4.1. Let 1/n ≪ µ ≪ 1/r, ε, 1/t, d, 1/∆. Suppose that G is a graph with vertex partition
V (G) = V1 ∪· · · · ∪· Vr and RS ⊆ R are graphs on [r] such that
(i) n ≤ |Vi | ≤ 2n for all i ∈ [r];
(ii) G[Vi , Vj ] is (lower) (ε, d)-regular for all ij ∈ E(R);
(iii) G[Vi , Vj ] is (lower) (ε, d)-super-regular for all ij ∈ E(RS ).

7

Let c : E(G) → 2C be a (µn, ∆)-bounded edge set colouring of G with |C| ≤ µ−1.3 n. Then there exists a
partition (Cℓ )ℓ∈[t] of C such that for all ℓ ∈ [t] and all ij ∈ E(R), there is a subgraph Gij
ℓ ⊆ GCℓ [Vi , Vj ]
ij
∆
∆
such that Gℓ is (lower) (2ε, d/t )-regular, and (lower) (2ε, d/t )-super-regular if ij ∈ E(RS ).
We remark that if c is uniform, i.e. c(e) = ∆ for all e ∈ E(G), for some ∆ ∈ N, then we can take
Gij
ℓ = GCℓ [Vi , Vj ]. In particular, this applies if c is a normal edge colouring. In the general case, we
introduce ‘dummy colours’ to make c uniform.
In the proof of Lemma 4.1, we will partition C randomly and then show that with positive probability,
all the obtained subpairs are (super-)regular. In order to motivate our approach, we briefly discuss the
following simplified variant of the problem (which will be the running example throughout this section):
Consider Kn,n with any µn-bounded edge colouring. If we ‘activate’ each colour independently with
probability 1/2, what is the probability that the activated edges induce a super-regular pair? (An edge
is activated if its colour is activated.) Using McDiarmid’s inequality, it is not hard to see that with high
probability, the activated subgraph is indeed (ε, 1/2)-regular. We first recall McDiarmid’s inequality and
then prove a more elaborated version of what we just indicated.
Theorem 4.2 (McDiarmid’s inequality, see [37]). Suppose X1 , . . . , Xm are independent Bernoulli random variables and suppose w1 , . . . , wm ∈ [0, W ]. Suppose X is a real-valued random variable determined
by X1 , . . . , Xm such that changing the outcome of Xi changes X by at most wi for all i ∈ [m]. Then, for
all t > 0, we have
2

P [|X − E [X] | ≥ t] ≤ 2e

− W P2t
m

i=1

wi

.

Proposition 4.3. Let 1/n ≪ µ ≪ ε, p, d, 1/∆. Suppose
 that G is a (lower) (ε, d)-regular graph between
C
V, V ′ with εn ≤ |V |, |V ′ | ≤ 2n and let c : E(G) → ∆
be a µn-bounded edge set colouring of G. Suppose
we choose a random subset C ′ of C by including every colour α ∈ C independently with probability p.
−0.9
n
Then with probability at least 1 − e−µ
, the graph GC ′ is (lower) (2ε, p∆ d)-regular.
Proof. We only consider the case when G is (ε, d)-regular. If G is lower (ε, d)-regular, the proof is
similar. Consider sets S ⊆ V , T ⊆ V ′ with |S| ≥ ε|V | and |T | ≥ ε|V ′ |. Let X(S, T ) = eGC ′ (S, T ) denote
the number of edges e between S and T such that c(e) ⊆ C ′ . Clearly, E [X(S, T )] = p∆ eG (S, T ) =
p∆ d|S||T | ± ε|S||T |. Moreover, X(S, T ) is a random variable where a single choice of whether α ∈ C ′
changes X(S, T ) by at most µn. Hence, by Theorem 4.2,
P [|X(S, T ) − E [X(S, T )] | > ε|S||T |] ≤ 2e−

2(ε|S||T |)2
µn∆e(G)

ε10

≤ 2e− 2µ∆ n .

Thus, a union bound shows that the activated subgraph is not (2ε, p∆ d)-regular with probability at most
ε10

−0.9

24n 2e− 2µ∆ n ≤ e−µ

n

.



However, in order to show that the activated subgraph is super-regular, we have to control the degree
of every vertex as well. Whilst for sets S, T as above, the activation or deactivation of one colour has only
a small effect, this is very different for the degree of a single vertex. To appreciate this issue, note that
there might only be µ−1 colours present at a particular vertex at all. Hence, if we suppose the ‘activated’
degrees of the vertices are mutually independent, then the probability that all ‘activated’ degrees are in
the desired range decays exponentially with n. We note that under the additional assumption that the
given colouring is locally o(n/ log n)-bounded, we could apply McDiarmid’s inequality for each vertex
and conclude with a union bound that our desired properties hold with probability close to 1. We remark
that in [2], the authors considered a problem of a similar kind. They prove that if the colours of a proper
edge colouring of Kn are activated with probability 1/2, say, then with high probability, the activated
subgraph has very good expansion properties.
Our efforts in the rest of this section focus on overcoming this local barrier. As a consequence, we
cannot hope that a random partition satisfies the desired properties with high probability. The approach
we pursue is motivated by the Lovász local lemma, but the Lovász local lemma itself does not seem
flexible enough for our purposes. We will discuss this in more detail in the next subsection.
In order to motivate the next result, which allows us to split the degree of each vertex evenly among
the colour sets, we note that (the simplified version of) this problem can be phrased as a ‘column-sparse
assignment-packing problem’. Let G be a graph on n vertices and c : E(G) → C a µn-bounded edge
colouring. Our aim is to find a subset C ′ of ‘activated’ colours such that for every vertex v ∈ V (G), we
have dC ′ (v) = dG (v)/2 ± 2µn, say. Define the matrix Â whose rows are indexed by V (G) and whose

8

S. GLOCK AND F. JOOS

columns are indexed by C, where Âv,i := di (v) is the number of edges at v coloured i. Let
X
di (v)
D := max
i∈C

v∈V (G)

denote the maximum column sum of Â. Let ĉ denote the vector indexed by V (G) with ĉv := dG (v)/2.
Define




Â
ĉ
A :=
and c :=
.
−ĉ
−Â

Let x be a vector indexed by C. Clearly, the linear system Ax = c has the solution x∗i = 1/2 for all
i ∈ C. The rounding theorem of Karp et al. [25] implies the existence of an integral vector x such
that |xi − x∗i | < 1 for all i ∈ C and such that (Âx)v = (Âx∗ )v ± D for all v ∈ V (G). Clearly, x
is a 0/1-vector. Let C ′ be the subset of C which represents the 1-coordinates of x. Then we have
dC ′ (v) = (Âx)v = ĉv ± D = dG (v)/2 ± D for all v ∈ V (G). Crucially, since c is µn-bounded, we have
that D ≤ 2µn, as desired.
This is good news for our problem. However, in order to prove Lemma 4.1, we need that a random
partition of C satisfies the desired degree properties with high enough probability so that after applying
Proposition 4.3, we can use a union bound to conclude that the sliced pairs are super-regular. We will
deal with this in the next two subsections. The following corollary is the result of these efforts. With this
tool at hand, we can deduce that the sliced pairs do not only inherit regularity, but also super-regularity,
all we need to prove Lemma 4.1.
p
Corollary 4.4. Suppose 1/n ≪ µ ≪ 1/t, d, 1/∆, 1/r and let κ := 4 t∆ d−1 µ. Let G be a graph on
C
n vertices and let c : E(G) → ∆
be µn-bounded. Suppose for every vertex v ∈ V (G), we are given a
v
v
partition S1 , . . . , Smv of NG (v) into at most r sets of size at least drn each. Suppose we split C randomly
into C1 , . . . , Ct , by independently assigning α ∈ C to Cℓ with probability 1/t. Then with probability at
least κ3 (1 + κ)−|C| , the following holds: dCℓ (v, Siv ) = t−∆ |Siv | ± (2t)∆ κrn for all v ∈ V (G), i ∈ [mv ], and
ℓ ∈ [t].
Proof of Lemma 4.1. We only consider the case when G[Vi , Vj ] is in fact (ε, d)-(super)-regular. If
G[Vi , Vj ] is only lower (ε, d)-(super)-regular, the proof is similar. If 2ε ≥ d, there is nothing to prove, so
let us assume that ε ≤ d/2.
In order to apply Proposition 4.3 and Corollary 4.4, we need the edge set colouring to be uniform.
We thus add a set of new ‘dummy’ colours C ′ with |C ′ | = ⌈µ−1 ∆n⌉. Let
C ∗ := C ∪· C ′

be the extended colour set and note that |C ∗ | ≤ 2µ−1.3 n. Let c′ : E(G) →
set colouring. Clearly, c′ exists since ∆e(G)
≤ |C ′ |.
µn

C∗
∗
Now, let c : E(G) → ∆ be such that

(4.1)

C′
∆



be any µn-bounded edge

c∗ (e) ⊆ c(e) ∪ c′ (e) and c(e) ⊆ c∗ (e) for all e ∈ E(G).

Clearly, c∗ is µn-bounded.
Split C ∗ randomly into C1∗ , . . . , Ct∗ , by independently assigning α ∈ C ∗ to Cℓ∗ with probability 1/t. By
−0.9
n
∗
, the graph Gij
Proposition 4.3, we conclude that with probability at least 1 − tr2 e−µ
ℓ := GCℓ [Vi , Vj ]
∆
is (2ε, d/t )-regular for all ℓ ∈ [t] and all ij ∈ E(R).
S
In order to apply Corollary 4.4, define G∗ := ij∈E(RS ) G[Vi , Vj ]. Consider i ∈ [r] and v ∈ Vi . For
j ∈ NRS (i), define Sjv := NG (v)∩Vj . Note that (Sjv )j∈NRS (i) partitions NG∗ (v), and that |Sjv | = (d±ε)|Vj |
since G[Vi , Vj ] is (ε, d)-super-regular. In particular, |Sjv | ≥ d|Vj |/2.
By Corollary 4.4 (with G∗ , d/4r2 playing the roles of G, d), we have with probability at least µ(1 +
√ −|C ∗ |
µ)
that
(4.2)

dG∗C ∗ (v, Vj ) = t−∆ (d ± ε)|Vj | ± µ1/3 n
ℓ

for all ij ∈ E(RS ), v ∈ Vi , and ℓ ∈ [t].
Since |C ∗ | ≤ 2µ−1.3 n, we have
∗
−0.9
−0.8
−0.9
√
n
n
µ(1 + µ)−|C | − tr2 e−µ n ≥ µe−2µ
− tr2 e−µ
> 0.

Therefore, there exists a partition (Cℓ∗ )ℓ∈[t] of C ∗ with the above properties. From (4.2), we can infer
∆
∗
that Gij
ℓ is (2ε, d/t )-super-regular for all ℓ ∈ [t] and all ij ∈ E(RS ). Finally, define Cℓ := C ∩ Cℓ for

9

all ℓ ∈ [t]. Clearly, (Cℓ )ℓ∈[t] is a partition of C, and we have Gij
ℓ ⊆ GCℓ [Vi , Vj ] by (4.1) for all ℓ ∈ [t] and
all ij ∈ E(R).

4.1. The partial resampling algorithm. The proof of Corollary 4.4 is based on the partial resampling
algorithm introduced by Harris and Srinivasan, which is a relative of the Moser-Tardos resampling
algorithm. These algorithms are set in the so-called ‘variable model’ of the Lovász local lemma. Let
X1 , . . . , XN be independent random variables, and suppose we want to avoid a set of bad events B. For
every A ∈ B, let vbl(A) be the set of variables which determine A. This naturally defines a dependency
graph Γ on B as follows: AB ∈ E(Γ) if vbl(A) ∩ vbl(B) 6= ∅. The (symmetric) Lovász local lemma implies
that if each bad event has probability at most p and 4p∆(Γ) ≤ 1, then there exists an assignment of
the variables X1 , . . . , XN which avoids all bad events. In their well-known paper, Moser and Tardos [40]
provided an algorithmic version thereof. Their so-called resampling algorithm is as simple as it could
be: Start with a random assignment of the variables X1 , . . . , XN . As long as some bad event A ∈ B is
still true, resample all the variables in vbl(A) (according to their respective distribution). Clearly, if the
algorithm terminates, then this yields an assignment of the variables which avoids all bad events. Moser
and Tardos showed that, under the assumptions of the Lovász local lemma, the algorithm terminates
with probability 1.
In our (simplified) setting, let Xi denote the Bernoulli random variable indicating
whether colour
P
i ∈ C is activated or not. For each vertex v ∈ V (G), let Av be the bad event that i∈C diG (v)1{Xi =1} 6=
√
dG (v)/2 ± µn, say. Note that Av depends on all colours which are present at v. This may lead to a
very dense dependency graph, possibly far too dense to apply the Lovász local lemma.
Nonetheless, a lot of these dependencies might be very weak. For example, given a vertex v and
colours i, j ∈ C, where di (v) is much larger than dj (v), the dependency of Av on Xi should intuitively be
much more significant than its dependency on Xj . A variant of the resampling algorithm of Moser and
Tardos tailored towards this problem could thus vaguely look as follows: Start with a random assignment
of the variables (Xi )i∈C . As long as some bad event Av is still true, choose randomly a subset C ′ of
colours, where a colour is more likely to be chosen if many edges at v are coloured with this colour. Now
only resample (Xi )i∈C ′ .
This ‘partial resampling algorithm’ falls into a very general framework, which was introduced by Harris
and Srinivasan [19, 20, 21]. They eliminated the need of a dependency graph by introducing ‘fractional
hitting sets’ instead, which capture ‘how dependent’ a bad event A is on a variable Xi (or more generally,
a set of variables).
We now introduce this framework, following their exposition in [21]. Let X1 , . . . , XN be independent
random variables, where each
P Xi has a finite set Li of possible assignments. For i ∈ [N ] and j ∈ Li , let
pi,j = P [Xi = j]. Hence, j∈Li pi,j = 1. Let (Ω, P) be the respective product probability space.
An ordered pair (i, j) with i ∈ [N ] and j ∈ Li is referred to as an element, and X denotes the set of all
elements. An atomic event is a set Y ⊆ X such that if (i, j), (i, j ′ ) ∈ Y , then j = j ′ . Let A denote the
family of all atomic events. A set B ⊆ A is called a complex event. An assignment is an atomic event A
such that |A| = N . We say that an assignment A avoids B ⊆ A if there is no B ∈ B with B ⊆ A.
These definitions naturally relate to the more standard notation for events. For an element ω =
(j1 , . . . , jN ) of the probability space Ω, define Aω := {(1, j1 ), . . . , (N, jN )}. Then Aω is an assignment.
For an event E ⊆ Ω, define BE := {Aω : ω ∈ E}. Clearly, we have ω ∈ E if and only if Aω does not
avoid BE . Note that our complex events BE only contain assignments. In general, it is also possible to
deal with complex events which contain atomic events A with |A| < N .
Given a function λ : X → R, we use the following shorthand notation: for an element (i, j) ∈ X , we
write λi,j := λ((i, j)), and for a set Y ⊆ X , we write
Y
λi,j .
λY :=
(i,j)∈Y

For Y ⊆ X and i ∈ [N ], we write Y ∼ i if there exists some j ∈ Li such that (i, j) ∈ Y .
Definition 4.5 (fractional hitting set, cf. [21, Definition 2.1]). Let Q : A → [0, 1]. For a set B ∈ A, we
say that Q is a fractional hitting set for B if Q(∅) = 0 and
X
Q(Y ) ≥ 1.
Y ⊆B

For a complex event B ⊆ A, we say that Q is a fractional hitting set for B if it is a fractional hitting
set for all B ∈ B. Moreover, for an event E ⊆ Ω, we say that Q is a fractional hitting set for E if it is a
fractional hitting set for BE .

10

S. GLOCK AND F. JOOS

The intention of this definition is to offer a more flexible notion of dependency within the framework,
which finally eliminates the need for a dependency graph. Suppose we want to find an assignment
that avoids the complex events B1 , . . . , BK , for which we are given fractional hitting sets Q1 , . . . , QK ,
respectively.
The partial resampling algorithm (PRA) starts with a random assignment of the Xi . Then it repeats
the following, as long as some bad event is true: choose any B ∈ Bk which is true. Now, select randomly
)
a set Y ⊆ B, where the probability of selecting Y is given by P ′Qk (Y
Qk (Y ′ ) . Then resample all Xi with
Y ⊆B

Y ∼ i (according to their distribution). Clearly, if the algorithm terminates, it outputs an assignment
of the Xi which avoids all bad events.
The next definition is the final ingredient before we can state the result of Harris and Srinivasan.
Therein, the function λ may be thought of as an ‘inflated’ probability vector.
Definition 4.6. Let Q : A → [0, 1] and λ : X → [0, ∞). We define
X
Γ(Q, λ) :=
Q(Y )λY ,
Y ∈A

and for each i ∈ [N ], we define

Γi (Q, λ) :=

X

Q(Y )λY .

Y ∈A : Y ∼i

Theorem 4.7 (Harris and Srinivasan [21, Theorem 3.8, see also Equation (10)]). Let B1 , . . . , BK ⊆ A be
λ
complex (bad) events. Let λ : X → [0, ∞) be such that pi,j = P i,j λi,j . Suppose we are given fractional
j∈Li

hitting sets Q1 , . . . , QK for B1 , . . . , BK , respectively. Assume that the following conditions are satisfied:
(i) for all k ∈ [K], we have Γ(Qk , λ) < 1;
P
P
Γi (Qk ,λ)
(ii) for all i ∈ [N ], we have k∈[K] 1−Γ(Q
+ 1 ≤ j∈Li λi,j .
k ,λ)

Then the expected number of resamplings of the PRA for these parameters is at most
particular, the PRA terminates with probability 1.

P

(i,j)∈X

λi,j . In

4.2. Proof of Corollary 4.4. Theorem 4.7 guarantees that there exists an assignment which avoids all
of B1 , . . . , BK . It does however not state a lower bound on the probability (in the space (Ω, P)) that no
bad event happens. Fortunately, we can deduce the following corollary, which yields such a lower bound.
For this, we use the PRA in an indirect proof. It would be interesting to know whether there exists an
appropriately formulated generalized Lovász local lemma with a direct proof.
Corollary 4.8. Let E1 , . . . , EK ⊆ Ω be (bad) events. Let λ : X → [0, ∞) be defined as λi,j := (1 + κ)pi,j ,
where κ ∈ (0, 1). Suppose there are fractional hitting sets Q1 , . . . , QK for E1 , . . . , EK , respectively, which
satisfy the following conditions:
(i) for all k ∈ [K], we have Γ(Qk , λ) < 1;
P
Γi (Qk ,λ)
≤ κ/2.
(ii) for all i ∈ [N ], we have k∈[K] 1−Γ(Q
k ,λ)
hT
i
Then P k∈[K] Ek ≥ κ3 (1 + κ)−N .
P
P
Q
Proof. For any event E ⊆ Ω, we have that P [E] = ω∈E P [{ω}] = ω∈E (i,j)∈Aω pi,j . Therefore,


X Y
\
(4.3)
pi,j ,
Ek  = P [E ∗ ] =
P
k∈[K]

A∈B∗ (i,j)∈A

S
where E ∗ := Ω \ k∈[K] Ek , B∗ := BE ∗ , and Bk := BEk for all k ∈ [K]. Observe that k∈[K]∪{∗} Bk = BΩ
and hence there is no assignment which avoids all of B1 , . . . , BK , B∗ .
Suppose, for a contradiction, that P [E ∗ ] ≤ p∗ := κ3 (1 + κ)−N . Let Q∗ : A → [0, 1] be the trivial
fractional hitting set for B∗ , that is Q∗ (Y ) := 1 if Y ∈ B∗ and Q∗ (Y ) := 0 otherwise. We emphasize that
B∗ only contains assignments and hence
X Y
X
(4.3)
(4.4)
(1 + κ)pi,j = (1 + κ)N P [E ∗ ] ≤ p∗ (1 + κ)N = κ/3.
λY =
Γ(Q∗ , λ) =
S

Y ∈B∗

Y ∈B∗ (i,j)∈Y

Γi (Q∗ ,λ)
Trivially, for all i ∈ [N ], we have Γi (Q∗ , λ) ≤ Γ(Q∗ , λ) ≤ κ/3, which implies 1−Γ(Q
≤ κ/2. We now
∗ ,λ)
apply Theorem 4.7 to the complex events B1 , . . . , BK , B∗ with fractional hitting sets Q1 , . . . , QK , Q∗ ,

11

respectively. For all k ∈ [K] ∪ {∗}, we have Γ(Qk , λ) < 1 by (i) and (4.4). Moreover, for all i ∈ [N ], we
have
X
X
Γi (Qk , λ)
λi,j .
+ 1 ≤ κ/2 + κ/2 + 1 = κ + 1 =
1 − Γ(Qk , λ)
k∈[K]∪{∗}

j∈[t]

Thus, by Theorem 4.7, there exists an assignment A ⊆ X which avoids all of B1 , . . . , BK , B∗ . This clearly
is a contradiction, which completes the proof.

We now use Corollary 4.8 to prove Corollary 4.4. To this end, we need to introduce some more
notation.
Pt
t
Let S∆
:= {(s1 , . . . , st ) :
j=1 sj = ∆, sj ∈ N0 } denote the t-dimensional discrete simplex. For

∆
∆!
t
denote the multinomial coefficient. Recall that
s = (s1 , . . . , st ) ∈ S∆ , let s := s1 !···s
t!
X ∆
(4.5)
= t∆ .
s
t

C

s∈S∆

Let G be a graph, c : E(G) → ∆ and suppose that C1 , . . . , Ct is a (random) partition of C. For
t
a vertex v and s = (s1 , . . . , st ) ∈ S∆
, let ds,v be the (random) number of edges e incident to v with
|c(e) ∩ Cj | = sj for all j ∈ [t]. For instance, for s = (∆, 0, . . . , 0), we have ds,v = dGC1 (v). Observe that

if each i ∈ C is independently assigned to Cj with probability 1/t, then E [ds,v ] = ∆s t−∆ dG (v).
p
Lemma 4.9. Suppose 1/n ≪ µ ≪ 1/t,d, 1/∆ and let κ := 4 t∆ d−1 µ. Let G be a graph on n vertices
C
with δ(G) ≥ dn, and let c : E(G) → ∆
be µn-bounded. Suppose we split C randomly into C1 , . . . , Ct ,
by independently assigning i ∈ C to Cj with probability 1/t. Then with probability at least κ3 (1 + κ)−|C| ,
the following holds:
 
∆ −∆
ds,v =
t dG (v) ± (2t)∆ κn
s
t
for all v ∈ V (G) and s ∈ S∆
.
We remark that for any 1 ≤ K ≤ 2−∆ κ−1 , the above probability bound can be improved to
κ/K)−|C| on the expense of an extra factor K in the degree error term, with the same proof.

κ
3K (1

+

Proof. We may assume that C = [N ]. Let X1 , . . . , XN be independent random variables taking
values in [t] uniformly at random. (Hence, the probability space is Ω = [t]N and the set of elements is
X = [N ] × [t].) For j ∈ [t], define the random sets Cj := {i ∈ [N ] : Xi = j}. Thus, the Cj are as in the
statement of the lemma.
t
For every vertex v ∈ V (G) and every s ∈ S∆
, we define Ev,s as the (bad) event that ds,v ≥

∆ −∆
∆
dG (v) + 2 κn. We will show that
s t


\
κ
Ev,s  ≥ (1 + κ)−N .
(4.6)
P
3
t
v∈V (G),s∈S∆


Observe that (4.6) would complete the proof: if no bad event Ev,s happens, we have ds,v ≤ ∆s t−∆ dG (v)+
t
2∆ κn for every vertex v ∈ V (G) and every s ∈ S∆
. We can then use (4.5) to also establish the lower
bound


X
X ∆
t
ds,v = dG (v) −
ds′ ,v ≥ 1 −
| − 1)κn
t−∆  dG (v) − 2∆ (|S∆
s′
t
t
′
′
s ∈S∆ \{s}
s ∈S∆ \{s}
 
∆ −∆
≥
t dG (v) − (2t)∆ κn.
s

We will obtain (4.6) by applying Corollary 4.8. To this end, we first define fractional hitting sets for our
bad events.
Step 1: Defining fractional hitting sets


]
t
Fix v ∈ V (G) and s ∈ S∆
throughout Step 1. For I ∈ [N
∆ , let dI (v) denote the number of edges
e incident to v with c(e) = I. We say that Y ∈ A is of type (I, s) if Y = {(i1 , j1 ), . . . , (i∆ , j∆ )} with
{i1 , . . . , i∆ } = I and for each j ∈ [t], the number of indices k ∈ [∆] with jk = j is equal to sj . Let T (I, s)
denote the set of all Y ∈ A of type (I, s). This means that the edges e at v with c(e) = I contribute to

12

S. GLOCK AND F. JOOS

the value of the random variable ds,v if and only if Y is a subset of the assignment given by the outcome
of X1 , . . . , XN . More formally, given an assignment A, we have
X
(4.7)
dI (v) = ds,v (A),
[N ]
I∈( ∆ ),Y ∈T (I,s) : Y ⊆A
where ds,v (A) refers to the value of ds,v if X1 , . . . , XN have outcome A.
Observe that
 
∆
|T (I, s)| =
(4.8)
.
s

We make another remark for later use. We have
 
 
X
∆
∆
(4.8) X
dI (v) =
dI (v) =
(4.9)
dG (v).
s
s
]
[N ]
,Y
∈T
(I,s)
I∈([N
I∈
)
)
(
∆
∆
Next we define a fractional hitting set Qv,s for the event Ev,s . Define Qv,s : A → [0, ∞) for all I ∈
and all Y ∈ T (I, s) as
(4.10)

Qv,s (Y ) :=

∆
s

dI (v)

−∆
t dG (v) + 2∆ κn

[N ]
∆



and set Qv,s (Y ) := 0 for all other Y ∈ A. We claim that Qv,s is indeed a fractional hitting set for Ev,s .
Recall that Bv,s is the corresponding set of assignments. Hence we need to check that Qv,s is a fractional
hitting set for all assignments A ∈ Bv,s .
Consider first any assignment A. Then
X
X
ds,v (A)
(4.7),(4.10)
=

.
Qv,s (Y )
Qv,s (Y ) =
∆ −∆
t dG (v) + 2∆ κn
[N ]
s
Y ⊆A
I∈( ∆ ),Y ∈T (I,s) : Y ⊆A

∆ −∆
Since ds,v (A) ≥ s P
t dG (v) + 2∆ κn for all A ∈ Bv,s by definition of Ev,s , we conclude that for any
A ∈ BEv,s , we have Y ⊆A Qv,s (Y ) ≥ 1, as required.
Step 2: Verification of the conditions in Corollary 4.8

Now, define λ : X → [0, ∞) as λi,j := (1 + κ)/t for all (i, j) ∈ X . We need to check conditions (i)
t
. We have
and (ii) from Corollary 4.8. In order to check (i), consider v ∈ V (G) and s ∈ S∆
∆

X
X
1+κ
Qv,s (Y )
Γ(Qv,s , λ)
=
Qv,s (Y )λY =
t
]
Y ∈A
I∈([N
∆ ),Y ∈T (I,s)


∆
∆
1+κ
(4.9),(4.10)
s dG (v)
=
· ∆
−∆ d (v) + 2∆ κn
t
G
s t
≤

and thus (as 2∆ κ ≤ 1)

(4.11)

1 + (2∆ − 1)κ
κ
(1 + κ)∆
≤
=1−
∆
∆
1+2 κ
1+2 κ
1 + 2∆ κ
Γ(Qv,s , λ) ≤ 1 − κ/2 < 1.

t
We now check (ii). Consider i ∈ [N ]. First observe that for any v ∈ V (G), s ∈ S∆
, we have

∆
X
X
1+κ
Y
Qv,s (Y )
Γi (Qv,s , λ) =
Qv,s (Y )λ =
(4.12)
.
t
]
Y ∈A : Y ∼i
I∈([N
,Y
∈T
(I,s)
:
I∋i
∆ )

Crucially, we have for all i ∈ [N ]
(4.13)

X

X

v∈V (G) I∈([N ]) : I∋i
∆

dI (v) ≤ 2µn

since c is µn-bounded and every edge e ∈ E(G) with i ∈ c(e) is counted twice on the left hand side.
t
Therefore, for any s ∈ S∆
, we have

∆
X
X
(4.8),(4.10),(4.13)
2µ
s · 2µn
Qv,s (Y )

≤ t∆ .
≤
∆ −∆
∆ κn
d
t
d
(v)
+
2
G
s
v∈V (G) I∈([N ]),Y ∈T (I,s) : I∋i
∆

13

Using (4.5) and (4.12), we deduce that
X

t
v∈V (G),s∈S∆

t
Γi (Qv,s , λ) ≤ |S∆
|



1+κ
t

∆

· t∆ ·

2µ
3t∆ µ
≤
.
d
d

Altogether, with (4.11), we conclude that
X
2 3t∆ µ
Γi (Qv,s , λ)
≤ ·
≤ κ/2
1 − Γ(Qv,s , λ)
κ
d
t
v∈V (G),s∈S∆

by definition of κ. Thus, (4.6) follows from Corollary 4.8.



For the proof of Lemma 4.1, we need the additional flexibility that not only the total degree of a
vertex is of interest, but its degree into each of the clusters of a regularity partition. By splitting every
vertex we can deduce this easily from Lemma 4.9.
Proof of Corollary 4.4.
We apply Lemma 4.9 to the graph G∗ , which is obtained from G by
splitting
each
vertex
as
follows:
for each v ∈ V (G), let v1 , . . . , vmv be new vertices. Let V (G∗ ) =
S
}.
For
every
edge uv ∈ E(G), there are unique i ∈ [mu ] and j ∈ [mv ] such that
{v
,
.
.
.
,
v
mv
v∈V (G) 1
u
v
v ∈ Si and u ∈ Sj . Add the edge ui vj to G∗ and define c∗ (ui vj ) := c(uv). Clearly, n∗ := |V (G∗ )| ≤ rn
and for all v ∈ V (G) and i ∈ [mv ], we have |NG∗ (vi )| = |Siv |. In particular, δ(G∗ ) ≥ drn ≥ dn∗ .
C
Moreover, c∗ : E(G∗ ) → ∆
is µn∗ -bounded. By Lemma 4.9 (with G∗ playing the role of G), the
following holds with probability at least κ3 (1 + κ)−|C| :
dG∗C (vi ) = t−∆ dG∗ (vi ) ± (2t)∆ κn∗
ℓ

for all v ∈ V (G), i ∈ [mv ] and ℓ ∈ [t]. Since dCℓ (v, Siv ) = dG∗C (vi ) and |Siv | = dG∗ (vi ), this completes
ℓ
the proof.

5. Proof of the rainbow blow-up lemma
In this section, we state and prove the full version of the rainbow blow-up lemma. As indicated
in Section 1.1, we also include exceptional vertices and candidate graphs in the statement. In [30],
the authors provided a version of the blow-up lemma which also allowed for the assignment of certain
‘candidate sets’ for some of the vertices. More precisely, for sufficiently small α, it is possible to assign
for every cluster Xi to α|Xi | vertices x of Xi a candidate set Ax ⊆ Vi , which needs to be of size at least
β|Vi |, such that the blow-up lemma still holds with the additional property that the image of x will lie
inside Ax . We keep track of candidate sets by storing the essential information in a ‘candidacy graph’
Ai with bipartition (Xi , Vi ), where NAi (x) encodes the candidate set for x. Thus, we allow candidate
sets for all vertices, not only a small fraction. However, we require that the resulting candidacy graph
for each cluster is lower super-regular. Clearly this includes the original framework. More formally, a
bipartite graph Ai with bipartition (Xi , Vi ) is a candidacy graph for (Xi , Vi ). We say that the blow-up
instance (H, G, R, (Xi )i∈[r]0 , (Vi )i∈[r]0 ) with candidacy graphs (Ai )i∈[r] is (lower) (ε, d)-super-regular if
for all ij ∈ E(R), the bipartite graph G[Vi , Vj ] is (lower) (ε, d)-super-regular, and for all i ∈ [r], the
graph Ai is (lower) (ε, d)-super-regular.
Candidate sets are especially helpful if a part of H is already embedded, for example if one has to
deal with ‘exceptional vertices’ before the application of the blow-up lemma. For instance, if x0 is an
exceptional vertex which already has been assigned its image v0 , and x is an H-neighbour of x0 to be
embedded by the blow-up lemma, then the image of x better lies NG (v0 ). This can be achieved by
assigning x a candidate set which is a subset of NG (v0 ). In the rainbow setting, we face the additional
challenge that, depending on which of the candidates v we pick as the image of x, the edge vv0 will
already use a colour which is then forbidden for the rest of the embedding. In the full statement of our
rainbow blow-up lemma, we thus already include the exceptional vertices. For the proof to work, we put
the following restrictions on the partial embedding of the exceptional vertices. We will see in Section 6
that these criteria can be met in applications easily.
Given a blow-up instance (H, G, R, (Xi )i∈[r]0 , (Vi )i∈[r]0 ) with candidacy graphs (Ai )i∈[r] and an edge
set colouring c : E(G) → 2C , we say that the bijection φ0 : X0 → V0 is D-feasible if the following hold:
(EXC1) for all x ∈ X0 , j ∈ [r] and y ∈ NH (x) ∩ Xj , we have NAj (y) ⊆ NG (φ0 (x));
(EXC2) for all j ∈ [r], x ∈ Xj , v ∈ NAj (x) and distinct x0 , x′0 ∈ NH (x) ∩ X0 , we have c(φ0 (x0 )v) ∩
c(φ0 (x′0 )v) = ∅ ;
P
(EXC3) for all colours α ∈ C, we have x∈X0 dα
G (φ0 (x)) · dH (x) ≤ D.

14

S. GLOCK AND F. JOOS

Condition (EXC1) ensures that whenever we pick for y ∈ V (H) \ X0 an image v from its candidate
set, then v is appropriately connected to V0 . Condition (EXC2) in turn ensures that no conflict arises
from this, i.e. the star with center v and the images of the neighbours of v in X0 is rainbow. Condition
(EXC3) is designed for an application where the exceptional vertices are not required to have bounded
degree. Note that (EXC1)–(EXC3) are trivially satisfied if X0 is empty. Moreover, (EXC2) is clearly
satisfied if X0 is 2-independent. Note that if c is k-bounded and ∆(H) ≤ ∆, then (EXC3) holds with
D = 2∆k.
Given an edge set colouring c of G, we say that a subgraph H is rainbow if c(e) ∩ c(e′ ) = ∅ for all
distinct e, e′ ∈ E(H). This allows to model slightly more general systems of conflicts. For instance, if
c1 , . . . , c∆ are edge colourings of G, we can define c∗ (e) := {c1 (e), . . . , c∆ (e)} for all e ∈ E(G). If H is
rainbow with respect to the edge set colouring c∗ , then H is simultaneously rainbow with respect to all
the ci .
We also note that, even if the given colouring of G is a ‘normal’ edge colouring, the ability to handle
edge set colourings is crucial when dealing with exceptional vertices (see Step 2 in the proof of Lemma 5.2).
We now state the full version of the rainbow blow-up lemma. It clearly implies Lemma 1.1.
Lemma 5.1 (Rainbow blow-up lemma). Let 1/n ≪ µ, ε ≪ d, 1/∆ and µ ≪ 1/r. Let (H, G, R, (Xi )i∈[r]0 , (Vi )i∈[r]0 )
with candidacy graphs (Ai )i∈[r] be a lower (ε, d)-super-regular blow-up instance and assume further that
(i) ∆(R) ≤ ∆ and dH (x) ≤ ∆ for all x ∈ V (H) \ X0 ;
(ii) |Vi | = (1 ± ε)n/r for all i ∈ [r];
(iii) for all i ∈ [r], at most (2∆)−4 |Xi | vertices in Xi have a neighbour in X0 .
Let c : E(G) → 2C be (µn, ∆)-bounded. Suppose a 2∆µn-feasible bijection φ0 : X0 → V0 is given. Then
there exists a rainbow embedding φ of H into G which extends φ0 such that φ(x) ∈ NAi (x) for all i ∈ [r]
and x ∈ Xi .
In the remaining four subsections of this section, we prove Lemma 5.1. In the first subsection,
we deduce Lemma 5.1 from a similar statement (Lemma 5.2), where we impose considerably stronger
assumptions on G and H. In Subsection 5.2, we introduce the so-called ‘Four graphs lemma’ from [43],
which we use in the proof of Lemma 5.2. In Subsection 5.3, we discuss ‘conflict-free’ matchings and see
how a recent result of Coulson and Perarnau [12] via the switching method can be used to find perfect
conflict-free matchings in super-regular pairs. This will be another important ingredient for the proof of
Lemma 5.2. In the last subsection we finally prove Lemma 5.2.
5.1. Split into matchings. Our first step in proving Lemma 5.1 is to reduce it to a similar statement
where H is highly structured in the sense that H only induces (perfect) matchings between its partition
classes. The main steps of this reduction are essentially the same as in [43]: we apply the Hajnal–
Szemerédi theorem to H 2 [Xi ] for each vertex class Xi to obtain a refined partition of H where every
vertex class is now 2-independent. We refine the partition of G randomly such that super-regularity is
preserved. Our reduction is more intricate than the one in [43] as we also consider candidacy graphs and
exceptional vertices and allow the cluster sizes to be slighty unbalanced.
We now state the auxiliary lemma, which we will prove in Section 5.4. In this subsection, we deduce
the rainbow blow-up lemma (Lemma 5.1) from Lemma 5.2.
Lemma 5.2. Suppose 1/n ≪ µ ≪ ε ≪ d, 1/∆ and µ ≪ 1/r such that r divides n. Let (H, G, R, (Xi )i∈[r]0 , (Vi )i∈[r]0 )
with candidacy graphs (Ai )i∈[r] be an (ε, d)-super-regular blow-up instance and assume further that
(i) ∆(R) ≤ ∆ and dH (x, X0 ) ≤ ∆ for all x ∈ V (H) \ X0 ;
(ii) |Vi | = n/r for all i ∈ [r];

(iii) for all ij ∈ [r]
2 , the graph H[Xi , Xj ] is a perfect matching if ij ∈ E(R) and empty otherwise.
Let c : E(G) → 2C be (µn, ∆)-bounded. Suppose a µn-feasible bijection φ0 : X0 → V0 is given. Then
there exists a rainbow embedding φ of H into G which extends φ0 such that φ(x) ∈ NAj (x) for all j ∈ [r]
and x ∈ Xj .

In the reduction, we will need the classical Hajnal–Szemerédi theorem and two facts about regular
pairs.
Theorem 5.3 ([18]). Let G be a graph on n vertices with ∆(G) < k ≤ n. Then V (G) can be partitioned
into k independent sets of size ⌊ nk ⌋ or ⌈ nk ⌉.

Proposition 5.4 ([43, Fact 2]). Let 1/n ≪ ε ≪ ε′ ≪ d. Let G be a bipartite graph with bipartition
(V1 , V2 ), where |V1 | = |V2 | = n. If G is lower (ε, d)-super-regular, then G contains a spanning subgraph
G′ which is (ε′ , d2 /2)-super-regular.

15

Fact 5.5. Let G be a bipartite graph with vertex partition (A, B). Suppose G is lower (ε, d)-regular and
Y ⊆ B with |Y | ≥ ε|B|. Then all but at most ε|A| vertices of A have at least (d − ε)|Y | neighbours in Y .

Proof of Lemma 5.1. The proof divides into four steps. Firstly, we modify the partition of H. From
this, we obtain a few more exceptional vertices. In Step 2, we then extend φ0 to the new exceptional set.
Subsequently, in Step 3 we refine the partition of G accordingly, and finally we apply Lemma 5.2.
Choose a new constant ε∗ such that 1/n ≪ µ, ε ≪ ε∗ ≪ d, 1/∆. Let n′ be the largest integer not
exceeding (1 − ε)n/r which is divisible by ∆2 . For i ∈ [r], define ai := |Xi | − n′ . Note that

(5.1)

0 ≤ ai ≤ 3εn/r.

Let R∗ be the graph with vertex set [r] × [∆2 ] and edges (i, j)(i′ , j ′ ) ∈ E(R∗ ) whenever ii′ ∈ E(R).
Clearly, ∆(R∗ ) ≤ ∆3 . Let r∗ := r∆2 and n∗ := n′ r. So (1 − 2ε)n ≤ n∗ ≤ n. Later, we will apply
Lemma 5.2 with n∗ , r∗ , R∗ playing the roles of n, r, R, respectively.
Step 1: Refining H
First, we move ai vertices from each cluster Xi to the exceptional set in order to adjust the sizes. For
vertex sets U1 ⊆ U2 ⊆ V (H), we say that (U2 , U1 ) is (2, 1)-independent if U2 is independent in H and
whenever u, u′ ∈ U2 have a common neighbour in H, then u, u′ ∈ U1 .

Claim 1: There is a set B ⊆ V (H)\ X0 such that |B ∩Xi | = ai for all i ∈ [r] and such that (X0 ∪B, X0 )
is (2, 1)-independent in H.

Proof of claim: The set B can be constructed greedily. Assume that for some i ∈ [r − 1]0 , we have found
a set Bi such that |Bi ∩ Xj | = aj for all j ∈ [i] and (X0 ∪ Bi , X0 ) is (2, 1)-independent in H. (Note that
B0 = ∅ satisfies this for i = 0.) Using (5.1) and the fact that ∆(R) ≤ ∆ and ∆(H) ≤ ∆, it is not hard
to see that at most (2∆)−2 n/r vertices in Xi+1 are at distance at most 2 from X0 ∪ Bi .
Now, since ∆(H 2 [Xi+1 ]) ≤ ∆2 − 1, there exists a 2-independent subset of Xi+1 of size at least
|Xi+1 |/∆2 . Thus, since |Xi+1 |/∆2 − (2∆)−2 n/r ≥ ai+1 , we can pick ai+1 2-independent vertices from
Xi+1 which are at distance at least 3 from X0 ∪ Bi and add them to Bi to obtain Bi+1 . Observe that
then (X0 ∪ Bi+1 , X0 ) is (2, 1)-independent in H.
−

Define X0∗ := X0 ∪ B and Xi′ := Xi \ B for i ∈ [r]. Clearly, we have |Xi′ | = n′ . For all i ∈ [r], apply the
Hajnal–Szemerédi theorem (Theorem 5.3) to H 2 [Xi′ ]. Note that ∆(H 2 [Xi′ ]) ≤ ∆(∆ − 1) < ∆2 . Recall
∗
∗
that n′ is divisible by ∆2 . Thus, there exists a partition of Xi′ into 2-independent sets Xi,1
, . . . , Xi,∆
2 in
′
2
′ ′
2
∗
∗
H of size exactly n /∆ each. For all (i, j), (i , j ) ∈ [r] × [∆ ], we have that H[Xi,j , Xi′ ,j ′ ] is a matching
if (i, j)(i′ , j ′ ) ∈ E(R∗ ) and empty otherwise. Thus, R∗ is a suitable reduced graph for the new partition
∗
(Xi,j
)(i,j)∈[r]×[∆2 ] of V (H) \ X0∗ , and X0∗ is the new exceptional set. Surely, we can add edges to H to
∗
obtain a supergraph H ∗ such that H ∗ [Xi,j
, Xi∗′ ,j ′ ] forms a perfect matching for all (i, j)(i′ , j ′ ) ∈ E(R∗ )
∗
Clearly, any rainbow embedding of H induces a rainbow embedding of H.
We observe that by the (2, 1)-independence of (X0∗ , X0 ), we have that for all i ∈ [r] and y ∈ Xi′ ,
exactly one of the following alternatives applies:
(a) NH (y) ∩ X0∗ = NH (y) ∩ X0 ;
(b) NH (y) ∩ X0∗ = {x} for a unique x ∈ Xj with j ∈ NR (i);
(c) NH (y) ∩ X0∗ = ∅.
Let Wa be the set of all vertices y ∈ V (H) \ X0∗ for which (a) applies, and let Wb be the set of all vertices
y ∈ V (H) \ X0∗ for which (b) applies. For i ∈ [r], we have
X
(5.1)
∆aj ≤ ∆2 · 3εn/r.
|Wb ∩ Xi | ≤
(5.2)
j∈NR (i)

Step 2: Extending φ0
We want to find a suitable set V0∗ ⊇ V0 and extend φ0 to a bijection φ∗0 : X0∗ → V0∗ such that
φ∗0 (x) ∈ NAj (x) for all j ∈ [r] and x ∈ X0∗ ∩ Xj , and such that for all x ∈ X0∗ \ X0 , all i ∈ [r] and all
y ∈ NH (x) ∩ Xi , we have
(5.3)

|NAi (y) ∩ NG (φ∗0 (x))| ≥ (d − ε)|NAi (y)|.

We can find V0∗ and φ∗0 by successively picking a suitable image for each x ∈ X0∗ \ X0 . Suppose we have
already defined images for Z ⊆ X0∗ \ X0 and now want to find a suitable image for x ∈ X0∗ \ (X0 ∪ Z).
Let j ∈ [r] be such that x ∈ Xj . We want to pick φ∗0 (x) from NAj (x). A vertex v ∈ NAj (x) is a suitable
image if for all i ∈ [r] and all y ∈ NH (x) ∩ Xi , we have dG (v, NAi (y)) ≥ (d − ε)|NAi (y)|. For fixed i ∈ [r]

16

S. GLOCK AND F. JOOS

and y ∈ NH (x) ∩ Xi , since ij ∈ E(R) and G[Vi , Vj ] is lower (ε, d)-regular, Fact 5.5 implies that all but
at most ε|Vj | vertices in Vj have at least (d − ε)|NAi (y)| neighbours in NAi (y). Thus, at most ∆ε|Vj |
vertices of Vj are not suitable images for x. Moreover, at most aj vertices of Vj have already been used
as images for the vertices in Z. Thus, there exists a suitable image φ∗0 (x) for x.
Let V0∗ := φ∗0 (X0∗ ). Clearly, we have |V0∗ ∩ Vi | = ai for all i ∈ [r]. Before we continue to refine the
partition of G, we have to redefine the neighbourhoods of the vertices in Wb in their respective candidate
graphs in order to meet condition (EXC1) for φ∗0 (see Step 4). Consider i ∈ [r]. Let A′i be the spanning
subgraph of Ai obtained by deleting for every vertex y ∈ Xi ∩ Wb all edges yv for which v ∈
/ NG (φ∗0 (x)),
′i
∗
where x is the unique H-neighbour of y in X0 (cf. (b)). Note that A still contains vertices from X0∗
and V0∗ . We might as well remove them, but it is more convenient to leave them in for now.
Note that by (5.3), we still have that dA′i (y) ≥ (d−ε)|NAi (y)| ≥ d2 |Vi |/2 for all y ∈ Xi ∩Wb . Moreover,
since |Xi ∩ Wb | ≤ 4∆2 ε|Xi | by (5.2), it is easy to see that A′i is still lower (8∆2 ε, d2 /2)-super-regular.
Step 3: Refining G
Let d′ := d2 /2. For i ∈ [r], let Vi′ := Vi \ V0∗ . Clearly, |Vi′ | = |Xi′ | = n′ . We will partition each Vi′
∗
randomly into ∆2 equal-sized parts and then match those with the refined parts Xi,j
of Xi′ . In order to
obtain super-regular new candidacy graphs, we need to take special care of some vertices.
Consider i ∈ [r]. We say that a vertex v ∈ Vi′ is good if

(5.4)

∗
∗
dA′i (v, Xi,j
) ≥ (d′ − 8∆2 ε)|Xi,j
|

for all j ∈ [∆2 ]. By Fact 5.5 and since A′i is lower (8∆2 ε, d′ )-regular, all but at most 8∆4 ε|Vi | vertices
of Vi are good. Let Vi′′ be the set of good vertices of Vi′ . Thus,
√
(5.5)
|Vi \ Vi′′ | ≤ 8∆4 ε|Vi | + ai ≤ ε|Vi |.

∗
∗
′
2
We now partition Vi′ into equal-sized parts Vi,1
, . . . , Vi,∆
= n∗ /r∗ each. First,
2 of size exactly n /∆
we take care of the √
vertices which are not good. For every v ∈ Vi′ \ Vi′′ , choose j ∈ [∆2 ] such that
∗
∗
dA′i (v, Xi,j
) ≥ (d′ − ε)|Xi,j
|. Clearly, such an index j ∈ [∆2 ] exists since dA′i (v) ≥ (d′ − 8∆2 ε)|Xi | ≥
√
′
2
′
′
be the set of all vertices v ∈ Vi′ \ Vi′′ which have been assigned to j
(d − ε)|Xi |. For j ∈ [∆ ], let Vi,j
in this way.
′′
′′
′′
′′
′
Now, for each i ∈ [r], let Vi,1
, . . . , Vi,∆
such that |Vi,j
| = n′ /∆2 − |Vi,j
| and such
2 be a partition of Vi
′
′
2
that the following hold: for all i ∈ [r], i ∈ NR (i), v ∈ Vi and j ∈ [∆ ], we have
√
dG (v, Vi′′′ ,j ′ ) ≥ (d − 3 ε)|Vi′′′ ,j ′ |,
(5.6)

and for all i ∈ [r], x ∈ Xi and j ∈ [∆2 ], we have

(5.7)

√
′′
′′
|.
dA′i (x, Vi,j
) ≥ (d′ − 3 ε)|Vi,j

That such partitions exist can be seen using a probabilistic argument as follows: For each i ∈ [r], let
′′
′′
′′
′′
′
2
′
Vi,1
, . . . , Vi,∆
2 be a partition of Vi such that |Vi,j | = n /∆ − |Vi,j |, chosen uniformly at random amongst
all such partitions. (We may also assume that the partitions of Vi′′ and Vi′′′ , say, are independent, but
′′
this is not even necessary.) In particular, for all (i, j) ∈ [r] × [∆2 ], the set Vi,j
is a uniformly random
′′
′
2
′
′
subset of Vi of size n /∆ − |Vi,j |. Note that for all i ∈ [r], i ∈ NR (i), v ∈ Vi , we have
(5.5)
√
√
dG (v, Vi′′′ ) ≥ (d − ε)|Vi′ | − ε|Vi′ | ≥ (d − 2 ε)|Vi′′′ |.


√
Thus, for all j ′ ∈ [∆2 ], we have E dG (v, Vi′′′ ,j ′ ) ≥ (d − 2 ε)|Vi′′′ ,j ′ |. Similarly, for all i ∈ [r], x ∈ Xi


√
′′
′′
and j ∈ [∆2 ], we have E dA′i (x, Vi,j
) ≥ (d′ − 2 ε)|Vi,j
|. Using a Chernoff-Hoeffding-type bound for
the hypergeometric distribution and a union bound, we can see that (5.6) and (5.7) are satisfied with
positive probability.
∗
′
′′
Finally, for (i, j) ∈ [r] × [∆2 ], let Vi,j
:= Vi,j
∪ Vi,j
. We claim that for all (i, j)(i′ , j ′ ) ∈ E(R∗ ), the
√
∗
∗
bipartite graph G[Vi,j , Vi′ ,j ′ ] is lower (3 ε, d)-super-regular. Indeed, it follows simply from the lower
∗
, Vi∗′ ,j ′ ] is lower (2∆2 ε, d)-regular, say.
(ε, d)-regularity of the pairs G[Vi , Vi′ ] for ii′ ∈ E(R) that G[Vi,j
That every vertex has large enough degree in the respective pair follows from (5.6).
√
∗
∗
Similarly, for all (i, j) ∈ [r] × [∆2 ], the new candidacy graph A(i,j) := A′i [Xi,j
, Vi,j
] is lower (3 ε, d′ )∗
∗
super-regular. Here, every vertex x ∈ Xi,j
has sufficiently high degree in Vi,j
by (5.7). Moreover, all
′
good vertices of Vi have automatically sufficiently high degree by (5.4), and all vertices which are not
′
good have sufficiently high degree in their new candidate graph because of their assignment to a set Vi,j
.
∗
∗
∗
∗
Finally, using Proposition 5.4, we can transition to a spanning subgraph G of G such that G [Vi,j , Vi,j ′ ]
is (ε∗ , d2 /2)-super-regular for all (i, j)(i′ , j ′ ) ∈ E(R∗ ), and for each (i, j) ∈ [r] × [∆2 ], we can transition

17

to a spanning subgraph A∗(i,j) of A(i,j) such that A∗(i,j) is (ε∗ , d′2 /2)-super-regular. Note that we do
not delete any edges incident to V0∗ .
Step 4: Applying Lemma 5.2
We can now complete the proof. It remains to check that φ∗0 is feasible.
∗
. If y ∈ Wa , then we must have
First, consider x ∈ X0∗ , (i, j) ∈ [r] × [∆2 ] and y ∈ NH ∗ (x) ∩ Xi,j
x ∈ X0 and thus NAi (y) ⊆ NG (φ0 (x)) by (EXC1) for φ0 . If y ∈ Wb , then we have NA′i (y) ⊆ NG (φ∗0 (x))
by the definition of A′i . In both cases, we conclude that NA′i (y) ⊆ NG∗ (φ∗0 (x)) since edges in G are only
removed between regular pairs. Since A∗(i,j) is a subgraph of A′i , we have NA∗(i,j) (y) ⊆ NG∗ (φ∗0 (x)).
Thus, (EXC1) holds for φ∗0 .
Condition (EXC2) also holds for φ∗0 because only the vertices in Wb gained a new neighbour in X0∗ .
However, as each y ∈ Wb only has one neighbour in X0∗ , the condition holds trivially.
Finally, consider (EXC3). Let α ∈ C. Note that dH ∗ (x) = dH (x) ≤ ∆ for all x ∈ X0∗ \ X0 . Thus,
X
dG∗α (φ∗0 (x)) · dH ∗ (x) ≤ 2∆µn
x∈X0∗ \X0

P

and hence x∈X ∗ dG∗α (φ∗0 (x)) · dH ∗ (x) ≤ 2∆µn + 2∆µn ≤ µ0.9 n∗ .
0
Therefore, φ∗0 is µ0.9 n∗ -feasible. Now apply Lemma 5.2 as follows:
n
n∗

µ
µ0.9

ε
ε∗

d
d /8
4

∆
∆3

r
r∗

H
H∗

G
G∗

R
R∗

Xi
∗
Xi,j

Vi
∗
Vi,j

Ai
∗(i,j)

A

c
c↾E(G∗ )

φ0
φ∗0

This yields a rainbow embedding φ of H ∗ into G∗ which extends φ∗0 such that φ(x) ∈ NA∗(i,j) (x) for
∗
all (i, j) ∈ [r] × [∆2 ] and x ∈ Xi,j
. Clearly, φ is thus a rainbow embedding of H into G which extends
φ0 such that φ(x) ∈ NAi (x) for all i ∈ [r] and x ∈ Xi .

5.2. The Four graphs lemma. In this subsection, we state the so-called ‘Four graphs lemma’ due to
Rödl and Ruciński, which is an important ingredient in the proof of the blow-up lemma.
Let V1 , V2 , V3 be three disjoint sets of size n. Suppose Gi,j , for 1 ≤ i < j ≤ 3, is an (ε, di,j )-superregular bipartite graph with vertex partition (Vi , Vj ) and for all v1 v2 ∈ E(G1,2 ) (with v1 ∈ V1 ), we
have
(5.8)

|NG1,3 (v1 ) ∩ NG2,3 (v2 )| = (d1,3 d2,3 ± ε)n.

In such a case we say that the triple (G1,2 , G1,3 , G2,3 ) is (ε, d1,2 , d1,3 , d2,3 )-regular. For a perfect matching
σ : V1 → V2 of G1,2 , let Aσ be the spanning subgraph of G1,3 such that v1 v3 ∈ E(Aσ ) (with vi ∈ Vi for
i ∈ {1, 3}) if σ(v1 )v3 ∈ E(G2,3 ).
Lemma 5.6 (Four graphs lemma, see [43]). Suppose 1/n ≪ a ≪ ε ≪ ε′ ≪ d1,2 , d1,3 , d2,3 . Suppose
(G1,2 , G1,3 , G2,3 ) is (ε, d1,2 , d1,3 , d2,3 )-regular on the vertex set V1 ∪ V2 ∪ V3 . Suppose σ : V1 → V2 is a
perfect matching of G1,2 drawn uniformly at random, then
P [Aσ is (ε′ , d1,3 d2,3 )-super-regular] ≥ 1 − (1 − a)n .
The following proposition is useful when the graphs Gi,j are super-regular, but (5.8) is not satisfied.
One can always delete a small fraction of the edges of G1,2 such that (5.8) is then satisfied. The proof
is based on standard regularity methods and thus omitted. (See also Fact 1 in [43] for a very similar
statement.)
Proposition 5.7. Let 1/n ≪ ε ≪ d, 1/k. Let V1 , . . . , Vk+2 be disjoint vertex sets of size n. Suppose
that G1,2 is an (ε, d1,2 )-super-regular bipartite graph with bipartition (V1 , V2 ), where d1,2 ≥ d, and for all
i ∈ [2] and j ∈ {3, . . . , k + 2}, Gi,j is an (ε, di,j )-super-regular bipartite graph with bipartition (Vi , Vj ),
where di,j ≥ d. Let G′1,2 be the spanning subgraph of G1,2 consisting of those edges v1 v2 ∈ E(G1,2 )
(with v1 ∈ V1 , v2 ∈ V2 ) which satisfy the following: |NG1,j (v1 ) ∩ NG2,j (v2 )| = (d1,j d2,j ± ε)n for all
√
j ∈ {3, . . . , k + 2}. Then G′1,2 is still (2k ε, d1,2 )-super-regular.
We close this subsection by giving some intuition as to how the Four graphs lemma is applied. Suppose
that we embed cluster Xi into Vi by choosing a perfect matching σ in a suitable candidacy graph Ai
with bipartition (Xi , Vi ). Suppose we have not embedded cluster Xj yet. In order to proceed with the
embedding, we need to update the candidacy graph Aj . This involves the graphs H[Xi , Xj ], Ai , Aj ,
and G[Vi , Vj ]. More precisely, suppose that x ∈ Xj and that v ∈ Vj is a candidate for x before the
embedding of Xi . After embedding Xi , vertex v remains a valid candidate for x if and only if it is
suitably connected to the images of the neighbours of x which are already embedded. Now, if H[Xi , Xj ]

18

S. GLOCK AND F. JOOS

is a perfect matching, we can define the bijection π : Xj → Xi where π(x) is the unique H-neighbour of
x in Xi . With this notation, v remains a valid candidate for x if and only if σ(π(x))v ∈ E(G[Vi , Vj ]).
We can now identify Xj with Xi according to π. More precisely, define the graph P with bipartition
(Xi , Vj ) which is isomorphic to Aj , where π(x) plays the role of x. We are now left with three vertex
sets Xi , Vi , Vj and the three graphs Ai , P, G[Vi , Vj ]. In this setting, we can apply the Four graphs lemma,
which yields a super-regular spanning subgraph Pσ of P , which, via π, translates back to the updated
candidacy graph for (Xj , Vj ).
5.3. Conflict-free perfect matchings. A system of conflicts in a graph G is a set F of unordered
pairs of edges. If {e, f } ∈ F , we say that e and f conflict. We say that F is k-bounded if every edge is
contained in at most k conflicts. A subgraph H is conflict-free if no two edges of H conflict.
Let G be a bipartite graph with vertex classes A, B such that |A| = |B| = n. Suppose M is a perfect
matching of G and e = a1 b1 ∈ M . An edge ab ∈ E(G) \ M is (e, M )-switchable if a1 b2 , a2 b1 ∈ E(G),
where a2 and b2 are matched to b and a by M , respectively, i.e. a2 b, ab2 ∈ M .
The following lemma from [12] is another important tool in our proof. Its proof is based on the
Lopsided Lovász local lemma. In [12], it is used to show the existence of conflict-free perfect matchings
in Dirac bipartite graphs.
Lemma 5.8 (Coulson and Perarnau [12, Lemma 6]). Suppose 1/n ≪ µ ≪ γ. Let G be a bipartite
graph with bipartition (A, B) such that |A| = |B| = n. Assume that G has at least one perfect matching,
and for every perfect matching M of G and for every e ∈ M there are at least γn2 edges in G that are
(e, M )-switchable. Then, given any µn-bounded system of conflicts for G, a uniformly chosen perfect
1/2
matching of G is conflict-free with probability at least e−µ n .
We will apply it to find conflict-free perfect matchings of our candidacy graphs. It is easy to see that
there are many switchings in an (ε, d)-super-regular graph.
Proposition 5.9. Let 1/n ≪ ε ≪ d. Let G be a bipartite graph with bipartition (A, B) such that
|A| = |B| = n and G is lower (ε, d)-super-regular. Then G has a perfect matching. Moreover, for
every perfect matching M of G and every e ∈ M , there are at least (d − 2ε)3 n2 edges in G that are
(e, M )-switchable.
Proof. It is well known that G has a perfect matching. Let M be a perfect matching of G and suppose
e ∈ M . Let a ∈ A, b ∈ B with e = ab. Define Na := NG (a) and Nb := NG (b). Moreover, let Na′ ⊆ A be
the set of vertices which are matched to the vertices in Na by M , and let Nb′ ⊆ B be the set of vertices
which are matched to the vertices in Nb by M . Clearly, |Na′ | = |Na | and |Nb′ | = |Nb |. Note that all
edges in G[Na′ , Nb′ ] are (e, M )-switchable, except those which already belong to M . Since dG (a), dG (b) ≥
(d−ε)n ≥ εn, we have dG (Na′ , Nb′ ) ≥ d−ε and hence eG (Na′ , Nb′ )−|M | ≥ (d−ε)|Na′ ||Nb′ |−n ≥ (d−2ε)3 n2 .


5.4. Proof of Lemma 5.2. We are now ready to prove the auxiliary blow-up lemma. We split the
proof into four steps. In Step 1, we show that we may assume that |C| is not too large. This is needed
for the application of Lemma 4.1. We embed H into G in a number of rounds, which depends only on
∆; in particular, all vertices that belong to the same cluster are embedded simultaneously. As r may be
much larger than ∆, we even have to embed several clusters in a single round (cf. Section 2). In Step 2,
we reserve for each round a set of colours. During the embedding procedure, we will in each round only
use colours of G which were assigned to this round. In Step 3, we set up the induction statement and in
Step 4, we perform the induction step.
Proof of Lemma 5.2. Let n′ := |V (G)| = n + |V0 |. By removing isolated vertices from X0 and their
images determined by φ0 from V0 , we can assume that |V0 | ≤ ∆n and hence n′ ≤ (∆ + 1)n. We may
clearly assume that V0 , . . . , Vr are independent in G. Let
T := ∆2 + 1,

d′ :=

Choose new constants a, ε1 , . . . , εT such that

d

 2
T +1 ∆
2

and ε0 := 2ε.

1/n ≪ µ ≪ a ≪ ε ≪ ε1 ≪ · · · ≪ εT ≪ d, 1/∆.
Step 1: Modifying the colouring assignment

19

We claim that we may assume that |C| ≤ 7µ−1 ∆2 n. Roughly speaking, if two colours α, β appear on
at most µn/2 edges each, say, then we wish to merge them to a single colour. Clearly, the new colouring
will still be (µn, ∆)-bounded and any rainbow embedding of H in the new colouring is also a rainbow
embedding in the original colouring. However, we have to be a bit careful not to violate the feasibility
of φ0 . We start with a simple observation:
X X
X
X
dα
dH (x)∆dG (φ0 (x)) ≤ ∆n
dH (x) ≤ ∆2 n2 .
G (φ0 (x)) · dH (x) ≤
α∈C x∈X0

x∈X0

−1

2

P

x∈X0

α
x∈X0 dG (φ0 (x))

Hence there are at most 2µ ∆ n colours α ∈ C for which
· dH (x) ≥ µn/2 holds. Let
us call these colours critical. In order to ensure that (EXC3) still holds, we will not merge colours where
one is critical.
We say α, β ∈ C block each other if there exist distinct x, x′ ∈ X0 , x′′ ∈ NH (x) ∩ NH (x′ ) and
v ∈ NAi (x′′ ) for some i ∈ [r] such that α ∈ c(φ0 (x)v) and β ∈ c(φ0 (x′ )v). For (EXC2) to be preserved,
we must not merge colours which block each other. Next we seek an upper bound on the number of
pairs α, β that block each other. For any x, x′ ∈ X0 , x′′ ∈ NH (x) ∩ NH (x′ ), there are clearly at most
n vertices v ∈ NAi (x′′ ) and for each such v, there are at most ∆2 such pairs. We claim that there
are at most ∆2 n choices for x, x′ , x′′ as above. Indeed, there are clearly at most n choices for x′′ as
x′′ ∈ V (H) \ X0 and as dH (x′′ , X0 ) ≤ ∆, we have at most ∆2 choices for the pair x, x′ . Hence there are
at most n · ∆2 · n∆2 = ∆4 n2 pairs α, β that block each other. Therefore, any set of colours of size, say,
10∆2 n contains a pair α, β such that α, β do not block each other.
The following observation motivates our discussion above. Given α, β that do not block each other,
are both not critical, and there are at most µn edges on which α or β appear, then we may replace
every appearance of β by α (some colour sets may become smaller) and the new edge set colouring is
still (µn, ∆)-bounded and φ0 is still µn-feasible. In addition, any rainbow embedding of H in the new
colouring is also a rainbow embedding in the original colouring.
Therefore, we may assume that there are at most 2µ−1 ∆2 n + 10∆2 n ≤ 3µ−1 ∆2 n colours α ∈ C such
that α appears on at most µn/2 edges. Hence (|C| − 3µ−1 ∆2 n) · µn/2 ≤ ∆e(G) ≤ 2∆2 n2 , which implies
|C| ≤ 7µ−1 ∆2 n.
Step 2: Colour splitting
Let ψ : V (R) → [T ] be a proper vertex colouring of R2 . Moreover, set ψ(0) := 0. For t ∈ [T ]0 , let
[
Jℓ .
Jt := ψ −1 (t) and Jt∗ :=
ℓ∈[t]0

Note that the sets (Jt )t∈[T ] are 2-independent in R, and J0 = {0}.
In round t ∈ [T ], we will embed all vertices from clusters Xi with i ∈ Jt . In order to reserve colours

for the respective rounds, we first partition E(R) according to the colouring ψ. For t1 t2 ∈ [T2 ] , let
Et1 t2 := {ij ∈ E(R) : ψ(i) = t1 , ψ(j) = t2 }. Clearly, (Et1 t2 )t1 t2 ∈([T ]) is a partition of E(R) since
2

ψ(i) 6= ψ(j) for all ij ∈ E(R). We will also reserve colours for the edges that have an endpoint in V0 .
For t ∈ [T ], define E0t := {{j, j + r} : j ∈ Jt }.
Our aim is now to use Lemma 4.1 to reserve for every set (Et1 t2 )t1 t2 ∈([T ]0 ) an exclusive set of colours,
2
and sparsify G accordingly. This will also let the neighbourhoods of exceptional vertices shrink, and
thus we need to update the candidacy graphs Aj . To ensure that the new candidacy graphs are again
super-regular, we define an auxiliary colouring of S
the candidacy graphs and apply Lemma 4.1 to the
somewhat artificial graph Gexc := G[V (G) \ V0 ] ∪ j∈[r] Aj which is the union of G[V (G) \ V0 ] and all
the candidacy graphs. For j ∈ [r], let Vj+r := Xj . Let Rexc be the graph on [2r] which is the union
of R and the perfect matching {{j, j + r} : j ∈ [r]}. Note that Rexc is a reduced graph for Gexc , and
(Et1 t2 )t1 t2 ∈([T ]0 ) is a partition of E(Rexc ).
2

We now transfer the colouring of G[V0 , V (G)\V0 ] onto the candidacy graphs in a natural way: Consider
i ∈ [r], x ∈ Xi and v ∈ Vi with xv ∈ E(Ai ). Define
[
(5.9)
c(φ0 (x′ )v).
cexc (xv) :=
x′ ∈NH (x)∩X0

Note that |cexc (xv)| ≤ ∆2 since c is (µn, ∆)-bounded and dH (x, X0 ) ≤ ∆. We also define cexc (e) := c(e)
for all e ∈ E(G[V (G) \ V0 ]). We claim that cexc is (2µn, ∆2 )-bounded. Consider any αS∈ C. Since
φ0 is µn-feasible, we can deduce from (EXC3) that α appears on at most µn edges xv ∈ j∈[r] E(Aj ).
Moreover, there are at most µn edges e ∈ E(G[V (G) \ V0 ]) on which α appears.

20

S. GLOCK AND F. JOOS

Recall from Step 1that we can assume that |C| ≤ 7µ−1 ∆2 n. We now apply Lemma 4.1 (with Gexc ,
c , Rexc , ∆2 , T +1
playing the roles of G, c, RS , ∆, t) to obtain a partition (Ct1 t2 )t1 t2 ∈([T ]0 ) of C
2
2

exc
such that for all t1 t2 ∈ [T2]0 and all ij ∈ E(Rexc ), there is a subgraph Gij
t1 t2 of GCt1 t2 [Vi , Vj ] which is

(ε0 , d′ )-super-regular. We will only keep those for which ψ(ij) = t1 t2 . More precisely, for all t1 t2 ∈ [T2 ]
and all ij ∈ Et1 t2 , we let Gij := Gij
t1 t2 ⊆ GCt1 t2 [Vi , Vj ], and for all 1 ≤ t ≤ T and all j ∈ Jt , we let
j
0j
j
1
A0 := G0t ⊆ AC0t . This means that we reserve the colours in Ct1 t2 for the edges in G[Vi , Vj ] with
ψ(ij) = t1 t2 . The colours in the sets C0t are ‘reserved’ for the candidacy graphs, which we now transfer
back to the exceptional edges. For all t ∈ [T ] and all j ∈ Jt , define the bipartite graph G0j with
bipartition (V0 , Vj ) and edge set E(G0j ) = {v0 v ∈ E(G) : v0 ∈ V0 , v ∈ Vj , c(v0 v) ⊆ C0,t }.
We now transition from G to the spanning subgraph G∗ defined as
[
[
Gij
G0j ∪
G∗ :=
exc

ij∈E(R)

j∈[r]

which is the spanning subgraph
of G containing those edges of G which are ‘admissibly’ coloured. More

precisely, for all t1 t2 ∈ [T2]0 and all ij ∈ Et1 t2 , we have
c(vw) ⊆ Ct1 t2 for all vw ∈ G∗ [Vi , Vj ].

(5.10)

The following is the reason why we transferred the colouring of the exceptional edges onto the candidacy
graphs before applying Lemma 4.1. Observe that for all j ∈ [r], x0 ∈ X0 and x ∈ NH (x0 ) ∩ Xj , we have
NAj (x) ⊆ NG∗ (φ0 (x0 )),

(5.11)

0

i.e. the new candidacy graphs satisfy (EXC1) with respect to the sparsified graph G∗ . Indeed, given
j, x0 , x as above and v ∈ NAj (x), we have xv ∈ Aj and cexc (xv) ⊆ C0,t , where t := ψ(j). By (EXC1),
0
we have φ0 (x0 )v ∈ E(G). Moreover, by definition of cexc , we have
(5.9)

c(φ0 (x0 )v) ⊆ cexc (xv) ⊆ C0,t

and thus φ0 (x0 )v ∈ E(G0j ) ⊆ E(G∗ ), as claimed. From now on, we do not need the colouring cexc
anymore.
Step 3: Candidacy graphs and the inductive statement
We will embed H into G∗ . For brevity, define for t ∈ [T ]0 :
[
[
Xt :=
Xi ,
Vt :=
Vi ,
i∈Jt

Xt∗ :=

[

Ct :=

i∈Jt

Xi ,

i∈Jt∗

Ht := H[Xt∗ ],

Vt∗ :=

[

Vi ,

i∈Jt∗

Gt := G∗ [Vt∗ ].

[

Ckt ,

k∈[t−1]0

Ct∗ :=

[

Cℓ ,

ℓ∈[t]0

Note that Xt∗ contains X0 and Vt∗ contains V0 for all t ∈ [T ]0 . Moreover, X0∗ = X0 = X0 , V0∗ = V0 = V0 ,
and C0∗ = C0 = ∅. After round t, we want to have embedded Ht into Gt , only using colours from Ct∗ .
Given a partial embedding of H into G∗ , an edge of G∗ is called used if it is the image of an edge of H,
and a colour is called used if some edge is used on which this colour appears.
A bijection φ : Xt∗ → Vt∗ is valid if φ↾X0 = φ0 and for all j ∈ Jt∗ and all x ∈ Xj , we have φ(x) ∈ NAj (x).
0
In particular, this implies that φ(Xj ) = Vj for all j ∈ Jt∗ .
The following claim ensures that edges which are embedded in different rounds have automatically
distinct colours. Moreover, it also ensures that the edges embedded at one vertex in the same round
have distinct colours.
Claim 1: Let t ∈ [T ]0 and suppose that φ : Ht → Gt is a valid embedding. Then φ uses only colours
from Ct∗ . Moreover, for all z ∈ Xk , v ∈ Vk with zv ∈ E(Ak ) and ℓ := ψ(k) > t and all distinct x, y ∈
NH (z)∩Xt∗ such that φ(x)v, φ(y)v ∈ E(G∗ ), we have c(φ(x)v), c(φ(y)v) ⊆ Cℓ and c(φ(x)v)∩c(φ(y)v) = ∅.

Proof of claim: To prove the first part of the claim, assume that vw ∈ E(Gt ). Thus, there are unique
i, j ∈ Jt∗ with ij ∈ Et1 t2 such that v ∈ Vi and w ∈ Vj . By (5.10), we have c(vw) ⊆ Ct1 t2 . Since i, j ∈ Jt∗ ,
we have t1 , t2 ≤ t and thus Ct1 t2 ⊆ Ct∗ , as claimed.
1The ‘0’ in Aj refers to the fact that these graphs are candidacy graphs after round 0. Later we will also define Aj for
t
0

t ≥ 1.

21

To prove the second part of the claim, suppose that z, v, ℓ, k, x, y are as in the statement. There are
unique i, j ∈ Jt∗ with x ∈ Xi and y ∈ Xj . Let ℓ1 := ψ(i) and ℓ2 := ψ(j). Without loss of generality,
assume that ℓ1 ≤ ℓ2 ≤ t < ℓ. By (5.10), we have that c(φ(x)v) ⊆ Cℓ1 ℓ and c(φ(y)v) ⊆ Cℓ2 ℓ . If
ℓ1 6= ℓ2 , then Cℓ1 ℓ and Cℓ2 ℓ are disjoint subsets of Cℓ , and the claim follows. If i, j > 0, this implies that
ik, jk ∈ E(R) and we can conclude that ℓ1 6= ℓ2 by definition of ψ. If i = 0 and j > 0, we have ℓ1 = 0
and ℓ2 > 0.
The remaining case is when x, y ∈ X0 . But then, since zv ∈ E(Ak ), we have c(φ(x)v) ∩ c(φ(y)v) = ∅
−
by (EXC2) since φ0 feasible.
Given t ∈ [T ]0 and any bijection φ : Xt∗ → Vt∗ with φ↾X0 = φ0 (e.g. a valid embedding as above), we
define (for round t + 1) updated candidacy graphs for the clusters still to be embedded. Let j ∈ [r] \ Jt∗ .
For vertices x ∈ Xj and v ∈ Vj , we say that v is a candidate for x if xv ∈ E(Aj0 ) and for all y ∈ NH (x)∩Xt∗
we have that φ(y)v ∈ E(G∗ ).
Let Ajt be the bipartite auxiliary graph with bipartition (Xj , Vj ) and edge set
(5.12)

E(Ajt ) := {xv : x ∈ Xj , v ∈ Vj and v is a candidate for x}.

Note that Ajt depends on the specific choice of φ. We might write Ajt (φ) to indicate this dependency,
but will just write Ajt if φ is clear from the context. Note that Aj0 (φ0 ) = Aj0 by (5.11).
We will prove by induction that the following statement S(t) holds for all t ∈ [T ]0 .

S(t). There exists a valid rainbow embedding φt : Ht → Gt such that for all j ∈ [r] \ Jt∗ , the candidacy
graph Ajt (φt ) is (εt , dj )-super-regular for some dj ≥ d′t+1 .

The instance S(0) holds since the graphs (Aj0 )j∈[r] are (ε0 , d′ )-super-regular. The instance S(T ) completes
the proof since then φT is a valid rainbow embedding of H into G.
Step 4: The inductive step
Now, assume the truth of S(t) for some t ∈ [T − 1]0 , and let φt be as in S(t). We will extend φt to
∗
∗
φt+1 such that S(t + 1) holds. Any bijection σ : Xt+1 → Vt+1 induces a bijection φt+1 : Xt+1
→ Vt+1
which extends φt as follows:
(
φt (x) if x ∈ Xt∗ ,
φt+1 (x) :=
(5.13)
σ(x) if x ∈ Xt+1 .

We will choose σ as a perfect matchingSin a suitably defined bipartite graph with bipartition (Xt+1 , Vt+1 ).
The natural choice for this graph is i∈Jt+1 Ait . Indeed, if we pick for every x ∈ Xt+1 its image σ(x)
for x, we will obtain
among the neighbours of x in Ait , then, since every such neighbour v is a candidateS
a valid embedding of Ht+1 into Gt+1 . However, not every perfect matching σ in i∈Jt+1 Ait induces a
φt+1 which satisfies S(t + 1). For this, we also need to ensure that the embedding is rainbow, and that
the new candidacy graphs are again super-regular. In order to show that a suitable σ exists, we pick σ
randomly and show that the desired properties hold with positive probability. We will use Lemma 5.8
to show that φt+1 is rainbow (see Claim 2), and the Four graphs lemma (Lemma 5.6) to show that the
new candidacy graphs are again super-regular (see Claim 3).
WeSnow prepare the application of the Four graphs lemma by finding a suitable spanning subgraph
Ãt of i∈Jt+1 Ait of which we will pick the perfect matching σ uniformly at random. (The reason for the
transition to Ãt is to satisfy condition (5.8).)
Recall that for every ij ∈ E(R), the graph H[Xi , Xj ] is a perfect matching. For i, j ∈ V (R) with
ij ∈ E(R), we define the bijection πj→i : Xj → Xi where πj→i (x) is the unique H-neighbour of x in Xi .
−1
Clearly, πj→i
= πi→j .
∗
Let i ∈ Jt+1 . For j ∈ NR (i) \ Jt+1
, we define the new bipartite auxiliary graph Pij with bipartition
(Xi , Vj ), where xv ∈ Pij if and only if πi→j (x)v ∈ E(Ajt ). Clearly, Pij is isomorphic to Ajt by construction.
The reason for the definition of Pij is that it forms a super-regular triple with Ait and G∗ [Vi , Vj ] on vertex
set Xi ∪· Vi ∪· Vj (cf. Figure 1). We would like to apply the Four graphs lemma with Ait , Pij , and G∗ [Vi , Vj ]
playing the roles of G1,2 , G1,3 , and G2,3 , respectively. However, in order to satisfy condition (5.8), we
define Ãit as the spanning subgraph of Ait which contains only those edges xv ∈ E(Ait ), x ∈ Xi , v ∈ Vi ,
∗
that satisfy the following: for all j ∈ NR (i) \ Jt+1
, we have
(5.14)

|NP j (x) ∩ NG∗ [Vi ,Vj ] (v)| = (dj d′ ± εt )n/r.
i

22

S. GLOCK AND F. JOOS

By Proposition 5.7, we still have that for every i ∈ Jt+1 ,
√
(5.15)
Ãit is (2∆ εt , di )-super-regular.
Now, define
(5.16)

Ãt :=

[

Ãit .

i∈Jt+1

Choose σ uniformly at random among all perfect matchings of Ãt . We will show that with positive
probability, φt+1 as defined in (5.13) satisfies S(t + 1), which then completes the proof.
Note first that the graphs (Ãit )i∈Jt+1 are all vertex-disjoint. In particular, every perfect matching σ
of Ãt is the union of |Jt+1 | perfect matchings σi : Xi → Vi , where σi is a perfect matching in Ãit . In
particular, every choice of σ yields a φt+1 which is valid. Moreover, a simple but crucial observation is
that since σ is chosen uniformly at random, each σi is a uniformly random perfect matching of Ãit .
In order to make sure that φt+1 is a rainbow embedding, we define a suitable system of conflicts
for Ãt and then use Lemma 5.8 to obtain a lower bound on the probability that σ is conflict-free.
We will subsequently use this lower bound in a union bound, hence a mere existence result would not
be sufficient here. Consider xv ∈ E(Ãt ) with x ∈ Xt+1 , v ∈ Vt+1 . There is a unique i ∈ Jt+1 with
xv ∈ E(Ãit ), i.e. x ∈ Xi , v ∈ Vi . Let
Fxv := {φt (y)v : y ∈ NH (x) ∩ Xt∗ }.

By definition of Ait , we have that Fxv ⊆ E(G∗ ). In particular, Fxv is the set of edges of G∗ which is used
in the embedding of H if x is mapped to v. For our embedding to be rainbow, we clearly need that the
colour sets (c(e))e∈Fxv of the edges in Fxv are pairwise disjoint, and disjoint from the set of colours used
to embed Ht . That this is the case follows from Claim 1. Recall from Claim 1 that the embedding of
Ht only uses colours from Ct∗ . Moreover, since ψ(i) = t + 1 > t, the second part of Claim 1 implies that
the sets (c(e))e∈Fxv are pairwise disjoint subsets of Ct+1 . Recall that Ct+1 ∩ Ct∗ = ∅. Let
[
Zxv :=
c(e)
e∈Fxv

be the set of all colours which appear on the edges in Fxv (cf. Figure 1). By the above, Zxv ⊆ Ct+1 . We
define a system of conflicts F for E(Ãt ) as follows: two edges xv, x′ v ′ ∈ E(Ãt ) conflict, i.e. {xv, x′ v ′ } ∈ F ,
if and only if Zxv ∩Zx′ v′ 6= ∅. Hence, if σ is a conflict-free perfect matching of Ãt , then φt+1 : Ht+1 → Gt+1
is a valid rainbow embedding.
1/3

Claim 2: The probability that σ is conflict-free is at least e−µ

n

.

2

Proof of claim: We first claim that F is 4µ∆ n-bounded. Fix any edge xv ∈ E(Ãt ). Clearly, |Zxv | ≤ 2∆2
since dH (x, Xt∗ ) ≤ 2∆ and c is (µn, ∆)-bounded. Fix a colour α ∈ Zxv . Note that if α ∈ Zx′ v′ , where
x′ ∈ Xt+1 , v ′ ∈ Vt+1 and x′ v ′ ∈ E(Ãt ), then α was forced on x′ v ′ by some edge v ′ v ′′ ∈ E(G∗ ) with
−1 ′′
′′ ′
′ ′′
′′
∗
′′
v ′′ ∈ Vt∗ , φ−1
t (v )x ∈ E(H) and α ∈ c(v v ). Note that if v ∈ Vt \ V0 , then x := φt (v ) ∈ V (H) \ X0
satisfies dH (x′′ , Xt+1 ) = 1 by definition of ψ. Thus, v ′ v ′′ forces α on at most one edge x′ v ′ ∈ E(Ãt ).
Since there are at most µn edges v ′ v ′′ with α ∈ c(v ′ v ′′ ), we conclude that α is forced on at most µn edges
′′
x′ v ′ ∈ Ãt in this way. On the other hand, if v ′′ ∈ V0 , then v ′ v ′′ forces α on at most dH (φ−1
0 (v ), Xt+1 ) ≤
−1 ′′
′ ′
α
′′
′
dH (φt (v )) edges x v ∈ Ãt . Since there are at most dG (v ) vertices v in Vt+1 such that α ∈ c(v ′ v ′′ ),
the total number of edges x′ v ′ ∈ Ãt on which α is forced by some v ′ v ′′ with v ′′ ∈ V0 , can be bounded
from above by
X

v ′′ ∈V0

−1 ′′
′′
dα
G (v ) · dH (φ0 (v ), Xt+1 ) ≤

X

x′′ ∈X0

′′
′′
dα
G (φ0 (x )) · dH (x )

(EXC3)
≤
µn.

Therefore, α appears on at most 2µn edges in Ãt and hence F is 4µ∆2 n-bounded.
By (5.15) and Proposition 5.9 (applied for each i ∈ Jt+1 ), there exists a perfect matching of Ãt .
Let M be any perfect matching of Ãt , and e ∈ M . We need to show that there are many (e, M )switchable edges. Suppose that e ∈ E(Ãit ) for i ∈ Jt+1 . Let Mi be the perfect matching of Ãit induced
by M . Clearly, every (e, Mi )-switchable edge is also (e, M )-switchable. By (5.15), we have that Ãit is
√
√
(2∆ εt , di )-super-regular. By Proposition 5.9 (with n/r, 2∆ εt , d′t+1 playing the roles of n, ε, d), there
′3(t+1)
are at least d 2 (n/r)2 edges in Ãit that are (e, Mi )-switchable, and thus (e, M )-switchable.
Hence, by Lemma 5.8 (with |Jt+1 |n/r, 4µr∆2 /|Jt+1 |, d′3(t+1) /2|Jt+1 |2 playing the roles of n, µ, γ), the
1/3
probability that σ is conflict-free is at least e−µ n .
−

23

x′

Xj

Xi

Xi′′

Xi′
x′′

πi→j

x

H
πj→i

Ãit
φt

φt

φ(x′ )

φ(x′′ )

σi

β

Pij

{α, β}

Ajt → Ajt+1

G∗ [Vi , Vj ]

v

G∗

α
Vj

Vi

Vi′′

Vi′

Figure 1. A sketch of the induction step. Here, i ∈ Jt+1 , that is, the cluster Xi in the middle is
currently embedded into Vi by choosing a random perfect matching σi in the candidacy graph Ãit . To
the left, we have clusters that are already embedded, so i′ , i′′ ∈ Jt∗ . The edge xv receives all colours from
edges from v to already embedded neighbours of x. This produces a conflict system for Ãit . To the right,
∗ . The current candidacy
we have a cluster which will be embedded in a later round, so j ∈ [r] \ Jt+1
graph Ajt is projected using the perfect matching H[Xi , Xj ]. The random choice of σi produces a
subgraph Pij (σi ) of this projected candidacy graph Pij , which translates back to the new candidacy
graph Ajt+1 for (Xj , Vj ).

It remains to show that with high enough probability, the updated candidacy graphs Ajt+1 are superregular. For this, we use the Four graphs lemma.
∗
Claim 3: For all j ∈ [r] \ Jt+1
, with probability at least 1 − (1 − a)n/r , the candidacy graph Ajt+1 is
′′
(εt+1 , d )-super-regular for some d′′ ≥ d′t+2 .

Proof of claim: Crucially, Ajt+1 only depends on (at most) one of the σi . Consider x ∈ Xj and v ∈ Vj .
Observe first that by (5.12) and (5.13), we have xv ∈ E(Ajt+1 (φt+1 )) if and only if xv ∈ E(Ajt (φt )) and
σ(y)v ∈ E(G∗ ) for all y ∈ NH (x) ∩ Xt+1 . Recall that j has at most one R-neighbour in Jt+1 . If j has no
such neighbour, then Ajt+1 = Ajt and thus there is nothing to prove. Assume now that i is the unique
R-neighbour of j in Jt+1 . Thus, πj→i (x) is the unique H-neighbour of x in Xt+1 . We conclude that
xv ∈ E(Ajt+1 ) if and only if xv ∈ E(Ajt ) and σi (πj→i (x))v ∈ E(G∗ ). Thus, Ajt+1 only depends on σi .
Moreover, recalling the definition of Pij , we have that
xv ∈ E(Ajt+1 )

(5.17)

⇔

πj→i (x)v ∈ E(Pij ) and σi (πj→i (x))v ∈ E(G∗ ).

· j . Recall that σi : Xi → Vi is a uniformly
· i ∪V
Consider the triple (Ãit , Pij , G∗ [Vi , Vj ]) on vertex set Xi ∪V
random perfect matching of Ãit . Define Pij (σi ) as the spanning subgraph of Pij which contains all edges
x′ v ∈ E(Pij ), with x′ ∈ Xi , v ∈ Vj , for which σi (x′ )v ∈ E(G∗ [Vi , Vj ]). (Thus, Pij (σi ) is the graph Aσ
defined in the Four graphs lemma.) By (5.17), Pij (σi ) is isomorphic to Ajt+1 .
√
By (5.15), Ãit is (2∆ εt , di )-super-regular. Moreover, by S(t), Pij (which is isomorphic to Ajt ) is
(εt , dj )-super-regular. Also, recall that G∗ [Vi , Vj ] is (ε0 , d′ )-super-regular. Finally, condition (5.8) is
satisfied by (5.14). Therefore, we can apply the Four graphs lemma (Lemma 5.6) as follows:
n/r
n

a
a

1/3

εt
ε

εt+1
ε′

Ãit
G1,2

Pij
G1,3

G∗ [Vi , Vj ]
G2,3

di
d1,2

dj
d1,3

d′
d2,3

σi
σ

Pij (σi )
Aσ

With probability at least 1 − (1 − a)n/r , the graph Pij (σi ) (and thus Ajt+1 ) is (εt+1 , dj d′ )-super-regular.
Note that dj d′ ≥ d′t+2 , as required.
−
Using a union bound, it follows from Claims 2 and 3 that with probability at least
1/3

e−µ

n

− r(1 − a)n/r > 0,

σ has the property that φt+1 satisfies S(t + 1). This completes the proof.



24

S. GLOCK AND F. JOOS

6. Applications
6.1. Rainbow spanning trees in Dirac graphs. Although the following result is implied by the
rainbow bandwidth theorem which we prove in the next subsection, we state and prove it here to
illustrate an easy application of our blow-up lemma.
Theorem 6.1. Suppose 1/n ≪ µ ≪ δ, 1/∆. Suppose G is a graph on n vertices such that δ(G) ≥
(1/2 + δ)n. Then, given any µn-bounded edge colouring of G, the graph G contains any tree T on n
vertices with ∆(T ) ≤ ∆ as a rainbow subgraph.
Komlós, Sárközy and Szemerédi [29] proved this result in the non-rainbow setting even before the
development of the blow-up lemma (some of the ideas which later led to the blow-up lemma were already
present there). With a blow-up lemma at hand, the proof becomes much shorter. It essentially boils
down to distributing the vertices of T evenly among the clusters of the regularity partition, with the
reduced graph being a Hamilton cycle. For this, we need the following result, which essentially appears
in [23] and uses the fact that the symmetric Markov chain on an odd cycle mixes rapidly.
Lemma 6.2 ([23]). Suppose 1/n ≪ 1/r, 1/∆ and r is odd. Suppose T is a tree on n vertices with
∆(T ) ≤ ∆. Then there is a partition (Xi )i∈[r] of V (T ) such that

(i) the endvertices of any edge of T lie in two consecutive sets Xi , Xi+1 (where Xr+1 is identified
with X1 ),
(ii) |Xi | = n/r ± n/ log2 n for all i ∈ [r], and
(iii) for every i ∈ [r], the vertex set Xi+1 contains at least 2−∆−3 n/r vertices v ∈ V (T ) such that
NT (v) ⊆ Xi .

We remark here that for a cycle on n vertices it is easy to find a vertex decomposition as described
in Lemma 6.2. As the following proof only uses these properties of T and the fact that ∆(T ) ≤ ∆, (the
proof of) Theorem 6.1 also implies the existence of a rainbow Hamilton cycle under the same assumptions
on G.
Proof of Theorem 6.1. Let G and T be as in the statement; in particular, we assume that some
µn-bounded edge colouring of G is given. Choose new constants ε, d such that µ ≪ ε ≪ d ≪ δ, 1/∆. We
apply the regularity lemma to G and obtain a vertex partition (Vi )i∈[r]0 such that
• |V1 | = . . . = |Vr | for some odd r (we may assume µ ≪ 1/r ≪ ε),
• |V0 | ≤ εn, and
• for every i ∈ [r] and for all but at most εr integers j ∈ [r] \ {i}, the graph G[Vi , Vj ] is ε-regular.

Let R be the graph with vertex set [r] where two vertices i, j ∈ [r] are joined by an edge if G[Vi , Vj ] is
lower (ε, d)-regular. As δ(G) ≥ (1/2 + δ)n, it is not hard to see that δ(R) ≥ (1/2 + δ/2)r. Hence R
contains a Hamilton cycle C. Without loss of generality, we may assume that 1, 2, . . . , r appear in this
order on C. Below we always identify vertex sets Sr+1 with S1 .
By Fact 5.5, one can remove at most 2εn/r vertices from every Vi (call the new vertex sets Vei′ ) such
′
that G[Vei′ , Vei+1
] is lower (4ε, d)-super-regular for all i ∈ [r]. For purposes that will become clear below,
we remove even more vertices. So let us remove from every Vi exactly ε1/2 n/r vertices (in total) and
′
add them to V0 (call the new vertex sets Vi′ ) such that G[Vi′ , Vi+1
] is lower (2ε1/2 , d)-super-regular for
′
′
all i ∈ [r] (where Vr+1 := V1 ). We claim that

(i) ε1/2 n ≤ |V0′ | ≤ (ε1/2 + ε)n,
(ii) for every vertex v ∈ V0′ , there are at least (1/2 + δ/2)r integers i ∈ [r] such that v has at least
dn/2r neighbours in Vi′ , and
(iii) for every i ∈ [r], there are at least (1/2 + δ/3)|V0′ | vertices in V0′ that have at least dn/2r
neighbours in Vi′ .

Indeed, (i) is trivial. To see (ii), consider v ∈ V0′ . Clearly, v has at most |V0′ | ≤ 2ε1/2 n neighbours in
V0′ and at most dn neighbours in clusters Vi′ in which v has less than dn/2r neighbours. As d ≪ δ and
δ(G) ≥ (1/2 + δ)n, statement (ii) follows. To see (iii), we fix some i ∈ [r] and let j ∈ NR (i). As G[Vi , Vj ]
is lower (ε, d)-regular, among the ε1/2 n/r vertices we moved from Vj to V0 , at least (ε1/2 − 2ε)n/r have
at least (d − ε)|Vi | ≥ dn/2r neighbours in Vi by Fact 5.5. Now (iii) follows as dR (i) ≥ (1/2 + δ/2)r and
by (i).
Next we apply Lemma 6.2 to T and obtain a vertex partition (Xi )i∈[r] of V (T ) such that the endvertices
of every edge lie in consecutive parts (modulo r) and |Xi | = n/r ± n/ log2 n for all i ∈ [r]. Moreover,
Xi+1 contains at least 2−∆−3 n/r vertices such that all their neighbours lie in Xi ; among those vertices we

25

bi+1 of size exactly |Xi+1 | − |V ′ |. For all i ∈ [r], since |Xi | = n/r ± n/ log2 n
select a 2-independent set X
i+1
′
1/2
and |Vi | = (1 − ε ± ε)n/r, we have that
bi | = (1 ± δ/10)ε1/2 n/r.
|X

(6.1)

bi . Hence |X ′ | = |V ′ |.
Let Xi′ := Xi \ X
i
i
′
b
br . It is easy to see that X ′ is 2-independent and |V ′ | = |X ′ |. We wish to
Let X0 := X1 ∪ · · · ∪ X
0
0
0
apply the rainbow blow-up lemma to the blow-up instance (T, G, C, (Xi′ )i∈[r]0 , (Vi′ )i∈[r]0 ). Before, we
need to find a feasible partial embedding φ0 : X0′ → V0′ and define appropriate candidacy graphs for the
remaining vertices. Next, we want to match the vertices in V0′ and X0′ such that whenever v ∈ V0′ is
bi+1 , the vertex v has at least dn/2r neighbours in V ′ . To this end, let H be the
matched to x ∈ X
i
bi+1 whenever dG (v, V ′ ) ≥ dn/2r. By
bipartite graph with bipartition (V0′ , X0′ ) and join v ∈ V0′ , x ∈ X
i
(iii), we have dH (x) ≥ (1/2 + δ/3)|V0′ | for all x ∈ X0′ . Moreover, for all v ∈ V0′ , we have
(ii),(6.1)

dH (v)

≥

(i)

(1/2 + δ/2)r · (1 − δ/10)ε1/2 n/r ≥ (1/2 + δ/3)|V0′ |.

Clearly, by Hall’s theorem, H contains a perfect matching φ0 : X0′ → V0′ .
Now, consider i ∈ [r]. We need to define a suitable candidacy graph Ai . Note that at most 2∆ε1/2 |Xi′ |
vertices of Xi′ have a neighbour in X0′ . For these vertices we have to restrict their candidate set. Now
bi+1 . We
suppose that x ∈ Xi′ has a (unique) neighbour x′ in X0′ . Observe that we must have x′ ∈ X
′
′
define NAi (x) := NG (φ0 (x ), Vi ). By definition of H, we have that |NAi (x)| ≥ dn/2r. For the vertices
x ∈ Xi′ \ NT (X0′ ), we can define NAi (x) := Vi′ . Thus, Ai is lower (ε1/3 , d/2)-super-regular. Moreover, we
have met condition (EXC1), and since X0′ is 2-independent, φ0 is 2∆µn-feasible. Thus, since the blow-up
instance (T, G, C, (Xi′ )i∈[r]0 , (Vi′ )i∈[r]0 ) with candidacy graphs (Ai )i∈[r] is lower (ε1/3 , d/2)-super-regular,
an application of the rainbow blow-up lemma (Lemma 5.1) yields a rainbow embedding of T into G.

6.2. Rainbow bandwidth theorem. In this subsection, we apply the rainbow blow-up lemma to prove
a rainbow bandwidth theorem (Theorem 1.2). Due to the proof in [9] being carried out in a very modular
way, we can directly make use of important parts of the original proof. In fact, Böttcher, Schacht and
Taraz [9] proved a slightly more general result (and so do we). As mentioned earlier, the minimum degree
threshold in the bandwidth theorem is in general not optimal. For example, if H is a Hamilton cycle and
n is odd, then χ(H) = 3, yet δ(G) ≥ n/2 already suffices to find H. Roughly speaking, this is because
H is essentially 2-colourable, except that we need an additional colour for one vertex. This motivates
the following definition. Suppose the vertex set of H is [n]. For ℓ, x, y ∈ N, we say an (ℓ + 1)-colouring
σ : V (H) → [ℓ]0 of H is (x, y)-zero free if for each t ∈ [n], there exists a t′ with t ≤ t′ ≤ t + x such that
σ(u) 6= 0 for all u ∈ [t′ , t′ + y].
The following theorem can provide the optimal threshold for such graphs H, for example if H is the
(ℓ − 1)-st power of a Hamilton cycle. We remark however that it does not always yield the optimal
threshold, e.g. for C5 -factors the optimal threshold is 3/5 (cf. [34]).
Theorem 6.3. Suppose 1/n ≪ µ, β ≪ δ, 1/∆, 1/ℓ. Let H be a graph on vertex set [n] with ∆(H) ≤ ∆.
Assume that H has an (ℓ + 1)-colouring that is (8ℓβn, 4ℓβn)-zero free and uses colour 0 at most βn
times. Also assume that max{|i − j| : ij ∈ E(G)} ≤ βn. Suppose G is a graph on n vertices with
δ(G) ≥ (1 − 1/ℓ + δ)n. Then, given any µn-bounded edge colouring of G, there is a rainbow copy of H
in G.
Obviously Theorem 6.3 implies Theorem 1.2, and the remaining part of this section is devoted to
the proof of Theorem 6.3. Its proof in [9] without the rainbow condition is based on three results, the
so-called ‘Lemma for G’, ‘Lemma for H’ and ‘partial embedding lemma’ (see Lemmas 6, 8 and 9 in [9]).
The first two are strong structural decomposition results for G and H, respectively, which prepare the
application of the blow-up lemma and require the main part of the work done in [9]. Fortunately, for the
proof of Theorem 6.3 we can use the Lemmas for G and H without any alterations.
The partial embedding lemma deals with a very small set of exceptional vertices that cannot be
handled by the blow-up lemma directly. In [9], this is by far the easiest part and follows by standard
techniques. However, it does not easily translate to the rainbow setting and hence we give a proof later in
this section using the methods developed in this paper. We now state the partial embedding lemma for
the rainbow setting, which replaces Lemma 9 from [9]. Roughly speaking, it yields a rainbow embedding
φ of a small exceptional set X such that every outside neighbour y ∈ Y := NH (X) \ X of vertices in X
still has a large candidate set (and will later be embedded by the blow-up lemma).

26

S. GLOCK AND F. JOOS

Lemma 6.4. Suppose 1/n ≪ µ, ε ≪ d′ ≪ d, 1/∆ and µ ≪ 1/r. Suppose R is a graph on [r]. Suppose G
is a graph on n vertices with vertex partition (Vi )i∈[r] such that G[Vi , Vj ] is lower (ε, d)-regular whenever
ij ∈ E(R) and |Vi | = (1 ± ε)n/r. Suppose H is a graph on at most εn/r vertices with vertex partition
(X1 , . . . , Xr , Y1 , . . . , Yr ) such that ∆(H) ≤ ∆ and Zi := Xi ∪ Yi is an independent set for all i ∈ [r].
Moreover, whenever zi zj ∈ E(H) with zi ∈ Zi , zj ∈ Zj , then ij ∈ E(R). Let X := X1 ∪ . . . ∪ Xr and
Y := Y1 ∪ . . . ∪ Yr . Given any µn-bounded edge colouring c : E(G) → C of G, there exists a set of colours
C ′ ⊆ C, a rainbow embedding φ : H[X] → GC\C ′ and candidate sets Sy ⊆ Vi for all y ∈ Yi and i ∈ [r]
such that the following hold:
(i) φ(Xi ) ⊆ Vi for all i ∈ [r];
(ii) for all y ∈ Y , we have |Sy | ≥ d′ n/r and for all x ∈ NH (y) ∩ X we have Sy ⊆ NGC ′ (φ(x));
(iii) for all y ∈ Y , all distinct x, x′ ∈ NH (y) ∩ X and all v ∈ Sy , we have c(φ(x)v) 6= c(φ(x′ )v).
With the Lemmas for G and H at hand, the proof of Theorem 6.3 without the rainbow condition
works verbatim also for Theorem 6.3, by replacing the partial embedding lemma with the rainbow partial
embedding lemma and the blow-up lemma with the rainbow blow-up lemma. We provide a proof for
completeness, but focus on the differences to the original proof. For integers r, ℓ, let Kℓr denote the
vertex-disjoint union of r cliques of order ℓ. This will be a spanning subgraph of the reduced graph R
indicating super-regular pairs, and the blow-up lemma will be applied with reduced graph Kℓr . In [9], Kℓr
is found within R inside a so-called ‘backbone’, that is, the ℓ-cliques in Kℓr form a sequence where two
consecutive cliques are joined almost completely in R. The purpose of this backbone is to allow changing
the cluster sizes Vi in G slightly to match the cluster sizes of the H-partition given by the Lemma for H.
Proof of Theorem 6.3.
hierarchy of parameters

Choose new constants d, d′ , ε, ξ, r′ , r′′ such that we have the following

1/n ≪ µ, β ≪ ξ ≪ 1/r′′ ≪ 1/r′ ≪ ε ≪ d′ ≪ d ≪ δ, 1/∆, 1/ℓ.
Suppose now that G and H are as in the statement. In exactly the same way as in [9], we first use the
structural results for G (Lemma 6 in [9]) and H (Lemma 8 in [9]), respectively, to obtain a partition
(Vi )i∈[ℓr] of V (G), a partition (Xi ∪ Xi′ )i∈[ℓr] of V (H) and a graph R on [ℓr] for some r′ ≤ r ≤ r′′ such
that the following hold:
S
(i) | i∈[ℓr] Xi′ | ≤ ξn;
n
for all i ∈ [ℓr];
(ii) |Xi ∪ Xi′ | = |Vi | = (1 ± ξ) ℓr
r
(iii) R contains a Kℓ -factor Kℓ such that G[Vi , Vj ] is lower (ε, d)-regular for all ij ∈ E(R) and even
lower (ε, d)-super-regular if ij ∈ E(Kℓr );
(iv) for all xy ∈ E(H) with x ∈ Xi ∪ Xi′ and y ∈ Xj ∪ Xj′ , we have ij ∈ E(R), and moreover we have
ij ∈ Kℓr if x ∈ Xi and y ∈ Xj .
For the first time, we need to make an easy amendment for the rainbow setting. Let c : E(G) → C
be any µn-bounded edge colouring. Note that we may assume that |C| ≤ 3µ−1 n, say. (Otherwise, there
would be two colour classes with combined size at most µn and we could merge them.) We split the colour
set C into two sets C1 , C2 such that GCi has still R as a reduced graph and all lower (super-)regular
pairs halve their
S density. This can be achieved with Lemma 4.1.
Let X0 := i∈[ℓr] Xi′ . Next we use the (rainbow) partial embedding lemma (Lemma 6.4 instead of
Lemma 9 in [9]), with X0 , NH (X0 ) \ X0 , H[X0 ∪ NH (X0 )] playing the roles of X, Y, H, to obtain a set
C ′ ⊆ C1 , a rainbow embedding φ0 : H[X0 ] → GC1 \C ′ and a candidate set Sy for each y ∈ NH (X0 ) \ X0
such that the following hold:
(a) φ0 (Xi′ ) ⊆ Vi for all i ∈ [ℓr];
(b) for all y ∈ NH (X0 ) \ X0 with y ∈ Xi for some i ∈ [ℓr], we have Sy ⊆ Vi and |Sy | ≥ d′ n/ℓr, and
for all x ∈ NH (y) ∩ X0 , we have Sy ⊆ NGC ′ (φ0 (x));
(c) for all y ∈ NH (X0 ) \ X0 , all distinct x, x′ ∈ NH (y) ∩ X0 and all v ∈ Sy , we have c(vφ(x)) 6=
c(vφ(x′ )).
Let V0′ := φ0 (X0 ) and Vi′ := Vi \ V0 for all i ∈ [ℓr]. By (a), we have |Vi′ | = |Xi | for all i ∈ [ℓr]. Let
′
H := H − H[X0 ].
Now we want to use the rainbow blow-up lemma to embed H ′ into GC2 ∪C ′ . As a blow-up instance
we use (H ′ , GC2 ∪C ′ , Kℓr , (Xi )i∈[ℓr]0 , (Vi′ )i∈[ℓr]0 ) with the obvious candidacy graphs, where the candidate
set of y ∈ NH (X0 ) \ X0 is Sy and there are no restrictions for other vertices. From (b), (c) and the fact
that ∆(H) ≤ ∆, we conclude that φ0 is 2∆µn-feasible. Thus, Lemma 5.1 yields a rainbow embedding φ
of H ′ into GC2 ∪C ′ which extends φ0 . Since φ0 and φ use distinct colours, this is a rainbow embedding
of H, completing the proof.


27

It remains to prove Lemma 6.4, for which we need the following straightforward consequence of
Lemma 5.8 and Proposition 5.9.
Corollary 6.5. Suppose
S 1/n ≪ µ, ε ≪ d and µ ≪ 1/r. Let V1 , . . . , Vr be disjoint vertex sets such that
|V | = n, where V := i∈[r] Vi , and n/(2r) ≤ |Vi | ≤ 2n/r for all i ∈ [r]. Suppose X1 , . . . , Xr are disjoint
S
vertex sets such that |Xi | ≤ εn/r for all i ∈ [r]. Let X := i∈[r] Xi . Suppose G is a bipartite graph
with vertex partition (X, V ) and suppose every edge in G joins Xi and Vi for some i ∈ [r]. Suppose
that dG (x) ≥ dn/r for all x ∈ X. Then, given any µn-bounded system of conflicts for G, there is a
conflict-free matching covering X.
Proof. Define a supergraph G′ of G on 2n vertices as follows.SFirst we add to every set Xi exactly
|Vi | − |Xi | new vertices and call the new set Xi′ . Let X ′ := i∈[r] Xi′ . Next, we join every vertex
x ∈ Xi′ \ Xi to all vertices in Vi . It is easy to see that G′ [Xi′ , Vi ] is lower (4ε, d/2)-super-regular for all
i ∈ [r]. Every conflict system of G easily transfers to a conflict system of G′ .
Observe that by Proposition 5.9, for every i ∈ [r], the graph G′ [Xi′ , Vi ] has a perfect matching, and
thus G′ has one. In addition, for every perfect matching M of G′ and every edge e ∈ M , there are
at least d3 /9 · n2 /(4r2 ) edges that are (e, M )-switchable. Hence, Lemma 5.8 implies the existence of a
conflict-free perfect matching M ′ in G′ . Let M ⊆ M ′ be the matching obtained by deleting all edges
incident to X ′ \ X. Consequently, M is a conflict-free matching of G covering X.

The following proof is reminiscent of our main proof in Section 5.4 in that we proceed in rounds and
reserve exclusive colours for each round. It is much simpler though since we only need to embed a small
fraction of all vertices.
Proof of Lemma 6.4. As ∆(H) ≤ ∆, we can colour H 2 with T := ∆2 + 1 colours. Hence, there
exists a partition of X into sets X 1 , . . . , X T which are 2-independent in H. We define X T +1 := Y . We
will proceed in T rounds and embed in round t ∈ [T ] all vertices of X t , whilst keeping track of candidate
sets for the remaining vertices.

} such that GCt1 t2 [Vi , Vj ]
Beforehand, we apply Lemma 4.1 to partition C into sets {Ct1 t2 : t1 t2 ∈ [T +1]
2


[T +1]
t1 t2
ˆ
ˆ
is lower (2ε, d)-regular for all t1 t2 ∈
and all ij ∈ E(R), where d := d/ T +1
:=
2
2 . Define G
GCt1 t2 .
In the beginning we set Sz (0) := Vi for all i ∈ [r] and z ∈ Zi . We claim that after round t, we have
(a) a rainbow embedding φt of H t := H[X 1 ∪ · · · ∪ X t ] such that for every edge xy ∈ E(H t ) with
x ∈ X t1 and y ∈ X t2 , we have c(φt (xy)) ∈ Ct1 t2 ;
ˆ t · n/2r and Sz (t) ⊆ Vi \ φt (V (H t )) for all i ∈ [r] and z ∈ Zi \ V (H t );
(b) |Sz (t)| ≥ (d/2)
′
′′
′
(c) for all t ∈ [t], t′′ ∈ [T + 1] \ [t], and all x′ ∈ X t , x′′ ∈ NH (x′ ) ∩ X t , we have Sx′′ (t) ⊆
NGt′ t′′ (φt (x′ )).
Indeed, our claim is true for t = 0. Now let t > 0 and suppose it is true for t − 1. We first restrict the
candidate sets for the vertices in x ∈ X t slightly. Consider any x ∈ X t . By Fact 5.5, for all but at most
ε1/2 n/r vertices v ∈ Sx (t − 1), we have
(b)

(6.2)

ˆ · (d/2)
ˆ t−1 · n/2r.
ˆ · |Sx′ (t − 1)| ≥ 3d/4
dGtt′ (v, Sx′ (t − 1)) ≥ 3d/4
′

for all t′ > t and x′ ∈ NH (x) ∩ X t . Let Sx (t) be obtained from Sx (t − 1) by removing all those vertices
v ∈ Sx (t − 1) for which (6.2) does not hold for some t′ , x′ . This will ensure that (b) and (c) hold again
for the next step.
We now embed X t by picking for every x ∈ X t a suitable image from Sx (t). Let V := V (G). We
define a bipartite graph J with bipartition (X t , V \ φt−1 (V (H t−1 ))) and we join every x ∈ X t to all
vertices in Sx (t). To ensure that the new embedding is again rainbow, we define a system of conflicts
for E(J). For an edge xv ∈ E(J) with x ∈ X t and v ∈ Sx (t), let Fxv be the set of edges φt−1 (x′ )v
for x′ ∈ NH (x) ∩ V (H t−1 ). By (c), we have Fxv ⊆ E(G). Moreover, the colours of the edges in
′
Fxv are distinct as the sets X t are 2-independent. We let two distinct edges xv, x′ v ′ ∈ E(J) conflict
if c(Fxv ) ∩ c(Fx′ v′ ) 6= ∅. It is easy to see that this gives a µn-bounded conflict system. We apply
Corollary 6.5 and obtain a conflict-free matching σ : X t → V \ φt−1 (V (H t−1 )). Now, let φt be the
extension of φt−1 defined by φt (x) := σ(x) for all x ∈ X t . Observe that φt is a rainbow embedding of
H t with the properties required for (a).
′
Next we update the candidate sets Sx for all x ∈ X t with t′ > t. If x has no neighbour in X t we only
remove φt (X t ) from Sx (t − 1) to obtain Sx (t). If x′ ∈ X t is the neighbour of x (there is at most one for
every x), we define
Sx (t) := (Sx (t − 1) ∩ NGtt′ (σ(x′ ))) \ φt (X t ).

28

S. GLOCK AND F. JOOS

This automatically ensures that (c) holds again for t. Moreover, by (6.2) and since |X t | ≤ εn/r, we
ˆ · |Sx′ (t − 1)| − εn/r ≥ (d/2)
ˆ t · n/2r, hence (b) also holds for t.
deduce that |Sx (t)| ≥ 3d/4
S
Assume now that the claim holds for T . Let C ′ := t∈[T ] Ct,T +1 . By (a), φ := φT is a rainbow
embedding of H[X] into GC\C ′ . For all y ∈ Y , let Sy := Sy (T ). It remains to check that (i)–(iii) hold.
Clearly, (i) holds as we have Sz ⊆ Vi for all z ∈ Zi and all i ∈ [r] throughout the embedding. Since
ˆ T /2, we have |Sy | ≥ d′ n/r for all y ∈ Y by (b). Moreover, from (c) we deduce that for all y ∈ Y ,
d′ ≤ (d/2)
t ∈ [T ] and x ∈ NH (y) ∩ X t , we have Sy ⊆ NGt,T +1 (φ(x)). Since Gt,T +1 ⊆ GC ′ , this establishes (ii).
Finally, for all y ∈ Y , all distinct x, x′ ∈ NH (y)∩X and all v ∈ Sy , we have c(φ(x)v) 6= c(φ(x′ )v), i.e. (iii)
′
holds. Indeed, by the above, we have c(φ(x)v) ∈ Ct,T +1 and c(φ(x′ )v) ∈ Ct′ ,T +1 , where x ∈ X t , x′ ∈ X t .
′
Since we partitioned X into 2-independent sets, t and t are distinct and thus Ct,T +1 ∩ Ct′ ,T +1 = ∅. This
completes the proof.


7. Concluding remarks
We have proved a rainbow blow-up lemma for µn-bounded edge colourings and have used it to prove
a rainbow bandwidth theorem in this setting and to show that every bounded degree spanning graph
exists as a rainbow subgraph in quasi-random graphs of arbitrarily small fixed density. We conclude this
paper with the following remarks:
• In fact, our blow-up lemma applies to slightly more general systems of conflicts (see beginning
of Section 5), allowing for instance to obtain embeddings which are simultaneously rainbow with
respect to several given edge colourings. A natural question is whether a blow-up lemma still
holds for arbitrary µn-bounded conflict systems (as defined in Section 5.3). The bottleneck in
the current proof is that it relies on the colour splitting technique, which seems to be limited to
‘highly transitive’ conflict systems.
• Note that in order to guarantee a rainbow copy of a graph H with maximum degree ∆ in a
graph G of density d, the given edge-colouring of G needs to be dn/∆-bounded, as otherwise
there may be less than ∆n/2 different colours available. In particular, our theorems are optimal
up to the value of the constant µ. As noted before, the constant µ in our theorems is very small.
In particular, in an embedding obtained with the rainbow blow-up lemma, only a small fraction
of the colours available in G is used for the embedding. On the contrary, affirmative answers
to many open rainbow conjectures would imply that (almost) all colours need to be used. As
mentioned in Section 1, Kim, Kühn, Kupavskii and Osthus used the rainbow blow-up lemma
on a small random subset (of vertices and colours) to complete a partial embedding (even a
partial approximate decomposition), thus effectively using almost all colours. We expect further
applications in this direction.
• There has been some exciting progress towards rainbow decompositions of properly edge-coloured
complete graphs, for instance in [5, 42] it is shown that there are Ω(n) edge-disjoint rainbow
spanning trees in every properly edge-coloured Kn . For µn-bounded edge colourings, it might
be possible to achieve (approximate) rainbow decompositions for any prescribed collection of
bounded degree graphs. For instance, it was proved in [3] that for every µn-bounded edge
colouring of Kn,n , there is a decomposition into rainbow perfect matchings provided µ is small
enough and n is a power of 2. We conjecture that for any µn-bounded edge colouring of Kn , there
exists a decomposition into rainbow Hamilton cycles (provided n is odd). Similarly, we conjecture
Pt
that for any collection of n-vertex graphs H1 , . . . , Ht with bounded degree and i=1 e(Hi ) ≤
(1 − α)e(Kn ) and any µn-bounded edge colouring of Kn , where µ ≪ α, the graphs H1 , . . . , Ht
pack edge-disjointly into Kn such that each subgraph is rainbow. In the uncoloured setting, this
was proved in [28].
Acknowledgement
We are grateful to David Harris as well as Matthew Coulson and Guillem Perarnau for helpful discussions on their papers.
References
[1] M. Albert, A. Frieze, and B. Reed, Multicoloured Hamilton cycles, Electron. J. Combin. 2 (1995), Art. 10, 13 pages.
[2] N. Alon, A. Pokrovskiy, and B. Sudakov, Random subgraphs of properly edge-coloured complete graphs and long
rainbow cycles, Israel J. Math. 222 (2017), 317–331.
[3] N. Alon, J. Spencer, and P. Tetali, Covering with Latin transversals, Discrete Appl. Math. 57 (1995), 1–10.

29

[4] L.D. Andersen, Hamilton circuits with many colours in properly edge-coloured complete graphs, Math. Scand. 64
(1989), 5–14.
[5] J. Balogh, H. Liu, and R. Montgomery, Rainbow spanning trees in properly coloured complete graphs, arXiv:1704.07200,
2017.
[6] J. Balogh and T. Molla, Long rainbow cycles and Hamiltonian cycles using many colors in properly edge-colored
complete graphs, arXiv:1706.04950, 2017.
[7] F. Benzing, A. Pokrovskiy, and B. Sudakov, Long directed rainbow cycles and rainbow spanning trees, arXiv:1711.03772,
2017.
[8] J. Böttcher, Y. Kohayakawa, and A. Procacci, Properly coloured copies and rainbow copies of large graphs with small
maximum degree, Random Structures Algorithms 40 (2012), 425–436.
[9] J. Böttcher, M. Schacht, and A. Taraz, Proof of the bandwidth conjecture of Bollobás and Komlós, Math. Ann. 343
(2009), 175–205.
[10] P. Cano, G. Perarnau, and O. Serra, Rainbow spanning subgraphs in bounded edge-colourings of graphs with large
minimum degree, Electron. Notes Discrete Math. 61 (2017), 199–205.
[11] M. Coulson, P. Keevash, G. Perarnau, and L. Yepremyan, Rainbow factors in hypergraphs, arXiv:1803.10674, 2018.
[12] M. Coulson and G. Perarnau, Rainbow matchings in Dirac bipartite graphs, arXiv:1711.02916, 2017.
[13] B. Csaba, On the Bollobás-Eldridge conjecture for bipartite graphs, Combin. Probab. Comput. 16 (2007), 661–691.
[14] P. Erdős, J. Nešetřil, and V. Rödl, On some problems related to partitions of edges of a graph, Graphs and other
combinatorial topics, Teubner-Texte Math. 59, Teubner, 1983, pp. 54–63.
[15] A. Frieze and M. Krivelevich, On rainbow trees and cycles, Electron. J. Combin. 15 (2008), Art. 59, 9 pages.
[16] A. Frieze and B. Reed, Polychromatic Hamilton cycles, Discrete Math. 118 (1993), 69–74.
[17] G. Hahn and C. Thomassen, Path and cycle sub-Ramsey numbers and an edge-colouring conjecture, Discrete Math. 62
(1986), 29–33.
[18] A. Hajnal and E. Szemerédi, Proof of a conjecture of Erdős, In: Combinatorial Theory and its Applications II (P. Erdős,
A. Rényi, and V.T. Sós, eds.), North Holland, 1970, pp. 601–623.
[19] D.G. Harris and A. Srinivasan, Constraint satisfaction, packet routing, and the Lovász local lemma, STOC 2013,
ACM, 2013, pp. 685–694.
, The Moser-Tardos framework with partial resampling, FOCS 2013, IEEE Computer Soc., 2013, pp. 469–478.
[20]
, The Moser-Tardos framework with partial resampling, arXiv:1406.5943v3, 2018.
[21]
[22] P. Hatami and P.W. Shor, A lower bound for the length of a partial transversal in a Latin square, J. Combin. Theory
Ser. A 115 (2008), 1103–1113.
[23] F. Joos, J. Kim, D. Kühn, and D. Osthus, Optimal packings of bounded degree trees, J. Eur. Math. Soc. (to appear).
[24] N. Kamčev, B. Sudakov, and J. Volec, Bounded colorings of multipartite graphs and hypergraphs, European J. Combin. 66 (2017), 235–249.
[25] R.M. Karp, F.T. Leighton, R.L. Rivest, C.D. Thompson, U.V. Vazirani, and V.V. Vazirani, Global wire routing in
two-dimensional arrays, Algorithmica 2 (1987), 113–129.
[26] P. Keevash and L. Yepremyan, Linearly many rainbow trees in properly edge-coloured complete graphs,
arXiv:1710.03041, 2017.
[27] J. Kim, D. Kühn, A. Kupavskii, and D. Osthus, Rainbow structures in locally bounded colourings of graphs,
arXiv:1805.08424, 2018.
[28] J. Kim, D. Kühn, D. Osthus, and M. Tyomkyn, A blow-up lemma for approximate decompositions, Trans. Amer.
Math. Soc. (to appear).
[29] J. Komlós, G.N. Sárközy, and E. Szemerédi, Proof of a packing conjecture of Bollobás, Combin. Probab. Comput. 4
(1995), 241–255.
[30]
, Blow-up lemma, Combinatorica 17 (1997), 109–123.
, On the Pósa-Seymour conjecture, J. Graph Theory 29 (1998), 167–176.
[31]
[32]
, Proof of the Seymour conjecture for large graphs, Ann. Comb. 2 (1998), 43–60.
, Proof of the Alon-Yuster conjecture, Discrete Math. 235 (2001), 255–269.
[33]
[34] D. Kühn and D. Osthus, The minimum degree threshold for perfect graph packings, Combinatorica 29 (2009), 65–107.
[35]
, Hamilton decompositions of regular expanders: A proof of Kelly’s conjecture for large tournaments, Adv.
Math. 237 (2013), 62–146.
[36] L. Lu and L. Székely, Using Lovász local lemma in the space of random injections, Electron. J. Combin. 14 (2007),
Art. 63, 13 pages.
[37] C. McDiarmid, On the method of bounded differences, Surveys in combinatorics, London Math. Soc. Lecture Note Ser.
141, Cambridge Univ. Press, 1989, pp. 148–188.
[38] R. Montgomery, A. Pokrovskiy, and B. Sudakov, Decompositions into spanning rainbow structures, arXiv:1805.07564,
2018.
, Embedding rainbow trees with applications to graph labelling and decomposition, arXiv:1803.03316, 2018.
[39]
[40] R.A. Moser and G. Tardos, A constructive proof of the general Lovász local lemma, J. ACM 57 (2010), Art. 11,
15 pages.
[41] A. Pokrovskiy, An approximate version of a conjecture of Aharoni and Berger, arXiv:1609.06346, 2016.
[42] A. Pokrovskiy and B. Sudakov, Linearly many rainbow trees in properly edge-coloured complete graphs,
arXiv:1703.07301, 2017.
[43] V. Rödl and A. Ruciński, Perfect matchings in ǫ-regular graphs and the blow-up lemma, Combinatorica 19 (1999),
437–452.
[44] B. Sudakov and J. Volec, Properly colored and rainbow copies of graphs with few cherries, J. Combin. Theory Ser. B 122
(2017), 391–416.

Version 11th June 2018

30

Stefan Glock <s.glock@bham.ac.uk>
Felix Joos <f.joos@bham.ac.uk>
School of Mathematics
University of Birmingham
United Kingdom

S. GLOCK AND F. JOOS

