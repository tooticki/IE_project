arXiv:1510.05543v1 [math.AG] 19 Oct 2015

CRYSTALLINE COMPARISON ISOMORPHISMS IN p-ADIC
HODGE THEORY: THE ABSOLUTELY UNRAMIFIED CASE
FUCHENG TAN, JILONG TONG

Abstract. We construct the crystalline comparison isomorphisms for proper
smooth formal schemes over an absolutely unramified base. Such isomorphisms
hold for étale cohomology with nontrivial coefficients, as well as in the relative
setting, i.e. for proper smooth morphisms of smooth formal schemes. The
proof is formulated in terms of the pro-étale topos introduced by Scholze,
and uses his primitive comparison theorem for the structure sheaf on the proétale site. Moreover, we need to prove the Poincaré lemma for crystalline
period sheaves, for which we adapt the idea of Andreatta and Iovita. Another
ingredient for the proof is the geometric acyclicity of crystalline period sheaves,
whose computation is due to Andreatta and Brinon.

Contents
Notation
1. Introduction
2. Crystalline period sheaves
2.1. Period sheaves and their acyclicities
2.2. Period sheaves with connections
2.3. Frobenius on crystalline period sheaves
2.4. Comparison with de Rham period sheaves
3. Crystalline cohomology and pro-étale cohomology
3.1. A reminder on convergent F -isocrystals
b p -sheaves and filtered F -isocystals
3.2. Lisse Z
3.3. From pro-étale site to étale site
4. Primitive comparison on the pro-étale site
5. Comparison isomorphism in the relative setting
6. Appendix: geometric acyclicity of OBcris
6.1. Cohomology of OBcris
6.2. Cohomology of Filr OBcris
References

1
2
4
4
9
16
18
21
21
26
36
39
44
53
54
64
72

Notation
• Let p be a prime number.
• Let k be a p-adic field, i.e., a discretely valued complete nonarchimedean
extension of Qp , whose residue field κ is a perfect field of characteristic p.
(We often assume k to be absolutely unramified in this paper.)
1

2

FUCHENG TAN, JILONG TONG

b the p-adic completion
• Let k be a fixed algebraic closure of k. Set Cp := k
of k. The p-adic valuation v on Cp is normalized so that v(p) = 1. Write
the absolute Galois group Gal(k/k) as Gk .
• For a topological ring A which is complete with respect to p-adic topology,
let AhT1 , . . . , Td i be the PD-envelope of the polynomial ring A[T1 , . . . , Td ]
with respect to the ideal (T1 , . . . , Td ) ⊂ A[T1 , . . . , Td ] (with the requirement
that the PD-structure be compatible with the one on the ideal (p)) and then
let A{hT1 , . . . , Td i} be its p-adic completion.
• We use the symbol ≃ to denote canonical isomorphisms and sometimes
use ≈ for almost isomorphisms (often with respect to the maximal ideal of
OCp ).
1. Introduction
Let k be a p-adic field, that is a discretely valued complete nonarchimedean
extension of Qp with a perfect residue field of characteristic p, which is absolutely
unramified. Consider a rigid analytic variety over k, or more generally an adic space
X over Spa(k, Ok ) which admits a proper smooth formal model X over Spf Ok ,
whose special fiber is denoted by X0 . Let L be a lisse Zp -sheaf on Xét . On one hand,
we have the p-adic étale cohomology H i (Xk , L) which is a finitely generated Zp module carrying a continuous Gk = Gal(k/k)-action. On the other hand, one may
i
consider the crystalline cohomology Hcris
(X0 /Ok , E) with the coefficient E being a
filtered (convergent) F -isocrystal on X0 /Ok . At least in the case that X comes from
a scheme and the coefficients L and E are trivial, it was Grothendieck’s problem
of mysterious functor to find a comparison between the two cohomology theories.
This problem was later formulated as the crystalline conjecture by Fontaine [Fon82].
In the past decades, the crystalline conjecture was proved in various generalities,
by Fontaine-Messing, Kato, Tsuji, Niziol, Faltings, Andreatta-Iovita, Beilinson and
Bhatt. Among them, the first proof for the whole conjecture was given by Faltings [Fal]. Along this line, Andreatta-Iovita introduced the Poincaré lemma for the
crystalline period sheaf Bcris on the Faltings site, a sheaf-theoretic generalization
of Fontaine’s period ring Bcris . Both the approach of Fontaine-Messing and that of
Faltings-Andreatta-Iovita use an intermediate topology, namely the syntomic topology and the Faltings topology, respectively. The approach of Faltings-AndreattaIovita, however, has the advantage that it works for nontrivial coefficients L and
E.
More recently, Scholze [Sch13] introduced the pro-étale site Xproét , which allows
him to construct the de Rham comparison isomorphism for any proper smooth
adic space over a discretely valued complete nonarchimedean field over Qp , with
coefficients being lisse Zp -sheaves on Xproét . (The notion of lisse Zp -sheaf on Xét
and that on Xproét are equivalent.) Moreover, his approach is direct and flexible
enough to attack the relative version of the de Rham comparison isomorphism, i.e.
the comparison for a proper smooth morphism between two smooth adic spaces.
It seems that to deal with nontrivial coefficients in a comparison isomorphism,
one is forced to work over analytic bases. For the generality and some technical
advantages provided by the pro-étale topology, we adapt Scholze’s approach to give
a proof of the crystalline conjecture for proper smooth formal schemes over Spf Ok ,
with nontrivial coefficients, in both absolute and relative settings. We note that it
is not hard to prove in our setup the crystalline conjecture for formal schemes over

Crystalline comparison isomorphism in p-adic Hodge theory

3

arbitrary complete discretely valued rings. Furthermore, in a sequel paper we shall
construct crystalline comparison isomorphisms for arbitrary varieties over p-adic
fields.
Let us explain our construction of crystalline comparison isomorphism (in the
absolutely unramified case) in more details. First of all, Scholze is able to prove
k
the finiteness of the étale cohomology of a proper smooth adic space X over K = b
with coefficient L′ being an Fp -local system. Consequently, he shows the following “primitive comparison”, an almost (with respect to the maximal ideal of OK )
isomorphism
≈

+
H i (Xk,ét , L′ ) ⊗Fp OK /p −→ H i (Xk,ét , L′ ⊗Fp OX
/p).

With some more efforts, one can produce the primitive comparison isomorphism in
the crystalline case:
Theorem 1.1 (See Theorem 4.3). For L a lisse Zp -sheaf on Xét , we have a canonical isomorphism of Bcris -modules
(1.0.1)

∼

→ H i (Xk,proét , L ⊗ Bcris ).
H i (Xk,ét , L) ⊗Zp Bcris −

compatible with Gk -action, filtration, and Frobenius.
It seems to us that such a result alone may have interesting arithmetic applications, since it works for any lisse Zp -sheaves, without the crystalline condition
needed for comparison theorems.
Following Faltings, we say a lisse Zp -sheaf L on the pro-étale site Xproét is crystalline if there exists a filtered F -isocrystal E on X0 /Ok together with an isomorphism of OBcris -modules
(1.0.2)

ur OBcris ≃ L ⊗Z OBcris
E ⊗OX
p

ur
which is compatible with connection, filtration and Frobenius. Here, OX
is the
ur
pullback to Xproét of OXét and OBcris is the crystalline period sheaf of OX -module
with connection ∇ such that OB∇=0
cris = Bcris . When this holds, we say the lisse
Zp -sheaf L and the filtered F -isocrystal E are associated.
We illustrate the construction of the crystalline comparison isomorphism briefly.
Firstly, we prove a Poincaré lemma for the crystalline period sheaf Bcris on Xproét .
It follows from the Poincaré lemma (Proposition 2.16) that the natural morphism
from Bcris to the de Rham complex DR(OBcris ) of OBcris is a quasi-isomorphism,
which is compatible with filtration and Frobenius. When L and E are associated,
the natural morphism

L ⊗Zp DR(OBcris ) → DR(E) ⊗ OBcris
is an isomorphism compatible with Frobenius and filtration. Therefore we find a
quasi-isomorphism
L ⊗Zp Bcris ≃ DR(E) ⊗ OBcris .
From this we deduce
(1.0.3)

∼

→ RΓ(Xk,proét , DR(E) ⊗ OBcris ).
RΓ(Xk,proét , L ⊗Zp Bcris ) −

∼
∼
→ Xét
, one has
Via the natural morphism of topoi w : Xk,proét

(1.0.4)

b Ok Bcris ))
RΓ(Xk,proét , DR(E) ⊗ OBcris ) ≃ RΓ(Xét , DR(E)⊗

4

FUCHENG TAN, JILONG TONG

for which we have used the fact that the natural morphism
b Ok Bcris → Rw ∗ OBcris
OX ⊗

is an isomorphism (compatible with extra structures), which is a result of AndreattaBrinon.
Combining the isomorphisms above, we obtain the desired crystalline comparison
isomorphism.
Theorem 1.2 (See Theorem 4.5). Let L be a lisse Zp -sheaf on X and E be a filtered
F -isocrystal on X0 /Ok which are associated as in (1.0.2). Then there is a natural
isomorphism of Bcris -modules
∼

i
H i (Xk,ét , L) ⊗ Bcris −
→ Hcris
(X0 /Ok , E) ⊗k Bcris

which is compatible with Gk -action, filtration and Frobenius.
After obtaining a refined version of the acyclicity of crystalline period sheaf
OBcris in §6, we achieve the crystalline comparison in the relative setting, which
reduces to Theorem 1.2 when Y = Spf Ok :
Theorem 1.3 (See Theorem 5.6). Let f : X → Y be a proper smooth morphism of
smooth formal schemes over Spf Ok , with fk : X → Y the generic fiber and fcris the
morphism between the crystalline topoi. Let L, E be as in Theorem 1.2. Suppose
that Ri fk∗ L is a lisse Zp -sheaf on Y . Then it is crystalline and is associated to the
filtered F -isocrystal Ri fcris∗ E.
Acknowledgments. The authors are deeply indebted to Andreatta, Iovita and
Scholze for the works [AI] and [Sch13]. They wish to thank Kiran Kedlaya and
Barry Mazur for their interests in this project.
2. Crystalline period sheaves
Let k be a p-adic field with residue field κ. Let X be a locally noetherian adic
space over Spa(k, Ok ). For the fundamentals on the pro-étale site Xproét , we refer
to [Sch13].
The following terminology and notation will be used frequently throughout the
paper. We shall fix once for all an algebraic closure k of k, and consider Xk :=
X ×Spa(k,Ok ) Spa(k, Ok ) as an object of Xproét . As in [Sch13, Definition 4.3], an
object U ∈ Xproét lying above Xk is called an affinoid perfectoid (lying above Xk )
if U has a pro-étale presentation U = lim Ui → X by affinoids Ui = Spa(Ri , Ri+ )
←−
above Xk such that, with R+ the p-adic completion of lim Ri+ and R = R+ [1/p],
−→
b O )-algebra. Write U
b = Spa(R, R+ ).
the pair (R, R+ ) is a perfectoid affinoid (k,
b
k

By [Sch13, Proposition 4.8, Lemma 4.6], the set of affinoid perfectoids lying above
Xk of Xproét forms a basis for the topology.
2.1. Period sheaves and their acyclicities. Following [Sch13], let
∼
∼
ν : Xproét
−→ Xét

be the morphism of topoi, which, on the underlying sites, sends an étale morphism
U → X to the pro-étale morphism from U (viewed as a constant projective system)
+
+
to X. Consider OX
= ν −1 OX
and OX = ν −1 OXét , the (uncompleted) structural
ét
sheaves on Xproét . More concretely, for U = lim Ui a qcqs (quasi-compact and
←−

Crystalline comparison isomorphism in p-adic Hodge theory

5

quasi-separated) object of Xproét , one has OX (U ) = lim OX (Ui ) = lim OXét (Ui )
−→
−→
([Sch13, Lemma 3.16]). Set
d
+
O
O+ /pn ,
X := lim
←− X
n

♭+
+
+
OX
= lim OX
/pOX
.
←−p
x7→x

b =
For U = lim Ui ∈ Xproét an affinoid perfectoid lying above Xk with U
←−
+
Spa(R, R ), by [Sch13, Lemmas 4.10, 5.10], we have
(2.1.1)

Denote

d
+
+
O
X (U ) = R ,

R♭+ → R+ ,

♭+
and OX
(U ) = R♭+ := lim R+ /pR+ .
←−
x7→xp
n

x = (x0 , x1 , · · · ) 7→ x♯ := lim x
bpn ,
n→∞

for x
bn any lifting from R+ /p to R+ . We have the multiplicative homeomorphism
(induced by projection):
∼

lim R+ −
→ R♭+ ,
←
−
p
x7→x

(x♯ , (x1/p )♯ , · · · ) ←[ x

which can be extended to a ring homomorphism.
♭+
Put Ainf := W (OX
) and Binf = Ainf [ p1 ]. As R♭+ is a perfect ring, Ainf (U ) =
W (R♭+ ) has no p-torsions. In particular, Ainf has no p-torsions and it is a subsheaf
of Binf . Following Fontaine, define as in [Sch13, Definition 6.1] a natural morphism
d
+
θ : Ainf → O
X

(2.1.2)

b = Spa(R, R+ ), is given by
which, on an affinoid perfectoid U with U
d
+
+
(2.1.3) θ(U ) : Ainf (U ) = W (R♭+ ) −→ O
X (U ) = R ,
♭+

+

(x0 , x1 , · · · ) 7→

∞
X

pn x♯n,n

n=0
+

with xn = (xn,i )i∈N ∈ R = limx7→xp R /p. As (R, R ) is a perfectoid affinoid
←−
algebra, θ(U ) is known to be surjective (cf. [Bri, 5.1.2]). Therefore, θ is also
surjective.
Definition 2.1. Let X be a locally noetherian adic space over Spa(k, Ok ) as above.
Consider the following sheaves on Xproét .
(1) Define Acris to be the p-adic completion of the PD-envelope A0cris of Ainf
with respect to the ideal sheaf ker(θ) ⊂ Ainf , and define B+
cris := Acris [1/p].
(2) For r ∈ Z≥0 , set Filr A0cris := ker(θ)[r] A0cris ⊂ A0cris to be the r-th divided
power ideal, and Fil−r A0cris = A0cris . So the family {Filr A0cris : r ∈ Z} gives
a descending filtration of A0cris .
(3) For r ∈ Z, define Filr Acris ⊂ Acris to be the image of the following morphism of sheaves (we shall see below that this map is actually injective):
(2.1.4)

lim(Filr A0cris )/pn −→ lim A0cris /pn = Acris ,
←
−
←
−
n
n
r
and define Filr B+
cris = Fil Acris [1/p].

Let p♭ = (pi )i≥0 be a family of elements of k such that p0 = p and that ppi+1 = pi
for any i ≥ 0. Set
ξ = [p♭ ] − p ∈ Ainf |Xk .

6

FUCHENG TAN, JILONG TONG

Lemma 2.2. We have ker(θ)|Xk = (ξ) ⊂ Ainf |Xk . Furthermore, ξ ∈ Ainf |Xk is not
a zero-divisor.
Proof. As the set of affinoids perfectoids U lying above Xk forms a basis for the
topology of Xproét /Xk , we only need to check that, for any such U , ξ ∈ Ainf (U ) is
d
+
not a zero-divisor and that the kernel of θ(U ) : A (U ) → O
(U ) is generated by
inf

X

d
+
+
b = Spa(R, R+ ). Then Ainf (U ) = W (R♭+ ) and O
ξ. Write U
X (U ) = R , hence we
reduce our statement to (the proof of) [Sch13, Lemma 6.3].

Corollary 2.3. (1) We have A0cris |Xk = Ainf |Xk [ξ n /n! : n ∈ N] ⊂ Binf |Xk . More∼ d
+
| .
over, for r ≥ 0, Filr A0 | = A | [ξ n /n! : n ≥ r] and grr A0 | −→ O
cris Xk

inf Xk

cris Xk

X Xk

∼

(2) The morphism (2.1.4) is injective, hence limn Filr A0cris /pn −→ Filr Acris .
←−
∼ d
+
Moreover, for r ≥ 0, grr Acris |Xk −→ O
|
.
X
X k

Proof. The first two statements in (1) are clear. In particular, for r ≥ 0 we have
the following exact sequence
(2.1.5)

0

/ Filr+1 A0 |X
cris k

/ Filr A0 |X
cris k

d
+
/O
X |Xk

/0,

where the second map sends aξ r /r! to θ(a). This gives the last assertion of (1).
d
+
As O
X has no p-torsions, an induction on r shows that the cokernel of the
inclusion Filr A0cris ⊂ A0cris has no p-torsions. As a result, the morphism (2.1.4)
d
+
is injective and Filr A
is the p-adic completion of Filr A0 . Since O
is pcris

cris

X

adically complete, we deduce from (2.1.5) also the following short exact sequence
after passing to p-adic completions:
(2.1.6)

0

/ Filr+1 Acris |X
k

/ Filr Acris |X
k

giving the last part of (2).

d
+
/O
X |Xk

(i)

(0)

/0

(1)

Let ǫ = (ǫ )i≥0 be a sequence of elements of k such that ǫ = 1, ǫ 6= 1 and
(ǫ(i+1) )p = ǫ(i) for all i ≥ 0. Then 1 − [ǫ] is a well-defined element of the restriction
Ainf |Xk to Xproét /Xk of Ainf . Moreover 1 − [ǫ] ∈ ker(θ)|Xk = Fil1 Acris |Xk . Let
(2.1.7)

t := log([ǫ]) = −

∞
X
(1 − [ǫ])n
,
n
n=1

which is well-defined in Acris |Xk since Fil1 Acris is a PD-ideal.
Definition 2.4. Let X be a locally noetherian
space over Spa(k, Ok ). Define
P adic−s
r
Bcris = B+
[1/t].
For
r
∈
Z,
set
Fil
B
=
t
Filr+s B+
cris
cris
cris ⊂ Bcris . (As the
s∈Z
canonical element t ∈ Acris exists locally, these definitions do make sense.)
Before investigating these period sheaves in details, we first study them over a
b O )-algebra (R, R+ ). Consider
perfectoid affinoid (k,
b
k

Ainf (R, R+ ) := W (R♭+ ),

Binf (R, R+ ) := Ainf (R, R+ )[1/p],

and define the morphism
(2.1.8)

θ(R,R+ ) : Ainf (R, R+ ) −→ R+

Crystalline comparison isomorphism in p-adic Hodge theory

7

in the same way as in (2.1.3). It is known to be surjective as (R, R+ ) is perfectoid.
b O ) generates ker(θ
Furthermore, we have seen that the element ξ ∈ Ainf (k,
b
(R,R+ ) )
k
+
and is not a zero-divisor in Ainf (R, R ). Let Acris (R, R+ ) be the p-adic completion of the PD-envelope of Ainf (R, R+ ) with respect to the ideal ker(θ(R,R+ ) ). So
Acris (R, R+ ) is the p-adic completion of A0cris (R, R+ ) with

 n
ξ
: n ∈ N ⊂ Binf (R, R+ ).
A0cris (R, R+ ) := Ainf (R, R+ )
n!

For r an integer, let Filr A0cris (R, R+ ) ⊂ A0cris (R, R+ ) be the r-th PD-ideal, i.e., the
ideal generated by ξ n /n! for n ≥ max{r, 0}. Let Filr Acris (R, R+ ) ⊂ Acris (R, R+ )
be the closure (for the p-adic topology) of Filr A0cris (R, R+ ) inside Acris (R, R+ ).
+
+
+
+
+
Finally, put B+
cris (R, R ) := Acris (R, R )[1/p], Bcris (R, R ) := Bcris (R, R )[1/t],
and for r ∈ Z, set
r
+
+
Filr B+
cris (R, R ) := Fil Acris (R, R )[1/p] and
X
+
Filr Bcris (R, R+ ) :=
t−s Filr+s B+
cris (R, R ).
s∈Z

+

In particular, taking R = OCp with Cp the p-adic completion of the fixed
+
algebraic closure k of k, we get Fontaine’s rings Acris , Bcris
, Bcris as in [Fon94].
Lemma 2.5. Let X be a locally noetherian adic space over (k, Ok ). Let U ∈ Xproét
b = Spa(R, R+ ). Let F ∈ {A0 , Acris }.
be an affinoid perfectoid above Xk with U
cris
≈
Then for any r ≥ Z, we have a natural almost isomorphism Filr F (R, R+ )a →
r
r
Fil F (U )a , and have H i (U, Fil F )a = 0 for any i > 0.
d
+
♭+
+
♭+
Proof. As U is affinoid perfectoid, we have O
and
X (U ) = R , OX (U ) = R
+
θ(U ) = θ(R,R+ ) . In particular, Ainf (U ) = Ainf (R, R ), and the natural morphism
α : Ainf (R, R+ ) = Ainf (U ) −→ A0cris (U ) sends ker(θ(R,R+ ) ) into Fil1 A0cris (U ). As a
consequence, we get a natural morphism A0cris (R, R+ ) → A0cris (U ), inducing morphisms Filr A0cris (R, R+ ) → Filr A0cris (U ) between the filtrations. Passing to p-adic
completions, we obtain the natural maps Filr Acris (R, R+ ) → Filr Acris (U ) for all
r ∈ Z.
We need to show that the morphisms constructed above are almost isomorphisms. Recall that, as U is affinoid perfectoid, H i (U, Ainf )a = 0 for i > 0 ([Sch13,
Ainf [Xi :i∈N]
pi+1 !
0
Theorem 6.5]). Consider Ag
cris := (Xip −ai Xi+1 :i∈N) with ai = (pi !)p , then one has the
following short exact sequence
0

·(X0 −ξ)
0
0
/ Ag
/ Ag
cris
cris

/ A0
cris

/0.

g
0
Since
is a direct sum of Ainf ’s as an abelian sheaf and U is qcqs, we get
 Acris 
a
g
i
0
H U, Acris = 0 for i > 0. Hence H i (U, A0cris )a = 0 for i > 0 and the short exact
sequence above stays almost exact after taking sections over U :
(2.1.9)

0

·(X0 −ξ)
0 (U )a
0 (U )a
/ Ag
/ Ag
cris
cris

/ A0 (U )a
cris

/0.

8

FUCHENG TAN, JILONG TONG

+
0 (R, R+ ) := Ainf (R,R )[Xi :i∈N] with a =
On the other hand, set Ag
i
cris
(Xip −ai Xi+1 :i∈N)
then the following similar sequence is exact:

(2.1.10) 0

·(X0 −ξ)
0 (R, R+ )a
0 (R, R+ )a
/ Ag
/ Ag
cris
cris

pi+1 !
(pi !)p

/ A0 (R, R+ )a
cris

as above,

/0.

g
0 (R, R+ ). Combining (2.1.9) and (2.1.10), we find
0 (U ) = A
Since U is qcqs, Ag
cris
cris
0
+ a ∼
0
a
Acris (R, R ) −
→ Acris (U ) . This proves the statement for A0cris .
Next, as A0cris ⊂ Binf (Corollary 2.3), the sheaf A0cris has no p-torsions. So we get
the following tautological exact sequence
pn

0 −→ A0cris −→ A0cris −→ A0cris /pn −→ 0.
0
By what we have
sequence above that
 shown0 for Acrisn,awe∼ get0 fromn the exact
0
+
n a ∼
→ Acris /p (U )a , and H i (U, A0cris /pn )a = 0
→ Acris (U )/p
Acris (R, R )/p
for i > 0. Therefore the transition maps of the projective
system {(A0cris /pn )(U )}n≥0
a
1
0
n
are almost surjective, thus R lim (Acris /p )(U ) = 0. So the projective system
←−
{A0cris /pn } verifies the assumptions of (the almost version of)[Sch13, Lemma 3.18].
As a result, we find

Rj lim A0cris /pn = 0, for any j > 0,
←−

a
∼
+ a
0
Acris (R, R ) = lim(Acris (R, R+ )/pn )a −→ lim A0cris /pn (U ) = Acris (U )a ,
←−
←−
and
H i (U, Acris )a = H i (U, lim A0cris /pn )a = 0
←−

(2.1.11)

n

for i > 0.
To prove the statements for Filr A0cris for r ≥ 0, we shall use the exact sed
+ a
quence (2.1.5). As H i (U, O
X ) = 0 for i > 0 ([Sch13, Lemma 4.10]), we find
r 0
i
a
H (U, Fil Acris ) = 0 for all i ≥ 2, and also the induced long exact sequence
d
+
a
0 −→ Filr+1 A0cris (U )a −→ Filr A0cris (U )a −→ O
X (U ) −→
r+1 0
r 0
1
a
1
a
H (U, Fil
Acris ) −→ H (U, Fil Acris ) −→ 0.

On the other hand, we have the analogous exact sequence for Filr A0cris (R, R+ ):
0 −→ Filr+1 A0cris (R, R+ ) −→ Filr A0cris (R, R+ ) −→ R+ −→ 0,
where the second morphism sends aξ r /r! to θ(R,R+ ) (a). Together with the two
exact sequences above and the vanishing H 1 (U, A0cris )a = 0, an induction on r ≥ 0
∼
shows Filr A0cris (R, R+ )a → Filr A0cris (U )a and H 1 (U, Filr A0cris )a = 0. This gives the
r 0
statement for Fil Acris for r ∈ Z (note that Filr A0cris = A0cris when r ≤ 0). The
statement for Filr Acris can be done in the same way; one starts with (2.1.6) and
uses the vanishing of H 1 (U, Acris )a .

Corollary 2.6. Keep the notation of Lemma 2.5.
(1) The morphism multiplication by t on Acris is almost injective. In particular,
t ∈ B+
cris |Xk is not a zero-divisor.
(2) Let F ∈ {B+
cris , Bcris }. Then for any r ∈ Z, there is a natural isomorphism
∼
Filr F (R, R+ ) → Filr F (U ), and H i (U, Filr F ) = 0 for i ≥ 1.

Crystalline comparison isomorphism in p-adic Hodge theory

9

Proof. (1) By Lemma 2.5, we are reduced to showing that t ∈ Acris (R, R+ ) is not
a zero-divisor. So we just need to apply [Bri, Corollaire 6.2.2], whose proof works
for any such perfectoid (R, R+ ).
(2) As U is qcqs, we deduce from Lemma 2.5 the statement for B+
cris and for
Filr B+
on
inverting
p.
Similarly,
inverting
t
we
get
the
statement
for
B
. Finally,
cris
cris
r+s +
r+s +
−s
|
and
as
t
Fil
B
|
≃
Fil
Bcris |Xk ,
as Filr Bcris |Xk = lims t−s Filr+s B+
cris Xk
cris Xk
−→
r
passing to limits we get the statement for Fil Bcris .

2.2. Period sheaves with connections. In this section, assume that the p-adic
field k is absolutely unramified. Let X be a smooth formal scheme over Ok . Set
X := Xk the generic fiber of X , viewed as an adic space over Spa(k, Ok ). For any
étale morphism Y → X , by taking the generic fibers, we obtain an étale morphism
Yk → X of adic spaces, hence an object of the pro-étale site Xproét . In this way,
we get a morphism of sites Xét → Xproét , with the induced morphism of topoi
∼
∼
w : Xproét
−→ Xét
.

Let OXét denote the structure sheaf of the étale site Xét : for any étale morphism
ur+
Y → X of formal schemes over Ok , OXét (Y) = Γ(Y, OY ). Define OX
:= w−1 OXét
ur+
]
and Our := w−1 O [1/p]. Thus Our+ is the associated sheaf of the presheaf O
:
X

Xét

X

X

ur+
]
Xproét ∋ U 7→ lim OXét (Y) =: O
X (U ),
−→
(Y,a)

where the limit runs through all pairs (Y, a) with Y ∈ Xét and a : U → Yk a
morphism making the following diagram commutative
/ X = Xk
(2.2.1)
U ●
O
●●
●●
●●
a ●●
#
Yk .
The morphism a : U → Yk induces a map Γ(Y, OY ) → OX (U ). There is then a
ur+
]
morphism of presheaves O
→ O+ , whence a morphism of sheaves
X

(2.2.2)

X

ur+
+
OX
→ OX
.

♭+
ur+
Recall Ainf := W (OX
). Set OAinf := OX
⊗Ok Ainf and

(2.2.3)

d
+
θX : OAinf −→ O
X

d
+
to be the map induced from θ : Ainf → O
X of (2.1.2) by extension of scalars.

Definition 2.7. Consider the following sheaves on Xproét .
(1) Let OAcris be the p-adic completion of the PD-envelope OA0cris of OAinf
with respect to the ideal sheaf ker(θX ) ⊂ OAinf , OB+
cris := OAcris [1/p], and
OBcris := OB+
[1/t]
with
t
=
log([ǫ])
defined
in
(2.1.7).
cris
(2) For r ∈ Z≥0 , define Filr OA0cris ⊂ OA0cris to be the r-th PD-ideal ker(θX )[r] ,
and Filr OAcris the image of the canonical map
lim Filr OA0cris /pn −→ lim OA0cris /pn = OAcris .
←−
←−
−r
Also set Fil OAcris = OAcris for r > 0.

10

FUCHENG TAN, JILONG TONG

(3) For r ∈ Z, set
r
Filr OB+
cris := Fil OAcris [1/p] and

Filr OBcris :=

X

t−s Filr+s OB+
cris .

s∈Z

k, Ob ), one can also define Filr OBcris
Remark 2.8. As tp = p!·t[p] in Acris := Acris (b
k
P
as s∈N t−s Filr+s OAcris . A similar observation holds equally for Filr Bcris .

Remark 2.9.
(1) As X is flat over Ok , the structure sheaf OXét has no ptorsions. It follows that OAinf , OA0cris and OAcris have no p-torsions. So
OAcris ⊂ OB+
cris .
(2) The morphism θX of (2.2.3) extends to a surjective morphism from OA0cris
d
+
d
+
to O
with kernel Fil1 OA0 , hence also a morphism from OA
to O
.
cris

cris

X

X

Let us denote these two morphisms again by θX . As coker(Fil1 OA0cris ֒→
d
+
OA0cris ) ≃ O
X is p-adically complete and has no p-torsions, using the snake
lemma and passing to limits one can deduce the following short exact sequence
θX d
+
OX
−→ 0.
0 −→ lim(Fil1 OA0cris /pn ) −→ OAcris −→
←−
n

In particular, Fil1 OAcris = ker(θX ).

In order to describe explicitly the sheaf OAcris , we shall need some auxiliary
sheaves on Xproét .
Definition 2.10. Consider the following sheaves on Xproét .
(1) Let Acris {hu1 , . . . , ud i} be the p-adic completion of the sheaf of PD polynomial rings A0cris hu1 , . . . , ud i ⊂ Binf [u1 , . . . , ud ]. Set B+
cris {hu1 , . . . , ud i} :=
Acris {hu1 , . . . , ud i}[1/p] and Bcris {hu1 , . . . , ud i} := Acris {hu1 , . . . , ud i}[1/t].
(2) For r ∈ Z, let Filr A0cris hu1 , . . . , ud i ⊂ A0cris hu1 , . . . , ud i be the ideal sheaf
given by
X
[i ]
[i ]
Filr (A0cris hu1 , . . . , ud i) :=
Filr−(i1 +...+id ) A0cris · u1 1 · · · ud d ,
i1 ,...,id ≥0

and Filr (Acris {hu1 , . . . , ud i}) ⊂ Acris {hu1 , . . . , ud i} the image of the morphism

lim Filr A0cris {hu1 , . . . , ud i}/pn −→ Acris {hu1 , . . . , ud i}.
←
−
n
The family {Filr (Acris {hu1 , . . . , ud i}) : r ∈ Z} gives a descending filtration
of Acris {hu1 , . . . , ud i}. Inverting p, we obtain Filr (B+
cris {hu1 , . . . , ud i}). Set
finally
X
Filr (Bcris {hu1 , . . . , ud i}) :=
t−s Filr+s (B+
cris {hu1 , . . . , ud i}).
s∈Z

The proof of the following lemma is similar to that of Lemma 2.5. We omit the
details here.

Lemma 2.11. Let V ∈ Xproét be an affinoid perfectoid lying above Xk with Vb =
Spa(R, R+ ). Then the following natural map is an almost isomorhpism
≈

Acris (R, R+ ){hu1 , . . . , ud i} −→ (Acris {hu1 , . . . , ud i})(V ).

Crystalline comparison isomorphism in p-adic Hodge theory

11

Under this identification, Filr (Acris {hu1 , . . . , ud i})(V )a consists of series
X
[i ]
[i ]
ai1 ,...,id u1 1 · · · ud d ∈ Acris (R, R+ ){hu1 , . . . , ud i}
i1 ,...,id ≥0

such that ai1 ,...,id ∈ Filr−(i1 +...+id ) Acris (R, R+ ) and ai1 ,...,id tends to 0 for the p-adic
topology when the sum i1 + . . . + id tends to infinity. Furthermore
H i (V, Filr (Acris {hu1 , . . . , ud i}))a = 0,

for i > 0.

We want to describe OAcris more explicitly . For this, assume there is an étale
morphism X → Spf(Ok {T1±1, . . . , Td±1 }) =: T d of formal schemes over Ok . Let Td
fd be obtained from Td by adding a compatible
denote the generic fiber of T d and T
n
system of p -th root of Ti for 1 ≤ i ≤ d and n ≥ 1:
fd := Spa(k{T ±1/p∞ , . . . , T ±1/p∞ }, Ok {T ±1/p∞ , . . . , T ±1/p∞ }).
T
1

1

d

d

fd . Let T ♭ ∈ O♭+ | e be the element (Ti , T 1/p , . . . , T 1/pn , . . .). Then
e := X ×Td T
Set X
i
i
i
X X
θX (Ti ⊗ 1 − 1 ⊗ [Ti♭ ]) = 0, which allows us to define an Acris -linear morphism

(2.2.4)

ui 7→ Ti ⊗ 1 − 1 ⊗ [Ti♭ ].

α : Acris {hu1 , . . . , ud i}|Xe −→ OAcris |Xe ,

Proposition 2.12. The morphism α of (2.2.4) is an almost isomorphism. Furthermore, it respects the filtrations on both sides.
Lemma 2.13. Let k be an algebraic closure of k. Then Acris {hu1 , . . . , ud i}|Xe has a
k

ur+
natural OX
|Xe -algebra structure, sending Ti to ui +[Ti♭ ], such that the composition
k

ur+
OX
|Xe
k

is
is

θ ′ |X
f

d
+
−→ Acris {hu1 , . . . , ud i}|Xe −→k O
e
X |X
k

d
+
+
′
the map (2.2.2) composed with OX
→O
X . Here θ :
θ d
+
induced from the map Acris → O
X by sending Ui ’s to

k

d
+
Acris {hu1 , . . . , ud i} → O
X

0.

ur+
ur+
]
Proof. As OX
is the associated sheaf of O
X , and as the affinoids perfectoids
e form a basis for the topology of Xproét /X
e , we only need to define
lying above X
k
k
e , a morphism of
naturally, for any affinoid perfectoid U ∈ Xproét lying above X
k
rings:
ur+
]
O
(U ) −→ (Aa {hu , . . . , u i})(U ),
cris

X

1

d

sending Ti to ui + [Ti♭ ].
b = Spa(R, R+ ). Let p♭ ∈ O♭ ⊂ R♭+ be the element given by a compatible
Write U
b
k

system of pn -th roots of p. Then we have (see [Bri, Proposition 6.1.2])
Acris (R, R+ )
(R♭+ /(p♭ )p )[δ0 , δ1 , . . .]
≃
,
(p)
(δ0p , δ1p , . . .)

where δi is the image of γ i+1 (ξ) with γ : x 7→ xp /p. So
Acris (R, R+ ){hu1 , . . . , ud i}
(p)

≃

(Acris (R, R+ )/p)[ui , ui,j : 1 ≤ i ≤ d, j = 0, 1, . . .]
(upi , upi,j )

≃

R♭+ [u1 ,...,ud ]
p [δj , ui,j : 1 ≤ i
((p♭ )p ,up
1 ,...,ud )
(δjp , upi,j )

≤ d, j = 0, 1, . . .]
.

12

FUCHENG TAN, JILONG TONG

Set I := (p♭ , u1 , . . . , ud ) ⊂ R♭+ [u1 , . . . , ud ]/((p♭ )p , up1 , . . . , upd ): this is an nilpotent
ideal with cokernel R♭+ /(p♭ ) ≃ R+ /p. Furthermore, there is a canonical morphism
of schemes



 ♭+
Acris (R, R+ ){hu1 , . . . , ud i}
R [u1 , . . . , ud ]
Spec
−→ Spec
(p)
((p♭ )p , up1 , . . . , upd )
♭+

+

R [u1 ,...,ud ]
Acris (R,R ){hu1 ,...,ud i}
induced from the natural inclusion ((p
.
♭ )p ,up ,...,up ) ⊂
(p)
1
d
Let Y be a formal scheme étale over X together with a factorization a : U → Yk
as in (2.2.1). We shall construct a natural morphism of Ok -algebras

(2.2.5)

OY (Y) −→ (Acris {hu1 , . . . , ud i}) (U )
[Ti♭ ].

sending Ti to ui +
Assume firstly that the image a(U ) is contained in the
generic fiber Spa(A[1/p], A) of some affine open subset Spf(A) ⊂ Y. In particular,
there exists a morphism of Ok -algebras A → R+ , whence a morphism of κ-schemes
Spec(R+ /p) −→ Spec(A/p) −→ Y ⊗Ok κ =: Y1 .

(2.2.6)

Composing Y → X with the étale morphism X → T d , we obtain an étale morphism
Y → T d , hence an étale morphism Yn : = Y ⊗ Ok /pn → T d ⊗ Ok /pn =: T d,n for
each n. As Ti♭ + ui ∈ R♭+ [u1 , . . . , ud ]/((p♭ )p , up1 , . . . , upd ) is invertible, one deduces
a map
Spec(R♭+ [u1 , . . . , ud ]/((p♭ )p , up1 , . . . , upd )) −→ T d,1 ,

Ti 7→ Ti♭ + ui .

But we have the following commutative diagram
(2.2.6)

♭
Spec(R♭+
 _ /(p ))

Spec(R+ /p)

∃

nil-immersion

Spec



7/ Y1
étale morphism

g



R♭+ [u1 ,...,ud ]
p
((p♭ )p ,up
1 ,...,ud )





/ T d,1 ,

from which we deduce a morphism, denoted by g1 :

 ♭+


R [u1 , . . . , ud ]
Acris (R, R+ ){hu1 , . . . , ud i}
g
−→ Spec
g1 : Spec
−→ Y1 .
p
p
♭
p
(p)
((p ) , u1 , . . . , ud )
Then we have the following commutative diagram
 g

+

1
){hu1 ,...,ud i}
/ Y1 
Spec Acris (R,R (p)
_
nil-immersion

Spec





Acris (R,R+ ){hu1 ,...,ud i}
(pn )



4/ Yn

∃
gn

étale morphism



/ T d,n .

with the bottom map Ti 7→ Ti♭ + ui . These gn ’s are compatible with each other, so
that they give rise to a morphism Spf(Acris (R, R+ ){hu1 , . . . , ud i}) → Y of formal
schemes over Ok , inducing a morphism of Ok -algebras
OY (Y) → Acris (R, R+ ){hu1 , . . . , ud i}
sending Ti to ui + [Ti♭ ]. Combining it with the natural morphism
Acris (R, R+ ){hu1 , . . . , ud i} → Acris {hu1 , . . . , ud i}(U )

Crystalline comparison isomorphism in p-adic Hodge theory

13

we obtain the desired map (2.2.5). For the general case, i.e., without assuming
that a(U ) is contained in the generic fiber of some affine open of Y, cover U by
affinoids perfectoids Vj such that each a(Vj ) is contained in the generic fiber of
some affine open subset of Y. The construction above gives, for each j, a morphism
of Ok -algebras
OY (Y) −→ (Acris {hu1 , . . . , ud i}) (Vj ),

Ti 7→ ui + [Ti♭ ].

As the construction is functorial on the affinoid perfectoid Vj , we deduce the morphism (2.2.5) in the general case using the sheaf property of Acris {hu1 , . . . , ud i}.
ur+
]
Finally, since O
O (Y) with the limit runs through the diagrams
X (U ) = lim
−→ Y
(2.2.1), we get a morphism of Ok -algebras
ur+
]
O
X (U ) −→ Acris (U ){hu1 , . . . , ud i},

Ti 7→ ui + [Ti♭ ]

e .
which is functorial with respect to affinoid perfectoid U ∈ Xproét lying above X
k
Passing to the associated sheaf, we obtain finally a natural morphism of sheaves
ur
of Ok -algebras OX
|Xe → Acris |Xe {hu1 , . . . , ud i} sending Ti to ui + [Ti♭ ]. The last
k

k

statement follows from the assignment θ′ (Ui ) = 0 and the fact that θ([Ti♭ ]) = Ti . 

e is a covering in the pro-étale site Xproét ,
e →X
Proof of Proposition 2.12. As X
k
we only need to show that α|Xe is an almost isomorphism. By the lemma above,
k

ur+
there exists a morphism of sheaves of Ok -algebras OX
|Xe → Acris {hu1 , . . . , ud i}|Xe
k

sending Ti to ui + [Ti♭ ]. By extension of scalars, we find the following morphism

ur+
⊗Ok Ainf |Xe −→ Acris {hu1 , . . . , ud i}|Xe
β : OAinf |Xe = OX
k

which maps Ti ⊗ 1 to

ui + [Ti♭ ].

k

k

k

′

Consider the composite (with θ as in Lemma 2.13)

d
+
θ′ |Xe ◦ β : OAinf |Xe −→ Acris {hu1 , . . . , ud i}|Xe −→O
e ,
X |X
k
k
k
k


which is simply θX |Xe by Lemma 2.13. Therefore, β ker(θX |Xe ) ⊂ ker(θ′ |Xe ).
k

k

k

Since ker(θ′ ) has a PD-structure, the map β extends to the PD-envelope OA0cris |Xe
k
of the source. Furthermore, Acris {hu1 , . . . , ud i}a is by definition p-adically complete:
∼
Acris {hu1 , . . . , ud i}a → limn (Acris {hu1 , . . . , ud i}a /pn ). The map β in turn extends
←−
to the p-adic completion of OA0,a
e . So we obtain the following morphism, still
cris |X
k
denoted by β:
β : OAacris |Xe −→ Acris {hu1 , . . . , ud i}a |Xe ,
k

k

Ti ⊗ 1 7→ ui + [Ti♭ ].

Then one shows that β and α are inverse to each other, giving the first part of our
proposition.
It remains to check that α respects the filtrations. As θX |Xe ◦ α = θ′ |Xe and
≈
as α is an almost isomorphism, α induces an almost isomorphism α : ker(θ′ |Xe ) →
ker(θX |Xe ). Therefore, since ker(θ′ ) = Fil1 (Acris {hu1 , . . . , ud i}) and Fil1 OAcris =
ker(θX ) (Remark 2.9), α gives an almost isomorphism
∼

α : Fil1 (Acris {hu1 , . . . , ud i})a |Xe −→ Fil1 OAacris |Xe .

As Fil1 OAcris |Xe ⊂ OAcris |Xe is a PD-ideal, we can consider its i-th PD ideal subsheaf I [i] ⊂ OAcris |Xe . Using the almost isomorphism above and the explicit description in Lemma 2.11, one checks that the p-adic completion of I [i] is (almost)

14

FUCHENG TAN, JILONG TONG

equal to α(Fili (Acris {hu1 , . . . , ud i})|Xe ). As the image of the morphism
Fili OA0cris |Xe −→ OAcris |Xe

is naturally contained in I [i] , on passing to p-adic completion, we obtain
Fili OAacris |Xe ⊂ α(Fili Acris {hu1 , . . . , ud i}a |Xe ).
On the other hand, we have the following commutative diagram
α

Fili (Acris {hu1 , . . . , ud i})|Xe
O

/ OAcris | e
O X

∼
=

lim
←−

Fili (A0cris hu1 ,...,ud i)|X
f
pn

α

/ lim Fil
←−

i

OA0cris |X
f
pn

= Fili OAacris |Xe .

Therefore α(Fili Acris {hu1 , . . . , ud i}|Xe ) ⊂ Fili OAcris |Xe , whence the equality
α(Fili (Acris {hu1 , . . . , ud i})a |Xe ) = Fili OAacris |Xe .


Corollary 2.14. Keep the notation above. There are natural filtered isomorphisms
∼

+
B+
e {hu1 , . . . , ud i} −→ OBcris |X
e,
cris |X

and

∼

Bcris |Xe {hu1 , . . . , ud i} −→ OBcris |Xe

both sending ui to Ti ⊗ 1 − 1 ⊗ [Ti♭ ].
Corollary 2.15. Let X be a smooth formal scheme over Ok . Then the morphism
of multiplication by t on OAcris |Xk is almost injective. In particular t ∈ OB+
cris |Xk
is not a zero-divisor and OB+
⊂
OB
.
cris
cris
Proof. This is a local question on X. Hence we may and do assume there is an
étale morphism X → Spf(Ok {T1±1 , . . . , Td±1 }). Thus our corollary results from
Proposition 2.12 and Corollary 2.6 (1).

An important feature of OAcris is that it has an Acris -linear connection on it. To
1,ur+
ur+
.
:= w−1 Ω1Xét /Ok , which is locally free of finite rank over OX
see this, set ΩX/k
Let
1,ur+
1,ur+
i
and Ωi,ur
Ωi,ur+
X/k := ΩX/k [1/p] ∀i ≥ 0.
X/k := ∧O ur+ ΩX/k ,
X

Then OAinf admits a unique Ainf -linear connection
∇ : OAinf −→ OAinf ⊗Our+ Ω1,ur+
X/k
X

induced from the usual one on OXét . This connection extends uniquely to OA0cris
and to its completion
∇ : OAcris −→ OAcris ⊗Our+ Ω1,ur+
X/k
X

This extension is Acris -linear. Inverting p (resp. t), we get also a B+
cris -linear (resp.
+
Bcris -linear) connection on OBcris (resp. on OBcris ):
1,ur
+
ur
∇ : OB+
cris −→ OBcris ⊗OX ΩX/k ,

From Proposition 2.12, we obtain

1,ur
ur Ω
and ∇ : OBcris −→ OBcris ⊗OX
X/k .

Crystalline comparison isomorphism in p-adic Hodge theory

15

Corollary 2.16 (Crystalline Poincaré lemma). Let X be a smooth formal scheme
of dimension d over Ok . Then there is an exact sequence of pro-étale sheaves:
∇

∇

∇

1,ur
d,ur
+
+
+
ur
ur
0 → B+
cris → OBcris → OBcris ⊗OX ΩX/k → . . . → OBcris ⊗OX ΩX/k → 0,

which is strictly exact with respect to the filtration giving Ωi,ur
X/k degree i. In particular, the connection ∇ is integrable and satisfies Griffiths transversality with respect
1,ur
i
i−1
+
ur
to the filtration on OB+
OB+
cris , i.e. ∇(Fil OBcris ) ⊂ Fil
cris ⊗OX ΩX/k .
Proof. We just need to establish the almost version of our corollary for OAcris . This
is a local question on X, hence we may and do assume there is an étale morphism
from X to Spf(Ok {T1±1 , . . . , Td±1 }). Then under the almost isomorphism (2.2.4) of
Proposition 2.12, Fili OAacris |Xe is the p-adic completion of
X
[i ]
[i ]
Fili−(i0 +...+id ) Aacris |Xe u1 1 · · · ud d
i1 ,...id ≥0

⊗ [Ti♭ ]

[n]

[n−1]

⊗ dTi for any i, n ≥ 1,
with Ti ⊗ 1 − 1
sent to ui . Moreover ∇(ui ) = ui
since the connection ∇ on OAcris is Acris -linear. The strict exactness and Griffiths
transversality then follow.

Using Proposition 2.12, we can also establish an analogous acyclicity result for
OAcris as in Lemma 2.5. Let U = Spf(R+ ) be an affine subset of X admitting
an étale morphism to T d = Spf(Ok {T1±1 , . . . , Td±1 }). Let U be the generic fiber,
e := U ×Td T
e d . Let V be an affinoid perfectoid of Xproét lying above
and set U
e . Write Vb = Spa(S, S + ). Let OAcris (S, S + ) be the p-adic completion of the
U
k
PD-envelope OA0cris (S, S + ) of R+ ⊗Ok W (S ♭+ ) with respect to the kernel of the
following morphism induced from θ(S,S +) by extending scalars to R+ :
θR+ : R+ ⊗Ok W (S ♭+ ) −→ S + .
+
+
+
+
+
Set OB+
cris (S, S ) := OAcris (S, S )[1/p], OBcris (S, S ) := OBcris (S, S )[1/t]. For
r
+
+
r ∈ Z, define Fil OAcris (S, S ) to be the closure inside OAcris (S, S ) for the p-adic
+
topology of the r-th PD-ideal of OA0cris (S, S + ). Finally, set Filr OB+
cris (S, S ) :=
P
r+s
r
r
+
OBcris (S, S + ).
Fil OAcris (S, S + )[1/p] and Fil OBcris (S, S + ) := s∈Z t−s Fil

Lemma 2.17. Keep the notation above. For any F ∈ {OAcris , OB+
cris , OBcris } and
r
+ ≈
any r ∈ Z, there exists a natural almost isomorphism Fil F (S, S ) → Filr F (V ).
Moreover, H i (V, Filr F )a = 0 whenever i > 0.
Proof. Consider the following morphism, again denoted by α
α : Acris (S, S + ){hu1 , . . . , ud i} −→ OAcris (S, S + ),

ui 7→ Ti ⊗ 1 − 1 ⊗ [Ti♭ ].

One checks similarly as in Proposition 2.12 that this morphism is an isomorphism.
Moreover, if we define Filr (Acris (S, S + ){hu1 , . . . , ud i}) to be the p-adic completion
of
X
[i ]
[i ]
Filr−(i1 +...+id ) A0cris (S, S + )u1 1 · · · ud d ⊂ Acris (S, S + ){hu1 , . . . , ud i},
i1 ,...,id ≥0

16

FUCHENG TAN, JILONG TONG

then α respects the filtrations of both sides. The first part of our lemma can be
deduced from the following commutative diagram
Filr (Acris (S, S + ){hu1 , . . . , ud i})

≈
α

/ Filr OAcris (S, S + )

≈
α


/ Filr OAcris (V )

≈


Filr (Acris {hu1 , . . . , ud i})(V )

where the left vertical almost isomorphism comes from Lemma 2.11. Using the
≈
last part of Lemma 2.11 and the almost isomorphism Filr (Acris {hu1 , . . . , ud i})|Xe →
Filr OAcris |Xe of Proposition 2.12, we deduce H i (V, Filr OAcris )a = 0 for i > 0.
Inverting respectively p and t, we obtain the statements for Filr OB+
cris and for
Filr OBcris .

2.3. Frobenius on crystalline period sheaves. We keep the notations in the
previous §. So k is absolutely unramified and X is a smooth formal scheme of dimension d over Ok . We want to endow Frobenius endomorphisms on the crystalline
period sheaves.
♭+
On Ainf = W (OX
), we have the Frobenius map

ϕ : Ainf −→ Ainf ,

(a0 , a1 , . . . , an , . . .) 7→ (ap0 , ap1 , . . . , apn , . . .).

Then for any a ∈ Ainf , we have ϕ(a) ≡ ap mod p. Thus, ϕ(ξ) = ξ p + p · b with
b ∈ Ainf |Xk . In particular ϕ(ξ) ∈ A0cris |Xk has all divided powers. As a consequence
we obtain a Frobenius ϕ on A0cris extending that on Ainf . By continuity, ϕ extends
p
to Acris and B+
cris . Note that ϕ(t) = log([ǫ ]) = pt. Consequently ϕ is extended to
1
1
Bcris by setting ϕ( t ) = pt .
To endow a Frobenius on OAcris , we first assume that the Frobenius of X0 =
X ⊗Ok κ lifts to a morphism σ on X , which is compatible with the Frobenius on
Ok . Then for Y ∈ Xét , consider the following diagram:

/7 Y
YO κ 
∃σY

absolute Frobenius

Yκ



/Y

/X

étale
σ


/ X.

As the right vertical map is étale, there is a unique dotted morphism above making
the diagram commute. When Y varies in Xét , the σY ’s give rise to a σ-semilinear
ur+
endomorphism on OXét whence a σ-semilinear endomorphism ϕ on OX
.
Remark 2.18. In general X does not admit a lifting of Frobenius. But as X
is smooth over Ok , for each open subset U ⊂ X admitting an étale morphism
U → Spf(Ok {T1±1 , . . . , Td±1 }), a similar argument as above shows that there exists
a unique lifting of Frobenius on U mapping Ti to Tip .
ur+
We deduce from above a Frobenius on OAinf = OX
⊗Ok Ainf given by ϕ ⊗ ϕ.
Abusing notation, we will denote it again by ϕ. A similar argument as in the
previous paragraphs shows that ϕ extends to OA0cris , hence to OAcris by continuity,
and finally to OB+
cris and OBcris . Moreover, under the almost isomorphism (2.2.4),
≈
the Frobenius on Acris {hu1 , . . . , ud i} → OAcris sends ui to ϕ(ui ) = σ(Ti ) − [Ti♭ ]p .

Crystalline comparison isomorphism in p-adic Hodge theory

17

Lemma 2.19. Assume as above that the Frobenius of X0 = X ⊗Ok κ lifts to a
morphism σ on X compatible with the Frobenius on Ok . The Frobenius ϕ on OB+
cris
1,ur
+
is horizontal with respect to the connection ∇ : OB+
cris → OBcris ⊗ ΩX/k .
Proof. We just need to check ∇ ◦ ϕ = (ϕ ⊗ dσ) ◦ ∇ on OAcris in the almost sense.
It is enough to do this locally. Thus we may assume there exists an étale morphism
X → Spf(Ok {T1±1 , . . . , Td±1 }). Recall the almost isomorphism (2.2.4). By Acris [n]
linearity it reduces to check the equality on the Ui . We have
[n]

∇(ϕ(ui )[n] ) = ϕ(ui )[n−1] ∇(ϕ(ui ))

(∇ ◦ ϕ)(ui ) =

Meanwhile, note that ϕ(ui ) − σ(Ti ) = −[Ti♭ ]p ∈ Acris , hence ∇(ϕ(ui )) = dσ(Ti ).
Thus
[n]

((ϕ ⊗ dσ) ◦ ∇) (ui )

[n−1]

= (ϕ ⊗ dσ)(ui
=

[n−1]
)
ϕ(ui

= (∇ ◦

⊗ dTi )

⊗ dσ(Ti )

[n]
ϕ)(ui ),

as desired.



Clearly, the Frobenius on OB+
cris above depends on the initial lifting of Frobenius
on X . For different choices of liftings of Frobenius on X , it is possible to compare
explicitly the resulting Frobenius endomorphisms on OB+
cris with the help of the
connection on it, at least when the formal scheme X is small, i.e. when it admits
an étale morphism to Spf(Ok {T1±1 , . . . , Td±1 }).
Lemma 2.20. Assume there is an étale morphism X → Spf(Ok {T1±1, . . . , Td±1 }).
Let σ1 , σ2 be two Frobenius liftings on X , and let ϕ1 and ϕ2 be the induced Frobenius
maps on OB+
cris , respectively. Then for any quasi-compact U ∈ Xproét , we have the
following relation on OB+
cris (U ):
(2.3.1)

ϕ2 =

X

(

d
d
Y
Y
(σ2 (Ti ) − σ1 (Ti ))[ni ] )(ϕ1 ◦ ( Nini ))
i=1

(n1 ,...,nd )∈Nd i=1

where the Ni ’s are the endomorphisms of OB+
cris such that ∇ =

Pd

i=1

Ni ⊗ dTi .

Proof. We only need to check the almost analogue for OAcris . To simplify the
notations, we shall use the multi-index: for m = (m1 , . . . , ud ) ∈ Nd , set N m :=
Qd
P
mi
and |m| := i mi . Let us remark first that for any a ∈ OAcris (U ) and
i=1 Ni
m
any r ∈ N, N (a) ∈ pr · OAcris (U ) when |m| is sufficiently large. As U is quasib = Spa(R, R+ ). As
compact, we may and do assume U is affinoid perfectoid with U
OAcris has no p-torsions, up to replacing a by p · a, we may and do assume that a
is of the form
X
bm · u[m] , bm ∈ Acris (R, R+ ) and lim bm = 0.
a=
|m|→∞

m∈Nd

Here we have again used the almost isomorphism (2.2.4). An easy calculation shows
X
X
N n (a) =
bm+n u[m] .
bm u[m−n] =
m≥n

m∈Nd

As the coefficient bm tends to 0 for the p-adic topology when |m| goes to infinity, it
follows that N n (a) ∈ pr · OAcris (U ) when |n| ≫ 0, as desired. Meanwhile, note that

18

FUCHENG TAN, JILONG TONG

ur+
ur+
σ2 (Ti ) − σ1 (Ti ) ∈ pOX
(U ), hence their divided powers lie in OX
(U ). Therefore
the series of the righthand side of (2.3.1) applied to a converges.
It remains to verify the formula (2.3.1) for any a ∈ OAcris (U ). Assume again U
is affinoid perfectoid. Since both sides of (2.3.1) are semilinear with respect to the
Frobenius of Acris , it suffices to check the equality for a = u[m] . In fact, we have
P

Qd
Qd
[ni ]
)(ϕ1 ◦ ( i=1 Nini )) (u[m] )
(n1 ,...,nd )∈Nd ( i=1 (σ2 (Ti ) − σ1 (Ti ))
P
[n]
(ϕ1 (N n (u[m] )))
=
d (σ (T ) − σ1 (T ))
Pn∈N 2
[n]
=
(ϕ1 (N n (u[m] )))
d (ϕ (u) − ϕ1 (u))
Pn∈N 2
[n]
· ϕ1 (u)[m−n]
=
n∈Nd s.t. n≤m (ϕ2 (u) − ϕ1 (u))
= (ϕ2 (u) − ϕ1 (u) + ϕ1 (u))[m]
= ϕ2 (u[m] ).

This finishes the proof.



2.4. Comparison with de Rham period sheaves. Let X be a locally noetherian adic space over Spa(k, Ok ) and recall the map (2.1.2). Set B+
Binf /(ker θ)n ,
dR = lim
←
−
r
r +
BdR = B+
dR [1/t]. For r ∈ Z, let Fil BdR = (ker θ) BdR . By its very definition, the
filtration on BdR is decreasing, separated and exhaustive. Similarly, with OBinf
r
+
+
r
in place of Binf , we define OB+
dR and OBdR . Define Fil OBdR = (ker θX ) OBdR
P
r+s
r
+
+
−s
Fil
OBdR . The filtration on OBdR is decreasing,
and Fil OBdR =
s∈Z t
separated and exhaustive. Moreover, as in [Bri, 5.2.8, 5.2.9], one can also show
that
r
r
+
OB+
dR ∩ Fil OBdR = Fil OBdR ,
which in particular implies that the filtration on OBdR is also (decreasing and)
separated and exhaustive.
In the rest of this subsection, assume k/Qp is absolutely unramified.
Lemma 2.21. Let X be a smooth formal scheme over Ok .
(1) There are natural injective morphisms
+
B+
cris ֒→ BdR ,

+
OB+
cris ֒→ OBdR .

+
+
In the following, we will view B+
cris (resp. OBcris ) as a subring of BdR (resp.
of OB+
dR ).
(2) For any integer i ≥ 0, one has
i
+
+
Fili B+
cris = Fil OBdR ∩ Bcris

i
+
+
Fili OB+
cris = Fil OBdR ∩ OBcris .

i
+
In particular, the filtration {Fili B+
cris : i ∈ Z} (resp. {Fil OBcris : i ∈ Z})
+
+
on Bcris (resp. on OBcris ) is decreasing, separated and exhaustive.
(3) For i ≥ 0, the following canonical morphisms are isomorphisms:
∼

gri B+
→ gri B+
cris −
dR ,

∼

gri OB+
→ gri OB+
cris −
dR .

Proof. (1) We will first construct the two natural morphisms claimed in our lemma.
d
+
, and that B+ is a
Recall that we have the natural mophism θ : W (O♭+ ) → O
X

X

sheaf of Qp -algebras. In particular, under the natural morphism

dR

♭+
♭+
Ainf = W (OX
) −→ W (OX
)[1/p] −→ B+
dR ,

the ideal of B+
dR generated by the image of ker(θ) has a PD-structure. Therefore,
the composed morphism above extends to a unique morphism A0cris → B+
dR . On

Crystalline comparison isomorphism in p-adic Hodge theory

19

n +
the other hand, for each n, the quotient B+
dR / Fil BdR is p-adically complete, the
composite
n +
+
A0cris −→ B+
dR −→ BdR / Fil BdR
factors through the p-adic completion Acris of A0cris , giving a morphism Acris →
n +
B+
dR / Fil BdR . On passing to limit with respect to n, we get a morphism Acris →
+
+
B+
dR , whence the required natural morphism Bcris → BdR by inverting p ∈ Acris .
+
The natural morphism from OBcris → OBdR is constructed in a similar way.
The two morphisms constructed above are compatible with the isomorphisms in
Corollary 2.14 and its de Rham analogue [Sch13, Proposition 6.10]. To finish the
+
proof of (1), we only need to show the morphism B+
cris → BdR constructed above
is injective. Let k be an algebraic closure of k. We only need to check that for
+
any affinoid perfectoid U lying above Xk , the induced map B+
cris (U ) → BdR (U ) is
b = Spa(R, R+ ). Using the identification in Lemma 2.5 together
injective. Write U
with its de Rham analogue ([Sch13, Theorem 6.5]), we are reduced to showing that
+
+
+
the map h : B+
cris (R, R ) → BdR (R, R ) is injective, where h is constructed analo+
+
gously as the natural map Bcris → BdR above. This is proved in [Bri, Proposition
6.2.1], and we reproduce the proof here for the sake of completeness.
+
+
As B+
cris (R, R ) = Acris (R, R )[1/p], we only need to show the following com′
posite h is injective:

/ B+ (R, R+ ) h / B+ (R, R+ ) .
h′ : Acris (R, R+ )
cris
dR

For n ≥ 0, let J [n] ⊂ Acris (R, R+ ) denote the closure for the p-adic topology of
the ideal generated by ξ [i] = ξ i /i! (i ≥ n), with ξ := [p♭ ] − p ∈ Acris generating
−1
+
[n]
. Clearly only
the kernel of θ. We claim first that h′ (Filn B+
dR (R, R )) = J
−1
n
+
′
+
[n]
the inclusion h (Fil BdR (R, R )) ⊂ J requires verification. The case n = 1
is obvious from the definition. For general n ≥ 2, we will proceed by induction.
−1
+
[n−1]
Let x ∈ h′ (Filn B+
. Write x =
dR (R, R )). By induction hypothesis, x ∈ J
[n−1]
♭+
[n]
x0 ξ
+ x1 with x0 ∈ W (R ) and x1 ∈ J . Under the identification
+
Filn−1 B+
dR (R, R ) ∼
−
→ R · ξ n−1 ,
n +
Fil BdR (R, R+ )

aξ n−1 7→ θ(a)ξ n−1 ,

+
n−1
the class of h′ (x) ∈ Filn−1 B+
/(n − 1)!. As
dR (R, R ) corresponds to θ(x0 )ξ
n +
′
+
h (x) lies in Fil BdR (R, R ), it follows that θ(x0 ) = 0. So x0 ∈ J and thus
+
x = x0 ξ [n−1] + x1 ∈ J [n] . Consequently J [n] = h−1 (Filn B+
dR (R, R )).
T
To conclude the proof of injectivity of h′ , it remains to show n J [n] = 0 in
Acris (R, R+ ). Recall from the proof of Lemma 2.13

Acris (R, R+ )/(p) ≃

(R♭+ /(p♭ )p )[δ0 , δ1 , . . .]
(δ0p , δ1p , . . .)

for δi the image of γ i+1 (ξ), where γ(x) = xp /p. Under this isomorphism, for
n
any n ≥ 1, the image of J [p ] in Acris (R, R+ )/(p) is generated by (δi )i≥n−1 .
T
T
This implies that i∈Z≥1 J [i] ⊂ pAcris (R, R+ ). Take x = px′ ∈ i≥1 J [i] with
T
+
+
x′ ∈ Acris (R, R+ ). Then h′ (x′ ) ∈ i Fili B+
dR (R, R ) as p ∈ Bcris is invertible.
T
T
−1
i
Thus x′ ∈ i h′ (Fil BdR (R, R+ )) = i J [i] ⊂ pAcris (R, R+ ). Hence x = px′ ∈
T
p2 Acris (R, R+ ). Repeating this argument, one sees that i∈Z≥1 J [i] ⊂ pn Acris for
T
any n ≥ 1. So i∈Z≥1 J [i] = {0} as Acris is p-adically separated. Thus we have

20

FUCHENG TAN, JILONG TONG

+
+
+
constructed a natural injection B+
cris ֒→ BdR . The claim OBcris ֒→ OBdR follows
from this: this is a local question on Xproét , thus we may assume that our formal
scheme X admits an étale map to Spf(Ok {T1±1 , . . . , Td±1 }), and then conclude by
Corollary 2.14 and its de Rham analogue [Sch13, Proposition 6.10].
T i +
(2) To check Fili B+
= B+
Fil BdR , it suffices to show Fili B+
cris
cris
cris (U ) =
T
i +
+
b
Bcris (U ) Fil BdR (U ) for any affinoid perfectoid U above Xk . Write U = Spa(R, R+ ).
+
+
+
+
+
Under the identifications B+
dR (R, R ) ≃ BdR (U ) and Bcris (R, R ) ≃ Bcris (U ), we
i +
i +
i +
i +
+
+
have Fil Bcris (U ) = Fil Bcris (R, R ), and Fil BdR (U ) = Fil BdR (R, R ) (Lemma
2.5). On the other hand, from the proof of (1), we have J [i] = h−1 (Fili BdR (R, R+ )) =
T
Acris (R, R+ ) Fili BdR (R, R+ ), from which we deduce
\ i
+
+
+
+
Fili B+
Fil B+
cris (R, R ) = Bcris (R, R )
dR (R, R ),

as desired.
i
+ T
+
To show Fili OB+
Fili OB+
cris = OBcris
dR , we only need to check Fil OBcris ⊃
T
OB+
Fili OB+
cris
dR . For this we may again assume the formal scheme X admits an
étale map to Spf(Ok {T1±1 , . . . , Td±1 }). Then we can conclude by Corollary 2.14 and
its de Rham analogue.
i +
(3) From (2), we know that the canonical morphism gri B+
cris → gr BdR is injective. Furthermore we have the identification
Fili B+
∼ d
dR |Xk
gri B+
|
−
→ OX |Xk · ξ i , aξ i 7→ θ(a)ξ i .
=
dR Xk
i+1 +
Fil
BdR |Xk
i +
i +
As ξ i = i!ξ [i] ∈ Fili B+
cris , the injection gr Bcris ֒→ gr BdR is also surjective. Thus
∼
i +
i +
gr Bcris −
→ gr BdR . Using Corollary 2.14 and its de Rham analogue, we see that
∼
the latter isomorphism also implies that gri OB+
→ gri OB+

cris −
dR .

Corollary 2.22. Let X be a smooth formal scheme over Ok .
(1) There are two natural injections
Bcris ֒→ BdR ,

OBcris ֒→ OBdR .
T
(2) For any i ∈ Z, we have Fil Bcris = Bcris Fili BdR and Fili OBcris =
T i
OBcris Fil OBdR .
∼
∼
→ gri OBdR . In par→ gri BdR and gri OBcris −
Furthermore, gri Bcris −
i
i
ticular, the filtration {Fil Bcris }i∈Z (resp. {Fil OBcris }i∈Z ) is decreasing,
separated and exhaustive.
i

Proof. These follow from the previous lemma, by inverting t.



As a consequence, we can compute the cohomology of the graded quotients gri F
+
for F ∈ {B+
cris , Bcris , OBcris , OBcris }: one just reduces to its de Rham analogue such
as [Sch13, Proposition 6.16] etc.
Corollary 2.23. Let X be a smooth adic space over Spa(k, Ok ) which admits a
smooth formal model X over Ok (so that we can define OBcris ), then
w∗ OBcris ≃ OXét [1/p].
∼
∼
∼
∼
→ Xét
the natural morphisms of topoi.
and ν ′ : Xét
Proof. Let ν : Xproét
→ Xét
′
Then w = ν ◦ ν. Therefore
∼

∼

→ ν∗′ ν∗ OX = w∗ OX .
OXét [1/p] −
→ ν∗′ OXét −

Crystalline comparison isomorphism in p-adic Hodge theory

21

By [Sch13, Corollary 6.19], the natural morphism OXét → ν∗ OBdR is an isomorphism. Thus, w∗ OBdR = ν∗′ (ν∗ OBdR ) ≃ ν∗′ OXét ≃ OXét [1/p]. On the other
hand, we have the injection of OXét [1/p]-algebras w∗ OBcris ֒→ w∗ OBdR . Thereby
∼
OXét [1/p] −
→ w∗ OBcris .

3. Crystalline cohomology and pro-étale cohomology
In this section, we assume k is absolutely unramified. Let σ denote the Frobenius
on Ok and on k, lifting the Frobenius of the residue field κ. Note that the ideal
(p) ⊂ Ok is endowed naturally with a PD-structure and Ok becomes a PD-ring in
this way.
3.1. A reminder on convergent F -isocrystals. Let X0 be a κ-scheme of finite
type. Let us begin with some general definitions about crystals on the small crystalline site (X0 /Ok )cris endowed with étale topology. For basics of crystals, we refer
to [Ber96], [BO]. Recall that a crystal of OX0 /Ok -modules is an OX0 /Ok -module
E on (X0 /Ok )cris such that (i) for any object (U, T ) ∈ (X0 /Ok )cris , the restriction
ET of E to the étale site of T is a coherent OT -module; and (ii) for any morphism
∼
→ ET ′ is an
u : (U ′ , T ′ ) → (U, T ) in (X0 /Ok )cris , the canonical morphism u∗ ET −
isomorphism.
Remark 3.1. Write X0 the closed fiber of a smooth formal scheme X over Ok .
Then the category of crystals on (X0 /Ok )cris is equivalent to that of coherent OX modules M equipped with an integrable and quasi-nilpotent connection ∇ : M →
M ⊗OX Ω1X /Ok . Here the connection ∇ is said to be quasi-nilpotent if its reduction
modulo p is quasi-nilpotent in the sense of [BO, Definition 4.10]. The correspondence between these two categories is given as follows: for E a crystal on X0 /Ok , as
X0 ֒→ X is a p-adic PD-thickening, we can evalue E at it: set EX := limn EX ⊗Ok /pn .
←−
Let ∆1 ֒→ X × X be the PD-thickening of order 1 of the diagonal embedding
X ֒→ X × X . The two projections pi : ∆1 → X are PD-morphisms. So we have two
∼
→ E∆1 := limn E∆1 ⊗Ok /pn , whence a natural isomorphism
isomorphisms p∗i EX −
←−
∼
∗
∗
→ p1 EX . The latter isomorphism gives a connection ∇ : EX → EX ⊗ Ω1X /Ok
p2 EX −
on EX . Together with a limit argument, that ∇ is integrable and quasi-nilpotent
is due to [BO, Theorem 6.6].
The absolute Frobenius F : X0 → X0 is a morphism over the Frobenius σ on Ok ,
hence it induces a morphism of topoi, still denoted by F :
∼

∼

F : (X0 /Ok )cris −→ (X0 /Ok )cris .
An F -crystal on (X0 /Ok )cris is a crystal E equipped with a morphism ϕ : F ∗ E → E
of OX0 /Ok -modules, which is nondegenerate, i.e. there exists a map V : E → F ∗ E
of OX0 /Ok -modules such that ϕV = V ϕ = pm for some m ∈ N. In the following,
we will denote by F -Cris(X0 , Ok ) the category of F -crystals on X0 /Ok .
Before discussing isocrystals, let us first observe the following facts.
Remark 3.2. Let X rig be a classical rigid analytic space over k, with associated
adic space X. Using [Sch13, Theorem 9.1], one sees that the notion of coherent
OX rig -modules on X rig coincides with that of coherent OXan -modules on Xan , where
Xan denote the site of open subsets of the adic space X.

22

FUCHENG TAN, JILONG TONG

Remark 3.3. Let X be a smooth formal scheme over Ok , with X its generic fiber
in the sense of Huber. Let Coh(OX [1/p]) denote the category of coherent OX [1/p]modules on X , or equivalently, the full subcategory of the category of OX [1/p]modules on X consisting of OX [1/p]-modules which are isomorphic to M+ [1/p] for
some coherent sheaf M+ on X . Denote also Coh(OXan ) the category of coherent
OXan -modules on X. The analytification functor gives a fully faithful embedding
Coh(OX [1/p]) ֒→ Coh(OXan ). Moreover, the essential image is stable under taking
direct summands (as OXan -modules). Indeed, let E be a coherent OXan -module
admitting a coherent formal model E + over X , and E ′ ⊂ E a direct summand. Let
f : E → E be the idempotent corresponding to E ′ : write E = E ′ ⊕ E ′′ , then f is the
composite of the projection from E to E ′ followed by the inclusion E ′ ⊂ E. Therefore,
there exists some n ≫ 0 such that pn f comes from a morphism f + : E + → E + of
OX -modules. Then the image of f + gives a formal model of E ′ over X , as desired.
Let X0 be a κ-scheme of finite type. Asumme that it can be embedded as a
closed subscheme into a smooth formal scheme P. Let P be the associated adic
space of P and ]X0 [P ⊂ P the pre-image of the closed subset X0 ⊂ P under the
specialization map. Following [Ber96, 2.3.2 (i)] (with Remark 3.2 in mind), the
realization on P of a convergent isocrystal on X0 /Ok is a coherent O]X0 [P -module E
equipped with an integrable and convergent connection ∇ : E → E ⊗O]X0 [P Ω1]X0 [P /k
(we refer to [Ber96, 2.2.5] for the definition of convergent connections). Being a
coherent O]X0 [P -module with integrable connection, E is locally free of finite rank
by [Ber96, 2.2.3 (ii)]. The category of realizations on P of convergent isocrystals
on X0 /Ok is denoted by Isoc† (X0 /Ok , P), where the morphisms are morphisms of
O]X0 [P -modules which commute with connections.
Let X0 ֒→ P ′ be a second embedding of X0 into a smooth formal scheme P ′ over
Ok , and assume there exists a morphism u : P ′ → P of formal schemes inducing
identity on X0 . The generic fiber of u gives a morphism of adic spaces uk : ]X0 [P ′ →
]X0 [P , hence a natural functor
u∗k : Isoc† (X0 /Ok , P) −→ Isoc† (X0 /Ok , P ′ ),

(E, ∇) 7→ (u∗k E, u∗k ∇).

By [Ber96, 2.3.2 (i)], the functor u∗k is an equivalence of categories. Furthermore,
for a second morphism v : P ′ → P of formal schemes inducing identity on X0 , the
two equivalence u∗k , vk∗ are canonically isomorphic ([Ber96, 2.2.17 (i)]). Now the
category of convergent isocrystal on X0 /Ok , denoted by Isoc† (X0 /Ok ), is defined as
Isoc† (X0 /Ok ) := 2-lim Isoc† (X0 /Ok , P),
−→
P

where the limit runs through all smooth formal embedding X0 ֒→ P of X0 .
Remark 3.4. In general, X0 does not necessarily admit a global formal embedding.
In this case, the category of convergent isocrystals on X0 /Ok can still be defined
by a gluing argument (see [Ber96, 2.3.2(iii)]). But the definition recalled above will
be enough for our purpose.
As for the category of crystals on X0 /Ok , the Frobenius morphism F : X0 → X0
induces a natural functor (see [Ber96, 2.3.7] for the construction):
F ∗ : Isoc† (X0 /Ok ) −→ Isoc† (X0 /Ok ).

Crystalline comparison isomorphism in p-adic Hodge theory

23

A convergent F -isocrystal on X0 /Ok is a convergent isocrystal E on X0 /Ok
∼
equipped with an isomorphism F ∗ E −
→ E in Isoc† (X0 /Ok ). The category of convergent F -isocrystals on X0 /Ok will be denoted in the following by F -Isoc† (X0 /Ok ).
Remark 3.5. The category F -Isoc† (X0 /Ok ) has as a full subcategory the isogeny
category F -Cris(X0 /Ok )⊗Q of F -crystals E on (X0 /Ok )cris . To explain this, assume
for simplicity that X0 is the closed fiber of a smooth formal scheme X over Ok . So
]X0 [X = X, the generic fiber of X . Let (M, ∇) be the OX -module with integrable
and quasi-nilpotent connection associated to the F -crystal E (Remark 3.1). Let
Ean := Mν denote the generic fiber of M, which is a coherent (hence locally
free by [Ber96, 2.3.2 (ii)]) OXan -module equipped with an integrable connection
∇an : Ean −→ Ean ⊗ Ω1Xan /k , which is nothing but the generic fiber of ∇. Because of
the F -crystal structure on E, the connection ∇an is necessarily convergent ([Ber96,
2.4.1]). In this way we obtain an F -isocrystal Ean on X0 /Ok , whence a natural
functor
(3.1.1)

(−)an : F -Cris(X0 /Ok ) ⊗ Q −→ F -Isoc† (X0 /Ok ),

E 7→ Ean .

By [Ber96, 2.4.2], this analytification functor is fully faithful, and for E a convergent
F -isocrystal on X0 /Ok , there exists an integer n ≥ 0 and an F -crystal E such that
∼
∼
E−
→ Ean (n), where for F = (F , ∇, ϕ : F ∗ F −
→ F ) an F -isocrystal on X0 /Ok , F (n)
∼
denotes the Tate twist of F , given by (F , ∇, pϕn : F ∗ F −
→ F ) ([Ber96, 2.3.8 (i)]).
Our next goal is to give a more explicit description of the Frobenii on convergent
F -isocrystals on X0 /Ok . From now on, assume for simplicity that X0 is the closed
fiber of a smooth formal scheme X and we shall identify the notion of convergent
iscrystals on X0 /Ok with its realizations on X . Let X be the generic fiber of X .
The proof of the following lemma is obvious.
Lemma 3.6. Assume that the Frobenius F : X0 → X0 can be lifted to a morphism
σ : X → X compatible with the Frobenius on Ok . Still denote by σ the endomorphism on X induced by σ. Then there is an equivalence of categories between
(1) the category F -Isoc† (X0 /Ok ) of convergent F -isocrystals on X0 /Ok ; and
(2) the category Modσ,∇
OX of OXan -vector bundles E equipped with an integrable
and convergent connection ∇ and an OXan -linear horizontal isomorphism
ϕ : σ ∗ E → E.
Consider two liftings of Froebnius σi (i = 1, 2) on X . By the lemma above,
σi ,∇
for i = 1, 2, both categories ModO
are naturally equivalent to the category of
X
convergent F -iscrystals on X0 /Ok :
ModσO1X,∇ o

∼

F -Isoc† (X0 /Ok )

∼

/ Modσ2 ,∇ .
OX

Therefore we deduce a natural equivalence of categories
(3.1.2)

Fσ1 ,σ2 : ModσO1X,∇ −→ ModσO2X,∇ .

When our formal scheme X is small, we can explicitly describe this equivalence as
follows. Assume there is an étale morphism X → T d = Spf(Ok {T1±1 , . . . , Td±1 }).
So Ω1Xan /k is a free OXan -module with a basis given by dTi (i = 1, . . . , d). In the
following, for ∇ a connection on an OXan -module E, let Ni be the endomorphism
P
of E (as an abelian sheaf) such that ∇ = di=1 Ni ⊗ dTi .

24

FUCHENG TAN, JILONG TONG

Lemma 3.7 (see also [Bri] 7.2.3). Assume X = Spf(A) is affine and that there
exists an étale morphism X → T d as above. For (E, ∇, ϕ1 ) ∈ ModσO1X,∇ , with
(E, ∇, ϕ2 ) the corresponding object of ModσO2X,∇ under the functor Fσ1 ,σ2 . Then on
E(X) we have
!!
!
d
d
Y
X
Y
ni
[ni ]
.
Ni
ϕ1 ◦
(σ2 (Ti ) − σ1 (Ti ))
(3.1.3)
ϕ2 =
(n1 ,...,nd )∈Nd

i=1

i=1

Furthermore, ϕ1 and ϕ2 coincide on E(X)∇=0 .

Q
Proof. To simplify the notations, we shall use the multi-index: so N n := n Nini
for n = (n1 , . . . , nd ) ∈ Nd etc. We observe first that the right hand side of (3.1.3)
converges. Indeed, by [Ber96, 2.4.2], there exists some n ∈ N such that E(−n) lies in
the essential image of the functor (3.1.1). In particular, this implies that there exists
a coherent OX -module E + equipped with a quasi-nilpotent connection ∇+ such that
(E, ∇) is the generic fiber of (E + , ∇+ ). In particular, for any e ∈ E + := E + (X ),
N n (e) ∈ p · E + for all but finitely many n ∈ Nd . Furthermore, as σ1 , σ2 are liftings
of Frobenius, σ2 (Ti )− σ1 (Ti ) ∈ p·A. So the divided power (σ2 (Ti )− σ1 (Ti ))[ni ] ∈ A.
Thereby the right hand side of (3.1.3) applied to an element of E(X) = E + [1/p]
converges for the cofinite filter on Nd .
Next we claim that the equality (3.1.3) holds when E = OXan endowed with the
natural structure of F -isocrystal. Indeed, necessarily ϕi = σi in this case. Let σ2′ be
the endomorphism of A defined by the right hand side of (3.1.3). Then both σ2 , σ2′
are liftings of Frobenius on A, and it is elementary to check that they coincide
on the Ok -subalgbra Ok {T1±1 , . . . , Td±1 }. As A is étale over Ok {T1±1 , . . . , Td±1 },
we deduce σ2 = σ2′ , giving our claim. By consequence, in the general case, the
right hand side of (3.1.3) defines a σ2 -semilinear endomorphism ϕ′2 on E(X). In
particular, we obtain a morphism of OXan -modules σ2∗ E → E, still denoted by ϕ′2 .
One checks that ϕ′2 : σ2∗ E → E is horizontal, hence it is a morphism of convergent
isocrystals.
Now one needs to verify the equality (3.1.3). Consider the fiber product X × X
and its generic fiber X × X. Let U =]X0 [X ×X ⊂ X × X denote the pre-image of
the closed subset δ(X0 ) ⊂ X0 × X0 under the specialization map, and qi : U → X
(i = 1, 2) the two projections. If we endow X × X with the Frobenius σ := σ1 × σ2 ,
then σi ◦ qi = qi ◦ σ. In particular, the pull-back q1∗ E is endowed with a morphism
q1∗ ϕ1 : σ ∗ q1∗ E = q1∗ σ1∗ E −→ q1∗ E.
Similarly, q2∗ E is a convergent isocrystal on U endowed with a horizontal morphism
q2∗ ϕ′2 . Consider the following OUan -linear isomorphism induced by the connection
on E:
X N n (m) ⊗ τ n
∼
,
η : OUan ⊗OXan E −→ E ⊗OXan OUan , 1 ⊗ m 7→
n!
d
n∈N

where τ = (τ1 , . . . , τd ) with τi = 1 ⊗ Ti − Ti ⊗ 1 (note that this formula makes sense
as the connection on E is convergent (see [Ber96, 2.2.5])). By a direct calculation,

Crystalline comparison isomorphism in p-adic Hodge theory

25

one checks the commutativity of the following diagram:
q2∗ ϕ′2

σ ∗ (OUan ⊗ E)
σ∗ (η)

η


σ ∗ (E ⊗ OUan )
Indeed, taking m ∈ E, we find
X N n (ϕ′ (m)) ⊗ τ n
2

n∈Nd

n!

/ OUan ⊗ E

q1∗ ϕ1

=


/ E ⊗ OUan .

X ϕ1 (N n (m)) ⊗ σ
b(τ n )
.
n!
d

n∈N

Finally, let I = (τ1 , . . . , τd ) be the ideal defining the closed immersion X ֒→ U .
Then modulo the ideal I in the above equality, the left hand side becomes just
ϕ′2 (m). Moreover, as σ(τi ) = σ2 (Ti ) − σ1 (Ti ), we find the following equality in E:
X ϕ1 (N n (m)) · Q (σ2 (Ti ) − σ1 (Ti ))ni
i
ϕ2 (m) =
,
n!
d
n∈N

as desired.
In particular, ϕ′2 : σ2∗ E → E is a horizontal isomorphism, hence (E, ∇, ϕ′2 ) is an
F -isocrystal. Moreover q1∗ (E, ∇, ϕ1 ) and q2∗ (E, ∇, ϕ′2 ) are isomorphic as realizations
of F -isocrystals on the embedding X0 ֒→ X × X . Therefore, by definition [Ber96,
2.3.2], (E, ∇, ϕ1 ) and (E, ∇, ϕ′2 ) realize the same F -isocrystal on X0 /Ok .
The last statement of our lemma is clear from the formula just proved as E(X)∇=0 =
Td

i=1 ker(Ni ).
More generally, i.e. without assuming the existence of Frobenius lifts to X , for
(E, ∇) an OXan -module with integrable and convergent connection, a compatible
system of Frobenii on E consists of, for any open subset U ⊂ X equipped with a
lifting of Frobenius σU , a horizontal isomorphism ϕ(U ,σU ) : σU∗ E|Uk → E|Uk satisfying
the following condition: for V ⊂ X another open subset equipped with a lifting of
Frobenius σV , the functor
σU ,∇
σV ,∇
−→ ModO
FσU ,σV : ModO
T
T
U
V
U
V
k

k

k

k

sends (E|Uk T Vk , ∇, ϕ(U ,σU ) |Uk T Vk ) to (E|Uk T Vk , ∇, ϕ(V,σV ) |Uk T Vk ). We denote a
compatible system of Frobenii on E by the symbol ϕ, when no confusion arises. Let
Modσ,∇
OX be the category of OXan -vector bundles equipped with an integrable and
convergent connection, and with a compatible system of Frobenii. The morphism in
Modσ,∇
OX are the morphisms of OXan -modules which commute with the connections,
and with the Frobenius morphisms on any open subset U ⊂ X equipped with a
lifting of Frobenius.
Remark 3.8. Let E be a convergent isocrystal on X0 /Ok . To defineSa compatible
system of Frobenii on E, we only need to give, for a cover X = i Ui of X by
open subsets Ui equipped with a lifting of Frobenius σi , a family of Frobenius
∼
morphisms ϕi : σi∗ E|Ui → E|Ui such that ϕi |Ui T Uj corresponds to ϕj |Ui T Uj under
σ ,∇
the functor Fσi ,σj : ModσOiU,∇T U → ModOjU T U (Here U• := U•,k ). Indeed, for
i
j
i
j
U any open subset equipped with a lifting of Frobenius σU , one can first use the
functor Fσi ,σU of (3.1.2) applied to (E|Ui , ∇|Ui , ϕi )|Ui T U to obtain a horizontal

26

FUCHENG TAN, JILONG TONG

isomorphism ϕU ,i : (σU∗ (E|U ))|Ui T U → E|Ui T U . From the compatibility of the ϕi ’s,
we deduce ϕU ,i |U T Ui T Uj = ϕU ,j |U T Ui T Uj . Consequently we can glue the ϕU ,i ’s
(i ∈ I) to get a horizontal isomorphism ϕU : σU∗ (E|U ) → E|U . One checks that these
ϕU ’s give the desired compatible system of Frobenii on E.
Let E be a convergent F -isocrystal on X0 /Ok . For U ⊂ X an open subset equipped with a lifting of Frobenius σU , the restriction E|Uk gives rise to a
convergent F -isocrystal on U0 /k. Thus there exists a ∇-horizontal isomorphism
ϕ(U ,σU ) : σU∗ E|Uk → E|Uk . Varying (U, σU ) we obtain a compatible system of Frobenii
ϕ on E. In this way, (E, ∇, ϕ) becomes an object of Modσ,∇
OX . Directly from the
definition, we have the following
Corollary 3.9. The natural functor F -Isoc† (X0 /Ok ) → Modσ,∇
OX is an equivalence
of categories.
•
In the following, denote by FModσ,∇
OX the category of quadruples (E, ∇, ϕ, Fil (E))
with (E, ∇, ϕ) ∈ Modσ,∇
OX and a decreasing, separated and exhaustive filtration
Fil• (E) on E by locally free direct summands, such that ∇ satisfies Griffiths transversality with respect to Fil• (E), i.e., ∇(Fili (E)) ⊂ Fili−1 (E) ⊗OXan Ω1Xan /k . The

morphisms are the morphisms in Modσ,∇
OX which respect the filtrations. We call
σ,∇
the objects in FModOX filtered (convergent) F -isocrystals on X0 /Ok . By analogy
with the category F -Isoc† (X0 /Ok ) of F -isocrystals, we also denote the category of
filtered F -isocrystals on X0 /Ok by F F -Isoc† (X0 /Ok ).
b p -sheaves and filtered F -isocystals. Let X be a smooth formal
3.2. Lisse Z
b p := lim Z/pn
scheme over Ok with X its generic fiber in the sense of Huber. Define Z
←−
b p := Z
b p [1/p] as sheaves on Xproét . Recall that a lisse Zp -sheaf on Xét is an
and Q
inverse system of sheaves of Z/pn -modules L• = (Ln )n∈N on Xét such that each
Ln is locally a constant sheaf associated to a finitely generated Z/pn -modules, and
such that the inverse system is isomorphic in the pro-category to an inverse system
b p -sheaf on Xproét is a sheaf of Z
b p -modules on
for which Ln+1 /pn ≃ Ln . A lisse Z
b
Xproét , which is locally isomorphic to Zp ⊗Zp M where M is a finitely generated
Zp -module. By [Sch13, Proposition 8.2] these two notions are equivalent via the
∼
∼
. In the following, we use the natural morphism of topoi
→ Xproét
functor ν ∗ : Xét
ν
∼
∼
∼
w : Xproét → Xét → Xét frequently. Before defining crystalline sheaves let us first
make the following observation.
Remark 3.10. (1) Let M be a crystal on X0 /Ok , viewed as a coherent OX -module
ur+
admitting an integrable connection. Then w−1 M is a coherent OX
-module with
1,ur+
−1
−1
an integrable connection w M → w M ⊗Our+ ΩX/k . If furthermore M is an
X
F -crystal, then w−1 M inherits a system of Frobenii: for any open subset U ⊂ X
equipped with a lifting of Frobenius σU , there is naturally an endomorphism of
ur+
w−1 M|U which is semilinear with respect to the Frobenius w−1 σU on OX
|U (here
U := Uk ). Indeed, the Frobenius structure on M gives a horizontal OU -linear
morphism σU∗ M|U → M|U , or equivalently, a σU -semilinear morphism ϕU : M|U →
M|U (as σU is the identity map on the underlying topological space). So we obtain
a natural endomorphism w−1 ϕU of w−1 M|U , which is w−1 σU -semilinear.

Crystalline comparison isomorphism in p-adic Hodge theory

27

(2) Let E be a convergent F -isocrystal on X0 /Ok . By Remark 3.5, there exists
an F -crystal M on X0 /Ok and n ∈ N such that E ≃ Man (n). By (1), w−1 M is
ur+
a coherent OX
-module equipped with an integrable connection and a compatible
ur
system of Frobenii ϕ. Inverting p, we get an OX
-module w−1 M[1/p] equipped with
an integrable connection and a system of Frobenii ϕ/pn , which does not depend
on the choice of the formal model M or the integer n. For this reason, abusing
notation, let us denote w−1 M[1/p] by w−1 E, which is equipped with an integrable
connection and a system of Frobenii inherited from E. If furthermore E has a
descending filtration {Fili E} by locally direct summands, by Remark 3.3, each
Fili E has a coherent formal model Ei+ on X . Then {w−1 Ei+ [1/p]} gives a descending
filtration (by locally direct summands) on w−1 E.
b p -sheaf L on Xproét is crystalline if there exists
Definition 3.11. We say a lisse Z
a filtered F -isocrystal E together with an isomorphism of OBcris -modules

(3.2.1)

ur OBcris ≃ L ⊗
w−1 E ⊗OX
bp OBcris
Z

which is compatible with connection, filtration and Frobenius. In this case, we say
b p -sheaf L and the filtered F -isocrystal E are associated.
that the lisse Z

Remark 3.12. The Frobenius compatibility of the isomorphism (3.2.1) means
the following. Take any open subset U ⊂ X equipped with a lifting of Frobenius
σ : U → U. By the discussion in §2.3, we know that OBcris |Uk is naturally endowed
with a Frobenius ϕ. Meanwhile, as E is an F -isocrystal, by Remark 3.10 w−1 E|Uk
is endowed with a w−1 σ-semilinear Frobenius, still denoted by ϕ. Now the required
Frobenius compatibility means that when restricted to any such Uk , we have ϕ⊗ϕ =
id ⊗ ϕ via the isomorphism (3.2.1).
b p -sheaf and i ∈ Z, set
Definition 3.13. For L a lisse Z
Dcris (L) := w∗ (L ⊗Zbp OBcris ),

and

Fili Dcris (L) := w∗ (L ⊗Zbp Fili OBcris ).

All of them are OX [1/p]-modules, and the Fili Dcris (L) give a separated exhaustive
decreasing filtration on Dcris (L) (as the same holds for the filtration on OBcris ; see
Corollary 2.22).
Next we shall compare the notion of crystalline sheaves with other related notions
considered in [Bri, Chapitre 8], [Fal] and [Sch13]. We begin with the following
characterization of crystalline sheaves, which is more closely related to the classical
definition of crystalline representations by Fontaine (see also [Bri, Chapitre 8]).
b p -sheaf on Xproét . Then L is crystalline if
Proposition 3.14. Let L be a lisse Z
and only if the following two conditions are verified:
(1) the OX [1/p]-modules Dcris (L) and Fili Dcris (L) (i ∈ Z) are all coherent.
ur OBcris → L ⊗
(2) the adjunction morphism w−1 Dcris (L) ⊗OX
bp OBcris is an
Z
isomorphism of OBcris -modules.
Before proving this proposition, let us express locally the sheaf Dcris (L) = w∗ (L⊗
OBcris ) as the Galois invariants of some Galois module. Consider U = Spf(R+ ) ⊂ X
a connected affine open subset admitting an étale map U → Spf(Ok {T1±1 , . . . , Td±1 }).
Write R = R+ [1/p] and denote U the generic fiber of U. As U is smooth and connected, R+ is an integral domain. Fix an algebraic closure Ω of Frac(R), and let
+
R be the union of finite and normal R+ -algebras Q+ contained in Ω such that

28

FUCHENG TAN, JILONG TONG
+

Q+ [1/p] is étale over R. Write R = R [1/p]. Write GU := Gal(R/R), which is
nothing but the fundamental group of U = Uk . Let U univ be the profinite étale
+
cover of U corresponding to (R, R ). One checks that U univ is affinoid perfectoid
b p -sheaf on X, its restriction to U
(over the completion of k). As L is a lisse Z
corresponds to a continuous Zp -representation VU (L) := L(U univ ) of GU . Write
\
univ = Spa(S, S + ), where (S, S + ) is the p-adic completion of (R, R+ ).
U
b p -sheaf on X. Then
Lemma 3.15. Keep the notation above. Let L be a lisse Z
there exist natural isomorphisms of R-modules
GU
∼
=: Dcris (VU (L))
Dcris (L)(U) −→ VU (L) ⊗Zp OBcris (S, S + )
and, for any r ∈ Z,

GU
∼
.
(Filr Dcris (L)) (U) −→ VU (L) ⊗Zp Filr OBcris (S, S + )

Moreover, the R-module Dcris (L)(U) is projective of rank at most that of VU (L)⊗Qp .
b p -sheaf, it becomes constant restricted to U univ . In other
Proof. As L is a lisse Z
b p |U univ . For i ≥ 0 an integer, we denote by
words, we have L|U univ ≃ VU (L) ⊗Zp Z
univ,i
univ
U
the (i+1)-fold product of U
over U . Then U univ,i ≃ U univ × GiU , and it is
again an affinoid perfectoid. By the use of Lemma 2.17, we find H j (U univ,i , L ⊗Zbp
OBcris ) = 0 for j > 0. Moreover

H 0 (U univ,i , L ⊗Zbp OBcris ) = Homcont GiU , VU (L) ⊗Zp OAcris (U univ ) [1/t].
Again, as U univ is affinoid perfectoid, OBcris (U univ ) ≃ OBcris (S, S + ) by Lemma
2.17. Consider the Cartan-Leray spectral sequence (cf. [SGA4, V.3]) associated to
the cover U univ → U :
E1i,j = H j (U univ,i , L ⊗Zbp OBcris ) =⇒ H i+j (U, L ⊗Zbp OBcris ).
As E1i,j = 0 for j ≥ 1, we have E2n,0 = H n (U, L ⊗Zbp OBcris ). Thus, we deduce a
natural isomorphism
∼

j
H j (U, L ⊗Zbp OBcris ) −→ Hcont
(GU , VU (L) ⊗Zp OAcris (S, S + ))[1/t]

where the right hand side is the continuous group cohomology. Taking j = 0, we
obtain our first assertion. The isomorphism concerning Filr OBcris can be proved
exactly in the same way. The last assertion follows from the first isomorphism and
[Bri, Proposition 8.3.1], which gives the assertion for the right hand side.

The lemma above has the following two consequences.
b p -sheaf on Xproét , which satisfies the condition
Corollary 3.16. Let L be a lisse Z
(1) of Proposition 3.14. Let U = Spf(R+ ) be a small connected affine open subset
of X . Write R = R+ [1/p] and U = Uk . Then for any V ∈ Xproét /U , we have
∼

ur OBcris )(V ).
Dcris (L)(U) ⊗R OBcris (V ) → (w−1 Dcris (L) ⊗OX

Proof. By Lemma 3.15, the R-module Dcris (L)(U) is projective of finite type over
R, hence it is a direct summand of a finite free R-module. As Dcris (L) is coherent
over OX [1/p] and as U is affine, Dcris (L)|U is then a direct summand of a finite free
OX [1/p]|U -module. The isomorphism in our corollary then follows, since we have
similar isomorphism when Dcris (L)|U is replace by a free OX [1/p]|U -module.


Crystalline comparison isomorphism in p-adic Hodge theory

29

b p -sheaf verifying the condition (1) of Proposition
Corollary 3.17. Let L be a lisse Z
3.14. Then the condition (2) of Proposition 3.14 holds for L if and only if for any
small affine connected open subset U ⊂ X (with U := Uk ), the GU -representation
VU (L) ⊗Zp Qp is crystalline in the sense that the following natural morphism is an
isomorphism ([Bri, Chapitre 8])
∼

Dcris (VU (L)) ⊗R OBcris (S, S + ) −→ VU (L) ⊗Zp OBcris (S, S + ),
\
univ = Spa(S, S + ) are as in the paragraph before Lemma 3.15.
where GU , U univ , U
Proof. If L satisfies in addition the condition (2) of Proposition 3.14, combining
with Corollary 3.16, we find
 ∼
univ
ur OBcris )(U
)
−→ (w−1 Dcris (L) ⊗OX
Dcris (L)(U) ⊗R OBcris U univ
∼

−→ (L ⊗Zbp OBcris )(U univ )
=

VU (L) ⊗Zp OBcris (U univ ).

So, by Lemmas 2.17 and 3.15, the GU -representation VU (L) ⊗ Qp is crystalline.
Conversely, assume that for any small connected affine open subset U = Spf(R+ )
of X , the GU -representation VU (L) ⊗Zp Qp is crystalline. Together with Lemmas
∼
2.17 and 3.15, we get Dcris (L)(U) ⊗R OBcris (U univ ) → VU (L) ⊗Zp OBcris (U univ ) and
univ
the similar isomorphism after replacing U
by any V ∈ Xproét /U univ . Using
∼
ur OBcris )(V ) → (L ⊗ b OBcris )(V ) for
Corollary 3.16, we deduce (w−1 Dcris (L) ⊗OX
Zp
∼

ur OBcris )| univ → (L ⊗ b OBcris )| univ .
any V ∈ Xproét /U univ , i.e., (w−1 Dcris (L) ⊗OX
U
U
Zp
When the small opens U’s run through a cover of X , the U univ ’s form a cover of
∼
X for the pro-étale topology. Therefore, w−1 Dcris (L) ⊗ OBcris → L ⊗ OBcris , as
desired.


b p -sheaf on X satisfying the two conditions of
Lemma 3.18. Let L be a lisse Z
Proposition 3.14. Then (the analytification of ) Dcris (L) has a natural structure of
filtered convergent F -isocrystal on X0 /Ok .
Proof. First of all, the Fili Dcris (L)’s (i ∈ Z) endow a separated exhaustive decreasing filtration on Dcris (L) by Corollary 2.22, and the connection on Dcris (L) =
w∗ (L ⊗ OBcris ) can be given by the composite of
w∗ (L ⊗ OBcris )

w∗ (id⊗∇)

−→
∼

−→

1,ur
ur Ω
w∗ (L ⊗ OBcris ⊗OX
X/k )

w∗ (L ⊗ OBcris ) ⊗OX [1/p] Ω1X /Ok [1/p]

where the last isomorphism is the projection formula. That the connection satisfies
the Griffiths transversality with respect to the filtration Fil• Dcris follows from the
analogous assertion for OBcris (Proposition 2.16).
Now consider the special case where X = Spf(R+ ) is affine connected admitting an étale map X → Spf(Ok {T1±1 , . . . , Td±1 }), such that X is equipped with
a lifting of Frobenius σ. As in the paragraph before Lemma 3.15, let X univ be
the univeral profinite étale cover of X (which is an affinoid perfectoid). Write
\
univ = Spa(S, S + ) and G
X
X the fundamental group of X. As X is affine, the
category Coh(OX [1/p]) is equivalent to the category of finite type R-modules (here
R := R+ [1/p]). Under this equivalence, Dcris (L) corresponds to Dcris (VX (L)) :=
(VX (L) ⊗ OBcris (S, S + ))GX , denoted by D for simplicity. So D is a projective

30

FUCHENG TAN, JILONG TONG

R-module of finite type (Lemma 3.15) equipped with a connection ∇ : D → D ⊗
Ω1R/k . Under the same equivalence, Fili Dcris (L) corresponds to Fili D := (VX (L) ⊗
Fili OBcris (S, S + ))GX , by Lemma 3.15 again. By the same proof as in [Bri, 8.3.2],
the graded quotient gri (D) is a projective module. In particular, Fili D ⊂ D is a
direct summand. Therefore, each Fili Dcris (L) is a direct summand of Dcris (L). Furthermore, since X admits a lifting of Frobenius σ, we get from § 2.3 a σ-semilinear
endomorphism ϕ on OBcris (X univ ) ≃ OBcris (S, S + ), whence a σ-semilinear endomorphism on D, still denoted by ϕ. From Lemma 2.19, One checks that the Frobenius ϕ on D is horizontal with respect to its connection. Thus Dcris (L) is endowed
with a horizontal σ-semilinear morphism Dcris (L) → Dcris (L), always denoted by ϕ
in the following.
To finish the proof in the special case, one still needs to show that the triple
(Dcris (L), ∇, ϕ) gives an F -isocrystal on X0 /Ok . As D is of finite type over R, there
exists some n ∈ N such that D = D+ [1/p] with D+ := (VX (L)⊗Zp t−n OAcris (S, S + ))GX .
The connection on t−n OAcris (S, S + ) induces a connection ∇+ : D+ → D+ ⊗R+
Ω1R+ /Ok on D+ , compatible with that of Dcris (VX (L)). Moreover, if we take Ni to
Pd
be the endomorphism of D+ so that ∇+ = i=1 Ni ⊗ dTi , then for any a ∈ D+ ,
N m (a) ∈ p · D+ for all but finitely many m ∈ Nd (as this holds for the connection on t−n OAcris , seen in the proof of Lemma 2.20). Similarly, the Frobenius on
OBcris (S, S + ) induces a map (note that the Frobenius on OBcris (S, S + ) sends t to
p · t)
ϕ : D+ −→ (VX (L) ⊗ p−n t−n OAcris (S, S + ))GX .
Thus ψ := pn ϕ gives a well-defined σ-semilinear morphism on D+ . One checks
that ψ is horizontal with respect to the connection ∇+ on D+ and it induces an
∼
R+ -linear isomorphism σ ∗ D+ → D+ . As a result, the triple (D+ , ∇, ψ) will define an F -crystal on U0 /Ok , once we know D+ is of finite type over R+ . The
required finiteness of D+ is explained in [AI, Proposition 3.6], and for the sake of
completeness we recall briefly their proof here. As D is projective of finite type
(Lemma 3.15), it is a direct summand of a finite free R-module T . Let T + ⊂ T
be a finite free R+ -submodule of T such that T + [1/p] = T . Then we have the
inclusion D ⊗R OBcris (S, S + ) ֒→ T + ⊗R+ OBcris (S, S + ). As VX (L) is of finite type
over Zp and OBcris (S, S + ) = OAcris (S, S + )[1/t], there exists m ∈ N such that the
OAcris (S, S + )-submodule VX (L) ⊗ t−n OAcris (S, S + ) of VX (L) ⊗ OBcris (S, S+) ≃
D ⊗ OBcris (S, S + ) is contained in T + ⊗R+ t−m OAcris (S, S + ). By taking GU invariants and using the fact that R+ is noetherian, we are reduced to showing
that R′ := (t−m OAcris (S, S + ))GX is of finite type over R+ . From the construction, R′ is p-adically separated and R+ ⊂ R′ ⊂ R = (OBcris (S, S + ))GX . As R+
is normal, we deduce pN R′ ⊂ R+ for some N ∈ N. Thus pN R′ and hence R′ are
of finite type over R+ . As a result, (D+ , ∇, ψ) defines an F -crystal D+ on U0 /Ok .
As D = D+ [1/p] and ∇ = ∇+ [1/p], the connection ∇ on Dcris (L) is convergent;
this is standard and we refer to [Ber96, 2.4.1] for detail. Consequently, the triple
(Dcris (L), ∇, ϕ) is an F -isocrystal on X0 /Ok , which is isomorphic to D+,an (n). This
finishes the proof in the special case.
S
In the general case, consider a covering X = i Ui of X by connected small
affine open subsets such that each Ui admits a lifting of Frobenius σi and an étale
morphism to some torus over Ok . By the special case, we have seen that each
Fili Dcris (L) ⊂ Dcris (L) is locally a direct summand, and that the connection on

Crystalline comparison isomorphism in p-adic Hodge theory

31

Dcris (L) is convergent ([Ber96, 2.2.8]). Furthermore, each Dcris (L)|Ui is equipped
with a Frobenius ϕi , and over Ui ∩ Uj , the two Frobenii ϕi , ϕj on Dcris (L)|Ui T Uj
are related by the formula in Lemma 3.7 as it is the case for ϕi , ϕj on OBcris |Ui T Uj
(Lemma 2.20). So these local Frobenii glue together to give a compatible system of
Frobenii ϕ on Dcris (L) and the analytification of the quadruple (Dcris (L), Fil• Dcris (L), ∇, ϕ)
is a filtered F -isocrystal on X0 /Ok , as wanted.

b p -sheaf L on X is associated to a filtered F Proof of Proposition 3.14. If a lisse Z
isocrystal E on X, then we just have to show E ≃ Dcris (L). By assumption, we have
ur OBcris . Then
L ⊗Zbp OBcris ≃ w−1 E ⊗OX
ur OBcris ) ≃ E ⊗
w∗ (L ⊗Zbp OBcris ) ≃ w∗ (w−1 E ⊗OX
OXét [1/p] w∗ OBcris ≃ E

where the second isomorphism has used Remark 3.12, and the last isomorphism is
by the isomorphism w∗ OBcris ≃ OXét [1/p] from Corollary 2.23.
b p -sheaf verifying the two conditions of our propoConversely, let L be a lisse Z
sition. By Lemma 3.18, Dcris (L) is naturally a filtered F -isocrystal. To finish the
proof, we need to show that the isomorphism in (2) is compatible with the extra
structures. Only the compatibility with filtrations needs verification. This is a
local question, hence we shall assume X = Spf(R+ ) is a small connected affine
formal scheme. As Fili Dcris (L) is coherent over OX [1/p] and is a direct summand
of Dcris (L), the same proof as that of Corollary 3.16 gives
∼

j
ur Fil OBcris )(V )
Fili Dcris (L)(X ) ⊗R Filj OBcris (V ) −→ (w−1 Fili Dcris (L) ⊗OX

for any V ∈ Xproét . Consequently, the isomorphism in Corollary 3.16 is strictly
compatible with filtrations on both sides. Thus, we reduce to show that, for any affi∼
noid perfectoid V ∈ Xproét /X univ , the isomorphism Dcris (VX (L)) ⊗R OBcris (V ) →
VX (L) ⊗ OBcris (V ) is strictly compatible with the filtrations, or equivalently, the
induced morphisms between the graded quotients are isomorphisms:

(3.2.2)
⊕i+j=n gri Dcris (VX (L)) ⊗R grj OBcris (V ) −→ L ⊗ grn OBcris (V ).

When V = X univ , this follows from [Bri, 8.4.3]. For the general case, write
\
univ = Spa(S, S + ) and V
b = Spa(S1 , S + ). Then by [Sch13, Corollary 6.15] and
X
1
Corollary 2.22, we have grj OBcris (V ) ≃ S1 ξ j [U1 /ξ, . . . , Ud /ξ]. So the natural mor∼
phism grj OBcris (X univ ) ⊗S S1 → grj OBcris (V ) is an isomorphism. The required
isomorphism (3.2.2) for general V then follows from the special case for X univ . 
b
Let Liscris
b (X) denote the category of lisse crystalline Zp -sheaves on X, and
Z
p

Liscris
b (X) the corresponding isogeny category. The functor
Q
p

†
Dcris : Liscris
b (X) −→ F F -Iso (X0 /Ok ),
Q
p

L 7→ Dcris (L)

†
allows us to relate Liscris
b p (X) to the category F F -Iso (X0 /Ok ) of filtered convergent
Q
F -isocrystals on X0 /Ok , thanks to Proposition 3.14. A filtered F -isocrystal E on
X0 /Ok is called admissible if it lies in the essential image of the functor above. The
full subcategory of admissible filtered F -isocrystals on X0 /Ok will be denoted by
F F -Iso† (X0 /Ok )adm .

Theorem 3.19. The functor Dcris above induces an equivalence of categories
∼

†
adm
Dcris : Liscris
.
b (X) −→ F F -Iso (X0 /Ok )
Q
p

32

FUCHENG TAN, JILONG TONG

A quasi-inverse of Dcris is given by
∇=0,ϕ=1
ur OBcris )
Vcris : E 7→ Fil0 (w−1 E ⊗OX

where ϕ denotes the compatible system of Frobenii on E as before.
Proof. Observe first that, for E a filtered convergent F -isocrystal, the local Frobenii
on E ∇=0 glue to give a unique σ-semilinear morphism on E ∇=0 (Lemma 3.7). In
particular, the abelian sheaf Vcris (E) is well-defined. Assume moreover E is admissib p -sheaf such that E ≃ Dcris (L). So L and E are associated
ble, and let L be a lisse Z
ur OBcris , and we find
by Proposition 3.14. Hence L ⊗Zbp OBcris ≃ w−1 E ⊗OX
bp
L ⊗Zbp Q

∼

−→ L ⊗Zbp Fil0 (OBcris )∇=0,ϕ=1
∼

−→ Fil0 (L ⊗Zbp OBcris )∇=0,ϕ=1
∼

∇=0,ϕ=1
ur OBcris )
−→ Fil0 (w−1 E ⊗OX

=

Vcris (E),

where the first isomorphism following from the the fundamental exact sequence (by
Lemma 2.5 and [Bri, Corollary 6.2.19])
1−ϕ

0 −→ Qp −→ Fil0 Bcris −→ Bcris −→ 0.
b p -sheaf of a lisse Z
b p -sheaf. Thus Vcris (E) ∈
In particular, Vcris (E) is the associated Q
(X)
and
the
functor
V
is
well-defined.
Furthermore,
as we can recover the
Liscris
cris
cp
Q
b p -sheaf up to isogeny, it follows that Dcris is fully faithful, and a quasithe lisse Z
inverse on its essential image is given by Vcris .


Remark 3.20. Using [Bri, Theorem 8.5.2], one can show that the equivalence
above is an equivalence of tannakian category.
Next we compare Definition 3.11 with the “associatedness” defined in [Fal]. Let
E be a filtered convergent F -isocrystal E on X0 /Ok , and M an F -crystal on X0 /Ok
such that Man = E(−n) for some n ∈ N (see Remark 3.5 for the notations). Let
U = Spf(R+ ) be a small connected affine open subset of X , equipped with a lifting
+
of Frobenius σ. Write U = Spa(R, R+ ) the generic fiber of U. As before, let R
+
be the union of all finite normal R -algebras (contained in some fixed algebraic
+
closure of Frac(R+ )) which are étale over R := R+ [1/p], and R := R [1/p]. Let
+
GU := Gal(R/R) and (S, S + ) the p-adic completion of (R, R ). Then (S, S + ) is
an perfectoid affinoid algebra over the p-adic completion of k. So we can consider
the period sheaf Acris (S, S + ). Moreover the composite of the following two natural
morphisms
 θ
can
(3.2.3)
Acris S, S + −→ S + −→ S + /pS + ,
defines a p-adic PD-thickening of Spec(S + /pS + ). Evaluate our F -crystal M at it
and write M(Acris (S, S + )) for the resulting finite type Acris (S, S + )-module. As an
element of GU defines a morphism of the PD-thickening (3.2.3) in the big crystalline site of X0 /Ok and M is a crystal, M(A(S, S + )) is endowed naturally with
an action of GU . Similarly, the Frobenius on the crystal M gives a Frobenius
ψ on M(Acris (S, S + )). Set E(Bcris (S, S + )) := M(Acris (S, S + ))[1/t], which is a
Bcris (S, S + )-module of finite type endowed with a Frobenius ϕ = ψ/pn and an
action of GU .

Crystalline comparison isomorphism in p-adic Hodge theory

33

On the other hand, as U is small, there exists a morphism α : R+ → Acris (S, S + )
of Ok -algebras, whose composite with the projection Acris (S, S + ) → S + is the inclusion R+ ⊂ S + . For example, consider an étale morphism U → Spf(Ok {T1±1 , . . . , Td±1 }).
+
1/pn
) be a compatible system of pn -th roots of Ti inside R ⊂ S + , and Ti♭
Let (Ti
the corresponding element of S ♭+ := limx7→xp S + /pS + . Then one can take α as the
←−
unique morphism of Ok -algebras R+ → Acris (S, S + ) sending Ti to [Ti♭ ], such that
its composite with the projection Acris (S, S + ) → S + /pS + is just the natural map
R+ → S + /pS + (such a morphism exists as R+ is étale over Ok {T1±1, . . . , Td±1 }
and because of (3.2.3); see the proof of Lemma 2.13 for a similar situation). Now
we fix such a morphism α. So we obtain a morphism of PD-thickenings from
U0 ֒→ U to the one defined by (3.2.3). Consequently we get a natural isomorphism
M(Acris (S, S + )) ≃ M(U) ⊗R+ ,α Acris (S, S + ), whence
E(Bcris (S, S + )) ≃ E(U) ⊗R,α Bcris (S, S + ).
Using this isomorphism, we define the filtration on E(Bcris (S, S + )) as the tensor
product of the filtration on E(U) and that on Bcris (S, S + ).
Remark 3.21. It is well known that the filtration on E(Bcris (S, S + )) does not
depend on the choice of α. More precisely, let α′ be a second morphism R+ →
Acris (S, S + ) of Ok -algebras whose composite with Acris (S, S + ) → S + is the inclusion R+ ⊂ S + . Fix an étale morphism U → Spf(Ok {T1±1 , . . . , Td±1 }). Denote
β = (α, α′ ) : R+ ⊗Ok R+ → Acris (S, S + ) and by the same notation the corresponding map on schemes, and write p1 , p2 : Spec R+ × Spec R+ → Spec R+ the two
∼
projections. We have a canonical isomorphism (p2 ◦ β)∗ E −
→ (p1 ◦ β)∗ E, as E is
a crystal. In terms of the connection ∇ on E, this gives (cf. [Ber96, 2.2.4]) the
following Bcris (S, S + )-linear isomorphism
η : E(U) ⊗R,α Bcris (S, S + ) −→ E(U) ⊗R,α′ Bcris (S, S + )
P
sending e ⊗ 1 to n∈Nd N n (e) ⊗ (α(T ) − α′ (T ))[n] , with N the endomorphism of
E such that ∇ = N ⊗ dT . Here we use the multi-index to simplify the notations,
and note that α(Ti ) − α′ (Ti ) ∈ Fil1 Acris (S, S + ) hence the divided power (α(Ti ) −
α′ (Ti ))[ni ] is well-defined. Moreover, the series converge since the connection on
M is quasi-nilpotent. Now as the filtration on E satisfies Griffiths transversality,
the isomorphism η is compatible with the tensor product filtrations on both sides.
Since the inverse η −1 can be described by a similar formula (one just switches α
and α′ ), it is also compatible with filtrations on both sides. Hence the isomorphism
η is strictly compatible with the filtrations, and the filtration on E(Bcris (S, S + ))
does not depend on the choice of α.
b p -sheaf on X, and write as before VU (L) the Zp -representation of
Let L be a lisse Z
GU corresponding to the lisse sheaf L|U . Following [Fal], we say a filtered convergent
F -isocrystal E is associated to L in the sense of Faltings if, for all small open subset
U ⊂ X , there is a functorial isomorphism:

 ∼
(3.2.4)
E Bcris S, S + −→ VU (L) ⊗Qp Bcris S, S +
which is compatible with filtration, GU -action and Frobenius.

Proposition 3.22. Keep the notation above. If E is associated to L in the sense
of Faltings then L is crystalline (not necessarily associated to E) and there is an
isomorphism Dcris (L) ≃ E compatible with filtration and Frobenius. Conversely,

34

FUCHENG TAN, JILONG TONG

if L is crystalline and if there is an isomorphism Dcris (L) ≃ E of OX an -modules
compatible with filtration and Frobenius, then L and E are associated in the sense
of Faltings.
Before giving the proof of Proposition 3.22, we observe first the following commutative diagram in which the left vertical morphisms are all PD-morphisms:
/ R+ /pR+ .

R+
can


OAcris (S, S + )
O

θR


/ S + /pS +

can

Acris (S, S + )

θ

/ S + /pS +

Therefore, we have isomorphisms

 ∼
−→ M OAcris S, S +
M(U) ⊗R+ OAcris S, S +


∼
←− M Acris S, S + ⊗Acris (S,S + ) OAcris S, S + ,

where the second term in the first row denotes the evaluation of the crystal M at
the PD-thickening defined by the PD-morphism θR in the commutative diagram
above. Inverting t, we obtain a natural isomorphism


 ∼
(3.2.5)
E(U) ⊗R OBcris S, S + −→ E Bcris S, S + ⊗ OBcris S, S + ,
where the last tensor product is taken over Bcris (S, S + ). This isomorphism is clearly
compatible with Galois action and Frobenius. By a similar argument as in Remark
3.21 one checks that (3.2.5) is also strictly compatible with the filtrations. Furthermore, using the identification


∼
Acris S, S + {hu1 , . . . , ud i} −→ OAcris S, S + , ui 7→ Ti ⊗ 1 − 1 ⊗ [Ti♭ ]
we obtain a section s of the canonical map Acris (S, S + ) → OAcris (S, S + ):


ui 7→ 0
s : OAcris S, S + → Acris S, S +

which is again a PD-morphism. Composing with the inclusion R+ ⊂ OAcris (S, S + ),
we get a morphism α0 : R+ → Acris (S, S + ) whose composite with the projection
Acris (S, S + ) → S + is the inclusion R+ ⊂ S + .
Proof of Proposition 3.22. Now assume that E is associated with L in the sense
of [Fal]. Extending scalars to OBcris (S, S + ) of the isomorphism (3.2.4) and using the identification (3.2.5), we obtain a functorial isomorphism, compatible with
filtration, GU -action, and Frobenius:

 ∼
VU (L) ⊗Zp OBcris S, S + −→ E(U) ⊗R OBcris S, S + .

Therefore, VU (L)⊗Zp Qp is a crystalline GU -representation (Corollary 3.17), and we
∼
get by Lemma 3.15 an isomorphism E(U) −
→ Dcris (L)(U) compatible with filtrations
and Frobenius. As such small open subsets U form a basis for the Zariski topology of
∼
X , we find an isomorphism E −
→ Dcris (L) compatible with filtrations and Frobenius,
and that L is crystalline in the sense of Definition 3.11 (Corollary 3.17).

Crystalline comparison isomorphism in p-adic Hodge theory

35

Conversely, assume L is crystalline with Dcris (L) ∼
= E compatible with filtrations
and Frobenius. As in the proof of Corollary 3.17, we have a functorial isomorphism

 ∼
E(U) ⊗R OBcris S, S + −→ VU (L) ⊗Zp OBcris S, S +

which is compatible with filtration, Galois action and Frobenius. Pulling it back
via the section OBcris (S, S + ) → Bcris (S, S + ) obtained from s by inverting p, we
obtain a functorial isomorphism
∼

E(Bcris (S, S + )) ≃ E(U) ⊗R,α0 Bcris (S, S + ) −→ VU (L) ⊗Zp Bcris (S, S + ),
which is again compatible with Galois action, Frobenius and filtrations. Therefore
L and E are associated in the sense of Faltings.

Finally we compare Definition 3.11 with its de Rham analogue considered in
[Sch13].
b p -sheaf on X and E a filtered convergent F Proposition 3.23. Let L be a lisse Z
isocrystal on X0 /Ok . Assume that L and E are associated as defined in Definition
3.11, then L is a de Rham in the sense of [Sch13, Definition 8.3] . More precisely,
if we view E as a filtered module with integrable connection on X (namely we forget
the Frobenius), there exists a natural filtered isomorphism that is compatible with
connections:
L ⊗Zbp OBdR −→ E ⊗OX OBdR
Proof. Let U = Spf(R+ ) ⊂ X be a connected affine open subset, and denote U
(resp. U univ ) the generic fiber of U (resp. the universal étale cover of U ). Let V
be a affinoid perfectoid lying above U univ . As L and E are associated, there exits a
filtered isomorphism compatible with connections and Frobenius
∼

ur OBcris .
L ⊗Zbp OBcris −→ w−1 E ⊗OX

Evaluate this isomorphism at V ∈ Xproét and use the fact that the R-module E(U)
is projective (here R := R+ [1/p]), we deduce a filtered isomorphism compatible
with all extra structures:
∼

VU (L) ⊗Zp OBcris (V ) −→ E(U ) ⊗R OBcris (V ).
Taking tensor product − ⊗OBcris (V ) OBdR (V ) on both sides, we get a filtered isomorphism compatible with connection:
∼

VU (L) ⊗Zp OBdR (V ) −→ E(U ) ⊗R OBdR (V ).
Again, as E(U ) is a projective R-module and as E is coherent, the isomorphism
above can be rewritten as
∼

(L ⊗Zbp OBdR )(V ) −→ (E ⊗OX OBdR )(V ),
which is clearly functorial in U and in V . Varying U and V , we deduce that L is
de Rham, hence our proposition.


36

FUCHENG TAN, JILONG TONG

3.3. From pro-étale site to étale site. Let X be a smooth formal scheme over
ur+
ur
Ok . For O = OX , OX [1/p], OX
, OX
and a sheaf of O-modules F with connection,
we denote the de Rham complex of F as:
∇

∇

DR(F ) = (0 → F −→ F ⊗O Ω1 −→ · · · ).
Let w be the composite of natural morphisms of topoi (here we use the same
∼
notation to denote the object in Xproét
represented by Xk ∈ Xproét ):
w

∼
∼
∼
Xproét
/Xk −→ Xproét
−→ Xét
.

The following lemma is just a global reformulation of the main results of [AB]. As
we shall prove a more general result later (Lemma 5.3), let us omit the proof here.
Lemma 3.24. Let X be smooth formal scheme over Ok . Then the natural morphism below is an isomorphism in the filtered derived category:
b Ok Bcris −→ Rw∗ (OBcris ).
OX ⊗

b Ok Bcris := OX ⊗
b Ok Acris [1/t] with
Here OX ⊗
b Ok Acris := lim OX ⊗Ok Acris /pn ,
OX ⊗
←−
n∈N

b Ok Bcris is filtered by the subsheaves
and OX ⊗
b Ok Filr+n Acris ),
b Ok Filr Bcris := lim t−n (OX ⊗
O⊗
−→

r ∈ Z.

n∈N

Corollary 3.25. Let X be a smooth formal scheme over Ok . Let L be a crystalline
b p -sheaf associated with a filtered convergent F -isocrystal E. Then there exists
lisse Z
a natural quasi-isomorphism in the filtered derived category
∼
b k Bcris .
Rw ∗ (L ⊗Zb Bcris ) −→ DR(E)⊗
p

If moreover X is endowed with a lifting of Frobenius σ, then the isomorphism above
is also compatible with the Frobenii deduced from σ on both sides.

Proof. Using the Poincaré lemma (Corollary 2.16), we get first a quasi-isomorphism
which is strictly compatible with filtrations:
∼

L ⊗ Bcris −→ L ⊗ DR(OBcris ) = DR(L ⊗ OBcris ).
∼

ur
As L and E are associated, there is a filtered isomorphism L⊗ OBcris −
→ w−1 E ⊗OX
OBcris compatible with connection and Frobenius, from which we get the quasiisomorphisms in the filtered derived category

(3.3.1)

∼

∼

L ⊗ Bcris −→ DR(L ⊗ OBcris ) −→ DR(w−1 E ⊗ OBcris ).

On the other hand, as Rj w ∗ OBcris = 0 for j > 0 (Lemma 3.24), we obtain using
projection formula that Rj w∗ ((w−1 E ⊗ OBcris )|Xk ) = E ⊗ Rj w ∗ OBcris = 0 (note
that E is locally a direct factor of a finite free OX [1/p]-module, hence one can apply
projection formula here). In particular, each component of DR(w−1 E ⊗ OBcris ) is
w∗ -acyclic. Therefore,
∼

∼

DR(E ⊗ w∗ OBcris ) −→ w ∗ (DR(w−1 E ⊗ OBcris )) −→ Rw∗ (DR(w−1 E ⊗ OBcris )).
Combining this with Lemma 3.24, we deduce the following quasi-isomorphisms in
the filtered derived category
∼
∼
b k Bcris −→
DR(E ⊗ w∗ OBcris ) −→ Rw ∗ (DR(w−1 E ⊗ OBcris )).
(3.3.2) DR(E)⊗

Crystalline comparison isomorphism in p-adic Hodge theory

37

The desired quasi-isomorphism follows from (3.3.1) and (3.3.2). When furthermore X admits a lifting of Frobenius σ, one checks easily that both quasiisomorphisms are compatible with Frobenius, hence the last part of our corollary.

Remark 3.26. Recall that Gk denotes the absolute Galois group of k. Each
element of Gk defines a morphism of Uk in the pro-étale site Xproét for any U ∈
Xproét with U := Uk . Therefore, the object Rw∗ (L ⊗ Bcris ) comes with a natural
Galois action of Gk . With this Galois action, one checks that the quasi-isomorphism
in Corollary 3.25 is also Galois equivariant.
Let E be a filtered convergent F -isocrystal on X0 /Ok , and M an F -crystal on
X0 /Ok (viewed as a coherent OX -module equipped with an integrable connection)
such that E ≃ Man (n) for some n ∈ N (Remark 3.5). The crystalline cohomology
i
group Hcris
(X0 /Ok , M) is an Ok -module of finite type endowed with a Frobenius
ψ. In the following, the crystalline cohomology (or more appropriately, the rigid
cohomology) of the convergent F -isocrystal E is defined as
i
i
Hcris
(X0 /Ok , E) := Hcris
(X0 /Ok , M)[1/p].

It is a finite dimensional k-vector space equipped with the Frobenius ψ/pn . Moreover, let u = uX0 /Ok be the following morphism of topoi
∼
(X0 /Ok )∼
cris −→ Xét

such that u∗ (F )(U) = H 0 ((U0 /Ok )∼
cris , F ) for U ∈ Xét . With the étale topology
replaced by the Zariski topology, this is precisely the morphism uX0 /Ŝ (with Ŝ =
Spf(Ok )) considered in [BO, Theorem 7.23]. By loc.cit., there exists a natural
quasi-isomorphism in the derived category
(3.3.3)

∼

Ru∗ M −→ DR(M),
∼

i
which induces a natural isomorphism Hcris
(X0 /Ok , M) −
→ Hi (X , DR(M)). Thereby

(3.3.4)

∼

i
Hcris
(X0 /Ok , E) −→ Hi (X , DR(E)).

On the other hand, the de Rham complex DR(E) of E is filtered by its subcomplexes
∇

∇

Filr DR(E) := (Filr E −→ Filr−1 E ⊗ Ω1X/k −→ . . .).
So the hypercohomology Hi (X , DR(E)) has a descending filtration given by

Filr Hi (X , DR(E)) := Im Hi (X , Filr DR(E)) −→ Hi (X , DR(E)) .

i
Consequently, through the isomorphism (3.3.4), the k-space Hcris
(X0 /Ok , E) is endowed naturally with a decreasing filtration.

Theorem 3.27. Assume further that the smooth formal scheme X is proper over
b p -sheaf
Ok . Let E be a filtered convergent F -isocrystal on X0 /Ok and L a lisse Z
on Xproét . Assume that E and L are associated. Then there is a natural filtered
isomorphism of Bcris -modules
(3.3.5)

∼

i
H i (Xk,proét , L ⊗Zbp Bcris ) −→ Hcris
(X0 /Ok , E) ⊗k Bcris

which is compatible with Frobenius and Galois action.

38

FUCHENG TAN, JILONG TONG

Proof. By Corollary 3.25, we have the natural Galois equivariant quasi-isomorphism
in the filtered derived category:
∼
b k Bcris ).
RΓ(Xk,proét , L ⊗ Bcris ) = RΓ(X , Rw ∗ (L ⊗ Bcris )) −→ RΓ(X , DR(E)⊗

We first claim that the following natural morphism in the filtered derived category
is an isomorphism:
b Ok Acris ).
RΓ(X , DR(E)) ⊗Ok Acris −→ RΓ(Xét , DR(E)⊗

Indeed, as Acris is flat over Ok , the morphism above is an isomorphism respecting
the filtrations in the derived category. Thus to prove our claim, it suffices to check
that the morphism above induces quasi-isomorphisms on gradeds. Further filtering
the de Rham complex by its naive filtration, we are reduced to checking the following
isomorphism for A a coherent OX -module:
∼
b Ok OCp ) ,
RΓ(X , A) ⊗Ok OCp −→ RΓ(X , A⊗
which holds because again OCp is flat over Ok . Consequently, inverting t we obtain
an isomorphism in the filtered derived category
b k Bcris ).
RΓ(X , DR(E)) ⊗k Bcris −→ RΓ(Xét , DR(E)⊗

In this way, we get a Galois equivariant quasi-isomorphism in the filtered derived
category
∼
RΓ(Xk,proét , L ⊗ Bcris ) −→ RΓ(X , DR(E)) ⊗k Bcris .

Combining it with (3.3.4), we obtain the isomorphism (3.3.5) verifying the required
properties except for the Frobenius compatibility.
To check the Frobenius compatibility, we only need to check that the restriction
i
i
to Hcris
(X0 /Ok , E) ֒→ Hcris
(X0 /Ok , E)⊗k Bcris of the inverse of (3.3.5) is Frobeniuscompatible. Let M be an F -crystal on X0 /Ok such that E = Man (n). Via the
i
i
identification Hcris
(X0 /Ok , E) = Hcris
(X0 /Ok , M)[1/p], the restriction map in question is induced from the following composite of morphisms at the level of derived
category:
∼
∼
b Ok Bcris ≃ DR(E)⊗
b k Bcris −→
Rw∗ (L ⊗ Bcris ),
Ru∗ M −→ DR(M) −→ DR(M)⊗

where the first quasi-isomorphism is (3.3.3), and the last morphism is just the
inverse in the derived category of the quasi-isomorphism in Corollary 3.25. Let us
denote by θ the composite of these morphisms. Let ψ (resp. ϕ) be the induced
Frobenius on Ru∗ M (resp. on Rw∗ (L⊗Bcris )). One only needs to check that ϕ◦θ =
1
pn θ ◦ ψ. This can be checked locally on X . So let U ⊂ X be a small open subset
equipped with a lifting of Frobenius σ. Thus M|U (resp. E|U ) admits naturally
a Frobenius, which we denote by ψU (resp. ϕU ). Then all the morphisms above
except for the identification in the middle are Frobenius-compatible (see Corollary
3.25 for the last quasi-isomorphism). But by definition, under the identification
M[1/p]|U ≃ E|U , the Frobenius ϕU on E corresponds exactly to ψU /pn on M[1/p].
This gives the desired equality ϕ ◦ θ = p1n θ ◦ ψ on U, from which the Frobenius
compatibility in (3.3.5) follows.


Crystalline comparison isomorphism in p-adic Hodge theory

39

4. Primitive comparison on the pro-étale site
Let X be a proper smooth formal scheme over Ok , with X (resp. X0 ) its generic
b p -sheaf on Xproét . In this section, we will con(resp. closed) fiber. Let L be a lisse Z
b p -sheaf L on the pro-étale
struct a primitive comparison isomorphism for any lisse Z
site Xproét (Theorem 4.3). In particular, this primitive comparison isomorphism
b p -sheaves, which may lead to interesting arithalso holds for non-crystalline lisse Z
metic applications. On the other hand, in the case that L is crystalline, such a
result and Theorem 3.27 together give rise to the crystalline comparison isomorphism between étale cohomology and crystalline cohomology.
We shall begin with some preparations. The first lemma is well-known.
Lemma 4.1. Let (Fn )n∈N be a projective system of abelian sheaves on a site T ,
such that Rj lim Fn = 0 whenever j > 0. Then for any object Y ∈ T and any i ∈ Z,
←−
the following sequence is exact:
0 −→ R1 lim H i−1 (Y, Fn ) −→ H i (Y, lim Fn ) −→ lim H i (Y, Fn ) −→ 0.
←−
←−
←−
Proof. Let Sh (resp. PreSh) denote the category of abelian sheaves (resp. abelian
presheaves) on T , and ShN (resp. PreShN ) the category of projective systems of
abelian sheaves (resp. of abelian presheaves) indexed by N. Let Ab denote the
category of abelian groups. Consider the functor
τ : ShN −→ Ab,

(Gn ) 7→ lim Γ(Y, Gn ).
←−
Clearly τ is left exact, hence we can consider its right derived functors. Let us
compute Rτ (Fn ) in two different ways.
Firstly, one can write τ as the composite of the following two functors
lim

− / Sh
ShN ←

Γ(U,−)

/ Ab .

N

Since the projective limit functor lim : Sh → Sh admits an exact left adjoint given
←−
by constant projective system, it sends injectives to injectives. Thus we obtain a
spectral sequence
E2i,j = H i (Y, Rj lim Fn ) =⇒ Ri+j τ (Fn ).
←−
By assumption, Rj lim Fn = 0 whenver j > 0. So the spectral sequence above
←−
degenerates at E2 and we get H i (Y, lim Fn ) ≃ Ri τ (Fn ).
←−
Secondly, one can equally decompose τ as follows:
ShN

α

lim

− / Ab ,
/ AbN ←

where the functor α sends (Gn ) to the projective system of abelian groups (Γ(Y, Gn )).
Let I• = (In ) be an injective object of ShN . By [Jan, Proposition 1.1], each component In is an injective object of Ab and the transition maps In+1 → In are split
surjective. Therefore, the transition maps of the projective system α(I• ) are also
split surjective. In particular, the projective system α(I• ) is lim-acyclity. So we
←−
can consider the following spectral sequence
E2i,j = Ri lim H j (Y, Fn ) =⇒ Ri+j τ (Fn ).
←−
Since the category Ab satisfies the axiom (AB5*) of abelian categories (i.e., infinite
products are exact), Ri lim An = 0 (i ∈
/ {0, 1}) for any projective system of abelian
←−

40

FUCHENG TAN, JILONG TONG

groups (An )n . So the previous spectral sequence degenerates at E2 , from which we
deduce a natural short exact sequence for each i ∈ Z
0 −→ R1 lim H i−1 (Y, Fn ) −→ Ri τ (Fn ) −→ lim H i (Y, Fn ) −→ 0.
←−
←−
As we have seen H i (Y, lim Fn ) ≃ Ri τ (Fn ), we deduce the short exact sequence as
←−
asserted by our lemma.

i
b p -sheaf on X
Lemma 4.2. Let L be a lisse Z
k,proét . Then for i ∈ Z, H (Xk,proét , L)
/ [0, 2 dim(X)].
is a Zp -module of finite type, and H i (Xk,proét , L) = 0 whenever i ∈

Proof. Since all the cohomology groups below are computed in the pro-étale site,
we shall omit the subscript “proét” from the notations.
Let Ltor denote the torsion subsheaf of L. Then our lemma follows from the
corresponding statements for Ltor and for L/Ltor . Therefore, we may assume either
b p . In the first case, we
L is torsion or is locally on Xk,proét free of finite rank over Z
reduce immediately to the finiteness statement of Scholze (Theorem 5.1 of [Sch13]).
So it remains to consider the case when L is locally on Xk,proét free of finite rank
b p . Let Ln := L/pn L. We have the tautological exact sequence
over Z
pn

0 −→ L −→ L −→ Ln −→ 0,

inducing the following short exact sequence
(4.0.6)

0 −→ H i (Xk , L)/pn −→ H i (Xk , Ln ) −→ H i+1 (Xk , L)[pn ] −→ 0.

We shall show that the following natural morphism is an isomorphism:
H i (Xk , L) −→ lim H i (Xk , Ln ).
←−
Indeed, as L is locally free, using [Sch13, Proposition 8.2], we find Rj limn Ln = 0
←−
for j > 0. Moreover, as H i−1 (Xk , Ln ) are finite Z/pn Z-modules by [Sch13, Theorem
5.1], R1 lim H i−1 (Xk , Ln ) = 0. Consequently, by Lemma 4.1, the morphism (4.0.7)
←−
is an isomorphism.
∼
In particular, H i (Xk , L) → lim H i (Xk , Ln ) is a pro-p abelian group, hence it
←−
does not contain any element infinitely divisible by p. Thus, lim(H i (Xk , L)[pn ]) = 0
←−
(where the transition map is multiplication by p). From the exactness of (4.0.6),
we then deduce a canonical isomorphism
 ∼
lim H i (Xk , L)/pn −
→ lim H i (Xk , Ln ).
←−
←−
∼
So H i (Xk , L) −
→ limn H i (Xk , L)/pn . Consequently the Zp -module H i (Xk , L) is p←−
adically complete, and it can be generated as a Zp -module by a family of elements
whose images in H i (Xk , L)/p generate it as an Fp -vector space. Since the latter is
finite dimensional over Fp , the Zp -module H i (Xk , L) is of finite type, as desired. 
(4.0.7)

The primitive form of the comparison isomorphism on the pro-étale site is as
follows.
b p -sheaf on Xproét . There is a canonical isomorTheorem 4.3. Let L be a lisse Z
+
phism of Bcris -modules
(4.0.8)

∼

+
H i (Xk,proét , L) ⊗Zp Bcris
−
→ H i (Xk,proét , L ⊗Zbp B+
cris )

compatible with Galois action, filtration and Frobenius.

Crystalline comparison isomorphism in p-adic Hodge theory

41

Proof. In the following, all the cohomologies are computed on the pro-étale site,
hence we omit the subscript “proét” from the notations.
The proof begins with the almost isomorphism in [Sch13, Theorem 8.4]:
≈

H i (Xk , L) ⊗Zp Ainf −→ H i (Xk , L ⊗Zbp Ainf ).
Therefore, setting
0
]
A
cris :=

Ainf [Xi : i ∈ N]
− ai Xi+1 : i ∈ N)

(Xip

i+1

0
and Ag
cris :=

Ainf [Xi : i ∈ N]
− ai Xi+1 : i ∈ N)

(Xip

p
!
with ai = (p
i !)p and using the fact that Xk is qcqs, we find the following almost
isomorphism


≈
i
0
0
]
Xk , L ⊗Zbp Ag
(4.0.9)
H i (Xk , L) ⊗Zp A
cris −→ H
cris .

On the other hand, from the tautological short exact sequence
X0 −ξ ]
0
0
0
]
0 −→ A
cris −→ Acris −→ Acris −→ 0

and the fact that A0cris is flat over Zp , we deduce a short exact sequence:
X0 −ξ
i
i
0
0
0
]
]
0 −→ H i (Xk , L) ⊗Zp A
cris −→ H (Xk , L) ⊗Zp Acris −→ H (Xk , L) ⊗Zp Acris −→ 0.

As a result, together with the almost isomorphism (4.0.9), we see that the morphism




i
0
0
αi : H i Xk , L ⊗ Ag
Xk , L ⊗ Ag
cris −→ H
cris

induced by multiplication-by-(X0 − ξ) is almost injective for all i ∈ Z. Similarly,
b p , the following sequence of abelian sheaves on Xproét /X
since A0cris is flat over Z
k
is exact:
X0 −ξ
0 )|
0 )|
−→ (L ⊗ Ag
−→ (L ⊗ A0 )| −→ 0,
0 −→ (L ⊗ Ag
bp
Z

cris

Xk

bp
Z

cris

Xk

cris Xk

bp
Z

giving the associated long exact sequence on the cohomology:
αi
0
0 ) −→
0 ) → H i (X , L ⊗
· · · → H i (Xk , L ⊗Zbp Ag
H i (Xk , L ⊗Zbp Ag
bp Acris ) → · · · .
cris
cris
k
Z

As the αi ’s are almost injective for all i, the previous long exact sequence splits
into short almost exact sequences
αi
0 ) −→
0 ) −→ H i (X , L ⊗
0 −→ H i (X , L ⊗ Ag
H i (X , L ⊗ Ag
A0 ) −→ 0.
k

bp
Z

cris

bp
Z

k

cris

bp
Z

k

cris

Thus the following natural morphism is an almost isomorphism
(4.0.10)

≈

H i (Xk , L) ⊗Zp A0cris −→ H i (Xk , L ⊗Zbp A0cris ),

∀i ≥ 0.

To pass to p-adic completion, we remark that, by Lemma 4.2, the Zp -module
H i (Xk , L) is of finite type and vanishes when i ∈
/ [0, 2 dim X]. Let N be an integer
such that the torsion part Ltor of L and for all i the torsion parts H i (Xk , L)tor of
H i (Xk , L) are annilated by pN . For n > N an integer, we claim that the following
natural morphism has kernel and cokernel killed by p2N :
(4.0.11)

H i (Xk , L) ⊗Zp (A0cris /pn ) −→ H i (Xk , L ⊗Zbp A0cris /pn ),

or equivalently (via the isomorphism (4.0.10)), that the natural morphism below
has kernel and cokernel killed by p2N :
(4.0.12)

H i (Xk , L ⊗ A0cris )/pn −→ H i (Xk , L ⊗Zbp A0cris /pn ).

42

FUCHENG TAN, JILONG TONG

To see this, consider the following tautological exact sequence
pn

L ⊗ A0cris −→ L ⊗ A0cris −→ L ⊗ A0cris /pn −→ 0.
pn

Let Kn := ker(L⊗A0cris → L⊗A0cris ). Then Kn is isomorphic to T orZ1 p (L, A0cris /pn ) ≃
T orZ1 p (Ltor , A0cris /pn ), thus is killed by pN . Let In := pn (L ⊗ A0cris ) ⊂ L ⊗ A0cris . So
we have two short exact sequences:
0 −→ Kn −→ L ⊗ A0cris −→ In −→ 0,
and
0 −→ In −→ L ⊗ A0cris −→ L ⊗ A0cris /pn −→ 0.
Taking cohomology one gets exact sequences
γi

. . . −→ H i (Xk , Kn ) −→ H i (Xk , L⊗A0cris ) −→ H i (Xk , In ) −→ H i+1 (Xk , Kn ) −→ . . .
and
βi

. . . −→ H i (Xk , In ) −→ H i (Xk , L ⊗ A0cris ) −→ H i (Xk , L ⊗ A0cris /pn ) −→ . . . ,
which give rise to the exact sequence below:
H i (Xk , L ⊗ A0cris )/pn −→ H i (Xk , L ⊗ A0cris /pn ) −→ ker(βi+1 ) −→ 0,
such that the kernel of the first morphism is killed by pN . On the other hand, we
have the following commutative diagram
βi+1

/ H i+1 (X , L ⊗ Acris /pn ) .
k
❥❥❥4
❥
❥
❥
❥❥
γi+1
❥❥❥❥pn
❥❥❥❥
H i+1 (Xk , L ⊗ Acris )
H i+1 (Xk , In )
O

pn

Note that ker(H i+1 (Xk , L ⊗ A0cris ) → H i+1 (Xk , L ⊗ A0cris )) is, via the almost isomorphism (4.0.10) for H i+1 , almost isomorphic to Tor1Zp (H i+1 (Xk , L)tor , A0cris /pn ),
hence is killed by pN . Moreover, coker(γi+1 ) is contained in H i+1 (Xk , Kn ), thus
is also killed by pN . As a result, from the commutative diagram above we deduce
that ker(βi+1 ) is killed by p2N , giving our claim.
Now we claim that the following canonical map
H i (Xk , L ⊗Zbp Acris ) −→ lim H i (Xk , L ⊗Zbp Acris /pn )
←−
b p -sheaf, it is locally
is almost surjective with kernel killed by p2N . Since L is a lisse Z
b
b p /pm ’s.
a direct sum of a finite free Zp -module and a finite product of copies of Z
j
a
n
In particular, R lim(L ⊗ Acris /p ) = 0 whenever j > 0 as the same holds for the
←−
projective system {Aacris /pn }n (recall (2.1.11)). As a result, by the almost version
of Lemma 4.1, we dispose the following almost short exact sequence for each i:
(4.0.13)

0 −→ R1 lim H i−1 (Xk , L⊗Acris /pn ) −→ H i (Xk , L⊗Acris ) −→ lim H i (Xk , L⊗Acris /pn ) −→ 0
←−
←−
On the other hand, the morphisms (4.0.11) for all n give rise to a morphism of
projective systems whose kernel and cokernel are killed by p2N :
{H i−1 (Xk , L) ⊗Zp (A0cris /pn )}n≥0 → {H i−1 (Xk , L ⊗Zbp A0cris /pn )}n≥0
Therefore R1 limn H i−1 (Xk , L ⊗Zbp A0cris /pn ) is killed by p2N . This concludes the
←−
proof of the claim.

Crystalline comparison isomorphism in p-adic Hodge theory

43

Consequently, by the following commutative digram
can

/ H i (X , L ⊗b Aa )
H i (Xk , L) ⊗Zp Aacris
k
Zp cris
❚❚❚❚
❚❚❚❚
❚❚❚❚
(4.0.13)
lim (4.0.11) ❚❚❚❚❚
*

←
−

lim H i (Xk , L ⊗Zbp Acris /pn )
←−

we deduce that the kernel and the cokernel of the horizontal canonical morphism
are killed by p4N . On inverting p, we obtain the desired isomorphism (4.0.8).
We still need to check that (4.0.8) is compatible with the extra structures.
Clearly only the strict compatibility with filtrations needs verification, and it suffices to check this on gradeds. So we reduce to showing that the natural morphism
is an isomorphism:
bX (j)).
H i (X , L) ⊗Zp Cp (j) −→ H i (X , L ⊗ O
k

k

Twisting, one reduces to j = 0, which is given by the following lemma.



b p -sheaf on X
Lemma 4.4. Let L be a lisse Z
k,proét . Then the following natural
morphism is an isomorphism:


≈
bX ,
H i (Xk,proét , L) ⊗Zp Cp −→ H i Xk,proét , L ⊗Zbp O
b
bX is the completed structural sheaf of X
where O
k,proét and Cp = k.

Proof. The proof is similar to that of the first part of Theorem 4.3. Let Ln :=
L/pn L. Using the (finite) filtration {pm · Ln }m of Ln and by induction on m, we
get from [Sch13, Theorem 5.1] the following natural almost isomorphisms


≈
b+ .
H i (X , Ln ) ⊗Zp OCp −→ H i X , Ln ⊗b O
k

k

Zp

X

We need to look at the project limits (with respect to n) of both sides of the previous
morphisms. Pick N ∈ N such that pN kills Ltor and H i (Xk , L)tor for all i ∈ N. For
n ≥ N , there is a tautological exact sequence
pn

0 −→ Ltor −→ L −→ L −→ Ln −→ 0.
Splitting it into two short exact sequences and taking cohomology, we obtain exact
sequences
. . . −→ H i (Xk , pn L) −→ H i (Xk , L) −→ H i (Xk , Ln ) −→ . . .
and
. . . −→ H i (Xk , Ltor ) −→ H i (Xk , L) −→ H i (Xk , pn L) −→ . . . ,
from which we deduce the exact sequence below:
H i (Xk , L)/pn −→ H i (Xk , Ln ) −→ ker(H i+1 (Xk , pn L) −→ H i+1 (Xk , L)) −→ 0.
As in the proof of Theorem 4.3, the kernel of the first morphism in the sequence
above is killed by pN while the last abelian group is killed by p2N . Consequently,
the kernel and the cokernel of the following natural morphism are killed by p2N :
H i (Xk , L) ⊗ OCp /pn −→ H i (Xk , Ln ) ⊗ OCp .

44

FUCHENG TAN, JILONG TONG

Passing to projective limits, we find a natural morphism with kernel and cokernel
killed by p2N :


H i (Xk , L) ⊗ OCp ≃ lim H i (Xk , L) ⊗ OCp /pn −→ lim H i (Xk , Ln ) ⊗ OCp ,
←−
←−

b+ ) are both killed by p2N .
and R1 lim H i (Xk , Ln ) ⊗ OCp ≃ R1 lim H i (Xk , Ln ⊗ O
X
←−
←−
b p -sheaf, Rj lim(Ln ⊗ O
b+ ) = 0 for j > 0 since
On the other hand, as L is a lisse Z
X
←−
b + /pn }n ; for this, apply [Sch13, Lemma 3.18] to Lemma 4.10
the same holds for {O
X
loc.cit.. Hence by Lemma 4.1, we deduce a short exact sequence
b+ ) −→ H i (X , L⊗O
b+ ) −→ lim H i (X , Ln ⊗O
b+ ) −→ 0.
0 −→ R1 lim H i−1 (Xk , Ln ⊗O
X
X
X
k
k
←−
←−
So we get the following commutative diagram
/ H i (X , L ⊗ O
b+ ).
H i (Xk , L) ⊗ OCp
X
k
❙❙❙
❙❙❙
❙❙❙
iso. up to p2N −torsion
❙❙
iso. up to p2N −torsion ❙❙❙)

b+ )
lim H i (Xk , Ln ⊗ O
X
←−

In particular, the horizontal morphism is an isomorphism up to p4N -torsions. On
inverting p, we get our lemma.

b p -sheaf on Xproét are
Recall that the notion of lisse Zp -sheaf on Xét and lisse Z
equivalent. We finally deduce the following crystalline comparison theorem:

Theorem 4.5. Let X be a proper smooth formal scheme over Ok , with X (resp.
b p -sheaf on Xproét . Assume
X0 ) its generic (resp. closed) fiber. Let L be a lisse Z
that L is associated to a filtered F -isocrystal E on X0 /Ok . Then there exists a
canonical isomorphism of Bcris -modules
∼

i
→ Hcris
(X0 /Ok , E) ⊗Ok Bcris
H i (Xk,ét , L) ⊗Zp Bcris −

compatible with Galois action, filtration and Frobenius.
Proof. This is just the composition of the isomorphisms in Themorem 3.27 and
Theorem 4.3.

5. Comparison isomorphism in the relative setting
Let f : X → Y be a smooth morphism between two smooth formal schemes over
Spf(Ok ) of relative dimension d ≥ 0. The induced morphism between the generic
fibers will be denoted by fk : X → Y . We shall denote by wX (resp. wY ) the natural
∼
∼
∼
∼
morphism of topoi Xproét
→ Xét
(resp. Yproét
→ Yét
). By abuse of notation, the
∼
∼
morphism of topoi Xproét → Yproét will be still denoted by fk .
1,ur
+
ur
Let ∇X/Y : OB+
cris,X → OBcris,X ⊗OX ΩX/Y be the natural relative derivation,
∗ 1
where Ω1,ur
X/Y := wX ΩX /Y .

Proposition 5.1. (1) (Relative Poincaré lemma) The following sequence of proétale sheaves is exact and strict with respect to the filtration giving Ωi,ur
X/Y degree
i:
b
0 −→ B+
cris,X ⊗f −1 B+
k

cris,Y

∇X/Y

∇X/Y

1,ur
+
+
ur
fk−1 OB+
cris,Y → OBcris,X −→ OBcris,X ⊗OX ΩX/Y
∇X/Y

d,ur
ur
−→ · · · −→ OB+
cris,X ⊗OX ΩX/Y → 0.

Crystalline comparison isomorphism in p-adic Hodge theory

45

Furthermore, the connection ∇X/Y is integrable and satisfies Griffiths transversality
1,ur
i−1
ur
with respect to the filtration, i.e. ∇X/Y (Fili OB+
OB+
cris,X ) ⊂ Fil
cris,X ⊗OX ΩX/Y .
(2) Suppose the Frobenius on X0 (resp. Y0 ) lifts to a Frobenius σX (resp. σY )
on the formal scheme X (resp. Y) and they commute with f . Then the induced
Frobenius ϕX on OB+
cris,X is horizontal with respect to ∇X/Y .
Proof. The proof is routine (cf. Proposition 2.12), so we omit the detail here.



For the relative version of the crystalline comparison, we shall need the following
primitive comparison in the relative setting.
Proposition 5.2. Let f : X → Y be a proper smooth morphism between two smooth
b p -sheaf on Xproét . Suppose that Ri fk∗ L
formal schemes over Ok . Let L be a lisse Z
b
is a lisse Zp -sheaf on Yproét for all i ≥ 0. Then the following canonical morphism
is an isomorphism:
(5.0.14)

∼

(Ri fk∗ L) ⊗Zbp B+
→ Ri fk∗ (L ⊗Zbp B+
cris,Y −
cris,X )

which is compatible with filtration and Frobenius.
Proof. Remark first that Ri fk∗ L = 0 for i > 2d where d denotes the relative
dimension of f . To show this, write L′ and L′′ the Fp -local system on Xproét
defined by the following exact sequence
(5.0.15)

p

0 −→ L′ −→ L −→ L −→ L′′ −→ 0.

We claim that Ri fk∗ L′ = Ri fk∗ L′′ = 0 for i > 2d. Indeed, as L′ is an Fp -local
system of finite presentation, it comes from an Fp -local system of finite presentation
on Xét , still denoted by L′ . By [Sch13, Corollary 3.17(ii)], we are reduced to
showing that Ri fk ét∗ L′ = 0 for i > 2d, which follows from [Sch13, Theorem 5.1]
and [Hub, 2.6.1] by taking fibers of Ri fk ét∗ L′ at geometric points of Y . Similarly
Ri fk∗ L′′ = 0 for i > 2d. Then, splitting the exact sequence (5.0.15) into two short
exact sequences as in the proof of Theorem 4.3 and applying the higher direct
image functor Rfk∗ , we deduce that the multiplication-by-p morphism on Ri fk∗ L
b p -sheaf on Yproét by our assumption,
is surjective for i > 2d. But Ri fk∗ L is a lisse Z
necessarily Ri fk∗ L = 0 for i > 2d. Consequently, we can choose a sufficiently large
integer N ∈ N such that pN kills the torsion part of L and also the torsion part of
Ri fk∗ L for all i ∈ Z.
Then, it is shown in the proof of [Sch13, Theorem 8.8 (i)], as a consequence
of the primitive comparison isomorphism in the relative setting ([Sch13, Corollary
5.11]), that the following canonical morphism is an almost isomorphism:
(5.0.16)

≈

Ri fk∗ L ⊗Zbp Ainf,Y −→ Ri fk∗ (L ⊗Zbp Ainf,X ).

With this in hand, the proof of Theorem 4.3 applies and gives the result. Indeed,
consider the PD-envelope A0cris,X (resp. A0cris,Y ) of Ainf,X (resp. of Ainf,Y ) with
d
+
respect to the ideal ker(θ : A
→ O
) (resp. to the ideal ker(θ : A
→
X

inf,X

X

Y

inf,Y

d
+
0
O
Y )). Then Acris,X and Acris,Y are respectively the p-adic completions of Acris,X
and A0cris,Y . As in the proof of Theorem 4.3, we obtain from (5.0.16) the following
canonical almost isomorphism
(5.0.17)

≈

Ri fk∗ L ⊗Zbp A0cris,Y −→ Ri fk∗ (L ⊗Zbp A0cris,X ),

46

FUCHENG TAN, JILONG TONG

from which we deduce that for each n the kernel and the cokernel of the natural
morphism below are killed by p2N :
(5.0.18)

Ri fk∗ L ⊗Zbp A0cris,Y /pn −→ Ri fk∗ (L ⊗Zbp A0cris,X /pn ).

Recall from the proof of Theorem 4.3 that Rj lim(L ⊗ Aacris,X /pn ) = 0 whenever
←−
j > 0, hence a spectral sequence:
E2j,i = Rj lim Ri fk∗ (L ⊗ Aacris,X /pn ) =⇒ Ri+j fk∗ (L ⊗ Aacris,X ).
←−

i
n
b p -sheaf, Rj lim Ri fk∗ (L) ⊗ A0
As R fk∗ L is a lisse Z
= 0 for j > 0. It
cris,Y /p
←−n
follows that Rj limn Ri fk∗ (L ⊗ A0cris,X /pn ) is killed by p2N for any j > 0. In
←−
j,i
particular, p2N · E∞
= 0 whenever j > 0. With i fixed, let H := Ri fk∗ (L ⊗ A0cris,X ).
From the theory of spectral sequences, we know that H is endowed with a finite
filtration
0 = F i+1 H ⊂ F i H ⊂ . . . F 1 H ⊂ F 0 H = H,
q
q+1
q,i−q
such that F H/F
H ≃ E∞
. Therefore, F 1 H is killed by p2N i . On the other
0,i
hand, E2 has a filtration of length i
0,i
0,i
0,i
E∞
= E2+i
⊂ E2+(i−1)
⊂ . . . ⊂ E20,i = lim Ri fk∗ (L ⊗ Acris,X /pn ).
←−
0,i
0,i
r,i−r+1
Since in general Er+1 = ker(dr : Er → Er
), it follows that all the successive
0,i
quotients of the filtration above are killed by p2N . So the inclusion E∞
⊂ E20,i has
2N i
cokernel killed by p . To summarize, we have a commutative diagram

/ E 0,i = lim Ri fk∗ (L ⊗ Acris,X /pn )
2
←−
4
✐✐✐✐
✐
✐
✐
2N i
✐
✐
✐
kernel killed by p
✐✐✐
 
✐✐cokernel
killed by p2N i
✐✐✐✐
'
✐
✐
0,i
E∞
Ri fk∗ (L ⊗ Acris,X )

Hence the natural morphism
Ri fk∗ (L ⊗ Aacris,X ) ։ lim Ri fk∗ (L ⊗ Aacris,X /pn )
←−
has kernel and cokernel killed by p2N i . Therefore we deduce like in the proof of
Theorem 4.3 that the kernel and the cokernel of the following canonical morphism
are killed by p2N +2N i :

(5.0.19)

(5.0.20)

Ri fk∗ L ⊗Zbp Acris,Y −→ Ri fk∗ (L ⊗Zbp Acris,X ).

Inverting p in the above morphism, we obtain the desired isomorphism of our
lemma.
It remains to verify the compatibility of the isomorphism (5.0.14) with the extra
structures. It clearly respects Frobenius structures. To check the (strict) compatibility with respect to filtrations, by taking grading quotients, we just need to show
that for each r ∈ N, the following natural morphism
bY (r) −→ Rfk∗ (L ⊗ O
bX (r))
Rfk∗ L ⊗ O

is an isomorphism: it is a local question, hence it suffices to show this after restrictbX |X and O
bY (r)|Y ≃ O
bY |Y , we
bX (r)|X ≃ O
ing the latter morphism to Yk . As O
k
k
k
k
then reduce to the case where r = 0. The proof of the latter statement is similar
to that of Lemma 4.4, so we omit the details here.


Crystalline comparison isomorphism in p-adic Hodge theory

47

For a sheaf of OX -modules F with an OY -linear connection ∇ : F → F ⊗ Ω1X /Y ,
we denote the de Rham complex of F as:
∇

∇

DRX/Y (F ) := (. . . −→ 0 −→ F −→ F ⊗OY Ω1X /Y −→ . . .).
un
The same rule applies if we consider an OX
-module endowed with an OYun -linear
connection etc.
In the lemma below, assume Y = Spf(A) is affine and is étale over a torus
1/pn
S = Spf(Ok {S1±1 , . . . , Sδ±1 }). For each 1 ≤ j ≤ δ, let (Sj )n∈N be a compatible
family of p-power roots of Sj . As in Proposition 2.12, set



±1/pn
±1/pn
±1/pn
±1/pn
, . . . , Sδ
}
, . . . , Sδ
}, Ok {S1
∈ Yproét .
Ye := Y ×Sk Spa k{S1
n∈N

Lemma 5.3. Let V ∈ Yproét be an affinoid perfectoid which is pro-étale over Yek ,
with Vb = Spa(R, R+ ). Let wV be the composite of natural morphisms of topoi
w

∼
∼
∼
wV : Xproét
/XV −→ Xproét
−→ Xét
.

Then
(1) for any j > 0 and r ∈ Z, Rj wV ∗ OBcris = Rj wV ∗ (Filr OBcris ) = 0; and
(2) the natural morphisms
b A OBcris,Y (V ) −→ wV ∗ (OBcris,X )
OX ⊗

and

b A Filr OBcris,Y (V ) → wV ∗ (Filr OBcris,X ) for all r ∈ Z
OX ⊗

b A OBcris,Y (V ) := OX ⊗
b A OAcris,Y (V ) [1/t] with
are isomorphisms. Here OX ⊗
and

b A OAcris,Y (V ) := lim (OX ⊗A OAcris,Y (V )/pn ) ,
OX ⊗
←−


b A Filr+n OAcris,Y (V ) .
b A Filr OBcris,Y (V ) := lim t−n OX ⊗
OX ⊗
−→
n∈N

b A OBcris,Y (V ) using {OX ⊗
b A Filr OBcris,Y (V )}r∈Z ,
In particular, if we filter OX ⊗
the natural morphism
b A OBcris,Y (V ) −→ RwV ∗ (OBcris,X )
OX ⊗

is an isomorphism in the filtered derived category.

Proof. (1) Recall that for j ≥ 0, Rj wV ∗ OBcris,X is the associated sheaf on Xét of
the presheaf sending U ∈ Xét to H i (UV , OBcris,X ), where UV := Uk ×X XV . Now we
take U = Spf(B) ∈ Xét to be affine such that the composition of U → X together
with f : X → Y can be factored as
U −→ T −→ Y,
where the first morphism is étale and that T = Spf(A{T1±1 , . . . , Td±1 }) is a ddimensional torus over Y. Write TV = Tk ×Y V . Then TV = Spa(S, S + ) with
e Se+ ). For each
S + = R{T1±1, . . . , Td±1 } and S = S + [1/p]. Write also UV = Spa(S,
n
1/p
)n∈N be a compatible family of p-power root of Ti , and set
1 ≤ i ≤ d, let (Ti
±1/p∞

+
S∞
= R+ {T1

±1/p∞

, . . . , Td

},

+
+
b A{T ±1 ,...,T ±1 } S∞
Se∞
:= B ⊗
,
1

d

+
+
+
) and (Se∞ , Se∞
) are two affinoid
[1/p]. Then (S∞ , S∞
S∞ :=
and Se∞ = Se∞
b
f
perfectoid algebras over (k, Ob ). Let Uf
∈
X
(resp.
T
∈
Tk proét ) be the
V
proét
V
+
S∞
[1/p]

k

48

FUCHENG TAN, JILONG TONG

+
+
affinoid perfectoid corresponding to (Se∞ , Se∞
) (resp. to (S∞ , S∞
)). So we have the
following commutative diagram of ringed spaces

c
e e+
Uf
V = Spf(S∞ , S∞ )

Γ


c
+
Tf
V = Spa(S∞ , S∞ )

e e+
/ Uc
V = Spa(S, S )

/ U = Spf(B) .


/ Tc
=
Spa(S,
S+)
V

Vb = Spa(R, R+ )


/T


/ Y = Spf(A)

The morphism Uf
V → UV is a profinite Galois cover, with Galois group Γ isomorphic
to Zp (1)d .
q
q
f
f
For q ∈ N, let Uf
V be the (q + 1)-fold fiber product of UV over UV . So UV ≃
q
q
j f
a
Uf
V × Γ is affinoid perfectoid. In particular, for j > 0, H (UV , OAcris,X ) = 0
(Lemma 2.5) and



 q
q
f
Γ
,
OA
(
U
)
.
=
Hom
,
OA
(5.0.21)
H 0 Uf
cris,X
V
cont
V
cris,X

Consequently, the Cartan-Leray spectral sequence associated with the cover Uf
V →
UV almost degenerates at E2 :

 q
q+j
(UV , OAcris,X ),
E1q,j = H j Uf
,
OA
V
cris,X =⇒ H

giving an almost isomorphism E2q,0 ≈ H q (UV , OAcris,X ) for each q ∈ Z. Using
(5.0.21), we see that E2q,0 is the continuous group cohomology H q (Γ, OAcris,X (Uf
V )).
+
e
e
On the other hand, OAcris,X (Uf
)
≈
OA
(
S
,
S
)
by
Lemma
2.17,
so
V
cris ∞
∞
H q (UV , OBcris,X )

≃ H q (UV , OAcris,X )[1/t]
≃ H q (Γ, OAcris,X (Uf
V ))[1/t]

+
≃ H q (Γ, OAcris (Se∞ , Se∞
))[1/t].

+
By definition, the last cohomology group is precisely H q (Γ, OBcris (Se∞ , Se∞
)) comq
puted in §6. Namely, from Theorem 6.12 we deduce H (UV , OBcris,X ) = 0 whenever
q > 0, and that the natural morphism
+
b A OBcris (V ) = B ⊗
b A OBcris (R, R+ ) −→ H 0 (Γ, OBcris (Se∞ , Se∞
OX (U)⊗
)) = H 0 (UV , OBcris,X )

is an isomorphism. Varying U in Xét and passing to associated sheaf, we obtain
∼
e A OBcris,Y (V ) −→
OX ⊗
wV ∗ OBcris,X ,

e A OBcris,Y (V ) is the associated sheaf of the presheaf over
where by definition, OX ⊗
b A OBcris (V ).
Xét sending U ∈ Xét to OX (U)⊗
To concludes the proof of (1) it remains to check that the canonical morphism
below is an isomorhpism:
e A OBcris,Y (V ) −→ OX ⊗
b A OBcris,Y (V ).
(5.0.22)
OX ⊗

Crystalline comparison isomorphism in p-adic Hodge theory

49

Indeed, using wV ∗ OAcris,X = lim wV ∗ (OAcris,X /pn ) and Proposition 6.11, we de←−
duce a natural morphism which is injective with cokernel killed by (1 − [ǫ])2d :
b A OAcris,Y (V ) −→ wV ∗ OAcris,X .
OX ⊗
Therefore inverting t, we get an isomorphism
∼
b A OBcris,Y (V ) −→
OX ⊗
wV ∗ OBcris,X ,

from which the desired isomorphism (5.0.22) follows, since the objects on both sides
of loc. cit. are isomorphic in a natural way to wV ∗ (OBcris,X ).
e A Filr OAcris,Y (V ) and OX ⊗
e A grr OAcris,Y (V ) in the
(2) For r ∈ Z, define OX ⊗
e A Bcris,Y (V ). Like the proof above, we have the natural
same way as is done for OX ⊗
isomorphism below
∼
e A Filr OBcris,Y (V ) −→
OX ⊗
wV ∗ Filr OBcris,X ,

and we need to check that the following canonical morphism is an isomorphism:
e A Filr OBcris,Y (V ) −→ OX ⊗
b A Filr OBcris,Y (V ).
OX ⊗

To see this, remark first that the morphism above is injective since both sides of the
e A OBcris,Y (V ) ≃ OX ⊗
b A OBcris,Y .
morphism above are naturally subsheaves of OX ⊗
For the surjectivity, by taking the graded quotients, we are reduced to showing that
the natural morphism below is an isomorphism:
e A grr OBcris,Y (V ) −→ OX ⊗
b A grr OBcris,Y (V ).
(5.0.23)
OX ⊗

But grr OAcris,Y (V ) ≈ grr OAcris (R, R+ ), while the latter is a free module over R+ .
Furthermore R+ is almost flat over A by the almost purity theorem (recall that V
k, Ob )). So, for U ∈ Xét
is pro-étale over Ye which is an affinoid perfectoid over (b
k

an affine formal scheme,

k


 
b A R+ = lim (OX (U)/pn ) ⊗A R+ ≈ lim (OX /pn ) ⊗A R+ (U).
OX (U)⊗
←−
←−
Inverting p and passing to associated sheaves, we get the required isomorphism
(5.0.23), which concludes the proof of our lemma.

Lemma 5.4. Let E be a filtered convergent F -isocrystal on X , Y = Spf A, and V ∈
Yproét an affinoid perfectoid which is pro-étale over Yek . The canonical morphism
b A OBcris,Y (V ))
RΓ(X , DRX/Y (E)) ⊗A OBcris,Y (V ) −→ RΓ(X , DRX/Y (E)⊗

is an isomorphism in the filtered derived category.

Proof. Write Vb = Spa(R, R+ ). To show our lemma, remark first that the morphism
above respects clearly the filtration on both sides. Secondly, since OAcris,Y (V ) ≈
OAcris (R, R+ ) while the latter is I 2 -flat over A with I ⊂ OAcris (R, R+ ) the ideal
n
generated by ([ǫ]1/p − 1)n∈N (we refer to [Bri, Section 6.3] for this notion and the
proof of this assertion), for any coherent sheaf F on X , the kernel and the cokernel
of the morphism below induced by base change are killed by some (finite) power of
I:
b A OAcris (R, R+ )).
H i (X , F ) ⊗A OAcris (R, R+ ) −→ H i (X , F ⊗
Inverting t, we get an isomorphism
b A OBcris,Y (V )).
H i (X , F ) ⊗A OBcris,Y (V ) −→ H i (X , F ⊗

50

FUCHENG TAN, JILONG TONG

By some standard devissage, we deduce that the morphism in our lemma is an
isomorphism in the derived category. To conclude, we only need to check that the
induced morphisms between the graded quotients are all quasi-isomorphisms. As
in the proof of Corollary 3.25 we are reduced to checking the almost isomorphism
below for any coherent sheaf F on X :
b A grr OAcris,Y (V )),
RΓ(X , F ) ⊗A grr OAcris,Y (V ) −→ RΓ(X , F ⊗

which is clear since grr OAcris,Y (V ) is free over R+ , which is almost flat over A by
the almost purity theorem.


From now on, assume f : X → Y is a proper smooth morphism (between smooth
formal schemes) over Ok . Its closed fiber gives rise to a morphism between the
crystalline topoi,
∼
fcris : (X0 /Ok )∼
cris −→ (Y0 /Ok )cris .
Let E be a filtered convergent F -isocrystal on X0 /Ok , and M an F -crystal on X0 /Ok
such that E ≃ Man (n) for some n ∈ N (cf. Remark 3.5). Then M can be viewed
naturally as a coherent OX -module endowed with an integrable and quasi-nilpotent
Ok -linear connection M → M ⊗ Ω1X /Ok .
In the following we consider the higher direct image Ri fcris∗ M of the crystal
M. One can determine the value of this abelian sheaf on Y0 /Ok at the p-adic PDthickening Y0 ֒→ Y in terms of the relative de Rham complex DRX/Y (M) of M.
To state this, take V = Spf(A) an affine open subset of Y, and put XA := f −1 (V).
We consider A as a PD-ring with the canonical divided power structure on (p) ⊂ A.
In particular, we can consider the crystalline site (XA,0 /A)cris of XA,0 := X ×Y V0
relative to A. By [Ber96, Lemme 3.2.2], the latter can be identified naturally to the
open subsite of (X0 /Ok ) whose objects are objets (U, T ) of (X0 /Ok )cris such that
f (U ) ⊂ V0 and such that there exists a morphism α : T → Vn := V ⊗A A/pn+1 for
some n ∈ N, making the square below commute

/T .
U
can

 
V0 


/ Vn

Using [Ber96, Corollaire 3.2.3] and a limit argument, one finds a canonical identification
∼
Ri fcris∗ (M)(V0 , V) −→ H i ((XA,0 /A)cris , M)
where we denote again by M the restriction of M to (XA,0 /A)cris . Let u = uXA,0 /A
be the morphism of topoi
∼
(XA,0 /A)∼
cris −→ XA ét
0
∼
such that u∗ (F )(U) = H ((U0 /A)cris , F ) for U ∈ XA ét . By [BO, Theorem 7.23],
there exists a natural quasi-isomorphism in the derived category
(5.0.24)

∼

Ru∗ M −→ DRX/Y (M),
∼

i
inducing an isomorphism Hcris
(XA,0 /A, M) −
→ Hi (XA , DRX/Y (M)). Thereby

(5.0.25)

∼

i
Hcris
(XA,0 /A, M) −→ Hi (XA , DRX/Y (M)).

Passing to associated sheaves, we deduce that
Ri fcris∗ (M)Y = Ri f∗ (DRX/Y (M)).

Crystalline comparison isomorphism in p-adic Hodge theory

51

On the other hand, as f : X → Y is proper and smooth, Ri f∗ (DRX/Y (E)), viewed
as a coherent sheaf on the adic space Y , is the i-th relative convergent cohomology
of E with respect to the morphism f0 : X0 → Y0 . Thus, by [Ber86, Théorème 5] (see
also [Tsu, Theorem 4.1.4]), if we invert p, the OY [1/p]-module Ri f∗ (DRX/Y (E)) ≃
Ri f∗ (DRX/Y (M))[1/p], together with the Gauss-Manin connection and the natural Frobenius structure inherited from Ri fcris∗ (M)Y ≃ Ri f∗ (DRX/Y (M)), is a
convergent F -isocrystal on Y0 /Ok , denoted by Ri fcris∗ (E) in the following (this is
an abuse of notation, a more appropriate notation should be Ri f0 conv∗ (E)). Using
the filtration on E, one sees that Ri fcris∗ (E) has naturally a filtration, and it is
well-known that this filtration satisfies Griffiths transversality with respect to the
Gauss-Manin connection.
Proposition 5.5. Let X → Y be a proper smooth morphism between two smooth
formal schemes over Ok . Let E be a filtered convergent F -isocrystal on X0 /Ok and
b p -sheaf on Xproét . Assume that E and L are associated. Then there is a
L a lisse Z
natural filtered isomorphism of OBcris,Y -modules
(5.0.26)

∼
−1
b k−1 OBcris,Y ) −→
Ri fk∗ (L ⊗Zbp Bcris,X ⊗f
wY
(Ri fcris∗ (E)) ⊗ OBcris,Y

which is compatible with Frobenius and connection.

Proof. Using the relative Poincaré lemma (Proposition 5.1 (1)) and the fact that L
and E are associated, we have the following filtered isomorphisms compatible with
connection:
b k−1 OBcris,Y )
Ri fk∗ (L ⊗ Bcris,X ⊗f
∼
i
−→ R fk∗ (L ⊗ DRX/Y (OBcris,X ))
∼
(5.0.27)
−→ Ri fk∗ (DRX/Y (L ⊗ OBcris,X ))
∼
−1
E ⊗ OBcris,X ))
−→ Ri fk∗ (DRX/Y (wX
∼
−1
i
−→ R fk∗ (wX DRX/Y (E) ⊗ OBcris,X ).
On the other hand, we have the morphism below given by adjunction which respects
also the connections on both sides:
−1 i
−1
b
(5.0.28) wY
R f∗ (DRX/Y (E)) ⊗ OBcris,Y −→ Ri fk∗ (wX
DRX/Y (E)⊗OB
cris,X ).

We claim that the morphism (5.0.28) is a filtered isomorphism. This is a local
question, we may and do assume first that Y = Spf(A) is affine and is étale over
some torus defined over Ok . Let V ∈ Yproét be an affinoid perfectoid pro-étale over
Yek . As Ri f∗ (DRX/Y (E)) = Ri fcris∗ (E) is a locally free OY [1/p]-module over Y and
as OBcris (V ) is flat over A ([Bri, Théorème 6.3.8]),

−1 i
wY
R f∗ (DRX/Y (E)) ⊗ OBcris,Y (V ) ≃ H i (X , DRX/Y (E)) ⊗A OBcris,Y (V ).

So we only need to check that the natural morphism below is a filtered isomorphism
−1
b
H i (X , DRX/Y (E)) ⊗A OBcris,Y (V ) −→ H i (XV , wX
DRX/Y (E)⊗OB
cris,X ).

By Lemma 5.3 one has the following identifications that are strictly compatible
with filtrations:
−1
H i (XV , wX
DRX/Y (E) ⊗ OBcris,X ) ≃

≃

−1
H i (X , RwV ∗ (wX
DRX/Y (E) ⊗ OBcris,X ))
b A OBcris,Y (V )).
H i (X , DRX/Y (E)⊗

52

FUCHENG TAN, JILONG TONG

Thus we are reduced to proving that the canonical morphism below is a filtered
isomorphism:
b A OBcris,Y (V )),
H i (X , DRX/Y (E)) ⊗A OBcris,Y (V ) −→ H i (X , DRX/Y (E)⊗

which follows from Lemma 5.4.
Composing the isomorphisms in (5.0.27) with the inverse of (5.0.28), we get the
desired filtered isomorphism (5.0.26) that is compatible with connections on both
sides. It remains to check the Frobenius compatibility of (5.0.26). For this, we may
and do assume again that Y = Spf(A) is affine and is étale over some torus over
Ok , and let V ∈ Yproét some affinoid perfectoid pro-étale over Ye . In particular, A
admits a lifting of the Frobenius on Y0 , denoted by σ. Let M be an F -crystal on
X0 /Ok such that E = Man (n) for some n ∈ N (Remark 3.5). Then the crystalline
cohomology H i (X0 /A, M) is endowed with a Frobenius which is σ-semilinear. We
just need to check the Frobenius compatibility of composition of the maps below
(here the last one is induced by the inverse of (5.0.26)):
∼

i
i
Hcris
(X0 /A, M) −→ Hcris
(X
−→ H i (X , DRX/Y (E)) −→
 0 /A, M)[1/p]
−1
i
i
b k−1 OBcris,Y ),
wY (R fcris∗ (E) ⊗ OBcris,Y (V ) −→ H (XV , L ⊗ Bcris,X ⊗f

which can be done exactly in the same way as in the proof of Theorem 3.27.



The relative crystalline comparison theorem then can be stated as follows:
b p -sheaf on X associated to a filtered
Theorem 5.6. Let L be a crystalline lisse Z
b p -sheaf
F -isocrystal E on X0 /Ok . Assume that, for any i ∈ Z, Ri fk∗ L is a lisse Z
i
on Y . Then R fk∗ L is crystalline and is associated to the filtered convergent F isocrystal Ri fcris∗ E.
Proof. Let us first observe that the filtration on Ri fcris∗ E is given by locally direct
summands (so Ri fcris∗ E is indeed a filtered convergent F -isocrystal on Y0 /Ok ). To
b p -sheaf
see this, one uses [Sch13, Theorem 8.8]: by Proposition 3.23, the lisse Z
L is de Rham with associated filtered OX -module with integrable connection E.
Therefore the Hodge-to-de Rham spectral sequence

E1i,j = Ri+j f∗ gri DRX/Y (E) =⇒ Ri+j f∗ (DRX/Y (E))
degenerates at E1 . Moreover E1i,j , the relative Hodge cohomology of E in [Sch13,
Theorem 8.8], is a locally free OY -module of finite rank for all i, j by loc. cit.
Therefore the filtration on Ri f∗ (DRX/Y (E)) = Ri fcris∗ (E), which is the same as
the one induced by the spectral sequence above, is given by locally direct summands.
To complete the proof, we need to find filtered isomorphisms that are compatible
with Frobenius and connections:
∼

−1 i
R fcris∗ (E) ⊗ OBcris,Y ,
Ri fk∗ (L) ⊗ OBcris,Y −→ wY

i ∈ Z.

By Proposition 5.2 and Proposition 5.5, we only need to check that the natural
morphism below is a filtered almost isomorphism compatible with Frobenius and
connections:
i
b
b k−1 OAcris,Y ).
Ri fk∗ (L ⊗ Acris,X )⊗OA
cris,Y −→ R fk∗ (L ⊗ Acris,X ⊗f

The proof of this is similar to that of Proposition 5.2: one just remarks that for
each n ∈ N, OAcris,Y /pn |Ye ≃ Acris,Y |Ye hw1 , . . . , wδ i/pn hence OAcris,Y |Ye /pn is free
over Acris,Y /pn with a basis given by the divided powers w[α] with α ∈ Nδ (recall
that for 1 ≤ j ≤ δ, wj = Sj − [Sj♭ ] ∈ OAcris,Y |Ye ).


Crystalline comparison isomorphism in p-adic Hodge theory

53

6. Appendix: geometric acyclicity of OBcris
In this section, we extend the main results of [AB] to the setting of perfectoids.
The generalization is rather straightforward. Although one might see here certain
difference from the arguments in [AB], the strategy and technique are entirely
theirs.
Let f : X = Spf(B) → Y = Spf(A) be a smooth morphism between two smooth
affine formal scheme over Ok . Write X (resp. Y ) the generic fiber of X (resp. of
Y). By abuse of notation the morphism X → Y induced from f is still denoted by
f.
Assume that Y is étale over the torus S := Spf(Ok {S1±1 , . . . , Sδ±1 }) defined over
Ok and that the morphism f : X → Y can factor as
étale

X −→ T −→ Y,
so that T = Spf(C) is a torus over Y and the first morphism X → T is étale.
Write C = A{T1±1 , . . . , Td±1 }. For each 1 ≤ i ≤ d (resp. each 1 ≤ j ≤ δ), let
1/pn
1/pn
}n∈N (resp. {Sj }n∈N ) be a compatible family of p-power roots of Ti (resp.
{Ti
of Sj ). As in Proposition 2.12, we denote by Ye the following fiber product over the
generic fiber Sk of S:
±1/p∞

Y ×Sk Spa(k{S1

±1/p∞

, . . . , Sδ

±1/p∞

}, Ok {S1

±1/p∞

, . . . , Sδ

}).

Let V ∈ Yproét be an affinoid perfectoid over Yek with Vb = Spa(R, R ). Let TV =
e Se+ ) the base change
Spa(S, S + ) be the base change Tk ×Y V and XV = Spa(S,
±1
±1
+
+
+
X ×Y V . Thus S = R {T1 , . . . , Td } and S = S [1/p]. Set
n
o
±1/p∞
±1/p∞
+
+
+
b C S∞
, · · · , Td
, Se∞
:= B ⊗
,
S∞
= R + T1
+

+
+
+
+
S∞ := S∞
[1/p] and Se∞ := Se∞
[1/p]. Then (S∞ , S∞
) and (Se∞ , Se∞
) are affinoids
perfectoids and
n
o
∞
∞
♭+
S∞
= R♭+ (T1♭ )±1/p , · · · , (Td♭ )±1/p
,
2

1/p
1/p
♭+
+
+
, . . .) ∈ S∞
. The inclusions S + ⊂ S∞
and Se+ ⊂ Se∞
where Ti♭ := (Ti , Ti , Ti
define two profinite Galois covers. Their Galois groups are the same, denoted by Γ,
which is a profinite group isomorphic to Zp (1)d . One can summarize these notations
in the following commutative diagramme
+ o
Se∞
O

Γ

+ o
S∞

Γ

±1/p∞

R+ {T1

±1/p∞

, . . . , Td

Γ
}o

SeO+ o

BO

S+ o

C

R+ {T1±1, . . . , Td±1 } o
O

A{T1±1 , . . . , Td±1 }
O

R+ o

A

étale

54

FUCHENG TAN, JILONG TONG

+
The group Γ acts naturally on the period ring OBcris (Se∞ , Se∞
) and on its filtration
r
+
Fil OBcris (Se∞ , Se∞ ). The aim of this appendix is to compute the group cohomology






q
+
+
H q Γ, OBcris Se∞ , Se∞
[1/t]
:= Hcont
Γ, OAcris Se∞ , Se∞

and







1
q
r+n
r
+
+
e
e
e
e
OAcris S∞ , S∞
:= lim Hcont Γ, n Fil
H Γ, Fil OBcris S∞ , S∞
−→
t
q

n≥|r|

for q, r ∈ Z.
In the following, we will omit systematically the subscript “cont” whenever there
is no confusion arising. Moreover, we shall use the multi-index to simplify the
notation: for example, for a = (a1 , . . . , ad ) ∈ Z[1/p]d , T a := T1a1 · T2a2 · · · Tdad .
+
6.1. Cohomology of OBcris . We will first compute H q (Γ, OAcris (S∞ , S∞
)/pn ) up
∞
to (1 − [ǫ]) -torsion for all q, n ∈ N.

Lemma 6.1. For n ∈ Z≥1 , there are natural isomorphisms
∼

+
♭+
)/pn
Acris (R, R+ )/pn ⊗W (R♭+ )/pn W (S∞
)/pn −→ Acris (S∞ , S∞

and


∼
+
+
)/pn ,
Acris (S∞ , S∞
)/pn ⊗ OAcris (R, R+ )/pn hu1 , . . . , ud i −→ OAcris (S∞ , S∞

sending ui to Ti − [Ti♭ ]. Here the tensor product in the last isomorphism above is
taken over Acris (R, R+ )/pn .
Moreover, the natural morphisms
+
Acris (R, R+ )/pn → Acris (S∞ , S∞
)/pn ,

+
OAcris (R, R+ )/pn → OAcris (S∞ , S∞
)/pn

are both injective.
+
Proof. Recall ξ = [p♭ ] − p. We know that Acris (S∞ , S∞
) is the p-adic completion of

 m
♭+
W (S∞
)[X0 , X1 , · · · ]
ξ
+
♭+
|m = 0, 1, · · · =
.
A0cris (S∞ , S∞
) := W (S∞
)
m!
(m!Xm − ξ m : m ∈ Z≥0 )
Note that we have the same expression with R in place of S∞ . We then have

W (R♭+ )[X0 , X1 , · · · ]
(m!Xm − ξ m |m ∈ Z≥0 )

∼

♭+
W (S∞
) ⊗W (R♭+ )

=

♭+
W (S∞
) ⊗W (R♭+ ) A0cris (R, R+ ).

+
A0cris (S∞ , S∞
) ←−

The first isomorphism follows.
Secondly, as V lies above Yek , by Proposition 2.12 we have
∼

Acris (R, R+ ){hw1 , . . . , wδ i} −→ OAcris (R, R+ ),
1/p

1/p2

where Sj♭ := (Sj , Sj , Sj

wj 7→ Sj − [Sj♭ ]

, . . .) ∈ R♭+ . Similarly
∼

+
+
Acris (S∞ , S∞
){hu1 , . . . , ud , w1 , . . . , wδ i} −→ OAcris (S∞ , S∞
),

ui 7→ Ti −[Ti♭], wj 7→ Sj −[Sj♭ ].

Crystalline comparison isomorphism in p-adic Hodge theory

55

Thus (the isomorphisms below are all the natural ones)


+
+
Acris (S∞ , S∞
)
OAcris (S∞ , S∞
)
∼
hu1 , . . . , ud , w1 , . . . , wδ i
←−
pn
pn


+
Acris (S∞ , S∞
)
Acris (R, R+ )
∼
⊗ Acris (R,R+ )
hu1 , . . . , ud , w1 , . . . , wδ i
←−
pn
pn
pn


+
Acris (S∞ , S∞
)
OAcris (R, R+ )
∼
−→
⊗ Acris (R,R+ )
hu1 , . . . , ud i
pn
pn
pn


+
OAcris (R, R+ )
Acris (S∞ , S∞
)
∼
hu1 , . . . , ud i.
⊗ Acris (R,R+ )
−→
pn
pn
pn
So our second isomorphism is obtained.
+
Next we prove that the natural morphism Acris (R, R+ )/pn → Acris (S∞ , S∞
)/pn
is injective. When n = 1, we are reduced to showing the injectivity of
(S ♭+ /(p♭ )p )[X1 , X2 , . . .]
(R♭+ /(p♭ )p )[X1 , X2 , . . .]
−→
,
p
p
(X1 , X2 , . . .)
(X1p , X2p , . . .)
or equivalently the injectivity of
i
h

∞
∞
R♭+ /(p♭ )p → S ♭+ /(p♭ )p = R♭+ /(p♭ )p (T1♭ )±1/p , . . . (Td♭ )±1/p ,

+
which is clear. The general case follows easily since Acris (S∞ , S∞
) is p-torsion free.
+
n
+
One deduces also the injectivity of OAcris (R, )/p → OAcris (S∞ , S∞
)/pn by using
+
n
+
n
the natural isomorphisms OAcris (R, R )/p ≃ (Acris (R, R )/p )hw1 , . . . , wδ i, and
+
+
OAcris (S∞ , S∞
)/pn ≃ (Acris (S∞ , S∞
)/pn )hu1 , . . . , ud , w1 , . . . , wδ i. This concludes
the proof of our lemma.

+
Proposition 6.2. Acris (S∞ , S∞
)/pn is free over Acris (R, R+ )/pn with a basis give
♭ a
d
by {[T ] |a ∈ Z[1/p] }.

+
Proof. By Lemma 6.1, Acris (S∞ , S∞
)/pn is generated over Acris (R, R+ )/pn by el∞
∞
♭+
ements of the form [x] with x ∈ S∞ = R♭+ {(T1♭ )±1/p , . . . , (Td♭ )±1/p }. Write
+
Bn ⊂ Acris (S∞ , S∞
)/pn for the Acris(R, R+ )/pn -submodule generated
by elements
∞
∞
♭+
⊂ S∞
. We claim
of the form [x] with x ∈ S := R♭+ (T1♭ )±1/p , . . . , (Td♭ )±1/p
+
that Bn = Acris (S∞ , S∞
)/pn .
♭+
Since S∞
is the p♭ -adic completion of S, for each x ∈ S ♭+ we can write x =
♭ ′
y0 + p x with x′ ∈ S. Iteration yields

x = y0 + p♭ y1 + · · · + (p♭ )p−1 yp−1 + (p♭ )p x′′
♭+
♭+
with yi ∈ S and x′′ ∈ S∞
. Then in W (S∞
):

[x]

♭+
≡ [y0 ] + [p♭ ][y1 ] + · · · + [(p♭ )p−1 ][yp−1 ] + [(p♭ )p ][x′′ ] mod pW (S∞
)

≡ [y0 ] + ξ[y1 ] + · · · + ξ p−1 [yp−1 ] + ξ p [x′′ ] mod

♭+
pW (S∞
).

+
+
As ξ ∈ Acris (S∞ , S∞
) has divided power, ξ p = p! · ξ [p] ∈ pAcris (S∞ , S∞
). So we
+
obtain in Acris (S∞ , S∞ )

[x] ≡ [y0 ] + ξ[y1 ] + · · · + ξ p−1 [yp−1 ] mod

+
pAcris (S∞ , S∞
).

56

FUCHENG TAN, JILONG TONG

+
♭+
For any α ∈ Acris (S∞ , S∞
)/pn = Acris (R, R+ )/pn ⊗W (R♭+ )/pn W (S∞
)/pn , we may
write
m
X
♭+
+
λi [xi ] + pα′ , xi ∈ S∞
, λi ∈ Acris (R, R+ )/pn , α′ ∈ Acris (S∞ , S∞
)/pn .
α=
i=0

The observation above tells us that one can write
α = β0 + pα′′ ,

+
β0 ∈ Bn , α′′ ∈ Acris (S∞ , S∞
)/pn .

By iteration again, we find
α = β0 + pβ1 + · · · pn−1 βn−1 + pn α̃,

+
β0 , · · · , βn−1 ∈ Bn , α̃ ∈ Acris (S∞ , S∞
)/pn .

Thus
+
α = β0 + pβ1 + · · · pn−1 βn−1 ∈ Bn ⊂ Acris (S∞ , S∞
)/pn .
+
n
This shows the claim, i.e. Acris (S∞ , S∞ )/p is generated over Acris (R, R+ )/pn by
∞
∞
♭+
the elements of the form [x] with x ∈ S = R♭+ [(T1♭ )±1/p , . . . , (Td♭ )±1/p ] ⊂ S∞
.
♭+
Furthermore, as for any x, y ∈ S∞
♭+
[x + y] ≡ [x] + [y] mod pW (S∞
),
+
a similar argument shows that Acris (S∞ , S∞
)/pn is generated over Acris (R, R+ )/pn
d
♭ a
by the family of elements {[T ] |a ∈ Z[1/p] }.
It remains to show the freeness of the family {[T ♭ ]a |a ∈ Z[1/p]d } over Acris (R, R+ )/pn .
For this, suppose there exist λ1 , · · · , λm ∈ Acris (R, R+ ) and distinct elements
a1 , · · · , am ∈ Z[1/p]d such that
m
X
+
).
λi [T ♭ ]ai ∈ pn Acris (S∞ , S∞
i=1

+
One needs to prove λi ∈ pn Acris (R, R+ ) for each i. Modulo p we find in Acris (S∞ , S∞
)/p
that
m
X
λi · (T ♭ )ai = 0,
i=1

with λi ∈ Acris (R, R+ )/p the reduction modulo p of λi . On the other hand, the
family of elements {(T ♭ )a : a ∈ Z[1/p]d } in
+
Acris (S∞ , S∞
)/p

≃

S ♭+ /((p♭ )p )[δ2 , δ3 , . . .]
(δ2p , δ3p , . . .)

≃

R♭+ /((p♭ )p )[(T1♭ )±1/p , . . . , (Td♭ )±1/p , δ2 , δ3 , . . .]
(δ2p , δ3p , . . .)

∞

♭+

♭ p

∞

) )[δ2 ,δ3 ,...]
is free over Acris (R, R+ )/p ≃ R /((p
. Therefore, λi = 0, or equivalently,
(δ2p ,δ3p ,...)
λi = pλ′i for some λ′i ∈ Acris (R, R+ ). In particular,
!
m
m
X
X
+
).
λi [T ♭ ]ai = p ·
λ′i [T ♭ ]ai ∈ pn Acris (S∞ , S∞
i=1

i=1

+
But Acris (S∞ , S∞
) is p-torsion free, which implies that
m
X
+
λ′i [T ♭ ]ai ∈ pn−1 Acris (S∞ , S∞
).
i=1

Crystalline comparison isomorphism in p-adic Hodge theory

57

This way, we may find λi = pn λ̃i for some λ̃i ∈ Acris (R, R+ ), which concludes the
proof of the freeness.

+
Recall that Γ is the Galois group of the profinite cover (S∞ , S∞
) of (S, S + ). Let
(0) (1)
♭
ǫ = (ǫ , ǫ , . . .) ∈ Ob be a compatible system of p-power roots of unity such that
k

ǫ(0) = 1 and that ǫ(1) 6= 1. Let {γ1 , . . . , γd } be a family of generators such that for
each 1 ≤ i ≤ d, γi acts trivially on the variables Tj for any index j different from i
and that γi (Ti♭ ) = ǫTi♭ .
Lemma 6.3 ([AB] Lemme 11). Let 1 ≤ i ≤ d be an integer. Then one has
n
n
+
γi ([Ti♭ ]p ) = [Ti♭ ]p in OAcris (S∞ , S∞
)/pn .
n

n

n

+
Proof. By definition, γi ([Ti♭ ]p ) = [ǫ]p [Ti♭ ]p in OAP
cris (S∞ , S∞ ). So our lemma
nr [r]
pn
n

follows from the fact that [ǫ] − 1 = exp(p t) − 1 = r≥1 p t ∈ pn Acris .

+
Let An be the OAcris (R, R+ )-subalgebra of OAcris (S∞ , S∞
)/pn generated by
for 1 ≤ i ≤ d. The previous lemma shows that Γ acts trivially on An .
Furthermore, by the second isomorphism of Lemma 6.1 and by Proposition 6.2, we
have


+
M
OAcris (S∞ , S∞ ) ∼ 
−→
An [T ♭ ]a  hu1 , . . . , ud i, Ti − [Ti♭ ] 7→ ui .
pn
d
n d

n
[Ti♭ ]±p

a∈Z[1/p] ∩[0,p )

+
Transport the Galois action of Γ on OAcris (S∞ , S∞
)/pn to the righthand side of
this isomorphism. It follows that

γi (ui ) = ui + (1 − [ǫ])[Ti♭ ].
Therefore,
[n]

[n]

γi (ui ) = ui +

n
X

[n−j]

[Ti♭ ]j (1 − [ǫ])[j] ui

.

j=1

[n]

[n]

For other index j 6= i, γi (uj ) = uj and hence γi (uj ) = uj for any n. Set
M
M
An [T ♭ ]a , and An :=
An [T ♭ ]a .
Xn :=
a∈(Z[1/p]∩[0,pn ))d \Zd

a∈Zd ∩[0,pn )d

Then we have the following decomposition, which respects the Γ-actions:
+
OAcris (S∞ , S∞
)/pn = Xn hu1 , . . . , ud i ⊕ An hu1 , . . . , ud i.

Proposition 6.4 ([AB] Proposition 16). For any integer q ≥ 0, H q (Γ, Xn hu1 , . . . , ud i)
is killed by (1 − [ǫ]1/p )2 .
Proof. Let An [T ♭ ]a be a direct summand of Xn with a ∈ (Z[1/p] ∩ [0, pn ))d \ Z.
Write a = (a1 , . . . , ad ). Clearly we may assume that a1 ∈
/ Z.
We claim first that cohomology group H q (Γ1 , An [T ♭ ]a ) is killed by 1 − [ǫ]1/p for
any q, where Γ1 ⊂ Γ is the closed subgroup generated by γ1 . As Γ1 is topologically
cyclic with a generator γ1 , the desired cohomology H q (Γ1 , An · [T ♭ ]a ) is computed
using the following complex
γ1 −1

An · [T ♭ ]a −→ An · [T ♭ ]a .
We need to show that the kernel and the cokernel of the previous map are both
killed by 1 − [ǫ]1/p . We have (γ1 − 1)([T ♭ ]a ) = ([ǫ]a1 − 1)[T ♭ ]a . Since a1 ∈
/ Z, its

58

FUCHENG TAN, JILONG TONG

p-adic valuation is ≤ −1. Therefore, 1 − [ǫ]1/p is a multiple of 1 − [ǫ]a1 , which
implies that coker(γ − 1 : Xn → Xn ) is killed by 1 − [ǫ]1/p . On the other hand,
let x = λ · [T ♭ ]a be an element in ker(γ1 − 1 : An · [T ♭ ]a → An · [T ♭ ]a ). Then
(γ1 − 1)(x) = λ([ǫ]a1 − 1)[T ♭ ]a and necessarily λ([ǫ]a1 − 1) = 0. Since 1 − [ǫ]1/p is a
multiple of [ǫ]a1 − 1, (1 − [ǫ])λ = 0 and thus (1 − [ǫ]1/p )x = 0, giving our claim.
Now for each 1 ≤ i ≤ d, let



d
\
(i)
n
/Z
E := a = (a1 , . . . , ad ) ∈ Z[1/p] [0, p ) : a1 , . . . , ai−1 ∈ Z, ai ∈

and

M

X(i)
n :=

An [T ♭ ]a .

a∈E (i)

Then we have the following decompositions which respect also the Γ-action:
Xn =

d
M

X(i)
n ,

Xn hu1 , . . . , ud i =

d
M

X(i)
n hu1 , . . . , ud i.

i=1

i=1

(i)

So we are reduced to proving that for each 1 ≤ i ≤ d, H q (Γ, Xn hu1 , . . . , ud i) is
killed by (1 − [ǫ]1/p )2 for all q ≥ 0. By what we have shown in the beginning of
(i)
the proof, H q (Zp γi , Xn ) is killed by 1 − [ǫ]1/p . As γi acts trivially on uj for j 6= i,
(i)
one computes as in [AB, Lemme 15] and then finds that H q (Zp γi , Xn hu1 , . . . , ud i)
1/p
is killed by 1 − [ǫ] . Finally, one uses the Hochschild-Serre spectral sequence to
(i)
conclude that H q (Γ, Xn hu1 . . . , ud i) is killed by (1 − [ǫ]1/p )2 for any q ≥ 0, as
desired.

The computation of H q (Γ, An hu1 , . . . , ud i) is more subtle. Note that we have
the following decomposition
d
i
h
O
(OAcris (R, R+ )/pn ) [Ti♭ ]±1 hui i,
An hu1 , . . . , ud i =
i=1

where the tensor products above are taken over OAcris (R, R+ )/pn .
We shall first treat the case where d = 1. We set T := T1 , u := u1 and
(m)
+
)/pn generated by the
γ := γ1 . Let An be the An -submodule of OAcris (S∞ , S∞
[m+a]
♭ a
n
u
/[T ] ’s with m + a ≥ 0 and 0 ≤ a < p . Then
h
i
X
An hui = An [T ♭ ] hui =
A(m)
n .
m>−pn

Consider the following complex:
h
i
h
i
γ− 1
(6.1.1)
An [T ♭ ] hui −→ An [T ♭ ] hui,



which computes H q (Γ, An hui) = H q Γ, An [T ♭ ] hui .

Lemma 6.5 ([AB] Proposition 20). The cokernel of (6.1.1), and hence H q (Γ, An hui)
for any q > 0, are killed by 1 − [ǫ].
(m)

Proof. We will proceed by induction on m > −pn to show that (1 − [ǫ])An
(1−pn )
= An · [T ♭ ]1pn −1 , while
contained in the image of (6.1.1). Note first An
n

(γ − 1)(U/[T ♭ ]p ) = (1 − [ǫ])

1
.
[T ♭ ]pn −1

is

Crystalline comparison isomorphism in p-adic Hodge theory

59

(1−pn )

Thus (1−[ǫ])An
is contained in the image of (6.1.1). Let m > −pn be a fixed in[m+pn −i]
(m)
teger. Then An is generated over An by u[T ♭ ]pn −i for i = 1, . . . , D := min(pn , pn +


m). On the other hand, for u[m+a] /[T ♭]a ∈ An [T ♭ ] hui with max(0, −m) ≤ a ≤
pn , we have
(u + (1 − [ǫ])[T ♭ ])[m+a] − [ǫ]a u[m+a]
[T ♭ ]a
X
u[m+a]
u[m+a−i]
(1 − [ǫ]a ) ♭ a +
(1 − [ǫ])[i]
[T ]
[T ♭ ]a−i
1≤i≤a

[ǫ]a (γ − 1)(u[m+a] /[T ♭ ]a ) =
=

i≤m+a

X

+

n

(1 − [ǫ])[i] [T ♭ ]p

a+1≤i≤a+pn
i≤m+a

u[m+a−i]
[T ♭ ]a−i+pn

+...
[n]

As for n ≥ 2, (1 − [ǫ]) is a multiple of 1 − [ǫ] ([AB, Lemme 18]), and all the terms
(m−rpn )
from the second line of the last equality belong to An
for r = 1, 2, . . .. By
induction hypothesis, we may assume that all these terms belong to the image of
(6.1.1). Write
(1 − [ǫ])[j]
1 − [ǫ]j
, and βj =
.
αj =
1 − [ǫ]
1 − [ǫ]
Modulo the image of (6.1.1), we find for max(0, −m) ≤ a < pn


n
U [m+a]
U [m+a−2]
U [m+a−1]
U [m+p −D]
(1−[ǫ]) αa
+
+ β2
+ . . . + βa−(pn −D)
≡ 0;
[T ♭ ]a
[T ♭ ]a−1
[T ♭ ]a−2
[T ♭ ]pn −D
n

and for a = pn , as [ǫ]p = 1 in Acris /pn , modulo the image of (6.1.1) we have

 [m+pn −1]
n
n
u[m+p −2]
u[m+p −D]
u
+
β
+
.
.
.
+
β
≡0
(1 − [ǫ])
2
D
[T ♭ ]pn −1
[T ♭ ]pn −2
[T ♭ ]pn −D

Therefore, combining these congruences and modulo the image of (6.1.1) we have
 [m+pn −1]

n
u
u[m+p −D]
(1 − [ǫ])
· Mn(m) ≡ 0
,...,
[T ♭ ]pn −1
[T ♭ ]pn −D
(m)

where Mn

is the matrix

1
apn −1
 β2
1


..
..

.
.

 βD−1 βD−2
βD
βD−1

0
apn −2
..
.

...
...
..
.

0
0
..
.

βD−3
βD−2

. . . apn −D
...
1






 ∈ MD (Acris /pn ).



One can check that this matrix is invertible ([AB, Lemme 19]), so modulo the image
[m+pn −i]
(m)
of (6.1.1) we have (1 − [ǫ]) u[T ♭ ]pn −i = 0 for 1 ≤ i ≤ D. In other words, (1 − [ǫ])An
is contained in the image of (6.1.1).

One still needs to compute H 0 (Γ, An hui). One remarks first that we have the
following isomorphism
h
i


∼
→ An hui = (OAcris (R, R+ )/pn ) [T ♭ ] hui
OAcris (R, R+ )/pn T ±1 hui −

60

FUCHENG TAN, JILONG TONG

sending T to u + [T ♭ ]. Endow an action of Γ on (OAcris (R, R+ )/pn )[T ±1 ]hui via
the isomorphism above. So H 0 (Γ, An hui) is naturally isomorphic to the kernel of
the morphism
γ − 1 : (OAcris (R, R+ )/pn )[T ±1 ]hui −→ (OAcris (R, R+ )/pn )[T ±1 ]hui,

(6.1.2)

and there is a natural injection
C ⊗A OAcris (R, R+ )/pn = (OAcris (R, R+ )/pn )[T ±1 ] ֒→ H 0 (Γ, An hui).
Lemma 6.6 ([AB] Lemme 29). The cokernel of the last map is killed by 1 − [ǫ].
Proof. We have γ(u) = T − [ǫ][T ♭ ] = (1 − [ǫ])T + [ǫ]u. Therefore
[m]

(γ − 1)(u[m] ) =

((1 − [ǫ]) T + [ǫ]u) − u[m]
m
X
(1 − [ǫ])[j] T j [ǫ]m−j u[m−j]
([ǫ]m − 1)u[m] +

=

(1 − [ǫ]) µm u[m] +

=
where µm =
matrix

(N )

G

m

[ǫ] −1
1−[ǫ] ,



0
0
..
.




:= 

 0
0

βj =

j=1



[j]

(1−[ǫ])
1−[ǫ]

T
µ1
..
.

T 2 β2
T [ǫ]
..
.

0
0

0
0

m
X
j=1



βj T j [ǫ]m−j u[m−j]  ,

(so β1 = 1). For N > 0 an integer, consider the

...
T N βN
N −1
... T
βN −1 [ǫ]
..
..
.
.
T β1 [ǫ]N −1
µN

...
...

Then we have






 ∈ M1+N (Acris,n [T ±1 ]).



(γ − 1)(1, u, u[2], . . . , u[N ] ) = (1 − [ǫ])(1, u, u[2], . . . , u[N ] )G(N ) .
Write
G(N ) =



0 H (N )
0
D



with D = (0, . . . , 0, µN ) a matrix of type 1 × N . On checks that the matrix H (N ) ∈
MN (Acris,n [T ±1 ]) is invertible.


Now let α ∈ (OAcris (R, R+ )/pn ) T ±1 hui be an element contained in the kernel
of (6.1.2). Write
α=

N
X

as u[s] ∈

s=0

OAcris (R, R+ )/pn

  ±1 
T
hui,

as ∈ (OAcris (R, R+ )/pn )[T ±1 ].

As α is contained in the kernel of (6.1.2),

(γ − 1)(1, u, . . . , u[N ] )(a0 , a1 , . . . , aN )t = 0.
It follows that
(1 − [ǫ])(1, u, . . . , u

[N ]

)



H (N ) ã
µN a N



=0

with ã = (a1 , . . . , aN ). As the family {1, u, . . . , u[N ] } is linearly independent, (1 −
[ǫ])H (N ) ã = 0. Since H (N ) is invertible, we deduce (1 − [ǫ])ã = 0. In other words,
(1 − [ǫ])ai = 0 for i ≥ 1 and the lemma follows.


Crystalline comparison isomorphism in p-adic Hodge theory

61

Now we are ready to prove
Proposition 6.7. For any d > 0, n > 0 and q > 0, H q (Γ, An hu1 , . . . , ud i) is killed
by (1 − [ǫ])2d−1 . Moreover, the natural morphism
(6.1.3)

C ⊗A OAcris (R, R+ )/pn −→ H 0 (Γ, An hu1 , . . . , ud i),

Ti 7→ ui + [Ti♭ ]

is injective with cokernel killed by (1 − [ǫ])2d−1 .
Proof. Recall that we have the decomposition
d
h
i
O
(OAcris (R, R+ )/pn ) [Ti♭ ]±1 hui i.
An hu1 , . . . , ud i =
i=1

We shall proceed by induction on d. The case d = 1 comes from the previous two
lemmas. For integer d > 1, one uses Hochschild-Serre spectral sequence
E2i,j = H i (Γ/Γ1 , H j (Γ1 , An hu1 , . . . , ud i)) =⇒ H i+j (Γ, An hu1 , . . . , ud i).
Using the decomposition above, the group H j (Γ1 , An hu1 , . . . , ud i) is isomorphic to
i

h
i
 
h

H j Γ1 , OAcris (R, R+ )/pn [T1♭ ]±1 hu1 i ⊗ ⊗di=2 (OAcris (R, R+ )/pn ) [Ti♭ ]±1 hui i .

So by the calculation done for the case d = 1, we find that, up to (1 − [ǫ])-torsion,
H j (Γ1 , An hu1 , . . . , ud i) is zero when j > 0, and is equal to
i


h
(OAcris (R, R+)/pn )[T1±1 ] ⊗ ⊗di=2 (OAcris (R, R+ )/pn ) [Ti♭ ]±1 hui i

when j = 0. Thus, up to (1 − [ǫ])-torsion, E2i,j = 0 when j > 0 and E2i,0 is equal to


h
i

(OAcris (R, R+)/pn )[T1±1 ] ⊗ H i Γ/Γ1 , ⊗di=2 (OAcris (R, R+ )/pn ) [Ti♭ ]±1 hui i .

Using the induction hypothesis, we get that, up to (1−[ǫ])2(d−1)−1+1 -torsion, E2i,0 =
0 when i > 0 and
E20,0 = (OAcris (R, R+ )/pn )[T1±1 , . . . , Td±1 ] = C ⊗A OAcris (R, R+ )/pn .
As E2i,j = 0 for j > 1, we have short exact sequence
q,0
q−1,1
0 −→ E∞
−→ H q (Γ, An hu1 , . . . , ud i) −→ E∞
−→ 0.
q−1,1
is killed by (1 − [ǫ]) (as this is already
By what we have shown above, E∞
q−1,1
q,0
the case for E2
), and E∞
is killed by (1 − [ǫ])2d−2 for q > 0 (as this is the
case for E2q,0 ), thus H q (Γ, An hu1 , . . . , ud i) is killed by (1 − [ǫ])2d−1 . For q = 0,
0,0
H 0 (Γ, An hu1 , . . . , ud i) ≃ E∞
= E20,0 . So the cokernel of the natural injection

C ⊗A OAcris (R, R+ )/pn −→ H 0 (Γ, An hu1 , . . . , ud i)
is killed by (1 − [ǫ])2d−2 , hence by (1 − [ǫ])2d−1 .



Remark 6.8. With more efforts, one may prove that H q (Γ, An hu1 , . . . , ud i) is
killed by (1 − [ǫ])d for q > 0 ([AB, Proposition 21]), and that the cokernel of the
morphism (6.1.3) is killed by (1 − [ǫ])2 ([AB, Proposition 30]).
+
Corollary 6.9. For any n ≥ 0 and any q > 0, H q (Γ, OAcris (S∞ , S∞
)/pn ) is killed
2d
by (1 − [ǫ]) . Moreover, the natural morphism
+
b A OAcris (R, R+ )/pn −→ H 0 (Γ, OAcris (S∞ , S∞
C⊗
)/pn )

is injective, with cokernel killed by (1 − [ǫ])2d .

62

FUCHENG TAN, JILONG TONG
+
Recall that we want to compute H q (Γ, OBcris (Se∞ , Se∞
)). For this, one needs

Lemma 6.10. Keep the notations above and assume that the morphism f : X → Y
+
e Se+ ) = Spa(Se∞ , Se∞
is étale; thus V = Spa(R, R+ ) and X ×Y V = Spa(S,
). The
natural morphism
+
b A OAcris (R, R+ ) −→ OAcris (Se∞ , Se∞
B⊗
)
is an isomorphism.

Proof. By Lemma 2.17 we are reduced to showing that the natural map (here
wj = Sj − [Sj♭ ])
e Se+ ){hw1 , . . . , wδ i}
b A Acris (R, R+ ){hw1 , . . . , wδ i} −→ Acris (S,
B⊗

is an isomorphism. Since both sides of the previous maps are p-adically complete
and without p-torsion, we just need to check that its reduction modulo p
e Se+ )/p)hw1 , . . . , wδ i
B/p ⊗A/p (Acris (R, R+ )/p)hw1 , . . . , wδ i −→ (Acris (S,
is an isomorphism. Note that we have the following expression
(Acris (R, R+ )/p)hw1 , . . . , wδ i ≃

(R♭+ /((p♭ )p ))[δm , wi , Zim ]1≤i≤δ,m∈N
,
p
p
)1≤i≤δ,m∈N
(δm
, wim , Zim

e Se+ )/p)hw1 , . . . , wδ i, where δm is the image
and the similar expression for (Acris (S,
m+1
p
of γ
(ξ) with γ : x 7→ x /p. One sees that both sides of the morphism above are
p♭ -adically complete (in fact p♭ is nilpotent). Moreover R♭+ has no p♭ -torsion. So
we are reduced to showing that the morphism
(R♭+ /p♭ )[δm , wi , Zim ]1≤i≤δ,m∈N
(Se♭+ /p♭ )[δm , wi , Zim ]1≤i≤δ,m∈N
B/p ⊗A/p
−→
p
p
p
p
p
(δm , wi , Zim )1≤i≤δ,m∈N
(δm
, wip , Zim
)1≤i≤δ,m∈N

is an isomorphism. But R♭+ /p♭ ≃ R+ /p and Se♭+ /p♭ ≃ Se+ /p, so we just need to
show that the following morphism is an isomorphism:
(R+ /p)[δm , wi , Zim ]1≤i≤δ,m∈N
(Se+ /p)[δm , wi , Zim ]1≤i≤δ,m∈N
α : B/p ⊗A/p
−→
.
p
p
p
p
p
(δm , wi , Zim )1≤i≤δ,m∈N
(δm
, wip , Zim
)1≤i≤δ,m∈N
To see this, we consider the following diagram
0

e+ /p[δm ,wi ,Zim ]1≤i≤δ,m∈N
S
p
p
)1≤i≤δ,m∈N
,wip ,Zim
(δm

4
✐✐✐✐
α✐✐✐✐✐
✐✐✐✐
✐✐✐✐

B/p
O

/ B/p ⊗A/p

A/p

R+ /p[δm ,wi ,Zim ]1≤i≤δ,m∈N
p
p
)1≤i≤δ,m∈N
,wip ,Zim
(δm

O

étale

.

>

étale

/

étale
R+ /p[δm ,wi ,Zim ]1≤i≤δ,m∈N
p
p
)1≤i≤δ,m∈N
,wip ,Zim
(δm

It follows that α is étale. To see that α is an isomorphism, we just need to show
that this is the case after modulo some nilpotent ideals of both sides of α. Hence
we are reduced to showing that the natural morphism
B/p ⊗A/p R+ /p −→ Se+ /p

is an isomorphism, which is clear from the definition.



Crystalline comparison isomorphism in p-adic Hodge theory

63

Apply the previous lemma to the étale morphism f : X → T , we find a canonical
Γ-equivariant isomorphism
∼
b C OAcris (S∞ , S + ) −→
B⊗
OAcris (Se∞ , Se+ ).
∞

∞

In particular, we find

∼

+
+
b C OAcris (S∞ , S∞
)) −→ H q (Γ, OAcris (Se∞ , Se∞
)).
H q (Γ, B ⊗

Now consider the following spectral sequence

+
+
b C OAcris (S∞ , S∞
)/pn ) =⇒ H i+j (Γ, B ⊗
))
E2i,j = Ri lim H j (Γ, B ⊗C OAcris (S∞ , S∞
←
−
n

which induces a short exact sequence for each i:
(6.1.4)
+
b C OAcris (S∞ , S∞
0 −→ R1 limn H i−1 (Γ, B ⊗C OAcris (S∞ , S∞ )/pn ) −→ H i (Γ, B ⊗
))
←−
i
n
−→ limn H (Γ, B ⊗C OAcris (S∞ , S∞ )/p ) −→ 0.
←−
As B is flat over C, it can be written as a filtered limit of finite free C-modules,
and as Γ acts trivially on B, the following natural morphism is an isomorphism for
each i:
∼

B ⊗C H i (Γ, OAcris (S∞ , S∞ )/pn ) −→ H i (Γ, B ⊗C OAcris (S∞ , S∞ )/pn ).
+
Therefore, for i ≥ 1, H i (Γ, B⊗C OAcris (S∞ , S∞
)/pn ) is killed by (1−[ǫ])2d by Corollary 6.9. Moreover, by the same corollary, we know that the following morphism is
injective with cokernel killed by (1 − [ǫ])2d :
+
C ⊗A OAcris (R, R+ )/pn −→ H 0 (Γ, OAcris (S∞ , S∞
)/pn ).

Thus the same holds if we apply the functor B ⊗C − to the morphism above
+
B ⊗A OAcris (R, R+ )/pn −→ B ⊗C H 0 (Γ, OAcris (S∞ , S∞
)/pn ).

Passing to limits we obtain an injective morphism

+
b A OAcris (R, R+ ) −→ lim B ⊗C H 0 (Γ, OAcris (S∞ , S∞
B⊗
)/pn ) ,
←
−
n
whose cokernel is killed by (1 − [ǫ])2d , and that


+
R1 lim B ⊗C H 0 (Γ, OAcris (S∞ , S∞
)/pn )
←
−
n

is killed by (1 − [ǫ])2d. As a result, using the short exact sequence (6.1.4), we deduce
+
+
b C OAcris (S∞ , S∞
)) is killed by
)) ≃ H i (Γ, OAcris (Se∞ , Se∞
that for i ≥ 1, H i (Γ, B ⊗
4d
(1 − [ǫ]) , and that the canonical morphism
+
+
b A OAcris (R, R+ ) −→ H 0 (Γ, B ⊗
b C OAcris (S∞ , S∞
B⊗
)) ≃ H 0 (Γ, OAcris (Se∞ , Se∞
))

is injective with cokernel killed by (1 − [ǫ])2d . One can summarize the calculations
above as follows:
+
Proposition 6.11. (i) For any n ≥ 0 and q > 0, H q (Γ, OAcris (Se∞ , Se∞
)/pn ) is
2d
killed by (1 − [ǫ]) , and the natural morphism
B ⊗A OAcris (R, R+ )/pn −→ H 0 (Γ, OAcris (Se∞ , Se+ ))/pn
∞

is injective with cokernel killed by (1 − [ǫ])2d .
+
(ii) For any q > 0, H q (Γ, OAcris (S∞ , S∞
)) is killed by (1 − [ǫ])4d and the natural
morphism
+
b A OAcris (R, R+ ) → H 0 (Γ, OAcris (Se∞ , Se∞
B⊗
))

64

FUCHENG TAN, JILONG TONG

is injective, with cokernel killed by (1 − [ǫ])2d .
From this proposition, we deduce the following
+
Theorem 6.12. Keep the notations above. Then H q (Γ, OBcris (Se∞ , Se∞
)) = 0 for
q ≥ 1, and the natural morphism
+
b A OBcris (R, R+ ) −→ H 0 (Γ, OBcris (Se∞ , Se∞
))
B⊗

is an isomorphism.

Proof. By the previous proposition, we just need to remark that inverting t is
equivalent to inverting 1 − [ǫ], as
X
X
(1 − [ǫ])[n]
.
t = log([ǫ]) = −
(n − 1)! · (1 − [ǫ])[n] = −(1 − [ǫ])
(n − 1)! ·
1 − [ǫ]
n≥1

Here, by [AB, Lemme 18],
above converges in Acris .

n≥1

(1−[ǫ])[n]
1−[ǫ]

θ

c ), hence the last summation
∈ ker(Acris → O
k


6.2. Cohomology of Filr OBcris . We keep the notations at the beginning of the
+
+
appendix. In this §, for simplicity, we will denote OAcris (Se∞ , Se∞
) (resp. Filr OAcris (Se∞ , Se∞
))
r
by OAcris (resp. Fil OAcris ). This part is entirely taken from [AB, §5], which we
keep here for the sake of completeness.
Lemma 6.13. Let q ∈ N>0 , and n an integer ≥ 4d + r. The multiplication-by-tn
morphism of H q (Γ, Filr OAcris ) is trivial.
Proof. Let grr OAcris := Filr OAcris / Filr+1 OAcris . As θ(1 − [ǫ]) = 0, grr OAcris is
killed by 1 − [ǫ]. So using the tautological short exact sequence below
0 −→ Filr+1 OAcris −→ Filr OAcris −→ grr OAcris −→ 0
and by induction on the integer r ≥ 0, one shows that H q (Γ, Filr OAcris ) is killed by
(1 − [ǫ])4d+r ; the r = 0 case being Proposition 6.11(ii). So the multiplication-by-tn
with n ≥ 4d + r is zero for H q (Γ, OAcris ).

Recall that for q ∈ Z, we have defined
+
H q (Γ, Filr OBcris (Se∞ , Se∞
)) := lim H q (Γ, t−n Filr+n OAcris ),
−→
n∈N

or, in an equivalent way,

+
H q (Γ, Filr OBcris (Se∞ , Se∞
)) = lim H q (Γ, Filr+n OAcris ),
−→
n∈N

where for each n, the transition map

H q (Γ, Filr+n OAcris ) → H q (Γ, Filr+n+1 OAcris )
is induced from the map
Filr+n OAcris → Filr+n+1 OAcris ,

x 7→ t · x.

We have the following easy observation.
+
Lemma 6.14 ([AB] Lemme 33). For each q ∈ Z, H q (Γ, Filr OBcris (Se∞ , Se∞
)) is a
vector space over Qp .

The first main result of this section is the following.

Crystalline comparison isomorphism in p-adic Hodge theory

65

+
Proposition 6.15 ([AB] Proposition 34). H q (Γ, Filr OBcris (Se∞ , Se∞
)) = 0 for any
q > 0.

+
Proof. By Lemma 6.14, the cohomology group H q (Γ, Filr OBcris (Se∞ , Se∞
)) is a vector space over Qp . Hence to show the desired annihilation, we just need to show
that for any x ∈ H q (Γ, t−n Filr+n Acris ), there exists m ≫ n such that the image of
x in H q (Γ, t−m Filr+m OAcris ) is p-torsion. In view of Lemma 6.13, we are reduced
to showing that the kernel of the map

H q (Γ, Filr+1 OAcris ) → H q (Γ, Filr OAcris )
is of p-torsion, or equivalently, the cokernel of the map
H q−1 (Γ, Filr OAcris ) → H q−1 (Γ, grr OAcris )
is of p-torsion for any q ≥ 1. This assertion is verified in the following lemma.



Lemma 6.16 ([AB] Lemme 35, Lemme 36). For each q ∈ N, the cokernel of the
map
H q (Γ, Filr OAcris ) → H q (Γ, grr OAcris )

(6.2.1)
is of p-torsion.

e♭+
e+
Proof. Recall that ξ̃ := [ǫ][ǫ]−1
1/p −1 is a generator of ker(θ : W (S∞ ) → S∞ ). Moreover,
there exists a canonical isomorphism
OAcris ≃ Acris (Se∞ , Se+ ){hu1 , . . . , ud , w1 , . . . wδ i}.
∞

For n = (n0 , n1 , . . . , nd+δ ) ∈ N
n

u :=

[n ]
u1 1

1+d+δ

a multi-index, we set

[n ]
· · · ud d ,

[nd+1 ]

w n := w1

[nd+δ ]

· · · wδ

.

+
In particular grr OAcris is a free Se∞
-module with a basis given by
[n
]
n
n
0
ξ˜ · u · w , where n ∈ N1+d+δ such that |n| = r.

+
Recall that Se+ ⊂ Se∞
. Let

Dr :=

M

|n|=r

Se+ ξ˜[n0 ] · u[n] · w[n] ⊂ grr OAcris .

˜ i ].
For each 1 ≤ i ≤ d, γi (ui ) = Ti − [ǫ][Ti♭ ] = ui − ([ǫ] − 1)[Ti♭ ] = ui − ([ǫ]1/p − 1)ξ[T
r
(1)
˜
Viewed as element in gr OAcris , we have γi (ui ) = ui − (ǫ − 1)ξTi . In particular,
Dr ⊂ grr OAcris is stable under the action of Γ. Similarly, one checks that the
S + -submodule T α · Dr ⊂ grr OAcris is again stable under the action of Γ.
T
d
We first claim that, for any α ∈ (Z[1/p] [0, 1)) such that αi 6= 0 for some
q
α
h α
1 ≤ i ≤ d, the cohomology H (Γ, T Dr /p T Dr ) is killed by (ǫ(1) − 1)2 for any
q, h. Using Hochschild-Serre spectral sequence, we are reduced to showing that the
cohomology of the complex
γi −1

· · · −→ 0 −→ T α Dr /ph T α Dr −→ T α Dr /ph T α Dr −→ 0 −→ · · ·
is killed by ǫαi − 1 (as αi 6= 0, ααi − 1|ǫ(1) − 1), or in an equivalent way, the
cohomology of the complex
· · · −→ 0 −→ Dr /ph Dr

ǫαi γi −1

−→ Dr /ph Dr −→ 0 −→ · · ·

66

FUCHENG TAN, JILONG TONG

is killed by ǫαi − 1. By definition,
=
=

(ǫαi γi − 1)(ξ˜[n0 ] u[n] w[n] )
˜ i )[ni ] · Q u[nj ] · w[n] − ξ˜[n0 ] u[n] w [n]
ǫαi ξ˜[n0 ] (ui − (ǫ(1) − 1)ξT
j6=i

j

(ǫ − 1)ξ˜[n0 ] u[n] w [n] + (ǫ(1) − 1)η
(ǫαi − 1)(ξ˜[n0 ] u[n] w[n] + η ′ )
αi

=

where η and η ′ are linear combinations of elements of the form ξ˜[m0 ] u[m] w[m] with
|m| = r such that mi < ni . Note that we have the last equality because (ǫαi −
1)|(ǫ(1) − 1). So if we write down the matrix M of ǫα γi − 1 with respect to the
basis {ξ˜n0 u[n] w [n] : |n| = r} (the elements of this basis is ordered by the increasing
value of the number ni ), then M = (ǫαi − 1) · U with U a unipotent matrix.
In particular U is invertible and hence the kernel and the cokernel of the map
ǫαi γi − 1 : Dr /ph Dr → Dr /ph Dr are killed by ǫαi − 1, and hence by ǫ(1) − 1.
Now set
M
+
.
X :=
Se+ · T α ⊂ Se∞
α∈(Z[1/p]

T
[0,1))d \{(0,··· ,0)}

By what we have shown above, H q (Γ, X ⊗Se+ Dr /ph ) is killed by (ǫ(1) − 1)2 for all
q, h. Hence a standard use of spectral sequence involving the higher derived functor
b Se+ Dr ) is killed by (ǫ(1) − 1)4 for all q. On the other
of lim shows that H q (Γ, X ⊗
←−
b ⊗ e+ Dr and one checks
b Se+ Dr = X
hand, as Dr is an Se+ -module of finite rank, X ⊗
S
L
b ⊗ e+ Dr ). Therefore, the canonical map
easily that grr OAcris = Dr (X
S
H q (Γ, Dr ) −→ H q (Γ, grr OAcris )

is injective with cokernel killed by (ǫ(1) − 1)4 , hence by some power of p.

It remains to show that H q (Γ, Dr ) ⊂ H q (Γ, grr OAcris ) is contained in the image
of (6.2.1). To see this, we shall use a different basis for the free Se+ -module Dr .
For each 1 ≤ i ≤ d, set
 ♭
[m]
 ♭  X
∞
[Ti ]
[Ti ]
=
(−1)m−1 (m − 1)!
−1
.
vi = log
Ti
Ti
m=1

Then vi ≡ −Ti−1 ui mod Fil2 Acris , and γi (vi ) = vi + t. Moreover, as t ≡ (ǫ(1) −
1)ξ˜ Fil2 Acris , we see that
M
M
Se+ (ǫ(1) − 1)n0 ξ˜[n0 ] u[n] w [n] =
Se+ t[n0 ] v [n] w [n]
Mr :=
|n|=r

Let

Mr0

:=

L

|n|=r

Zp t

|n|=r

[n0 ] [n]

v

w

[n]

e+

. Then Mr ≃ S ⊗Zp Mr0 . In particular we find

H q (Γ, Mr ) ≃ Se+ ⊗Zp H q (Γ, Mr0 ).

fr (resp. M
fr0 ) be the B ⊗
b A OAcris (R, R+ )-submodule (resp.
On the other hand, let M
r
the Zp -submodule) of Fil OAcris generated by {t[n0 ] v [n] w [n] }|n|=r . Since γi (vi ) =
fr and M
fr0 are both stable under the action of Γ. Moreover, the natural
vi + t, M
r
fr ։ Mr . Now
morphism Fil OAcris → grr OAcris induces a surjective morphism M

Crystalline comparison isomorphism in p-adic Hodge theory

67

we have the following tautological commutative diagram
sur.

fr0 )
b A OAcris (R, R+ )) ⊗Zp H q (Γ, M
(B ⊗

≃


fr )
H q (Γ, M


H q (Γ, Filr OAcris )

/ Se+ ⊗Zp H q (Γ, Mr0 ) .

/ H q (Γ, Mr )
β

(6.2.1)


/ H q (Γ, grr OAcris )

But the morphism β can be decomposed as the composite of two morphisms
H q (Γ, Mr ) → H q (Γ, Dr ) ֒→ H q (Γ, grr OAcris )
which is killed by (ǫ(1) − 1)r+4 . This concludes the proof of our lemma.



r

It remains to compute the Γ-invariants of Fil OBcris (S∞ , S∞ ). For this, we shall
b A Filr OAcris (R, R+ ).
first prove H 0 (Γ, Filr OAcris ) = B ⊗
[ǫ]−1
Recall that ξ˜ := [ǫ]1/p −1 . Put

([ǫ] − 1)p−1
∈ Acris [p−1 ].
p
+
+
For each x ∈ ker(θ : OAcris (Se∞ , Se∞
) → Se∞
), set γ(x) := xp /p. One checks that
γ(x) ∈ OAcris and θ(γ(x)) = 0.
We have the following observation.
η :=

Lemma 6.17 ([AB] Lemme 37). There exists λ ∈ ξ̃W (Ob♭ ) such that η = (p −
k
1)!ξ˜[p] + λ. In particular, η ∈ ker(θ : Acris → Ob ). Furthermore, γ ν (η) ∈ p−r ηAcris
k
for any integers 0 ≤ ν ≤ r.
Lemma 6.18 ([AB] page 1011). There exists isomorphism
(Se♭+ /ξ˜p )[ηm , wj , Zj,m , ui , Ti,m ]1≤i,j≤d;m∈N
OAcris /p ≃ ∞
p
p
p
(ηm
, wjp , Zj,m
, upi , Ti,m
)

where ηm denotes the image of γ m (η) in OAcris /p. We have a similar assertion for
OAcris (R, R+ )/p.

♭+
+
Proof. Recall that ξ˜ is a generator of the kernel ker(θ : W (S∞
) → S∞
), hence we
have isomorphism
(S ♭+ /ξ˜p )[δm , wj , Zj,m , ui , Ti,m ]1≤i,j≤d;m∈N
OAcris /p ≃ ∞
p
p
p
(δm
, wjp , Zj,m
, upi , Ti,m
)

˜ As η = (p −
where δm represents the image in OAcris /p of the element γ m+1 (ξ).
♭+
p
˜ (O♭ ), it follows that ηm ∈ (S∞ /ξ̃p )[δν ]0≤ν≤m ⊂ OAcris /p,
1)!ξ˜[p] + λ for some λ ∈ ξW
b
k

(δν )0≤ν≤m

p
♭+ ˜p
and ηm
= 0, giving a morphism of S∞
/ξ -algebras
♭+ ˜p
(S ♭+ /ξ˜p )[δν ]0≤ν≤m
(S /ξ )[Wν ]0≤ν≤m
−→ ∞ p
,
αm : ∞ p
(Wν )0≤ν≤m
(δν )0≤ν≤m

Wν 7→ ην .

68

FUCHENG TAN, JILONG TONG

On the other hand, for any ν ∈ N,
ν

γ ((p − 1)!ξ˜[p] ) = γ ν (η − λ) =
ν

p
X

ν

ai η [p

−i] [i]

λ

i=0

♭+ ˜p
for some coefficients ai ∈ S∞
/ξ , and λ[i] ∈

♭+
(S∞
/ξ̃ p )[δj ]0≤j≤ν−1
(δjp )0≤j≤ν−1

(as i ≤ pν ). By

induction on ν, one checks that δν ∈ Im(αm ), hence αm is an isomorphism for the
♭+ ˜p
reason of length. Taking direct limits, one deduces that the morphism of S∞
/ξ algebras
(S ♭+ /ξ˜p )[Wm ]m∈N
(S ♭+ /ξ˜p )[δm ]m∈N
α: ∞
−→ ∞ p
, Wm 7→ ηm
p
(Wm )m∈N
(δm )m∈N
is an isomorphism, proving our lemma.

T
Lemma
6.19 ([AB] Lemme 38). For any r ∈ N, we have (pr OAcris ) ηOAcris =
Pr
r ν
ν=0 p γ (η)OAcris .

Proof. The proof is done by induction on r. The
T case r = 0 is trivial. So we may
and do assume that r > 0. Let x ∈ pr OAcris ηOAcris . By induction hypothesis,
one can write
r−1
X
x=
pr−1 γ ν (η)xν , with xν ∈ OAcris .
Set x′ :=
have

Pr−1

ν=0

ν
′
r
ν=0 γ (η)xν . Then x ∈ pOAcris since x ∈ p OAcris . So in OAcris /p, we
r−1
X

ην xν = 0,

ν=0

where for a ∈ OAcris we denote by a its reduction modulo p and ην the image of
γ ν (η) in OAcris /p. Let
(Se♭+ /ξ˜p )[ηh , wj , Zjm , ui , Tim ]1≤i≤d,1≤j≤δ,m∈N,h≥r
.
Λ := ∞ p p p
p
)1≤i≤d,1≤j≤δ,m∈N,h≥r
(ηh , wj , Zjm , upi , Tim

p
Then OAcris /p ≃ Λ[ηm ]0≤m≤r−1 /(ηm
)0≤m≤r−1 by the previous lemma. In parQr−1 αm
: α ∈
ticular, OAcris /p is a free Λ-module with a basis given by { m=0 ηm
{0, . . . , p − 1}r }. Thus up to modifying the xν ’s for 0 ≤ ν ≤ r − 2, we may
assume that xν ∈ Λ[η0 , . . . , ην ]/(η0p , . . . , ηνp ).
Next we claim that xν ∈ ηνp−1 (OAcris /p), which is also done by induction on ν.
When ν = 0, as x0 ∈ Λ[η0 ]/(η0p ), we just need to show η0 x0 = 0. But

η0 x0 = −

r−1
X

p
ηh xh ∈ Λ[η0 , η1 , . . . , ηr−1 ]/(η0p , η1p , . . . , ηr−1
),

h=1

we have necessarily η0 x0 = 0, giving our claim for ν = 0. Let now ν ∈ {1, . . . , r − 1}
such that for any 0 ≤ h ≤ ν, xh ∈ ηhp−1 (OAcris /p). So ηh xh = 0 for 0 ≤ h ≤ ν and
ην xν = −

r−1
X

ηl xl .

l=ν+1

So necessarily ην xν = 0, and hence xν ∈ ηνp−1 (OAcris /p). This shows our claim for
any 0 ≤ ν ≤ r − 1.

Crystalline comparison isomorphism in p-adic Hodge theory

69

As a result, for any 0 ≤ ν ≤ r − 1, we have xν ∈ γ ν (η)p−1 OAcris + pOAcris , and
hence
pr−1 γ ν (η)xν ∈ pr−1 γ ν (η)p OAcris + pr γ ν (η)OAcris .
P
But pr−1 γ ν (η)p = pr γ ν+1 (η), so we get finally x ∈ rν=0 pr γ ν (η)OAcris .


b A OAcris (R, R+ ) ⊂ OAcris (Proposition 6.11).
Recall that we have an injection B ⊗
The key lemma is the following
Lemma 6.20 ([AB] Lemme 39). Inside OAcris , we have
\
b A OAcris (R, R+ )) ηOAcris = η(B ⊗
b A OAcris (R, R+ )).
(B ⊗

Proof. The proof of the lemma is divided into several steps. First we remark that,
as B ⊗A OAcris (R, R+ )/p ֒→ OAcris /p, we have
\
b A OAcris (R, R+ )) pOAcris = p(B ⊗
b A OAcris (R, R+ )).
(B ⊗
Secondly, we claim that, to show our lemma, it is enough to prove that
\
b A OAcris (R, R+ )) ηOAcris ⊂ η(B ⊗
b A OAcris (R, R+ )) + pηOAcris .
(6.2.2) (B ⊗
Indeed, once this is done, we obtain
T
b A OAcris (R, R+)) ηOAcris
(B ⊗
T
b A OAcris (R, R+ ))
b A OAcris (R, R+ )) + pηOAcris (B ⊗
⊂
η(B ⊗

T
+
b A OAcris (R, R )) + p ηOAcris (B ⊗
b A OAcris (R, R+ ))
=
η(B ⊗
⊂

⊂

b A OAcris (R, R+ )) + p η(B ⊗
b A OAcris (R, R+ )) + pηOAcris
η(B ⊗
b A OAcris (R, R+ )) + p2 ηOAcris .
η(B ⊗



An iteration of this argument shows that
\
b A OAcris (R, R+)) ηOAcris ⊂ η(B ⊗
b A OAcris (R, R+ )) + pr ηOAcris
(B ⊗
T
b A OAcris (R, R+)) ηOAcris ⊂ η(B ⊗
b A OAcris (R, R+ )) as
for any r ∈ N. Thus (B ⊗
+
b
OAcris and B ⊗A OAcris (R, R ) are p-adically complete.

Next we claim that for any r ∈ N we have
\
b A OAcris (R, R+ )) ηOAcris ⊂ η(B ⊗
b A OAcris (R, R+ )) + pr OAcris .
(6.2.3) (B ⊗

When r = 0, this is trivial. Assume now the inclusion above holds for some r ∈ N.
So by Lemma 6.19
T
b A OAcris (R, R+ )) ηOAcris
(B ⊗
T
T
b A OAcris (R, R+ )) + (B ⊗
b A OAcris (R, R+ )) pr OAcris ηOAcris
⊂
η(B ⊗
T
P
b A OAcris (R, R+ )) + (B ⊗
b A OAcris (R, R+ )) pr ( rν=0 γ ν (η)OAcris )
⊂
η(B ⊗

T P
b A OAcris (R, R+ )) + pr (B ⊗
b A OAcris (R, R+ )) ( rν=0 γ ν (η)OAcris ) .
⊂ η(B ⊗
So we are reduced to showing that
b A OAcris R, R
B⊗

Put

r
 \ X
+

Λ(R, R+ ) :=

ν=0

γ ν (η)OAcris

!!

b A OAcris (R, R+ ))+pOAcris .
⊂ p−r η(B ⊗

(R♭+ /ξ˜p )[wj , Zjm ]1≤j≤δ,m∈N
⊂ OAcris (R, R+ )/p,
p
)1≤j≤δ,m∈N
(wjm , Zjm

70

FUCHENG TAN, JILONG TONG

and
+
Λ(Se∞ , Se∞
) :=

♭+ ˜p
(Se∞
/ξ )[wj , Zjm ]1≤j≤δ,m∈N
⊂ OAcris /p.
p
)1≤j≤δ,m∈N
(wjm , Zjm

We claim that the natural morphism A → OAcris (R, R+ )/p (resp. B → OAcris /p)
+
factors through Λ(R, R+ ) (resp. through Λ(Se∞ , Se∞
)[ui ]1≤i≤d /(upi )1≤i≤d ). Indeed,
we consider the reduction modulo p of the morphism θ
θ : OAcris (R, R+ )/p −→ R+ /p.

Then all elements of ker(θ) are nilpotent, and θ(Λ(R, R+ )) = R+ /p. Recall that A
is étale over Ok {S1±1 , . . . , Sδ±1 } and the composite
Ok {S1±1 , . . . , Sδ±1 } → A → OAcris (R, R+ )/p
sends Sj to the reduction modulo p of wj + Sj♭ ∈ OAcris (R, R+ )/p, which factors
through Λ(R, R+ ) and hence so does the morphism A → OAcris (R, R+ )/p by the
étaleness of the morphism Ok {S1±1 , . . . , Sδ±1 } → A. In a similar way, one sees that
+
the morphism B → OAcris /p factors through Λ(Se∞ , Se∞
)[ui ]1≤i≤d /(upi )1≤i≤d . In
particular, it makes sense to consider the map
e e+ i , ηm ]1≤i≤d,m∈N
Λ(R, R+ )[ηm ]m∈N
e := Λ(S∞ , Sp∞ )[u
B ⊗A
−→ Λ
,
p
p
(ηm )m∈N
(ui , ηm
)1≤i≤d,m∈N
T Pr
ν
b A OAcris (R, R+ ))
which is injective. Now for xP∈ (B ⊗
ν=0 γ (η)OAcris , its rer
duction x modulo p lies in
ν=0 ην OAcris /p. On the other hand, as a module
e
e ⊂ OAcris /p is a direct factor of OAcris /p
OAcris /p is free over Λ and the inclusion Λ
e
as Λ-modules, the fact that x appears in the image of the morphism above (note
p
that OAcris (R, R+ )/p = Λ(R, R+ )[ηm ]m∈N /(ηm
)m∈N ) implies that
r
X
e
x∈
ην Λ.
ν=0

Thus

x∈

r
X

ν=0

p
b A Λ(R, R+ ))[ηm ]m∈N /(ηm
ην (B ⊗
)m∈N

p
e are free over B ⊗A Λ(R, R+ ) and over
as (B ⊗A Λ(R, R+ ))[ηm ]m∈N /(ηm
)m∈N and Λ
Q
p
αm
+
:α∈
Λ(R, R )[ui ]1≤i≤d /(ui )1≤i≤d respectively , with a basis given by { m∈N ηm
(N)
{0, . . . , p − 1} }. In other words, this shows
r
X
b A OAcris (R, R+ )) + pOAcris .
x∈
γ ν (η)(B ⊗
ν=0

b A OAcris (R, R+ )), we obtained finally
By Lemma 6.17, γ (η) ∈ p−r η(B ⊗
b A OAcris (R, R+ )) + pOAcris ,
x ∈ p−r η(B ⊗
ν

as desired.
To complete the proof, it remains to show that the inclusions
(6.2.3) for all
Qν
r ∈ N implies (6.2.2). For ν ≥ −1 an integer, set βν := i=0 γ i (η)p−1 . A direct
calculation shows ηβν = pν+1 γ ν+1 (η) for any ν ≥ −1. Let
+
Λ(Se∞ , Se∞
)[ui , Tim ]1≤i≤d,m∈N
Λ :=
.
p
p
(ui , Tim
)1≤i≤d,m∈N

Crystalline comparison isomorphism in p-adic Hodge theory

71

p
Then OAcris /p = Λ[ηm ]m∈N /(ηm
)m∈N . Recall also that
p
OAcris (R, R+ ) = Λ(R, R+ )[ηm ]m∈N /(ηm
)m∈N .

For ν ≥ −1, let Mν (resp. Nν ) be the sub-Λ-module (resp. sub-B ⊗A Λ(R, R+ )module) of OAcris /p (resp. of B ⊗A OAcris (R, R+ )/p) generated by the family
)
( ∞
Y
(N)
αm
ηm : α ∈ {0, . . . , p − 1} , αm = p − 1 for 0 ≤ m ≤ ν, αν+1 < p − 1 .
m=0

Clearly Nν ⊂ Mν , OAcris /p = ⊕ν≥−1 Mν , and B ⊗A OAcris (R, R+ )/p = ⊕ν≥−1 Nν .
T
b A OAcris (R, R+ )) ηOAcris , and write z = ηz ′ with z ′ ∈ OAcris . Let
Let z ∈ (B ⊗
N be an integer such that
N
M
z′ ∈
Mν .
ν=−1

By (6.2.3) for r = N + 2, one can write

\
b A OAcris (R, R+ ) and w ∈ pN +2 OAcris ηOAcris .
with y ∈ B ⊗
PN +2
By Lemma 6.19, w = pN +2 i=0 γ i (η)αi with αi ∈ OAcris . So we find
z = η · y + w,

w=

N
+2
X

pN +2−i pi γ i (η)αi =

PN +2

Therefore z = y + i=0 p
definition of the integer N ,

pN +2−i ηβi−1 αi .

i=0

i=0

′

N
+2
X

N +2−i

βi−1 αi and thus z ′ = y + βN +1 αN +2 . But by the
z′ ∈

N
M

Mν

ν=−1

while
y∈

∞
M

ν=−1

Nν

and βN +1 αN +2 ∈

M

Mν .

ν>N
+

So necessarily βN +1 αN +2 ∈ ⊕ν>N Nν ∈ B ⊗A OAcris (R, R )/p. In other words, we
b A OAcris (R, R+ ) + pOAcris . So finally
find βN +1 αN +2 ∈ B ⊗
b A OAcris (R, R+ )) + pηOAcris ,
z ∈ η(y + βN +1 αN +2 ) ∈ η(B ⊗
as required by (6.2.2). This finishes the proof of this lemma.



Corollary 6.21 ([AB] Corollaire 40). Inside OAcris , we have
\
b A OAcris (R, R+ )) ([ǫ] − 1)p−1 OAcris = ([ǫ] − 1)p−1 (B ⊗
b A OAcris (R, R+ )).
(B ⊗
T
b A OAcris (R, R+ )) ([ǫ] − 1)p−1 OAcris . As pη = ([ǫ] − 1)p−1 , x ∈
Proof. Let x ∈ (B ⊗
T
+
b A Filr OAcris (R, R+ )) pOAcris = p(B ⊗
b
(B ⊗
Lemma
T A OAcris (R, R )). Thus, by
+
b
b
6.20, we find x/p ∈ (B ⊗A OAcris (R, R )) ηOAcris = η(B ⊗A OAcris (R, R+ )). Thereb A OAcris (R, R+ )) = ([ǫ] − 1)p−1 (B ⊗
b A OAcris (R, R+ )).
fore x ∈ pη(B ⊗


Finally, we can assemble the previous results to get the main result about the
Γ-invariants.

72

FUCHENG TAN, JILONG TONG

Proposition 6.22 ([AB] Proposition 41). For each r ∈ N, the natural injection
b A Filr OAcris (R, R+ ) −→ H 0 (Γ, Filr OAcris )
ιr : B ⊗

is an isomorphism.

Proof. We shall begin with the case where r = 0. By Proposition 6.11 (ii), the
b A OAcris (R, R+ ) → H 0 (Γ, OAcris ) is injective with cokernel
natural morphism B ⊗
2d
killed by (1 − [ǫ]) . It remains to show that the latter map is also surjective. Let
b A OAcris (R, R+ ). In particular,
x ∈ H 0 (Γ, OAcris ). So (1 − [ǫ])2d x ∈ B ⊗
\
b A OAcris (R, R+ )
(1 − [ǫ])2d(p−1) x ∈ B ⊗
(1 − [ǫ])2d(p−1) OAcris .

b A OAcris (R, R+ )).
By Corollary 6.21, the last intersection is just (1 − [ǫ])2d(p−1) (B ⊗
+
b A OAcris (R, R ); note that 1 − [ǫ] is a regular element. This
In particular, x ∈ B ⊗
concludes the proof of our proposition for r = 0. Assume now r > 0 and that
the statement holds for Filr−1 OAcris . Then we have the following commutative
diagram with exact rows
0

/ B⊗
b A Filr OAcris (R, R+ )
ιr

0


/ H 0 (Γ, Filr OAcris )

/ B⊗
b A Filr−1 OAcris (R, R+ )
ιr−1



/ H 0 (Γ, Filr−1 OAcris )

/ B⊗
b A grr−1 OA cris (R, R+ )
_

/ H 0 (Γ, grr−1 OAcris )

b A R+ = Se+ ⊂
One checks easily that the last vertical morphism is injective as B ⊗
+
Se∞
. So by snake lemma, that ιr−1 is an isomorphism implies that the morphism
ιr is also an isomorphism. This finishes the induction and hence the proof of our
proposition.

Corollary 6.23 ([AB] Corollaire 42). The natural morphism
b A Filr OBcris (R, R+ ) −→ H 0 (Γ, Filr OBcris )
B⊗

is an isomorphism, where
b A Filr+n OAcris (R, R+ )
b A Filr OBcris (R, R+ ) := lim B ⊗
B⊗
−→
n≥0

with transition maps given by multiplication by t.
References

[AB] F. Andreatta, O. Brinon: Acyclicité géométrique de Bcris , Comment. Math. Helv. 88 (2013),
965-1022.
[AI] F. Andreatta, A. Iovita: Comparison Isomorphisms for Smooth Formal Schemes, Journal de
l’Institut de Mathématiques de Jussieu (2013) 12(1), 77-151.
[Ber86] P. Berthelot, Géométrie rigide et cohomologie des variétés algébriques de caractéristique
p, Bull. Soc. Math. France, Mémoire 23 (1986), 7-32.
[Ber96] P. Berthelot, Cohomologie rigide et cohomologie rigide à supports propres, Premiére partie, Preprint IRMAR 96-03 (1996), 91 pp.
[BO] P. Berthelot, A. Ogus, Notes on crystalline cohomology, Princeton University Press, 1978.
[Bri] O. Brinon, Représentations p-adiques cristallines et de de Rham dans le cas relatif,
Mémoires de la SMF 112 (2008).
[Fal] G. Faltings, Crystalline cohomology and p-adic Galois representations, Algebraic analysis,
geometry, and number theory, Johns Hopkins Univ. Press (1989), 25-80.
[Fon82] J.-M.Fontaine, Sur certains types de représentations p-adiques du group de Galois d’un
corps local; construction d’un anneau de Barsotti-Tate, Ann. of Math. (2) 115 (1982), 529577.

/0

Crystalline comparison isomorphism in p-adic Hodge theory

73

[Fon94] J.-M. Fontaine, Le corps des périodes p-adiques, Périodes p-adiques (Bures-sur-Yvette,
1988), Astérisque 223 (1994), 59-111.
[GR] O. Gabber, L. Ramero, Almost ring theory, LNM 1800, Springer-Verlag, Berlin, 2003.
[Hub] R. Huber, Étale cohomology of rigid analytic varieties and adic spaces, Aspects of Mathematics, E 30. Friedr. Vieweg & Sohn, Braunschweig, 1996.
[Hub94] R. Huber, A generalization of formal schemes and rigid analytic varieties, Math. Z. 217
(1994), 513-551.
[Jan] U. Jannsen, Continuous étale cohomology, Math. Ann. 280(1988), 207-245.
[Sch13] P. Scholze, p-adic Hodge theory for rigid-analytic varieties, Forum of Mathematics, Pi, 1
(2013), 1-77.
[SGA4] M. Artin, A. Grothendieck, J.-L. Verdier, Théorie des topos et cohomologie étale des
schémas, LNM 269, 270, 305, Springer Verlang, 1972, 1973.
[Tat] J. Tate, p-divisible groups, Proc. Conf. Local Fields (Driebergen, 1966), 158-183, Springer,
Berlin, 1967.
[Tsu] N. Tsuzuki, On base change theorem and coherence in rigid cohomology, Kazuya Kato’s
fiftieth birthday, Doc. Math. 2003, Extra Vol., 891?918

Fucheng Tan
800 Dongchuan Rd
Department of Mathematics, Shanghai Jiao Tong University
Shanghai 200240, China
and
220 Handan Rd
Shanghai Center for Mathematical Sciences
Shanghai 200433, China
Email: fuchengtan@sjtu.edu.cn

Jilong Tong
Institut de Mathématiques de Bordeaux
Université de Bordeaux
351, cours de la Libération
F-33405 Talence cedex, France
Email: jilong.tong@math.u-bordeaux1.fr

