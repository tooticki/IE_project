arXiv:1510.05543v1 [math.AG] 19 Oct 2015

CRYSTALLINE COMPARISON ISOMORPHISMS IN p-ADIC
HODGE THEORY: THE ABSOLUTELY UNRAMIFIED CASE
FUCHENG TAN, JILONG TONG

Abstract. We construct the crystalline comparison isomorphisms for proper
smooth formal schemes over an absolutely unramified base. Such isomorphisms
hold for eÌtale cohomology with nontrivial coefficients, as well as in the relative
setting, i.e. for proper smooth morphisms of smooth formal schemes. The
proof is formulated in terms of the pro-eÌtale topos introduced by Scholze,
and uses his primitive comparison theorem for the structure sheaf on the proeÌtale site. Moreover, we need to prove the PoincareÌ lemma for crystalline
period sheaves, for which we adapt the idea of Andreatta and Iovita. Another
ingredient for the proof is the geometric acyclicity of crystalline period sheaves,
whose computation is due to Andreatta and Brinon.

Contents
Notation
1. Introduction
2. Crystalline period sheaves
2.1. Period sheaves and their acyclicities
2.2. Period sheaves with connections
2.3. Frobenius on crystalline period sheaves
2.4. Comparison with de Rham period sheaves
3. Crystalline cohomology and pro-eÌtale cohomology
3.1. A reminder on convergent F -isocrystals
b p -sheaves and filtered F -isocystals
3.2. Lisse Z
3.3. From pro-eÌtale site to eÌtale site
4. Primitive comparison on the pro-eÌtale site
5. Comparison isomorphism in the relative setting
6. Appendix: geometric acyclicity of OBcris
6.1. Cohomology of OBcris
6.2. Cohomology of Filr OBcris
References

1
2
4
4
9
16
18
21
21
26
36
39
44
53
54
64
72

Notation
â€¢ Let p be a prime number.
â€¢ Let k be a p-adic field, i.e., a discretely valued complete nonarchimedean
extension of Qp , whose residue field Îº is a perfect field of characteristic p.
(We often assume k to be absolutely unramified in this paper.)
1

2

FUCHENG TAN, JILONG TONG

b the p-adic completion
â€¢ Let k be a fixed algebraic closure of k. Set Cp := k
of k. The p-adic valuation v on Cp is normalized so that v(p) = 1. Write
the absolute Galois group Gal(k/k) as Gk .
â€¢ For a topological ring A which is complete with respect to p-adic topology,
let AhT1 , . . . , Td i be the PD-envelope of the polynomial ring A[T1 , . . . , Td ]
with respect to the ideal (T1 , . . . , Td ) âŠ‚ A[T1 , . . . , Td ] (with the requirement
that the PD-structure be compatible with the one on the ideal (p)) and then
let A{hT1 , . . . , Td i} be its p-adic completion.
â€¢ We use the symbol â‰ƒ to denote canonical isomorphisms and sometimes
use â‰ˆ for almost isomorphisms (often with respect to the maximal ideal of
OCp ).
1. Introduction
Let k be a p-adic field, that is a discretely valued complete nonarchimedean
extension of Qp with a perfect residue field of characteristic p, which is absolutely
unramified. Consider a rigid analytic variety over k, or more generally an adic space
X over Spa(k, Ok ) which admits a proper smooth formal model X over Spf Ok ,
whose special fiber is denoted by X0 . Let L be a lisse Zp -sheaf on XeÌt . On one hand,
we have the p-adic eÌtale cohomology H i (Xk , L) which is a finitely generated Zp module carrying a continuous Gk = Gal(k/k)-action. On the other hand, one may
i
consider the crystalline cohomology Hcris
(X0 /Ok , E) with the coefficient E being a
filtered (convergent) F -isocrystal on X0 /Ok . At least in the case that X comes from
a scheme and the coefficients L and E are trivial, it was Grothendieckâ€™s problem
of mysterious functor to find a comparison between the two cohomology theories.
This problem was later formulated as the crystalline conjecture by Fontaine [Fon82].
In the past decades, the crystalline conjecture was proved in various generalities,
by Fontaine-Messing, Kato, Tsuji, Niziol, Faltings, Andreatta-Iovita, Beilinson and
Bhatt. Among them, the first proof for the whole conjecture was given by Faltings [Fal]. Along this line, Andreatta-Iovita introduced the PoincareÌ lemma for the
crystalline period sheaf Bcris on the Faltings site, a sheaf-theoretic generalization
of Fontaineâ€™s period ring Bcris . Both the approach of Fontaine-Messing and that of
Faltings-Andreatta-Iovita use an intermediate topology, namely the syntomic topology and the Faltings topology, respectively. The approach of Faltings-AndreattaIovita, however, has the advantage that it works for nontrivial coefficients L and
E.
More recently, Scholze [Sch13] introduced the pro-eÌtale site XproeÌt , which allows
him to construct the de Rham comparison isomorphism for any proper smooth
adic space over a discretely valued complete nonarchimedean field over Qp , with
coefficients being lisse Zp -sheaves on XproeÌt . (The notion of lisse Zp -sheaf on XeÌt
and that on XproeÌt are equivalent.) Moreover, his approach is direct and flexible
enough to attack the relative version of the de Rham comparison isomorphism, i.e.
the comparison for a proper smooth morphism between two smooth adic spaces.
It seems that to deal with nontrivial coefficients in a comparison isomorphism,
one is forced to work over analytic bases. For the generality and some technical
advantages provided by the pro-eÌtale topology, we adapt Scholzeâ€™s approach to give
a proof of the crystalline conjecture for proper smooth formal schemes over Spf Ok ,
with nontrivial coefficients, in both absolute and relative settings. We note that it
is not hard to prove in our setup the crystalline conjecture for formal schemes over

Crystalline comparison isomorphism in p-adic Hodge theory

3

arbitrary complete discretely valued rings. Furthermore, in a sequel paper we shall
construct crystalline comparison isomorphisms for arbitrary varieties over p-adic
fields.
Let us explain our construction of crystalline comparison isomorphism (in the
absolutely unramified case) in more details. First of all, Scholze is able to prove
k
the finiteness of the eÌtale cohomology of a proper smooth adic space X over K = b
with coefficient Lâ€² being an Fp -local system. Consequently, he shows the following â€œprimitive comparisonâ€, an almost (with respect to the maximal ideal of OK )
isomorphism
â‰ˆ

+
H i (Xk,eÌt , Lâ€² ) âŠ—Fp OK /p âˆ’â†’ H i (Xk,eÌt , Lâ€² âŠ—Fp OX
/p).

With some more efforts, one can produce the primitive comparison isomorphism in
the crystalline case:
Theorem 1.1 (See Theorem 4.3). For L a lisse Zp -sheaf on XeÌt , we have a canonical isomorphism of Bcris -modules
(1.0.1)

âˆ¼

â†’ H i (Xk,proeÌt , L âŠ— Bcris ).
H i (Xk,eÌt , L) âŠ—Zp Bcris âˆ’

compatible with Gk -action, filtration, and Frobenius.
It seems to us that such a result alone may have interesting arithmetic applications, since it works for any lisse Zp -sheaves, without the crystalline condition
needed for comparison theorems.
Following Faltings, we say a lisse Zp -sheaf L on the pro-eÌtale site XproeÌt is crystalline if there exists a filtered F -isocrystal E on X0 /Ok together with an isomorphism of OBcris -modules
(1.0.2)

ur OBcris â‰ƒ L âŠ—Z OBcris
E âŠ—OX
p

ur
which is compatible with connection, filtration and Frobenius. Here, OX
is the
ur
pullback to XproeÌt of OXeÌt and OBcris is the crystalline period sheaf of OX -module
with connection âˆ‡ such that OBâˆ‡=0
cris = Bcris . When this holds, we say the lisse
Zp -sheaf L and the filtered F -isocrystal E are associated.
We illustrate the construction of the crystalline comparison isomorphism briefly.
Firstly, we prove a PoincareÌ lemma for the crystalline period sheaf Bcris on XproeÌt .
It follows from the PoincareÌ lemma (Proposition 2.16) that the natural morphism
from Bcris to the de Rham complex DR(OBcris ) of OBcris is a quasi-isomorphism,
which is compatible with filtration and Frobenius. When L and E are associated,
the natural morphism

L âŠ—Zp DR(OBcris ) â†’ DR(E) âŠ— OBcris
is an isomorphism compatible with Frobenius and filtration. Therefore we find a
quasi-isomorphism
L âŠ—Zp Bcris â‰ƒ DR(E) âŠ— OBcris .
From this we deduce
(1.0.3)

âˆ¼

â†’ RÎ“(Xk,proeÌt , DR(E) âŠ— OBcris ).
RÎ“(Xk,proeÌt , L âŠ—Zp Bcris ) âˆ’

âˆ¼
âˆ¼
â†’ XeÌt
, one has
Via the natural morphism of topoi w : Xk,proeÌt

(1.0.4)

b Ok Bcris ))
RÎ“(Xk,proeÌt , DR(E) âŠ— OBcris ) â‰ƒ RÎ“(XeÌt , DR(E)âŠ—

4

FUCHENG TAN, JILONG TONG

for which we have used the fact that the natural morphism
b Ok Bcris â†’ Rw âˆ— OBcris
OX âŠ—

is an isomorphism (compatible with extra structures), which is a result of AndreattaBrinon.
Combining the isomorphisms above, we obtain the desired crystalline comparison
isomorphism.
Theorem 1.2 (See Theorem 4.5). Let L be a lisse Zp -sheaf on X and E be a filtered
F -isocrystal on X0 /Ok which are associated as in (1.0.2). Then there is a natural
isomorphism of Bcris -modules
âˆ¼

i
H i (Xk,eÌt , L) âŠ— Bcris âˆ’
â†’ Hcris
(X0 /Ok , E) âŠ—k Bcris

which is compatible with Gk -action, filtration and Frobenius.
After obtaining a refined version of the acyclicity of crystalline period sheaf
OBcris in Â§6, we achieve the crystalline comparison in the relative setting, which
reduces to Theorem 1.2 when Y = Spf Ok :
Theorem 1.3 (See Theorem 5.6). Let f : X â†’ Y be a proper smooth morphism of
smooth formal schemes over Spf Ok , with fk : X â†’ Y the generic fiber and fcris the
morphism between the crystalline topoi. Let L, E be as in Theorem 1.2. Suppose
that Ri fkâˆ— L is a lisse Zp -sheaf on Y . Then it is crystalline and is associated to the
filtered F -isocrystal Ri fcrisâˆ— E.
Acknowledgments. The authors are deeply indebted to Andreatta, Iovita and
Scholze for the works [AI] and [Sch13]. They wish to thank Kiran Kedlaya and
Barry Mazur for their interests in this project.
2. Crystalline period sheaves
Let k be a p-adic field with residue field Îº. Let X be a locally noetherian adic
space over Spa(k, Ok ). For the fundamentals on the pro-eÌtale site XproeÌt , we refer
to [Sch13].
The following terminology and notation will be used frequently throughout the
paper. We shall fix once for all an algebraic closure k of k, and consider Xk :=
X Ã—Spa(k,Ok ) Spa(k, Ok ) as an object of XproeÌt . As in [Sch13, Definition 4.3], an
object U âˆˆ XproeÌt lying above Xk is called an affinoid perfectoid (lying above Xk )
if U has a pro-eÌtale presentation U = lim Ui â†’ X by affinoids Ui = Spa(Ri , Ri+ )
â†âˆ’
above Xk such that, with R+ the p-adic completion of lim Ri+ and R = R+ [1/p],
âˆ’â†’
b O )-algebra. Write U
b = Spa(R, R+ ).
the pair (R, R+ ) is a perfectoid affinoid (k,
b
k

By [Sch13, Proposition 4.8, Lemma 4.6], the set of affinoid perfectoids lying above
Xk of XproeÌt forms a basis for the topology.
2.1. Period sheaves and their acyclicities. Following [Sch13], let
âˆ¼
âˆ¼
Î½ : XproeÌt
âˆ’â†’ XeÌt

be the morphism of topoi, which, on the underlying sites, sends an eÌtale morphism
U â†’ X to the pro-eÌtale morphism from U (viewed as a constant projective system)
+
+
to X. Consider OX
= Î½ âˆ’1 OX
and OX = Î½ âˆ’1 OXeÌt , the (uncompleted) structural
eÌt
sheaves on XproeÌt . More concretely, for U = lim Ui a qcqs (quasi-compact and
â†âˆ’

Crystalline comparison isomorphism in p-adic Hodge theory

5

quasi-separated) object of XproeÌt , one has OX (U ) = lim OX (Ui ) = lim OXeÌt (Ui )
âˆ’â†’
âˆ’â†’
([Sch13, Lemma 3.16]). Set
d
+
O
O+ /pn ,
X := lim
â†âˆ’ X
n

â™­+
+
+
OX
= lim OX
/pOX
.
â†âˆ’p
x7â†’x

b =
For U = lim Ui âˆˆ XproeÌt an affinoid perfectoid lying above Xk with U
â†âˆ’
+
Spa(R, R ), by [Sch13, Lemmas 4.10, 5.10], we have
(2.1.1)

Denote

d
+
+
O
X (U ) = R ,

Râ™­+ â†’ R+ ,

â™­+
and OX
(U ) = Râ™­+ := lim R+ /pR+ .
â†âˆ’
x7â†’xp
n

x = (x0 , x1 , Â· Â· Â· ) 7â†’ xâ™¯ := lim x
bpn ,
nâ†’âˆ

for x
bn any lifting from R+ /p to R+ . We have the multiplicative homeomorphism
(induced by projection):
âˆ¼

lim R+ âˆ’
â†’ Râ™­+ ,
â†
âˆ’
p
x7â†’x

(xâ™¯ , (x1/p )â™¯ , Â· Â· Â· ) â†[ x

which can be extended to a ring homomorphism.
â™­+
Put Ainf := W (OX
) and Binf = Ainf [ p1 ]. As Râ™­+ is a perfect ring, Ainf (U ) =
W (Râ™­+ ) has no p-torsions. In particular, Ainf has no p-torsions and it is a subsheaf
of Binf . Following Fontaine, define as in [Sch13, Definition 6.1] a natural morphism
d
+
Î¸ : Ainf â†’ O
X

(2.1.2)

b = Spa(R, R+ ), is given by
which, on an affinoid perfectoid U with U
d
+
+
(2.1.3) Î¸(U ) : Ainf (U ) = W (Râ™­+ ) âˆ’â†’ O
X (U ) = R ,
â™­+

+

(x0 , x1 , Â· Â· Â· ) 7â†’

âˆ
X

pn xâ™¯n,n

n=0
+

with xn = (xn,i )iâˆˆN âˆˆ R = limx7â†’xp R /p. As (R, R ) is a perfectoid affinoid
â†âˆ’
algebra, Î¸(U ) is known to be surjective (cf. [Bri, 5.1.2]). Therefore, Î¸ is also
surjective.
Definition 2.1. Let X be a locally noetherian adic space over Spa(k, Ok ) as above.
Consider the following sheaves on XproeÌt .
(1) Define Acris to be the p-adic completion of the PD-envelope A0cris of Ainf
with respect to the ideal sheaf ker(Î¸) âŠ‚ Ainf , and define B+
cris := Acris [1/p].
(2) For r âˆˆ Zâ‰¥0 , set Filr A0cris := ker(Î¸)[r] A0cris âŠ‚ A0cris to be the r-th divided
power ideal, and Filâˆ’r A0cris = A0cris . So the family {Filr A0cris : r âˆˆ Z} gives
a descending filtration of A0cris .
(3) For r âˆˆ Z, define Filr Acris âŠ‚ Acris to be the image of the following morphism of sheaves (we shall see below that this map is actually injective):
(2.1.4)

lim(Filr A0cris )/pn âˆ’â†’ lim A0cris /pn = Acris ,
â†
âˆ’
â†
âˆ’
n
n
r
and define Filr B+
cris = Fil Acris [1/p].

Let pâ™­ = (pi )iâ‰¥0 be a family of elements of k such that p0 = p and that ppi+1 = pi
for any i â‰¥ 0. Set
Î¾ = [pâ™­ ] âˆ’ p âˆˆ Ainf |Xk .

6

FUCHENG TAN, JILONG TONG

Lemma 2.2. We have ker(Î¸)|Xk = (Î¾) âŠ‚ Ainf |Xk . Furthermore, Î¾ âˆˆ Ainf |Xk is not
a zero-divisor.
Proof. As the set of affinoids perfectoids U lying above Xk forms a basis for the
topology of XproeÌt /Xk , we only need to check that, for any such U , Î¾ âˆˆ Ainf (U ) is
d
+
not a zero-divisor and that the kernel of Î¸(U ) : A (U ) â†’ O
(U ) is generated by
inf

X

d
+
+
b = Spa(R, R+ ). Then Ainf (U ) = W (Râ™­+ ) and O
Î¾. Write U
X (U ) = R , hence we
reduce our statement to (the proof of) [Sch13, Lemma 6.3].

Corollary 2.3. (1) We have A0cris |Xk = Ainf |Xk [Î¾ n /n! : n âˆˆ N] âŠ‚ Binf |Xk . Moreâˆ¼ d
+
| .
over, for r â‰¥ 0, Filr A0 | = A | [Î¾ n /n! : n â‰¥ r] and grr A0 | âˆ’â†’ O
cris Xk

inf Xk

cris Xk

X Xk

âˆ¼

(2) The morphism (2.1.4) is injective, hence limn Filr A0cris /pn âˆ’â†’ Filr Acris .
â†âˆ’
âˆ¼ d
+
Moreover, for r â‰¥ 0, grr Acris |Xk âˆ’â†’ O
|
.
X
X k

Proof. The first two statements in (1) are clear. In particular, for r â‰¥ 0 we have
the following exact sequence
(2.1.5)

0

/ Filr+1 A0 |X
cris k

/ Filr A0 |X
cris k

d
+
/O
X |Xk

/0,

where the second map sends aÎ¾ r /r! to Î¸(a). This gives the last assertion of (1).
d
+
As O
X has no p-torsions, an induction on r shows that the cokernel of the
inclusion Filr A0cris âŠ‚ A0cris has no p-torsions. As a result, the morphism (2.1.4)
d
+
is injective and Filr A
is the p-adic completion of Filr A0 . Since O
is pcris

cris

X

adically complete, we deduce from (2.1.5) also the following short exact sequence
after passing to p-adic completions:
(2.1.6)

0

/ Filr+1 Acris |X
k

/ Filr Acris |X
k

giving the last part of (2).

d
+
/O
X |Xk

(i)

(0)

/0

(1)

Let Ç« = (Ç« )iâ‰¥0 be a sequence of elements of k such that Ç« = 1, Ç« 6= 1 and
(Ç«(i+1) )p = Ç«(i) for all i â‰¥ 0. Then 1 âˆ’ [Ç«] is a well-defined element of the restriction
Ainf |Xk to XproeÌt /Xk of Ainf . Moreover 1 âˆ’ [Ç«] âˆˆ ker(Î¸)|Xk = Fil1 Acris |Xk . Let
(2.1.7)

t := log([Ç«]) = âˆ’

âˆ
X
(1 âˆ’ [Ç«])n
,
n
n=1

which is well-defined in Acris |Xk since Fil1 Acris is a PD-ideal.
Definition 2.4. Let X be a locally noetherian
space over Spa(k, Ok ). Define
P adicâˆ’s
r
Bcris = B+
[1/t].
For
r
âˆˆ
Z,
set
Fil
B
=
t
Filr+s B+
cris
cris
cris âŠ‚ Bcris . (As the
sâˆˆZ
canonical element t âˆˆ Acris exists locally, these definitions do make sense.)
Before investigating these period sheaves in details, we first study them over a
b O )-algebra (R, R+ ). Consider
perfectoid affinoid (k,
b
k

Ainf (R, R+ ) := W (Râ™­+ ),

Binf (R, R+ ) := Ainf (R, R+ )[1/p],

and define the morphism
(2.1.8)

Î¸(R,R+ ) : Ainf (R, R+ ) âˆ’â†’ R+

Crystalline comparison isomorphism in p-adic Hodge theory

7

in the same way as in (2.1.3). It is known to be surjective as (R, R+ ) is perfectoid.
b O ) generates ker(Î¸
Furthermore, we have seen that the element Î¾ âˆˆ Ainf (k,
b
(R,R+ ) )
k
+
and is not a zero-divisor in Ainf (R, R ). Let Acris (R, R+ ) be the p-adic completion of the PD-envelope of Ainf (R, R+ ) with respect to the ideal ker(Î¸(R,R+ ) ). So
Acris (R, R+ ) is the p-adic completion of A0cris (R, R+ ) with

 n
Î¾
: n âˆˆ N âŠ‚ Binf (R, R+ ).
A0cris (R, R+ ) := Ainf (R, R+ )
n!

For r an integer, let Filr A0cris (R, R+ ) âŠ‚ A0cris (R, R+ ) be the r-th PD-ideal, i.e., the
ideal generated by Î¾ n /n! for n â‰¥ max{r, 0}. Let Filr Acris (R, R+ ) âŠ‚ Acris (R, R+ )
be the closure (for the p-adic topology) of Filr A0cris (R, R+ ) inside Acris (R, R+ ).
+
+
+
+
+
Finally, put B+
cris (R, R ) := Acris (R, R )[1/p], Bcris (R, R ) := Bcris (R, R )[1/t],
and for r âˆˆ Z, set
r
+
+
Filr B+
cris (R, R ) := Fil Acris (R, R )[1/p] and
X
+
Filr Bcris (R, R+ ) :=
tâˆ’s Filr+s B+
cris (R, R ).
sâˆˆZ

+

In particular, taking R = OCp with Cp the p-adic completion of the fixed
+
algebraic closure k of k, we get Fontaineâ€™s rings Acris , Bcris
, Bcris as in [Fon94].
Lemma 2.5. Let X be a locally noetherian adic space over (k, Ok ). Let U âˆˆ XproeÌt
b = Spa(R, R+ ). Let F âˆˆ {A0 , Acris }.
be an affinoid perfectoid above Xk with U
cris
â‰ˆ
Then for any r â‰¥ Z, we have a natural almost isomorphism Filr F (R, R+ )a â†’
r
r
Fil F (U )a , and have H i (U, Fil F )a = 0 for any i > 0.
d
+
â™­+
+
â™­+
Proof. As U is affinoid perfectoid, we have O
and
X (U ) = R , OX (U ) = R
+
Î¸(U ) = Î¸(R,R+ ) . In particular, Ainf (U ) = Ainf (R, R ), and the natural morphism
Î± : Ainf (R, R+ ) = Ainf (U ) âˆ’â†’ A0cris (U ) sends ker(Î¸(R,R+ ) ) into Fil1 A0cris (U ). As a
consequence, we get a natural morphism A0cris (R, R+ ) â†’ A0cris (U ), inducing morphisms Filr A0cris (R, R+ ) â†’ Filr A0cris (U ) between the filtrations. Passing to p-adic
completions, we obtain the natural maps Filr Acris (R, R+ ) â†’ Filr Acris (U ) for all
r âˆˆ Z.
We need to show that the morphisms constructed above are almost isomorphisms. Recall that, as U is affinoid perfectoid, H i (U, Ainf )a = 0 for i > 0 ([Sch13,
Ainf [Xi :iâˆˆN]
pi+1 !
0
Theorem 6.5]). Consider Ag
cris := (Xip âˆ’ai Xi+1 :iâˆˆN) with ai = (pi !)p , then one has the
following short exact sequence
0

Â·(X0 âˆ’Î¾)
0
0
/ Ag
/ Ag
cris
cris

/ A0
cris

/0.

g
0
Since
is a direct sum of Ainf â€™s as an abelian sheaf and U is qcqs, we get
 Acris 
a
g
i
0
H U, Acris = 0 for i > 0. Hence H i (U, A0cris )a = 0 for i > 0 and the short exact
sequence above stays almost exact after taking sections over U :
(2.1.9)

0

Â·(X0 âˆ’Î¾)
0 (U )a
0 (U )a
/ Ag
/ Ag
cris
cris

/ A0 (U )a
cris

/0.

8

FUCHENG TAN, JILONG TONG

+
0 (R, R+ ) := Ainf (R,R )[Xi :iâˆˆN] with a =
On the other hand, set Ag
i
cris
(Xip âˆ’ai Xi+1 :iâˆˆN)
then the following similar sequence is exact:

(2.1.10) 0

Â·(X0 âˆ’Î¾)
0 (R, R+ )a
0 (R, R+ )a
/ Ag
/ Ag
cris
cris

pi+1 !
(pi !)p

/ A0 (R, R+ )a
cris

as above,

/0.

g
0 (R, R+ ). Combining (2.1.9) and (2.1.10), we find
0 (U ) = A
Since U is qcqs, Ag
cris
cris
0
+ a âˆ¼
0
a
Acris (R, R ) âˆ’
â†’ Acris (U ) . This proves the statement for A0cris .
Next, as A0cris âŠ‚ Binf (Corollary 2.3), the sheaf A0cris has no p-torsions. So we get
the following tautological exact sequence
pn

0 âˆ’â†’ A0cris âˆ’â†’ A0cris âˆ’â†’ A0cris /pn âˆ’â†’ 0.
0
By what we have
sequence above that
 shown0 for Acrisn,aweâˆ¼ get0 fromn the exact
0
+
n a âˆ¼
â†’ Acris /p (U )a , and H i (U, A0cris /pn )a = 0
â†’ Acris (U )/p
Acris (R, R )/p
for i > 0. Therefore the transition maps of the projective
system {(A0cris /pn )(U )}nâ‰¥0
a
1
0
n
are almost surjective, thus R lim (Acris /p )(U ) = 0. So the projective system
â†âˆ’
{A0cris /pn } verifies the assumptions of (the almost version of)[Sch13, Lemma 3.18].
As a result, we find

Rj lim A0cris /pn = 0, for any j > 0,
â†âˆ’

a
âˆ¼
+ a
0
Acris (R, R ) = lim(Acris (R, R+ )/pn )a âˆ’â†’ lim A0cris /pn (U ) = Acris (U )a ,
â†âˆ’
â†âˆ’
and
H i (U, Acris )a = H i (U, lim A0cris /pn )a = 0
â†âˆ’

(2.1.11)

n

for i > 0.
To prove the statements for Filr A0cris for r â‰¥ 0, we shall use the exact sed
+ a
quence (2.1.5). As H i (U, O
X ) = 0 for i > 0 ([Sch13, Lemma 4.10]), we find
r 0
i
a
H (U, Fil Acris ) = 0 for all i â‰¥ 2, and also the induced long exact sequence
d
+
a
0 âˆ’â†’ Filr+1 A0cris (U )a âˆ’â†’ Filr A0cris (U )a âˆ’â†’ O
X (U ) âˆ’â†’
r+1 0
r 0
1
a
1
a
H (U, Fil
Acris ) âˆ’â†’ H (U, Fil Acris ) âˆ’â†’ 0.

On the other hand, we have the analogous exact sequence for Filr A0cris (R, R+ ):
0 âˆ’â†’ Filr+1 A0cris (R, R+ ) âˆ’â†’ Filr A0cris (R, R+ ) âˆ’â†’ R+ âˆ’â†’ 0,
where the second morphism sends aÎ¾ r /r! to Î¸(R,R+ ) (a). Together with the two
exact sequences above and the vanishing H 1 (U, A0cris )a = 0, an induction on r â‰¥ 0
âˆ¼
shows Filr A0cris (R, R+ )a â†’ Filr A0cris (U )a and H 1 (U, Filr A0cris )a = 0. This gives the
r 0
statement for Fil Acris for r âˆˆ Z (note that Filr A0cris = A0cris when r â‰¤ 0). The
statement for Filr Acris can be done in the same way; one starts with (2.1.6) and
uses the vanishing of H 1 (U, Acris )a .

Corollary 2.6. Keep the notation of Lemma 2.5.
(1) The morphism multiplication by t on Acris is almost injective. In particular,
t âˆˆ B+
cris |Xk is not a zero-divisor.
(2) Let F âˆˆ {B+
cris , Bcris }. Then for any r âˆˆ Z, there is a natural isomorphism
âˆ¼
Filr F (R, R+ ) â†’ Filr F (U ), and H i (U, Filr F ) = 0 for i â‰¥ 1.

Crystalline comparison isomorphism in p-adic Hodge theory

9

Proof. (1) By Lemma 2.5, we are reduced to showing that t âˆˆ Acris (R, R+ ) is not
a zero-divisor. So we just need to apply [Bri, Corollaire 6.2.2], whose proof works
for any such perfectoid (R, R+ ).
(2) As U is qcqs, we deduce from Lemma 2.5 the statement for B+
cris and for
Filr B+
on
inverting
p.
Similarly,
inverting
t
we
get
the
statement
for
B
. Finally,
cris
cris
r+s +
r+s +
âˆ’s
|
and
as
t
Fil
B
|
â‰ƒ
Fil
Bcris |Xk ,
as Filr Bcris |Xk = lims tâˆ’s Filr+s B+
cris Xk
cris Xk
âˆ’â†’
r
passing to limits we get the statement for Fil Bcris .

2.2. Period sheaves with connections. In this section, assume that the p-adic
field k is absolutely unramified. Let X be a smooth formal scheme over Ok . Set
X := Xk the generic fiber of X , viewed as an adic space over Spa(k, Ok ). For any
eÌtale morphism Y â†’ X , by taking the generic fibers, we obtain an eÌtale morphism
Yk â†’ X of adic spaces, hence an object of the pro-eÌtale site XproeÌt . In this way,
we get a morphism of sites XeÌt â†’ XproeÌt , with the induced morphism of topoi
âˆ¼
âˆ¼
w : XproeÌt
âˆ’â†’ XeÌt
.

Let OXeÌt denote the structure sheaf of the eÌtale site XeÌt : for any eÌtale morphism
ur+
Y â†’ X of formal schemes over Ok , OXeÌt (Y) = Î“(Y, OY ). Define OX
:= wâˆ’1 OXeÌt
ur+
]
and Our := wâˆ’1 O [1/p]. Thus Our+ is the associated sheaf of the presheaf O
:
X

XeÌt

X

X

ur+
]
XproeÌt âˆ‹ U 7â†’ lim OXeÌt (Y) =: O
X (U ),
âˆ’â†’
(Y,a)

where the limit runs through all pairs (Y, a) with Y âˆˆ XeÌt and a : U â†’ Yk a
morphism making the following diagram commutative
/ X = Xk
(2.2.1)
U â—
O
â—â—
â—â—
â—â—
a â—â—
#
Yk .
The morphism a : U â†’ Yk induces a map Î“(Y, OY ) â†’ OX (U ). There is then a
ur+
]
morphism of presheaves O
â†’ O+ , whence a morphism of sheaves
X

(2.2.2)

X

ur+
+
OX
â†’ OX
.

â™­+
ur+
Recall Ainf := W (OX
). Set OAinf := OX
âŠ—Ok Ainf and

(2.2.3)

d
+
Î¸X : OAinf âˆ’â†’ O
X

d
+
to be the map induced from Î¸ : Ainf â†’ O
X of (2.1.2) by extension of scalars.

Definition 2.7. Consider the following sheaves on XproeÌt .
(1) Let OAcris be the p-adic completion of the PD-envelope OA0cris of OAinf
with respect to the ideal sheaf ker(Î¸X ) âŠ‚ OAinf , OB+
cris := OAcris [1/p], and
OBcris := OB+
[1/t]
with
t
=
log([Ç«])
defined
in
(2.1.7).
cris
(2) For r âˆˆ Zâ‰¥0 , define Filr OA0cris âŠ‚ OA0cris to be the r-th PD-ideal ker(Î¸X )[r] ,
and Filr OAcris the image of the canonical map
lim Filr OA0cris /pn âˆ’â†’ lim OA0cris /pn = OAcris .
â†âˆ’
â†âˆ’
âˆ’r
Also set Fil OAcris = OAcris for r > 0.

10

FUCHENG TAN, JILONG TONG

(3) For r âˆˆ Z, set
r
Filr OB+
cris := Fil OAcris [1/p] and

Filr OBcris :=

X

tâˆ’s Filr+s OB+
cris .

sâˆˆZ

k, Ob ), one can also define Filr OBcris
Remark 2.8. As tp = p!Â·t[p] in Acris := Acris (b
k
P
as sâˆˆN tâˆ’s Filr+s OAcris . A similar observation holds equally for Filr Bcris .

Remark 2.9.
(1) As X is flat over Ok , the structure sheaf OXeÌt has no ptorsions. It follows that OAinf , OA0cris and OAcris have no p-torsions. So
OAcris âŠ‚ OB+
cris .
(2) The morphism Î¸X of (2.2.3) extends to a surjective morphism from OA0cris
d
+
d
+
to O
with kernel Fil1 OA0 , hence also a morphism from OA
to O
.
cris

cris

X

X

Let us denote these two morphisms again by Î¸X . As coker(Fil1 OA0cris Ö’â†’
d
+
OA0cris ) â‰ƒ O
X is p-adically complete and has no p-torsions, using the snake
lemma and passing to limits one can deduce the following short exact sequence
Î¸X d
+
OX
âˆ’â†’ 0.
0 âˆ’â†’ lim(Fil1 OA0cris /pn ) âˆ’â†’ OAcris âˆ’â†’
â†âˆ’
n

In particular, Fil1 OAcris = ker(Î¸X ).

In order to describe explicitly the sheaf OAcris , we shall need some auxiliary
sheaves on XproeÌt .
Definition 2.10. Consider the following sheaves on XproeÌt .
(1) Let Acris {hu1 , . . . , ud i} be the p-adic completion of the sheaf of PD polynomial rings A0cris hu1 , . . . , ud i âŠ‚ Binf [u1 , . . . , ud ]. Set B+
cris {hu1 , . . . , ud i} :=
Acris {hu1 , . . . , ud i}[1/p] and Bcris {hu1 , . . . , ud i} := Acris {hu1 , . . . , ud i}[1/t].
(2) For r âˆˆ Z, let Filr A0cris hu1 , . . . , ud i âŠ‚ A0cris hu1 , . . . , ud i be the ideal sheaf
given by
X
[i ]
[i ]
Filr (A0cris hu1 , . . . , ud i) :=
Filrâˆ’(i1 +...+id ) A0cris Â· u1 1 Â· Â· Â· ud d ,
i1 ,...,id â‰¥0

and Filr (Acris {hu1 , . . . , ud i}) âŠ‚ Acris {hu1 , . . . , ud i} the image of the morphism

lim Filr A0cris {hu1 , . . . , ud i}/pn âˆ’â†’ Acris {hu1 , . . . , ud i}.
â†
âˆ’
n
The family {Filr (Acris {hu1 , . . . , ud i}) : r âˆˆ Z} gives a descending filtration
of Acris {hu1 , . . . , ud i}. Inverting p, we obtain Filr (B+
cris {hu1 , . . . , ud i}). Set
finally
X
Filr (Bcris {hu1 , . . . , ud i}) :=
tâˆ’s Filr+s (B+
cris {hu1 , . . . , ud i}).
sâˆˆZ

The proof of the following lemma is similar to that of Lemma 2.5. We omit the
details here.

Lemma 2.11. Let V âˆˆ XproeÌt be an affinoid perfectoid lying above Xk with Vb =
Spa(R, R+ ). Then the following natural map is an almost isomorhpism
â‰ˆ

Acris (R, R+ ){hu1 , . . . , ud i} âˆ’â†’ (Acris {hu1 , . . . , ud i})(V ).

Crystalline comparison isomorphism in p-adic Hodge theory

11

Under this identification, Filr (Acris {hu1 , . . . , ud i})(V )a consists of series
X
[i ]
[i ]
ai1 ,...,id u1 1 Â· Â· Â· ud d âˆˆ Acris (R, R+ ){hu1 , . . . , ud i}
i1 ,...,id â‰¥0

such that ai1 ,...,id âˆˆ Filrâˆ’(i1 +...+id ) Acris (R, R+ ) and ai1 ,...,id tends to 0 for the p-adic
topology when the sum i1 + . . . + id tends to infinity. Furthermore
H i (V, Filr (Acris {hu1 , . . . , ud i}))a = 0,

for i > 0.

We want to describe OAcris more explicitly . For this, assume there is an eÌtale
morphism X â†’ Spf(Ok {T1Â±1, . . . , TdÂ±1 }) =: T d of formal schemes over Ok . Let Td
fd be obtained from Td by adding a compatible
denote the generic fiber of T d and T
n
system of p -th root of Ti for 1 â‰¤ i â‰¤ d and n â‰¥ 1:
fd := Spa(k{T Â±1/pâˆ , . . . , T Â±1/pâˆ }, Ok {T Â±1/pâˆ , . . . , T Â±1/pâˆ }).
T
1

1

d

d

fd . Let T â™­ âˆˆ Oâ™­+ | e be the element (Ti , T 1/p , . . . , T 1/pn , . . .). Then
e := X Ã—Td T
Set X
i
i
i
X X
Î¸X (Ti âŠ— 1 âˆ’ 1 âŠ— [Tiâ™­ ]) = 0, which allows us to define an Acris -linear morphism

(2.2.4)

ui 7â†’ Ti âŠ— 1 âˆ’ 1 âŠ— [Tiâ™­ ].

Î± : Acris {hu1 , . . . , ud i}|Xe âˆ’â†’ OAcris |Xe ,

Proposition 2.12. The morphism Î± of (2.2.4) is an almost isomorphism. Furthermore, it respects the filtrations on both sides.
Lemma 2.13. Let k be an algebraic closure of k. Then Acris {hu1 , . . . , ud i}|Xe has a
k

ur+
natural OX
|Xe -algebra structure, sending Ti to ui +[Tiâ™­ ], such that the composition
k

ur+
OX
|Xe
k

is
is

Î¸ â€² |X
f

d
+
âˆ’â†’ Acris {hu1 , . . . , ud i}|Xe âˆ’â†’k O
e
X |X
k

d
+
+
â€²
the map (2.2.2) composed with OX
â†’O
X . Here Î¸ :
Î¸ d
+
induced from the map Acris â†’ O
X by sending Ui â€™s to

k

d
+
Acris {hu1 , . . . , ud i} â†’ O
X

0.

ur+
ur+
]
Proof. As OX
is the associated sheaf of O
X , and as the affinoids perfectoids
e form a basis for the topology of XproeÌt /X
e , we only need to define
lying above X
k
k
e , a morphism of
naturally, for any affinoid perfectoid U âˆˆ XproeÌt lying above X
k
rings:
ur+
]
O
(U ) âˆ’â†’ (Aa {hu , . . . , u i})(U ),
cris

X

1

d

sending Ti to ui + [Tiâ™­ ].
b = Spa(R, R+ ). Let pâ™­ âˆˆ Oâ™­ âŠ‚ Râ™­+ be the element given by a compatible
Write U
b
k

system of pn -th roots of p. Then we have (see [Bri, Proposition 6.1.2])
Acris (R, R+ )
(Râ™­+ /(pâ™­ )p )[Î´0 , Î´1 , . . .]
â‰ƒ
,
(p)
(Î´0p , Î´1p , . . .)

where Î´i is the image of Î³ i+1 (Î¾) with Î³ : x 7â†’ xp /p. So
Acris (R, R+ ){hu1 , . . . , ud i}
(p)

â‰ƒ

(Acris (R, R+ )/p)[ui , ui,j : 1 â‰¤ i â‰¤ d, j = 0, 1, . . .]
(upi , upi,j )

â‰ƒ

Râ™­+ [u1 ,...,ud ]
p [Î´j , ui,j : 1 â‰¤ i
((pâ™­ )p ,up
1 ,...,ud )
(Î´jp , upi,j )

â‰¤ d, j = 0, 1, . . .]
.

12

FUCHENG TAN, JILONG TONG

Set I := (pâ™­ , u1 , . . . , ud ) âŠ‚ Râ™­+ [u1 , . . . , ud ]/((pâ™­ )p , up1 , . . . , upd ): this is an nilpotent
ideal with cokernel Râ™­+ /(pâ™­ ) â‰ƒ R+ /p. Furthermore, there is a canonical morphism
of schemes



 â™­+
Acris (R, R+ ){hu1 , . . . , ud i}
R [u1 , . . . , ud ]
Spec
âˆ’â†’ Spec
(p)
((pâ™­ )p , up1 , . . . , upd )
â™­+

+

R [u1 ,...,ud ]
Acris (R,R ){hu1 ,...,ud i}
induced from the natural inclusion ((p
.
â™­ )p ,up ,...,up ) âŠ‚
(p)
1
d
Let Y be a formal scheme eÌtale over X together with a factorization a : U â†’ Yk
as in (2.2.1). We shall construct a natural morphism of Ok -algebras

(2.2.5)

OY (Y) âˆ’â†’ (Acris {hu1 , . . . , ud i}) (U )
[Tiâ™­ ].

sending Ti to ui +
Assume firstly that the image a(U ) is contained in the
generic fiber Spa(A[1/p], A) of some affine open subset Spf(A) âŠ‚ Y. In particular,
there exists a morphism of Ok -algebras A â†’ R+ , whence a morphism of Îº-schemes
Spec(R+ /p) âˆ’â†’ Spec(A/p) âˆ’â†’ Y âŠ—Ok Îº =: Y1 .

(2.2.6)

Composing Y â†’ X with the eÌtale morphism X â†’ T d , we obtain an eÌtale morphism
Y â†’ T d , hence an eÌtale morphism Yn : = Y âŠ— Ok /pn â†’ T d âŠ— Ok /pn =: T d,n for
each n. As Tiâ™­ + ui âˆˆ Râ™­+ [u1 , . . . , ud ]/((pâ™­ )p , up1 , . . . , upd ) is invertible, one deduces
a map
Spec(Râ™­+ [u1 , . . . , ud ]/((pâ™­ )p , up1 , . . . , upd )) âˆ’â†’ T d,1 ,

Ti 7â†’ Tiâ™­ + ui .

But we have the following commutative diagram
(2.2.6)

â™­
Spec(Râ™­+
 _ /(p ))

Spec(R+ /p)

âˆƒ

nil-immersion

Spec



7/ Y1
eÌtale morphism

g



Râ™­+ [u1 ,...,ud ]
p
((pâ™­ )p ,up
1 ,...,ud )





/ T d,1 ,

from which we deduce a morphism, denoted by g1 :

 â™­+


R [u1 , . . . , ud ]
Acris (R, R+ ){hu1 , . . . , ud i}
g
âˆ’â†’ Spec
g1 : Spec
âˆ’â†’ Y1 .
p
p
â™­
p
(p)
((p ) , u1 , . . . , ud )
Then we have the following commutative diagram
 g

+

1
){hu1 ,...,ud i}
/ Y1 
Spec Acris (R,R (p)
_
nil-immersion

Spec





Acris (R,R+ ){hu1 ,...,ud i}
(pn )



4/ Yn

âˆƒ
gn

eÌtale morphism



/ T d,n .

with the bottom map Ti 7â†’ Tiâ™­ + ui . These gn â€™s are compatible with each other, so
that they give rise to a morphism Spf(Acris (R, R+ ){hu1 , . . . , ud i}) â†’ Y of formal
schemes over Ok , inducing a morphism of Ok -algebras
OY (Y) â†’ Acris (R, R+ ){hu1 , . . . , ud i}
sending Ti to ui + [Tiâ™­ ]. Combining it with the natural morphism
Acris (R, R+ ){hu1 , . . . , ud i} â†’ Acris {hu1 , . . . , ud i}(U )

Crystalline comparison isomorphism in p-adic Hodge theory

13

we obtain the desired map (2.2.5). For the general case, i.e., without assuming
that a(U ) is contained in the generic fiber of some affine open of Y, cover U by
affinoids perfectoids Vj such that each a(Vj ) is contained in the generic fiber of
some affine open subset of Y. The construction above gives, for each j, a morphism
of Ok -algebras
OY (Y) âˆ’â†’ (Acris {hu1 , . . . , ud i}) (Vj ),

Ti 7â†’ ui + [Tiâ™­ ].

As the construction is functorial on the affinoid perfectoid Vj , we deduce the morphism (2.2.5) in the general case using the sheaf property of Acris {hu1 , . . . , ud i}.
ur+
]
Finally, since O
O (Y) with the limit runs through the diagrams
X (U ) = lim
âˆ’â†’ Y
(2.2.1), we get a morphism of Ok -algebras
ur+
]
O
X (U ) âˆ’â†’ Acris (U ){hu1 , . . . , ud i},

Ti 7â†’ ui + [Tiâ™­ ]

e .
which is functorial with respect to affinoid perfectoid U âˆˆ XproeÌt lying above X
k
Passing to the associated sheaf, we obtain finally a natural morphism of sheaves
ur
of Ok -algebras OX
|Xe â†’ Acris |Xe {hu1 , . . . , ud i} sending Ti to ui + [Tiâ™­ ]. The last
k

k

statement follows from the assignment Î¸â€² (Ui ) = 0 and the fact that Î¸([Tiâ™­ ]) = Ti . 

e is a covering in the pro-eÌtale site XproeÌt ,
e â†’X
Proof of Proposition 2.12. As X
k
we only need to show that Î±|Xe is an almost isomorphism. By the lemma above,
k

ur+
there exists a morphism of sheaves of Ok -algebras OX
|Xe â†’ Acris {hu1 , . . . , ud i}|Xe
k

sending Ti to ui + [Tiâ™­ ]. By extension of scalars, we find the following morphism

ur+
âŠ—Ok Ainf |Xe âˆ’â†’ Acris {hu1 , . . . , ud i}|Xe
Î² : OAinf |Xe = OX
k

which maps Ti âŠ— 1 to

ui + [Tiâ™­ ].

k

k

k

â€²

Consider the composite (with Î¸ as in Lemma 2.13)

d
+
Î¸â€² |Xe â—¦ Î² : OAinf |Xe âˆ’â†’ Acris {hu1 , . . . , ud i}|Xe âˆ’â†’O
e ,
X |X
k
k
k
k


which is simply Î¸X |Xe by Lemma 2.13. Therefore, Î² ker(Î¸X |Xe ) âŠ‚ ker(Î¸â€² |Xe ).
k

k

k

Since ker(Î¸â€² ) has a PD-structure, the map Î² extends to the PD-envelope OA0cris |Xe
k
of the source. Furthermore, Acris {hu1 , . . . , ud i}a is by definition p-adically complete:
âˆ¼
Acris {hu1 , . . . , ud i}a â†’ limn (Acris {hu1 , . . . , ud i}a /pn ). The map Î² in turn extends
â†âˆ’
to the p-adic completion of OA0,a
e . So we obtain the following morphism, still
cris |X
k
denoted by Î²:
Î² : OAacris |Xe âˆ’â†’ Acris {hu1 , . . . , ud i}a |Xe ,
k

k

Ti âŠ— 1 7â†’ ui + [Tiâ™­ ].

Then one shows that Î² and Î± are inverse to each other, giving the first part of our
proposition.
It remains to check that Î± respects the filtrations. As Î¸X |Xe â—¦ Î± = Î¸â€² |Xe and
â‰ˆ
as Î± is an almost isomorphism, Î± induces an almost isomorphism Î± : ker(Î¸â€² |Xe ) â†’
ker(Î¸X |Xe ). Therefore, since ker(Î¸â€² ) = Fil1 (Acris {hu1 , . . . , ud i}) and Fil1 OAcris =
ker(Î¸X ) (Remark 2.9), Î± gives an almost isomorphism
âˆ¼

Î± : Fil1 (Acris {hu1 , . . . , ud i})a |Xe âˆ’â†’ Fil1 OAacris |Xe .

As Fil1 OAcris |Xe âŠ‚ OAcris |Xe is a PD-ideal, we can consider its i-th PD ideal subsheaf I [i] âŠ‚ OAcris |Xe . Using the almost isomorphism above and the explicit description in Lemma 2.11, one checks that the p-adic completion of I [i] is (almost)

14

FUCHENG TAN, JILONG TONG

equal to Î±(Fili (Acris {hu1 , . . . , ud i})|Xe ). As the image of the morphism
Fili OA0cris |Xe âˆ’â†’ OAcris |Xe

is naturally contained in I [i] , on passing to p-adic completion, we obtain
Fili OAacris |Xe âŠ‚ Î±(Fili Acris {hu1 , . . . , ud i}a |Xe ).
On the other hand, we have the following commutative diagram
Î±

Fili (Acris {hu1 , . . . , ud i})|Xe
O

/ OAcris | e
O X

âˆ¼
=

lim
â†âˆ’

Fili (A0cris hu1 ,...,ud i)|X
f
pn

Î±

/ lim Fil
â†âˆ’

i

OA0cris |X
f
pn

= Fili OAacris |Xe .

Therefore Î±(Fili Acris {hu1 , . . . , ud i}|Xe ) âŠ‚ Fili OAcris |Xe , whence the equality
Î±(Fili (Acris {hu1 , . . . , ud i})a |Xe ) = Fili OAacris |Xe .


Corollary 2.14. Keep the notation above. There are natural filtered isomorphisms
âˆ¼

+
B+
e {hu1 , . . . , ud i} âˆ’â†’ OBcris |X
e,
cris |X

and

âˆ¼

Bcris |Xe {hu1 , . . . , ud i} âˆ’â†’ OBcris |Xe

both sending ui to Ti âŠ— 1 âˆ’ 1 âŠ— [Tiâ™­ ].
Corollary 2.15. Let X be a smooth formal scheme over Ok . Then the morphism
of multiplication by t on OAcris |Xk is almost injective. In particular t âˆˆ OB+
cris |Xk
is not a zero-divisor and OB+
âŠ‚
OB
.
cris
cris
Proof. This is a local question on X. Hence we may and do assume there is an
eÌtale morphism X â†’ Spf(Ok {T1Â±1 , . . . , TdÂ±1 }). Thus our corollary results from
Proposition 2.12 and Corollary 2.6 (1).

An important feature of OAcris is that it has an Acris -linear connection on it. To
1,ur+
ur+
.
:= wâˆ’1 â„¦1XeÌt /Ok , which is locally free of finite rank over OX
see this, set â„¦X/k
Let
1,ur+
1,ur+
i
and â„¦i,ur
â„¦i,ur+
X/k := â„¦X/k [1/p] âˆ€i â‰¥ 0.
X/k := âˆ§O ur+ â„¦X/k ,
X

Then OAinf admits a unique Ainf -linear connection
âˆ‡ : OAinf âˆ’â†’ OAinf âŠ—Our+ â„¦1,ur+
X/k
X

induced from the usual one on OXeÌt . This connection extends uniquely to OA0cris
and to its completion
âˆ‡ : OAcris âˆ’â†’ OAcris âŠ—Our+ â„¦1,ur+
X/k
X

This extension is Acris -linear. Inverting p (resp. t), we get also a B+
cris -linear (resp.
+
Bcris -linear) connection on OBcris (resp. on OBcris ):
1,ur
+
ur
âˆ‡ : OB+
cris âˆ’â†’ OBcris âŠ—OX â„¦X/k ,

From Proposition 2.12, we obtain

1,ur
ur â„¦
and âˆ‡ : OBcris âˆ’â†’ OBcris âŠ—OX
X/k .

Crystalline comparison isomorphism in p-adic Hodge theory

15

Corollary 2.16 (Crystalline PoincareÌ lemma). Let X be a smooth formal scheme
of dimension d over Ok . Then there is an exact sequence of pro-eÌtale sheaves:
âˆ‡

âˆ‡

âˆ‡

1,ur
d,ur
+
+
+
ur
ur
0 â†’ B+
cris â†’ OBcris â†’ OBcris âŠ—OX â„¦X/k â†’ . . . â†’ OBcris âŠ—OX â„¦X/k â†’ 0,

which is strictly exact with respect to the filtration giving â„¦i,ur
X/k degree i. In particular, the connection âˆ‡ is integrable and satisfies Griffiths transversality with respect
1,ur
i
iâˆ’1
+
ur
to the filtration on OB+
OB+
cris , i.e. âˆ‡(Fil OBcris ) âŠ‚ Fil
cris âŠ—OX â„¦X/k .
Proof. We just need to establish the almost version of our corollary for OAcris . This
is a local question on X, hence we may and do assume there is an eÌtale morphism
from X to Spf(Ok {T1Â±1 , . . . , TdÂ±1 }). Then under the almost isomorphism (2.2.4) of
Proposition 2.12, Fili OAacris |Xe is the p-adic completion of
X
[i ]
[i ]
Filiâˆ’(i0 +...+id ) Aacris |Xe u1 1 Â· Â· Â· ud d
i1 ,...id â‰¥0

âŠ— [Tiâ™­ ]

[n]

[nâˆ’1]

âŠ— dTi for any i, n â‰¥ 1,
with Ti âŠ— 1 âˆ’ 1
sent to ui . Moreover âˆ‡(ui ) = ui
since the connection âˆ‡ on OAcris is Acris -linear. The strict exactness and Griffiths
transversality then follow.

Using Proposition 2.12, we can also establish an analogous acyclicity result for
OAcris as in Lemma 2.5. Let U = Spf(R+ ) be an affine subset of X admitting
an eÌtale morphism to T d = Spf(Ok {T1Â±1 , . . . , TdÂ±1 }). Let U be the generic fiber,
e := U Ã—Td T
e d . Let V be an affinoid perfectoid of XproeÌt lying above
and set U
e . Write Vb = Spa(S, S + ). Let OAcris (S, S + ) be the p-adic completion of the
U
k
PD-envelope OA0cris (S, S + ) of R+ âŠ—Ok W (S â™­+ ) with respect to the kernel of the
following morphism induced from Î¸(S,S +) by extending scalars to R+ :
Î¸R+ : R+ âŠ—Ok W (S â™­+ ) âˆ’â†’ S + .
+
+
+
+
+
Set OB+
cris (S, S ) := OAcris (S, S )[1/p], OBcris (S, S ) := OBcris (S, S )[1/t]. For
r
+
+
r âˆˆ Z, define Fil OAcris (S, S ) to be the closure inside OAcris (S, S ) for the p-adic
+
topology of the r-th PD-ideal of OA0cris (S, S + ). Finally, set Filr OB+
cris (S, S ) :=
P
r+s
r
r
+
OBcris (S, S + ).
Fil OAcris (S, S + )[1/p] and Fil OBcris (S, S + ) := sâˆˆZ tâˆ’s Fil

Lemma 2.17. Keep the notation above. For any F âˆˆ {OAcris , OB+
cris , OBcris } and
r
+ â‰ˆ
any r âˆˆ Z, there exists a natural almost isomorphism Fil F (S, S ) â†’ Filr F (V ).
Moreover, H i (V, Filr F )a = 0 whenever i > 0.
Proof. Consider the following morphism, again denoted by Î±
Î± : Acris (S, S + ){hu1 , . . . , ud i} âˆ’â†’ OAcris (S, S + ),

ui 7â†’ Ti âŠ— 1 âˆ’ 1 âŠ— [Tiâ™­ ].

One checks similarly as in Proposition 2.12 that this morphism is an isomorphism.
Moreover, if we define Filr (Acris (S, S + ){hu1 , . . . , ud i}) to be the p-adic completion
of
X
[i ]
[i ]
Filrâˆ’(i1 +...+id ) A0cris (S, S + )u1 1 Â· Â· Â· ud d âŠ‚ Acris (S, S + ){hu1 , . . . , ud i},
i1 ,...,id â‰¥0

16

FUCHENG TAN, JILONG TONG

then Î± respects the filtrations of both sides. The first part of our lemma can be
deduced from the following commutative diagram
Filr (Acris (S, S + ){hu1 , . . . , ud i})

â‰ˆ
Î±

/ Filr OAcris (S, S + )

â‰ˆ
Î±


/ Filr OAcris (V )

â‰ˆ


Filr (Acris {hu1 , . . . , ud i})(V )

where the left vertical almost isomorphism comes from Lemma 2.11. Using the
â‰ˆ
last part of Lemma 2.11 and the almost isomorphism Filr (Acris {hu1 , . . . , ud i})|Xe â†’
Filr OAcris |Xe of Proposition 2.12, we deduce H i (V, Filr OAcris )a = 0 for i > 0.
Inverting respectively p and t, we obtain the statements for Filr OB+
cris and for
Filr OBcris .

2.3. Frobenius on crystalline period sheaves. We keep the notations in the
previous Â§. So k is absolutely unramified and X is a smooth formal scheme of dimension d over Ok . We want to endow Frobenius endomorphisms on the crystalline
period sheaves.
â™­+
On Ainf = W (OX
), we have the Frobenius map

Ï• : Ainf âˆ’â†’ Ainf ,

(a0 , a1 , . . . , an , . . .) 7â†’ (ap0 , ap1 , . . . , apn , . . .).

Then for any a âˆˆ Ainf , we have Ï•(a) â‰¡ ap mod p. Thus, Ï•(Î¾) = Î¾ p + p Â· b with
b âˆˆ Ainf |Xk . In particular Ï•(Î¾) âˆˆ A0cris |Xk has all divided powers. As a consequence
we obtain a Frobenius Ï• on A0cris extending that on Ainf . By continuity, Ï• extends
p
to Acris and B+
cris . Note that Ï•(t) = log([Ç« ]) = pt. Consequently Ï• is extended to
1
1
Bcris by setting Ï•( t ) = pt .
To endow a Frobenius on OAcris , we first assume that the Frobenius of X0 =
X âŠ—Ok Îº lifts to a morphism Ïƒ on X , which is compatible with the Frobenius on
Ok . Then for Y âˆˆ XeÌt , consider the following diagram:

/7 Y
YO Îº 
âˆƒÏƒY

absolute Frobenius

YÎº



/Y

/X

eÌtale
Ïƒ


/ X.

As the right vertical map is eÌtale, there is a unique dotted morphism above making
the diagram commute. When Y varies in XeÌt , the ÏƒY â€™s give rise to a Ïƒ-semilinear
ur+
endomorphism on OXeÌt whence a Ïƒ-semilinear endomorphism Ï• on OX
.
Remark 2.18. In general X does not admit a lifting of Frobenius. But as X
is smooth over Ok , for each open subset U âŠ‚ X admitting an eÌtale morphism
U â†’ Spf(Ok {T1Â±1 , . . . , TdÂ±1 }), a similar argument as above shows that there exists
a unique lifting of Frobenius on U mapping Ti to Tip .
ur+
We deduce from above a Frobenius on OAinf = OX
âŠ—Ok Ainf given by Ï• âŠ— Ï•.
Abusing notation, we will denote it again by Ï•. A similar argument as in the
previous paragraphs shows that Ï• extends to OA0cris , hence to OAcris by continuity,
and finally to OB+
cris and OBcris . Moreover, under the almost isomorphism (2.2.4),
â‰ˆ
the Frobenius on Acris {hu1 , . . . , ud i} â†’ OAcris sends ui to Ï•(ui ) = Ïƒ(Ti ) âˆ’ [Tiâ™­ ]p .

Crystalline comparison isomorphism in p-adic Hodge theory

17

Lemma 2.19. Assume as above that the Frobenius of X0 = X âŠ—Ok Îº lifts to a
morphism Ïƒ on X compatible with the Frobenius on Ok . The Frobenius Ï• on OB+
cris
1,ur
+
is horizontal with respect to the connection âˆ‡ : OB+
cris â†’ OBcris âŠ— â„¦X/k .
Proof. We just need to check âˆ‡ â—¦ Ï• = (Ï• âŠ— dÏƒ) â—¦ âˆ‡ on OAcris in the almost sense.
It is enough to do this locally. Thus we may assume there exists an eÌtale morphism
X â†’ Spf(Ok {T1Â±1 , . . . , TdÂ±1 }). Recall the almost isomorphism (2.2.4). By Acris [n]
linearity it reduces to check the equality on the Ui . We have
[n]

âˆ‡(Ï•(ui )[n] ) = Ï•(ui )[nâˆ’1] âˆ‡(Ï•(ui ))

(âˆ‡ â—¦ Ï•)(ui ) =

Meanwhile, note that Ï•(ui ) âˆ’ Ïƒ(Ti ) = âˆ’[Tiâ™­ ]p âˆˆ Acris , hence âˆ‡(Ï•(ui )) = dÏƒ(Ti ).
Thus
[n]

((Ï• âŠ— dÏƒ) â—¦ âˆ‡) (ui )

[nâˆ’1]

= (Ï• âŠ— dÏƒ)(ui
=

[nâˆ’1]
)
Ï•(ui

= (âˆ‡ â—¦

âŠ— dTi )

âŠ— dÏƒ(Ti )

[n]
Ï•)(ui ),

as desired.



Clearly, the Frobenius on OB+
cris above depends on the initial lifting of Frobenius
on X . For different choices of liftings of Frobenius on X , it is possible to compare
explicitly the resulting Frobenius endomorphisms on OB+
cris with the help of the
connection on it, at least when the formal scheme X is small, i.e. when it admits
an eÌtale morphism to Spf(Ok {T1Â±1 , . . . , TdÂ±1 }).
Lemma 2.20. Assume there is an eÌtale morphism X â†’ Spf(Ok {T1Â±1, . . . , TdÂ±1 }).
Let Ïƒ1 , Ïƒ2 be two Frobenius liftings on X , and let Ï•1 and Ï•2 be the induced Frobenius
maps on OB+
cris , respectively. Then for any quasi-compact U âˆˆ XproeÌt , we have the
following relation on OB+
cris (U ):
(2.3.1)

Ï•2 =

X

(

d
d
Y
Y
(Ïƒ2 (Ti ) âˆ’ Ïƒ1 (Ti ))[ni ] )(Ï•1 â—¦ ( Nini ))
i=1

(n1 ,...,nd )âˆˆNd i=1

where the Ni â€™s are the endomorphisms of OB+
cris such that âˆ‡ =

Pd

i=1

Ni âŠ— dTi .

Proof. We only need to check the almost analogue for OAcris . To simplify the
notations, we shall use the multi-index: for m = (m1 , . . . , ud ) âˆˆ Nd , set N m :=
Qd
P
mi
and |m| := i mi . Let us remark first that for any a âˆˆ OAcris (U ) and
i=1 Ni
m
any r âˆˆ N, N (a) âˆˆ pr Â· OAcris (U ) when |m| is sufficiently large. As U is quasib = Spa(R, R+ ). As
compact, we may and do assume U is affinoid perfectoid with U
OAcris has no p-torsions, up to replacing a by p Â· a, we may and do assume that a
is of the form
X
bm Â· u[m] , bm âˆˆ Acris (R, R+ ) and lim bm = 0.
a=
|m|â†’âˆ

mâˆˆNd

Here we have again used the almost isomorphism (2.2.4). An easy calculation shows
X
X
N n (a) =
bm+n u[m] .
bm u[mâˆ’n] =
mâ‰¥n

mâˆˆNd

As the coefficient bm tends to 0 for the p-adic topology when |m| goes to infinity, it
follows that N n (a) âˆˆ pr Â· OAcris (U ) when |n| â‰« 0, as desired. Meanwhile, note that

18

FUCHENG TAN, JILONG TONG

ur+
ur+
Ïƒ2 (Ti ) âˆ’ Ïƒ1 (Ti ) âˆˆ pOX
(U ), hence their divided powers lie in OX
(U ). Therefore
the series of the righthand side of (2.3.1) applied to a converges.
It remains to verify the formula (2.3.1) for any a âˆˆ OAcris (U ). Assume again U
is affinoid perfectoid. Since both sides of (2.3.1) are semilinear with respect to the
Frobenius of Acris , it suffices to check the equality for a = u[m] . In fact, we have
P

Qd
Qd
[ni ]
)(Ï•1 â—¦ ( i=1 Nini )) (u[m] )
(n1 ,...,nd )âˆˆNd ( i=1 (Ïƒ2 (Ti ) âˆ’ Ïƒ1 (Ti ))
P
[n]
(Ï•1 (N n (u[m] )))
=
d (Ïƒ (T ) âˆ’ Ïƒ1 (T ))
PnâˆˆN 2
[n]
=
(Ï•1 (N n (u[m] )))
d (Ï• (u) âˆ’ Ï•1 (u))
PnâˆˆN 2
[n]
Â· Ï•1 (u)[mâˆ’n]
=
nâˆˆNd s.t. nâ‰¤m (Ï•2 (u) âˆ’ Ï•1 (u))
= (Ï•2 (u) âˆ’ Ï•1 (u) + Ï•1 (u))[m]
= Ï•2 (u[m] ).

This finishes the proof.



2.4. Comparison with de Rham period sheaves. Let X be a locally noetherian adic space over Spa(k, Ok ) and recall the map (2.1.2). Set B+
Binf /(ker Î¸)n ,
dR = lim
â†
âˆ’
r
r +
BdR = B+
dR [1/t]. For r âˆˆ Z, let Fil BdR = (ker Î¸) BdR . By its very definition, the
filtration on BdR is decreasing, separated and exhaustive. Similarly, with OBinf
r
+
+
r
in place of Binf , we define OB+
dR and OBdR . Define Fil OBdR = (ker Î¸X ) OBdR
P
r+s
r
+
+
âˆ’s
Fil
OBdR . The filtration on OBdR is decreasing,
and Fil OBdR =
sâˆˆZ t
separated and exhaustive. Moreover, as in [Bri, 5.2.8, 5.2.9], one can also show
that
r
r
+
OB+
dR âˆ© Fil OBdR = Fil OBdR ,
which in particular implies that the filtration on OBdR is also (decreasing and)
separated and exhaustive.
In the rest of this subsection, assume k/Qp is absolutely unramified.
Lemma 2.21. Let X be a smooth formal scheme over Ok .
(1) There are natural injective morphisms
+
B+
cris Ö’â†’ BdR ,

+
OB+
cris Ö’â†’ OBdR .

+
+
In the following, we will view B+
cris (resp. OBcris ) as a subring of BdR (resp.
of OB+
dR ).
(2) For any integer i â‰¥ 0, one has
i
+
+
Fili B+
cris = Fil OBdR âˆ© Bcris

i
+
+
Fili OB+
cris = Fil OBdR âˆ© OBcris .

i
+
In particular, the filtration {Fili B+
cris : i âˆˆ Z} (resp. {Fil OBcris : i âˆˆ Z})
+
+
on Bcris (resp. on OBcris ) is decreasing, separated and exhaustive.
(3) For i â‰¥ 0, the following canonical morphisms are isomorphisms:
âˆ¼

gri B+
â†’ gri B+
cris âˆ’
dR ,

âˆ¼

gri OB+
â†’ gri OB+
cris âˆ’
dR .

Proof. (1) We will first construct the two natural morphisms claimed in our lemma.
d
+
, and that B+ is a
Recall that we have the natural mophism Î¸ : W (Oâ™­+ ) â†’ O
X

X

sheaf of Qp -algebras. In particular, under the natural morphism

dR

â™­+
â™­+
Ainf = W (OX
) âˆ’â†’ W (OX
)[1/p] âˆ’â†’ B+
dR ,

the ideal of B+
dR generated by the image of ker(Î¸) has a PD-structure. Therefore,
the composed morphism above extends to a unique morphism A0cris â†’ B+
dR . On

Crystalline comparison isomorphism in p-adic Hodge theory

19

n +
the other hand, for each n, the quotient B+
dR / Fil BdR is p-adically complete, the
composite
n +
+
A0cris âˆ’â†’ B+
dR âˆ’â†’ BdR / Fil BdR
factors through the p-adic completion Acris of A0cris , giving a morphism Acris â†’
n +
B+
dR / Fil BdR . On passing to limit with respect to n, we get a morphism Acris â†’
+
+
B+
dR , whence the required natural morphism Bcris â†’ BdR by inverting p âˆˆ Acris .
+
The natural morphism from OBcris â†’ OBdR is constructed in a similar way.
The two morphisms constructed above are compatible with the isomorphisms in
Corollary 2.14 and its de Rham analogue [Sch13, Proposition 6.10]. To finish the
+
proof of (1), we only need to show the morphism B+
cris â†’ BdR constructed above
is injective. Let k be an algebraic closure of k. We only need to check that for
+
any affinoid perfectoid U lying above Xk , the induced map B+
cris (U ) â†’ BdR (U ) is
b = Spa(R, R+ ). Using the identification in Lemma 2.5 together
injective. Write U
with its de Rham analogue ([Sch13, Theorem 6.5]), we are reduced to showing that
+
+
+
the map h : B+
cris (R, R ) â†’ BdR (R, R ) is injective, where h is constructed analo+
+
gously as the natural map Bcris â†’ BdR above. This is proved in [Bri, Proposition
6.2.1], and we reproduce the proof here for the sake of completeness.
+
+
As B+
cris (R, R ) = Acris (R, R )[1/p], we only need to show the following comâ€²
posite h is injective:

/ B+ (R, R+ ) h / B+ (R, R+ ) .
hâ€² : Acris (R, R+ )
cris
dR

For n â‰¥ 0, let J [n] âŠ‚ Acris (R, R+ ) denote the closure for the p-adic topology of
the ideal generated by Î¾ [i] = Î¾ i /i! (i â‰¥ n), with Î¾ := [pâ™­ ] âˆ’ p âˆˆ Acris generating
âˆ’1
+
[n]
. Clearly only
the kernel of Î¸. We claim first that hâ€² (Filn B+
dR (R, R )) = J
âˆ’1
n
+
â€²
+
[n]
the inclusion h (Fil BdR (R, R )) âŠ‚ J requires verification. The case n = 1
is obvious from the definition. For general n â‰¥ 2, we will proceed by induction.
âˆ’1
+
[nâˆ’1]
Let x âˆˆ hâ€² (Filn B+
. Write x =
dR (R, R )). By induction hypothesis, x âˆˆ J
[nâˆ’1]
â™­+
[n]
x0 Î¾
+ x1 with x0 âˆˆ W (R ) and x1 âˆˆ J . Under the identification
+
Filnâˆ’1 B+
dR (R, R ) âˆ¼
âˆ’
â†’ R Â· Î¾ nâˆ’1 ,
n +
Fil BdR (R, R+ )

aÎ¾ nâˆ’1 7â†’ Î¸(a)Î¾ nâˆ’1 ,

+
nâˆ’1
the class of hâ€² (x) âˆˆ Filnâˆ’1 B+
/(n âˆ’ 1)!. As
dR (R, R ) corresponds to Î¸(x0 )Î¾
n +
â€²
+
h (x) lies in Fil BdR (R, R ), it follows that Î¸(x0 ) = 0. So x0 âˆˆ J and thus
+
x = x0 Î¾ [nâˆ’1] + x1 âˆˆ J [n] . Consequently J [n] = hâˆ’1 (Filn B+
dR (R, R )).
T
To conclude the proof of injectivity of hâ€² , it remains to show n J [n] = 0 in
Acris (R, R+ ). Recall from the proof of Lemma 2.13

Acris (R, R+ )/(p) â‰ƒ

(Râ™­+ /(pâ™­ )p )[Î´0 , Î´1 , . . .]
(Î´0p , Î´1p , . . .)

for Î´i the image of Î³ i+1 (Î¾), where Î³(x) = xp /p. Under this isomorphism, for
n
any n â‰¥ 1, the image of J [p ] in Acris (R, R+ )/(p) is generated by (Î´i )iâ‰¥nâˆ’1 .
T
T
This implies that iâˆˆZâ‰¥1 J [i] âŠ‚ pAcris (R, R+ ). Take x = pxâ€² âˆˆ iâ‰¥1 J [i] with
T
+
+
xâ€² âˆˆ Acris (R, R+ ). Then hâ€² (xâ€² ) âˆˆ i Fili B+
dR (R, R ) as p âˆˆ Bcris is invertible.
T
T
âˆ’1
i
Thus xâ€² âˆˆ i hâ€² (Fil BdR (R, R+ )) = i J [i] âŠ‚ pAcris (R, R+ ). Hence x = pxâ€² âˆˆ
T
p2 Acris (R, R+ ). Repeating this argument, one sees that iâˆˆZâ‰¥1 J [i] âŠ‚ pn Acris for
T
any n â‰¥ 1. So iâˆˆZâ‰¥1 J [i] = {0} as Acris is p-adically separated. Thus we have

20

FUCHENG TAN, JILONG TONG

+
+
+
constructed a natural injection B+
cris Ö’â†’ BdR . The claim OBcris Ö’â†’ OBdR follows
from this: this is a local question on XproeÌt , thus we may assume that our formal
scheme X admits an eÌtale map to Spf(Ok {T1Â±1 , . . . , TdÂ±1 }), and then conclude by
Corollary 2.14 and its de Rham analogue [Sch13, Proposition 6.10].
T i +
(2) To check Fili B+
= B+
Fil BdR , it suffices to show Fili B+
cris
cris
cris (U ) =
T
i +
+
b
Bcris (U ) Fil BdR (U ) for any affinoid perfectoid U above Xk . Write U = Spa(R, R+ ).
+
+
+
+
+
Under the identifications B+
dR (R, R ) â‰ƒ BdR (U ) and Bcris (R, R ) â‰ƒ Bcris (U ), we
i +
i +
i +
i +
+
+
have Fil Bcris (U ) = Fil Bcris (R, R ), and Fil BdR (U ) = Fil BdR (R, R ) (Lemma
2.5). On the other hand, from the proof of (1), we have J [i] = hâˆ’1 (Fili BdR (R, R+ )) =
T
Acris (R, R+ ) Fili BdR (R, R+ ), from which we deduce
\ i
+
+
+
+
Fili B+
Fil B+
cris (R, R ) = Bcris (R, R )
dR (R, R ),

as desired.
i
+ T
+
To show Fili OB+
Fili OB+
cris = OBcris
dR , we only need to check Fil OBcris âŠƒ
T
OB+
Fili OB+
cris
dR . For this we may again assume the formal scheme X admits an
eÌtale map to Spf(Ok {T1Â±1 , . . . , TdÂ±1 }). Then we can conclude by Corollary 2.14 and
its de Rham analogue.
i +
(3) From (2), we know that the canonical morphism gri B+
cris â†’ gr BdR is injective. Furthermore we have the identification
Fili B+
âˆ¼ d
dR |Xk
gri B+
|
âˆ’
â†’ OX |Xk Â· Î¾ i , aÎ¾ i 7â†’ Î¸(a)Î¾ i .
=
dR Xk
i+1 +
Fil
BdR |Xk
i +
i +
As Î¾ i = i!Î¾ [i] âˆˆ Fili B+
cris , the injection gr Bcris Ö’â†’ gr BdR is also surjective. Thus
âˆ¼
i +
i +
gr Bcris âˆ’
â†’ gr BdR . Using Corollary 2.14 and its de Rham analogue, we see that
âˆ¼
the latter isomorphism also implies that gri OB+
â†’ gri OB+

cris âˆ’
dR .

Corollary 2.22. Let X be a smooth formal scheme over Ok .
(1) There are two natural injections
Bcris Ö’â†’ BdR ,

OBcris Ö’â†’ OBdR .
T
(2) For any i âˆˆ Z, we have Fil Bcris = Bcris Fili BdR and Fili OBcris =
T i
OBcris Fil OBdR .
âˆ¼
âˆ¼
â†’ gri OBdR . In parâ†’ gri BdR and gri OBcris âˆ’
Furthermore, gri Bcris âˆ’
i
i
ticular, the filtration {Fil Bcris }iâˆˆZ (resp. {Fil OBcris }iâˆˆZ ) is decreasing,
separated and exhaustive.
i

Proof. These follow from the previous lemma, by inverting t.



As a consequence, we can compute the cohomology of the graded quotients gri F
+
for F âˆˆ {B+
cris , Bcris , OBcris , OBcris }: one just reduces to its de Rham analogue such
as [Sch13, Proposition 6.16] etc.
Corollary 2.23. Let X be a smooth adic space over Spa(k, Ok ) which admits a
smooth formal model X over Ok (so that we can define OBcris ), then
wâˆ— OBcris â‰ƒ OXeÌt [1/p].
âˆ¼
âˆ¼
âˆ¼
âˆ¼
â†’ XeÌt
the natural morphisms of topoi.
and Î½ â€² : XeÌt
Proof. Let Î½ : XproeÌt
â†’ XeÌt
â€²
Then w = Î½ â—¦ Î½. Therefore
âˆ¼

âˆ¼

â†’ Î½âˆ—â€² Î½âˆ— OX = wâˆ— OX .
OXeÌt [1/p] âˆ’
â†’ Î½âˆ—â€² OXeÌt âˆ’

Crystalline comparison isomorphism in p-adic Hodge theory

21

By [Sch13, Corollary 6.19], the natural morphism OXeÌt â†’ Î½âˆ— OBdR is an isomorphism. Thus, wâˆ— OBdR = Î½âˆ—â€² (Î½âˆ— OBdR ) â‰ƒ Î½âˆ—â€² OXeÌt â‰ƒ OXeÌt [1/p]. On the other
hand, we have the injection of OXeÌt [1/p]-algebras wâˆ— OBcris Ö’â†’ wâˆ— OBdR . Thereby
âˆ¼
OXeÌt [1/p] âˆ’
â†’ wâˆ— OBcris .

3. Crystalline cohomology and pro-eÌtale cohomology
In this section, we assume k is absolutely unramified. Let Ïƒ denote the Frobenius
on Ok and on k, lifting the Frobenius of the residue field Îº. Note that the ideal
(p) âŠ‚ Ok is endowed naturally with a PD-structure and Ok becomes a PD-ring in
this way.
3.1. A reminder on convergent F -isocrystals. Let X0 be a Îº-scheme of finite
type. Let us begin with some general definitions about crystals on the small crystalline site (X0 /Ok )cris endowed with eÌtale topology. For basics of crystals, we refer
to [Ber96], [BO]. Recall that a crystal of OX0 /Ok -modules is an OX0 /Ok -module
E on (X0 /Ok )cris such that (i) for any object (U, T ) âˆˆ (X0 /Ok )cris , the restriction
ET of E to the eÌtale site of T is a coherent OT -module; and (ii) for any morphism
âˆ¼
â†’ ET â€² is an
u : (U â€² , T â€² ) â†’ (U, T ) in (X0 /Ok )cris , the canonical morphism uâˆ— ET âˆ’
isomorphism.
Remark 3.1. Write X0 the closed fiber of a smooth formal scheme X over Ok .
Then the category of crystals on (X0 /Ok )cris is equivalent to that of coherent OX modules M equipped with an integrable and quasi-nilpotent connection âˆ‡ : M â†’
M âŠ—OX â„¦1X /Ok . Here the connection âˆ‡ is said to be quasi-nilpotent if its reduction
modulo p is quasi-nilpotent in the sense of [BO, Definition 4.10]. The correspondence between these two categories is given as follows: for E a crystal on X0 /Ok , as
X0 Ö’â†’ X is a p-adic PD-thickening, we can evalue E at it: set EX := limn EX âŠ—Ok /pn .
â†âˆ’
Let âˆ†1 Ö’â†’ X Ã— X be the PD-thickening of order 1 of the diagonal embedding
X Ö’â†’ X Ã— X . The two projections pi : âˆ†1 â†’ X are PD-morphisms. So we have two
âˆ¼
â†’ Eâˆ†1 := limn Eâˆ†1 âŠ—Ok /pn , whence a natural isomorphism
isomorphisms pâˆ—i EX âˆ’
â†âˆ’
âˆ¼
âˆ—
âˆ—
â†’ p1 EX . The latter isomorphism gives a connection âˆ‡ : EX â†’ EX âŠ— â„¦1X /Ok
p2 EX âˆ’
on EX . Together with a limit argument, that âˆ‡ is integrable and quasi-nilpotent
is due to [BO, Theorem 6.6].
The absolute Frobenius F : X0 â†’ X0 is a morphism over the Frobenius Ïƒ on Ok ,
hence it induces a morphism of topoi, still denoted by F :
âˆ¼

âˆ¼

F : (X0 /Ok )cris âˆ’â†’ (X0 /Ok )cris .
An F -crystal on (X0 /Ok )cris is a crystal E equipped with a morphism Ï• : F âˆ— E â†’ E
of OX0 /Ok -modules, which is nondegenerate, i.e. there exists a map V : E â†’ F âˆ— E
of OX0 /Ok -modules such that Ï•V = V Ï• = pm for some m âˆˆ N. In the following,
we will denote by F -Cris(X0 , Ok ) the category of F -crystals on X0 /Ok .
Before discussing isocrystals, let us first observe the following facts.
Remark 3.2. Let X rig be a classical rigid analytic space over k, with associated
adic space X. Using [Sch13, Theorem 9.1], one sees that the notion of coherent
OX rig -modules on X rig coincides with that of coherent OXan -modules on Xan , where
Xan denote the site of open subsets of the adic space X.

22

FUCHENG TAN, JILONG TONG

Remark 3.3. Let X be a smooth formal scheme over Ok , with X its generic fiber
in the sense of Huber. Let Coh(OX [1/p]) denote the category of coherent OX [1/p]modules on X , or equivalently, the full subcategory of the category of OX [1/p]modules on X consisting of OX [1/p]-modules which are isomorphic to M+ [1/p] for
some coherent sheaf M+ on X . Denote also Coh(OXan ) the category of coherent
OXan -modules on X. The analytification functor gives a fully faithful embedding
Coh(OX [1/p]) Ö’â†’ Coh(OXan ). Moreover, the essential image is stable under taking
direct summands (as OXan -modules). Indeed, let E be a coherent OXan -module
admitting a coherent formal model E + over X , and E â€² âŠ‚ E a direct summand. Let
f : E â†’ E be the idempotent corresponding to E â€² : write E = E â€² âŠ• E â€²â€² , then f is the
composite of the projection from E to E â€² followed by the inclusion E â€² âŠ‚ E. Therefore,
there exists some n â‰« 0 such that pn f comes from a morphism f + : E + â†’ E + of
OX -modules. Then the image of f + gives a formal model of E â€² over X , as desired.
Let X0 be a Îº-scheme of finite type. Asumme that it can be embedded as a
closed subscheme into a smooth formal scheme P. Let P be the associated adic
space of P and ]X0 [P âŠ‚ P the pre-image of the closed subset X0 âŠ‚ P under the
specialization map. Following [Ber96, 2.3.2 (i)] (with Remark 3.2 in mind), the
realization on P of a convergent isocrystal on X0 /Ok is a coherent O]X0 [P -module E
equipped with an integrable and convergent connection âˆ‡ : E â†’ E âŠ—O]X0 [P â„¦1]X0 [P /k
(we refer to [Ber96, 2.2.5] for the definition of convergent connections). Being a
coherent O]X0 [P -module with integrable connection, E is locally free of finite rank
by [Ber96, 2.2.3 (ii)]. The category of realizations on P of convergent isocrystals
on X0 /Ok is denoted by Isocâ€  (X0 /Ok , P), where the morphisms are morphisms of
O]X0 [P -modules which commute with connections.
Let X0 Ö’â†’ P â€² be a second embedding of X0 into a smooth formal scheme P â€² over
Ok , and assume there exists a morphism u : P â€² â†’ P of formal schemes inducing
identity on X0 . The generic fiber of u gives a morphism of adic spaces uk : ]X0 [P â€² â†’
]X0 [P , hence a natural functor
uâˆ—k : Isocâ€  (X0 /Ok , P) âˆ’â†’ Isocâ€  (X0 /Ok , P â€² ),

(E, âˆ‡) 7â†’ (uâˆ—k E, uâˆ—k âˆ‡).

By [Ber96, 2.3.2 (i)], the functor uâˆ—k is an equivalence of categories. Furthermore,
for a second morphism v : P â€² â†’ P of formal schemes inducing identity on X0 , the
two equivalence uâˆ—k , vkâˆ— are canonically isomorphic ([Ber96, 2.2.17 (i)]). Now the
category of convergent isocrystal on X0 /Ok , denoted by Isocâ€  (X0 /Ok ), is defined as
Isocâ€  (X0 /Ok ) := 2-lim Isocâ€  (X0 /Ok , P),
âˆ’â†’
P

where the limit runs through all smooth formal embedding X0 Ö’â†’ P of X0 .
Remark 3.4. In general, X0 does not necessarily admit a global formal embedding.
In this case, the category of convergent isocrystals on X0 /Ok can still be defined
by a gluing argument (see [Ber96, 2.3.2(iii)]). But the definition recalled above will
be enough for our purpose.
As for the category of crystals on X0 /Ok , the Frobenius morphism F : X0 â†’ X0
induces a natural functor (see [Ber96, 2.3.7] for the construction):
F âˆ— : Isocâ€  (X0 /Ok ) âˆ’â†’ Isocâ€  (X0 /Ok ).

Crystalline comparison isomorphism in p-adic Hodge theory

23

A convergent F -isocrystal on X0 /Ok is a convergent isocrystal E on X0 /Ok
âˆ¼
equipped with an isomorphism F âˆ— E âˆ’
â†’ E in Isocâ€  (X0 /Ok ). The category of convergent F -isocrystals on X0 /Ok will be denoted in the following by F -Isocâ€  (X0 /Ok ).
Remark 3.5. The category F -Isocâ€  (X0 /Ok ) has as a full subcategory the isogeny
category F -Cris(X0 /Ok )âŠ—Q of F -crystals E on (X0 /Ok )cris . To explain this, assume
for simplicity that X0 is the closed fiber of a smooth formal scheme X over Ok . So
]X0 [X = X, the generic fiber of X . Let (M, âˆ‡) be the OX -module with integrable
and quasi-nilpotent connection associated to the F -crystal E (Remark 3.1). Let
Ean := MÎ½ denote the generic fiber of M, which is a coherent (hence locally
free by [Ber96, 2.3.2 (ii)]) OXan -module equipped with an integrable connection
âˆ‡an : Ean âˆ’â†’ Ean âŠ— â„¦1Xan /k , which is nothing but the generic fiber of âˆ‡. Because of
the F -crystal structure on E, the connection âˆ‡an is necessarily convergent ([Ber96,
2.4.1]). In this way we obtain an F -isocrystal Ean on X0 /Ok , whence a natural
functor
(3.1.1)

(âˆ’)an : F -Cris(X0 /Ok ) âŠ— Q âˆ’â†’ F -Isocâ€  (X0 /Ok ),

E 7â†’ Ean .

By [Ber96, 2.4.2], this analytification functor is fully faithful, and for E a convergent
F -isocrystal on X0 /Ok , there exists an integer n â‰¥ 0 and an F -crystal E such that
âˆ¼
âˆ¼
Eâˆ’
â†’ Ean (n), where for F = (F , âˆ‡, Ï• : F âˆ— F âˆ’
â†’ F ) an F -isocrystal on X0 /Ok , F (n)
âˆ¼
denotes the Tate twist of F , given by (F , âˆ‡, pÏ•n : F âˆ— F âˆ’
â†’ F ) ([Ber96, 2.3.8 (i)]).
Our next goal is to give a more explicit description of the Frobenii on convergent
F -isocrystals on X0 /Ok . From now on, assume for simplicity that X0 is the closed
fiber of a smooth formal scheme X and we shall identify the notion of convergent
iscrystals on X0 /Ok with its realizations on X . Let X be the generic fiber of X .
The proof of the following lemma is obvious.
Lemma 3.6. Assume that the Frobenius F : X0 â†’ X0 can be lifted to a morphism
Ïƒ : X â†’ X compatible with the Frobenius on Ok . Still denote by Ïƒ the endomorphism on X induced by Ïƒ. Then there is an equivalence of categories between
(1) the category F -Isocâ€  (X0 /Ok ) of convergent F -isocrystals on X0 /Ok ; and
(2) the category ModÏƒ,âˆ‡
OX of OXan -vector bundles E equipped with an integrable
and convergent connection âˆ‡ and an OXan -linear horizontal isomorphism
Ï• : Ïƒ âˆ— E â†’ E.
Consider two liftings of Froebnius Ïƒi (i = 1, 2) on X . By the lemma above,
Ïƒi ,âˆ‡
for i = 1, 2, both categories ModO
are naturally equivalent to the category of
X
convergent F -iscrystals on X0 /Ok :
ModÏƒO1X,âˆ‡ o

âˆ¼

F -Isocâ€  (X0 /Ok )

âˆ¼

/ ModÏƒ2 ,âˆ‡ .
OX

Therefore we deduce a natural equivalence of categories
(3.1.2)

FÏƒ1 ,Ïƒ2 : ModÏƒO1X,âˆ‡ âˆ’â†’ ModÏƒO2X,âˆ‡ .

When our formal scheme X is small, we can explicitly describe this equivalence as
follows. Assume there is an eÌtale morphism X â†’ T d = Spf(Ok {T1Â±1 , . . . , TdÂ±1 }).
So â„¦1Xan /k is a free OXan -module with a basis given by dTi (i = 1, . . . , d). In the
following, for âˆ‡ a connection on an OXan -module E, let Ni be the endomorphism
P
of E (as an abelian sheaf) such that âˆ‡ = di=1 Ni âŠ— dTi .

24

FUCHENG TAN, JILONG TONG

Lemma 3.7 (see also [Bri] 7.2.3). Assume X = Spf(A) is affine and that there
exists an eÌtale morphism X â†’ T d as above. For (E, âˆ‡, Ï•1 ) âˆˆ ModÏƒO1X,âˆ‡ , with
(E, âˆ‡, Ï•2 ) the corresponding object of ModÏƒO2X,âˆ‡ under the functor FÏƒ1 ,Ïƒ2 . Then on
E(X) we have
!!
!
d
d
Y
X
Y
ni
[ni ]
.
Ni
Ï•1 â—¦
(Ïƒ2 (Ti ) âˆ’ Ïƒ1 (Ti ))
(3.1.3)
Ï•2 =
(n1 ,...,nd )âˆˆNd

i=1

i=1

Furthermore, Ï•1 and Ï•2 coincide on E(X)âˆ‡=0 .

Q
Proof. To simplify the notations, we shall use the multi-index: so N n := n Nini
for n = (n1 , . . . , nd ) âˆˆ Nd etc. We observe first that the right hand side of (3.1.3)
converges. Indeed, by [Ber96, 2.4.2], there exists some n âˆˆ N such that E(âˆ’n) lies in
the essential image of the functor (3.1.1). In particular, this implies that there exists
a coherent OX -module E + equipped with a quasi-nilpotent connection âˆ‡+ such that
(E, âˆ‡) is the generic fiber of (E + , âˆ‡+ ). In particular, for any e âˆˆ E + := E + (X ),
N n (e) âˆˆ p Â· E + for all but finitely many n âˆˆ Nd . Furthermore, as Ïƒ1 , Ïƒ2 are liftings
of Frobenius, Ïƒ2 (Ti )âˆ’ Ïƒ1 (Ti ) âˆˆ pÂ·A. So the divided power (Ïƒ2 (Ti )âˆ’ Ïƒ1 (Ti ))[ni ] âˆˆ A.
Thereby the right hand side of (3.1.3) applied to an element of E(X) = E + [1/p]
converges for the cofinite filter on Nd .
Next we claim that the equality (3.1.3) holds when E = OXan endowed with the
natural structure of F -isocrystal. Indeed, necessarily Ï•i = Ïƒi in this case. Let Ïƒ2â€² be
the endomorphism of A defined by the right hand side of (3.1.3). Then both Ïƒ2 , Ïƒ2â€²
are liftings of Frobenius on A, and it is elementary to check that they coincide
on the Ok -subalgbra Ok {T1Â±1 , . . . , TdÂ±1 }. As A is eÌtale over Ok {T1Â±1 , . . . , TdÂ±1 },
we deduce Ïƒ2 = Ïƒ2â€² , giving our claim. By consequence, in the general case, the
right hand side of (3.1.3) defines a Ïƒ2 -semilinear endomorphism Ï•â€²2 on E(X). In
particular, we obtain a morphism of OXan -modules Ïƒ2âˆ— E â†’ E, still denoted by Ï•â€²2 .
One checks that Ï•â€²2 : Ïƒ2âˆ— E â†’ E is horizontal, hence it is a morphism of convergent
isocrystals.
Now one needs to verify the equality (3.1.3). Consider the fiber product X Ã— X
and its generic fiber X Ã— X. Let U =]X0 [X Ã—X âŠ‚ X Ã— X denote the pre-image of
the closed subset Î´(X0 ) âŠ‚ X0 Ã— X0 under the specialization map, and qi : U â†’ X
(i = 1, 2) the two projections. If we endow X Ã— X with the Frobenius Ïƒ := Ïƒ1 Ã— Ïƒ2 ,
then Ïƒi â—¦ qi = qi â—¦ Ïƒ. In particular, the pull-back q1âˆ— E is endowed with a morphism
q1âˆ— Ï•1 : Ïƒ âˆ— q1âˆ— E = q1âˆ— Ïƒ1âˆ— E âˆ’â†’ q1âˆ— E.
Similarly, q2âˆ— E is a convergent isocrystal on U endowed with a horizontal morphism
q2âˆ— Ï•â€²2 . Consider the following OUan -linear isomorphism induced by the connection
on E:
X N n (m) âŠ— Ï„ n
âˆ¼
,
Î· : OUan âŠ—OXan E âˆ’â†’ E âŠ—OXan OUan , 1 âŠ— m 7â†’
n!
d
nâˆˆN

where Ï„ = (Ï„1 , . . . , Ï„d ) with Ï„i = 1 âŠ— Ti âˆ’ Ti âŠ— 1 (note that this formula makes sense
as the connection on E is convergent (see [Ber96, 2.2.5])). By a direct calculation,

Crystalline comparison isomorphism in p-adic Hodge theory

25

one checks the commutativity of the following diagram:
q2âˆ— Ï•â€²2

Ïƒ âˆ— (OUan âŠ— E)
Ïƒâˆ— (Î·)

Î·


Ïƒ âˆ— (E âŠ— OUan )
Indeed, taking m âˆˆ E, we find
X N n (Ï•â€² (m)) âŠ— Ï„ n
2

nâˆˆNd

n!

/ OUan âŠ— E

q1âˆ— Ï•1

=


/ E âŠ— OUan .

X Ï•1 (N n (m)) âŠ— Ïƒ
b(Ï„ n )
.
n!
d

nâˆˆN

Finally, let I = (Ï„1 , . . . , Ï„d ) be the ideal defining the closed immersion X Ö’â†’ U .
Then modulo the ideal I in the above equality, the left hand side becomes just
Ï•â€²2 (m). Moreover, as Ïƒ(Ï„i ) = Ïƒ2 (Ti ) âˆ’ Ïƒ1 (Ti ), we find the following equality in E:
X Ï•1 (N n (m)) Â· Q (Ïƒ2 (Ti ) âˆ’ Ïƒ1 (Ti ))ni
i
Ï•2 (m) =
,
n!
d
nâˆˆN

as desired.
In particular, Ï•â€²2 : Ïƒ2âˆ— E â†’ E is a horizontal isomorphism, hence (E, âˆ‡, Ï•â€²2 ) is an
F -isocrystal. Moreover q1âˆ— (E, âˆ‡, Ï•1 ) and q2âˆ— (E, âˆ‡, Ï•â€²2 ) are isomorphic as realizations
of F -isocrystals on the embedding X0 Ö’â†’ X Ã— X . Therefore, by definition [Ber96,
2.3.2], (E, âˆ‡, Ï•1 ) and (E, âˆ‡, Ï•â€²2 ) realize the same F -isocrystal on X0 /Ok .
The last statement of our lemma is clear from the formula just proved as E(X)âˆ‡=0 =
Td

i=1 ker(Ni ).
More generally, i.e. without assuming the existence of Frobenius lifts to X , for
(E, âˆ‡) an OXan -module with integrable and convergent connection, a compatible
system of Frobenii on E consists of, for any open subset U âŠ‚ X equipped with a
lifting of Frobenius ÏƒU , a horizontal isomorphism Ï•(U ,ÏƒU ) : ÏƒUâˆ— E|Uk â†’ E|Uk satisfying
the following condition: for V âŠ‚ X another open subset equipped with a lifting of
Frobenius ÏƒV , the functor
ÏƒU ,âˆ‡
ÏƒV ,âˆ‡
âˆ’â†’ ModO
FÏƒU ,ÏƒV : ModO
T
T
U
V
U
V
k

k

k

k

sends (E|Uk T Vk , âˆ‡, Ï•(U ,ÏƒU ) |Uk T Vk ) to (E|Uk T Vk , âˆ‡, Ï•(V,ÏƒV ) |Uk T Vk ). We denote a
compatible system of Frobenii on E by the symbol Ï•, when no confusion arises. Let
ModÏƒ,âˆ‡
OX be the category of OXan -vector bundles equipped with an integrable and
convergent connection, and with a compatible system of Frobenii. The morphism in
ModÏƒ,âˆ‡
OX are the morphisms of OXan -modules which commute with the connections,
and with the Frobenius morphisms on any open subset U âŠ‚ X equipped with a
lifting of Frobenius.
Remark 3.8. Let E be a convergent isocrystal on X0 /Ok . To defineSa compatible
system of Frobenii on E, we only need to give, for a cover X = i Ui of X by
open subsets Ui equipped with a lifting of Frobenius Ïƒi , a family of Frobenius
âˆ¼
morphisms Ï•i : Ïƒiâˆ— E|Ui â†’ E|Ui such that Ï•i |Ui T Uj corresponds to Ï•j |Ui T Uj under
Ïƒ ,âˆ‡
the functor FÏƒi ,Ïƒj : ModÏƒOiU,âˆ‡T U â†’ ModOjU T U (Here Uâ€¢ := Uâ€¢,k ). Indeed, for
i
j
i
j
U any open subset equipped with a lifting of Frobenius ÏƒU , one can first use the
functor FÏƒi ,ÏƒU of (3.1.2) applied to (E|Ui , âˆ‡|Ui , Ï•i )|Ui T U to obtain a horizontal

26

FUCHENG TAN, JILONG TONG

isomorphism Ï•U ,i : (ÏƒUâˆ— (E|U ))|Ui T U â†’ E|Ui T U . From the compatibility of the Ï•i â€™s,
we deduce Ï•U ,i |U T Ui T Uj = Ï•U ,j |U T Ui T Uj . Consequently we can glue the Ï•U ,i â€™s
(i âˆˆ I) to get a horizontal isomorphism Ï•U : ÏƒUâˆ— (E|U ) â†’ E|U . One checks that these
Ï•U â€™s give the desired compatible system of Frobenii on E.
Let E be a convergent F -isocrystal on X0 /Ok . For U âŠ‚ X an open subset equipped with a lifting of Frobenius ÏƒU , the restriction E|Uk gives rise to a
convergent F -isocrystal on U0 /k. Thus there exists a âˆ‡-horizontal isomorphism
Ï•(U ,ÏƒU ) : ÏƒUâˆ— E|Uk â†’ E|Uk . Varying (U, ÏƒU ) we obtain a compatible system of Frobenii
Ï• on E. In this way, (E, âˆ‡, Ï•) becomes an object of ModÏƒ,âˆ‡
OX . Directly from the
definition, we have the following
Corollary 3.9. The natural functor F -Isocâ€  (X0 /Ok ) â†’ ModÏƒ,âˆ‡
OX is an equivalence
of categories.
â€¢
In the following, denote by FModÏƒ,âˆ‡
OX the category of quadruples (E, âˆ‡, Ï•, Fil (E))
with (E, âˆ‡, Ï•) âˆˆ ModÏƒ,âˆ‡
OX and a decreasing, separated and exhaustive filtration
Filâ€¢ (E) on E by locally free direct summands, such that âˆ‡ satisfies Griffiths transversality with respect to Filâ€¢ (E), i.e., âˆ‡(Fili (E)) âŠ‚ Filiâˆ’1 (E) âŠ—OXan â„¦1Xan /k . The

morphisms are the morphisms in ModÏƒ,âˆ‡
OX which respect the filtrations. We call
Ïƒ,âˆ‡
the objects in FModOX filtered (convergent) F -isocrystals on X0 /Ok . By analogy
with the category F -Isocâ€  (X0 /Ok ) of F -isocrystals, we also denote the category of
filtered F -isocrystals on X0 /Ok by F F -Isocâ€  (X0 /Ok ).
b p -sheaves and filtered F -isocystals. Let X be a smooth formal
3.2. Lisse Z
b p := lim Z/pn
scheme over Ok with X its generic fiber in the sense of Huber. Define Z
â†âˆ’
b p := Z
b p [1/p] as sheaves on XproeÌt . Recall that a lisse Zp -sheaf on XeÌt is an
and Q
inverse system of sheaves of Z/pn -modules Lâ€¢ = (Ln )nâˆˆN on XeÌt such that each
Ln is locally a constant sheaf associated to a finitely generated Z/pn -modules, and
such that the inverse system is isomorphic in the pro-category to an inverse system
b p -sheaf on XproeÌt is a sheaf of Z
b p -modules on
for which Ln+1 /pn â‰ƒ Ln . A lisse Z
b
XproeÌt , which is locally isomorphic to Zp âŠ—Zp M where M is a finitely generated
Zp -module. By [Sch13, Proposition 8.2] these two notions are equivalent via the
âˆ¼
âˆ¼
. In the following, we use the natural morphism of topoi
â†’ XproeÌt
functor Î½ âˆ— : XeÌt
Î½
âˆ¼
âˆ¼
âˆ¼
w : XproeÌt â†’ XeÌt â†’ XeÌt frequently. Before defining crystalline sheaves let us first
make the following observation.
Remark 3.10. (1) Let M be a crystal on X0 /Ok , viewed as a coherent OX -module
ur+
admitting an integrable connection. Then wâˆ’1 M is a coherent OX
-module with
1,ur+
âˆ’1
âˆ’1
an integrable connection w M â†’ w M âŠ—Our+ â„¦X/k . If furthermore M is an
X
F -crystal, then wâˆ’1 M inherits a system of Frobenii: for any open subset U âŠ‚ X
equipped with a lifting of Frobenius ÏƒU , there is naturally an endomorphism of
ur+
wâˆ’1 M|U which is semilinear with respect to the Frobenius wâˆ’1 ÏƒU on OX
|U (here
U := Uk ). Indeed, the Frobenius structure on M gives a horizontal OU -linear
morphism ÏƒUâˆ— M|U â†’ M|U , or equivalently, a ÏƒU -semilinear morphism Ï•U : M|U â†’
M|U (as ÏƒU is the identity map on the underlying topological space). So we obtain
a natural endomorphism wâˆ’1 Ï•U of wâˆ’1 M|U , which is wâˆ’1 ÏƒU -semilinear.

Crystalline comparison isomorphism in p-adic Hodge theory

27

(2) Let E be a convergent F -isocrystal on X0 /Ok . By Remark 3.5, there exists
an F -crystal M on X0 /Ok and n âˆˆ N such that E â‰ƒ Man (n). By (1), wâˆ’1 M is
ur+
a coherent OX
-module equipped with an integrable connection and a compatible
ur
system of Frobenii Ï•. Inverting p, we get an OX
-module wâˆ’1 M[1/p] equipped with
an integrable connection and a system of Frobenii Ï•/pn , which does not depend
on the choice of the formal model M or the integer n. For this reason, abusing
notation, let us denote wâˆ’1 M[1/p] by wâˆ’1 E, which is equipped with an integrable
connection and a system of Frobenii inherited from E. If furthermore E has a
descending filtration {Fili E} by locally direct summands, by Remark 3.3, each
Fili E has a coherent formal model Ei+ on X . Then {wâˆ’1 Ei+ [1/p]} gives a descending
filtration (by locally direct summands) on wâˆ’1 E.
b p -sheaf L on XproeÌt is crystalline if there exists
Definition 3.11. We say a lisse Z
a filtered F -isocrystal E together with an isomorphism of OBcris -modules

(3.2.1)

ur OBcris â‰ƒ L âŠ—
wâˆ’1 E âŠ—OX
bp OBcris
Z

which is compatible with connection, filtration and Frobenius. In this case, we say
b p -sheaf L and the filtered F -isocrystal E are associated.
that the lisse Z

Remark 3.12. The Frobenius compatibility of the isomorphism (3.2.1) means
the following. Take any open subset U âŠ‚ X equipped with a lifting of Frobenius
Ïƒ : U â†’ U. By the discussion in Â§2.3, we know that OBcris |Uk is naturally endowed
with a Frobenius Ï•. Meanwhile, as E is an F -isocrystal, by Remark 3.10 wâˆ’1 E|Uk
is endowed with a wâˆ’1 Ïƒ-semilinear Frobenius, still denoted by Ï•. Now the required
Frobenius compatibility means that when restricted to any such Uk , we have Ï•âŠ—Ï• =
id âŠ— Ï• via the isomorphism (3.2.1).
b p -sheaf and i âˆˆ Z, set
Definition 3.13. For L a lisse Z
Dcris (L) := wâˆ— (L âŠ—Zbp OBcris ),

and

Fili Dcris (L) := wâˆ— (L âŠ—Zbp Fili OBcris ).

All of them are OX [1/p]-modules, and the Fili Dcris (L) give a separated exhaustive
decreasing filtration on Dcris (L) (as the same holds for the filtration on OBcris ; see
Corollary 2.22).
Next we shall compare the notion of crystalline sheaves with other related notions
considered in [Bri, Chapitre 8], [Fal] and [Sch13]. We begin with the following
characterization of crystalline sheaves, which is more closely related to the classical
definition of crystalline representations by Fontaine (see also [Bri, Chapitre 8]).
b p -sheaf on XproeÌt . Then L is crystalline if
Proposition 3.14. Let L be a lisse Z
and only if the following two conditions are verified:
(1) the OX [1/p]-modules Dcris (L) and Fili Dcris (L) (i âˆˆ Z) are all coherent.
ur OBcris â†’ L âŠ—
(2) the adjunction morphism wâˆ’1 Dcris (L) âŠ—OX
bp OBcris is an
Z
isomorphism of OBcris -modules.
Before proving this proposition, let us express locally the sheaf Dcris (L) = wâˆ— (LâŠ—
OBcris ) as the Galois invariants of some Galois module. Consider U = Spf(R+ ) âŠ‚ X
a connected affine open subset admitting an eÌtale map U â†’ Spf(Ok {T1Â±1 , . . . , TdÂ±1 }).
Write R = R+ [1/p] and denote U the generic fiber of U. As U is smooth and connected, R+ is an integral domain. Fix an algebraic closure â„¦ of Frac(R), and let
+
R be the union of finite and normal R+ -algebras Q+ contained in â„¦ such that

28

FUCHENG TAN, JILONG TONG
+

Q+ [1/p] is eÌtale over R. Write R = R [1/p]. Write GU := Gal(R/R), which is
nothing but the fundamental group of U = Uk . Let U univ be the profinite eÌtale
+
cover of U corresponding to (R, R ). One checks that U univ is affinoid perfectoid
b p -sheaf on X, its restriction to U
(over the completion of k). As L is a lisse Z
corresponds to a continuous Zp -representation VU (L) := L(U univ ) of GU . Write
\
univ = Spa(S, S + ), where (S, S + ) is the p-adic completion of (R, R+ ).
U
b p -sheaf on X. Then
Lemma 3.15. Keep the notation above. Let L be a lisse Z
there exist natural isomorphisms of R-modules
GU
âˆ¼
=: Dcris (VU (L))
Dcris (L)(U) âˆ’â†’ VU (L) âŠ—Zp OBcris (S, S + )
and, for any r âˆˆ Z,

GU
âˆ¼
.
(Filr Dcris (L)) (U) âˆ’â†’ VU (L) âŠ—Zp Filr OBcris (S, S + )

Moreover, the R-module Dcris (L)(U) is projective of rank at most that of VU (L)âŠ—Qp .
b p -sheaf, it becomes constant restricted to U univ . In other
Proof. As L is a lisse Z
b p |U univ . For i â‰¥ 0 an integer, we denote by
words, we have L|U univ â‰ƒ VU (L) âŠ—Zp Z
univ,i
univ
U
the (i+1)-fold product of U
over U . Then U univ,i â‰ƒ U univ Ã— GiU , and it is
again an affinoid perfectoid. By the use of Lemma 2.17, we find H j (U univ,i , L âŠ—Zbp
OBcris ) = 0 for j > 0. Moreover

H 0 (U univ,i , L âŠ—Zbp OBcris ) = Homcont GiU , VU (L) âŠ—Zp OAcris (U univ ) [1/t].
Again, as U univ is affinoid perfectoid, OBcris (U univ ) â‰ƒ OBcris (S, S + ) by Lemma
2.17. Consider the Cartan-Leray spectral sequence (cf. [SGA4, V.3]) associated to
the cover U univ â†’ U :
E1i,j = H j (U univ,i , L âŠ—Zbp OBcris ) =â‡’ H i+j (U, L âŠ—Zbp OBcris ).
As E1i,j = 0 for j â‰¥ 1, we have E2n,0 = H n (U, L âŠ—Zbp OBcris ). Thus, we deduce a
natural isomorphism
âˆ¼

j
H j (U, L âŠ—Zbp OBcris ) âˆ’â†’ Hcont
(GU , VU (L) âŠ—Zp OAcris (S, S + ))[1/t]

where the right hand side is the continuous group cohomology. Taking j = 0, we
obtain our first assertion. The isomorphism concerning Filr OBcris can be proved
exactly in the same way. The last assertion follows from the first isomorphism and
[Bri, Proposition 8.3.1], which gives the assertion for the right hand side.

The lemma above has the following two consequences.
b p -sheaf on XproeÌt , which satisfies the condition
Corollary 3.16. Let L be a lisse Z
(1) of Proposition 3.14. Let U = Spf(R+ ) be a small connected affine open subset
of X . Write R = R+ [1/p] and U = Uk . Then for any V âˆˆ XproeÌt /U , we have
âˆ¼

ur OBcris )(V ).
Dcris (L)(U) âŠ—R OBcris (V ) â†’ (wâˆ’1 Dcris (L) âŠ—OX

Proof. By Lemma 3.15, the R-module Dcris (L)(U) is projective of finite type over
R, hence it is a direct summand of a finite free R-module. As Dcris (L) is coherent
over OX [1/p] and as U is affine, Dcris (L)|U is then a direct summand of a finite free
OX [1/p]|U -module. The isomorphism in our corollary then follows, since we have
similar isomorphism when Dcris (L)|U is replace by a free OX [1/p]|U -module.


Crystalline comparison isomorphism in p-adic Hodge theory

29

b p -sheaf verifying the condition (1) of Proposition
Corollary 3.17. Let L be a lisse Z
3.14. Then the condition (2) of Proposition 3.14 holds for L if and only if for any
small affine connected open subset U âŠ‚ X (with U := Uk ), the GU -representation
VU (L) âŠ—Zp Qp is crystalline in the sense that the following natural morphism is an
isomorphism ([Bri, Chapitre 8])
âˆ¼

Dcris (VU (L)) âŠ—R OBcris (S, S + ) âˆ’â†’ VU (L) âŠ—Zp OBcris (S, S + ),
\
univ = Spa(S, S + ) are as in the paragraph before Lemma 3.15.
where GU , U univ , U
Proof. If L satisfies in addition the condition (2) of Proposition 3.14, combining
with Corollary 3.16, we find
 âˆ¼
univ
ur OBcris )(U
)
âˆ’â†’ (wâˆ’1 Dcris (L) âŠ—OX
Dcris (L)(U) âŠ—R OBcris U univ
âˆ¼

âˆ’â†’ (L âŠ—Zbp OBcris )(U univ )
=

VU (L) âŠ—Zp OBcris (U univ ).

So, by Lemmas 2.17 and 3.15, the GU -representation VU (L) âŠ— Qp is crystalline.
Conversely, assume that for any small connected affine open subset U = Spf(R+ )
of X , the GU -representation VU (L) âŠ—Zp Qp is crystalline. Together with Lemmas
âˆ¼
2.17 and 3.15, we get Dcris (L)(U) âŠ—R OBcris (U univ ) â†’ VU (L) âŠ—Zp OBcris (U univ ) and
univ
the similar isomorphism after replacing U
by any V âˆˆ XproeÌt /U univ . Using
âˆ¼
ur OBcris )(V ) â†’ (L âŠ— b OBcris )(V ) for
Corollary 3.16, we deduce (wâˆ’1 Dcris (L) âŠ—OX
Zp
âˆ¼

ur OBcris )| univ â†’ (L âŠ— b OBcris )| univ .
any V âˆˆ XproeÌt /U univ , i.e., (wâˆ’1 Dcris (L) âŠ—OX
U
U
Zp
When the small opens Uâ€™s run through a cover of X , the U univ â€™s form a cover of
âˆ¼
X for the pro-eÌtale topology. Therefore, wâˆ’1 Dcris (L) âŠ— OBcris â†’ L âŠ— OBcris , as
desired.


b p -sheaf on X satisfying the two conditions of
Lemma 3.18. Let L be a lisse Z
Proposition 3.14. Then (the analytification of ) Dcris (L) has a natural structure of
filtered convergent F -isocrystal on X0 /Ok .
Proof. First of all, the Fili Dcris (L)â€™s (i âˆˆ Z) endow a separated exhaustive decreasing filtration on Dcris (L) by Corollary 2.22, and the connection on Dcris (L) =
wâˆ— (L âŠ— OBcris ) can be given by the composite of
wâˆ— (L âŠ— OBcris )

wâˆ— (idâŠ—âˆ‡)

âˆ’â†’
âˆ¼

âˆ’â†’

1,ur
ur â„¦
wâˆ— (L âŠ— OBcris âŠ—OX
X/k )

wâˆ— (L âŠ— OBcris ) âŠ—OX [1/p] â„¦1X /Ok [1/p]

where the last isomorphism is the projection formula. That the connection satisfies
the Griffiths transversality with respect to the filtration Filâ€¢ Dcris follows from the
analogous assertion for OBcris (Proposition 2.16).
Now consider the special case where X = Spf(R+ ) is affine connected admitting an eÌtale map X â†’ Spf(Ok {T1Â±1 , . . . , TdÂ±1 }), such that X is equipped with
a lifting of Frobenius Ïƒ. As in the paragraph before Lemma 3.15, let X univ be
the univeral profinite eÌtale cover of X (which is an affinoid perfectoid). Write
\
univ = Spa(S, S + ) and G
X
X the fundamental group of X. As X is affine, the
category Coh(OX [1/p]) is equivalent to the category of finite type R-modules (here
R := R+ [1/p]). Under this equivalence, Dcris (L) corresponds to Dcris (VX (L)) :=
(VX (L) âŠ— OBcris (S, S + ))GX , denoted by D for simplicity. So D is a projective

30

FUCHENG TAN, JILONG TONG

R-module of finite type (Lemma 3.15) equipped with a connection âˆ‡ : D â†’ D âŠ—
â„¦1R/k . Under the same equivalence, Fili Dcris (L) corresponds to Fili D := (VX (L) âŠ—
Fili OBcris (S, S + ))GX , by Lemma 3.15 again. By the same proof as in [Bri, 8.3.2],
the graded quotient gri (D) is a projective module. In particular, Fili D âŠ‚ D is a
direct summand. Therefore, each Fili Dcris (L) is a direct summand of Dcris (L). Furthermore, since X admits a lifting of Frobenius Ïƒ, we get from Â§ 2.3 a Ïƒ-semilinear
endomorphism Ï• on OBcris (X univ ) â‰ƒ OBcris (S, S + ), whence a Ïƒ-semilinear endomorphism on D, still denoted by Ï•. From Lemma 2.19, One checks that the Frobenius Ï• on D is horizontal with respect to its connection. Thus Dcris (L) is endowed
with a horizontal Ïƒ-semilinear morphism Dcris (L) â†’ Dcris (L), always denoted by Ï•
in the following.
To finish the proof in the special case, one still needs to show that the triple
(Dcris (L), âˆ‡, Ï•) gives an F -isocrystal on X0 /Ok . As D is of finite type over R, there
exists some n âˆˆ N such that D = D+ [1/p] with D+ := (VX (L)âŠ—Zp tâˆ’n OAcris (S, S + ))GX .
The connection on tâˆ’n OAcris (S, S + ) induces a connection âˆ‡+ : D+ â†’ D+ âŠ—R+
â„¦1R+ /Ok on D+ , compatible with that of Dcris (VX (L)). Moreover, if we take Ni to
Pd
be the endomorphism of D+ so that âˆ‡+ = i=1 Ni âŠ— dTi , then for any a âˆˆ D+ ,
N m (a) âˆˆ p Â· D+ for all but finitely many m âˆˆ Nd (as this holds for the connection on tâˆ’n OAcris , seen in the proof of Lemma 2.20). Similarly, the Frobenius on
OBcris (S, S + ) induces a map (note that the Frobenius on OBcris (S, S + ) sends t to
p Â· t)
Ï• : D+ âˆ’â†’ (VX (L) âŠ— pâˆ’n tâˆ’n OAcris (S, S + ))GX .
Thus Ïˆ := pn Ï• gives a well-defined Ïƒ-semilinear morphism on D+ . One checks
that Ïˆ is horizontal with respect to the connection âˆ‡+ on D+ and it induces an
âˆ¼
R+ -linear isomorphism Ïƒ âˆ— D+ â†’ D+ . As a result, the triple (D+ , âˆ‡, Ïˆ) will define an F -crystal on U0 /Ok , once we know D+ is of finite type over R+ . The
required finiteness of D+ is explained in [AI, Proposition 3.6], and for the sake of
completeness we recall briefly their proof here. As D is projective of finite type
(Lemma 3.15), it is a direct summand of a finite free R-module T . Let T + âŠ‚ T
be a finite free R+ -submodule of T such that T + [1/p] = T . Then we have the
inclusion D âŠ—R OBcris (S, S + ) Ö’â†’ T + âŠ—R+ OBcris (S, S + ). As VX (L) is of finite type
over Zp and OBcris (S, S + ) = OAcris (S, S + )[1/t], there exists m âˆˆ N such that the
OAcris (S, S + )-submodule VX (L) âŠ— tâˆ’n OAcris (S, S + ) of VX (L) âŠ— OBcris (S, S+) â‰ƒ
D âŠ— OBcris (S, S + ) is contained in T + âŠ—R+ tâˆ’m OAcris (S, S + ). By taking GU invariants and using the fact that R+ is noetherian, we are reduced to showing
that Râ€² := (tâˆ’m OAcris (S, S + ))GX is of finite type over R+ . From the construction, Râ€² is p-adically separated and R+ âŠ‚ Râ€² âŠ‚ R = (OBcris (S, S + ))GX . As R+
is normal, we deduce pN Râ€² âŠ‚ R+ for some N âˆˆ N. Thus pN Râ€² and hence Râ€² are
of finite type over R+ . As a result, (D+ , âˆ‡, Ïˆ) defines an F -crystal D+ on U0 /Ok .
As D = D+ [1/p] and âˆ‡ = âˆ‡+ [1/p], the connection âˆ‡ on Dcris (L) is convergent;
this is standard and we refer to [Ber96, 2.4.1] for detail. Consequently, the triple
(Dcris (L), âˆ‡, Ï•) is an F -isocrystal on X0 /Ok , which is isomorphic to D+,an (n). This
finishes the proof in the special case.
S
In the general case, consider a covering X = i Ui of X by connected small
affine open subsets such that each Ui admits a lifting of Frobenius Ïƒi and an eÌtale
morphism to some torus over Ok . By the special case, we have seen that each
Fili Dcris (L) âŠ‚ Dcris (L) is locally a direct summand, and that the connection on

Crystalline comparison isomorphism in p-adic Hodge theory

31

Dcris (L) is convergent ([Ber96, 2.2.8]). Furthermore, each Dcris (L)|Ui is equipped
with a Frobenius Ï•i , and over Ui âˆ© Uj , the two Frobenii Ï•i , Ï•j on Dcris (L)|Ui T Uj
are related by the formula in Lemma 3.7 as it is the case for Ï•i , Ï•j on OBcris |Ui T Uj
(Lemma 2.20). So these local Frobenii glue together to give a compatible system of
Frobenii Ï• on Dcris (L) and the analytification of the quadruple (Dcris (L), Filâ€¢ Dcris (L), âˆ‡, Ï•)
is a filtered F -isocrystal on X0 /Ok , as wanted.

b p -sheaf L on X is associated to a filtered F Proof of Proposition 3.14. If a lisse Z
isocrystal E on X, then we just have to show E â‰ƒ Dcris (L). By assumption, we have
ur OBcris . Then
L âŠ—Zbp OBcris â‰ƒ wâˆ’1 E âŠ—OX
ur OBcris ) â‰ƒ E âŠ—
wâˆ— (L âŠ—Zbp OBcris ) â‰ƒ wâˆ— (wâˆ’1 E âŠ—OX
OXeÌt [1/p] wâˆ— OBcris â‰ƒ E

where the second isomorphism has used Remark 3.12, and the last isomorphism is
by the isomorphism wâˆ— OBcris â‰ƒ OXeÌt [1/p] from Corollary 2.23.
b p -sheaf verifying the two conditions of our propoConversely, let L be a lisse Z
sition. By Lemma 3.18, Dcris (L) is naturally a filtered F -isocrystal. To finish the
proof, we need to show that the isomorphism in (2) is compatible with the extra
structures. Only the compatibility with filtrations needs verification. This is a
local question, hence we shall assume X = Spf(R+ ) is a small connected affine
formal scheme. As Fili Dcris (L) is coherent over OX [1/p] and is a direct summand
of Dcris (L), the same proof as that of Corollary 3.16 gives
âˆ¼

j
ur Fil OBcris )(V )
Fili Dcris (L)(X ) âŠ—R Filj OBcris (V ) âˆ’â†’ (wâˆ’1 Fili Dcris (L) âŠ—OX

for any V âˆˆ XproeÌt . Consequently, the isomorphism in Corollary 3.16 is strictly
compatible with filtrations on both sides. Thus, we reduce to show that, for any affiâˆ¼
noid perfectoid V âˆˆ XproeÌt /X univ , the isomorphism Dcris (VX (L)) âŠ—R OBcris (V ) â†’
VX (L) âŠ— OBcris (V ) is strictly compatible with the filtrations, or equivalently, the
induced morphisms between the graded quotients are isomorphisms:

(3.2.2)
âŠ•i+j=n gri Dcris (VX (L)) âŠ—R grj OBcris (V ) âˆ’â†’ L âŠ— grn OBcris (V ).

When V = X univ , this follows from [Bri, 8.4.3]. For the general case, write
\
univ = Spa(S, S + ) and V
b = Spa(S1 , S + ). Then by [Sch13, Corollary 6.15] and
X
1
Corollary 2.22, we have grj OBcris (V ) â‰ƒ S1 Î¾ j [U1 /Î¾, . . . , Ud /Î¾]. So the natural morâˆ¼
phism grj OBcris (X univ ) âŠ—S S1 â†’ grj OBcris (V ) is an isomorphism. The required
isomorphism (3.2.2) for general V then follows from the special case for X univ . 
b
Let Liscris
b (X) denote the category of lisse crystalline Zp -sheaves on X, and
Z
p

Liscris
b (X) the corresponding isogeny category. The functor
Q
p

â€ 
Dcris : Liscris
b (X) âˆ’â†’ F F -Iso (X0 /Ok ),
Q
p

L 7â†’ Dcris (L)

â€ 
allows us to relate Liscris
b p (X) to the category F F -Iso (X0 /Ok ) of filtered convergent
Q
F -isocrystals on X0 /Ok , thanks to Proposition 3.14. A filtered F -isocrystal E on
X0 /Ok is called admissible if it lies in the essential image of the functor above. The
full subcategory of admissible filtered F -isocrystals on X0 /Ok will be denoted by
F F -Isoâ€  (X0 /Ok )adm .

Theorem 3.19. The functor Dcris above induces an equivalence of categories
âˆ¼

â€ 
adm
Dcris : Liscris
.
b (X) âˆ’â†’ F F -Iso (X0 /Ok )
Q
p

32

FUCHENG TAN, JILONG TONG

A quasi-inverse of Dcris is given by
âˆ‡=0,Ï•=1
ur OBcris )
Vcris : E 7â†’ Fil0 (wâˆ’1 E âŠ—OX

where Ï• denotes the compatible system of Frobenii on E as before.
Proof. Observe first that, for E a filtered convergent F -isocrystal, the local Frobenii
on E âˆ‡=0 glue to give a unique Ïƒ-semilinear morphism on E âˆ‡=0 (Lemma 3.7). In
particular, the abelian sheaf Vcris (E) is well-defined. Assume moreover E is admissib p -sheaf such that E â‰ƒ Dcris (L). So L and E are associated
ble, and let L be a lisse Z
ur OBcris , and we find
by Proposition 3.14. Hence L âŠ—Zbp OBcris â‰ƒ wâˆ’1 E âŠ—OX
bp
L âŠ—Zbp Q

âˆ¼

âˆ’â†’ L âŠ—Zbp Fil0 (OBcris )âˆ‡=0,Ï•=1
âˆ¼

âˆ’â†’ Fil0 (L âŠ—Zbp OBcris )âˆ‡=0,Ï•=1
âˆ¼

âˆ‡=0,Ï•=1
ur OBcris )
âˆ’â†’ Fil0 (wâˆ’1 E âŠ—OX

=

Vcris (E),

where the first isomorphism following from the the fundamental exact sequence (by
Lemma 2.5 and [Bri, Corollary 6.2.19])
1âˆ’Ï•

0 âˆ’â†’ Qp âˆ’â†’ Fil0 Bcris âˆ’â†’ Bcris âˆ’â†’ 0.
b p -sheaf of a lisse Z
b p -sheaf. Thus Vcris (E) âˆˆ
In particular, Vcris (E) is the associated Q
(X)
and
the
functor
V
is
well-defined.
Furthermore,
as we can recover the
Liscris
cris
cp
Q
b p -sheaf up to isogeny, it follows that Dcris is fully faithful, and a quasithe lisse Z
inverse on its essential image is given by Vcris .


Remark 3.20. Using [Bri, Theorem 8.5.2], one can show that the equivalence
above is an equivalence of tannakian category.
Next we compare Definition 3.11 with the â€œassociatednessâ€ defined in [Fal]. Let
E be a filtered convergent F -isocrystal E on X0 /Ok , and M an F -crystal on X0 /Ok
such that Man = E(âˆ’n) for some n âˆˆ N (see Remark 3.5 for the notations). Let
U = Spf(R+ ) be a small connected affine open subset of X , equipped with a lifting
+
of Frobenius Ïƒ. Write U = Spa(R, R+ ) the generic fiber of U. As before, let R
+
be the union of all finite normal R -algebras (contained in some fixed algebraic
+
closure of Frac(R+ )) which are eÌtale over R := R+ [1/p], and R := R [1/p]. Let
+
GU := Gal(R/R) and (S, S + ) the p-adic completion of (R, R ). Then (S, S + ) is
an perfectoid affinoid algebra over the p-adic completion of k. So we can consider
the period sheaf Acris (S, S + ). Moreover the composite of the following two natural
morphisms
 Î¸
can
(3.2.3)
Acris S, S + âˆ’â†’ S + âˆ’â†’ S + /pS + ,
defines a p-adic PD-thickening of Spec(S + /pS + ). Evaluate our F -crystal M at it
and write M(Acris (S, S + )) for the resulting finite type Acris (S, S + )-module. As an
element of GU defines a morphism of the PD-thickening (3.2.3) in the big crystalline site of X0 /Ok and M is a crystal, M(A(S, S + )) is endowed naturally with
an action of GU . Similarly, the Frobenius on the crystal M gives a Frobenius
Ïˆ on M(Acris (S, S + )). Set E(Bcris (S, S + )) := M(Acris (S, S + ))[1/t], which is a
Bcris (S, S + )-module of finite type endowed with a Frobenius Ï• = Ïˆ/pn and an
action of GU .

Crystalline comparison isomorphism in p-adic Hodge theory

33

On the other hand, as U is small, there exists a morphism Î± : R+ â†’ Acris (S, S + )
of Ok -algebras, whose composite with the projection Acris (S, S + ) â†’ S + is the inclusion R+ âŠ‚ S + . For example, consider an eÌtale morphism U â†’ Spf(Ok {T1Â±1 , . . . , TdÂ±1 }).
+
1/pn
) be a compatible system of pn -th roots of Ti inside R âŠ‚ S + , and Tiâ™­
Let (Ti
the corresponding element of S â™­+ := limx7â†’xp S + /pS + . Then one can take Î± as the
â†âˆ’
unique morphism of Ok -algebras R+ â†’ Acris (S, S + ) sending Ti to [Tiâ™­ ], such that
its composite with the projection Acris (S, S + ) â†’ S + /pS + is just the natural map
R+ â†’ S + /pS + (such a morphism exists as R+ is eÌtale over Ok {T1Â±1, . . . , TdÂ±1 }
and because of (3.2.3); see the proof of Lemma 2.13 for a similar situation). Now
we fix such a morphism Î±. So we obtain a morphism of PD-thickenings from
U0 Ö’â†’ U to the one defined by (3.2.3). Consequently we get a natural isomorphism
M(Acris (S, S + )) â‰ƒ M(U) âŠ—R+ ,Î± Acris (S, S + ), whence
E(Bcris (S, S + )) â‰ƒ E(U) âŠ—R,Î± Bcris (S, S + ).
Using this isomorphism, we define the filtration on E(Bcris (S, S + )) as the tensor
product of the filtration on E(U) and that on Bcris (S, S + ).
Remark 3.21. It is well known that the filtration on E(Bcris (S, S + )) does not
depend on the choice of Î±. More precisely, let Î±â€² be a second morphism R+ â†’
Acris (S, S + ) of Ok -algebras whose composite with Acris (S, S + ) â†’ S + is the inclusion R+ âŠ‚ S + . Fix an eÌtale morphism U â†’ Spf(Ok {T1Â±1 , . . . , TdÂ±1 }). Denote
Î² = (Î±, Î±â€² ) : R+ âŠ—Ok R+ â†’ Acris (S, S + ) and by the same notation the corresponding map on schemes, and write p1 , p2 : Spec R+ Ã— Spec R+ â†’ Spec R+ the two
âˆ¼
projections. We have a canonical isomorphism (p2 â—¦ Î²)âˆ— E âˆ’
â†’ (p1 â—¦ Î²)âˆ— E, as E is
a crystal. In terms of the connection âˆ‡ on E, this gives (cf. [Ber96, 2.2.4]) the
following Bcris (S, S + )-linear isomorphism
Î· : E(U) âŠ—R,Î± Bcris (S, S + ) âˆ’â†’ E(U) âŠ—R,Î±â€² Bcris (S, S + )
P
sending e âŠ— 1 to nâˆˆNd N n (e) âŠ— (Î±(T ) âˆ’ Î±â€² (T ))[n] , with N the endomorphism of
E such that âˆ‡ = N âŠ— dT . Here we use the multi-index to simplify the notations,
and note that Î±(Ti ) âˆ’ Î±â€² (Ti ) âˆˆ Fil1 Acris (S, S + ) hence the divided power (Î±(Ti ) âˆ’
Î±â€² (Ti ))[ni ] is well-defined. Moreover, the series converge since the connection on
M is quasi-nilpotent. Now as the filtration on E satisfies Griffiths transversality,
the isomorphism Î· is compatible with the tensor product filtrations on both sides.
Since the inverse Î· âˆ’1 can be described by a similar formula (one just switches Î±
and Î±â€² ), it is also compatible with filtrations on both sides. Hence the isomorphism
Î· is strictly compatible with the filtrations, and the filtration on E(Bcris (S, S + ))
does not depend on the choice of Î±.
b p -sheaf on X, and write as before VU (L) the Zp -representation of
Let L be a lisse Z
GU corresponding to the lisse sheaf L|U . Following [Fal], we say a filtered convergent
F -isocrystal E is associated to L in the sense of Faltings if, for all small open subset
U âŠ‚ X , there is a functorial isomorphism:

 âˆ¼
(3.2.4)
E Bcris S, S + âˆ’â†’ VU (L) âŠ—Qp Bcris S, S +
which is compatible with filtration, GU -action and Frobenius.

Proposition 3.22. Keep the notation above. If E is associated to L in the sense
of Faltings then L is crystalline (not necessarily associated to E) and there is an
isomorphism Dcris (L) â‰ƒ E compatible with filtration and Frobenius. Conversely,

34

FUCHENG TAN, JILONG TONG

if L is crystalline and if there is an isomorphism Dcris (L) â‰ƒ E of OX an -modules
compatible with filtration and Frobenius, then L and E are associated in the sense
of Faltings.
Before giving the proof of Proposition 3.22, we observe first the following commutative diagram in which the left vertical morphisms are all PD-morphisms:
/ R+ /pR+ .

R+
can


OAcris (S, S + )
O

Î¸R


/ S + /pS +

can

Acris (S, S + )

Î¸

/ S + /pS +

Therefore, we have isomorphisms

 âˆ¼
âˆ’â†’ M OAcris S, S +
M(U) âŠ—R+ OAcris S, S +


âˆ¼
â†âˆ’ M Acris S, S + âŠ—Acris (S,S + ) OAcris S, S + ,

where the second term in the first row denotes the evaluation of the crystal M at
the PD-thickening defined by the PD-morphism Î¸R in the commutative diagram
above. Inverting t, we obtain a natural isomorphism


 âˆ¼
(3.2.5)
E(U) âŠ—R OBcris S, S + âˆ’â†’ E Bcris S, S + âŠ— OBcris S, S + ,
where the last tensor product is taken over Bcris (S, S + ). This isomorphism is clearly
compatible with Galois action and Frobenius. By a similar argument as in Remark
3.21 one checks that (3.2.5) is also strictly compatible with the filtrations. Furthermore, using the identification


âˆ¼
Acris S, S + {hu1 , . . . , ud i} âˆ’â†’ OAcris S, S + , ui 7â†’ Ti âŠ— 1 âˆ’ 1 âŠ— [Tiâ™­ ]
we obtain a section s of the canonical map Acris (S, S + ) â†’ OAcris (S, S + ):


ui 7â†’ 0
s : OAcris S, S + â†’ Acris S, S +

which is again a PD-morphism. Composing with the inclusion R+ âŠ‚ OAcris (S, S + ),
we get a morphism Î±0 : R+ â†’ Acris (S, S + ) whose composite with the projection
Acris (S, S + ) â†’ S + is the inclusion R+ âŠ‚ S + .
Proof of Proposition 3.22. Now assume that E is associated with L in the sense
of [Fal]. Extending scalars to OBcris (S, S + ) of the isomorphism (3.2.4) and using the identification (3.2.5), we obtain a functorial isomorphism, compatible with
filtration, GU -action, and Frobenius:

 âˆ¼
VU (L) âŠ—Zp OBcris S, S + âˆ’â†’ E(U) âŠ—R OBcris S, S + .

Therefore, VU (L)âŠ—Zp Qp is a crystalline GU -representation (Corollary 3.17), and we
âˆ¼
get by Lemma 3.15 an isomorphism E(U) âˆ’
â†’ Dcris (L)(U) compatible with filtrations
and Frobenius. As such small open subsets U form a basis for the Zariski topology of
âˆ¼
X , we find an isomorphism E âˆ’
â†’ Dcris (L) compatible with filtrations and Frobenius,
and that L is crystalline in the sense of Definition 3.11 (Corollary 3.17).

Crystalline comparison isomorphism in p-adic Hodge theory

35

Conversely, assume L is crystalline with Dcris (L) âˆ¼
= E compatible with filtrations
and Frobenius. As in the proof of Corollary 3.17, we have a functorial isomorphism

 âˆ¼
E(U) âŠ—R OBcris S, S + âˆ’â†’ VU (L) âŠ—Zp OBcris S, S +

which is compatible with filtration, Galois action and Frobenius. Pulling it back
via the section OBcris (S, S + ) â†’ Bcris (S, S + ) obtained from s by inverting p, we
obtain a functorial isomorphism
âˆ¼

E(Bcris (S, S + )) â‰ƒ E(U) âŠ—R,Î±0 Bcris (S, S + ) âˆ’â†’ VU (L) âŠ—Zp Bcris (S, S + ),
which is again compatible with Galois action, Frobenius and filtrations. Therefore
L and E are associated in the sense of Faltings.

Finally we compare Definition 3.11 with its de Rham analogue considered in
[Sch13].
b p -sheaf on X and E a filtered convergent F Proposition 3.23. Let L be a lisse Z
isocrystal on X0 /Ok . Assume that L and E are associated as defined in Definition
3.11, then L is a de Rham in the sense of [Sch13, Definition 8.3] . More precisely,
if we view E as a filtered module with integrable connection on X (namely we forget
the Frobenius), there exists a natural filtered isomorphism that is compatible with
connections:
L âŠ—Zbp OBdR âˆ’â†’ E âŠ—OX OBdR
Proof. Let U = Spf(R+ ) âŠ‚ X be a connected affine open subset, and denote U
(resp. U univ ) the generic fiber of U (resp. the universal eÌtale cover of U ). Let V
be a affinoid perfectoid lying above U univ . As L and E are associated, there exits a
filtered isomorphism compatible with connections and Frobenius
âˆ¼

ur OBcris .
L âŠ—Zbp OBcris âˆ’â†’ wâˆ’1 E âŠ—OX

Evaluate this isomorphism at V âˆˆ XproeÌt and use the fact that the R-module E(U)
is projective (here R := R+ [1/p]), we deduce a filtered isomorphism compatible
with all extra structures:
âˆ¼

VU (L) âŠ—Zp OBcris (V ) âˆ’â†’ E(U ) âŠ—R OBcris (V ).
Taking tensor product âˆ’ âŠ—OBcris (V ) OBdR (V ) on both sides, we get a filtered isomorphism compatible with connection:
âˆ¼

VU (L) âŠ—Zp OBdR (V ) âˆ’â†’ E(U ) âŠ—R OBdR (V ).
Again, as E(U ) is a projective R-module and as E is coherent, the isomorphism
above can be rewritten as
âˆ¼

(L âŠ—Zbp OBdR )(V ) âˆ’â†’ (E âŠ—OX OBdR )(V ),
which is clearly functorial in U and in V . Varying U and V , we deduce that L is
de Rham, hence our proposition.


36

FUCHENG TAN, JILONG TONG

3.3. From pro-eÌtale site to eÌtale site. Let X be a smooth formal scheme over
ur+
ur
Ok . For O = OX , OX [1/p], OX
, OX
and a sheaf of O-modules F with connection,
we denote the de Rham complex of F as:
âˆ‡

âˆ‡

DR(F ) = (0 â†’ F âˆ’â†’ F âŠ—O â„¦1 âˆ’â†’ Â· Â· Â· ).
Let w be the composite of natural morphisms of topoi (here we use the same
âˆ¼
notation to denote the object in XproeÌt
represented by Xk âˆˆ XproeÌt ):
w

âˆ¼
âˆ¼
âˆ¼
XproeÌt
/Xk âˆ’â†’ XproeÌt
âˆ’â†’ XeÌt
.

The following lemma is just a global reformulation of the main results of [AB]. As
we shall prove a more general result later (Lemma 5.3), let us omit the proof here.
Lemma 3.24. Let X be smooth formal scheme over Ok . Then the natural morphism below is an isomorphism in the filtered derived category:
b Ok Bcris âˆ’â†’ Rwâˆ— (OBcris ).
OX âŠ—

b Ok Bcris := OX âŠ—
b Ok Acris [1/t] with
Here OX âŠ—
b Ok Acris := lim OX âŠ—Ok Acris /pn ,
OX âŠ—
â†âˆ’
nâˆˆN

b Ok Bcris is filtered by the subsheaves
and OX âŠ—
b Ok Filr+n Acris ),
b Ok Filr Bcris := lim tâˆ’n (OX âŠ—
OâŠ—
âˆ’â†’

r âˆˆ Z.

nâˆˆN

Corollary 3.25. Let X be a smooth formal scheme over Ok . Let L be a crystalline
b p -sheaf associated with a filtered convergent F -isocrystal E. Then there exists
lisse Z
a natural quasi-isomorphism in the filtered derived category
âˆ¼
b k Bcris .
Rw âˆ— (L âŠ—Zb Bcris ) âˆ’â†’ DR(E)âŠ—
p

If moreover X is endowed with a lifting of Frobenius Ïƒ, then the isomorphism above
is also compatible with the Frobenii deduced from Ïƒ on both sides.

Proof. Using the PoincareÌ lemma (Corollary 2.16), we get first a quasi-isomorphism
which is strictly compatible with filtrations:
âˆ¼

L âŠ— Bcris âˆ’â†’ L âŠ— DR(OBcris ) = DR(L âŠ— OBcris ).
âˆ¼

ur
As L and E are associated, there is a filtered isomorphism LâŠ— OBcris âˆ’
â†’ wâˆ’1 E âŠ—OX
OBcris compatible with connection and Frobenius, from which we get the quasiisomorphisms in the filtered derived category

(3.3.1)

âˆ¼

âˆ¼

L âŠ— Bcris âˆ’â†’ DR(L âŠ— OBcris ) âˆ’â†’ DR(wâˆ’1 E âŠ— OBcris ).

On the other hand, as Rj w âˆ— OBcris = 0 for j > 0 (Lemma 3.24), we obtain using
projection formula that Rj wâˆ— ((wâˆ’1 E âŠ— OBcris )|Xk ) = E âŠ— Rj w âˆ— OBcris = 0 (note
that E is locally a direct factor of a finite free OX [1/p]-module, hence one can apply
projection formula here). In particular, each component of DR(wâˆ’1 E âŠ— OBcris ) is
wâˆ— -acyclic. Therefore,
âˆ¼

âˆ¼

DR(E âŠ— wâˆ— OBcris ) âˆ’â†’ w âˆ— (DR(wâˆ’1 E âŠ— OBcris )) âˆ’â†’ Rwâˆ— (DR(wâˆ’1 E âŠ— OBcris )).
Combining this with Lemma 3.24, we deduce the following quasi-isomorphisms in
the filtered derived category
âˆ¼
âˆ¼
b k Bcris âˆ’â†’
DR(E âŠ— wâˆ— OBcris ) âˆ’â†’ Rw âˆ— (DR(wâˆ’1 E âŠ— OBcris )).
(3.3.2) DR(E)âŠ—

Crystalline comparison isomorphism in p-adic Hodge theory

37

The desired quasi-isomorphism follows from (3.3.1) and (3.3.2). When furthermore X admits a lifting of Frobenius Ïƒ, one checks easily that both quasiisomorphisms are compatible with Frobenius, hence the last part of our corollary.

Remark 3.26. Recall that Gk denotes the absolute Galois group of k. Each
element of Gk defines a morphism of Uk in the pro-eÌtale site XproeÌt for any U âˆˆ
XproeÌt with U := Uk . Therefore, the object Rwâˆ— (L âŠ— Bcris ) comes with a natural
Galois action of Gk . With this Galois action, one checks that the quasi-isomorphism
in Corollary 3.25 is also Galois equivariant.
Let E be a filtered convergent F -isocrystal on X0 /Ok , and M an F -crystal on
X0 /Ok (viewed as a coherent OX -module equipped with an integrable connection)
such that E â‰ƒ Man (n) for some n âˆˆ N (Remark 3.5). The crystalline cohomology
i
group Hcris
(X0 /Ok , M) is an Ok -module of finite type endowed with a Frobenius
Ïˆ. In the following, the crystalline cohomology (or more appropriately, the rigid
cohomology) of the convergent F -isocrystal E is defined as
i
i
Hcris
(X0 /Ok , E) := Hcris
(X0 /Ok , M)[1/p].

It is a finite dimensional k-vector space equipped with the Frobenius Ïˆ/pn . Moreover, let u = uX0 /Ok be the following morphism of topoi
âˆ¼
(X0 /Ok )âˆ¼
cris âˆ’â†’ XeÌt

such that uâˆ— (F )(U) = H 0 ((U0 /Ok )âˆ¼
cris , F ) for U âˆˆ XeÌt . With the eÌtale topology
replaced by the Zariski topology, this is precisely the morphism uX0 /SÌ‚ (with SÌ‚ =
Spf(Ok )) considered in [BO, Theorem 7.23]. By loc.cit., there exists a natural
quasi-isomorphism in the derived category
(3.3.3)

âˆ¼

Ruâˆ— M âˆ’â†’ DR(M),
âˆ¼

i
which induces a natural isomorphism Hcris
(X0 /Ok , M) âˆ’
â†’ Hi (X , DR(M)). Thereby

(3.3.4)

âˆ¼

i
Hcris
(X0 /Ok , E) âˆ’â†’ Hi (X , DR(E)).

On the other hand, the de Rham complex DR(E) of E is filtered by its subcomplexes
âˆ‡

âˆ‡

Filr DR(E) := (Filr E âˆ’â†’ Filrâˆ’1 E âŠ— â„¦1X/k âˆ’â†’ . . .).
So the hypercohomology Hi (X , DR(E)) has a descending filtration given by

Filr Hi (X , DR(E)) := Im Hi (X , Filr DR(E)) âˆ’â†’ Hi (X , DR(E)) .

i
Consequently, through the isomorphism (3.3.4), the k-space Hcris
(X0 /Ok , E) is endowed naturally with a decreasing filtration.

Theorem 3.27. Assume further that the smooth formal scheme X is proper over
b p -sheaf
Ok . Let E be a filtered convergent F -isocrystal on X0 /Ok and L a lisse Z
on XproeÌt . Assume that E and L are associated. Then there is a natural filtered
isomorphism of Bcris -modules
(3.3.5)

âˆ¼

i
H i (Xk,proeÌt , L âŠ—Zbp Bcris ) âˆ’â†’ Hcris
(X0 /Ok , E) âŠ—k Bcris

which is compatible with Frobenius and Galois action.

38

FUCHENG TAN, JILONG TONG

Proof. By Corollary 3.25, we have the natural Galois equivariant quasi-isomorphism
in the filtered derived category:
âˆ¼
b k Bcris ).
RÎ“(Xk,proeÌt , L âŠ— Bcris ) = RÎ“(X , Rw âˆ— (L âŠ— Bcris )) âˆ’â†’ RÎ“(X , DR(E)âŠ—

We first claim that the following natural morphism in the filtered derived category
is an isomorphism:
b Ok Acris ).
RÎ“(X , DR(E)) âŠ—Ok Acris âˆ’â†’ RÎ“(XeÌt , DR(E)âŠ—

Indeed, as Acris is flat over Ok , the morphism above is an isomorphism respecting
the filtrations in the derived category. Thus to prove our claim, it suffices to check
that the morphism above induces quasi-isomorphisms on gradeds. Further filtering
the de Rham complex by its naive filtration, we are reduced to checking the following
isomorphism for A a coherent OX -module:
âˆ¼
b Ok OCp ) ,
RÎ“(X , A) âŠ—Ok OCp âˆ’â†’ RÎ“(X , AâŠ—
which holds because again OCp is flat over Ok . Consequently, inverting t we obtain
an isomorphism in the filtered derived category
b k Bcris ).
RÎ“(X , DR(E)) âŠ—k Bcris âˆ’â†’ RÎ“(XeÌt , DR(E)âŠ—

In this way, we get a Galois equivariant quasi-isomorphism in the filtered derived
category
âˆ¼
RÎ“(Xk,proeÌt , L âŠ— Bcris ) âˆ’â†’ RÎ“(X , DR(E)) âŠ—k Bcris .

Combining it with (3.3.4), we obtain the isomorphism (3.3.5) verifying the required
properties except for the Frobenius compatibility.
To check the Frobenius compatibility, we only need to check that the restriction
i
i
to Hcris
(X0 /Ok , E) Ö’â†’ Hcris
(X0 /Ok , E)âŠ—k Bcris of the inverse of (3.3.5) is Frobeniuscompatible. Let M be an F -crystal on X0 /Ok such that E = Man (n). Via the
i
i
identification Hcris
(X0 /Ok , E) = Hcris
(X0 /Ok , M)[1/p], the restriction map in question is induced from the following composite of morphisms at the level of derived
category:
âˆ¼
âˆ¼
b Ok Bcris â‰ƒ DR(E)âŠ—
b k Bcris âˆ’â†’
Rwâˆ— (L âŠ— Bcris ),
Ruâˆ— M âˆ’â†’ DR(M) âˆ’â†’ DR(M)âŠ—

where the first quasi-isomorphism is (3.3.3), and the last morphism is just the
inverse in the derived category of the quasi-isomorphism in Corollary 3.25. Let us
denote by Î¸ the composite of these morphisms. Let Ïˆ (resp. Ï•) be the induced
Frobenius on Ruâˆ— M (resp. on Rwâˆ— (LâŠ—Bcris )). One only needs to check that Ï•â—¦Î¸ =
1
pn Î¸ â—¦ Ïˆ. This can be checked locally on X . So let U âŠ‚ X be a small open subset
equipped with a lifting of Frobenius Ïƒ. Thus M|U (resp. E|U ) admits naturally
a Frobenius, which we denote by ÏˆU (resp. Ï•U ). Then all the morphisms above
except for the identification in the middle are Frobenius-compatible (see Corollary
3.25 for the last quasi-isomorphism). But by definition, under the identification
M[1/p]|U â‰ƒ E|U , the Frobenius Ï•U on E corresponds exactly to ÏˆU /pn on M[1/p].
This gives the desired equality Ï• â—¦ Î¸ = p1n Î¸ â—¦ Ïˆ on U, from which the Frobenius
compatibility in (3.3.5) follows.


Crystalline comparison isomorphism in p-adic Hodge theory

39

4. Primitive comparison on the pro-eÌtale site
Let X be a proper smooth formal scheme over Ok , with X (resp. X0 ) its generic
b p -sheaf on XproeÌt . In this section, we will con(resp. closed) fiber. Let L be a lisse Z
b p -sheaf L on the pro-eÌtale
struct a primitive comparison isomorphism for any lisse Z
site XproeÌt (Theorem 4.3). In particular, this primitive comparison isomorphism
b p -sheaves, which may lead to interesting arithalso holds for non-crystalline lisse Z
metic applications. On the other hand, in the case that L is crystalline, such a
result and Theorem 3.27 together give rise to the crystalline comparison isomorphism between eÌtale cohomology and crystalline cohomology.
We shall begin with some preparations. The first lemma is well-known.
Lemma 4.1. Let (Fn )nâˆˆN be a projective system of abelian sheaves on a site T ,
such that Rj lim Fn = 0 whenever j > 0. Then for any object Y âˆˆ T and any i âˆˆ Z,
â†âˆ’
the following sequence is exact:
0 âˆ’â†’ R1 lim H iâˆ’1 (Y, Fn ) âˆ’â†’ H i (Y, lim Fn ) âˆ’â†’ lim H i (Y, Fn ) âˆ’â†’ 0.
â†âˆ’
â†âˆ’
â†âˆ’
Proof. Let Sh (resp. PreSh) denote the category of abelian sheaves (resp. abelian
presheaves) on T , and ShN (resp. PreShN ) the category of projective systems of
abelian sheaves (resp. of abelian presheaves) indexed by N. Let Ab denote the
category of abelian groups. Consider the functor
Ï„ : ShN âˆ’â†’ Ab,

(Gn ) 7â†’ lim Î“(Y, Gn ).
â†âˆ’
Clearly Ï„ is left exact, hence we can consider its right derived functors. Let us
compute RÏ„ (Fn ) in two different ways.
Firstly, one can write Ï„ as the composite of the following two functors
lim

âˆ’ / Sh
ShN â†

Î“(U,âˆ’)

/ Ab .

N

Since the projective limit functor lim : Sh â†’ Sh admits an exact left adjoint given
â†âˆ’
by constant projective system, it sends injectives to injectives. Thus we obtain a
spectral sequence
E2i,j = H i (Y, Rj lim Fn ) =â‡’ Ri+j Ï„ (Fn ).
â†âˆ’
By assumption, Rj lim Fn = 0 whenver j > 0. So the spectral sequence above
â†âˆ’
degenerates at E2 and we get H i (Y, lim Fn ) â‰ƒ Ri Ï„ (Fn ).
â†âˆ’
Secondly, one can equally decompose Ï„ as follows:
ShN

Î±

lim

âˆ’ / Ab ,
/ AbN â†

where the functor Î± sends (Gn ) to the projective system of abelian groups (Î“(Y, Gn )).
Let Iâ€¢ = (In ) be an injective object of ShN . By [Jan, Proposition 1.1], each component In is an injective object of Ab and the transition maps In+1 â†’ In are split
surjective. Therefore, the transition maps of the projective system Î±(Iâ€¢ ) are also
split surjective. In particular, the projective system Î±(Iâ€¢ ) is lim-acyclity. So we
â†âˆ’
can consider the following spectral sequence
E2i,j = Ri lim H j (Y, Fn ) =â‡’ Ri+j Ï„ (Fn ).
â†âˆ’
Since the category Ab satisfies the axiom (AB5*) of abelian categories (i.e., infinite
products are exact), Ri lim An = 0 (i âˆˆ
/ {0, 1}) for any projective system of abelian
â†âˆ’

40

FUCHENG TAN, JILONG TONG

groups (An )n . So the previous spectral sequence degenerates at E2 , from which we
deduce a natural short exact sequence for each i âˆˆ Z
0 âˆ’â†’ R1 lim H iâˆ’1 (Y, Fn ) âˆ’â†’ Ri Ï„ (Fn ) âˆ’â†’ lim H i (Y, Fn ) âˆ’â†’ 0.
â†âˆ’
â†âˆ’
As we have seen H i (Y, lim Fn ) â‰ƒ Ri Ï„ (Fn ), we deduce the short exact sequence as
â†âˆ’
asserted by our lemma.

i
b p -sheaf on X
Lemma 4.2. Let L be a lisse Z
k,proeÌt . Then for i âˆˆ Z, H (Xk,proeÌt , L)
/ [0, 2 dim(X)].
is a Zp -module of finite type, and H i (Xk,proeÌt , L) = 0 whenever i âˆˆ

Proof. Since all the cohomology groups below are computed in the pro-eÌtale site,
we shall omit the subscript â€œproeÌtâ€ from the notations.
Let Ltor denote the torsion subsheaf of L. Then our lemma follows from the
corresponding statements for Ltor and for L/Ltor . Therefore, we may assume either
b p . In the first case, we
L is torsion or is locally on Xk,proeÌt free of finite rank over Z
reduce immediately to the finiteness statement of Scholze (Theorem 5.1 of [Sch13]).
So it remains to consider the case when L is locally on Xk,proeÌt free of finite rank
b p . Let Ln := L/pn L. We have the tautological exact sequence
over Z
pn

0 âˆ’â†’ L âˆ’â†’ L âˆ’â†’ Ln âˆ’â†’ 0,

inducing the following short exact sequence
(4.0.6)

0 âˆ’â†’ H i (Xk , L)/pn âˆ’â†’ H i (Xk , Ln ) âˆ’â†’ H i+1 (Xk , L)[pn ] âˆ’â†’ 0.

We shall show that the following natural morphism is an isomorphism:
H i (Xk , L) âˆ’â†’ lim H i (Xk , Ln ).
â†âˆ’
Indeed, as L is locally free, using [Sch13, Proposition 8.2], we find Rj limn Ln = 0
â†âˆ’
for j > 0. Moreover, as H iâˆ’1 (Xk , Ln ) are finite Z/pn Z-modules by [Sch13, Theorem
5.1], R1 lim H iâˆ’1 (Xk , Ln ) = 0. Consequently, by Lemma 4.1, the morphism (4.0.7)
â†âˆ’
is an isomorphism.
âˆ¼
In particular, H i (Xk , L) â†’ lim H i (Xk , Ln ) is a pro-p abelian group, hence it
â†âˆ’
does not contain any element infinitely divisible by p. Thus, lim(H i (Xk , L)[pn ]) = 0
â†âˆ’
(where the transition map is multiplication by p). From the exactness of (4.0.6),
we then deduce a canonical isomorphism
 âˆ¼
lim H i (Xk , L)/pn âˆ’
â†’ lim H i (Xk , Ln ).
â†âˆ’
â†âˆ’
âˆ¼
So H i (Xk , L) âˆ’
â†’ limn H i (Xk , L)/pn . Consequently the Zp -module H i (Xk , L) is pâ†âˆ’
adically complete, and it can be generated as a Zp -module by a family of elements
whose images in H i (Xk , L)/p generate it as an Fp -vector space. Since the latter is
finite dimensional over Fp , the Zp -module H i (Xk , L) is of finite type, as desired. 
(4.0.7)

The primitive form of the comparison isomorphism on the pro-eÌtale site is as
follows.
b p -sheaf on XproeÌt . There is a canonical isomorTheorem 4.3. Let L be a lisse Z
+
phism of Bcris -modules
(4.0.8)

âˆ¼

+
H i (Xk,proeÌt , L) âŠ—Zp Bcris
âˆ’
â†’ H i (Xk,proeÌt , L âŠ—Zbp B+
cris )

compatible with Galois action, filtration and Frobenius.

Crystalline comparison isomorphism in p-adic Hodge theory

41

Proof. In the following, all the cohomologies are computed on the pro-eÌtale site,
hence we omit the subscript â€œproeÌtâ€ from the notations.
The proof begins with the almost isomorphism in [Sch13, Theorem 8.4]:
â‰ˆ

H i (Xk , L) âŠ—Zp Ainf âˆ’â†’ H i (Xk , L âŠ—Zbp Ainf ).
Therefore, setting
0
]
A
cris :=

Ainf [Xi : i âˆˆ N]
âˆ’ ai Xi+1 : i âˆˆ N)

(Xip

i+1

0
and Ag
cris :=

Ainf [Xi : i âˆˆ N]
âˆ’ ai Xi+1 : i âˆˆ N)

(Xip

p
!
with ai = (p
i !)p and using the fact that Xk is qcqs, we find the following almost
isomorphism


â‰ˆ
i
0
0
]
Xk , L âŠ—Zbp Ag
(4.0.9)
H i (Xk , L) âŠ—Zp A
cris âˆ’â†’ H
cris .

On the other hand, from the tautological short exact sequence
X0 âˆ’Î¾ ]
0
0
0
]
0 âˆ’â†’ A
cris âˆ’â†’ Acris âˆ’â†’ Acris âˆ’â†’ 0

and the fact that A0cris is flat over Zp , we deduce a short exact sequence:
X0 âˆ’Î¾
i
i
0
0
0
]
]
0 âˆ’â†’ H i (Xk , L) âŠ—Zp A
cris âˆ’â†’ H (Xk , L) âŠ—Zp Acris âˆ’â†’ H (Xk , L) âŠ—Zp Acris âˆ’â†’ 0.

As a result, together with the almost isomorphism (4.0.9), we see that the morphism




i
0
0
Î±i : H i Xk , L âŠ— Ag
Xk , L âŠ— Ag
cris âˆ’â†’ H
cris

induced by multiplication-by-(X0 âˆ’ Î¾) is almost injective for all i âˆˆ Z. Similarly,
b p , the following sequence of abelian sheaves on XproeÌt /X
since A0cris is flat over Z
k
is exact:
X0 âˆ’Î¾
0 )|
0 )|
âˆ’â†’ (L âŠ— Ag
âˆ’â†’ (L âŠ— A0 )| âˆ’â†’ 0,
0 âˆ’â†’ (L âŠ— Ag
bp
Z

cris

Xk

bp
Z

cris

Xk

cris Xk

bp
Z

giving the associated long exact sequence on the cohomology:
Î±i
0
0 ) âˆ’â†’
0 ) â†’ H i (X , L âŠ—
Â· Â· Â· â†’ H i (Xk , L âŠ—Zbp Ag
H i (Xk , L âŠ—Zbp Ag
bp Acris ) â†’ Â· Â· Â· .
cris
cris
k
Z

As the Î±i â€™s are almost injective for all i, the previous long exact sequence splits
into short almost exact sequences
Î±i
0 ) âˆ’â†’
0 ) âˆ’â†’ H i (X , L âŠ—
0 âˆ’â†’ H i (X , L âŠ— Ag
H i (X , L âŠ— Ag
A0 ) âˆ’â†’ 0.
k

bp
Z

cris

bp
Z

k

cris

bp
Z

k

cris

Thus the following natural morphism is an almost isomorphism
(4.0.10)

â‰ˆ

H i (Xk , L) âŠ—Zp A0cris âˆ’â†’ H i (Xk , L âŠ—Zbp A0cris ),

âˆ€i â‰¥ 0.

To pass to p-adic completion, we remark that, by Lemma 4.2, the Zp -module
H i (Xk , L) is of finite type and vanishes when i âˆˆ
/ [0, 2 dim X]. Let N be an integer
such that the torsion part Ltor of L and for all i the torsion parts H i (Xk , L)tor of
H i (Xk , L) are annilated by pN . For n > N an integer, we claim that the following
natural morphism has kernel and cokernel killed by p2N :
(4.0.11)

H i (Xk , L) âŠ—Zp (A0cris /pn ) âˆ’â†’ H i (Xk , L âŠ—Zbp A0cris /pn ),

or equivalently (via the isomorphism (4.0.10)), that the natural morphism below
has kernel and cokernel killed by p2N :
(4.0.12)

H i (Xk , L âŠ— A0cris )/pn âˆ’â†’ H i (Xk , L âŠ—Zbp A0cris /pn ).

42

FUCHENG TAN, JILONG TONG

To see this, consider the following tautological exact sequence
pn

L âŠ— A0cris âˆ’â†’ L âŠ— A0cris âˆ’â†’ L âŠ— A0cris /pn âˆ’â†’ 0.
pn

Let Kn := ker(LâŠ—A0cris â†’ LâŠ—A0cris ). Then Kn is isomorphic to T orZ1 p (L, A0cris /pn ) â‰ƒ
T orZ1 p (Ltor , A0cris /pn ), thus is killed by pN . Let In := pn (L âŠ— A0cris ) âŠ‚ L âŠ— A0cris . So
we have two short exact sequences:
0 âˆ’â†’ Kn âˆ’â†’ L âŠ— A0cris âˆ’â†’ In âˆ’â†’ 0,
and
0 âˆ’â†’ In âˆ’â†’ L âŠ— A0cris âˆ’â†’ L âŠ— A0cris /pn âˆ’â†’ 0.
Taking cohomology one gets exact sequences
Î³i

. . . âˆ’â†’ H i (Xk , Kn ) âˆ’â†’ H i (Xk , LâŠ—A0cris ) âˆ’â†’ H i (Xk , In ) âˆ’â†’ H i+1 (Xk , Kn ) âˆ’â†’ . . .
and
Î²i

. . . âˆ’â†’ H i (Xk , In ) âˆ’â†’ H i (Xk , L âŠ— A0cris ) âˆ’â†’ H i (Xk , L âŠ— A0cris /pn ) âˆ’â†’ . . . ,
which give rise to the exact sequence below:
H i (Xk , L âŠ— A0cris )/pn âˆ’â†’ H i (Xk , L âŠ— A0cris /pn ) âˆ’â†’ ker(Î²i+1 ) âˆ’â†’ 0,
such that the kernel of the first morphism is killed by pN . On the other hand, we
have the following commutative diagram
Î²i+1

/ H i+1 (X , L âŠ— Acris /pn ) .
k
â¥â¥â¥4
â¥
â¥
â¥
â¥â¥
Î³i+1
â¥â¥â¥â¥pn
â¥â¥â¥â¥
H i+1 (Xk , L âŠ— Acris )
H i+1 (Xk , In )
O

pn

Note that ker(H i+1 (Xk , L âŠ— A0cris ) â†’ H i+1 (Xk , L âŠ— A0cris )) is, via the almost isomorphism (4.0.10) for H i+1 , almost isomorphic to Tor1Zp (H i+1 (Xk , L)tor , A0cris /pn ),
hence is killed by pN . Moreover, coker(Î³i+1 ) is contained in H i+1 (Xk , Kn ), thus
is also killed by pN . As a result, from the commutative diagram above we deduce
that ker(Î²i+1 ) is killed by p2N , giving our claim.
Now we claim that the following canonical map
H i (Xk , L âŠ—Zbp Acris ) âˆ’â†’ lim H i (Xk , L âŠ—Zbp Acris /pn )
â†âˆ’
b p -sheaf, it is locally
is almost surjective with kernel killed by p2N . Since L is a lisse Z
b
b p /pm â€™s.
a direct sum of a finite free Zp -module and a finite product of copies of Z
j
a
n
In particular, R lim(L âŠ— Acris /p ) = 0 whenever j > 0 as the same holds for the
â†âˆ’
projective system {Aacris /pn }n (recall (2.1.11)). As a result, by the almost version
of Lemma 4.1, we dispose the following almost short exact sequence for each i:
(4.0.13)

0 âˆ’â†’ R1 lim H iâˆ’1 (Xk , LâŠ—Acris /pn ) âˆ’â†’ H i (Xk , LâŠ—Acris ) âˆ’â†’ lim H i (Xk , LâŠ—Acris /pn ) âˆ’â†’ 0
â†âˆ’
â†âˆ’
On the other hand, the morphisms (4.0.11) for all n give rise to a morphism of
projective systems whose kernel and cokernel are killed by p2N :
{H iâˆ’1 (Xk , L) âŠ—Zp (A0cris /pn )}nâ‰¥0 â†’ {H iâˆ’1 (Xk , L âŠ—Zbp A0cris /pn )}nâ‰¥0
Therefore R1 limn H iâˆ’1 (Xk , L âŠ—Zbp A0cris /pn ) is killed by p2N . This concludes the
â†âˆ’
proof of the claim.

Crystalline comparison isomorphism in p-adic Hodge theory

43

Consequently, by the following commutative digram
can

/ H i (X , L âŠ—b Aa )
H i (Xk , L) âŠ—Zp Aacris
k
Zp cris
âšâšâšâš
âšâšâšâš
âšâšâšâš
(4.0.13)
lim (4.0.11) âšâšâšâšâš
*

â†
âˆ’

lim H i (Xk , L âŠ—Zbp Acris /pn )
â†âˆ’

we deduce that the kernel and the cokernel of the horizontal canonical morphism
are killed by p4N . On inverting p, we obtain the desired isomorphism (4.0.8).
We still need to check that (4.0.8) is compatible with the extra structures.
Clearly only the strict compatibility with filtrations needs verification, and it suffices to check this on gradeds. So we reduce to showing that the natural morphism
is an isomorphism:
bX (j)).
H i (X , L) âŠ—Zp Cp (j) âˆ’â†’ H i (X , L âŠ— O
k

k

Twisting, one reduces to j = 0, which is given by the following lemma.



b p -sheaf on X
Lemma 4.4. Let L be a lisse Z
k,proeÌt . Then the following natural
morphism is an isomorphism:


â‰ˆ
bX ,
H i (Xk,proeÌt , L) âŠ—Zp Cp âˆ’â†’ H i Xk,proeÌt , L âŠ—Zbp O
b
bX is the completed structural sheaf of X
where O
k,proeÌt and Cp = k.

Proof. The proof is similar to that of the first part of Theorem 4.3. Let Ln :=
L/pn L. Using the (finite) filtration {pm Â· Ln }m of Ln and by induction on m, we
get from [Sch13, Theorem 5.1] the following natural almost isomorphisms


â‰ˆ
b+ .
H i (X , Ln ) âŠ—Zp OCp âˆ’â†’ H i X , Ln âŠ—b O
k

k

Zp

X

We need to look at the project limits (with respect to n) of both sides of the previous
morphisms. Pick N âˆˆ N such that pN kills Ltor and H i (Xk , L)tor for all i âˆˆ N. For
n â‰¥ N , there is a tautological exact sequence
pn

0 âˆ’â†’ Ltor âˆ’â†’ L âˆ’â†’ L âˆ’â†’ Ln âˆ’â†’ 0.
Splitting it into two short exact sequences and taking cohomology, we obtain exact
sequences
. . . âˆ’â†’ H i (Xk , pn L) âˆ’â†’ H i (Xk , L) âˆ’â†’ H i (Xk , Ln ) âˆ’â†’ . . .
and
. . . âˆ’â†’ H i (Xk , Ltor ) âˆ’â†’ H i (Xk , L) âˆ’â†’ H i (Xk , pn L) âˆ’â†’ . . . ,
from which we deduce the exact sequence below:
H i (Xk , L)/pn âˆ’â†’ H i (Xk , Ln ) âˆ’â†’ ker(H i+1 (Xk , pn L) âˆ’â†’ H i+1 (Xk , L)) âˆ’â†’ 0.
As in the proof of Theorem 4.3, the kernel of the first morphism in the sequence
above is killed by pN while the last abelian group is killed by p2N . Consequently,
the kernel and the cokernel of the following natural morphism are killed by p2N :
H i (Xk , L) âŠ— OCp /pn âˆ’â†’ H i (Xk , Ln ) âŠ— OCp .

44

FUCHENG TAN, JILONG TONG

Passing to projective limits, we find a natural morphism with kernel and cokernel
killed by p2N :


H i (Xk , L) âŠ— OCp â‰ƒ lim H i (Xk , L) âŠ— OCp /pn âˆ’â†’ lim H i (Xk , Ln ) âŠ— OCp ,
â†âˆ’
â†âˆ’

b+ ) are both killed by p2N .
and R1 lim H i (Xk , Ln ) âŠ— OCp â‰ƒ R1 lim H i (Xk , Ln âŠ— O
X
â†âˆ’
â†âˆ’
b p -sheaf, Rj lim(Ln âŠ— O
b+ ) = 0 for j > 0 since
On the other hand, as L is a lisse Z
X
â†âˆ’
b + /pn }n ; for this, apply [Sch13, Lemma 3.18] to Lemma 4.10
the same holds for {O
X
loc.cit.. Hence by Lemma 4.1, we deduce a short exact sequence
b+ ) âˆ’â†’ H i (X , LâŠ—O
b+ ) âˆ’â†’ lim H i (X , Ln âŠ—O
b+ ) âˆ’â†’ 0.
0 âˆ’â†’ R1 lim H iâˆ’1 (Xk , Ln âŠ—O
X
X
X
k
k
â†âˆ’
â†âˆ’
So we get the following commutative diagram
/ H i (X , L âŠ— O
b+ ).
H i (Xk , L) âŠ— OCp
X
k
â™â™â™
â™â™â™
â™â™â™
iso. up to p2N âˆ’torsion
â™â™
iso. up to p2N âˆ’torsion â™â™â™)

b+ )
lim H i (Xk , Ln âŠ— O
X
â†âˆ’

In particular, the horizontal morphism is an isomorphism up to p4N -torsions. On
inverting p, we get our lemma.

b p -sheaf on XproeÌt are
Recall that the notion of lisse Zp -sheaf on XeÌt and lisse Z
equivalent. We finally deduce the following crystalline comparison theorem:

Theorem 4.5. Let X be a proper smooth formal scheme over Ok , with X (resp.
b p -sheaf on XproeÌt . Assume
X0 ) its generic (resp. closed) fiber. Let L be a lisse Z
that L is associated to a filtered F -isocrystal E on X0 /Ok . Then there exists a
canonical isomorphism of Bcris -modules
âˆ¼

i
â†’ Hcris
(X0 /Ok , E) âŠ—Ok Bcris
H i (Xk,eÌt , L) âŠ—Zp Bcris âˆ’

compatible with Galois action, filtration and Frobenius.
Proof. This is just the composition of the isomorphisms in Themorem 3.27 and
Theorem 4.3.

5. Comparison isomorphism in the relative setting
Let f : X â†’ Y be a smooth morphism between two smooth formal schemes over
Spf(Ok ) of relative dimension d â‰¥ 0. The induced morphism between the generic
fibers will be denoted by fk : X â†’ Y . We shall denote by wX (resp. wY ) the natural
âˆ¼
âˆ¼
âˆ¼
âˆ¼
morphism of topoi XproeÌt
â†’ XeÌt
(resp. YproeÌt
â†’ YeÌt
). By abuse of notation, the
âˆ¼
âˆ¼
morphism of topoi XproeÌt â†’ YproeÌt will be still denoted by fk .
1,ur
+
ur
Let âˆ‡X/Y : OB+
cris,X â†’ OBcris,X âŠ—OX â„¦X/Y be the natural relative derivation,
âˆ— 1
where â„¦1,ur
X/Y := wX â„¦X /Y .

Proposition 5.1. (1) (Relative PoincareÌ lemma) The following sequence of proeÌtale sheaves is exact and strict with respect to the filtration giving â„¦i,ur
X/Y degree
i:
b
0 âˆ’â†’ B+
cris,X âŠ—f âˆ’1 B+
k

cris,Y

âˆ‡X/Y

âˆ‡X/Y

1,ur
+
+
ur
fkâˆ’1 OB+
cris,Y â†’ OBcris,X âˆ’â†’ OBcris,X âŠ—OX â„¦X/Y
âˆ‡X/Y

d,ur
ur
âˆ’â†’ Â· Â· Â· âˆ’â†’ OB+
cris,X âŠ—OX â„¦X/Y â†’ 0.

Crystalline comparison isomorphism in p-adic Hodge theory

45

Furthermore, the connection âˆ‡X/Y is integrable and satisfies Griffiths transversality
1,ur
iâˆ’1
ur
with respect to the filtration, i.e. âˆ‡X/Y (Fili OB+
OB+
cris,X ) âŠ‚ Fil
cris,X âŠ—OX â„¦X/Y .
(2) Suppose the Frobenius on X0 (resp. Y0 ) lifts to a Frobenius ÏƒX (resp. ÏƒY )
on the formal scheme X (resp. Y) and they commute with f . Then the induced
Frobenius Ï•X on OB+
cris,X is horizontal with respect to âˆ‡X/Y .
Proof. The proof is routine (cf. Proposition 2.12), so we omit the detail here.



For the relative version of the crystalline comparison, we shall need the following
primitive comparison in the relative setting.
Proposition 5.2. Let f : X â†’ Y be a proper smooth morphism between two smooth
b p -sheaf on XproeÌt . Suppose that Ri fkâˆ— L
formal schemes over Ok . Let L be a lisse Z
b
is a lisse Zp -sheaf on YproeÌt for all i â‰¥ 0. Then the following canonical morphism
is an isomorphism:
(5.0.14)

âˆ¼

(Ri fkâˆ— L) âŠ—Zbp B+
â†’ Ri fkâˆ— (L âŠ—Zbp B+
cris,Y âˆ’
cris,X )

which is compatible with filtration and Frobenius.
Proof. Remark first that Ri fkâˆ— L = 0 for i > 2d where d denotes the relative
dimension of f . To show this, write Lâ€² and Lâ€²â€² the Fp -local system on XproeÌt
defined by the following exact sequence
(5.0.15)

p

0 âˆ’â†’ Lâ€² âˆ’â†’ L âˆ’â†’ L âˆ’â†’ Lâ€²â€² âˆ’â†’ 0.

We claim that Ri fkâˆ— Lâ€² = Ri fkâˆ— Lâ€²â€² = 0 for i > 2d. Indeed, as Lâ€² is an Fp -local
system of finite presentation, it comes from an Fp -local system of finite presentation
on XeÌt , still denoted by Lâ€² . By [Sch13, Corollary 3.17(ii)], we are reduced to
showing that Ri fk eÌtâˆ— Lâ€² = 0 for i > 2d, which follows from [Sch13, Theorem 5.1]
and [Hub, 2.6.1] by taking fibers of Ri fk eÌtâˆ— Lâ€² at geometric points of Y . Similarly
Ri fkâˆ— Lâ€²â€² = 0 for i > 2d. Then, splitting the exact sequence (5.0.15) into two short
exact sequences as in the proof of Theorem 4.3 and applying the higher direct
image functor Rfkâˆ— , we deduce that the multiplication-by-p morphism on Ri fkâˆ— L
b p -sheaf on YproeÌt by our assumption,
is surjective for i > 2d. But Ri fkâˆ— L is a lisse Z
necessarily Ri fkâˆ— L = 0 for i > 2d. Consequently, we can choose a sufficiently large
integer N âˆˆ N such that pN kills the torsion part of L and also the torsion part of
Ri fkâˆ— L for all i âˆˆ Z.
Then, it is shown in the proof of [Sch13, Theorem 8.8 (i)], as a consequence
of the primitive comparison isomorphism in the relative setting ([Sch13, Corollary
5.11]), that the following canonical morphism is an almost isomorphism:
(5.0.16)

â‰ˆ

Ri fkâˆ— L âŠ—Zbp Ainf,Y âˆ’â†’ Ri fkâˆ— (L âŠ—Zbp Ainf,X ).

With this in hand, the proof of Theorem 4.3 applies and gives the result. Indeed,
consider the PD-envelope A0cris,X (resp. A0cris,Y ) of Ainf,X (resp. of Ainf,Y ) with
d
+
respect to the ideal ker(Î¸ : A
â†’ O
) (resp. to the ideal ker(Î¸ : A
â†’
X

inf,X

X

Y

inf,Y

d
+
0
O
Y )). Then Acris,X and Acris,Y are respectively the p-adic completions of Acris,X
and A0cris,Y . As in the proof of Theorem 4.3, we obtain from (5.0.16) the following
canonical almost isomorphism
(5.0.17)

â‰ˆ

Ri fkâˆ— L âŠ—Zbp A0cris,Y âˆ’â†’ Ri fkâˆ— (L âŠ—Zbp A0cris,X ),

46

FUCHENG TAN, JILONG TONG

from which we deduce that for each n the kernel and the cokernel of the natural
morphism below are killed by p2N :
(5.0.18)

Ri fkâˆ— L âŠ—Zbp A0cris,Y /pn âˆ’â†’ Ri fkâˆ— (L âŠ—Zbp A0cris,X /pn ).

Recall from the proof of Theorem 4.3 that Rj lim(L âŠ— Aacris,X /pn ) = 0 whenever
â†âˆ’
j > 0, hence a spectral sequence:
E2j,i = Rj lim Ri fkâˆ— (L âŠ— Aacris,X /pn ) =â‡’ Ri+j fkâˆ— (L âŠ— Aacris,X ).
â†âˆ’

i
n
b p -sheaf, Rj lim Ri fkâˆ— (L) âŠ— A0
As R fkâˆ— L is a lisse Z
= 0 for j > 0. It
cris,Y /p
â†âˆ’n
follows that Rj limn Ri fkâˆ— (L âŠ— A0cris,X /pn ) is killed by p2N for any j > 0. In
â†âˆ’
j,i
particular, p2N Â· Eâˆ
= 0 whenever j > 0. With i fixed, let H := Ri fkâˆ— (L âŠ— A0cris,X ).
From the theory of spectral sequences, we know that H is endowed with a finite
filtration
0 = F i+1 H âŠ‚ F i H âŠ‚ . . . F 1 H âŠ‚ F 0 H = H,
q
q+1
q,iâˆ’q
such that F H/F
H â‰ƒ Eâˆ
. Therefore, F 1 H is killed by p2N i . On the other
0,i
hand, E2 has a filtration of length i
0,i
0,i
0,i
Eâˆ
= E2+i
âŠ‚ E2+(iâˆ’1)
âŠ‚ . . . âŠ‚ E20,i = lim Ri fkâˆ— (L âŠ— Acris,X /pn ).
â†âˆ’
0,i
0,i
r,iâˆ’r+1
Since in general Er+1 = ker(dr : Er â†’ Er
), it follows that all the successive
0,i
quotients of the filtration above are killed by p2N . So the inclusion Eâˆ
âŠ‚ E20,i has
2N i
cokernel killed by p . To summarize, we have a commutative diagram

/ E 0,i = lim Ri fkâˆ— (L âŠ— Acris,X /pn )
2
â†âˆ’
4
âœâœâœâœ
âœ
âœ
âœ
2N i
âœ
âœ
âœ
kernel killed by p
âœâœâœ
 
âœâœcokernel
killed by p2N i
âœâœâœâœ
'
âœ
âœ
0,i
Eâˆ
Ri fkâˆ— (L âŠ— Acris,X )

Hence the natural morphism
Ri fkâˆ— (L âŠ— Aacris,X ) Ö‰ lim Ri fkâˆ— (L âŠ— Aacris,X /pn )
â†âˆ’
has kernel and cokernel killed by p2N i . Therefore we deduce like in the proof of
Theorem 4.3 that the kernel and the cokernel of the following canonical morphism
are killed by p2N +2N i :

(5.0.19)

(5.0.20)

Ri fkâˆ— L âŠ—Zbp Acris,Y âˆ’â†’ Ri fkâˆ— (L âŠ—Zbp Acris,X ).

Inverting p in the above morphism, we obtain the desired isomorphism of our
lemma.
It remains to verify the compatibility of the isomorphism (5.0.14) with the extra
structures. It clearly respects Frobenius structures. To check the (strict) compatibility with respect to filtrations, by taking grading quotients, we just need to show
that for each r âˆˆ N, the following natural morphism
bY (r) âˆ’â†’ Rfkâˆ— (L âŠ— O
bX (r))
Rfkâˆ— L âŠ— O

is an isomorphism: it is a local question, hence it suffices to show this after restrictbX |X and O
bY (r)|Y â‰ƒ O
bY |Y , we
bX (r)|X â‰ƒ O
ing the latter morphism to Yk . As O
k
k
k
k
then reduce to the case where r = 0. The proof of the latter statement is similar
to that of Lemma 4.4, so we omit the details here.


Crystalline comparison isomorphism in p-adic Hodge theory

47

For a sheaf of OX -modules F with an OY -linear connection âˆ‡ : F â†’ F âŠ— â„¦1X /Y ,
we denote the de Rham complex of F as:
âˆ‡

âˆ‡

DRX/Y (F ) := (. . . âˆ’â†’ 0 âˆ’â†’ F âˆ’â†’ F âŠ—OY â„¦1X /Y âˆ’â†’ . . .).
un
The same rule applies if we consider an OX
-module endowed with an OYun -linear
connection etc.
In the lemma below, assume Y = Spf(A) is affine and is eÌtale over a torus
1/pn
S = Spf(Ok {S1Â±1 , . . . , SÎ´Â±1 }). For each 1 â‰¤ j â‰¤ Î´, let (Sj )nâˆˆN be a compatible
family of p-power roots of Sj . As in Proposition 2.12, set



Â±1/pn
Â±1/pn
Â±1/pn
Â±1/pn
, . . . , SÎ´
}
, . . . , SÎ´
}, Ok {S1
âˆˆ YproeÌt .
Ye := Y Ã—Sk Spa k{S1
nâˆˆN

Lemma 5.3. Let V âˆˆ YproeÌt be an affinoid perfectoid which is pro-eÌtale over Yek ,
with Vb = Spa(R, R+ ). Let wV be the composite of natural morphisms of topoi
w

âˆ¼
âˆ¼
âˆ¼
wV : XproeÌt
/XV âˆ’â†’ XproeÌt
âˆ’â†’ XeÌt
.

Then
(1) for any j > 0 and r âˆˆ Z, Rj wV âˆ— OBcris = Rj wV âˆ— (Filr OBcris ) = 0; and
(2) the natural morphisms
b A OBcris,Y (V ) âˆ’â†’ wV âˆ— (OBcris,X )
OX âŠ—

and

b A Filr OBcris,Y (V ) â†’ wV âˆ— (Filr OBcris,X ) for all r âˆˆ Z
OX âŠ—

b A OBcris,Y (V ) := OX âŠ—
b A OAcris,Y (V ) [1/t] with
are isomorphisms. Here OX âŠ—
and

b A OAcris,Y (V ) := lim (OX âŠ—A OAcris,Y (V )/pn ) ,
OX âŠ—
â†âˆ’


b A Filr+n OAcris,Y (V ) .
b A Filr OBcris,Y (V ) := lim tâˆ’n OX âŠ—
OX âŠ—
âˆ’â†’
nâˆˆN

b A OBcris,Y (V ) using {OX âŠ—
b A Filr OBcris,Y (V )}râˆˆZ ,
In particular, if we filter OX âŠ—
the natural morphism
b A OBcris,Y (V ) âˆ’â†’ RwV âˆ— (OBcris,X )
OX âŠ—

is an isomorphism in the filtered derived category.

Proof. (1) Recall that for j â‰¥ 0, Rj wV âˆ— OBcris,X is the associated sheaf on XeÌt of
the presheaf sending U âˆˆ XeÌt to H i (UV , OBcris,X ), where UV := Uk Ã—X XV . Now we
take U = Spf(B) âˆˆ XeÌt to be affine such that the composition of U â†’ X together
with f : X â†’ Y can be factored as
U âˆ’â†’ T âˆ’â†’ Y,
where the first morphism is eÌtale and that T = Spf(A{T1Â±1 , . . . , TdÂ±1 }) is a ddimensional torus over Y. Write TV = Tk Ã—Y V . Then TV = Spa(S, S + ) with
e Se+ ). For each
S + = R{T1Â±1, . . . , TdÂ±1 } and S = S + [1/p]. Write also UV = Spa(S,
n
1/p
)nâˆˆN be a compatible family of p-power root of Ti , and set
1 â‰¤ i â‰¤ d, let (Ti
Â±1/pâˆ

+
Sâˆ
= R+ {T1

Â±1/pâˆ

, . . . , Td

},

+
+
b A{T Â±1 ,...,T Â±1 } Sâˆ
Seâˆ
:= B âŠ—
,
1

d

+
+
+
) and (Seâˆ , Seâˆ
) are two affinoid
[1/p]. Then (Sâˆ , Sâˆ
Sâˆ :=
and Seâˆ = Seâˆ
b
f
perfectoid algebras over (k, Ob ). Let Uf
âˆˆ
X
(resp.
T
âˆˆ
Tk proeÌt ) be the
V
proeÌt
V
+
Sâˆ
[1/p]

k

48

FUCHENG TAN, JILONG TONG

+
+
affinoid perfectoid corresponding to (Seâˆ , Seâˆ
) (resp. to (Sâˆ , Sâˆ
)). So we have the
following commutative diagram of ringed spaces

c
e e+
Uf
V = Spf(Sâˆ , Sâˆ )

Î“


c
+
Tf
V = Spa(Sâˆ , Sâˆ )

e e+
/ Uc
V = Spa(S, S )

/ U = Spf(B) .


/ Tc
=
Spa(S,
S+)
V

Vb = Spa(R, R+ )


/T


/ Y = Spf(A)

The morphism Uf
V â†’ UV is a profinite Galois cover, with Galois group Î“ isomorphic
to Zp (1)d .
q
q
f
f
For q âˆˆ N, let Uf
V be the (q + 1)-fold fiber product of UV over UV . So UV â‰ƒ
q
q
j f
a
Uf
V Ã— Î“ is affinoid perfectoid. In particular, for j > 0, H (UV , OAcris,X ) = 0
(Lemma 2.5) and



 q
q
f
Î“
,
OA
(
U
)
.
=
Hom
,
OA
(5.0.21)
H 0 Uf
cris,X
V
cont
V
cris,X

Consequently, the Cartan-Leray spectral sequence associated with the cover Uf
V â†’
UV almost degenerates at E2 :

 q
q+j
(UV , OAcris,X ),
E1q,j = H j Uf
,
OA
V
cris,X =â‡’ H

giving an almost isomorphism E2q,0 â‰ˆ H q (UV , OAcris,X ) for each q âˆˆ Z. Using
(5.0.21), we see that E2q,0 is the continuous group cohomology H q (Î“, OAcris,X (Uf
V )).
+
e
e
On the other hand, OAcris,X (Uf
)
â‰ˆ
OA
(
S
,
S
)
by
Lemma
2.17,
so
V
cris âˆ
âˆ
H q (UV , OBcris,X )

â‰ƒ H q (UV , OAcris,X )[1/t]
â‰ƒ H q (Î“, OAcris,X (Uf
V ))[1/t]

+
â‰ƒ H q (Î“, OAcris (Seâˆ , Seâˆ
))[1/t].

+
By definition, the last cohomology group is precisely H q (Î“, OBcris (Seâˆ , Seâˆ
)) comq
puted in Â§6. Namely, from Theorem 6.12 we deduce H (UV , OBcris,X ) = 0 whenever
q > 0, and that the natural morphism
+
b A OBcris (V ) = B âŠ—
b A OBcris (R, R+ ) âˆ’â†’ H 0 (Î“, OBcris (Seâˆ , Seâˆ
OX (U)âŠ—
)) = H 0 (UV , OBcris,X )

is an isomorphism. Varying U in XeÌt and passing to associated sheaf, we obtain
âˆ¼
e A OBcris,Y (V ) âˆ’â†’
OX âŠ—
wV âˆ— OBcris,X ,

e A OBcris,Y (V ) is the associated sheaf of the presheaf over
where by definition, OX âŠ—
b A OBcris (V ).
XeÌt sending U âˆˆ XeÌt to OX (U)âŠ—
To concludes the proof of (1) it remains to check that the canonical morphism
below is an isomorhpism:
e A OBcris,Y (V ) âˆ’â†’ OX âŠ—
b A OBcris,Y (V ).
(5.0.22)
OX âŠ—

Crystalline comparison isomorphism in p-adic Hodge theory

49

Indeed, using wV âˆ— OAcris,X = lim wV âˆ— (OAcris,X /pn ) and Proposition 6.11, we deâ†âˆ’
duce a natural morphism which is injective with cokernel killed by (1 âˆ’ [Ç«])2d :
b A OAcris,Y (V ) âˆ’â†’ wV âˆ— OAcris,X .
OX âŠ—
Therefore inverting t, we get an isomorphism
âˆ¼
b A OBcris,Y (V ) âˆ’â†’
OX âŠ—
wV âˆ— OBcris,X ,

from which the desired isomorphism (5.0.22) follows, since the objects on both sides
of loc. cit. are isomorphic in a natural way to wV âˆ— (OBcris,X ).
e A Filr OAcris,Y (V ) and OX âŠ—
e A grr OAcris,Y (V ) in the
(2) For r âˆˆ Z, define OX âŠ—
e A Bcris,Y (V ). Like the proof above, we have the natural
same way as is done for OX âŠ—
isomorphism below
âˆ¼
e A Filr OBcris,Y (V ) âˆ’â†’
OX âŠ—
wV âˆ— Filr OBcris,X ,

and we need to check that the following canonical morphism is an isomorphism:
e A Filr OBcris,Y (V ) âˆ’â†’ OX âŠ—
b A Filr OBcris,Y (V ).
OX âŠ—

To see this, remark first that the morphism above is injective since both sides of the
e A OBcris,Y (V ) â‰ƒ OX âŠ—
b A OBcris,Y .
morphism above are naturally subsheaves of OX âŠ—
For the surjectivity, by taking the graded quotients, we are reduced to showing that
the natural morphism below is an isomorphism:
e A grr OBcris,Y (V ) âˆ’â†’ OX âŠ—
b A grr OBcris,Y (V ).
(5.0.23)
OX âŠ—

But grr OAcris,Y (V ) â‰ˆ grr OAcris (R, R+ ), while the latter is a free module over R+ .
Furthermore R+ is almost flat over A by the almost purity theorem (recall that V
k, Ob )). So, for U âˆˆ XeÌt
is pro-eÌtale over Ye which is an affinoid perfectoid over (b
k

an affine formal scheme,

k


 
b A R+ = lim (OX (U)/pn ) âŠ—A R+ â‰ˆ lim (OX /pn ) âŠ—A R+ (U).
OX (U)âŠ—
â†âˆ’
â†âˆ’
Inverting p and passing to associated sheaves, we get the required isomorphism
(5.0.23), which concludes the proof of our lemma.

Lemma 5.4. Let E be a filtered convergent F -isocrystal on X , Y = Spf A, and V âˆˆ
YproeÌt an affinoid perfectoid which is pro-eÌtale over Yek . The canonical morphism
b A OBcris,Y (V ))
RÎ“(X , DRX/Y (E)) âŠ—A OBcris,Y (V ) âˆ’â†’ RÎ“(X , DRX/Y (E)âŠ—

is an isomorphism in the filtered derived category.

Proof. Write Vb = Spa(R, R+ ). To show our lemma, remark first that the morphism
above respects clearly the filtration on both sides. Secondly, since OAcris,Y (V ) â‰ˆ
OAcris (R, R+ ) while the latter is I 2 -flat over A with I âŠ‚ OAcris (R, R+ ) the ideal
n
generated by ([Ç«]1/p âˆ’ 1)nâˆˆN (we refer to [Bri, Section 6.3] for this notion and the
proof of this assertion), for any coherent sheaf F on X , the kernel and the cokernel
of the morphism below induced by base change are killed by some (finite) power of
I:
b A OAcris (R, R+ )).
H i (X , F ) âŠ—A OAcris (R, R+ ) âˆ’â†’ H i (X , F âŠ—
Inverting t, we get an isomorphism
b A OBcris,Y (V )).
H i (X , F ) âŠ—A OBcris,Y (V ) âˆ’â†’ H i (X , F âŠ—

50

FUCHENG TAN, JILONG TONG

By some standard devissage, we deduce that the morphism in our lemma is an
isomorphism in the derived category. To conclude, we only need to check that the
induced morphisms between the graded quotients are all quasi-isomorphisms. As
in the proof of Corollary 3.25 we are reduced to checking the almost isomorphism
below for any coherent sheaf F on X :
b A grr OAcris,Y (V )),
RÎ“(X , F ) âŠ—A grr OAcris,Y (V ) âˆ’â†’ RÎ“(X , F âŠ—

which is clear since grr OAcris,Y (V ) is free over R+ , which is almost flat over A by
the almost purity theorem.


From now on, assume f : X â†’ Y is a proper smooth morphism (between smooth
formal schemes) over Ok . Its closed fiber gives rise to a morphism between the
crystalline topoi,
âˆ¼
fcris : (X0 /Ok )âˆ¼
cris âˆ’â†’ (Y0 /Ok )cris .
Let E be a filtered convergent F -isocrystal on X0 /Ok , and M an F -crystal on X0 /Ok
such that E â‰ƒ Man (n) for some n âˆˆ N (cf. Remark 3.5). Then M can be viewed
naturally as a coherent OX -module endowed with an integrable and quasi-nilpotent
Ok -linear connection M â†’ M âŠ— â„¦1X /Ok .
In the following we consider the higher direct image Ri fcrisâˆ— M of the crystal
M. One can determine the value of this abelian sheaf on Y0 /Ok at the p-adic PDthickening Y0 Ö’â†’ Y in terms of the relative de Rham complex DRX/Y (M) of M.
To state this, take V = Spf(A) an affine open subset of Y, and put XA := f âˆ’1 (V).
We consider A as a PD-ring with the canonical divided power structure on (p) âŠ‚ A.
In particular, we can consider the crystalline site (XA,0 /A)cris of XA,0 := X Ã—Y V0
relative to A. By [Ber96, Lemme 3.2.2], the latter can be identified naturally to the
open subsite of (X0 /Ok ) whose objects are objets (U, T ) of (X0 /Ok )cris such that
f (U ) âŠ‚ V0 and such that there exists a morphism Î± : T â†’ Vn := V âŠ—A A/pn+1 for
some n âˆˆ N, making the square below commute

/T .
U
can

 
V0 


/ Vn

Using [Ber96, Corollaire 3.2.3] and a limit argument, one finds a canonical identification
âˆ¼
Ri fcrisâˆ— (M)(V0 , V) âˆ’â†’ H i ((XA,0 /A)cris , M)
where we denote again by M the restriction of M to (XA,0 /A)cris . Let u = uXA,0 /A
be the morphism of topoi
âˆ¼
(XA,0 /A)âˆ¼
cris âˆ’â†’ XA eÌt
0
âˆ¼
such that uâˆ— (F )(U) = H ((U0 /A)cris , F ) for U âˆˆ XA eÌt . By [BO, Theorem 7.23],
there exists a natural quasi-isomorphism in the derived category
(5.0.24)

âˆ¼

Ruâˆ— M âˆ’â†’ DRX/Y (M),
âˆ¼

i
inducing an isomorphism Hcris
(XA,0 /A, M) âˆ’
â†’ Hi (XA , DRX/Y (M)). Thereby

(5.0.25)

âˆ¼

i
Hcris
(XA,0 /A, M) âˆ’â†’ Hi (XA , DRX/Y (M)).

Passing to associated sheaves, we deduce that
Ri fcrisâˆ— (M)Y = Ri fâˆ— (DRX/Y (M)).

Crystalline comparison isomorphism in p-adic Hodge theory

51

On the other hand, as f : X â†’ Y is proper and smooth, Ri fâˆ— (DRX/Y (E)), viewed
as a coherent sheaf on the adic space Y , is the i-th relative convergent cohomology
of E with respect to the morphism f0 : X0 â†’ Y0 . Thus, by [Ber86, TheÌoreÌ€me 5] (see
also [Tsu, Theorem 4.1.4]), if we invert p, the OY [1/p]-module Ri fâˆ— (DRX/Y (E)) â‰ƒ
Ri fâˆ— (DRX/Y (M))[1/p], together with the Gauss-Manin connection and the natural Frobenius structure inherited from Ri fcrisâˆ— (M)Y â‰ƒ Ri fâˆ— (DRX/Y (M)), is a
convergent F -isocrystal on Y0 /Ok , denoted by Ri fcrisâˆ— (E) in the following (this is
an abuse of notation, a more appropriate notation should be Ri f0 convâˆ— (E)). Using
the filtration on E, one sees that Ri fcrisâˆ— (E) has naturally a filtration, and it is
well-known that this filtration satisfies Griffiths transversality with respect to the
Gauss-Manin connection.
Proposition 5.5. Let X â†’ Y be a proper smooth morphism between two smooth
formal schemes over Ok . Let E be a filtered convergent F -isocrystal on X0 /Ok and
b p -sheaf on XproeÌt . Assume that E and L are associated. Then there is a
L a lisse Z
natural filtered isomorphism of OBcris,Y -modules
(5.0.26)

âˆ¼
âˆ’1
b kâˆ’1 OBcris,Y ) âˆ’â†’
Ri fkâˆ— (L âŠ—Zbp Bcris,X âŠ—f
wY
(Ri fcrisâˆ— (E)) âŠ— OBcris,Y

which is compatible with Frobenius and connection.

Proof. Using the relative PoincareÌ lemma (Proposition 5.1 (1)) and the fact that L
and E are associated, we have the following filtered isomorphisms compatible with
connection:
b kâˆ’1 OBcris,Y )
Ri fkâˆ— (L âŠ— Bcris,X âŠ—f
âˆ¼
i
âˆ’â†’ R fkâˆ— (L âŠ— DRX/Y (OBcris,X ))
âˆ¼
(5.0.27)
âˆ’â†’ Ri fkâˆ— (DRX/Y (L âŠ— OBcris,X ))
âˆ¼
âˆ’1
E âŠ— OBcris,X ))
âˆ’â†’ Ri fkâˆ— (DRX/Y (wX
âˆ¼
âˆ’1
i
âˆ’â†’ R fkâˆ— (wX DRX/Y (E) âŠ— OBcris,X ).
On the other hand, we have the morphism below given by adjunction which respects
also the connections on both sides:
âˆ’1 i
âˆ’1
b
(5.0.28) wY
R fâˆ— (DRX/Y (E)) âŠ— OBcris,Y âˆ’â†’ Ri fkâˆ— (wX
DRX/Y (E)âŠ—OB
cris,X ).

We claim that the morphism (5.0.28) is a filtered isomorphism. This is a local
question, we may and do assume first that Y = Spf(A) is affine and is eÌtale over
some torus defined over Ok . Let V âˆˆ YproeÌt be an affinoid perfectoid pro-eÌtale over
Yek . As Ri fâˆ— (DRX/Y (E)) = Ri fcrisâˆ— (E) is a locally free OY [1/p]-module over Y and
as OBcris (V ) is flat over A ([Bri, TheÌoreÌ€me 6.3.8]),

âˆ’1 i
wY
R fâˆ— (DRX/Y (E)) âŠ— OBcris,Y (V ) â‰ƒ H i (X , DRX/Y (E)) âŠ—A OBcris,Y (V ).

So we only need to check that the natural morphism below is a filtered isomorphism
âˆ’1
b
H i (X , DRX/Y (E)) âŠ—A OBcris,Y (V ) âˆ’â†’ H i (XV , wX
DRX/Y (E)âŠ—OB
cris,X ).

By Lemma 5.3 one has the following identifications that are strictly compatible
with filtrations:
âˆ’1
H i (XV , wX
DRX/Y (E) âŠ— OBcris,X ) â‰ƒ

â‰ƒ

âˆ’1
H i (X , RwV âˆ— (wX
DRX/Y (E) âŠ— OBcris,X ))
b A OBcris,Y (V )).
H i (X , DRX/Y (E)âŠ—

52

FUCHENG TAN, JILONG TONG

Thus we are reduced to proving that the canonical morphism below is a filtered
isomorphism:
b A OBcris,Y (V )),
H i (X , DRX/Y (E)) âŠ—A OBcris,Y (V ) âˆ’â†’ H i (X , DRX/Y (E)âŠ—

which follows from Lemma 5.4.
Composing the isomorphisms in (5.0.27) with the inverse of (5.0.28), we get the
desired filtered isomorphism (5.0.26) that is compatible with connections on both
sides. It remains to check the Frobenius compatibility of (5.0.26). For this, we may
and do assume again that Y = Spf(A) is affine and is eÌtale over some torus over
Ok , and let V âˆˆ YproeÌt some affinoid perfectoid pro-eÌtale over Ye . In particular, A
admits a lifting of the Frobenius on Y0 , denoted by Ïƒ. Let M be an F -crystal on
X0 /Ok such that E = Man (n) for some n âˆˆ N (Remark 3.5). Then the crystalline
cohomology H i (X0 /A, M) is endowed with a Frobenius which is Ïƒ-semilinear. We
just need to check the Frobenius compatibility of composition of the maps below
(here the last one is induced by the inverse of (5.0.26)):
âˆ¼

i
i
Hcris
(X0 /A, M) âˆ’â†’ Hcris
(X
âˆ’â†’ H i (X , DRX/Y (E)) âˆ’â†’
 0 /A, M)[1/p]
âˆ’1
i
i
b kâˆ’1 OBcris,Y ),
wY (R fcrisâˆ— (E) âŠ— OBcris,Y (V ) âˆ’â†’ H (XV , L âŠ— Bcris,X âŠ—f

which can be done exactly in the same way as in the proof of Theorem 3.27.



The relative crystalline comparison theorem then can be stated as follows:
b p -sheaf on X associated to a filtered
Theorem 5.6. Let L be a crystalline lisse Z
b p -sheaf
F -isocrystal E on X0 /Ok . Assume that, for any i âˆˆ Z, Ri fkâˆ— L is a lisse Z
i
on Y . Then R fkâˆ— L is crystalline and is associated to the filtered convergent F isocrystal Ri fcrisâˆ— E.
Proof. Let us first observe that the filtration on Ri fcrisâˆ— E is given by locally direct
summands (so Ri fcrisâˆ— E is indeed a filtered convergent F -isocrystal on Y0 /Ok ). To
b p -sheaf
see this, one uses [Sch13, Theorem 8.8]: by Proposition 3.23, the lisse Z
L is de Rham with associated filtered OX -module with integrable connection E.
Therefore the Hodge-to-de Rham spectral sequence

E1i,j = Ri+j fâˆ— gri DRX/Y (E) =â‡’ Ri+j fâˆ— (DRX/Y (E))
degenerates at E1 . Moreover E1i,j , the relative Hodge cohomology of E in [Sch13,
Theorem 8.8], is a locally free OY -module of finite rank for all i, j by loc. cit.
Therefore the filtration on Ri fâˆ— (DRX/Y (E)) = Ri fcrisâˆ— (E), which is the same as
the one induced by the spectral sequence above, is given by locally direct summands.
To complete the proof, we need to find filtered isomorphisms that are compatible
with Frobenius and connections:
âˆ¼

âˆ’1 i
R fcrisâˆ— (E) âŠ— OBcris,Y ,
Ri fkâˆ— (L) âŠ— OBcris,Y âˆ’â†’ wY

i âˆˆ Z.

By Proposition 5.2 and Proposition 5.5, we only need to check that the natural
morphism below is a filtered almost isomorphism compatible with Frobenius and
connections:
i
b
b kâˆ’1 OAcris,Y ).
Ri fkâˆ— (L âŠ— Acris,X )âŠ—OA
cris,Y âˆ’â†’ R fkâˆ— (L âŠ— Acris,X âŠ—f

The proof of this is similar to that of Proposition 5.2: one just remarks that for
each n âˆˆ N, OAcris,Y /pn |Ye â‰ƒ Acris,Y |Ye hw1 , . . . , wÎ´ i/pn hence OAcris,Y |Ye /pn is free
over Acris,Y /pn with a basis given by the divided powers w[Î±] with Î± âˆˆ NÎ´ (recall
that for 1 â‰¤ j â‰¤ Î´, wj = Sj âˆ’ [Sjâ™­ ] âˆˆ OAcris,Y |Ye ).


Crystalline comparison isomorphism in p-adic Hodge theory

53

6. Appendix: geometric acyclicity of OBcris
In this section, we extend the main results of [AB] to the setting of perfectoids.
The generalization is rather straightforward. Although one might see here certain
difference from the arguments in [AB], the strategy and technique are entirely
theirs.
Let f : X = Spf(B) â†’ Y = Spf(A) be a smooth morphism between two smooth
affine formal scheme over Ok . Write X (resp. Y ) the generic fiber of X (resp. of
Y). By abuse of notation the morphism X â†’ Y induced from f is still denoted by
f.
Assume that Y is eÌtale over the torus S := Spf(Ok {S1Â±1 , . . . , SÎ´Â±1 }) defined over
Ok and that the morphism f : X â†’ Y can factor as
eÌtale

X âˆ’â†’ T âˆ’â†’ Y,
so that T = Spf(C) is a torus over Y and the first morphism X â†’ T is eÌtale.
Write C = A{T1Â±1 , . . . , TdÂ±1 }. For each 1 â‰¤ i â‰¤ d (resp. each 1 â‰¤ j â‰¤ Î´), let
1/pn
1/pn
}nâˆˆN (resp. {Sj }nâˆˆN ) be a compatible family of p-power roots of Ti (resp.
{Ti
of Sj ). As in Proposition 2.12, we denote by Ye the following fiber product over the
generic fiber Sk of S:
Â±1/pâˆ

Y Ã—Sk Spa(k{S1

Â±1/pâˆ

, . . . , SÎ´

Â±1/pâˆ

}, Ok {S1

Â±1/pâˆ

, . . . , SÎ´

}).

Let V âˆˆ YproeÌt be an affinoid perfectoid over Yek with Vb = Spa(R, R ). Let TV =
e Se+ ) the base change
Spa(S, S + ) be the base change Tk Ã—Y V and XV = Spa(S,
Â±1
Â±1
+
+
+
X Ã—Y V . Thus S = R {T1 , . . . , Td } and S = S [1/p]. Set
n
o
Â±1/pâˆ
Â±1/pâˆ
+
+
+
b C Sâˆ
, Â· Â· Â· , Td
, Seâˆ
:= B âŠ—
,
Sâˆ
= R + T1
+

+
+
+
+
Sâˆ := Sâˆ
[1/p] and Seâˆ := Seâˆ
[1/p]. Then (Sâˆ , Sâˆ
) and (Seâˆ , Seâˆ
) are affinoids
perfectoids and
n
o
âˆ
âˆ
â™­+
Sâˆ
= Râ™­+ (T1â™­ )Â±1/p , Â· Â· Â· , (Tdâ™­ )Â±1/p
,
2

1/p
1/p
â™­+
+
+
, . . .) âˆˆ Sâˆ
. The inclusions S + âŠ‚ Sâˆ
and Se+ âŠ‚ Seâˆ
where Tiâ™­ := (Ti , Ti , Ti
define two profinite Galois covers. Their Galois groups are the same, denoted by Î“,
which is a profinite group isomorphic to Zp (1)d . One can summarize these notations
in the following commutative diagramme
+ o
Seâˆ
O

Î“

+ o
Sâˆ

Î“

Â±1/pâˆ

R+ {T1

Â±1/pâˆ

, . . . , Td

Î“
}o

SeO+ o

BO

S+ o

C

R+ {T1Â±1, . . . , TdÂ±1 } o
O

A{T1Â±1 , . . . , TdÂ±1 }
O

R+ o

A

eÌtale

54

FUCHENG TAN, JILONG TONG

+
The group Î“ acts naturally on the period ring OBcris (Seâˆ , Seâˆ
) and on its filtration
r
+
Fil OBcris (Seâˆ , Seâˆ ). The aim of this appendix is to compute the group cohomology






q
+
+
H q Î“, OBcris Seâˆ , Seâˆ
[1/t]
:= Hcont
Î“, OAcris Seâˆ , Seâˆ

and







1
q
r+n
r
+
+
e
e
e
e
OAcris Sâˆ , Sâˆ
:= lim Hcont Î“, n Fil
H Î“, Fil OBcris Sâˆ , Sâˆ
âˆ’â†’
t
q

nâ‰¥|r|

for q, r âˆˆ Z.
In the following, we will omit systematically the subscript â€œcontâ€ whenever there
is no confusion arising. Moreover, we shall use the multi-index to simplify the
notation: for example, for a = (a1 , . . . , ad ) âˆˆ Z[1/p]d , T a := T1a1 Â· T2a2 Â· Â· Â· Tdad .
+
6.1. Cohomology of OBcris . We will first compute H q (Î“, OAcris (Sâˆ , Sâˆ
)/pn ) up
âˆ
to (1 âˆ’ [Ç«]) -torsion for all q, n âˆˆ N.

Lemma 6.1. For n âˆˆ Zâ‰¥1 , there are natural isomorphisms
âˆ¼

+
â™­+
)/pn
Acris (R, R+ )/pn âŠ—W (Râ™­+ )/pn W (Sâˆ
)/pn âˆ’â†’ Acris (Sâˆ , Sâˆ

and


âˆ¼
+
+
)/pn ,
Acris (Sâˆ , Sâˆ
)/pn âŠ— OAcris (R, R+ )/pn hu1 , . . . , ud i âˆ’â†’ OAcris (Sâˆ , Sâˆ

sending ui to Ti âˆ’ [Tiâ™­ ]. Here the tensor product in the last isomorphism above is
taken over Acris (R, R+ )/pn .
Moreover, the natural morphisms
+
Acris (R, R+ )/pn â†’ Acris (Sâˆ , Sâˆ
)/pn ,

+
OAcris (R, R+ )/pn â†’ OAcris (Sâˆ , Sâˆ
)/pn

are both injective.
+
Proof. Recall Î¾ = [pâ™­ ] âˆ’ p. We know that Acris (Sâˆ , Sâˆ
) is the p-adic completion of

 m
â™­+
W (Sâˆ
)[X0 , X1 , Â· Â· Â· ]
Î¾
+
â™­+
|m = 0, 1, Â· Â· Â· =
.
A0cris (Sâˆ , Sâˆ
) := W (Sâˆ
)
m!
(m!Xm âˆ’ Î¾ m : m âˆˆ Zâ‰¥0 )
Note that we have the same expression with R in place of Sâˆ . We then have

W (Râ™­+ )[X0 , X1 , Â· Â· Â· ]
(m!Xm âˆ’ Î¾ m |m âˆˆ Zâ‰¥0 )

âˆ¼

â™­+
W (Sâˆ
) âŠ—W (Râ™­+ )

=

â™­+
W (Sâˆ
) âŠ—W (Râ™­+ ) A0cris (R, R+ ).

+
A0cris (Sâˆ , Sâˆ
) â†âˆ’

The first isomorphism follows.
Secondly, as V lies above Yek , by Proposition 2.12 we have
âˆ¼

Acris (R, R+ ){hw1 , . . . , wÎ´ i} âˆ’â†’ OAcris (R, R+ ),
1/p

1/p2

where Sjâ™­ := (Sj , Sj , Sj

wj 7â†’ Sj âˆ’ [Sjâ™­ ]

, . . .) âˆˆ Râ™­+ . Similarly
âˆ¼

+
+
Acris (Sâˆ , Sâˆ
){hu1 , . . . , ud , w1 , . . . , wÎ´ i} âˆ’â†’ OAcris (Sâˆ , Sâˆ
),

ui 7â†’ Ti âˆ’[Tiâ™­], wj 7â†’ Sj âˆ’[Sjâ™­ ].

Crystalline comparison isomorphism in p-adic Hodge theory

55

Thus (the isomorphisms below are all the natural ones)


+
+
Acris (Sâˆ , Sâˆ
)
OAcris (Sâˆ , Sâˆ
)
âˆ¼
hu1 , . . . , ud , w1 , . . . , wÎ´ i
â†âˆ’
pn
pn


+
Acris (Sâˆ , Sâˆ
)
Acris (R, R+ )
âˆ¼
âŠ— Acris (R,R+ )
hu1 , . . . , ud , w1 , . . . , wÎ´ i
â†âˆ’
pn
pn
pn


+
Acris (Sâˆ , Sâˆ
)
OAcris (R, R+ )
âˆ¼
âˆ’â†’
âŠ— Acris (R,R+ )
hu1 , . . . , ud i
pn
pn
pn


+
OAcris (R, R+ )
Acris (Sâˆ , Sâˆ
)
âˆ¼
hu1 , . . . , ud i.
âŠ— Acris (R,R+ )
âˆ’â†’
pn
pn
pn
So our second isomorphism is obtained.
+
Next we prove that the natural morphism Acris (R, R+ )/pn â†’ Acris (Sâˆ , Sâˆ
)/pn
is injective. When n = 1, we are reduced to showing the injectivity of
(S â™­+ /(pâ™­ )p )[X1 , X2 , . . .]
(Râ™­+ /(pâ™­ )p )[X1 , X2 , . . .]
âˆ’â†’
,
p
p
(X1 , X2 , . . .)
(X1p , X2p , . . .)
or equivalently the injectivity of
i
h

âˆ
âˆ
Râ™­+ /(pâ™­ )p â†’ S â™­+ /(pâ™­ )p = Râ™­+ /(pâ™­ )p (T1â™­ )Â±1/p , . . . (Tdâ™­ )Â±1/p ,

+
which is clear. The general case follows easily since Acris (Sâˆ , Sâˆ
) is p-torsion free.
+
n
+
One deduces also the injectivity of OAcris (R, )/p â†’ OAcris (Sâˆ , Sâˆ
)/pn by using
+
n
+
n
the natural isomorphisms OAcris (R, R )/p â‰ƒ (Acris (R, R )/p )hw1 , . . . , wÎ´ i, and
+
+
OAcris (Sâˆ , Sâˆ
)/pn â‰ƒ (Acris (Sâˆ , Sâˆ
)/pn )hu1 , . . . , ud , w1 , . . . , wÎ´ i. This concludes
the proof of our lemma.

+
Proposition 6.2. Acris (Sâˆ , Sâˆ
)/pn is free over Acris (R, R+ )/pn with a basis give
â™­ a
d
by {[T ] |a âˆˆ Z[1/p] }.

+
Proof. By Lemma 6.1, Acris (Sâˆ , Sâˆ
)/pn is generated over Acris (R, R+ )/pn by elâˆ
âˆ
â™­+
ements of the form [x] with x âˆˆ Sâˆ = Râ™­+ {(T1â™­ )Â±1/p , . . . , (Tdâ™­ )Â±1/p }. Write
+
Bn âŠ‚ Acris (Sâˆ , Sâˆ
)/pn for the Acris(R, R+ )/pn -submodule generated
by elements
âˆ
âˆ
â™­+
âŠ‚ Sâˆ
. We claim
of the form [x] with x âˆˆ S := Râ™­+ (T1â™­ )Â±1/p , . . . , (Tdâ™­ )Â±1/p
+
that Bn = Acris (Sâˆ , Sâˆ
)/pn .
â™­+
Since Sâˆ
is the pâ™­ -adic completion of S, for each x âˆˆ S â™­+ we can write x =
â™­ â€²
y0 + p x with xâ€² âˆˆ S. Iteration yields

x = y0 + pâ™­ y1 + Â· Â· Â· + (pâ™­ )pâˆ’1 ypâˆ’1 + (pâ™­ )p xâ€²â€²
â™­+
â™­+
with yi âˆˆ S and xâ€²â€² âˆˆ Sâˆ
. Then in W (Sâˆ
):

[x]

â™­+
â‰¡ [y0 ] + [pâ™­ ][y1 ] + Â· Â· Â· + [(pâ™­ )pâˆ’1 ][ypâˆ’1 ] + [(pâ™­ )p ][xâ€²â€² ] mod pW (Sâˆ
)

â‰¡ [y0 ] + Î¾[y1 ] + Â· Â· Â· + Î¾ pâˆ’1 [ypâˆ’1 ] + Î¾ p [xâ€²â€² ] mod

â™­+
pW (Sâˆ
).

+
+
As Î¾ âˆˆ Acris (Sâˆ , Sâˆ
) has divided power, Î¾ p = p! Â· Î¾ [p] âˆˆ pAcris (Sâˆ , Sâˆ
). So we
+
obtain in Acris (Sâˆ , Sâˆ )

[x] â‰¡ [y0 ] + Î¾[y1 ] + Â· Â· Â· + Î¾ pâˆ’1 [ypâˆ’1 ] mod

+
pAcris (Sâˆ , Sâˆ
).

56

FUCHENG TAN, JILONG TONG

+
â™­+
For any Î± âˆˆ Acris (Sâˆ , Sâˆ
)/pn = Acris (R, R+ )/pn âŠ—W (Râ™­+ )/pn W (Sâˆ
)/pn , we may
write
m
X
â™­+
+
Î»i [xi ] + pÎ±â€² , xi âˆˆ Sâˆ
, Î»i âˆˆ Acris (R, R+ )/pn , Î±â€² âˆˆ Acris (Sâˆ , Sâˆ
)/pn .
Î±=
i=0

The observation above tells us that one can write
Î± = Î²0 + pÎ±â€²â€² ,

+
Î²0 âˆˆ Bn , Î±â€²â€² âˆˆ Acris (Sâˆ , Sâˆ
)/pn .

By iteration again, we find
Î± = Î²0 + pÎ²1 + Â· Â· Â· pnâˆ’1 Î²nâˆ’1 + pn Î±Ìƒ,

+
Î²0 , Â· Â· Â· , Î²nâˆ’1 âˆˆ Bn , Î±Ìƒ âˆˆ Acris (Sâˆ , Sâˆ
)/pn .

Thus
+
Î± = Î²0 + pÎ²1 + Â· Â· Â· pnâˆ’1 Î²nâˆ’1 âˆˆ Bn âŠ‚ Acris (Sâˆ , Sâˆ
)/pn .
+
n
This shows the claim, i.e. Acris (Sâˆ , Sâˆ )/p is generated over Acris (R, R+ )/pn by
âˆ
âˆ
â™­+
the elements of the form [x] with x âˆˆ S = Râ™­+ [(T1â™­ )Â±1/p , . . . , (Tdâ™­ )Â±1/p ] âŠ‚ Sâˆ
.
â™­+
Furthermore, as for any x, y âˆˆ Sâˆ
â™­+
[x + y] â‰¡ [x] + [y] mod pW (Sâˆ
),
+
a similar argument shows that Acris (Sâˆ , Sâˆ
)/pn is generated over Acris (R, R+ )/pn
d
â™­ a
by the family of elements {[T ] |a âˆˆ Z[1/p] }.
It remains to show the freeness of the family {[T â™­ ]a |a âˆˆ Z[1/p]d } over Acris (R, R+ )/pn .
For this, suppose there exist Î»1 , Â· Â· Â· , Î»m âˆˆ Acris (R, R+ ) and distinct elements
a1 , Â· Â· Â· , am âˆˆ Z[1/p]d such that
m
X
+
).
Î»i [T â™­ ]ai âˆˆ pn Acris (Sâˆ , Sâˆ
i=1

+
One needs to prove Î»i âˆˆ pn Acris (R, R+ ) for each i. Modulo p we find in Acris (Sâˆ , Sâˆ
)/p
that
m
X
Î»i Â· (T â™­ )ai = 0,
i=1

with Î»i âˆˆ Acris (R, R+ )/p the reduction modulo p of Î»i . On the other hand, the
family of elements {(T â™­ )a : a âˆˆ Z[1/p]d } in
+
Acris (Sâˆ , Sâˆ
)/p

â‰ƒ

S â™­+ /((pâ™­ )p )[Î´2 , Î´3 , . . .]
(Î´2p , Î´3p , . . .)

â‰ƒ

Râ™­+ /((pâ™­ )p )[(T1â™­ )Â±1/p , . . . , (Tdâ™­ )Â±1/p , Î´2 , Î´3 , . . .]
(Î´2p , Î´3p , . . .)

âˆ

â™­+

â™­ p

âˆ

) )[Î´2 ,Î´3 ,...]
is free over Acris (R, R+ )/p â‰ƒ R /((p
. Therefore, Î»i = 0, or equivalently,
(Î´2p ,Î´3p ,...)
Î»i = pÎ»â€²i for some Î»â€²i âˆˆ Acris (R, R+ ). In particular,
!
m
m
X
X
+
).
Î»i [T â™­ ]ai = p Â·
Î»â€²i [T â™­ ]ai âˆˆ pn Acris (Sâˆ , Sâˆ
i=1

i=1

+
But Acris (Sâˆ , Sâˆ
) is p-torsion free, which implies that
m
X
+
Î»â€²i [T â™­ ]ai âˆˆ pnâˆ’1 Acris (Sâˆ , Sâˆ
).
i=1

Crystalline comparison isomorphism in p-adic Hodge theory

57

This way, we may find Î»i = pn Î»Ìƒi for some Î»Ìƒi âˆˆ Acris (R, R+ ), which concludes the
proof of the freeness.

+
Recall that Î“ is the Galois group of the profinite cover (Sâˆ , Sâˆ
) of (S, S + ). Let
(0) (1)
â™­
Ç« = (Ç« , Ç« , . . .) âˆˆ Ob be a compatible system of p-power roots of unity such that
k

Ç«(0) = 1 and that Ç«(1) 6= 1. Let {Î³1 , . . . , Î³d } be a family of generators such that for
each 1 â‰¤ i â‰¤ d, Î³i acts trivially on the variables Tj for any index j different from i
and that Î³i (Tiâ™­ ) = Ç«Tiâ™­ .
Lemma 6.3 ([AB] Lemme 11). Let 1 â‰¤ i â‰¤ d be an integer. Then one has
n
n
+
Î³i ([Tiâ™­ ]p ) = [Tiâ™­ ]p in OAcris (Sâˆ , Sâˆ
)/pn .
n

n

n

+
Proof. By definition, Î³i ([Tiâ™­ ]p ) = [Ç«]p [Tiâ™­ ]p in OAP
cris (Sâˆ , Sâˆ ). So our lemma
nr [r]
pn
n

follows from the fact that [Ç«] âˆ’ 1 = exp(p t) âˆ’ 1 = râ‰¥1 p t âˆˆ pn Acris .

+
Let An be the OAcris (R, R+ )-subalgebra of OAcris (Sâˆ , Sâˆ
)/pn generated by
for 1 â‰¤ i â‰¤ d. The previous lemma shows that Î“ acts trivially on An .
Furthermore, by the second isomorphism of Lemma 6.1 and by Proposition 6.2, we
have
ï£«
ï£¶
+
M
OAcris (Sâˆ , Sâˆ ) âˆ¼ ï£­
âˆ’â†’
An [T â™­ ]a ï£¸ hu1 , . . . , ud i, Ti âˆ’ [Tiâ™­ ] 7â†’ ui .
pn
d
n d

n
[Tiâ™­ ]Â±p

aâˆˆZ[1/p] âˆ©[0,p )

+
Transport the Galois action of Î“ on OAcris (Sâˆ , Sâˆ
)/pn to the righthand side of
this isomorphism. It follows that

Î³i (ui ) = ui + (1 âˆ’ [Ç«])[Tiâ™­ ].
Therefore,
[n]

[n]

Î³i (ui ) = ui +

n
X

[nâˆ’j]

[Tiâ™­ ]j (1 âˆ’ [Ç«])[j] ui

.

j=1

[n]

[n]

For other index j 6= i, Î³i (uj ) = uj and hence Î³i (uj ) = uj for any n. Set
M
M
An [T â™­ ]a , and An :=
An [T â™­ ]a .
Xn :=
aâˆˆ(Z[1/p]âˆ©[0,pn ))d \Zd

aâˆˆZd âˆ©[0,pn )d

Then we have the following decomposition, which respects the Î“-actions:
+
OAcris (Sâˆ , Sâˆ
)/pn = Xn hu1 , . . . , ud i âŠ• An hu1 , . . . , ud i.

Proposition 6.4 ([AB] Proposition 16). For any integer q â‰¥ 0, H q (Î“, Xn hu1 , . . . , ud i)
is killed by (1 âˆ’ [Ç«]1/p )2 .
Proof. Let An [T â™­ ]a be a direct summand of Xn with a âˆˆ (Z[1/p] âˆ© [0, pn ))d \ Z.
Write a = (a1 , . . . , ad ). Clearly we may assume that a1 âˆˆ
/ Z.
We claim first that cohomology group H q (Î“1 , An [T â™­ ]a ) is killed by 1 âˆ’ [Ç«]1/p for
any q, where Î“1 âŠ‚ Î“ is the closed subgroup generated by Î³1 . As Î“1 is topologically
cyclic with a generator Î³1 , the desired cohomology H q (Î“1 , An Â· [T â™­ ]a ) is computed
using the following complex
Î³1 âˆ’1

An Â· [T â™­ ]a âˆ’â†’ An Â· [T â™­ ]a .
We need to show that the kernel and the cokernel of the previous map are both
killed by 1 âˆ’ [Ç«]1/p . We have (Î³1 âˆ’ 1)([T â™­ ]a ) = ([Ç«]a1 âˆ’ 1)[T â™­ ]a . Since a1 âˆˆ
/ Z, its

58

FUCHENG TAN, JILONG TONG

p-adic valuation is â‰¤ âˆ’1. Therefore, 1 âˆ’ [Ç«]1/p is a multiple of 1 âˆ’ [Ç«]a1 , which
implies that coker(Î³ âˆ’ 1 : Xn â†’ Xn ) is killed by 1 âˆ’ [Ç«]1/p . On the other hand,
let x = Î» Â· [T â™­ ]a be an element in ker(Î³1 âˆ’ 1 : An Â· [T â™­ ]a â†’ An Â· [T â™­ ]a ). Then
(Î³1 âˆ’ 1)(x) = Î»([Ç«]a1 âˆ’ 1)[T â™­ ]a and necessarily Î»([Ç«]a1 âˆ’ 1) = 0. Since 1 âˆ’ [Ç«]1/p is a
multiple of [Ç«]a1 âˆ’ 1, (1 âˆ’ [Ç«])Î» = 0 and thus (1 âˆ’ [Ç«]1/p )x = 0, giving our claim.
Now for each 1 â‰¤ i â‰¤ d, let



d
\
(i)
n
/Z
E := a = (a1 , . . . , ad ) âˆˆ Z[1/p] [0, p ) : a1 , . . . , aiâˆ’1 âˆˆ Z, ai âˆˆ

and

M

X(i)
n :=

An [T â™­ ]a .

aâˆˆE (i)

Then we have the following decompositions which respect also the Î“-action:
Xn =

d
M

X(i)
n ,

Xn hu1 , . . . , ud i =

d
M

X(i)
n hu1 , . . . , ud i.

i=1

i=1

(i)

So we are reduced to proving that for each 1 â‰¤ i â‰¤ d, H q (Î“, Xn hu1 , . . . , ud i) is
killed by (1 âˆ’ [Ç«]1/p )2 for all q â‰¥ 0. By what we have shown in the beginning of
(i)
the proof, H q (Zp Î³i , Xn ) is killed by 1 âˆ’ [Ç«]1/p . As Î³i acts trivially on uj for j 6= i,
(i)
one computes as in [AB, Lemme 15] and then finds that H q (Zp Î³i , Xn hu1 , . . . , ud i)
1/p
is killed by 1 âˆ’ [Ç«] . Finally, one uses the Hochschild-Serre spectral sequence to
(i)
conclude that H q (Î“, Xn hu1 . . . , ud i) is killed by (1 âˆ’ [Ç«]1/p )2 for any q â‰¥ 0, as
desired.

The computation of H q (Î“, An hu1 , . . . , ud i) is more subtle. Note that we have
the following decomposition
d
i
h
O
(OAcris (R, R+ )/pn ) [Tiâ™­ ]Â±1 hui i,
An hu1 , . . . , ud i =
i=1

where the tensor products above are taken over OAcris (R, R+ )/pn .
We shall first treat the case where d = 1. We set T := T1 , u := u1 and
(m)
+
)/pn generated by the
Î³ := Î³1 . Let An be the An -submodule of OAcris (Sâˆ , Sâˆ
[m+a]
â™­ a
n
u
/[T ] â€™s with m + a â‰¥ 0 and 0 â‰¤ a < p . Then
h
i
X
An hui = An [T â™­ ] hui =
A(m)
n .
m>âˆ’pn

Consider the following complex:
h
i
h
i
Î³âˆ’ 1
(6.1.1)
An [T â™­ ] hui âˆ’â†’ An [T â™­ ] hui,



which computes H q (Î“, An hui) = H q Î“, An [T â™­ ] hui .

Lemma 6.5 ([AB] Proposition 20). The cokernel of (6.1.1), and hence H q (Î“, An hui)
for any q > 0, are killed by 1 âˆ’ [Ç«].
(m)

Proof. We will proceed by induction on m > âˆ’pn to show that (1 âˆ’ [Ç«])An
(1âˆ’pn )
= An Â· [T â™­ ]1pn âˆ’1 , while
contained in the image of (6.1.1). Note first An
n

(Î³ âˆ’ 1)(U/[T â™­ ]p ) = (1 âˆ’ [Ç«])

1
.
[T â™­ ]pn âˆ’1

is

Crystalline comparison isomorphism in p-adic Hodge theory

59

(1âˆ’pn )

Thus (1âˆ’[Ç«])An
is contained in the image of (6.1.1). Let m > âˆ’pn be a fixed in[m+pn âˆ’i]
(m)
teger. Then An is generated over An by u[T â™­ ]pn âˆ’i for i = 1, . . . , D := min(pn , pn +


m). On the other hand, for u[m+a] /[T â™­]a âˆˆ An [T â™­ ] hui with max(0, âˆ’m) â‰¤ a â‰¤
pn , we have
(u + (1 âˆ’ [Ç«])[T â™­ ])[m+a] âˆ’ [Ç«]a u[m+a]
[T â™­ ]a
X
u[m+a]
u[m+aâˆ’i]
(1 âˆ’ [Ç«]a ) â™­ a +
(1 âˆ’ [Ç«])[i]
[T ]
[T â™­ ]aâˆ’i
1â‰¤iâ‰¤a

[Ç«]a (Î³ âˆ’ 1)(u[m+a] /[T â™­ ]a ) =
=

iâ‰¤m+a

X

+

n

(1 âˆ’ [Ç«])[i] [T â™­ ]p

a+1â‰¤iâ‰¤a+pn
iâ‰¤m+a

u[m+aâˆ’i]
[T â™­ ]aâˆ’i+pn

+...
[n]

As for n â‰¥ 2, (1 âˆ’ [Ç«]) is a multiple of 1 âˆ’ [Ç«] ([AB, Lemme 18]), and all the terms
(mâˆ’rpn )
from the second line of the last equality belong to An
for r = 1, 2, . . .. By
induction hypothesis, we may assume that all these terms belong to the image of
(6.1.1). Write
(1 âˆ’ [Ç«])[j]
1 âˆ’ [Ç«]j
, and Î²j =
.
Î±j =
1 âˆ’ [Ç«]
1 âˆ’ [Ç«]
Modulo the image of (6.1.1), we find for max(0, âˆ’m) â‰¤ a < pn


n
U [m+a]
U [m+aâˆ’2]
U [m+aâˆ’1]
U [m+p âˆ’D]
(1âˆ’[Ç«]) Î±a
+
+ Î²2
+ . . . + Î²aâˆ’(pn âˆ’D)
â‰¡ 0;
[T â™­ ]a
[T â™­ ]aâˆ’1
[T â™­ ]aâˆ’2
[T â™­ ]pn âˆ’D
n

and for a = pn , as [Ç«]p = 1 in Acris /pn , modulo the image of (6.1.1) we have

 [m+pn âˆ’1]
n
n
u[m+p âˆ’2]
u[m+p âˆ’D]
u
+
Î²
+
.
.
.
+
Î²
â‰¡0
(1 âˆ’ [Ç«])
2
D
[T â™­ ]pn âˆ’1
[T â™­ ]pn âˆ’2
[T â™­ ]pn âˆ’D

Therefore, combining these congruences and modulo the image of (6.1.1) we have
 [m+pn âˆ’1]

n
u
u[m+p âˆ’D]
(1 âˆ’ [Ç«])
Â· Mn(m) â‰¡ 0
,...,
[T â™­ ]pn âˆ’1
[T â™­ ]pn âˆ’D
(m)

where Mn

is the matrix
ï£«
1
apn âˆ’1
ï£¬ Î²2
1
ï£¬
ï£¬
..
..
ï£¬
.
.
ï£¬
ï£­ Î²Dâˆ’1 Î²Dâˆ’2
Î²D
Î²Dâˆ’1

0
apn âˆ’2
..
.

...
...
..
.

0
0
..
.

Î²Dâˆ’3
Î²Dâˆ’2

. . . apn âˆ’D
...
1

ï£¶

ï£·
ï£·
ï£·
ï£· âˆˆ MD (Acris /pn ).
ï£·
ï£¸

One can check that this matrix is invertible ([AB, Lemme 19]), so modulo the image
[m+pn âˆ’i]
(m)
of (6.1.1) we have (1 âˆ’ [Ç«]) u[T â™­ ]pn âˆ’i = 0 for 1 â‰¤ i â‰¤ D. In other words, (1 âˆ’ [Ç«])An
is contained in the image of (6.1.1).

One still needs to compute H 0 (Î“, An hui). One remarks first that we have the
following isomorphism
h
i


âˆ¼
â†’ An hui = (OAcris (R, R+ )/pn ) [T â™­ ] hui
OAcris (R, R+ )/pn T Â±1 hui âˆ’

60

FUCHENG TAN, JILONG TONG

sending T to u + [T â™­ ]. Endow an action of Î“ on (OAcris (R, R+ )/pn )[T Â±1 ]hui via
the isomorphism above. So H 0 (Î“, An hui) is naturally isomorphic to the kernel of
the morphism
Î³ âˆ’ 1 : (OAcris (R, R+ )/pn )[T Â±1 ]hui âˆ’â†’ (OAcris (R, R+ )/pn )[T Â±1 ]hui,

(6.1.2)

and there is a natural injection
C âŠ—A OAcris (R, R+ )/pn = (OAcris (R, R+ )/pn )[T Â±1 ] Ö’â†’ H 0 (Î“, An hui).
Lemma 6.6 ([AB] Lemme 29). The cokernel of the last map is killed by 1 âˆ’ [Ç«].
Proof. We have Î³(u) = T âˆ’ [Ç«][T â™­ ] = (1 âˆ’ [Ç«])T + [Ç«]u. Therefore
[m]

(Î³ âˆ’ 1)(u[m] ) =

((1 âˆ’ [Ç«]) T + [Ç«]u) âˆ’ u[m]
m
X
(1 âˆ’ [Ç«])[j] T j [Ç«]mâˆ’j u[mâˆ’j]
([Ç«]m âˆ’ 1)u[m] +

=

(1 âˆ’ [Ç«]) ï£­Âµm u[m] +

=
where Âµm =
matrix

(N )

G

m

[Ç«] âˆ’1
1âˆ’[Ç«] ,

ï£«

0
0
..
.

ï£¬
ï£¬
ï£¬
:= ï£¬
ï£¬
ï£­ 0
0

Î²j =

j=1

ï£«

[j]

(1âˆ’[Ç«])
1âˆ’[Ç«]

T
Âµ1
..
.

T 2 Î²2
T [Ç«]
..
.

0
0

0
0

m
X
j=1

ï£¶

Î²j T j [Ç«]mâˆ’j u[mâˆ’j] ï£¸ ,

(so Î²1 = 1). For N > 0 an integer, consider the

...
T N Î²N
N âˆ’1
... T
Î²N âˆ’1 [Ç«]
..
..
.
.
T Î²1 [Ç«]N âˆ’1
ÂµN

...
...

Then we have

ï£¶

ï£·
ï£·
ï£·
ï£· âˆˆ M1+N (Acris,n [T Â±1 ]).
ï£·
ï£¸

(Î³ âˆ’ 1)(1, u, u[2], . . . , u[N ] ) = (1 âˆ’ [Ç«])(1, u, u[2], . . . , u[N ] )G(N ) .
Write
G(N ) =



0 H (N )
0
D



with D = (0, . . . , 0, ÂµN ) a matrix of type 1 Ã— N . On checks that the matrix H (N ) âˆˆ
MN (Acris,n [T Â±1 ]) is invertible.


Now let Î± âˆˆ (OAcris (R, R+ )/pn ) T Â±1 hui be an element contained in the kernel
of (6.1.2). Write
Î±=

N
X

as u[s] âˆˆ

s=0

OAcris (R, R+ )/pn

  Â±1 
T
hui,

as âˆˆ (OAcris (R, R+ )/pn )[T Â±1 ].

As Î± is contained in the kernel of (6.1.2),

(Î³ âˆ’ 1)(1, u, . . . , u[N ] )(a0 , a1 , . . . , aN )t = 0.
It follows that
(1 âˆ’ [Ç«])(1, u, . . . , u

[N ]

)



H (N ) aÌƒ
ÂµN a N



=0

with aÌƒ = (a1 , . . . , aN ). As the family {1, u, . . . , u[N ] } is linearly independent, (1 âˆ’
[Ç«])H (N ) aÌƒ = 0. Since H (N ) is invertible, we deduce (1 âˆ’ [Ç«])aÌƒ = 0. In other words,
(1 âˆ’ [Ç«])ai = 0 for i â‰¥ 1 and the lemma follows.


Crystalline comparison isomorphism in p-adic Hodge theory

61

Now we are ready to prove
Proposition 6.7. For any d > 0, n > 0 and q > 0, H q (Î“, An hu1 , . . . , ud i) is killed
by (1 âˆ’ [Ç«])2dâˆ’1 . Moreover, the natural morphism
(6.1.3)

C âŠ—A OAcris (R, R+ )/pn âˆ’â†’ H 0 (Î“, An hu1 , . . . , ud i),

Ti 7â†’ ui + [Tiâ™­ ]

is injective with cokernel killed by (1 âˆ’ [Ç«])2dâˆ’1 .
Proof. Recall that we have the decomposition
d
h
i
O
(OAcris (R, R+ )/pn ) [Tiâ™­ ]Â±1 hui i.
An hu1 , . . . , ud i =
i=1

We shall proceed by induction on d. The case d = 1 comes from the previous two
lemmas. For integer d > 1, one uses Hochschild-Serre spectral sequence
E2i,j = H i (Î“/Î“1 , H j (Î“1 , An hu1 , . . . , ud i)) =â‡’ H i+j (Î“, An hu1 , . . . , ud i).
Using the decomposition above, the group H j (Î“1 , An hu1 , . . . , ud i) is isomorphic to
i

h
i
 
h

H j Î“1 , OAcris (R, R+ )/pn [T1â™­ ]Â±1 hu1 i âŠ— âŠ—di=2 (OAcris (R, R+ )/pn ) [Tiâ™­ ]Â±1 hui i .

So by the calculation done for the case d = 1, we find that, up to (1 âˆ’ [Ç«])-torsion,
H j (Î“1 , An hu1 , . . . , ud i) is zero when j > 0, and is equal to
i


h
(OAcris (R, R+)/pn )[T1Â±1 ] âŠ— âŠ—di=2 (OAcris (R, R+ )/pn ) [Tiâ™­ ]Â±1 hui i

when j = 0. Thus, up to (1 âˆ’ [Ç«])-torsion, E2i,j = 0 when j > 0 and E2i,0 is equal to


h
i

(OAcris (R, R+)/pn )[T1Â±1 ] âŠ— H i Î“/Î“1 , âŠ—di=2 (OAcris (R, R+ )/pn ) [Tiâ™­ ]Â±1 hui i .

Using the induction hypothesis, we get that, up to (1âˆ’[Ç«])2(dâˆ’1)âˆ’1+1 -torsion, E2i,0 =
0 when i > 0 and
E20,0 = (OAcris (R, R+ )/pn )[T1Â±1 , . . . , TdÂ±1 ] = C âŠ—A OAcris (R, R+ )/pn .
As E2i,j = 0 for j > 1, we have short exact sequence
q,0
qâˆ’1,1
0 âˆ’â†’ Eâˆ
âˆ’â†’ H q (Î“, An hu1 , . . . , ud i) âˆ’â†’ Eâˆ
âˆ’â†’ 0.
qâˆ’1,1
is killed by (1 âˆ’ [Ç«]) (as this is already
By what we have shown above, Eâˆ
qâˆ’1,1
q,0
the case for E2
), and Eâˆ
is killed by (1 âˆ’ [Ç«])2dâˆ’2 for q > 0 (as this is the
case for E2q,0 ), thus H q (Î“, An hu1 , . . . , ud i) is killed by (1 âˆ’ [Ç«])2dâˆ’1 . For q = 0,
0,0
H 0 (Î“, An hu1 , . . . , ud i) â‰ƒ Eâˆ
= E20,0 . So the cokernel of the natural injection

C âŠ—A OAcris (R, R+ )/pn âˆ’â†’ H 0 (Î“, An hu1 , . . . , ud i)
is killed by (1 âˆ’ [Ç«])2dâˆ’2 , hence by (1 âˆ’ [Ç«])2dâˆ’1 .



Remark 6.8. With more efforts, one may prove that H q (Î“, An hu1 , . . . , ud i) is
killed by (1 âˆ’ [Ç«])d for q > 0 ([AB, Proposition 21]), and that the cokernel of the
morphism (6.1.3) is killed by (1 âˆ’ [Ç«])2 ([AB, Proposition 30]).
+
Corollary 6.9. For any n â‰¥ 0 and any q > 0, H q (Î“, OAcris (Sâˆ , Sâˆ
)/pn ) is killed
2d
by (1 âˆ’ [Ç«]) . Moreover, the natural morphism
+
b A OAcris (R, R+ )/pn âˆ’â†’ H 0 (Î“, OAcris (Sâˆ , Sâˆ
CâŠ—
)/pn )

is injective, with cokernel killed by (1 âˆ’ [Ç«])2d .

62

FUCHENG TAN, JILONG TONG
+
Recall that we want to compute H q (Î“, OBcris (Seâˆ , Seâˆ
)). For this, one needs

Lemma 6.10. Keep the notations above and assume that the morphism f : X â†’ Y
+
e Se+ ) = Spa(Seâˆ , Seâˆ
is eÌtale; thus V = Spa(R, R+ ) and X Ã—Y V = Spa(S,
). The
natural morphism
+
b A OAcris (R, R+ ) âˆ’â†’ OAcris (Seâˆ , Seâˆ
BâŠ—
)
is an isomorphism.

Proof. By Lemma 2.17 we are reduced to showing that the natural map (here
wj = Sj âˆ’ [Sjâ™­ ])
e Se+ ){hw1 , . . . , wÎ´ i}
b A Acris (R, R+ ){hw1 , . . . , wÎ´ i} âˆ’â†’ Acris (S,
BâŠ—

is an isomorphism. Since both sides of the previous maps are p-adically complete
and without p-torsion, we just need to check that its reduction modulo p
e Se+ )/p)hw1 , . . . , wÎ´ i
B/p âŠ—A/p (Acris (R, R+ )/p)hw1 , . . . , wÎ´ i âˆ’â†’ (Acris (S,
is an isomorphism. Note that we have the following expression
(Acris (R, R+ )/p)hw1 , . . . , wÎ´ i â‰ƒ

(Râ™­+ /((pâ™­ )p ))[Î´m , wi , Zim ]1â‰¤iâ‰¤Î´,mâˆˆN
,
p
p
)1â‰¤iâ‰¤Î´,mâˆˆN
(Î´m
, wim , Zim

e Se+ )/p)hw1 , . . . , wÎ´ i, where Î´m is the image
and the similar expression for (Acris (S,
m+1
p
of Î³
(Î¾) with Î³ : x 7â†’ x /p. One sees that both sides of the morphism above are
pâ™­ -adically complete (in fact pâ™­ is nilpotent). Moreover Râ™­+ has no pâ™­ -torsion. So
we are reduced to showing that the morphism
(Râ™­+ /pâ™­ )[Î´m , wi , Zim ]1â‰¤iâ‰¤Î´,mâˆˆN
(Seâ™­+ /pâ™­ )[Î´m , wi , Zim ]1â‰¤iâ‰¤Î´,mâˆˆN
B/p âŠ—A/p
âˆ’â†’
p
p
p
p
p
(Î´m , wi , Zim )1â‰¤iâ‰¤Î´,mâˆˆN
(Î´m
, wip , Zim
)1â‰¤iâ‰¤Î´,mâˆˆN

is an isomorphism. But Râ™­+ /pâ™­ â‰ƒ R+ /p and Seâ™­+ /pâ™­ â‰ƒ Se+ /p, so we just need to
show that the following morphism is an isomorphism:
(R+ /p)[Î´m , wi , Zim ]1â‰¤iâ‰¤Î´,mâˆˆN
(Se+ /p)[Î´m , wi , Zim ]1â‰¤iâ‰¤Î´,mâˆˆN
Î± : B/p âŠ—A/p
âˆ’â†’
.
p
p
p
p
p
(Î´m , wi , Zim )1â‰¤iâ‰¤Î´,mâˆˆN
(Î´m
, wip , Zim
)1â‰¤iâ‰¤Î´,mâˆˆN
To see this, we consider the following diagram
0

e+ /p[Î´m ,wi ,Zim ]1â‰¤iâ‰¤Î´,mâˆˆN
S
p
p
)1â‰¤iâ‰¤Î´,mâˆˆN
,wip ,Zim
(Î´m

4
âœâœâœâœ
Î±âœâœâœâœâœ
âœâœâœâœ
âœâœâœâœ

B/p
O

/ B/p âŠ—A/p

A/p

R+ /p[Î´m ,wi ,Zim ]1â‰¤iâ‰¤Î´,mâˆˆN
p
p
)1â‰¤iâ‰¤Î´,mâˆˆN
,wip ,Zim
(Î´m

O

eÌtale

.

>

eÌtale

/

eÌtale
R+ /p[Î´m ,wi ,Zim ]1â‰¤iâ‰¤Î´,mâˆˆN
p
p
)1â‰¤iâ‰¤Î´,mâˆˆN
,wip ,Zim
(Î´m

It follows that Î± is eÌtale. To see that Î± is an isomorphism, we just need to show
that this is the case after modulo some nilpotent ideals of both sides of Î±. Hence
we are reduced to showing that the natural morphism
B/p âŠ—A/p R+ /p âˆ’â†’ Se+ /p

is an isomorphism, which is clear from the definition.



Crystalline comparison isomorphism in p-adic Hodge theory

63

Apply the previous lemma to the eÌtale morphism f : X â†’ T , we find a canonical
Î“-equivariant isomorphism
âˆ¼
b C OAcris (Sâˆ , S + ) âˆ’â†’
BâŠ—
OAcris (Seâˆ , Se+ ).
âˆ

âˆ

In particular, we find

âˆ¼

+
+
b C OAcris (Sâˆ , Sâˆ
)) âˆ’â†’ H q (Î“, OAcris (Seâˆ , Seâˆ
)).
H q (Î“, B âŠ—

Now consider the following spectral sequence

+
+
b C OAcris (Sâˆ , Sâˆ
)/pn ) =â‡’ H i+j (Î“, B âŠ—
))
E2i,j = Ri lim H j (Î“, B âŠ—C OAcris (Sâˆ , Sâˆ
â†
âˆ’
n

which induces a short exact sequence for each i:
(6.1.4)
+
b C OAcris (Sâˆ , Sâˆ
0 âˆ’â†’ R1 limn H iâˆ’1 (Î“, B âŠ—C OAcris (Sâˆ , Sâˆ )/pn ) âˆ’â†’ H i (Î“, B âŠ—
))
â†âˆ’
i
n
âˆ’â†’ limn H (Î“, B âŠ—C OAcris (Sâˆ , Sâˆ )/p ) âˆ’â†’ 0.
â†âˆ’
As B is flat over C, it can be written as a filtered limit of finite free C-modules,
and as Î“ acts trivially on B, the following natural morphism is an isomorphism for
each i:
âˆ¼

B âŠ—C H i (Î“, OAcris (Sâˆ , Sâˆ )/pn ) âˆ’â†’ H i (Î“, B âŠ—C OAcris (Sâˆ , Sâˆ )/pn ).
+
Therefore, for i â‰¥ 1, H i (Î“, BâŠ—C OAcris (Sâˆ , Sâˆ
)/pn ) is killed by (1âˆ’[Ç«])2d by Corollary 6.9. Moreover, by the same corollary, we know that the following morphism is
injective with cokernel killed by (1 âˆ’ [Ç«])2d :
+
C âŠ—A OAcris (R, R+ )/pn âˆ’â†’ H 0 (Î“, OAcris (Sâˆ , Sâˆ
)/pn ).

Thus the same holds if we apply the functor B âŠ—C âˆ’ to the morphism above
+
B âŠ—A OAcris (R, R+ )/pn âˆ’â†’ B âŠ—C H 0 (Î“, OAcris (Sâˆ , Sâˆ
)/pn ).

Passing to limits we obtain an injective morphism

+
b A OAcris (R, R+ ) âˆ’â†’ lim B âŠ—C H 0 (Î“, OAcris (Sâˆ , Sâˆ
BâŠ—
)/pn ) ,
â†
âˆ’
n
whose cokernel is killed by (1 âˆ’ [Ç«])2d , and that


+
R1 lim B âŠ—C H 0 (Î“, OAcris (Sâˆ , Sâˆ
)/pn )
â†
âˆ’
n

is killed by (1 âˆ’ [Ç«])2d. As a result, using the short exact sequence (6.1.4), we deduce
+
+
b C OAcris (Sâˆ , Sâˆ
)) is killed by
)) â‰ƒ H i (Î“, OAcris (Seâˆ , Seâˆ
that for i â‰¥ 1, H i (Î“, B âŠ—
4d
(1 âˆ’ [Ç«]) , and that the canonical morphism
+
+
b A OAcris (R, R+ ) âˆ’â†’ H 0 (Î“, B âŠ—
b C OAcris (Sâˆ , Sâˆ
BâŠ—
)) â‰ƒ H 0 (Î“, OAcris (Seâˆ , Seâˆ
))

is injective with cokernel killed by (1 âˆ’ [Ç«])2d . One can summarize the calculations
above as follows:
+
Proposition 6.11. (i) For any n â‰¥ 0 and q > 0, H q (Î“, OAcris (Seâˆ , Seâˆ
)/pn ) is
2d
killed by (1 âˆ’ [Ç«]) , and the natural morphism
B âŠ—A OAcris (R, R+ )/pn âˆ’â†’ H 0 (Î“, OAcris (Seâˆ , Se+ ))/pn
âˆ

is injective with cokernel killed by (1 âˆ’ [Ç«])2d .
+
(ii) For any q > 0, H q (Î“, OAcris (Sâˆ , Sâˆ
)) is killed by (1 âˆ’ [Ç«])4d and the natural
morphism
+
b A OAcris (R, R+ ) â†’ H 0 (Î“, OAcris (Seâˆ , Seâˆ
BâŠ—
))

64

FUCHENG TAN, JILONG TONG

is injective, with cokernel killed by (1 âˆ’ [Ç«])2d .
From this proposition, we deduce the following
+
Theorem 6.12. Keep the notations above. Then H q (Î“, OBcris (Seâˆ , Seâˆ
)) = 0 for
q â‰¥ 1, and the natural morphism
+
b A OBcris (R, R+ ) âˆ’â†’ H 0 (Î“, OBcris (Seâˆ , Seâˆ
))
BâŠ—

is an isomorphism.

Proof. By the previous proposition, we just need to remark that inverting t is
equivalent to inverting 1 âˆ’ [Ç«], as
X
X
(1 âˆ’ [Ç«])[n]
.
t = log([Ç«]) = âˆ’
(n âˆ’ 1)! Â· (1 âˆ’ [Ç«])[n] = âˆ’(1 âˆ’ [Ç«])
(n âˆ’ 1)! Â·
1 âˆ’ [Ç«]
nâ‰¥1

Here, by [AB, Lemme 18],
above converges in Acris .

nâ‰¥1

(1âˆ’[Ç«])[n]
1âˆ’[Ç«]

Î¸

c ), hence the last summation
âˆˆ ker(Acris â†’ O
k


6.2. Cohomology of Filr OBcris . We keep the notations at the beginning of the
+
+
appendix. In this Â§, for simplicity, we will denote OAcris (Seâˆ , Seâˆ
) (resp. Filr OAcris (Seâˆ , Seâˆ
))
r
by OAcris (resp. Fil OAcris ). This part is entirely taken from [AB, Â§5], which we
keep here for the sake of completeness.
Lemma 6.13. Let q âˆˆ N>0 , and n an integer â‰¥ 4d + r. The multiplication-by-tn
morphism of H q (Î“, Filr OAcris ) is trivial.
Proof. Let grr OAcris := Filr OAcris / Filr+1 OAcris . As Î¸(1 âˆ’ [Ç«]) = 0, grr OAcris is
killed by 1 âˆ’ [Ç«]. So using the tautological short exact sequence below
0 âˆ’â†’ Filr+1 OAcris âˆ’â†’ Filr OAcris âˆ’â†’ grr OAcris âˆ’â†’ 0
and by induction on the integer r â‰¥ 0, one shows that H q (Î“, Filr OAcris ) is killed by
(1 âˆ’ [Ç«])4d+r ; the r = 0 case being Proposition 6.11(ii). So the multiplication-by-tn
with n â‰¥ 4d + r is zero for H q (Î“, OAcris ).

Recall that for q âˆˆ Z, we have defined
+
H q (Î“, Filr OBcris (Seâˆ , Seâˆ
)) := lim H q (Î“, tâˆ’n Filr+n OAcris ),
âˆ’â†’
nâˆˆN

or, in an equivalent way,

+
H q (Î“, Filr OBcris (Seâˆ , Seâˆ
)) = lim H q (Î“, Filr+n OAcris ),
âˆ’â†’
nâˆˆN

where for each n, the transition map

H q (Î“, Filr+n OAcris ) â†’ H q (Î“, Filr+n+1 OAcris )
is induced from the map
Filr+n OAcris â†’ Filr+n+1 OAcris ,

x 7â†’ t Â· x.

We have the following easy observation.
+
Lemma 6.14 ([AB] Lemme 33). For each q âˆˆ Z, H q (Î“, Filr OBcris (Seâˆ , Seâˆ
)) is a
vector space over Qp .

The first main result of this section is the following.

Crystalline comparison isomorphism in p-adic Hodge theory

65

+
Proposition 6.15 ([AB] Proposition 34). H q (Î“, Filr OBcris (Seâˆ , Seâˆ
)) = 0 for any
q > 0.

+
Proof. By Lemma 6.14, the cohomology group H q (Î“, Filr OBcris (Seâˆ , Seâˆ
)) is a vector space over Qp . Hence to show the desired annihilation, we just need to show
that for any x âˆˆ H q (Î“, tâˆ’n Filr+n Acris ), there exists m â‰« n such that the image of
x in H q (Î“, tâˆ’m Filr+m OAcris ) is p-torsion. In view of Lemma 6.13, we are reduced
to showing that the kernel of the map

H q (Î“, Filr+1 OAcris ) â†’ H q (Î“, Filr OAcris )
is of p-torsion, or equivalently, the cokernel of the map
H qâˆ’1 (Î“, Filr OAcris ) â†’ H qâˆ’1 (Î“, grr OAcris )
is of p-torsion for any q â‰¥ 1. This assertion is verified in the following lemma.



Lemma 6.16 ([AB] Lemme 35, Lemme 36). For each q âˆˆ N, the cokernel of the
map
H q (Î“, Filr OAcris ) â†’ H q (Î“, grr OAcris )

(6.2.1)
is of p-torsion.

eâ™­+
e+
Proof. Recall that Î¾Ìƒ := [Ç«][Ç«]âˆ’1
1/p âˆ’1 is a generator of ker(Î¸ : W (Sâˆ ) â†’ Sâˆ ). Moreover,
there exists a canonical isomorphism
OAcris â‰ƒ Acris (Seâˆ , Se+ ){hu1 , . . . , ud , w1 , . . . wÎ´ i}.
âˆ

For n = (n0 , n1 , . . . , nd+Î´ ) âˆˆ N
n

u :=

[n ]
u1 1

1+d+Î´

a multi-index, we set

[n ]
Â· Â· Â· ud d ,

[nd+1 ]

w n := w1

[nd+Î´ ]

Â· Â· Â· wÎ´

.

+
In particular grr OAcris is a free Seâˆ
-module with a basis given by
[n
]
n
n
0
Î¾Ëœ Â· u Â· w , where n âˆˆ N1+d+Î´ such that |n| = r.

+
Recall that Se+ âŠ‚ Seâˆ
. Let

Dr :=

M

|n|=r

Se+ Î¾Ëœ[n0 ] Â· u[n] Â· w[n] âŠ‚ grr OAcris .

Ëœ i ].
For each 1 â‰¤ i â‰¤ d, Î³i (ui ) = Ti âˆ’ [Ç«][Tiâ™­ ] = ui âˆ’ ([Ç«] âˆ’ 1)[Tiâ™­ ] = ui âˆ’ ([Ç«]1/p âˆ’ 1)Î¾[T
r
(1)
Ëœ
Viewed as element in gr OAcris , we have Î³i (ui ) = ui âˆ’ (Ç« âˆ’ 1)Î¾Ti . In particular,
Dr âŠ‚ grr OAcris is stable under the action of Î“. Similarly, one checks that the
S + -submodule T Î± Â· Dr âŠ‚ grr OAcris is again stable under the action of Î“.
T
d
We first claim that, for any Î± âˆˆ (Z[1/p] [0, 1)) such that Î±i 6= 0 for some
q
Î±
h Î±
1 â‰¤ i â‰¤ d, the cohomology H (Î“, T Dr /p T Dr ) is killed by (Ç«(1) âˆ’ 1)2 for any
q, h. Using Hochschild-Serre spectral sequence, we are reduced to showing that the
cohomology of the complex
Î³i âˆ’1

Â· Â· Â· âˆ’â†’ 0 âˆ’â†’ T Î± Dr /ph T Î± Dr âˆ’â†’ T Î± Dr /ph T Î± Dr âˆ’â†’ 0 âˆ’â†’ Â· Â· Â·
is killed by Ç«Î±i âˆ’ 1 (as Î±i 6= 0, Î±Î±i âˆ’ 1|Ç«(1) âˆ’ 1), or in an equivalent way, the
cohomology of the complex
Â· Â· Â· âˆ’â†’ 0 âˆ’â†’ Dr /ph Dr

Ç«Î±i Î³i âˆ’1

âˆ’â†’ Dr /ph Dr âˆ’â†’ 0 âˆ’â†’ Â· Â· Â·

66

FUCHENG TAN, JILONG TONG

is killed by Ç«Î±i âˆ’ 1. By definition,
=
=

(Ç«Î±i Î³i âˆ’ 1)(Î¾Ëœ[n0 ] u[n] w[n] )
Ëœ i )[ni ] Â· Q u[nj ] Â· w[n] âˆ’ Î¾Ëœ[n0 ] u[n] w [n]
Ç«Î±i Î¾Ëœ[n0 ] (ui âˆ’ (Ç«(1) âˆ’ 1)Î¾T
j6=i

j

(Ç« âˆ’ 1)Î¾Ëœ[n0 ] u[n] w [n] + (Ç«(1) âˆ’ 1)Î·
(Ç«Î±i âˆ’ 1)(Î¾Ëœ[n0 ] u[n] w[n] + Î· â€² )
Î±i

=

where Î· and Î· â€² are linear combinations of elements of the form Î¾Ëœ[m0 ] u[m] w[m] with
|m| = r such that mi < ni . Note that we have the last equality because (Ç«Î±i âˆ’
1)|(Ç«(1) âˆ’ 1). So if we write down the matrix M of Ç«Î± Î³i âˆ’ 1 with respect to the
basis {Î¾Ëœn0 u[n] w [n] : |n| = r} (the elements of this basis is ordered by the increasing
value of the number ni ), then M = (Ç«Î±i âˆ’ 1) Â· U with U a unipotent matrix.
In particular U is invertible and hence the kernel and the cokernel of the map
Ç«Î±i Î³i âˆ’ 1 : Dr /ph Dr â†’ Dr /ph Dr are killed by Ç«Î±i âˆ’ 1, and hence by Ç«(1) âˆ’ 1.
Now set
M
+
.
X :=
Se+ Â· T Î± âŠ‚ Seâˆ
Î±âˆˆ(Z[1/p]

T
[0,1))d \{(0,Â·Â·Â· ,0)}

By what we have shown above, H q (Î“, X âŠ—Se+ Dr /ph ) is killed by (Ç«(1) âˆ’ 1)2 for all
q, h. Hence a standard use of spectral sequence involving the higher derived functor
b Se+ Dr ) is killed by (Ç«(1) âˆ’ 1)4 for all q. On the other
of lim shows that H q (Î“, X âŠ—
â†âˆ’
b âŠ— e+ Dr and one checks
b Se+ Dr = X
hand, as Dr is an Se+ -module of finite rank, X âŠ—
S
L
b âŠ— e+ Dr ). Therefore, the canonical map
easily that grr OAcris = Dr (X
S
H q (Î“, Dr ) âˆ’â†’ H q (Î“, grr OAcris )

is injective with cokernel killed by (Ç«(1) âˆ’ 1)4 , hence by some power of p.

It remains to show that H q (Î“, Dr ) âŠ‚ H q (Î“, grr OAcris ) is contained in the image
of (6.2.1). To see this, we shall use a different basis for the free Se+ -module Dr .
For each 1 â‰¤ i â‰¤ d, set
 â™­
[m]
 â™­  X
âˆ
[Ti ]
[Ti ]
=
(âˆ’1)mâˆ’1 (m âˆ’ 1)!
âˆ’1
.
vi = log
Ti
Ti
m=1

Then vi â‰¡ âˆ’Tiâˆ’1 ui mod Fil2 Acris , and Î³i (vi ) = vi + t. Moreover, as t â‰¡ (Ç«(1) âˆ’
1)Î¾Ëœ Fil2 Acris , we see that
M
M
Se+ (Ç«(1) âˆ’ 1)n0 Î¾Ëœ[n0 ] u[n] w [n] =
Se+ t[n0 ] v [n] w [n]
Mr :=
|n|=r

Let

Mr0

:=

L

|n|=r

Zp t

|n|=r

[n0 ] [n]

v

w

[n]

e+

. Then Mr â‰ƒ S âŠ—Zp Mr0 . In particular we find

H q (Î“, Mr ) â‰ƒ Se+ âŠ—Zp H q (Î“, Mr0 ).

fr (resp. M
fr0 ) be the B âŠ—
b A OAcris (R, R+ )-submodule (resp.
On the other hand, let M
r
the Zp -submodule) of Fil OAcris generated by {t[n0 ] v [n] w [n] }|n|=r . Since Î³i (vi ) =
fr and M
fr0 are both stable under the action of Î“. Moreover, the natural
vi + t, M
r
fr Ö‰ Mr . Now
morphism Fil OAcris â†’ grr OAcris induces a surjective morphism M

Crystalline comparison isomorphism in p-adic Hodge theory

67

we have the following tautological commutative diagram
sur.

fr0 )
b A OAcris (R, R+ )) âŠ—Zp H q (Î“, M
(B âŠ—

â‰ƒ


fr )
H q (Î“, M


H q (Î“, Filr OAcris )

/ Se+ âŠ—Zp H q (Î“, Mr0 ) .

/ H q (Î“, Mr )
Î²

(6.2.1)


/ H q (Î“, grr OAcris )

But the morphism Î² can be decomposed as the composite of two morphisms
H q (Î“, Mr ) â†’ H q (Î“, Dr ) Ö’â†’ H q (Î“, grr OAcris )
which is killed by (Ç«(1) âˆ’ 1)r+4 . This concludes the proof of our lemma.



r

It remains to compute the Î“-invariants of Fil OBcris (Sâˆ , Sâˆ ). For this, we shall
b A Filr OAcris (R, R+ ).
first prove H 0 (Î“, Filr OAcris ) = B âŠ—
[Ç«]âˆ’1
Recall that Î¾Ëœ := [Ç«]1/p âˆ’1 . Put

([Ç«] âˆ’ 1)pâˆ’1
âˆˆ Acris [pâˆ’1 ].
p
+
+
For each x âˆˆ ker(Î¸ : OAcris (Seâˆ , Seâˆ
) â†’ Seâˆ
), set Î³(x) := xp /p. One checks that
Î³(x) âˆˆ OAcris and Î¸(Î³(x)) = 0.
We have the following observation.
Î· :=

Lemma 6.17 ([AB] Lemme 37). There exists Î» âˆˆ Î¾ÌƒW (Obâ™­ ) such that Î· = (p âˆ’
k
1)!Î¾Ëœ[p] + Î». In particular, Î· âˆˆ ker(Î¸ : Acris â†’ Ob ). Furthermore, Î³ Î½ (Î·) âˆˆ pâˆ’r Î·Acris
k
for any integers 0 â‰¤ Î½ â‰¤ r.
Lemma 6.18 ([AB] page 1011). There exists isomorphism
(Seâ™­+ /Î¾Ëœp )[Î·m , wj , Zj,m , ui , Ti,m ]1â‰¤i,jâ‰¤d;mâˆˆN
OAcris /p â‰ƒ âˆ
p
p
p
(Î·m
, wjp , Zj,m
, upi , Ti,m
)

where Î·m denotes the image of Î³ m (Î·) in OAcris /p. We have a similar assertion for
OAcris (R, R+ )/p.

â™­+
+
Proof. Recall that Î¾Ëœ is a generator of the kernel ker(Î¸ : W (Sâˆ
) â†’ Sâˆ
), hence we
have isomorphism
(S â™­+ /Î¾Ëœp )[Î´m , wj , Zj,m , ui , Ti,m ]1â‰¤i,jâ‰¤d;mâˆˆN
OAcris /p â‰ƒ âˆ
p
p
p
(Î´m
, wjp , Zj,m
, upi , Ti,m
)

Ëœ As Î· = (p âˆ’
where Î´m represents the image in OAcris /p of the element Î³ m+1 (Î¾).
â™­+
p
Ëœ (Oâ™­ ), it follows that Î·m âˆˆ (Sâˆ /Î¾Ìƒp )[Î´Î½ ]0â‰¤Î½â‰¤m âŠ‚ OAcris /p,
1)!Î¾Ëœ[p] + Î» for some Î» âˆˆ Î¾W
b
k

(Î´Î½ )0â‰¤Î½â‰¤m

p
â™­+ Ëœp
and Î·m
= 0, giving a morphism of Sâˆ
/Î¾ -algebras
â™­+ Ëœp
(S â™­+ /Î¾Ëœp )[Î´Î½ ]0â‰¤Î½â‰¤m
(S /Î¾ )[WÎ½ ]0â‰¤Î½â‰¤m
âˆ’â†’ âˆ p
,
Î±m : âˆ p
(WÎ½ )0â‰¤Î½â‰¤m
(Î´Î½ )0â‰¤Î½â‰¤m

WÎ½ 7â†’ Î·Î½ .

68

FUCHENG TAN, JILONG TONG

On the other hand, for any Î½ âˆˆ N,
Î½

Î³ ((p âˆ’ 1)!Î¾Ëœ[p] ) = Î³ Î½ (Î· âˆ’ Î») =
Î½

p
X

Î½

ai Î· [p

âˆ’i] [i]

Î»

i=0

â™­+ Ëœp
for some coefficients ai âˆˆ Sâˆ
/Î¾ , and Î»[i] âˆˆ

â™­+
(Sâˆ
/Î¾Ìƒ p )[Î´j ]0â‰¤jâ‰¤Î½âˆ’1
(Î´jp )0â‰¤jâ‰¤Î½âˆ’1

(as i â‰¤ pÎ½ ). By

induction on Î½, one checks that Î´Î½ âˆˆ Im(Î±m ), hence Î±m is an isomorphism for the
â™­+ Ëœp
reason of length. Taking direct limits, one deduces that the morphism of Sâˆ
/Î¾ algebras
(S â™­+ /Î¾Ëœp )[Wm ]mâˆˆN
(S â™­+ /Î¾Ëœp )[Î´m ]mâˆˆN
Î±: âˆ
âˆ’â†’ âˆ p
, Wm 7â†’ Î·m
p
(Wm )mâˆˆN
(Î´m )mâˆˆN
is an isomorphism, proving our lemma.

T
Lemma
6.19 ([AB] Lemme 38). For any r âˆˆ N, we have (pr OAcris ) Î·OAcris =
Pr
r Î½
Î½=0 p Î³ (Î·)OAcris .

Proof. The proof is done by induction on r. The
T case r = 0 is trivial. So we may
and do assume that r > 0. Let x âˆˆ pr OAcris Î·OAcris . By induction hypothesis,
one can write
râˆ’1
X
x=
prâˆ’1 Î³ Î½ (Î·)xÎ½ , with xÎ½ âˆˆ OAcris .
Set xâ€² :=
have

Prâˆ’1

Î½=0

Î½
â€²
r
Î½=0 Î³ (Î·)xÎ½ . Then x âˆˆ pOAcris since x âˆˆ p OAcris . So in OAcris /p, we
râˆ’1
X

Î·Î½ xÎ½ = 0,

Î½=0

where for a âˆˆ OAcris we denote by a its reduction modulo p and Î·Î½ the image of
Î³ Î½ (Î·) in OAcris /p. Let
(Seâ™­+ /Î¾Ëœp )[Î·h , wj , Zjm , ui , Tim ]1â‰¤iâ‰¤d,1â‰¤jâ‰¤Î´,mâˆˆN,hâ‰¥r
.
Î› := âˆ p p p
p
)1â‰¤iâ‰¤d,1â‰¤jâ‰¤Î´,mâˆˆN,hâ‰¥r
(Î·h , wj , Zjm , upi , Tim

p
Then OAcris /p â‰ƒ Î›[Î·m ]0â‰¤mâ‰¤râˆ’1 /(Î·m
)0â‰¤mâ‰¤râˆ’1 by the previous lemma. In parQrâˆ’1 Î±m
: Î± âˆˆ
ticular, OAcris /p is a free Î›-module with a basis given by { m=0 Î·m
{0, . . . , p âˆ’ 1}r }. Thus up to modifying the xÎ½ â€™s for 0 â‰¤ Î½ â‰¤ r âˆ’ 2, we may
assume that xÎ½ âˆˆ Î›[Î·0 , . . . , Î·Î½ ]/(Î·0p , . . . , Î·Î½p ).
Next we claim that xÎ½ âˆˆ Î·Î½pâˆ’1 (OAcris /p), which is also done by induction on Î½.
When Î½ = 0, as x0 âˆˆ Î›[Î·0 ]/(Î·0p ), we just need to show Î·0 x0 = 0. But

Î·0 x0 = âˆ’

râˆ’1
X

p
Î·h xh âˆˆ Î›[Î·0 , Î·1 , . . . , Î·râˆ’1 ]/(Î·0p , Î·1p , . . . , Î·râˆ’1
),

h=1

we have necessarily Î·0 x0 = 0, giving our claim for Î½ = 0. Let now Î½ âˆˆ {1, . . . , r âˆ’ 1}
such that for any 0 â‰¤ h â‰¤ Î½, xh âˆˆ Î·hpâˆ’1 (OAcris /p). So Î·h xh = 0 for 0 â‰¤ h â‰¤ Î½ and
Î·Î½ xÎ½ = âˆ’

râˆ’1
X

Î·l xl .

l=Î½+1

So necessarily Î·Î½ xÎ½ = 0, and hence xÎ½ âˆˆ Î·Î½pâˆ’1 (OAcris /p). This shows our claim for
any 0 â‰¤ Î½ â‰¤ r âˆ’ 1.

Crystalline comparison isomorphism in p-adic Hodge theory

69

As a result, for any 0 â‰¤ Î½ â‰¤ r âˆ’ 1, we have xÎ½ âˆˆ Î³ Î½ (Î·)pâˆ’1 OAcris + pOAcris , and
hence
prâˆ’1 Î³ Î½ (Î·)xÎ½ âˆˆ prâˆ’1 Î³ Î½ (Î·)p OAcris + pr Î³ Î½ (Î·)OAcris .
P
But prâˆ’1 Î³ Î½ (Î·)p = pr Î³ Î½+1 (Î·), so we get finally x âˆˆ rÎ½=0 pr Î³ Î½ (Î·)OAcris .


b A OAcris (R, R+ ) âŠ‚ OAcris (Proposition 6.11).
Recall that we have an injection B âŠ—
The key lemma is the following
Lemma 6.20 ([AB] Lemme 39). Inside OAcris , we have
\
b A OAcris (R, R+ )) Î·OAcris = Î·(B âŠ—
b A OAcris (R, R+ )).
(B âŠ—

Proof. The proof of the lemma is divided into several steps. First we remark that,
as B âŠ—A OAcris (R, R+ )/p Ö’â†’ OAcris /p, we have
\
b A OAcris (R, R+ )) pOAcris = p(B âŠ—
b A OAcris (R, R+ )).
(B âŠ—
Secondly, we claim that, to show our lemma, it is enough to prove that
\
b A OAcris (R, R+ )) Î·OAcris âŠ‚ Î·(B âŠ—
b A OAcris (R, R+ )) + pÎ·OAcris .
(6.2.2) (B âŠ—
Indeed, once this is done, we obtain
T
b A OAcris (R, R+)) Î·OAcris
(B âŠ—
T
b A OAcris (R, R+ ))
b A OAcris (R, R+ )) + pÎ·OAcris (B âŠ—
âŠ‚
Î·(B âŠ—

T
+
b A OAcris (R, R )) + p Î·OAcris (B âŠ—
b A OAcris (R, R+ ))
=
Î·(B âŠ—
âŠ‚

âŠ‚

b A OAcris (R, R+ )) + p Î·(B âŠ—
b A OAcris (R, R+ )) + pÎ·OAcris
Î·(B âŠ—
b A OAcris (R, R+ )) + p2 Î·OAcris .
Î·(B âŠ—



An iteration of this argument shows that
\
b A OAcris (R, R+)) Î·OAcris âŠ‚ Î·(B âŠ—
b A OAcris (R, R+ )) + pr Î·OAcris
(B âŠ—
T
b A OAcris (R, R+)) Î·OAcris âŠ‚ Î·(B âŠ—
b A OAcris (R, R+ )) as
for any r âˆˆ N. Thus (B âŠ—
+
b
OAcris and B âŠ—A OAcris (R, R ) are p-adically complete.

Next we claim that for any r âˆˆ N we have
\
b A OAcris (R, R+ )) Î·OAcris âŠ‚ Î·(B âŠ—
b A OAcris (R, R+ )) + pr OAcris .
(6.2.3) (B âŠ—

When r = 0, this is trivial. Assume now the inclusion above holds for some r âˆˆ N.
So by Lemma 6.19
T
b A OAcris (R, R+ )) Î·OAcris
(B âŠ—
T
T
b A OAcris (R, R+ )) + (B âŠ—
b A OAcris (R, R+ )) pr OAcris Î·OAcris
âŠ‚
Î·(B âŠ—
T
P
b A OAcris (R, R+ )) + (B âŠ—
b A OAcris (R, R+ )) pr ( rÎ½=0 Î³ Î½ (Î·)OAcris )
âŠ‚
Î·(B âŠ—

T P
b A OAcris (R, R+ )) + pr (B âŠ—
b A OAcris (R, R+ )) ( rÎ½=0 Î³ Î½ (Î·)OAcris ) .
âŠ‚ Î·(B âŠ—
So we are reduced to showing that
b A OAcris R, R
BâŠ—

Put

r
 \ X
+

Î›(R, R+ ) :=

Î½=0

Î³ Î½ (Î·)OAcris

!!

b A OAcris (R, R+ ))+pOAcris .
âŠ‚ pâˆ’r Î·(B âŠ—

(Râ™­+ /Î¾Ëœp )[wj , Zjm ]1â‰¤jâ‰¤Î´,mâˆˆN
âŠ‚ OAcris (R, R+ )/p,
p
)1â‰¤jâ‰¤Î´,mâˆˆN
(wjm , Zjm

70

FUCHENG TAN, JILONG TONG

and
+
Î›(Seâˆ , Seâˆ
) :=

â™­+ Ëœp
(Seâˆ
/Î¾ )[wj , Zjm ]1â‰¤jâ‰¤Î´,mâˆˆN
âŠ‚ OAcris /p.
p
)1â‰¤jâ‰¤Î´,mâˆˆN
(wjm , Zjm

We claim that the natural morphism A â†’ OAcris (R, R+ )/p (resp. B â†’ OAcris /p)
+
factors through Î›(R, R+ ) (resp. through Î›(Seâˆ , Seâˆ
)[ui ]1â‰¤iâ‰¤d /(upi )1â‰¤iâ‰¤d ). Indeed,
we consider the reduction modulo p of the morphism Î¸
Î¸ : OAcris (R, R+ )/p âˆ’â†’ R+ /p.

Then all elements of ker(Î¸) are nilpotent, and Î¸(Î›(R, R+ )) = R+ /p. Recall that A
is eÌtale over Ok {S1Â±1 , . . . , SÎ´Â±1 } and the composite
Ok {S1Â±1 , . . . , SÎ´Â±1 } â†’ A â†’ OAcris (R, R+ )/p
sends Sj to the reduction modulo p of wj + Sjâ™­ âˆˆ OAcris (R, R+ )/p, which factors
through Î›(R, R+ ) and hence so does the morphism A â†’ OAcris (R, R+ )/p by the
eÌtaleness of the morphism Ok {S1Â±1 , . . . , SÎ´Â±1 } â†’ A. In a similar way, one sees that
+
the morphism B â†’ OAcris /p factors through Î›(Seâˆ , Seâˆ
)[ui ]1â‰¤iâ‰¤d /(upi )1â‰¤iâ‰¤d . In
particular, it makes sense to consider the map
e e+ i , Î·m ]1â‰¤iâ‰¤d,mâˆˆN
Î›(R, R+ )[Î·m ]mâˆˆN
e := Î›(Sâˆ , Spâˆ )[u
B âŠ—A
âˆ’â†’ Î›
,
p
p
(Î·m )mâˆˆN
(ui , Î·m
)1â‰¤iâ‰¤d,mâˆˆN
T Pr
Î½
b A OAcris (R, R+ ))
which is injective. Now for xPâˆˆ (B âŠ—
Î½=0 Î³ (Î·)OAcris , its rer
duction x modulo p lies in
Î½=0 Î·Î½ OAcris /p. On the other hand, as a module
e
e âŠ‚ OAcris /p is a direct factor of OAcris /p
OAcris /p is free over Î› and the inclusion Î›
e
as Î›-modules, the fact that x appears in the image of the morphism above (note
p
that OAcris (R, R+ )/p = Î›(R, R+ )[Î·m ]mâˆˆN /(Î·m
)mâˆˆN ) implies that
r
X
e
xâˆˆ
Î·Î½ Î›.
Î½=0

Thus

xâˆˆ

r
X

Î½=0

p
b A Î›(R, R+ ))[Î·m ]mâˆˆN /(Î·m
Î·Î½ (B âŠ—
)mâˆˆN

p
e are free over B âŠ—A Î›(R, R+ ) and over
as (B âŠ—A Î›(R, R+ ))[Î·m ]mâˆˆN /(Î·m
)mâˆˆN and Î›
Q
p
Î±m
+
:Î±âˆˆ
Î›(R, R )[ui ]1â‰¤iâ‰¤d /(ui )1â‰¤iâ‰¤d respectively , with a basis given by { mâˆˆN Î·m
(N)
{0, . . . , p âˆ’ 1} }. In other words, this shows
r
X
b A OAcris (R, R+ )) + pOAcris .
xâˆˆ
Î³ Î½ (Î·)(B âŠ—
Î½=0

b A OAcris (R, R+ )), we obtained finally
By Lemma 6.17, Î³ (Î·) âˆˆ pâˆ’r Î·(B âŠ—
b A OAcris (R, R+ )) + pOAcris ,
x âˆˆ pâˆ’r Î·(B âŠ—
Î½

as desired.
To complete the proof, it remains to show that the inclusions
(6.2.3) for all
QÎ½
r âˆˆ N implies (6.2.2). For Î½ â‰¥ âˆ’1 an integer, set Î²Î½ := i=0 Î³ i (Î·)pâˆ’1 . A direct
calculation shows Î·Î²Î½ = pÎ½+1 Î³ Î½+1 (Î·) for any Î½ â‰¥ âˆ’1. Let
+
Î›(Seâˆ , Seâˆ
)[ui , Tim ]1â‰¤iâ‰¤d,mâˆˆN
Î› :=
.
p
p
(ui , Tim
)1â‰¤iâ‰¤d,mâˆˆN

Crystalline comparison isomorphism in p-adic Hodge theory

71

p
Then OAcris /p = Î›[Î·m ]mâˆˆN /(Î·m
)mâˆˆN . Recall also that
p
OAcris (R, R+ ) = Î›(R, R+ )[Î·m ]mâˆˆN /(Î·m
)mâˆˆN .

For Î½ â‰¥ âˆ’1, let MÎ½ (resp. NÎ½ ) be the sub-Î›-module (resp. sub-B âŠ—A Î›(R, R+ )module) of OAcris /p (resp. of B âŠ—A OAcris (R, R+ )/p) generated by the family
)
( âˆ
Y
(N)
Î±m
Î·m : Î± âˆˆ {0, . . . , p âˆ’ 1} , Î±m = p âˆ’ 1 for 0 â‰¤ m â‰¤ Î½, Î±Î½+1 < p âˆ’ 1 .
m=0

Clearly NÎ½ âŠ‚ MÎ½ , OAcris /p = âŠ•Î½â‰¥âˆ’1 MÎ½ , and B âŠ—A OAcris (R, R+ )/p = âŠ•Î½â‰¥âˆ’1 NÎ½ .
T
b A OAcris (R, R+ )) Î·OAcris , and write z = Î·z â€² with z â€² âˆˆ OAcris . Let
Let z âˆˆ (B âŠ—
N be an integer such that
N
M
zâ€² âˆˆ
MÎ½ .
Î½=âˆ’1

By (6.2.3) for r = N + 2, one can write

\
b A OAcris (R, R+ ) and w âˆˆ pN +2 OAcris Î·OAcris .
with y âˆˆ B âŠ—
PN +2
By Lemma 6.19, w = pN +2 i=0 Î³ i (Î·)Î±i with Î±i âˆˆ OAcris . So we find
z = Î· Â· y + w,

w=

N
+2
X

pN +2âˆ’i pi Î³ i (Î·)Î±i =

PN +2

Therefore z = y + i=0 p
definition of the integer N ,

pN +2âˆ’i Î·Î²iâˆ’1 Î±i .

i=0

i=0

â€²

N
+2
X

N +2âˆ’i

Î²iâˆ’1 Î±i and thus z â€² = y + Î²N +1 Î±N +2 . But by the
zâ€² âˆˆ

N
M

MÎ½

Î½=âˆ’1

while
yâˆˆ

âˆ
M

Î½=âˆ’1

NÎ½

and Î²N +1 Î±N +2 âˆˆ

M

MÎ½ .

Î½>N
+

So necessarily Î²N +1 Î±N +2 âˆˆ âŠ•Î½>N NÎ½ âˆˆ B âŠ—A OAcris (R, R )/p. In other words, we
b A OAcris (R, R+ ) + pOAcris . So finally
find Î²N +1 Î±N +2 âˆˆ B âŠ—
b A OAcris (R, R+ )) + pÎ·OAcris ,
z âˆˆ Î·(y + Î²N +1 Î±N +2 ) âˆˆ Î·(B âŠ—
as required by (6.2.2). This finishes the proof of this lemma.



Corollary 6.21 ([AB] Corollaire 40). Inside OAcris , we have
\
b A OAcris (R, R+ )) ([Ç«] âˆ’ 1)pâˆ’1 OAcris = ([Ç«] âˆ’ 1)pâˆ’1 (B âŠ—
b A OAcris (R, R+ )).
(B âŠ—
T
b A OAcris (R, R+ )) ([Ç«] âˆ’ 1)pâˆ’1 OAcris . As pÎ· = ([Ç«] âˆ’ 1)pâˆ’1 , x âˆˆ
Proof. Let x âˆˆ (B âŠ—
T
+
b A Filr OAcris (R, R+ )) pOAcris = p(B âŠ—
b
(B âŠ—
Lemma
T A OAcris (R, R )). Thus, by
+
b
b
6.20, we find x/p âˆˆ (B âŠ—A OAcris (R, R )) Î·OAcris = Î·(B âŠ—A OAcris (R, R+ )). Thereb A OAcris (R, R+ )) = ([Ç«] âˆ’ 1)pâˆ’1 (B âŠ—
b A OAcris (R, R+ )).
fore x âˆˆ pÎ·(B âŠ—


Finally, we can assemble the previous results to get the main result about the
Î“-invariants.

72

FUCHENG TAN, JILONG TONG

Proposition 6.22 ([AB] Proposition 41). For each r âˆˆ N, the natural injection
b A Filr OAcris (R, R+ ) âˆ’â†’ H 0 (Î“, Filr OAcris )
Î¹r : B âŠ—

is an isomorphism.

Proof. We shall begin with the case where r = 0. By Proposition 6.11 (ii), the
b A OAcris (R, R+ ) â†’ H 0 (Î“, OAcris ) is injective with cokernel
natural morphism B âŠ—
2d
killed by (1 âˆ’ [Ç«]) . It remains to show that the latter map is also surjective. Let
b A OAcris (R, R+ ). In particular,
x âˆˆ H 0 (Î“, OAcris ). So (1 âˆ’ [Ç«])2d x âˆˆ B âŠ—
\
b A OAcris (R, R+ )
(1 âˆ’ [Ç«])2d(pâˆ’1) x âˆˆ B âŠ—
(1 âˆ’ [Ç«])2d(pâˆ’1) OAcris .

b A OAcris (R, R+ )).
By Corollary 6.21, the last intersection is just (1 âˆ’ [Ç«])2d(pâˆ’1) (B âŠ—
+
b A OAcris (R, R ); note that 1 âˆ’ [Ç«] is a regular element. This
In particular, x âˆˆ B âŠ—
concludes the proof of our proposition for r = 0. Assume now r > 0 and that
the statement holds for Filrâˆ’1 OAcris . Then we have the following commutative
diagram with exact rows
0

/ BâŠ—
b A Filr OAcris (R, R+ )
Î¹r

0


/ H 0 (Î“, Filr OAcris )

/ BâŠ—
b A Filrâˆ’1 OAcris (R, R+ )
Î¹râˆ’1



/ H 0 (Î“, Filrâˆ’1 OAcris )

/ BâŠ—
b A grrâˆ’1 OA cris (R, R+ )
_

/ H 0 (Î“, grrâˆ’1 OAcris )

b A R+ = Se+ âŠ‚
One checks easily that the last vertical morphism is injective as B âŠ—
+
Seâˆ
. So by snake lemma, that Î¹râˆ’1 is an isomorphism implies that the morphism
Î¹r is also an isomorphism. This finishes the induction and hence the proof of our
proposition.

Corollary 6.23 ([AB] Corollaire 42). The natural morphism
b A Filr OBcris (R, R+ ) âˆ’â†’ H 0 (Î“, Filr OBcris )
BâŠ—

is an isomorphism, where
b A Filr+n OAcris (R, R+ )
b A Filr OBcris (R, R+ ) := lim B âŠ—
BâŠ—
âˆ’â†’
nâ‰¥0

with transition maps given by multiplication by t.
References

[AB] F. Andreatta, O. Brinon: AcycliciteÌ geÌomeÌtrique de Bcris , Comment. Math. Helv. 88 (2013),
965-1022.
[AI] F. Andreatta, A. Iovita: Comparison Isomorphisms for Smooth Formal Schemes, Journal de
lâ€™Institut de MatheÌmatiques de Jussieu (2013) 12(1), 77-151.
[Ber86] P. Berthelot, GeÌomeÌtrie rigide et cohomologie des varieÌteÌs algeÌbriques de caracteÌristique
p, Bull. Soc. Math. France, MeÌmoire 23 (1986), 7-32.
[Ber96] P. Berthelot, Cohomologie rigide et cohomologie rigide aÌ€ supports propres, PremieÌre partie, Preprint IRMAR 96-03 (1996), 91 pp.
[BO] P. Berthelot, A. Ogus, Notes on crystalline cohomology, Princeton University Press, 1978.
[Bri] O. Brinon, RepreÌsentations p-adiques cristallines et de de Rham dans le cas relatif,
MeÌmoires de la SMF 112 (2008).
[Fal] G. Faltings, Crystalline cohomology and p-adic Galois representations, Algebraic analysis,
geometry, and number theory, Johns Hopkins Univ. Press (1989), 25-80.
[Fon82] J.-M.Fontaine, Sur certains types de repreÌsentations p-adiques du group de Galois dâ€™un
corps local; construction dâ€™un anneau de Barsotti-Tate, Ann. of Math. (2) 115 (1982), 529577.

/0

Crystalline comparison isomorphism in p-adic Hodge theory

73

[Fon94] J.-M. Fontaine, Le corps des peÌriodes p-adiques, PeÌriodes p-adiques (Bures-sur-Yvette,
1988), AsteÌrisque 223 (1994), 59-111.
[GR] O. Gabber, L. Ramero, Almost ring theory, LNM 1800, Springer-Verlag, Berlin, 2003.
[Hub] R. Huber, EÌtale cohomology of rigid analytic varieties and adic spaces, Aspects of Mathematics, E 30. Friedr. Vieweg & Sohn, Braunschweig, 1996.
[Hub94] R. Huber, A generalization of formal schemes and rigid analytic varieties, Math. Z. 217
(1994), 513-551.
[Jan] U. Jannsen, Continuous eÌtale cohomology, Math. Ann. 280(1988), 207-245.
[Sch13] P. Scholze, p-adic Hodge theory for rigid-analytic varieties, Forum of Mathematics, Pi, 1
(2013), 1-77.
[SGA4] M. Artin, A. Grothendieck, J.-L. Verdier, TheÌorie des topos et cohomologie eÌtale des
scheÌmas, LNM 269, 270, 305, Springer Verlang, 1972, 1973.
[Tat] J. Tate, p-divisible groups, Proc. Conf. Local Fields (Driebergen, 1966), 158-183, Springer,
Berlin, 1967.
[Tsu] N. Tsuzuki, On base change theorem and coherence in rigid cohomology, Kazuya Katoâ€™s
fiftieth birthday, Doc. Math. 2003, Extra Vol., 891?918

Fucheng Tan
800 Dongchuan Rd
Department of Mathematics, Shanghai Jiao Tong University
Shanghai 200240, China
and
220 Handan Rd
Shanghai Center for Mathematical Sciences
Shanghai 200433, China
Email: fuchengtan@sjtu.edu.cn

Jilong Tong
Institut de MatheÌmatiques de Bordeaux
UniversiteÌ de Bordeaux
351, cours de la LibeÌration
F-33405 Talence cedex, France
Email: jilong.tong@math.u-bordeaux1.fr

