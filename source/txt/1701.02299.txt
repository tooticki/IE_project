HAUSDORFF DIMENSION OF UNIONS OF AFFINE
SUBSPACES AND OF FURSTENBERG-TYPE SETS

arXiv:1701.02299v3 [math.MG] 6 Mar 2018

K. HÉRA, T. KELETI, AND A. MÁTHÉ
Abstract. We prove that for any 1 ≤ k < n and s ≤ 1, the union of any
nonempty s-Hausdorff dimensional family of k-dimensional affine subspaces
of Rn has Hausdorff dimension k + s. More generally, we show that for any
0 < α ≤ k, if B ⊂ Rn and E is a nonempty collection of k-dimensional affine
subspaces of Rn such that every P ∈ E intersects B in a set of Hausdorff dimension at least α, then dim B ≥ 2α − k + min(dim E, 1), where dim denotes
the Hausdorff dimension. As a consequence, we generalize the well-known
Furstenberg-type estimate that every α-Furstenberg set has Hausdorff dimension at least 2α; we strengthen a theorem of Falconer and Mattila [5]; and we
show that for any 0 ≤ k < n, if a set A ⊂ Rn contains the k-skeleton of a
rotated unit cube around every point of Rn , or if A contains a k-dimensional
affine subspace at a fixed positive distance from every point of Rn , then the
Hausdorff dimension of A is at least k + 1.

1. Introduction
There are several problems gathering around the general principle that an sdimensional collection of d-dimensional sets in Rn must have positive measure if
s + d > n and Hausdorﬀ dimension s + d if s + d ≤ n, unless the sets have large
intersections. For example, Wolﬀ [18, 19] proved that if a planar set B contains a
circle around every point of a Borel set S ⊂ R2 of Hausdorﬀ dimension s then B
has positive Lebesgue measure provided s > 1, and the Hausdorﬀ dimension of B
is at least s + 1 when s ≤ 1. Most of these problems are only partially solved. The
most famous example is the Kakeya conjecture, which states that every Besicovitch
set (a compact set that contains a unit line segment in every direction) in Rn has
Hausdorﬀ dimension n, see e.g [12]. Note that the directions of lines of Rn form a
set of dimension n − 1, so the line segments of a Besicovitch set form a collection of
Hausdorﬀ dimension at least n − 1, so the above principle would indeed imply the
Kakeya conjecture. On the other hand, the following trivial example shows that
this principle cannot be applied for every s-dimensional collection of lines: for any
collection of lines of a ﬁxed plane of R3 the union clearly has Hausdorﬀ dimension
at most 2, which is less than s + 1 if s > 1. In this paper we show that the above
principle holds for any s-dimensional collection of lines or even k-dimensional aﬃne
subspaces provided that s ≤ 1.
Theorem 1.1. For any integers 1 ≤ k < n and s ∈ [0, 1] the union of any nonempty
s-Hausdorff-dimensional family of k-dimensional affine subspaces of Rn has Hausdorff dimension s + k.

For the special case k = n − 1 this was proved by Oberlin [14] for compact (or
analytic) families of hyperplanes. He also proved [15] that for any integers 1 ≤ k < n
and any s ≥ 0, the union of any nonempty compact (or analytic) s-Hausdorﬀdimensional family of k-dimensional aﬃne subspaces of Rn has Hausdorﬀ dimension
This research was supported by the Hungarian National Research, Development and Innovation
Office – NKFIH, 104178, and the first author was also supported by the ÚNKP-16-3 New National
Excellence Program of the Ministry of Human Capacities.
1

2

K. HÉRA, T. KELETI, AND A. MÁTHÉ

at least min{n, 2k − k(n − k) + s}. Moreover, he proved that s > (k + 1)(n − k) − k
implies positive Lebesgue measure for such unions, and the bound for s is sharp. His
results are in harmony with the above heuristic principle in the case of hyperplanes.
Falconer and Mattila [5] proved a stronger statement both in the s ≤ 1 and s > 1
cases for hyperplanes: instead of full n − 1-dimensional aﬃne subspaces it is enough
to take a positive measure subset of each of them.
We can go even further for any k < n: it is enough to take a k-Hausdorﬀ
dimensional subset of each k-dimensional subspace:
Theorem 1.2. Let 1 ≤ k < n be integers and s ∈ [0, 1]. If E is a nonempty
s-Hausdorff
dimensional family of k-dimensional affine subspaces and B is a subset
S
of P ∈E P such that B ∩ P has Hausdorff dimension k for every P ∈ E then
!
[
(1)
dim B = dim
P = s + k,
P ∈E

where here and in the sequel dim denotes Hausdorff dimension.

Note that this theorem does not assume any kind of measurability of E (or B),
unlike the mentioned results of Oberlin and Falconer and Mattila.
As we explained above, the equality on the right hand side of (1) is not true
without the restriction s ≤ 1. But it is possible that the equality on the left hand
side always holds. If it holds for k = 1 in Rn for all n ≥ 2, it would imply that
Besicovitch sets in Rn have Hausdorﬀ dimension at least n−1 and upper Minkowski
dimension n, see [9].


S
S
In Theorem 1.2, dim B ≤ dim
P ∈E P ≤ s + k is
P ∈E P is obvious, dim
easy (Lemma 2.4), the essence of the result is the estimate dim B ≥ s + k.

It is natural to ask what happens if we go further and take the union of αHausdorﬀ dimensional subsets of an s-dimensional family of k-dimensional aﬃne
subspaces of Rn for some s ≤ 1 and α ∈ (0, k]. Our most general result (Theorem 2.1) gives that in this case the union has Hausdorﬀ dimension at least 2α−k+s.
Note that this result implies a known Furstenberg-type estimate. Let 0 < α ≤ 1
and suppose that F ⊂ R2 is a Furstenberg set: a compact set such that for every
e ∈ S 1 there is a line Le in direction e for which dim Le ∩ F ≥ α, see e.g. [12].
Since the sets Le form an at least 1-dimensional collection of lines of R2 our above
mentioned result gives dim F ≥ 2α − 1 + 1 = 2α.
Molter and Rela [13] proved that if E ⊂ S 1 has Hausdorﬀ dimension s, F ⊂ R2
and for every e ∈ S 1 there is a line Le in direction e for which dim Le ∩ F ≥ α then
dim F ≥ 2α − 1 + s and dim F ≥ α + 2s . So our result is also a generalization of the
ﬁrst estimate of Molter and Rela.
Our original motivation comes from the following question: What is the minimal
Hausdorﬀ dimension of a set in Rn that contains the k-skeleton of a rotated unit
cube centered at every point of Rn ? In [1] it is proved that for every 0 ≤ k < n there
exist such sets of Hausdorﬀ dimension at most k + 1. As a fairly quick application
of the above results we show (Theorem 2.6) that for every 0 ≤ k < n such a set
must have Hausdorﬀ dimension at least k + 1, so k + 1 is the minimal Hausdorﬀ
dimension. We remark that if we have k-skeletons of rotated and scaled cubes
centered at every point then the minimal Hausdorﬀ dimension is k, see [1], and
if we allow only scaled axis-parallel cubes then the minimal Hausdorﬀ dimension
is n − 1, see [10] for k = 1, n = 2 and [16] for the general case. We also show
(Theorem 2.6) that if A contains a k-dimensional aﬃne subspace at a ﬁxed positive
distance from every point of Rn , then the Hausdorﬀ dimension of A is at least k + 1.
The paper is organized as follows: In Section 2 we state our most general result
(Theorem 2.1), and prove its corollaries. In Section 3 we prove Theorem 2.1 subject

HAUSDORFF DIMENSION OF UNIONS OF AFFINE SUBSPACES

3

to a lemma (Lemma 3.7), which will be proved in Sections 4 and 5. In Section 4
we prove a purely geometrical lemma, which will be used during the L2 estimation
procedure in Section 5 to prove Lemma 3.7.
Notation 1.3. For any integers 1 ≤ k < n, let A(n, k) denote the space of all
k-dimensional aﬃne subspaces of Rn . For any s ≥ 0, δ ∈ (0, ∞] and A ⊂ Rn ,
the s-dimensional Hausdorﬀ δ-premeasure of A will be denoted by Hδs (A), the
s-dimensional Hausdorﬀ measure by Hs (A), and the Hausdorﬀ dimension of A by
dim A. The open ball of center x and radius r will be denoted by B(x, r) or Bρ (x, r)
if we want to indicate the metric ρ. For a set U ⊂ Rn , Uδ = ∪x∈U B(x, δ) denotes
the open δ-neighborhood of U . We will use the notation a .α b if a ≤ Cb where C
is a constant depending on α. If it is clear from the context what C should depend
on, we may write only a . b.
2. The most general theorem and its corollaries
Our most general result is the following:
Theorem 2.1. Let 1 ≤ k < n be integers, let A(n, k) denote the space of all kdimensional affine subspaces of Rn and consider any natural metric on A(n, k). Let
0 < α ≤ k be any real number. Suppose that B ⊂ Rn , ∅ 6= E ⊂ A(n, k) and for
every k-dimensional affine subspace P ∈ E, dim (P ∩ B) ≥ α. Then
dim B ≥ 2α − k + min(dim E, 1).

(2)

Remark 2.2. An example for such a metric on A(n, k) is deﬁned in [11], p. 53.
Let ρ denote the given metric on A(n, k). We say that ρ is a natural metric if ρ
and the metric d deﬁned in [11] are strongly equivalent; that is, there exist positive
constants K1 and K2 such that, for every P, P ′ ∈ A(n, k), K1 ·d(P, P ′ ) ≤ ρ(P, P ′ ) ≤
K2 · d(P, P ′ ).

Remark 2.3. For α = k and dim E ≤ k + 1 the estimate (2) is sharp in the sense
that for any s ∈ [0, k + 1] there exist sets E and B with the above property and
dim E = s such that we have equality in (2): it is easy to see using Theorem 1.2
that we obtain such an example by letting E to be any s-Hausdorﬀ dimensional
collection of k-dimensional aﬃne subspaces of a ﬁxed k + 1-dimensional subspace
of Rn and B = ∪P ∈E P .
Clearly, (2) can be a good estimate only when α is close to k: for α < k − 1
the right-hand side of (2) is less than α but trivially, dim B ≥ α. Since ﬁnding the
best estimate for the n = 2, k = 1, dim E = 1, α < 1 case is essentially equivalent to
ﬁnding the minimal Hausdorﬀ dimension of a Furstenberg set, this cannot be easy
and it is unlikely that our estimate is sharp for any α < k.
By combining the α = k case of Theorem 2.1 and the following lemma, we obtain
Theorem 1.2, and its special case Theorem 1.1.
Lemma 2.4. For any 1 ≤ k < n integers and ∅ 6= E ⊂ A(n, k) we have
!
[
dim
P ≤ k + dim E.
P ∈E

Proof. By taking a ﬁnite decomposition of E if necessary, we can assume that there
exists a P0 ∈ A(n, k) such that the orthogonal projection of P0 onto any P ∈ E is
P . Fix such a P0 . For any P ∈ E and t ∈ P0 let h(P, t) be the orthogonal
S projection
of t onto P . Then h({P } × P0 ) = P for any P ∈ E, so h(E × P0 ) = P ∈E P . It is
not hard to check that h : E × P0 → Rn is locally Lipschitz, therefore we obtain
!
[
dim
P = dim (h(E × P0 )) ≤ dim (E × P0 ) = dim E + k.
P ∈E

4

K. HÉRA, T. KELETI, AND A. MÁTHÉ


Now we show a simple direct application of Theorem 2.1.
Corollary 2.5. Let 0 ≤ k < n be integers, 0 ≤ α ≤ k, ∅ 6= C ⊂ Rn , and B ⊂ Rn
such that for every x ∈ C there exists a k-dimensional affine subspace P containing
x such that P intersects B in a nonempty set of Hausdorff dimension at least α.
Then dim B ≥ 2α − k + min(dim C − k, 1).
Specially, if 1 ≤ k and a set A ⊂ Rn contains a k-dimensional punctured affine
subspace through every point of a set C with dim C ≥ k + 1, then dim A ≥ k + 1.
Proof. If k = 0, or k ≥ 1 and α = 0, then the statement clearly holds. Suppose now
k ≥ 1, α > 0. Let E ⊂ A(n, k) be the set of those k-dimensional aﬃne subspaces
that
S intersect B in a nonempty set of Hausdorﬀ dimension at least α. Then C ⊂
P ∈E P , thus dim C ≤ dim E + k by Lemma 2.4, which means, dim E ≥ dim C − k.
Applying Theorem 2.1 for B and E, we obtain dim B ≥ 2α − k + min(dim C −
k, 1).

Our next goal is to show that if a set B ⊂ Rn contains the k-skeleton of a rotated
unit cube around every point of Rn then dim B ≥ k + 1, as it was already stated in
the Introduction. Instead of the k-skeleton of the unit cube we will prove (Corollary
2.8) the analogous result for any k-Hausdorﬀ dimensional set S ⊂ Rn that can be
covered by countably many k-dimensional aﬃne subspaces. This result will follow
from the following theorem.
Theorem 2.6. Let 0 ≤ k < n be integers, 0 ≤ α ≤ k and 0 ≤ r be real numbers,
∅ 6= C ⊂ Rn , and B ⊂ Rn be such that for every x ∈ C there exists a k-dimensional
affine subspace P at distance r from x such that P intersects B in a nonempty set
of Hausdorff dimension at least α. Then dim B ≥ 2α − k + dim C − (n − 1).
Specially, if B contains a k-dimensional affine subspace at a fixed positive distance from every point of Rn , or if B contains the k-skeleton of a rotated unit cube
around every point of Rn , then dim B ≥ k + 1.
Proof. If r = 0, then we can apply Corollary 2.5 and thus we get dim B ≥ 2α − k +
min(dim C − k, 1) ≥ 2α − k + dim C − (n − 1).
Suppose now that r > 0. If k = 0, then the condition of Theorem 2.6 means
that for
S every x ∈ C there exists a point contained in B at distance r from x.
Then p∈B (p + rS n−1 ) ⊃ C, where S n−1 denotes the unit sphere of center 0
in Rn . Let g : SRn × S n−1 → Rn , (p, e) 7→ p + re. Clearly, g is Lipschitz and
g(B × S n−1 ) = p∈B (p + rS n−1 ). Thus we have
[
dim C ≤ dim
(p + rS n−1 ) ≤ dim (B × rS n−1 ) = dim B + n − 1,
p∈B

thus dim B ≥ dim C − (n − 1).
If k ≥ 1 and α = 0, then the statement is trivially true, so suppose now that
k ≥ 1, α > 0. We will use a similar argument as in the case k = 0, but we use
Theorem 2.1. Let E ⊂ A(n, k) be the set of those k-dimensional aﬃne subspaces
that intersect B in a set of Hausdorﬀ dimension at least α. By Theorem 2.1 it is
enough to prove that dim E ≥ dim C − (n − 1). For each P ∈ E let D(P ) ⊂ Rn
be the union of those k-dimensional aﬃne subspaces that are parallel to P and are
at distance r from P (in the Euclidean distance of Rn ). Clearly, D(P ) is exactly
n
the
S set of those points of R that are at distance r from P , thus by assumption,
P ∈E D(P ) ⊃ C. It is easy to see that dim D(P ) = n − 1 for any P ∈ E.
For any P ∈ A(n, k), let VP denote the translate of P containing 0 and let VP⊥
denote the orthogonal complement of VP . It is easy to see that there is a ﬁnite

HAUSDORFF DIMENSION OF UNIONS OF AFFINE SUBSPACES

5

SN
decomposition E = i=1 Ei such that for all i there exists a Pi ∈ A(n, k) with the
following properties: the orthogonal projection of Pi onto any P ∈ Ei is P , and the
orthogonal projection of the (n − k − 1)-sphere VP⊥i ∩ S n−1 onto VP⊥ is contained in
the 21 -neighborhood of the (n − k − 1)-sphere VP⊥ ∩ S n−1 , for any P ∈ Ei .
Using the above properties, one can easily deﬁne for all i a locally Lipschitz map
hi : Ei × D(Pi ) → Rn such that hi ({P } × D(Pi )) = D(P ) for all P ∈ Ei . We obtain
[
[
dim C ≤ dim
D(P ) = max dim
D(P ) = max dim hi (Ei × D(Pi )) ≤
P ∈E

i

P ∈Ei

i

≤ max dim (Ei × D(Pi )) = max dim Ei + n − 1 = dim E + n − 1,
i

i

and thus dim E ≥ dim C − (n − 1) and we are done.



Remark 2.7. In the special cases mentioned in Theorem 2.6, the estimate is sharp.
It is easy to see that B = Rk+1 × Qn−k−1 contains a k-dimensional aﬃne subspace
at every positive distance from every point of Rn and clearly dim B = k + 1. The
construction given in [1] for a set B with dim B = k + 1 containing the k-skeleton
of a rotated unit cube centered at every point of Rn is also based on this example.
Corollary 2.8. Let 0 ≤ k < n be integers, S ⊂ Rn with dim S = k that can be
covered by a countable union of k-dimensional affine subspaces. Let ∅ =
6 C ⊂ Rn ,
n
A ⊂ R such that for all x ∈ C there exists a rotation T ∈ SO(n) such that A
contains x + T (S). Then dim A ≥ max(k, k + dim C − (n − 1)).
Proof. Clearly,Sdim A ≥ k. Let Si ⊂ Rn , i ≥ 1, be k-dimensional aﬃne subspaces
such that S ⊂ i≥1 Si . Let ri = d(0, Si ), and αi = dim (Si ∩S). Then supi≥1 αi = k
by dim S = k. The set A has the property that for all x ∈ Rn , there exists an aﬃne
subspace P = x + T (Si ) at distance ri from x such that dim (A ∩ P ) ≥ αi , thus we
can apply Theorem 2.6 for each i. We obtain that dim A ≥ 2αi − k + dim C − (n− 1)
for all i ≥ 1, and thus dim A ≥ k + dim C − (n − 1).

Remark 2.9. The authors in [1] show that the estimate in Corollary 2.8 is sharp
if dim C = n and S can be covered by a countable union of k-dimensional aﬃne
subspaces that do not contain the origin.
On the other hand, if the covering subspaces contain the origin, then the estimate
is not always sharp. Indeed, if S is a punctured line through the origin and C = Rn ,
then A is a Nikodym set, thus the conjecture is dim A = n. The lower bounds
obtained for the dimension of Besicovitch sets give lower bounds for the dimension
of Nikodym sets, thus for dim A as well. A survey of the currently best lower bounds
which is better than
can be found in [12]. As an example, by [17], dim A ≥ n+2
2
the bound 2 given by Corollary 2.8 provided n > 2.
3. The proof of Theorem 2.1
In this section we prove Theorem 2.1 subject to a lemma (Lemma 3.7), which
will be proved in Sections 4 and 5.
We start with addressing measurability issues. For the deﬁnition of analytic sets,
see e.g. [6].
Lemma 3.1. For X ⊂ Rn , α > 0 and c ≥ 0 let

α
Eα,c,X = {P ∈ A(n, k) : H∞
(P ∩ X) > c}.

If X ⊂ Rn is bounded Gδ , then Eα,c,X is analytic.

Lemma 3.1 is an unpublished result of M. Elekes and Z. Vidnyánszky. Similar
statements were also proved in [4]. For completeness, we include a proof here.

6

K. HÉRA, T. KELETI, AND A. MÁTHÉ

Remark 3.2. It is easy to see that if X ⊂ Rn is compact, then Eα,c,X is Fσ , thus
also analytic. Therefore, to prove Theorem 2.1 (or any of the above mentioned
results) with the extra assumption that B ⊂ Rn is compact, the following argument
could be skipped.
Proof. Let
T = {(P, x) ∈ A(n, k) × Rn : x ∈ P },
this is the natural vector bundle of rank k over A(n, k). Let ϕ : T → Rn be deﬁned
by ϕ((P, x)) = x, and let π : T → A(n, k) be deﬁned by π((P, x)) = P . On T we
can consider the metric inherited from a product metric on A(n, k) × Rn so that ϕ
is isometry on all ﬁbres.
Let K be the space of those non-empty compact subsets of T which lie in one
ﬁbre, that is,
K = {K ⊂ T : K is non-empty compact, and π(K) is a singleton}.
This is a complete metric space in the Hausdorﬀ metric. Not to mix up singletons
and their unique elements, let π ′ : K → A(n, k) be deﬁned by {π ′ (K)} = π(K).
Since X is Gδ , ϕ−1 (X) is Gδ in T . It is easy to check that
def

K(ϕ−1 (X)) = {K ∈ K : K ⊂ ϕ−1 (X)}

is also Gδ in K.
For α > 0 and d > 0, let

α
Kdα = {K ∈ K : H∞
(ϕ(K)) ≥ d}.

It is easy to see that these are closed sets in K.
Let
[
α
Kα,c,X = K(ϕ−1 (X)) ∩
Kc+1/n
.
n

Clearly, this is a Borel set in K. We claim that
(3)

Eα,c,X = π ′ (Kα,c,X ).

Clearly, the right hand side consists of those P ∈ A(n, k) for which P ∩ X contains
α
(K) > c. We will show that for any P ∈ A(n, k),
a compact subset K with H∞
(4)

α
α
∃K ⊂ P ∩ X compact with H∞
(K) > c ⇐⇒ H∞
(P ∩ X) > c,

which implies (3).
To prove (4), we use the concept of capacities (see e.g. [8], Section 30).
Definition. Let Y be a Hausdorﬀ topological space. A capacity on Y is a map
γ : P(Y ) → [0, ∞] such that
(i) A ⊂ B =⇒ γ(A) ≤ γ(B),
(ii) A0 ⊂ A1 ⊂ · · · =⇒ γ(An ) → γ(∪n An ),
(iii) for any compact K ⊂ Y we have γ(K) < ∞, and if γ(K) < r, then for some
open U ⊃ K, γ(U ) < r.
α
We claim that γ = H∞
is a capacity on B(0, R) for any R > 0. Indeed, it is
α
clear that H∞ satisﬁes properties (i) and (iii) in any metric space, and it follows
α
from the results in [3] that (ii) holds for H∞
in any compact metric space.
α
Since X is bounded Gδ (thus also analytic), and H∞
is a capacity on the compact
metric space B(0, R) with X ⊂ B(0, R), the Choquet Capacitability Theorem ([8],
(30.13)) can be applied, and it gives precisely (4).
Finally, (3) implies that Eα,c,X is a continuous image of a Borel set, thus analytic,
and we are done.


HAUSDORFF DIMENSION OF UNIONS OF AFFINE SUBSPACES

7

Note that the statement of Theorem 2.1 is trivially true if dim E = 0, since
2α − k ≤ α.
Lemma 3.3. Let s = min(dim E, 1) > 0. We can make the following assumptions
in the proof of Theorem 2.1:
(i) B is a Gδ set, that is, a countable intersection of open sets;
(ii) Hα (P ∩ B) > 0 for every P ∈ E;
(iii) B is bounded;
(iv) E ⊂ A(n, k) is compact, and Hs (E) > 0. Moreover, there is ε > 0 such that
for every P ∈ E,
α
H∞
(P ∩ B) ≥ ε.
Statement (ii) is clearly weaker than (iv); it is stated to guide the proof.
e ⊂ E, or B is replaced
Proof. First we remark that if E is replaced by any subset E
e
e
by any superset B ⊃ B, then the condition dim (P ∩ B) ≥ dim (P ∩ B) ≥ α in
e ⊂ E.
Theorem 2.1 is trivially satisﬁed for all P ∈ E
e ⊃ B be a Gδ set with dim B = dim B;
e the existence of such set is
(i) Let B
e
proved for example in [6]. Clearly, it is enough to prove Theorem 2.1 for B
replacing B.
(ii) Clearly, replacing α with a slightly smaller value, we may assume, without
loss of generality, that Hα (P ∩ B) > 0 for every P ∈ E.
(iii) If B is not bounded then consider B = ∪n Bn where Bn is bounded Gδ and
deﬁne En = {P ∈ E : Hα (P ∩ Bn ) > 0}. Clearly, E = ∪n En thus dim E =
sup{dim En : n ∈ N}. If Theorem 2.1 holds for the bounded set Bn and
En ⊂ A(n, k) for every n then it holds for B and E as well. Thus we can
assume that B is bounded.
(iv) By (i), we may assume that B is Gδ . By (ii), for every P ∈ E, Hα (P ∩B) > 0,
α
and thus H∞
(P ∩ B) > 0. Thus E ⊂ ∪∞
i=1 Eα,1/i,B , where the sets Eα,1/i,B
are the analytic sets given by Lemma 3.1. For every δ > 0, Hs−δ (E) = ∞ and
therefore there is i = i(δ) with Hs−δ (Eα,1/i,B ) > 0. By Howroyd’s theorem
[7], there is a compact set E δ ⊂ Eα,1/i,B with Hs−δ (E δ ) > 0. If Theorem 2.1
holds for these compact sets E δ , then dim B ≥ 2α − k + s − δ for every δ > 0,
which ﬁnishes the proof.

Let e0 = (0, . . . , 0); let e1 = (1, 0, . . . , 0), . . . , en = (0, . . . , 0, 1) be the standard
basis vectors of Rn , and let V be the k-dimensional linear space generated by
e1 , . . . , ek . Put H0 = V ⊥ , and Hi = ei + H0 . Then Hi is an n − k-dimensional
aﬃne subspace for all i = 1, . . . , k. We use the sets Hi (i = 0, . . . , k) to describe
the structure of E by investigating the intersection of the elements of E with them.
Let C denote the convex hull of the vectors e0 , e1 , . . . , ek in V , Q ⊂ H0 the
n − k-dimensional closed unit cube of center e0 in H0 , and S = C × Q ⊂ Rn . Fix
δ0 > 0 and an open set S ′ such that
(5)

Sδ′ 0 ⊂ S,

where Sδ′ 0 denotes the open δ0 -neighborhood of S ′ .
Lemma 3.4. We can make the following further assumptions in Theorem 2.1.
(I) For every P ∈ E, P ∩ Hi is a singleton and contained in S for all i =
0, 1, . . . , k;
(II) B ⊂ S ′ .
Proof.

8

K. HÉRA, T. KELETI, AND A. MÁTHÉ

(I) We can cover E by ﬁnitely many compact subsets for which (I) holds after
applying a suitable similarity transformation.
(II) Since we may assume that B is bounded, this can be obtained after applying
a homothety.

Let us now ﬁx B, E, ε, S ′ , δ0 (and s and α) with properties given by Lemma 3.3
and such that Lemma 3.4 is satisﬁed. That is, B is bounded and Gδ , E is compact
and Hs (E) > 0, and
α
H∞
(P ∩ B) ≥ ε

(6)

for all P ∈ E for a ﬁxed ε > 0.
We apply Frostman’s lemma (see e.g. [11]) to obtain a probability measure µ
on A(n, k) (for which Borel and analytic sets are measurable) supported on E for
which
µ(B(P, r)) . rs

(7)

for all r > 0 and all P ∈ E.
Now we turn to estimating the dimension of the set B. Our aim is to show that
H2α−k+s−γ (B) > 0
for any γ > 0. Fix γ > 0, and let
u = 2α − k + s − γ.
Let M be a positive integer such that
∞
X

1/k 2 < ε

k=M

S∞

Let B ⊂
l ≥ M , let

i=1

and

2−M+1 ≤ δ0 .

B(xi , ri ) be any countable cover with 2ri ≤ 2−M for all i. For any
Jl = {i : 2−l < ri ≤ 2−l+1 }.

Let Rl = ∪i∈Jl B(xi , ri ), and Bl = Rl ∩ B. Then B = ∪∞
l=M Bl .
Our aim is to ﬁnd a big enough subset of B that is covered by balls of approximately the same radii and such that many of the aﬃne subspaces of E have big
intersection with it.
Remark 3.5. In the subsequent proofs, applications of Lemma 3.1 imply that
the sets we take µ-measure of are µ-measurable, since they are in the σ-algebra
generated by analytic sets.
Lemma 3.6. There exists an integer l ≥ M such that


1
1
α
(8)
µ P ∈ E : H∞
(P ∩ Bl ) ≥ 2 ≥ 2 .
l
l
Proof. Let
Al =



α
P ∈ E : H∞
(P ∩ Bl ) ≥

1
l2



,

P∞
and assume that µ(Al ) < 1/l2 for all l ≥ M . Since l=M 1/l2 < 1 (we may assume
ε ≤ 1), these sets Al cannot cover E. Therefore,
P∞ there exists P ∈ E such that
α
α
H∞
(P ∩ Bl ) < 1/l2, and thus H∞
(P ∩ B) < l=M 1/l2 < ε, which contradicts
(6).


HAUSDORFF DIMENSION OF UNIONS OF AFFINE SUBSPACES

9

Fix the integer l obtained by Lemma 3.6 and let


e = Al = P ∈ E : Hα (P ∩ Bl ) ≥ 1 .
(9)
E
∞
l2

e We have
We will use the notation Pe = P ∩ Bl for any P ∈ E.
1
1
α e
and H∞
(P ) ≥ 2
l2
l

e ≥
µ(E)

(10)

e by Lemma 3.6. Note also that
for every P ∈ E
Peδ0 ⊂ S

(11)

e by (II) of Lemma 3.4 and the deﬁnition of S ′ and δ0 .
for every P ∈ E
Let
[
(12)
F =
Pe ⊂ Bl ⊂ B.
e
P ∈E

Our aim is to ﬁnd a lower estimate for Ln (Fδ ). We will prove the following.

Lemma 3.7. There is a constant c > 0 depending on E, n, and k but independent
of l, ε, γ and the covering of B such that, for every 0 < δ ≤ δ0 ,
Ln (Fδ ) ≥ c

δ n−(2α−k+s)
.
l8 log δ1

e Pe for every P ∈ E,
e and F depend
Remark 3.8. Note
that the integer l, the sets E,
S∞
on the cover B ⊂ i=1 B(xi , ri ).

First we show how the proof can be ﬁnished using Lemma 3.7. We prove Lemma
3.7 in Sections 4 and 5.

Remark 3.9. As it happens often, it would be easier to prove the lower bound for
the box dimension of B. For that purpose, we would not need the previous steps,
it would be enough to estimate Ln (Bδ ) from below. To prove the lower bound for
the Hausdorﬀ dimension, we sorted out a big enough part of B that can be covered
by balls of approximately the same radius.
S∞
Recall that B ⊂ i=1 B(xi , ri ), 2ri ≤ 2−M ≤ δ20 for all i. We will use that the
balls with indices from Jl have approximately the same radius. We have that
∞
X
i=1

−l+1

u

(2ri ) =

∞ X
X

l=M i∈Jl

(2ri )u ≥

X

(2ri )u &

i∈Jl

X

(2−l )u .

i∈Jl

−M+1

Let δ = 2
. Then δ ≤ 2
≤ δ0 .
The set F was constructed to satisfy
[
[
F ⊂ Bl ⊂
B(xi , ri ) ⊂
B(xi , δ),
i∈Jl

and thus
Fδ ⊂
Using
(2−l )u & δ u =

i∈Jl

[

B(xi , 2δ).

i∈Jl

δn
δ n−(2α−k+s−γ)

&

Ln (B(xi , 2δ))
δ n−(2α−k+s−γ)

10

K. HÉRA, T. KELETI, AND A. MÁTHÉ

and Lemma 3.7, we get
X

(2−l )u &

i∈Jl

X Ln (B(xi , 2δ))
Ln (Fδ )
≥ n−(2α−k+s)+γ &
n−(2α−k+s−γ)
δ
δ
i∈J
l

&

1
1
δ n−(2α−k+s)
1 = γ 8
1 & 2−lγ l 9 .
n−(2α−k+s)+γ
8
δ
l log δ
δ l log δ

Thus we obtain
∞
X

S∞inf

B⊂ i=1 B(xi ,ri )
i=1
∀i 2ri ≤2−M

(2ri )u & inf

l≥1

1
&γ 1
2−lγ l9

proving that Hu (B) > 0 and we are done.
4. Geometric arguments
Now we start proving Lemma 3.7. In this section we prove a purely geometric
e ⊂ A(n, k). This part is independent of the set B and
lemma using only the set E
the number α.
e
Lemma 4.1. For any P, P ′ ∈ E,

(13)

Ln (Pδ ∩ Pδ′ ∩ S) .

δ n−k+1
ρ(P, P ′ ) + δ

for all 0 < δ ≤ δ0 , where ρ denotes the metric on A(n, k), and δ0 is from (5).
e by making use of (I)
To prove Lemma 4.1, we will deﬁne a new metric on E
e
of Lemma 3.4. We will assign a code to each k-dimensional aﬃne subspace in E.
0
0
0
e
For a given P ∈ E, let (0, a ) = (0, . . . , 0, a1 , . . . , an−k ) denote the standard Rn coordinates of P ∩ H0 . Similarly, let (1l , al ) = (0, . . . , 1, . . . , 0, al1 , . . . , aln−k ) denote
the standard Rn -coordinates of P ∩Hl for each l = 1, . . . , k. Let bl = al −a0 ∈ Rn−k
for each l = 1, . . . , k. We refer to a0 as the vertical intercept, and to {bl }kl=1 as the
slopes of P .
We say that the point x = x(P ) = (a0 , b1 , . . . , bk ) = (a, b) ∈ R(k+1)(n−k) is the
e By (I) of Lemma 3.4 one can see
code of the k-dimensional aﬃne subspace P ∈ E.
e
that P → x(P ) is well deﬁned and injective on E.
We will use the maximum metric on the code space R(k+1)(n−k) . This means,
kx − x′ k = max(ka − a′ k, kb − b′ k), where
ka − a′ k =
(14)

kb − b′ k =

max

′

j=1,...,n−k

max

j=1,...,n−k



|a0j − a0j |,


′
max |blj − blj |) .

l=1,...,k

e
Remark 4.2. Put d(P, P ′ ) = kx(P ) − x(P ′ )k, then d is a natural metric on E.
Thus the metrics d and ρ are strongly equivalent, this means, there exist positive
e K1 · d(P, P ′ ) ≤ ρ(P, P ′ ) ≤
constants K1 and K2 such that, for every P, P ′ ∈ E,
′
K2 · d(P, P ).

In order to prove Lemma 4.1 we show that if P and P ′ are translated along H0
far enough from each other compared to their slopes, then the intersection of their
δ-tubes is empty in S, and if the slopes of P and P ′ are far enough from each other,
then the intersection of their δ-tubes is small enough in S.

HAUSDORFF DIMENSION OF UNIONS OF AFFINE SUBSPACES

11

Lemma 4.3. (a) There is a constant D > 0 (depending only on n and k) such
that if
ka − a′ k > kb − b′ k + Dδ
then Pδ ∩ Pδ′ ∩ S = ∅ for all 0 < δ ≤ δ0 .
(b) If kb − b′ k > 0, then Ln (Pδ ∩ Pδ′ ∩ S) .

δ n−k+1
kb−b′ k

for all 0 < δ ≤ δ0 .

e and put f, g : Rk → Rn−k ,
Proof. Fix P, P ′ ∈ E,

t = (t1 , . . . , tk ) 7→ a0 + t1 b1 + · · · + tk bk = f (t),
′

′

′

t = (t1 , . . . , tk ) 7→ a0 + t1 b1 + · · · + tk bk = g(t),
′

′

′

where a0 , b1 , . . . bk , and a0 , b1 , . . . bk are the code coordinates of P and P ′ , respectively. Then
P ∩ S = {(t, f (t)) ∈ Rn : t ∈ C}, P ′ ∩ S = {(t, g(t)) ∈ Rn : t ∈ C}.
One can easily prove using (I) of Lemma 3.4 and the compactness of S, that
e
there is a constant c > 0 independent of δ such that for all Q ∈ E,

(15)
Qδ ⊂ Q + {0} × (−cδ, cδ)n−k ,
where for A, B ⊂ Rn , A + B = {a + b : a ∈ A, b ∈ B}. Fix such a constant c.
Applying (15) for P and P ′ , we have

Pδ ⊂ {(t, u) ∈ Rn : |f (t) − u| < cδ}, Pδ′ ⊂ {(t, u) ∈ Rn : |g(t) − u| < cδ},
and
(16)

Pδ ∩ Pδ′ ∩ S ⊂ {(t, u) ∈ Rn : u ∈ (B(f (t), cδ) ∩ B(g(t), cδ)), t ∈ C}.

Clearly, |f (t)−g(t)| > 2cδ implies B(f (t), cδ)∩B(g(t), cδ) = ∅, thus Pδ ∩Pδ′ ∩S = ∅.
Put D = 2c, then ka − a′ k > kb − b′ k + Dδ implies |f (t) − g(t)| > 2cδ, thus we are
done with the proof of (a) of Lemma 4.3.
By (16) and Fubini’s theorem we also have
Z
n
′
Ln−k (B(f (t), cδ) ∩ B(g(t), cδ))dLk (t).
L (Pδ ∩ Pδ ∩ S) ≤
C

If B(f (t), cδ) ∩ B(g(t), cδ) 6= ∅, we will use the trivial estimate

Ln−k (B(f (t), cδ) ∩ B(g(t), cδ)) .n,k (cδ)n−k . δ n−k .

Put N = {t ∈ C : |f (t) − g(t)| ≤ 2cδ}, then
Ln (Pδ ∩ Pδ′ ∩ S) .

Z

δ n−k dLk (t).

N

Clearly, we have
(17)

N⊂

n−k
\
j=1

(



)
k

 X


 0
0′
i
i′ 
t ∈ C :  aj − aj +
ti bj − bj  ≤ 2cδ .


i=1

′

By the deﬁnition of k · k, there are indices i, j such that 0 < kb − b′ k = |bij − bij |.
Fix such an i and j, we can assume that i = k without loss of generality. Then we
get using (17) that
N ⊂ {t ∈ C : p− (t) ≤ tk ≤ p+ (t)} ,

where

′

p− (t) = p− (t1 , . . . , tk−1 ) =

−2cδ − (a0 − a0 ) −

k−1
P

bkj − bkj

i=1

′

′

ti (bij − bij )

,

12

K. HÉRA, T. KELETI, AND A. MÁTHÉ

′

p+ (t) = p+ (t1 , . . . , tk−1 ) =

2cδ − (a0 − a0 ) −

k−1
P
i=1

bkj − bkj

′

ti (bij − bij )

′

.

The set {t ∈ C : p− (t) ≤ tk ≤ p+ (t)} is obtained as the intersection of the simplex
C and the strip between the parallel hyperplanes {tk = p+ (t)}, {tk = p− (t)}. One
can easily calculate the distance of these hyperplanes, using the normal vector
′
′
n = (b1j − b1j , . . . , bkj − bjk ). One gets
d = d({tk = p+ (t)}, {tk = p− (t)}) = s

2cδ
k
P

(bij
i=1

−

.
′
bij )2

Thus the set N is contained in a √
rectangular box, where the shortest side length is
d and the others are diam (C) = 2. Then
Lk (N ) . s

δ
k
P

.

(bij − bij )2
′

δ
δ
=
,
′
kb − b′ k
|bkj − bkj |

i=1

thus

Ln (Pδ ∩ Pδ′ ∩ S) .
and we are done with the proof of Lemma 4.3.

δ n−k+1
kb − b′ k



Now we prove Lemma 4.1.
Proof. Using (a) of Lemma 4.3 we obtain that Pδ ∩ Pδ′ ∩ S = ∅ for all 0 < δ ≤ δ0 if
ka − a′ k > kb − b′ k + Dδ, so (13) is clearly satisﬁed.
Assume now that ka − a′ k ≤ kb − b′ k + Dδ, and kb − b′ k ≤ δ. By Remark 4.2,
ρ(P, P ′ ) ≤ K2 kx − x′ k ≤ K2 (D + 1)δ . δ,
and then since S is bounded, we have
Ln (Pδ ∩ Pδ′ ∩ S) ≤ Ln (Pδ ∩ S) . δ n−k =

δ n−k+1
δ n−k+1
.
.
δ
ρ(P, P ′ ) + δ

Thus we are done in this case.
If ka − a′ k ≤ kb − b′ k + Dδ and kb − b′ k ≥ δ, we have that
ρ(P, P ′ ) + δ ≤ K2 kx − x′ k + δ ≤ K2 (kb − b′ k + Dδ) + δ . kb − b′ k
using Remark 4.2 again. Applying (b) of Lemma 4.3, we obtain that
Ln (Pδ ∩ Pδ′ ∩ S) .

δ n−k+1
δ n−k+1
.
,
kb − b′ k
ρ(P, P ′ ) + δ

which is (13).

5. The proof of Lemma 3.7, L2 argument
In this section we prove Lemma 3.7 with help on an L2 estimation technique.
It resembles the technique that Córdoba used in his proof for the Kakeya maximal
inequality in the plane, see [2].

HAUSDORFF DIMENSION OF UNIONS OF AFFINE SUBSPACES

By Fubini’s theorem we have the following:
Z
Z Z
n e
χPeδ (y)dydµ(P )
L (Pδ )dµ(P ) =
e Rn
E

e
E

=

Z Z

χPeδ (y)dµ(P )dy =

Rn E
e

S

Z

Rn

χFδ (y) ·

Z

13

χPeδ (y)dµ(P )dy,

e
E

where F = P ∈Ee Pe from (12). Now we
R apply the Cauchy-Schwarz inequality for
the L2 functions y 7→ χFδ (y) and y 7→ χPeδ (y)dµ(P ). We get
Z

Rn

e
E



2 1/2

1/2  
Z
Z
Z Z


 


χFδ (y) ·  χPeδ (y)dµ(P ) dy ≤  χ2Fδ (y)dy  ·   χPeδ (y)dµ(P ) dy 
Rn

e
E

Rn

= (Ln (Fδ ))

1/2




·

Z ZZ

Rn E×
e E
e




= (Ln (Fδ ))1/2 · 

ZZ

e E
e
E×

We proved that
Z

e
E

Ln (Peδ )dµ(P ) ≤ (Ln (Fδ ))

1/2




·

ZZ

e E
e
E×



e
E


χPeδ (y) · χPf′ δ (y)dµ(P )dµ(P ′ )dy 


1/2



f′ δ dµ(P )dµ(P ′ )
Ln Peδ ∩ P



1/2

f′ δ dµ(P )dµ(P ′ )
Ln Peδ ∩ P


.

On the other hand, there is a lower bound for the left hand side.
For any U ⊂ Rn and ε > 0, let N (U, ε) denote the smallest number of ε-balls
needed to cover U . It is well known (see e.g. [11]) that Ln (Uε ) &n N (U, 2ε)εn for
α e
every U ⊂ Rn and ε > 0. Since H∞
(P ) ≥ l12 by (10), we have N (Pe , ε) · (2ε)α ≥ l12
e and ε > 0, thus
for every P ∈ E
1
(18)
Ln (Peδ ) & N (Pe , 2δ) · δ n & δ n−α · 2 .
l
Then
Z
1
e ≥ δ n−α · 1
Ln (Peδ )dµ(P ) & δ n−α · 2 · µ(E)
l
l4
by (10).
Thus we get
(19)

e
E

δ 2n−2α
. Ln (Fδ ) ·
l8

ZZ

e E
e
E×



f′ δ dµ(P )dµ(P ′ ).
Ln Peδ ∩ P

Thus we need to ﬁnd an upper estimate for
ZZ
f′ δ )dµ(P )dµ(P ′ ).
(20)
Ln (Peδ ∩ P

1/2

e E
e
E×

This means, we have to investigate, how the diﬀerent δ-tubes intersect each other.
e into parts. One can easily
We will estimate the integral (20) by dividing the set E
check using Remark 3.5 that the elements of this partition will be measurable.

.

14

K. HÉRA, T. KELETI, AND A. MÁTHÉ

e Put
Fix a P ′ ∈ E.

and

e : ρ(P, P ′ ) ≤ δ}
E0 = {P ∈ E

e : 2j−1 δ < ρ(P, P ′ ) ≤ 2j δ}
Ej = {P ∈ E
e = SN Ej , so
for j = 1, . . . , N , where N . log δ1 . Clearly, we have E
j=0
(21)

Z

f′ δ )dµ(P ) =
L (Peδ ∩ P
n

e
E

Z

E0

f′ δ )dµ(P ) +
L (Peδ ∩ P
n

N Z
X

j=1E
j

By (11) and Lemma 4.1, we obtain
Z
Z
Z
f′ δ )dµ(P ) ≤ Ln (Pδ ∩ P ′ ∩ S)dµ(P ) .
Ln (Peδ ∩ P
(22)
δ

δ n−k+1
dµ(P )
ρ(P, P ′ ) + δ

Ej

Ej

Ej

f′ δ )dµ(P ).
Ln (Peδ ∩ P

for each j = 0, . . . , N .
In the case j = 0, we obtain that
Z
n−k+1
f′ δ )dµ(P ) . δ
Ln (Peδ ∩ P
µ(E0 ) . δ n−k · δ s
(23)
δ
E0

by (22) and (7).
For j ∈ {1, . . . , N }, we get
Z
n−k+1
δ n−k+s · 2js
δ n−k j s
f′ δ )dµ(P ) ≤ δ
Ln (Peδ ∩ P
(24)
(2
δ)
=
µ(E
)
.
j
2j−1 δ + δ
2j
2j
Ej

by (22) and (7) again. Applying these estimates for (21) and using s ≤ 1, we get


Z
N
js
X
2 
1
f′ δ )dµ(P ) . δ n−k+s 1 +
Ln (Peδ ∩ P
. δ n−k+s N . δ n−k+s log .
j
2
δ
j=1
e
E

e ≤ 1 that
Finally we integrate with respect to P ′ and obtain by µ(E)
ZZ
f′ δ )dµ(P )dµ(P ′ ) . δ n−k+s log 1 .
Ln (Peδ ∩ P
δ
e E
e
E×

Recalling (19), we obtain that

1
δ 2n−2α
. Ln (Fδ ) · δ n−k+s log ,
8
l
δ
thus
Ln (Fδ ) &

δ n−2α+k−s
l8 log 1δ

and we are done with the proof of Lemma 3.7 and so also with the proof of Theorem
2.1.
Acknowledgement
The ﬁrst author is grateful to Izabella Laba for her notes on intersections of
Cantor sets and diﬀerentiation for self-similar measures. It helped her choosing the
formulation of the L2 argument used in Section 5. The authors are grateful to the
referees for their helpful suggestions.

HAUSDORFF DIMENSION OF UNIONS OF AFFINE SUBSPACES

15

References
[1] A. Chang, M. Csörnyei, K. Héra and T. Keleti, Small unions of affine subspaces and skeletons
via Baire category, Adv. Math. 328 (2018), 801–821.
[2] A. Córdoba, Kakeya maximal function and spherical summation of multipliers, Amer. J.
Math. 99 (1977), 1–22.
[3] R. O. Davies, Increasing Sequences of Sets and Hausdorff Measure, Proc. London Math. Soc.
(3) 20 (1970), 222–236.
[4] C. Dellacherie, Ensembles Analytiques, Capacités, Mesures de Hausdorff, Lecture Notes in
Mathematics 295, Springer-Verlag, 1972.
[5] K. Falconer and P. Mattila, Strong Marstrand theorems and dimensions of sets formed by
subsets of hyperplanes, J. Fractal Geom. 3 (2016), 319–329.
[6] D. H. Fremlin, Measure Theory: Topological Measure Spaces (Vol. 4), Torres Fremlin, 2003.
[7] J. D. Howroyd, On dimension and on the existence of sets of finite positive Hausdorff measure,
Proc. London Math. Soc. (3) 70 (1995), 581–604.
[8] A. S. Kechris, Classical Descriptive Set Theory, Graduate Texts in Mathematics 156,
Springer-Verlag, 1994.
[9] T. Keleti, Are lines much bigger than line segments?, Proc. Amer. Math. Soc. 144 (2016),
1535–1541.
[10] T. Keleti, D. T. Nagy and P. Shmerkin, Squares and their centers, to appear in J. Anal.
Math.
[11] P. Mattila, Geometry of sets and measures in Euclidean spaces, Cambridge University Press,
1995.
[12] P. Mattila, Fourier Analysis and Hausdorff Dimension, Cambridge University Press, 2015.
[13] U. Molter and E. Rela, Furstenberg sets for a fractal set of directions, Proc. Amer. Math.
Soc. 140 (2012), 2753–2765.
[14] D. M. Oberlin, Unions of hyperplanes, unions of spheres, and some related estimates, Illinois
J. Math. 51 (2007), no. 4, 1265–1274.
[15] D. M. Oberlin, Exceptional sets of projections, unions of k-planes, and associated transforms,
Israel J. Math. 202 (2014), 331–342.
[16] R. Thornton, Cubes and Their Centers, Acta Math. Hungar. 152 (2017), 291–313.
[17] T. Wolff, An improved bound for Kakeya type maximal functions, Revista Math. Iberoamericana 11 (1995), 651–674.
[18] T. Wolff, A Kakeya-type problem for circles, Amer. J. Math. 119 (1997), 985–1026.
[19] T. Wolff, Local smoothing type estimates on Lp for large p, Geom. Funct. Anal. 10 (2000),
1237–1288.
Institute of Mathematics, Eötvös Loránd University, Pázmány Péter sétány 1/c,
H-1117 Budapest, Hungary
E-mail address: herakornelia@gmail.com
E-mail address: tamas.keleti@gmail.com
Mathematics Institute, University of Warwick, Coventry, CV4 7AL, UK
E-mail address: a.mathe@warwick.ac.uk

