HAUSDORFF DIMENSION OF UNIONS OF AFFINE
SUBSPACES AND OF FURSTENBERG-TYPE SETS

arXiv:1701.02299v3 [math.MG] 6 Mar 2018

K. HEÌRA, T. KELETI, AND A. MAÌTHEÌ
Abstract. We prove that for any 1 â‰¤ k < n and s â‰¤ 1, the union of any
nonempty s-Hausdorff dimensional family of k-dimensional affine subspaces
of Rn has Hausdorff dimension k + s. More generally, we show that for any
0 < Î± â‰¤ k, if B âŠ‚ Rn and E is a nonempty collection of k-dimensional affine
subspaces of Rn such that every P âˆˆ E intersects B in a set of Hausdorff dimension at least Î±, then dim B â‰¥ 2Î± âˆ’ k + min(dim E, 1), where dim denotes
the Hausdorff dimension. As a consequence, we generalize the well-known
Furstenberg-type estimate that every Î±-Furstenberg set has Hausdorff dimension at least 2Î±; we strengthen a theorem of Falconer and Mattila [5]; and we
show that for any 0 â‰¤ k < n, if a set A âŠ‚ Rn contains the k-skeleton of a
rotated unit cube around every point of Rn , or if A contains a k-dimensional
affine subspace at a fixed positive distance from every point of Rn , then the
Hausdorff dimension of A is at least k + 1.

1. Introduction
There are several problems gathering around the general principle that an sdimensional collection of d-dimensional sets in Rn must have positive measure if
s + d > n and Hausdorï¬€ dimension s + d if s + d â‰¤ n, unless the sets have large
intersections. For example, Wolï¬€ [18, 19] proved that if a planar set B contains a
circle around every point of a Borel set S âŠ‚ R2 of Hausdorï¬€ dimension s then B
has positive Lebesgue measure provided s > 1, and the Hausdorï¬€ dimension of B
is at least s + 1 when s â‰¤ 1. Most of these problems are only partially solved. The
most famous example is the Kakeya conjecture, which states that every Besicovitch
set (a compact set that contains a unit line segment in every direction) in Rn has
Hausdorï¬€ dimension n, see e.g [12]. Note that the directions of lines of Rn form a
set of dimension n âˆ’ 1, so the line segments of a Besicovitch set form a collection of
Hausdorï¬€ dimension at least n âˆ’ 1, so the above principle would indeed imply the
Kakeya conjecture. On the other hand, the following trivial example shows that
this principle cannot be applied for every s-dimensional collection of lines: for any
collection of lines of a ï¬xed plane of R3 the union clearly has Hausdorï¬€ dimension
at most 2, which is less than s + 1 if s > 1. In this paper we show that the above
principle holds for any s-dimensional collection of lines or even k-dimensional aï¬ƒne
subspaces provided that s â‰¤ 1.
Theorem 1.1. For any integers 1 â‰¤ k < n and s âˆˆ [0, 1] the union of any nonempty
s-Hausdorff-dimensional family of k-dimensional affine subspaces of Rn has Hausdorff dimension s + k.

For the special case k = n âˆ’ 1 this was proved by Oberlin [14] for compact (or
analytic) families of hyperplanes. He also proved [15] that for any integers 1 â‰¤ k < n
and any s â‰¥ 0, the union of any nonempty compact (or analytic) s-Hausdorï¬€dimensional family of k-dimensional aï¬ƒne subspaces of Rn has Hausdorï¬€ dimension
This research was supported by the Hungarian National Research, Development and Innovation
Office â€“ NKFIH, 104178, and the first author was also supported by the UÌNKP-16-3 New National
Excellence Program of the Ministry of Human Capacities.
1

2

K. HEÌRA, T. KELETI, AND A. MAÌTHEÌ

at least min{n, 2k âˆ’ k(n âˆ’ k) + s}. Moreover, he proved that s > (k + 1)(n âˆ’ k) âˆ’ k
implies positive Lebesgue measure for such unions, and the bound for s is sharp. His
results are in harmony with the above heuristic principle in the case of hyperplanes.
Falconer and Mattila [5] proved a stronger statement both in the s â‰¤ 1 and s > 1
cases for hyperplanes: instead of full n âˆ’ 1-dimensional aï¬ƒne subspaces it is enough
to take a positive measure subset of each of them.
We can go even further for any k < n: it is enough to take a k-Hausdorï¬€
dimensional subset of each k-dimensional subspace:
Theorem 1.2. Let 1 â‰¤ k < n be integers and s âˆˆ [0, 1]. If E is a nonempty
s-Hausdorff
dimensional family of k-dimensional affine subspaces and B is a subset
S
of P âˆˆE P such that B âˆ© P has Hausdorff dimension k for every P âˆˆ E then
!
[
(1)
dim B = dim
P = s + k,
P âˆˆE

where here and in the sequel dim denotes Hausdorff dimension.

Note that this theorem does not assume any kind of measurability of E (or B),
unlike the mentioned results of Oberlin and Falconer and Mattila.
As we explained above, the equality on the right hand side of (1) is not true
without the restriction s â‰¤ 1. But it is possible that the equality on the left hand
side always holds. If it holds for k = 1 in Rn for all n â‰¥ 2, it would imply that
Besicovitch sets in Rn have Hausdorï¬€ dimension at least nâˆ’1 and upper Minkowski
dimension n, see [9].


S
S
In Theorem 1.2, dim B â‰¤ dim
P âˆˆE P â‰¤ s + k is
P âˆˆE P is obvious, dim
easy (Lemma 2.4), the essence of the result is the estimate dim B â‰¥ s + k.

It is natural to ask what happens if we go further and take the union of Î±Hausdorï¬€ dimensional subsets of an s-dimensional family of k-dimensional aï¬ƒne
subspaces of Rn for some s â‰¤ 1 and Î± âˆˆ (0, k]. Our most general result (Theorem 2.1) gives that in this case the union has Hausdorï¬€ dimension at least 2Î±âˆ’k+s.
Note that this result implies a known Furstenberg-type estimate. Let 0 < Î± â‰¤ 1
and suppose that F âŠ‚ R2 is a Furstenberg set: a compact set such that for every
e âˆˆ S 1 there is a line Le in direction e for which dim Le âˆ© F â‰¥ Î±, see e.g. [12].
Since the sets Le form an at least 1-dimensional collection of lines of R2 our above
mentioned result gives dim F â‰¥ 2Î± âˆ’ 1 + 1 = 2Î±.
Molter and Rela [13] proved that if E âŠ‚ S 1 has Hausdorï¬€ dimension s, F âŠ‚ R2
and for every e âˆˆ S 1 there is a line Le in direction e for which dim Le âˆ© F â‰¥ Î± then
dim F â‰¥ 2Î± âˆ’ 1 + s and dim F â‰¥ Î± + 2s . So our result is also a generalization of the
ï¬rst estimate of Molter and Rela.
Our original motivation comes from the following question: What is the minimal
Hausdorï¬€ dimension of a set in Rn that contains the k-skeleton of a rotated unit
cube centered at every point of Rn ? In [1] it is proved that for every 0 â‰¤ k < n there
exist such sets of Hausdorï¬€ dimension at most k + 1. As a fairly quick application
of the above results we show (Theorem 2.6) that for every 0 â‰¤ k < n such a set
must have Hausdorï¬€ dimension at least k + 1, so k + 1 is the minimal Hausdorï¬€
dimension. We remark that if we have k-skeletons of rotated and scaled cubes
centered at every point then the minimal Hausdorï¬€ dimension is k, see [1], and
if we allow only scaled axis-parallel cubes then the minimal Hausdorï¬€ dimension
is n âˆ’ 1, see [10] for k = 1, n = 2 and [16] for the general case. We also show
(Theorem 2.6) that if A contains a k-dimensional aï¬ƒne subspace at a ï¬xed positive
distance from every point of Rn , then the Hausdorï¬€ dimension of A is at least k + 1.
The paper is organized as follows: In Section 2 we state our most general result
(Theorem 2.1), and prove its corollaries. In Section 3 we prove Theorem 2.1 subject

HAUSDORFF DIMENSION OF UNIONS OF AFFINE SUBSPACES

3

to a lemma (Lemma 3.7), which will be proved in Sections 4 and 5. In Section 4
we prove a purely geometrical lemma, which will be used during the L2 estimation
procedure in Section 5 to prove Lemma 3.7.
Notation 1.3. For any integers 1 â‰¤ k < n, let A(n, k) denote the space of all
k-dimensional aï¬ƒne subspaces of Rn . For any s â‰¥ 0, Î´ âˆˆ (0, âˆ] and A âŠ‚ Rn ,
the s-dimensional Hausdorï¬€ Î´-premeasure of A will be denoted by HÎ´s (A), the
s-dimensional Hausdorï¬€ measure by Hs (A), and the Hausdorï¬€ dimension of A by
dim A. The open ball of center x and radius r will be denoted by B(x, r) or BÏ (x, r)
if we want to indicate the metric Ï. For a set U âŠ‚ Rn , UÎ´ = âˆªxâˆˆU B(x, Î´) denotes
the open Î´-neighborhood of U . We will use the notation a .Î± b if a â‰¤ Cb where C
is a constant depending on Î±. If it is clear from the context what C should depend
on, we may write only a . b.
2. The most general theorem and its corollaries
Our most general result is the following:
Theorem 2.1. Let 1 â‰¤ k < n be integers, let A(n, k) denote the space of all kdimensional affine subspaces of Rn and consider any natural metric on A(n, k). Let
0 < Î± â‰¤ k be any real number. Suppose that B âŠ‚ Rn , âˆ… 6= E âŠ‚ A(n, k) and for
every k-dimensional affine subspace P âˆˆ E, dim (P âˆ© B) â‰¥ Î±. Then
dim B â‰¥ 2Î± âˆ’ k + min(dim E, 1).

(2)

Remark 2.2. An example for such a metric on A(n, k) is deï¬ned in [11], p. 53.
Let Ï denote the given metric on A(n, k). We say that Ï is a natural metric if Ï
and the metric d deï¬ned in [11] are strongly equivalent; that is, there exist positive
constants K1 and K2 such that, for every P, P â€² âˆˆ A(n, k), K1 Â·d(P, P â€² ) â‰¤ Ï(P, P â€² ) â‰¤
K2 Â· d(P, P â€² ).

Remark 2.3. For Î± = k and dim E â‰¤ k + 1 the estimate (2) is sharp in the sense
that for any s âˆˆ [0, k + 1] there exist sets E and B with the above property and
dim E = s such that we have equality in (2): it is easy to see using Theorem 1.2
that we obtain such an example by letting E to be any s-Hausdorï¬€ dimensional
collection of k-dimensional aï¬ƒne subspaces of a ï¬xed k + 1-dimensional subspace
of Rn and B = âˆªP âˆˆE P .
Clearly, (2) can be a good estimate only when Î± is close to k: for Î± < k âˆ’ 1
the right-hand side of (2) is less than Î± but trivially, dim B â‰¥ Î±. Since ï¬nding the
best estimate for the n = 2, k = 1, dim E = 1, Î± < 1 case is essentially equivalent to
ï¬nding the minimal Hausdorï¬€ dimension of a Furstenberg set, this cannot be easy
and it is unlikely that our estimate is sharp for any Î± < k.
By combining the Î± = k case of Theorem 2.1 and the following lemma, we obtain
Theorem 1.2, and its special case Theorem 1.1.
Lemma 2.4. For any 1 â‰¤ k < n integers and âˆ… 6= E âŠ‚ A(n, k) we have
!
[
dim
P â‰¤ k + dim E.
P âˆˆE

Proof. By taking a ï¬nite decomposition of E if necessary, we can assume that there
exists a P0 âˆˆ A(n, k) such that the orthogonal projection of P0 onto any P âˆˆ E is
P . Fix such a P0 . For any P âˆˆ E and t âˆˆ P0 let h(P, t) be the orthogonal
S projection
of t onto P . Then h({P } Ã— P0 ) = P for any P âˆˆ E, so h(E Ã— P0 ) = P âˆˆE P . It is
not hard to check that h : E Ã— P0 â†’ Rn is locally Lipschitz, therefore we obtain
!
[
dim
P = dim (h(E Ã— P0 )) â‰¤ dim (E Ã— P0 ) = dim E + k.
P âˆˆE

4

K. HEÌRA, T. KELETI, AND A. MAÌTHEÌ


Now we show a simple direct application of Theorem 2.1.
Corollary 2.5. Let 0 â‰¤ k < n be integers, 0 â‰¤ Î± â‰¤ k, âˆ… 6= C âŠ‚ Rn , and B âŠ‚ Rn
such that for every x âˆˆ C there exists a k-dimensional affine subspace P containing
x such that P intersects B in a nonempty set of Hausdorff dimension at least Î±.
Then dim B â‰¥ 2Î± âˆ’ k + min(dim C âˆ’ k, 1).
Specially, if 1 â‰¤ k and a set A âŠ‚ Rn contains a k-dimensional punctured affine
subspace through every point of a set C with dim C â‰¥ k + 1, then dim A â‰¥ k + 1.
Proof. If k = 0, or k â‰¥ 1 and Î± = 0, then the statement clearly holds. Suppose now
k â‰¥ 1, Î± > 0. Let E âŠ‚ A(n, k) be the set of those k-dimensional aï¬ƒne subspaces
that
S intersect B in a nonempty set of Hausdorï¬€ dimension at least Î±. Then C âŠ‚
P âˆˆE P , thus dim C â‰¤ dim E + k by Lemma 2.4, which means, dim E â‰¥ dim C âˆ’ k.
Applying Theorem 2.1 for B and E, we obtain dim B â‰¥ 2Î± âˆ’ k + min(dim C âˆ’
k, 1).

Our next goal is to show that if a set B âŠ‚ Rn contains the k-skeleton of a rotated
unit cube around every point of Rn then dim B â‰¥ k + 1, as it was already stated in
the Introduction. Instead of the k-skeleton of the unit cube we will prove (Corollary
2.8) the analogous result for any k-Hausdorï¬€ dimensional set S âŠ‚ Rn that can be
covered by countably many k-dimensional aï¬ƒne subspaces. This result will follow
from the following theorem.
Theorem 2.6. Let 0 â‰¤ k < n be integers, 0 â‰¤ Î± â‰¤ k and 0 â‰¤ r be real numbers,
âˆ… 6= C âŠ‚ Rn , and B âŠ‚ Rn be such that for every x âˆˆ C there exists a k-dimensional
affine subspace P at distance r from x such that P intersects B in a nonempty set
of Hausdorff dimension at least Î±. Then dim B â‰¥ 2Î± âˆ’ k + dim C âˆ’ (n âˆ’ 1).
Specially, if B contains a k-dimensional affine subspace at a fixed positive distance from every point of Rn , or if B contains the k-skeleton of a rotated unit cube
around every point of Rn , then dim B â‰¥ k + 1.
Proof. If r = 0, then we can apply Corollary 2.5 and thus we get dim B â‰¥ 2Î± âˆ’ k +
min(dim C âˆ’ k, 1) â‰¥ 2Î± âˆ’ k + dim C âˆ’ (n âˆ’ 1).
Suppose now that r > 0. If k = 0, then the condition of Theorem 2.6 means
that for
S every x âˆˆ C there exists a point contained in B at distance r from x.
Then pâˆˆB (p + rS nâˆ’1 ) âŠƒ C, where S nâˆ’1 denotes the unit sphere of center 0
in Rn . Let g : SRn Ã— S nâˆ’1 â†’ Rn , (p, e) 7â†’ p + re. Clearly, g is Lipschitz and
g(B Ã— S nâˆ’1 ) = pâˆˆB (p + rS nâˆ’1 ). Thus we have
[
dim C â‰¤ dim
(p + rS nâˆ’1 ) â‰¤ dim (B Ã— rS nâˆ’1 ) = dim B + n âˆ’ 1,
pâˆˆB

thus dim B â‰¥ dim C âˆ’ (n âˆ’ 1).
If k â‰¥ 1 and Î± = 0, then the statement is trivially true, so suppose now that
k â‰¥ 1, Î± > 0. We will use a similar argument as in the case k = 0, but we use
Theorem 2.1. Let E âŠ‚ A(n, k) be the set of those k-dimensional aï¬ƒne subspaces
that intersect B in a set of Hausdorï¬€ dimension at least Î±. By Theorem 2.1 it is
enough to prove that dim E â‰¥ dim C âˆ’ (n âˆ’ 1). For each P âˆˆ E let D(P ) âŠ‚ Rn
be the union of those k-dimensional aï¬ƒne subspaces that are parallel to P and are
at distance r from P (in the Euclidean distance of Rn ). Clearly, D(P ) is exactly
n
the
S set of those points of R that are at distance r from P , thus by assumption,
P âˆˆE D(P ) âŠƒ C. It is easy to see that dim D(P ) = n âˆ’ 1 for any P âˆˆ E.
For any P âˆˆ A(n, k), let VP denote the translate of P containing 0 and let VPâŠ¥
denote the orthogonal complement of VP . It is easy to see that there is a ï¬nite

HAUSDORFF DIMENSION OF UNIONS OF AFFINE SUBSPACES

5

SN
decomposition E = i=1 Ei such that for all i there exists a Pi âˆˆ A(n, k) with the
following properties: the orthogonal projection of Pi onto any P âˆˆ Ei is P , and the
orthogonal projection of the (n âˆ’ k âˆ’ 1)-sphere VPâŠ¥i âˆ© S nâˆ’1 onto VPâŠ¥ is contained in
the 21 -neighborhood of the (n âˆ’ k âˆ’ 1)-sphere VPâŠ¥ âˆ© S nâˆ’1 , for any P âˆˆ Ei .
Using the above properties, one can easily deï¬ne for all i a locally Lipschitz map
hi : Ei Ã— D(Pi ) â†’ Rn such that hi ({P } Ã— D(Pi )) = D(P ) for all P âˆˆ Ei . We obtain
[
[
dim C â‰¤ dim
D(P ) = max dim
D(P ) = max dim hi (Ei Ã— D(Pi )) â‰¤
P âˆˆE

i

P âˆˆEi

i

â‰¤ max dim (Ei Ã— D(Pi )) = max dim Ei + n âˆ’ 1 = dim E + n âˆ’ 1,
i

i

and thus dim E â‰¥ dim C âˆ’ (n âˆ’ 1) and we are done.



Remark 2.7. In the special cases mentioned in Theorem 2.6, the estimate is sharp.
It is easy to see that B = Rk+1 Ã— Qnâˆ’kâˆ’1 contains a k-dimensional aï¬ƒne subspace
at every positive distance from every point of Rn and clearly dim B = k + 1. The
construction given in [1] for a set B with dim B = k + 1 containing the k-skeleton
of a rotated unit cube centered at every point of Rn is also based on this example.
Corollary 2.8. Let 0 â‰¤ k < n be integers, S âŠ‚ Rn with dim S = k that can be
covered by a countable union of k-dimensional affine subspaces. Let âˆ… =
6 C âŠ‚ Rn ,
n
A âŠ‚ R such that for all x âˆˆ C there exists a rotation T âˆˆ SO(n) such that A
contains x + T (S). Then dim A â‰¥ max(k, k + dim C âˆ’ (n âˆ’ 1)).
Proof. Clearly,Sdim A â‰¥ k. Let Si âŠ‚ Rn , i â‰¥ 1, be k-dimensional aï¬ƒne subspaces
such that S âŠ‚ iâ‰¥1 Si . Let ri = d(0, Si ), and Î±i = dim (Si âˆ©S). Then supiâ‰¥1 Î±i = k
by dim S = k. The set A has the property that for all x âˆˆ Rn , there exists an aï¬ƒne
subspace P = x + T (Si ) at distance ri from x such that dim (A âˆ© P ) â‰¥ Î±i , thus we
can apply Theorem 2.6 for each i. We obtain that dim A â‰¥ 2Î±i âˆ’ k + dim C âˆ’ (nâˆ’ 1)
for all i â‰¥ 1, and thus dim A â‰¥ k + dim C âˆ’ (n âˆ’ 1).

Remark 2.9. The authors in [1] show that the estimate in Corollary 2.8 is sharp
if dim C = n and S can be covered by a countable union of k-dimensional aï¬ƒne
subspaces that do not contain the origin.
On the other hand, if the covering subspaces contain the origin, then the estimate
is not always sharp. Indeed, if S is a punctured line through the origin and C = Rn ,
then A is a Nikodym set, thus the conjecture is dim A = n. The lower bounds
obtained for the dimension of Besicovitch sets give lower bounds for the dimension
of Nikodym sets, thus for dim A as well. A survey of the currently best lower bounds
which is better than
can be found in [12]. As an example, by [17], dim A â‰¥ n+2
2
the bound 2 given by Corollary 2.8 provided n > 2.
3. The proof of Theorem 2.1
In this section we prove Theorem 2.1 subject to a lemma (Lemma 3.7), which
will be proved in Sections 4 and 5.
We start with addressing measurability issues. For the deï¬nition of analytic sets,
see e.g. [6].
Lemma 3.1. For X âŠ‚ Rn , Î± > 0 and c â‰¥ 0 let

Î±
EÎ±,c,X = {P âˆˆ A(n, k) : Hâˆ
(P âˆ© X) > c}.

If X âŠ‚ Rn is bounded GÎ´ , then EÎ±,c,X is analytic.

Lemma 3.1 is an unpublished result of M. Elekes and Z. VidnyaÌnszky. Similar
statements were also proved in [4]. For completeness, we include a proof here.

6

K. HEÌRA, T. KELETI, AND A. MAÌTHEÌ

Remark 3.2. It is easy to see that if X âŠ‚ Rn is compact, then EÎ±,c,X is FÏƒ , thus
also analytic. Therefore, to prove Theorem 2.1 (or any of the above mentioned
results) with the extra assumption that B âŠ‚ Rn is compact, the following argument
could be skipped.
Proof. Let
T = {(P, x) âˆˆ A(n, k) Ã— Rn : x âˆˆ P },
this is the natural vector bundle of rank k over A(n, k). Let Ï• : T â†’ Rn be deï¬ned
by Ï•((P, x)) = x, and let Ï€ : T â†’ A(n, k) be deï¬ned by Ï€((P, x)) = P . On T we
can consider the metric inherited from a product metric on A(n, k) Ã— Rn so that Ï•
is isometry on all ï¬bres.
Let K be the space of those non-empty compact subsets of T which lie in one
ï¬bre, that is,
K = {K âŠ‚ T : K is non-empty compact, and Ï€(K) is a singleton}.
This is a complete metric space in the Hausdorï¬€ metric. Not to mix up singletons
and their unique elements, let Ï€ â€² : K â†’ A(n, k) be deï¬ned by {Ï€ â€² (K)} = Ï€(K).
Since X is GÎ´ , Ï•âˆ’1 (X) is GÎ´ in T . It is easy to check that
def

K(Ï•âˆ’1 (X)) = {K âˆˆ K : K âŠ‚ Ï•âˆ’1 (X)}

is also GÎ´ in K.
For Î± > 0 and d > 0, let

Î±
KdÎ± = {K âˆˆ K : Hâˆ
(Ï•(K)) â‰¥ d}.

It is easy to see that these are closed sets in K.
Let
[
Î±
KÎ±,c,X = K(Ï•âˆ’1 (X)) âˆ©
Kc+1/n
.
n

Clearly, this is a Borel set in K. We claim that
(3)

EÎ±,c,X = Ï€ â€² (KÎ±,c,X ).

Clearly, the right hand side consists of those P âˆˆ A(n, k) for which P âˆ© X contains
Î±
(K) > c. We will show that for any P âˆˆ A(n, k),
a compact subset K with Hâˆ
(4)

Î±
Î±
âˆƒK âŠ‚ P âˆ© X compact with Hâˆ
(K) > c â‡â‡’ Hâˆ
(P âˆ© X) > c,

which implies (3).
To prove (4), we use the concept of capacities (see e.g. [8], Section 30).
Definition. Let Y be a Hausdorï¬€ topological space. A capacity on Y is a map
Î³ : P(Y ) â†’ [0, âˆ] such that
(i) A âŠ‚ B =â‡’ Î³(A) â‰¤ Î³(B),
(ii) A0 âŠ‚ A1 âŠ‚ Â· Â· Â· =â‡’ Î³(An ) â†’ Î³(âˆªn An ),
(iii) for any compact K âŠ‚ Y we have Î³(K) < âˆ, and if Î³(K) < r, then for some
open U âŠƒ K, Î³(U ) < r.
Î±
We claim that Î³ = Hâˆ
is a capacity on B(0, R) for any R > 0. Indeed, it is
Î±
clear that Hâˆ satisï¬es properties (i) and (iii) in any metric space, and it follows
Î±
from the results in [3] that (ii) holds for Hâˆ
in any compact metric space.
Î±
Since X is bounded GÎ´ (thus also analytic), and Hâˆ
is a capacity on the compact
metric space B(0, R) with X âŠ‚ B(0, R), the Choquet Capacitability Theorem ([8],
(30.13)) can be applied, and it gives precisely (4).
Finally, (3) implies that EÎ±,c,X is a continuous image of a Borel set, thus analytic,
and we are done.


HAUSDORFF DIMENSION OF UNIONS OF AFFINE SUBSPACES

7

Note that the statement of Theorem 2.1 is trivially true if dim E = 0, since
2Î± âˆ’ k â‰¤ Î±.
Lemma 3.3. Let s = min(dim E, 1) > 0. We can make the following assumptions
in the proof of Theorem 2.1:
(i) B is a GÎ´ set, that is, a countable intersection of open sets;
(ii) HÎ± (P âˆ© B) > 0 for every P âˆˆ E;
(iii) B is bounded;
(iv) E âŠ‚ A(n, k) is compact, and Hs (E) > 0. Moreover, there is Îµ > 0 such that
for every P âˆˆ E,
Î±
Hâˆ
(P âˆ© B) â‰¥ Îµ.
Statement (ii) is clearly weaker than (iv); it is stated to guide the proof.
e âŠ‚ E, or B is replaced
Proof. First we remark that if E is replaced by any subset E
e
e
by any superset B âŠƒ B, then the condition dim (P âˆ© B) â‰¥ dim (P âˆ© B) â‰¥ Î± in
e âŠ‚ E.
Theorem 2.1 is trivially satisï¬ed for all P âˆˆ E
e âŠƒ B be a GÎ´ set with dim B = dim B;
e the existence of such set is
(i) Let B
e
proved for example in [6]. Clearly, it is enough to prove Theorem 2.1 for B
replacing B.
(ii) Clearly, replacing Î± with a slightly smaller value, we may assume, without
loss of generality, that HÎ± (P âˆ© B) > 0 for every P âˆˆ E.
(iii) If B is not bounded then consider B = âˆªn Bn where Bn is bounded GÎ´ and
deï¬ne En = {P âˆˆ E : HÎ± (P âˆ© Bn ) > 0}. Clearly, E = âˆªn En thus dim E =
sup{dim En : n âˆˆ N}. If Theorem 2.1 holds for the bounded set Bn and
En âŠ‚ A(n, k) for every n then it holds for B and E as well. Thus we can
assume that B is bounded.
(iv) By (i), we may assume that B is GÎ´ . By (ii), for every P âˆˆ E, HÎ± (P âˆ©B) > 0,
Î±
and thus Hâˆ
(P âˆ© B) > 0. Thus E âŠ‚ âˆªâˆ
i=1 EÎ±,1/i,B , where the sets EÎ±,1/i,B
are the analytic sets given by Lemma 3.1. For every Î´ > 0, Hsâˆ’Î´ (E) = âˆ and
therefore there is i = i(Î´) with Hsâˆ’Î´ (EÎ±,1/i,B ) > 0. By Howroydâ€™s theorem
[7], there is a compact set E Î´ âŠ‚ EÎ±,1/i,B with Hsâˆ’Î´ (E Î´ ) > 0. If Theorem 2.1
holds for these compact sets E Î´ , then dim B â‰¥ 2Î± âˆ’ k + s âˆ’ Î´ for every Î´ > 0,
which ï¬nishes the proof.

Let e0 = (0, . . . , 0); let e1 = (1, 0, . . . , 0), . . . , en = (0, . . . , 0, 1) be the standard
basis vectors of Rn , and let V be the k-dimensional linear space generated by
e1 , . . . , ek . Put H0 = V âŠ¥ , and Hi = ei + H0 . Then Hi is an n âˆ’ k-dimensional
aï¬ƒne subspace for all i = 1, . . . , k. We use the sets Hi (i = 0, . . . , k) to describe
the structure of E by investigating the intersection of the elements of E with them.
Let C denote the convex hull of the vectors e0 , e1 , . . . , ek in V , Q âŠ‚ H0 the
n âˆ’ k-dimensional closed unit cube of center e0 in H0 , and S = C Ã— Q âŠ‚ Rn . Fix
Î´0 > 0 and an open set S â€² such that
(5)

SÎ´â€² 0 âŠ‚ S,

where SÎ´â€² 0 denotes the open Î´0 -neighborhood of S â€² .
Lemma 3.4. We can make the following further assumptions in Theorem 2.1.
(I) For every P âˆˆ E, P âˆ© Hi is a singleton and contained in S for all i =
0, 1, . . . , k;
(II) B âŠ‚ S â€² .
Proof.

8

K. HEÌRA, T. KELETI, AND A. MAÌTHEÌ

(I) We can cover E by ï¬nitely many compact subsets for which (I) holds after
applying a suitable similarity transformation.
(II) Since we may assume that B is bounded, this can be obtained after applying
a homothety.

Let us now ï¬x B, E, Îµ, S â€² , Î´0 (and s and Î±) with properties given by Lemma 3.3
and such that Lemma 3.4 is satisï¬ed. That is, B is bounded and GÎ´ , E is compact
and Hs (E) > 0, and
Î±
Hâˆ
(P âˆ© B) â‰¥ Îµ

(6)

for all P âˆˆ E for a ï¬xed Îµ > 0.
We apply Frostmanâ€™s lemma (see e.g. [11]) to obtain a probability measure Âµ
on A(n, k) (for which Borel and analytic sets are measurable) supported on E for
which
Âµ(B(P, r)) . rs

(7)

for all r > 0 and all P âˆˆ E.
Now we turn to estimating the dimension of the set B. Our aim is to show that
H2Î±âˆ’k+sâˆ’Î³ (B) > 0
for any Î³ > 0. Fix Î³ > 0, and let
u = 2Î± âˆ’ k + s âˆ’ Î³.
Let M be a positive integer such that
âˆ
X

1/k 2 < Îµ

k=M

Sâˆ

Let B âŠ‚
l â‰¥ M , let

i=1

and

2âˆ’M+1 â‰¤ Î´0 .

B(xi , ri ) be any countable cover with 2ri â‰¤ 2âˆ’M for all i. For any
Jl = {i : 2âˆ’l < ri â‰¤ 2âˆ’l+1 }.

Let Rl = âˆªiâˆˆJl B(xi , ri ), and Bl = Rl âˆ© B. Then B = âˆªâˆ
l=M Bl .
Our aim is to ï¬nd a big enough subset of B that is covered by balls of approximately the same radii and such that many of the aï¬ƒne subspaces of E have big
intersection with it.
Remark 3.5. In the subsequent proofs, applications of Lemma 3.1 imply that
the sets we take Âµ-measure of are Âµ-measurable, since they are in the Ïƒ-algebra
generated by analytic sets.
Lemma 3.6. There exists an integer l â‰¥ M such that


1
1
Î±
(8)
Âµ P âˆˆ E : Hâˆ
(P âˆ© Bl ) â‰¥ 2 â‰¥ 2 .
l
l
Proof. Let
Al =



Î±
P âˆˆ E : Hâˆ
(P âˆ© Bl ) â‰¥

1
l2



,

Pâˆ
and assume that Âµ(Al ) < 1/l2 for all l â‰¥ M . Since l=M 1/l2 < 1 (we may assume
Îµ â‰¤ 1), these sets Al cannot cover E. Therefore,
Pâˆ there exists P âˆˆ E such that
Î±
Î±
Hâˆ
(P âˆ© Bl ) < 1/l2, and thus Hâˆ
(P âˆ© B) < l=M 1/l2 < Îµ, which contradicts
(6).


HAUSDORFF DIMENSION OF UNIONS OF AFFINE SUBSPACES

9

Fix the integer l obtained by Lemma 3.6 and let


e = Al = P âˆˆ E : HÎ± (P âˆ© Bl ) â‰¥ 1 .
(9)
E
âˆ
l2

e We have
We will use the notation Pe = P âˆ© Bl for any P âˆˆ E.
1
1
Î± e
and Hâˆ
(P ) â‰¥ 2
l2
l

e â‰¥
Âµ(E)

(10)

e by Lemma 3.6. Note also that
for every P âˆˆ E
PeÎ´0 âŠ‚ S

(11)

e by (II) of Lemma 3.4 and the deï¬nition of S â€² and Î´0 .
for every P âˆˆ E
Let
[
(12)
F =
Pe âŠ‚ Bl âŠ‚ B.
e
P âˆˆE

Our aim is to ï¬nd a lower estimate for Ln (FÎ´ ). We will prove the following.

Lemma 3.7. There is a constant c > 0 depending on E, n, and k but independent
of l, Îµ, Î³ and the covering of B such that, for every 0 < Î´ â‰¤ Î´0 ,
Ln (FÎ´ ) â‰¥ c

Î´ nâˆ’(2Î±âˆ’k+s)
.
l8 log Î´1

e Pe for every P âˆˆ E,
e and F depend
Remark 3.8. Note
that the integer l, the sets E,
Sâˆ
on the cover B âŠ‚ i=1 B(xi , ri ).

First we show how the proof can be ï¬nished using Lemma 3.7. We prove Lemma
3.7 in Sections 4 and 5.

Remark 3.9. As it happens often, it would be easier to prove the lower bound for
the box dimension of B. For that purpose, we would not need the previous steps,
it would be enough to estimate Ln (BÎ´ ) from below. To prove the lower bound for
the Hausdorï¬€ dimension, we sorted out a big enough part of B that can be covered
by balls of approximately the same radius.
Sâˆ
Recall that B âŠ‚ i=1 B(xi , ri ), 2ri â‰¤ 2âˆ’M â‰¤ Î´20 for all i. We will use that the
balls with indices from Jl have approximately the same radius. We have that
âˆ
X
i=1

âˆ’l+1

u

(2ri ) =

âˆ X
X

l=M iâˆˆJl

(2ri )u â‰¥

X

(2ri )u &

iâˆˆJl

X

(2âˆ’l )u .

iâˆˆJl

âˆ’M+1

Let Î´ = 2
. Then Î´ â‰¤ 2
â‰¤ Î´0 .
The set F was constructed to satisfy
[
[
F âŠ‚ Bl âŠ‚
B(xi , ri ) âŠ‚
B(xi , Î´),
iâˆˆJl

and thus
FÎ´ âŠ‚
Using
(2âˆ’l )u & Î´ u =

iâˆˆJl

[

B(xi , 2Î´).

iâˆˆJl

Î´n
Î´ nâˆ’(2Î±âˆ’k+sâˆ’Î³)

&

Ln (B(xi , 2Î´))
Î´ nâˆ’(2Î±âˆ’k+sâˆ’Î³)

10

K. HEÌRA, T. KELETI, AND A. MAÌTHEÌ

and Lemma 3.7, we get
X

(2âˆ’l )u &

iâˆˆJl

X Ln (B(xi , 2Î´))
Ln (FÎ´ )
â‰¥ nâˆ’(2Î±âˆ’k+s)+Î³ &
nâˆ’(2Î±âˆ’k+sâˆ’Î³)
Î´
Î´
iâˆˆJ
l

&

1
1
Î´ nâˆ’(2Î±âˆ’k+s)
1 = Î³ 8
1 & 2âˆ’lÎ³ l 9 .
nâˆ’(2Î±âˆ’k+s)+Î³
8
Î´
l log Î´
Î´ l log Î´

Thus we obtain
âˆ
X

Sâˆinf

BâŠ‚ i=1 B(xi ,ri )
i=1
âˆ€i 2ri â‰¤2âˆ’M

(2ri )u & inf

lâ‰¥1

1
&Î³ 1
2âˆ’lÎ³ l9

proving that Hu (B) > 0 and we are done.
4. Geometric arguments
Now we start proving Lemma 3.7. In this section we prove a purely geometric
e âŠ‚ A(n, k). This part is independent of the set B and
lemma using only the set E
the number Î±.
e
Lemma 4.1. For any P, P â€² âˆˆ E,

(13)

Ln (PÎ´ âˆ© PÎ´â€² âˆ© S) .

Î´ nâˆ’k+1
Ï(P, P â€² ) + Î´

for all 0 < Î´ â‰¤ Î´0 , where Ï denotes the metric on A(n, k), and Î´0 is from (5).
e by making use of (I)
To prove Lemma 4.1, we will deï¬ne a new metric on E
e
of Lemma 3.4. We will assign a code to each k-dimensional aï¬ƒne subspace in E.
0
0
0
e
For a given P âˆˆ E, let (0, a ) = (0, . . . , 0, a1 , . . . , anâˆ’k ) denote the standard Rn coordinates of P âˆ© H0 . Similarly, let (1l , al ) = (0, . . . , 1, . . . , 0, al1 , . . . , alnâˆ’k ) denote
the standard Rn -coordinates of P âˆ©Hl for each l = 1, . . . , k. Let bl = al âˆ’a0 âˆˆ Rnâˆ’k
for each l = 1, . . . , k. We refer to a0 as the vertical intercept, and to {bl }kl=1 as the
slopes of P .
We say that the point x = x(P ) = (a0 , b1 , . . . , bk ) = (a, b) âˆˆ R(k+1)(nâˆ’k) is the
e By (I) of Lemma 3.4 one can see
code of the k-dimensional aï¬ƒne subspace P âˆˆ E.
e
that P â†’ x(P ) is well deï¬ned and injective on E.
We will use the maximum metric on the code space R(k+1)(nâˆ’k) . This means,
kx âˆ’ xâ€² k = max(ka âˆ’ aâ€² k, kb âˆ’ bâ€² k), where
ka âˆ’ aâ€² k =
(14)

kb âˆ’ bâ€² k =

max

â€²

j=1,...,nâˆ’k

max

j=1,...,nâˆ’k



|a0j âˆ’ a0j |,


â€²
max |blj âˆ’ blj |) .

l=1,...,k

e
Remark 4.2. Put d(P, P â€² ) = kx(P ) âˆ’ x(P â€² )k, then d is a natural metric on E.
Thus the metrics d and Ï are strongly equivalent, this means, there exist positive
e K1 Â· d(P, P â€² ) â‰¤ Ï(P, P â€² ) â‰¤
constants K1 and K2 such that, for every P, P â€² âˆˆ E,
â€²
K2 Â· d(P, P ).

In order to prove Lemma 4.1 we show that if P and P â€² are translated along H0
far enough from each other compared to their slopes, then the intersection of their
Î´-tubes is empty in S, and if the slopes of P and P â€² are far enough from each other,
then the intersection of their Î´-tubes is small enough in S.

HAUSDORFF DIMENSION OF UNIONS OF AFFINE SUBSPACES

11

Lemma 4.3. (a) There is a constant D > 0 (depending only on n and k) such
that if
ka âˆ’ aâ€² k > kb âˆ’ bâ€² k + DÎ´
then PÎ´ âˆ© PÎ´â€² âˆ© S = âˆ… for all 0 < Î´ â‰¤ Î´0 .
(b) If kb âˆ’ bâ€² k > 0, then Ln (PÎ´ âˆ© PÎ´â€² âˆ© S) .

Î´ nâˆ’k+1
kbâˆ’bâ€² k

for all 0 < Î´ â‰¤ Î´0 .

e and put f, g : Rk â†’ Rnâˆ’k ,
Proof. Fix P, P â€² âˆˆ E,

t = (t1 , . . . , tk ) 7â†’ a0 + t1 b1 + Â· Â· Â· + tk bk = f (t),
â€²

â€²

â€²

t = (t1 , . . . , tk ) 7â†’ a0 + t1 b1 + Â· Â· Â· + tk bk = g(t),
â€²

â€²

â€²

where a0 , b1 , . . . bk , and a0 , b1 , . . . bk are the code coordinates of P and P â€² , respectively. Then
P âˆ© S = {(t, f (t)) âˆˆ Rn : t âˆˆ C}, P â€² âˆ© S = {(t, g(t)) âˆˆ Rn : t âˆˆ C}.
One can easily prove using (I) of Lemma 3.4 and the compactness of S, that
e
there is a constant c > 0 independent of Î´ such that for all Q âˆˆ E,

(15)
QÎ´ âŠ‚ Q + {0} Ã— (âˆ’cÎ´, cÎ´)nâˆ’k ,
where for A, B âŠ‚ Rn , A + B = {a + b : a âˆˆ A, b âˆˆ B}. Fix such a constant c.
Applying (15) for P and P â€² , we have

PÎ´ âŠ‚ {(t, u) âˆˆ Rn : |f (t) âˆ’ u| < cÎ´}, PÎ´â€² âŠ‚ {(t, u) âˆˆ Rn : |g(t) âˆ’ u| < cÎ´},
and
(16)

PÎ´ âˆ© PÎ´â€² âˆ© S âŠ‚ {(t, u) âˆˆ Rn : u âˆˆ (B(f (t), cÎ´) âˆ© B(g(t), cÎ´)), t âˆˆ C}.

Clearly, |f (t)âˆ’g(t)| > 2cÎ´ implies B(f (t), cÎ´)âˆ©B(g(t), cÎ´) = âˆ…, thus PÎ´ âˆ©PÎ´â€² âˆ©S = âˆ….
Put D = 2c, then ka âˆ’ aâ€² k > kb âˆ’ bâ€² k + DÎ´ implies |f (t) âˆ’ g(t)| > 2cÎ´, thus we are
done with the proof of (a) of Lemma 4.3.
By (16) and Fubiniâ€™s theorem we also have
Z
n
â€²
Lnâˆ’k (B(f (t), cÎ´) âˆ© B(g(t), cÎ´))dLk (t).
L (PÎ´ âˆ© PÎ´ âˆ© S) â‰¤
C

If B(f (t), cÎ´) âˆ© B(g(t), cÎ´) 6= âˆ…, we will use the trivial estimate

Lnâˆ’k (B(f (t), cÎ´) âˆ© B(g(t), cÎ´)) .n,k (cÎ´)nâˆ’k . Î´ nâˆ’k .

Put N = {t âˆˆ C : |f (t) âˆ’ g(t)| â‰¤ 2cÎ´}, then
Ln (PÎ´ âˆ© PÎ´â€² âˆ© S) .

Z

Î´ nâˆ’k dLk (t).

N

Clearly, we have
(17)

NâŠ‚

nâˆ’k
\
j=1

(



)
k

 X


 0
0â€²
i
iâ€² 
t âˆˆ C :  aj âˆ’ aj +
ti bj âˆ’ bj  â‰¤ 2cÎ´ .


i=1

â€²

By the deï¬nition of k Â· k, there are indices i, j such that 0 < kb âˆ’ bâ€² k = |bij âˆ’ bij |.
Fix such an i and j, we can assume that i = k without loss of generality. Then we
get using (17) that
N âŠ‚ {t âˆˆ C : pâˆ’ (t) â‰¤ tk â‰¤ p+ (t)} ,

where

â€²

pâˆ’ (t) = pâˆ’ (t1 , . . . , tkâˆ’1 ) =

âˆ’2cÎ´ âˆ’ (a0 âˆ’ a0 ) âˆ’

kâˆ’1
P

bkj âˆ’ bkj

i=1

â€²

â€²

ti (bij âˆ’ bij )

,

12

K. HEÌRA, T. KELETI, AND A. MAÌTHEÌ

â€²

p+ (t) = p+ (t1 , . . . , tkâˆ’1 ) =

2cÎ´ âˆ’ (a0 âˆ’ a0 ) âˆ’

kâˆ’1
P
i=1

bkj âˆ’ bkj

â€²

ti (bij âˆ’ bij )

â€²

.

The set {t âˆˆ C : pâˆ’ (t) â‰¤ tk â‰¤ p+ (t)} is obtained as the intersection of the simplex
C and the strip between the parallel hyperplanes {tk = p+ (t)}, {tk = pâˆ’ (t)}. One
can easily calculate the distance of these hyperplanes, using the normal vector
â€²
â€²
n = (b1j âˆ’ b1j , . . . , bkj âˆ’ bjk ). One gets
d = d({tk = p+ (t)}, {tk = pâˆ’ (t)}) = s

2cÎ´
k
P

(bij
i=1

âˆ’

.
â€²
bij )2

Thus the set N is contained in a âˆš
rectangular box, where the shortest side length is
d and the others are diam (C) = 2. Then
Lk (N ) . s

Î´
k
P

.

(bij âˆ’ bij )2
â€²

Î´
Î´
=
,
â€²
kb âˆ’ bâ€² k
|bkj âˆ’ bkj |

i=1

thus

Ln (PÎ´ âˆ© PÎ´â€² âˆ© S) .
and we are done with the proof of Lemma 4.3.

Î´ nâˆ’k+1
kb âˆ’ bâ€² k



Now we prove Lemma 4.1.
Proof. Using (a) of Lemma 4.3 we obtain that PÎ´ âˆ© PÎ´â€² âˆ© S = âˆ… for all 0 < Î´ â‰¤ Î´0 if
ka âˆ’ aâ€² k > kb âˆ’ bâ€² k + DÎ´, so (13) is clearly satisï¬ed.
Assume now that ka âˆ’ aâ€² k â‰¤ kb âˆ’ bâ€² k + DÎ´, and kb âˆ’ bâ€² k â‰¤ Î´. By Remark 4.2,
Ï(P, P â€² ) â‰¤ K2 kx âˆ’ xâ€² k â‰¤ K2 (D + 1)Î´ . Î´,
and then since S is bounded, we have
Ln (PÎ´ âˆ© PÎ´â€² âˆ© S) â‰¤ Ln (PÎ´ âˆ© S) . Î´ nâˆ’k =

Î´ nâˆ’k+1
Î´ nâˆ’k+1
.
.
Î´
Ï(P, P â€² ) + Î´

Thus we are done in this case.
If ka âˆ’ aâ€² k â‰¤ kb âˆ’ bâ€² k + DÎ´ and kb âˆ’ bâ€² k â‰¥ Î´, we have that
Ï(P, P â€² ) + Î´ â‰¤ K2 kx âˆ’ xâ€² k + Î´ â‰¤ K2 (kb âˆ’ bâ€² k + DÎ´) + Î´ . kb âˆ’ bâ€² k
using Remark 4.2 again. Applying (b) of Lemma 4.3, we obtain that
Ln (PÎ´ âˆ© PÎ´â€² âˆ© S) .

Î´ nâˆ’k+1
Î´ nâˆ’k+1
.
,
kb âˆ’ bâ€² k
Ï(P, P â€² ) + Î´

which is (13).

5. The proof of Lemma 3.7, L2 argument
In this section we prove Lemma 3.7 with help on an L2 estimation technique.
It resembles the technique that CoÌrdoba used in his proof for the Kakeya maximal
inequality in the plane, see [2].

HAUSDORFF DIMENSION OF UNIONS OF AFFINE SUBSPACES

By Fubiniâ€™s theorem we have the following:
Z
Z Z
n e
Ï‡PeÎ´ (y)dydÂµ(P )
L (PÎ´ )dÂµ(P ) =
e Rn
E

e
E

=

Z Z

Ï‡PeÎ´ (y)dÂµ(P )dy =

Rn E
e

S

Z

Rn

Ï‡FÎ´ (y) Â·

Z

13

Ï‡PeÎ´ (y)dÂµ(P )dy,

e
E

where F = P âˆˆEe Pe from (12). Now we
R apply the Cauchy-Schwarz inequality for
the L2 functions y 7â†’ Ï‡FÎ´ (y) and y 7â†’ Ï‡PeÎ´ (y)dÂµ(P ). We get
Z

Rn

e
E

ï£«
ï£¶
ï£¶2 ï£¶1/2
ï£«
ï£¶1/2 ï£« ï£«
Z
Z
Z Z
ï£¬
ï£·
ï£¬ ï£¬
ï£·
ï£·
Ï‡FÎ´ (y) Â· ï£­ Ï‡PeÎ´ (y)dÂµ(P )ï£¸ dy â‰¤ ï£­ Ï‡2FÎ´ (y)dy ï£¸ Â· ï£­ ï£­ Ï‡PeÎ´ (y)dÂµ(P )ï£¸ dy ï£¸
Rn

e
E

Rn

= (Ln (FÎ´ ))

1/2

ï£«

ï£¬
Â·ï£­

Z ZZ

Rn EÃ—
e E
e

ï£«

ï£¬
= (Ln (FÎ´ ))1/2 Â· ï£­

ZZ

e E
e
EÃ—

We proved that
Z

e
E

Ln (PeÎ´ )dÂµ(P ) â‰¤ (Ln (FÎ´ ))

1/2

ï£«

ï£¬
Â·ï£­

ZZ

e E
e
EÃ—



e
E

ï£·
Ï‡PeÎ´ (y) Â· Ï‡Pfâ€² Î´ (y)dÂµ(P )dÂµ(P â€² )dy ï£¸


ï£¶1/2



fâ€² Î´ dÂµ(P )dÂµ(P â€² )ï£·
Ln PeÎ´ âˆ© P
ï£¸


ï£¶1/2

fâ€² Î´ dÂµ(P )dÂµ(P â€² )ï£·
Ln PeÎ´ âˆ© P
ï£¸

.

On the other hand, there is a lower bound for the left hand side.
For any U âŠ‚ Rn and Îµ > 0, let N (U, Îµ) denote the smallest number of Îµ-balls
needed to cover U . It is well known (see e.g. [11]) that Ln (UÎµ ) &n N (U, 2Îµ)Îµn for
Î± e
every U âŠ‚ Rn and Îµ > 0. Since Hâˆ
(P ) â‰¥ l12 by (10), we have N (Pe , Îµ) Â· (2Îµ)Î± â‰¥ l12
e and Îµ > 0, thus
for every P âˆˆ E
1
(18)
Ln (PeÎ´ ) & N (Pe , 2Î´) Â· Î´ n & Î´ nâˆ’Î± Â· 2 .
l
Then
Z
1
e â‰¥ Î´ nâˆ’Î± Â· 1
Ln (PeÎ´ )dÂµ(P ) & Î´ nâˆ’Î± Â· 2 Â· Âµ(E)
l
l4
by (10).
Thus we get
(19)

e
E

Î´ 2nâˆ’2Î±
. Ln (FÎ´ ) Â·
l8

ZZ

e E
e
EÃ—



fâ€² Î´ dÂµ(P )dÂµ(P â€² ).
Ln PeÎ´ âˆ© P

Thus we need to ï¬nd an upper estimate for
ZZ
fâ€² Î´ )dÂµ(P )dÂµ(P â€² ).
(20)
Ln (PeÎ´ âˆ© P

ï£¶1/2

e E
e
EÃ—

This means, we have to investigate, how the diï¬€erent Î´-tubes intersect each other.
e into parts. One can easily
We will estimate the integral (20) by dividing the set E
check using Remark 3.5 that the elements of this partition will be measurable.

.

14

K. HEÌRA, T. KELETI, AND A. MAÌTHEÌ

e Put
Fix a P â€² âˆˆ E.

and

e : Ï(P, P â€² ) â‰¤ Î´}
E0 = {P âˆˆ E

e : 2jâˆ’1 Î´ < Ï(P, P â€² ) â‰¤ 2j Î´}
Ej = {P âˆˆ E
e = SN Ej , so
for j = 1, . . . , N , where N . log Î´1 . Clearly, we have E
j=0
(21)

Z

fâ€² Î´ )dÂµ(P ) =
L (PeÎ´ âˆ© P
n

e
E

Z

E0

fâ€² Î´ )dÂµ(P ) +
L (PeÎ´ âˆ© P
n

N Z
X

j=1E
j

By (11) and Lemma 4.1, we obtain
Z
Z
Z
fâ€² Î´ )dÂµ(P ) â‰¤ Ln (PÎ´ âˆ© P â€² âˆ© S)dÂµ(P ) .
Ln (PeÎ´ âˆ© P
(22)
Î´

Î´ nâˆ’k+1
dÂµ(P )
Ï(P, P â€² ) + Î´

Ej

Ej

Ej

fâ€² Î´ )dÂµ(P ).
Ln (PeÎ´ âˆ© P

for each j = 0, . . . , N .
In the case j = 0, we obtain that
Z
nâˆ’k+1
fâ€² Î´ )dÂµ(P ) . Î´
Ln (PeÎ´ âˆ© P
Âµ(E0 ) . Î´ nâˆ’k Â· Î´ s
(23)
Î´
E0

by (22) and (7).
For j âˆˆ {1, . . . , N }, we get
Z
nâˆ’k+1
Î´ nâˆ’k+s Â· 2js
Î´ nâˆ’k j s
fâ€² Î´ )dÂµ(P ) â‰¤ Î´
Ln (PeÎ´ âˆ© P
(24)
(2
Î´)
=
Âµ(E
)
.
j
2jâˆ’1 Î´ + Î´
2j
2j
Ej

by (22) and (7) again. Applying these estimates for (21) and using s â‰¤ 1, we get
ï£«
ï£¶
Z
N
js
X
2 ï£¸
1
fâ€² Î´ )dÂµ(P ) . Î´ nâˆ’k+s ï£­1 +
Ln (PeÎ´ âˆ© P
. Î´ nâˆ’k+s N . Î´ nâˆ’k+s log .
j
2
Î´
j=1
e
E

e â‰¤ 1 that
Finally we integrate with respect to P â€² and obtain by Âµ(E)
ZZ
fâ€² Î´ )dÂµ(P )dÂµ(P â€² ) . Î´ nâˆ’k+s log 1 .
Ln (PeÎ´ âˆ© P
Î´
e E
e
EÃ—

Recalling (19), we obtain that

1
Î´ 2nâˆ’2Î±
. Ln (FÎ´ ) Â· Î´ nâˆ’k+s log ,
8
l
Î´
thus
Ln (FÎ´ ) &

Î´ nâˆ’2Î±+kâˆ’s
l8 log 1Î´

and we are done with the proof of Lemma 3.7 and so also with the proof of Theorem
2.1.
Acknowledgement
The ï¬rst author is grateful to Izabella Laba for her notes on intersections of
Cantor sets and diï¬€erentiation for self-similar measures. It helped her choosing the
formulation of the L2 argument used in Section 5. The authors are grateful to the
referees for their helpful suggestions.

HAUSDORFF DIMENSION OF UNIONS OF AFFINE SUBSPACES

15

References
[1] A. Chang, M. CsoÌˆrnyei, K. HeÌra and T. Keleti, Small unions of affine subspaces and skeletons
via Baire category, Adv. Math. 328 (2018), 801â€“821.
[2] A. CoÌrdoba, Kakeya maximal function and spherical summation of multipliers, Amer. J.
Math. 99 (1977), 1â€“22.
[3] R. O. Davies, Increasing Sequences of Sets and Hausdorff Measure, Proc. London Math. Soc.
(3) 20 (1970), 222â€“236.
[4] C. Dellacherie, Ensembles Analytiques, CapaciteÌs, Mesures de Hausdorff, Lecture Notes in
Mathematics 295, Springer-Verlag, 1972.
[5] K. Falconer and P. Mattila, Strong Marstrand theorems and dimensions of sets formed by
subsets of hyperplanes, J. Fractal Geom. 3 (2016), 319â€“329.
[6] D. H. Fremlin, Measure Theory: Topological Measure Spaces (Vol. 4), Torres Fremlin, 2003.
[7] J. D. Howroyd, On dimension and on the existence of sets of finite positive Hausdorff measure,
Proc. London Math. Soc. (3) 70 (1995), 581â€“604.
[8] A. S. Kechris, Classical Descriptive Set Theory, Graduate Texts in Mathematics 156,
Springer-Verlag, 1994.
[9] T. Keleti, Are lines much bigger than line segments?, Proc. Amer. Math. Soc. 144 (2016),
1535â€“1541.
[10] T. Keleti, D. T. Nagy and P. Shmerkin, Squares and their centers, to appear in J. Anal.
Math.
[11] P. Mattila, Geometry of sets and measures in Euclidean spaces, Cambridge University Press,
1995.
[12] P. Mattila, Fourier Analysis and Hausdorff Dimension, Cambridge University Press, 2015.
[13] U. Molter and E. Rela, Furstenberg sets for a fractal set of directions, Proc. Amer. Math.
Soc. 140 (2012), 2753â€“2765.
[14] D. M. Oberlin, Unions of hyperplanes, unions of spheres, and some related estimates, Illinois
J. Math. 51 (2007), no. 4, 1265â€“1274.
[15] D. M. Oberlin, Exceptional sets of projections, unions of k-planes, and associated transforms,
Israel J. Math. 202 (2014), 331â€“342.
[16] R. Thornton, Cubes and Their Centers, Acta Math. Hungar. 152 (2017), 291â€“313.
[17] T. Wolff, An improved bound for Kakeya type maximal functions, Revista Math. Iberoamericana 11 (1995), 651â€“674.
[18] T. Wolff, A Kakeya-type problem for circles, Amer. J. Math. 119 (1997), 985â€“1026.
[19] T. Wolff, Local smoothing type estimates on Lp for large p, Geom. Funct. Anal. 10 (2000),
1237â€“1288.
Institute of Mathematics, EoÌˆtvoÌˆs LoraÌnd University, PaÌzmaÌny PeÌter seÌtaÌny 1/c,
H-1117 Budapest, Hungary
E-mail address: herakornelia@gmail.com
E-mail address: tamas.keleti@gmail.com
Mathematics Institute, University of Warwick, Coventry, CV4 7AL, UK
E-mail address: a.mathe@warwick.ac.uk

