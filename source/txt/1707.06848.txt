Hyperbolic polyhedra and discrete uniformization
Boris Springborn

arXiv:1707.06848v3 [math.MG] 27 Mar 2018

Abstract
We provide a constructive, variational proof of Rivin’s realization theorem for ideal hyperbolic polyhedra with prescribed intrinsic metric, which
is equivalent to a discrete uniformization theorem for spheres. The same
variational method is also used to prove a discrete uniformization theorem of Gu et al. and a corresponding polyhedral realization result of Fillastre. The variational principles involve twice continuously differentiable
functions on the decorated Teichmüller spaces Teg,n of punctured surfaces,
which are analytic in each Penner cell, convex on each fiber over T g,n , and
invariant under the action of the mapping class group.
57M50, 52B10, 52C26

1

Introduction

This article is concerned with two types of problems that are in fact equivalent:
realization problems for ideal hyperbolic polyhedra with prescribed intrinsic
metric, and discrete uniformization problems. We develop a variational method
to prove the respective existence and uniqueness theorems. Special attention is
paid to the case of genus zero, because it turns out to be the most difficult one.
In particular, we provide a constructive variational proof of Rivin’s realization
theorem for convex ideal polyhedra with prescribed intrinsic metric:
Theorem 1.1 (Rivin [26]). Every complete hyperbolic surface S of finite area
that is homeomorphic to a punctured sphere can be realized as a convex ideal
polyhedron in three-dimensional hyperbolic space H 3 . The realization is unique
up to isometries of H 3 .
The realizing polyhedron is allowed to degenerate to a two-sided ideal polygon. The uniqueness statement of Theorem 1.1 implies that this is the case if
and only if S admits an orientation reversing isometry mapping each cusp to
itself.
An analogous realization result for convex euclidean polyhedra was proved
by Alexandrov [2, pp. 99–100], and Rivin’s original proof of Theorem 1.1 follows the general approach introduced by Alexandrov: First, show that the realization is unique if it exists. Then use this rigidity result to show that the space
of realizable metrics is open and closed in the connected space of all metrics.
This topological argument does not provide a method of actually constructing
a polyhedron with prescribed intrinsic metric, and to find such a method was
posed as a problem for further research [26].
1

The proof of Theorem 1.1 presented here is variational in nature. It proceeds by transforming the realization problem into a finite dimensional nonlinear convex optimization problem with bounds constraints (see Theorem 7.18).
This optimization problem is then shown to have an adequately unique solution
(see Section 9). The number of variables is n − 1 for a sphere with n cusps. The
v∞
target function E¯∆,λ
(see Definition 7.16) is twice continuously differentiable
and piecewise analytic (see Proposition 7.17). The main work of proving the
differentiability statement is done in Section 8.
Calculating a value of the target function involves Epstein and Penner’s convex hull construction [10, 22, 23]. For the purposes of this article, it is necessary
to translate this construction into the language of Delaunay decompositions
(see Sections 4 and 5). Constructing an ideal Delaunay triangulation can be
achieved by Weeks’s edge flip algorithm [30]. Once the Delaunay triangulation
is known, the target function and its first and second derivatives are given by
explicit equations (see Proposition 7.17).
A variational proof of Alexandrov’s realization theorem for euclidean polyhedra was given by Bobenko and Izmestiev [4]. Their proof also provides a
constructive method to produce polyhedral realizations, and there are some
similarities between their approach and ours. The variational principles are
analogous, and Delaunay triangulations play an important role, too. But there
is one important difference: The variational principle of Bobenko and Izmestiev
involves a non-convex target function, while the target function considered here
is convex. This makes the case of ideal polyhedra actually simpler than the case
of euclidean polyhedra, for which no convex variational principle is known.
In Section 10 we turn to the other side of the theory, discrete conformal
maps. The realization Theorem 1.1 is equivalent to a discrete uniformization
theorem for spheres, Theorem 10.6. The equivalence of discrete conformal
mapping problems and realization problems for ideal hyperbolic polyhedra was
established in a previous article [5]. Previously, we treated conformal mapping
problems and polyhedral realization problems with fixed triangulations. In this
article, we require the variable triangulations to be Delaunay. The previously established variational principle extends to the setting of variable triangulations.
For discrete conformal maps, this extension can be described roughly as follows:
Minimize the same function as in [5], but flip to a Delaunay triangulation before evaluating it. However, instead of using standard euclidean edge flips that
do not change the piecewise euclidean metric of the triangulation, use Ptolemy
flips: Update the length of the flipped edge using Ptolemy’s relation (9). This
does change the piecewise euclidean metric, except if the adjacent triangles are
inscribed in the same circle. Nevertheless, Ptolemy flips are the right thing to do
because they do not change the induced hyperbolic metric (see Proposition 10.3
and Definition 10.4).
In Section 11 we use the variational approach to prove the uniformization
theorem of Gu et al. [15] (see Theorem 11.1) and a polyhedral realization result
proved by Fillastre [12] using Alexandrov’s method (see Theorem 11.2). Note
that Rivin’s Theorem 1.1 and Theorem 10.6 on the uniformization spheres are
not covered by the work of Gu et al. [14, 15].
It may be possible to adapt the variational method presented here to other

2

problems, for example discrete conformal mapping problems of surfaces with
boundary. Transferring the method to the setting of piecewise hyperbolic surfaces [14] should be straightforward, starting with the known variational principle for a fixed triangulation [5, Sec. 6]. All this is beyond the scope of this
article.
Although the variational method presented in this article is applied to realize three-dimensional ideal polyhedra, the problems are all essentially twodimensional. Whether any truly three-dimensional problem can be treated in
a similar fashion seems to be one of the most interesting questions raised by
this approach. In particular, “deformations” of two-dimensional problems, like
problems involving quasi-Fuchsian manifolds [21], might have a chance to be
tractable.

2

Overview: Polyhedral realizations from realizable coordinates

We want to show that the following problem has a unique solution up to isometries of H 3 :
Problem 2.1. Given a complete finite area hyperbolic surface S homeomorphic
to a sphere with n ≥ 3 punctures, find a realization as convex ideal polyhedron.
We assume the hyperbolic surface S is specified in Penner coordinates (∆, λ),
consisting of a triangulation ∆ of the sphere with n marked points and a function
λ : E∆ → R on the set E∆ of edges (see Section 3). These coordinates determine
the hyperbolic surface S together with an ideal triangulation ∆ and a choice of
horocycle at each cusp. For each edge e ∈ E∆ , the coordinate λe is the signed
distance of the horocycles at the ends of e (see Figure 2, Remark 3.1).
Remark 2.2 (shear coordinates). Rivin [26] assumes that the surface S is specified by shear coordinates. This is not an issue because it is straightforward
to convert between shear coordinates and Penner coordinates (see Proposition 3.5).
The basic idea of our approach is the following: For any polyhedral realization of S and any choice of a distinguished vertex v∞ , there are special adapted
e λ̃) with certain characteristic properties. We call them realizable
coordinates (∆,
coordinates with distinguished vertex v∞ (see Definition 6.1). The realizable coe λ̃) describe the same hyperbolic surface S as the given coordinates
ordinates (∆,
(∆, λ), but the ideal triangulation and the choice of horocycles are in general
different. Conversely, if realizable coordinates for S are known, it is straightforward to reconstruct the polyhedral realization. Thus, solving Problem 2.1 turns
out to be equivalent to the problem of finding realizable coordinates:
Problem 2.3. Given Penner coordinates (∆, λ) of a complete finite area hyperbolic surface S homeomorphic to a sphere with n ≥ 3 punctures and a chosen
e λ̃) with distinguished
distinguished cusp v∞ , find realizable coordinates (∆,
vertex v∞ for the same surface.

3

Figure 1: Ideal polyhedron (bounded by the transparent hyperbolic planes)
decorated with horospheres (white) at ideal vertices
Definition 6.1 characterizes realizable coordinates in terms of the intrinsic
geometry of the surface S. This characterization relies on Epstein and Penner’s
convex hull construction [10, 22, 23] for cusped hyperbolic surfaces decorated
with horocycles, and Akiyoshi’s [1] generalization, allowing partially decorated
surfaces: Horocycles may be missing at some (but not all) cusps. The necessary background will be reviewed in Sections 4 and 5 in the language of ideal
Delaunay decompositions.
While the intrinsic characterization of realizable coordinates requires some
preparation, it is more straightforward to explain how a polyhedral realization
gives rise to adapted Penner coordinates from which the realization can easily
be reconstructed. Consider a convex ideal polyhedron P realizing the hyperbolic
surface S in the half-space model of hyperbolic space (see Figure 1). Assume
that one ideal vertex, v∞ , is the point at infinity in the half-space model. The
faces of P are ideal polygons. Should any face have more than three sides,
triangulate it by adding diagonal ideal arcs. The diagonals may be chosen arbitrarily, except in vertical faces incident with v∞ , which should be triangulated
by adding the vertical diagonals incident with v∞ .
For every ideal vertex v of P, choose a horosphere s v centered at v as follows:
Choose an arbitrary horosphere s v∞ at v∞ (not shown in Figure 1). For all other
vertices v 6= v∞ let s v be the horosphere centered at v that touches s v∞ (white
spheres in Figure 1). For each edge e not incident with v∞ let λ̃e be the signed
distance (see Figure 2) of the horospheres at the ends of e. For each edge e
incident with v∞ , let λ̃e = ∞.
Intrinsically, the ideal polyhedron P is the hyperbolic surface S. The trian-

4

λ>0
λ<0

Figure 2: Signed distance λ of disjoint and intersecting horocycles
e of S. The horospheres s v at
gulated faces of P form an ideal triangulation ∆
the vertices of P intersect the surface S in horocycles h v = s v ∩ P. The signed
distance λ̃e of horospheres in H 3 is also the intrinsic signed distance of the core λ̃) are
responding horocycles in S along the ideal arc e. By Proposition 6.2, (∆,
realizable coordinates with distinguished vertex v∞ as defined in Definition 6.1.
e λ̃), proceed as follows: For each
To reconstruct the realization P from (∆,
triangle t ∈ T∆
e that is not incident with v∞ , construct an ideal tetrahedron
as shown in Figure 3. These tetrahedra fit together to form the ideal polyhedron P. This construction of a realizing polyhedron works for any coordinates
that are realizable in the sense of Definition 6.1 (see Proposition 6.3).
The intrinsic Problem 2.3 of finding realizable coordinates turns out to be
equivalent to a convex optimization problem (see Theorem 7.18). This leads to
a proof of Theorem 1.1 (see Section 9).

3

Penner coordinates

In Sections 3–5, we review known results from Teichmüller theory. The aim
is to fix notation, to collect required background material and equations for
reference, and to translate the convex hull construction into the language of
Delaunay decompositions. For the reader’s convenience, we indicate proofs
whenever we see a way to do so by a short comment or a suggestive picture.
For a more thorough treatment, we refer to the literature. In this section, we
review Penner’s coordinates for the decorated Teichmüller spaces of punctured
surfaces [22] [23].
Let S g be the oriented surface of genus g, let V ⊆ S g be a finite nonempty
subset of n = |V | points and let S g,n = S g \ V be the oriented surface of genus g
with n punctures. The pair (S g , V ) is the surface of genus g with n marked
points. A triangulation of (S g , V ) is a triangulation with vertex set V . We will
denote the set of edges by E∆ and the set of triangles by T∆ . We write e1 (t),
e2 (t), e3 (t) for the edges of a triangle t in cyclic order, e1 (v), . . . , edeg(v) (v) for
the edges emanating from a vertex v in cyclic order, and v1 (e), v2 (e) for the
vertices of an edge e (in arbitrary order).
Penner coordinates (∆, λ) on the decorated Teichmüller space Teg,n consist
of a triangulation ∆ of (S g , V ) and a function λ ∈ R E∆ . The Penner coordinates
describe a complete hyperbolic surface with finite area of genus g with n cusps,
marked by S g,n , and decorated with a horocycle at each cusp, together with
an ideal triangulation. The cusps correspond to the vertices v ∈ V and the
5

x



v∞

α3
`2
A1 α1
v1

A3

v3
λ2

λ1 `1

`3

α2

λ3

A2

v2

Figure 3: Ideal tetrahedron decorated with horospheres at the vertices. The
horosphere at v∞ is the horizontal plane at height 1. The horospheres at v1 , v2 ,
v3 touch the horosphere at v∞ . The horosphere at v∞ intersects the tetrahedron
1
in a euclidean triangle with sides `i = e 2 λi , where λi are the signed distances
between horospheres (see Figure 4).

1

` = e2λ
λ

Figure 4: Signed distance λ and horocyclic arc length ` in a configuration of
two horocycles that are tangent to a third horocycle

6

ideal triangulation corresponds to a triangulation in the isotopy class of ∆. For
simplicity, we will identify cusps with vertices and the ideal triangulation with
∆. The value λe = λ(e) for an edge e ∈ E∆ is the signed distance (see Figure 2)
of the horocycles at its ideal vertices v1 (e), v2 (e) as measured in a lift to the
universal cover H 2 .
e we denote the chart transition function by
For two triangulations ∆, ∆,
E∆
τ∆,∆
→ R E∆e .
e :R

(1)

e λ̃) describe the same surface if
That is, the Penner coordinates (∆, λ) and (∆,
and only if λ̃ = τ∆,∆
e (λ).
Remark 3.1 (notation warning). Our λs denote hyperbolic lengths, not Penner’s lambda-lengths [23]. The lambda-lengths are eλ/2 , and we denote them
by
in this paper. In earlier articles [22], the lambda-lengths were defined as
p ` λ/2
2e .
The decorated Teichmüller space Teg,n is a fiber bundle over the ordinary
Teichmüller space T g,n . The projection map π : Teg,n → T g,n simply forgets
about the decoration. The fibers, whose points correspond to choices of decorating horocycles, are naturally affine spaces. If a decorated surface with Penner coordinates (∆, λ) is chosen as the origin in its fiber, then there is a natural
parametrization of the fiber by RV :
Proposition 3.2 (parametrizing a fiber of Teg,n ). Let Λ(∆,λ) be the function
Λ(∆,λ) : RV −→ R E∆ ,

u 7−→ Λ(∆,λ) (u)

where the value of Λ(∆,λ) (u) for e ∈ E∆ is
(u) = λe + u v1 (e) + u v2 (e) .
Λ(∆,λ)
e

(2)

Then the decorated surfaces in the fiber of the surface with coordinates (∆, λ) are
precisely the surfaces with Penner coordinates (∆, Λ∆,λ (u)) for some u ∈ RV , and u
is uniquely determined by (∆, λ) and the decorating horocycles. The horocycle of
the decorated surface (∆, Λ∆,λ (u)) at a vertex v is a distance u v away from the
horocycle of (∆, λ) at v, measured in the direction of the cusp.
The following two propositions provide relations between λs and the lengths
of horocyclic arcs.
Proposition 3.3 (horocyclic arcs in a decorated triangle). Consider a decorated
ideal triangle with signed horocycle distances λ1 , λ2 , λ3 as shown in Figure 5.
Each horocycle intersects the triangle in an arc of length αk . The signed horocycle
distances λ determine the horocyclic arc lengths α, and vice versa, via the relations
1

αi = e 2 (λi −λ j −λk ) ,

(3)

λi = − log α j − log αk ,

(4)

where (i, j, k) is a permutation of (1, 2, 3).
7

α1

α1

λ3
α2

λ1

1+i
λ2

i
λ3
λ2

α2

α3

0

λ1

α3

1

Figure 5: Decorated ideal triangle in the Poincaré disk model (left) and in the
half-plane model (right)

λb
λc
σe
λd

βα

λa

Figure 6: Penner coordinates and shear coordinates
Summing the horocyclic arc lengths around one vertex, one obtains the total
horocycle length at a cusp:
Proposition 3.4 (horocycle length at a cusp). The total length of the horocycle
at a cusp v ∈ V of the decorated hyperbolic surface with Penner coordinates (∆, λ)
is


d−1
X
1
λ
−λ
−λ
c v (∆, λ) =
e 2 bei (v) ei (v) ei+1 (v) ,
(5)
k=0

where e1 (v), . . . , ed (v) = e0 (v) are the edges emanating from v in cyclic order and
ê1 (v), . . . , êd (v) = ê0 (v) are the edges opposite v in cyclic order, so that the i-th
triangle around v looks like this:
ei+1
v

êi
ei

Shear coordinates (∆, σ) on the Teichmüller space T g,n also consist of a triangulation ∆ of (S g , V ) and a function σ ∈ R E∆ . Shear coordinates describe
a marked surface together with an ideal triangulation but without decorating
horocycles. For each edge e ∈ E∆ , σe = σ(e) is the shear with which the ideal
triangles are glued together along e (see Figure 6). The shear coordinates of a

8

vc

d

α1

α2

e
f

γ γ0

c

va

α

α0

e

b

va0

0
β β

a

vb

Figure 7: Ptolemy relation

Figure 8: Local Delaunay condition

complete hyperbolic surface sum to zero around every cusp:
deg(v)
X

σei (v) = 0.

(6)

i=1

Proposition 3.5 (Penner coordinates and shear coordinates). (i) The shear coordinates (∆, σ) of a decorated surface with Penner coordinates (∆, λ) are
σe =

1
(λa − λ b + λc − λd ) = log β − log α,
2

(7)

where a, b, c, d are the edges adjacent to edge e, and α, β are the horocycle arc
lengths, as shown in Figure 6.
(ii) Conversely, if (∆, σ) are the shear coordinates of a complete finite area
hyperbolic surface S, then one obtains Penner coordinates (∆, λ) for S, decorated
with some choice of horocycles, as follows. First, note that the shear coordinates
determine the length ratios of adjacent horocycle arcs α, β as shown in Figure 6
by equation (7). Use the relations (7) to determine compatible arc lengths around
each vertex. (The equations (7) are compatible by (6), but under-determined: At
each vertex, exactly one arc length may be chosen arbitrarily, and this choice fixes
the decorating horocycle.) Then use equations (4) to determine λ.
The Penner coordinates of a decorated surface with respect to triangulations
∆ and ∆0 that differ by a single edge flip are related by Ptolemy’s relation (9):
Proposition 3.6 (Ptolemy relation). Consider a decorated ideal quadrilateral
with edges a, b, c, d and diagonals e, f as shown in Figure 7. Let λa , . . . , λ f
be the respective signed horocycle distances. Then `a , . . . , ` f defined by
1

` = e2λ

(8)

`e ` f = `a `c + ` b `d .

(9)

satisfy Ptolemy’s relation
Proof. This follows with (3) from
1

1

1

e 2 (λa −λd −λ f ) + e 2 (λ b −λc −λ f ) = α1 + α2 = e 2 (λe −λc −λd )
1

by multiplying both sides with e 2 (λc +λd +λ f ) .
9

4

Ideal Delaunay triangulations

Epstein and Penner’s convex hull construction [10, 22, 23] is a fundamental tool
for the polyhedral realization method presented here. The construction works
for cusped hyperbolic manifolds of arbitrary dimension, but some aspects are
simpler for surfaces (compare, e.g., the local condition (10) with the generalized tilt formula [27]), and other aspects (like the edge flip algorithm [30])
have no adequate counterpart in higher dimensions. In this section, we will
review the relevant results focusing on the two-dimensional case.
In order to apply the convex hull construction to polyhedral realization problems, we need to translate it into the language of Delaunay decompositions.
This translation is a straightforward application of the pole-polar relationship
of projective geometry and Proposition 4.1 below. In the hyperboloid model
of the hyperbolic plane, circles are intersections of the hyperboloid with affine
planes. Planes intersecting the hyperboloid correspond, via the pole-polar relationship, to points outside the hyperboloid. Two circles intersect orthogonally
if the pole of one circle’s plane lies in the other circle’s plane. The vertices of
the Epstein–Penner convex hull correspond to horocycles, while the faces correspond to orthogonally intersecting circles. (It may be necessary to scale the
convex hull up to make all faces intersect the hyperboloid.) Convexity translates to the condition that a face-circle intersects all horocycles corresponding
to non-incident vertices less than orthogonally. So far, everything is analogous
to the standard theory of power diagrams and weighted Delaunay triangulations in euclidean space [3]. Proposition 4.1 allows us to express the Delaunay
condition in terms of oriented contact instead of orthogonality. This only works
for Delaunay triangulations in hyperbolic space and with horospheres as sites.
Proposition 4.1 (orthogonality and contact). Let h1 , . . . , hn be horocycles with
different centers in the hyperbolic plane. Of the following statements, any two
labeled with the same letter are equivalent. If n ≥ 3, statements labeled with
different letters are mutually exclusive.
(a1 ) There is a circle that intersects every horocycle h1 , . . . , hn orthogonally.
(a2 ) There is a circle that touches every horocycle h1 , . . . , hn externally.
(b1 ) There is a horocycle that intersects every horocycle h1 , . . . , hn orthogonally.
(b2 ) There is a horocycle that touches every horocycle h1 , . . . , hn .
(c1 ) There is a hypercycle that intersects every horocycle h1 , . . . , hn orthogonally.
(c2 ) There is a hypercycle or geodesic that touches every horocycle h1 , . . . , hn on
the same side.
(A hypercycle is a complete curve at a constant nonzero distance from a geodesic.)
The following definitions and theorems summarize Epstein and Penner’s results in the language of Delaunay decompositions.
Definition 4.2 (ideal Delaunay decomposition). Let S be a complete finite area
hyperbolic surface with at least one cusp, decorated with a horocycle at each
cusp. First, assume that the horocycles are small enough so that they bound
disjoint cusp neighborhoods. An ideal cell decomposition D of S is an ideal

10

Delaunay decomposition, if its lift D̂ to H 2 and the lifted horocycles satisfy the
global Delaunay condition:
(gD) For every face fˆ of D̂ there is a circle that touches all lifted horocycles
centered at the vertices of fˆ externally and does not meet any other lifted
horocycles.
If the horocycles are not small enough to bound disjoint cusp neighborhoods,
the cell decomposition D is an ideal Delaunay decomposition if condition (gD)
holds for smaller horocycles at equal distance to the original horocycles. The
distance is arbitrary as long as it is large enough for the new horocycles to bound
disjoint cusp neighborhoods.
Theorem 4.3 (existence and uniqueness). For each decorated complete finite
area hyperbolic surface with at least one cusp there exists a unique ideal Delaunay
decomposition.
The faces of the ideal Delaunay decomposition are ideal polygons. An ideal
Delaunay triangulation is obtained by adding ideal arcs to triangulate the nontriangular faces:
Definition 4.4 (ideal Delaunay triangulation). An ideal triangulation ∆ of a
decorated complete finite area hyperbolic surface is a called an ideal Delaunay
triangulation if it is a refinement of the ideal Delaunay decomposition D, that
is, if E D ⊆ E∆ . An edge e ∈ E∆ is an essential edge of the Delaunay triangulation
if e ∈ E D . The edges in E∆ \ E D are nonessential.
The decorated Teichmüller spaces Teg,n decompose into cells consisting of
all decorated surfaces with the same ideal Delaunay decomposition:
Definition 4.5 (Penner cell). For a triangulation ∆ of (S g , V ), |V | = n, let the
Penner cell C (∆) be the set of decorated surfaces in Teg,n for which ∆ is an ideal
Delaunay triangulation.
Theorem 4.6 (canonical cell decomposition of Teg,n ). The Penner cells C (∆) ⊆
Teg,n are the top-dimensional closed cells of a cell decomposition of Teg,n .
Like in the standard euclidean theory, the global Delaunay condition (gD)
is equivalent to edge-local conditions:
Theorem 4.7 (local Delaunay conditions). Let S be a complete finite area hyperbolic surface with at least one cusp, decorated with small enough horocycles so
they bound disjoint cusp neighborhoods. An ideal triangulation ∆ is a Delaunay
triangulation if and only if for every edge e, one and hence all of the equivalent
conditions (lD1)–(lD3) are satisfied. Note that the directions left and right relative
to e are only defined once an orientation is chosen for e, but the truth values of
conditions (lD1) and (lD2) are independent of this choice.
(lD1) The circle touching the three horocycles of the triangle to the left of e and the
remaining horocycle of the triangle to the right of e are disjoint or externally
tangent.
(lD2) The center of the circle touching the three horocycles of the triangle to the
left of e is to the left of, or coincides with, the center of the circle touching
the horocycles of the triangle to the right of e.
11

(lD3) The total length of the horocyclic arcs incident with e is not greater than the
total length of the horocyclic arcs opposite to e, as shown in Figure 8:
α + α0 ≤ β + β 0 + γ + γ0 .

(10)

Moreover, if ∆ is a Delaunay triangulation, then an edge e is nonessential if and
only if tangency holds in (lD1), or equivalently, if the circle centers coincide in
condition (lD2), or equivalently, if equality holds in (10).
The global Delaunay condition (gD) obviously implies (lD1), and it is not
difficult to see that (lD1) and (lD2) are equivalent. To see that (lD2) and (lD3)
are equivalent, note that the oriented length of the thick horocyclic arcs in Figure 8 is −α − α0 + β + β 0 + γ + γ0 . It remains to show that the local conditions
imply the global condition (gD); see [22, Theorem 5.1] [23, p. 128].
Theorem 4.8 (Weeks’s flip alogrithm [30]). An ideal Delaunay triangulation of
the decorated surface (∆, λ) can be found by the flip algorithm: Iteratively flip any
edge violating the local condition (10) and update λ using Ptolemy’s relation (9)
until no such edge remains.
Remarks 4.9. (i) Issues of numerical instability that plague the euclidean flip
algorithm [9, 13] are also relevant in this setting.
(ii) No other algorithm for computing ideal Delaunay triangulations seems
to be known.
(iii) Because the diameter of the flip-graph is infinite, the number of flips
necessary to arrive at a Delaunay triangulation, depending on an arbitrary initial triangulation, is unbounded. (The only exception is the sphere with three
punctures, which admits only three ideal triangulations.)
(iv) To analyze the complexity of a variational algorithm to solve the realization problem 2.1, it would be important to bound the number of steps in the
flip algorithm under the condition that the initial triangulation is a Delaunay
triangulation for a different choice of horocycles.
(v) Little seems to be known about the following related question, except
that the number is finite [1]: How many ideal Delaunay decompositions arise
for a fixed hyperbolic surface as the decoration varies over all possible choices of
horocycles? A recent result says that the lattice of Delaunay decompositions of
a fixed punctured Riemann surface is the face lattice of an associated secondary
polyhedron [17].
(vi) Recently, an analogous flip algorithm for surfaces with real projective
structure was analyzed by Tillmann and Wong [29].
Definition 4.10. Let
e λ̃)
Del : (∆, λ) 7−→ (∆,
be a function that maps the Penner coordinates (∆, λ) of a decorated surface to
e λ̃) of the same decorated surface with respect to an
the Penner coordinates (∆,
e
ideal Delaunay triangulation ∆.
Such a function Del can be computed using the flip algorithm (see Theorem 4.8). The function Del is not uniquely determined because an ideal Delaunay triangulation is in general not unique. We will use Del in situations in which
it makes no difference which ideal Delaunay triangulation is chosen.
We will repeatedly use the following fact, which is Lemma 5.2 in [22].
12

Lemma 4.11 (ideal Delaunay triangulations and triangle inequalities). Let (∆, λ)
E
be Penner coordinates and let ` ∈ R>0
be defined by (8). The local Delaunay conditions (10) imply the triangle inequalities for ` for every triangle t ∈ T∆ :
−`e1 (t) + `e2 (t) + `e3 (t) > 0
`e1 (t) − `e2 (t) + `e3 (t) > 0

(11)

`e1 (t) + `e2 (t) − `e3 (t) > 0.
The following theorem says that ideal Delaunay triangulations of a decorated hyperbolic surface are also euclidean Delaunay triangulations of the corresponding piecewise euclidean surface, and vice versa. This ought to be known,
but we do not have a reference. Delaunay triangulations and Voronoi diagrams
of piecewise euclidean surfaces were invented and reinvented many times in
the context of different applications, for example in [7, 16, 19, 28].
Theorem 4.12 (ideal and euclidean Delaunay triangulations). Let (∆, λ) be
E∆
Penner coordinates, and let ` ∈ R>0
be defined by (8).
(i) If ∆ is an ideal Delaunay triangulation of the decorated surface described
by the Penner coordinates (∆, λ), then ` satisfies the triangle inequalities (11) by
Lemma 4.11. So we may equip the surface S g with the piecewise euclidean metric
that turns each triangle t ∈ T∆ into a euclidean triangle and each edge e ∈ E∆ into
a euclidean line segment of length `e . Then ∆ is also a Delaunay triangulation of
this piecewise euclidean surface.
(ii) Conversely, if ` satisfies the triangle inequalities for every triangle t ∈ T∆ ,
and if ∆ is a Delaunay triangulation for S g equipped with the piecewise euclidean
metric described in (i), then ∆ is also an ideal Delaunay triangulation of the decorated hyperbolic surface with Penner coordinates (∆, λ).
Proof. First note that a decorated ideal tetrahedron with horosphere distances λi
as shown in Figure 3 exists if and only if the `i defined by (8) satisfy the triangle inequalities. Now consider two decorated ideal tetrahedra as shown in
Figure 3 glued along two matching vertical faces. The local Delaunay condition (lD2) for the decorated ideal triangles in the base planes is equivalent to
the local Delaunay condition for the euclidean triangles in which the horocycle
at v∞ intersects the tetrahedra. To see this, note that the circumcenters of the
euclidean triangles project vertically down to the highest points of the hyperbolic base planes, and that these points are the centers of circles touching the
incident horocycles.

5

Akiyoshi’s compactification

Every triangulation ∆ of (S g , V ) with n = |V | > 0, 2−2g −n < 0 is the Delaunay
decomposition for some decorated complete finite area hyperbolic metric on
S g,n . For example, the decorated surface (∆, λ) with Penner coordinates λ = 0
has Delaunay decomposition ∆. There are infinitely many triangulations of
(S g , V ), unless g = 0 and n ≤ 3. However, a fixed hyperbolic surface supports
only a finite number of ideal Delaunay triangulations:

13

Figure 9: An ideal polygon with a cusp (shaded region), which is a face of a Delaunay decomposition of a partially decorated surface. The left and right boundary are identified by an isometry z 7→ z + c. The vertical edges are nonessential
edges of an adjusted Delaunay triangulation.
Theorem 5.1 (Akiyoshi [1]). Let S be a complete hyperbolic surface of finite area
with at least one cusp. There are only finitely many ideal triangulations ∆ of S
such that there exists a decoration of S with horocycles such that ∆ is a Delaunay
triangulation of the decorated surface.
In fact, Akiyoshi proved a more general result, the generalization of Theorem 5.1 to hyperbolic manifolds of arbitrary dimension. A simpler proof for the
two-dimensional case can be found in [15].
Akiyoshi’s proof is based on the observation that the convex hull construction of Epstein and Penner generalizes naturally to partially decorated surfaces,
that is, complete hyperbolic surfaces of finite area, decorated with horocycles at
some, but at least one, of the cusps. A missing horocycle should be interpreted
as the limit of horocycles vanishing at infinity. The existence and uniqueness
Theorem 4.3 generalizes to partially decorated surfaces:
Theorem 5.2 (existence and uniqueness). Every partially decorated surface has
a unique ideal Delaunay decomposition.
However, Definition 4.2 of an ideal Delaunay decompositions has to be modified quite radically: an ideal Delaunay decomposition of a partially decorated
surface with missing horocycles is not an ideal cell decomposition (see Definition 5.4). A cusps with missing horocycle is contained in a Delaunay face that
is not an ideal polygon, but an ideal polygon with a cusp in the sense of the
following definition:
Definition 5.3. An ideal polygon with a cusp is a hyperbolic manifold-withboundary f of finite area whose interior is homeomorphic to an open disk with
one puncture such that a neighborhood of the puncture corresponds to a cusp
neighborhood in f and the boundary is a union of complete geodesics (see Figure 9).
However, the Delaunay decomposition of a partially decorated surface is
a cell decomposition when viewed as a decomposition of (S g , V ), the closed
surface of genus g with marked points. The faces are cells, but the marked
points v ∈ V that correspond to cusps without decorating horocycle are not
vertices of the decomposition. A face contains at most one marked point in its
14

interior, which we call the central vertex of the face (although it is not a vertex
of the decomposition). Let us call the regular vertices of an ideal polygon with
a cusp its peripheral vertices to distinguish them from its central vertex.
Definition 5.4 (Delaunay decomposition of a partially decorated surface). Let D
be a decomposition of a partially decorated surface into ideal polygons and ideal
polygons with a cusp, called the faces of the decomposition. Suppose first that
the decorating horocycles are disjoint. Then the decomposition D is called a
Delaunay decomposition, if its lift D̂ to H 2 and the lifted horocycles satisfy the
following conditions:
(gD) If fˆ is the lift of a face of D that is an ideal polygon, then there is a circle
that touches all lifted horocycles at the vertices of fˆ externally and does
not meet any other lifted horocycles.
0
(gD ) If fˆ is the lift of a face f of D that is an ideal polygon with a cusp, then
every peripheral vertex of f is decorated with a horocycle, and there
exists a horocycle centered at the lifted central vertex of fˆ that touches
the lifted horocycles at the lifted peripheral vertices of fˆ and does not
meed any other lifted horocycles.
Extend this Definition to the case of intersecting horocycles like in Definition 4.2.
Remark 5.5. Generically, the punctured Delaunay faces are punctured monogons. Such punctured monogons were already considered by Penner to construct coordinates on the Teichmüller space of partially decorated punctured
surfaces [22, Addendum] [23, Sec. 5.1].
Even if a cusp is not decorated with a horocycle, differences of distances to
horocycles at other cusps are well defined. This can be used to characterize the
punctured Delaunay faces (see Figure 9):
Proposition 5.6 (characterization of punctured Delaunay faces). Let S be a
partially decorated surface, let v be a cusp with missing horocycle, and let p be
an ideal polygon with a cusp in S whose central vertex is v. Then p is a face
of the Delaunay decomposition of S if and only if all peripheral vertices of p are
decorated with horocycles, and these horocycles have all the same distance to v,
and this distance is strictly smaller than the distance of any other horocycle to v.
Definition 4.4 of ideal Delaunay triangulations and essential and nonessential
edges remains valid without change. However, it will be useful to triangulate
the punctured Delaunay faces in a canonical way:
Definition 5.7 (adjusted Delaunay triangulation). An ideal triangulation ∆ of
a partially decorated surface is called an adjusted Delaunay triangulation if it
refines the ideal Delaunay decomposition and every punctured face is triangulated by adding the ideal arcs connecting the central vertex with the peripheral
vertices.
Theorem 4.7 on local Delaunay conditions remains valid after the following
modifications: A triangle of a Delaunay triangulation has at most one vertex
with missing horocycle. For an ideal triangle with missing horocycle at one vertex v, one has to consider the horocycle centered at v and touching the triangle’s
15

two horocycles, instead of a circle touching three horocycles. If a horocycle is
missing, the respective arc length in condition (10) is zero.
The flip algorithm (see Theorem 4.8) remains valid, but some details have
to be modified (see Proposition 5.9) because Penner coordinates (∆, λ) do not
describe partially decorated surfaces. Instead, we may use the parametrization
of a fiber of Teg,n described in Proposition 3.2, which extends nicely to partially
decorated surfaces:
Definition 5.8 (parametrizing an extended fiber of Teg,n ). Let (∆, λ) be Penner
coordinates for a decorated surface in Teg,n , let
R = R ∪ {+∞},
and

(12)

V

u ∈ R \ {+∞V },
where +∞V denotes the constant function +∞ on V . Let the partially decorated surface (∆, λ, u) be the surface obtained from the decorated surface (∆, λ)
by moving, for each vertex v, the horocycle at v a distance u(v) in the direction
of the cusp v. If u(v) = +∞, the horocycle at v is missing. In particular, for
u ∈ RV , the surface (∆, λ, u) is just the decorated surface with Penner coordinates (∆, Λ∆,λ (u)).
If (10) is the local Delaunay condition at edge e ∈ E∆ for the decorated
surface (∆, λ), then the local Delaunay condition at e for the partially decorated
surface (∆, λ, u) is
αe−u(va ) + α0 e−u(va0 ) ≤ (β + β 0 )e−u(vb ) + (γ + γ0 )e−u(vc ) ,

(13)

where e−∞ = 0.
Proposition 5.9 (flip algorithm for partially decorated surfaces). An ideal Delaunay triangulation of the partially decorated surface (∆, λ, u) can be found by
Weeks’s flip algorithm (see Theorem 4.8) with the local condition (10) replaced
by (13). An adjusted Delaunay triangulation can then be found by iteratively
flipping all nonessential edges opposite an undecorated cusp until no such edge
remains.
With Proposition 5.10 below, the correctness of this algorithm for partially
decorated surfaces can be deduced from the correctness of the original algorithm for decorated surfaces.
e is an adjusted Delaunay triangulation for the partially
Proposition 5.10. If ∆
e is also an ideal
decorated surface (∆, λ, u), then there is an M ∈ R such that ∆
∆,λ
Delaunay triangulation for the decorated surfaces (∆, Λ (ũ)) with ũ ∈ RV satisfying
ũ(v) = u(v) if

u(v) < +∞,

ũ(v) > M

u(v) = +∞.

if

This is a corollary of the characterization of punctured Delaunay faces in
terms of horocycle distances (see Proposition 5.6).
16

Definition 5.11 (generalized Penner coordinates). If ∆ is an arbitrary triangulation of a partially decorated surface, then the surface is in general not deterE
mined by ∆ and the function λ ∈ R of horocycle distances, which takes the
value +∞ if the horocycle at one or both ends is missing. However, if ∆ is
an adjusted Delaunay triangulation, then the pair (∆, λ) determines the partially decorated surface uniquely (see Proposition 5.6), and we call such a pair
generalized Penner coordinates.
Definition 5.12. Let Del also denote a function
e λ̃)
Del : (∆, λ, u) 7−→ (∆,
that maps the parameters (∆, λ, u) of a partially decorated surface to generale λ̃) of the same partially decorated surface, where
ized Penner coordinates (∆,
e
∆ is an adjusted Delaunay triangulation. Hence
Ee

λ̃ = Λ∆,τ∆,∆e (λ) (u) ∈ R ∆ ,
e

E∆
where τ∆,∆
→ R E∆e is the chart transition function mapping Penner coore :R
e
dinates with respect to ∆ to Penner coordinates with respect to ∆.

Such a function Del can be computed by the modified flip algorithm of
Proposition 5.9.
The bounds constraints in the variational principle of Theorem 7.18 involve
signed distances of horocycles in a decorated surface, which are defined as follows:
Definition 5.13 (signed distance of horocycles). Let δ∆,λ (v1 , v2 ) denote the
signed distance of the horocycles at the vertices v1 , v2 ∈ V in the decorated
surface with Penner coordinates (∆, λ). More precisely, let
δ∆,λ (v1 , v2 ) = min d(h1 , h2 )
h1 ,h2

(14)

where d denotes the signed distance of horocycles in H 2 and the minimum is
taken over all pairs of horocycles h1 6= h2 in H 2 that are lifts of the horocycles
at v1 and v2 , respectively.
Remark 5.14. The distance δ∆,λ (v1 , v2 ) is well defined and non-trivial even for
v1 = v2 , but we will not need this.
Proposition 5.6 implies that the horocycle distances δ∆,λ can be calculated
using the flip algorithm:
Proposition 5.15 (Calculating δ∆,λ ). Let (∆, λ) be Penner coordinates for a decorated surface, let v1 , v2 ∈ V , let
¨
0
if v = v2
V
u∈R ,
u(v) =
+∞ otherwise,
e λ̃, u) be the output of the modified flip algorithm (see Proposition 5.9).
and let (∆,
e and all peripheral vertices
Then v1 is the central vertex of a punctured face of ∆
are v2 . For any edge e ∈ E∆
e connecting v1 and v2
δ∆,λ (v1 , v2 ) = λ̃e .
17

6

Realizable coordinates

In this section, we characterize the Penner coordinates that may be obtained
from an ideal polyhedron by the construction described in Section 2: They are
realizable coordinates by Definition 6.1 (see Proposition 6.2). Conversely, for
given realizable coordinates, a corresponding ideal polyhedron is uniquely determined by an explicit construction (see Proposition 6.3).
Definition 6.1 (realizable coordinates). Let S be a complete finite area hyperbolic surface of genus 0 with n ≥ 3 cusps. Realizable coordinates for S with
e λ̃) consisting of a triangulation ∆
e of
distinguished vertex v∞ ∈ V are a pair (∆,
E∆
e
(S0 , V ) and an function λ̃ = R , where R = R∪{+∞}, satisfying the following
conditions (r1) and (r2):
e is an adjusted Delaunay triangulation for a decoration of S with exactly
(r1) ∆
e λ̃) are the corresponding generalone missing horocycle at v∞ , and (∆,
ized Penner coordinates (see Definition 5.11).
e ◦ be the subcomplex of ∆
e consisting of all closed cells not incident
(r2) Let ∆
with v∞ , i.e.,
V∆
e ◦ = V \ {v∞ },

(15)

E∆
e ◦ = {e ∈ E∆
e | e not incident with v∞ },

(16)

T∆
e ◦ = {t ∈ T∆
e | t not incident with v∞ }.

(17)

Then either (r2a) or (r2b) are true:
e ◦ is a linear graph, that is, a graph of the form
(r2a) T∆
e ◦ = ;, and ∆
• − • − · · · − •.
e ◦ is a triangulation of a closed disk. Moreover,
(r2b) T∆
e ◦ 6= ; and ∆
e v = 2π if v is an interior vertex of ∆
e ◦,
Θ

(18)

e◦

(19)

ev ≤ π
Θ

if v is a boundary vertex of ∆ ,

where
e v = sum of angles around v in ∆
e ◦,
Θ

(20)

measured in the piecewise euclidean metric that that turns each
triangle in T∆
e ◦ into a euclidean triangle and each edge in e ∈ E∆
e◦
into a euclidean line segment of length ˜`e , where
1

˜` = e 2 λ̃ .

(21)

Proposition 6.2 (ideal polyhedron → realizable coordinates). Let P be a threedimensional convex ideal polyhedron or a two-sided ideal polygon in H 3 realizing a
surface S ∈ T0,n , which has Penner coordinates (∆, λ) for some decoration. Let v∞
e be a triangulation obtained by adding diagonals to
be an ideal vertex of P. Let ∆
triangulate all non-triangular faces of P. The choice of diagonals is arbitrary except
for non-triangular faces incident with v∞ , in which the diagonals incident with
v∞ are be chosen. Let s∞ be a horosphere centered at v∞ . For any other vertex
18

v, let s v be the horosphere centered at v and touching s∞ . For each edge e ∈ E∆
not incident with v∞ , let λ̃e be the signed distance of the horospheres at the ends
of e. If e is incident with v∞ , let λ̃e = ∞.
e λ̃) are realizable coordinates for S.
Then (∆,
Proof. In the case of a two-sided polygon, the statement follows easily from the
characterization of punctured Delaunay faces, Proposition 5.6. It remains to
consider the case of P being a three-dimensional polyhedron.
To show (r1), first note that for an edge e not incident with v∞ , λe is also
the intrinsic signed distance of the horocycles h v = s v ∩ P at the vertices of e.
e is an adjusted Delaunay triangulation. First, the
It remains to show that ∆
union of triangles incident with v∞ is the Delaunay face around the vertex v∞
with vanished horocycle. Indeed, the horocycle h∞ touches the horocycles at
adjacent vertices and does not meet the horocycles at all other vertices.
It remains to show that the local Delaunay conditions (see Theorem 4.7)
are satisfied for all edges between two triangles that are not incident with v∞ .
We may assume without loss of generality that the horosphere s∞ was chosen
large enough so that the horospheres at the other vertices are pairwise disjoint.
Consider a face f of P that is not incident with v∞ . The point in the hyperbolic
plane of f that is closest to s∞ is the center of the circle in this plane that
touches all horospheres at the vertices of f externally. (See Figure 1: The points
closest to s∞ are the highest points in the hemispheres.) Using this fact, it is
not difficult to see that the local convexity of the edge e in P is equivalent to
the local Delaunay condition (lD2) of Theorem 4.7.
e ◦ is a trian(r2) Since we assume that P is a three-dimensional polyhedron, ∆
gulation of a closed disk. Now (r2b) follows by decomposing P into ideal tetrae ◦ . The horohedra as shown in Figure 3, one tetrahedron for each triangle in ∆
sphere s∞ intersects these tetrahedra in euclidean triangles with side lengths ˜`
determined by (21). This implies (18) and (19) because P intersects s∞ in a
convex euclidean polygon.
e λ̃) be reProposition 6.3 (realizable coordinates → ideal polyhedron). Let (∆,
◦
e
e defined
alizable coordinates of a surface S ∈ T0,n . Let ∆ be the subcomplex of ∆
in Definition 6.1 (r2).
e ◦ is a triangulation of a closed disk, one obtains a polyhedral realization
(i) If ∆
of S as follows: Construct a decorated ideal tetrahedron as shown in Figure 3 for
e ◦ . These ideal tetrahedra fit together to form a polyhedron that
each triangle of ∆
realizes S.
e ◦ is a linear graph then ∆
e is a decomposition of S into partially deco(ii) If ∆
rated ideal triangles that fit together to form a realization of S as two-sided ideal
polygon.
We omit a detailed proof. The tetrahedra in (i) exist by Lemma 4.11. They fit
together to form an ideal polyhedron realizing S by (r2b). That the polyhedron
e is a Delaunay
is convex follows from inequality (19) and from the fact that ∆
triangulation.
e λ̃) with distinguished vertex v∞ that are
The realizable coordinates (∆,
obtained from a polyhedron or two-sided polygon by Proposition 6.2 are not
uniquely determined:
19

• Non-triangular faces that are not incident with v∞ may be triangulated in
different ways.
e λ̃ +
• A different choice of horosphere s∞ leads to realizable coordinates (∆,
h1 E∆e ) for some h ∈ R.
e λ̃) and (∆
e 0 , λ̃0 ) are both
But these are the only sources of ambiguity: If (∆,
realizable coordinates obtained from the same polyhedron or two-sided polygon
with the same distinguished vertex v∞ by Proposition 6.2, then
e and ∆
e 0 are both adjusted Delaunay triangulations of the same ideal
(u1) ∆
Delaunay decomposition,
(u2) λ̃0 = τ∆,
) for some h ∈ R.
e ∆
e 0 (λ̃ + h1 E∆
e
e λ̃)
Conversely, the polyhedra obtained from different realizable coordinates (∆,
0
0
e , λ̃ ) with the same distinguished vertex v∞ are congruent (as polyhedra
and (∆
marked by (S0 , V )) if and only if conditions (u1) and (u2) are satisfied.
e λ̃)
Definition 6.4 (equivalent realizable coordinates). Realizable coordinates (∆,
0
0
e
and (∆ , λ̃ ) with distinguished vertex v∞ are equivalent if they satisfy conditions (u1) and (u2).
Realizable coordinates are equivalent if and only if they correspond to congruent realizations.

7

The variational principle

In this section we present a variational principle (see Theorem 7.18) for Problem 2.3 of finding realizable coordinates. The variational principle involves the
v∞
function E¯∆,λ
(u) (see Definition 7.16). The variables u ∈ RV \{v∞ } parametrize
a part of the extended fiber of Teg,n over the surface (∆, λ). More precisely, they
parametrize the horocycle decorations of that surface with missing horocycle
at v∞ . The variables are subject to bounds constraints, which ensure that the
horocycles do not intersect an arbitrary but fixed horocycle at v∞ . The definiv∞
tion of E¯∆,λ
(u) requires some preparation. After the following brief summary, a
detailed account begins with Definition 7.1.
The function f (x 1 , x 2 , x 3 ) (see Definition 7.1) provides a variational encoding of euclidean trigonometry: If the variables x i are the logarithmic side
lengths of a euclidean triangle, then the partial derivatives of f are its angles
(see Proposition 7.2).
Using this building block, the function λ 7→ HΘ (∆, λ) (see Definition 7.3)
is defined on an open subset A∆ of the decorated Teichmüller space Teg,n . The
function EΘ,∆,λ (u) (see Definition 7.5) is the restriction of HΘ (∆, · ) to the intersection of A∆ with the fiber of Teg,n over the surface (∆, λ). This function was
already used in a previous article (see Remark 7.6).
Next we extend the function HΘ (∆, λ) to the whole decorated Teichmüller
space and the function EΘ,∆,λ (u) to a whole fiber by adapting the triangulation
appropriately. To this end, consider the restriction of HΘ (∆, · ) to the closed Penner cell of all λ ∈ R E∆ for which ∆ is a Delaunay triangulation of the decorated
surface (∆, λ). For different triangulations ∆, these restrictions of HΘ (∆, · )
fit together to define a C 2 function HΘ on the whole decorated Teichmüller
20

x2
3

2

1

A
-3

-2

1

-1

2

3

x1

-1

-2

-3

Figure 10: Intersection of the domain A with the plane x 3 = 0. The domain A
is invariant with respect to translations in the scaling direction (1, 1, 1).
space Teg,n (see Corollary 7.10). We denote by HΘ,∆ (λ) the representation of
HΘ in the global Penner coordinate system belonging to the ideal triangulation ∆ (see Definition and Proposition 7.9). The convex function EΘ,∆,λ (u) (see
Definition 7.11) is the restriction of HΘ,∆ (λ) to the fiber of Teg,n over (∆, λ).
v∞
Finally, E¯∆,λ
(u) is obtained by setting Θ v∞ = 0 and Θ v = 2π for v 6= v∞ , and
taking the limit u v∞ → +∞ (see Definition 7.16).
Definition 7.1 (the triangle function f ). Let f be the function
f : R3 ⊇ A −→ R,
f (x 1 , x 2 , x 3 ) = α1 x 1 + α2 x 2 + α3 x 3 + L(α1 ) + L(α2 ) + L(α3 ),
where
 
 x1
A =  x 2  ∈ R3
 x
3

(22)


 e x 1 > e x 2 + e x 3 ,


 x2
 e > e x3 + e x1 ,
 x

 e 3 > e x1 + e x2

(see Figure 10), L is Milnor’s Lobachevsky function [20],
Zα


L(α) = −
log 2 sin(t) d t

(23)

0

(see Figure 11), and α j are the angles in a triangle with sides e x j as shown in
Figure 12.
Proposition 7.2 (properties of f ). (i) The function f is analytic, and it satisfies
the scaling relation
f (x 1 + h, x 2 + h, x 3 + h) = πh.

(24)

(ii) The partial derivatives of f are
∂f
= αi .
∂ xi
21

(25)

y
y = L(α)
e

α

x2

α1

Figure 11: Milnor’s Lobachevsky function L is
π-periodic, odd, and analytic except at α ∈ π Z,
where the derivative tends to +∞.

α3

e x1
α2

e

x3

Figure 12: Triangle with
sides e x 1 , e x 2 , e x 3

(iii) The second derivative of f is
D2 f | x = cot α1 (d x 2 − d x 3 )2 + cot α2 (d x 3 − d x 1 )2 + cot α3 (d x 1 − d x 2 )2 (26)
(iv) The second derivative D2 f | x is positive semidefinite with one-dimensional
kernel spanned by (1, 1, 1). In particular, f is locally convex.
See [5, Sec. 4.2] for proofs.
Definition 7.3 (the function HΘ ). For a triangulation ∆ of (S g , V ) and Θ ∈ RV ,
let

HΘ (∆, · ) : A∆ −→ R,
X
X
 λe (t) λe (t) λe (t) 
1
3
HΘ (∆, λ) =
2f
, 2 ,
−π
λe
2
2
2
t∈T∆
e∈E∆
X
Θ v log c v (∆, λ),
−

(27)

v∈V

where A∆ ⊆ R E∆ is the subset



	
A∆ = λ ∈ R E∆  21 λe1 (t) , λe2 (t) , λe3 (t) ∈ A for all t ∈ T∆ ,

(28)

and c v is defined by (5).
Proposition 7.4 (properties of HΘ ). (i) The function HΘ (∆, · ) is analytic and
satisfies the scaling relation

1 X 
HΘ (∆, λ + h 1 E∆ ) = HΘ (∆, λ) + h π |T∆ | − |E∆ | +
Θv .
2π v∈V

(29)

(ii) For Θ = 0, the function H0 (∆, · ) is convex, and the kernel of the positive
semi-definite second derivative is one-dimensional and spanned by 1 E∆ .
This follows immediately from the corresponding properties of f and the
scaling behavior of c v :
c v (∆, λ + h 1 E∆ ) = c v (∆, λ) − 21 h.
22

(30)

Definition 7.5 (the function EΘ,∆,λ ). Let EΘ,∆,λ be the restriction of HΘ to the
fiber of Teg,n over (∆, λ) parametrized by Λ∆,λ as defined by (2), that is,

EΘ,∆,λ : {u ∈ RV | Λ∆,λ (u) ∈ A∆ } −→ R
EΘ,∆,λ (u) = H(∆, Λ∆,λ (u)).

(31)

Remark 7.6. The function EΘ,∆,λ (u) is up to an additive constant equal to the
function ET,Θ,λ (u) (with T = ∆) defined in the previous article [5, eq. (4-6)]. In
that article, the domain of ET,Θ,λ (u) is extended to the whole RV by exploiting
the fact that the function f can be extended to a convex function on the whole
R3 . Here, we do not need this extension. Instead, we will extend the functions
HΘ (∆, · ) and hence also EΘ,∆,λ (u) by changing the triangulation (see Definition
and Proposition 7.9 and Definition 7.11).
Proposition 7.7 (properties of EΘ,∆,λ ). (i) The function EΘ,∆,λ is analytic and
satisfies the scaling relation

1 X 
EΘ,∆,λ (u + h 1V ) = EΘ,∆,λ (u) + h 2π |T∆ | − |E∆ | +
Θv .
2π v∈V

(32)

(ii) For a vertex v ∈ V , the partial derivative of E∆,λ (u) with respect to u v is
∂
ev,
EΘ,∆,λ (u) = Θ v − Θ
∂ uv

(33)

e v is the angle sum around vertex v measured in the piecewise euclidean
where Θ
metric that turns every triangle in T∆ into a euclidean triangle and every edge
e ∈ E∆ into a straight line segment of length ˜`e , where ˜` is defined by (21) with
λ̃ = Λ∆,λ (u).
(iii) The second derivative of EΘ,∆,λ at u is
X ∂ 2 EΘ,∆,λ

2
1 X
(cot αe (u) + cot α0e (u)) du v1 (e) − du v2 (e) ,
∂ uv ∂ uv0
4 e∈E
v,v 0 ∈V
∆
(34)
where αe (u) and α0e (u) are the angles opposite edge e in the piecewise euclidean
metric described in (ii).
(iv) The function EΘ,∆,λ is locally convex. The second derivative is positive
semidefinite with one-dimensional kernel spanned by 1V .
du v du v 0 =

Remark 7.8. The second derivative of EΘ,∆,λ is the Dirichlet energy of the piecewise linear function taking the value u v at vertex v [8, eq. (8)] [24]. A satisfactory explanation for this coincidence seems to be unknown.
Proof of Proposition 7.7. (i) and (iv) follow from the corresponding properties
of H∆ (see Proposition 7.4), the scaling behavior of Λ∆,λ ,
Λ∆,λ (u + h 1V ) = Λ∆,λ (u) + 2h · 1 E∆ ,

23

(35)

and the equation
log c v (∆, Λ∆,λ (u)) = log c v (∆, λ) − u v .

(36)

(ii) follows from (25) and (36) by a direct calculation. Note that if (i, j, k)
is a permutation of (1, 2, 3) and
xi =

λi + u j + uk
2

then, with the notation of Figure 5,
∂
2 f (x 1 , x 2 , x 3 ) = α j + αk = π − αi .
∂ ui

(37)

(iii) follows from equations (26), (27), and (36) by a direct calculation (see
also [5, Prop. 4.1.6]).
The functions H(∆, · ), restricted to the respective Penner cells of ∆, fit together to form a single C 2 function on the decorated Teichmüller space:
Definition and Proposition 7.9 (the function HΘ,∆ ). For a triangulation ∆ of
(S g , V ), let HΘ,∆ be the function
HΘ,∆ : R E∆ −→ R,
HΘ,∆ (λ) = HΘ (Del(∆, λ)) .

(38)

(Del(∆, λ) is defined in Definition 4.10.) The function HΘ,∆ is well defined, twice
continuously differentiable, analytic in each open Penner cell of Teg,n , and satisfies
the scaling relations

1 X 
HΘ,∆ (λ + h 1 E∆ ) = HΘ,∆ (λ) + h π |T∆ | − |E∆ | +
Θv .
(39)
2π v∈V
Corollary 7.10. There is a C 2 function HΘ : Teg,n → R on the decorated Teichmüller space, which is analytic on each open Penner cell, such that for each ideal
triangulation ∆, the function HΘ,∆ is the representation of HΘ in the global Penner coordinate chart belonging to ∆. The function HΘ is invariant under the action
of the mapping class group.
Proof of Proposition 7.9. The right hand side of equation (38) is well-defined
e λ̃) = Del(∆, λ) implies λ̃ ∈ A e by Lemma 4.11.
for all λ ∈ R E∆ because (∆,
∆
The function HΘ,∆ is analytic on open Penner cells because the functions
e · ) are analytic for all triangulations ∆,
e and so are the chart transition
H(∆,
functions τ∆,∆
e : λ 7→ λ̃ for Penner coordinates with respect to different triane
gulations ∆ and ∆.
If the Delaunay triangulation for (∆, λ) is not unique, then the value of
the right hand side of (38) and its first two derivatives are independent of the
choice of Delaunay triangulation. This follows from Lemma 8.1, which we defer
to Section 8. It also implies that HΘ,∆ is twice continuously differentiable.
The scaling relation (39) follows from the scaling relation for HΘ (see Proposition 7.4).
24

Definition 7.11. Let EΘ,∆,λ be the restriction of HΘ,∆ to the fiber of Teg,n over (∆, λ)
parametrized by Λ∆,λ , that is,
EΘ,∆,λ : RV −→ R,
EΘ,∆,λ (u) = HΘ,∆ (Λ∆,λ (u)).

(40)

Proposition 7.12 (properties of EΘ,∆,λ ). (i) The function EΘ,∆,λ is twice continuously differentiable, analytic in the interior of each Penner cell, and satisfies the
scaling relations

1 X 
Θv .
(41)
EΘ,∆,λ (u + h 1V ) = EΘ,∆,λ (u) + h 2π |T∆ | − |E∆ | +
2π v∈V
(ii) The partial derivatives are
∂
ev,
EΘ,∆,λ (u) = Θ v − Θ
∂ uv

(42)

e v is the total angle at v when S g is equipped with the piecewise euclidean
where Θ
metric that turns every triangle in T∆
e into a euclidean triangle and every edge
˜
˜
e ∈ E∆
e into a straight line segment of length `e , where ` is defined by (21) and
e λ̃) = Del(∆, Λ∆,λ (u)).
(∆,

(43)

(iii) The second derivative of EΘ,∆,λ at u satisfies



D2 EΘ,∆,λ u = D2 EΘ,∆,
e λ̃ u ,

(44)

e λ̃) defined by (43).
with (∆,
(iv) The function EΘ,∆,λ is convex. The second derivative is positive semidefinite
with one-dimensional kernel spanned by 1V .
Remark 7.13. By equation (44), one can calculate the second derivative D2 EΘ,∆,λ |u
e λ̃) and then
by applying the flip algorithm (see Theorem 4.8) to determine (∆,
equation (34) for the second derivative of EΘ,∆,
e λ̃ .
Proof. The claims follow from the corresponding properties of HΘ,∆ and EΘ,∆,λ .
Note that the scaling action of u ∈ RV on R E∆ commutes with the chart transition functions τ∆,∆
e:
∆,λ
τ∆,∆
(u)) = Λ∆,τ∆,∆e (λ) (u).
e (Λ
e

(45)

So with
e
e (λ)
∆,∆
e λ̃) = Del(∆, Λ∆,λ (u)) = (∆,
e τ e Λ∆,λ (u)) = (∆,
e Λ∆,τ
(∆,
(u))
∆,∆

one obtains
e
e (λ)
∆,∆
e Λ∆,τ
(u))
EΘ,∆,λ (u) = H (Λ∆,λ (u)) = HΘ (Del(∆, Λ∆,λ (u))) = HΘ (∆,

= EΘ,∆,τ
e

e (λ)
∆,∆

(u).

(46)

Statements (ii) and (iii) follow with (46) from the corresponding properties
of EΘ,∆,λ (see Proposition 7.7).
25

To formulate the variational principle of Theorem 7.18 and for the variational existence proofs (see Sections 9 and 11) we need to consider limits of
EΘ,∆,λ (u) as some variables u v tend to infinity. It is enough to consider E0,∆,λ ,
that is, the case Θ = 0, because by equation (36),
X

Θ v log c v (∆, λ) − u v .
(47)
EΘ,∆,λ (u) = E0,∆,λ (u) −
v∈V
V

Lemma 7.14 (limits of E0,∆,λ ). Let ū ∈ R , with R defined by (12), and assume
ū v < +∞ for at least one vertex v ∈ V . Then
lim E0,∆,λ (u) =

u→ū

X

2f

t∈T∆
e◦

 λ̃e

1 (t)

2

,

X
λ̃e2 (t) λ̃e3 (t) 
λ̃e ,
,
−π
2
2
e∈E

(48)

e◦
∆

where
e λ̃) = Del(∆, λ, u),
(∆,
e ◦ is the subcomplex of the adjusted Delaunay triangulation ∆
e consisting of
and ∆
all closed cells that are not incident with an undecorated vertex, that is,
V∆
e ◦ = {v ∈ V | u v < +∞},

E∆
e ◦ = {e ∈ E∆
e | vertices of e are contained in V∆
e ◦ },
T∆
e ◦ = {t ∈ T∆
e | vertices of t are contained in V∆
e ◦ }.

Corollary 7.15. If Θ ≥ 0 and Θ v > 0 for at least one v ∈ V with ū v = +∞, then
lim EΘ,∆,λ (u) = +∞.

u→ū

Proof of Lemma 7.14. By Akiyoshi’s Theorem 5.1, only finitely many ideal Delaunay decompositions arise from different decorations of the surface (∆, λ).
It is therefore enough to consider the limit of E0,∆,λ (u) as u tends to ū in the
subset


	
¯ is an ideal Delaunay triangulation for ∆, Λ∆,λ (u) ⊆ RV (49)
u ∈ RV  ∆
¯ Then ∆
¯ is also a Delaunay triangulation
for some fixed ideal triangulation ∆.
of the partially decorated surface (∆, λ, ū), because the local Delaunay conditions (13) are non-strict inequalities, both sides of which extend continuously
V
¯ and the adjusted Delaunay triangulation ∆
e are ideal
to R . In particular, ∆
Delaunay triangulations of the same ideal Delaunay decomposition. For u in
the subset (49),
¯ λ̄(u))
E0,∆,λ (u) = H0 (∆,
X
X
 λ̄e (t) (u) λ̄e (t) (u) λ̄e (t) (u) 
1
3
, 2
,
−π
=
2f
λ̄e (u) (50)
2
2
2
t∈T
e∈E
¯
∆

where

¯
∆

λ̄(u) = τ∆,∆¯ ◦ Λ∆,λ (u).

In particular, for each triangle t ∈ T∆¯ and all u in the subset (49),

1
2 λ̄e1 (t) (u), λ̄e2 (t) (u), λ̄e3 (t) (u)
is contained in A (see Definition 7.1). There are three possibilities:
26

(51)

Figure 13: Ideal triangle contained in punctured Delaunay face, but not incident
with the central vertex
(i) Triangle t is not contained in a punctured Delaunay cell of (∆, λ, ū). Then (51)
converges to a point in A .
(ii) Triangle t is contained in a punctured Delaunay cell of (∆, λ, ū) and t is
incident with the undecorated central vertex. Then (51) goes to infinity
in A . If ei (t) is the edge opposite the central vertex, and e j (t), ek (t) are
the edges incident with the central vertex, then λ̄ei (t) (u) has a finite limit
while λ̄e j (t) (u) and λ̄ek (t) (u) tend to +∞.
(iii) Triangle t is contained in a punctured Delaunay cell of (∆, λ, ū) and t is
not incident with the undecorated central vertex. Then (51) converges to
a boundary point (x̄ 1 , x̄ 2 , x̄ 3 ) ∈ ∂A , that is, for some permutation (i, j, k)
of (1, 2, 3),
e x̄ i = e x̄ j + e x̄ k
(see Figures 4 and 13).
Now equation (48) for the limit follows from equation (50) and the following limits of the function f .
(a) As (x 1 , x 2 , x 3 ) −→ (x̄ 1 , +∞, +∞) in A ,
f (x 1 , x 2 , x 3 ) −

π
(x 2 + x 3 ) −→ 0.
2

(52)

To see this, note that


(α1 , α2 , α3 ) −→ 0, π2 + δ, π2 − δ
for some δ ∈ [0, π2 ]. So
α1 x 1 −→ 0

and

L(α1 ) + L(α2 ) + L(α3 ) −→ 0

because L(0) = 0 and L( π2 + δ) + L( π2 − δ) = 0. Now (52) follows from
α2 x 2 + α3 x 3 − π2 (x 2 + x 3 ) −→ 0.
To see this, note that
α2 x 2 + α3 x 3 − π2 (x 2 + x 3 ) = − 12 α1 (x 2 + x 3 ) + 12 (α2 − α3 )(x 2 − x 3 ).
The triangle inequalities imply (x 2 − x 3 ) → 0, and using the sine rule one
obtains − 12 α1 (x 2 + x 3 ) → 0 from limα→0 α log sin α = 0.

27

(b) As (x 1 , x 2 , x 3 ) −→ (x̄ 1 , x̄ 2 , x̄ 3 ) ∈ ∂A , where e x̄ 1 = e x̄ 2 + e x̄ 3 ,
f (x 1 , x 2 , x 3 ) −→ πx̄ 1 .
This follows from (α1 , α2 , α3 ) −→ (π, 0, 0).
The variational principle (see Theorem 7.18) involves the function EΘ,∆,λ
with Θ v∞ = 0, Θ v = 2π for all other vertices, and u v∞ → +∞. We denote this
v∞
function by E¯∆,λ
(see Definition 7.16) and collect its relevant properties (see
Proposition 7.17).
v∞
Definition 7.16 (E¯∆,λ
). For a triangulation ∆ of (S g , V ), a vertex v∞ ∈ V , and

λ ∈ R E∆ , let

V ◦ = V \ {v∞ },

(53)

let Θ ∈ RV be defined by
¨
Θv =

if v = v∞

0

(54)

2π if v ∈ V ◦ ,

and define
◦

v∞
E¯∆,λ
: RV −→ R
v∞
E¯∆,λ
(u) = lim EΘ,∆,λ (u|uv
x→+∞

∞

=x ),

(55)

◦

where for u ∈ RV , we write u|uv =x for the function in RV with value x at v∞
∞
and agreeing with u on V ◦ .
v∞
Proposition 7.17 (properties of E¯∆,λ
). (i) The limit in equation (55) exists and
is equal to

v∞
E¯∆,λ
(u) =

X
t∈T∆
e◦

2f

 λ̃e

1 (t)

2

,

X
λ̃e2 (t) λ̃e3 (t) 
,
−π
λ̃e
2
2
e∈E∆
e◦
X
− 2π
(log c v (∆, λ) − u v ), (56)
v∈V ◦

where
e λ̃) = Del(∆, λ, u|u
(∆,
v

∞

=+∞ )

(57)

(see Definition 5.12), and E∆
e ◦ and T∆
e ◦ are defined by (16) and (17).
v∞
(ii) The function E¯∆,λ
is twice continuously differentiable and analytic in the
interior of each Penner cell.
(iii) The partial derivatives are
∂
v
e v + π(deg2 (v) − deg1 (v) + 2),
E¯ ∞ (u) = −Θ
∂ u v ∆,λ
e is defined as in Definition 6.1, equation (20), and
where Θ
deg1 (v) = edge-degree of v,
28

(58)

that is, the number of edges emanating from v counted with multiplicity, and
deg2 (v) = triangle-degree of v,
that is, the number of triangles around v counted with multiplicity.
(iv) The second derivative is

2
1 X
v∞ 
w e (u) du v1 (e) − du v2 (e) ,
D2 E¯∆,λ
=
u
4 e∈E

(59)

e◦
∆

e ◦,
where, if edge e is not a boundary edge of ∆
w e (u) = cot αe (u) + cot α0e (u)
and αe (u), α0e (u) are the angles opposite e in the piecewise euclidean metric defined
in Definition 6.1 (r2b). If e is a boundary edge, then e has one or zero opposite
angles and w e (u) = cot αe (u) or w e (u) = 0, respectively.
v∞
(v) The function E¯∆,λ
is convex and satisfies the scaling relation
v∞
v∞
E¯∆,λ
(u + h 1V ◦ ) = E¯∆,λ
(u) + 2π h.

(60)

Proof. Statement (i) follows from Lemma 7.14. By direct calculations, one obtains equations (58) and (59) in the interior of Penner cells. As for HΘ,∆ , one
finds that the first and second derivatives are continuous at the boundaries of
Penner cells. This implies the differentiability statement (ii).
Statement (iii) follows from the corresponding properties of EΘ,∆,λ (see
Proposition 7.12), because convexity and the scaling relation survive taking the
limit (55). Note that
X
Θ v = 2π(|V | − 1)
v∈V

due to (54), and hence
|T∆
e | − |E∆
e|+

1 X
Θ v = |T∆
e | − |E∆
e | + |V | − 1 = 1,
2π v∈V

e is a triangulation of a sphere. Alternatively, one can also deduce
because ∆
statement (v) directly from equation (56).
Theorem 7.18 (variational principle for Problem 2.3). Let S ∈ T0,n be a complete
finite area hyperbolic surface of genus 0 with n ≥ 3 cusps, and let (∆, λ) be Penner
coordinates for S, decorated with arbitrary horocycles. Let V ◦ = V \{v∞ } for some
distinguished vertex v∞ ∈ V .
v∞
(i) If the function E¯∆,λ
attains its minimum under the constraints
u v ≥ δ∆,λ (v, v∞ ).

(61)

e λ̃) defined by (57) are realizable coordinates
at the point u ∈ V ◦ , then (∆,
with distinguished vertex v∞ .
(ii) Up to equivalence (see Definition 6.4), all realizable coordinates with distinv∞
guished vertex v∞ correspond to constrained minima of E¯∆,λ
as in (i).
29

Proof. We will show (i) and omit the proof of the converse statement (ii) bev∞
cause it is easier and no new ideas are required. So assume E¯∆,λ
attains a min◦

imum under the constraints (61) at u ∈ RV . We have to show conditions (r1)
and (r2) of Definition 6.1. Since condition (r1) obviously holds by construction,
it remains to show (r2).
v∞
First, note that the convex function E¯∆,λ
attains a minimum under the con◦

straints (61) at u ∈ RV if and only if for all v ∈ V ◦ :
∂
v
E¯ ∞ (u) = 0
∂ u v ∆,λ
∂
v
E¯ ∞ (u) ≥ 0
∂ u v ∆,λ

if u v > δ∆,λ (v, v∞ )

(62)

if u v = δ∆,λ (v, v∞ )

(63)

The scaling relation (60) implies that if a constrained minimum is attained at u
then u satisfies at least one constraint (61) with equality. The vertices v ∈ V ◦
for which the constraint (61) is satisfied with equality are precisely the vertices
e (see Proposition 5.6). Now let v ∈ V be a vertex adjacent
adjacent to v∞ in ∆
to v∞ . By equation (58) and inequality (63), we have
e v + π(deg2 (v) − deg1 (v) + 2) ≥ 0.
−Θ

(64)

Consider two cases separately:
e v = 0 because there are no triangles t ∈ T e ◦
(a) deg2 (v) = 0: In this case Θ
∆
incident with v. Inequality (64) implies
deg1 (v) ≤ 2.
Using the following two observations, one deduces that the cell complex
e ◦ = (V ◦ , E e ◦ , T e ◦ ) is a linear graph:
∆
∆
∆
(1) Any vertex v 0 6= v∞ adjacent to v also satisfies deg2 (v) = 0.
e ◦ is connected because its complement in the sphere S0
(2) The cell complex ∆
is an open disk.
This proves condition (r2a) of Definition 6.1.
e v > 0, so inequality (64) implies
(b) deg2 (v) > 0: In this case Θ
deg1 (v) < deg2 (v) + 2.
On the other hand, because T∆
e ◦ does not contain all triangles of T∆
e incident
with v, we have
deg1 (v) ≥ deg2 (v) + 1,
and therefore
deg1 (v) = deg2 (v) + 1.

(65)

e ◦ in the sphere S0 is an open disk, this implies
Because the complement of ∆
e ◦ is a triangulation of a closed disk. With (65),
that the cell complex ∆
inequality (64) implies (19), and (62) implies (18). This proves condition
(r2b).
This concludes the proof of (i).

30

8

The differentiability lemma

In this section we treat Lemma 8.1, which proves the well-definedness and differentiability statement of Definition and Proposition 7.9.
Lemma 8.1. Suppose ∆1 and ∆2 are both Delaunay triangulations for the decorated surface with Penner coordinates (∆, λ∗ ), and let τ12 = τ∆1 ,∆2 be the chart
transition function R E∆1 → R E∆2 mapping Penner coordinates with respect to ∆1
to Penner coordinates with respect to ∆2 . Then the function values and the first
and second derivatives of HΘ (∆1 , · ) and HΘ (∆2 , τ12 ( · )) at λ∗ are equal:

HΘ (∆1 , λ∗ ) = HΘ ∆2 , τ12 (λ∗ ) ,
(66)


(67)
d HΘ (∆1 , · )λ∗ = d HΘ (∆2 , τ12 ( · )) λ∗ ,


2
2
(68)
D HΘ (∆1 , · )λ∗ = D HΘ (∆2 , τ12 ( · )) λ∗ .
Remarks 8.2. (i) It is easy to check numerically that the analogous equations
for higher derivatives are in general false. In particular,


D3 HΘ (∆1 , · )λ∗ 6= D3 HΘ (∆2 , τ12 ( · )) λ∗ ,
so the third derivative of the function HΘ on Teg,n is generally discontinuous at
the boundaries of Penner cells.
(ii) The proof of equation (68) given in this section consists of a straightforward but unilluminating calculation. A more conceptual argument would be
desirable.
(iii) In the variational principles of Theorems 7.18 and 11.4, only the function EΘ,∆,λ (u) plays a role, which is the restriction of HΘ,∆ (λ) to one fiber of
the decorated Teichmüller space Teg,n . In the context of realization and discrete
uniformization theorems, it would be enough to show that EΘ,∆,λ (u) is twice
continuously differentiable. In view of Theorem 4.12 and Remark 7.8, this follows from Rippa’s Minimal Roughness Theorem [25] for the PL Dirichlet energy.
(This is also proved by an unilluminating calculation.) Lemma 8.1 shows that
the function HΘ,∆ and hence the function HΘ of Corollary 7.10 is twice continuously differentiable on the whole decorated Teichmüller space. We believe
this is of independent interest.
The rest of this section is devoted to the proof of Lemma 8.1.
1. Reduction to Θ = 0. Since the total length of the decorating horocycle at
a vertex v does not depend on the triangulation, we have
c v (∆1 , λ) = c v (∆2 , τ12 (λ))
and hence trivially also


d c v (∆1 , · )λ = d c v (∆2 , τ12 ( · ))λ ,


D2 c (∆ , · ) = D2 c (∆ , τ ( · ))
v

1

v

λ

2

12

λ

(69)
(70)

for all ideal triangulations ∆1 , ∆2 and all λ ∈ R E∆1 . To prove Lemma 8.1, it is
therefore enough to consider the function H0 with Θ = 0.
31

`c
α

δ

β
`e

`d
γ

α
`b

`f

β
`a

δ

γ

Figure 14: Lengths and angles in a euclidean cyclic quadrilateral.
2. Reduction to a single edge flip. Without loss of generality, we may assume
that ∆1 and ∆2 differ by a single edge flip. Indeed, any two Delaunay triangulations for the same decorated surface are related by a finite sequence of flips
of nonessential edges, and equations (66)–(68) have the necessary transitivity
property. To be more specific, assume ∆1 , ∆2 , ∆3 are three ideal triangulations. To abbreviate, we write Hi for HΘ (∆i , · ) and τi j for τ∆i ,∆ j . Then, by a
straightforward application of the chain rules for first and second derivatives,
the equations

H2 (τ12 (λ∗ )) = H3 ◦ τ23 (τ12 (λ∗ )),


d H2 τ (λ∗ ) = d(H3 ◦ τ23 )τ (λ∗ ) ,
12
 12
D2 H2 τ (λ∗ ) = D2 (H3 ◦ τ23 )τ (λ∗ )

H1 (λ∗ ) = H2 ◦ τ12 (λ∗ ),


d H1 λ∗ = d(H2 ◦ τ12 )λ∗ ,
and


2
2


D H1 λ∗ = D (H2 ◦ τ12 ) λ∗ ,

12

12

imply

H1 (λ∗ ) = H3 ◦ τ13 (λ∗ ),


d H1 λ∗ = d(H3 ◦ τ13 )λ∗ ,


D2 H1 λ∗ = D2 (H3 ◦ τ13 )λ∗ .
3. Notation. In the following we assume that ∆2 is the result of flipping
edge e of ∆1 , which is replaced by edge f in ∆2 . Let a, b, c, d ∈ E∆1 ∩ E∆2
be the adjacent edges of e and f as in Figure 7, and let ` be defined by (8).
By Lemma 4.11 and Theorem 4.12, the euclidean triangles with side lengths
`a , ` b , `e and `e , `c , `d form a cyclic quadrilateral as shown in Figure 14. By
Ptolemy’s theorem of euclidean geometry, ` f is the length of the other diagonal.
4. Equality of function values. To show equation (66), we use the notation
of Figure 14 for the angles. Writing
Vtet (α1 , α2 , α3 ) = L(α1 ) + L(α2 ) + L(α3 ),

(71)

we obtain from equation (27)

H0 (∆1 , λ∗ ) − H0 ∆2 , τ12 (λ∗ ) =
2Vtet (α, β, γ + δ) + 2Vtet (γ, δ, α + β) + (α + β + γ + δ − π)λ∗e
− 2Vtet (β, γ, α + δ) − 2Vtet (δ, α, β + γ) − (α + β + γ + δ − π)λ∗f ,
32

which is zero because
α+β +γ+δ =π

(72)

and because equation (71) is Milnor’s formula [20] for the volume Vtet of an
ideal tetrahedron with dihedral angles α1 , α2 , α3 as shown in Figure 3. So
Vtet (α, β, γ + δ) + Vtet (γ, δ, α + β) and

Vtet (β, γ, α + δ) + Vtet (δ, α, β + γ)

are two ways of writing the volume of an ideal quadrilateral pyramid as the
sum of the volumes of two tetrahedra.
5. Equality of first derivatives. To show equation (67), note that the chart
transition function τ12 changes λ∗e to λ∗f as determined by Ptolemy’s relation (9)
and leaves the values of λ∗ for all other edges unchanged. Now consider the
partial derivatives of both sides of equation (66) at λ∗ . From (25) and (27) one
obtains by a straightforward calculation

∂ H0 (∆1 , · ) 
(73)
 ∗ = α + β + γ + δ − π = 0,
λ
∂ λe
and similarly

∂ H0 (∆2 , · ) 
= δ + α + β + γ − π = 0,

τ12 (λ∗ )
∂ λf

(74)


∂ H0 (∆2 , τ12 ( · )) 
 ∗ = 0,
λ
∂ λe

(75)

which implies

and hence equality of the partial derivatives with respect to λe . For the partial
derivative with respect to λa one obtains


∂ H0 (∆2 , τ12 ( · )) 
∂ H0 (∆1 , · ) 
(76)
 ∗ =α=
 ∗
λ
λ
∂ λa
∂ λa
and similarly for λ b , λc , λd . For all other edges " ∈ E∆1 ∩ E∆2 , the difference of
partial derivatives is zero because all terms depending on λ" in the difference
H0 (∆1 , λ) − H0 (∆2 , τ12 (λ)) cancel. This proves (67).
5. Some useful identities.
use the identities

In the calculation proving equation (68), we will

sin β sin δ
(−dλa + dλ b − dλc + dλd ),
sin α sin γ + sin β sin δ
sin α sin γ
dλ b + dλd − dλe − dλ f =
(−dλa + dλ b − dλc + dλd ),
sin α sin γ + sin β sin δ
(77)

−dλa − dλc + dλe + dλ f =

which are valid at λ∗ , as well as the simple trigonometric identities
cot x ± cot y =
33

sin(±x + y)
.
sin x sin y

(78)

To see (77), take derivatives on both sides of of Ptolemy’s relation
1

1

1

e 2 (λe +λ f ) = e 2 (λa +λc ) + e 2 (λ b +λd )
to obtain
1

1

dλe + dλ f =
=

e 2 (λa +λc )
1

1

e 2 (λa +λc ) + e 2 (λ b +λd )
1
1

1 + e 2 (−λa +λ b −λc +λd )

e 2 (λ b +λd )

(dλa + dλc ) +

(dλ b + dλd )
1
1
e 2 (λa +λc ) + e 2 (λ b +λd )
1
(dλa + dλc ) +
(dλ b + dλd ),
1
(λ
−λ
1 + e 2 a b +λc −λd )

then by the law of sines
dλe + dλ f =

sin α sin γ
(dλa + dλc )
sin α sin γ + sin β sin δ
sin β sin δ
(dλ b + dλd ). (79)
+
sin α sin γ + sin β sin δ

and finally the identities (77).
6. Equality of second derivatives. To show equation (68), first consider the
right hand side. The chain rule for second derivatives says


D2 H0 (∆2 , τ12 ( · )) λ∗ (v, w) = D2 H0 (∆2 , · )τ


dτ12 |λ∗ (v), dτ12 |λ∗ (w)
12



+ d H0 (∆2 , · )τ (λ∗ ) D2 τ12 λ∗ (v, w) , (80)
12
|
{z
}
(λ∗ )

=0

where the term involving d H0 (∆2 , · ) vanishes due to equation (74), because
D2 τ12 only has a component in the direction of ∂ ∂λ .
f
Now use (26), (27), and (72) to obtain


2 D2 H0 (∆1 , · ) − D2 H0 (∆2 , τ12 ( · )) 
∗
λ

2
2
= cot α (dλ b − dλe ) − (dλ f − dλd ) + cot β (dλe − dλa )2 − (dλc − dλ f )2


+ cot γ (dλd − dλe )2 − (dλ f − dλ b )2 + cot δ (dλe − dλc )2 − (dλa − dλ f )2

+ cot(α + β) (dλc − dλd )2 − (dλa − dλ b )2

− cot(β + γ) (dλd − dλa )2 − (dλ b − dλc )2
= cot α (dλ b + dλd − dλe − dλ f )(dλ b − dλd − dλe + dλ f )
+ cot β (−dλa − dλc + dλe + dλ f )(−dλa + dλc + dλe − dλ f )
+ cot γ (dλ b + dλd − dλe − dλ f )(−dλ b + dλd − dλe + dλ f )
+ cot δ (−dλa − dλc + dλe + dλ f )(dλa − dλc + dλe − dλ f )
+ cot(α + β)(dλa − dλ b + dλc − dλd )(−dλa + dλ b + dλc − dλd )
− cot(β + γ)(−dλa + dλ b − dλc + dλd )(−dλa − dλ b + dλc + dλd )
= (dλ b + dλd − dλe − dλ f )

(cot α − cot γ)(dλ b − dλd ) + (cot α + cot γ)(−dλe + dλ f )
34

+ (−dλa − dλc + dλe + dλ f )

(cot β − cot δ)(−dλa + dλc ) + (cot β + cot δ)(dλe − dλ f )
+ (dλa − dλ b + dλc − dλd )
(cot(α + β) − cot(β + γ))(dλ b − dλd )

+ (cot(α + β) + cot(β + γ))(−dλa + dλc )
5.

= (−dλa + dλ b − dλc + dλd )

1
sin(−α + γ)(dλ b − dλd ) + sin(α + γ)(−dλe + dλ f )
sin α sin γ + sin β sin δ

+ sin(−β + δ)(−dλa + dλc ) + sin(β + δ)(dλe − dλ f )

1
−
sin(−α + γ)(dλ b − dλd ) + sin(−β + δ)(−dλa + dλc )
sin(α + β) sin(β + γ)
(81)
= 0.
5.

To see equality “=”, use the identities (77) and (78). To see the last equality,
note that (72) implies
sin(α + β) sin(β + γ) = sin α sin γ + sin β sin δ.

(82)

This proves equation (68) and completes the proof of Lemma 8.1.
Remark 8.3. In connection with Remark 8.2 (iii), it is curious to note that for
a vertical tangent vector in T Teg,n , that is, a vector tangent to the fiber over a
point in T g,n , the first factor in (81),
−dλa + dλ b − dλc + dλd ,
vanishes as well.

9

Proof of Theorem 1.1

In this section, we prove Theorem 1.1 using the variational principle of Theorem 7.18. By Propositions 6.2 and 6.3, Theorem 1.1 is equivalent to the following statement about the existence and uniqueness of realizable coordinate:
Proposition 9.1. Problem 2.3 has a unique solution up to equivalence (see Definition 6.4).
Proposition 9.1 is in turn equivalent to the following statement about the
unique solvability of an optimization problem with bounds constraints (see Theorem 7.18):
Proposition 9.2. Let ∆ be a triangulation of (S0 , V ), the oriented surface of
genus 0 with n = |V | ≥ 3 marked points, let λ ∈ R E∆ , let v∞ ∈ V , and let V ◦ be
defined by (53). Then there exists a unique solution to the minimization problem
◦

v∞
minimize E¯∆,λ
(u) for u ∈ RV ,

subject to the bounds constraints (61)
35

(83)



The rest of this section is concerned with proving Proposition 9.2, first the
uniqueness statement, then the existence statement.
Uniqueness. Assume the minimization problem (83) has a solution. To show
◦
e λ̃) be defined
the solution is unique, assume u ∈ RV solves (83) and let (∆,
e λ̃) are realizable coordinates with distinguished
by (57). By Theorem 7.18, (∆,
vertex v∞ .
e ◦ of cells not incident with v∞ is a linear graph.
Either the subcomplex ∆
In this case all constraints (61) are satisfied with equality, which determines u
uniquely.
e ◦ is a triangulation of a closed disk. Then the second derivative of E¯v∞
Or ∆
∆,λ
at u is positive semidefinite with one-dimensional kernel spanned by 1V ◦ . This
follows from (56) and the convexity of f (see Proposition7.2 (iii)). Together
with (62) and (63), this implies that
v∞ 0
v∞
E¯∆,λ
(u ) > E¯∆,λ
(u)
◦

for any u0 ∈ RV \ {u} satisfying the constraints (61).
v∞
Existence. To show that the continuous function E¯∆,λ
attains its minimum on
the closed subset
	

◦
◦ 
D = u ∈ RV  u satisfies the bounds constraints (61) ⊆ RV ,

it is enough to show that every unbounded sequence (un ) in D has a subsev∞
quence (unk ) with E¯∆,λ
(unk ) → +∞.
So let (un ) be an unbounded sequence in D. Note that (un ) is bounded from
below by the constraints (61). Hence, after taking a subsequence if necessary,
we may assume that for every v ∈ V ◦ either un (v) converges to a finite limit,
or un (v) → +∞. Since un (v) → +∞ for at least one v ∈ V ◦ and Θ v = 2π,
Corollary 7.15 implies
v∞
lim E¯∆,λ
(un ) = +∞.
n

This concludes the proof of Proposition 9.2, and hence of Theorem 1.1.

10

Discrete conformal equivalence and the uniformization spheres

In this section we recall the basic definitions of discrete conformal equivalence,
and we discuss the equivalence of Rivin’s Theorem 1.1 and the discrete uniformization theorem for spheres (see Theorem 10.6). The relation of discrete
conformal equivalence was first defined for triangulated surfaces (see Definition 10.1). A triangulated piecewise euclidean surface is determined by an abstract triangulation and an assignment of edge-lengths:
Definition 10.1 (triangulated piecewise euclidean surfaces). Let ∆ be a trianE∆
gulation of (S g , V ), and let ` ∈ R>0
be an assignment of positive numbers to
the edges that satisfies the triangle inequalities (11) for every triangle t ∈ T∆ .
36

Then there is a piecewise euclidean metric on S g that turns every triangle in
T∆ into a euclidean triangle and every edge e into a straight line segment of
length `e . We refer to the surface S g equipped with this metric and together
with the triangulation ∆ as the triangulated piecewise euclidean surface (∆, `).
Definition 10.2 (discrete conformal equivalence of triangulated surfaces). The
triangulated piecewise euclidean surfaces (∆, `) and (∆, ˜`) are discretely conformally equivalent if there is a function u ∈ RV such that for every edge e ∈ E ∆ ,
1

˜`(e) = e 2 (uv1 (e) +uv2 (e) ) `(e).

(84)

This definition is due to Luo [18]. It has the following interpretation in
terms of hyperbolic geometry:
Proposition 10.3. On a triangulated piecewise euclidean surface, one obtains
a complete hyperbolic metric of finite area by equipping every triangle with the
hyperbolic Klein metric induced by its circumcircle. Then the following statements
are equivalent:
e ˜`) are discretely
(i) The triangulated piecewise euclidean surfaces (∆, `) and (∆,
conformally equivalent.
e ˜`) are isometric
(ii) The triangulated piecewise euclidean surfaces (∆, `) and (∆,
with respect to the induced hyperbolic metrics.
This is Proposition 5.1.2 of [5]. The induced hyperbolic metric has Penner
coordinates (∆, λ), where λ and ` are related by (8). Proposition 5.1.2 can also
be seen by considering decorated ideal tetrahedra as shown in Figure 3: The
projection form the point v∞ maps the euclidean triangle A1 A2 A3 in the horosphere centered at v∞ to the ideal triangle v1 v2 v3 . The hyperbolic Klein metric
induced on the euclidean triangle A1 A2 A3 by its circumcircle is the pullback of
the hyperbolic metric of the ideal triangle v1 v2 v3 .
Note that Definition 10.1 requires the triangulations of both surfaces to be
equal. Discrete conformal mapping problems based on this notion of discrete
conformal equivalence can be solved using the variational principles introduced
in [5]—provided a solution exists. The variational principle also implies strong
uniqueness theorems for the solutions. But to prove any reasonable existence
theorem for discrete conformal maps, it seems necessary to allow changing the
triangulation. Proposition 10.3 motivates the following definition, which leads
to strong uniformization theorems:
Definition 10.4 (discrete conformal equivalence of piecewise euclidean surfaces). Piecewise euclidean metrics d and d̃ on the oriented surface (S g , V ) of
genus g with n = |V | marked points are discretely conformally equivalent if the
Delaunay triangulations of (S g , V ) with respect to the metrics d and d̃ induce
the same complete hyperbolic metric on the punctured surface S g,n = S g \ V .
Definition 10.4 is equivalent to the definition of Gu et al. [15]:
Proposition 10.5. Two piecewise euclidean metrics d and d̃ on (S g , V ) are discretely conformally equivalent, if there is a sequence of triangulated piecewise
euclidean surfaces
(∆0 , `0 ), . . . , (∆m , `m )
such that
37

(i) The metric of (∆0 , `0 ) is d and the metric of (∆m , `m ) is d̃.
(ii) Each ∆i is a Delaunay triangulation of the piecewise euclidean surface (∆i , `i ).
(iii) If ∆i = ∆i+1 , then (∆i , `i ) and (∆i+1 , `i+1 ) are discretely conformally equivalent in the sense of Definition 10.1.
(iv) If ∆i 6= ∆i+1 , then (∆i , `i ) and (∆i+1 , `i+1 ) are the same piecewise euclidean
surface with two different Delaunay triangulations ∆i and ∆i+1 .
Proof. This is a consequence of Proposition 10.3 and Theorems 4.6 and 4.12.
The connection of realization problems for ideal polyhedra and discrete conformal equivalence in the sense of Definition 10.1 was observed in [5, Sec. 5.4].
With Definition 10.4, Rivin’s polyhedral realization Theorem 1.1 is equivalent
to the following uniformization theorem for spheres:
Theorem 10.6 (discrete uniformization of spheres). For every piecewise euclidean metric d on the 2-sphere (S0 , V ) with n = |V | marked points, there is
a realization of (S0 , V ) as a convex euclidean polyhedron P with vertex set V , such
that all vertices lie on the unit sphere and the induced piecewise euclidean metric is
discretely conformally equivalent to d. The polyhedron P is unique up to projective
transformations of RP3 ⊇ R3 mapping the unit sphere to itself.
The equivalence of both problems follows from Proposition 10.3, the Möbius
invariance of discrete conformal equivalence [5, Sec. 2.5], the construction described in [5, Sec. 5.4], and Theorem 4.12.
The constructive variational proof of Theorem 1.1 (see Section 9) also shows
that the uniformizing polyhedron of a piecewise euclidean sphere with n vertices can be computed by solving a convex optimization problem with n − 1
variables.

11

Higher genus and prescribed cone angles

The variational method of proving Theorems 1.1 and 10.6 extends to other polyhedral realization and discrete uniformization problems. The following theorem was proved by Gu et al. [15]:
Theorem 11.1. Let d be a piecewise euclidean metric on (S g , V ), the surface of
genus g with n = |V | marked points, and let Θ ∈ RV satisfy Θ > 0 and the
Gauss–Bonnet condition
1 X
Θ v = 2g − 2 + n.
(85)
2π v∈V
Then there exists a discretely conformally equivalent metric d̃ on (S g , V ) such that
the cone angle at each v ∈ V is Θ v . The metric d̃ is uniquely determined up to
scale.
The special case of Θ v = 2π for all v is the uniformization theorem for tori:

38

Theorem 11.2 (uniformization theorem for tori). For every piecewise euclidean
metric d on (S1 , V ), the torus with n = |V | marked points, there exists a flat metric
d̃ on (S1 , V ) that is discretely conformally equivalent to d. The metric d̃ is uniquely
determined up to scale.
Theorem 11.2 is equivalent to the following polyhedral realization theorem:
Theorem 11.3. Every oriented complete hyperbolic surface of finite area that is
homeomorphic to a punctured torus S1,n can be realized as a convex polyhedral
surface in H 3 that is invariant under a faithful action of the fundamental group
π1 (S1 ) on H 3 by parabolic isometries.
Theorem 11.3 is a special case of a more general result of Fillastre [11,
Theorem B], who used Alexandrov’s method to prove it. It seems the more
general polyhedral realization theorem that is equivalent to Theorem 11.1 has
not been treated. It would involve hyperbolic manifolds with one cusp, convex
polyhedral boundary with ideal vertices, and with “particles”. Izmestiev and
Fillastre prove an analogous realization theorem for polyhedral surfaces with
finite vertices instead of ideal ones [12]. They use a variational method that is
analogous to the method presented in this article. Since the vertices are finite,
they do not need the Epstein–Penner convex hull construction.
The following variational principle for Theorem 11.1 is simpler than the
variational principle for the uniformization of spheres (see Theorem 7.18) because the minimization problem is unconstrained, no vertex is distinguished,
v∞
and it involves the function EΘ,∆,λ instead of E¯∆,λ
.
Theorem 11.4 (variational principle for Theorem 11.1). Let d be a piecewise
euclidean metric on (S g , V ), the surface of genus g with n = |V | marked points,
and let Θ ∈ RV . Let ∆ be a straight triangulation of (S g , V ) and for each edge e
let `e be length of edge e. Then the following statements are equivalent:
e ˜`) is discretely conformally equiv(i) The metric of the piecewise flat surface (∆,
alent to d and has cone angle Θ v at each vertex v ∈ V .
(ii) The function EΘ,∆,λ attains its minimum at u ∈ RV , the realizable coordie λ̃) are equivalent to Del(∆, Λ∆,λ (u)) (see Definition 6.4), and ˜`
nates (∆,
satisfies equation (21).
Proof. This follows from Proposition 7.12 and Theorem 4.12.
To prove Theorem 11.1 using the variational principle of Theorem 11.4,
note the following:
• The Gauss–Bonnet condition (85) is equivalent to the scale invariance of
EΘ,∆,λ , that is,
EΘ,∆,λ (u + h1V ) = EΘ,∆,λ (u).
(86)
This follows form (41).
• The uniqueness statement of Theorem 11.1 follows from the convexity of
EΘ,∆,λ , Proposition 7.12 (iii). If the Gauss–Bonnet condition is satisfied and
EΘ,∆,λ attains its minimum at u and at u0 , then u − u0 ∈ R1V .
• To prove the existence statement, proceed as in the proof of Theorem 1.1 (see
Section 9). Note that due to the scale invariance (86) it is enough to consider
unbounded sequences (un ) in RV that are bounded from below.
39

A completely analogous theory of discrete conformal equivalence for triangulated piecewise hyperbolic surfaces, including a convex variational principle,
was developed in [5, Sec. 6], see also [6]. A result analogous to Theorem 11.1
was proved by Gu et al. [14]. A corresponding realization result, analogous
to Theorem 11.3 for higher genus, is also due to Fillastre [11, Theorem B0 ].
To obtain a variational proof and a practical method for computation, one can
translate the variational method developed here to the setting of piecewise hyperbolic surfaces. This is beyond the scope of this article.
Acknowledgement. This research was supported by DFG SFB/Transregio 109
“Discretization in Geometry and Dynamics”.

References
[1] H. Akiyoshi. Finiteness of polyhedral decompositions of cusped hyperbolic
manifolds obtained by the Epstein-Penner’s method. Proc. Amer. Math. Soc.,
129(8):2431–2439, 2001.
[2] A. D. Alexandrov. Convex Polyhedra. Springer Monographs in Mathematics.
Springer-Verlag, Berlin, 2005. Translated from the 1950 Russian edition.
[3] F. Aurenhammer, R. Klein, and D.-T. Lee. Voronoi diagrams and Delaunay triangulations. World Scientific Publishing Co. Pte. Ltd., Hackensack, NJ, 2013.
[4] A. I. Bobenko and I. Izmestiev. Alexandrov’s theorem, weighted Delaunay triangulations, and mixed volumes. Ann. Inst. Fourier (Grenoble), 58(2):447–505,
2008.
[5] A. I. Bobenko, U. Pinkall, and B. Springborn. Discrete conformal maps and ideal
hyperbolic polyhedra. Geom. Topol., 19(4):2155–2215, 2015.
[6] A. I. Bobenko, S. Sechelmann, and B. Springborn. Discrete conformal maps:
boundary value problems, circle domains, Fuchsian and Schottky uniformization.
In A. I. Bobenko, editor, Advances in Discrete Differential Geometry, pages 1–56.
Springer, Berlin, 2016.
[7] A. I. Bobenko and B. A. Springborn. A discrete Laplace-Beltrami operator for
simplicial surfaces. Discrete Comput. Geom., 38(4):740–756, 2007.
[8] R. J. Duffin. Distributed and lumped networks. J. Math. Mech., 8:793–826, 1959.
[9] H. Edelsbrunner. Geometry and topology for mesh generation, volume 7 of Cambridge Monographs on Applied and Computational Mathematics. Cambridge University Press, Cambridge, 2001.
[10] D. B. A. Epstein and R. C. Penner. Euclidean decompositions of noncompact hyperbolic manifolds. J. Differential Geom., 27(1):67–80, 1988.
[11] F. Fillastre. Polyhedral hyperbolic metrics on surfaces. Geom. Dedicata, 134:177–
196, 2008. Erratum 138:193–194, 2009.
[12] F. Fillastre and I. Izmestiev. Hyperbolic cusps with convex polyhedral boundary.
Geom. Topol., 13(1):457–492, 2009.
[13] S. Fortune. Numerical stability of algorithms for 2D Delaunay triangulations. Int.
J. Comput. Geometry Appl., 5:193–213, 1995.
[14] X. Gu, R. Guo, F. Luo, J. Sun, and T. Wu. A discrete uniformization theorem for
polyhedral surfaces II. arXiv:1401.4594v1 [math.GT], 2014.

40

[15] X. Gu, F. Luo, J. Sun, and T. Wu. A discrete uniformization theorem for polyhedral
surfaces. arXiv:1309.4175v1 [math.GT], 2013.
[16] C. Indermitte, T. M. Liebling, M. Troyanov, and H. Clémençon. Voronoi diagrams on piecewise flat surfaces and an application to biological growth. Theoret. Comput. Sci., 263(1-2):263–274, 2001. Combinatorics and computer science
(Palaiseau, 1997).
[17] M. Joswig, R. Löwe, and B. Springborn. Secondary fans and secondary polyhedra
of punctured Riemann surfaces. arXiv:1708.08714 [math.MG], 2017.
[18] F. Luo. Combinatorial Yamabe flow on surfaces. Commun. Contemp. Math.,
6(5):765–780, 2004.
[19] H. Masur and J. Smillie. Hausdorff dimension of sets of nonergodic measured
foliations. Ann. of Math. (2), 134(3):455–543, 1991.
[20] J. Milnor. Hyperbolic geometry: the first 150 years. Bull. Amer. Math. Soc. (N.S.),
6(1):9–24, 1982.
[21] S. Moroianu and J.-M. Schlenker. Quasi-Fuchsian manifolds with particles. J.
Differential Geom., 83(1):75–129, 2009.
[22] R. C. Penner. The decorated Teichmüller space of punctured surfaces. Comm.
Math. Phys., 113(2):299–339, 1987.
[23] R. C. Penner. Decorated Teichmüller theory. QGM Master Class Series. European
Mathematical Society (EMS), Zürich, 2012.
[24] U. Pinkall and K. Polthier. Computing discrete minimal surfaces and their conjugates. Experiment. Math., 2(1):15–36, 1993.
[25] S. Rippa. Minimal roughness property of the Delaunay triangulation. Comput.
Aided Geom. Design, 7(6):489–497, 1990.
[26] I. Rivin. Intrinsic geometry of convex ideal polyhedra in hyperbolic 3-space. In
Analysis, Algebra, and Computers in Mathematical Research (Luleå, 1992), volume
156 of Lecture Notes in Pure and Appl. Math., pages 275–291. Dekker, New York,
1994.
[27] M. Sakuma and J. R. Weeks. The generalized tilt formula. Geom. Dedicata,
55(2):115–123, 1995.
[28] W. P. Thurston. Shapes of polyhedra and triangulations of the sphere. In The
Epstein birthday schrift, volume 1 of Geom. Topol. Monogr., pages 511–549. Geom.
Topol. Publ., Coventry, 1998.
[29] S. Tillmann and S. Wong. An algorithm for the Euclidean cell decomposition of a
cusped strictly convex projective surface. J. Comput. Geom., 7(1):237–255, 2016.
[30] J. R. Weeks. Convex hulls and isometries of cusped hyperbolic 3-manifolds. Topology Appl., 52(2):127–149, 1993.

Technische Universität Berlin, Institut für Mathematik, Strasse des 17. Juni 136,
10623 Berlin, Germany
boris.springborn@tu-berlin.de

41

