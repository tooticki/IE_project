Revisiting Zariski Main Theorem from a constructive
point of view
Alonso M. E., Coquand T., Lombardi H.

arXiv:1602.00597v1 [math.AC] 1 Feb 2016

January 2016

Note.
This paper appeared in Journal of Algebra 406, (2014), 46–68
Here, we have fixed two typos.
At the end of the proof of Proposition 4.8, we write
and h(T ) = T N +q (T − 1)
instead of: h(T ) = T N −1 (T − 1)
In the proof of Lemma 4.9. In line 7 of the proof we write:
We have q(T ) ∈ T N +1 + MA[T ]
instead of: We have q(T ) ∈ T N +1 (T − 1) + MA[T ]
Abstract
This paper deals with the Peskine version of Zariski Main Theorem published
in 1965 and discusses some applications. It is written in the style of Bishop’s
constructive mathematics. Being constructive, each proof in this paper can be
interpreted as an algorithm for constructing explicitly the conclusion from the
hypothesis. The main non-constructive argument in the proof of Peskine is
the use of minimal prime ideals. Essentially we substitute this point by two
dynamical arguments; one about gcd’s, using subresultants, and another using
our notion of strong transcendence. In particular we obtain algorithmic versions
for the Multivariate Hensel Lemma and the structure theorem of quasi-finite
algebras.

Keywords. Zariski Main Theorem, Multivariate Hensel Lemma, Quasi finite algebras, Constructive Mathematics

Contents
1 Introduction

2

2 Peskine crucial lemma
2.1 Basic tools for computing integral elements . . . . . . . . . . . . . .
2.2 Strong transcendence . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.3 Crucial lemma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4
4
6
7

3 Proof of ZMT

9
1

2

Revisiting Zariski Main Theorem

4 Henselian local rings
4.1 Simple zeroes in commutative rings . . . . .
4.2 Simple residual zeroes, Henselian rings . . .
4.3 Proof of the Multivariate Hensel Lemma . .
4.4 An example of Multivariate Hensel Lemma

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

11
11
13
14
18

5 Structure of quasi finite algebras

18

References

20

1

Introduction

The paper is written in the style of Bishop’s constructive mathematics, i.e. mathematics with intuitionistic logic (see [4, 5, 14, 16]).
A partial realization of Hilbert’s program has recently proved successful in commutative algebra, see e.g., [1, 6, 7, 8, 9, 11, 14, 19] and [10] with references therein,
and this paper is a new piece of realization of this program.
We were mainly interested in an algorithm for the Multivariate Hensel Lemma
(MHL for short). Let us see what is the aim of the computation on a simple example.
We consider the local ring A = Q[a, b]S , S = 1 + ha, biA. We take the equations
−a + x + bxy + 2bx2 = 0,

− b + y + ax2 + axy + by 2 = 0

and we want to compute a solution of the system (ξ, ζ) ≡ 0 mod M in the henselization of A. In other words, we have to find a Hensel equation f (U ) ∈ A[U ] (i.e. f
monic, f (0) ∈ ha, bi and f 0 (0) ∈
/ ha, bi) such that, when adding the Hensel zero u of
f to A we are able to compute ξ and ζ ∈ A[u]1+ha,b,uiA[u] .
Surprinsingly there is no direct proof of the result. Moreover elementary elimination techniques do not work on the above example. So we have to rely on the proof
of MHL via the so called Zariski Main Theorem (ZMT for short), as for example in
[15]. Note that there are many versions of ZMT (e.g. [13, 20]) and we are interested
in the ZMT à la Peskine as in [15].
We will give a solution of the above example in section 4.4.
This paper deals with the Peskine proof of ZMT published in 1965 [17] and
discusses some applications. Peskine statement is purely algebraic avoiding any hypothesis of noetherianity. The argument we give for Theorem 1.3 follows rather
closely Peskine’s proof. The main non-constructive argument in the proof of Peskine
is the use of minimal prime ideals. Note that the existence of minimal prime ideals in
commutative rings is known to be equivalent to Choice Axiom. Essentially we substitute this point by two dynamical arguments; one about gcd’s, using subresultants,
section 2.3, proof of Proposition 2.18, and another using our notion of strong transcendence, section 2.2 (in classical mathematics: to be transcendent over all residual
fields).
In sections 4 and 5, we give a constructive treatment of two classical applications of ZMT: the Multivariate Hensel Lemma, and structure theorem of quasi finite
algebras.
Being constructive, each proof in this paper can be interpreted as an algorithm
for constructing explicitly the conclusion from the hypothesis.

Alonso M., Coquand T., Lombardi H.

3

Theorem 1.1 (ZMT à la Peskine, particular case)
Let A be a ring, M a detachable maximal ideal of A and k = A/M. If B =
A[x1 , . . . , xn ] is an extension of A such that B/MB is a finite k-algebra then there
exists s ∈ 1 + MB such that s, sx1 , . . . , sxn are integral over A.
In [18] an equivalent formulation (Proposition 13.4) of Peskine version of the
Zariski Main Theorem can be written as the following lemma.
Proposition. Let (A, M) be a residually discrete local ring and k = A/M. If
B = A[x1 , . . . , xn ] is an extension of A such that MB ∩ A = M, A is integrally
closed in B and B/MB has a nontrivial zero-dimensional component as a k-algebra,
then B = A.
The last hypothesis can be given in a concrete way: there exists an idempotent e
of B/MB such that (B/MB)[1/e] is a nontrivial finite k-algebra. This means that
the residual variety has at least one isolated point.
The following corollary of Theorem 1.1 is a weakened form of the previous proposition.
Corollary 1.2 Let (A, M) be a residually discrete local ring and k = A/M. If
B = A[x1 , . . . , xn ] is an extension of A such that MB ∩ A = M, A is integrally
closed in B and B/MB is a finite k-algebra then B = A.
Proof. By Theorem 1.1 we find s ∈ A such that s ∈ 1 + MB and sx1 , . . . , sxn ∈ A.
We have then s − 1 ∈ A ∩ MB = M and hence s is invertible in A. Hence x1 , . . . , xn
are in A and B = A.
Remark. The hypothesis that A is integrally closed in B is necessary, even if we
weaken the conclusion to “B is finite over A”. Let A be a DVR with M = pA, the
ring B = A×A[1/p] is finitely generated over A, MB = h(p, 1)i and B/MB = A/M,
but B is not finite over A. If A0 is the integral closure of A in B, we cannot apply
Corollary 1.2 with (A0 , MA0 ) replacing (A, M) because MA0 is not a maximal ideal
of A0 (in fact A0 ' A × A).
In fact we shall prove a slightly more general version of Theorem 1.1, without
assuming M to be a detachable maximal ideal.
Theorem 1.3 (ZMT à la Peskine, variant)
Let A be a ring with an ideal I and B = A[x1 , . . . , xn ] be an extension of A such
that B/IB is a finite A/I-algebra, then there exists s ∈ 1 + IB such that s, sx1 ,
. . . , sxn are integral over A.
Remark. In fact, the hypothesis that the morphism A → B is injective is not
necessary: it is always possible to replace A and I by their images in B, and the
conclusion remains the same.
Corollary 1.4 Let A be a ring with an ideal I and B = A[x1 , . . . , xn ] be an extension of A such that B/IB is a finite A/I-algebra, then there exists a finite extension
C of A inside B and s ∈ C ∩ 1 + IB such that C[1/s] = B[1/s].
Proof. Take C = A[s, sx1 , . . . , sxn ].

4

Revisiting Zariski Main Theorem
We shall also give a proof of the following “global form” of Zariski Main Theorem.

Theorem 5.3 (ZMT à la Raynaud, [15])
Let A ⊆ B = A[x1 , . . . , xn ] be rings such that the inclusion morphism A → B is zero
dimensional (in other words, B is quasi-finite over A). Let C be the integral closure
of A in B. Then there exist elements s1 , . . . , sm in C, comaximal in B, such that all
si xj ∈ C.
In particular for each i, C[1/si ] = B[1/si ]. Moreover letting C 0 = A[(si ), (si xj )],
which is finite over A, we get also C 0 [1/si ] = B[1/si ] for each i.
We give now the plan of the paper.
In section 2 we give some preliminary results and the proof of a Peskine “crucial
lemma”.
In section 3 we give the constructive proof for Theorem 1.3.
In section 4 we give a constructive proof for the Multivariate Hensel Lemma
(Theorem 4.4). A usual variant is the following corollary.
Corollary 4.5 Let (A, m) be a Henselian local ring. Assume that a polynomial
system (f1 , . . . , fn ) in A[X1 , . . . , Xn ] has residually a simple zero at (0, . . . , 0). Then
the system has a (unique) solution in An with coordinates in m.
Section 5 is devoted to structure theorem of quasi-finite algebras: we give a proof
of Theorem 5.3, moreover Proposition 5.2 explains the constructive content of the
hypothesis in Theorem 5.3.
Acknowledgements. First and third authors are partially supported by Spanish
GR MTM2011-22435. Third author thanks the Computer Science and Engineering
Department at University of Gothenburg for several invitations. This article has been
discussed in the course of a researching stay of the first author at the Department
of Mathematics of the University of Franche-Comté. She thanks the Department for
its kind invitation.

2

Peskine crucial lemma

In this section we give a constructive proof of a crucial lemma in the proof of Peskine.
This is Proposition 2.18 in the following.

2.1

Basic tools for computing integral elements

Let R ⊆ S be rings and let I be an ideal of R. We say that t ∈ S is integral over I
if and only if it satisfies a relation tn + a1 tn−1 + · · · + an = 0 with a1 , . . . , an in I.
The integral closure of I in S is the ideal of elements of S that are integral over I.
Lemma 2.1 (Lying Over, concrete form)
1. If S is integral over R then the integral closure of I in S is
√
√
As a consequence IS ∩ R = I.

√

IS.

2. If S is integral over R and 1 ∈ hb1 , . . . , bm iS then 1 ∈ hb1 , . . . , bm iR[b1 , . . . , bm ].

Alonso M., Coquand T., Lombardi H.

5

Proof. 1. See [2] Lemma 5.14.
2. Use item 1 with R0 = R[b1 , . . . , bm ] and I = hb1 , . . . , bm iR[b1 , . . . , bm ].
√
P
Algorithm: Let x be in IS: xn = pk=1 ak sk , with ak ∈ I and sk ∈ S. Let 1 =
s1 , . . . , sm be generators of R1 = R[s1 , . . . , sp ] as an R-module. The multiplication
n with coefficients in I. The
by xn in R1 is expressed on s1 , . . . , sm by a matrix M
Pxm−1
m
n
characteristic polynomial of Mx is P (T ) = T + k=0 bk T k with bk ’s ∈ I, and
P (xn ) = P (Mxn )(1, 0, . . . , 0) = 0.
Definition 2.2 We denote cX (g) (or c(g)) the ideal of R generated by the coefficients of g ∈ R[X] (cX (g) is called the X-content ideal of g in R).
Lemma 2.3 (Kronecker)
Let Z ⊆ R where Z is the subring generated by 1.
1. (simple form) If f (X) = X k + a1 X k−1 + · · · + ak divides X n + b1 X n−1 + · · · + bn
in R[X] then a1 , . . . , ak are integral over b1 , . . . , bn (more precisely they are
integral over the ideal generated by b1 , . . . , bn in Z[b1 , . . . , bn ]).
Pn
j
2. (general form) If f g = h =
j=0 cj X in R[X], a a coefficient of f and b
a coefficient of g then ab is integral over the ideal generated by c0 , . . . , cn in
Z[c0 , . . . , cn ].
p
P
3. (Gauss-Joyal) If f g = h = nj=0 cj X j in R[X] then c(f )c(g) ⊆ c(h).
Proof. 1. Considering the splitting algebra of f over R, we can assume X k +a1 X k−1 +
· · · + ak = (X − t1 ) . . . (X − tk ). We have then t1 , . . . , tk integral over b1 , . . . , bn and
hence also a1 , . . . , ak since they are (symmetric) polynomials in t1 , . . . , tk .
2. This is deduced from 1 by homogeneization arguments.
3. This is an immediate consequence of 2.
Lemma 2.4 If R ⊆ S and t ∈ S satisfies an equation an tn + · · · + a0 = 0 with
a0 , . . . , an ∈ R then an t is integral over R.
Lemma 2.5 (see [12]) Let R ⊆ S and x ∈ S satisfies an equation P (x) = an xn +
· · · + a0 = 0 with a0 , . . . , an ∈ R. We take
un = an , un−1 = un x + an−1 , . . . . . . , u0 = u1 x + a0 = 0
We get the following results.
1. un , . . . , u0 and un x, . . . , u0 x are integral over R and hu0 , . . . , un i = ha0 , . . . , an i
as ideals of R[x].
2. Let I be an ideal of R s.t. 1 ∈ ha0 , . . . , an iR[x] mod IR[x] and x mod I is
integral over R/I then there exists w ∈ 1 + R[x] s.t. w and wx are integral
over R.
Proof. 1. Lemma 2.4 shows that an x = un x is integral over R. It follows that
un−1 = un x + an−1 is integral over R. We have then
un−1 xn−1 + an−2 xn−2 + · · · + a0 = 0

6

Revisiting Zariski Main Theorem

so that, again by Lemma 2.4, un−1 x is integral over R[un−1 ] and so over R. In this
way, we get that un , un x, un−1 , un−1 x, . . . , u1 x, u0 = 0 are all integral over R.
2. Let R0 be the image of R[u] = R[u0 , . . . , un ] in R[x]/IR[x]. So R0 ⊆ R[x]/IR[x]
0 . Item 1. shows that 1 ∈ hu , . . . , u i mod IR[x].
with R[x]/IR[x] integral over RP
0
n
n
LyingPOver item 2 gives 1 =
i=0 ui gi (u) mod IR[x] with gi (u)’s ∈ R[u]. Let
w = ni=0 ui gi (u), then w and wx are clearly integral over R.
Lemma 2.6
1. If t is integral over R[x] and p(x) is a monic polynomial in R[x] such that tp(x)
is in R[x] then there exists q in R[x] such that t − q is integral over R.
2. If t is integral over R[x] and p(x) = ak xk + · · · + a0 is a polynomial in R[x]
such that tp(x) is in R[x] then there exists q in R[x] and m such that am
k t−q
is integral over R.
Proof. 1. We write tp = r(x) in R[x]. We do the Euclidian division of r(X) by p(X)
and get r = pq + r1 . We can then write (t − q)p = r1 . This shows that we have
p = (t − q)−1 r1 in R[(t − q)−1 ][x] and hence that x is integral over R[(t − q)−1 ]. Since
t − q is integral over R[x] we get that t − q is integral over R[(t − q)−1 ] and hence
over R.
2. We have an equation for t of the form tn + p1 (x)tn−1 + · · · + pn (x) = 0. Let `
be the greatest exponent of x in this expression. By multiplying by a` we get an
equality of the form
a` tn + q1 (ax)tn−1 + · · · + qn (ax) = 0
and hence, by Lemma 2.4, a` t is integral over R[ax]. Sowe we have ` such that a` t
is integral over R[ax] for all a ∈ R.
We write tp(x) = r(x) and by multiplying by a suitable power of ak we get an
tam
k P (ak x) ∈ R[ak x] with m ≥ ` and P monic. We can then apply item 1.
Corollary 2.7 If t is integral over R[x] and R is integrally closed in R[x, t] and
t(ak xk + · · · + a0 ) ∈ R[x] then there exists m such that am
k t ∈ R[x].
Next lemma is a kind of glueing of integral extensions.
Lemma 2.8 Let R ⊆ S and x, t, y, s ∈ S. If t, ty are integral over R[x] and s, sx
integral over R then for N big enough and w = sN t the elements w, wx, wy are
integral over R.
Proof. We write tk +a1 (x)tk−1 +· · ·+ak (x) = 0 and t` y ` +b1 (x)t`−1 y `−1 +· · ·+b` = 0.
Let xd be the highest power of x that appears in these expressions. We have that
sd t and sd ty are integral over s, sx and so over R, and we take N = d + 1.

2.2

Strong transcendence

Let D be a C-algebra and x ∈ D. We say that x is strongly transcendent over C
in D if for all u ∈ D and c0 , . . . , ck ∈ C such that u(c0 + · · · + ck xk ) = 0, we have
uc0 = · · · = uck = 0 (each time it is needed, ci stands for the image of ci in D).
Note that the definition strongly depends on C and D. Moreover from an equality
c0 + · · · + ck xk = 0 in D we deduce only that c0 = · · · = ck = 0 in D.

Alonso M., Coquand T., Lombardi H.

7

Lemma 2.9
1. If D is a C-algebra, x strongly transcendent over C in D and V a monoid of
D, then x is strongly transcendent over C in DV .
2. If D is a C-algebra and x is strongly transcendent over C in D and a ∈ C,
then x is strongly transcendent over C[1/a] in D[1/a].
Lemma 2.10 If u, x ∈ D, D a reduced C-algebra, x strongly transcendent over C
in D and u, ux are integral over C then u = 0.
Proof. We have Q(ux) = (ux)` + c1 (ux)`−1 + · · · + c` = 0 and P (u) = um + a1 um1 +
· · · + am = 0 for some c1 , . . . , c` , a1 , . . . , am in C. So ResU (P (U ), Q(U x)) = V (x) is a
`
polynomial with constant coefficient cm
` and leading coefficient ±am . Since V (x) = 0,
x is transcendent over C in D, and D is reduced, it follows that we have c` = am = 0
in D. We get in D
(ux)Q1 (ux) = 0 with Q1 (T ) = (Q(T ) − c` )/T.
Now we consider the reduced ring D1 = D[1/(ux)]. In this ring x is strongly transcendent over C. We have in D1
Q1 (ux) = 0 with Q1 (0) = c`−1 and P (u) = 0.
So c`−1 = 0 in D1 . Similarly we deduce c`−2 = · · · = c1 = 0 in D1 . So ux = 0 in D1
and finally ux = u = 0 in D.
Lemma 2.11 If D is a reduced C-algebra and x is strongly transcendent over C in
D and C1 ⊆ D and C1 is integral over C then x is strongly transcendent over C1 in
D.
Proof. Assume an equality u(c0 xk + · · · + ck ) = 0 with u ∈ D and ci ’s in C1 . Passing
to D0 = D[1/u] we get c0 xk + · · · + ck = 0 with ci ’s integral over C. So c0 x is integral
over C1 , and thus over C too. So c0 and c0 x are integral over C. By Lemma 2.10
c0 = 0 in D0 , so c0 u = 0 in D. We finish by induction on k.

2.3

Crucial lemma

Context 2.12 We fix now the following context, which comes from Corollary 2.7:
t integral over R[x] of degree n and R integrally closed in S = R[x, t]. We define
J = (R[x] : S).
Lemma 2.13 (Context 2.12)
If u ∈ S we have u ∈ J if and only if u, ut, . . . , utn−1 ∈ R[x].
Proof. This is clear since all elements of S can be written qn−1 (x)tn−1 +· · ·+q0 (x).
Lemma 2.14 (Context 2.12)
If u ∈ S and a0 , . . . , ak ∈ R and u(a0 + · · · + ak xk ) ∈ J, then there exists m such
that uam
k ∈ J.

8

Revisiting Zariski Main Theorem

Proof. We have by Lemma 2.13
(a0 + · · · + ak xk )u, (a0 + · · · + ak xk )ut, . . . , (a0 + · · · + ak xk )utn−1 ∈ R[x].
All elements utj are integral over R[x] and R is integrally closed in R[x, utj ]. Hence
j
by Corollary 2.7 we find m such that am
k ut ∈ A[x].
√
We consider now the radical JS of J in S.
Corollary 2.15 (Context 2.12)
√
√
If u ∈ S and a0 , . . . , ak ∈ R and u(a0 +· · ·+ak xk ) ∈ JS, then ua0 , . . . , uak ∈ JS.
Proof. We have ` such that u` (a0 + · · · +
ak xk )` ∈ J. By Lemma 2.14√we have m
√
k
such that u` (a`k )m ∈ J and
JS and so
√ hence uak ∈ JS. It follows that uak x ∈ √
k−1
u(a0 + · · · + ak−1 x ) ∈ JS and we get successively uak−1 , . . . , ua0 ∈ JS.
Summing up previous results in Context 2.12 and using the notion of strong
transcendence.
Proposition 2.16 Assume S = R[x, t] with t integral over
√ R[x] and R is integrally
√
closed in S. We take J = (R[x] : S). If we take D = S/ JS and C = R/R ∩ JS,
then D = C[x, t] is a reduced ring with a subring C such that t is integral over C[x]
and x is strongly transcendent over C in D.
Proof. Clear. The last assertion comes from Corollary 2.15.
Proposition 2.17 Assume that D = C[x, t] is a reduced ring with a subring C such
that t is integral over C[x]√and x is strongly
√ transcendent over C in D. Let I be an
ideal of C such that tx ∈ ID. Then t ∈ ID.
Equivalently, if DU is the localization of D at the monoid U = tN + ID, then DU is
a trivial ring.
The proof is given after the crucial lemma.
Proposition 2.18 (crucial lemma)
If S = R[x, t] and R√is integrally closed
in S and
√
√ t is integral over R[x] and I ideal
of R such that tx ∈ IS then t ∈ IS mod. JS where J = (R[x] : S).
Proof. This follows from Propositions 2.16 and 2.17.
Here begins the proof of Proposition 2.17.
Since t is integral over
√ C we get a T -monic polynomial P (x, T ) in C[x][T ] s.t.
P (x, t) = 0. As tx ∈ ID by Lying Over we get a polynomial
Q(X, T ) = X n T n + µ1 (X)X n−1 T n−1 + · · · + µn (X) with ∈ µi (X) ∈ IC[X]
s.t. Q(x, t) = 0. We need now to prove Lemma 2.19.
Lemma 2.19 Assume C1 ⊆ DU , that x is transcendent over C1 and that G(x, T ) =
T k + b1 (x)T k−1 + · · · + bk (x) divides Q(x, T ), with b1 (x), . . . , bk (x) ∈ C1 [x] and
G(x, t) = 0. Then DU is a trivial ring.

Alonso M., Coquand T., Lombardi H.

9

Proof. Since x is transcendent over C1 we have that G(X, T ) = T k + b1 (X)T k−1 +
· · · + bk (X) divides Q(X, T ). By taking T = X N we see that X N k + b1 (X)X N (k−1) +
· · · + bk (X) divides X n X N n + µ1 (X)X n−1 X N (n−1) + · · · + µn (X). If N is big enough
we can apply Lemma 2.3 and conclude that all coefficients of b1 (X), . . . , bk (X) are
integral over I. Since G(x, t) = tk + b1 (x)tk−1 + · · · + bk (x) = 0 it follows that t is
integral over IC[x], and so DU is a trivial ring.
We consider the ring DU , we compute the subresultants of P (x, T ) and Q(x, T ) in
C[x][T ] and we show that they are all 0 in DU , i.e. P (x, T ) has to divide Q(x, T ) in
DU [T ].
The conclusion follows then from Lemma 2.19 with C1 the image of C in DU and
G = P.
We use results about subresultants given in Lemma 2.20 (for the general theory
of subresultants, see [3, Chapter 4]) We consider one such subresultant s0 (x)T ` +
c1 (x)T `−1 + · · · + c` (x) assuming that all previous subresultants have been shown to
be 0. We can assume s0 (x) to be invertible, replacing DU by DU [1/s0 ]. We let a be
the leading coefficient of s0 (x) and we show a = 0. We write bi (x) = ci (x)/s0 (x).
Since T ` + b1 (x)T `−1 + · · · + b` (x) divides P (x, T ) we have that b1 (x), . . . , b` (x) are
integral over C[x] by Lemma 2.3. By Lemma 2.6, b1 (x), . . . , b` (x) are in C1 [1/a][x]
with C1 integral over C. By Corollary 2.11 and Lemmas 2.19 and 2.9, we have 1 = 0
in DU [1/a] and hence a = 0 in DU .
Here the proof of Proposition 2.17 is finished.
Lemma 2.20 Let A be a reduced ring, f ∈ A[X] a monic polynomial of degree
d, g ∈ A[X] and δ a bound for the degree of g. Let j < d a nonnegative integer.
The subresultant of f and g in degree j, denoted Sresj,X,d,δ (f, g) = Srj (X) is a well
defined polynomial of degree ≤ j: it does not depend on δ. We let Srd = f . Let us
denote sj the coefficient of X j in Srj (X). Then we have:
1. Srj (X) belongs to the ideal hf, gi of A[X] (0 ≤ j ≤ d).
2. Let ` > 0, ` ≤ d. If sk = 0 for k < ` and s` is invertible, then:
– Srk (X) = 0 for k < `.
– Sr` (X) divides f (X) and g(X) in A[X].
Proof. 1. This is a classical result.
2. Since the results are well known when A is a field, the lemma follows by using
the formal Nullstellensatz.

3

Proof of ZMT

It is more convenient for a proof “by induction on n” to use the following version 3.1.
Theorem 3.1 (ZMT à la Peskine, general form, variant)
Let A be a ring with an ideal I and B be a finite extension of A[x1 , . . . , xn ] such that
B/IB is a finite A/I-algebra, then there exists s ∈ 1 + IB such that s, sx1 , . . . , sxn
are integral over A.
Here, the precise hypothesis is A ⊆ A[x1 , . . . , xn ] ⊆ B, with B finite over
A[x1 , . . . , xn ]. Clearly Theorems 1.3 and 3.1 are equivalent.

10

Revisiting Zariski Main Theorem

Case n = 1
Proposition 3.2 Let A be a ring with an ideal I and B be a finite extension of
A[x] such that B/IB is a finite A/I-algebra, then there exists s ∈ 1 + IB such that
s, sx are integral over A.
Proof. Let f (X) ∈ A[X] a monic P
polynomial s.t. f (x) ∈ IB. By Lying Over f (x)m ∈
i
IA[x]. This provides P (X) =
i=0 ai X ∈ A[X] such that P (x) = 0 and 1 ∈
ha0 , . . . , an i mod IA[x]. Apply Lemma 2.5, item 2 with R = A.
The induction step
Proposition 3.3 Let A be a ring with an ideal I, B an extension
√ of A with x in
B such that B is integral over A[x] and t in B such that xt is in IB. There exist
b0 , . . . , bn such that hb0 , . . . , bn i meets tN +IB and b0 , . . . , bn , b0 x, . . . , bn x are integral
over A.
p
Proof. By Lying Over xt ∈ IA[x, t] and we can assume as well that B = A[x, t].
We apply Proposition 2.18 with R the integral closure of A in B, S = R[x, t] = B,
J = (R[x] : S). We get an a ∈ J ⊆
R[x] with a = tm√+ y, y ∈ IS. We have
√
at = tm+1 + yt ∈ P
R[x]. Since tx ∈ IS, atx ∈ R[x] ∩ IS and by Lying Over
∃e ∈ N, (at)e xe = i µi xi with µi ’s in IR.
P
We write at = p(x) with p(X) ∈ R[X], q(X) = p(X)e X e − i µi xi written as
P
P`
i
i
e e
i µi X ∈ R[X]. We have Q(x) =
i=0 ai X in R[x][X] and Q(X) = p(X) X −
q(x) = 0 and cX (pe ) = cX (q) = cX (Q) mod IR[x].
p
p
Let R0 = R[x]/IR[x]. In R0 we have at = p(x) ∈ cX (p) andp cX (p) = cX (Q) by
Gauss-Joyal. Remark that tm+1 = at − yt implies that t ∈ cX (p) + IS.
If n is a bound for the degree of Q, by Lemma 2.5 we get b0 , . . . , bn ∈ R[x] integral
over R s.t. b0 x, . . . p
, bn x avec integral
pover R and hb0 , . . . , bn i = cX (Q).
Finally we get t ∈ cX (p) + IS = hb0 , . . . , bn i + IS
Corollary 3.4 Let A be a ring with an ideal I, B an extension of A with x in B
such that B is integral
over A[x], p(X) ∈ A[X] a monic polynomial and t in B such
√
that p(x)t is in IB. There exist b0 , . . . , bn such that hb0 , . . . , bn i meets tN + IB and
b0 , . . . , bn , b0 x, . . . , bn x are integral over A.
Proof. Let y = p(x), then x is integral over A[y]. Applying Proposition 3.3
with y instead of x, we get b0 , . . . , bn such that hb0 , . . . , bn i meets tN + IB and
b0 , . . . , bn , b0 y, . . . , bn y are integral over A. We say that this implies bj x’s are integral over A. If the integral dependance of bj y over A is given by a polynomial
(m−1)d
of degree d and p is of degree m, multiplying the equation by bj
, one gets an
integral dependance equation of bj x over A[bj ].
Now we can prove Theorem 3.1.
Proof. We give the proof for n = 2, x1 = x and x2 = y.
The induction from n − 1 to n follows the same lines as the induction from 1 to 2.
First we apply Proposition 3.2 with A0 = A[x] instead of A, y replacing x. We get
s ∈ 1 + IB with s and sy integral over A0 .

Alonso M., Coquand T., Lombardi H.

11

Let p(X) ∈ A[X] be a monic polynomial such that p(x) ∈ IB. By Lying Over p(x)
is integral over IA[x, y]. We take t = sN for N big p
enough such that tp(x) is integral
over IA[x, s, sy]. By Lying Over again tp(x) is in IA[x, s].
We apply Corollary 3.4 with A, x, t, replacing B by A[x, s]. We get b0 , . . . , bn ∈
A[x, s] such that hb0 , . . . , bn iA[x, s] meets tN + IA[x, s] and b0 , . . . , bn , b0 x, . . . , bn x
are integral over A. Since t ∈ 1 + IB, 1 ∈ hb0 , . . . P
, bn iB/IB. As B/IB is finite
over A/I, by Lying Over item 2 we have that P
1 = ni=0 bi gi (b) mod IB for some
polynomials gi with coefficients in A. Let w = ni=0 bi gi (b). Clearly w and wx are
integral over A. Applying lemma 2.8 with R = A, S = B gives u = wM s such that
u, ux and uy integral over A, and we see that w ∈ 1 + IB.

4

Henselian local rings

Remark. Section 5 is independant of section 4.

4.1

Simple zeroes in commutative rings

We consider an arbitrary commutative ring k, I = Rad(k) its Jacobson radical (so
1 + I ⊆ k × ) and a polynomial system
f1 (X1 , . . . , Xn ) = · · · = fn (X1 , . . . , Xn ) = 0

(∗)

which has a simple zero at (a1 , . . . , an ) = (a) ∈ k n . This means
f1 (a) = · · · = fn (a) = 0 and Jf (a) ∈ k × ,
where Jf (X) is the Jacobian of the system, i.e. the determinant of the Jacobian
matrix Jacf (X) = (∂fj /∂Xi )1≤i,j≤n .
Then this zero is unique modulo I = Rad(k) and can be isolated in a pure
algebraic way as shown by the next lemma.
Lemma 4.1 Let us consider the above polynomial system (∗).
Let L = k[X1 , . . . , Xn ]/hf1 , . . . , fn i = k[x1 , . . . , xn ], S = 1 + hx1 − a1 , . . . , xn − an i
and LS the corresponding “local algebra”.
1. For i = 1, . . . , n, xi = ai in LS , the natural morphism k → LS is an
isomorphism. Identifying k with its images in L and LS , we have L =
k ⊕ hx1 − a1 , . . . , xn − an iL and LS = k = L/hx1 − a1 , . . . , xn − an i.
2. There exists an idempotent e in S such that exi = ai (i = 1, . . . , n) and
LS = L[1/e].
3. (a) is the unique zero of (∗) equal to (a) modulo I.
Proof. Making a translation we can replace (a1 , . . . , an ) by (0, . . . , 0). The evaluation
g 7→ g(0) defined on k[X] gives morphisms L → k and LS → k, which we shall note
again g 7→ g(0). By composing k → LS → k or k → L → k we get the identity map.
So L = k ⊕ hx1 , . . . , xn iL.

12

Revisiting Zariski Main Theorem

1 and 2. After a linear change of variables using Jac(0)−1 we can assume that
Jac(0) = In , and we write fi (X) = Xi − gi (X) with gi (X) ∈ hX1 , . . . , Xn i2 . So in L
we have a matrix M = M (x) ∈ Mn (hx1 , . . . , xn i) satisfying

 
x1
x1
 ...  = M  ...  .


xn

xn

Writing e(x) = det(In − M ) we get e ∈ 1 + hx1 , . . . , xn i = S and exi = 0, which
implies eg = eg(0) for all g ∈ L. In particular e2 = e and eh = e for h ∈ S, so
LS = L[1/e]. Also xi = 0 in LS and g = g(0) for all g ∈ LS .
3. Let (y1 , . . . , yn ) be a zero with coordinates in I. So we have a k-morphism
L → k, g 7→ g(y1 , . . . , yn ).
We can view it as a specialization xi → yi . Item 2 gives e(x1 , . . . , xn ) ∈ 1 +
hx1 , . . . , xn i with exi = 0. Specialising xi to yi we obtain e(y1 , . . . , yn )yi = 0 with
e(y1 , . . . , yn ) ∈ 1 + hy1 , . . . , yn i ⊆ 1 + I ⊆ k × .
Remark. Viewing L as the ring of polynomial functions on the variety defined by
the polynomial system (∗), the idempotent e defines a clopen Zariski subset, it gives
two ways of isolating the zero (a), either by considering the closed subset defined
by e = 1 or by considering the open subset defined by making e invertible (the two
subsets are identical). Moreover point 3 gives a third way of understanding the fact
that the zero is isolated: it is the unique zero in the “infinitesimal neighborhood of
(a)”.
Approximate simple zeroes and Newton process
Here A is a commutative ring with an ideal I and we consider a polynomial system
with coefficients in A
f1 (X1 , . . . , Xn ) = · · · = fn (X1 , . . . , Xn ) = 0

(∗)

Theorem 4.2 (Newton process, see e.g. [14, Section III-10])
Let (a) = (a1 , . . . , an ) ∈ An be an approximate simple zero of (∗) modulo I: it gives
a zero of (∗) in A/I and the Jacobian Jf (a) of the system is invertible in A/I. So
the Jacobian matrix Jacf (a) is invertible modulo I; let U (a) ∈ Mn (A) be such an
inverse modulo I. Compute


  
f1 (a)
b1
a1
 ...  =  ...  − U (a)  ...  .


bn

an

fn (a)

Then (b1 , . . . , bn ) is a zero of (∗) modulo I2 and Jac(b) is invertible modulo I2 : one
can take U (b) = U (a)(2In − Jac(b)U (a)).
Let J be the Jacobson radical of the ideal I, i.e. the ideal of elements x such that
each y ∈ 1 + xA is invertible modulo I. Then Lemma 4.1 3 tells us that (a) is the
unique zero modulo I of (∗) equal to (a) modulo J. Since J is also the Jacobson

Alonso M., Coquand T., Lombardi H.

13

radical of I2 , (b) is the unique zero modulo I2 of (∗) which is equal to (b) modulo J.
A fortiori (b) is the unique zero modulo I2 of (∗) which is equal to (a) modulo I.
Remark. Newton process is used for constructing a zero of an Hensel system (see Context 4.3) when the Henselian local ring is a ring of formal power series. Nevertheless,
this does not prove that the coordinates of the zero are inside the Henselization of
the ring generated by the coefficients of the Hensel system. So the MHL can be seen
an improved version of Newton process for the existence of the zero. On the other
hand, Newton process is used in the proof of MHL (see the proof of Lemma 4.9).

4.2

Simple residual zeroes, Henselian rings

We fix the following context for sections 4.2 and 4.3.
Context 4.3 Let A be a local ring with detachable maximal ideal M, and k = A/M
its residual field (it is a discrete field). We consider a polynomial system
f1 (X1 , . . . , Xn ) = · · · = fn (X1 , . . . , Xn ) = 0

(∗)

which has a residually simple zero at (0, . . . , 0): we have fi (0, . . . , 0) = 0 residually
and the Jacobian of this system Jf (0, . . . , 0) is in A× . In this case we will say that
we have a Hensel system.
First we remark that if (C, MC ) is a local A-algebra such that the system (∗) has
a solution (y1 , . . . , yn ) with the yi ’s in MC , then this solution is unique by Lemma
4.1 3.
To this polynomial system we associate
the quotient ring

B = A[X1 , . . . , Xn ]/hf1 , . . . , fn i = A[x1 , . . . , xn ]

a maximal ideal of B

MB = M + hx1 , . . . , xn iB

and the local ring

B1+MB (usually denoted as BMB ).

(MB ⊇ MB)

The ideal MB is maximal because it is the kernel of the morphism B → k sending
g(x) to g(0). This shows also that B/MB = A/M and hence the natural morphism
A → B is injective. So we can identify A with its image in B and we have B =
A ⊕ hx1 , . . . , xn iB. Nevertheless it is not at all evident that the morphism from A
to B1+MB is injective (this fact will be proved in Corollary 4.6), so if we speak of
A ⊆ B1+MB before the proof of Corollary 4.6 is complete, it is an abus de langage
and it is needed to replace A by its image in B1+MB .
It can be easily seen that the natural morphism ϕ : A → B1+MB satisfies the
following universal property:
ϕ is a local morphism (i.e., ϕ(x) ∈ (B1+MB )× implies x ∈ A× ) and for every local
morphism ψ : A → C such that (y1 , . . . , yn ) is a solution of (∗) with the yi ’s in
the maximal ideal of C, there exists a unique local morphism θ : B → C such that
θ ◦ ϕ = ψ.
Since B1+MB satisfies this universal property w.r.t. the system (∗) we introduce
the notation
B1+MB = AJf1 ,...,fn K .
The following version of MHL is a kind of “primitive element theorem”.

14

Revisiting Zariski Main Theorem

Theorem 4.4 (Multivariate Hensel Lemma)
We consider a Hensel system as in Context 4.3 and we use preceeding notations.
Then the local ring AJf1 ,...,fn K = B1+MB can also be described with only one polynomial equation f (X) such that f (0) ∈ M and f 0 (0) invertible. More precisely there
exist
– an y ∈ MB ,
– a monic polynomial f (X) ∈ A[X] with f (y) = 0 and f 0 (0) ∈ 1 + M (thus f 0 (y) ∈
1 + MB ),
such that
– each xi belongs to A[y]1+M+yA[y] ,
– the natural morphism AJf K → B1+MB sending x to y is an isomorphism (x is X
viewed in AJf K ).
In short AJf1 ,...,fn K = AJf K .
Before proving Theorem 4.4 we state some corollaries.
A local ring where each equation of the preceeding form (a monic polynomial
with a simple residual zero) has a solution residually 0 is said to be Henselian.
As immediate consequence of the MHL one has the following.
Corollary 4.5 Let (A, m) be a Henselian local ring. Assume that a polynomial
system (f1 , . . . , fn ) in A[X1 , . . . , Xn ] has a residually simple zero at (0, . . . , 0). Then
the system has a (unique) solution in An with coordinates in m.
Corollary 4.6 The morphism A → AJf1 ,...,fn K is faithfully flat. In particular it is
injective and the divisibility relation is faithfully extended from A to AJf1 ,...,fn K .
Proof. It is sufficient to prove the assertions for AJf K with a monic polynomial f .
Since AJf K is a localization of a free A-algebra, it is flat over A. As AJf K /MAJf K =
A/M the morphism A → AJf K is local, hence faithfully flat. So for a, b ∈ A, a divides
b in A iff a divides b in AJf K .

4.3

Proof of the Multivariate Hensel Lemma

We begin by a slight transformation or our polynomial system in order to being able
to get the hypotheses of ZMT for the ring associated to the new system.
Proposition 4.7 Let a polynomial system
f1 (X1 , . . . , Xn ) = · · · = fn (X1 , . . . , Xn ) = 0

(∗)

which has a residually simple zero at (0, . . . , 0). We use preceeding notations for B
and MB .
One can find fn+1 (X1 , . . . , Xn , Xn+1 ) ∈ A[X1 , . . . , Xn+1 ] such that for the new system
f1 (X1 , . . . , Xn ) = · · · = fn (X1 , . . . , Xn ) = fn+1 (X1 , . . . , Xn , Xn+1 ) = 0

(∗∗)

we have again fn+1 (0, . . . , 0) ∈ M, with Jacobian J 0 (0, . . . , 0) invertible and if we
call
B 0 = A[x1 , . . . , xn , xn+1 ] = A[X1 , . . . , Xn , Xn+1 ]/hf1 , . . . , fn+1 i

Alonso M., Coquand T., Lombardi H.

15

then x1 , . . . , xn , xn+1 ∈ MB 0 (this means MB 0 = MB 0 ), and the natural morphism
0
BMB → BMB
0 is an isomorphism.
In short with the new system we have x1 , . . . , xn+1 ∈ MA[x1 , . . . , xn+1 ] and
AJf1 ,...,fn K = AJf1 ,...,fn+1 K .
Proof. Applying Lemma 4.1 to the residual system we get e(X1 , . . . , Xn ) such that
in k[x1 , . . . , xn ] we have e2 = e, exi = 0. So if we consider the localization
B[1/e] we get residually k[x1 , . . . , xn , 1/e] = k, more precisely e = 1 and xi = 0
in k[x1 , . . . , xn , 1/e]. In other words if we introduce a new variable T and the
equation T e(X1 , . . . , Xn ) = 1 we get a new polynomial system which has residually only one zero (0, . . . , 0, 1). In order to get a Hensel system we introduce
the variable Xn+1 (= 1 − T ) with the equation 1 − (1 − Xn+1 )e(X1 , . . . , Xn ), and
(0, . . . , 0) is the unique residual zero. Moreover if we call J 0 (x1 , . . . , xn+1 ) the Jacobian of the new system in B 0 then J 0 (x1 , . . . , xn+1 ) = Jf (x1 , . . . , xn )e(x1 , . . . , xn )
and J 0 (0, . . . , 0) = Jf (0, . . . , 0) mod M is invertible.
NB: Let us note that there is a little abuse of notations: we have e(x1 , . . . , xn ) = 1 in
k[x1 , . . . , xn+1 ] = B 0 /MB 0 but in general e(x1 , . . . , xn ) 6= 1 in k[x1 , . . . , xn ] = B/MB ,
meaning that the morphism k[x1 , . . . , xn ] → k[x1 , . . . , xn+1 ] is not injective. It would
be necessary to change the names of the xi ’s when changing the ring!

In the following we assume w.l.o.g. that the system (∗) satisfies x1 , . . . , xn ∈ MB.
Applying Theorem 1.3 to B = A[x1 , . . . , xn ], M ⊆ A and x1 , . . . , xn ∈ MB (so
B/MB = A/M) we get an s ∈ 1 + MB such that s, sx1 , . . . , sxn are integral over
A. So s = S(x1 , . . . , xn ), where S ∈ 1 + MA[X1 , . . . , Xn ]). We are going to prove
the following proposition, which clearly implies Theorem 4.4 if the given polynomial
f is monic.
Proposition 4.8 We can construct a polynomial h(T ) ∈ A[T ] such that h(s) = 0,
h0 (s) ∈ 1 + MB (more precisely, h(T ) = T N (T − 1) modulo MA[T ]), the xi are
expressed as rational fractions in s with denominator in 1 + M + (s − 1)A[s], and
letting f (X) = h(1 + X), the natural morphism AJf K → B1+MB = AJf1 ,...,fn K sending
x to s − 1 is an isomorphism.
Proof. Let D = A[s, sx1 , . . . , sxn ] and therefore we have A ⊆ A[s] ⊆ D ⊆ B. We
call m0 = 1, m1 , . . . , m` monomials in the (sxi )’s such that m0 , . . . , m` generate D
as an A[s]-module and we can also assume that mi = sxi for i = 1, . . . , n. We have
D = A[s] + m1 D + · · · + m` D.
Let MD = MB ∩ D and MA[s] = MB ∩ A[s].
Since m1 , . . . , m` ∈ MD we have MD = MA[s] + m1 D + · · · + m` D.
As s−1 ∈ MA[s] and A[s] = A[s−1] = A+(s−1)A[s] we have MA[s] = M+(s−1)A[s].
Notice that for all v ∈ B there exists an exponent r such that sr v ∈ D. Moreover
if v ∈ MB, there exists an exponent r such that sr v ∈ MD. In particular, since
mj ∈ MB there exists an exponent r0 such that all sr0 mj ∈ MD (j = 1, . . . , `).
We write this fact as
X

`
sr0 mj =
µij (s)mi + µ0j (s)
i=1

16

Revisiting Zariski Main Theorem

where µij (s) ∈ MA[s] for all i, j.
Let M (s) = (µij (s))1≤i,j≤` . We have then


 

µ01 (s)
m1
m1
.
.
sr0  ..  = M (s)  ..  +  ...  .


m`

m`

µ0` (s)

Let d(T ) = det(T r0 I` − M (T )), multiplying by the adjoint matrix P (s) we get



µ01 (s)
m1
.
d(s)  ..  = P (s)  ...  ∈ M`,1 (MA[s]).


m`

µ0` (s)

Summing up. We have found a polynomial d(T ) ∈ A[T ] such that:
i) d(T ) = T N modulo MA[T ] for some N , and so d(s)sr ∈ 1 + MA[s] for all
r ≥ 0,
ii) one has d(s)mj = νj (s) ∈ MA[s], this implies d(s)MD ⊆ MA[s] ,
iii) given an arbitrary v ∈ MB one has an exponent r such that sr d(s)v ∈
MA[s],
Let q be an exponent such that sq d(s)(s − 1) ∈ MA[s] and let us define h(T ) =
d(T )T q (T − 1) − µ(T ) ∈ A[T ]. So h(s) = 0 and h(T ) = T N +q (T − 1) modulo MA[T ].
Notice that h0 (1) ∈ 1 + M, which implies that s is a root of h(T ) which is residually
simple.
Now we finish the proof of Proposition 4.8 using the following general lemma.
Lemma 4.9 Let h(T ) ∈ A[T ] such that h(s) = 0 and h0 (1) ∈ 1 + M.
Let us set f (X) = h(1 + X), A[x] = A[X]/hf (X)i, t = 1 + x, AJf K = A[x]1+M+xA[x] .
Let θ : AJf K → B1+MB = AJf1 ,...,fn K be the natural morphism sending x to s − 1 (and
t to s) given by the universal property of AJf K .
Then θ is in fact an isomorphism.
Proof. In order to prove that θ is an isomorphism, it is sufficient to find a zero
(z1 , . . . , zn ) of the system (∗) in AJf K with coordinates zi in the maximal, and such
that
– θ(zi ) = xi for each i,
– the natural morphism B1+MB → AJf K sending (x1 , . . . , xn ) to (z1 , . . . , zn ) sends
s to t.
We have d(s)sxi = νi (s) where νi (T ) ∈ MA[T ]. We let q(T ) = T d(T ).
We have q(T ) ∈ T N +1 + MA[T ], t ∈ 1 + MAJf K and q(t) ∈ 1 + MAJf K . We let
zi = νi (t)/q(t) ∈ MAJf K
and we get θ(zi ) = νi (s)/q(s) = xi for each i.
Let
I = hf1 (z1 , . . . , zn ), . . . , fn (z1 , . . . , zn )i
as ideal of AJf K . We get I ⊆ MAJf K .

Alonso M., Coquand T., Lombardi H.

17

We are going to show that I = I2 , so I ⊆ I M0 , where M0 = MAJf K + xAJf K is the
maximal ideal of AJf K . This implies I = 0 by Nakayama’s Lemma. This will show
that (z1 , . . . , zn ) is a zero of (∗) with coordinates in M0 .
By Newton process we can construct a zero modulo I2 , let us call it (y1 , . . . , yn ).
The system (∗) has the zero (y1 , . . . , yn ) residually null in the local ring AJf K /I2 . By
the universal property of AJf1 ,...,fn K there is a morphism λ : AJf1 ,...,fn K → AJf K /I2
sending xi to yi .
We let y = S(y1 , . . . , yn ), so λ(s) = y mod I2 , h(y) = λ(h(s)) mod I2 , i.e. h(y) =
0 mod I2 .
Since h(t) = 0, h0 (t) ∈ AJf K × , t = y = 1 mod M0 we write
h(y) = h(t) + (t − y)(h0 (t) + (t − y)h1 (t, y)),

we have h0 (t) + (t − y)h1 (t, y) ∈ AJf K × and we get t − y ∈ I2 .
We have 0 = λ(q(s)xi − νi (s)) = q(y)yi − νi (y) in AJf K /I2 , q(y)yi − q(t)yi ∈ I2 and
νi (t) − νi (y) ∈ I2 , so q(t)yi − νi (t) ∈ I2 , i.e. yi = zi mod I2 . Finally
0 = λ(fi (x1 , . . . , xn )) = fi (y1 , . . . , yn ) = fi (z1 , . . . , zn ) mod I2 .
This shows that I ⊆ I2 , so I = 0. Now, since (z1 , . . . , zn ) is a zero of (∗) residually
null in AJf K , by the universal property of AJf1 ,...,fn K we can see λ as a morphism from
AJf1 ,...,fn K to AJf K sending xi to yi = zi .
Finally, we show that λ(s) = t. This follows from h(λ(s)) = λ(h(s)) = 0 and
s ∈ 1 + MA[x1 , . . . , xn ] in B which implies λ(s) ∈ 1 + MA[y1 , . . . , yn ] ⊆ 1 + MAJf K
so h0 (λ(s)) ∈ 1 + MAJf K .
In order to get Theorem 4.4 from Proposition 4.8 we use the following lemma.
Lemma 4.10 (see [1, Lemma 5.3])
Let (A, M) be a local ring, f (X) = an X n +· · ·+a1 X +a0 , with a1 ∈ A× and a0 ∈ M.
There exists a monic polynomial g(X) ∈ A[X], g(X) = X n + · · · + b1 X + b0 , with
b1 ∈ A× and b0 ∈ M, such that the following equality holds in A(X) (the Nagata
localization of A[X]):


−a0 a−1
n
1
a0 · g(X) = (X + 1) f
.
X +1
Moreover AJf K is isomorphic to AJgK .
Proof. We have




Pn
−a0 a−1
n − X n−1 + a
j a aj−2 a−j X n−j
1
X nf
=
a
·
X
(−1)
0
0
j
0
1
j=2
X
= a0 h(X)
with
h(X) = X n − X n−1 + a0

n
X
−j n−j
(−1)j aj aj−2
= X n − X n−1 + a0 `(X)
0 a1 X
j=2

We let g(X) = h(X + 1) = X n + · · · + b1 X + b0 . It is a monic polynomial, with
constant term b0 = g(0) = h(1) = a0 `(1) ∈ M, and linear term b1 = g 0 (0) = h0 (1) =
1 + a0 `0 (1) ∈ 1 + M.

18

4.4

Revisiting Zariski Main Theorem

An example of Multivariate Hensel Lemma

In this section we analyse an example where A is the local ring Q[a, b]S , S being the
monoid of elements p(a, b) ∈ Q[a, b] such that p(0, 0) 6= 0. We take next B = A[x, y]
where x, y are defined by the equations
−a + x + bxy + 2bx2 = 0,

− b + y + ax2 + axy + by 2 = 0

We shall compute s ∈ B integral over A such that sx, sy integral over B and s = 1
mod. MB.
Following the proof we apply Proposition 3.2 and we take t = 1+ax+by. We have
that t = 1 mod. MB and t, ty integral over A[x]. We have even ty = y + axy + by 2 =
b − ax2 in A[x]. The equation for t is
t2 − (1 + ax)t − b + ax2
We have then
tx = x + ax2 + bxy = a + (a − 2b)x2 .
Notice that we are now in the situation of the proof of Proposition 2.17 with
Q(X, T ) = T X − (a + (a − 2b)X 2 ). Since Q has degree 1 we get without extra
work and so
(t − (a − 2b)x)x = a
If we take w = t − (a − 2b)x = 1 + 2bx + by we have w = 1 mod. MB and wx in A
and w is integral over A. Indeed w is integral over A[1/w] since x is in A[1/w] and
w is integral over A[x].
If we take u = tw2 we have u, ux, uy integral over A. Indeed, wx is in A and
since t2 − (1 + ax)t − b + ax2 = 0 we have tw and hence u integral over A. Since
ty = b − ax2 we have uy = bw2 − a(wx)2 integral over A. Finally ux = (tw)(wx) is
integral over A.
It can be checked that u is a root of a monic polynomial f of degree 4 of the form
U 3 (U − 1) residually.
−u4 + (1 + 4 a b + a2 + 3 b2 ) u3
+b (b5 + 8 a b4 + 7 a2 b3 − a3 b2 − 4 b a4 + a5 − 6 a2 b − a3 + 4 a b2 ) u2
−a2 b2 (a − b) (a + 2 b) (2 b2 − 9 a b + a2 ) u + a4 b3 (a − 4 b) (a + 2 b)2 (a − b)2 = 0

5

Structure of quasi finite algebras

Let us recall that in classical mathematics an A-algebra B is said to be quasi-finite
if it is of finite type and if prime ideals of B lying over any prime ideal of A are
incomparable.
This last requirement means that the morphism A → B is zero-dimensional.
A constructive characterization of zero-dimensional morphisms uses the zerodimensional reduced ring A• generated by A.
A zero-dimensional reduced ring is characterized by the fact that every element
a possesses a quasi inverse: an element b such that a2 b = a and b2 a = b. Such a
ring is also said to be Von Neuman regular or absolutely flat. The element ab is
an idemptent ea . In the component A[1/ea ], a is invertible, and a = 0 in the other
component A/hea i.

Alonso M., Coquand T., Lombardi H.

19

From an algorithmic point of view this implies that algorithms for discrete fields
are easily transformed in algorithms for zero-dimensional reduced rings (for more
details see [14, Chapter 4]).
The ring A• can be obtained as a direct limit of rings
A[a•1 , a•2 , . . . , a•n ] ' (A[T1 , T2 , . . . , Tn ]/a)red
with a = h(ai Ti2 − Ti )ni=1 , (Ti a2i − ai )ni=1 i (for more details see [14, section 11.4]).
The direct limit is along the p.o. set of finite sequences of elements of A, ordered by (a1 , . . . , an )  (b1 , . . . , bm ) iff one has (for each i) bki = ai for some map
k

{1, . . . , n} −→ {1, . . . , m}.
In classical mathematics we obtain the following equivalence.
Proposition 5.1 Let ϕ : A → B a morphism of commutative rings.
1. Prime ideals of B lying over any prime ideal of A are incomparable.
2. The ring A• ⊗A B is a zero-dimensional ring.
The morphism A → B is not required to be injective, but the proposition involves
only the structure of B as ϕ(A)-algebra.
The second item is taken to be the correct definition of zero-dimensional morphisms in constructive mathematics.
This gives also a good definition of quasi-finite morphisms in constructive mathematics: indeed a quasi-finite A-algebra is an algebra B of finite type such that the
structure morphism A → B is zero-dimensional.
We have the following concrete characterization of zero-dimensional morphisms
for algebras of finite type.
Proposition 5.2 Let B be an A-algebra of finite type. The following are equivalent.
1. The structure map A → B is a zero dimensional morphism.
2. There exist a1 , . . . , ap ∈ A such that for each I ⊆ {1, . . . , p}, if we leth I 0 =i

Q
{1, . . . , p} \ I, aa,I = hai , i ∈ Ii, αa,I 0 = i∈I 0 ai and A(a,I) = A/aa,I α 1 0
a,I
then the ring B(a,I) is integral over A(a,I) .
Let us insist here on the fact that the equivalence in Proposition 5.2 has a constructive proof.
Theorem 5.3 (ZMT à la Raynaud, [15])
Let A ⊆ B = A[x1 , . . . , xn ] be rings such that the inclusion morphism A → B is zero
dimensional (in other words, B is quasi-finite over A). Let C be the integral closure
of A in B. Then there exist elements s1 , . . . , sm in C, comaximal in B, such that all
si xj ∈ C.
In particular for each i, C[1/si ] = B[1/si ]. Moreover letting C 0 = A[(si ), (si xj )],
which is finite over A, we get also C 0 [1/si ] = B[1/si ] for each i.

20

Revisiting Zariski Main Theorem

Proof. The concrete hypothesis is item 2. in Proposition 5.2. We have to find
elements s1 , . . . , sm integral over A, comaximal in B, such that all si xj are integral
over A.
The proof is by induction on p, the case p = 0 being trivial (in this case B is finite
over A by hypothesis).
Assume we have the conclusion for p − 1 and let a = ap . The induction hypothesis
is applied to the morphisms A/aA → B/aB and A[1/a] → B[1/a].
First we get s1 , . . . , sm integral over A/aA, comaximal in B/aB with all si xj integral
over A/aA. Let B 0 = A[(si ), (si xj )] (1 ≤ i ≤ m, 1 ≤ j ≤ n). Applying Theorem 1.3
to A ⊆ B 0 and I = aA we obtain w ∈ 1 + aB 0 such that all wsi ’s and wsi xj ’s are
integral over A.
Second, we get t1 , . . . , tq integral over A[1/a], comaximal in B[1/a] with all ti xj
integral over A[1/a]. This gives, for N big enough, aN ∈ ht1 , . . . , tq iB and all aN ti ’s
and aN ti xj ’s integral over A.
Since 1 ∈ hs1 , . . . , sm , aiB and 1 ∈ hw, aiB, we have
1 ∈ hws1 , . . . , wsm , a2N iB ⊆ hws1 , . . . , wsm , aN t1 , . . . , aN tq i.
So we have our conclusion with the family (ws1 , . . . , wsm , aN t1 , . . . , aN tq ).

References
[1] M. Alonso, H. Lombardi, H. Perdry. Elementary Constructive Theory of
Henselian Local Rings. Math. Logic Quarterly 54 (3), (2008), 253–271. 2, 17
[2] M. Atiyah, L. MacDonald. Introduction to Commutative Algebra. Addison
Wesley series in Mathematics, (1969). 5
[3] S. Basu, R. Pollack & M.-F. Roy Algorithms in Real Algebraic Geometry.
Springer-Verlag. 2nd edition (2006). 9
[4] E. Bishop, D. Bridges. Constructive Analysis. Springer-Verlag (1985). 2
[5] D. Bridges, F. Richman. Varieties of Constructive Mathematics. London
Math. Soc. LNS 97. Cambridge University Press (1987). 2
[6] T. Coquand. On seminormality. J. Algebra, 305, (2006), 577–584. 2
[7] T. Coquand. Space of valuations. Ann. Pure Appl. Logic, 157, (2009), 97–109.
2
[8] T. Coquand, H. Lombardi, C. Quitté. Generating non noetherian modules
constructively. Manuscripta Math., 115, (2004), 513–520. 2
[9] T. Coquand, C. Quitté. Constructive finite free resolutions. Manuscripta
Math., 137, (2012), 331–345. 2
[10] T. Coquand, H. Lombardi, P. Schuster Spectral schemes as ringed lattices.
Ann. Math. Artif. Intell., 56, (2009), 339–360. 2
[11] L. Ducos, H. Lombardi, C. Quitté , M. Salou. Théorie algorithmique
des anneaux arithmétiques, de Prüfer et de Dedekind. Journal of Algebra. 281,
(2004), 604–650. 2

Alonso M., Coquand T., Lombardi H.

21

[12] E. Hallouin. Parcours initiatique à travers la théorie des valuations. technical
report. Université de Poitiers, (1997). 5
[13] A. Grothendieck. Éléments de Géométrie Algébrique IV. 2
[14] H. Lombardi, C. Quitté. Commutative Algebra, Constructive Methods. Algebra and Applications, Vol. 20. Berlin, New-York: Springer. (Revised and expanded.) Translated from the French by Tania K. Roblot. Algèbre Commutative,
Méthodes Constructives. Calvage & Mounet, (2011). 2, 12, 19
[15] M. Raynaud. Anneaux locaux henséliens. Springer Lecture Notes in Mathematics No 169, (1970). 2, 4, 19
[16] R. Mines, F. Richman and W. Ruitenburg. A Course in Constructive
Algebra. Springer-Verlag, (1988) 2
[17] C. Peskine. Une généralization du “main theorem” de Zariski. Bull. Sci. Math.
(2) 90 (1966) 119–127. 2
[18] C. Peskine. An Algebraic Introduction to Complex Projective Geometry: Commutative Algebra. Cambridge University Press, (1996). 3
[19] I. Yengui. Making the use of maximal ideals constructive. Theoret. Comput.
Sci., 392, (2008), 174–178. 2
[20] O. Zariski. Analytical irreducibility of normal varieties. Annals of Math. 49
(1948) 352–361. 2

