arXiv:1609.09283v3 [math.PR] 30 Oct 2017

Modern Stochastics: Theory and Applications 4 (3) (2017) 189–198
DOI: 10.15559/17-VMSTA82

The self-normalized Donsker theorem revisited
Peter Parczewski
University of Mannheim, Institute of Mathematics A5,6,
D-68131 Mannheim, Germany
parczewski@math.uni-mannheim.de (P. Parczewski)
Received: 18 May 2017, Revised: 9 August 2017, Accepted: 9 August 2017,
Published online: 18 September 2017

Abstract We extend the Poincaré–Borel lemma to a weak approximation of a Brownian
motion via simple functionals of uniform distributions on n-spheres in the Skorokhod space
D([0, 1]). This approach is used to simplify the proof of the self-normalized Donsker theorem
in Csörgő et al. (2003). Some notes on spheres with respect to ℓp -norms are given.
Keywords Poincaré–Borel lemma, Brownian motion, Donsker theorem, self-normalized
sums
2010 MSC 60F05, 60F17

1

Introduction

Let S n−1 (d) = {x ∈ Rn : kxk = d} be the (n − 1)-sphere with radius d, where
k · k denotes the Euclidean norm. The uniform measure on the unit sphere S n−1 :=
S n−1 (1) can be characterized as
d

µS,n =

(X1 , . . . , Xn )
,
k(X1 , . . . , Xn )k

(1)

where (X1 , . . . , Xn ) is a standard n-dimensional normal random variable.
The celebrated Poincaré–Borel lemma is the classical result on the approximation
√
of a Gaussian distribution by projections of the uniform measure on S n−1 ( n) as n
n
m
tends to infinity: Let n ≥ m and πn,m
be the natural projection. The
√:R →R √
uniform measure on the sphere S n−1 ( n) is given by n µS,n . Then, for every fixed
m ∈ N,
√
−1
nµS,n ◦ πn,m
© 2017 The Author(s). Published by VTeX. Open access article under the CC BY license.

www.i-journals.org/vmsta

190

P. Parczewski

converges in distribution to a standard m-dimensional normal distribution as n tends
to infinity, cf. [11, Proposition 6.1]. Following the historical notes in [6, Section 6]
on the earliest reference to this result by Émile Borel, we acquire the usual practice
to speak about the Poincaré–Borel lemma.
Among other fields, this convergence stimulated the development of the infinitedimensional functional analysis (cf. [12]) as well as the concentration of measure
theory (cf. [10, Section 1.1]).
In particular, it inspired to consider connections of the Wiener measure and the
uniform measure on an infinite-dimensional sphere [21]. Such a Donsker-type result
is firstly proved in [4] by nonstandard methods. For the illustration, we make use of
the notations in [7], where this result is used for statistical analysis of measures on
high-dimensional unit spheres. Define the functional


Qn,2 : S n−1 → C [0, 1] ,
(x1 , . . . , xn ) 7→ Qn,2 (t) t∈[0,1] ,
such that

Pk

xi
,
k(x1 , . . . , xn )k
for k ∈ {0, . . . , n} and is linearly interpolated elsewhere. Then [4, Theorem 2.4]
gives that the sequence of processes
Qn,2 (k/n) :=

i=1

µS,n ◦ Q−1
n,2

converges weakly to a Brownian motion W := (Wt )t∈[0,1] in the space of continuous
functions C([0, 1]) as n tends to infinity. The first proof without nonstandard methods
in C([0, 1]) and in the Skorohod space D([0, 1]) is given in [17].
In this note, we present a very simple proof of the càdlàg version of this Poincaré–
Borel lemma for Brownian motion. This is the content of Section 2.
Some remarks on such Donsker-type convergence results on spheres with respect
to ℓp -norms are collected in Section 3.
In fact, our simple approach can be used to simplify the proof of the main result
in [3] as well. This is presented in Section 4.
2

Poincaré–Borel lemma for Brownian motion

Suppose X1 , X2 , . . . is a sequence of i.i.d. standard normal random variables. Then
(X1 , . . . , Xn ) has a standard n-dimensional normal distribution. We define the processes with càdlàg paths
P⌊nt⌋


i=1 Xi
.
Z n = Ztn :=
k(X1 , . . . , Xn )k t∈[0,1]
−1

Thus, Z n is equivalent to µS,n ◦ Qn,2 for the functional


Qn,2 : S n−1 → D [0, 1] ,
(x1 , . . . , xn ) 7→ Qn,2 (t) =

P⌊nt⌋

xi
k(x1 , . . . , xn )k
i=1



t∈[0,1]

and therefore it is a relatively simple computation from the uniform distribution on
the n-sphere. Then the following extension of the Poincaré–Borel lemma is true:

,

191

The self-normalized Donsker theorem revisited

Theorem 1. The sequence (Z n )n∈N converges weakly in the Skorokhod space
D([0, 1]) to a standard Brownian motion W as n tends to infinity.
Proof. As the distribution of the random vector in (1) is exactly the uniform measure
µS,n , the proof of the convergence of finite-dimensional distributions
with
Pnis in line
1
2
the classical Poincaré–Borel lemma: by the law of large numbers,
X
→
1 in
i
i=1
n
√
probability. Hence, by the continuous mapping theorem, n/(k(X1 , . . . , Xn )k) → 1
in probability, and, by Donsker’s theorem and Slutsky’s theorem, we conclude the
convergence of finite-dimensional distributions.
For the tightness we consider the increments of the process Z n and make use of
a standard criterion. For all s ≤ t in [0, 1], we denote
P
P
2

⌊ns⌋<i≤⌊nt⌋ Xi
⌊ns⌋<i6=j≤⌊nt⌋ Xi Xj
n
n 2
P
P
Zt − Zs =
+
=: I1t,s + I2t,s . (2)
2
2
X
X
i
i
i≤n
i≤n

Due to the symmetry of the standard n-dimensional normally distributed vector
(X1 , . . . , Xn ), for all pairwise different i, j, k, l, we observe




Xi2 Xj Xk
Xi Xj Xk Xl
=E P
= 0.
(3)
E P
( i≤n Xi2 )2
( i≤n Xi2 )2
Let s ≤ u ≤ t in [0, 1]. Thus via (3), we conclude




E I2t,u I1u,s = 0,
E I1t,u I2u,s = 0,
and therefore



E I2t,u I2u,s = 0,


2

2 

E Ztn − Zun Zun − Zsn
= E I1t,u I1u,s .

We denote for shorthand m1 := ⌊nt⌋ − ⌊nu⌋, m2 := ⌊nu⌋ − ⌊ns⌋ and m3 :=
n − (⌊nt⌋ − ⌊ns⌋). Then we observe
I1t,u I1u,s =

(χ2m1

1
2
2 ((χm1

χ2m1 χ2m2
=
+ χ2m2 + χ2m3 )2

+ χ2m2 )2 − (χ2m1 )2 − (χ2m2 )2 )
,
(χ2m1 + χ2m2 + χ2m3 )2

for pairwise independent chi-squared random variables χ2m with m degrees of freeχ2m
dom. We recall that χ2 +χ
2 is Beta(m/2, k/2)-distributed with
m


E

k

χ2m
χ2m + χ2k

2 

=



m+2
m+k+2




m
.
m+k

(4)

Hence a computation via (4) yields


m1 m2
E I1t,u I1u,s =
(m1 + m2 + m3 + 2)(m1 + m2 + m3 )



m2
m1
,
≤
m1 + m2 + m3
m1 + m2 + m3
and therefore

2
2 
E Ztn − Zun Zun − Zsn
≤



⌊nt⌋ − ⌊nu⌋
n



⌊nu⌋ − ⌊ns⌋
n



192

P. Parczewski

≤



⌊nt⌋ − ⌊ns⌋
n

2

.

Thus the well-known criterion [1, Theorem 15.6] (cp. Remark 1 in [15]) implies
the tightness of Z n .
Remark 2. (i) The heuristic connection of the Wiener measure and the uniform measure on an infinite-dimensional sphere goes back to Norbert Wiener’s study of the
differential space, [21]. The first informal presentation of Theorem 1 and further historical notes can be found in [12]. The first rigorous proof is given in Section 2 of [4].
However, the authors make use of nonstandard analysis and the functional Qn,2 . To
the best of our knowledge, the first proof of Theorem 1 is [17]. In contrast, our proof
is based on the pretty decoupling in the tightness argument. Moreover, this approach
is extended in Section 4 to a simpler proof of Theorem 1 in [3].
(ii) According to the historical comments in [20, Section 2.2], the Poincaré–Borel
lemma could be also attributed to Maxwell and Mehler.
3

ℓn
p -spheres

In this section, we consider uniform measures on ℓnp -spheres and prove that the limit
in Theorem 1 is the only case such that a simple Q-type pathwise functional leads to
a nontrivial limit (Theorem 5).
Furthermore, we present random variables living on ℓnp -spheres, with a similar
characterization for a fractional Brownian
Pn motion (Theorem 6).
Concerning the ℓnp norm kxkp = ( i=1 |xi |p )1/p for p ∈ [1, ∞) and defining the
ℓnp unit sphere

	
Spn−1 := x ∈ Rn : kxkp = 1 ,
the uniform measure µS,n,p on Spn−1 is characterized similarly to the uniform measure on the Euclidean unit sphere by independent results in [18, Lemma 1] and [16,
Lemma 3.1]:
Proposition 3. Suppose X, X1 , X2 , . . . is a sequence of i.i.d. random variables with
density
exp(−|x|p /p)
.
f (x) = 1/p
2p Γ (1 + 1/p)
Then
d

µS,n,p =

(X1 , . . . , Xn )
.
k(X1 , . . . , Xn )kp

Remark 4. (i) We notice that the uniform measure on the ℓnp -sphere equals the surface measure only in the cases p ∈ {1, 2, ∞}, see e.g. [16, Section 3] or the interesting
study of the total variation distance of these measures for p ≥ 1 in [14].
(ii) In particular, we have a counterpart of the classical Poincaré–Borel lemma for
finite-dimensional distributions: For every fixed m ∈ N,
−1
n1/p µS,n,p ◦ πn,m

193

The self-normalized Donsker theorem revisited

converges in distribution to the random vector (X1 , . . . , Xm ) as n tends to infinity.
This follows immediately from E[|X|p ] = 1 and the law of large numbers, cf. [11,
Proposition 6.1] or the finite-dimensional convergence in Theorem 1.
Similarly to the characterization of the central limit theorem, cp. [9, Theorem 4.23], but in contrast to the convergence of the projection on a finite number of
coordinates in Remark 4, we have a uniqueness result for the processes constructed
according to the Q-type pathwise functionals.
d
In the following we denote the convergence in distribution by → and the almost
a.s.
sure convergence by → .

Theorem 5. Suppose p ≥ 1 and denote
Qn,p : (x1 , . . . , xn ) 7→



P⌊nt⌋

xi
k(x1 , . . . , xn )kp
i=1



.

t∈[0,1]

Then, in the Skorokhod space D([0, 1]), as n tends to infinity:
a.s.

 → 0,
−1
d
µS,n,p ◦ Qn,p →
W,


is divergent,

p < 2,
p = 2,
p > 2.

Proof. The strong law of large numbers [9, Theorem 4.23] implies that
n1/p /k(X1 , . . . , Xn )kp → 1 almost surely for all p ≥ 1. Moreover, for p < 2, it
1 P⌊nt⌋
gives as well that n1/p
i=1 Xi → 0 almost surely for all t ∈ [0, 1]. Thanks to
Proposition 3, we have
µS,n,p ◦

−1 d
Qn,p =

!
⌊n·⌋
X
n1/p
−1/p
Xi .
n
k(X1 , . . . , Xn )kp
i=1

Thus we conclude via n−1/p = n−1/2 n(p−2)/2p , Donsker’s theorem and Slutsky’s
theorem.
However, the ℓnp spheres can be involved in another convergence result. The fractional Brownian motion B H = (BtH )t≥0 with Hurst parameter H ∈ (0, 1) is a centered Gaussian process with the covariance E[BtH BsH ] = 21 (t2H + s2H − |t − s|2H ).
We refer to [13] for further information on this generalization of the Brownian motion beyond semimartingales. In particular, there is the following random walk approximation ([19, Theorem 2.1] or [13, Lemma 1.15.9]): Let {Xi }i≥1 be a stationary
Gaussian sequence with E[Xi ] = 0 and correlations
n
X

i,j=1

E[Xi Xj ] ∼ n2H L(n),

P⌊nt⌋
as n tends to infinity for a slowly varying function L. Then n2H1L(n) i=1 Xi converges weakly in the Skorohod space D([0, 1]) towards a fractional Brownian motion

194

P. Parczewski

H
with Hurst parameter H. For simplification let Xi = BiH − Bi−1
, i ∈ N, be the corH
related increments of the fractional Brownian motion B . The stationarity and the
ergodic theorem imply, for p > 0 and the constant cH := E[|B1H |1/H ], that


p > 1/H,
n
0,
X



p a.s.
(X1 , . . . , Xn ) /nH p = n−Hp
→
(5)
|X
|
cH
p = 1/H,
i
p


i=1
+∞, p < 1/H,

(see e.g. [13, Eq. (1.18.3)]). With this at hand, we obtain a similar uniqueness result:

H
Theorem 6. Let Xi = BiH −Bi−1
, i ∈ N, be the increments of a fractional Brownian
H
motion B . Then, in the Skorokhod space D([0, 1]), as n tends to infinity:
a.s.
p < 1/H,

P⌊nt⌋


 → 0,
d
i=1 Xi
H
H
Qn,p (X1 , . . . , Xn ) =
→ B /cH , p = 1/H,
k(X1 , . . . , Xn )kp t∈[0,1] 

is divergent, p > 1/H.

Proof. Taqqu’s limit theorem implies, for all H ∈ (0, 1),
⌊nt⌋

n

−H

X

Xi

i=1

!

d

t∈[0,1]

→ BH

in the Skorokhod space D([0, 1]). Then, thanks to (5), we conclude as in Theorem 5.
Remark 7. Due to the different correlations between the random variables Xi in
Theorem 6, there is no symmetric and trivial sequence of measures µ̂S,n,p on the
ℓnp -spheres and some simple Qn,p -type pathwise functionals, which represent the distributions of Qn,p (X1 , . . . , Xn ). However, it would be interesting, whether some uniform or surface measures on geometric objects in combination with simple Qp -type
pathwise functionals allow similar Donsker-type theorems for fractional Brownian
motion or other Gaussian processes?
4

The self-normalized Donsker theorem

Suppose X, X1 , X2 , . . . is a sequence of i.i.d. nondegenerate random variables and
we denote for all n ∈ N,
Sn :=

n
X
i=1

Xi ,

Vn2 :=

n
X

Xi2 .

i=1

Limit theorems for self-normalized sums Sn /Vn play an important role in statistics,
see e.g. [8], and have been extensively studied during the last decades, cf. the monograph on self-normalizes processes [5].
In [3], the following invariance principle for self-normalized sum processes is
established.

195

The self-normalized Donsker theorem revisited

Theorem 8 (Theorem 1 in [3]). Assume the notations above and denote
Ztn := S⌊nt⌋ /Vn .
Then the following assertions, with n tending to infinity, are equivalent:
(a) E[X] = 0 and X is in the domain of attraction of the normal law (i.e. there
d

exists a sequence (bn )n≥1 with Sn /bn → N (0, 1)).
d

(b) For all t0 ∈ (0, 1], Ztn0 → N (0, t0 ).
(c) (Ztn )t∈[0,1] converges weakly to (Wt )t∈[0,1] on (D([0, 1]), ρ), where ρ denotes
the uniform topology.
(d) On an appropriate joint probability space, the following is valid:

√ 
sup Ztn − W (nt)/ n = oP (1).
t∈[0,1]

Remark 9. The equivalence of (a) and (b) is the celebrated result [8, Theorem 3].
Since the implications (d) ⇒ (c) ⇒ (b) are trivial, the proof in [3] is completed by
showing (a) ⇒ (d).
Thanks to a tightness argument as in the proof of Theorem 1, we obtain a simpler
alternative for the proof.
Proof of Theorem 8. As stated in the remark, we already know that (d) ⇒ (c) ⇒
(b) ⇔ (a). We denote
(c0 ) (Ztn )t∈[0,1] converges weakly to (Wt )t∈[0,1] on the Skorokhod space D([0, 1]).
By the continuity of the paths of the Brownian motion and [1, Section 18], we obtain
the equivalence (c) ⇔ (c0 ). We denote by d0 the Skorokhod metric on D([0, 1])
which makes it a Polish space. The Skorokhod–Dudley Theorem [9, Theorem 4.30]
and (c0 ) imply


d0 Ztn t∈[0,1] , (Wt )t∈[0,1] → 0,

almost surely on an appropriate probability space. Since the uniform topology is finer
than the Skorokhod topology ([1, Section 18]), we conclude assertion (d). Thus it remains to prove (a) ⇒ (c0 ). Firstly we consider finite-dimensional distributions. Due
d
(bn )n∈N with Sn /bn → N (0, 1) fulfills Vn /bn → 1
to [8, Lemma 3.2], the sequence
√
in probability and bn = nL(n) for some slowly varying at infinity function L.
The continuous mapping theorem implies bn /Vn → 1 in probability. Take arbitrary
N ∈ N, a1 , . . . , aN ∈ R and t1 , . . . , tN ∈ [0, 1]. Without loss of generality, we assume t1 < · · · < tN and denote t0 := 0 and tN +1 := 1. Then, by the independence
of the random variables S⌊nti ⌋ − S⌊nti−1 ⌋ , i = 1, . . . , N + 1, for every fixed n ∈ N,
Lévy’s continuity theorem and the normality of the random vector (Y1 , . . . , YN +1 ),
we obtain


S⌊ntN +1 ⌋ − S⌊ntN ⌋
S⌊nt1 ⌋ − S⌊nt0 ⌋
d
p
,..., p
→ (Y1 , . . . , YN +1 ),
(⌊nt1 ⌋)
(⌊ntN +1 ⌋ − ⌊ntN ⌋)

196

P. Parczewski

as n tends to infinity. As the sequence (bn )n∈N is regularly varying with exponent
1/2, it is easily seen that
p
b⌊nti ⌋−⌊nti−1 ⌋
→ ti − ti−1 .
bn

Via the continuous mapping theorem, we conclude


N
+1 P
X
X S⌊nti ⌋
( j≤i aj )(b⌊nti ⌋−⌊nti−1 ⌋ ) S⌊nti ⌋ − S⌊nti−1 ⌋
ai
=
bn
bn
b⌊nti ⌋−⌊nti−1 ⌋
i=1
i

N
+1X
N
+1
X
X
p
d
d
aj
ai Wti .
→
ti − ti−1 Yi =
i=1

i=1

j≤i

Slutsky’s theorem implies
N
+1
X
i=1

ai Ztni =



bn
Vn

X
i

ai

S⌊nti ⌋
bn



d

→

N
+1
X

ai Wti ,

i=1

what means the convergence of finite-dimensional distributions.
The tightness follows again by the criterion [1, Theorem 15.6]. By the identical
distribution, for all m ≤ n, we have




 P
2 2 
mX14
m(m − 1)X12 X22
i≤m Xi
P
=E P
+E
.
(6)
E P
2
( i≤n Xi2 )2
( i≤n Xi2 )2
i≤n Xi

Thanks to the value 1 on the left hand side in (6) for m = n, we conclude


X 2X 2
1
0 ≤ E P 1 22 2 ≤
.
( i≤n Xi )
n(n − 1)

In contrast to (3), for possibly nonsymmetric random variables, the Cauchy–Schwarz
inequality and [8, (3.10)] yields a constant cX < ∞ such that for every r ∈ {2, 3, 4},


|Xi Xj Xk Xl |
max E P
≤ cX n−r .
(7)
i,j,k,l≤n
( i≤n Xi2 )2
|{i,j,k,l}|=r

Applying the estimates in (7) on the terms in (2) gives that

2


⌊nt⌋ − ⌊ns⌋
max E Iit,u Iju,s ≤ cX
.
n
i,j∈{1,2}

(8)

Hence, we obtain


2
 n

 
 t,u t,u  u,s u,s 
⌊nt⌋ − ⌊ns⌋
n 2
n
n 2
E Zt −Zu
Zu −Zs
≤ 4cX
I1 +I2
= E I1 +I2
,
n

and the proof concludes as in Theorem 1.

Remark 10. (i) By the same reasoning, we obtain Theorem 5 for the sequence of
i.i.d. variables X, X1 , X2 , . . . such that Theorem 8 (a) is fulfilled.
(ii) In [2], a similar counterpart of Theorem 8 for α-stable Lévy processes is established. An interesting question would be on a uniqueness result similar to Theorem 5.

The self-normalized Donsker theorem revisited

197

Acknowledgments
The author thanks the anonymous referees for careful reading and helpful comments.
References
[1] Billingsley, P.: Convergence of Probability Measures. Wiley, New York (1968).
MR0233396
[2] Csörgő, M., Hu, Z.: Weak convergence of self-normalized partial sums processes. In:
Asymptotic Laws and Methods in Stochastics. Fields Inst. Commun., 76, pp. 3–15.
Springer (2015). MR3409822. doi:10.1007/978-1-4939-3076-0_1
[3] Csörgő, M., Szyszkowicz, B., Wang, Q.: Donsker’s theorem for self-normalized partial
sums processes. Ann. Probab. 31 (3), 1228–1240 (2003). MR1988470. doi:10.1214/aop/
1055425777
[4] Cutland, N., Ng, S.-A.: The wiener sphere and wiener measure. Ann. Probab. 21 (1), 1–13
(1993). MR1207212
[5] de la Peña, V.H., Lai, T.L., Shao, Q.-M.: Self-normalized Processes. Springer, Berlin
(2009). MR2488094. doi:10.1007/978-3-540-85636-8
[6] Diaconis, P., Freedman, D.: A dozen de finetti-style results in search of a theory. Ann.
Inst. Henri Poincaré Probab. Stat. 23 (2), 397–423 (1987). MR0898502
[7] Dryden, I.L.: Statistical analysis on high-dimensional spheres and shape spaces. Ann.
Stat. 33 (4), 1643–1665 (2005). MR2166558. doi:10.1214/009053605000000264
[8] Giné, E., Götze, F., Mason, D.M.: When is the student t-statistic asymptotically standard normal? Ann. Probab. 25, 1514–1531 (1997). MR1457629. doi:10.1214/aop/
1024404523
[9] Kallenberg, O.: Foundations of Modern Probability. Second Edition. Probability and
Its Applications. Springer, New York (2002). MR1876169. doi:10.1007/978-1-47574015-8
[10] Ledoux, M., Talagrand, M.: Probability in Banach Spaces. Springer, Berlin (1991).
[11] Lifshits, M.: Lectures on Gaussian Processes. Springer, New York (2012). MR3024389.
doi:10.1007/978-3-642-24939-6
[12] McKean, H.P.: Geometry of differential space. Ann. Probab. 1 (2), 197–206 (1973).
MR0353471
[13] Mishura, Y.: Stochastic Calculus for Fractional Brownian Motion and Related Processes.
Springer, Berlin (2008). MR2378138. doi:10.1007/978-3-540-75873-0
[14] Naor, A., Romik, D.: Projecting the surface measure of the sphere of ℓn
p . Ann. Inst.
Henri Poincaré Probab. Stat. 39 (2), 241–261 (2003). MR1962135. doi:10.1016/S02460203(02)00008-0
[15] Parczewski, P.: A fractional donsker theorem. Stoch. Anal. Appl. 32 (2), 328–347 (2014).
MR3177074. doi:10.1080/07362994.2013.866521
[16] Rachev, S.T., Rüschendorf, L.: Approximate independence of distributions on spheres
and their stability properties. Ann. Probab. 19 (3), 1311–1337 (1991). MR1112418
[17] Račkauskas, A., Suquet, C.: Convergence of self-normalized partial sums processes in
c[0, 1] and d[0, 1]. Publications IRMA de Lille 53 - VI (2000).
[18] Schechtman, G., Zinn, J.: On the volume of the intersection of two lpn balls. Proc. Am.
Math. Soc. 110 (1), 217–224 (1990). MR1015684. doi:10.2307/2048262

198

P. Parczewski

[19] Taqqu, M.S.: Weak convergence to fractional brownian motion and to the rosenblatt
process. Z. Wahrscheinlichkeitstheor. Verw. Geb. 31, 287–302 (1975). MR0400329.
doi:10.1007/BF00532868
[20] Vershik, A.M.: Does a lebesgue measure in an infinite-dimensional space exist? Tr. Mat.
Inst. Steklova 259, 256–281 (2007). MR2433687. doi:10.1134/S0081543807040153
[21] Wiener, N.: Differential space. J. Math. Phys. 2, 132–174 (1923).

