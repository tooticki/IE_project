Removal and stability for Erdős–Ko–Rado
Shagnik Das

∗†

Tuan Tran

∗‡

arXiv:1412.7885v3 [math.CO] 9 Mar 2016

March 10, 2016

Abstract
A k-uniform family of subsets of [n] is intersecting if it does not contain a disjoint pair of
sets. The study of intersecting families is central to extremal set theory, dating back to the
seminal Erdős–Ko–Rado theorem of 1961 that bounds the size of the largest such families. A
recent trend has been to investigate the structure of set families with few disjoint pairs. Friedgut
and Regev proved a general removal lemma, showing that when γn ≤ k ≤ ( 21 − γ)n, a set family
with few disjoint pairs can be made intersecting by removing few sets.
We provide a simple
proof of a removal lemma for large families, showing that families of

size close to ℓ n−1
with
relatively few disjoint pairs must be close to a union of ℓ stars. Our
k−1
lemma holds for a wide range of uniformities; in particular, when ℓ = 1, the result holds for all
2 ≤ k < n2 and provides sharp quantitative estimates.
We use this removal lemma to answer a question of Bollobás, Narayanan and Raigorodskii
regarding the independence number of random subgraphs
of the Kneser graph K(n, k). The

Erdős–Ko–Rado theorem shows α(K(n, k)) = n−1
.
For
some
constant c > 0 and k ≤ cn, we
k−1
determine the sharp threshold for when this equality holds for random subgraphs of K(n, k),
and provide strong bounds on the critical probability for k ≤ 21 (n − 3).

1

Introduction

Extremal set theory, with its many connections and applications to other areas, has experienced
remarkable growth in recent decades. Inspired by one of the cornerstones of the field, the celebrated
Erdős–Ko–Rado theorem of 1961, a great deal of research concerns intersecting families. We say a
family of sets is intersecting if it does not contain a pair of disjoint sets. In this paper we derive
a stability result for large families that are nearly intersecting, and apply it to obtain a sparse
extension of the Erdős–Ko–Rado theorem. We begin with a brief survey of relevant results.

1.1

Intersecting families and stability

We restrict our attention to k-uniform families of subsets of [n]. The natural extremal question is
to ask how large such
 a family can be if it is intersecting. When n < 2k, there are no two disjoint
sets, and hence [n]
itself is intersecting. For n ≥ 2k, a natural construction is to take all sets
k
∗

Freie Universität Berlin, Institut für Mathematik, Arnimallee 3, 14195 Berlin, Germany.
shagnik@mi.fu-berlin.de
‡
tuan@math.fu-berlin.de. Research supported by DFG within the Research Training Grant “Methods for Discrete Structures”.
†

1


containing some fixed element i ∈ [n]. This family, called the star with centre i, contains n−1
k−1
sets, and Erdős, Ko and Rado [11] showed this is best possible.
Given the extremal result, great efforts have been made to better understand the general structure of large intersecting families. Hilton and Milner [20] determined the size of the largest intersecting family that is not a subset of a star, before Frankl [13] extended this to determine the size
of the largest intersecting family not containing too large a star.
In the years since these initial papers appeared, a series of stability results have been obtained.
Friedgut [14] and Dinur and Friedgut [10] used spectral techniques to show, provided k ≤ ( 21 − γ)n

for some γ > 0, any intersecting family of size close to n−1
k−1 is almost entirely contained in a star.
Keevash and Mubayi [23] and Keevash [22] combined these methods with combinatorial arguments
to provide similar results when k is close to 12 n.
However, a recent trend in extremal set theory is to go beyond the Erdős–Ko–Rado threshold
and study set families that may not be intersecting, but contain few disjoint pairs. Das, Gan and
Sudakov [7] studied the supersaturation problem, determining the minimum number of disjoint
pairs appearing in sufficiently sparse k-uniform families. Furthermore, a probabilistic variant of
this supersaturation problem was introduced by Katona, Katona and Katona [21], and further
studied by Russell [25], Russell and Walters [26] and Das and Sudakov [8].
Another direction that has been pursued is the transferral of the Erdős–Ko–Rado theorem to the
sparse random setting. This study was initiated by Balogh, Bohman and Mubayi [1], who asked
when the largest intersecting subfamily of a random k-uniform hypergraph is the largest star.
Progress on this problem has been made in subsequent papers by Gauy, Hàn and Oliveira [17],
Balogh, Das, Delcourt, Liu and Sharifzadeh [3] and Hamm and Kahn [18, 19]. An alternative
version of a sparse Erdős–Ko–Rado theorem, which we shall discuss in greater detail in Section 1.3,
was introduced by Bollobás, Narayanan and Raigorodskii [5].

1.2

Removal lemmas for disjoint pairs

As these new problems go beyond the Erdős–Ko–Rado threshold, we require more robust forms of
stability that apply not only to intersecting families, but also to families with few disjoint pairs.
This motivated the search for a removal lemma that would show one can remove few sets from
any family with a small number of disjoint pairs to obtain an intersecting family. Such a result
would be a set-theoretic analogue of the graph removal lemmas that have found a wide range of
applications in extremal graph theory, details of which are in the survey of Conlon and Fox [6].
Friedgut and Regev [16] proved the first such removal lemma, stated below.
Theorem 1.1 (Friedgut–Regev). Let γ > 0, and let k and n be positive integers satisfying

with at
γn ≤ k ≤ ( 21 − γ)n. Then for every ε > 0 there is a δ > 0 such that any family F ⊂ [n]
k
n−k 
n−1
most δ |F| k disjoint pairs can be made intersecting by removing at most ε k−1 sets from F.

This is a very general result that holds regardless of the size or structure of the nearest intersecting family.
However, for extremal applications, one is typically interested in the case when
n−1
|F| ≈ k−1 . For example, Gauy, Hàn and Oliveira required such a lemma in [17], coupling Theo
rem 1.1 with known stability results to show that a family of size close to n−1
k−1 with few disjoint
pairs must be close in structure to a star. They further asked if such a result also holds for k = o(n).
Our main theorem shows this is indeed the case. Theorem 1.2 provides a removal lemma that holds
whenever F has size close to a union of ℓ full stars and has relatively few disjoint pairs. Moreover,
when ℓ = 1, this holds for the full range of 2 ≤ k < n2 .
2

Theorem 1.2. There is an absolute constant
C > 1 such that if n, k and ℓ are positive inte[n]
2
gers satisfying n > 2kℓ , and F ⊂ k is a family of size |F| = (ℓ − α) n−1
k−1 with at most
 

ℓ
n−1 n−k−1
n−2k
disjoint pairs, where max (2ℓ |α| , |β|) ≤ (20C)2 n , then there is a family S
2 +β
k−1
k−1

n−1
n
that is the union of ℓ stars satisfying |F∆S| ≤ C((2ℓ − 1)α + 2β) n−2k
k−1 .

Another feature of Theorem 1.2 is that, despite its simple proof, it provides quantitative control
that is often sharp up to the constant. The distance from F to a union of ℓ stars is measured in
terms of its size (parametrised by α), the number of disjoint pairs (parametrised by β), and how
close k is to 21 n. When ℓ = 1, taking β = 0 gives a stability result for intersecting families, and the
bounds sharpen those given by Keevash and Mubayi [23] and Keevash [22].
For positive β, the bounds remain sharp up to the constant. If k is bounded away from n2 , then


one may take a star and add α n−1
sets from another star to obtain a family of size (1+α) n−1
with
k−1
k−1



n−1 n−k−1
n−1
α k−1 k−1 disjoint pairs that is α k−1 -far from a star. On the other hand, if t = n−2k = o(n),



 n−k−1
consider the anti-star [n−1]
. This has size 1 + kt n−1
, contains approximately nt n−1
k−1
k−1
k−1
k

disjoint pairs, and yet is approximately n−1
-far
from
a
star.
k−1
When ℓ ≥ 2, F is much larger than the Erdős–Ko–Rado bound, and hence we would expect
F to contain many disjoint pairs. Das, Gan and Sudakov [7]
shown that, provided n is suffi have
 n−k−1
ciently large, a union of ℓ stars, which has approximately 2ℓ n−1
disjoint pairs, minimises
k−1
k−1
the number of disjoint pairs in set families of this size. Theorem 1.2 provides stability for this
supersaturation result, showing that families of comparable size with a similar number of disjoint
pairs must be close in structure to a union of ℓ stars.
Finally, while we require n > 2k when ℓ = 1, we can do a bit better when ℓ is large: as ℓ tends
to infinity, the bound on n can be lowered to n > 21 + o(1) kℓ2 .

1.3

Erdős–Ko–Rado for sparse Kneser subgraphs

To demonstrate the usefulness of Theorem 1.2, we shall apply it to a problem of Bollobás, Narayanan
and Raigorodskii [5] regarding an extension of the Erdős–Ko–Rado theorem to the sparse random
setting. To define the problem at hand, we first need to introduce the Kneser graph and its
connection to the Erdős–Ko–Rado theorem.

Given integers 1 ≤ k ≤ 21 n, the Kneser graph K(n, k) is defined on the vertex set V = [n]
, with
k
[n]
two k-sets F, G ∈ k adjacent in K(n, k) if and only if F ∩ G = ∅. Since edges of K(n, k) denote

disjoint pairs in [n]
, it follows that independent sets of K(n, k) correspond directly to intersecting
k
[n]
families in k . Thus the Erdős–Ko–Rado theorem, viewed from the perspective of the Kneser

graph, shows α(K(n, k)) = n−1
k−1 when n ≥ 2k.
Bollobás, Narayanan and Raigorodskii [5] transferred the Erdős–Ko–Rado theorem to the random setting by considering not the entire Kneser graph K(n, k), but rather random subgraphs
of it. Given some probability 0 ≤ p ≤ 1, let Kp (n, k) denote the subgraph of K(n, k) where every edge is retained independently
 with probability p. As Kp (n, k) ⊆ K(n, k), we clearly have
n−1
α(Kp (n, k)) ≥ α(K(n, k)) = k−1 . They then asked for which p we have equality.
In their paper, they showed the Erdős–Ko–Rado theorem is surprisingly robust when
 k is not
too large with respect to n. In other words, we almost surely have α(Kp (n, k)) = n−1
k−1 even for
very small probabilities p (and thus very sparse subgraphs of K(n, k)). Furthermore, they exhibited
a sharp threshold for when this sparse Erdős–Ko–Rado theorem holds.
3

Theorem 1.3 (Bollobás–Narayanan–Raigorodskii). Fix ε > 0 and suppose 2 ≤ k = o(n1/3 ). Let
p0 =

(k + 1) log n − k log k
.
n−1
k−1

Then, as n → ∞,


P α(Kp (n, k)) =



n−1
k−1



→



0 if p ≤ (1 − ε)p0
.
1 if p ≥ (1 + ε)p0

Moreover, for p ≥ (1 + ε)p0 , with high probability the largest independent sets are stars.
While observing that we may take ε = O(k −1 ), they conjectured that the result should continue
to hold provided k = o(n). Partial progress was made by Balogh, Bollobás and Narayanan [2], who
showed that for every γ > 0 there is some constant c(γ) > 0 such that if k ≤ ( 12 − γ)n and

−c(γ)
, then α(Kp (n, k)) = n−1
p ≥ n−1
k−1 with high probability.
k−1
By applying Theorem 1.2, we obtain sharper results for large k, as given in the theorem below.
For these larger values of k, it is convenient to present the critical probability in a different form
to that of Theorem 1.3; note that pc below is asymptotically equal to p0 above when k = o(n1/2 ).
Theorem 1.4. There is an absolute constant C > 0 such that the following holds. Let k and n be
integers with ω(1) = k ≤ 21 (n − 3), let ε = ω(k−1 ), and set
pc =

Then, as n → ∞, P α(Kp (n, k)) =

n−1
k−1



n−1
k
.
n−k−1
k−1

log n

→ 0 if p ≤ (1 − ε)pc .


n
, if p ≥ (1 + ε)pc , with high probability α(Kp (n, k)) = n−1
For k ≤ 6C
k−1 and the stars are the
2Cn
only maximum independent sets. For k ≤ 12 (n − 3), the same conclusion holds for p ≥ n−2k
pc .
n
, thus extending Theorem 1.3 to k as large
Theorem 1.4 exhibits a sharp threshold for k ≤ 6C
1
n
as linear in n. Furthermore, when k ≤ ( 2 − γ)n, as considered in [2], n−2k
≤ (2γ)−1 , and so
Theorem 1.4 determines the critical probability up to a constant factor. Finally, when k is close to
1
for very small edge
2 n, we find that the sparse version of the Erdős–Ko–Rado theorem still holds
n−1
1
probabilities; when k = 2 (n − 3), we almost surely have α(Kp (n, k)) = k−1 even for p = Ω(n−1 ).

1.4

Notation and organisation


We use standard set-theoretic and asymptotic notation. We write [n] for {1, 2, . . . , n}, while X
k is
the family of all k-element subsets of a set X. A non-standard piece of notation is dp(F), which
represents the number of disjoint pairs in a set family F. Given two functions f and g of some
underlying parameter n, if limn→∞ f (n)/g(n) = 0, we write f = o(g) and g = ω(f ). Finally, all
logarithms are to the base e.
In Section 2 we prove our removal lemma, Theorem 1.2. We apply this result to the sparse
Erdős–Ko–Rado problem in Section 3, where we prove Theorem 1.4. The final section contains
some concluding remarks and open problems.

4

2

The removal lemma

In this section we prove our version of the removal lemma, Theorem 1.2. Our proof combines the
work of Lovász [24] on the spectrum of the Kneser graph with an analytic result of Filmus [12]

regarding approximations of Boolean functions on [n]
k . Before beginning with the proof, we shall
introduce the necessary terminology.
[n]
Given a family of sets F ⊂ [n]
→ {0, 1} is a Boolean
k , the characteristic function f :
k
function indicating membership of the family, with f (F ) = 1 if and only if F ∈ F. We may

n
embed [n]
k ⊂ {0, 1} into the n-dimensional hypercube, and
P thus think of f as being defined on
n
the k-uniform slice of the
i xi = k}. A function f is affine if
P cube {(x1 , . . . , xn ) ∈ {0, 1} :
f (x1 , x2 , . . . , xn ) = a0 + i∈[n] ai xi for some constants ai , 0 ≤ i ≤ n. We will equip this space of

functions with the L2 -norm with respect to the uniform measure on [n]
k , defining
i
h
1 X
|f (F ) − g(F )|2 ,
kf − gk2 = E |f − g|2 = n
k

F ∈([n]
k )

and say f and g are ε-close if kf − gk2 ≤ ε. Finally, to avail of the spectral results, which are
traditionally phrased in terms of matrices and vectors, we will abuse notation and identify a function

([n])
f : [n]
→
R
with
the
vector
f
=
(f
(F
))
[n] in R k . Note that the L2 -norm above arises from
k
F ∈( )
k

[n]
the standard inner product on R( k ) .
The first step of our proof is the following lemma, which transfers the problem into the analytic
framework set up above. The lemma shows that if a set family F is as in the statement of
Theorem 1.2, then its characteristic function can be approximated well by an affine function.

Lemma 2.1. Let n, k and ℓ be positiveintegers satisfying n > 2k, and let F ⊂ [n]
be a family
k




[n]
n−1
ℓ
n−1 n−k−1
of size |F| = (ℓ − α) k−1 with at most 2 + β k−1 k−1 disjoint pairs. If f : k → {0, 1}

k
for some affine function
is the characteristic function of F, then kf − gk2 ≤ ((2ℓ − 1)α + 2β) n−2k

[n]
g : k → R.

To prove Lemma 2.1, we require some information on the spectrum of the Kneser graph. Let A
denote the adjacency matrix of K(n, k). In his celebrated paper on the Shannon capacity of graphs,
Lovász [24] showed the eigenvalues of A are λi = (−1)i n−k−i
for 0 ≤ i ≤ k. Thus the largest
k−i

eigenvalue is the degree of the vertices in the regular graph K(n, k), λ0 = n−k
, while the smallest
k


n−k−1
n−k−3
eigenvalue is λ1 = − k−1 . The second smallest eigenvalue is λ3 = − k−3 . Furthermore, the
λ0 -eigenspace is one-dimensional, spanned by the constant function. The (n − 1)-dimensional λ1 eigenspace
is spanned by the functions xi − nk (note that these functions are linearly dependent, as
P
i xi ≡ k). Hence the span of the λ0 - and λ1 -eigenspaces is precisely the space of affine functions.
As A is a real symmetric matrix, its eigenspaces are orthogonal. Armed with these preliminaries,
we can prove the lemma.
Proof of Lemma 2.1. Given the characteristic vector f of F, write f = f0 + f1 + f2 , where f0 and
f1 are the projections of f to the λ0 - and λ1 -eigenspaces respectively, and f2 = f − f0 − f1 . By
the orthogonality of the eigenspaces, we have kf k2 = kf0 k2 + kf1 k2 + kf2 k2 . As f is a Boolean
function, kf k2 = E[f 2 ] = E[f ] = |F| / nk = (ℓ − α) nk . Thus, solving for kf1 k2 , we find kf1 k2 =
5

(ℓ − α) nk − kf0 k2 − kf2 k2 . Furthermore, since the λ0 -eigenspace is spanned by the constant function,
 
2
f0 ≡ E[f ] = (ℓ − α) nk , and so kf0 k2 = E f02 = (ℓ − α)2 nk 2 .
As A is the adjacency matrix of the Kneser graph K(n, k), and f is the characteristic function
of the set family F, it follows that f T Af = 2dp(F). Using our bound on the number of disjoint
pairs in F,



 n−1 n−k−1
2
ℓ − ℓ + 2β
≥ 2dp(F) = f T Af = f0T Af0 + f1T Af1 + f2T Af2
k−1
k−1
≥ λ0 f0T f0 + λ1 f1T f1 + λ3 f2T f2 .


We divide through by nk to normalise, obtaining
 
 





ℓ2 − ℓ + 2β k n − k − 1
n−k
n−k−1
n−k−3
2
2
≥
kf0 k −
kf1 k −
kf2 k2 .
n
k−1
k
k−1
k−3
Dividing by

n−k−1
k−1 ,

substituting our expressions for kf0 k2 and kf1 k2 , and simplifying gives



2βk
(k − 1)(k − 2)
(2ℓ − 1) αk α2 k
≥ 1−
+
kf2 k2 −
n
(n − k − 1)(n − k − 2)
n
n
2
(2ℓ − 1) αk α k
n − 2k
(2ℓ − 1) αk
(n − 2k)(n − 3)
kf2 k2 −
+
≥
kf2 k2 −
.
=
(n − k − 1)(n − k − 2)
n
n
n
n
k
Rearranging, we deduce kf2 k2 ≤ ((2ℓ − 1)α + 2β) n−2k
. Recalling that f0 + f1 is spanned by the
λ0 - and λ1 -eigenspaces, and hence affine, setting g = f0 + f1 gives the desired result.

Lemma 2.1 shows the characteristic function of F must be close to an affine function, from which
we shall deduce that F itself is close to a union of stars. Note that the characteristic function g of
the union of stars with centres i ∈ S is simply g(x1 , . . . , xn ) = maxi∈S xi , and is thus determined
only by the coordinates in S. The Friedgut–Kalai–Naor theorem [15] states that if a Boolean
function f : {0, 1}n → {0, 1} on the entire hypercube is close to an affine function, then it is close
to a function determined by at most one coordinate. We shall make use of an analogous result for
the k-uniform slices of the cube, due to Filmus [12].
Theorem 2.2 (Filmus). For some constant C > 1 the following holds. Suppose 2 ≤ k ≤ 21 n and
[n]
k
ε < 128n
. For every Boolean function
f
:
k → {0, 1} that is ε-close to an affine function, there is

√

some set S ⊂ [n] of size |S| ≤ max 1, Cnk

ε

such that either f or 1 − f is (Cε)-close to maxi∈S xi .

We now have all the necessary ingredients to prove the removal lemma.

k
, and take C as in Theorem 2.2. By our
Proof of Theorem 1.2. Set ε = ((2ℓ − 1)α + 2β) n−2k
k
bounds on α and β, ε < 128C 2 n . If F is as in the statement of the theorem, then by Lemma 2.1 its
characteristic function f is ε-close to an affine function. By Theorem 2.2, there is some S ⊂ [n] such
that f or 1− f is√ (Cε)-close
to maxi∈S xi . Without loss of generality, we may assume S = [s], where

 [n]\[s]
Cn ε
. Let gs = maxi∈[s] xi , and let Gs = [n]
be the family corresponding
s ≤ max 1, k
k \
k
to this characteristic function.

6


since for any set F ∈ [n]
k we have

1 if F ∈ F∆Gs
.
|f (F ) − gs (F )| =
0 otherwise

Hence we must have |F∆H| ≤ Cε nk for H = Gs or H = Gs , depending on whether it is f or 1 − f
that is (Cε)-close to gs . There are six possibilities to consider:
Note that kf − gs k2 = |F∆Gs | /

(i)
(iv)

H = Gs , s ≤ ℓ − 1
H = Gs , s ≥ 2

n
k ,

(ii)
(v)

H = Gs , s ≥ ℓ + 1
H = G1

(iii)
(vi)

H = G0
H = Gℓ

Since Gℓ is the union of ℓ stars, we wish to show that (vi) must hold. We
 first consider the
sizes of F and H to eliminate cases (i)-(iv). Recall that |F| = (ℓ − α) n−1
by our bound
k−1 , and,

n
1
1 n−1
1
on α, ℓ − α ∈ (ℓ − 8 , ℓ + 8 ). Since ||F| − |H|| ≤ |F∆H| ≤ Cε k < 8 k−1 , we must have




ℓ − 41 n−1
+ 14 n−1
k−1 ≤ |H| ≤ ℓ 
k−1 .
We have |Gs | ≤ s n−1
k−1 , which is too small if s ≤ ℓ − 1. On the other hand, observe that Gs , the
union of s stars, grows with s. Thus, when s ≥ ℓ + 1,

 

 


 

n−1
ℓ+1 n−2
n−1
n−1
ℓ2 k
1
|Gs | ≥ |Gℓ+1 | ≥ (ℓ + 1)
−
≥ ℓ+1−
≥ ℓ+
,
k−1
2
k−2
n
2
k−1
k−1
 



2 n−1
which is too large. This rules out cases (i) and (ii). We also have G0  = nk = nk n−1
k−1 ≥ 2ℓ k−1 ,
which is again too large, ruling out case (iii) as well.
 

is decreasing
To handle case (iv), we show that Gs is too large when s ≥ 2. Since Gs  = n−s
k
√

in s, it suffices to take s = Cnk ε . We indeed have too many sets, as

 
 




 

 
√ n n−1
n
n−1
3ℓ2 n − 1
1
Gs  = n − s ≥ 1 − sk
= 1−C ε
>
≥ ℓ+
.
k
n
k k−1
2 k−1
2
k
k−1

√ 
The above argument does not immediately rule out case (v), since if s = max 1, Cnk ε = 1,
√

we may not assume s = Cnk ε . However, the family G1 is still too large when ℓ ≥ 2, as







 
 

n−1
G1  = n − 1 = n − k n − 1 ≥ 2ℓ2 − 1 n − 1 > ℓ + 1
.
k
k
2
k−1
k−1
k−1

To ruleout case (v) when ℓ = 1, we consider
the number of disjoint pairs in F. Note that each
n−k−1
n−k−1
G
is
disjoint
from
other
sets in G1 , and hence dp(G1 ) = 21 n−1
.
of the n−1
sets
in
1
k
k
k
k
n−k−1
Moreover, removing
G1 can account for at most t k
disjoint pairs. If F were close

 t sets from
n


to G1 , then G1 \ F ≤ Cε k , and so




 n − 1n − k − 1
 n−1 n−k−1
1
Cεn
1
dp(F) ≥ dp(F ∩ G1 ) ≥ 2 − n−k
> 2 − 2Cε
.
k
k
k
k
 n−k−1
On the other hand, we assumed F has at most β n−1
disjoint pairs, so we must have
k−1
k−1
 (n−k)(n−2k)
n−2k
1
> 2n , contradicting our bound on β.
β ≥ 2 − 2Cε
k2
Thus we are only left with case (vi), where H is the union of ℓ stars Gℓ , and, as required, we
n−1
n
have |F∆Gℓ | ≤ Cε nk = C((2ℓ − 1)α + 2β) n−2k
k−1 .
7

3

Independence number of random Kneser subgraphs

In this section we prove Theorem 1.4, establishing an analogue of the Erdős–Ko–Rado theorem for
sparse random subgraphs of the Kneser graph. We will show that below the threshold, there is
with high probability an independent superstar : some star S and a set F ∈
/ S such that S ∪ {F }
is independent in Kp (n, k). The upper bound on the critical probability essentially follows from a
union bound over all potential independent sets, where we will be able to take advantage of the
fine control afforded to us by Theorem 1.2 to obtain sharp results when k is large.
Proof of Theorem 1.4. First we establish the lower bound on the critical probability. Suppose
ε = ω(k−1 ) and p ≤ (1 − ε)pc . We wish to show that with high probability, stars can be extended

to independent superstars in Kp (n, k). Let S be the star with centre 1, and for every 1 ∈
/ F ∈ [n]
k
let EF be the event that S ∪ {F } is independent in Kp (n, k).

Note that F is disjoint from n−k−1
sets in S, and for EF to hold none of these edges can appear
k−1
n−k−1
(
in K (n, k). Thus P(E ) = (1 − p) k−1 ) . Moreover, the events {E : 1 ∈
/ F } depend on mutually
p

F

F

disjoint sets of edges of K(n, k), and are thus independent. Hence we can bound the probability
that the stars are the largest independent sets of Kp (n, k) by



(n−1)
 
n−k−1
n−1
k
.
P α(Kp (n, k)) =
≤ P ∩F EF = 1 − (1 − p)( k−1 )
k−1

(1−ε) log(n(n−1
k ))
. As n ≥ 2k+2,
This bound is increasing in p, so it suffices to take p = (1−ε)pc =
n−k−1
(
)
 k−1



n−k−1
−(1−ε/2)
. Thus
≥ n n−1
p = O(n−1 ) = o(ε), and hence (1 − p)( k−1 ) ≥ exp −p(1 + p) n−k−1
k
k−1

 



ε/2 !
(n−1)

n−k−1
n−k−1
n
−
1
n
−
1
k
1 − (1 − p)( k−1 )
≤ exp −
(1 − p)( k−1 ) ≤ exp −n−1
= o(1),
k
k



since ε = ω k−1 . Hence for p ≤ (1 − ε)pc we have α(Kp (n, k)) > n−1
k−1 with high probability.
We now seek an upper bound on the critical probability. By monotonicity, it suffices to consider p
as small as possible. To begin, we will prove the coarse threshold. Let C be the (absolute) constant
2Cn
from Theorem 1.2, and take p = ζpc , where ζ = n−2k
. For such p, we wish to show the only
maximum independent sets of Kp (n, k) are the stars. To this end, we define the following random
variables:
X = |{independent superstars F : F = S ∪ {F } for some star S, F ∈
/ S}| and








n−1
n−1


Yi =  independent F : |F| =
.
, min |S \ F| = i  , 1 ≤ i ≤
k−1
k − 1 S a star

X counts the number of independent superstars in Kp (n, k). If X = 0, the stars are all maximal
independent sets. If we further have Yi = 0 for all 1 ≤ i ≤ n−1
k−1 , then there are no independent

n−1
sets of size k−1 that are not stars, and thus
P the stars are the only maximum independent sets in
Kp (n, k). Hence our task is to
show
X
+
i Yi = 0 with high probability. By the union bound, it
P
suffices to show P(X > 0) + i P(Yi > 0) = o(1).
8

We begin
by estimating P(X > 0), which we can bound by E[X]. There are
n choices for the
n−1
n−k−1
star S, k choices for the set F ∈
/ S, and, for each such configuration, k−1 edges that should


n−k−1
not appear in K (n, k), which occurs with probability (1 − p)( k−1 ) ≤ exp −ζp n−k−1 . Thus
p

c

k−1




  

n−1
n−k−1
n − 1 1−ζ
E[X] ≤ n
exp −ζpc
= o(1),
(1)
= n
k
k−1
k

even for ζ as small as 1 + ω k−1 .
To analyse P(Yi > 0), we shall distinguish between two different cases: families that are close

n−1
1
.
to a star, and families far from a star. For the first case, we assume 1 < i ≤ t1 = 400C
k−1
n−1
The families F counted by Yi have size k−1 and |F∆S| = 2 |S \ F| ≥ 2i for every star S. By
i(n−2k)
i(n−2k) n−k−1
applying Theorem 1.2 with α = 0 and β = Cn
n−1 , it follows that dp(F) ≥
Cn
k−1 . For
(k−1)
F to be independent in Kp (n, k), none of these edges can appear, which occurs with probability
−ζi(n−2k)/(Cn)
.
(1 − p)dp(F ) ≤ n n−1
k
We now take a union bound over all possible choices of F. We know there is some star S such
n−1 
) choices for the i sets in S \ F, and
that |S \ F| = i. There are n choices for the star S, ( k−1
i

i
2
n−1 
n−1 

ke2 (n−1
(
)
(
)
(n−1
k )
k−1
k
k )
≤ n (n−k)i2
choices for the i sets in F \ S. Hence there are at most n i
i
i


families F that can be counted by Yi . Thus we have
t1
X
i=1

P(Yi > 0) ≤

t1
X
i=1

n

!i
2  

t1
X
ke2 n−1
n − 1 −ζ(n−2k)/(Cn)
ne2i
k
≤
= o(1).
n
(n − k)i2
(ni)2i
k

(2)

i=1

2Cn
where the second inequality follows from our choice of ζ = n−2k
.
n−2k
Finally, we bound P(Yi > 0) when i > t1 . Applying Theorem 1.2 with α = 0 and β = (20C)
2n ,


P
n−1
n−k−1
n−2k
any family F counted by i>t1 Yi must have dp(F) ≥ (20C)
2 n k−1
k−1 . Hence the probability
ζ(n−2k) n−1

−
( )
(20C)2 n k−1 . Recalling our
of such an F being independent in Kp (n, k) is (1 − p)dp(F ) ≤ n n−1
k
n 
(n−1)
(k)
2Cn
k−1
choice of ζ = n−2k
≤ ne
, we apply a trivial union bound, summing over all n−1
families
k
(
k−1 )

of size n−1
k−1 to find, when k ≥ 600C,

(n−1
k−1 )
X

i=t1 +1

P(Yi > 0) ≤

ne
k

!(n−1)
 

n − 1 −1/(200C) k−1
≤
n
k

ne
k

 k/(200C) !(n−1
k−1 )
k
= o(1).
n

(3)

P
Combining (1), (2), and (3), we find that when p ≥ ζpc , P(X > 0) + i P(Yi > 0) = o(1), and so
for such p, the maximum independent sets in Kp (n, k) are precisely the stars.
We now prove the sharp threshold result, for which we must show that the same conclusion holds
n
when k ≤ 6C
and ζ = 1 + ε, for some small ε = ω(k−1 ).
P As previously stated, the bound from (1)
holds with this smaller value of ζ. However, bounding i P(Yi > 0) requires more careful analysis.

n−1
1
,
t
+
1
≤
i
≤
t
=
We now split the sum into three parts: 1 ≤ i ≤ t0 = 2ε n−k−1
0
1
k−1
400C k−1 , and

t1 + 1 ≤ i ≤ n−1
.
k−1
9

For the latter two parts, we modify slightly our analysis of the above bounds. When a family
is only moderately close to a star, with
t0 + 1 ≤ i≤ t1 , we again use the bound in (2). We begin

n−k
εk
=
by observing that i > t0 = 2ε n−k−1
k−1
k , and so
2(n−k)
2
2

2k
4e2 (n − k) n−1
ke2 n−1
4e2 (n − k)ek/(2C)
k
4e2 (n − k)
k
k
≤
≤
.
1
+
≤

2
(n − k)i2
ε2 k
n − 2k
ε2 k
ε2 k n−k
k

−ζ(n−2k)/(Cn)
n
Since k ≤ 6C
≤
, we may also bound n n−1
k
exponential summands in (2) are at most
4e2 (n − k)
ε2 k

k/(2C)


k k/(2C)
,
n

and so the bases of the

 e 2
1
4e3
e3
4e3  e k/(2C)−1
< ,
≤
<
2
2
k/(2C)−1
2
k/(3C)
ε
6C
6
2
ε C
ε C
P1
as we may assume k ≥ 6C and ε ≥ 10C −k/(6C) . This then implies ti=t
P(Yi > 0) = o(1).
0 +1
For families that are far from a star, we can re-estimate the upper bound in (3) to show
X

i>t1



ek
n

≤

(n−1)
k−1
 
− ζ(n−2k)
2
(20C) n
n−1
ne


n
≤
P(Yi > 0) ≤
k
k


ne
k

  k 2 !(n−1
 (n−1)
k−1 )
k 2(20C)
ek k−1
= o(1),
≤
n
n

assuming k ≥ (40C)2 .
To complete the proof of the sharp threshold, we must demonstrate that we are unlikely to
obtain independent families that are very close to stars, with 1 ≤ i ≤ t0 . In this range, we
repeat the analysis of Bollobás, Narayanan and Raigorodskii in [5], and instead consider maximal
independent families in Kp (n, k).
For j ≥ i ≥ 0, let Zi,j denote the number of maximal independent families F such that there
is some star S with |S \ F| = i and |F \ S| = j. Observe that if F is a family counted by the
random variable Yi , then for any maximal independent family F ′ containing F, the family F ′ must
be counted by Zi′ ,j for some i′ ≤ i and j ≥ i. Furthermore, if i′ = 0, this family F ′ contains
superstars. This shows
[
[
{Yi > 0} ⊆ {X > 0} ∪
{Zi,j > 0} ,
1≤i≤t0
j≥i

1≤i≤t0

P0
P0 P
and so ti=1
P(Yi > 0) ≤ P(X > 0) + ti=1
j≥i P(Zi.j > 0). We already have P(X > 0) = o(1),
Pt0 P
and hence it suffices to show i=1 j≥i E[Zi,j ] = o(1).
Let F be a maximal independent family counted by Zi,j . Let S be the corresponding star,
A = S \ F, and B = F \ S. Thus we have |A| = i and |B| = j. By virtue of F being independent,
all of the edges between B and S \ A must be missing in Kp (n, k). As F is maximal, each A ∈ A
must have an edge to some B ∈ B, for otherwise F ∪ {A} would be a larger independent family. In
particular, this implies B is a subset of the union of the neighbourhoods in K(n, k) of A ∈ A.
n−1 
i n−k 
There are thus n choices for the star S, (k−1) choices for A, and at most ( k ) choices for
j

i

B. Each A ∈ A must retain at least one of its edges to B, which occurs with probability at most

10


jp, independently for each of the i sets. Furthermore, as every B ∈ B has n−k−1
neighbours in
k−1



S, there are at least j n−k−1
− i edges between B and S \ A that must be missing. This gives
k−1
E[Zi,j ] ≤ n



n−1 n−k
i k
k−1
(jp)i

j

i

We first observe that, for i ≤ t0 =
zi,j+1
=
zi,j

since p = ζpc =
t0 X
X
i=1 j≥i


i(n−k
k ) (j
j+1
i(

n−k
k

j

+

) ji

1)i

E[Zi,j ] ≤ 2

t0
X
i=1

zi,i = 2n

n−k−1
k−1

)−i) = z .
i,j

and j ≥ i,

n−k−1
(1 − p)( k−1 )−i ≤


i

n−k
k




−j e

n−k−1
ε
(1 − p)(1− 2 )( k−1 )

j+1

ε

 

n−k
n − 1 −(1+ 4 )
= o(1),
≤e
n
k
k

(1+ε) log(n(n−1
k ))

(n−k−1
k−1 )


ε n−k−1
2
k−1

(1 − p)j ((

. Hence

t0 
X
i=1

P

j≥i zi,j

≤ 2zi,i . Thus

n−1 n−k
i k
k−1
(ip)i

i

i

n−k−1
k−1

(1 − p)i((

)−i)

i


t0  
X
n−k
1− 2ε )(n−k−1
2 n−1
)
(
k−1
≤ 2n
e
p (1 − p)
k−1
k
i=1
−(1+ ε ) !i



t0
n−1  
X
4
(1
+
ε)
log
n
n
−
1
n
−
1
n
−
k
k
n
e2
≤ 2n

n−k−1
k
k−1
k
k−1
t=1
!

i
t0
X
(1 + ε)e2 log n n−1
k
= o(1),
= 2n
 4ε
n n n−1
i=1
k

completing the proof for the sharp threshold.

4

Concluding remarks

In this paper, we built on the work of Filmus [12] to develop a removal lemma for large set
families with few disjoint pairs. We then used this to determine the threshold for random Kneser
subgraphs having the Erdős–Ko–Rado property, thus answering a question of Bollobás, Narayanan
and Raigorodskii [5].
Rather than the probabilistic problem considered above, one might instead ask the correspond
ing extremal question: how sparse can a spanning subgraph G of K(n, k) be if α(G) = n−1
k−1 ? A
lower bound
can be obtained by requiring the stars to be maximal independent sets. For every set
[n]
F ∈ k , and every element x ∈
/ F , there must be an edge between F and the star Sx centred at x,

′
for otherwise Sx ∪ {F } would be an independent set of size n−1
k−1 + 1. As each edge {F, F } covers
k stars, it follows that F must have degree at least n−k
k , and hence G ⊆ K(n, k) must have at least

n−k n
2k k edges.
11

Perhaps surprisingly, this simple
lower bound can be tight. If k divides n, then Baranyai’s
[n]
Theorem [4] gives a partition of k into perfect matchings. In the Kneser graph, this corresponds
to a partition of the vertices into cliques of size nk . Let G be the subgraph consisting only of these
cliques. Any
set in G can contain at most one vertex from each clique, and hence
 independent

n−1
k n
α(G) ≤ n k = k−1 . Furthermore, G is n−k
k -regular, matching the lower bound given previously.
Theorem 1.4 shows that for this bound on the independence
number to hold in random graphs,
n−1
they must be denser by a factor of at least log n k . However, these random graphs have the
additional property that the only maximum independent sets are the stars, which is not the case in
the construction given above. One might be interested in the extremal problem with this stricter
requirement, or in the case when k does not divide n.
Returning to the random setting, Devlin and Kahn [9] have recently established threshold results
n
. We believe that, perhaps
when k ∼ n2 . It remains to exhibit a sharp threshold around pc for k > 6C
for smaller k, a more precise hitting time result may hold. Consider the random process where
one removes edges from the Kneser graph K(n, k) one at a time, selecting at each step an edge
uniformly at random from those that remain. Is it true that, with high probability, α(G) > n−1
k−1
precisely when a superstar is born? The fact that the lower bound from the sharp threshold comes
from these superstars suggests this might be the case.
More generally, given how central intersecting families are to extremal set theory, we believe the
removal lemma should find many other applications. In a forthcoming paper with Balogh, Liu and
Sharifzadeh, we obtain some supersaturation results using the removal lemma with ℓ ≥ 1, extending
the results of [7]. We hope that the lemma might prove useful for other research directions as well.
Acknowledgements We would like to thank Jozsef Balogh, Hong Liu and Maryam Sharifzadeh
for suggesting the generalisation of the removal lemma to larger families, with ℓ ≥ 2. We also
extend our thanks to the anonymous referees for their many helpful suggestions.

References
[1] J. Balogh, T. Bohman and D. Mubayi, Erdős–Ko–Rado in random hypergraphs, Combin.
Probab. Comput. 18.5 (2009), 629–646.
[2] J. Balogh, B. Bollobás and B. P. Narayanan, Transference for the Erdős–Ko–Rado theorem,
Forum of Mathematics, Sigma 3 (2015), e23.
[3] J. Balogh, S. Das, M. Delcourt, H. Liu and M. Sharifzadeh, The typical structure of intersecting
families of discrete structures, J. Combin. Theory Ser. A 132 (2015), 224–245.
[4] Z. Baranyai, On the Factorization of the Complete Uniform Hypergraph, Infinite and finite
sets (Colloq. Keszthely, 1973; dedicated to P. Erdős on his 60th birthday) 1 (1975), 91–108.
[5] B. Bollobás, B. P. Narayanan and A. M. Raigorodskii, On the stability of the Erdős–Ko–Rado
theorem, J. Combin. Theory Ser. A 137 (2016), 64–78.
[6] D. Conlon and J. Fox, Graph removal lemmas, Surveys in Combinatorics, Cambridge University Press, (2013), 1–50.
[7] S. Das, W. Gan and B. Sudakov, The minimum number of disjoint pairs in set systems and
related problems, Combinatorica, to appear.
12

[8] S. Das and B. Sudakov, Most probably intersecting hypergraphs, Electron. J. Comb. 22 (2015),
P1.80.
[9] P. Devlin and J. Kahn, On “stability” in the Erdős–Ko–Rado theorem, arXiv:1502.05692.
[10] I. Dinur and E. Friedgut, Intersecting families are essentially contained in juntas, Combin.
Probab. Comput. 18.1-2 (2009), 107–122.
[11] P. Erdős, C. Ko and R. Rado, Intersection theorems for systems of finite sets, Q. J. Math.
12.1 (1961), 313–320.
[12] Y. Filmus, Friedgut–Kalai–Naor theorem for slices of the Boolean cube, arXiv:1410.7834.
[13] P. Frankl, Erdős–Ko–Rado theorem with conditions on the maximal degree, J. Combin. Theory
Ser. A 46 (1987), 252–263.
[14] E. Friedgut, On the measure of intersecting families, uniqueness and stability, Combinatorica
28.5 (2008), 503–528.
[15] E. Friedgut, G. Kalai and A. Naor, Boolean functions whose Fourier transform is concentrated
on the first two levels, Adv. App. Math. 29.3 (2002), 427–437.
[16] E. Friedgut and O. Regev, personal communication.
[17] M. M. Gauy, H. Hàn and I. C. Oliveira, Erdős–Ko–Rado for random hypergraphs: asymptotics
and stability, arXiv:1409.3634.
[18] A. Hamm and J. Kahn, On Erdős–Ko–Rado for random hypergraphs I, arXiv:1412.5085.
[19] A. Hamm and J. Kahn, On Erdős–Ko–Rado for random hypergraphs II, arXiv:1406.5793.
[20] A. J. W. Hilton and E. C. Milner, Some intersection theorems for systems of finite sets, Q. J.
Math. 18.1 (1967), 369–384.
[21] G. O. H. Katona, G. Y. Katona and Z. Katona, Most probably intersecting families of subsets,
Combin. Probab. Comput. 21.1-2 (2012), 219–227.
[22] P. Keevash, Shadows and intersections: stability and new proofs, Adv. Math. 218 (2008),
1685–1703.
[23] P. Keevash and D. Mubayi, Set systems without a simplex or a cluster, Combinatorica 30.2
(2010), 175–200.
[24] L. Lovász, On the Shannon capacity of a graph, IEEE T. Inform. Theory 25.1 (1979), 1–7.
[25] P. A. Russell, Compressions and probably intersecting families, Combin. Probab. Comput.
21.1-2 (2012), 301–313.
[26] P. A. Russell and M. Walters, Probably intersecting families are not nested, Combin. Probab.
Comput. 22.1 (2013), 146–160.

13

