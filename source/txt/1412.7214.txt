The Pennsylvania State University

arXiv:1412.7214v1 [math.CO] 22 Dec 2014

The Graduate School
Department of Mathematics

MULTIVARIATE HYPERGEOMETRIC TERMS

A Thesis in
Mathematics
by
Garth Payne
c
1997
Garth Payne

Submitted in Partial Fulfillment
of the Requirements
for the Degree of

Doctor of Philosophy

December 1997

We approve the thesis of Garth Payne.

Date of Signature

George E. Andrews
Evan Pugh Professor of Mathematics
Head of the Department of Mathematics
Thesis Advisor
Chair of Committee

Leonid Vaserstein
Professor of Mathematics

W. Dale Brownawell
Distinguished Professor of Mathematics

Calyampudi R. Rao
Professor and Holder of the Eberly Family Chair in Statistics

Abstract

In [15], Wilf and Zeilberger developed a proof theory for hypergeometric multisums centered around the notion of a multivariate hypergeometric term. A multivariate function f (z1 , . . . , zk ) = f (z) from Zk to a field K is a hypergeometric term
if for each i ∈ {1, . . . , k} there exist nonzero polynomials Ai (z) and Bi (z) in K[z]
such that
Ai (z)f (z) = Bi (z)f (z + ei )
for all z ∈ Zk . Here e1 , . . . , ek is the standard basis for Zk . If f is not a zero
divisor, then the term ratios R1 = A1 /B1 , . . . , Rk = Ak /Bk are unique and satisfy
the relation
Ri (z)Rj (z + ei ) = Rj (z)Ri (z + ej ) for each i, j ∈ {1, . . . , k}
(cf. [14]).
We introduce the concepts of divisibility lattice paths, rational Galois spaces,
and fixed factors of rational functions to the study of the relation for the term ratios.
We prove that a solution R1 , . . . , Rk must be of the form [Ore–Sato]
Ri (z) =

Y Yei ·v av (v · z + j)
C(z + ei ) D(z)
for i ∈ {1, . . . , k},
0
C(z) D(z + ei )
b
(v
·
z
+
j)
v
j
v∈V

where C and D are polynomials, V is a finite subset of Zk , and, for each v ∈ V ,
Qb
av and bv are univariate polynomials all independent of i. The symbol a denotes
j
Qb−1
Qa−1
i=a if b > a, 1 if a = b, and 1/
i=b if a > b.

We use this factorization of Ri to answer an obvious question about multivariate

hypergeometric terms. Recall the Pochhammer symbol (m)r = m(m + 1) · · · (m +
r − 1). The multivariate hypergeometric terms that arise in practice have the form
Qp
(m )
zk C(z)
z1
Qqi=1 i vi ·z+ri
f (z) = γ1 · · · γk
D(z) j=1 (nj )wj ·z+si

iv
where γ1 , . . . , γk ∈ K, C and D are polynomials in K[z], the vi and wj are in
Zk , the ri and sj are in Z, and the mi and nj are in K. The question is: do all
hypergeometric terms have this form? We prove that if K is algebraically closed, and
the hypergeometric term is honest, then such an expression for f exists piecewise.
This is trivial in the case of one variable, but not in the case of several variables.
We use this result to settle the discrete part of a conjecture of Wilf and Zeilberger
[15] by showing that a holonomic hypergeometric term is piecewise proper, which
means roughly that we can take D(z) = 1 in the expression for f above.
For any subsets A and B of an additive group G, define A + B = {a + b : a ∈
A and b ∈ B} and −A = {−a : a ∈ A}. A subset S of G is said to be sum-free,
complete, and symmetric respectively if S + S ⊂ S c , S + S ⊃ S c , and S = −S.
Cameron asked if for all sufficiently large moduli m there exists a sum-free complete
set in Z/mZ that is not symmetric [7]. We answer Cameron’s question by showing
there exists such a set for all moduli greater than or equal to 890626. We also
show that every sum-free complete set in Z/mZ that is not symmetric can be used
to construct a counterexample to a conjecture of Conway disproved by Marica [9].
Conway conjectured that for any finite set S of integers, |S + S| 6 |S − S|.

Table of Contents

Acknowledgements

vi

Chapter 1 Introduction
1.1 Hypergeometric terms and term ratios
e
1.2 The rational solutions of Ri Rjei = Rj Ri j
1.3 The multiplicative structure of a hypergeometric term
1.4 A holonomic hypergeometric term is piecewise proper
1.5 A Solution to a Problem of Cameron On Sum-free Complete
Sets
e

1
1
2
4
6
7

Chapter 2 The Rational Solutions of Ri Rjei = Rj Ri j
2.1 Gosper’s lemma
2.2 The divisibility lattice path
2.3 What goes up must not come down
2.4 The divisor d is simple.
2.5 The rational Galois space of a rational function
2.6 Fixed factors
2.7 Proof of Lemma 2.1.3 for k > 2
2.8 The multiplicative structure of Ri

9
10
13
14
15
16
20
23
26

Chapter 3 The Multiplicative Structure of a Hypergeometric Term
3.1 Hypergeometric terms and term ratios
3.2 Sets of measure zero
3.3 Boxes
3.4 Polyhedral regions
3.5 Factorial hypergeometric terms
3.6 Path connected regions
3.7 Structure theorem for honest hypergeometric terms

32
33
36
37
39
41
44
48

Chapter 4 A Holonomic Hypergeometric Term Is Piecewise Proper
4.1 Proof of Theorem 4.1.10

54
56

Chapter 5

A Solution to a Problem of Cameron On Sum-free
Complete Sets
5.1 Introduction
5.2 Cameron’s problem
5.3 Conway’s conjecture

Bibliography

64
64
65
70
73

Acknowledgements

I would like to thank my advisor, George Andrews, for his infinite patience
and extraordinary generosity. Without his support and encouragement I would not
have written this dissertation or even come to graduate school (twice).
I am grateful to Jim Humphreys for writing the PSU Thesis Style and for
magically transforming my scribble into type with incredible speed.
I would like to thank Leonid Vasserstein for showing me some interesting mathematics and some excellent blackberry patches.
This thesis is dedicated to the divisibility of 28 by 7, without which I might
not have met Jenae, my wife.

Chapter 1
Introduction

1.1

Hypergeometric terms and term ratios

Throughout this work K denotes a field of characteristic zero. We write K[z] for the
ring of polynomials in one variable over K, and K[z] = K[z1 , . . . , zk ] for the ring
of polynomials in k variables over K. Similarly, we write K(z) for field of rational
functions in one variable over K, and K(z) = K(z1 , . . . , zk ) for the field of rational
functions in k variables over K.
Definition 1.1.1

For any function f : Zk → K and any vector v ∈ Zk , the

function f v : Zk → K is defined by
f v (z) = f (z + v) = f (z1 + v1 , . . . , zk + vk ).
Similarly, for any rational function R ∈ K(z) and any vector v ∈ Qk , the rational
function Rv ∈ K(z) is defined by
Rv (z) = R(z + v) = R(z1 + v1 , . . . , zk + vk ).
Definition 1.1.2

A hypergeometric term on Zk over a field K is a function

f : Zk → K such that for i ∈ {1, . . . , k} there exist nonzero polynomials A1 , . . . , Ak
and B1 , . . . , Bk ∈ K[z] such that
Ai f = B i f e i .
Of course, this last equation is equivalent to Ai (z)f (z) = Bi (z)f (z + ei ) for all
z ∈ Zk .

2
For any hypergeometric term f on Zk and any v ∈ Zk , a rational function
Rv ∈ K(z) is a term ratio in the direction v if
Rv =

Av
Bv

for some nonzero polynomials Av , Bv ∈ K[v] such that Av f = Bv f v .
Definition 1.1.3

A function f on Zk is a zero divisor if there exists a nonzero

polynomial p ∈ K[z] such that pf = 0.
We show in Lemma 3.1.5 that if a hypergeometric term f is not a zero divisor, then for each v ∈ Zk there exists a unique term ratio Rv in the direction v.
Furthermore, we show in Lemma 3.1.6 that if f is not a zero divisor then the term
ratios satisfy
v
Rv Rw
= Rw Rvw
e

for all w, v ∈ Zk . In particular, letting Ri = Rei , we have Ri Rjei = Rj Ri j for all
i, j ∈ {1, . . . , k} (cf. [14]). This is the relation for the term ratios of a hypergeometric
term. The first step in understanding the structure of a hypergeometric term is to
understand the structure of rational solutions of this system of equations.

1.2

The rational solutions of Ri Rjei = Rj Riej

It will be useful to define
 Qb−1

 i=a Ai
Yb
Ai =
1
a

  Qa−1
i
1
i=b Ai

if b > a
if b = a
if a > b.

The usefulness of the notation stems in part from the fact that
Yb
i

a

Ai

Yc
i

b

Ai =

Yc
i

a

and
Yb
i

which is easily verified.

a

Ai =

Ya 1
,
b Ai
i

Ai

3
In Chapter 2, we prove Theorem 2.8.4 [Ore–Sato] which completely describes
the rational solutions of the system of equations
e

Ri Rjei = Rj Ri j

i, j ∈ {1, . . . , k}.

Theorem 2.8.4 Let Ri ∈ K(z), i = 1, . . . , k, be rational functions such that
e

Ri Rjei = Rj Ri j

for all i, j ∈ {1, . . . , k}.

Then there exist polynomials C and D ∈ K[z], a finite set V ⊂ Zk , and univariate
polynomials av and bv ∈ K[z] for each v ∈ V such that for all i ∈ {1, . . . , k},
Ri (z) =

Y Yvi av (z · v + j)
C(z + ei ) D(z)
.
0 bv (z · v + j)
C(z) D(z + ei )
j
v∈V

The proof of Theorem 2.8.4 is quite involved. The first part of the proof is
showing that the solution can be expressed in the form
Ri =

C e i D Ai
,
C D ei Bi

i = 1, . . . , k, where C and D are polynomials (not depending on i) and Ai and
Bi are products of simple polynomials. A simple polynomial is a composition of
a univariate polynomial and a linear polynomial v · z. The one-dimensional case
is trivial. By using Gosper’s Lemma [8], we reduce the two-dimensional case to
the following lemma. Let A1 , A2 , B1 , and B2 ∈ K[z1 , z2 ]. If A1 and B1ne1 are
relatively prime for all n ∈ Z, A2 and B2 are relatively prime, and R1 = A1 /B1
and R2 = A2 /B2 satisfy R1 R2e1 = R2 R1e2 , then the irreducible divisors of A1 , B1 ,
A2 , and B2 are simple. An interesting feature of the proof of the lemma is the
association of a lattice path with an irreducible divisor of A1 , B1 , A2 , or B2 . ( A
lattice path in Zk is a sequence {Ti }i>1 in Zk such that Ti − Ti−1 ∈ {±e1 , . . . , ±ek }
for all i > 1. ) The primeness conditions of the lemma impose restrictions of
the shape of the lattice path, from which we deduce that the path is unbounded.

4
From the unboundedness of the path, it follows that d satisfies a nontrivial relation
d = dv , and from this it follows that d is simple. We derive the higher-dimensional
cases from the two-dimensional case with the aid of the notions of the rational
Galois space of a rational function and the fixed factor of a rational function for a
subspace.
The second part of the proof of Theorem 2.8.4 is deriving the formula for Ri
given the simplicity of the divisors of the Ai and Bi . A crucial step is observing that
the multiplicative components of the Ri determined by rational Galois space still
satisfy the relation for the term ratios: if s is a subspace of Qk and Ri,s = fixs Ri ,
then
e

ei
= Rj,s Ri,sj .
Ri,s Rj,s

1.3

The multiplicative structure of a hypergeometric term

Define a hyperplane in Zk to be a set of the form {z: v · z = n}, where n ∈ Z and v
is some vector in Zk . Define a half-space in Zk to be a set of the form {z: v · z > n},
where n ∈ Z and v is some vector in Zk . A set of measure zero in Zk is a set that
can be covered by a finite number of hyperplanes. Two functions f, g: Zk → K are
equal almost everywhere (written f = g a.e.) if there exists a set S of measure zero
such that f (z) = g(z) for all z ∈ Zk \ S. A region R ⊂ Zk is polyhedral if R = Zk
or R is the intersection of a finite number of half-spaces.
It is easily seen (Lemma 3.2.4) that a function f is a hypergeometric term on
Zk if and only if, for all v ∈ Zk , there exist nonzero polynomials Av and Bv ∈ K[z]
such that Av f = Bv f v a.e. A hypergeometric term f on Zk is honest if for all
v ∈ Zk there exist relatively prime polynomials Av and Bv ∈ K[z] such that
Av f = Bv f v a.e.
The main results of Chapter 3 are Theorem 3.7.1 and its corollary for algebraically closed fields, Corollary 3.7.3.

5
Theorem 3.7.1 Let f be an honest hypergeometric term on Zk . There exist
relatively prime polynomials C and D ∈ K[z], a finite set V ⊂ Zk , univariate
polynomials av , bv ∈ K[z], for each v ∈ V , and a finite number of polyhedral
regions R1 , . . . , Rm such that
(1) Zk is the disjoint union of the Ri and a set of measure zero;
(2) for each i ∈ {1, . . . , m} there exists z0 ∈ Ri such that C(z0 ) 6= 0, and for all
z ∈ Ri for which D(z) 6= 0,
f (z) = f (z0 )

C(z) D(z0 ) Y Yz·v av (j)
.
z0 ·v bv (j)
C(z0 ) D(z)
j
v∈V

(3) all the terms av (j) and bv (j) occurring in the product are nonzero.
The hypergeometric terms that occur in practice can be expressed as products
of Pochhammer symbols, so the question arises: Is this true in general? Corollary 3.7.3 show that if the field K is algebraically closed and the hypergeometric
term is honest, then the answer is yes, at least piecewise.
Corollary 3.7.3 Let f be an honest hypergeometric term on Zk over a field K
that is algebraically closed. Then there exist relatively prime polynomials C and
D ∈ K[z] and a finite number of polyhedral regions R1 , . . . , RL such that Zk is the
union of the Rℓ and a set of measure zero, and for each region Rℓ there exist a vector
γ ∈ K k , constants m1 , . . . , mp , n1 , . . . , nq ∈ K, vectors v1 , . . . , vp , w1 , . . . , wq ∈
Zk , and integers r1 , . . . , rp , s1 , . . . , sq such that
(1) for all z ∈ Rℓ such that D(z) 6= 0,
f (z) =

γ1z1

· · · γkzk

Qp
C(z) i=1 (mi )vi ·z+ri
Q
;
D(z) qj=1 (nj )wj ·z+sj

(2) for all i and j and all z ∈ Rℓ , vi · z + ri and wj · z + sj are positive;
(3) the Pochhammer symbols occurring in the products are nonzero.
If we assume that everything in sight is nonzero, then the expression for f
in Theorem 3.7.1 follows by induction from the expression for the term ratios in

6
Theorem 2.8.4. Unfortunately, zeros of C, D and the av and bv are deadly to the
induction. The polyhedral regions Ri arise as regions for which the nonzero points
of these polynomials have a certain connectedness property.

1.4

A holonomic hypergeometric term is piecewise proper

We prove the following result which settles the discrete part of Wilf and Zeilberger’s
conjecture that a hypergeometric term is holonomic if and only if it is proper.
Theorem 4.1.10 A holonomic hypergeometric term f on Zk over an algebraically
closed field K is piecewise proper; there exist a polynomial C ∈ K[z] and a finite
number of polyhedral regions R1 , . . . , RL such that Zk is the union of the Rℓ
and a set of measure zero, and for each region Rℓ there exist a vector γ ∈ K k ,
constants m1 , . . . , mp , n1 , . . . , nq ∈ K, vectors v1 , . . . , vp , w1 , . . . , wq ∈ Zk , and
integers r1 , . . . , rp , s1 , . . . , sq such that
(1) for all z ∈ Rℓ ,
f (z) =

γ1z1

Qp
(mi )vi ·z+ri
zk
· · · γk C(z) Qqi=1
j=1 (nj )wj ·z+sj

;

(2) for all i and j and all z ∈ Rℓ , vi · z + ri and wj · z + sj are positive;
(3) the Pochhammer symbols occurring in the products are nonzero.
Theorem 4.1.10 applies to hypergeometric terms on polyhedral regions other
than Zk via Lemma 3.4.6.
The proof of Theorem 4.1.10 uses the results of Chapter 3 and only elementary
facts about holonomic functions that can be found in [16] and [3].

7

1.5

A Solution to a Problem of Cameron On Sum-free Complete Sets

For any subsets A and B of an additive group G, define A + B = {a + b : a ∈
A and b ∈ B} and −A = {−a : a ∈ A}. A subset S of G is said to be sum-free,
complete, and symmetric respectively if S + S ⊂ S c , S + S ⊃ S c , and S = −S.
Hence, S is sum-free and complete if and only if S + S = S c .
Cameron observed that for any sufficiently small modulus m, every sum-free
complete set in Z/mZ is also symmetric. In fact, Calkin found that m = 36 is the
smallest modulus for which there is a sum-free complete set that is not symmetric
[7]. Cameron asked if there exists such a set for all sufficiently large moduli [7]. We
answer Cameron’s question by showing there exists such a set for all moduli greater
than or equal to 890626.
We also show that every sum-free complete set in Z/mZ that is not symmetric
can be used to construct a counterexample to a conjecture of J.H. Conway. Conway
conjectured that for any finite set S of integers, |S + S| 6 |S − S|. Conway’s
conjecture was disproved by Marica [9]. Later Stein showed how to make the ratio
|S + S|/|S − S| arbitrarily large [12]. We show that if S is sum-free and complete
modulo m but not symmetric, then |S + S| > |S − S|; hence, S is a counterexample
to a modular version of Conway’s conjecture. Further, we show that if S ′ ⊂ Z is a
certain set derived from S, then |S ′ + S ′ | > |S ′ − S ′ |; hence, S ′ is a counterexample
to Conway’s conjecture proper.
The history of sum-free sets begins with Schur who showed that the positive
integers can not be partitioned into finitely many sum-free sets [11]. Sum-free sets
have been used to find lower bounds for Ramsey numbers (see pp. 28, 128, 264
in [13]). Cameron describes some applications of sum-free sets and poses several
problems [5],[6],[7]. George Andrews observed that sum-free complete sets play a
role in partition identities (personal communication). For example, the set {1, 4} ∈

8
Z/5Z, which arises in the Rogers-Ramanujan Identities (p. 109 in [1]), is sum-free,
complete, and symmetric. Calkin showed that the number of sum-free sets contained
within the first n integers is o(2n(1/2+ǫ) ) for every ǫ > 0 [4].

Chapter 2
The Rational Solutions of
e

Ri Rjei = Rj Ri j

The main result of this chapter is Theorem 2.8.4 [Ore–Sato], which reveals the
multiplicative structure of solutions to the relation for the term ratios.
Theorem 2.8.4 Let Ri ∈ K(z), i = 1, . . . , k, be rational functions such that
e

Ri Rjei = Rj Ri j
for all i, j ∈ {1, . . . , k}. Then there exist polynomials C and D ∈ K[z], a finite set
V ⊂ Zk , and univariate polynomials av and bv ∈ K[z] for each v ∈ V such that for
all i ∈ {1, . . . , k},
Ri (z) =

Y Yvi av (z · v + j)
C(z + ei ) D(z)
.
0 bv (z · v + j)
C(z) D(z + ei )
j
v∈V

Recall that the symbol

Qb
j

a > b.

a

denotes

Qb−1

j=a

if b > a, 1 if a = b, and 1/

Qa−1
j=b

if

We require the following definitions.
Definition 2.0.1

Define the lead term of a nonzero polynomial p ∈ K[z1 , . . . , zk ]

to be the nonzero term cz1n1 · · · zknk of p for which the degree vector (n1 , . . . , nk ) is
maximal in the standard ordering. The polynomial p is monic if the coefficient of
the lead term is 1.
For any γ = (γ1 , . . . , γk ) ∈ (K(z))k such that γi 6= 0 for each i ∈ {1, . . . , k}
and v = (v1 , . . . , vk ) ∈ Zk , we denote γ1v1 · · · γkvk by γ v .
Lemma 2.0.2

Let z = (z1 , . . . , zk ), let m ∈ Zk , and let p =

P

n∈Zk

cn z n ∈

K[z1 , . . . , zk ] be a polynomial. If the term cm z m is maximal in the sense that

10
z m | z n and m 6= n imply cn = 0, then for any v ∈ Qk , the coefficient of z m in pv
is equal to the coefficient cm of z m in p.
Proof. By the binomial theorem, if z m is not a proper divisor of z n , then the
coefficient of z m in (z + v)n − z n is 0. If z m is a proper divisor of z n , then cn = 0.
Hence, in either case, the coefficient of z m in cn ((z + v)n − z n ) is 0, and, hence,
P
the coefficient of z m in pv − p =
cn ((z + v)n − z n ) is 0.

Corollary 2.0.3

Corollary 2.0.4

If p ∈ K[z1 , . . . , zk ] is monic, then so is pv for any v ∈ Qk .

If p ∈ K(z1 , . . . , zk ) is nonzero, v ∈ Qk , c ∈ K, and pv = cp,

then c = 1.

2.1

Gosper’s lemma

We require the following adaptation of Petkovšek’s refinement [10] of Gosper’s
lemma [8].
Lemma 2.1.1

Let K be a field of characteristic 0, and let R ∈ K(z1 , . . . , zk ) be a

nonzero rational function. There exist polynomials A, B, C, and D ∈ K[z1 , . . . , zk ]
such that
R=

A C e1 D
B C D e1

and
(1) A and B ne1 are relatively prime for all n ∈ Z,
(2) A and CDe1 are relatively prime,
(3) B and C e1 D are relatively prime, and
(4) C and D are relatively prime.
Proof. The lemma is proved by a double application of Gosper’s lemma. The
gcds below are with respect to z1 . By Gosper’s lemma there exist a, b, and c ∈
a ce1
where gcd(a, bne1 ) = 1 for all nonnegative
K(z2 , . . . , zk )[z1 ] such that R =
b c
integers n and by Petkovšek’s refinement we may assume in addition that gcd(a, c) =

11
1 and gcd(b, ce1 ) = 1. Applying this principle again, this time to

b
, we can write
a

B de 1
b
=
a
A d

(1)

where A, B, d ∈ K(z2 , . . . , zk )[z1 ], gcd(B, Ane1 ) = 1 for all integers n > 0, gcd(B, d) =
1, and gcd(A, de1 ) = 1. Since gcd(B, Ad) = 1, it follows from (1) that B | b. Similarly, A | a. Hence, gcd(A, B ne1 ) = 1 for all nonnegative integers n. On the
other hand, since gcd(B, Ane1 ) = 1 for all nonnegative integers n, it follows that
gcd(A, B ne1 ) = 1 for all nonpositive integers n. Hence gcd(A, B ne1 ) = 1 for all integers n, positive, negative, or zero. Let g = gcd(c, d), let C = c/g, and let D = d/g.
A C e1 D
, gcd(A, CDe1 ) = 1, gcd(B, C e1 ) = 1, and
It’s easily seen that R =
B C D e1
gcd(C, D) = 1.
For some α and β ∈ K[z2 , . . . , zk ], αA and βB are in K[z]. Replace A with αβA
and B with αβB; the ratio A/B is unchanged, hence, R is unchanged. Similarly,
adjust C and D so that A, B, C, and D are in K[z]. If A and B have a common
factor d (which must be free of z1 ), we replace A and B by A/d and B/d. Since
d = dne1 it follows that A and B ne1 are relatively prime for n ∈ Z. If C has any
divisor d that is free of z1 , replace C with C/d. Since de1 = d, C e1 /C is unchanged.
Similarly, adjust D. If follows that A1 and CDe1 are relatively prime, B1 and C e1 D
A C e1 D
are relatively prime, C and D are relatively prime, and R =
.

B C D e1
Definition 2.1.2

Let R ∈ K(z1 , . . . , zk ) be a rational function. The rational

function R is said to be simple over K if it can be written in the form
R(z) = R̄(v · z) = R̄(v1 z1 + · · · + vk zk )
where R̄ ∈ K(z) is a univariate rational function and v ∈ Qk .
Hence, (z12 + z2 + 3z3 )2 is simple over Q(z1 ) but (apparently) not over Q. It’s
easily proved that it’s not simple over Q using Corollary 2.5.4.

12
Lemma 2.1.3

Let K be a field of characteristic 0, and let R1 , . . . , Rk ∈ K(z1 , . . . , zk )

be nonzero rational functions satisfying the relation
e

Ri Rjei = Rj Ri j
for all i, j ∈ {1, . . . , k}. Then there exist polynomials A1 , . . . Ak , B1 , . . . , Bk , C,
and D such that
Ri =

Ai C e i D
Bi C D ei

for i ∈ {1, . . . , k}, and the irreducible divisors of Ai and Bi are all simple for
i ∈ {1, . . . , k}.
Proof. The one-variable case of Lemma 2.1.3 is trivial. The proof of the twovariable case continues through section 2.4 and the proof of the higher dimensional
cases occupies sections 2.5 through 2.7.
We prove the two-variable case. In fact, we prove a stronger version of the
two-variable case that is needed for the proof of the higher dimensional cases: if
R1 =

Ā1 C̄ e1 D̄
B̄1 C̄ D̄e1

and Ā1 and B̄1ne1 are relatively prime for all n ∈ Z, then we may take A1 = Ā1 ,
B1 = B̄1 , C = C̄, and D = D̄. By Lemma 2.1.1, such Ā1 , B̄1 , C̄, and D̄ exist.
Thus, we assume that
R1 =

A1 C e 1 D
B1 C D e1

where
A1 and B1ne1 are relatively prime for all n ∈ Z.

(1)

C D e1
A1
. Let A2 and B2 be relatively prime
. Thus, r1 =
e
C 1 D
B1
A2
. Using R1 R2e1 = R2 R1e1 and the definition of ri , it’s
polynomials such that r2 =
B2
easily verified that r1 r2e1 = r2 r1e2 and, hence,
Let ri = Ri

(2)

A1 Ae2 1 B1e2 B2 = Ae1 2 A2 B1 B2e1 .

We will show that the irreducible divisors of the left side of (2) are simple.

13

2.2

The divisibility lattice path

For any irreducible divisor d we construct a lattice path {Ti } in Z2 such that for all
i > 0, dTi divides one of the four factors on the left side of (2). Further, the factor
Ti divides is determined by the value of Si = Ti − Ti−1 , which, since Ti is a lattice
path, is one of the four directions e1 , −e1 , e2 , and −e2 .
To be precise, define
X(−e2 ) = A1 ,

X(e1 ) = Ae2 1 ,

X(e2 ) = B1e2 ,

X(−e1 ) = B2 .

We will construct Ti so that
dTi | X(Si ),

(3)

where Si = Ti − Ti−1 .

The product of the values of X is the left side of (2). It will be useful to also define
Y (−e2 ) = Ae2 1 ,

Y (e1 ) = A2 ,

Y (e2 ) = B1 ,

Y (−e1 ) = B2e1

so that the product of the values of Y is the right side of (2). The relationship
between terms on the left side of (2) and terms on the right side is captured by the
shift relation
(Y (v))v = X(v)

(4)
and coprimeness condition
(5)

X(v) and Y (−v)) are relatively prime

for v ∈ {±e1 , ±e2 }, which are easily verified.
We construct the lattice path {Ti } by induction. Let an irreducible divisor d
of the left side of (2) be given. Since d is irreducible, d must divide X(v) for some
v ∈ {±e1 , ±e2 }. Define T0 = 0 and S0 = v. Thus, dT0 | X(S0 ). Now assume
inductively that Ti and Si have been defined for 0 6 i 6 j. Since dTj divides

14
the left side of (2), it must also divide the right side, and since dTj is irreducible,
dTj | Y (v) for some v ∈ {±e1 , ±e2 }. Let Sj+1 = v and let Tj+1 = Tj + Sj+1 .
Since dTj | Y (Sj+1 ), it follows that dTj +Sj+1 | (Y (Sj+1 ))Sj +1 , and hence dTj+1 |
X(Sj+1 ) by (4). This completes the induction step. We have constructed Ti and
Si satisfying (3).

2.3

What goes up must not come down

Having constructed the path T , we explore what restrictions the coprimeness conditions (5) and (1) impose on the shape of T .
From the condition (5) we deduce path T does not traverse the same segment
of the lattice path in opposite directions. By the path T traversing a segment of the
lattice in the direction v, we mean for some i > 1, the end points of the segment
are Ti−1 and Ti , and Ti − Ti−1 = v.
Suppose to the contrary the path traverses the same segment in opposite directions. Then for some i and j > 0 we have Si = −Sj and Ti = Tj−1 . By (3),
dTj | X(Sj ), hence, by (4), dTj−1 | Y (Sj ), hence dTi | Y (Sj ), and hence dTi | Y (−Si ).
But dTi | X(Si ) which contradicts condition (5).
Taking j = i + 1 we see that the path can’t reverse directions without going in
a perpendicular direction first (Si 6= −Si+1 ).
From the condition (1) we deduce that the path T doesn’t go up a segment and
come down one of its horizontal translates. (By go up and come down, we mean
traverse in the directions e2 and −e2 , respectively.) Suppose the contrary. Then
for some i and j > 0 and n ∈ Z we have Si = −e2 , Sj = e2 , and Ti = Tj−1 + ne1 .
By (3), dTj | X(Sj ), hence by (4) dTj−1 | Y (Sj ), hence dTi −ne1 | Y (Sj ), hence by
the definition of Y , dTi −ne1 | B1 , and hence dTi | B1ne1 . But dTi | X(Si ) = A1 ,
which contradicts (1).
The condition that the path T doesn’t go up a segment and come down one of

15
its horizontal translates immediately implies a stronger condition:
(6)

If T goes up any segment, it must not come down any segment.

Suppose to the contrary T goes up to Ti and down to Tj (Si = e2 and Sj = −e2 ),
and assume that |i − j| is minimal. By the minimality of |i − j|, Sk 6= ±e2 for
any k between i and j. It follows that the segments (Ti−1 , Ti ) and (Tj−1 , Tj ) are
horizontal translates of each other, contradicting the original condition.
Finally, from (6) it’s easy to deduce that the path T is unbounded. If the
path is unbounded vertically, we are done. Thus, we may assume that for some
k > 0, |Ti · e2 | 6 k for all i. It follows from (6) that the path can go in a vertical
direction at most k times. Since the path can’t reverse direction without going in
a perpendicular direction first, the path can change horizontal direction at most k
times. Hence the path is unbounded horizontally.

2.4

The divisor d is simple.

Using the fact that the path T is unbounded, we show that it satisfies a nontrivial
relation d = dv for some v ∈ Z2 . By the fact that T is unbounded, the set
T = {Ti : i > 0} of values assumed by T is infinite. Let P be the left side of (2).
For every t ∈ T , dt | P . Since T is infinite and P has only finitely many monic
divisors, cdt1 = dt2 for some t1 and t2 ∈ T and c ∈ K. By Corollary 2.0.4, c = 1.
Letting v = t1 − t2 , we have dv = d.
Using the equation d = dv , we show that d is the composition of a univariate
polynomial and a linear polynomial:
(7)

d(z1 , z2 ) = p(v2 z1 − v1 z2 ) where p ∈ K[z].

We may assume without loss of generality that v2 6= 0. Define
q(z1 , z2 ) = d(z1 + v1 z2 , v2 z2 ).

16
Thus, q = q e2 . Iterating the last equation, q = q ne2 for all positive integers n.
Thus, q(z1 , z2 ) = q(z1 , z2 + n) identically. The left side of the last equation is
free of n and the right side is symmetric in n and z2 ; thus, the left side must
also be free of z2 . Hence q is free of its second argument. It’s easily verified that
d(z1 , z2 ) = q(z1 − (v1 /v2 )z2 , z2 /v2 ). Letting p(z) = q(z/v2 , 0), (7) is proved and,
hence, d is simple.
This completes the proof of the two-variable case.

2.5

The rational Galois space of a rational function

We require the following definitions and lemmas for the proof of the k > 2 case of
Lemma 2.1.3.
Definition 2.5.1

Let S = {x1 , . . . , xk } be a finite set that is algebraically inde-

pendent over K, and let R ∈ K(S) be a rational function in x = (x1 , . . . , xk ). We
define the rational Galois space of R over K with respect to x to be the set
rgal(R, x, K) = {v ∈ Qk : R(x + v) = R(x)}.
We write rgal(R) for rgal(R, z, K); thus, rgal(R) = {v ∈ Qk : Rv = R}.
Let G be the Galois group of K(x) over K. It’s easily seen that rgal(R, x, K) is
isomorphic to the subgroup {g ∈ G : g(R) = R and g(xi ) − xi ∈ Q for i ∈ {1, . . . , k}}
of G.
We show that the rational Galois space is a subspace of Qk . It’s clearly closed
under vector addition. By iterating Rv = R, it follows that Rnv = R for any
positive integer n. Writing R = A/B where A and B are polynomials, it follows
that AB nv = BAnv for all positive integers n. Each side of the last equation is a
polynomial in n. Thus, AB nv = BAnv identically. Hence Rnv = R for all n ∈ Q
and the rational Galois space is closed under multiplication by scalars.
Lemma 2.5.2

Let R ∈ K(z1 , . . . , zk ) be a rational function such that ej ∈

rgal(R). Then R is free of zj .

17
Proof. Since R = Rnej for all n ∈ Q, it follows that
R(z1 , . . . , zk ) = R(z1 , . . . , zj + n, . . . , zk )
identically. The left side is free of n and the right side is symmetric in zj and n, so
the left side must be free of zj .
Lemma 2.5.3



Let R ∈ K(z1 , . . . , zk ) be a rational function and let M be an

r × k matrix over Q. If the kernel of M is equal to the rational Galois space of R,
then there exists a rational function R̄ ∈ K(z1 , . . . , zr ) such that R(z) = R̄(M z).
Proof. Let A and B be invertible k × k and r × r matrices respectively such
that the r × k matrix AM B is of the form


Ij,j
AM B =
Zr−j,j

Zj,k−j
Zr−j,k−j



where j is the rank of M , Ij,j is the j × j identity matrix, and Zℓ,m is the ℓ × m zero
matrix. Since j is the rank of M , it follows that j 6 r. Let R1 (z) = R(Bz). Then
rgal R1 = B −1 rgal R = B −1 ker M = ker M B = ker AM B = span(ej+1 , . . . , ek ).
By Lemma 2.5.2, R1 (z) is free of zj+1 , . . . , zk . It follows that R1 (z) = R̄1 (AM Bz),
where R̄1 ∈ K(z1 , . . . , zr ) is defined by
R̄1 (z1 , . . . , zr ) = R1 (z1 , . . . , zk ) = R1 (z1 , . . . , zj , 0, . . . , 0).
Letting R̄(z) = R̄1 (Az), we have R1 (z) = R̄(M Bz). Hence R(z) = R1 (B −1 z) =
R̄(M z) as claimed.
Corollary 2.5.4


A nontrivial rational function R ∈ K(z1 , . . . , zk ) is simple if

and only if the dimension of rgal R is k − 1.
Proof. If R is simple, then there exists v ∈ Qk and a univariate rational
function r ∈ K(z) such that R(z) = r(z · v). Clearly rgal R contains the space
orthogonal to v, and thus dim rgal R > k − 1. If the dimension were k, then R
would be trivial; therefore, the dimension must be k − 1.

18
Conversely, if the dimension of rgal(R) is k − 1, there exists a 1 × k matrix
v = [v1 , . . . , vk ] with kernel equal to rgal R. By Lemma 2.5.3, R(z) = R̄(v · z) =
R̄(v1 z1 + · · · + vk zk ), so R is simple.
Lemma 2.5.5



Let d and A ∈ K[z1 , . . . , zk ] be polynomials. If d | A, then

rgal d ⊇ rgal A.
Proof. Suppose the contrary. Then the quotient space rgal A/(rgal A ∩ rgal d)
is infinite. Let S be a set of representatives of the cosets.
For any s ∈ S, A−s = A, hence d | A−s , hence ds | A. Since S is infinite and
A has only finitely many monic divisors, ds1 = cds2 for some s1 and s2 ∈ S and
c ∈ K. Letting s = s1 − s2 , ds = cd and, by a corollary of Lemma 2.0.2, c = 1. But
ds1 = ds2 , contradicting the definition of s.
Corollary 2.5.6



If A and B ∈ K[z1 , . . . , zk ] are polynomials such that rgal A =

rgal B = s, then rgal AB = s.
Proof. By Lemma 2.5.5, rgal AB ⊆ s. But clearly rgal AB ⊇ s, so rgal AB =
s.



Lemma 2.5.7

If A and B ∈ K[z1 , . . . , zk ] are relatively prime polynomials, then
rgal

A
⊆ rgal A ∩ rgal B.
B

Proof. Suppose the contrary. Then the quotient space

A
A
rgal
(rgal ∩ rgal A ∩ rgal B)
B
B
is infinite. Let S be a set of representatives of the cosets, and let s1 and s2 ∈ S.
Since (A/B)s1 = (A/B)s2 , letting s = s1 −s2 it follows that (As /B s ) = (A/B).
Hence AB s = BAs . Since A and B are relatively prime, A | As . Similarly, As | A.
Hence A = cAs , and hence, by corollary 2.0.4 of Lemma 2.0.2, c = 1. Hence A = As .
Similarly, B = B s . Hence s1 − s2 = s ∈ rgal(A/B) ∩ rgal A ∩ rgal B, contradicting
the definition of s1 and s2 .



19
Lemma 2.5.8

Every rational function R ∈ K(z1 , . . . , zk ) can be written as a

product
R=g

Y As
,
Bs

s∈S

where S is the collection of all proper subspaces of Qk , g ∈ K, and, for all s ∈ S,
As and Bs ∈ K[z1 , . . . , zk ] are relatively prime monic polynomials such that if d is
a nontrivial divisor of As or Bs , then rgal(d) = s. This expression is unique.
Of course, As = Bs = 1 for all but a finite number of s ∈ S.
Proof. We first show that such a factorization exists. Let R = gA/B, where
A and B are relatively prime monic polynomials and g ∈ K. Write A and B as
products of nontrivial irreducible monic factors
A = a1 a2 · · · am and B = b1 · · · bn , m, n > 0.
For all s ∈ S let As be the product of all ai such that rgal(ai ) = s, with
the understanding that empty products are 1. Similarly define Bs . Clearly A =
Q
Q
s∈S As and B =
s∈S Bs . Hence
R=g

Y As
Bs

s∈S

and As and Bs are relatively prime.
Let d be a nontrivial monic divisor of As or Bs . Then d can be expressed as a
product of a subset of the ai for which rgal ai = s and the bi for which rgal bi = s.
Hence, by the corollary of Lemma 2.5.5, rgal d = s.
We show that the factorization is unique. Let
(1)

R=g

Y Cs
Y As
and R = h
Bs
Ds
s∈S

s∈S

be two factorizations satisfying the conditions of the lemma. We will show that
g = h and As = Cs and Bs = Ds for all s ∈ S. By (1),
(2)

g

Y

As

Y

Ds = h

Y

Bs

Y

Cs .

20
For any t ∈ S, At is relatively prime to

Q

s6=t

Bs

Q

s6=t

Cs since any nontrivial

irreducible divisor d of the former has rgal(d) = s and any nontrivial divisor d of
the latter has rgal(d) 6= s. Since At and Bt are relatively prime by assumption, it
follows that At | Ct . Similarly Ct | At . Hence Ct = At . Similarly Bt = Dt . It
follows that g = h.

2.6



Fixed factors

The complementary idea to the rational Galois space is the fixed factor.
Definition 2.6.1

Using Lemma 2.5.8, we define the fixed factor fixs (R) of a

rational function R ∈ K(z1 , . . . , zk ) for a subspace s of Qk . Let S be the set of
Q
all proper subspaces of Qk . Let R = g s∈S (As /Bs ) be the unique expression
guaranteed by Lemma 2.5.8. Define
(
fixs (R) =

Lemma 2.6.2

As
Bs

for all s ∈ S

g

for s = Qk .

Let R ∈ K(z1 , . . . , zk ) be a rational function and let s be a

subspace of Qk . Then
rgal fixs R = s
unless fixs R = 1.
Proof. If fixs R 6= 1 then either fixs R has a nontrivial divisor or fixs R = c
for some c ∈ K, c 6= 1. In the first case, rgal fixs R ⊆ rgal d = s by Lemma 2.5.5.
But clearly rgal fixs R ⊇ s, so rgal fixs R = s. In the second case, s = Qk and
rgal c = Qk .
Lemma 2.6.3


For any nonzero rational functions R1 and R2 ∈ K(z1 , . . . , zk ),

any subspace s of Qk , and any v ∈ Qk
(1) fixs R1 R2 = fixs R1 fixs R2
1
1
=
(2) fixs
R1
fixs R1
v
(3) fixs R1 = (fixs R1 )v

21
Proof. Let S be the set of proper subspaces of Qk . Let R3 = R1 R2 , R4 =
1/R1 , and R5 = R1v . For i = 1, 2, 3, 4, and 5 let
Ri = g i

Y Ai,s
Bi,s

s∈S

be the unique expression guaranteed by Lemma 2.5.8.
(1): Since R3 = R1 R2 , it follows that
g3

Y A3,s
Y A1,s A2,s
= g1 g2
.
B3,s
B1,s B2,s

s∈S

s∈S

Let Cs and Ds be relatively prime polynomials such that
Cs
A1,s A2,s
=
.
Ds
B1,s B2,s
Since Cs | A1,s A2,s and every nontrivial divisor of A1,s or A2,s has rgal d = s, it
follows by the corollary of Lemma 2.5.5 that every nontrivial divisor d of Cs has
rgal d = s. Similarly, every nontrivial divisor d of Ds has rgal d = s. It follows that
R3 = g 1 g 2

Y Cs
Ds

s∈S

is the unique expression guaranteed by Lemma 2.5.8, hence
Cs
A1,s A2,s
A3,s
=
=
·
B3,s
Ds
B1,s B2,s
for all s ∈ S. Hence fixs R3 = fixs R1 fixs R2 for all s ∈ S. Clearly g3 = g1 g2 since
the polynomials in (1) are monic, so fixs R3 = fixs R1 fixs R2 for s = Qk .
(2): We have
g4

Y A4,s
1
1 Y B1,s
= R4 =
=
.
B4,s
R1
g1
A1,s

s∈S

s∈S

It follows immediately that the factorization
R4 =

1 Y B1,s
g1
A1,s
s∈S

22
satisfies the conditions of the lemma, hence g4 = 1/g1 and
B1,s
A4,s
=
.
B4,s
A1,s
Hence fixs R4 = 1/(fixs R1 ) for all s ∈ S and for s = Qk .
(3): We have
Y A5,s
Y Av1,s
v
v
g5
= R5 = R1 = g 1
v .
B5,s
B1,s
s∈S

s∈S

Since rgal dv = rgal d for any polynomial d and any v ∈ Qk ,
R5 = g1v

Y Av1,s
v
B1,s

s∈S

satisfies the conditions of the lemma. Hence
g5 = g1v and

Av1,s
A5,s
= v
B5,s
B1,s

for all s ∈ S. Hence fixs R5 = (fixs R1 )v for all s ∈ S and for s = Qk .
Lemma 2.6.4



Let R1 , . . . , Rk ∈ K(z1 , . . . , zk ) be rational functions satisfying

the relation
e

Ri Rjei = Rj Ri j
for all i, j ∈ {1, . . . , k}. For i = 1, . . . , k and all subspaces s of Qk define Ri,s =
fixs (Ri ). Then for all subspaces s of Qk and all i, j ∈ {1, . . . , k},
e

ei
Ri,s Rj,s
= Rj,s Ri,sj .

Proof. By Lemma 2.6.3,
fixs Ri (fixs Rj )ei = fixs Ri Rjei
e

= fixs Rj Ri j
= fixs Rj (fixs Ri )ej .


23
Lemma 2.6.5

Let R1 , . . . , Rk ∈ K(z1 , . . . , zk ) be rational functions satisfying

the relation
e

Ri Rjei = Rj Ri j
for all i, j ∈ {1, . . . , k}. Let s be a proper subspace of Qk such that ei ∈ s. Then
fixs Ri = 1.
Proof. By Lemma 2.6.4, for j ∈ {1, . . . , k},
fixs Rj
fixs Ri
=
(fixs Ri )ej
(fixs Rj )ei
fixs Rj
=
fixs Rj
= 1.
Hence ej ∈ rgal fixs Ri . By Lemma 2.6.2, either fixs Ri = 1 or rgal fixs Ri = s. In
the first case we are done. In the second case ej ∈ s for all j ∈ {1, . . . , k}. Hence
s = Qk , contradicting the assumption that s is a proper subspace.

2.7



Proof of Lemma 2.1.3 for k > 2

Now we are in a position to prove the case k > 2 of Lemma 2.1.3. We proceed by
induction. Assume the case of k − 1 variables is proved. Let
R1 =

A1 C1 D1e1
B1 C1e1 D1

as in Lemma 2.1.1. Let Ki,j = K({z1 , . . . , zk }\{zi , zj }) and let Qi,j be the subspace
of Qk generated by ei and ej . Let r1 = A1 /B1 .
Let i ∈ {2, . . . , k}. Applying the strong version of the two-variable case of
Lemma 2.1.3 to R1 and Ri over the field K1,i , it follows that we can write
Ri =

Ai C1 D1ei
,
Bi C1ei D1

where the irreducible divisors of A1 , Ai , B1 , and Bi are all simple over K1,i . The
point of using the strong version of the two-variable case is that the same C1 and
D1 can be used for all i ∈ {2, . . . , k}.

24
Let d be a nontrivial irreducible divisor of A1 or B1 . The subspace rgal(d)∩Q1,j
of Q1,j is isomorphic to the subspace rgal(d, (z1 , zj ), K1,j ) of Q2 . Hence rgal(d)∩Q1,j
is a one-dimensional subspace of Q1,j by Lemma 2.5.3. Let s = rgal(d). Let
ri = Ai /Bi for i ∈ {2, . . . , k}. It’s easily verified that ri satisfies
e

ri rjei = rj ri j
for i, j ∈ {1, . . . , k}, hence, by Lemma 2.6.5, if e1 ∈ s then fixs R1 = 1. But
fixs R1 = 1 implies fixs A1 = fixs B1 = 1, which implies d = 1. Since d is nontrivial,
e1 ∈
/ s.
Let vi be a nonzero vector in rgal d ∩ Q1,i . Since e1 ∈
/ s, it follows that
Pk
ei · vi 6= 0. Let t = i=2 ci vi . It is easily seen that the vectors v2 , . . . , vk are

linearly independent: if cj 6= 0, then ej · t = cj (ej · vj ) is nonzero, hence t is
nonzero.
It follows that the dimension of rgal(d) is at least k − 1. By Lemma 2.5.3, d is
simple over K. We have shown all the nontrivial irreducible divisors of A1 and B1
are simple over K.
Define R̄i and R̃i by
R̄i =

Y

fixs ri

and
R̃i =

Y′

fixs ri

where the first product is taken over all subspaces s of Qk such that e1 ∈
/ s, and
the second is taken over all subspaces such that e1 ∈ s. Hence ri = R̄i R̃i . It follows
from Lemma 2.6.4 that
e

R̄i R̄jei = R̄j R̄i j
and
e

R̃i R̃jei = R̃j R̃i j

25
for all i, j ∈ {1, . . . , k}.
Let Āi and B̄i be relatively prime polynomials such that R̄i = Āi /B̄i . We claim
that the irreducible divisors of Āi and B̄i are simple. By Lemma 2.6.5, R̃1 = 1.
Hence R̄1 = r1 , and hence the irreducible divisors of Ā1 = A1 and B̄1 = B1 are
simple. Let d be an irreducible divisor of Āi or B̄i for i ∈ {2, . . . , k}, and let
s = rgal(d). If the dimension of s is less than k − 1, then fixs R̄1 = 1 since all the
irreducible divisors of Ā1 and B̄1 are simple and, by Lemma 2.5.3, have rational
Galois spaces of dimension k or k − 1. By Lemma 2.6.4,
fixs R̄i
fixs R̄1
= 1,
e1 =
fixs R̄i
fixs R̄1ei
so e1 ∈ rgal(fixs R̄i ). Hence e1 ∈ s by Lemma 2.6.2, which contradicts the definition
of R̄i , so the dimension of rgal d is k − 1 or k and d is simple by Lemma 2.5.3.
By Lemma 2.5.2, R̃i is free of zi for all i ∈ {1, . . . , k}. Inductively applying
the k − 1 variable case of Lemma 2.1.3 to R̃2 , . . . , R̃k ∈ K(z2 , . . . , zk ), there exist
C̃ and D̃ such that
(1)

R̃i =

Ãi C̃ D̃ei
B̃i C̃ ei D̃

for i ∈ {2, . . . , k}, and the irreducible divisors of Ãi and B̃i are simple over K. Let
Ã1 = B̃1 = 1. Then (1) is true for i = 1.
Letting C = C1 C̃, D = D1 D̃, ai = Āi Ãi , and bi = B̄i B̃i ,
Ri =

ai C D ei
bi C e i D

where the irreducible divisors of ai and bi are all simple. This completes the proof
of Lemma 2.1.3.



26

2.8

The multiplicative structure of Ri

Let R1 , . . . , Rk ∈ K(z1 , . . . , zk ) be simple rational functions with

Lemma 2.8.1

the same rational Galois space such that
e

Ri Rjei = Rj Ri j

(1)

for all i, j ∈ {1, . . . , k}. Then there exist v ∈ Zk , a univariate rational function
t ∈ K(z), and c1 , . . . , ck ∈ K such that
Ri (z1 , . . . , zk ) = ci

Y vi
j

for i ∈ {1, . . . , k}.

0

t(v · z + j)

Proof. Let s = rgal Ri . The case s = Qk is trivial: if s = Qk , then Ri ∈ K
for all i ∈ {1, . . . , k}, so we may take ci = Ri , t = 1, and v = 0.
We consider the case s 6= Qk . By the corollary of Lemma 2.5.3 the dimension
of s is k − 1. Hence, there exists a vector v ∈ Zk with gcd(v) = 1 such that the
kernel of the 1 × k matrix v is s. By Lemma 2.5.3, for all i ∈ {1, . . . , k} there exist
univariate ri ∈ K(z) such that Ri (z) = ri (v · z).
Since gcd(v) = 1, there exists w ∈ Zk such that w · v = w1 v1 + · · · wk vk = 1.
For any univariate rational function r ∈ K(z) and any n ∈ Z, the rational function
r (n) ∈ K(z) is defined by r (n) (z) = r(z + n). Define
t=

Y w1
i

0

(v1 i)

r1

Yw2
i

0

(v1 w1 +v2 i)

r2

We claim that Ri (z1 , . . . , zk ) =

Y wk
i

Qvi
j

Since

···

0

t

(j)

0

(v1 w1 +···vk−1 wk−1 +vk i)

rk

(1)

(v · z). We first show that ri /ri

e

Ri j (z1 , . . . , zk ) = (r(v · z))ej
= r(v · z + v · ej )
= r(v · z + vj )
= r (vj ) (v · z),

.
= t/t(vi ) .

27
it follows from (1) that
ri
(vj )
ri

=

rj
(vi )
rj

for all i, j ∈ {1, . . . , k}. Hence
t
t(vj )

=

Y w1
0

i

r1
(vj )

r1

!(v1 i)

Y w2
i

0

r2
(vj )

r2

!(v1 w1 +v2 i)

···

=

Y w1
0

i

rj
(v )
rj 1

!(v1 i)

Yw2
i

0

rj
(v2 )
rj

Ywk

=
=
=

(v1 w1 )

rj

Ywk

(v1 w1 +v2 w2 )

rj

0

rj
(vk )

rj

!(v1 w1 +···+vk−1 wk−1 +vk i)

(v1 w1 +···+vk−1 wk−1 )

(v1 w1 )

rj

·

!(v1 w1 +···+vk−1 wk−1 +vk i)

···

i

(0)

rk

(v )
0
rk j
i
!(v1 w1 +v2 i)

···
rj

···

···

rj

(v1 w1 +···+vk wk )

rj

rj
(v w1 +···+vk wk )

rj 1
rj
(1)

rj

since v1 w1 + · · · + vk wk = 1.
Qv
Qv
(1)
We show that rj = cj 0j t(i) . Since rj /rj = t/t(vj ) , letting Tj = 0j t(i) it
follows that

(1)
rj /rj

=

i
(1)
Tj /Tj ;

i

hence (rj /Tj ) = (rj /Tj )

(1)

. It follows by Lemma 2.5.2
Qv
that rj /Tj = cj for some cj ∈ K. Thus, Rj (z1 , . . . , zk ) = rj (v · z) = ci 0j t(j) (v ·
j
Qvj

z) = ci 0 t(v · z + j).
j

Lemma 2.8.2 summarizes the results of this section thus far.

Lemma 2.8.2

Let R1 , . . . , Rk ∈ K(z1 , . . . , zk ) be rational functions satisfying

the relation
e

Ri Rjei = Rj Ri j
for all i, j ∈ {1, . . . , k}. For each subspace s of Qk let Ri,s = fixs Ri .

28
(1) If the dimension of s is less than k − 1, then there exists a rational function
r ∈ K(z1 , . . . , zk ) such that for all i ∈ {1, . . . , k},
Ri,s = r/r ei .

(2) If the dimension of s is k − 1 then there exists a univariate rational function
t ∈ K(z), c1 , . . . , ck ∈ K, and a vector v ∈ Zk such that for all i ∈ {1, . . . , k}
Ri,s = ci

Yvi
j

0

t(v · z + j).

(3) If the dimension of s is k then Ri,s ∈ K for all i ∈ {1, . . . , k}.
Q
(4) Ri =
s Ri,s for all i ∈ {1, . . . , k}, where the product is taken over all
subspaces s of Qk .
Proof. Write
Ri =

C D e i Ai
C ei D Bi

as in Lemma 2.1.3 and let Cs = fixs C, Ds = fixs D, Ai,s = fixs Ai , and Bi,s =
fixs Bi . By Lemma 2.6.3
Ri,s =

Cs Dsei Ai,s
.
Csei Ds Bi,s

(1) If the dimension of s is less than k − 1, then Ai,s = Bi,s = 1 since the
irreducible divisors of Ai and Bi are simple. Hence Ri,s = r/r ei where r = Cs /Ds .
(2) If the dimension of s is k − 1 then R1,s , . . . , Rk,s are simple by the corollary
of Lemma 2.5.3. By Lemma 2.6.4
e

ei
= Rj,s Ri,sj ,
Ri,s Rj,s

hence, by Lemma 2.8.1, there exist c1 , . . . , ck ∈ K, v ∈ Zk , and t ∈ K(z) such that
Ri,s = ci

Yvi
j

0

t(v · z + j)

29
for i ∈ {1, . . . , k}.
(3) By Lemma 2.5.2, ri,s is free of z1 , . . . , zk , and thus constant.
(4) This is immediate from Lemma 2.5.8.
Lemma 2.8.3



Let R1 , . . . , Rk ∈ K(z1 , . . . , zk ) be rational functions satisfying

the relation
e

Ri Rjei = Rj Ri j
for all i and j ∈ {1, . . . , k}. There exist a rational function r ∈ K(z1 , . . . , zk ),
constants c1 , . . . , ck ∈ K, finitely many vectors v1 , . . . , vm ∈ Zk , and corresponding
univariate rational functions t1 , . . . , tm ∈ K(z) such that for all i ∈ {1, . . . , k},
Ri (z) = ci

m
r(z) Y Yvℓ,i
tℓ (vℓ · z + j).
0
r ei (z)
ℓ=1 j

Proof. For each subspace of s of Qk and i ∈ {1, . . . , k} let Ri,s = fixs Ri . Let
s1 , . . . , sm be the subspaces s of Qk of dimension k − 1 such that Ri,s 6= 1 for some
i ∈ {1, . . . , k}. Let t1 , . . . , tn be the subspaces of Qk of dimension less than k − 1
such that Ri,s 6= 1 for some i ∈ {1, . . . , k}.
By Lemma 2.8.2 (2), for each ℓ, 1 6 ℓ 6 m, Ri,sℓ =

Qvℓ,i
j

0

tℓ (vℓ · z + j) for some

vℓ ∈ Zk and tℓ ∈ K(z). By Lemma 2.8.2 (1), for each p, 1 6 p 6 n, there exists
Qn
rp ∈ K(z1 , . . . , zk ) such that for i ∈ {1, . . . , k}, Ri,tp = rp /rpei . Let r = p=1 rp .

Let ci = Ri,Qk for i ∈ {1, . . . , k}. By Lemma 2.8.2 (4),

Ri,s = ci Ri,t1 · · · Ri,tn Ri,s1 · · · Ri,sm
m
rt1
rtn Y
= ci ei · · · ei
Ri,sℓ
rt1
rtn
= ci

Theorem 2.8.4

r
r ei

ℓ=1
m
Y Yvℓ,i

ℓ=1 j

0

tℓ (vℓ · z + j).


[Ore–Sato] Let R1 , . . . , Rk ∈ K(z) be rational functions such

that
e

Ri Rjei = Rj Ri j

30
for all i, j ∈ {1, . . . , k}. Then there exist polynomials C and D ∈ K[z], a finite set
V ⊂ Zk , and univariate polynomials av and bv ∈ K[z] for each v ∈ V such that for
all i ∈ {1, . . . , k},
Ri (z) =

Y Yvi av (z · v + j)
C(z + ei ) D(z)
.
0 bv (z · v + j)
C(z) D(z + ei )
j
v∈V

Proof. The ci from Lemma 2.8.3 can be absorbed into the product by noting
that
Yei ·w
j

0

ci =



ci

if w = ei ,

1

if w ∈ {e1 , . . . , ek } \ {ei }.

The rest is just a change of notation.
Corollary 2.8.5



For all w ∈ Zk , let Rw ∈ K(z) be rational functions such that
v
Rv+w = Rv Rw

for all w and v ∈ Zk . Then there exist polynomials C and D ∈ K[z], a finite set
V ⊆ Zk , and univariate polynomials av and bv ∈ K[z] for each v ∈ V such that for
all w ∈ Zk ,
Rw (z) =

Y Yv·w av (z · v + j)
C(z + w) D(z)
.
0
C(z) D(z + w)
b
(z
·
v
+
j)
v
j
v∈V

v
Proof. By symmetry, Rv+w = Rw Rvw , hence, Rw Rvw = Rv Rw
. Letting Ri =
e

Rei for i ∈ {1, . . . , k}, we have Ri Rjei = Rj Ri j . It follows by Theorem 2.8.4 that
there exist polynomials C, D ∈ K[z], a finite set V ∈ Z, and univariate polynomials
av and bv for v ∈ V such that
Rw (z) =

Y Yv·w av (z · v + j)
C(z + w) D(z)
0
C(z) D(z + w)
bv (z · v + j)
v∈V

j

for w ∈ {e1 , . . . , ek }. Let R̄w (z) be the right side of the last equation. Thus
Rw = R̄w for w ∈ {e1 , . . . , ek }.
We show that Rw = R̄w for all w ∈ Zk . It’s clear that R0 = 1 and R̄0 = 1 so
u
R0 = R̄0 . We show that R̄u+w = R̄u R̄w
.

31

u
R̄u R̄w

=c c

u

D
C Du

u wC

u

= cu+w



Cw D
C Dw
w+u


u
u Y Y
v·u av (v · z + j) Yv·w av (v · z + j)
0
0
bv (v · z + j)
bv (v · z + j)
j
j
v∈V

u

Y Yv·u av (v · z + j) Yv·w av (v · (z + u) + j)
C D C
D
0
0
C Du C u Dw+u
bv (v · z + j)
bv (v · (z + u) + j)
v∈V

= cu+w
= cu+w

C

u+w

C
C

= R̄u+w .

u+w

C

D

Du+w
D
Du+w

j

j

Y Yv·u av (v · z + j) Yv·w+v·u av (z · v + j)
0
bv (v · z + j) j v·u
bv (z · v + j)
j

v∈V

Y Yv·(u+w) av (z · v + j)
0
bv (z · v + j)
j

v∈V

u
u−w
Substituting u − w for u in Ru+w = Ru Rw
, it follows that Ru−w = Ru /Rw
.
u−w
Similarly R̄u−w = R̄u /R̄w
. It follows that if Ru = R̄u and Rw = R̄w then

Ru+w = R̄u+w and Ru−w = R̄u−w . Thus, it follows by induction that Ru = R̄u
for all u ∈ Zk .



Chapter 3
The Multiplicative Structure
of a Hypergeometric Term

The main results of this chapter are Theorem 3.7.1 and its corollary for algebraically
closed fields, Corollary 3.7.3.
Theorem 3.7.1 Let f be an honest hypergeometric term on Zk . There exist
relatively prime polynomials C and D ∈ K[z], a finite set V ⊂ Zk , univariate polynomials av , bv ∈ K[z], v ∈ V (all of which can be determined as in Theorem 3.1.8),
and a finite number of polyhedral regions R1 , . . . , Rm such that
(1) Zk is the disjoint union of the Ri and a set of measure zero;
(2) for each i ∈ {1, . . . , m} there exists z0 ∈ Ri such that C(z0 ) 6= 0, and for all
z ∈ Ri for which D(z) 6= 0,
f (z) = f (z0 )

C(z) D(z0 ) Y Yz·v av (j)
.
z0 ·v bv (j)
C(z0 ) D(z)
j
v∈V

(3) all the terms av (j) and bv (j) occurring in the product are nonzero.
The hypergeometric terms that occur in practice can be expressed as products
of Pochhammer symbols, so the question arises: Is this true in general? Corollary 3.7.3 show that if the field K is algebraically closed and the hypergeometric
term is honest, then the answer is yes, at least piecewise.
Corollary 3.7.3 Let f be an honest hypergeometric term on Zk over a field
K that is algebraically closed. Then there exist relatively prime polynomials C
and D ∈ K[z] (as in Theorem 3.7.1) and a finite number of polyhedral regions
R1 , . . . , RL such that Zk is the union of the Rℓ and a set of measure zero, and for
each region Rℓ there exist a vector γ ∈ K k , constants m1 , . . . , mp , n1 , . . . , nq ∈ K,
vectors v1 , . . . , vp , w1 , . . . , wq ∈ Zk , and integers r1 , . . . , rp , s1 , . . . , sq such that

33
(1) for all z ∈ Rℓ such that D(z) 6= 0,
f (z) =

γ1z1

· · · γkzk

Qp
C(z) i=1 (mi )vi ·z+ri
Q
;
D(z) qj=1 (nj )wj ·z+sj

(2) for all i and j and z ∈ Rℓ , vi · z + ri and wj · z + sj are positive;
(3) the Pochhammer symbols occurring in the products are nonzero.

3.1

Hypergeometric terms and term ratios

Definition 3.1.1

A hypergeometric term on Zk over a field K is a function

f : Zk → K such that for i ∈ {1, . . . , k} there exist nonzero polynomials A1 , . . . , Ak
and B1 , . . . , Bk ∈ K[z] such that
Ai (z)f (z) = Bi (z)f (z + ei )
for every z ∈ Zk .
Unfortunately, the definition of a hypergeometric term includes some pathological functions. For example, if f is any function f : Zk → K that is supported
by the set of zeros of a nonzero polynomial p, then p(z)f (z) = 0 for all z, that
is, pf = 0. It follows that pei f ei = 0 for i ∈ {1, . . . , k}, and hence pf = pei f ei
for i ∈ {1, . . . , k}. By Definition 3.1.1, f (z) is a hypergeometric term. Such a
hypergeometric term is called a zero divisor.
Definition 3.1.2

A function f on Zk is a zero divisor if there exists a nonzero

polynomial p ∈ K[z] such that pf = 0.
Lemma 3.1.3

If f is a hypergeometric term on Zk , then for all v ∈ Zk , there

exist nonzero polynomials Av and Bv ∈ K[z] such
Av f = B v f v .
Proof. We prove the lemma by induction. By the definition (3.1.1) of hypergeometric term, the statement of the lemma is true if v = ei , i ∈ {1, . . . , k},

34
and clearly the statement is true if v = 0. We complete the induction by showing
that if the statement is true for v = u and v = w, then it is true for v = u + w
u
and v = u − w. Taking Au+w = Au Au
w and Bu+w = Bu Bw , we have Au+w f =
u
u
u w+u
Au Au
= Bu (Aw f )u = Bu (Bw f w )u = Bu Bw
f
= Bu+w f u+w .
w f = Aw B v f
u−w
u−v
Similarly, taking Au−w = Au Bw
and Bu−w = Bu Au−w
, Au−w f = Au Bw
f=
w
u−w
Bw
Bu f u = Bu (Bw f w )u−w = Bu (Aw f )u−w = Bu Au−w
f u−w = Bu−w f u−w .
w


Definition 3.1.4

For any hypergeometric term f on Zk and any v ∈ Zk , a

rational function Rv ∈ K(z) is a term ratio in the direction v if
Rv =

Av
Bv

for some nonzero polynomials Av , Bv ∈ K[z] such that Av f = Bv f v .
Thus, by Lemma 3.1.3, a term ratio exists for each v. Of course, we use the
term term ratio because
Av (z)
f v (z)
=
= Rv (z)
f (z)
Bv (z)
for all z such that f (z) 6= 0 and Bv (z) 6= 0. The following lemma shows that if f
is not a zero divisor then the term ratio for f in the direction v is unique.
Lemma 3.1.5

If a hypergeometric term f on Zk is not a zero divisor, then for

each v ∈ Zk there is a unique term ratio in the direction v.
Proof. Let Rv and R̄v be two term ratios for f in the direction v. Then
Rv =

Av
Āv
and R̄v =
Bv
B̄v

where Av f = Bv f v and Āv f = B̄v f v . From the last two equations it follows that
(B̄v Av −Bv Āv )f = 0. Since f is not a zero divisor, this implies that B̄v Av −Bv Āv =
0, which implies that Rv = R̄v .



35
Lemma 3.1.6

Let f be a hypergeometric term on Zk that is not a zero divisor and

let Rv be the term ratio for f in the direction v (which is unique by Lemma 3.1.5).
Then
v
Rv+w = Rv Rw
= Rw Rvw

for all v, w ∈ Zk .
Proof. For each v ∈ Zk , let Av and Bv by polynomials such that Av f = Bv f v
as in Lemma 3.1.3. Then Av Avw f = Aw Bv f v = Bv (Aw f )v = Bv (Bw f v ) =
v v+w
Bv Bw
f
. Thus, we have

Av+w f = Bv+w f v+w
and
v v+w
Av Avw f = Bv Bw
f
.

It follows from these equations that
v
(Av+w Bv Bw
− Bv+w Av Avw )f = 0.

v
− Bv+w Av Avw = 0, from
Since f is not a zero divisor, this implies that Av+w Bv Bw
v
. By symmetry, Rv+w = Rw Rvw .
which it follows that Rv+w = Rv Rw

Proposition 3.1.7



If a hypergeometric term f on Zk is a zero divisor, then for

each v ∈ Zk there exist nonzero Av and Bv ∈ K[z] such that Av = Bv f v and
v
Rv = Av /Bv satisfies Rv Rw
= Rw Rvw for v, w ∈ Zk .

Proof. Since pf = 0 for some polynomial p ∈ K[z], pv f v = 0 for all v ∈ Zk .
Thus, pf = pv f v for all v ∈ Zk . Taking Av = p and Bv = pv , it’s easily verified
v
that Rv Rw
= Rw Rvw for all v, w ∈ Zk .

Theorem 3.1.8



Let f be a hypergeometric term on Zk that is not a zero divisor.

For all w ∈ Zk , let Rw be the term ratio of f in the direction w. Then there exist

36
polynomials C and D in K[z], a finite set V ⊂ Zk , and univariate polynomials av
and bv ∈ K[z] for each v ∈ V such that
Rw (z) =

Y Yv·w av (z · v + j)
C(z + w) D(z)
for all w ∈ Zk .
0
C(z) D(z + w)
b
(z
·
v
+
j)
v
j
v∈V

v
Proof. By Lemma 3.1.6, Rv+w = Rv Rw
for all v, w ∈ Zk . The result follows

immediately by Corollary 2.8.5.

3.2



Sets of measure zero

When considering sequences of one variable, it is useful to identify sequences that
are equal except at a finite number of points. Thus, we identify sequences that are
equal ‘almost everywhere’ and think of finite sets as ‘sets of measure zero’. When
considering sequences of several variables, that is, functions from Zk to a field K,
it is useful to consider the ‘sets of measure zero’ to be not finite sets, but sets that
can be covered by a finite number of hyperplanes. Thus, in dimension 2, a ‘set of
measure zero’ can be covered by a finite number of lines, and in three dimensions a
‘set of measure zero’ can be covered by a finite number of planes.
Definition 3.2.1

Define a hyperplane in Zk to be a set of the form {z: v · z = n},

where n ∈ Z and v is some vector in Zk . Define a half-space in Zk to be a set of
the form {z: v · z > n}, where n ∈ Z and v is some vector in Zk . The boundary of
the half-space {z: v · z > n} is the hyperplane {z: v · z = n}. Since {z: v · z < n} =
{z: −v ·z > −n} is a half-space with boundary {z: v ·z = n}, each hyperplane is the
boundary of two half-spaces, and Zk is the disjoint union of these two half-spaces
and the boundary.
Definition 3.2.2

A set of measure zero in Zk is a set that can be covered

by a finite number of hyperplanes. Two functions f, g: Zk → K are equal almost
everywhere (written f = g a.e.) if there exists a set S of measure zero such that
f (z) = g(z) for all z ∈ Zk \ S. We say f is degenerate if f = 0 a.e. and f is
nondegenerate if it is not degenerate.

37
Clearly, a finite union of sets of measure zero is a set of measure zero. Note
that although we have defined a set of measure zero, we have not defined a measure.
We use the phrase only because it is familiar and suggestive.
Lemma 3.2.3

A nonzero simple polynomial p ∈ K[z] is nonzero except on a set

of measure zero.
Proof. Let p(z) = p̄(z · v), where v ∈ Zk and p̄ ∈ K[z] is a univariate polynomial. Let n1 , . . . , nm be the integer roots of p̄. If p(z0 ) = 0, then z0 · v is a root
of p̄, and hence z0 · v = ni for some i. Hence z0 lies in one of the m hyperplanes
{z: z · v = nj }, j = 1, . . . , m, the union of which is a set of measure zero.
Lemma 3.2.4



A function f is a hypergeometric term on Zk if and only if,

for all v ∈ Zk , there exist nonzero polynomials Av and Bv ∈ K[z] such that
Av f = Bv f v a.e.
Proof. If f is a hypergeometric term, Av f = Bv f v a.e. automatically. Conversely, if Av f = Bv f v a.e., then pv Av f = pv Bv f v , where pv ∈ K[z] is a product
of nonzero linear polynomials. Hence f is a hypergeometric term.
Definition 3.2.5



A hypergeometric term f on Zk is honest if for all v ∈ Zk there

exist relatively prime polynomials Av and Bv ∈ K[z] such that Av f = Bv f v a.e.

3.3

Boxes

Definition 3.3.1

A k-dimensional box of size n is a set of the form {z ∈ Zk : ci 6

zi 6 ci + n}, where c1 , . . . , ck ∈ Z. (A k-dimensional box is the set of integer points
in a k-dimensional hypercube.)
Lemma 3.3.2

If a k-variable polynomial p ∈ K[z] is 0 on a k-dimensional box

of size n, where n is the total degree of p, then p is identically 0.
Proof. The lemma is clearly true if the degree of p is 0. We assume that it
is true if the degree of p is n − 1, and show that it is true if the degree of p is

38
n. Suppose p is of degree n and is zero on a k-dimensional box of size n. For
i ∈ {1, . . . , k}, p − pei is 0 on a k-dimensional box of size n − 1. By Lemma 2.0.2
p − pei is of degree at most n − 1, so p − pei is identically 0 by assumption. Thus,
p = pei for all i ∈ {1, . . . , k}. By Lemma 2.5.2 p is free of zi for i ∈ {1, . . . , k}.
Thus p is constant, and hence p is identically zero.
Lemma 3.3.3



If a hypergeometric term on Zk is not a zero divisor, then for any

sequence w1 , . . . , wn of vectors in Zk the hypergeometric term f w1 f w2 · · · f wn is
not a zero divisor.
Proof. By Lemma 3.1.3, for any v ∈ Zk there exist nonzero polynomials
Av , Bv ∈ K[z] such that Av f = Bv f v . If f w1 f w2 · · · f wn is a zero divisor, then for
some nonzero polynomial p, pf w1 f w2 · · · f wn = 0. Hence,
pBw1 · · · Bwn f w1 f w2 · · · f wn = 0,
hence, pAw1 · · · Awn f n = 0, hence, pAw1 · · · Awn f = 0, and hence, f is a zero
divisor, contrary to assumption.
Lemma 3.3.4



If f is a hypergeometric term on Zk , then either f is a zero divisor

or f is nonzero on arbitrarily large k-dimensional boxes.
Proof. Let V be the k-dimensional box {z ∈ Zk : 0 6 zi 6 n}, and let V =
{v1 , . . . , vm }. If f is not a zero divisor, by Lemma 3.3.3 g = f v1 · · · f vm is not a
zero divisor, hence for some w (infinitely many), g(w) 6= 0, and hence f (w +vj ) 6= 0
for j ∈ {1, . . . , m}. Thus f is nonzero on the k-dimensional box
{z + w: 0 6 zi 6 n, i = 1, . . . , k},
which is of size n.



39

3.4

Polyhedral regions

Definition 3.4.1

A region R ⊂ Zk is polyhedral if R = Zk or R is the intersection

of a finite number of half-spaces of Zk .
Lemma 3.4.2

The characteristic function of a half-space in Zk is a hypergeo-

metric term; in fact, for all w ∈ Zk , f = f w a.e.
Proof. Let the half-space be {z: v · z > n} for some v ∈ Zk and n ∈ Z. Then
f (z) = f (z + w) unless z · v > n and (z + w) · v 6 n, or unless z · v 6 n and
(z + w) · v > n; that is, n < z · v 6 n − v · w or n − v · w < z · v 6 n. In either case,
the set of exceptions is just the union of |v · w| hyperplanes. Thus f (z) = f (z + w)
a.e.



Lemma 3.4.3

The characteristic function of a polyhedral region is a hypergeo-

metric term.
Proof. By definition, the region is the intersection of a finite number of halfspaces, so the characteristic function of the region is just the product of the characteristic functions of the half-spaces, which are all hypergeometric terms by Lemma 3.4.2.
Since the product of two hypergeometric terms is a hypergeometric term, the characteristic function of the region is a hypergeometric term.
Lemma 3.4.4



If R is a polyhedral region in Zk , then either R contains arbitrarily

large k-dimensional boxes, or R is a set of measure zero.
Lemma 3.4.4 can be proved by elementary means, but we can’t resist this short
proof based on a result from Chapter 4.
Proof. Let f be the characteristic function of the region R. By Lemma 3.4.3, f
is a hypergeometric term. The function f is the product of characteristic functions of
half-spaces, so f is holonomic. If f is a zero divisor, then by Lemma 4.1.2 f = 0 a.e.,
so R is a set of measure 0. If f is not a zero divisor, then by Lemma 3.3.4, f is

40
nonzero on arbitrarily large k-dimensional boxes, and hence R contains arbitrarily
large k-dimensional boxes.



Let R ⊂ Zk be a polyhedral region. A hypergeometric term on

Definition 3.4.5

R over K is a function f : R → K such that for i ∈ {1, . . . , k} there exist nonzero
polynomials Ai , Bi ∈ K[z] such that
Ai (z)f (z) = Bi (z)f (z + ei )
for all z such that z and z + ei are in R.
Lemma 3.4.6

If f is a hypergeometric term on a polyhedral region R ⊂ Zk ,

then the function
g(z) =
is a hypergeometric term on Zk .



f (z) z ∈ R
0

z∈
/R

Proof. For i ∈ {1, . . . , k} there exist nonzero polynomials Ai and Bi such that
Ai (z)f (z) = Bi (z)f ei (z)
for all z such that z ∈ R and z + ei ∈ R. Let h be the characteristic function for
R. By Lemma 3.4.4, h is a hypergeometric term on Zk , so for i ∈ {1, . . . , k} there
exist nonzero polynomials Āi and B̄i such that
Āi (z)h(z) = B̄i (z)h(z + ei )
for all z ∈ Zk . By considering separately the cases
(1) z ∈ R, z + ei ∈ R,
(2) z ∈ R, z + ei ∈
/ R,
(3) z ∈
/ R, z + ei ∈ R, and
(4) z ∈
/ R, z + ei ∈
/ R,
it is easily seen that
Ai Āi g = Bi B̄i g ei
for i ∈ {1, . . . , k}.



41

3.5

Factorial hypergeometric terms

Definition 3.5.1

A hypergeometric term on Zk is factorial on a region R ⊂ Zk

if there exist a finite set V ⊂ Zk , univariate polynomials av and bv ∈ K[z] and an
integer nv for each v ∈ V such that, for all z ∈ R,
Y v·z+n
Y v av (j)
,
(1) f (z) =
bv (j)
j=1
v∈V

(2) for all v ∈ V , v · z + nv is a positive integer, and
(3) for all v ∈ V and j, 1 6 j 6 v · z + nv , av (j) 6= 0 and bv (j) 6= 0.
Recall that γ z = γ1z1 · · · γkzk and (m)r = m(m + 1) · · · (m + r − 1).

Lemma 3.5.2

If f is a hypergeometric term on Zk over a field that is algebraically

closed and f is factorial on a region R, then there exist a vector γ ∈ K k , constants
m1 , . . . , mp and n1 , . . . , nq ∈ K, vectors v1 , . . . , vp and w1 , . . . , wq ∈ Zk , and
integers r1 , . . . , rp and s1 , . . . , sq ∈ Z such that, for all z ∈ R,
Qp
(mi )vi ·z+ri
z
;
(1) f (z) = γ Qqi=1
j=1 (nj )wj ·z+sj
(2) vi · z + ri and wj · z + sj are positive integers for each i ∈ {1, . . . , p} and
{1, . . . , q};
(3) all the terms appearing in the numerator and denominator are nonzero.
Proof. Since f is factorial on R,
f (z) =

Y

v∈V

v·z+n
Yv
j=1

av (j)
bv (j)

for all z ∈ R where V , nv , av , and bv are as in Definition 3.5.1. Since a product of
functions of the form (1) satisfying conditions (2) and (3) is of the same form (and
likewise for reciprocals), we need only prove the lemma for
f (z) =

u·z+ℓ
Y

a(j).

j=1

Since K is algebraically closed, a(j) = α(j − a1 ) · · · (j − at ), where α, ai ∈ K. By

42
the same reasoning as before, we need only prove the lemma for
u·z+ℓ
Y

α

j=1

and
u·z+ℓ
Y

(j − a1 ).

j=1

The first is αu·z+ℓ = αℓ αu1 z1 +···uk zk = (αℓ )1 γ z , where γ = (αu1 , . . . , αuk ), and
the second is (1 − a1 )u·z+ℓ . We’re given that u · z + ℓ is positive on R and a(j) is
nonzero for 1 6 j 6 u · z + ℓ, so conditions (2) and (3) follow.
Definition 3.5.3



A hypergeometric term f on Zk is weakly factorial on a region

R ⊂ Zk if there exist a finite set V ⊂ Zk , univariate polynomials av and bv ∈ K[z]
for each v ∈ V , and z0 ∈ R such that, for all z ∈ R,
Y Yz·v av (j)
, and
(1) f (z) =
z0 ·v bv (j)
j
v∈V

(2) for all v ∈ V and all j occurring in the product
bv (j) 6= 0.

Yz·v av (j)
, av (j) 6= 0 and
z0 ·v bv (j)
j

An example of a hypergeometric term on Z that is weakly factorial but not
factorial is

f (z1 ) =

Yz1
j

0

(2j + 1) =

 z −1
1
Y



(2j + 1), z1 > 0


 j=0
−z

Y1






j=1

1
,
1 − 2j

z1 < 0.

Though f is not factorial, the domain of f can be split into two regions, {z1 > 0}
and {z1 < 0}, such that it is factorial on each region. The following lemma shows
that this is true in general.
Lemma 3.5.4

If a hypergeometric term is weakly factorial on a polyhedral region

R, then there exist a finite number of polyhedral regions R1 , . . . , Rm such that
R = R1 ∪ · · · ∪ Rm and f is factorial on each of the Ri .

43
Proof. Since f is weakly factorial on R,
f (z) =

Y Yv·z av (j)
,
v·z0 bv (j)
j

v∈V

where av , bv , V , and z0 are as in Definition 3.5.3. Let G be the set of functions
g: V → {−1, 1}. We show that R can be divided into at most 2|V | regions {Rg : g ∈
G}, such that for each v ∈ V , g ∈ G, and region Rg , there exist w = ±v, n = ±v·z0 ,
univariate polynomials av and bv which are nonzero for 1 6 j 6 w · v + n, such that
Yv·z av (j) w·z+n
Y av (j)
=
.
v·z0 bv (j)
bv (j)
j
j=1

(*)

We construct the region Rg so that for every v ∈ V , the sign of v · (z − z0 ) is
constant over z ∈ Rg . For each v ∈ V define the half-spaces
Hv (1) = {z: v · (z − z0 ) > 0}
and
Hv (−1) = {z: v · (z − z0 ) < 0}.
For each g ∈ G, the region Rg is defined by
Rg = R ∩

\

Hv (g(v)).

v∈V

Clearly R =

S

g

Rg and Rg is polyhedral. Note |G| = 2|V | , so |{Rg : g ∈ G}| 6 2|V | .

By definition, the sign of v · (z − z0 ) is constant on Hv (g(v)), so, for each v, the
sign of v · (z − z0 ) is constant for z ∈ Rg .
We need to show that for a given region (*) is true. Let a region Rg and a
vector v be given. If v · z − v · z0 = v · (z − z0 ) is nonnegative on Rg , then
v·z−1
Y av (j) v·z−v·z
Y 0 av (j + v · z0 − 1) w·z+n
Y v āv (j)
Yv·z av (j)
=
=
=
,
v·z0 bv (j)
b
(j)
b
(j
+
v
·
z
−
1)
b̄
(j)
v
v
0
v
j=v·z
j=1
j=1
j
0

44
where āv (j) = av (j + v · z0 − 1), b̄v (j) = bv (j + v · z0 − 1), w = v, and nv = −v · z0 .
If v · z − v · z0 = v · (z − z0 ) is negative on Rg ,
v·z−1
Y bv (j)
Yv·z av (j)
=
v·z0 bv (j)
av (j)
j=v·z
j
0

−v·z
Y

=

j=1−v·z0

=

v·zY
0 −v·z
j=1

=

w·z+n
Yv
j=1

bv (−j)
av (−j)
bv (−j − v · z0 )
av (−j − v · z)

āv (j)
,
b̄v (j)

where āv (j) = bv (−j − v · z0 ) and b̄v = av (−j − v · z0 ), w = −v, and nv = v · z0 .


3.6

Path connected regions

Recall that a lattice path in Zk is a sequence {Ti }i>1 in Zk such that Ti − Ti−1 ∈
{±e1 , . . . , ±ek } for all i > 1.
Let R and R̄ ∈ Zk . The region R is lattice path connected in

Definition 3.6.1

R̄ if for all z1 and z2 ∈ R there exists a lattice path {Ti }i>1 contained in R̄ such
that T1 = z1 and Ti = z2 for some positive integer i. The region R is lattice path
connected if it is lattice path connected in itself.
For any subsets S, R, and R̄ ⊂ Zk , the region R is S-path

Definition 3.6.2

connected in R̄ if for all z1 and z2 ∈ R there exists a sequence {Ti }i>1 contained
in R̄ such that T1 = z1 and Ti = z2 for some positive integer i, and Ti − Ti−1 ∈ S
for all i > 1.
Thus a region is lattice path connected if it is S-path connected in itself for
S = {±e1 , . . . , ek }.
Lemma 3.6.3

Let R ⊂ Zk be a polyhedral region. For any positive integer n,

R can be written as the union of a set of measure zero and a polyhedral region R′

45
such that every z ∈ R′ lies in a k-dimensional box of size n contained entirely in
R.
Proof. Let R′ = ∩v∈B (R−v) where B = {b ∈ Zk : for each i ∈ {1, . . . , k}, 0 6
bi 6 n}. Clearly R′ is a polyhedral region and for every z ∈ R′ the box z + B =
{z + b : b ∈ B} is contained in R, so we need to show that S = R \ R′ is a set of
measure zero.
Since R is the intersection of a finite number of half-spaces, there exists a finite
set T ⊂ Zk × Z such that z ∈ R if and only if z ∈ Zk and v · z 6 n for all (v, n) ∈ T .
Thus, z ∈ S implies there exists (v, n) ∈ T and b ∈ B such that v · z 6 n and
v · (z + b) > n, which in turn implies v · z = m for some integer m such that
n − v · b < m 6 n. It follows that S can be covered by hyperplanes of the form
{z : v · z = m}, where b ∈ B, (v, n) ∈ T and n − v · b < m 6 n. Clearly, there are
a finite number of such hyperplanes, so S is a set of measure zero.
Lemma 3.6.4



Let B0 and B1 be k-dimensional boxes of size 1, let S̄ be the

convex hull of B0 and B1 in Qk , and let S be the set of integer points in S̄. Then
S is lattice path connected.
Proof. Let M be a k × k matrix with entries equal to ±1 on the diagonal
and 0 off the diagonal. It is easily seen that the lemma is true for the boxes B0
and B1 if and only if it is true for the reflections M B0 = {M b : b ∈ B0 } and
M B1 = {M b : b ∈ B1 } of B0 and B1 . Similarly, letting v ∈ Zk , the lemma is true
for B0 and B1 if and only if it is true for the translations B0 + v = {b + v : b ∈ B0 }
and B1 + v = {b + v : b ∈ B1 } of B0 and B1 . By applying a sequence of such
transformations, we may assume that B0 is the unit k-dimensional box at the origin
in the first orthant, B0 = {z ∈ Zk : for each i ∈ {1, . . . , k}, 0 6 zi 6 1}, and that
B1 = B0 + w where w ∈ Zk and wi > 0 for each i ∈ {1, . . . , k}.
Further, if wi = 0 for some i ∈ {1, . . . , k}, then the lemma follows easily by
induction from the case of dimension k − 1. Since the case of dimension 1 is trivial,

46
we may assume that wi > 0 for each i ∈ {1, . . . , k}.
Let B̄0 be the convex hull of B0 in Qk . Thus, B̄0 = {z ∈ Qk : for each i ∈
{1, . . . , k}, 0 6 zi 6 1}.
We claim that any z ∈ S can be written in the form z = z ′ + sw, where
z ′ ∈ B̄0 , s ∈ Q, and s > 0. Since z ∈ S,
z=

X

X

λb b +

b∈B0

λb b ,

b∈B1

where
X

X

λb +

b∈B0

λb = 1 .

b∈B1

Hence,
z=

X

λb b +

b∈B0

=

X

X

λb+w (b + w)

b∈B0

(λb + λb+w )b +

b∈B0
′

X

λb+w w

b∈B0

= z + sw

,

where
z′ =

X

(λb + λb+w )b

X

λb+w > 0

b∈B0

and
s=

.

b∈B0

Since
X

b∈B0

(λb + λb+w ) =

X

b∈B0

λb +

X

λb = 1

,

b∈B1

it follows that z ′ ∈ B̄0 .
We claim that for any z ∈ S \ B1 , there exists j ∈ {1, . . . , k} such that
z + ej ∈ S. Let z = z ′ + sw where z ′ ∈ B̄0 , s ∈ Q and s > 0. For each
i ∈ {1, . . . , k}, the line {z ′ − rw : r ∈ Q} intersects the hyperplane z · ei = 0 at a
point vi = z ′ − ri w where ri ∈ Q and ri > 0. Thus, vi,i = 0 for each i ∈ {1, . . . , k}.

47
Let j ∈ {1, . . . , k} be such that rj is minimal. By the minimality of rj and the
positivity of wi , it follows that vj,i > vi,i = 0 for i 6= j. Thus, vj,i > 0 for all
i ∈ {1, . . . , k}. Further, since 0 6 zi′ 6 1, and ri > 0, it follows that 0 6 vj,i 6 1 for
all i ∈ {1, . . . , k} and vj,j = 0. Letting t = r + s, it follows that z = vj + tw, and,
hence,
z + ej = (1 − t)(vj + ej ) + t(vj + ej + w) .
It is easily seen that t < 1, otherwise z ∈ B1 . Since vj,j = 0 and vj ∈ B̄0 , it follows
that vj + ej ∈ B̄0 , and, hence, vj + ej + w ∈ B̄1 . Thus, z + ej ∈ S̄ as claimed.
We show that every z ∈ S is lattice path connected to a point in B1 . Suppose
to the contrary some z ∈ S \ B1 is not lattice path connected to a point in B1 .
Pk
Pk
Pk
Assume that i=1 zi is maximal. Such a z exists since i=1 zi < i=1 wi for all

z ∈ S \ B1 . For some j ∈ {1, . . . , k}, we have z + ej ∈ S. By the maximality
Pk
of i=1 zi , it follows that z + ej ∈ B1 . Thus, z is lattice path connected to B1
contrary to assumption. Clearly B1 is lattice path connected, so S is lattice path
connected.

Corollary 3.6.5

Let R ⊂ Zk be a polyhedral region and let z1 and z2 ∈ R. If

z1 and z2 are contained in k-dimensional boxes of size 1 contained entirely in R,
then there exists a lattice path from z1 to z2 contained entirely in R.
Proof. Let B1 and B2 ⊂ R be k-dimensional boxes containing z1 and z2
respectively. Let S̄ be the convex hull of B0 and B1 in Qk and let S be the set of
integer points in S̄. By the definition of a polyhedral region there exists a convex
subset R̄ of Qk such that R is the set of integer points in R̄. Since R̄ is convex, it
contains the convex hull of any of its subsets. Thus, S̄ ⊂ R̄ and, hence, S ⊂ R. But
S is lattice path connected by Lemma 3.6.4.



48

3.7

Structure theorem for honest hypergeometric terms

Theorem 3.7.1

Let f be an honest hypergeometric term on Zk . There exist

relatively prime polynomials C and D ∈ K[z], a finite set V ⊂ Zk , univariate polynomials av , bv ∈ K[z], v ∈ V (all of which can be determined as in Theorem 3.1.8),
and a finite number of polyhedral regions R1 , . . . , Rm such that
(1) Zk is the disjoint union of the Ri and a set of measure zero;
(2) for each i ∈ {1, . . . , m} there exists z0 ∈ Ri such that C(z0 ) 6= 0, and for all
z ∈ Ri for which D(z) 6= 0,
f (z) = f (z0 )

C(z) D(z0 ) Y Yz·v av (j)
.
z0 ·v bv (j)
C(z0 ) D(z)
v∈V

j

(3) all the terms av (j) and bv (j) occurring in the product are nonzero.
We conjecture that Theorem 3.7.1 is true for hypergeometric terms that are
not honest if the condition that C and D are relatively prime is dropped.
Theorem 3.7.1 applies to hypergeometric terms on polyhedral regions other
than Zk via Lemma 3.4.6.
Proof. If f is a zero divisor and pf = 0, then the lemma is true with D = p,
C = 1, V empty, and one region R1 = Zk . We assume hence forth that f is not a
zero divisor. Let Rw be the term ratio of f in the direction w. By Theorem 3.1.8,
Rw (z) =

Y Yv·w av (z · v + j)
C(z + w) D(z)
0
C(z) D(z + w)
bv (z · v + j)
j
v∈V

for all w ∈ Zk . We may assume C and D are relatively prime. Let Āw and
B̄w ∈ K[z] be relatively prime polynomials such that
(1)

Y Yv·w aw (z · v + j)
Āw
=
.
0
bw (z · v + j)
B̄w
v∈V j

Thus Āw and B̄w are products of simple polynomials, and by Lemma 3.2.3 Āw
and B̄w are nonzero except on a set of measure zero.

49
Since f is honest, for each w ∈ Z there exist relatively prime polynomials Aw
and Bw ∈ K[z] such that Aw f = Bw f w a.e. Since f is not a zero divisor, by
Lemma 3.1.5 the term ratio Rw is unique. Hence,
Aw
C w DĀw
= Rw =
Bw
CDw B̄w
for all w ∈ Zk and, hence, there exist relatively prime polynomials pw and qw ∈
K[z] such that
pw Aw = qw C w DĀw and pw Bw = qw CDw B̄w

.

Since pw and qw are relatively prime, it follows that qw | Aw and qw | Bw , and
since Aw and Bw are relatively prime, it follows that qw must be trivial. Hence,
for each w ∈ Zk ,
C w DĀw f = CDw B̄w f w a.e.
Let d be the total degree of CD. By Lemma 3.3.2, CD is nonzero for at
least one point in any k-dimensional box of size d. Let S0 ⊂ Zk be the union of
all k-dimensional boxes of size d containing 0. Let S1 = {s ± ei : s ∈ S0 and i ∈
{1, . . . , k}}. Thus, S1 is the union of all k-dimensional boxes of size d containing a
point ±ei , i ∈ {1, . . . , k}. Finally, let S = S0 − S1 = {s0 − s1 : s0 ∈ S0 , s1 ∈ S1 }.
For each w ∈ Zk , the polynomials Āw and B̄w are nonzero except on a set of
measure zero, and Āw C w Df = B̄w CDw f w except on a set of measure zero. Call
the union of these two sets of measure zero H1 (w) and let H1 = ∪w∈S H1 (w). Since
S is finite, it follows that H1 is a set of measure zero. Thus, for all w ∈ S and all
z∈
/ H1 ,
(2) Āw (z) 6= 0, B̄w (z) 6= 0, and
(3) Āw (z)C(z + w)D(z)f (z) = B̄w (z)C(z)D(z + w)f (z + w).
Let H2 be a finite set of hyperplanes covering H1 . The hyperplanes in H2
¯ such that Zk is the
divide space into a finite number of polyhedral regions R̄
i

50
disjoint union of the regions and the union of the hyperplanes. (The hyperplanes
are not necessarily disjoint, but the regions are disjoint from each other and from
¯ can be written as a
the hyperplanes.) Further, by Lemma 3.6.3 each region R̄
i
union of a polyhedral region R̄i and a set of measure zero such that each z ∈ R̄i is
¯ . By Lemma 3.6.4
contained in a k-dimensional box of size d contained entirely in R̄
i
each R̄i can be written as a union of a polyhedral region Ri and a set of measure
zero such that Ri is lattice path connected in R̄i . Thus,
(4) Zk = R1 ∪ · · · ∪ Rm ∪ H, where H is a set of measure zero;
¯ , i ∈ {1, . . . , m}, and every w ∈ S;
(5) Āw C w Df = B̄w CDw f w for every z ∈ R̄
i

¯ , i ∈ {1, . . . , m}, for every w ∈ S;
(6) Āw and B̄w are nonzero on R̄
i
(7) Ri is lattice path connected in R̄i for i ∈ {1, . . . , m};
(8) for every z ∈ R̄i , z is contained in a k-dimensional box of size d contained in
¯ , i ∈ {1, . . . , m}.
R̄
i
From (1), (5) and (6) it follows that
(9) f (z2 )C(z1 )D(z2 ) = f (z1 )C(z2 )D(z1 )

Y Yz2 ·z av (j)
¯ and z −
if z1 ∈ R̄
i
2
z1 ·v bv (j)
j

v∈V

z1 ∈ S, i ∈ {1, . . . , m}.

Since any Ri of measure zero can be absorbed into H we may assume Ri is not
a set a measure zero for i ∈ {1, . . . , m}. For each i ∈ {1, . . . , m} let R′i = {z ∈
¯ ′ = {z ∈ R̄
¯ : C(z)D(z) 6= 0}. Since R is not a set of
Ri : C(z)D(z) 6= 0}, and let R̄
i
i
i
measure zero, Ri contains a k-dimensional box of size d by Lemma 3.4.4. Hence,
by Lemma 3.3.2, C(z)D(z) is nonzero for some z ∈ Ri , and hence R′i is not empty.
¯ ′ for each i ∈ {1, . . . , m}. Let z and
We claim R′i is S-path connected in R̄
1
i
z2 ∈ R′i be given. We construct a sequence v1′ , . . . , vℓ′ in R̄′i such that v1′ = z1 ,
′
vℓ′ = z2 , and vj′ − vj−1
∈ S for j = 2, . . . , ℓ. Since Ri is lattice path connected

in R̄i , there exists a sequence v1 , . . . , vℓ in R̄i such that v1 = z1 , vℓ = z2 , and
vj − vj−1 ∈ {±e1 , . . . , ±ek }. For each j ∈ {1, . . . , ℓ} there is a k-dimensional

51
¯ . This box contains a point v ′ such
box of size d containing vj contained in R̄
i
j
that C(vj′ )D(vj′ ) 6= 0, since the total degree of CD is d. Obviously, we can take
′
v1′ = z1 and vℓ′ = z2 . By the construction of S, it’s clear that vj′ − vj−1
∈ S for

¯ ′ as claimed.
j ∈ {2, . . . , ℓ}. Thus, R′i is S-path connected in R̄
i
¯ ′ , define
For all z1 and z2 ∈ R̄
i
g(z1 , z2 ) =

C(z2 ) D(z1 ) Y Yz2 ·v av (j)
.
z1 ·v bv (j)
C(z1 ) D(z2 )
j
v∈V

We claim that for all z1 and z2 ∈ R′i ,
f (z2 ) = f (z1 )g(z1 , z2 ).
¯ such that z −z
We show by induction on j that if {zν }ν>1 is a sequence in R̄
i
ν
ν−1 ∈
S for all ν > 2, then
f (zj ) = f (z1 )g(z1 , zj )
for all j > 1. The statement is clearly true if j = 1. Suppose inductively that
f (zj−1 ) = f (z1 )g(z1 , zj−1 ). Since zj − zj−1 ∈ S, it follows by (9) that f (zj ) =
f (zj−1 )g(zj−1 , zj ). Hence, f (zj ) = f (z1 )g(z1 , zj−1 )g(zj−1 , zj ). Using the fact
Qc
Qb Qc
that a b = a , it is easily seen that f (zj ) = f (z1 )g(z1 , zj ), as was to be
i

i

i

¯ ′ , it follows that f (z ) = f (z )g(z , z )
shown. Since R′i is S-path connected in R̄
2
1
1 2
i
for all z1 and z2 ∈ R′i .
Let z0 ∈ R′i . We claim that for all z ∈ Ri such that D(z) 6= 0,
f (z) = f (z0 )g(z0 , z).

If z ∈ R′i , we’re done. If z ∈
/ R′i , then, since D(z) 6= 0, we must have C(z) = 0. In
this case (9) implies f (z) = 0. But g(z0 , z) = 0, so f (z) = f (z0 )g(z0 , z).

Corollary 3.7.2

Let f be an honest hypergeometric term on Zk . Then there

exist relatively prime polynomials C and D ∈ K[z] (as in Theorem 3.7.1) and a

52
finite number of polyhedral regions R1 , . . . , RL such that Zk is the union of the Rℓ
and a set of measure zero and for each region Rℓ there exist a finite set V ⊂ Zk and
univariate polynomials av and bv ∈ K[z] and an integer nv for each v ∈ V such
that, for all z ∈ Rℓ ,
C(z) Y
(1) f (z) =
D(z)

v∈V

v·z+n
Yv
j=1

av (j)
for all z ∈ Rℓ for which D(z) 6= 0,
bv (j)

(2) for all v ∈ V , v · z + nv is a positive integer, and
(3) for all v ∈ V and j, 1 6 j 6 v · z + nv , av (j) 6= 0 and bv (j) 6= 0.
Corollary 3.7.2 applies to hypergeometric terms on polyhedral regions other

than Zk via Lemma 3.4.6.
Proof. This follows from Theorem 3.7.1 and Lemma 3.5.4. The product
Y Yz·v av (j)
z0 ·v bv (j)
j

v∈V

that occurs in the expression for f (z) in Theorem 3.7.1 is a weakly factorial hypergeometric term on the region Ri . By lemma 3.5.4, the region Ri can be divided
into polyhedral subregions such that the weakly factorial hypergeometric term is
factorial on each subregion.
Corollary 3.7.3



Let f be an honest hypergeometric term on Zk over a field

K that is algebraically closed. Then there exist relatively prime polynomials C
and D ∈ K[z] (as in Theorem 3.7.1) and a finite number of polyhedral regions
R1 , . . . , RL such that Zk is the union of the Rℓ and a set of measure zero, and for
each region Rℓ there exist a vector γ ∈ K k , constants m1 , . . . , mp , n1 , . . . , nq ∈ K,
vectors v1 , . . . , vp , w1 , . . . , wq ∈ Zk , and integers r1 , . . . , rp , s1 , . . . , sq such that
(1) for all z ∈ Rℓ such that D(z) 6= 0,
f (z) =

γ1z1

· · · γkzk

Qp
C(z) i=1 (mi )vi ·z+ri
Q
;
D(z) qj=1 (nj )wj ·z+sj

(2) for all i and j and z ∈ Rℓ , vi · z + ri and wj · z + sj are positive;
(3) the Pochhammer symbols occurring in the products are nonzero.

53
Corollary 3.7.3 applies to hypergeometric terms on polyhedral regions other
than Zk via Lemma 3.4.6.
Proof. This corollary is an immediate consequence of Corollary 3.7.2 and
Lemma 3.5.2.



Chapter 4
A Holonomic Hypergeometric Term
Is Piecewise Proper

The theory of holonomic systems was developed by Bernstien [2] and applied
to the the theory of hypergeometric identities by Zeilberger [16]. In [15] Wilf and
Zeilberger developed a proof theory for multisums that applies only to proper hypergeometric terms. Wilf and Zeilberger conjectured [15] that a hypergeometric
term is holonomic if and only if it is proper. We consider the discrete case of their
conjecture and interpret it to mean roughly that a hypergeometric term on Zk is
holonomic if and only if it is piecewise proper. We use only elementary facts about
holonomic functions that can be found in [16] and [3].
Definition 4.0.1

A hypergeometric term f on Zk over an field K is piecewise

proper if there exist a polynomial C ∈ K[z] and a finite number of polyhedral regions
R1 , . . . , RL such that Zk is the union of the Rℓ and a set of measure zero, and for
each region Rℓ there exist a vector γ ∈ K k , constants m1 , . . . , mp , n1 , . . . , nq ∈ K,
vectors v1 , . . . , vp , w1 , . . . , wq ∈ Zk , and integers r1 , . . . , rp , s1 , . . . , sq such that
(1) for all z ∈ Rℓ ,
f (z) =

γ1z1

Qp
(mi )vi ·z+ri
zk
· · · γk C(z) Qqi=1
j=1 (nj )wj ·z+sj

;

(2) for all i and j and z ∈ Rℓ , vi · z + ri and wj · z + sj are positive;
(3) the Pochhammer symbols occurring in the products are nonzero.
Our interpretation of Wilf and Zeilberger’s conjecture is Theorem 4.0.2.
Theorem 4.0.2

A holonomic hypergeometric term f on Zk over an algebraically

closed field K is piecewise proper. Conversely, if f is piecewise proper then there

55
exists a holonomic function g such that f = g a.e.
The following example shows the necessity of introducing sets of measure zero
and polyhedral regions to the conjecture. Let

(z1 − z2 + 1)(z1 − z2 − 1)
f (z1 , z2 ) =
g(z1 , z2 )

if z1 6= z2
if z1 = z2 ,

where g is an arbitrary holonomic function. Letting
p(z1 , z2 ) = (z1 − z2 + 1)(z1 − z2 − 1),
it’s easily verified that
pe1 f = pf e1 and pe2 f = pf e2
regardless of the choice of g, so f is a hypergeometric term. Furthermore, using
the fact that the characteristic function of a half-space is holonomic, it’s easily seen
that f is holonomic:
f = χ(z1 > z2 )p + χ(z1 < z2 )p + χ(z1 > z2 )χ(z1 6 z2 )g,
where χ(relation(z1 , z2 )) is the characteristic function of {(z1 , z2 ): relation(z1 , z2 )}.
Each of the relations in the equation defines a half-plane, so each characteristic
function is holonomic. Sums and products of holonomic functions are holonomic,
so f is holonomic. But f is clearly not proper hypergeometric for arbitrary g.
The function f is, however, piecewise proper. The set of measure zero is the
line z1 = z2 , and the polyhedral regions are the half-spaces z1 > z2 and z1 < z2 .
The ‘conversely’ part of Theorem 4.0.2 follows by the arguments of [16]. Thus
to prove the conjecture, we need only prove the first part, which is the content of
Theorem 4.1.10.
Theorem 4.1.10 A holonomic hypergeometric term f on Zk over an algebraically
closed field K is piecewise proper: there exist a polynomial C ∈ K[z] (as in Theorem 4.1.8) and a finite number of polyhedral regions R1 , . . . , RL such that Zk is the

56
union of the Rℓ and a set of measure zero, and for each region Rℓ there exist a vector
γ ∈ K k , constants m1 , . . . , mp , n1 , . . . , nq ∈ K, vectors v1 , . . . , vp , w1 , . . . , wq ∈
Zk , and integers r1 , . . . , rp , s1 , . . . , sq such that
(1) for all z ∈ Rℓ ,
f (z) =

γ1z1

Qp
(mi )vi ·z+ri
zk
· · · γk C(z) Qqi=1
j=1 (nj )wj ·z+sj

;

(2) for all i and j and z ∈ Rℓ , vi · z + ri and wj · z + sj are positive;
(3) the Pochhammer symbols occurring in the products are nonzero.
Theorem 4.1.10 and Theorem 4.0.2 apply to hypergeometric terms on polyhedral regions other than Zk via Lemma 3.4.6. We define a function f on a polyhedral
region R ⊂ Zk to be holonomic if the function g on Zk is holonomic, where
g(z) =

4.1



f (z) if z ∈ R
0

otherwise.

Proof of Theorem 4.1.10

We require the following lemmas.
Lemma 4.1.1

If f is holonomic and nondegenerate then there exists a finite set

V ⊂ Zk such that f (z) 6= 0 implies f (z + v) 6= 0 for some v ∈ V .
Let Ei be the shift operator for zi . Thus, E v f (z) = E1v1 · · · Ekvk f (z) = f (z+v).
Proof. Since f is holonomic, by Lemma 4.1 of [16] or 1.5 of [15], for each i ∈
{1, . . . , k} there exists a nonzero operator Li (zi , E) that annihilates f ; Li (zi , E) =
P
v
k
v∈Vi ci,v (zi )E for some finite set Vi ⊂ Z and nonzero univariate polynomials
ci,v ∈ K[z]. The point is that the operator Li is free of all the variables z1 , . . . , zk
except zi . Since Li f = 0 implies E v Li f = 0, we may assume that 0 ∈ Vi .
Let bi = ci,0 . Thus bi is nonzero and
bi (zi )f (z) = −

X

v∈Vi
v6=0

ci,v (zi )f (z + v).

57
Hence bi (zi )f (z) 6= 0 implies f (z +v) 6= 0 for some v ∈ Vi . Letting V̄ = V1 ∪· · ·∪Vk
and S = {z: bi (zi ) = 0 for 1 6 i 6 k}, it follows that if f (z) 6= 0 and z ∈
/ S, then
f (z + v) 6= 0 for some v ∈ V̄ . Of course, the set S is finite since each of the bi has
a finite number of roots. Since f is nondegenerate, there exists z0 ∈ Zk such that
f (z0 ) 6= 0 and z0 ∈
/ S. Finally, let V = V̄ ∪ {z0 − z: z ∈ S}.

Lemma 4.1.2



If f is holonomic on Zk and f is a zero divisor, then f = 0 a.e.

Proof. We prove by induction on the dimension k and the total degree d of
p that if f is holonomic on Zk and pf = 0 a.e. then f = 0 a.e. The statement is
clearly true if either k = 1 or d = 1 since in either case p is simple: by Lemma 3.2.3,
p(z) 6= 0 except on a set of measure zero, so f = 0 a.e.
We assume that the lemma is true if either the dimension is less than k or
the degree is less than d and prove that it is true if the dimension is k and the
degree is d. Suppose, to the contrary, there exists a polynomial p ∈ K[z] of degree
d and a holonomic function f on Zk such that pf = 0 but f is nondegenerate. By
Lemma 2.5.3, there exists a finite set V such that f (z) 6= 0 implies f (z + v) 6= 0
for some v ∈ V . Let x = (x1 , . . . , xk ) where the xi are indeterminates. Let
P
g = v∈V f f v xv . If f (z) 6= 0, then g(z) 6= 0, so g is nondegenerate. Since V

is finite, f f v = 0 a.e. for each v ∈ V implies g = 0 a.e. Thus for at least one
v ∈ V , f f v is nondegenerate. If p 6= pv , then q = p − pv is of lower degree
and qf f v = f v (pf ) − f (pf )v = 0 a.e. But f f v is holonomic, contradicting the
assumption that the statement is true if the degree is less than d and the dimension
is k.
If p = pv we reduce the dimension. If h is holonomic on Zk , and M is an
invertible k × k integer matrix, then g(z) = h(M z) is also holonomic. Thus, by a
change of variable we may assume that p = pek , and hence p is free of zk .
Let x and y be indeterminates, and let K[[x, y]] be the ring of formal power

58
series in x and y. Define the function F : Zk−1 → K[[x, y]] by
F (z1 , . . . , zk−1 ) =

X

f (z1 , . . . , zk )xzk +

X

f (z1 , . . . , zk )y −zk .

zk <0

zk >0

By Proposition 3.4 of [16], F is holonomic in z1 , . . . , zk−1 . But pF = 0, and
therefore F = 0 a.e. by the assumption that the statement is true for dimension
k − 1 and degree d. The function F is constructed so that the formal power series
F (z1 , . . . , zk−1 ) = 0 only if f (z1 , . . . , zk ) = 0 for all zk ∈ Z. Using the fact that
F = 0 a.e. in Zk−1 , it is easily seen then that f = 0 a.e. in Zk , contrary to
assumption.
Corollary 4.1.3


A holonomic hypergeometric term is honest.

Proof. By Lemma 3.1.3 there exist Āv and B̄v such that Āv f = B̄v f v . Let
Āv = pAv and B̄v = pBv where p, Av , and Bv are polynomials and Av and Bv
are relatively prime. Then p(Av f − Bv f v ) = 0. But g = Av f − Bv f v is holonomic
and a zero divisor, so by Lemma 4.1.2, g = 0 a.e. Hence, Av f = Bv f v a.e.
Lemma 4.1.4



Let f be a hypergeometric term on Zk that is not a zero divisor,

and let Rv be the term ratio of f in the direction v. Let V ⊂ Zk be a finite set and
P
P
let cv ∈ K[z] be given for each v ∈ V . If v∈V cv f v = 0 a.e., then v∈V cv Rv = 0.

If f is also holonomic, then the converse is true.

Proof. Since f is a hypergeometric term, by Lemma 3.1.3 there exist polynoP
mials Av and Bv for each v ∈ Zk such that Av f = Bv f v . Since v∈V cv f v = 0 a.e.,
Q
P
P
Q
v
( w∈V Bw ) v∈V cv f v = 0 a.e., hence
c
(
= 0 a.e.,
v
v∈V
w∈V \{v} Bw )Bv f

hence




X

v∈V



cv 

Y

w∈V \{v}

Since f is not a zero divisor,

X

v∈V



cv 





Bw  Av  f = 0 a.e. .

Y

w∈V \{v}



Bw  Av = 0.

59
Dividing by

Q

Bw it follows that
P
Rv = Av /Bv . Hence v∈V cv Rv = 0.
w∈V

P

v∈V

cv Av /Bv = 0. By Lemma 3.1.5,

P
Conversely, assuming f is holonomic, if v∈V cv Rv = 0, then multiplying by
Q


Q
P
w∈V Bw f , it follows that
v∈V cv
w∈V \{v} Bw Av f = 0. Hence,
X

v∈V

and hence,



Y

cv 

w∈V \{v}

Y

Bw

w∈V

!



Bw  Bv f v = 0,

X

cv f v = 0.

v∈V

Since f is holonomic, v∈V cv f v is holonomic. But
P
so by Lemma 4.1.2, v∈V cv f v = 0 a.e.
P

Lemma 4.1.5

P

v∈V

cv f v is a zero divisor,


Let V ⊂ Z2 be finite and let Av and Bv ∈ K[z1 , z2 ] be products

of nonzero simple polynomials for each v ∈ V . Let R ∈ K(z1 , z2 ) be a rational
function such that
X Av
Rv = 0.
Bv

v∈V

Then the denominator of R is a product of simple polynomials.
Proof. Let R = P/Q, where P and Q are relatively prime. Let d be an
irreducible divisor of Q. We will show that d is simple. Suppose the contrary.
Then the dimension of rgal d is less than 1 by the corollary of Lemma 2.5.3, that
is, the dimension is 0. Thus d 6= dw for any nonzero w ∈ Z2 . By a corollary of
Lemma 2.0.2, d 6= cdw for any nonzero w ∈ Z2 and c ∈ K. Thus dw divides Q for
only finitely many w ∈ Z2 . Let w0 be the leftmost of the lowest of the w such that
dw | Q. In other words, w0 = (x0 , y0 ) where
y0 = min{y ∈ Z: d(x,y) | Q for some x ∈ Z}
and
x0 = min{x ∈ Z: d(x,y0 ) | Q}.

60
Similarly, let v0 be the leftmost of the lowest vectors in V .
Multiplying the equation
X Av
Rv = 0
Bv

v∈V

by

Q

u∈V

Bu Qu , we have
X

(*)

Av P v

v∈V

Y

Bu Qu = 0.

u∈V \{v}

Since dw0 | Q, it follows that dv0 +w0 | Qv0 . Since Qv0 appears in every term of the
Q
sum except the term for v = v0 , it follows that dv0 +w0 | Av0 P v0 u∈V \{v0 } Bu Qu .

Furthermore, since Av and Bv are simple and d is not and Qv0 and P v0 are relatively
prime, it follows that dv0 +w0 | Qu for some u ∈ V \ {v0 }. Thus dw0 +v0 −u | Q for
some u ∈ V \ {v0 }, contradicting the definition of w0 .
Lemma 4.1.6



Let f be a nondegenerate holonomic hypergeometric term on Zk

and let Rv be the term ratio of f in the direction v for each v ∈ Zk . Let
Rw (z) =

Y Yv·w av (z · v + j)
C(z + w) D(z)
0
C(z) D(z + w)
bv (z · v + j)
v∈V

j

as in Theorem 3.1.8. Then D is a product of simple polynomials.
Proof. By Lemma 4.1 of [16], for each i, j ∈ {1, . . . , k} there exists a nonzero
operator
L(Ei , Ej , z1 , . . . , zj−1 , zj+1 , . . . , zk )
such that L is free of all Es except Ei and Ej , and L is free of zj . Thus
X

αw f w = 0,

w∈W

where W is a finite subset of the subspace of Zk generated by ei and ej . Furthermore, since each polynomial αw is free of zj , each αw is simple over the field
Ki,j = K({z1 , . . . , zk } \ {zi , zj }).

61
By Lemma 4.1.4,

P

v∈W

αw Rw = 0. Hence
X

αw

w∈W

C w D Āw
= 0,
C Dw B̄w

where
Y Yv·w av (z · v + j)
Āw
=
.
0
b
(z
·
v
+
j)
B̄w
v
v∈V j
Hence
X

αw

w∈W

Āw C w
= 0,
B̄w Dw

and hence
X Aw C w
= 0,
Bw D w

w∈W

where Aw and Bw are the products of polynomials that are simple over Ki,j .
It follows by Lemma 4.1.5 that any irreducible divisor d of D is simple over
Ki,j . Hence, by Corollary 2.5.4, the dimension of rgal(d, (zi , zj ), Ki,j ) is at least 1.
Let Qi,j be the subspace of Qk generated by ei and ej . Since rgal(d, (zi , zj ), Ki,j )
is isomorphic to Qi,j ∩ rgal d, the dimension of Qi,j ∩ rgal d is at least 1.
We show that d is simple in z1 , . . . , zk , that is, the dimension of rgal d is at
least k − 1. Let Qi be the subspace of Qk generated by ei . If Qi ⊂ rgal d for
each i ∈ {1, . . . , k}, then rgal d = Qk . Hence the dimension is k. Otherwise, say
for concreteness that Q1 6⊂ rgal d. Then for each j ∈ {2, . . . , k} there exists uj ∈
Q1,j ∩ rgal d such that uj ∈
/ Q1 . It’s easily seen that u2 , . . . , uk are independent,
so the dimension of rgal d is at least k − 1.
Lemma 4.1.7



Let f be a holonomic hypergeometric term on Zk and let Rv be

the term ratio of f in the direction v for each v ∈ Zk . There exist a polynomial C,
a finite set V ⊂ Zk , and univariate polynomials av and bv for each v ∈ V such that
Rw (z) =

C(z + w) Y Yv·w av (z · v + j)
.
0
C(z)
bv (z · v + j)
j
v∈V

62
Proof. By Theorem 3.1.8 we can express Rw (z) as
Rw (z) =

Y Yv·w av (z · v + j)
C(z + w) D(z)
,
0
C(z) D(z + w)
bv (z · v + j)
j
v∈V

and by Lemma 4.1.6 the irreducible divisors of D are simple. The result follows by
noting that
Yv·w d(v · z + j)
d(v · z)
=
,
0
d(v · (z + w))
d(v · z + 1 + j)
j

and hence the divisors of D can be absorbed into the ‘factorial part’.
Theorem 4.1.8



Let f be a holonomic hypergeometric term on Zk . Then there

exist a polynomial C, a finite set V ⊂ Zk , and univariate polynomials av and
bv ∈ K[z] for each v ∈ V (as in Lemma 4.1.7) and a finite number of polyhedral
regions R1 , . . . , Rm such that
(1) Zk is the union of the Ri and a set of measure zero;
(2) for each i ∈ {1, . . . , m} there exists z0 ∈ Ri such that C(z0 ) 6= 0, and for all
z ∈ Ri ,
f (z) = f (z0 )

C(z) Y Yz·v av (j)
.
z0 ·v bv (j)
C(z0 )
j
v∈V

(3) all the terms av (j) and bv (j) occurring in the product are nonzero.
Theorem 4.1.8 applies to hypergeometric terms on polyhedral regions other
than Zk via Lemma 3.4.6.
Proof. The theorem is an immediate consequence of Theorem 3.7.1 and Lemma 4.1.7.
Corollary 4.1.9


Let f be an holonomic hypergeometric term on Zk . Then there

exist a polynomials C ∈ K[z] and a finite number of polyhedral regions R1 , . . . , RL
such that Zk is the union of the Rℓ and a set of measure zero and for each region
Rℓ there exist a finite set V ⊂ Zk and univariate polynomials av and bv ∈ K[z] and
an integer nv for each v ∈ V such that, for all z ∈ Rℓ ,
Y v·z+n
Y v av (j)
,
(1) f (z) = C(z)
b
(j)
v
j=1
v∈V

63
(2) for all v ∈ V , v · z + nv is a positive integer, and
(3) for all v ∈ V and j, 1 6 j 6 v · z + nv , av (j) 6= 0 and bv (j) 6= 0.
Corollary 4.1.9 applies to hypergeometric terms on polyhedral regions other
than Zk via Lemma 3.4.6.
Proof. This corollary is an immediate consequence of Corollary 3.7.2 and
Lemma 4.1.7.
Theorem 4.1.10


A holonomic hypergeometric term f on Zk over an alge-

braically closed field K is piecewise proper: there exist a polynomial C ∈ K[z]
(as in Theorem 4.1.8) and a finite number of polyhedral regions R1 , . . . , RL such
that Zk is the union of the Rℓ and a set of measure zero, and for each region
Rℓ there exist a vector γ ∈ K k , constants m1 , . . . , mp , n1 , . . . , nq ∈ K, vectors
v1 , . . . , vp , w1 , . . . , wq ∈ Zk , and integers r1 , . . . , rp , s1 , . . . , sq such that
(1) for all z ∈ Rℓ ,
f (z) =

γ1z1

Qp
(mi )vi ·z+ri
zk
· · · γk C(z) Qqi=1
j=1 (nj )wj ·z+sj

;

(2) for all i and j and z ∈ Rℓ , vi · z + ri and wj · z + sj are positive;
(3) the Pochhammer symbols occurring in the products are nonzero.
Theorem 4.1.10 applies to hypergeometric terms on polyhedral regions other
than Zk via Lemma 3.4.6.
Proof. This theorem is an immediate consequence of Corollary 4.1.9 and
Lemma 3.5.2.



Chapter 5
A Solution to a Problem of Cameron
On Sum-free Complete Sets

5.1

Introduction

For any subsets A and B of an additive group G, define A + B = {a + b : a ∈
A and b ∈ B} and −A = {−a : a ∈ A}. A subset S of G is said to be sum-free,
complete, and symmetric respectively if S + S ⊂ S c , S + S ⊃ S c , and S = −S.
Hence, S is sum-free and complete if and only if S + S = S c .
Cameron observed that for any sufficiently small modulus m, every sum-free
complete set in Z/mZ is also symmetric. In fact, Calkin found that m = 36 is the
smallest modulus for which there is a sum-free complete set that is not symmetric
[7]. Cameron asked if there exists such a set for all sufficiently large moduli [7]. We
answer Cameron’s question by showing there exists such a set for all moduli greater
than or equal to 890626.
We also show that every sum-free complete set in Z/mZ that is not symmetric
can be used to construct a counterexample to a conjecture of J.H. Conway. Conway
conjectured that for any finite set S of integers, |S + S| 6 |S − S|. Conway’s
conjecture was disproved by Marica [9]. Later Stein showed how to make the ratio
|S + S|/|S − S| arbitrarily large [12]. We show that if S is sum-free and complete
modulo m but not symmetric, then |S + S| > |S − S|; hence, S is a counterexample
to a modular version of Conway’s conjecture. Further, we show that if S ′ ⊂ Z is a
certain set derived from S, then |S ′ + S ′ | > |S ′ − S ′ |; hence, S ′ is a counterexample
to Conway’s conjecture proper.

65
The history of sum-free sets begins with Schur who showed that the positive
integers can not be partitioned into finitely many sum-free sets [11]. Sum-free sets
have been used to find lower bounds for Ramsey numbers (see pp. 28, 128, 264
in [13]). Cameron describes some applications of sum-free sets and poses several
problems [5],[6],[7]. George Andrews observed that sum-free complete sets play a
role in partition identities (personal communication). For example, the set {1, 4} ∈
Z/5Z, which arises in the Rogers-Ramanujan Identities (p. 109 in [1]), is sum-free,
complete, and symmetric. Calkin showed that the number of sum-free sets contained
within the first n integers is o(2n(1/2+ǫ) ) for every ǫ > 0 [4].

5.2

Cameron’s problem

For any S ⊂ Z and a, b ∈ Z ∪ {−∞, ∞} define Sab = {s ∈ S : a 6 s 6 b}. The
following sets S1 , . . . , S5 are used as building blocks in the construction of infinite
families of modular sum-free complete sets that are not symmetric. Define
353
∞
S1 = (−3 + 5Z)−354
−∞ ∪ (F1 )−353 ∪ (3 + 5Z)354 ,
191
∞
S2 = (−1 + 5Z)−192
−∞ ∪ (F2 )−191 ∪ (1 + 5Z)192 ,
184
∞
S3 = (−4 + 5Z)−185
−∞ ∪ (F3 )−184 ∪ (4 + 5Z)185 ,
∞
252
S4 = (−2 + 5Z)−253
−∞ ∪ (F4 )−252 ∪ (2 + 5Z)253 ,

and

94
∞
S5 = (−1 + 3Z)−95
−∞ ∪ (F5 )−94 ∪ (1 + 3Z)95 ,

where
F1 ={−6, 3} ∪ ±{1, 8, 13, 17, 22, 27, 38, 42, 53, 58, 62, 67, 72, 74, 86, 88, 93, 98, 107,
117, 119, 121, 133, 137, 142, 147, 152, 168, 173, 178, 182, 187, 192, 197, 208,
213, 218, 222, 227, 232, 243, 248, 253, 288, 293, 298, 323, 328, 333, 338},
F2 ={−6, 3} ∪ ±{1, 8, 13, 17, 22, 27, 38, 42, 53, 58, 62, 72, 74, 86, 88, 93, 109, 119,
121, 156, 166},

66
F3 ={−6, 3} ∪ ±{1, 8, 13, 17, 22, 27, 38, 42, 53, 58, 62, 67, 72, 74, 86, 88, 93, 98, 119,
149, 154, 159, 164, 169},
F4 ={−6, 3} ∪ ±{1, 8, 13, 17, 22, 27, 38, 42, 53, 58, 62, 67, 72, 74, 86, 88, 93, 98, 107,
117, 119, 121, 133, 137, 142, 147, 152, 182, 187, 192, 197, 202, 222, 227, 232,
237, 247},

and

F5 ={−1, 2} ∪ ±{5, 8, 14, 17, 29, 40, 44, 47, 67, 70, 79, 82, 85}.
Lemma 5.2.1 reduces to a computation the problem of determining if a set of
the form of S1 , . . . , S5 is sum-free and complete.
b−1
∞
Let S = (A + mZ)−a
−∞ ∪ F−a+1 ∪ (B + mZ)b where a, b, and m

Lemma 5.2.1

are positive integers and A, F , and B ⊂ Z. The set S is sum-free and complete in
Z if and only if
2b+a+3m
2b+2m
2b+a+3m
)2b+2m
+ S−(2a+b+3m)
(S c )−2a−2m
= (S−(2a+b+3m)
−2a−2m .

Proof. Let i = −(2a + 2m), j = 2b + 2m, k = −(2a + 2b + 3m), and l =
2b + a + 3m. We need to show that S is sum-free and complete if and only if
(S c )ji = (Skl + Skl )ji . We first show that S is sum-free and complete if and only
if (S c )ji = (S + S)ji , and then show that (S + S)ji = (Skl + Skl )ji . To prove the
first assertion it suffices to show that if (S c )ji = (S + S)ji , then S is sum-free and
complete; the implication in the other direction is trivial.
We show that if (S c )ji = (S +S)ji , then S is sum-free. Suppose the contrary and
let s1 , s2 , and s3 ∈ S be such that s1 + s2 = s3 and |s3 | is minimal. By assumption
(S + S)ji ⊂ S c , so s3 > j or s3 < i. We consider the case s3 > j. Let s′3 = s3 − m.
′
∞
Since s3 > j > b + m, it follows that s3 ∈ (B + mZ)∞
b and s3 ∈ (B + mZ)b . Since

s3 > 2b + 2m, it follows that s1 > b + m or s2 > b + m. We may assume without
loss of generality that s1 > b + m. Let s′1 = s1 − m. Since s1 > b + m, it follows
′
∞
′
′
′
that s1 ∈ (B + mZ)∞
b and s1 ∈ (B + mZ)b . But s1 + s2 = s3 and |s3 | < |s3 |,

contradicting the minimality of |s3 |. The case s3 < i is similar.

67
We show that if (S c )ji = (S+S)ji , then S is complete. Suppose the contrary and
let c ∈ S c be such that c ∈
/ S + S and |c| is minimal. By assumption, (S c )ji ⊂ S + S,
so c > j or c < i. We consider the case c > j. Let T = (B + mZ)c . Since
∞
c > j > b + m, it follows that c ∈ Tb+m
. Let c′ = c − m. Since T = T + mZ, it

follows that c′ ∈ Tb∞ ⊂ S c . By the minimality of |c|, it follows that c′ = s1 + s2
where s1 and s2 ∈ S. Since c′ > j − m > 2b, it follows that s1 > b or s2 > b. We
may assume without loss of generality that s1 > b. Let s′1 = s1 + m. Since s1 > b,
′
∞
′
it follows that s1 ∈ (B + mZ)∞
b and hence s1 ∈ (B + mZ)b . But c = s1 + s2

contradicting the assumption c ∈
/ S + S. The case c < i is similar.
We complete the proof by showing that (S + S)ji = (Skl + Skl )ji . It suffices
to show that (S + S)ji ⊂ Skl + Skl . Let c ∈ (S + S)ji and let s1 and s2 ∈ S be
such that s1 + s2 = c and |s1 | + |s2 | is minimal. We claim that s1 , s2 ∈ Skl and,
hence, c ∈ (Skl + Skl )ji . Suppose to the contrary s1 > l or s1 < k. We consider
the case s1 > l. Let s′1 = s1 − m and s′2 = s2 + m. Since s1 > l > b + m, it
′
∞
follows that s1 ∈ (B + mZ)∞
b and s1 ∈ (B + mZ)b . Since s1 > l = 2b + a + 3m

and c 6 2b + 2m, it follows that s2 = c − s1 6 −a − m. Since s2 6 −a − m,
−a
′
′
′
it follows that s2 ∈ (A + mZ)−a
−∞ and s2 ∈ (A + mZ)−∞ . But s1 + s2 = c and

|s′1 | + |s′2 | < |s1 | + |s2 |, contradicting the minimality of |s1 | + |s2 |. Hence, the claim
is true in the case s1 > l. The case s1 < k is similar.



Using Lemma 5.2.1, it is easily shown that the sets S1 , . . . , S5 are sum free and
complete. Taking F = F1 , a = b = 354, m = 5, and −A = B = {3} and verifying
1077
1077
718
that ((S1 )c )718
−718 = ((S1 )−1077 + (S1 )−1077 )−718 , it follows from Lemma 5.2.1 that

S1 is sum-free and complete. The cases corresponding to S2 , . . . , S5 are proved
similarly.
Let T ⊂ Z and let n be a positive integer. A sum-free complete set of the form
T + nZ can be identified with a sum-free complete set modulo n; the subset T + nZ
of Z is sum-free and complete if and only if the subset {t + nZ : t ∈ T } of Z/nZ

68
is sum-free and complete. Lemma 5.2.2 shows that a sum-free complete set of the
form of S1 , . . . , S5 can be used to construct a sum-free complete set modulo n for
all sufficiently large n in an arithmetic progression.
Lemma 5.2.2

b−1
∞
Let S = (A + mZ)−a
−∞ ∪ F−a+1 ∪ (B + mZ)b where a, b and m are

positive integers, A, F and B ⊂ Z, and for some integer d, d + A + mZ = B + mZ.
n/2

If S is sum-free and complete in Z, then S−n/2 + nZ is sum-free and complete in Z
for all n such that n > 2m + 4 max(a, b) − 2 and n ∼
= d (mod m).
Proof. Let n be such that n > 2m + 4 max(a, b) − 2 and n ∼
= d (mod m).
n/2

We show that S−n/2 + nZ is sum-free. Suppose the contrary and let s1 , s2 , and
n/2
s3 ∈ S−n/2 be such that s1 +s2 ∼
= s3 (mod n). Since |s1 +s2 −s3 | 6 |s1 |+|s2 |+|s3 | 6

3n/2 and s1 + s2 − s3 6= 0, it follows that s1 + s2 − s3 = ±n. We consider the case
s1 + s2 − s3 = n. Let sg(1) = sg(2) = − sg(3) = 1. If for all i ∈ {1, 2, 3} either
b−1
si ∈ F−a+1
or si sg(i) 6 0, then s1 + s2 − s3 6 3b < n, so we may assume there
b−1
exists j = 1, 2, or 3 such that sj ∈
/ F−a+1
and sj sg(j) > 0. In fact, we may assume

without loss of generality that either j = 1 or j = 3.
b−1
We consider the case j = 1. Let s′1 = s1 − n. Since s1 ∈
/ F−a+1
and s1 > 0, it

follows that s1 ∈ B + mZ and s′1 ∈ B + mZ − n. Since n ∼
= d (mod m), it follows
that mZ − n = mZ − d. Hence, s′1 ∈ B + mZ − d = A + mZ. Since s1 6 n/2, it
′
follows that s′1 6 −n/2 6 −a. Hence, s′1 ∈ (A + mZ)−a
−∞ ⊂ S. But s1 + s2 = s3 ,

contradicting the assumption that S is sum-free.
The case j = 3 is similar. This completes the proof in the case s1 + s2 − s3 = n.
n/2

The case s1 + s2 − s3 = −n is similar. We have shown that S−n/2 + nZ is sum-free.
n/2

We show S−n/2 + nZ is complete. Let c ∈ S c be such that |c| ≤ n/2. We need
n/2

to show that c ∼
= t1 + t2 (mod n) for some t1 and t2 ∈ S−n/2 . Since S is complete,
c = s1 + s2 for some s1 and s2 ∈ S. Let s1 and s2 be such that |s1 − s2 | is minimal.
n/2

If s1 and s2 have the same sign, |s1 | + |s2 | = |c| 6 n/2. Hence, s1 and s2 ∈ S−n/2
and we are done, so assume s1 > 0 and s2 < 0.

69
We claim that s1 < b + m or s2 > −a − m. Suppose the contrary and let
s′1 = s1 −m and s′2 = s2 +m. Since s1 > b+m, it follows that s1 and s′1 ∈ (B+mZ)∞
b .
Hence, s′1 ∈ S. Similarly, s′2 ∈ S. But s′1 + s′2 = c and |s′1 − s′2 | < |s1 − s2 |,
contradicting the minimality of |s1 − s2 |. Hence, s1 < b + m or s2 > −a − m as
claimed.
We consider the case s2 > −a−m. If s1 ≤ n/2 we are done, so assume s1 > n/2
and let s′1 = s1 − n. Since s1 > n/2 > b, it follows that s1 ∈ B + mZ. Arguing as
in the case j = 1 above, s′1 ∈ A + mZ. Since c 6 n/2 and s2 > −a − m, it follows
that s′1 = c − s2 − n < −n/2 + a + m. Since n > 2m + 4a − 2, it follows that
−n/2 + m + a 6 −a + 1. Hence, s′1 < −a + 1. Since s′1 6 −a and s′1 ∈ A + mZ,
it follows that s′1 ∈ S. Since s1 > n/2, it follows that s′1 > −n/2, and hence
n/2
s′1 ∈ S−n/2 . But s′1 + s2 ∼
= c (mod n). The case s1 < b + m is similar.

Theorem 5.2.3



For all n > 890626, there exists a sum-free complete set in Z/nZ

that is not symmetric.
Proof. Applying Lemma 5.2.2 with S = S1 , A = {−3}, B = {3}, F = F1 ,
a = b = 354, m = 5, and d = 1, it follows that for every n such that n > 1424
n/2

and n ∼
= 1 (mod 5), the set (S1 )−n/2 + nZ is sum-free and complete. Equivalently,
for every n such that n > 1426 and n ∼
= 1 (mod 5), the set Tn = {s + nZ : s ∈
n/2

(S1 )−n/2 } ⊂ Z/nZ is sum-free and complete. Further, it is clear from the form of
S1 that 3 ∈ Tn and −3 ∈
/ Tn . Hence, Tn is not symmetric. Thus, we have shown
that there is a sum-free complete set that is not symmetric for all moduli in the
set R1 = {m ≥ 1426 : m ∼
= 1 (mod 5)}. Similar arguments using the sets S2 , . . . S5
show that there is a sum-free complete set that is not symmetric for all moduli
in sets R2 = {m ≥ 777 : m ∼
= 2 (mod 5)}, R3 = {m ≥ 748 : m ∼
= 3 (mod 5)},
R4 = {m ≥ 1024 : m ∼
= 4 (mod 5)}, and R5 = {m ≥ 386 : m ∼
= 2 (mod 3)}.
It is easily seen that if there is a sum-free complete set that is not symmetric
for the modulus m, then there is such a set for any modulus that is a multiple of

70
m. Hence, there is a sum-free complete set that is not symmetric for any modulus
with a divisor in the set R = R1 ∪ R2 · · · ∪ R5 .
It remains only to show that for all n ≥ 890626, n has a divisor in the set R.
Let n be greater than or equal to 890626 and write n in the form n = 5a b where
b is not divisible by 5. Since 890626 = 54 1425 + 1, either a ≥ 5 or b ≥ 1426. If
a ≥ 5, then 55 = 3125 divides n. Since 3125 ∈ R5 , it follows that 3125 ∈ R. If
b ≥ 1426, then b ∈ R since the set R1 ∪ R2 · · · ∪ R4 contains every number greater
than or equal to 1426 that is not a multiple of 5. In either case n has a divisor in R.
We have shown that for every n greater than or equal to 890626 there is a sum-free
complete set in Z/nZ that is not symmetric.



The condition that n > 890626 in Theorem 5.2.3 is not sharp and can undoubtedly be considerably reduced.

5.3

Conway’s conjecture

The following theorem shows that if S is sum-free and complete but not symmetric
modulo m, then S must be a counterexample to a modular version of Conway’s
conjecture.
Theorem 5.3.1

If a set S is sum-free and complete but not symmetric modulo

m, then |S + S| > |S − S|.
Before beginning the proof of Theorem 5.3.1, it is useful to observe that S +S ⊂
S c if and only if S − S ⊂ S c ; there are no solutions s1 , s2 , s3 ∈ S to s1 + s2 = s3 if
and only if there are no solutions to s3 − s2 = s1
Proof. Suppose to the contrary S is sum-free and complete but not symmetric
modulo m and |S + S| 6 |S − S|. Since S is sum-free, S + S ⊂ S c and hence
S − S ⊂ S c . Since S c = S + S, it follows that S − S ⊂ S + S. But |S + S| 6 |S − S|,
so S − S = S + S and hence S − S = S c . The set S − S is symmetric, hence S c is
symmetric, hence S is symmetric, contrary to assumption.



Theorem 5.3.2 shows that if S is sum-free and complete but not symmetric

71
modulo m, then S can be used to construct a counterexample to Conway’s conjecture.
Theorem 5.3.2

Let A ⊂ Z/mZ be sum-free and complete but not symmetric,

let r = |A − A|/|A + A|, and let S be the set of integers congruent modulo m to a
member of A. For all n > 2m/(1 − r), we have |S0n + S0n | > |S0n − S0n |.
We require the following lemma for the proof of Theorem 5.3.2.
Lemma 5.3.3

Let A, B ⊂ Z, S = A + mZ, and T = B + mZ. For any integers

i, j, k, and l such that j − i > m − 1 and k − l > m − 1,
j+l−m+1
(Sij + Tkl )j+l−m+1
i+k+m−1 = (S + T )i+k+m−1 .

Proof. To prove Lemma 5.3.3, we need only show
j+l−m+1
(Sij + Tkl )j+l−m+1
i+k+m−1 ⊃ (S + T )i+k+m−1 ,

(1)

since the containment in the other direction is trivial. We first consider the case
j − i = k − l = m − 1. Let s = j + l − m + 1 = i + k + m − 1. Since j − i > m − 1,
S = Sij + mZ. Similarly, T = Tkl + mZ. Hence,
S + T = (Sij + mZ) + (Tkl + mZ) = Sij + Tkl + mZ
∞
= Sij + Tkl + (mZ−1
−∞ ∪ {0} ∪ mZ1 )
j
j
l
∞
l
= (Sij + Tkl + mZ−1
−∞ ) ∪ (Si + Tk ) ∪ (Si + Tk + mZ1 )

⊂ Zj+l−m
∪ (Sij + Tkl ) ∪ Z∞
i+k+m
−∞
j
∞
l
⊂ Zs−1
−∞ ∪ (Si + Tk ) ∪ Zs+1 .

It follows that (Sij + Tkl )ss ⊃ (S + T )ss which is that statment of (1) for the case
j − i = k − l = m − 1.
We derive the general case from the previous one. Let j−i > m−1, k−l > m−1

72
and define I = {(a, b, c, d) : Zba ⊂ Zji , Zdc ⊂ Zlk , and b − a = d − c = m − 1}.
(Sij + Tkl )j+l−m+1
i+k+m−1 ⊃

[

(Sab + Tcd )b+d−m+1
a+c+m−1

(a,b,c,d)∈I

⊃

[

(S + T )b+d−m+1
a+c+m−1

by the previous case

(a,b,c,d)∈I

⊃ (S + T )j+l−m+1
i+k+m−1 ,
so (1) is proved.



Proof. We now prove Theorem 5.3.2. Let n > 2m/(1 − r). By Theorem 5.3.1,
r < 1 so n > m − 1. Hence, by Lemma 5.3.3,
m−1+⌊k⌋m−1

(S0n + S0n )2n−m+1
= (S + S)2n−m+1
= (S + S)m−1+km−1
⊃ (S + S)m−1
m−1
m−1
m−1

,

where k = (2n − 2m + 3)/m and ⌊k⌋ is the greatest integer less than or equal to
k. Since S + S is the set of integers congruent modulo m to a member of A + A,
it follows that |(S + S)a+im−1
| = i|A + A| for any a and i > 0. In particular,
a
m−1+⌊k⌋m−1

|(S + S)m−1

| = ⌊k⌋|A + A|. Hence |S0n + S0n | > ⌊k⌋|A + A| > (k − 1)|A + A|.
−n+⌈j⌉m−1

Since S0n −S0n ⊂ Zn−n , it follows that S0n −S0n ⊂ (S −S)n−n ⊂ (S −S)−n

,

where j = (2n+1)/m and ⌈j⌉ is the least integer greater than or equal to j. Arguing
−n+⌈j⌉m−1

as before, |(S − S)−n

| = ⌈j⌉ |A − A|. Hence, |S0n − S0n | < ⌈j⌉ |A − A| <

(j + 1)|A − A|.
It follows that
(k − 1)|A + A|
2n − 3m + 3
|S0n + S0n |
>
=
.
|S0n − S0n |
(j + 1)|A − A|
(2n + m + 1)r
The right side is greater than or equal to 1 if and only if
n>

(3 + r)m + r − 3
.
2(1 − r)

Since r < 1, a sufficient condition is that n > 2m/(1 − r).



Bibliography

[1] G.E. Andrews. The theory of partitions. In G.C. Rota, editor, Encyclopedia of
Mathematics and Its Applications, volume 2. Addison-Wesley, 1976.
[2] I.N. Bernstein. Modules over a ring of differential operators, study of the fundamental solutions of equations with constant coefficients. Functional Analysis
and Its Applications, 5(2):89–101, 1971.
[3] J. Bjork. Rings of Differential Operators. North-Holland, Amsterdam, 1979.
[4] N. Calkin. On the number of sum-free sets. Bull. London Math. Soc., 22:141–
144, 1990.
[5] P. Cameron. Cyclic automorphisms of a countable graph and random sum-free
sets. Graphs and Combinatorics, 1:129–135, 1985.
[6] P. Cameron. On the structure of a random sum-free set. Probability Theory
and Related Fields, 76:523–531, 1987.
[7] P. Cameron. Portrait of a typical sum-free set. In C. Whitehead, editor, Surveys
in Combinatorics 1987, pages 13–42. Cambridge Univ. Press, Cambridge, 1987.
[8] R.W. Gosper. Decision procedures for indefinite hypergeometric summation.
Proc. Natl. Acad. Sci. U.S.A., 75:40–42, 1978.
[9] J. Marica. On a conjecture of Conway. Canad. Math. Bull., 12:233–234, 1969.
[10] M. Petkovšek. Hypergeometric solutions of linear recurrences with polynomial
coefficients. J. Symbolic Computation, 14:243–264, 1992.
[11] I. Schur. Über die kongruenz xm + y m ∼
= z m (mod p). Jahresber. Deutsch.
Math.-Verein., 25:114–117, 1916.

74
[12] S. Stein. The cardinalities of a+a and a−a. Canad. Math. Bull., 16(3):343–345,
1973.
[13] W. Wallis, A. Street, and J. Wallis. Combinatorics: Room Squares, Sum-Free
Squares, Hadamard Matrices. Springer-Verlag, Berlin, 1972.
[14] H.S. Wilf and D. Zeilberger. Rational functions certify combinatorial identities.
J. Amer. Math. Soc., 3:147–158, 1990.
[15] H.S. Wilf and D. Zeilberger. An algorithmic proof theory for hypergeometric
(ordinary and “q”) multisum/integral identities. Invent. Math., 108:575–633,
1992.
[16] D. Zeilberger. A holonomic systems approach to special functions identities.
J. of Computational and Applied Mathematics, 32:321–368, 1990.

Corrigenda
p. 6. “term on Zk f ” has been corrected to read “term f on Zk ” .
p. 14. “hence dTj | Y (Sj )” has been corrected to read “hence dTi | Y (Sj )” .
p. 17. “Let A and B be invertible k × k matrices” has been corrected to read “Let A and
B be invertible r × r and k × k matrices respectively” .
p. 25. Near the bottom of the page, “ri =” has been corrected to read “Ri =” .
pp. 4, 36. “{z: v · z = 0}, where v . . . {z: v · z > 0}, where v” has been corrected to read
“{z: v · z = n}, where n ∈ Z and v . . . {z: v · z > n}, where n ∈ Z and v” .
p. 38. “degree at most k − 1” has been corrected to read “degree at most n − 1”
p. 41. “j − aj ” has been corrected to read “j − at ” .
p. 42. Both occurances of “z1 < 1” have been corrected to read “z1 < 0” and “j − aj ” has
been corrected to read “j − a1 ” .
p. 45. “entirely in R′ .” has been corrected to read “entirely in R.” .
p. 57. “implies f (z+v) 6= 0 for some v ∈ V ” has been corrected to read “implies f (z+v) 6=
0 for some v ∈ Vi ”.
P
P
p. 58. “ zk <0 f (z1 , . . . , zk )y zk ” has been corrected to read “ zk <0 f (z1 , . . . , zk )y −zk ” .

p. 61. “there exists uj ∈ Qi,j ∩ rgal d such that uj ∈
/ Qi .” has been corrected to read
“there exists uj ∈ Q1,j ∩ rgal d such that uj ∈
/ Q1 .”
The author was unaware that Theorem 2.8.4 is due to O. Ore [1] in the case of two
variables and M. Sato [2] in the general case.
[1] O. Ore, Sur la forme de fonctions hypergéométriques de plusieurs variables, J.
Math. Pures et Appl. 9 (1930), 311-327.
[2] M. Sato, Theory of Prehomogeneous Vector Spaces, Nagoya Math. J. 120
(1990), 1-34.

