arXiv:1508.05035v2 [math.NT] 24 Aug 2015

Bounds for the first several prime character nonresidues
Paul Pollack
Let Îµ > 0. We prove that there are constants m0 = m0 (Îµ) and Îº = Îº(Îµ) > 0 for
which the following holds: For every integer m > m0 and every nontrivial Dirichlet
1
âˆš

+Îµ

character modulo m, there are more than mÎº primes â„“ â‰¤ m 4 e with Ï‡(â„“) âˆˆ
/ {0, 1}.
The proof uses the fundamental lemma of the sieve, Nortonâ€™s reï¬nement of the
Burgess bounds, and a result of Tenenbaum on the distribution of smooth numbers
satisfying a coprimality condition. For quadratic characters, we demonstrate a
1
somewhat weaker lower bound on the number of primes â„“ â‰¤ m 4 +Ç« with Ï‡(â„“) = 1.

1 Introduction
Let Ï‡ be a nonprincipal Dirichlet character. An integer n is called a Ï‡-nonresidue if Ï‡(n) âˆˆ
/
{0, 1}. Problems about character nonresidues go back to the beginnings of modern number
theory. Indeed,
one can read out of Gaussâ€™s Disquisitiones that for primes p â‰¡ 1 (mod 8) and
âˆš
p
Ï‡(Â·) = Â· , the smallest Ï‡-nonresidue does not exceed 2 p + 1 [10, Article 129]. This was an
auxiliary result required for Gaussâ€™s ï¬rst proof of the quadratic reciprocity law.
In the early 20th century, I. M. Vinogradov initiated the study of how the quadratic residues
and nonresidues modulo a prime p are distributed in the interval [1, p âˆ’ 1]. A particularly
natural problem is to estimate the size of np , the smallest quadratic nonresidue modulo p.
Vinogradov conjectured that np â‰ªÎµ pÎµ , for each Îµ > 0. By means of a novel estimate for
character sums (independently discovered by PÃ³lya), coupled with a clever sieving argument,
1
âˆš

+Îµ

he showed [24] that np â‰ªÎµ p 2 e . Burgessâ€™s character sum bounds [4], in conjunction with
Vinogradovâ€™s methods, yield the sharper estimate
1
âˆš

n p â‰ªÎµ p 4

e

+Îµ

.

(1)

1
. But
Fifty years of subsequent research has not led to any improvement in the exponent 4âˆš
e
generalizing (1), Norton âˆš
showed that if Ï‡ is any nontrivial character modulo m, then the least
1/4
e+Îµ ). See [18, Theorem 1.30].
Ï‡-nonresidue is OÎµ (m
Since Ï‡ is completely multiplicative, the smallest Ï‡-nonresidue is necessarily prime. In this
note, we prove that there are actually many prime Ï‡-nonresidues satisfying the Burgessâ€“Norton
upper bound.

Theorem 1.1. For each Îµ > 0, there are numbers m0 (Îµ) and Îº = Îº(Îµ) > 0 for which the following
holds: For all m > m0 and each nontrivial character Ï‡ mod m, there are more than mÎº prime
1
âˆš

Ï‡-nonresidues not exceeding m 4

e

+Îµ

.

1

The problem of obtaining an upper bound on the ï¬rst several prime character nonresidues
was considered already by Vinogradov. In [24], he showed that for large p, there are at least
log p
7 log log p prime quadratic nonresidues modulo p not exceeding
1

1

p 2 âˆ’ log log p .
For characters to prime moduli, a result resembling Theorem 1.1 was proved by Hudson in
1983 [15]. (See also Hudsonâ€™s earlier investigations [12, 13, 14].) But even restricted to prime
m, Theorem 1.1 improves on [15] in multiple respects. In [15], the exponent on p is 41 + Îµ instead
1
of 4âˆš
+ Îµ, and the number of nonresidues produced is only cÎµ logloglogp p . Moreover, it is assumed
e
in [15] that the order of Ï‡ is ï¬xed. Stronger results than those of [15] were announced by
Norton already in 1973 [17].1 Unfortunately, a full account of Nortonâ€™s work seems to have
never appeared.
It becomes easier to produce small character nonresidues as the order of Ï‡ increases. This
phenomenon was noticed by Vinogradov [25] and further investigated by Buchstab [3] and
Davenport and ErdÅ‘s [5]. To explain their results requires us to ï¬rst recall the rudiments of
the theory of smooth numbers. For each positive integer n, let P + (n) denote the largest prime
factor of n, with the convention that P + (1) = 1. A natural number n is called y-smooth (or
y-friable) if P + (n) â‰¤ y. For x â‰¥ y â‰¥ 2, we let Î¨(x, y) be the count of y-smooth numbers up to
x. We let Ï be Dickmanâ€™s function, deï¬ned by
Ï(u) = 1 for 0 â‰¤ u â‰¤ 1,

and

uÏâ€² (u) = âˆ’Ï(u âˆ’ 1) for u > 1.

The functions Î¨(x, y) and Ï(u) are intimately connected; it is known that Î¨(x, y) âˆ¼ xÏ(u),
x
where u := log
log y , in a wide range of x and y. In fact, Hildebrand [11] has shown that this
asymptotic formula holds whenever x â†’ âˆ, as long as
y â‰¥ exp((log log x)5/3+Î» )
for some ï¬xed positive Î». For this estimate to be useful, one needs to understand the behavior
of Ï(u). It is not hard to show that Ï is strictly decreasing for u > 1 and that Ï(u) â‰¤ 1/Î“(u + 1).
So for any k > 1, there is a unique uk > 1 with Ï(uk ) = k1 . Buchstab and, independently,
Davenport and ErdÅ‘s (developing ideas implicit in [25]) showed that if Ï‡ mod p has order k â‰¥ 2,
then the least Ï‡-nonresidue is OÎµ,k (p1/2uk +Îµ ). If in their argument Burgessâ€™s method (which
was not available at the time) is used in place of the PÃ³lyaâ€“Vinogradov inequality, then 1/2uk
may be replaced by 1/4uk [26]. We prove the following:
Theorem 1.2. Let Îµ > 0 and k0 â‰¥ 2. There are numbers m0 (Îµ, k0 ) and Îº = Îº(Îµ, k0 ) > 0 for
which the following holds: For all m > m0 and each nontrivial character Ï‡ mod m of order
1

k â‰¥ k0 , there are more than mÎº prime Ï‡-nonresidues not exceeding m 4uk0

+Îµ

.

Remarks.
â€¢ It follows readily from the deï¬nition that Ï(u) = 1 âˆ’ log u for 1 â‰¤ u â‰¤ 2, and so u2 =
e1/2 = 1.6487 . . . and u3 = e2/3 = 1.9477 . . .. For k > 3, it does not seem that uk has a
simple closed form expression.
1

k

Norton claims in [17]: Let Îµ > 0 and k0 â‰¥ 2. If m â‰¥ 3 and [(Z/mZ)Ã— : (Z/mZ)Ã— ] â‰¥ k0 , then each of the
smallest âŒŠlog m/ log log mâŒ‹ primes not dividing m that are kth power nonresidues modulo m is â‰ªÎµ,k0 n1/4uk0 +Îµ .
Here uk0 has the same meaning as in our introduction.

2

â€¢ Theorem 1.1 is the special case k0 = 2 of Theorem 1.2.
One might compare Theorem 1.1 for the quadratic character modulo a prime p with a result
of Banksâ€“Garaevâ€“Heath-Brownâ€“Shparlinski
[1]. They show that for each ï¬xed Îµ > 0, and each
âˆš
e+Îµ
1/4
, the proportion of quadratic nonresidues modulo p in [1, N ] is â‰«Îµ 1 for all primes
N â‰¥p
p > p0 (Îµ).
Our arguments use the ideas of Vinogradov and Davenportâ€“ErdÅ‘s but take advantage of
modern developments in sieve methods and the theory of smooth numbers. A variant of the
Burgess bounds developed by Norton also plays an important role. We note that an application
of the sieve that is similar in spirit to ours appears in work of Bourgain and Lindenstrauss [2,
Theorem 5.1].2
It is equally natural to ask for small prime character residues, i.e., primes â„“ with Ï‡(â„“) = 1.
The most signiï¬cant unconditional result in this direction is due to Linnik and A. I. Vinogradov
[23]. They showed that if Ï‡ is the quadratic character modulo a prime p, then the smallest prime
â„“ with Ï‡(â„“) = 1 satisï¬es â„“ â‰ªÎµ p1/4+Îµ . More generally, Elliott [8] proved that when Ï‡ has order
kâˆ’1
k, the least such â„“ is Ok,Îµ (p 4 +Ç« ). As Elliott notes, this bound is only interesting for small
values of k; otherwise, it is inferior to what follows from known forms of Linnikâ€™s theorem on
primes in progressions. For extensions of the Linnikâ€“Vinogradov method in a diï¬€erent direction,
see [19, 20].
Our ï¬nal result is a partial analogue of Theorem 1.1 for prime residues of quadratic characters.
Regrettably, the number of primes produced falls short of a ï¬xed power of m.
Theorem 1.3. Let Îµ > 0 and let A > 0. There is an m0 = m0 (Îµ, A) with the following property:
If m > m0 , and Ï‡ is a quadratic character modulo m, then there are at least (log m)A primes
1
â„“ â‰¤ m 4 +Îµ with Ï‡(â„“) = 1.
Results of the sort proven here have direct consequences for prime splitting in cyclic extensions of Q. For example, Theorem 1.1 (respectively Theorem 1.3) implies that there are more
1
âˆš

+Îµ

than |âˆ†|Îº inert (respectively, more than (log |âˆ†|)A split) primes p â‰¤ |âˆ†| 4 e
(respectively,
1
+Îµ
p â‰¤ |âˆ†| 4 ) in the quadratic ï¬eld of discriminant âˆ†, as soon as |âˆ†| is large enough in terms of
Îµ (and A).

2 Small prime nonresidues: Proofs of Theorems 1.1 and 1.2
2.1 Preparation
As might be expected, the Burgess bounds play the key role in our analysis. The following
version is due to Norton (see [18, Theorem 1.6]).
Proposition 2.1. Let Ï‡ be a nontrivial character modulo m of order dividing k. Let r be a
positive integer, and let Ç« > 0. For all x > 0,
X
r+1
1
Ï‡(n) â‰ªÇ«,r Rk (m)1/r x1âˆ’ r m 4r2 +Ç« .
nâ‰¤x

Here
2

o
n
Rk (m) = min M (m)3/4 , Q(k)9/8 ,

A special case of their result: Given Îµ > 0, there is an Î± > 0 such that

3

P

1
pÎ± â‰¤â„“â‰¤p1/4+Îµ â„“
(pâ„“)=âˆ’1

>

1
2

âˆ’ Îµ, for all p > p0 (Îµ).

where
M (m) =

Y

pe

and

Y

Q(k) =

pe km, eâ‰¥3

pe .

pe kk, eâ‰¥2

The factor of Rk (m)1/r can be omitted if r â‰¤ 3.
Another crucial tool is a theorem of Tenenbaum concerning the distribution of smooth numbers
satisfying a coprimality condition. For x â‰¥ y â‰¥ 2, let
Î¨q (x, y) = #{n â‰¤ x : gcd(n, q) = 1, P + (q) â‰¤ y}.
Proposition 2.2. For positive integers q and real numbers x, y satisfying
P + (q) â‰¤ y â‰¤ x
we have

and

Ï‰(q) â‰¤ y 1/ log(1+u) ,




log(1 + u) log(1 + Ï‰(q))
Ï•(q)
Î¨(x, y) 1 + O
.
Î¨q (x, y) =
q
log y

As before, u denotes the ratio log x/ log y.
Proof. This is the main result of [21] in the case A = 1.
Remark. If q â€² is the largest divisor of q supported on the primes not exceeding y, then Î¨q (x, y) =
Î¨qâ€² (x, y). So the assumption in Proposition 2.2 that P + (q) â‰¤ y does not entail any loss of
generality.
Theorem 1.2 will be deduced from two variant results claiming weaker upper bounds.
Theorem 2.3. Let Îµ > 0 and k0 â‰¥ 2. There are numbers m0 (Îµ, k0 ) and Îº = Îº(Îµ, k0 ) > 0 for
which the following holds: For all m > m0 and each nontrivial character Ï‡ mod m of order
1

k â‰¥ k0 , there are more than mÎº prime Ï‡-nonresidues not exceeding m 3uk0

+Îµ

.

Theorem 2.4. Let Îµ > 0 and k0 â‰¥ 2. There are numbers m0 (Îµ, k0 ) and Îº = Îº(Îµ, k0 ) > 0 for which
the following holds: For all m > m0 and each nontrivial character Ï‡ mod m of order k â‰¥ k0 ,
1

there are more than mÎº prime Ï‡-nonresidues not exceeding Rk (m)m 4uk0
defined in Proposition 2.1.

+Îµ

. Here Rk (m) is as

The proof of Theorem 2.4 is given in detail in the next section. We include only a brief remark
about the proof of Theorem 2.3, which is almost entirely analogous (but slightly simpler). We
then present the derivation of Theorem 1.2 from Theorems 2.3 and 2.4. We remind the reader
that Theorem 1.1 is the special case k0 = 2 of Theorem 1.2.

2.2 Proof of Theorem 2.4
We let Ï‡ be a nontrivial character modulo m of order k â‰¥ k0 , where k0 â‰¥ 2 is ï¬xed. With
Î´ âˆˆ (0, 41 ), we set
1

x = Rk (m) Â· m 4 +Î´ ,

1

y = x u k0

+Î´

.

To prove Theorem 2.4, it suï¬ƒces to show that for all large m (depending only on k0 and Î´),
there are at least xÎº prime Ï‡-nonresidues in [1, y] for a certain constant Îº = Îº(k0 , Î´) > 0.

4

Let q be the product of the prime Ï‡-nonresidues in [1, y]. Note that gcd(q, m) = 1, from the
deï¬nition of a Ï‡-nonresidue. Our strategy is to estimate
X
(1 + Ï‡(n) + Ï‡2 (n) + Â· Â· Â· + Ï‡kâˆ’1 (n))
(2)
nâ‰¤x
gcd(n,mq)=1

in two diï¬€erent ways.
We ï¬rst derive a lower bound on (2), under the assumption that there are not so many prime
Ï‡-nonresidues in [1, y].
Lemma 2.5. There are constants Î· = Î·(Î´, k0 ) > 0, Îº = Îº(Î´, k0 ) > 0, and m0 = m0 (Î´, k0 ) with
the following property: If m > m0 and Ï‰(q) â‰¤ xÎº , then


X
Ï•(mq)
2k
x.
(1 + Ï‡(n) + Â· Â· Â· + Ï‡(n)kâˆ’1 ) â‰¥ 1 + Î·
3
mq
nâ‰¤x
gcd(n,mq)=1

Proof. Observe that
X
(1 + Ï‡(n) + Â· Â· Â· + Ï‡(n)kâˆ’1 ) = k
nâ‰¤x
gcd(n,mq)=1

X

nâ‰¤x
gcd(n,q)=1, Ï‡(n)=1

1â‰¥k

X

nâ‰¤x
gcd(n,mq)=1
p|nâ‡’pâ‰¤y

1 = k Â· Î¨mq (x, y).

We estimate Î¨mq (x, y) using Proposition 2.2 and the succeeding remark. We have u â‰k0 1,
or equivalently, log y â‰k0 log x. So if Îº is suï¬ƒciently small in terms of k0 , and Ï‰(q) â‰¤ xÎº ,
Proposition 2.2 gives




Y
log(1 + xÎº )
1
1 + Ok0
Î¨mq (x, y) = Î¨(x, y)
1âˆ’
p
log x
p|mq
pâ‰¤y

Ï•(mq)
â‰¥ Î¨(x, y)
mq




log(1 + xÎº )
1 + Ok0
.
log x

Now the result of Hildebrand quoted in the introduction (or a much more elementary theorem)
1

+Î´

shows that Î¨(x, y) = Î¨(x, x uk0 ) â‰¥ ( k10 + Î·)x for a certain Î· = Î·(k0 , Î´) > 0 and all large x.
So if Îº is ï¬xed suï¬ƒciently small, depending on k0 and Î´, and x is suï¬ƒciently large,


Ï•(mq)
2
1
+ Î·
x.
Î¨mq (x, y) >
k0 3
mq
Hence,
X

nâ‰¤x
gcd(n,q)=1

(1 + Ï‡(n) + Â· Â· Â· + Ï‡(n)kâˆ’1 ) â‰¥



k
2k
+
Î·
k0
3

We turn next to an upper bound.

5



Ï•(mq)
xâ‰¥
mq



1+

2k
Î·
3



Ï•(mq)
x.
mq

Lemma 2.6. Let Î² > 0. There are numbers Î· â€² = Î· â€² (Î´) > 0, Îºâ€² = Îºâ€² (Î´, Î²) > 0 and m0 = m0 (Î´, Î²)
â€²
with the following property: If m > m0 and Ï‰(q) â‰¤ xÎº , then
X
Ï•(mq)
â€²
(1 + Ï‡(n) + Ï‡(n)2 + Â· Â· Â· + Ï‡(n)kâˆ’1 ) â‰¤ (1 + Î²)
x + OÎ´ (kx1âˆ’Î· ).
mq
nâ‰¤x
gcd(n,mq)=1

Proof. We let A = {n â‰¤ x : gcd(n, m) = 1, Ï‡(n) = 1} and observe that
X
X
(1 + Ï‡(n) + Ï‡(n)2 + Â· Â· Â· + Ï‡(n)kâˆ’1 ) = k
nâ‰¤x
gcd(n,mq)=1

1.

(3)

nâˆˆA
gcd(n,q)=1

We apply the fundamental lemma of the sieve to estimate the right-hand sum. (The precise
form of the fundamental lemma is not so important, but we have in mind [7, Theorem 4.1, p. 29].)
Let d âˆˆ [1, x] be a squarefree integer dividing q. Then
X
X
1
(1 + Ï‡(n) + Â· Â· Â· + Ï‡(n)kâˆ’1 ).
1=
k
nâ‰¤x
gcd(n,m)=1, d|n

nâˆˆA
d|n

For each j = 0, 1, 2, . . . , k âˆ’ 1,
X

X

Ï‡j (n) = Ï‡j (d)

nâ‰¤x
gcd(n,m)=1, d|n

Ï‡j (e).

eâ‰¤x/d
gcd(e,m)=1

Ç«
When j = 0, the right-hand side is xd Ï•(m)
m + OÇ« (m ), by a straightforward inclusion-exclusion.
For j âˆˆ {1, 2, . . . , k âˆ’ 1}, Proposition 2.1 gives
X
X
X
X
X
Ï‡j (e) =
Ï‡j (e)
Âµ(f ) =
Âµ(f )Ï‡j (f )
Ï‡j (g)
eâ‰¤x/d
gcd(e,m)=1

eâ‰¤x/d

f |e
f |m

f |m

gâ‰¤x/df

r+1

1

1

â‰ªÇ«,r Rk (m)1/r x1âˆ’ r dâˆ’1+ r m 4r2 +Ç«
â‰ªÇ« Rk (m)1/r x

1âˆ’ 1r

âˆ’1+ r1

d

m

r+1
+2Ç«
4r 2

X

1

f âˆ’1+ r

f |m

;

here r â‰¥ 2 and Ç« > 0 are parameters to be chosen. (We used in the last step that the sum on
f has only OÇ« (mÇ« ) terms, each of which is O(1).) Assembling the preceding estimates,
X
r+1
1
1
x Ï•(m)
+ r(d), where r(d) â‰ªÇ«,r Rk (m)1/r x1âˆ’ r dâˆ’1+ r m 4r2 +2Ç« .
1=
dk m
nâˆˆA
d|n

By the fundamental lemma, for any choices of real parameters z â‰¥ 2 and v â‰¥ 1 with z 2v < x,

!
X
X

x Ï•(m) Y
1
1=
1âˆ’
1 + O(v âˆ’v )
1â‰¤
k m
p
nâˆˆA
gcd(n,q)=1

nâˆˆA
p|gcd(n,q)â‡’pâ‰¥z

p|q
p<z

1/r 1âˆ’ 1r

+ OÇ«,r Rk (m)

x

m

r+1
+2Ç«
4r 2

X

d<z 2v
d|q

6

2

Ï‰(d) âˆ’1+ 1r

Âµ (d)3

d

!

.

1
1
âŒ‰ (so that Î´ â‰¥ 2r
). Since x = Rk (m)Â·m1/4+Î´ ,
We now make a choice of parameters. Let r = âŒˆ 2Î´
we have
r+1
r+1
Î´
1
1
1 1
Rk (m)1/r x1âˆ’ r m 4r2 = x Â· mâˆ’ 4r âˆ’Î´/r m 4r2 = x Â· m r ( 4r âˆ’Î´) â‰¤ x Â· mâˆ’ 4r2 .

We take Ç« =

Î´
,
16r 2

so that
Î´

m2Ç« = m 8r2 .
Since r â‰¥ 2 and 3Ï‰(d) â‰ª d1/2 , each term in the sum on d is O(1). Putting it all together, the
O-term above is
Î´
Î´
â‰ªÎ´ x Â· mâˆ’ 4r2 Â· m 8r2 Â· z 2v .
Î´

Since x = Rk (m) Â· m1/4+Î´ â‰¤ m3/4 Â· m1/4+Î´ < m2 , this upper bound is â‰ªÎ´ x1âˆ’ 16r2 z 2v . Taking
Î´

z = x 64r2 v gives a ï¬nal upper bound on the O-term of
â€²

â‰ªÎ´ x1âˆ’Î· ,

where

Î·â€² =

Î´
.
32r 2

Turning attention to the main term, we ï¬x v large enough that the factor 1+O(v âˆ’v ) is smaller
than 1 + 21 Î². Then our main term above does not exceed
x Ï•(mq)
k mq



1
1+ Î²
2

Y
p|q
pâ‰¥z

1
1âˆ’
p

âˆ’1

x Ï•(mq)
â‰¤
k mq


 X 

1
1
1 + Î² exp 2
2
p

x Ï•(mq)
â‰¤
k mq



1
1 + Î² exp(2Ï‰(q)z âˆ’1 ).
2

p|q
pâ‰¥z

â€²

2

Î´
âˆ’1 â‰¤ 2xâˆ’Î´/128r v , and
Îº
Take Îºâ€² = 128r
2 v . Under the assumption that Ï‰(q) â‰¤ x , we have 2Ï‰(q)z
2
exp(2Ï‰(q)z âˆ’1 ) = 1 + O(xâˆ’Î´/128r v ). So once x (or equivalently, m) is large enough, our main
term is smaller than xk Ï•(mq)
mq (1 + Î²). So we have shown that for large m,

X

nâˆˆA
gcd(n,q)=1

1â‰¤

â€²
x Ï•(mq)
(1 + Î²) + OÎ´ (x1âˆ’Î· ).
k mq

Recalling (3) ï¬nishes the proof.
Completion of the proof of Theorem 1.2. We keep the notation from earlier in this section. Let
Î·, Îº be as speciï¬ed in Lemma 2.5. With Î² = Î·/2, choose Î· â€² and Îºâ€² as in Lemma 2.6. If m is
large and we assume that
â€²â€²

Ï‰(q) â‰¤ xÎº ,

where

Îºâ€²â€² = min{Îº, Îºâ€² },

then these lemmas imply that




Ï•(mq)
1 Ï•(mq)
2k
â€²
xâ‰¤ 1+ Î·
x + OÎ´ (kx1âˆ’Î· ).
1+ Î·
3
mq
2
mq
Rearranging,
kÎ·

4k âˆ’ 3 Ï•(mq)
â€²
Ï•(mq)
xâ‰ª
Î·Â·
x â‰ªÎ´ kx1âˆ’Î· ,
mq
6
mq

7

and so

mq
â€²
â‰«k0 ,Î´ xÎ· .
Ï•(mq)

Noting that m < x4 and q â‰¤ y Ï‰(q) â‰¤ xÏ‰(q) , we see that for large x,
mq
â‰ª log log(mq + 2) â‰ª log log x + log(Ï‰(q) + 2) â‰ª log x.
Ï•(mq)
Comparing with the above lower bound, we see that x, and hence m, is bounded. Turning it
â€²â€²
around, for m large enough, there are at least xÎº prime Ï‡-nonresidues in [1, y].
Sketch of the proof of Theorem 2.3. The proof of Theorem 2.3 is quite similar, except that now
we take x = m1/3+Î´ . With this choice of x, we can apply the Burgess bounds with r = 3, which
allows us to omit the factor of Rk (m) in the resulting estimates.

2.3 Deduction of Theorem 1.2
Let Îµ > 0 and k0 â‰¥ 2 be ï¬xed. Let Ï‡ be a nonprincipal character mod m of order k, where
k â‰¥ k0 . We would like to show that as long as m is large enough there must be at least mÎº
prime Ï‡-nonresidues not exceeding x1/4uk0 +Îµ , for a certain Îº = Îº(Îµ, k0 ) > 0. Let k1 be the
smallest positive integer with 3uk1 > 4uk0 . If k â‰¥ k1 , apply Theorem 2.3: We ï¬nd that for large
m, there are at least mÎº0 prime Ï‡-nonresidues
1

â‰¤ m 3uk1

+Îµ

1

â‰¤ m 4uk0

+Îµ

,

where Îº0 = Îº(Îµ, k1 ) in the notation of Theorem 2.3. Suppose instead that k0 â‰¤ k < k1 . Then
Rk (m) is bounded in terms of k0 . Theorem 2.4 thus shows that for large m, there are at least
mÎº1 prime Ï‡-nonresidues
1

â‰¤ Rk (m)m 4uk0

+Îµ/2

1

â‰¤ m 4uk0

+Îµ

,

where Îº1 = Îº(Îµ/2, k0 ) in the notation of Theorem 2.4. Theorem 1.2 follows with Îº = min{Îº0 , Îº1 }.
Remark. By a minor modiï¬cation of our proof, one can establish the following more general
result. Theorem 1.2 corresponds to the case H = ker Ï‡.

Theorem 2.7. Let Îµ > 0 and k0 â‰¥ 2. There are numbers m0 (Îµ, k0 ) and Îº = Îº(Îµ, k0 ) > 0 for which
the following holds: For all m > m0 and every proper subgroup H of G = (Z/mZ)Ã— of index
1

k â‰¥ k0 , there are more than mÎº primes â„“ not exceeding m 4uk0

+Îµ
1

with â„“ âˆ¤ m and â„“ mod m âˆˆ
/ H.
+Îµ

This strengthens [18, Theorem 1.20], where the bound Ok0 ,Ç« (m 4uk0 ) is established for the ï¬rst
such prime â„“.
The main idea in the proof of the generalization is to replace 1 + Ï‡(n) + Â· Â· Â· + Ï‡(n)kâˆ’1 with
P
[
[ Ï‡(n), where G/H denotes the group of characters Ï‡ mod m with ker Ï‡ âŠƒ H. We leave
Ï‡âˆˆG/H
the remaining details to the reader.

8

3 Small prime residues of quadratic characters: Proof of Theorem 1.3
The
P next proposition is a variant of [23, Theorem 2]. Given a character Ï‡, we let rÏ‡ (n) =
d|n Ï‡(d). Since Ï‡ will be clear from context, we will suppress the subscript.

Proposition 3.1. For each Ç« > 0, there is a constant Î· = Î·(Ç«) > 0 for which the following holds:
If Ï‡ is a quadratic character modulo m and x â‰¥ m1/4+Ç« , then
X
r(n) = L(1, Ï‡)x + OÇ« (x1âˆ’Î· ).
nâ‰¤x

1

1

+ Ç«
Ï…
4 2 . Put z = x/y. By Dirichletâ€™s hyperbola
Proof. With Ï… = 1/4+Ç«/2
1/4+Ç« , put y = x , so that y â‰¥ m
method,
X
X
X
X X
X
X
r(n) =
Ï‡(d)
1+
Ï‡(d) âˆ’
Ï‡(d)
1.
(4)
nâ‰¤x

dâ‰¤y

eâ‰¤x/d

eâ‰¤z dâ‰¤x/e

dâ‰¤y

eâ‰¤z

By
(with k = 2, so that Rk (m)1/r = 1), there is an Î·0 = Î·0 (Ç«) > 0 with
P Proposition 2.1
1âˆ’Î·
0
for all T â‰¥ y. Thus, the second double sum on the right of (4) is â‰ªÎ´
Ï‡(d) â‰ªÇ« T
dâ‰¤T P
1âˆ’Î·
Î·
âˆ’1
0
0
x
â‰ªÎ´ x(z/x)Î·0 = xy âˆ’Î·0 . Similarly, the third double sum is â‰ªÇ« zy 1âˆ’Î·0 = xy âˆ’Î·0 .
eâ‰¤z e
Finally,
X
dâ‰¤y

Ï‡(d)

X

eâ‰¤x/d

1=

X
dâ‰¤y

Ï‡(d)


X Ï‡(d)
+ O(1) = xL(1, Ï‡)âˆ’x
+O(y) = xL(1, Ï‡)+OÇ« (xy âˆ’Î·0 )+O(y).
d
d

x

d>y

(Here the sum on d > y has been handled by partial summation.) Collecting our estimates and
keeping in mind that y = xÏ… , we obtain the theorem with Î· deï¬ned by 1 âˆ’ Î· = max{Ï…, 1 âˆ’
vÎ·0 }.
Proof of Theorem 1.3. Let Îµ âˆˆ (0, 14 ) and let Ï‡ be a quadratic character modulo m. Let
1

x = m 4 +Îµ ,
and let q be the product of the primes â„“ â‰¤ x with Ï‡(â„“) = 1. We suppose that Ï‰(q) â‰¤ (log m)A ,
and we show this implies that m is bounded by a constant depending on Îµ and A. Throughout
this proof, we suppress any dependence on Îµ and A in our O-notation.
By Proposition 3.1,
X
r(n) = L(1, Ï‡) Â· x + O(x1âˆ’Î· ).
(5)
nâ‰¤x

We can estimate the sum in a second way. Observe that
Y
r(n) =
(1 + Ï‡(â„“) + Â· Â· Â· + Ï‡(â„“e )) â‰¥ 0.

(6)

â„“e kn

Hence, if the subset S of [1, x] is chosen to contain the support of r(n) on [1, x], then


X
0â‰¤
r(n) â‰¤ #S Â· max r(n) .
nâˆˆS

nâ‰¤x

Examining the expression in (6) for r(n), we see S can be chosen as the set of n â‰¤ x where
every prime that appears to the ï¬rst power in the factorization of n divides mq. For each

9

n âˆˆ S, we can write n = n1 n2 , where n1 is a squarefree divisor of mq and n2 is squarefull. The
number of elements of S with n2 > x1/2 is O(x3/4 ). For the remaining elements of S, we have
n1 â‰¤ x/n2 and n1 is a squarefree product of primes dividing mq. There is a bijection
Î¹ : {squarefree divisors of mq} â†’ {squarefrees composed of the ï¬rst Ï‰(mq) primes}
with Î¹(r) â‰¤ r for all r. Hence, given n2 , the number of choices for n1 is at most the number of
integers in [1, x/n2 ] supported on the product of the ï¬rst Ï‰(mq) primes. By our assumption on
Ï‰(q), those primes all belong to the interval [1, (log x)A+1 ], once x is large. Hence, given n2 ,
the number of possible values of n1 is at most
Î¨(x/n2 , (log x)A+1 ).
1

For ï¬xed Î¸ â‰¥ 1, a classical theorem of de Bruijn [6] asserts that Î¨(X, (log X)Î¸ ) = X 1âˆ’ Î¸ +o(1) ,
as X â†’ âˆ. Since x/n2 â‰¥ x1/2 , we deduce that
1

Î¨(x/n2 , (log x)A+1 ) â‰¤ (x/n2 )1âˆ’ A+2
if x is large. Summing on squarefull n2 â‰¤ x1/4 , we see that the number of elements of S arising
1
in this way is O(x1âˆ’ A+2 ). Hence,


1
1
1
1âˆ’ A+2
â€²
1âˆ’Î·â€²
3/4
,
.
, where Î· = min
â‰ªx
#S â‰ª x + x
4 A+2
â€²

Since r(n) â‰¤ Ï„ (n) â‰ª xÎ· /2 for n â‰¤ x,
X
â€²
â€²
r(n) â‰ª #S Â· xÎ· /2 â‰ª x1âˆ’Î· /2 .

(7)

nâ‰¤x

Comparing (5) and (7) gives

â€²

L(1, Ï‡) â‰ª xâˆ’ min{Î· /2,Î·} .
But for large x, this contradicts Siegelâ€™s theorem [16, Theorem 11.14, p. 372].
Remark. Any improvement on Siegelâ€™s lower bound for L(1, Ï‡) would boost the number of â„“
produced in Theorem 1.3. Substantial improvements of this kind would have other closely
related implications. For example, a simple modiï¬cation of an argument of Wolke [27] shows
that for any quadratic character Ï‡ mod m,


X 1
Ï•(m)
1
â‰¥ log
L(1, Ï‡) log m + O(1),
â„“
2
m
â„“â‰¤m
Ï‡(â„“)=1

1 P
where the O(1) constant is absolute. (Here is the short proof: By Proposition 3.1, m
nâ‰¤m r(n) â‰«
P
P
r(n)
1
1
L(1, Ï‡). On the other hand, [22, Theorem 5, p. 308] yields m
nâ‰¤m r(n) â‰ª log m
nâ‰¤m n â‰ª

 P
1
m
1
â„“â‰¤m, Ï‡(â„“)=1 â„“ .)
log m Â· Ï•(m) Â· exp 2

10

Acknowledgments
This work was motivated in part by observations made on mathoverflow by â€œGH from MOâ€ [9].
The author is also grateful to â€œLuciaâ€ for pointing out there the work of Bourgainâ€“Lindenstrauss.
He thanks Enrique TreviÃ±o for useful feedback on an early draft. This research was supported
by NSF award DMS-1402268.

References
[1] W. D. Banks, M. Z. Garaev, D. R. Heath-Brown, and I. E. Shparlinski, Density of non-residues in
Burgess-type intervals and applications, Bull. Lond. Math. Soc. 40 (2008), 88â€“96.
[2] J. Bourgain and E. Lindenstrauss, Entropy of quantum limits, Comm. Math. Phys. 233 (2003), 153â€“
171.
[3] A. A. Buchstab, On those numbers in an arithmetic progression all prime factors of which are small
in order of magnitude, Doklady Akad. Nauk SSSR (N.S.) 67 (1949), 5â€“8 (Russian).
[4] D. A. Burgess, The distribution of quadratic residues and non-residues, Mathematika 4 (1957), 106â€“
112.
[5] H. Davenport and P. ErdÅ‘s, The distribution of quadratic and higher residues, Publ. Math. Debrecen
2 (1952), 252â€“265.
[6] N. G. de Bruijn, On the number of positive integers â‰¤ x and free of prime factors > y. II, Indag.
Math. 28 (1966), 239â€“247.
[7] H. G. Diamond and H. Halberstam, A higher-dimensional sieve method, Cambridge Tracts in Mathematics, vol. 177, Cambridge University Press, Cambridge, 2008.
[8] P. D. T. A. Elliott, The least prime k-th-power residue, J. London Math. Soc. (2) 3 (1971), 205â€“210.
[9] GH from MO (http://mathoverflow.net/users/11919/gh-from-mo), Given a prime p how
many primes â„“ < p of a given quadratic character mod p?, MathOverï¬‚ow, URL:
http://mathoverflow.net/q/52393 (version: 2014-09-03).
[10] C. F. Gauss, Disquisitiones arithmeticae, Springer-Verlag, New York, 1986.
[11] A. J. Hildebrand, On the number of positive integers â‰¤ x and free of prime factors > y, J. Number
Theory 22 (1986), 289â€“307.
[12] R. H. Hudson, Prime k-th power non-residues, Acta Arith. 23 (1973), 89â€“106.
[13]

, A note on the second smallest prime kth power nonresidue, Proc. Amer. Math. Soc. 46
(1974), 343â€“346.

[14]

, Power residues and nonresidues in arithmetic progressions, Trans. Amer. Math. Soc. 194
(1974), 277â€“289.

[15]

, A note on prime kth power nonresidues, Manuscripta Math. 42 (1983), 285â€“288.

[16] H. L. Montgomery and R. C. Vaughan, Multiplicative number theory. I. Classical theory, Cambridge
Studies in Advanced Mathematics, vol. 97, Cambridge University Press, Cambridge, 2007.
[17] K. K. Norton, Estimates for prime kth power nonresidues, Notices Amer. Math. Soc. 21 (1974),
January, 74T-A12.
[18]

, A character-sum estimate and applications, Acta Arith. 85 (1998), 51â€“78.

[19] P. Pollack, Prime splitting in abelian number fields and linear combinations of Dirichlet characters,
Int. J. Number Theory 10 (2014), 885â€“903.

11

[20]

, The smallest prime that splits completely in an abelian number field, Proc. Amer. Math.
Soc. 142 (2014), 1925â€“1934.

[21] G. Tenenbaum, Cribler les entiers sans grand facteur premier, Philos. Trans. Roy. Soc. London Ser.
A 345 (1993), 377â€“384.
[22]

, Introduction to analytic and probabilistic number theory, Cambridge Studies in Advanced
Mathematics, vol. 46, Cambridge University Press, Cambridge, 1995.

[23] A. I. Vinogradov and U. V. Linnik, Hypoelliptic curves and the least prime quadratic residue, Dokl.
Akad. Nauk SSSR 168 (1966), 259â€“261 (Russian).
[24] I. M. Vinogradov, On the distribution of quadratic residues and nonresidues, J. Phys.-Mat. ob-va
Permsk Univ. 2 (1919), 1â€“16 (Russian).
[25]

, On the bound of the least non-residue of n-th powers, Trans. Amer. Math. Soc. 29 (1927),
218â€“226.

[26] Y. Wang, Estimation and application of character sums, Shuxue Jinzhan 7 (1964), 78â€“83.
[27] D. Wolke, A note on the least prime quadratic residue (mod p), Acta Arith. 16 (1969/1970), 85â€“87.

Department of Mathematics, Boyd Graduate Studies Building, University of Georgia, Athens,
Georgia 30602
E-mail address: pollack@uga.edu

12

