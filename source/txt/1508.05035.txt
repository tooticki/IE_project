arXiv:1508.05035v2 [math.NT] 24 Aug 2015

Bounds for the first several prime character nonresidues
Paul Pollack
Let ε > 0. We prove that there are constants m0 = m0 (ε) and κ = κ(ε) > 0 for
which the following holds: For every integer m > m0 and every nontrivial Dirichlet
1
√

+ε

character modulo m, there are more than mκ primes ℓ ≤ m 4 e with χ(ℓ) ∈
/ {0, 1}.
The proof uses the fundamental lemma of the sieve, Norton’s reﬁnement of the
Burgess bounds, and a result of Tenenbaum on the distribution of smooth numbers
satisfying a coprimality condition. For quadratic characters, we demonstrate a
1
somewhat weaker lower bound on the number of primes ℓ ≤ m 4 +ǫ with χ(ℓ) = 1.

1 Introduction
Let χ be a nonprincipal Dirichlet character. An integer n is called a χ-nonresidue if χ(n) ∈
/
{0, 1}. Problems about character nonresidues go back to the beginnings of modern number
theory. Indeed,
one can read out of Gauss’s Disquisitiones that for primes p ≡ 1 (mod 8) and
√
p
χ(·) = · , the smallest χ-nonresidue does not exceed 2 p + 1 [10, Article 129]. This was an
auxiliary result required for Gauss’s ﬁrst proof of the quadratic reciprocity law.
In the early 20th century, I. M. Vinogradov initiated the study of how the quadratic residues
and nonresidues modulo a prime p are distributed in the interval [1, p − 1]. A particularly
natural problem is to estimate the size of np , the smallest quadratic nonresidue modulo p.
Vinogradov conjectured that np ≪ε pε , for each ε > 0. By means of a novel estimate for
character sums (independently discovered by Pólya), coupled with a clever sieving argument,
1
√

+ε

he showed [24] that np ≪ε p 2 e . Burgess’s character sum bounds [4], in conjunction with
Vinogradov’s methods, yield the sharper estimate
1
√

n p ≪ε p 4

e

+ε

.

(1)

1
. But
Fifty years of subsequent research has not led to any improvement in the exponent 4√
e
generalizing (1), Norton √
showed that if χ is any nontrivial character modulo m, then the least
1/4
e+ε ). See [18, Theorem 1.30].
χ-nonresidue is Oε (m
Since χ is completely multiplicative, the smallest χ-nonresidue is necessarily prime. In this
note, we prove that there are actually many prime χ-nonresidues satisfying the Burgess–Norton
upper bound.

Theorem 1.1. For each ε > 0, there are numbers m0 (ε) and κ = κ(ε) > 0 for which the following
holds: For all m > m0 and each nontrivial character χ mod m, there are more than mκ prime
1
√

χ-nonresidues not exceeding m 4

e

+ε

.

1

The problem of obtaining an upper bound on the ﬁrst several prime character nonresidues
was considered already by Vinogradov. In [24], he showed that for large p, there are at least
log p
7 log log p prime quadratic nonresidues modulo p not exceeding
1

1

p 2 − log log p .
For characters to prime moduli, a result resembling Theorem 1.1 was proved by Hudson in
1983 [15]. (See also Hudson’s earlier investigations [12, 13, 14].) But even restricted to prime
m, Theorem 1.1 improves on [15] in multiple respects. In [15], the exponent on p is 41 + ε instead
1
of 4√
+ ε, and the number of nonresidues produced is only cε logloglogp p . Moreover, it is assumed
e
in [15] that the order of χ is ﬁxed. Stronger results than those of [15] were announced by
Norton already in 1973 [17].1 Unfortunately, a full account of Norton’s work seems to have
never appeared.
It becomes easier to produce small character nonresidues as the order of χ increases. This
phenomenon was noticed by Vinogradov [25] and further investigated by Buchstab [3] and
Davenport and Erdős [5]. To explain their results requires us to ﬁrst recall the rudiments of
the theory of smooth numbers. For each positive integer n, let P + (n) denote the largest prime
factor of n, with the convention that P + (1) = 1. A natural number n is called y-smooth (or
y-friable) if P + (n) ≤ y. For x ≥ y ≥ 2, we let Ψ(x, y) be the count of y-smooth numbers up to
x. We let ρ be Dickman’s function, deﬁned by
ρ(u) = 1 for 0 ≤ u ≤ 1,

and

uρ′ (u) = −ρ(u − 1) for u > 1.

The functions Ψ(x, y) and ρ(u) are intimately connected; it is known that Ψ(x, y) ∼ xρ(u),
x
where u := log
log y , in a wide range of x and y. In fact, Hildebrand [11] has shown that this
asymptotic formula holds whenever x → ∞, as long as
y ≥ exp((log log x)5/3+λ )
for some ﬁxed positive λ. For this estimate to be useful, one needs to understand the behavior
of ρ(u). It is not hard to show that ρ is strictly decreasing for u > 1 and that ρ(u) ≤ 1/Γ(u + 1).
So for any k > 1, there is a unique uk > 1 with ρ(uk ) = k1 . Buchstab and, independently,
Davenport and Erdős (developing ideas implicit in [25]) showed that if χ mod p has order k ≥ 2,
then the least χ-nonresidue is Oε,k (p1/2uk +ε ). If in their argument Burgess’s method (which
was not available at the time) is used in place of the Pólya–Vinogradov inequality, then 1/2uk
may be replaced by 1/4uk [26]. We prove the following:
Theorem 1.2. Let ε > 0 and k0 ≥ 2. There are numbers m0 (ε, k0 ) and κ = κ(ε, k0 ) > 0 for
which the following holds: For all m > m0 and each nontrivial character χ mod m of order
1

k ≥ k0 , there are more than mκ prime χ-nonresidues not exceeding m 4uk0

+ε

.

Remarks.
• It follows readily from the deﬁnition that ρ(u) = 1 − log u for 1 ≤ u ≤ 2, and so u2 =
e1/2 = 1.6487 . . . and u3 = e2/3 = 1.9477 . . .. For k > 3, it does not seem that uk has a
simple closed form expression.
1

k

Norton claims in [17]: Let ε > 0 and k0 ≥ 2. If m ≥ 3 and [(Z/mZ)× : (Z/mZ)× ] ≥ k0 , then each of the
smallest ⌊log m/ log log m⌋ primes not dividing m that are kth power nonresidues modulo m is ≪ε,k0 n1/4uk0 +ε .
Here uk0 has the same meaning as in our introduction.

2

• Theorem 1.1 is the special case k0 = 2 of Theorem 1.2.
One might compare Theorem 1.1 for the quadratic character modulo a prime p with a result
of Banks–Garaev–Heath-Brown–Shparlinski
[1]. They show that for each ﬁxed ε > 0, and each
√
e+ε
1/4
, the proportion of quadratic nonresidues modulo p in [1, N ] is ≫ε 1 for all primes
N ≥p
p > p0 (ε).
Our arguments use the ideas of Vinogradov and Davenport–Erdős but take advantage of
modern developments in sieve methods and the theory of smooth numbers. A variant of the
Burgess bounds developed by Norton also plays an important role. We note that an application
of the sieve that is similar in spirit to ours appears in work of Bourgain and Lindenstrauss [2,
Theorem 5.1].2
It is equally natural to ask for small prime character residues, i.e., primes ℓ with χ(ℓ) = 1.
The most signiﬁcant unconditional result in this direction is due to Linnik and A. I. Vinogradov
[23]. They showed that if χ is the quadratic character modulo a prime p, then the smallest prime
ℓ with χ(ℓ) = 1 satisﬁes ℓ ≪ε p1/4+ε . More generally, Elliott [8] proved that when χ has order
k−1
k, the least such ℓ is Ok,ε (p 4 +ǫ ). As Elliott notes, this bound is only interesting for small
values of k; otherwise, it is inferior to what follows from known forms of Linnik’s theorem on
primes in progressions. For extensions of the Linnik–Vinogradov method in a diﬀerent direction,
see [19, 20].
Our ﬁnal result is a partial analogue of Theorem 1.1 for prime residues of quadratic characters.
Regrettably, the number of primes produced falls short of a ﬁxed power of m.
Theorem 1.3. Let ε > 0 and let A > 0. There is an m0 = m0 (ε, A) with the following property:
If m > m0 , and χ is a quadratic character modulo m, then there are at least (log m)A primes
1
ℓ ≤ m 4 +ε with χ(ℓ) = 1.
Results of the sort proven here have direct consequences for prime splitting in cyclic extensions of Q. For example, Theorem 1.1 (respectively Theorem 1.3) implies that there are more
1
√

+ε

than |∆|κ inert (respectively, more than (log |∆|)A split) primes p ≤ |∆| 4 e
(respectively,
1
+ε
p ≤ |∆| 4 ) in the quadratic ﬁeld of discriminant ∆, as soon as |∆| is large enough in terms of
ε (and A).

2 Small prime nonresidues: Proofs of Theorems 1.1 and 1.2
2.1 Preparation
As might be expected, the Burgess bounds play the key role in our analysis. The following
version is due to Norton (see [18, Theorem 1.6]).
Proposition 2.1. Let χ be a nontrivial character modulo m of order dividing k. Let r be a
positive integer, and let ǫ > 0. For all x > 0,
X
r+1
1
χ(n) ≪ǫ,r Rk (m)1/r x1− r m 4r2 +ǫ .
n≤x

Here
2

o
n
Rk (m) = min M (m)3/4 , Q(k)9/8 ,

A special case of their result: Given ε > 0, there is an α > 0 such that

3

P

1
pα ≤ℓ≤p1/4+ε ℓ
(pℓ)=−1

>

1
2

− ε, for all p > p0 (ε).

where
M (m) =

Y

pe

and

Y

Q(k) =

pe km, e≥3

pe .

pe kk, e≥2

The factor of Rk (m)1/r can be omitted if r ≤ 3.
Another crucial tool is a theorem of Tenenbaum concerning the distribution of smooth numbers
satisfying a coprimality condition. For x ≥ y ≥ 2, let
Ψq (x, y) = #{n ≤ x : gcd(n, q) = 1, P + (q) ≤ y}.
Proposition 2.2. For positive integers q and real numbers x, y satisfying
P + (q) ≤ y ≤ x
we have

and

ω(q) ≤ y 1/ log(1+u) ,




log(1 + u) log(1 + ω(q))
ϕ(q)
Ψ(x, y) 1 + O
.
Ψq (x, y) =
q
log y

As before, u denotes the ratio log x/ log y.
Proof. This is the main result of [21] in the case A = 1.
Remark. If q ′ is the largest divisor of q supported on the primes not exceeding y, then Ψq (x, y) =
Ψq′ (x, y). So the assumption in Proposition 2.2 that P + (q) ≤ y does not entail any loss of
generality.
Theorem 1.2 will be deduced from two variant results claiming weaker upper bounds.
Theorem 2.3. Let ε > 0 and k0 ≥ 2. There are numbers m0 (ε, k0 ) and κ = κ(ε, k0 ) > 0 for
which the following holds: For all m > m0 and each nontrivial character χ mod m of order
1

k ≥ k0 , there are more than mκ prime χ-nonresidues not exceeding m 3uk0

+ε

.

Theorem 2.4. Let ε > 0 and k0 ≥ 2. There are numbers m0 (ε, k0 ) and κ = κ(ε, k0 ) > 0 for which
the following holds: For all m > m0 and each nontrivial character χ mod m of order k ≥ k0 ,
1

there are more than mκ prime χ-nonresidues not exceeding Rk (m)m 4uk0
defined in Proposition 2.1.

+ε

. Here Rk (m) is as

The proof of Theorem 2.4 is given in detail in the next section. We include only a brief remark
about the proof of Theorem 2.3, which is almost entirely analogous (but slightly simpler). We
then present the derivation of Theorem 1.2 from Theorems 2.3 and 2.4. We remind the reader
that Theorem 1.1 is the special case k0 = 2 of Theorem 1.2.

2.2 Proof of Theorem 2.4
We let χ be a nontrivial character modulo m of order k ≥ k0 , where k0 ≥ 2 is ﬁxed. With
δ ∈ (0, 41 ), we set
1

x = Rk (m) · m 4 +δ ,

1

y = x u k0

+δ

.

To prove Theorem 2.4, it suﬃces to show that for all large m (depending only on k0 and δ),
there are at least xκ prime χ-nonresidues in [1, y] for a certain constant κ = κ(k0 , δ) > 0.

4

Let q be the product of the prime χ-nonresidues in [1, y]. Note that gcd(q, m) = 1, from the
deﬁnition of a χ-nonresidue. Our strategy is to estimate
X
(1 + χ(n) + χ2 (n) + · · · + χk−1 (n))
(2)
n≤x
gcd(n,mq)=1

in two diﬀerent ways.
We ﬁrst derive a lower bound on (2), under the assumption that there are not so many prime
χ-nonresidues in [1, y].
Lemma 2.5. There are constants η = η(δ, k0 ) > 0, κ = κ(δ, k0 ) > 0, and m0 = m0 (δ, k0 ) with
the following property: If m > m0 and ω(q) ≤ xκ , then


X
ϕ(mq)
2k
x.
(1 + χ(n) + · · · + χ(n)k−1 ) ≥ 1 + η
3
mq
n≤x
gcd(n,mq)=1

Proof. Observe that
X
(1 + χ(n) + · · · + χ(n)k−1 ) = k
n≤x
gcd(n,mq)=1

X

n≤x
gcd(n,q)=1, χ(n)=1

1≥k

X

n≤x
gcd(n,mq)=1
p|n⇒p≤y

1 = k · Ψmq (x, y).

We estimate Ψmq (x, y) using Proposition 2.2 and the succeeding remark. We have u ≍k0 1,
or equivalently, log y ≍k0 log x. So if κ is suﬃciently small in terms of k0 , and ω(q) ≤ xκ ,
Proposition 2.2 gives




Y
log(1 + xκ )
1
1 + Ok0
Ψmq (x, y) = Ψ(x, y)
1−
p
log x
p|mq
p≤y

ϕ(mq)
≥ Ψ(x, y)
mq




log(1 + xκ )
1 + Ok0
.
log x

Now the result of Hildebrand quoted in the introduction (or a much more elementary theorem)
1

+δ

shows that Ψ(x, y) = Ψ(x, x uk0 ) ≥ ( k10 + η)x for a certain η = η(k0 , δ) > 0 and all large x.
So if κ is ﬁxed suﬃciently small, depending on k0 and δ, and x is suﬃciently large,


ϕ(mq)
2
1
+ η
x.
Ψmq (x, y) >
k0 3
mq
Hence,
X

n≤x
gcd(n,q)=1

(1 + χ(n) + · · · + χ(n)k−1 ) ≥



k
2k
+
η
k0
3

We turn next to an upper bound.

5



ϕ(mq)
x≥
mq



1+

2k
η
3



ϕ(mq)
x.
mq

Lemma 2.6. Let β > 0. There are numbers η ′ = η ′ (δ) > 0, κ′ = κ′ (δ, β) > 0 and m0 = m0 (δ, β)
′
with the following property: If m > m0 and ω(q) ≤ xκ , then
X
ϕ(mq)
′
(1 + χ(n) + χ(n)2 + · · · + χ(n)k−1 ) ≤ (1 + β)
x + Oδ (kx1−η ).
mq
n≤x
gcd(n,mq)=1

Proof. We let A = {n ≤ x : gcd(n, m) = 1, χ(n) = 1} and observe that
X
X
(1 + χ(n) + χ(n)2 + · · · + χ(n)k−1 ) = k
n≤x
gcd(n,mq)=1

1.

(3)

n∈A
gcd(n,q)=1

We apply the fundamental lemma of the sieve to estimate the right-hand sum. (The precise
form of the fundamental lemma is not so important, but we have in mind [7, Theorem 4.1, p. 29].)
Let d ∈ [1, x] be a squarefree integer dividing q. Then
X
X
1
(1 + χ(n) + · · · + χ(n)k−1 ).
1=
k
n≤x
gcd(n,m)=1, d|n

n∈A
d|n

For each j = 0, 1, 2, . . . , k − 1,
X

X

χj (n) = χj (d)

n≤x
gcd(n,m)=1, d|n

χj (e).

e≤x/d
gcd(e,m)=1

ǫ
When j = 0, the right-hand side is xd ϕ(m)
m + Oǫ (m ), by a straightforward inclusion-exclusion.
For j ∈ {1, 2, . . . , k − 1}, Proposition 2.1 gives
X
X
X
X
X
χj (e) =
χj (e)
µ(f ) =
µ(f )χj (f )
χj (g)
e≤x/d
gcd(e,m)=1

e≤x/d

f |e
f |m

f |m

g≤x/df

r+1

1

1

≪ǫ,r Rk (m)1/r x1− r d−1+ r m 4r2 +ǫ
≪ǫ Rk (m)1/r x

1− 1r

−1+ r1

d

m

r+1
+2ǫ
4r 2

X

1

f −1+ r

f |m

;

here r ≥ 2 and ǫ > 0 are parameters to be chosen. (We used in the last step that the sum on
f has only Oǫ (mǫ ) terms, each of which is O(1).) Assembling the preceding estimates,
X
r+1
1
1
x ϕ(m)
+ r(d), where r(d) ≪ǫ,r Rk (m)1/r x1− r d−1+ r m 4r2 +2ǫ .
1=
dk m
n∈A
d|n

By the fundamental lemma, for any choices of real parameters z ≥ 2 and v ≥ 1 with z 2v < x,

!
X
X

x ϕ(m) Y
1
1=
1−
1 + O(v −v )
1≤
k m
p
n∈A
gcd(n,q)=1

n∈A
p|gcd(n,q)⇒p≥z

p|q
p<z

1/r 1− 1r

+ Oǫ,r Rk (m)

x

m

r+1
+2ǫ
4r 2

X

d<z 2v
d|q

6

2

ω(d) −1+ 1r

µ (d)3

d

!

.

1
1
⌉ (so that δ ≥ 2r
). Since x = Rk (m)·m1/4+δ ,
We now make a choice of parameters. Let r = ⌈ 2δ
we have
r+1
r+1
δ
1
1
1 1
Rk (m)1/r x1− r m 4r2 = x · m− 4r −δ/r m 4r2 = x · m r ( 4r −δ) ≤ x · m− 4r2 .

We take ǫ =

δ
,
16r 2

so that
δ

m2ǫ = m 8r2 .
Since r ≥ 2 and 3ω(d) ≪ d1/2 , each term in the sum on d is O(1). Putting it all together, the
O-term above is
δ
δ
≪δ x · m− 4r2 · m 8r2 · z 2v .
δ

Since x = Rk (m) · m1/4+δ ≤ m3/4 · m1/4+δ < m2 , this upper bound is ≪δ x1− 16r2 z 2v . Taking
δ

z = x 64r2 v gives a ﬁnal upper bound on the O-term of
′

≪δ x1−η ,

where

η′ =

δ
.
32r 2

Turning attention to the main term, we ﬁx v large enough that the factor 1+O(v −v ) is smaller
than 1 + 21 β. Then our main term above does not exceed
x ϕ(mq)
k mq



1
1+ β
2

Y
p|q
p≥z

1
1−
p

−1

x ϕ(mq)
≤
k mq


 X 

1
1
1 + β exp 2
2
p

x ϕ(mq)
≤
k mq



1
1 + β exp(2ω(q)z −1 ).
2

p|q
p≥z

′

2

δ
−1 ≤ 2x−δ/128r v , and
κ
Take κ′ = 128r
2 v . Under the assumption that ω(q) ≤ x , we have 2ω(q)z
2
exp(2ω(q)z −1 ) = 1 + O(x−δ/128r v ). So once x (or equivalently, m) is large enough, our main
term is smaller than xk ϕ(mq)
mq (1 + β). So we have shown that for large m,

X

n∈A
gcd(n,q)=1

1≤

′
x ϕ(mq)
(1 + β) + Oδ (x1−η ).
k mq

Recalling (3) ﬁnishes the proof.
Completion of the proof of Theorem 1.2. We keep the notation from earlier in this section. Let
η, κ be as speciﬁed in Lemma 2.5. With β = η/2, choose η ′ and κ′ as in Lemma 2.6. If m is
large and we assume that
′′

ω(q) ≤ xκ ,

where

κ′′ = min{κ, κ′ },

then these lemmas imply that




ϕ(mq)
1 ϕ(mq)
2k
′
x≤ 1+ η
x + Oδ (kx1−η ).
1+ η
3
mq
2
mq
Rearranging,
kη

4k − 3 ϕ(mq)
′
ϕ(mq)
x≪
η·
x ≪δ kx1−η ,
mq
6
mq

7

and so

mq
′
≫k0 ,δ xη .
ϕ(mq)

Noting that m < x4 and q ≤ y ω(q) ≤ xω(q) , we see that for large x,
mq
≪ log log(mq + 2) ≪ log log x + log(ω(q) + 2) ≪ log x.
ϕ(mq)
Comparing with the above lower bound, we see that x, and hence m, is bounded. Turning it
′′
around, for m large enough, there are at least xκ prime χ-nonresidues in [1, y].
Sketch of the proof of Theorem 2.3. The proof of Theorem 2.3 is quite similar, except that now
we take x = m1/3+δ . With this choice of x, we can apply the Burgess bounds with r = 3, which
allows us to omit the factor of Rk (m) in the resulting estimates.

2.3 Deduction of Theorem 1.2
Let ε > 0 and k0 ≥ 2 be ﬁxed. Let χ be a nonprincipal character mod m of order k, where
k ≥ k0 . We would like to show that as long as m is large enough there must be at least mκ
prime χ-nonresidues not exceeding x1/4uk0 +ε , for a certain κ = κ(ε, k0 ) > 0. Let k1 be the
smallest positive integer with 3uk1 > 4uk0 . If k ≥ k1 , apply Theorem 2.3: We ﬁnd that for large
m, there are at least mκ0 prime χ-nonresidues
1

≤ m 3uk1

+ε

1

≤ m 4uk0

+ε

,

where κ0 = κ(ε, k1 ) in the notation of Theorem 2.3. Suppose instead that k0 ≤ k < k1 . Then
Rk (m) is bounded in terms of k0 . Theorem 2.4 thus shows that for large m, there are at least
mκ1 prime χ-nonresidues
1

≤ Rk (m)m 4uk0

+ε/2

1

≤ m 4uk0

+ε

,

where κ1 = κ(ε/2, k0 ) in the notation of Theorem 2.4. Theorem 1.2 follows with κ = min{κ0 , κ1 }.
Remark. By a minor modiﬁcation of our proof, one can establish the following more general
result. Theorem 1.2 corresponds to the case H = ker χ.

Theorem 2.7. Let ε > 0 and k0 ≥ 2. There are numbers m0 (ε, k0 ) and κ = κ(ε, k0 ) > 0 for which
the following holds: For all m > m0 and every proper subgroup H of G = (Z/mZ)× of index
1

k ≥ k0 , there are more than mκ primes ℓ not exceeding m 4uk0

+ε
1

with ℓ ∤ m and ℓ mod m ∈
/ H.
+ε

This strengthens [18, Theorem 1.20], where the bound Ok0 ,ǫ (m 4uk0 ) is established for the ﬁrst
such prime ℓ.
The main idea in the proof of the generalization is to replace 1 + χ(n) + · · · + χ(n)k−1 with
P
[
[ χ(n), where G/H denotes the group of characters χ mod m with ker χ ⊃ H. We leave
χ∈G/H
the remaining details to the reader.

8

3 Small prime residues of quadratic characters: Proof of Theorem 1.3
The
P next proposition is a variant of [23, Theorem 2]. Given a character χ, we let rχ (n) =
d|n χ(d). Since χ will be clear from context, we will suppress the subscript.

Proposition 3.1. For each ǫ > 0, there is a constant η = η(ǫ) > 0 for which the following holds:
If χ is a quadratic character modulo m and x ≥ m1/4+ǫ , then
X
r(n) = L(1, χ)x + Oǫ (x1−η ).
n≤x

1

1

+ ǫ
υ
4 2 . Put z = x/y. By Dirichlet’s hyperbola
Proof. With υ = 1/4+ǫ/2
1/4+ǫ , put y = x , so that y ≥ m
method,
X
X
X
X X
X
X
r(n) =
χ(d)
1+
χ(d) −
χ(d)
1.
(4)
n≤x

d≤y

e≤x/d

e≤z d≤x/e

d≤y

e≤z

By
(with k = 2, so that Rk (m)1/r = 1), there is an η0 = η0 (ǫ) > 0 with
P Proposition 2.1
1−η
0
for all T ≥ y. Thus, the second double sum on the right of (4) is ≪δ
χ(d) ≪ǫ T
d≤T P
1−η
η
−1
0
0
x
≪δ x(z/x)η0 = xy −η0 . Similarly, the third double sum is ≪ǫ zy 1−η0 = xy −η0 .
e≤z e
Finally,
X
d≤y

χ(d)

X

e≤x/d

1=

X
d≤y

χ(d)


X χ(d)
+ O(1) = xL(1, χ)−x
+O(y) = xL(1, χ)+Oǫ (xy −η0 )+O(y).
d
d

x

d>y

(Here the sum on d > y has been handled by partial summation.) Collecting our estimates and
keeping in mind that y = xυ , we obtain the theorem with η deﬁned by 1 − η = max{υ, 1 −
vη0 }.
Proof of Theorem 1.3. Let ε ∈ (0, 14 ) and let χ be a quadratic character modulo m. Let
1

x = m 4 +ε ,
and let q be the product of the primes ℓ ≤ x with χ(ℓ) = 1. We suppose that ω(q) ≤ (log m)A ,
and we show this implies that m is bounded by a constant depending on ε and A. Throughout
this proof, we suppress any dependence on ε and A in our O-notation.
By Proposition 3.1,
X
r(n) = L(1, χ) · x + O(x1−η ).
(5)
n≤x

We can estimate the sum in a second way. Observe that
Y
r(n) =
(1 + χ(ℓ) + · · · + χ(ℓe )) ≥ 0.

(6)

ℓe kn

Hence, if the subset S of [1, x] is chosen to contain the support of r(n) on [1, x], then


X
0≤
r(n) ≤ #S · max r(n) .
n∈S

n≤x

Examining the expression in (6) for r(n), we see S can be chosen as the set of n ≤ x where
every prime that appears to the ﬁrst power in the factorization of n divides mq. For each

9

n ∈ S, we can write n = n1 n2 , where n1 is a squarefree divisor of mq and n2 is squarefull. The
number of elements of S with n2 > x1/2 is O(x3/4 ). For the remaining elements of S, we have
n1 ≤ x/n2 and n1 is a squarefree product of primes dividing mq. There is a bijection
ι : {squarefree divisors of mq} → {squarefrees composed of the ﬁrst ω(mq) primes}
with ι(r) ≤ r for all r. Hence, given n2 , the number of choices for n1 is at most the number of
integers in [1, x/n2 ] supported on the product of the ﬁrst ω(mq) primes. By our assumption on
ω(q), those primes all belong to the interval [1, (log x)A+1 ], once x is large. Hence, given n2 ,
the number of possible values of n1 is at most
Ψ(x/n2 , (log x)A+1 ).
1

For ﬁxed θ ≥ 1, a classical theorem of de Bruijn [6] asserts that Ψ(X, (log X)θ ) = X 1− θ +o(1) ,
as X → ∞. Since x/n2 ≥ x1/2 , we deduce that
1

Ψ(x/n2 , (log x)A+1 ) ≤ (x/n2 )1− A+2
if x is large. Summing on squarefull n2 ≤ x1/4 , we see that the number of elements of S arising
1
in this way is O(x1− A+2 ). Hence,


1
1
1
1− A+2
′
1−η′
3/4
,
.
, where η = min
≪x
#S ≪ x + x
4 A+2
′

Since r(n) ≤ τ (n) ≪ xη /2 for n ≤ x,
X
′
′
r(n) ≪ #S · xη /2 ≪ x1−η /2 .

(7)

n≤x

Comparing (5) and (7) gives

′

L(1, χ) ≪ x− min{η /2,η} .
But for large x, this contradicts Siegel’s theorem [16, Theorem 11.14, p. 372].
Remark. Any improvement on Siegel’s lower bound for L(1, χ) would boost the number of ℓ
produced in Theorem 1.3. Substantial improvements of this kind would have other closely
related implications. For example, a simple modiﬁcation of an argument of Wolke [27] shows
that for any quadratic character χ mod m,


X 1
ϕ(m)
1
≥ log
L(1, χ) log m + O(1),
ℓ
2
m
ℓ≤m
χ(ℓ)=1

1 P
where the O(1) constant is absolute. (Here is the short proof: By Proposition 3.1, m
n≤m r(n) ≫
P
P
r(n)
1
1
L(1, χ). On the other hand, [22, Theorem 5, p. 308] yields m
n≤m r(n) ≪ log m
n≤m n ≪

 P
1
m
1
ℓ≤m, χ(ℓ)=1 ℓ .)
log m · ϕ(m) · exp 2

10

Acknowledgments
This work was motivated in part by observations made on mathoverflow by “GH from MO” [9].
The author is also grateful to “Lucia” for pointing out there the work of Bourgain–Lindenstrauss.
He thanks Enrique Treviño for useful feedback on an early draft. This research was supported
by NSF award DMS-1402268.

References
[1] W. D. Banks, M. Z. Garaev, D. R. Heath-Brown, and I. E. Shparlinski, Density of non-residues in
Burgess-type intervals and applications, Bull. Lond. Math. Soc. 40 (2008), 88–96.
[2] J. Bourgain and E. Lindenstrauss, Entropy of quantum limits, Comm. Math. Phys. 233 (2003), 153–
171.
[3] A. A. Buchstab, On those numbers in an arithmetic progression all prime factors of which are small
in order of magnitude, Doklady Akad. Nauk SSSR (N.S.) 67 (1949), 5–8 (Russian).
[4] D. A. Burgess, The distribution of quadratic residues and non-residues, Mathematika 4 (1957), 106–
112.
[5] H. Davenport and P. Erdős, The distribution of quadratic and higher residues, Publ. Math. Debrecen
2 (1952), 252–265.
[6] N. G. de Bruijn, On the number of positive integers ≤ x and free of prime factors > y. II, Indag.
Math. 28 (1966), 239–247.
[7] H. G. Diamond and H. Halberstam, A higher-dimensional sieve method, Cambridge Tracts in Mathematics, vol. 177, Cambridge University Press, Cambridge, 2008.
[8] P. D. T. A. Elliott, The least prime k-th-power residue, J. London Math. Soc. (2) 3 (1971), 205–210.
[9] GH from MO (http://mathoverflow.net/users/11919/gh-from-mo), Given a prime p how
many primes ℓ < p of a given quadratic character mod p?, MathOverﬂow, URL:
http://mathoverflow.net/q/52393 (version: 2014-09-03).
[10] C. F. Gauss, Disquisitiones arithmeticae, Springer-Verlag, New York, 1986.
[11] A. J. Hildebrand, On the number of positive integers ≤ x and free of prime factors > y, J. Number
Theory 22 (1986), 289–307.
[12] R. H. Hudson, Prime k-th power non-residues, Acta Arith. 23 (1973), 89–106.
[13]

, A note on the second smallest prime kth power nonresidue, Proc. Amer. Math. Soc. 46
(1974), 343–346.

[14]

, Power residues and nonresidues in arithmetic progressions, Trans. Amer. Math. Soc. 194
(1974), 277–289.

[15]

, A note on prime kth power nonresidues, Manuscripta Math. 42 (1983), 285–288.

[16] H. L. Montgomery and R. C. Vaughan, Multiplicative number theory. I. Classical theory, Cambridge
Studies in Advanced Mathematics, vol. 97, Cambridge University Press, Cambridge, 2007.
[17] K. K. Norton, Estimates for prime kth power nonresidues, Notices Amer. Math. Soc. 21 (1974),
January, 74T-A12.
[18]

, A character-sum estimate and applications, Acta Arith. 85 (1998), 51–78.

[19] P. Pollack, Prime splitting in abelian number fields and linear combinations of Dirichlet characters,
Int. J. Number Theory 10 (2014), 885–903.

11

[20]

, The smallest prime that splits completely in an abelian number field, Proc. Amer. Math.
Soc. 142 (2014), 1925–1934.

[21] G. Tenenbaum, Cribler les entiers sans grand facteur premier, Philos. Trans. Roy. Soc. London Ser.
A 345 (1993), 377–384.
[22]

, Introduction to analytic and probabilistic number theory, Cambridge Studies in Advanced
Mathematics, vol. 46, Cambridge University Press, Cambridge, 1995.

[23] A. I. Vinogradov and U. V. Linnik, Hypoelliptic curves and the least prime quadratic residue, Dokl.
Akad. Nauk SSSR 168 (1966), 259–261 (Russian).
[24] I. M. Vinogradov, On the distribution of quadratic residues and nonresidues, J. Phys.-Mat. ob-va
Permsk Univ. 2 (1919), 1–16 (Russian).
[25]

, On the bound of the least non-residue of n-th powers, Trans. Amer. Math. Soc. 29 (1927),
218–226.

[26] Y. Wang, Estimation and application of character sums, Shuxue Jinzhan 7 (1964), 78–83.
[27] D. Wolke, A note on the least prime quadratic residue (mod p), Acta Arith. 16 (1969/1970), 85–87.

Department of Mathematics, Boyd Graduate Studies Building, University of Georgia, Athens,
Georgia 30602
E-mail address: pollack@uga.edu

12

