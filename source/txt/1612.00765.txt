arXiv:1612.00765v3 [math.NT] 20 Jun 2018

A GENERALIZATION OF RAMANUJANâ€™S CONGRUENCE
TO MODULAR FORMS OF PRIME LEVEL
RADU GABA AND ALEXANDRU A. POPA
Abstract. We prove congruences between cuspidal newforms and Eisenstein series of
prime level, which generalize Ramanujanâ€™s congruence. Such congruences were recently
found by Billerey and Menares, and we refine them by specifying the Atkin-Lehner
eigenvalue of the newform involved. We show that similar refinements hold for the level
raising congruences between cuspidal newforms of different levels, due to Ribet and
Diamond. The proof relies on studying the new subspace and the Eisenstein subspace
of the space of period polynomials for the congruence subgroup Î“0 (N ), and on a version
of Iharaâ€™s lemma.

1. Introduction
Let Ek be the Eisenstein series of even weight k > 4 for the full modular group, normalized
so that its Fourier expansion is
Bk X
+
Ïƒkâˆ’1 (n)q n ,
Ek (z) = âˆ’
2k
n>1
P
where Bk is the Bernoulli number, Ïƒa (n) = d|n da , and q = e2Ï€iz . Let I be a prime ideal
k
dividing the numerator of B
2k , in the number field generated by the eigenvalues of Hecke
eigenforms of weight k. Then there exists such a cuspidal Hecke eigenform f such that
(1.1)

f â‰¡ Ek

(mod I);

for k = 12 this is the well-known Ramanujan congruence modulo 691, while for higher
weights it was proved in [15, 8]. This and later congruences mean that the difference
between the Fourier coefficients at the cusp âˆ of the two sides belong to I (after clearing
the denominator of the constant term), and we always normalize Hecke eigenforms to have
the coefficient of q equal to 1.
This congruence was recently generalized to newforms f of prime level by BillereyMenares [3] and by Dummigan-Fretwell [13], for Fourier coefficients of index coprime to
the level. In this paper we refine these results, by determining also the Atkin-Lehner eigenvalue of the newform involved, thus obtaining congruences for all coefficients. A similar
congruence between cuspidal newforms of different levels is the â€œlevel raising theoremâ€ of
Ribet [29] and Diamond [10], and we show that it admits a similar refinement. Before stating
the results, we introduce the common setting and explain the heuristic behind them.
Let Sk (N ), Mk (N ) be the space of cusp forms, respectively modular forms of even weight
k > 2 and trivial Nebentypus for the congruence subgroup Î“0 (N ). We let N = M p with
p âˆ¤ M a prime, and consider a modular form g âˆˆ Mk (M ). Fixing Îµ âˆˆ {Â±1}, we define
(1.2)

gp(Îµ) := g|(1 + ÎµWp ),

namely gp(Îµ) (z) := g(z) + Îµpk/2 g(pz),

The authors were supported by CNCSIS grant TE-2014-4-2077.
1

2

RADU GABA AND ALEXANDRU A. POPA

which is a form of level N with eigenvalue Îµ under the Atkin-Lehner involution Wp . Since g
âˆ’k/2+1
has level M , it follows that TrN
g|Tp , where TrN
M (g|Wp ) = p
M : Mk (N ) â†’ Mk (M )
is the trace map (the definition is recalled in Section 2.3). Assuming further that g is an
eigenform of the Hecke operator Tp with eigenvalue Î»p we have

(Îµ)
âˆ’k/2+1
(1.3)
TrN
Î»p Â· g ,
M gp = 1 + p + Îµp

using that [Î“0 (M ) : Î“0 (N )] = 1 + p. The cuspforms f âˆˆ Sk (N ) which are new at p can be
N
characterized by the condition TrN
M f = TrM f |WN = 0, as recalled in Section 2.3, where
we also recall the definitions. We conclude from (1.3) that if g is a newform of level M ,
(Îµ)
then gp is new at p when reduced modulo prime ideals dividing the term in parentheses,
and heuristically we expect that it is congruent modulo such ideals to a Hecke eigenform in
Sk (N ), which is new at p and has eigenvalue Îµ under Wp . The next two theorems confirm
this heuristic.
(Îµ)
(Îµ)
When M = 1 and g = Ek , denote by Ek,p the form gp in (1.2). The factor in (1.3)
splits:
1 + p + Îµpâˆ’k/2+1 Ïƒkâˆ’1 (p) = (pâˆ’k/2+1 + Îµ)(pk/2 + Îµ),
(Îµ)

and since Wp interchanges the cusps âˆ and 0 of Î“0 (p), the constant terms of Ek,p at both
k/2
k
+ Îµ) (up to a sign and powers of p). Therefore candidates for congruence
cusps are B
2k (p
(Îµ)
primes between Ek,p and newforms are prime ideals which divide its constant terms and the
product above.
(Îµ)
We denote by Sk (N ) the subspace of Sk (N ) consisting of eigenforms for Wp with eigenvalue Îµ. We write a|q, a âˆ¤ q if the integer a divides, respectively does not divide, the
numerator of the rational number q.
Theorem 1. Let k > 4 be even, p a prime, and Îµ âˆˆ {Â±1}. Let â„“ be a prime with â„“ > k + 1,
and assume that the following conditions are satisfied:

 Bk
(1.4)
â„“(pk/2 + Îµ)(pk/2âˆ’1 + Îµ) and â„“ (pk/2 + Îµ).
k
k/2
nâˆ’1
If â„“ âˆ¤ (p
+ Îµ), assume also that â„“ âˆ¤ Bn Bkâˆ’n (p
âˆ’ 1) for some even n, 0 < n < k. Then
there exists a prime ideal I of residue characteristic â„“, in the ring of integers generated by
(Îµ)
(Îµ)
Hecke eigenvalues of newforms in Sk (p), and a newform f âˆˆ Sk (p) such that
(1.5)

(Îµ)

f â‰¡ Ek,p

(mod I).

We prove the theorem in Section 3, together with the next theorem. The theorem refines [3, Thm. 1], where it is shown that a congruence as in (1.5) holds for coefficients
coprime to p if and only if â„“|(pk âˆ’ 1)(pkâˆ’2 âˆ’ 1) and â„“ divides the numerator of Bkk (pk âˆ’ 1).
The additional condition we impose if â„“ âˆ¤ (pk/2 + Îµ) is an artifact of our method, but it is
automatically satisfied for all k 6 6 Â· 104 (see Remark 3.1). We also checked numerically
that the theorem holds for â„“ = k Â± 1 in numerous cases (see Example 5.1), but our method
does not apply for these values of â„“.
When the form g is a cuspidal newform, we obtain instead the following refinement of
Diamondâ€™s level raising theorem [10, Thm. 1]. We give this theorem as an illustration of
our method, as it requires little extra work. The statement is not the sharpest possible,
since assumption (1.6) below could probably be removed.

A GENERALIZATION OF RAMANUJANâ€™S CONGRUENCE

3

Theorem 2. Let k > 4 be even, let N = M p with p prime, p âˆ¤ M , and Îµ âˆˆ {Â±1}. Let
g âˆˆ Sk (M ) be a newform with eigenvalue Î»p under Tp . Assume there is a prime â„“ > k + 1,
â„“ âˆ¤ N , and a prime ideal I above it in the field generated by the eigenvalues of all Hecke
(Îµ)
eigenforms in Sk (N ) such that
Î»p â‰¡ âˆ’Îµpk/2âˆ’1 (p + 1) (mod I).
Assume also that either
(1.6)

â„“ âˆ¤ (pk/2âˆ’1 + Îµ) Â· Den P + (g),

or k > 6 and â„“ âˆ¤ (pk/2âˆ’2 + Îµ) Â· Den P âˆ’ (g).
(Îµ)

Then there exists a Hecke eigenform f âˆˆ Sk (N ) which is new at p such that
f â‰¡ gp(Îµ)

(mod I).

In condition (1.6), P + (g), respectively P âˆ’ (g) is the even, respectively the odd period
polynomial of g, normalized so that its principal part is 1 modulo X 2 Kg [X], respectively X
modulo X 3 Kg [X], with Kg the field generated by the Hecke eigenvalues of g. We denote by
Den P Â± (g) the least common multiple of the norms of the denominators of the coefficients
of P Â± (g) (which belong to Kg ). These denominators tend to have few factors of residue
characteristic â„“ > k (none if f is of full level and weight k such that Sk (1) is one dimensional,
cf. the tables in [24, 12]), so this condition is typically verified for a given g (see Example 5.3).
The theorem should hold for weight k = 2 as well, without assumption (1.6) but assuming
that â„“ âˆ¤ Ï•(M ), which would refine the original result of Ribet [29].
The proof of both theorems relies on the theory of period polynomials for congruence
subgroups developed by PasÌ§ol and the second author in [27], and the results we obtain
along the way are of independent interest. In Section 2 we define the new subspace of
the space Ww (N ) of period polynomials of degree w for Î“0 (N ), where N > 1 is arbitrary.
By studying the action of the Atkin-Lehner involution on period polynomials, we determine explicitly a basis for the â€œEisenstein subspaceâ€ of Ww (N ) consisting of Atkin-Lehner
cw (N ) of extended
eigenvectors, when N is square-free. We also need the larger space W
period polynomials introduced in [27], and we use it to prove an Eichler-Shimura isomorckâˆ’2 (N ) and of Mk (N ) (see Propositions 2.7 and 2.9).
phism between the new subspaces of W
Compared to the better known theory of modular symbols, there are two new features: the
new subspace is defined using a trace map from higher to lower levels, as in Serreâ€™s characterization of newforms; and to associate even period polynomials in Wkâˆ’2 (N ) to Eisenstein
ckâˆ’2 (N ).
series when N is square-free, we require the larger space W
The upshot of the theory in Section 2 is that the Eisenstein series in Theorem 1 has an
(Îµ) 
extended period polynomial Ïb Ek,p whose even part belongs to the new subspace Ww (p)new
/Fâ„“ ,
when reduced modulo primes â„“|pk/2 + Îµ, and similarly for the odd part modulo primes â„“
satisfying (1.4) and â„“ âˆ¤ pk/2 + Îµ. The even part is clearly nonzero modulo â„“, but for the
nonvanishing of the odd part we require the extra condition in Theorem 1. Similarly, the
(Îµ) 
polynomials P Â± gp in Theorem 2 are new mod I because of the congruence satisfied by
(Îµ) 
(Îµ) 
Î»p , and at least one is nonzero mod I by assumption (1.6). Since ÏbÂ± Ek,p and P Â± gp
are Hecke and Atkin-Lehner eigenvectors, the previous theorems follow from the DeligneSerre lifting lemma [9] (see Section 3 for the details), once we establish the surjectivity of a
reduction map on newspaces.
This is the other main result, and to state it, we let R be a discrete valuation ring with
residue field F of characteristic â„“. Let Ww (N )pâˆ’new
be the space of polynomials new at
/R
p|N , defined over R (see (2.9) for the definition).

4

RADU GABA AND ALEXANDRU A. POPA

Theorem 3. Let w > 0 be even, and let N = pM with p prime, p âˆ¤ M . Assume that
â„“ > w + 3, â„“ âˆ¤ N , and if w = 0 assume also that â„“ âˆ¤ Ï•(M ). Then the reduction map
Ww (N )pâˆ’new
â†’ Ww (N )pâˆ’new
/R
/F
is surjective (when â„“ = w + 3 > 3, its image has codimension 1).
For the proof, given in Section 4, we use the isomorphism between Ww (N )/R and the
compactly supported cohomology Hc1 (Î“0 (N ), Vw (R)), with Vw (R) the module of polynomials
of degree at most w with coefficients in R. Using PoincareÌ duality, we show in Proposition 4.3
that the surjectivity reduces to a version of Iharaâ€™s lemma [19, Lemma 3.2]. Iharaâ€™s lemma,
or rather the ingredients in its proof, was first used to prove the level raising congruence
mentioned above by Ribet (for weight two) and Diamond (for higher weights). We follow the
argument in [10], modified to take into account that we work with the whole cohomology
rather than just the parabolic part. Our work is close in spirit to Harderâ€™s program of
proving congruences by studying Eisenstein cohomology classes [16].
The surjectivity of the map in Theorem 3, or lack thereof for â„“ = w + 3, can be traced
to the vanishing of the finite cohomology group H 1 (SL2 (Fâ„“ ), Vw (F )) for â„“ > w, and its
nonvanishing for â„“ = w + 3. This was shown in [21], but for completeness we give the proof
in Proposition 4.7.
We end the introduction with two remarks and a conjecture related to Theorem 1.
Theorem 1 is true in weight two as well, when it refines a congruence due to Mazur [26,
Prop. 5.12]. In this case, the Eisenstein subspace of M2 (p) is one dimensional spanned by
an Eisenstein series having Atkin-Lehner eigenvalue âˆ’1, and Theorem 1 predicts that the
newform in Mazurâ€™s congruence can be taken to have the same Atkin-Lehner eigenvalue.
However there are technical difficulties in applying Theorem 3 for w = 0 in this case; the
refined congruence is anyway proved by Yoo [34, Thm. 1.3 (i)], who studies the case of
weight two and square-free level in great detail, using different methods.
Assuming a conjecture of Maeda, the Hecke eigenforms of full level form a single Galois
orbit, so all of them satisfy (1.1) modulo conjugate ideals. Similarly, a generalization of
Maedaâ€™s conjecture due to Tsaknias [33] states that the newforms in Sk (p) form two Galois
orbits for sufficiently large k, the forms in each orbit sharing the same Atkin-Lehner eigenvalue. This would imply that all newforms in Sk (p) satisfy congruence (1.5), when primes â„“
as in Theorem 1 exist.
A conjecture generalizing Ramanujanâ€™s congruence to newforms of square-free levels was
proposed by Billerey and Menares in [3], and we end by stating a conjectural refinement
that includes a generalization of Theorem 2 as well. Let N = M N â€² be square-free, k > 4,
and let g âˆˆ Mk (M ) be a newform of level M . This includes the case of Eisenstein series,
when we necessarily have M = 1 and g = Ek . Let D(N â€² ) denote the set of positive divisors
of N â€² , and let Îµ : D(N â€² ) â†’ {Â±1} be a multiplicative function, which we view as a system of
Atkin-Lehner eigenvalues for modular forms in Mk (N ). Define
X
Y
(Îµ)
(Îµ)
Îµ(d)dk/2 g(dz),
(1 + Îµ(p)Wp ), namely gN â€² (z) =
gN â€² = g|
d|N â€²

p|N â€²

which is a eigenform for Wp for prime p|N â€² with eigenvalue Îµ(p), and it is new at primes
(Îµ)
dividing M . Note that when M = 1 and g = Ek , the constant term of gN at all cusps is
(up to signs and powers of p|N ):
Bk Y k/2
(p
+ Îµ(p)) ,
(1.7)
2k
p|N

A GENERALIZATION OF RAMANUJANâ€™S CONGRUENCE

5

since the group of Atkin-Lehner involutions acts transitively on the cusps for square-free N .
(Îµ)
Let Sk (N ) be the subspace of Sk (N ) consisting of eigenforms for Wp with eigenvalue Îµ(p),
for all p|N â€² .
Conjecture. Assume N = M N â€² square-free and k > 4, and let g âˆˆ Mk (M ) be a newform
of level M , with Hecke eigenvalues Î»p for p|N â€² . Let Îµ : D(N â€² ) â†’ {Â±1} be a system of
Atkin-Lehner eigenvalues as above, and assume that for all p|N â€² we have
Î»p â‰¡ âˆ’Îµ(p)pk/2âˆ’1 (p + 1) (mod I) ,
for I a prime ideal of residue characteristic â„“ in the field generated by the Hecke eigenvalues
(Îµ)
of all newforms in Sk (N ), such that â„“ > k âˆ’ 2, â„“ âˆ¤ 6N . If M = 1 and g = Ek also assume
(Îµ)
that â„“ divides the numerator of (1.7). Then there exists a newform f âˆˆ Sk (N ) such that
(Îµ)

f â‰¡ gN â€²

(mod I).
(Îµ)

By (1.3), the conditions in the conjecture guarantee that gN â€² is cuspidal and â€œnewâ€ when
reduced modulo the ideal I. The reductions mod I make sense in the space Sk (Î“0 (N ), Zâ„“ )
of arithmetic modular forms aÌ€ la Katz [14]. Provided one had a definition of the â€œnew
subspaceâ€ Sk (Î“0 (N ), Zâ„“ )new involving trace maps, as for modular forms over C, then the
conjecture would follow immediately from the surjectivity of the reduction map
Sk (Î“0 (N ), Zâ„“ )new â†’ Sk (Î“0 (N ), Fâ„“ )new .
Part of the conjecture would also follow from a generalization of Theorem 3, stating that
new
the reduction map Ww (N )new
/R â†’ Ww (N )/F is surjective for N square-free.
For cuspidal g, the existence of a newform f as in the conjectureâ€“with possibly non-trivial
Nebentypus and minus the determination of its Atkin-Lehner eigenvalues at primes p|N â€² â€“
follows from a theorem of Diamond and Taylor on non-optimal levels for modular Galois
representations [11]. That theorem was proved for arbitrary M such that (M, N â€² ) = 1 and
N â€² square-free, and we similarly expect the conjecture to hold in the cuspidal case under
these assumptions. When g is an Eisenstein newform of level M > 1, a similar conjecture
can be made, under extra assumptions due to the fact that the group of Atkin-Lehner
involutions no longer acts transitively on the cusps of Î“0 (M ).
For k = 2 and g an Eisenstein series, similar statements have been proved by Yoo [34]
(who also determines the Atkin-Lehner eigenvalues of f ), and Martin [25].
Acknowledgments. We would like to thank VicentÌ§iu PasÌ§ol for many useful conversations. We are grateful to Neil Dummigan and Dan Fretwell for bringing to our attention
reference [3], after a first version of this paper was released as a preprint. We thank a referee
for a thorough reading of the paper and for pointing out an error in an earlier version of
Lemma 4.4.
2. Atkin-Lehner operators and newform theory for period polynomials
In Â§2.1, we briefly review the definition of period polynomials for Î“0 (N ) and the action
of Hecke operators on them. We study the action of Atkin-Lehner operators in more detail
in Â§2.2, and in Â§2.3 we define primitive (new) subspaces using trace maps. In Â§2.4 we
introduce extended period polynomials, and in Â§2.5 we use them to determine an explicit
basis consisting of Atkin-Lehner eigenvectors of the â€œEisenstein subspaceâ€ for square-free N .

6

RADU GABA AND ALEXANDRU A. POPA

2.1. Period polynomials and Hecke operators. We start by recalling from [27] basic
facts about period
polynomials
for the congruence subgroup Î“ = Î“0 (N ) of Î“1 = SL2 (Z).


1 âˆ’1
be
generators
of Î“1 . We use the same notation for their images
,
U
=
Let S = 10 âˆ’1
1 0
0
in PSL2 (Z), which have orders 2, 3, respectively.
We fix a commutative base ring R of characteristic different from 2 and 3. Let Vw (R) be
the space of polynomials of degree at most w with coefficients in R, on which GL2 (Z) acts
on the right by

P |âˆ’w Î³(X) = P (Î³X)(cX + d)w , for Î³ = ac db âˆˆ GL2 (Z).

Let Vw (N )/R be the space of |Î“\Î“1 |-tuples of polynomials,1 identified with maps P : Î“\Î“1 â†’
Vw (R), on which Î“1 acts by P |Î³(A) = P (AÎ³ âˆ’1 )|âˆ’w Î³ for a coset A âˆˆ Î“\Î“1 , Î³ âˆˆ Î“1 . Since
âˆ’1 âˆˆ Î“ we assume w > 0 is even, so âˆ’1 acts trivially on Vw (N )/R . The space of period
polynomials is defined by:

Ww (N )/R = {P âˆˆ Vw (N )/R : P |(1 + S) = P |(1 + U + U 2 ) = 0}.

0
âˆˆ GL2 (Z) belongs to the normalizer of Î“, so Ww (N )/R is preThe element Î´ = âˆ’1
0 1
served by the involution P 7â†’ P |Î´, where P |Î´(A) = P (Î´AÎ´)|âˆ’w Î´, and so it decomposes into
eigenspaces WwÂ± (N )/R for Î´ with eigenvalue Â±1. We call even the polynomials in Ww+ (N ),
and odd those in Wwâˆ’ (N ). This is motivated by the fact that for P âˆˆ Ww+ (N ) the principal part P (I) is even, with I the coset of the identity, but not all components P (A) are
necessarily even.
Remark 2.1. The space Ww (N )/R is isomorphic to the space SymbÎ“0 (N ) Vw (R) of modular
symbols introduced by Ash and Stevens in [2], and by [2, Prop. 4.2] we have a Heckeequivariant isomorphism
(2.1)

Ww (N )/R â‰ƒ Hc1 (Î“0 (N ), Vw (R)).

The compactly supported cohomology group is that of the local system associated to Vw (R)
on the modular surface Î“\H, with H the upper half-plane.
The module Vw (N )/R is simply the induced module IndÎ“Î“1 Vw (R), so, via Shapiroâ€™s lemma,
another way to interpret the isomorphism (2.1) is:
Ww (N )/R â‰ƒ Hc1 (Î“1 , Vw (N )/R ).
Since Î“1 has only one cusp fixed by T = U S , the latter cohomology group can be identified
with the set of Î“1 -cocycles which are 0 on T as in [15], and the isomorphism takes a
polynomial P to the cocyle Ï• with Ï•(T ) = 0, Ï•(T ) = P . See also [27, Sec. 2] and [28, Sec.
2.2].
We will use the isomorphism (2.1) in Section 4. We conclude that the combinatorial description of Ww (N )/R that we use throughout Section 2 gives us a way of studying â€œEisenstein classesâ€ in the compactly supported cohomology of the modular surface.
Throughout Section 2 we are interested in the case R = C, and we set Vw (N ) = Vw (N )/C ,
Ww (N ) = Ww (N )/C . For a cuspform f âˆˆ Sk (N ), its period polynomial Ïf âˆˆ Wkâˆ’2 (N )
(which we sometimes denote by Ï(f )) is defined in [27] by
Z iâˆ
(2.2)
Ïf (A) =
f |k A(z)(X âˆ’ z)kâˆ’2 dz,
âˆ€A âˆˆ Î“\Î“1 ,
0

where we set f |k Ïƒ(z) = f (Ïƒz)(cz + d)âˆ’k for Ïƒ = ac db âˆˆ GL+
2 (R), and f |k A is defined using
any representative of the coset A. This normalization of the stroke |k operator is chosen both
1Note that we have two notations for V (R) = V (1) , but for brevity we use the shorter notation.
w
w
/R

A GENERALIZATION OF RAMANUJANâ€™S CONGRUENCE

7

to be compatible with the earlier operator |âˆ’w on period polynomials, and to avoid scaling
factors in the action of Hecke operatorsâ€“see the last equation in this subsection and (2.11).
The maps ÏÂ± : Sw+2 (N ) â†’ Ww (N ), f 7â†’ ÏÂ±
f are injective, and the Eichler-Shimura
isomorphism can be restated as the following direct sum decomposition
(2.3)

Ww (N ) â‰ƒ Ï+ (Sw+2 (N )) âŠ• Ïâˆ’ (Sw+2 (N )) âŠ• Cw (N ),

where Cw (N ) = {P |1 âˆ’ S : P âˆˆ Vw (N ), P |1 âˆ’ T = 0} is the coboundary subspace [27,
Thm. 2.1]. The dimension of Cw (N ) equals the dimension of the Eisenstein subspace of
Mw+2 (N ) [27, Lemma 4.2], and in Proposition 2.9 we give an explicit basis coming from
Eisenstein series when the level N is square-free and w > 0.
To define the action of Hecke operators on period polynomials, let Mn be the set of 2 Ã— 2
integral matrices of determinant n, and set Mn := Mn /{Â±1}, Rn := Z[Mn ]. Let Î£ âŠ‚ Mn
be a double coset of Î“, namely Î£ = Î“Î£Î“ and the number of right cosets |Î“\Î£| is finite. The
double coset Î£ acts on f âˆˆ Mk (N ) by
X
f |k Ïƒ.
(2.4)
f |[Î£] = nkâˆ’1
ÏƒâˆˆÎ“\Î£

To define the corresponding action on period polynomials, we make the following assumption
on the double coset Î£:
(2.5)

The map Î“\Î£ âˆ’â†’ Î“1 \Î“1 Î£,

Î“Ïƒ 7â†’ Î“1 Ïƒ is bijective ,

or equivalently |Î“\Î£| = |Î“1 \Î“1 Î£|. For P âˆˆ Vw (N ) and M âˆˆ Mn , we define
(
P (AM )|âˆ’w M if M Aâˆ’1 = Aâˆ’1
M MA with AM âˆˆ Î“1 , MA âˆˆ Î£
(2.6)
P |Î£ M (A) =
0
otherwise.
Since both M and âˆ’M act in the same way, the action of elements in M n is also well defined,
and by linearity it extends to an action of elements in Rn . It is not a proper action, but it
is compatible with the action of Î“1 : for g âˆˆ Î“1 , M âˆˆ Mn , we have P |Î£ gM = (P |g)|Î£ M ,
P |Î£ M g = (P |Î£ M )|g.
Let P
Mnâˆ be a system of representatives which fix âˆ for the cosets Î“1 \Mn , and let
âˆ
Tn = MâˆˆMnâˆ M âˆˆ Rn . Let T = U S = ( 10 11 ) be a generator of the stabilizer of âˆ. It was
shown in [7] that there exists Ten âˆˆ Rn such that:

(2.7)

Tnâˆ (1 âˆ’ S) âˆ’ (1 âˆ’ S)Ten âˆˆ (1 âˆ’ T )Rn ,

and in [27] we show that for f âˆˆ Sk (N ) we have Ïf |[Î£] = Ïf |Î£ Ten .


2.2. The Atkin-Lehner operator. Let Î“ = Î“0 (N ) and denote wN = N0 âˆ’1
0 , ÏƒN =
( N0 01 ). The action of the Atkin-Lehner involution WN on modular forms f âˆˆ Mk (N ) is
given by f |WN = N k/2 f |k wN . It is related to the action of the double coset
	
 a b
Î˜N = Î“wN Î“ = Î“wN =
c d âˆˆ MN : N |a, N |d, N |c

1
f |[Î˜N ], with the latter action defined in (2.4). We write P |Î˜ TeN instead
N k/2âˆ’1
of P |Î˜N TeN for the corresponding action on P âˆˆ Vw (N ) given by (2.6).

by f |WN =

Lemma 2.2. (i) We have a bijection Î“\Î“1 â†’ Î“1 \Î“1 ÏƒN Î“1 , given for A âˆˆ Î“\Î“1 by
A 7â†’ KA := Î“1 ÏƒN A.
(ii) We have KA = Î“1 Î˜N A.

8

RADU GABA AND ALEXANDRU A. POPA

âˆ’1
Proof. (i) Since Î“0 (N ) = Î“1 âˆ© ÏƒN
Î“1 ÏƒN , the bijection follows from [31, Prop. 3.1].

(ii) This is immediate from Î“1 Î˜N = Î“1 ÏƒN = { ac db âˆˆ MN : N |a, N |c}.
P
P
(K)
For Ten = MâˆˆMn cM M âˆˆ Rn and a coset K âˆˆ Î“1 \Mn , we let Ten = MâˆˆK cM M be
the part of Ten supported on matrices in K.

Lemma 2.3. Let P âˆˆ Vw (N ) and TeN âˆˆ RN . Then

(KA )

P |Î˜ TeN (A) = P |Î˜ TeN

(A),

for A âˆˆ Î“\Î“1 , where KA âˆˆ Î“1 \MN is the coset defined in Lemma 2.2.
P
Proof. By the definition (2.6), for TeN = cM M âˆˆ RN we have
X
(2.8)
P |Î˜ TeN (A) =
cM Â· P (AM )|âˆ’w M = P |Î˜ Ten(KA) (A),
MâˆˆÎ“1 Î˜N A

where AM âˆˆ Î“\Î“1 is the unique coset such that AM M Aâˆ’1 âŠ‚ Î˜N . The last equality follows

from Lemma 2.2 (ii).
Example 2.4. For the identity coset I, we have KI = Î“1 ÏƒN and we can take
(K )
TeN I = ( N0 01 ) .

The space Ww (1) contains the polynomial 1|âˆ’w 1 âˆ’ S = 1 âˆ’ X w , which belongs to the
coboundary subspace Cw (1) defined in (2.3) and corresponds to the Eisenstein series Ek , as
we will see in Â§2.5. Therefore Ww (N ) contains the polynomial P0 = 1|(1 âˆ’ S), with 1 the
constant polynomial 1 in each coset. We next determine its image under the Atkin-Lehner
operator, which will be used to determine a basis of the â€œEisenstein partâ€ of Ww (N ) when
N is square-free. Denote by (x, y) the greatest common divisor of x, y âˆˆ Z.
Proposition 2.5. Let w > 2 be even, and let P0 = 1|(1 âˆ’ S) âˆˆ Ww (N ). For every TeN
satisfying (2.5) we have
P0 |Î˜ TeN (A) = Nzw âˆ’ Ntw X w
where A = Î“ ( âˆ—z âˆ—t ) and for a âˆˆ Z we let Na = N/(N, a).

Proof. ForPa coset K âˆˆ Î“1 \Mn , let MK âˆˆ K âˆ© Mnâˆ be a fixed representative fixing âˆ, and
let Tnâˆ = KâˆˆÎ“1 \Mn MK . Taking the part of relation (2.5) supported on matrices in K we
(K)
have (1 âˆ’ S)Ten âˆ’ (MK âˆ’ MKS S) âˆˆ (1 âˆ’ T )Q[K]. Using Lemma 2.3 we obtain
(K )
P0 |Î˜ TeN (A) = 1|âˆ’w (1 âˆ’ S)TeN A = 1|âˆ’w (MKA âˆ’ MKA S S) = dw âˆ’ (dâ€² X)w ,

â€² â€² 
where we write MKA = a0 db , MKA S = a0 db â€² . One checks that dâ€² = N/(b, d), and since



KA = Î“1 a0 db = Î“1 Nzx Nty for A = Î“ ( xz yt ), we obtain a = (N, z), (b, d) = (N, t).

2.3. Primitive spaces. In this section we define subspaces Ww (N )new âŠ‚ Ww (N ) which
contain the period polynomials of newforms in Mw+2 (N ).
To fix definitions, we first review some newform theory from [1]. A modular form in
Mk (N ) is called a Hecke eigenform if it is an eigenform of all Hecke operators Tn (including
for primes p|N , which are called Up in [1]), normalized to have the coefficient of q equal to 1.
For a prime p|N , a cuspform f is called p-new if it is orthogonal with respect to the Petersson
inner product to the space spanned by the image of the two embeddings Sk (N/p) Ö’â†’ Sk (N )
given by the identity and f (z) 7â†’ f (pz). The Hecke eigenforms which are p-new for all p|N
are called newforms. If h is a newform of level M |N , M 6= N , the oldspace associated to h is
the span of h(dz) for d|(N/M ), and the oldspaces together with the one dimensional spaces

A GENERALIZATION OF RAMANUJANâ€™S CONGRUENCE

9

spanned by newforms give a decomposition of Sk (N ) into mutually orthogonal subspaces.
There is also a notion of newforms for Eisenstein series [35], but we only need here the
obvious fact that for k > 4 and square-free N > 1 all Eisenstein series in Mk (N ) are old.
In this paper we use an algebraic characterization of newspaces originally
due to Serre.
P
N
f
|
Ïƒ,
with
the sum
For M |N , let TrN
:
M
(N
)
â†’
M
(M
)
be
the
trace
map
Tr
(f
)
=
k
k
k
M
M
Ïƒ
over a system of representatives for the cosets Î“0 (N )\Î“0 (M ). For a prime p|N , the space
of forms which are new at p can be characterized as
N
Mk (N )pâˆ’new = {f âˆˆ Mk (N ) : TrN
N/p (f ) = TrN/p (f |WN ) = 0},

and we define the space of newforms Mk (N )new = âˆ©p|N Mk (N )pâˆ’new , where p runs through
the prime divisors of N . This agrees with the usual definition given above: see [22, Ch.
VIII, Thm. 2.2] for cusp forms and [35, Prop. 19] for Eisenstein series.
Similarly, for M |N we let TrN
M : Ww (N ) â†’ Ww (M ) be the trace map:
X
P (BC),
TrN
M (P )(C) =
BâˆˆÎ“0 (N )\Î“0 (M)

for all C âˆˆ Î“0 (M )\Î“1 . This is compatible with the trace defined on the cuspidal space:
N
for f âˆˆ Sw+2 (N ) we easily see that Ï(TrN
M f ) = TrM Ï(f ). We therefore define the new
subspace of Ww (N ) by Ww (N )new = âˆ©p|N Ww (N )pâˆ’new , where for prime p|N we define
N
e
Ww (N )pâˆ’new := {P âˆˆ Ww (N ) : TrN
N/p (P ) = TrN/p (P |Î˜ TN ) = 0}.

(2.9)

Since the action of Î´ commutes with the trace map, we may define subspaces WwÂ± (N )pâˆ’new
of WwÂ± (N ). All these spaces can be defined in the same way over an arbitrary ring R, and
we will need them in Section 4.2.
2.4. Extended period polynomials. We also need the space of extended period polynocw (N ), which contains the period polynomials Ïb(f ) = Ïbf of arbitrary modular forms
mials W
f âˆˆ Mk (N ) (we set k = w + 2 throughout). We refer to [27, Sec. 8] for the definition, and
we only recall that for f âˆˆ Mk (N ), its extended period polynomial Ïbf is given as in (2.2),
with the integral regularized by replacing f |A with f |A âˆ’ a0 (f |A), where a0 (f |A) is the
constant term in the Fourier expansion of f |A. By [27, eq. (8.2)] we have2
 
w
X
X kâˆ’1
X âˆ’1
k
wâˆ’n w
(2.10) Ïbf (A) = (âˆ’1) a0 (f |A)
rn (f |A)X wâˆ’n
+ a0 (f |AS)
+
(âˆ’1)
kâˆ’1
k âˆ’ 1 n=0
n

Î“(m)
for A âˆˆ Î“0 (N )\Î“1 , where rmâˆ’1 (g) = (âˆ’1)m (2Ï€i)
m L(g, m) is given in terms of the critical
values at 0 < m < k of the L-function L(g, s), extended by meromorphic continuation.

Example 2.6. Since L(Ek , s) = Î¶(s)Î¶(s âˆ’ k + 1), we obtain for k > 4 even:



Bk X kâˆ’1 + X âˆ’1 1 X
k âˆ’ 2 Bn Bkâˆ’n nâˆ’1 c âˆ’
Ïbâˆ’ Ek = âˆ’
Â·
âˆ’
X
âˆˆ Wkâˆ’2 (1) ,
2k
kâˆ’1
2
nâˆ’1 n kâˆ’n
0<n<kâˆ’2



+
(1), for Î±k =
and Ïb+ Ek = Î±k (1 âˆ’ X kâˆ’2 ) âˆˆ Wkâˆ’2

(kâˆ’2)!
Î¶(k
2(2Ï€i)kâˆ’1

âˆ’ 1) [20, p. 240].

cw (N ), acting as in Section 2.1, and we have
The Hecke operators Ten preserve W

(2.11)

Ïbf |[Î£] = Ïbf |Î£ Ten ,

2Here k is even, but the formula is valid for all finite index subgroups of SL (Z), when k may also be odd.
2

10

RADU GABA AND ALEXANDRU A. POPA

cw (N ) is preserved
where Î£ is a double coset contained in Mn satisfying (2.5). The space W

âˆ’1 0
cwÂ± (N ). We define
by the involution Î´ = 0 1 , and we denote its Â±1 eigenspaces by W
its new subspaces as in (2.9). The following proposition is a generalization of the EichlerShimura isomorphism to the space of extended period polynomials.
Proposition 2.7. Let w > 2 be even. The two maps
c Â± (N ),
ÏbÂ± : Mw+2 (N ) â†’ W
w

f 7â†’ ÏbÂ±
f

are Hecke equivariant isomorphisms, and they map Mw+2 (N )pâˆ’new isomorphically onto
c Â± (N )pâˆ’new , for primes p|N .
W
w

Proof. That the two maps are isomorphisms is proved in [27, Prop. 8.4]. The second
statement follows by using the characterisation of newforms above, together with the compatibility of the two isomorphisms with the trace map Tr = TrN
M and with the Atkin-Lehner
Â±
Â±
âˆ’w/2 Â±
e
T
.

involution: ÏbÂ±
=
Tr(b
Ï
),
Ï
b
=
N
Ï
b
|
f
f Î˜ N
Tr(f )
f |WN
Remark 2.8. For w = 0 and N square-free the map Ïbâˆ’ is still an isomorphism, but Ïb+ is
not unless N is prime [27, Prop. 8.4]. This is one of the reasons the weight 2 case is more
delicate, and we avoid it in this paper.

2.5. Period polynomials of Eisenstein series. We now specialize N to be square-free,
and apply the results of the previous sections to determine the period polynomials of a
basis of Eisenstein series in Mk (N ) for k > 4. Let D(N ) denote the divisors of N and
let Îµ : D(N ) â†’ {Â±1} be a system of Atkin-Lehner eigenvalues, namely Îµ(a)Îµ(b) = Îµ(ab) if
(a, b) = 1. Since Ek |Wd (z) = dk/2 Ek (dz), the linear combinations
X
(Îµ)
Îµ(d)dk/2 Ek (dz) âˆˆ Mk (N )
Ek,N (z) :=
d|N

are eigenforms of Wd with eigenvalue Îµ(d) for all d|N , and they provide a basis of the
Eisenstein subspace (of dimension 2Ï‰(N ) , with Ï‰(N ) the number of prime factors of N ).
When N = p is prime, we identify Îµ with its value Îµ(p) âˆˆ {Â±1}, and we recover the
(Îµ)
Eisenstein series Ek,p from the introduction.
When N is square-free, we show next that the extended polynomial Ïb+
f is actually a period
polynomial in Ww+ (N ) for all f âˆˆ Mw+2 (N ), just like in the case N = 1 of Example 2.6. We
also make more explicit the Eichler-Shimura isomorphism in Proposition 2.7, by determining
an explicit basis of the coboundary subspace of Ww (N ).
Proposition 2.9. Let N be square-free and let k = w + 2 > 4 be even.
(i) We have isomorphisms
âˆ¼

Ïâˆ’ : Sk (N ) âˆ’â†’ Wwâˆ’ (N ),
âˆ¼

âˆ¼

Ïb+ : Mk (N ) âˆ’â†’ Ww+ (N ),

and, if N > 1, Ï+ : Sk (N )new âˆ’â†’ Ww+ (N )new .
(ii) We have the following explicit version of the Eichler-Shimura isomorphism
(Îµ)

Ww (N ) = Ïâˆ’ (Sk (N )) âŠ• Ï+ (Sk (N )) âŠ•Îµ Cb
Ï+ (Ek,N ),
(Îµ)

where the period polynomials Ïb+ (Ek,N ) span the coboundary subspace Cw (N ).

Proof. (i) The set of N for which the map Ïâˆ’ is an isomorphism is characterized in [27,
Prop. 4.4], and it includes square-free N . From the Eichler-Shimura isomorphism (2.3),
cw+ (N ), so
we obtain that dim Ww+ (N ) = dim Mw+2 (N ). The latter is also equal to dim W

A GENERALIZATION OF RAMANUJANâ€™S CONGRUENCE

11

c + (N ) = W + (N ), and Proposition 2.7 implies that Ïb+ and Ï+ in (i) are isomorphisms as
W
w
w
well (the latter when N > 1 since Mw+2 (N )new = Sw+2 (N )new in this case).
(Îµ)
(ii) The period polynomials Ïb+ (Ek,N ) are Atkin-Lehner eigenforms with different eigenvalues, so they are linearly independent. They belong to Cw (N ) since they are in the span
of images of Ïb+ (Ek ) âˆˆ Cw (N ) under Atkin-Lehner involutions, which preserve Cw (N ). 
(Îµ) 
(Îµ) 
In the rest of this subsection we determine Ïb+ Ek,N and the principal part of Ïbâˆ’ Ek,N .
(Îµ) 
is an eigenvector for the Hecke operators Ten with
Note that (2.11) implies that ÏbÂ± E
k,N

eigenvalue Ïƒkâˆ’1 (n) for (n, N ) = 1, as well as an eigenvector for all Atkin-Lehner operators.
For d|N , the inclusion Mk (d) Ö’â†’ Mk (N ) corresponds to an inclusion
iN
d : Ww (d) Ö’â†’ Ww (N )
described as follows. For A âˆˆ Î“0 (N )\Î“1 , write A = BC with B âˆˆ Î“0 (N )\Î“0 (d), C âˆˆ
âˆ—
âˆ—
âˆ—âˆ—
Î“0 (d)\Î“1 . Then (iN
d P )(A) = P (C), and if A = Î“0 (N ) ( z t ) then C = Î“0 (d) (z,d) (t,d) .
+
+
kâˆ’2
For the Eisenstein series Ek we have Ïb (Ek ) = Î±(1 âˆ’ X
) âˆˆ Wkâˆ’2 (1), with Î± = Î±k
given explicitly in Example 2.6.

Proposition 2.10. Let N be square-free and let k = w + 2 > 4 be even. For Îµ : D(N ) â†’
{Â±1} a system of Atkin-Lehner eigenvalues, we have
Y
(Îµ) 
(Îµ) 
(1 + Îµ(p)pâˆ’w/2 ) Â· P + Ek,N
Ïb+ Ek,N = Î±
p|N

with

(Îµ) 
P + Ek,N

âˆˆ Ww+ (N ) given by
(Îµ) 
w/2
P + Ek,N (A) = Îµ(Nz )Nzw/2 âˆ’ Îµ(Nt )Nt X w âˆˆ Z[X]

for A = Î“0 (N ) ( âˆ—z âˆ—t ), where we recall that Na = N/(N, a).
(Îµ) 
(Îµ)
One can check directly that P + Ek,N âˆˆ Cw (N ), by writing it as Pw,N |1 âˆ’ S where
w/2

(Îµ)

Pw,N (A) = Îµ(Nz )Nz

(Îµ)

for a coset A as above. One easily checks Pw,N |1 âˆ’ T = 0.

Proof. By (2.11), for each divisor d|N we have
Ïb+ (Ek |Wd ) = dâˆ’w/2 Â· [id1 Ïb+ (Ek )]|Î˜ Ted âˆˆ Ww (d),

with the Atkin-Lehner involution Wd acting as in Section 2.2, yielding
X
(Îµ) 
d +
Îµ(d)dâˆ’w/2 Â· iN
b (Ek )|Î˜ Ted ].
(2.12)
Ïb+ Ek,N =
d [i1 Ï
d|N

id1 Ïb+ (Ek )

Note that
= Î±P0 âˆˆ Wkâˆ’2 (d), where P0 is defined in Proposition 2.5, and applying
that proposition we obtain:
w w
d +
for A = Î“0 (N ) ( âˆ—z âˆ—t ) .
iN
b (Ek )|Î˜ Ted ](A) = Î± Â· (dw
z âˆ’ dt X ),
d [i1 Ï
P
w/2 Q

Â· p|N (1 + Îµ(p)pâˆ’w/2 ).
We now use the identity d|N Îµ(d)dâˆ’w/2 dw
z = Îµ(Nz )Nz

(Îµ)
The computation of the principal part of Ïbâˆ’ Ek,N is similar, using the formula for
c âˆ’ (1) in Example 2.6.
Ïbâˆ’ (Ek ) âˆˆ W
kâˆ’2

Proposition 2.11. Let N be square-free, let k = w + 2 > 4 be even, and let Îµ : D(N ) â†’
{Â±1} be a system of Atkin-Lehner eigenvalues. For the identity coset I we have
X
(Îµ) 
Îµ(d)dâˆ’w/2 Â· Ïbâˆ’ (Ek )|âˆ’w ( d0 10 ) .
Ïbâˆ’ Ek,N (I) =
d|N

12

RADU GABA AND ALEXANDRU A. POPA

Proof. Apply (2.12) written for the odd part in terms of Ïbâˆ’ (Ek ), and use Lemma 2.3 (which
is easily seen to hold for extended polynomials) together with Example 2.4.

(Îµ)

2.6. Trace maps. We end this section by determining the behavior of Ek,N under trace
maps. Let N = M p be square-free with p prime. We can restrict a system of Atkin-Lehner
(Îµ)
(Îµ)
eigenvalues Îµ : D(N ) â†’ {Â±1} to D(M ), and apply (1.3) to Ek,N = Ek,M |(1 + Îµ(p)Wp ).
N Â±
Using ÏbÂ± (TrN
b (f ) for f âˆˆ Mk (N ), we obtain
M f ) = TrM Ï

(Îµ)
(Îµ)
+
k/2
Â· P + (Ek,M )
TrN
M P (Ek,N ) = 1 + Îµ(p)p
(2.13)


(Îµ)
(Îµ)
TrN
bâˆ’ (Ek,N ) = pk/2 + Îµ(p) p1âˆ’k/2 + Îµ(p) Â· Ïbâˆ’ (Ek,M )
M Ï
where in the first equation we used Proposition 2.10.

3. Proof of Theorems 1 and 2
Let N = M p with p âˆ¤ M as in the introduction, let g âˆˆ Mk (M ) be a newform of level
(Îµ)
M with Fourier coefficients Î»n (g) = Î»n , and let gp be defined as in (1.2) for Îµ âˆˆ {Â±1}.
This includes the case M = 1 and g = Ek in Theorem 1. Let â„“ be a prime satisfying
â„“|Î»p + Îµpk/2âˆ’1 (p + 1), which covers the â€œnew at pâ€ condition in both theorems (see (1.3)).
We first observe that if f âˆˆ Sk (N )pâˆ’new is a Hecke eigenform with eigenvalue Îµ under
the Atkin-Lehner involution Wp , then Î»p (f ) = âˆ’Îµpk/2âˆ’1 by [1, Thm. 3], so3
Î»p (f ) â‰¡ Î»p (gp(Îµ) ) = Î»p + Îµpk/2

(mod Î»p + Îµpk/2âˆ’1 (p + 1)).

That is, the congruences in both theorems hold at p because of the above assumption on â„“,
and therefore it is enough to check that there exists such an f with Hecke eigenvalues
Î»n (f ) â‰¡ Î»n (mod I) for (n, p) = 1.
Let R be a finite extension of Zâ„“ containing the coefficients of all Hecke eigenforms in
(Îµ)
Sk (N ). Let Ï€ be a uniformizer in R and F = R/Ï€R the residue field, and set w = k âˆ’ 2.
â†’ Ww (N )pâˆ’new
is
Since â„“ > k + 1, â„“ âˆ¤ N , by Theorem 3 the reduction map Ww (N )pâˆ’new
/R
/F
surjective, and both theorems follow from the Deligne-Serre lifting lemma, once we produce
an element in Ww (N )pâˆ’new
which is an eigenvector for the Hecke operators of index coprime
/F
(Îµ)

to p and for the Atkin-Lehner involution Wp , with eigenvalues congruent to those of gp . The
Deligne-Serre lemma would then provide a system of Hecke and Atkin-Lehner eigenvalues on
(Îµ)
Ww (N )pâˆ’new
congruent to those of gp . By Proposition 2.7 we then conclude the existence
/R
(Îµ)

of a Hecke eigenform f âˆˆ Mk (N ) which is p-new, satisfying the desired congruence. But
there are no p-new Eisenstein series in Mk (N ), as p âˆ¤ M , so the form f must be a cusp form.
Note that since f is p-new, it is automatically an eigenform of Tp , being in the oldspace of
a newform of level pM â€² with M â€² |M .
To construct the desired finite period polynomial in both theorems we proceed as follows.
â€¢ Theorem 1, â„“|pk/2 +Îµ. From (2.13) and the definition of the newspace in (2.9) we obtain
(Îµ)
that P + (Ek,p ) (mod â„“) belongs to Ww (p)new
/Fâ„“ (note that it is already an eigenform for the
e
Atkin-Lehner operator |Î˜ Tp acting on period polynomials). It is nonzero modulo â„“ since
(Îµ) 
P + Ek,p (I) = 1 âˆ’ Îµpw/2 X w , by Proposition 2.10.
3Both f and g (Îµ) have Euler products, so it is enough to check the congruence for Fourier coefficients of
p

prime index.

A GENERALIZATION OF RAMANUJANâ€™S CONGRUENCE

13

â€¢ Theorem 1, â„“ âˆ¤ pk/2 + Îµ. Since â„“ divides the numerator of Bk /k, formula (2.10) shows
(Îµ) 
that Ïbâˆ’ Ek,p (mod â„“) belongs to Wwâˆ’ (p)/Fâ„“ . Since â„“|pw/2 + Îµ, it follows from (2.13) that
(Îµ) 
Ïbâˆ’ Ek,p (mod â„“) actually belongs to Ww (p)new
/Fâ„“ . From Proposition 2.11 we have


k âˆ’ 2 Bn Bkâˆ’n
1 X
(Îµ) 
(1 âˆ’ pnâˆ’1 )X nâˆ’1 (mod â„“).
Ïbâˆ’ Ek,p (I) â‰¡
2 0<n<w n âˆ’ 1 n k âˆ’ n

The denominators in this formula have prime factors which are smaller than â„“, since â„“ > kâˆ’2,
and the extra assumption ensures that the previous element is nonzero.
â€¢ Theorem 2. Let P Â± (g) âˆˆ Ww (M ) be the multiples of ÏÂ± (g) which are normalized as
in the paragraph following Theorem 2, so their coefficients belong to Kg by a well-known
rationality result, e.g. [27, Prop. 5.11]. The condition k > 6 is required to guarantee that
the coefficient of X in P âˆ’ (g)(I) is nonzero, being proportional to the value at s = k âˆ’ 2 of
the L-function L(s, g). From (1.3) we obtain as before

Â± (Îµ)
âˆ’k/2+1
TrN
Î»p ) Â· P Â± (g),
M P (gp ) = (1 + p + Îµp
(Îµ) 
(Îµ) 
Â±
âˆ’w/2 N Â±
where P Â± gp := iN
iM P (g)|Î˜ Tep is a multiple of ÏÂ± gp . By assumpM P (g) + Îµp
tion, either P + (g) or P âˆ’ (g) has denominators coprime to I, so the same is true about at
(Îµ) 
(Îµ) 
least one of P Â± gp . It follows that one of P Â± gp
(mod I) belongs to WwÂ± (N )pâˆ’new
,
/F
and we fix this choice of sign.
To see that it is nonzero, we evaluate it on the identity coset I. Setting P = P Â± (g)(I)
for the choice of sign above, we obtain by the definition (2.2) and a change of variables:

P Â± gp(Îµ) (I)(X) = P (X) + Îµpâˆ’w/2 P (pX).
Due to the normalization of P , the constant term is 1 + Îµpâˆ’w/2 for P + and the coefficient
of X is 1 + Îµpâˆ’w/2+1 for P âˆ’ , which are nonzero mod â„“ in either case by assumption (1.6).

Remark 3.1. We found numerically that the extra assumption â„“ âˆ¤ Bn Bkâˆ’n (pnâˆ’1 âˆ’ 1) in
Theorem 1 is not needed for weights k 6 6 Â· 104 , by considering n = 2 and n = 4.
More precisely, assume â„“ âˆ¤ pk/2 + Îµ. It follows from (1.4) that â„“|pk/2âˆ’1 + Îµ, â„“|Bk , and
â„“ âˆ¤ p âˆ’ 1, so the assumption is satisfied for n = 2, unless â„“|Bkâˆ’2 . For k 6 6 Â· 104 there are
only two pairs (k, â„“) with k even and â„“ > k âˆ’ 2 prime, such that â„“ divides the numerator of
both Bk and Bkâˆ’2 , namely (92, 587) and (338, 491).4 Note that in both cases 3 âˆ¤ â„“ âˆ’ 1, and
since â„“|pâ„“âˆ’1 âˆ’ 1 it follows that â„“ âˆ¤ p3 âˆ’ 1 (otherwise we would have â„“|p âˆ’ 1, contradicting the
assumption). It follows that â„“ âˆ¤ B4 Bkâˆ’4 (p3 âˆ’ 1) for those two values of k, so the assumption
is satisfied for n = 4.
Note that the same assumption, without the factor pnâˆ’1 âˆ’ 1, appears in Haberlandâ€™s
proof of the Ramanujan congruence (1.1) [15, Sec. 5.2]. There the assumption guarantees
the nonvanishing of the reduction mod â„“ of an Eisenstein cocycle in H 1 (Î“1 , Vw (R)) associated
to Ïbâˆ’ (Ek ).
4. Surjectivity of reduction maps on spaces of period polynomials

In this section we use the isomorphism Ww (N )/R â‰ƒ Hc1 (Î“0 (N ), Vw (R)) in Remark 2.1 to
prove Theorem 3.
4Using PARI [23], it took about 50 minutes on a laptop to check the range 5 Â· 104 6 k 6 6 Â· 104 .

14

RADU GABA AND ALEXANDRU A. POPA

4.1. Surjectivity of reduction on the whole space. We first need a lemma computing
the dimension of the cohomology of Î“1 = SL2 (Z), for which we start in greater generality.
Let V be a right Î“1 -module, and assume, as it will always be the case, that âˆ’1 âˆˆ Î“1 acts
trivially on V . Therefore the cohomology groups we consider are the same when replacing
Î“1 by Î“1 = PSL2 (Z).
Since Î“1 is a free product of its subgroups G2 and G3 generated by S and U , the MayerVietoris exact sequence in group cohomology [5, Sec. VII.9] gives
(4.1)

0 â†’ H 0 (Î“1 , V ) â†’ H 0 (G2 , V ) âŠ• H 0 (G3 , V ) â†’ H 0 (G2 âˆ© G3 , V ) â†’
â†’ H 1 (Î“1 , V ) â†’ H 1 (G2 , V ) âŠ• H 1 (G3 , V )

Lemma 4.1. Assume that the Î“1 -module V is defined over a field F of characteristic
char(F ) 6= 2, 3. We have
dim H 1 (Î“1 , V ) = dim V âˆ’ dim H 0 (G2 , V ) âˆ’ dim H 0 (G3 , V ) + dim H 0 (Î“1 , V ).
Proof. The assumption char(F ) 6= 2, 3 implies that H j (Gi , V ) = 0 for j > 1, i = 2, 3, so the
conclusion immediately follows from the Mayer-Vietoris sequence.

Let R be a discrete valuation ring with residue field F . The surjectivity of more general
reduction maps on compactly supported cohomology was proved by Hida [17, Eq. (1.16)] for
congruence groups with no elliptic elements, by a geometric argument. We give an algebraic
proof here, valid for groups with elliptic elements as well.
Proposition 4.2. Let w > 0 be even. If the residue field F has characteristic â„“ > w,
â„“ 6= 2, 3, then the reduction map Ww (N )/R â†’ Ww (N )/F is surjective.
Proof. The reduction map is a composition
Ww (N )/R Ö‰ Ww (N )/R âŠ— F Ö’â†’ Ww (N )/F ,
with the first map surjective and the second map injective. Therefore surjectivity reduces
to the equality of the dimensions of the last two spaces as vector spaces over F .
Since R is a DVR, Ww (N )/R is a free R-module so
dim Ww (N )/R âŠ— F = rank Ww (N )/R = dim Ww (N )/C = dim H 1 (Î“0 (N ), Vw (C)),
where the second equality follows from the fact that Ww (N )/Z is a sublattice of Ww (N )/C ,
and the third follows from Ww (N )/C â‰ƒ Hc1 (Î“0 (N ), Vw (C)) and PoincareÌ duality over C.
The hypothesis â„“ > w implies that the Î“1 -invariant pairing on V (F ) induced by the
natural Î“1 -invariant pairing on Vw is nondegenerate, so V âˆ— (F ) â‰ƒ V (F ). By PoincareÌ
duality [2, Lemma 1.4.3], it follows that
dim Ww (N )/F = dimF Hc1 (Î“0 (N ), Vw (F )) = dimF H 1 (Î“0 (N ), Vw (F )).
Lemma 4.1 shows that dimF H 1 (Î“1 , Vw (N )/F ) is the same for all fields F with char(F ) 6=
2, 3, where Vw (N )/F is the induced module IndÎ“Î“10 (N ) Vw (F ). Applying this to the residue
field F and to C, and using the Shapiro lemma, we conclude from the last two displayed
equations that Ww (N )/R âŠ— F = Ww (N )/F , as they have the same dimension.

4.2. Surjectivity of reduction on the p-new subspace. For N = M p with p prime,
in (2.9) we have defined

Ww (N )pâˆ’new
= Ker Î² : Ww (N )/R â†’ Ww (M )2/R
/R

N
e
e
where Î²(P ) = (TrN
M P, TrM P |Î˜ TN ). We recall that the operator |Î˜ TN on Ww (N ) corresponds to the Atkin-Lehner involution WN on Mw+2 (N ) as in Section 2.2.

A GENERALIZATION OF RAMANUJANâ€™S CONGRUENCE

15

âˆ’1

Let Î“0 (M )â€² := p0 10
Î“0 (M ) p0 01 for p âˆ¤ M . We have Î“0 (M ) âˆ© Î“0 (M )â€² = Î“0 (M p), and
we consider the sum of restriction maps:
(4.2)

Î± : H 1 (Î“0 (M ), Vw (F )) âŠ• H 1 (Î“0 (M )â€² , Vw (F )) â†’ H 1 (Î“0 (M p), Vw (F )).

We prove below that the maps Î± and Î² are essentially PoincareÌ dual to each other.
Proposition 4.3. Let R be a discrete valuation ring with residue field F of characteristic â„“.
Let w > 0 be even, let N = M p with p prime, p âˆ¤ M , and assume that â„“ > w, â„“ âˆ¤ 6. The
following are equivalent:
(i) The reduction map Ww (N )pâˆ’new
â†’ Ww (N )pâˆ’new
is surjective.
/R
/F
2
(ii) The map Î² : Ww (N )/F â†’ Ww (M )/F is surjective.
(iii) The map Î± given by (4.2) is injective.
Proof. (i) â‡” (ii): The space Ww (N )pâˆ’new
is free over R, of rank equal to the dimension
/R
of Ww (N )pâˆ’new
. Since R is a DVR, this rank also equals the dimension of the reduction
/C
Ww (N )pâˆ’new
âŠ— F , so (i) is equivalent to dim Ww (N )pâˆ’new
= dim Ww (N )pâˆ’new
. On the
/R
/F
/C
other hand (ii) is equivalent to
dim Ww (N )pâˆ’new
= dim Ww (N )/F âˆ’ 2 dim Ww (M )/F
/F
= dim Ww (N )/C âˆ’ 2 dim Ww (M )/C
where the second equality follows from Proposition 4.2. It remains to show that the latter
difference equals dim Ww (N )pâˆ’new
, that is that the map Î² is surjective over C. For this we
/C
follow the proof of surjectivity given below, which works over C with little change. Indeed
the same proof shows that (ii) and (iii) are equivalent over C as well, and the proof of (iii)
over C is the same as that of Proposition 4.6 below, but without needing Lemma 4.4 and
Proposition 4.7. Instead, the fact that H 1 (âˆ†M , Vw (C)) vanishes, where âˆ†M is the principal
congruence subgroup of level M of PSL2 (Z[1/p]), is a consequence of Cor. 2 to Thm. 5
in [30].
(ii) â‡” (iii): Since the residue field F and w are fixed, we write V = Vw (F ). We have
Ww (N )/F â‰ƒ Hc1 (Î“0 (N ), V ), and TrN
M : Ww (N )/F â†’ Ww (M )/F corresponds to the corestriction map on the compactly supported cohomology groups, while the map P 7â†’ P |Î˜ TeN
on Ww (N )/F corresponds to the Atkin-Lehner operator [Î˜N ] on Hc1 (Î“0 (N ), V ). Therefore
the first part in the diagram below is commutative.
Ww (N )/F
Î²

â‰ƒ

/ Hc1 (Î“0 (N ), V )

Ã—

(cor,cor â—¦ [Î˜N ])


Ww (M )2/F

â‰ƒ

H 1 (Î“0 (N ), V )
O

/F

res +[Î˜N ] â—¦ res


/ Hc1 (Î“0 (M ), V )2

Ã—

H 1 (Î“0 (M ), V )2

/F

The second part is given by PoincareÌ duality, taking into account that V â‰ƒ V âˆ— since â„“ > w.
For Ï• âˆˆ Hc1 (Î“0 (N ), V ), Ïˆ âˆˆ H 1 (Î“0 (M ), V ) and Ï•â€² âˆˆ H 1 (Î“0 (N ), V ) we have [18, Sec. 6.3]
hcor Ï•, ÏˆiM = hÏ•, res ÏˆiN ,

hÏ•|[Î˜N ], Ï•â€² i = hÏ•, Ï•â€² |[Î˜N ]i.

Since PoincareÌ duality is a perfect pairing, it follows that Î² is surjective if and only if the
rightmost map is injective.

16

RADU GABA AND ALEXANDRU A. POPA

Let cp : H 1 (Î“0 (M ), V ) â†’ H 1 (Î“0 (M )â€² , V ) be conjugation by
the following diagram commutes
[Î˜N ]

H 1 (Î“0 (N ), V )
O


. We easily check that

/ H 1 (Î“0 (N ), V )
O

â‰ƒ

res

H 1 (Î“0 (M ), V )

p0
01

res
[Î˜M ]
â‰ƒ

/ H 1 (Î“0 (M ), V )

cp
â‰ƒ

/ H 1 (Î“0 (M )â€² , V )

which shows that the rightmost map in the diagram differs from Î± only by the isomorphism
cp â—¦ [Î˜M ] in the second factor, so rightmost map is injective if and only if Î± is injective. 
We are reduced to proving the injectivity of Î±, for which we use the ingredients of Iharaâ€™s
lemma [19, Lemma 3.2]. Our proof is inspired by the proof of similar statements for parabolic
cohomology given in [29, 10]. First we need an easy lemma.
Lemma 4.4. Let w > 0, and consider the SL2 (Z)-module Vw (F ), with F a field of characteristic â„“ > w + 1. Let u = ( 10 a1 ) âˆˆ SL2 (Z) with â„“ âˆ¤ a. We have:
(i) Im(1 âˆ’ u) = Vwâˆ’1 (F ) (setting Vâˆ’1 (F ) = {0}), and Ker(1 âˆ’ u) = V0 (F );
(ii) Ker(N ) = Vw (F ), where N := 1 + u + . . . + uâ„“âˆ’1 âˆˆ Z[SL2 (Z)] acts by linearity on
Vw (F ).
Proof. (i) The matrix of 1 âˆ’ u in the basis 1, X, . . . , X w is upper triangular, with 0â€™s on the
diagonal and elements ni ai with w > n > i above the diagonal, which are invertible in F
since â„“ > w. It follows that Ker(1 âˆ’ u) = F , and since Im(1 âˆ’ u) is contained in Vwâˆ’1 (F ) it
must be the entire subspace.
(ii) Since uâ„“ acts as identity on Vw (F ), we have Im(1 âˆ’ u) âŠ‚ Ker(N ). By (i) we only have
to check that X w âˆˆ Ker(N ), namely that the polynomial
Qw (X) = X w + (X + 1)w + . . . + (X + â„“ âˆ’ 1)w
is identically 0 in Fâ„“ [X]. We prove this by induction on w. For w = 0 the statement is
clear, and assuming it true for w âˆ’ 1 > 0 and taking derivatives we have Qâ€²w = wQwâˆ’1 = 0.
Therefore Qw is constant and we only have to prove that its constant term vanishes, which
we leave as an exercise. Note that if â„“ = w + 1 we have Qw (0) = âˆ’1.

Remark 4.5. For â„“ = w + 1, part (ii) in the lemma is no longer true (from the proof we see
that Ker(N ) = Vwâˆ’1 (F ), Im(N ) = V0 (F ) in this case). For this reason, the case â„“ = w + 1
is not included in the next proposition and in Theorem 3.
Proposition 4.6. Let w > 0 be even, let p âˆ¤ M be prime and let V = Vw (F ) with F a field
of characteristic â„“ > w + 3. Assume â„“ âˆ¤ pM , and if w = 0 assume also that â„“ âˆ¤ Ï•(M ). Then
the restriction map
Î± : H 1 (Î“0 (M ), V ) âŠ• H 1 (Î“0 (M )â€² , V ) â†’ H 1 (Î“0 (M p), V )
is injective (if â„“ = w + 3 > 3, its kernel is one-dimensional).

A GENERALIZATION OF RAMANUJANâ€™S CONGRUENCE

17

Proof. Let Î“(M ) be the principal congruence subgroup of level M of PSL2 (Z), and Î“(M )â€² :=


p 0 âˆ’1
Î“(M ) p0 01 . Their intersection is Î“(M ) âˆ© Î“0 (p) âŠ‚ Î“0 (M p), and we have a commu0 1
tative diagram of restriction maps5
Î±

H 1 (Î“0 (M ), V ) âŠ• H 1 (Î“0 (M )â€² , V )

/ H 1 (Î“0 (M p), V )

res

res


H 1 (Î“(M ), V ) âŠ• H 1 (Î“(M )â€² , V )

Î³


/ H 1 (Î“(M ) âˆ© Î“(M )â€² , V )

The first vertical restriction is injective: using the
 inflation-restriction exact sequence it is
enough to show that H 1 Î“0 (M )/Î“(M ), V Î“(M) = 0. When w > 0, the space of invariants V Î“(M) is trivial, since the invariants under ( 10 M
1 ) are the constant polynomials, by
1 0 ) is 0. If w = 0, we use that the
Lemma 4.4, while the only constant invariant under ( M
1
âˆ—
quotient Î“0 (M )/Î“(M ) â‰ƒ (Z/M Z) â‹‰ (Z/M Z) has order M Ï•(M ), which is coprime to â„“ by
assumption, so the cohomology group vanishes (it is here that we use the extra assumption
â„“ âˆ¤ Ï•(M ) when w = 0).
Therefore to show that Î± is injective it is enough to show that Î³ is injective. For that
we use the following two ingredients of Iharaâ€™s lemma [19, Lemma 3.2]. Let âˆ†M be the
principal congruence subgroup of level M of PSL2 (Z[1/p]).
(I1) The group âˆ†M is the free product of Î“(M ) and Î“(M )â€² with amalgamated subgroup
Î“(M ) âˆ© Î“(M )â€² ;
(I2) The group âˆ†M is the normal closure of ( 10 M
1 ) in âˆ†1 .
By (I1), the Mayer-Vietoris exact sequence gives:
Î³

Â· Â· Â· â†’ H 1 (âˆ†M , V ) â†’ H 1 (Î“(M ), V ) âŠ• H 1 (Î“(M )â€² , V ) âˆ’â†’ H 1 (Î“(M ) âˆ© Î“(M )â€² , V ) â†’ Â· Â· Â· ,
so Ker Î³ = H 1 (âˆ†M , V ). The inflation-restriction exact sequence for the normal subgroup
âˆ†â„“M âŠ‚ âˆ†M gives:
inf

res

0 â†’ H 1 (PSL2 (Fâ„“ ), V âˆ†â„“M ) âˆ’â†’ H 1 (âˆ†M , V ) âˆ’â†’ H 1 (âˆ†â„“M , V )âˆ†M /âˆ†â„“M .
We have V âˆ†â„“M = V , and we will see in Proposition 4.7 below that H 1 (PSL2 (Fâ„“ ), V ) vanishes
under the assumption â„“ 6= w + 3. Therefore to show H 1 (âˆ†M , V ) = 0 it suffices to prove that
the restriction map is identically 0.
For this, we use (I2), that is the fact that âˆ†â„“M is generated by elements of the form
âˆ’1
âˆ’1
g ( 10 â„“M
, g âˆˆ âˆ†1 . Let g ( 10 â„“M
= v â„“ , with v = gug âˆ’1 âˆˆ âˆ†M for u = ( 10 M
1 )g
1 )g
1 ). For any
cocycle Ï• âˆˆ Z 1 (âˆ†M , V ), we have
Ï•(v â„“ ) = Ï•(v)|(1 + v + . . . + v â„“âˆ’1 ) = (Ï•(v)|g)|(1 + u + . . . + uâ„“âˆ’1 )|g âˆ’1 = 0
by Lemma 4.4 (ii) (here we use â„“ 6= w + 1). We conclude res Ï• = 0.



It remains to prove the vanishing of a finite cohomology group, which was essentially
proved in [21, Theorem 1.5.3]. Since the proof there was only sketched, and since we need
a slightly more general ground field, we fill in the details below. The entire structure of the
cohomology ring is also determined in [32].
Proposition 4.7. Let w > 0 be even, and let F be a field of characteristic â„“ > w, â„“ > 3.
Then the cohomology group H 1 (SL2 (Fâ„“ ), Vw (F )) vanishes, unless â„“ = w + 3 when it is onedimensional.
5The cohomology groups do not change upon replacing Î“ (M ) by its projectivization Î“ (M )/{Â±1}, as âˆ’1
0
0
acts trivially on V.

18

RADU GABA AND ALEXANDRU A. POPA

Proof. We set Î“ = SL2 (Fâ„“ ), V = Vw (F ), and consider more generally H n (Î“, V ) for n > 0.
Let B âŠ‚ Î“ be the Borel subgroup of upper triangular matrices, so that |B| = â„“(â„“ âˆ’ 1). The
composition cor â—¦ res : H n (Î“, V ) â†’ H n (B, V ) â†’ H n (Î“, V ) of the restriction and transfer
maps equals multiplication by the index [Î“ : B] = â„“ + 1 [5, Ch. III, Prop. 9.5], which
is an isomorphism of vector spaces over F as the index is coprime to â„“. The composition
res â—¦ cor also equals multiplication by [Î“ : B], by the Cartan-Eilenberg stability criterion [6,
Ch. XII Prop. 9.4]. To apply the criterion, we have to check that H n (B, V ) consists of
stable cohomology classes, namely for all x âˆˆ Î“ we have a commutative diagram
â‰ƒ
/ H n (xBxâˆ’1 , V )
H n (B, V )
â—†â—†â—†
â™¥â™¥
â—†â—†â—†
â™¥â™¥â™¥
â™¥
â™¥
â—†
â™¥
â™¥ res
res â—†â—†â—†
&
wâ™¥â™¥â™¥
n
âˆ’1
H (B âˆ© xBx , V )

with the horizontal isomorphism being conjugation by x. To prove the commutativity, note
that B âˆ© xBxâˆ’1 is either B (when x âˆˆ B), or the diagonal subgroup T (when x âˆˆ
/ B).
In the first case the statement is trivial, while in the second it follows from the fact that
H n (T, V ) = 0, as T is cyclic of order â„“ âˆ’ 1 coprime to â„“. We conclude that H n (Î“, V ) â‰ƒ
H n (B, V ).
Let U = {( 10 âˆ—1 ) âˆˆ Î“}, which is normal in B with B/U â‰ƒ T , the diagonal subgroup. The
inflation-restriction exact sequence together with H n (T, V ) = 0 for n > 0 implies that
H n (B, V ) â‰ƒ H n (U, V )B/U .
Since U is cyclic generated by u = ( 10 11 ), its cohomology H n (U, V ) equals Ker N/ Im(1âˆ’u)
if n is odd and Ker(1 âˆ’ u)/ Im N if n > 0 is even [5, p. 58], where N = 1 + u + . . . + uâ„“âˆ’1 :
V â†’ V is the norm map. By Lemma 4.4 we obtain H n (U, V ) â‰ƒ F for all n > 0 if â„“ 6= w + 1,
and H n (U, V ) = 0 if â„“ = w + 1 (see Remark 4.5).
To compute the invariants under B/U assume n = 1, and let Ï• : U â†’ V be the generator
of H 1 (U, V ) with Ï•(u) = X w âˆˆ
/ Im(1 âˆ’ u). The group B/U â‰ƒ T acts on cocycles by
Ï•|g(n) = Ï•(gng âˆ’1 )|âˆ’w g for g âˆˆ B, n âˆˆ U , so the class of Ï• is invariant
under T if and

a 0
âˆ’1
only if Ï•(u) âˆ’ Ï•(tut )|âˆ’w t âˆˆ Im(1 âˆ’ u) = Vwâˆ’1 for t = 0 aâˆ’1 âˆˆ T (i.e. Ï• âˆ’ Ï•|t is a
coboundary). Since Ï•(u) = X w , this happens if and only if aw+2 = 1 for all a âˆˆ Fâˆ—â„“ , i.e.,
if and only if â„“ âˆ’ 1|w + 2. Since â„“ > w, â„“ > 5, we conclude that H 1 (U, V )B/U = 0 unless
â„“ = w + 3, when it is one dimensional.

5. Numerical examples
For the examples in this section, we computed spaces of period polynomials and individual
eigenforms using the software MAGMA [4]. More details are given in [27, Sec. 5.5].
Example 5.1. We expect Theorem 1 to hold for â„“ = k + 1 as well, and we verified the
congruence in many such cases. For example, let p = 19, k = 6, â„“ = k + 1 = 7. Although
â„“ = k + 1 divides once the denominator of Bk (which always holds when k + 1 is prime
by the von Staudt-Clausen Theorem), we have â„“3 |pk/2 + 1, so â„“ divides the numerator of
(+1)
(+1)
Bk
k/2
+ 1). We find a congruence modulo â„“ between Ek,p and the newform f âˆˆ Sk (p)
2k (p
with q-expansion:
f = q âˆ’ 2q 2 âˆ’ q 3 âˆ’ 28q 4 âˆ’ 24q 5 + 2q 6 âˆ’ 167q 7 + . . . âˆ’ 361q 19 + . . . .
Note that in order to prove this congruence, and the ones below, it is enough to check that
it holds for coefficients of prime index up to the Sturm bound k(p + 1)/12.

A GENERALIZATION OF RAMANUJANâ€™S CONGRUENCE

19

Example 5.2. One may ask whether the congruence in Theorem 1 comes from a congruence
(Îµ)
between the period polynomials P + (f ) and P + (Ek,p ) of the forms in the theorem (both
normalized to have constant term 1 at the identity coset). Such a congruence would imply
the congruence of Hecke eigenvalues, and for level 1 it was shown to hold by Manin [24] in
the cases when Sk (1) is one dimensional. In higher level, this congruence often holds (see
the next example), but the following example shows that it can also fail. For p = 5, k = 40,
(Îµ)
â„“ = 71, Îµ = âˆ’1, we have â„“|pk/2 + Îµ and the congruence (1.5) holds for some f âˆˆ Sk (p), but

(Îµ)
P + (f )(I) 6â‰¡ P + Ek,p (I) (mod I). This illustrates the fact that the Deligne-Serre lifting
lemma guarantees the lift of systems of eigenvalues, but not of eigenvectors.
Example 5.3. Let M = 7, k = 6, and let g âˆˆ Sk (M ) be the newform
g = q âˆ’ 10q 2 âˆ’ 14q 3 + 68q 4 âˆ’ 56q 5 + 140q 6 âˆ’ 49q 7 + . . . + 1824q 23 + . . . .
The cosets A = Î“0 (M ) ( xâˆ— yâˆ— ) can be identified with points (x : y) âˆˆ P1 (Z/M Z), and setting
P = P + (g), we can use the relations P |Î´ = P , P |S = âˆ’P to express all 8 components of P
in terms of
43
129 2
P ((0 : 1)) = âˆ’49X 4 + 1, P ((1 : 2)) = 80X 4 âˆ’ X 3 âˆ’
X âˆ’ 86X + 6,
2
2
129 2 43
P ((1 : 1)) = âˆ’49X 4 + 49, P ((1 : 3)) = âˆ’6X 4 âˆ’ 86X 3 +
X âˆ’ X âˆ’ 80.
2
2
Since 43 divides all the coefficients except for those of X 0 and X 4 , this illustrates the
(+1) 
previous comment, namely we have P + (g) â‰¡ P + Ek,M (mod 43). This implies directly
(+1)

that g â‰¡ Ek,M (mod 43), and indeed we have 43|73 + 1, so the congruence follows from
Theorem 1.
To apply Theorem 2, we note that Den P + (g) = 2 in (1.6), so this condition poses no
restriction. Taking p = 2, we find 11|Î»p âˆ’ pk/2âˆ’1 (p + 1), and since 11 âˆ¤ pk/2âˆ’1 âˆ’ 1 = 3 we
(âˆ’1)
deduce from Theorem 2 that there exists a congruence between gp
and a Hecke eigenform
f âˆˆ S6 (14) which is 2-new and has eigenvalue âˆ’1 for W2 . In fact, we find a newform f of
level 14 (as predicted by the conjecture in the introduction) with q-expansion
f = q + 4q 2 + 8q 3 + 16q 4 + 10q 5 + 32q 6 âˆ’ 49q 7 + . . . + 2000q 23 + . . . .
References
[1] A.O.L Atkin, J. Lehner, Hecke Operators on Î“0 (m). Math. Ann. 185 (1970), 134â€“160.
[2] A. Ash, G. Stevens, Cohomology arithmetic groups and congruences between systems of Hecke eigenvalues. Journal fuÌˆr reine und angew. Math. (1985), 192â€“220.
[3] N. Billerey, R. Menares, On the modularity of reducible mod l Galois representations. Math. Res. Lett.
23 (2016), 15â€“41.
[4] W. Bosma, J. Cannon, C. Playoust, The Magma algebra system. I. The user language. J. Symbolic
Comput. 24 (1997), 235â€“265.
[5] K.S. Brown, Cohomology of groups. GTM 87, Springer-Verlag, 1982.
[6] H. Cartan, S. Eilenberg, Homological algebra. Princeton University Press, 1956.
[7] Y.J. Choie, D. Zagier, Rational period functions for PSL2 (Z). Contemporary Math. 143 (1993), 89-108.
[8] B. Datskovsky, P. Guerzhoy, On Ramanujan Congruences for Modular Forms of Integral and HalfIntegral Weights. Proc. of the AMS 124/8 (1996), 2283-2291.
[9] P. Deligne, J.-P. Serre, Formes modulaires de poids 1. Ann. Sci. Ec. Norm. Sup. 7 (1974), 507â€“530.
[10] F. Diamond, Congruence primes for cusp forms of weight k > 2. AsteÌrisque 196-197 (1991), 205â€“213.
[11] F. Diamond, R. Taylor, Non-optimal levels of mod l modular representations. Invent. Math. 115 (1994),
435â€“462.
[12] N. Dummigan, Period ratios of modular forms. Math. Ann. 318 (2000), 621â€“636.

20

RADU GABA AND ALEXANDRU A. POPA

[13] N. Dummigan, D. Fretwell, Ramanujan-style congruences of local origin. J. Number Theory 143 (2014),
248â€“261.
[14] B. Edixhoven, Serreâ€™s Conjecture. In Modular Forms and Fermatâ€™s Last Theorem (G. Cornell, J. H.
Silverman, G. Stevens, eds.), 209-242, Springer, New York, 1997.
[15] K. Haberland, Perioden von Modulformen einer Variablen und Gruppenkohomologie, I. Math. Nachr.
112 (1983), 245â€“282.
[16] G. Harder, Cohomology of arithmetic groups. File â€œChaptersix 1.pdfâ€ recovered from
http://www.math.uni-bonn.de/people/harder/
[17] H. Hida, Congruences of Cusp Forms and Special Values of Their Zeta Functions. Invent. Math. 63
(1981), 225â€“261.
[18] H. Hida, Elementary Theory of L-functions and Eisenstein series. Cambridge University Press, 1993.
[19] Y. Ihara, On Modular Curves Over Finite Fields. Proceedings of the International Colloquium on
Discrete Subgroups of Lie Groups and Applications to Moduli, Bombay (1973), 161â€“202.
[20] W. Kohnen, D. Zagier, Modular forms with rational periods. In Modular forms, R.A. Rankin editor,
Ellis Horwood series in math. and its applications, 1984.
[21] M. Kuga, W. Parry, C.-H. Shah, Group cohomology and Hecke operators. In Manifolds and Lie groups,
Progress in Math. 14 (1980), 223â€“266, Birkhauser, Boston.
[22] S. Lang, Introduction to modular forms. Grunlehren der math. Wissenschaften 222, Springer-Verlag
(1976).
[23] The
PARI
Group,
PARI/GP
version
2.9.3.
Univ.
Bordeaux
(2016),
http://pari.math.u-bordeaux.fr/ .
[24] Yu.I. Manin, Periods of parabolic forms and p-adic Hecke series. Mat. Sb. 21 (1973), 371â€“393.
[25] K. Martin, The Jacquet-Langlands correspondence, Eisenstein congruences, and integral L-values in
weight 2. Math. Res. Lett. 24, No. 6 (2017), 1775â€“1795.
[26] B. Mazur, Modular curves and the Eisenstein ideal. Publ. Math. IHES 47 (1977), 33â€“186.
[27] V. PasÌ§ol, A.A. Popa, Modular forms and period polynomials. Proc. Lond. Math. Soc. 107/4 (2013),
713-743.
[28] A.A. Popa, On the trace formula for Hecke operators on congruence subgroups. Proc. Amer. Math Soc.
146/7 (2018), p. 2749â€“2764.
[29] K. Ribet, Congruence relations between modular forms. Proc. of ICM Warsaw (1983), 503-514.
[30] J.-P. Serre, Le probleÌ€me des groupes de congruence pour SL2 . Ann. of Math. 92 (1970), 489â€“527.
[31] G. Shimura, Introduction to the arithmetic theory of automorphic functions. Princeton U. Press (1971).
[32] M. Tazuka, The cohomology of SL2 (Fp ) and the Hecke algebra actions. Kodai Math. J. 9 (1986), 440â€“
455.
[33] P. Tsaknias, A Possible Generalization of Maedaâ€™s Conjecture. In Computations with Modular Forms,
Contributions in Mathematical and Computational Sciences vol. 6 (2014), 317â€“329.
[34] H. Yoo, Non-optimal levels of a reducible mod l modular representation. Transactions of the AMS,
Early view, doi:10.1090/tran/7314.
[35] J. Weisinger, Some results on classical Eisenstein series and modular forms over function fields. Harvard thesis (1977).
Institute of Mathematics â€œSimion Stoilowâ€ of the Romanian Academy, P.O. Box 1-764, RO014700 Bucharest, Romania
E-mail: radu.gaba@imar.ro, alexandru.popa@imar.ro

