UNIVERSALLY AND EXISTENTIALLY DEFINABLE SUBSETS OF
GLOBAL FIELDS

arXiv:1609.09787v3 [math.NT] 17 Apr 2018

KIRSTEN EISENTRAÌˆGER AND TRAVIS MORRISON
Abstract. We show that rings of S-integers of a global function field K of odd characteristic are first-order universally definable in K. This extends work of Koenigsmann and Park
who showed the same for Z in Q and the ring of integers in a number field, respectively.
We also give another proof of a theorem of Poonen and show that the set of non-squares
in a global field of characteristic 6= 2 is diophantine. Finally, we show that the set of pairs
âˆš
(x, y) âˆˆ K Ã— Ã— K Ã— such that x is not a norm in K( y) is diophantine over K for any global
field K of characteristic 6= 2.

1. Introduction
Hilbertâ€™s Tenth Problem asks whether there exists an algorithm that decides, given an
arbitrary polynomial equation with integer coefficients, whether it has a solution in the integers. Matiyasevich answered this in the negative in [Mat70] using work by Davis, Putnam,
and J. Robinson [DPR61]. We say that Hilbertâ€™s Tenth Problem is undecidable. The same
question can be asked for polynomial equations with coefficients and solutions in other commutative rings R. We refer to this as Hilbertâ€™s Tenth Problem over R. Hilbertâ€™s Tenth
Problem over Q, and over number fields in general, is still open. The function field analogue
is much better understood, and Hilbertâ€™s Tenth Problem is known to be undecidable for
global function fields ([Phe91], [Vid94], [Shl96], [Eis03]).
One approach to proving that Hilbertâ€™s Tenth Problem for Q is undecidable is to show
that Z is diophantine over Q:
Definition 1.1. Let R be a ring. We say that A âŠ† Rm is diophantine over R if there exists
a polynomial g(x1 , . . . , xm , y1 , . . . , yn ) âˆˆ R[x1 , . . . , xm , y1 , . . . , yn ] such that
(a1 , . . . , am ) âˆˆ A â‡â‡’ âˆƒr1 , . . . , rn âˆˆ R s.t. g(a1 , . . . , am , r1 , . . . , rn ) = 0.
If one had a diophantine, i.e. a positive existential definition of Z in Q, then a reduction
argument, together with Matiyasevichâ€™s theorem for Hilbertâ€™s Tenth Problem over Z, would
imply that Hilbertâ€™s Tenth Problem for Q is undecidable. But it is still open whether Z
is positive existentially definable in Q. In fact, if Mazurâ€™s conjecture holds, then Z is not
existentially definable in Q [Maz92].
It is, however, possible to define the integers inside the rationals with a first-order formula.
This is due to J. Robinson [Rob49] who gave a âˆ€âˆƒâˆ€ definition of Z in Q. Her result was
improved by Poonen [Poo09a] who gave a âˆ€âˆƒ definition of Z in Q. Koenigsmann [Koe16]
further improved on Poonenâ€™s result and gave a definition of the integers inside Q that uses
only universal quantifiers.
Park generalized this and showed that for any number field K, the ring of integers OK is
universally definable in K [Par13].
1

Similar definability questions can be asked for subrings of global function fields. Let q be
a power of a prime. While Hilbertâ€™s Tenth Problem for both Fq [t] and Fq (t) is undecidable
([Den79], [Phe91], [Vid94]), it is not known whether Fq [t] is diophantine over Fq (t). Showing
this still seems out of reach, but it is possible to give a universal definition of Fq [t] in Fq (t)
which we do in this paper for odd q. More generally, we prove the natural generalization of
Parkâ€™s result for defining rings of integers to global function fields K.
This is the first of three main theorems in this paper, and we prove it in Section 3:
Theorem 1.2. Let K be a global function field of odd characteristic and let S be a finite,
nonempty set of primes of K. Then OS is first-order universally definable in K. Equivalently, K \ OS is diophantine over K.
Here, for a finite set S of primes of K we denote by OS the ring
OS := {x âˆˆ K : vp (x) â‰¥ 0 âˆ€ primes p 6âˆˆ S}.
Our theorem generalizes a result by Rumely [Rum80] who gave a first-order definition of
a polynomial ring inside a global function field K. It also improves one of the results in
[Shl15], where it was shown how to define the S-integers in a global function field using a
first-order formula that involves one change in quantifiers.
One of the main ideas in proving Theorem 1.2 is to use certain diophantine rings, parametrized by K Ã— , to encode integrality at finite sets of primes; this is based on ideas of Poonen in
[Poo09a] and Koenigsmann in [Koe16]. Park replaces the congruence classes that Koenigsmann used for Z in Q with ray classes of a fixed modulus of K for a fixed biquadratic
extension of K.
Some parts of Parkâ€™s arguments do not extend to the function field setting and require a
different approach; in [Par13], a biquadratic extension of K is chosen so that it is linearly
disjoint from the Hilbert class field of K. Since the Hilbert class field of a global function field
is an infinite extension, we cannot use it in our arguments, but there is another natural finite
extension of the global function field K that we can use instead. We use a finite extension
of K whose Galois group is the ideal class group of the Dedekind domain OS â€² for some
carefully chosen set of primes S â€² . Another crucial ingredient in the proof of Theorem 1.2
is showing that any class in the ray class group of a Dedekind domain A contained in K
contains infinitely many primes of A.
We also show that other arithmetic subsets of a global field K are diophantine over K,
extending the results in [Koe16]. Given y âˆˆ K Ã— \ K Ã—2 , consider the norm map
âˆš
Ny : K( y) â†’ K
âˆš
a + b y 7â†’ a2 âˆ’ yb2 .
In Section 4.2 we show the following new result:
Theorem 1.3. Let K be a global field with char(K) 6= 2. Then
âˆš
{(x, y) âˆˆ K Ã— Ã— K Ã— |x 6âˆˆ Ny (K( y))}
is diophantine over K.
This generalizes a result of [Koe16] from K = Q to global fields.
We also give a new proof of the following theorem:
2

Theorem 1.4. Let K be a global field with char(K) 6= 2. Then K Ã— \ K Ã—2 is diophantine
over K.
This was established by Poonen in [Poo09b], using results on the Brauer-Manin obstruction. For number fields, this was extended to non-nth powers in [CTVG15] and further in
[Dit16]. In [Koe16], Koenigsmann gave a more elementary proof for K = Q. Using results in [Par13] and their extensions in this paper, together with Artin Reciprocity and the
Chebotarev Density Theorem, we give a different proof of Poonenâ€™s result.
2. S-integers and class field theory of global function fields
Let K be a global function field. In this section we recall some facts about rings of
S-integers and their class groups.
2.1. Background and definitions. Let K be a global function field, and let SK denote the
set of all primes of K. By a prime of K we mean an equivalence class of nontrivial absolute
values of K. In a global function field, all such absolute values are non-archimedean and
we can represent a prime as a pair (p, Op ) where Op is a local ring of K and p âŠ† Op is its
maximal ideal. We will often refer only to the ideal p as a prime of K. We denote by vp the
associated normalized discrete valuation on K. We now recall some facts about the ring of
S-integers OS in K where S âŠ‚ SK is a finite set of primes of K. The ring OS is a Dedekind
domain and its prime ideals are in one-to-one correspondence with the primes of K not in
S; this correspondence is given by
p 7â†’ p âˆ© OS .

See [Ros02, Theorem 14.5]. So given q âˆˆ OS , we can factor qOS uniquely into a product of
prime ideals of OS . The support of the divisor of q contains the primes in this factorization
and some primes of S.
Q
A modulus m of K is a formal product of primes of K, m = pm(p) , such that m(p) â‰¥ 0
for all p and m(p) = 0 for all but finitely many p. The group of fractional ideals I of K is the
free abelian group generated by the primes of K. We define Im to be the subgroup generated
by the primes which do not appear in m. Given Î± âˆˆ K Ã— , it defines a fractional ideal
Y
(Î±) :=
pvp (Î±) .
p

Define
Km,1 = {x âˆˆ K Ã— : vp (x âˆ’ 1) â‰¥ m(p) for all p dividing m}.

We have a well-defined map i : Km,1 â†’ Im , sending Î± to the fractional ideal (Î±). Define
Pm to be the subgroup i(Km,1 ) of Im . The ray class group modulo m, Cm , is defined to be
the quotient Im /Pm . This group is not finite, but the degree map (which we can define by
viewing these formal products as divisors) induces an exact sequence
0 â†’ Cm0 â†’ Cm â†’ Z â†’ 0.
The subgroup Cm0 of degree-zero divisor classes can be shown to be finite.
Let L be a finite abelian extension of K. Suppose p âˆˆ SK is unramified in L. Then we
define (p, L/K) âˆˆ Gal(L/K) to be its associated Frobenius automorphism. If m is a modulus
3

of K divisible by those primes which ramify in L, we have the global Artin map
ÏˆL/K : Im â†’ Gal(L/K)
Y
Y
pei i 7â†’
(pi , L/K)ei .

Theorem 2.1. (Artin Reciprocity) The Artin map is surjective and there exists a modulus
m containing all the primes of K which ramify in L such that the kernel is Pm NL/K (IL (mâ€² ));
here NL/K is the norm map on fractional ideals and mâ€² is the modulus of L consisting of
primes of L lying above those of K contained in m.
Remark 2.2. We call any m as in Theorem 2.1 an admissible modulus for the extension L
over K.
We will need the existence theorem of class field theory for function fields, so we introduce
the idele group. We define the idele group of K to be the restricted product of KpÃ— for p âˆˆ SK
with respect to the compact groups RpÃ— , where Rp is the ring of integers in the completion
Kp of K at p. We denote the idele group of K by I. Denote the diagonal embedding of
K Ã— in I again by K Ã— and the idele class group by CK := I/K Ã— , which we endow with the
quotient topology.
An idele of K determines a fractional ideal of K via the surjective map
id : I â†’ I
Y
pvp (xp ) .
(xp ) 7â†’
pâˆˆSK

Again let L/K be a finite abelian extension and let Sram be the set of primes of K ramifying
in L. Define
ISram := {(xp ) âˆˆ I : xp = 1 for all p âˆˆ Sram }.
There is a unique function Ï†L/K : I â†’ Gal(L/K) which is continuous, trivial on K Ã— , and
satisfies Ï†L/K ((xp )) = ÏˆL/K (id((xp ))) for all (xp ) âˆˆ ISram ; see [Tat67]. Hence Ï†L/K induces a
map on the idele class group CK , which we again denote by Ï†L/K . This is the idelic Artin
map. The idelic Artin reciprocity law states that the kernel of Ï†L/K is N(CL ) where N is
the norm map on ideles.
Now we state the existence theorem of class field theory; see Theorem 1 of Chapter 8 in
[AT68].
Theorem 2.3 (Existence Theorem). Let K be any global field. Fix an algebraic closure K
of K. Given a finite index open subgroup H âŠ‚ CK , there is a unique finite abelian extension
L of K in K such that H = N(CL ).
2.2. Ray class groups of rings of S-integers. Let Sâˆ := {âˆ1 , . . . , âˆn } âŠ† SK , and
A := OSâˆ . The ideal class group Cl(A) of the Dedekind domain A is finite. Denote by K A
the maximal abelian unramified extension of K in which each prime of Sâˆ splits completely.
Then Cl(A) âˆ¼
= Gal(K A /K) via the Artin map (see [Ros87]), and we will use K A and Cl(A)
in Section 3.2. Set âˆ := âˆ1 Â· Â· Â· âˆn . For the rest of this section, let m be another modulus
of K coprime to âˆ; we can then view m as an ideal of A. Below we define Clm (A), the
ray class group of A for the modulus m. One crucial ingredient to the universal definition
of S-integers is Lemma 3.15, where we need that a given class of Clm (A) contains infinitely
many primes of A. This is Theorem 2.9 at the end of this section, whose proof uses idelic
4

class field theory. The remainder of this section is devoted to proving Theorem 2.9. One can
think of this as a function field analogue of Dirichletâ€™s theorem.
Definition 2.4. Let Im (A) be the group of fractional ideals of A which are coprime to m.
We have a natural injection j : Km,1 â†’ Im (A) whose image we denote by Pm (A). This image
consists of principal fractional ideals Î±A with vp (Î± âˆ’ 1) â‰¥ m(p). Define
Clm (A) := Im (A)/Pm (A).

We need the following lemma:
Lemma 2.5 (Kernel-Cokernel sequence). Given a pair of maps between abelian groups
f

g

Aâˆ’
â†’Bâˆ’
â†’C

there is an exact sequence

0 â†’ ker f â†’ ker g â—¦ f â†’ ker g â†’ coker f â†’ coker g â—¦ f â†’ coker g â†’ 0.
Proof. This is Proposition 0.24 in [Mil06].



Define
Um,p := {x âˆˆ KpÃ— : vp (x âˆ’ 1) â‰¥ m(p)},
Y
Y
Im :=
KpÃ— Ã—
Um,p âˆ© I,
pâˆ¤m

Wm :=

Y
p|âˆ

p|m

KpÃ—

Ã—

Y

pâˆ¤mÂ·âˆ

OpÃ— Ã—

Y

Um,p .

p|m

Proposition 2.6. Let m be a modulus of K coprime to âˆ.
(1) The ideal map id : Im â†’ Im (A) induces an isomorphism Im /(Km,1Wm ) âˆ¼
= Clm (A).
âˆ¼
(2) The inclusion map Im â†’ I induces an isomorphism Im /Km,1 = CK .
Proof. (1) We have maps
Km,1 â†’ Im â†’ Im (A),
where the first map is the diagonal embedding and the second is the ideal map. Applying
the kernel-cokernel sequence gives us the exact sequence
Wm â†’ Im /Km,1 â†’ Clm (A) â†’ 0.

This follows because by definition, Clm (A) = Im (A)/Pm (A), Pm (A) = j(Km,1 ), and the kernel
of the ideal map restricted to Im is Wm . Thus Clm (A) is isomorphic to Im /Km,1 modulo the
image of Wm . Since the first map in the above sequence is reduction modulo the image of
Km,1 in Wm , we get that
Clm (A) âˆ¼
= (Im /Km,1)/(Wm Km,1 /Km,1 ) âˆ¼
= Im /Km,1Wm .
(2) The injection Im â†’ I gives us an injection Im /Km,1 â†’ CK . Denote the maximal
ideal of Rp by pÌ‚. Let (xp ) âˆˆ I and choose, using weak approximation, b âˆˆ K Ã— such that
vp (xp âˆ’ b) > m(p) + vp (xp ) for each p|m. Because vp (xp âˆ’ b) > vp (xp ), we must have that
vp (xp ) = vp (b). Then
vp (xp /b âˆ’ 1) = vp (xp âˆ’ b) âˆ’ vp (b) > m(p),
5

implying that xp /b âˆˆ Um,p for each p|m. Then (xp /b) âˆˆ Im maps to the image of (xp ) in CK
and we see that the map is surjective.

Proposition 2.7. The group Clm (A) is finite.
Proof. In any ideal class of A, we can find an ideal in it coprime to m, so we have a surjection
Clm (A) â†’ Cl(A). The kernel of this map is the subgroup of Clm (A) consisting of the principal
ideal classes of the form xA where vp (x) = 0 for p|m. These classes can be viewed as elements
in Cm0 . Since Cm0 is finite, we see that Clm (A) is an extension of finite groups and is itself
finite.

Corollary 2.8. There is a finite abelian extension KmA of K whose Galois group is isomorphic
to Clm (A) via the Artin map.
Proof. The injection Im â†’ I, when restricted to Km,1 Wm , induces an isomorphism
(Km,1 Wm )/Km,1 â‰ƒ (K Ã— Wm )/K Ã— .

Indeed, given c âˆˆ K Ã— and (xp ) âˆˆ Wm we can use weak approximation to find câ€² âˆˆ K Ã— such
that c/câ€² âˆˆ Km,1 as in the proof of part (2) of Theorem 2.6. Then ccâ€² (xp ) âˆˆ Km,1 Wm maps to
the image of c Â· (xp ) in (K Ã— Wm )/K Ã— . Thus Clm (A) is a quotient of CK by an open subgroup
subgroup, whose index is finite by Proposition 2.7. The Existence Theorem then guarantees
such an extension KmA /K as desired.

Together with an application of the Chebotarev Density Theorem, the above discussion
gives us the following theorem:
Theorem 2.9. Let A and m be as above. Any ideal class in Clm (A) contains infinitely many
prime ideals of A.
3. S-integers are universally definable in global function fields
In Sections 3.1 and 3.2 we will review facts and results from [Par13]. The rest of Parkâ€™s
argument does not extend to the function field setting, so we use results of Section 2 on
idelic class field theory to finish the proof in Section 3.3 and Section 3.4.
3.1. Notation and facts about quaternion algebras. Throughout this section, let K be
a global function field of odd characteristic. Let a, b âˆˆ K Ã— . We recall the following notation
from [Par13]:
(1) Given a prime p âˆˆ SK , let v := vp be its associated valuation, normalized so that
it takes values in Z âˆª {âˆ}. Define Kp to be the completion of K at p, Rp the ring
of integers in Kp , the maximal ideal of Rp by pÌ‚, and Fp the residue field of p. Set
Up := {s âˆˆ Fp : x2 âˆ’ sx + 1 is irreducible over Fp } and let redp : Rp â†’ Fp be the
reduction map. Let Op := Rp âˆ© K; this is the local ring of the prime p in K.
(2) Ha,b = K âŠ• Î±K âŠ• Î²K âŠ• Î±Î²K, the quaternion algebra over K with multiplication
given by Î±2 = a, Î² 2 = b, Î±Î² = âˆ’Î²Î±.
(3) Given x := x1 + x2 Î± + x3 Î² + x4 Î±Î², define x := x1 âˆ’ x2 Î± âˆ’ x3 Î² âˆ’ x4 Î±Î². This is the
standard involution on Ha,b . Define the (reduced) trace of x to be x + x = 2x1 and
the (reduced) norm of x to be x Â· x = x21 âˆ’ ax22 âˆ’ bx23 + abx24 .
(4) âˆ†a,b = {p âˆˆ SK : Ha,b âŠ—K Kp âˆ¼
6= M2 (Kp )}, that is, the set of primes where Ha,b
ramifies.
6

(

1
: p 6âˆˆ âˆ†a,b
, the Hilbert symbol of Kp .
âˆ’1 : p âˆˆ âˆ†a,b
(6) Sa,b = {2x1 âˆˆ K : âˆƒx2 , x3 , x4 such that x21 âˆ’ ax22 âˆ’ bx23 + abx24 = 1}. This is the set of
traces of norm one elements of Ha,b .
(7) Ta,b = Sa,b + Sa,b .
Given a prime p âˆˆ SK , we similarly define Sa,b (Kp ) and Ta,b (Kp ) just by replacing K with
Kp in the above definitions.
(5) (a, b)p =

Lemma 3.1.
(1) If p 6âˆˆ âˆ†a,b , then Sa,b (Kp ) = Kp .
(2) If p âˆˆ âˆ†a,b then redâˆ’1
p (Up ) âŠ† Sa,b (Kp ) âŠ† Op .
(3) For any p with |Fp | > 11, we have Fp = Up + Up .
(4) For each a, b âˆˆ K Ã— ,
\
Sa,b (Kp ).
Sa,b = K âˆ©
pâˆˆâˆ†a,b

Proof. See [Par13], Lemma 2.2; the arguments work when K is any global field.

Proposition 3.2. For any a, b âˆˆ K Ã— , we have
\
Op .
Ta,b =
pâˆˆâˆ†a,b

Proof. See [Par13, Proposition 2.3].



In our setting, we also have the following formula for the Hilbert symbol from [Ser79,
XIV.3.8]:,
 vp (b) (|Fp |âˆ’1)/2

a
vp (a)vp (b)
(a, b)p = (âˆ’1)
.
(1)
bvp (a)
Hence for a p-adic unit a, (a, p)p = âˆ’1 if and only if vp (p) is odd and redp (a) is not a
square in Fp .
3.2. Partitioning
the primes of K. Suppose a is not a square in K. Then if p is unramified
âˆš
Ã—
in K( a), after possibly multiplying by a square of K
 , a is a p-adic unit. We can then
(see Proposition 10.5 and 10.6
identify ÏˆK(âˆša)/K (p) with the power residue symbol ap
2

in [Ros02]).âˆšIf the images of a, b are distinct in K Ã— /K Ã—2 , we can use the splitting of p in
âˆš
Gal(K( a,  b)/K) to study the Hilbert symbols (a, p)p and (b, p)p , since if vp (p) is odd,
(a, p)p =

a
p

2

. We have the following lemma:

Lemma 3.3. Take a, b âˆˆ K Ã— whose images âˆš
in K Ã— /K Ã—2 are distinct and let m be an admisâˆš
sible modulus for the extension L := K( a, b)/K and let
ÏˆL/K : Im â†’ {Â±1} Ã— {Â±1}

be the Artin map. Suppose that m is divisible also by all primes dividing (ab). For a prime
p âˆˆ SK such that p âˆ¤ m, p âˆˆ âˆ†a,p âˆ© âˆ†b,p if and only if vp (p) is odd and ÏˆL/K (p) = (âˆ’1, âˆ’1).
7

Proof. See [Par13], Lemma 3.8. The only change in the argument is that we do not to worry
about total positivity conditions defining Km,1 since there are no Archimedean primes of a
global function field.

As in [Par13], we partition primes of K coprime to m based on their image under ÏˆL/K .
Choose a, b âˆˆ K Ã— and L as in Lemma 3.3 and set
P(p) := {p âˆˆ SK : vp (p) is odd.}.

Also, for (i, j) âˆˆ Gal(L/K), i, j âˆˆ {Â±1}, set
and set

P(i,j) = {p âˆˆ SK : p âˆˆ Im and ÏˆL/K (p) = (i, j)}
P(i,j) (p) = P(p) âˆ© P(i,j) .

Lemma 3.4. Suppose p âˆˆ K Ã— and let m be a modulus as in Lemma 3.3. Additionally,
suppose (p) and m are coprime. Then we have the following identification of sets of primes,
where the two sets differ at most by primes dividing the modulus.
P(âˆ’1,âˆ’1) (p) â†” âˆ†a,p âˆ© âˆ†b,p ,

P(âˆ’1,1) (p) â†” âˆ†a,p âˆ© âˆ†ab,p ,

P(1,âˆ’1) (p) â†” âˆ†b,p âˆ© âˆ†ab,p .
Proof. See [Par13, Lemma 3.9].



Lemma 3.5. Let p âˆˆ SK with p âˆ¤ m and suppose that ÏˆL/K (p) = (i, j) with (i, j) 6= (1, 1).
Then p âˆˆ P(i,j) (p) for some p âˆˆ K Ã— . Hence there exist u, v âˆˆ K Ã— such that p âˆˆ âˆ†u,p âˆ© âˆ†v,p .
If ÏˆL/K (p) = (1, 1) then there exist p, q âˆˆ K Ã— so that p âˆˆ âˆ†ap,q âˆ© âˆ†bp,q .
Proof. See [Par13, Lemmas 3.11, 3.12].



Definition 3.6. Let a, b âˆˆ K Ã— . Let
Ja,b :=

\

pOp .

pâˆˆâˆ†a,b âˆ©(P(a)âˆªP(b))

Proposition 3.7. Ja,b is diophantine over K.
Proof. See [Par13, Lemmas 3.14, 3.15, 3.17].



3.3. Controlling integrality with diophantine sets. The remainder of the argument
used to give a universal definition of the S-integers in K requires a different approach than
the one in [Par13]. In order to make our proof work, we need to find infinitely many q âˆˆ K Ã—
with prescribed image under ÏˆL/K and which generate prime ideals in a certain Dedekind
domain contained in K in order to control the poles of q.
Lemma 3.8. Let S be a finite set of primes in SK . We can choose a, b âˆˆ K Ã— so that the
following hold:
(1) The images of a and b in K Ã— /K Ã—2 are distinct.
âˆš âˆš
(2) Any admissible modulus m for L := K( a, b)/K is divisible by the primes of S.
8

(3) Given a finite set of primes S â€² âŠ† SK disjoint from S, an ideal class I in Cl(OS â€² ),
and an element Ïƒ âˆˆ Gal(L/K), there exists a prime q of K such that q âˆ© OS â€² is in
the ideal class I, q âˆˆ Im , and ÏˆL/K (q) = Ïƒ.
(4) As fractional ideals, (a) and (b) are coprime, meaning their supports are disjoint.
Proof. Set A = OS â€² . Let p1 âˆˆ SK \ S and choose a âˆˆ K Ã— with vp1 (a) = 0 and vp (a) = 1 for
p âˆˆ S; this is possible by weak approximation.
Now we choose b âˆˆ K Ã— with vp1 (b) = 1 and vp (b) = 0 for any p in the support of (a). Then
(a) and (b) have disjoint support. They have distinct images in K Ã— /K Ã—2 as the primes at
which a has odd valuation differ from the primes where b has
âˆš odd valuation. Thus we have
established (1) and (4). Since the primes in S ramify in K( a), they also ramify in L and
hence will be contained in any admissible modulus for L/K.
We are left with showing that (3) holds. Recall that K A /K is the maximal abelian
unramified extension of K in which every prime of S â€² splits completely and for which
Gal(K A /K) â‰ƒ Cl(A). We claim
that KâˆšA and L are linearly disjoint; this will follow if
âˆš âˆš
we can show that none of a, b, andâˆš ab are in K A . Since the primes in S ramify in
âˆš âˆš
K(âˆša), a 6âˆˆ K A . As pâˆš1 ramifies
primes of S along with p1 all ramify in
âˆš in K( b) and the
A
K( ab), we have that b, and ab are not in K , and the claim follows.
We conclude
Gal(LK A /K) âˆ¼
= {(Â±1, Â±1)} Ã— Cl(A).
= Gal(L/K) Ã— Gal(K A /K) âˆ¼
We then apply the Chebotarev density theorem to find a prime q such that
(q, LK A /K) = (Ïƒ, I) âˆˆ Gal(L/K) Ã— Gal(K A /K). This yields part (c):
Ïƒ = (q, LK A /K)|L = (q, L/K) = ÏˆL/K (q) and I = (q, LK A /K)|K A = (q, K A /K).

Ã—
For the rest of this section,
âˆš a, b âˆˆ K as in Lemma 3.8 along with an admissible
âˆš fix
modulus m of K for L := K( a, b).
âˆš âˆš
For the rest of this section, fix a, b âˆˆ K Ã— as in Lemma 3.8 and set L := K( a, b).
Next, we must fix two additional elements of K Ã— . To construct them, we need Theorem 3.7
of [Par13], which we restate below for convenience. This theorem lets us construct an element
of K Ã— with prescribed Hilbert symbols against finitely many elements of K Ã— .

Theorem 3.9. [Par13, Theorem 3.7] Let K be a global field, char(K) 6= 2. Let Î£ denote
the set of primes of K, and let Î› be a finite set of indices. Let (ai )iâˆˆÎ› be a finite sequence
of elements of K âˆ— and suppose that (Îµi,p )iâˆˆÎ›,pâˆˆÎ£ is a family of elements of {1, âˆ’1}. There
exists x âˆˆ K âˆ— satisfying (ai , x)p = Îµi,p for all i âˆˆ Î› and p âˆˆ Î£ if and only if the following
conditions hold:
(1) All but finitely many ofQthe Îµi,p are equal to 1.
(2) For all i âˆˆ Î›, we have pâˆˆÎ£ Îµi,p = 1.
(3) For every p âˆˆ Î£, there exists xp âˆˆ K âˆ— such that (ai , xp )p = Îµi,p.
Lemma 3.10. There exist c, d âˆˆ K Ã— such that âˆ†a,c = P(a) or âˆ†a,c = P(a) âˆª {pa } where pa
is coprime to (a) and (b), and âˆ†b,d = P(b) or âˆ†b,d âˆª {pb } where pb is coprime to (a), (b), and
pa .
9

Proof. Assume P(a) has even cardinality. Then by Theorem 3.9, there exists c in K such
that (a, c)p = âˆ’1 for each p âˆˆ P(a), and (a, c)p = 1 if p is not in P(a). Indeed, there are
an
number primes in P(a), and for a local element we can take any cp âˆˆ K Ã— such that
 even

cp
p

= âˆ’1. Then (a, cp )p = âˆ’1 since vp (a) is odd. The proof in the case that P(a) has
 
odd cardinality is the same by choosing pa coprime to (a) and (b) such that paa = âˆ’1
and considering the set P(a) âˆª pa . The local element for pa can be taken to be any element

cpa âˆˆ pa \ p2a . The proof for the existence of d is a similar argument.
We now also fix c, d âˆˆ K Ã— as in Lemma 3.10, along with a modulus m of K for L such
that m contains all the primes dividing (a), (b), (c), and (d) and any other primes p such that
(a, c)p = âˆ’1 or (b, d)p = âˆ’1.
Corollary 3.11. Let p âˆˆ K Ã— such that (p) and m are coprime. We have
P(âˆ’1,âˆ’1) (p) = âˆ†a,p âˆ© âˆ†b,p ,

P(âˆ’1,1) (p) = âˆ†a,p âˆ© âˆ†ab,p âˆ© âˆ†a,cp ,
P(1,âˆ’1) (p) = âˆ†b,p âˆ© âˆ†ab,p âˆ© âˆ†b,dp .

Proof. For the first equality, see [Par13, Corollary 3.20]. We will prove the second equality.
We have

 

a
(âˆ’1,1)
âˆ†a,p âˆ© âˆ†ab,p = P
(p) âˆª p âˆˆ P(a) :
= âˆ’1 ,
p

by Lemma 3.4. Also, P(âˆ’1,1) (p) âŠ† âˆ†a,cp , since (a, c)p = 1 for any p coprime to m. Thus we
need to compute the intersection âˆ†a,cp âˆ© {p|m}.
  Suppose p âˆˆ P(a). Then (a, c)p = âˆ’1 by

our choice of c, so (a, cp)p = âˆ’1 if and only if pp = 1. If p|m but p 6âˆˆ P(a), then (a, p)p = 1
by Equation 1, so (a, cp)p = âˆ’1 if and only if (a, c)p = âˆ’1. In any case, we conclude that
âˆ†a,p âˆ© âˆ†a,cp âˆ© {p|m} = âˆ…,

because whenever (a, p)p = âˆ’1 for p|m, we have (a, c)p = âˆ’1 as well. Thus the second
equality holds. The proof of the third equality goes the same way by calculating
âˆ†b,dp âˆ© {p|m}.

Definition 3.12. For p, q âˆˆ K Ã— , let
Rp(âˆ’1,âˆ’1) =

\

pâˆˆâˆ†a,p âˆ©âˆ†b,p

Rp(1,âˆ’1) =

Op ,

\

pâˆˆâˆ†ab,p âˆ©âˆ†b,p âˆ©âˆ†a,cp

\

Rp(âˆ’1,1) =

pâˆˆâˆ†a,p âˆ©âˆ†ab,p âˆ©âˆ†b,dp
(1,1)
Rp,q
=

\

pâˆˆâˆ†ap,q âˆ©âˆ†bp,q

10

Op .

Op ,
Op ,

Given a finite set of primes S âŠ‚ SK , in Section 3 we will express the S-integers OS in
(1,1)
terms of the rings RpÏƒ for Ïƒ = (âˆ’1, âˆ’1), (âˆ’1, 1), and (1, âˆ’1) and Rp,q defined above.
Definition 3.13. For each Ïƒ âˆˆ Gal(L/K), let
Î¦Ïƒ = {p âˆˆ K Ã— : (p) âˆˆ Im , ÏˆL/K ((p)) = Ïƒ, and P(p) âŠ† P(1,1) âˆª PÏƒ }.
Lemma 3.14.
(1) For each Ïƒ âˆˆ Gal(L/K), Î¦Ïƒ is diophantine over K.
(2) For any p âˆˆ Î¦Ïƒ and Ïƒ âˆˆ Gal(L/K) with Ïƒ 6= (1, 1), we have that P(Ïƒ) (p) is nonempty.
Furthermore, the Jacobson radical of RpÏƒ , denoted J(RpÏƒ ), is diophantine over K.
(3) Let Ïƒ âˆˆ Gal(L/K) with Ïƒ 6= (1, 1), and let p0 âˆ¤ m be a prime of K satisfying
ÏˆL/K (p0 ) = Ïƒ. Then there is an element p âˆˆ Î¦Ïƒ such that p0 âˆˆ PÏƒ (p). In fact,
p can be chosen so that PÏƒ (p) = {p0 }.
Proof. To prove (1), we first establish that Km,1 is diophantine over K: this follows from
the fact that Km,1 is defined by the finitely many local conditions vp (a âˆ’ 1) â‰¥ m(p) for
p|m and that the local rings Op are diophantine over K for any prime p by [Shl94, Lemma
3.22]. Because a class of principal ideals in Cm lies in Cm0 which is finite, we see there are only
finitely many inequivalent classes of the form (p)Pm for p âˆˆ K Ã— . Thus {p âˆˆ K Ã— : (p) âˆˆ Im } is
diophantine over K as it is a finite union of translates of Km . Observe that P(p) âŠ† P(1,1) âˆª PÏƒ
is equivalent to one of the following:
â€¢
â€¢
â€¢
â€¢

P(1,âˆ’1) (p) = P(âˆ’1,1) (p) = âˆ…, if Ïƒ = (âˆ’1, âˆ’1);
P(âˆ’1,âˆ’1) (p) = P(âˆ’1,1) (p) = âˆ…, if Ïƒ = (1, âˆ’1);
P(âˆ’1,âˆ’1) (p) = P(1,âˆ’1) (p) = âˆ…, if Ïƒ = (âˆ’1, 1);
P(1,âˆ’1) (p) = P(âˆ’1,1) (p) = P(âˆ’1,âˆ’1) (p) = âˆ…, if Ïƒ = (1, 1).

For Ï„ 6= (1, 1), we have that PÏ„ (p) = âˆ… if and only if p âˆˆ K Ã—2 Â· (RpÏ„ )Ã— , and this is a
diophantine subset of K. Thus for any Ïƒ, Î¦Ïƒ is the intersection of finitely many diophantine
sets and is thus diophantine over K.
Now we prove (2). Suppose Ïƒ 6= (1, 1) and that p âˆˆ Î¦Ïƒ . Then because ÏˆL/K ((p)) = Ïƒ
and P(p) âŠ† P(1,1) âˆª PÏƒ , there must be some prime p âˆˆ PÏƒ (p), because otherwise we would
(âˆ’1,âˆ’1)
have Ïˆ((p)) = (1, 1). If Ïƒ = (âˆ’1, âˆ’1), then we observe that J(Rp
) = Ja,p + Jb,p is
(âˆ’1,1)
diophantine over K by Definition 3.6 Lemma 3.7. Similarly, J(Rp
) = Ja,p + Jab,p + Ja,cp
(1,âˆ’1)
and J(Rp
) = Jb,p + Jab,p + Jb,dp are diophantine over
K.
âˆš âˆš
We move on to (3). Suppose that Ïƒ âˆˆ Gal(K( a, b)/K) with Ïƒ 6= (1, 1) and p0 âˆ¤ m is a
prime of K satisfying ÏˆL/K (p0 ) = Ïƒ. Let qâ€² âˆ¤ m be a prime of K with ÏˆL/K (qâ€² ) = (1, 1) and
let S â€² = {qâ€² }. By Lemma 3.8 we can choose a prime q of K such that it represents the class
of (p0 âˆ© OS â€² )âˆ’1 in Cl(OS â€² ) and ÏˆL/K (q) = (1, 1). Then there is an element p âˆˆ OS â€² such that
(p0 âˆ© OS â€² )(q âˆ© OS â€² ) = pOS â€² .
We claim that p âˆˆ Î¦Ïƒ . Since vp (p) = 0 if p 6= p0 , q, qâ€², it follows that (p) âˆˆ Im and
ÏˆL/K ((p)) = ÏˆL/K (p0 )ÏˆL/K (q)ÏˆL/K (qâ€² ) = Ïƒ.
Additionally, the only primes p with vp (p) odd are p0 , q, and possibly qâ€² . Hence P(p) âŠ†
P(1,1) âˆª PÏƒ and p âˆˆ Î¦Ïƒ . Finally, we observe that PÏƒ (p) = {p0 }.

11

Lemma 3.15. Let p0 , q0 be primes of K not dividing m with ÏˆL/K (q0 ) = (1, 1). Let A :=
O{q0 } . Then there exists infinitely many q âˆˆ K Ã— satisfying
(1) 
ÏˆL/K
 ((q)) = (âˆ’1, âˆ’1);
q
(2) p0 = âˆ’1;
(3) qA is a prime ideal of A, so there exists a prime q of K such that q âˆ© A = qA.

Proof. Set
Km := {Î± âˆˆ K Ã— : vp (Î±) = 0 âˆ€p|m}.
For a prime p 6= q0 of K, let Ip := A âˆ© p be the associated prime ideal in A. Given x âˆˆ Km ,
we can find y, z âˆˆ A âˆ© Km such that x = y/z. Then y and z are p-adic units for each p|m
Q
m(p)
and thus we can map x = y/z to the image of y/z modulo p|m Ip . The kernel of this
map is Km,1 so there is a well-defined isomorphism
Km /Km,1

ï£« ,
ï£¶Ã—
Y m(p)
â‰ƒ ï£­A
Ip ï£¸ .
p|m

By the Chinese Remainder Theorem,

Kp0 m /Kp0 m,1 âˆ¼
= Km /Km,1 Ã— (A/Ip0 )Ã— .
The group Km /Km,1 surjects onto the ray classes in Cm consisting of principal fractional
ideals by the map
xKm,1 7â†’ (x)Pm .
Now we apply Lemma 3.8 part (3) to find a prime qâ€² of K in the principal ideal class of Cl(A)
such that ÏˆL/K (qâ€² ) = (âˆ’1, âˆ’1). Then there exists x1 âˆˆ K Ã— such that ÏˆL/K ((x1 )) = (âˆ’1, âˆ’1)
and x1 A = qâ€² âˆ© A is a prime ideal of A. Let s be a non-square of (A/Ip0 )Ã— . By the
Ã—
Chinese Remainder Theorem, the element (x1 Km,1 , s) in Km
/Km,1 Ã— (A/Ip0 ) corresponds to

an element x2 Kp0 m,1 âˆˆ Kp0 m /Kp0 m,1 . By construction, xp02 = âˆ’1. The ideal x2 A need not
be a prime ideal of A, but by Theorem 2.9, we can find infinitely many prime ideals of A in
the class generated by x2 in Clmp0 (A); such a prime ideal is of the form qA = q âˆ© A. Both
qA and x2 A generate the same class in Clmp0 (A) and hence q = x2 t for some t âˆˆ Kmp0 ,1 .
Thus ÏˆL/K ((q)) = ÏˆL/K ((x2 )) and since q and x2 , as elements of A, are congruent modulo
the ideal Ip0 of A,
   
q
x2
=
= âˆ’1.
p0
p0
Thus the element q satisfies the three requirements of the lemma.


We now need more definitions from [Par13].
12

âˆš âˆš
Definition 3.16. For Ïƒ âˆˆ Gal(K( a, b)/K), and S âŠ† SK the fixed set of primes from
above, define
fÏƒ := K Ã—2 Â· Î¦Ïƒ ;
Î¦
(
Y
]
^
Î¨K := (p, q) âˆˆ Î¦
(ap, q)p = âˆ’1
(1,1) Ã— Î¦(âˆ’1,âˆ’1) |
p|m

)

and p âˆˆ a Â· K Ã—2 Â· (1 + J(Rq(âˆ’1,âˆ’1) )) .
Lemma 3.17.
(1) The set Î¨K is diophantine over K.
(1,1)
(2) For (p, q) âˆˆ ÏˆL/K , we have âˆ… =
6 âˆ†ap,q âˆ© âˆ†bp,q âŠ† Im , and J(Rp,q ) is diophantine over
K.
(3) For each prime ideal p0 satisfying p0 âˆ¤ m and ÏˆL/K (p0 ) = (1, 1), there exists (p, q) âˆˆ
Î¨K such that âˆ†ap,q âˆ© âˆ†bp,q = {p0 }.

]
^
Proof. By Lemma 3.14 part (1), Î¦
(1,1) Ã— Î¦(âˆ’1,âˆ’1) is diophantine over K, and by Lemma 3.14
(âˆ’1,âˆ’1)
part (2), J(Rq
) is diophantine over K. By Theorem 4.5, for any prime p of K,
{(x, y) : (x, y)p = âˆ’1} âŠ† K Ã— Ã— K Ã—

is diophantine over K. Here, (Â·, Â·)p denotes the Hilbert symbol of K at p. Since only finitely
many p divide m, the set Î¨K is the intersection of finitely many sets diophantine over K.
For (2), the proof in [Par13] of Lemma 3.25 part (2) shows that for (p, q) âˆˆ Î¨K , if p âˆ¤ m
then âˆ†ap,q âˆ© âˆ†bp,q âˆ© Im is nonempty. We only need to show that if p|m, p 6âˆˆ âˆ†ap,q âˆ© âˆ†bp,q .
]
^
Suppose that p âˆˆ âˆ†ap,q . Then (ap, q)p = âˆ’1. Since p âˆˆ Î¦
(1,1) and q âˆˆ Î¦(âˆ’1,âˆ’1) we can assume
Ã—
that, possibly after multiplying by a square of K , vp (p) = vp (q) = 0. Then (ap, q)p = âˆ’1
implies that vp (ap) = vp (a) is odd, which implies vp (b) must be 0 since the fractional ideals
(a) and (b) have disjoint support. Thus (bp, q)p = 1 and p 6âˆˆ âˆ†ap,q âˆ© âˆ†bp,q .
Now we prove (3). Let p0 satisfy p0 âˆ¤ m and ÏˆL/K (p0 ) = (1, 1); we wish to construct a pair
(p, q) âˆˆ Î¨K such that âˆ†ap,q âˆ© âˆ†bp,q = {p0 }. We begin by constructing our candidate for q.
Choose a different prime q0 of K not dividing m with
 ÏˆL/K (q0 ) = (1, 1). Using Lemma 3.15,

choose q âˆˆ K Ã— such that ÏˆL/K ((q)) = (âˆ’1, âˆ’1), pq0 = âˆ’1, and q generates a prime ideal
of A := O{q0 } . Thus there exists a prime q of K with qA = q âˆ© A. Observe that this implies
that the support of (q) is {q, q0}. We claim that
âˆ†a,q âˆ© âˆ†b,q = {q}.

We begin by showing that (a, q)q = (b, q)q = âˆ’1. The support of (a) and (b) is contained in
m, so vq (a) = vq (b) = 0. We have that vq (q) is odd, so we need to show a and b are nonsquares in the completion of K at q. This follows immediately from ÏˆL/K (q) = (âˆ’1, âˆ’1).
From ÏˆL/K (q0 ) = (1, 1) we get that q0 6âˆˆ âˆ†a,q âˆ© âˆ†b,q . No other prime p in Im can appear
in this set since we have vp (q) = vp (a) = vp (b) = 0. Finally, no prime p|m can occur in
âˆ†a,q âˆ© âˆ†b,q since we cannot have that vp (a) and vp (b) are both odd as their supports are
disjoint, and vp (q) = 0. This proves the claim.
13

For each prime p|m, let Ep âŠ† K be a generating setforKpÃ— /KpÃ—2 chosen
  so that for each
e âˆˆ Ep , we have vp0 (e âˆ’ 1) â‰¥ 0. Fix e0 âˆˆ K such that eq0 = âˆ’1 and pe00 = 1.
Now one can construct p âˆˆ K Ã— so that (p, q) âˆˆ ÏˆL/K with âˆ†ap,q âˆ© âˆ†bp,q = {p0 } as it is
constructed in [Par13], Lemma 3.25(c). The remainder of the proof exactly follows Parkâ€™s
after Equation 3.6 (loc. cit.). The only difference is that instances of the ideal (q) of the
number field K are replaced with the prime q of K in this proof.

3.4. Proof of main theorem. Our general strategy in proving Theorem 1.2 follows that
of [Koe16].
Definition 3.18.
Given some finite set of primes âˆ† âŠ† S of K, consider the semi-local
T
subring R = pâˆˆâˆ† Op of K. Set
e = {x âˆˆ K :6 âˆƒy âˆˆ J(R) with xy = 1}.
R

Lemma 3.19.

e is defined by a universal formula in K.
(1) If J(R) is diophantine over K, then R
S
e=
f
(2) R
pâˆˆâˆ† Op , provided that âˆ† 6= âˆ…. In particular, Op = Op .

Proof. To see (1), observe that

e = {x âˆˆ K : x = 0 or xâˆ’1 âˆˆ K \ J(R)}.
R

Since J(R) is diophantine, its complement is defined by a universal formula, and thus so is
e
R.
S
eâŠ†S
Now we prove (2). To see that R
Op . This means that for
pâˆˆâˆ† Op , assume x 6âˆˆ
T pâˆˆâˆ†
âˆ’1
âˆ’1
e
all p âˆˆ âˆ†, vp (x) < 0 and hence vp (x ) > 0, giving x âˆˆ pâˆˆâˆ† Op = J(R). Hence x 6âˆˆ R.
For the reverse inclusion, suppose x âˆˆ Op for some p âˆˆ âˆ†. Then if y âˆˆ J(R), we have that
e
vp (x Â· y) â‰¥ 1 and hence x Â· y 6= 1. Thus x âˆˆ R.

Given a modulus m, let S(m) := {p : p|m}.

Theorem 3.20. For any global function field K and finite set of primes S âŠ‚ SK , with m
chosen as before,
ï£¶
ï£«
\
\ ]
\ \
(1,1)
fÏƒ ï£¸ âˆ©
fp âˆ© ï£­
R
OS =
O
Rp,q ,
p
pâˆˆS(m)\S

Ïƒ6=(1,1) pâˆˆÎ¦Ïƒ

(p,q)âˆˆÎ¨K

where Î¦Ïƒ and Î¨K are the diophantine sets in the previous section.

Proof. For p âˆˆ Î¦Ïƒ and (p, q) âˆˆ Î¨K , all of the sets PÏƒ (p) and âˆ†ap,q âˆ© âˆ†bp,q are nonempty.
Thus the right hand side is equal to
ï£«
ï£¶
\
\ \ [
\
[
(1,1)
RS :=
Op âˆ© ï£­
Op ï£¸ âˆ©
Rp,q
.
pâˆˆS(m)\S

Ïƒ6=(1,1) pâˆˆÎ¦Ïƒ pâˆˆPÏƒ (p)

14

(p,q)âˆˆÎ¨K pâˆˆâˆ†ap,q âˆ©âˆ†bp,q

To show RS is contained in OS , consider a prime p0 6âˆˆ S. We need to show that any
x âˆˆ RS is integral at p0 . If p0 |m, this is clear. If not, consider the image of p0 under ÏˆL/K .
First we assume ÏˆL/K (p0 ) 6= (1, 1). Then we claim that we can choose p, pâ€² âˆˆ Î¦Ïƒ such that
[
[
Op0 =
Op âˆ©
Op .
pâˆˆPÏƒ (pâ€² )

pâˆˆPÏƒ (p)

If this claim is true, then x âˆˆ RS implies that vp0 (x) â‰¥ 0. Suppose Ïƒ = (âˆ’1, âˆ’1). Using
Lemma 3.14, we find p âˆˆ Î¦Ïƒ such that {p0 } = PÏƒ (p). Now let p1 be some other prime of
K not dividing m with ÏˆL/K (p1 ) = (1, 1), set S â€² = {p1 } and A := OS â€² . Then using Lemma
3.8, we find a prime q of K such that q âˆ© A is in the ideal class of (p0 âˆ© A)âˆ’1 in Cl(A) and
ÏˆL/K (q) = (1, 1). There exists an element pâ€² âˆˆ A such that (p0 âˆ© A)(q âˆ© A) = pâ€² A. Then
pâ€² âˆˆ Î¦(âˆ’1,âˆ’1) , as p0 , p1 , and q do not divide m, P(pâ€² ) = {p0 , p1 , q}, and
ÏˆL/K (pâ€² ) = ÏˆL/K (p0 )ÏˆL/K (p1 )ÏˆL/K (q) = (âˆ’1, âˆ’1).

Thus P(âˆ’1,âˆ’1) (p) âˆ© P(âˆ’1,âˆ’1) (p) = {p0 } and the claim follows; the case of Ïƒ = (âˆ’1, 1) and
Ïƒ = (1, âˆ’1) is entirely similar.
If p0 satisfies ÏˆL/K (p0 ) = (1, 1) then we have seen in Lemma 3.17 that there exist (p, q) âˆˆ
Î¨K such that {p0 } = âˆ†ap,q âˆ© âˆ†bp,q (and consequently (p, q) âˆˆ Î¨K ), implying
[
Op = Op0 .
pâˆˆâˆ†ap,q âˆ©âˆ†bp,q

Thus x is integral at primes outside of S.
To show the reverse inclusion, we claim that membership in RS imposes no integrality
condition at a prime in S. If p0 âˆˆ S, for any Ïƒ âˆˆ Gal(L/K) and any p âˆˆ Î¦Ïƒ , we have
p0 6âˆˆ PÏƒ (p). Additionally, p0 6âˆˆ âˆ†ap,q âˆ© âˆ†bp,q for (p, q) âˆˆ Î¨K as âˆ†ap,q âˆ© âˆ†bp,q âŠ† Im by Lemma
3.17 part (2).

Now we are ready to prove our first main theorem.
Theorem 1.2. For any global function field K with char(K) 6= 2, and any nonempty, finite
set of primes S of K, OS is defined by a first-order universal formula.
Proof. Theorem 3.20 shows that for t âˆˆ K,
\
fp
t âˆˆ OS â‡â‡’ t âˆˆ
O
p|m

âˆ§ âˆ€p

^

Ïƒ6=(1,1)

âˆ§ âˆ€p, q

fÏƒ )
(p 6âˆˆ Î¦Ïƒ âˆ¨ t âˆˆ R
p

]
(1,1)
(p, q) 6âˆˆ Î¨K âˆ¨ t âˆˆ Rp,q .
(1,1)

Given Ïƒ âˆˆ Gal(L/K), p âˆˆ Î¦Ïƒ , and (p, q) âˆˆ Î¨K , we have that J(RpÏƒ ) and J(Rp,q ) are
diophantine by Lemmas 3.14 and 3.17. The sets Î¦Ïƒ and Î¨K are diophantine by the same
lemmas, so their complements are defined by a universal formula. Additionally, membership
]
(1,1)
fÏƒ is given by a universal formula, along with membership in R
in R
p,q . Hence membership
p
in OS can be given by a universal formula.

15

4. Non-squares and non-norms of global fields are diophantine
Now we let K be a global field with char(K) 6= 2. Throughout this section, fix a, b, c, d
as in Lemmas 3.8 and 3.10 if K is a global function field, and if K is a number field,
choose a, b âˆˆ K Ã— as in Proposition 3.19 of [Par13]. Additionally, we fix c, d âˆˆ K Ã— satisfying
the same assumptions as in Lemma 3.10 but now in the case that K is a number field.
Corollary 3.20 in [Par13] is incorrect as stated, and has to be modified as in Corollary 3.11
of our paper. With
this modification, the other results from [Par13] are correct as stated.
âˆš âˆš
Set L := K( a, b) and fix an admissible modulus m for L/K where m contains all the
primes dividing (2abcd), and all real places if K is a number field. In this section we prove
Theorems 1.4 and 1.3.
4.1. Non-squares. We begin by proving Theorem 1.4, i.e. that K \ K Ã—2 is diophantine over
K. We use the fact that x 6âˆˆ K Ã—2 is equivalent to x being a non-square in a completion of
K at some prime p, where p may be finite or infinite.
Suppose âˆ is a real archimedean prime of K corresponding to an embedding Ï‰ : K Ö’â†’ R.
For x âˆˆ K Ã— , we have that x is not a square in Kâˆ if and only if Ï‰(x) < 0. Therefore we
require the following lemma:
Lemma 4.1. Suppose K is a number field and that âˆ is a real archimedean prime of K
corresponding to an embedding Ï‰ : K Ö’â†’ Kp = R. Then the set
KÏ‰Ã— := {x âˆˆ K Ã— : Ï‰(x) > 0}
is diophantine over K. Moreover, the set
{x âˆˆ K Ã— : x is not totally positive }
is diophantine over K.
Proof. Let p be a finite prime of K and let B be the quaternion algebra over K ramified
exactly at p and âˆ. Let Nrd : B â†’ K denote the reduced norm map on B. Then by Facts
I and II of [SH36], Nrd(B Ã— ) = KÏ‰Ã— . Let b1 , b2 , b3 , b4 be a K-basis of B. Then
!
4
X
q(x1 , x2 , x3 , x4 ) := Nrd
xi bi
i=1

is a quadratic form in the variables x1 , . . . , x4 with coefficients in K, and
KÏ‰Ã— = {x âˆˆ K Ã— : âˆƒa1 , . . . , a4 âˆˆ K s.t. q(a1 , a2 , a3 , a4 ) = x}.
We conclude that KÏ‰Ã— is diophantine over K. For an alternative proof, see [Den80], Lemma
10.
Now we will prove the second statement. Let Ï‰1 , . . . , Ï‰r denote a complete set of representatives of the inequivalent embeddings of K into R. The set S
of elements which are not
totally positive is diophantine over K, since it is the finite union i âˆ’KÏ‰Ã—i .

The main lemma used in proving Theorem 1.4 is the following:
16

Lemma 4.2. Let K be a global field with char(K) 6= 2. Then
ï£±
ï£´
ï£²x is not totally positive, or
Ã—2
x 6âˆˆ K
â‡â‡’ vp (x) is odd for some p|m0 , or
ï£´
(âˆ’1,1)
ï£³âˆƒp âˆˆ Î¦
Ã—2
Â· (1 + J(Rp
)).
(âˆ’1,1) such that x âˆˆ a Â· K
(âˆ’1,1)

Here, m0 denotes the finite primes dividing m, and Î¦(âˆ’1,1) , Rp
, a, and m are as in
Section 3.3. Before proving Lemma 4.2, we will show how to use it to prove Theorem 1.4.
Proof of Theorem 1.4 from Lemma 4.2. We begin by showing the right side of the equivalence in Lemma 4.2 defines a diophantine subset of K. We claim that, for a prime p of K,
the set
{x âˆˆ K Ã— : vp (x) is odd}
is diophantine over K. To see this, fix p âˆˆ K Ã— with vp (p) = 1. Then vp (x) is odd if and only
if x âˆˆ p Â· K Ã—2 Â· OpÃ— . This is diophantine over K since
OpÃ— = Op âˆ© {x âˆˆ K Ã— : xâˆ’1 âˆˆ Op }.

Since only finitely many primes divide m0 , the condition that vp (x) is odd for some p|m0
is diophantine as well. As noted in Lemma 4.1, the condition that x is not totally positive
defines a diophantine set. If K is a global function field, Lemma 3.14 parts (1) and (2)
complete the argument that the right side of Lemma 4.2 defines a diophantine subset of
K. The number field case follows from parts (a) and (b) of Lemma 3.22 of [Par13]. Hence
Lemma 4.2 shows that K Ã— \ K Ã—2 is diophantine.

We are now left with proving Lemma 4.2, for which we need the following lemma.
(âˆ’1,1)

Lemma 4.3. Let Î¦(âˆ’1,1) , Rp
, a, b, and m be defined as in Section 3.3. Let p âˆˆ Î¦(âˆ’1,1) .
(âˆ’1,1)
Then x âˆˆ a Â· K Ã—2 Â· (1 + J(Rp
)) if and only if there exists an element t âˆˆ K Ã— such that
(âˆ’1,1)
2
âˆ€q âˆˆ P
(p), vq (xt ) = 0 and the image of xt2 in the residue field of q is not a square.
Proof. Since p âˆˆ Î¦(âˆ’1,1) , we have that P(âˆ’1,1) (p) 6= âˆ…. In the function field setting, this
follows from Lemma 3.14, and in the number field setting, it follows from Lemma 3.22 of
[Par13]. We also have that
\
Rp(âˆ’1,1) =
Oq ,
qâˆˆP(âˆ’1,1) (p)

\

J(Rp(âˆ’1,1) ) =

qOq .

qâˆˆP(âˆ’1,1) (p)

Suppose there exists t âˆˆ K Ã— as in the lemma. Let q âˆˆ P(âˆ’1,1) (p). Then xt2 â‰¡ a in
(Oq /q)Ã— /(Oq /q)Ã—2 , since by our choice of a and b,
    
âˆš âˆš
a
b
,
= (q, K( a, b)/K) = (âˆ’1, 1).
q 2 q 2
 
Here qÂ· is the degree 2 power residue symbol for K. Thus there is some sq âˆˆ (Oq )Ã— such
2

that xt2 = as2q mod q; using the Chinese remainder theorem we find an s so that xt2 = as2
17

mod q for each q. Since q := xt2 âˆ’ as2 âˆˆ q for each q âˆˆ P(âˆ’1,1) (p), it is in their intersection.
Thus
x = a Â· (s/t)2 (1 + q/(as2 )).
T
We claim x is in a Â· K Ã—2 Â· (1 + qâˆˆP(âˆ’1,1) (p) qOq ). Let q âˆˆ P(âˆ’1,1) (p). Then vq (a) = 0 because
(a) is only divisible by primes dividing m and q âˆˆ Im . Additionally, vq (s) = 0 and vq (q) â‰¥ 1,
because s âˆˆ OqÃ— and q âˆˆ q. The claim follows as
vq (q/as2 ) â‰¥ 1 âˆ’ vq (a) âˆ’ 2vq (s) â‰¥ 1.
For the other implication, write x = at2 (1 + j) with t 6= 0 and j âˆˆ
vq (x/t2 ) = vq (a(1 + j)) = vq (a) = 0

T

qâˆˆP(âˆ’1,1) (p)

qOq . Then

for each q âˆˆ PÏƒ (p), and x/t2 â‰¡ a modulo q for q âˆˆ P(âˆ’1,1) (p). Finally, by construction, a is
a non-square in the completion at any prime q âˆˆ P(âˆ’1,1) (p).

We now prove Lemma 4.2:
Proof of Lemma 4.2. For the forward implication, suppose x is not a square. If x is not
totally positive, or vp (x) is odd for some p|m, we are done, so assume that vp (x) is even for
each p|m and that x is totally positive. Using weak approximation, we may assume that
in fact vp (x) = 0 for each p|m. This does not change the truth value of either side of the
implication in Lemma 4.2, as both statements are invariant under multiplying x by a square.
What we will now show is that there is a p âˆˆ Î¦(âˆ’1,1) such that P(âˆ’1,1) (p) = {q}, vq (x) = 0,
and such that x modulo q is not a square. Together with Lemma 4.3, this will imply that
(âˆ’1,1)
Ã—2
x âˆˆ a Â· Kâˆš
Â· (1 + J(Rp
)).
As K( x)âˆšis a degree 2 extension of K unramified at all p|m, it is linearly disjoint from
âˆš
âˆš
L = K( a, b) over âˆš
K. Let Ï„ be the nontrivial automorphism of K( x)/K and consider
(Ï„, (âˆ’1, 1)) âˆˆ Gal(K( x)/K) Ã— Gal(L/K). By the Chebotarev Density Theorem, there is a
prime q of K so that its associated
Frobenius automorphism is (Ï„, (âˆ’1, 1)). The restriction
âˆš
of this automorphism to K( x) is
âˆš
Ï„ = (q, K( x)/K),
âˆš
implying q does not split completely in K( x). Hence x is not a square in the completion
of K at q. The restriction to L is
âˆš âˆš
(âˆ’1, 1) = (q, K( a, b)/K),
so we have that q âˆˆ P(âˆ’1,1) . If K is a global function field, Lemma 3.14 implies there exists
an element p âˆˆ K Ã— so that {q} = P(âˆ’1,1) (p). In the number field setting, this follows from
Lemma 3.22 in [Par13]. This is the desired element p and prime q, and finishes the first half
of the proof.
For the reverse implication, suppose that there is an element p âˆˆ Î¦(âˆ’1,1) such that x âˆˆ
(âˆ’1,1)
a Â· K Ã—2 Â· (1 + J(Rp
)). By Lemma 4.3 there exists t 6= 0 such that xt2 is a non-square in
the completion of K at each prime q âˆˆ P(âˆ’1,1) (p). This implies xt2 itself is not a square in
K, i.e. x 6âˆˆ K Ã—2 .

18

4.2. Non-norms. Let K be a global field with char(K) 6= 2. To prove Theorem 1.3, which
states that the set
âˆš
{(x, y) âˆˆ K Ã— Ã— K Ã— : x is not a norm of K( y)}

is diophantine over K, we use the Hasse norm theorem: for a cyclic extension L/K, an
element of K is a (relative) norm of an element of L if and only if it is a local norm in every
completion of K. We will use the fact that
âˆš
âˆš
(x, y)p = âˆ’1 â‡” x is not a local norm of K( y) â‡” y is not a local norm of K( x).

We begin by establishing that, given a finite or infinite prime p of K, the collection of
âˆš
pairs (x, y) âˆˆ K Ã— Ã— K Ã— such that x is not a local norm in the completion of K( y) at p is
diophantine over K.
First we need the following lemma, which will be used both in the proof of Theorem 4.5
and later in proving Theorem 1.3.

Lemma 4.4. Let p be a finite prime of K with |Fp | odd. Fix p, s âˆˆ K Ã— so that vp (p) = 1
and vp (s) = 0 so that redp (s) is not a square in the residue field of p. Then for x, y âˆˆ K Ã— ,
(x, y)p = âˆ’1 if and only if

(x âˆˆ p Â· K Ã—2 Â· OpÃ— ) âˆ§ (y or âˆ’ xy âˆˆ s Â· K Ã—2 Â· (1 + pOp ))

âˆ¨ (y âˆˆ p Â· K Ã—2 Â· OpÃ— ) âˆ§ (x or âˆ’ xy âˆˆ s Â· K Ã—2 Â· (1 + pOp )) .
Proof. Assume that (x, y)p = âˆ’1. From the formula for the Hilbert symbol in Section 3.1, at
least one of x or y must have odd valuation at p, so without loss of generality, assume vp (x) is
odd. As (x, y)p = âˆ’1, the formula for the Hilbert symbol implies ((âˆ’1)vp (x)vp (y) )(|Fp |âˆ’1)/2 = âˆ’1
 v (y)  |Fp2|âˆ’1
p
= 1 or vice versa. Then vp (x/p) is even and x/p âˆˆ K Ã—2 Â· OpÃ— .
and redp xyvp (x)

Case 1. If vp (y) is even, then using weak approximation, choose t âˆˆ K Ã— so that yt2 is a
 v (y)  |Fp2|âˆ’1
p
p-adic unit. In this case, redp xyvp (x)
= âˆ’1 since (âˆ’1)vp (x)vp (y) = 1. We claim that yt2
is a non-square modulo p. This follows from
 (vp (y))/2 (1âˆ’vp (x))/2 2 
 vp (y) âˆ’vp (x) 2 
(x
y
t)
x
y
yt
=
= 1.
p
p
2
2
Since yt2 is not a square mod p, an argument similar to the one in the proof of Lemma 4.3
shows that y âˆˆ s Â· K Ã—2 Â· (1 + pOp ).
Case 2. Suppose vp (y) is odd. We claim that, possibly after multiplying by a square of K,
âˆ’xy is not a square modulo p. This would imply that
âˆ’xy âˆˆ s Â· (K Ã— )2 (1 + pOp ),

which is what we want to show. To prove the claim, use weak approximation to find t âˆˆ K Ã—
such that vp (xyt2 ) = 0. The following calculation shows xvp (y) /y vp (x) and xyt2 have the same
2-power residue for the prime p:
 vp (y) âˆ’vp (x) 2 
 (vp (y)+1)/2 (1âˆ’vp (x))/2 2 
x
y
xyt
(x
y
t)
=
= 1.
p
p
2
2

If |Fp | is 1 modulo 4, then âˆ’1 is a square in Fp . From the formula for the Hilbert symbol, we
must have that xvp (y) /y vp (x) is not a square in the residue field of p, and hence neither is âˆ’xyt2 .
19

If |Fp | is 3 mod 4, then considering the formula for (x, y)p again, we have (âˆ’1)(|Fp |âˆ’1)/2 = âˆ’1
and thus (x, y)p = âˆ’1 implies xyt2 is a square modulo p. But since âˆ’1 is not a square modulo
p, this implies xyt2 is not a square modulo p, and hence âˆ’xy âˆˆ a Â· K Ã—2 Â· (1 + pOp ).
Conversely, if x âˆˆ p Â· K Ã—2 Â· OpÃ— , then vp (x) is odd. If y âˆˆ s Â· K Ã—2 Â· (1 + pOp ), then for some
t âˆˆ K Ã— , yt2 is a p-adic unit and is a non-square modulo p. If âˆ’xy âˆˆ s Â· K Ã—2 Â· (1 + pOp ),
then, possibly after multiplying by a square of K Ã— , âˆ’xy is a p-adic unit and is a non-square
modulo p. Hence (x, âˆ’xy)p = âˆ’1. Since (x, âˆ’x)p = 1,
(x, y)p = (x, âˆ’xy)p = âˆ’1.

Theorem 4.5. Let p be a finite or real infinite prime of K. The set {(x, y) âˆˆ K Ã— Ã— K Ã— :
(x, y)p = âˆ’1} is diophantine over K.
Proof. First assume p corresponds to a real archimedean absolute value on K. Let Ï‰ : K Ö’â†’ R
be the corresponding embedding of K into Kp = R. Then (x, y)p = âˆ’1 if and only if the
equation xs2 + yt2 = 1 has no solutions in R Ã— R, which holds if and only if Ï‰(x) < 0 and
Ï‰(y) < 0. These conditions are diophantine by Lemma 4.1.
Now suppose p is a finite prime of K. If |Fp | is odd, the lemma follows from Lemma 4.4
since all the sets appearing are diophantine over K. Since our statements are only for global
fields K with char(K) 6= 2, the only remaining case is that K is a number field and p|2.
First we show that there are only finitely many elements in KpÃ— /KpÃ—2 . Let Ï€ be a uniformizer for pÌ‚ and let e be the absolute ramification index, meaning (Ï€)e = (2). Then if
Î± âˆˆ RpÃ— is in 1 + pÌ‚2e+1 , it is a square in RpÃ— by Henselâ€™s Lemma. We conclude that RpÃ—2 is
open in the profinite group RpÃ— since it contains 1 + pÌ‚2e+1 , a neighborhood of 1. As open
subgroups of compact groups have finite index, we conclude that RpÃ—2 has finite index in RpÃ— .
To see that [KpÃ— : KpÃ—2 ] is finite, we now just need to observe that squares of KpÃ— are of the
form s Â· Ï€ 2k where s âˆˆ RpÃ—2 .
Let s1 , . . . , sn âˆˆ K be a set of representatives for KpÃ— /KpÃ—2 and define Sj := sj Â· K Ã—2 Â· (1 +
p2e+1 Op ). For x âˆˆ Si , y âˆˆ Sj we have (x, y)p = (si , sj )p .
Now we define
[
Sp :=
Si Ã— Sj .
i,j:(si ,sj )p =âˆ’1

Then (x, y)p = âˆ’1 if and only if (x, y) âˆˆ Sp . Each set Si is diophantine over K, and the finite
Cartesian product of diophantine sets is again diophantine. Thus Sp is diophantine over K.

Now we prove Theorem 1.3 for a global field K with char(K) 6= 2.

âˆš
Proof of Theorem 1.3. By the Hasse norm principle, x is not a norm in K( y) if and
only if (x, y)
= âˆ’1 for some finite or real infinite prime p of K. For Ïƒ 6= (1, 1) âˆˆ
âˆš âˆšp
Gal(K( a, b)/K), let sÏƒ = a if Ïƒ = (âˆ’1, Â±1) and sÏƒ = b if Ïƒ = (1, âˆ’1). We claim
that (x, y)p = âˆ’1 if and only if one of the following conditions holds:
â€¢ âˆƒ p|m such that (x, y)p = âˆ’1,

20

â€¢

W

Ïƒ6=(1,1)

âˆƒp âˆˆ Î¦Ïƒ such that
(x âˆˆ p Â· K Ã—2 Â· (RpÏƒ )Ã— ) âˆ§ (y or âˆ’ xy âˆˆ sÏƒ Â· K Ã—2 Â· (1 + J(RpÏƒ )))




âˆ¨ (y âˆˆ p Â· K Ã—2 Â· (RpÏƒ )Ã— ) âˆ§ (x or âˆ’ xy âˆˆ sÏƒ Â· K Ã—2 Â· (1 + J(RpÏƒ ))) ,
(1,1)

â€¢ âˆƒ(p, q) âˆˆ Î¨K such that q âˆˆ (Rp,q )Ã— and

(1,1) Ã—
(1,1)
(x âˆˆ p Â· K Ã—2 Â· (Rp,q
) ) âˆ§ (y or âˆ’ xy âˆˆ q Â· K Ã—2 Â· (1 + J(Rp,q
)))




(1,1) Ã—
(1,1)
âˆ¨ (y âˆˆ p Â· K Ã—2 Â· (Rp,q
) ) âˆ§ (x or âˆ’ xy âˆˆ q Â· K Ã—2 Â· (1 + J(Rp,q
))) .

This will imply the theorem, because we have already shown that the above conditions
define diophantine sets. We will first prove the forward implication. If x is not a norm in
âˆš
K( y), there is a prime p of K such that (x, y)p = âˆ’1. If p|m we are done; recall that m
contains all real infinite primes if K is a number field.
Now assume p âˆˆ Im and that ÏˆL/K (p) = Ïƒ 6= (1, 1). We claim that the second condition
holds. We can find p âˆˆ Î¦Ïƒ such that PÏƒ (p) = {p} as before. Corollary 3.11 and the definition
of RpÏƒ imply RpÏƒ = Op and J(RpÏƒ ) = pOp . By setting p := p and s := sÏƒ , Lemma 4.4 implies
that the second condition holds because vp (p) is odd and sÏƒ , by construction, is a p-adic unit
which is not a square modulo p. For example, if Ïƒ = (1, âˆ’1), then sÏƒ = b. The fractional
ideal (b) is coprime to m, and ÏˆL/K (p) = (1, âˆ’1) implies that b is not a square mod p.
Now assume p âˆˆ Im with ÏˆL/K (p) = (1, 1). We claim that the third condition holds in this
case. We will first show that we can find (p, q) âˆˆ Î¨K with the stated properties if K is a global
function field. By Lemma 3.17, there is a (p, q) âˆˆ Î¨K with âˆ†ap,q âˆ© âˆ†bp,q = {p}. In fact, q can
be chosen so that vp (q) = 0, q is not a square modulo p, and such that P(q) = {q, p0 }. Here, q
(1,1)
and p0 are primes with ÏˆL/K (q) = (âˆ’1, âˆ’1) and ÏˆL/K (p0 ) = (1, 1). Then q âˆˆ OpÃ— = (Rp,q )Ã—
by Definition 3.12. By the formula for the Hilbert symbol, vp (ap) is odd, and since p cannot
(1,1)
(1,1)
divide (a), we conclude vp (p) is odd. As Rp,q = Op and J(Rp,q ) = pOp , we can apply
Lemma 4.4 with s := q.
If K is a number field, then by Lemma 3.25 in [Par13], we can find (p, q) âˆˆ Î¨K such
that (q) is a prime ideal with ÏˆL/K ((q)) = (âˆ’1, âˆ’1), q is not a square in Kp , and such that
âˆ†ap,q âˆ© âˆ†bp,q = {p}. A similar argument as above shows that the second condition holds.
Now we will prove that if one of the three conditions above holds, then for some prime
p, (x, y)p = âˆ’1. Suppose the second condition holds for some Ïƒ 6= (1, 1). If K is a global
function field, PÏƒ (p) 6= âˆ… by Lemma 3.14 (2), so PÏƒ (p) contains some prime p. Assume,
without loss of generality, that

(x âˆˆ p Â· K Ã—2 Â· (RpÏƒ )Ã— ) âˆ§ (y or âˆ’ xy âˆˆ sÏƒ Â· K Ã—2 Â· (1 + J(RpÏƒ ))) .

Since vp (p) is odd, vp (x) is odd, too. Also, either y or âˆ’xy is, possibly after multiplying by
a square of K Ã— , a non-square in Kp since ÏˆL/K (p) = Ïƒ implies sÏƒ is a non-square in Kp . By
Lemma 4.4, this implies that (x, y)p = âˆ’1. If K is a number field, an application of Lemma
3.22 (b) in [Par13] and a similar argument show that (x, y)p = âˆ’1 for a finite prime p of K.
We now prove that the third condition implies that (x, y)p = âˆ’1 for some p with ÏˆL/K (p) =
(1, 1). The argument is similar to the one in the second condition. If K is a global function
field, (p, q) âˆˆ Î¨K implies that âˆ†ap,q âˆ© âˆ†bp,q 6= âˆ… and contains some prime p by Lemma 3.17
part (2). Then because q âˆˆ (Rp,q )Ã— and (ap, q)p = (bp, q)p = âˆ’1, q is not a square mod p and
21

vp (p) must be odd. Again by Lemma 4.4, this implies that (x, y)p = âˆ’1. If K is a number
field, the same argument, along with Lemma 3.25 (b) from [Par13], proves the claim.

Acknowledgments
The first author was partially supported by National Science Foundation grant DMS1056703. The second author was partially supported by National Science Foundation grants
DMS-1056703 and CNS-1617802.
References
[AT68]
E. Artin and J. Tate. Class field theory. W. A. Benjamin, Inc., New York-Amsterdam, 1968.
[CTVG15] Jean-Louis Colliot-TheÌleÌ€ne and Jan Van Geel. Le compleÌmentaire des puissances n-ieÌ€mes dans
un corps de nombres est un ensemble diophantien. Compos. Math., 151(10):1965â€“1980, 2015.
[Den79]
J. Denef. The Diophantine problem for polynomial rings of positive characteristic. In Logic Colloquium â€™78 (Mons, 1978), volume 97 of Stud. Logic Foundations Math., pages 131â€“145. NorthHolland, Amsterdam-New York, 1979.
[Den80]
J. Denef. Diophantine sets over algebraic integer rings. II. Trans. Amer. Math. Soc., 257(1):227â€“
236, 1980.
[Dit16]
P. Dittmann. Irreducibility of Polynomials over Number Fields is Diophantine. arXiv:1601.07829,
2016. Preprint.
[DPR61] Martin Davis, Hilary Putnam, and Julia Robinson. The decision problem for exponential diophantine equations. Ann. of Math. (2), 74:425â€“436, 1961.
[Eis03]
Kirsten EisentraÌˆger. Hilbertâ€™s Tenth Problem for algebraic function fields of characteristic 2.
Pacific J. Math., 210(2):261â€“281, 2003.
[Koe16]
Jochen Koenigsmann. Defining Z in Q. Ann. of Math. (2), 183(1):73â€“93, 2016.
[Mat70]
Yu. V. Matiyasevich. The Diophantineness of enumerable sets. Dokl. Akad. Nauk SSSR, 191:279â€“
282, 1970.
[Maz92]
Barry Mazur. The topology of rational points. Experiment. Math., 1(1):35â€“45, 1992.
[Mil06]
J.S. Milne. Arithmetic Duality Theorems. BookSurge, LLC, second edition, 2006.
[Par13]
Jennifer Park. A universal first-order formula defining the ring of integers in a number field.
Math. Res. Lett., 20(5):961â€“980, 2013.
[Phe91]
Thanases Pheidas. Hilbertâ€™s tenth problem for fields of rational functions over finite fields. Invent.
Math., 103(1):1â€“8, 1991.
[Poo09a] Bjorn Poonen. Characterizing integers among rational numbers with a universal-existential formula. Amer. J. Math., 131(3):675â€“682, 2009.
[Poo09b] Bjorn Poonen. The set of nonsquares in a number field is Diophantine. Math. Res. Lett.,
16(1):165â€“170, 2009.
[Rob49]
Julia Robinson. Definability and decision problems in arithmetic. J. Symbolic Logic, 14:98â€“114,
1949.
[Ros87]
Michael Rosen. The Hilbert class field in function fields. Exposition. Math., 5(4):365â€“378, 1987.
[Ros02]
Michael Rosen. Number theory in function fields, volume 210 of Graduate Texts in Mathematics.
Springer-Verlag, New York, 2002.
[Rum80] R. S. Rumely. Undecidability and definability for the theory of global fields. Trans. Amer. Math.
Soc., 262(1):195â€“217, 1980.
[Ser79]
Jean Pierre Serre. Local Fields. Springer-Verlag New York, Inc, New York, 1979.
[SH36]
O. Schilling and H. Hasse. Die Normen aus einer normalen Divisionsalgebra uÌˆber einem algebraischen ZahlkoÌˆrper. J. Reine Angew. Math., 174:248â€“252, 1936.
[Shl94]
Alexandra Shlapentokh. Diophantine classes of holomorphy rings of global fields. J. Algebra,
169(1):139â€“175, 1994.
[Shl96]
Alexandra Shlapentokh. Diophantine undecidability over algebraic function fields over finite fields
of constants. J. Number Theory, 58(2):317â€“342, 1996.
22

[Shl15]
[Tat67]
[Vid94]

Alexandra Shlapentokh. On definitions of polynomials over function fields of positive characteristic. arXiv:1502.02714, 2015. Preprint.
J. T. Tate. Global class field theory. In Algebraic Number Theory (Proc. Instructional Conf.,
Brighton, 1965), pages 162â€“203. Thompson, Washington, D.C., 1967.
Carlos R. Videla. Hilbertâ€™s tenth problem for rational function fields in characteristic 2. Proc.
Amer. Math. Soc., 120(1):249â€“253, 1994.

Department of Mathematics, The Pennsylvania State University, University, Park, PA
16802, USA
E-mail address: eisentra@math.psu.edu
URL: http://www.personal.psu.edu/kxe8/
Department of Mathematics, The Pennsylvania State University, University, Park, PA
16802, USA
E-mail address: txm950@psu.edu
URL: http://www.personal.psu.edu/txm950/

23

