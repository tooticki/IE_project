arXiv:1806.10737v2 [math.NT] 17 Aug 2018

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

Paul Vojta
University of California, Berkeley
16 August 2018
Abstract. Roth’s theorem is extended to finitely generated field extensions of Q , using
Moriwaki’s framework for heights.

Recent work of Rastegar [2015pre] has made it apparent that it would be useful
to prove a version of Roth’s theorem for fields K finitely generated over Q , using
Moriwaki’s framework for defining heights on K .
Recall that in the “usual” diophantine theory of function fields, the function field
in question is the function field K of a projective variety B over a ground field F .
Often F is taken to be algebraically closed; hence, following Moriwaki ([2004], § 1),
we refer to such function fields as geometric function fields. When dim B > 1 , it is
necessary to choose a projective embedding of B , in order to determine degrees of
the prime divisors on B to be used in the product formula. When the ground field
is infinite, there may be infinitely many elements of K whose height is below a fixed
bound. It is true, however, that a set of such elements can belong to only a finite
number of algebraic families. A similar principle applies also to Northcott’s finiteness
theorem (for algebraic points on a projective variety, rational over a field of bounded
degree over K and of bounded height relative to an ample divisor).
Moriwaki ([2004], § 2) refers to fields finitely generated over Q as arithmetic function fields. They have this name because they have features of both function fields
and number fields. An arithmetic function field K arises as the function field of an
arithmetic variety; i.e., an integral scheme B , flat and projective over Spec Z . As
is the case for geometric function fields, when dim B > 1 it is necessary to choose
metrized line sheaves on B in order to determine weights for the prime divisors on B .
Unlike the case of geometric function fields, though, not all places are non-archimedean;
in fact, if dim B > 1 then there are uncountably many archimedean places. (When
dim B = 1 , one recovers the classical case of number fields.) Regardless of dim B ,
though, Northcott’s finiteness theorem gives actual finiteness.
1991 Mathematics Subject Classification. 11J68 (Primary); 14G40, 11J97 (Secondary).
Key words and phrases. Diophantine approximation, Arithmetic function field, Roth’s theorem.

1

2

PAUL VOJTA

Already some fundamental theorems over number fields are known to extend to
arithmetic function fields. Examples include Mordell’s conjecture ([Lang 1991], Ch. I,
Cor. 2.2)1 and the Mordell–Weil theorem ([Lang 1991], Ch. I, Cor. 4.3). In fact,
Lang’s early conjectures on “Mordellicity” were phrased in terms of rational points
over subfields of C finitely generated over Q (i.e., arithmetic function fields). He
felt that such fields were a more natural setting for diophantine geometry. Lang also
conjectured that results on integral points should extend to integral points over entire
rings finitely generated over Z . See [Lang 1974] and [Lang 1986]. A weaker version
of the Dirichlet unit theorem is also true (it gives only an inequality for the rank, since
finiteness of the class group does not hold for arithmetic function fields). One can then
extend the Mordell–Weil theorem to include integral points on semiabelian varieties
over arithmetic function fields. This is done in the usual way.
The above conjectures and theorems were restricted to statements about rational
points and integral points, since a theory of heights over arithmetic function fields was
not known until work of Moriwaki [2000]. With this development, it is becoming clear
that diophantine approximation statements should also extend to arithmetic function
fields.
This paper provides a first step in this direction, by extending Roth’s theorem
to arithmetic function fields. One also expects that, for example, Schmidt’s Subspace
Theorem and possibly the Masser–Oesterlé abc conjecture should also extend to arithmetic function fields. (A proof of the abc conjecture has been proposed by Mochizuki,
but it has not attained wide acceptance yet.) In addition, Conjectures 15.6, 23.4, 25.1,
25.3, 26.1, and 30.1 of [Vojta 2011] should also hold over arithmetic function fields.
We recall the statement of Roth’s theorem [Roth 1955], as generalized by LeVeque ([1956], Thm. 4-15), Ridout [1958], and Lang [1962] (Lang’s work included
also geometric function fields).
Theorem 0.1. Let k be a number field, and let S be a finite set of places of k . For
each v ∈ S let αv be algebraic over k , and assume that v is extended to k in
some way. Then, for all ǫ > 0 , the set of ξ ∈ k satisfying the approximation
condition
Y

(0.1.1)

v∈S

min{1, kξ − αv kv } ≤

1
hk (ξ)2+ǫ

is finite.
One can extend this statement to arithmetic function fields in a straightforward
way, and the resulting theorem is true, provided one imposes the condition that the
set of all αv is finite, as v varies over S (which is now in general uncountable). See
Theorem 4.6. (Theorem 4.6 is actually stronger than the above—see Remark 4.7.) The
version proved here is sufficiently strong to imply Siegel’s theorem on integral points
(Corollary 4.11).
1 Lang

apparently forgot to state the necessary assumption that X has genus ≥ 2 .

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

3

Actually, we give four equivalent formulations of Roth’s theorem over arithmetic
function fields (Theorems 4.3–4.6), and show in Proposition 4.8 that they are equivalent.
Sections 5–10 contain a proof of Theorem 4.5, and then Proposition 4.8 implies that
the other three variants also hold.
The main difficulty in generalizing Roth’s theorem to arithmetic function fields
concerns the part of the proof often referred to as “reduction to simultaneous approximation.” In that part, it is shown that it suffices to prove the theorem with the approx′
imation condition (0.1.1) replaced by conditions min{1, kξ − αv kv } ≤ hk (ξ)−λv (2+ǫ )
for each v , where 0 < ǫ′ < ǫ , and for each v ∈ S a constant λv ≥ 0 is given such that
P
v∈S λv = 1 .
In addressing this difficulty, a key idea came from a proof of Wirsing [1971]. Wirsing extended Roth’s theorem to approximation by rational numbers of bounded degree.
In his proof the number of archimedean places was still finite, but it grew exponentially
with the number of solutions to (his equivalent of) (0.1.1) under consideration. The
idea was to ignore a small proportion of those places, and this is also done here. See
the introduction to Section 6 for more details on this.
The paper is organized as follows. Section 1 summarizes the basic results and
conventions from number theory, algebraic geometry, and Arakelov theory used in the
paper. Section 2 describes the positivity properties of metrized line sheaves that are
needed in the paper. Section 3 introduces Moriwaki’s theory of heights for arithmetic
function fields, and describes how this theory can be extended to give a theory of
Weil functions (often called local heights). Thus, one can decompose the height into
proximity and counting functions, as in Nevanlinna theory [Vojta 2011]. In Section 4,
the main theorem of the paper is formally stated, in four different forms, and the four
are shown to be equivalent. Section 5 begins the main line of the proof of the theorem,
by showing that it suffices to prove the theorem under some additional assumptions.
Sections 6–8 give the proof of reduction to simultaneous approximation for arithmetic function fields; this is the technical core of the paper. Mostly this focuses on the
archimedean places, and involves analysis of Green functions. More details are given in
the introduction to Section 6. Sections 9 and 10 then conclude the proof by formulating and proving Siegel’s lemma for arithmetic function fields, constructing the auxiliary
polynomial, and deriving a contradiction to conclude the proof. For the latter, we use
a version of Dyson’s lemma [Dyson 1947] due to Esnault and Viehweg [1984] instead
of Roth’s lemma, since the former is true for arbitrary fields of characteristic zero, and
therefore needs no adaptation for arithmetic function fields.
I thank the Vietnam Institute for Advanced Study in Mathematics (VIASM) for
their kind hospitality during a brief stay while part of the work for this paper took
place. I also thank Xinyi Yuan for helpful discussions.
§1. Basic Notation and Conventions
In this paper, N = {0, 1, 2, . . . } and Z>0 = {1, 2, 3, . . . } . Also,
log+ x = log max{1, x}

and

log− x = log min{1, x} .

4

PAUL VOJTA

Throughout this paper, the notation c1 always refers to either a Chern form or
a Chern class. The letter c with any other subscript refers to a constant—and this
includes, for example, ci when i = 1 . Higher Chern classes do not occur in this paper.
Algebraic geometry
A variety over a field k is an integral separated scheme of finite type over k , and a
curve over k is a variety over k of dimension 1 . A line sheaf is an invertible sheaf.
For a point x on a scheme X , κ(x) denotes the residue field of x . If X is a variety
or integral scheme, then κ(X) denotes its function field (this equals the residue field
κ(ξ) for the generic point ξ of X ).
For more details on these conventions, see [Vojta 2011].
Number theory
For a number field k , the subring Ok is its ring of integers (the integral closure of
Z in k ). The set Mk is the set of all places of k ; this is the disjoint union of the
sets of archimedean and non-archimedean places of k . These are in canonical bijection
with the set of injections k ֒→ C and with the set of nonzero prime ideals in Ok ,
respectively.
For each place v ∈ Mk we define an absolute value k · kv , as follows:
kxkv =



|σ(x)|

if v is archimedean and corresponds to σ : k ֒→ R;
− ordp (x)

(Ok : p)

if v is non-archimedean and corresponds to p ⊆ Ok .

(In the non-archimedean case, the formula assumes x 6= 0 ; of course k0kv = 0 for all
v .) Note that two non-real complex conjugate embeddings σ, σ : k ֒→ C are regarded
as different places but give rise to the same absolute value. This is the usual convention
in Arakelov theory. These absolute values satisfy the product formula
(1.1)

Y

v∈Mk

kxkv = 1

for all x ∈ k∗ .

Heights are always taken to be logarithmic but not absolute. The reason for the
latter is that, for a general function field K (either arithmetic or geometric) there is no
canonical choice of “base field” to play the role of Q , for which K is a finite extension
(other than K itself).
As a specific example, the height of a point P ∈ Pn (k) with homogeneous coordinates [x0 : x1 : · · · : xn ] is
hk (P ) =

X

v∈Mk

log max{kx0 kv , . . . , kxn kv } .

For more information on the basic properties of heights, see ([Hindry and Silverman
2000], Part B) or ([Lang 1983], Ch. 4).

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

5

Complex Analytic Spaces
A complex analytic space, or just complex space, is as defined in ([Hartshorne 1977],
App. B). Examples include X an , where X is a reduced quasi-projective scheme over
C (note that X may be reducible, and may have singularities); and the unit discs
D := {z ∈ C : |z| < 1}

and

Dd := {z ∈ Cd : |z| < 1}

in C and Cd ( d ∈ Z>0 ), respectively.
In this paper, complex spaces are always assumed to be Hausdorff and reduced.
This paper generally follows the definitions of Zhang [1995].
For the rest of this subsection, let T be a complex space.
A function f : T → R is smooth if for any holomorphic map φ : Dd → T , the
composite function f ◦ φ is smooth (i.e., C ∞ ). Smoothness of differential forms is
defined similarly.
Let L be a line sheaf on T . Then a smooth hermitian metric or continuous
hermitian metric on L is defined as usual in Arakelov theory, with the metric varying
smoothly or continuously, respectively. A smoothly metrized line sheaf or continuously
metrized line sheaf L on T is a pair (Lfin , k · kL ) , consisting of a line sheaf Lfin on
T , together with a smooth or continuous hermitian metric k·kL on Lfin , respectively.
Most hermitian metrics in this paper are assumed to be smooth. Here the subscript
“fin” means finite, and is used to refer to the underlying non-metrized line sheaf (this
terminology will make more sense when we get to Arakelov theory). We do not use
bars to denote metrized line sheaves: an object L is what it was said to be. This is
because metrized line sheaves are the most natural objects to consider when working in
Arakelov theory. For the remainder of this paper, all line sheaves on complex analytic
spaces written using notation not involving a subscript “fin” are metrized.
The subscript L on k·kL may be omitted if L should be clear from the context.
Let L be a continuously metrized line sheaf on T . Then a section of L over an
open subset U of T is a section of Lfin over U . A global section s of L is small
(resp. strictly small) if ksk ≤ 1 (resp. ksk < 1 ) everywhere on T .
If L is a smoothly metrized line sheaf on a complex manifold M , then it has a
Chern form c1 (k·kL ) (well-)defined by the condition that c1 (k·kL )U = −ddc log ksk2
for all open U ⊆ M and all nowhere-vanishing sections s of L over U . Note that if
L is a smoothly metrized line sheaf on a reduced complex space T , then it may not
be possible to define a Chern form c1 (k · kL ) at singular points of T .
For n ∈ Z>0 , the line sheaf O(1) on Pn (C) can be smoothly metrized by the
standard metric, also called the Fubini–Study metric. It is defined uniquely by the
condition that, for all global sections s = a0 z0 + · · · + an zn , where z0 , . . . , zn are
homogeneous coordinates on Pn (C) ,
(1.2)

|a0 p0 + · · · + an pn |
.
ksk(p0 : · · · : pn ) = p
|p0 |2 + · · · + |pn |2

6

PAUL VOJTA

When n = 1 , the Chern form of this metric is
√
−1
1
ddc |z|2
c1 (k · k) =
dz
∧
dz̄
=
.
2π (1 + |z|2 )2
(1 + |z|2 )2
Recall that a form on a complex manifold M is real if it can be written as a form
with real coefficients when M is regarded as a manifold over R . For a (1, 1)-form ω
on M , written as
√ X
(1.3)
ω = −1
hij (z)dzi ∧ dz j ,
i,j

this is equivalent to (hij (z)) being a Hermitian matrix for all holomorphic local coordinate systems (z1 , . . . , zn ) and all z . Following Moriwaki ([2014], §§ 1.12 and 1.14),
this form is positive (resp. semipositive) if it is real and if (hij (z)) is positive definite
(resp. positive semidefinite) for all z . A (1, 1)-form on a complex projective variety is
semipositive if its pull-back to a desingularization is semipositive.
Likewise, an (n, n)-form θ on a complex manifold M , written in local coordinates
as
(1.4)

θ = ρ(z)ddc |z1 |2 ∧ · · · ∧ ddc |zn |2 ,

is real if and only if ρ(z) ∈ R for all z , and is positive (resp. semipositive) if it is real
and ρ(z) > 0 (resp. ρ(z) ≥ 0 ) for all z .

Proposition 1.5. Positivity of forms as in (1.3) and (1.4) are related as follows.
(a). Let M be a complex manifold of dimension n , and let ω1 , . . . , ωn be positive
(resp. semipositive) (1, 1)-forms on M . Then ω1 ∧ · · · ∧ ωn is positive (resp.
semipositive).
(b). Let X be a complex projective variety of dimension n , and let ω1 , . . . , ωn
be semipositive (1, 1)-forms on X . Then ω1 ∧ · · · ∧ ωn is also semipositive.

Proof. See ([Lang 1987], Ch. IV, Lemma 2.4). For the convenience of the reader, we
provide more details here.
It will suffice to prove part (a), since (b) follows by passing to a desingularization.
First assume that ω1 , . . . , ωn are positive. We will use induction on n . The n = 1
case is trivial. Fix a point p ∈ M , and let (z1 , . . . , zn ) be a local coordinate system
on M near p . We may assume that p corresponds to z1 = · · · = zn = 0 . Write
√ X
ω1 = −1
hij (z)dzi ∧ dz j .
i,j

By Gram–Schmidt, we may assume that (hij (0)) is a diagonal matrix. Since ω1 is
positive, the diagonal entries λ1 , . . . , λn of this matrix are real and positive. For all
i = 1, . . . , n and all j > 1 , ωj z =0 is positive, so if we write
i

ω2 ∧ · · · ∧ ωn zi =0 = ρi (z)ddc |z1 |2 ∧ · · · ∧ (ddc |zi |2 )b∧ · · · ∧ ddc |zn |2

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

7

for all i , then by induction ρi (0) isP
real and positive. Let θ = ω1 ∧ · · · ∧ ωn and let ρ
be as in (1.4). Then ρ(0) = (2π)−1 λi ρi (0) > 0 , so θ is positive.
The argument for the semipositive case is similar.

Arakelov theory
An arithmetic variety is an integral scheme, flat and projective over Spec Z .
All arithmetic varieties in this paper will be assumed to be normal.
Let X be an arithmetic variety. Let K = κ(X) ; this is a finitely generated
extension field of Q . We also write XQ = X ×Z Q . The set X(C) will often be
regarded as a complex space (with the classical topology).
We say that X is generically smooth if XQ is smooth over Q . If X is generically
smooth, then X(C) is a complex manifold (not necessarily connected). If X is an
(arbitrary) arithmetic variety, then a generic resolution of singularities of X is a proper
birational morphism π : Y → X , where Y is a generically smooth arithmetic variety.
A smoothly metrized line sheaf L on X is a pair (Lfin , k · kL ) consisting of
a line sheaf Lfin on X and a smooth hermitian metric k · kL on (Lfin )C , where
(Lfin )C is the pull-back of Lfin to X(C) . A continuously metrized line sheaf on X is
defined similarly. In both cases, we will always assume that the hermitian metric is of
real type; i.e., that it is invariant under the complex conjugation map F∞ on X(C) ;
see ([Moriwaki 2014], (5.2)).
As discussed earlier, metrized line sheaves are not denoted using bars. In this
paper, all line sheaves on arithmetic varieties written using notation not involving a
subscript “fin” are metrized.
If L = (Lfin , k · kL ) is a smoothly or continuously metrized line sheaf on X ,
then LC will denote the smoothly or continuously metrized line sheaf ((Lfin )C , k · kL )
on X(C) , respectively. We also let LQ denote the (non-metrized) line sheaf (Lfin )Q
on XQ obtained by restriction.
A section of L over an open subset U of X is a section of Lfin over U . A
global section s of L is small (resp. strictly small) if the corresponding section of LC
is small (resp. strictly small).
If L is a smoothly metrized line sheaf on X , then its Chern form is the form
c1 (k · kL ) ; it is a smooth (1, 1)-form on X(C) and is again denoted c1 (k · kL ) . If
L is a line sheaf (resp. smoothly metrized line sheaf) on a scheme (resp. arithmetic
variety) X , then c1 (L ) will denote the first Chern class (resp. arithmetic first Chern
class) of L ; it is a cycle (resp. Arakelov cycle) of codimension 1 on X . In particular,
if L is a smoothly metrized line sheaf on an arithmetic variety X , then c1 (LQ ) is an
(ordinary, i.e., non-Arakelov) cycle of codimension 1 on XQ .
In order to simplify the notation, we will often omit deg(·) , even though the
product of a number of Chern classes is technically a 0-cycle, not a number. It will
always be the intersection number that is meant.
Finally, if L is a smoothly metrized line sheaf on X then we recall that the height

8

PAUL VOJTA

function hL : X(Q) → R is defined by
(1.6)


c1 (L x )
,
hL (x) =
[κ(x) : Q]

where x ∈ X(Q) and x is its closure in X . This is an absolute height.
Arithmetic Intersection Theory of Cartier Divisors
At the present time, a theory of resolution of singularities on arithmetic varieties is not
available, so the arithmetic intersection theory of [Gillet and Soulé 1990] or [Soulé
1992] cannot be used. Instead (as is common), we follow Faltings ([1992], Lect. 1) and
note that one has an intersection theory of arithmetic Cartier divisors on a generically
smooth arithmetic variety, and this can be extended to an arbitrary arithmetic variety
by pulling back to a generic resolution of singularities.
(For generically smooth arithmetic varieties, however, the results of ([Gillet and
Soulé 1990], § 1–2), on Green currents and Green forms, can be applied. In fact, they
play a key role in this paper.)
Here we follow ([Moriwaki 2014], § 5.4). A brief summary of his definitions
follows.
Let X be a generically smooth arithmetic variety. For p ∈ N , an arithmetic cycle
of codimension p on X is a pair Z = (Zfin , T ) , where Zfin is a cycle of codimension p
on X and T is a current on X(C) of type (p − 1, p − 1) . These form an abelian group
under componentwise addition, which is denoted ZpD (X) . Note that Z0D (X) = Z·(X, 0) .
bpD (X) , but the hat is redundant since the subscript “D”
(Moriwaki denotes this group Z
already implies that there is a component at infinity.)
∗
A (p − 1, p − 1)-current T on X(C) is said to be of real type if F∞
(T ) = (−1)p T .
Note that this is different from a current (or form) being real; i.e., T = T .
If Z is a cycle of codimension p on X , then we say that a Green current for Z
is a current T on X(C) of type (p − 1, p − 1) such that
ddc T + δZ = [ω]
for some smooth (p, p)-form ω on X . An arithmetic cycle Z = (Zfin , T ) ∈ ZpD (X) is
said to be of Green type if T is a Green current for Zfin . These cycles form a subgroup
of ZpD (X) .
d p (X) to be the subgroup of Zp (X) generated by (i) cycles
Moriwaki defines Rat
D
i∗ ((f )fin , − log kf k2 ) , where Y is an integral closed subscheme of X of codimension
p − 1 , i : Y → X is the corresponding closed embedding, and f is a nonzero rational
function on Y ; and (ii) (0, ∂A) and (0, ∂B) , where A and B are currents on X(C)
of type (p − 2, p − 1) and (p − 1, p − 2) , respectively. He then defines
p

d (X) .
CHpD (X) = ZpD (X)/Rat

bp (X) to
By way of comparison, Gillet and Soulé ([Soulé 1992], III 1.1) define Z
be the subgroup of ZpD (X) consisting of all pairs (Z, T ) of Green type such that T is

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

9

p

d (X) be the image of Z
bp (X) in CHp (X) . In this
real and of real type, and they let CH
D
paper, all currents under consideration come from (smoothly) metrized line sheaves, so
they are real and of real type, but not all pairs (Z, T ) ∈ ZpD (X) in this paper are of
Green type, since it is sometimes useful (e.g., in the proof of Lemma 1.11) to split up
(Z, T ) ∈ ZpD (X) into a sum (Z, 0) + (0, T ) .
At times it will be useful to consider intersections on integral closed subschemes
of an arithmetic scheme X , including those that are not flat over Spec Z . Therefore,
consider for now an integral scheme X , projective over Spec Z , which lies entirely
over a single closed point (p) ∈ Spec Z . Such schemes X will be said to be vertical.
Since XQ = ∅ , this scheme is always generically smooth. Similarly, since X(C) = ∅ , a
metrized line sheaf on X (defined as above) is just a pair L = (Lfin , ∅) , and the same
definitions as above give that ZpD (X) is the group of pairs (Zfin , 0) , where Zfin is a
cycle of codimension p on X in the classical (non-Arakelov) sense. Similarly, CHpD (X)
is canonically isomorphic to the classical Chow group CHp (X) .
Let X be an integral scheme, projective (but not necessarily flat) over Spec Z , and
generically smooth. Let L be a smoothly metrized line sheaf on X . By ([Moriwaki
2014], Def. 5.16, Thm. 5.20, and § 5.2), the formula

(1.7)
(Z, g) 7→ ((s)fin · Z, i∗ [− log ksZ k2 ] + c1 (k · kL ) ∧ g)

gives a well-defined group homomorphism CHpD (X) → CHp+1
D (X) , denoted c1 (L ) · ,
p
where (Z, g) ∈ ZD (X) is such that Z is a closed integral subscheme of X , i : Z → X is
the corresponding closed embedding, and s is a rational section of L whose restriction
to Z is nonzero. (If Z is vertical, then Z(C) = ∅ , and therefore i∗ [− log ksZ k2 ] = 0 .)
It is easy to check that (i) c1 (L ) · (X, 0) = c1 (L ) , where c1 (L ) on the right-hand
p
d (X) , then c1 (L ) · α
side is as defined earlier, and (ii) if X is regular and if α ∈ CH
as defined here coincides with the definition from ([Gillet and Soulé 1990], § 3) (or
with classical intersection theory if X is vertical).
Let X be an integral scheme, projective over Spec Z and generically smooth; let
n = dim X ; and let L1 , . . . , Ln be smoothly metrized line sheaves on X . Then we
have a well-defined element
c1 (L1 ) · · · c1 (Ln ) ∈ CHnD (X) .

Since this is a cycle of dimension 0 on X , we can take its degree ([Moriwaki 2014],
Def. 5.22) to get a real number, which will also (by the usual abuse of notation) be
denoted c1 (L1 ) · · · c1 (Ln ) . This degree is always taken in the Arakelov sense, even if
X is vertical.
The map c1 (L )· satisfies the following projection formula. Let X and Y be integral schemes, projective over Spec Z and generically smooth; let f : X → Y be a morphism; let L1 , . . . , Ln be smoothly metrized line sheaves on Y ; and let α ∈ CHpD (X) .
Then
(1.8)

f∗ (c1 (f ∗ L1 ) · · · c1 (f ∗ Ln ) · α) = c1 (L1 ) · · · c1 (Ln ) · f∗ α .

10

PAUL VOJTA

Indeed, when n = 1 this is ([Moriwaki 2014], Thm. 5.20 (2) and Prop. 5.5), and the
general case follows by induction. In particular, if f is birational and n = dim X ,
then (taking degrees) we have
(1.9)

c1 (f ∗ L1 ) · · · c1 (f ∗ Ln ) = c1 (f ∗ L1 ) · · · c1 (f ∗ Ln ) · (X, 0)
= c1 (L1 ) · · · c1 (Ln ) · (Y, 0)
= c1 (L1 ) · · · c1 (Ln ) .

By pulling back to a generic resolution of singularities and using (1.9), one can also
define this quantity without assuming that X is generically smooth; see ([Moriwaki
2014], Def. 5.24). With this definition, (1.9) holds without the assumption that X
and Y are generically smooth.
We conclude this section with a result which is implicit several places in Moriwaki’s
work, and obvious to the experts, but which seems not to be explicitly stated or proved
anywhere.
Definition 1.10. Let X be an arithmetic variety, and let M be a continuously metrized
line sheaf on X . Then, for any nonzero rational section s of M , we define
c1 (M ) = ((s)fin , − log ksk2 ) ∈ CH1D (X) .
This definition is independent of the choice of s , and is compatible with the definition of c1 (M ) ∈ CH1 (X) when the metric on M is smooth.
Lemma 1.11. Let X be a generically smooth arithmetic variety of dimension n . Let
L1 , . . . , Ln−1 be smoothly metrized line sheaves on X , let M be a continuously
metrized line sheaf on P
X , and let s be a nonzero rational section of M . Write
(s)fin as a finite sum
nZ Z , where nZ ∈ Z for all Z and each Z is a prime
divisor on X . Then
(1.11.1)
c1 (L1 ) · · · c1 (Ln−1 ) · c1 (M ) =

X

 
 
nZ c1 L1 Z · · · c1 Ln−1 Z
Z
log ksk c1 (k · kL1 ) ∧ · · · ∧ c1 (k · kLn−1 ) .
−
X(C)

Proof. Since both sides of (1.11.1) are linear in M (and correspondingly in nZ and
− log ksk ), we may assume that there is only one prime divisor Z , and that nZ = 1 .
Then c1 (M ) is represented by the cycle (Z, − log ksk2 ) , and we have
(1.11.2)
c1 (L1 ) · · · c1 (Ln−1 ) · c1 (M ) = c1 (L1 ) · · · c1 (Ln−1 ) · (Z, 0)

+ c1 (L1 ) · · · c1 (Ln−1 ) · (0, − log ksk2 ) .

We first consider the first term on the right-hand side.

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

11

Let Ze be a generic resolution of singularities of Z , and let f : Ze → X be the
corresponding map to X . By (1.8) and (1.9),
(1.11.3)
e 0)
c1 (L1 ) · · · c1 (Ln−1 ) · (Z, 0) = c1 (L1 ) · · · c1 (Ln−1 ) · f∗ (Z,

e 0)
= c1 (f ∗ (L1 )) · · · c1 (f ∗ (Ln−1 )) · (Z,

= c1 (f ∗ (L1 )) · · · c1 (f ∗ (Ln−1 ))
 
 
= c1 L1  · · · c1 Ln−1 
Z

Z

(where the last formula is computed on Z ).
Now consider the second term on the right-hand side of (1.11.2).
If g is a current of type (n − 1 − i, n − 1 − i) on X(C) , then by (1.7),
c1 (Li ) · (0, g) = (0, c1 (k · kLi ) ∧ g) ,
and therefore (taking the degree)
(1.11.4)
2

c1 (L1 ) · · · c1 (Ln−1 ) · (0, − log ksk ) = −

Z

X(C)

log ksk c1 (k · kL1 ) ∧ · · · ∧ c1 (k · kLn−1 ) .

Combining (1.11.2)–(1.11.4) then gives (1.11.1).



Proposition 1.12. Let X be an integral scheme of dimension n , projective over Spec Z .
(a). Let L1 , . . . , Ln be nef, smoothly metrized line sheaves on X , or
(b). let L1 , . . . , Ln−1 be nef, smoothly metrized line sheaves on X , and let Ln
be a continuously metrized line sheaf on X for which some positive tensor
power has a small nonzero global section.
Then
c1 (L1 ) · · · c1 (Ln ) ≥ 0 .
Proof. If X an arithmetic variety, then part (a) is ([Moriwaki 2000], Prop. 2.3 (1))
or ([Moriwaki 2014], Thm. 6.15). Otherwise, it is a standard result in algebraic
geometry.
Part (b) is ([Moriwaki 2000], Prop. 2.3 (2)). It follows from part (a) and Lemma
1.11.

§2. Positivity Conditions on Metrized Line Sheaves
This section defines the conditions nef, big, and ample for a smoothly metrized line
sheaf on an arithmetic variety, and gives some of their main properties.
References for this section are [Zhang 1995], [Yuan 2008], [Yuan 2009], and
[Moriwaki 2014].

12

PAUL VOJTA

Throughout this section, L is a smoothly metrized line sheaf on an arithmetic
variety X .
Nef Metrized Line Sheaves
Definition 2.1. ([Moriwaki 2014], Def. 5.38 (3))
(a). L is vertically nef if Lfin is nef on all closed fibers of X → Spec Z and if
the metric on L is semipositive, and
(b). L is nef if it is vertically nef and if hL (x) ≥ 0 for all x ∈ X(Q) .
Proposition 2.2. Let f : X ′ → X be a surjective generically finite morphism of arithmetic varieties. If L is nef, then so is f ∗ L .
Proof. This is clear from the definition.



Big Metrized Line Sheaves
The definition of a big metrized line sheaf given here is modeled after the definition of
big in the classical case.
Definition 2.3.
(a). Let H 0 (X, L ) denote the set of small sections of L :
H 0 (X, L ) = {s ∈ H 0 (X, Lfin ) : ksksup ≤ 1} ,
and let
h0 (X, L ) = log #H 0 (X, L ) .
(b). Let n = dim X . Then the volume of L is
vol(L ) = lim sup
m→∞

h0 (X, L ⊗m )
.
mn /n!

By ([Yuan 2009], § 1.1 and Thm. 2.7) (see also [Chen 2008pre]), this
lim sup converges as a limit.
(c). We say that L is big if vol(L ) > 0 .
Remark 2.4. Sometimes H 0 (X, L ) is defined to be the set of strictly small sections
of L , and this definition is used to define bigness. This definition of big (and several
others) are equivalent to Definition 2.3c, by ([Yuan 2008], Cor. 2.4) and ([Moriwaki
2009], Thm. 4.6).
Proposition 2.5. Let f : X ′ → X be a surjective generically finite morphism of arithmetic varieties. If L is big, then so is f ∗ L .
Proof. This is immediate from the fact that pulling back by f induces an injection
H 0 (X, L ) → H 0 (X ′ , f ∗ L ) .

Ample Metrized Line Sheaves
To define ampleness, we follow Yuan ([2008], Sect. 2.1).

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

13


Definition 2.6. We say that L is horizontally positive if c1 (L Y )· dim Y > 0 for all
horizontal integral closed subschemes Y of X . Here an integral subscheme Y of
X is horizontal if it is flat over Spec Z .
Definition 2.7. The smoothly metrized line sheaf L is ample if:
(i). LQ is ample;
(ii). L is vertically nef; and
(iii). L is horizontally positive.
Remark 2.8. Moriwaki defines ampleness differently. He defines L to be ample if (i)
Lfin is ample (on X ), (ii) the metric on L is positive, and (iii) there is some integer
⊗n
) is generated by strictly small sections ([Moriwaki
n > 0 such that H 0 (X, Lfin
2014], Def. 5.38 (2)). This definition is stronger than Definition 2.7. Indeed, (i) and
(ii) of Definition 2.7 follow from Moriwaki’s (i) and (ii), and horizontal positivity follows
from ([Moriwaki 2014], Prop. 5.39). The converse implication is false: for example, if
L is ample on X in the sense of Moriwaki, then its pull-back to the blowing-up of X
at a closed point is ample in the sense of Definition 2.7, but not in Moriwaki’s sense.
Proposition 2.9. If L is ample, then it is nef and big.
Proof. The fact that L is nef follows immediately by comparing Definitions 2.7 and
2.1. That L is big follows from ([Yuan 2008], Cor. 2.4)

An Openness Property
Because a metrized line sheaf is only required to be vertically nef in order to be ample,
arithmetical ampleness is not an open condition. However, it is true that arithmetical
ampleness is preserved under changing the metric by a constant multiple sufficiently
close to 1 , provided that the arithmetic variety is generically smooth. This is the
conclusion of Proposition 2.12, which is the goal of this subsection.
Note that the definition of ampleness is comparable to the Nakai-Moishezon criterion. This implies something comparable to the more common definition of ampleness
in the non-Arakelov setting ([Zhang 1995], Cor. 4.8).
We start with a result that may be regarded as a counterpart to the theorem in
classical algebraic geometry that says that the Nakai-Moishezon and Kleiman criteria
for ampleness are equivalent.
Lemma 2.10. Assume that X is generically smooth, that LQ is ample, and that the
metric on L is semipositive. Then L is horizontally positive if and only if the
height function hL has a positive lower bound on X .
Proof. This proof makes use of the condition that a smoothly metrized line sheaf be
relatively semiample. We will not quote the
 definition here (see ([Zhang 1995], (3.1)));
instead, it is sufficient to know that L Y is relatively semiample for all horizontal
integral closed subschemes Y of X ([Zhang 1995], Thm. 3.5).
This proof follows fairly easily from the equivalence (ii) ⇐⇒ (iii) of ([Zhang
1995], Cor. 5.7). This says the following. Let M be a smoothly metrized line sheaf on

14

PAUL VOJTA

an arithmetic variety Y . Assume that MQ is ample, that M is relatively semiample,
and that hM (y) ≥ 0 for all y ∈ Y (Q) . Then the following conditions are equivalent:
(ii) there is a nonempty Zariski-open subset U of Y such that hM has a positive
lower bound on U (i.e., on U (Q) ), and (iii) c1 (M )· dim Y > 0 .
We will apply this result with Y equal to a horizontal integral closed subscheme of
X and with M = L Y . In this situation, M is relatively semiample as noted above,
and MQ is ample because LQ is.
We first prove the converse assertion. Assume that hL has a positive lower bound

on X , let Y be a horizontal integral closed subscheme on X , and let M = L Y .
Then condition (ii) in Zhang’s lemma holds for Y and M with U = Y , and also
the hypothesis hM (y) ≥ 0 holds. Therefore, by (iii), c1 (M )· dim Y > 0 . Since Y is
arbitrary, L is horizontally positive.
Conversely, assume that L is horizontally positive. We will show by noetherian
induction that hL has a positive lower bound on Y (Q) for all Zariski-closed subsets
Y of X , and therefore it holds for X .
Let Y be a Zariski-closed subset of X . If Y = ∅ then there is nothing to show. If
Y is reducible, then write Y = Y1 ∪ · · · ∪ Yn with all Yi irreducible. By the inductive
hypothesis, hL has a positive lower bound on Yi for all i , so the same is true for Y .
Assume now that Y is irreducible. If Y is not horizontal, then Y (Q) is empty,
and there is nothing to prove. Otherwise, we apply the above result of Zhang. Note
that, since L is horizontally positive, the hypothesis that hM (y) ≥ 0 for all y ∈ Y (Q)
holds, and so does condition (iii) of Zhang’s corollary. Therefore, by condition (ii) of the
corollary, there is a nonempty open U ⊆ Y such that hL has a positive lower bound
on U . Also hL has a positive lower bound on Y \ U by the inductive hypothesis, so
hL has a positive lower bound on Y .
It follows by taking Y = X that hL has a positive lower bound on X .

Definition 2.11. For all a ∈ R let Va be the smoothly metrized line sheaf on X such
that (Va )fin is the structure sheaf of X and the constant section 1 of Va has
constant metric e−a . (Here V stands for vertical.)
We are now ready to prove the main result of this subsection.
Proposition 2.12. Assume that X is generically smooth and that L is ample. Then
there is a c > 0 such that L ⊗ V−ǫ is ample for all ǫ < c .

Proof. For all ǫ ∈ R , the properties (L ⊗ V−ǫ )Q ample and L ⊗ V−ǫ vertically nef
follow trivially from the same properties of L . Therefore it will suffice to find c > 0
such that L ⊗ V−ǫ is horizontally positive for all ǫ < c .
Let
c = inf hL (x) .
x∈X(Q)

By Lemma 2.10, c > 0 . Fix ǫ < c . We need to show that L ⊗ V−ǫ is horizontally
positive. To see this, we note that
hL ⊗V−ǫ (x) = hL (x) − ǫ

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

15

for all x ∈ X(Q) . Then hL ⊗V−ǫ has the positive lower bound c − ǫ , and therefore
L ⊗ V−ǫ is ample by Lemma 2.10.

§3. Arithmetic Function Fields
An arithmetic function field is a finitely generated extension field of Q . Such fields
have a diophantine theory that contains the number field case as a special case.
This theory was originally developed in [Moriwaki 2000]. See also the survey
article [Moriwaki 2004].
Polarizations, Places, and Heights
Definition 3.1. Let K be an arithmetic function field, and let d = tr. degQ K . Then a
polarization of K consists of
∼

(i). an arithmetic variety B , given with an isomorphism κ(B) → K , and
(ii). nef smoothly metrized line sheaves M1 , . . . Md on B .
Such a polarization will be denoted M = (B; M1 , . . . , Md ) . A polarization will be
said to be big if M1 , . . . , Md are all big.
We now define a set of places of K to replace the set Mk of places of a number
field k recalled in Section 1. This description follows ([Burgos Gil et al. 2016], § 1)
as well as [Moriwaki 2000].
We assume from now on that B is normal.
We start with the non-archimedean places. Let B (1) denote the set of prime (Weil)
divisors on B ; i.e., the set of integral closed subschemes of B of codimension 1 . (These
may be horizontal or vertical.)
Let Y be a prime divisor on B , and let
 
 
(3.2)
hM (Y ) = c1 M1 Y · · · c1 Md Y .
By Proposition 1.12a, hM (Y ) ≥ 0 . For nonzero x ∈ K , we then define a nonarchimedean absolute value associated to Y as
kxkY = exp(−hM (Y ) ordY (x)) .
(Note that if d = 0 then K is a number field k , Y is a closed point on Spec Ok , and
the intersection product (3.2) is just the cycle Y , whose degree is the logarithm of the
number of elements in the residue field. Therefore kxkY coincides with kxkv for the
place v ∈ Mk that corresponds to Y .)
0
The set B (1) will be the set of non-archimedean places of K . We write MK
= B (1)
(1)
0
and let µfin be the counting measure on B = MK .
For archimedean places, we define the set of generic points of B(C) as
[
B(C)gen = B(C) \
Y (C) .
Y ∈B (1)

16

PAUL VOJTA

For such a generic point b ∈ B(C)gen , we define an absolute value
kxkb = |x|b = |x(b)|
for all x ∈ K . Note that x(b) ∈ C , because b does not lie on a pole of the function
x : all such poles lie in elements of B (1) .
The set B(C)gen will be the set of archimedean places of K , and we will usually
∞
denote it MK
. In sharp contrast to the number field case, if d > 0 then there are
uncountably many archimedean places.
We let µ∞ be the Lebesgue measure on B(C) associated to the (d, d)-form
c1 (k · kM1 ) · · · c1 (k · kMd ) . This form is semipositive by Proposition 1.5b. The set
B(C) \ B(C)gen is a countable union of the sets Y (C) , all of which have measure zero,
so B(C) \ B(C)gen has measure zero. We also regard µ∞ as a measure on B(C)gen .
We then have
µ∞ (B(C)gen ) = c1 ((M1 )Q ) · · · c1 ((Md )Q ) < ∞ .

(3.3)

One can then let MK be the disjoint union
∞
0
MK = MK
∐ MK
= B(C)gen ∐ B (1) ,

and combine the measures µ∞ on B(C) and µfin on B (1) to give a measure µ on
B(C) ∐ B (1) ⊇ MK . As in ([Moriwaki 2000], Sect. 3.2), this then leads to a product
formula
Z
log kxkv dµ(v) = 0
for all x ∈ K ∗
(3.4)
MK

and a “naı̈ve height”
(3.5)
hK (x) =
=

Z

ZMK

log+ kxkv dµ(v)

B(C)gen

log+ |x(b)| dµ∞ (b) +

Y

X

∈B (1)

max{0, − ordY (x)}hM (Y )

for all x ∈ K ; here we take max{0, − ordY (x)} = 0 if x = 0 . Note that hK (x) ≥ 0
for all x ∈ K .
Remark 3.6. The set of archimedean places of K can be canonically identified with
the set of embeddings of K into C , in such a way that if an archimedean place v of
K corresponds to σ : K → C , then
(3.6.1)

kxkv = |σ(x)|

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

17

for all x ∈ K . So this is just like the number field case. The construction using
B(C)gen is necessary to define the measure.
To see this identification, recall from ([Hartshorne 1977], II Ex. 2.7) that giving
an element of B(C) is equivalent to giving a point P ∈ B and an injection κ(P ) ֒→ C .
The elements of B(C)gen are exactly those for which the point P is the generic point
of B . Thus B(C)gen is in natural bijection with Hom(K, C) , and (3.6.1) is true.
Definition 3.7. For all v ∈ MK we define a field extension Cv /K
archimedean, then let Cv = C , viewed as an extension of K
K ֒→ Cv of Remark 3.6. If v is non-archimedean, then we let
tion of the algebraic closure K v of the completion Kv of K
algebraically closed ([Bosch et al. 1984], Prop. 3.4.1/3).

as follows. If v is
by the embedding
Cv be the compleat v . This field is

Finite Extensions of Arithmetic Function Fields
Let K be an arithmetic function field of transcendence degree d over Q , and let K ′ be
a finite extension of K . Then K ′ is also an arithmetic function field of transcendence
degree d .
Definition 3.8. Let M = (B; M1 , . . . , Md ) be a polarization of K . We define a polarization M ′ of K ′ as follows. Let B ′ be the normalization of B in K ′ , and
let π : B ′ → B be the associated map. Then π is a finite morphism of degree
[K ′ : K] , and of course B ′ is normal. Let Mi′ = π ∗ Mi for all i ; these are nef
line sheaves on B ′ by Proposition 2.2. Thus M ′ := (B ′ ; M1′ , . . . , Md′ ) is a polarization of K ′ , and is called the polarization of K ′ induced by M , or the induced
polarization of K ′ if M is clear from the context.
The absolute values of K ′ are related to those of K as follows.
Definition 3.9. Let M , M ′ , and π : B ′ → B be as in Definition 3.8, let v ∈ MK , and
let w ∈ MK ′ . Then we say that w lies over v , and write w | v , if one of the
following holds:
(i). both w and v are archimedean, corresponding to b′ ∈ B ′ (C)gen and
b ∈ B(C)gen , respectively, and π(b′ ) = b ; or
(ii). both w and v are non-archimedean, corresponding to prime divisors Y ′ on
B ′ and Y on B , respectively, and π(Y ′ ) = Y .
As in ([Moriwaki 2000], § 3.2), we then have:
Proposition 3.10. Let v ∈ MK . For each w ∈ MK ′ lying over v there is a canonical
injection i : Cv → Cw of fields, and a canonical integer nw/v such that
(3.10.1)
for all x ∈ Cv . Moreover,
(3.10.2)

n

ki(x)kw = kxkv v/w
X
w|v

nw/v = [K ′ : K] ,

18

PAUL VOJTA

(3.10.3)

Y
w|v

ki(x)kw = kxk[K
v

′

:K]

for all x ∈ Cv ,

and
(3.10.4)

hK ′ (x) = [K ′ : K]hK (x)

for all x ∈ K .

Proof. If v is archimedean, then let σ : K → C and σ ′ : K ′ → C be injections as in
Remark 3.6 for v and w, respectively. Then i : Cv → Cw is just the identity map on
C via the identifications Cv = C = Cw , and the diagram
σ

K −−−−→


y
σ′

C


yi

K ′ −−−−→ C

commutes; therefore (3.10.1) holds with nw/v = 1 . Moreover, since K ′ /K is separable,
there are exactly [K ′ : K] places w lying over v , and this gives (3.10.2).
If P
v is non-archimedean, then it corresponds to a prime divisor Y on B , and
π ∗ Y = i ei Yi , where the Yi are the irreducible components of π −1 (Y ) . These correspond to the places w of K ′ lying over v . Let fi be the residue degree [K(Yi ) : K(Y )]
for all i . Then, for all i , hM ′ (Yi ) = fi hM (Y ) and ordYi x = ei ordY x for all x ∈ K ∗ .
Therefore (3.10.1) holds with nw/v = ei fi if w corresponds to Yi . Also (3.10.2) holds
by the basic theory of Dedekind rings applied to the local ring OB,Y and its integral
closure in K ′ .
Finally, in both cases (3.10.3) and (3.10.4) follow immediately from (3.10.1) and
(3.10.2).

Models and Arakelov Heights
For higher generality, Roth’s theorem over arithmetic function fields is best formulated
using Arakelov theory, using a model for P1K .
Throughout this subsection let (B; M1 , . . . , Md ) be a polarization of K .
Definition 3.11. Let V be a projective variety over K . A model for V over B consists
∼
of an arithmetic variety X , a morphism π : X → B , and an isomorphism XK → V
over K . We say that a given line sheaf L (resp. Cartier divisor D ) on V extends
to X if there is a smoothly metrized line sheaf L ′ (resp. Arakelov Cartier divisor
′ ∼
′
D ′ ) on X such that π ∗ Lfin
= D ).
= L (resp. π ∗ Dfin
Remark 3.12. Let V , X , and π be as above. Not every line sheaf L or Cartier
divisor D on V extends to X , but there is always a model for V to which L or D
extends. For existence of a model X , we may take an embedding of V into PnK , and
let X be the closure of the image in PnB . To see that for any given Cartier divisor D
on V there is a model to which D extends, it will suffice for our purposes to assume

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

19

that V is nonsingular. Take any model X0 for V , extend each irreducible component
of Supp D to X0 as a Weil divisor, and blow up the sheaves of ideals of the closure in
X0 of each such closure. The resulting scheme X will then be a model for V to which
D extends as a Cartier divisor. Given any line sheaf L on V , one can then find a
model to which L extends by writing L ∼
= O(D) for a Cartier divisor D , and finding
a model to which D extends. For more general situations, see [Vojta 2006pre].
We can now define height functions in terms of Arakelov theory.
Definition 3.13 ([Moriwaki 2000], Sect. 3.3). Let π : X → B be a model for a variety
V over K , and let L be a continuously metrized line sheaf on X . Then the
Arakelov height of a point x ∈ V (K) (or, equivalently, x ∈ X(K) ) is given by
 
 
 
c1 π ∗ M1 x · · · c1 π ∗ Md x · c1 L x
(3.13.1)
hL (x) =
.
[κ(x) : K]
Here, as usual, x denotes the closure of x in X . (Compare with (1.6).)

We will use the following results of Moriwaki.
Proposition 3.14 ([Moriwaki 2000], Prop. 3.3.1). Let V , X , π , and L be as above.
Let K ′ be a finite extension of K , and let (B ′ ; M1′ , . . . , Md′ ) be the polarization
of K ′ induced by the polarization (B; M1 , . . . , Md ) of K . Let X ′ be the main
component of X ×B B ′ (the latter may have many components if V is not geometrically integral over K ). Let f : X ′ → X be the projection morphism, and
let L ′ = f ∗ L . Here X ′ is a model over B ′ for the main component VK ′ of
V ×K K ′ . For all x ∈ X(K) , pick x′ ∈ X ′ (K ′ ) lying over x . Then

(3.14.1)

hL ′ (x′ ) = [K ′ : K]hL (x) .

Theorem 3.15 (Northcott’s finiteness theorem, ([Moriwaki 2000], Thm. 4.3)). Let V ,
X , and π be as above, and let L be a continuously metrized line sheaf on X .
Assume that the polarization (B; M1 , . . . , Md ) of K is big; i.e., that all Mi are
big (see ([Yuan 2008], Cor. 2.4); it suffices if the Mi are ample). Assume also
that LK is ample. Then for all C ∈ R and all n ∈ Z>0 , the set
is finite.

{x ∈ X(K) : hL (x) ≤ C and [κ(x) : K] ≤ n }

Proposition 3.16 ([Moriwaki 2000], Prop. 3.3.2). Let L be the continuously metrized line sheaf on P1B such that Lfin is the tautological line sheaf O(1) on P1B
and the metric is uniquely defined by the condition that for all global sections
s = a0 z0 + a1 z1 , where z0 , z1 are the standard homogeneous coordinates on P1 ,
ka0 p0 + a1 p1 kv
.
ksk(p0 : p1 ) =
max{kp0 kv , kp1 kv }
Then the Arakelov height hL is equal to the “naı̈ve height” hK of (3.5).

This then gives a Northcott finiteness theorem for the naı̈ve height as an immediate
corollary.

20

PAUL VOJTA

MK -constants and Weil Functions
This paper will rely heavily on Weil functions (also called local heights). As far as I
know, they have not been developed in the context of arithmetic function fields, but
their construction from the number field case carries over directly, once the definitions
have been chosen.
Throughout this subsection, K is an arithmetic function field, with polarization
(B; M1 , . . . , Md ) . Models over B of varieties are not necessary for the theory of Weil
functions itself, although they can be used to construct examples of Weil functions. We
do need the polarization, though, because it determines MK .
Definition 3.17. An MK -constant is a measurable, L1 function from MK to R , whose
support has finite measure. An MK -constant is usually denoted v 7→ cv or (cv )v .
Equivalently, an MK -constant is a measurable, L1 function v 7→ cv such that,
when restricted to non-archimedean places, cv = 0 for all but finitely many v .
Since an MK -constant (cv )v is L1 , we have
Z
|cv | dµ(v) < ∞
and therefore also
(3.18)
MK

−∞<

Z

MK

cv dµ(v) < ∞ .

Remark 3.19. Since − log |z| has finite integral on the unit disc D , the function
v 7→ − log kαkv is an MK -constant for all α ∈ K ∗ . Note, however, that if α is
transcendental, then − log kαkv is not bounded in the usual sense: for all c ∈ R there
is a v ∈ MK such that − log kαkv > c . (This happens near zeroes of α on B(C) .)
The reliance on integration and measure theory makes it necessary to assume that
the sets and functions encountered are measurable (this trivially holds for the counting
measure). Therefore:
In this paper, subsets of MK of finite measure are always assumed to be
measurable.
Also, we define the following.
Definition 3.20. Let V be a variety over K , and let S be a measurable subset of MK .
(a). The set V (S) is the disjoint union
V (S) =

a

V (Cv ) .

v∈S

In particular,
V (MK ) =

a

V (Cv ) .

v∈MK

(b). A function α : V (S) → R is K-measurable if the following condition is true.
For all finite extensions L of K , let πL : BL → B be the normalization
gen
of B in L , let πL
denote the induced map BL (C)gen → B(C)gen , let

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

21

gen −1
SL = (πL
) (S) , and (as usual) let VL = V ×K L . A rational point
P ∈ V (L) induces a function βP : SL → VL (SL ) ; for all w ∈ SL , we have
gen
a canonical identification of VL (Cw ) with V (Cv ) , where v = πL
(w) ∈ S .
This identification associates βP with a function βP′ : SL → V (S) . Then the
condition is that α ◦ βP′ : SL → R is a measurable function for all L and
P as above. (Note that SL does not contain any non-archimedean places,
but that removing non-archimedean places from a given set does not affect
whether the set is measurable.)
(c). A function α : V (S) → R is M -continuous if it is K-measurable and if, for
all v ∈ S , its restriction to V (Cv ) is continuous in the topology induced by
the metric on Cv .

Then Weil functions can be defined, following ([Lang 1983], Ch. 10); see also
([Gubler 1997], § 2):2
Definition 3.21. Let V be a complete variety over K , and let D be a Cartier divisor
on V . Then a Weil function for D is a function λD : (V \ Supp
 D)(MK ) → R
such that, for all open U ⊆ V and all f ∈ OV (U ) for which D U = (f ) , there is
an M -continuous, locally M -bounded function α : U (MK ) → R such that
λD (P ) = − log kf (P )kv + α(P )

for all P ∈ (U \ Supp D)(MK ) ,

where v is the (unique) place of K for which P ∈ U (Cv ) . (For the definition of
locally M -bounded function, see ([Lang 1983], Ch. 10, § 1).)
The restriction of λD to (V \ Supp D)(Cv ) is denoted λD,v .
With the definitions from the number field case extended to arithmetic function
fields in the above way, the theory of Weil functions follows from ([Lang 1983], Ch. 10),
where one replaces references to a finite subset of MK with a subset of MK of finite
measure, and similarly references to “almost all v ∈ MK ” with “all v ∈ MK outside a
set of finite measure.”
In particular, we have the following, in which OMK (1) refers to a function whose
absolute value is bounded by an MK -constant.
Theorem 3.22. Let V be a complete variety over an arithmetic function field K . Then:
(a). Additivity: If λ1 and λ2 are Weil functions for Cartier divisors D1 and
D2 , respectively, on V , then λ1 + λ2 (on the intersection of their domains)
extends uniquely to a Weil function for D1 + D2 .
(b). Functoriality: If λ is a Weil function for a Cartier divisor D on V , and if
f : V ′ → V is a morphism of varieties over K whose image is not contained
in Supp D , then λ ◦ f is a Weil function for f ∗ D on V ′ .
2 Gubler

does not require MK -constants to have support of finite measure. This condition can
be omitted for the purposes of this paper.

22

PAUL VOJTA

(c). Normalization: If V = PnK (with n ∈ Z>0 ), then the function λD defined
by
kx0 kv
λD,v ([x0 : · · · : xn ]) = − log
max{kx0 kv , . . . , kxn kv }
for all v ∈ MK is a Weil function for the divisor D given by x0 = 0 .
(d). Uniqueness: If both λ1 and λ2 are Weil functions for the same Cartier
divisor D on V , then λ1 = λ2 + OMK (1) .
(e). Boundedness from below: If λ is a Weil function for an effective Cartier
divisor D , then λ is bounded from below by an MK -constant.
(f). Existence: If V is projective, then every Cartier divisor on V has a Weil
function.
Proof. Parts (a)–(c) are easy to see from the definitions. For parts (d) and (e), see
([Lang 1983], Ch. 10, Prop. 2.2 and Prop. 3.1), together with Chow’s lemma. For (f),
see ([Lang 1983], Ch. 10, Thm. 3.5).

Remark 3.23. One can generalize part (f) to arbitrary complete varieties V over K as
follows. Let D be a Cartier divisor on V , and let π : X → B be a model for V such
that D extends to a Cartier divisor D ′ on X . Choose a continuous hermitian metric
on O(D ′ ) . One can then use the canonical section of O(D ′ ) to define a Weil function
for D on V . This fact will not be needed for this paper, though, so the details are left
to the reader.
Weil functions can be extended to finite extensions of arithmetic function fields
(with polarizations as in Definition 3.8) in much the same way as for number fields.
Indeed, let K ′ be a finite extension of K , and let M = (B; M1 , . . . , Md ) and
M ′ := (B ′ ; M1′ , . . . , Md′ ) be as in Definition 3.8. Let w ∈ MK ′ , and let v ∈ MK
be the place lying under it. Let V be a complete variety over K , and recall that
∼
VK ′ = V ×K K ′ . Then there is a natural bijection ιw/v : VK ′ (Cw ) → V (Cv ) . Let D
be a Cartier divisor on V , let λD be a Weil function for D , and let
(3.24)

λD′ ,w = nw/v λD,v ◦ ιw/v

for all w ∈ MK ′ and all v ∈ MK with w | v , where nw/v is as in Proposition 3.10.
Then λD′ is a Weil function for the pull-back D ′ of D to VK ′ . Moreover, by (3.10.3)
and functoriality of pull-back of polarizations to finite extension fields, this construction
is functorial in towers of finite extensions of K .
This allows us to define proximity and counting functions for complete varieties
over arithmetic function fields, as follows.
Definition 3.25. Let S be a subset of MK of finite measure, let K ′ be a finite extension
of K with the polarization M ′ induced by the polarization M of K , and let
S ′ = {w ∈ MK ′ : w | v for some v ∈ S } .

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

23

Let D be a Cartier divisor on a complete variety V over K . Let VK ′ , D ′ , λD ,
and λD′ be as above. Then the proximity function and counting function for D
relative to S are defined by
Z
1
mS (D, P ) =
λD′ ,w (P ) dµ(w)
[K ′ : K] S ′
and
NS (D, P ) =

1
′
[K : K]

Z

λD′ ,w (P ) dµ(w) ,

MK ′ \S ′
′

respectively, for all P ∈ (V \ Supp D)(K ) . By functoriality of (3.24) in towers,
these quantities are independent of the choice of K ′ .
As is true in the number field case, Theorem 3.22d and (3.18) imply that these
definitions are independent of the choice of Weil functions, up to O(1) .
With the above notation, we can then define a height function by letting
hλ (P ) = mS (D, P ) + NS (D, P )
Z
1
λD′ ,w (P ) dµ(w)
=
[K ′ : K] MK ′

for all P ∈ (V \ Supp D)(K ′ ) . By the method of ([Lang 1983], Ch. 10, § 4), this can
be extended to give a height function hλ : V (K) → R . Again, this function depends
on the choice of Weil function for a given D only up to O(1) .
The following proposition shows that this height is the same (up to O(1) ) as the
height defined by Moriwaki (Definition 3.13).
Proposition 3.26. Let V be a variety over K , let D be a Cartier divisor on V , and let
λ be a Weil function for D . Also let X be a model for V over B such that the
line sheaf O(D) extends to a continuously metrized line sheaf L on X . Then
(3.26.1)

hλ = hL + O(1) .

Proof. The canonical section of O(D) extends to a rational section s of L ; this can
then be used to define a Weil function λ′ for D , as in Remark 3.23. One then has
hL = hλ′ = hλ + O(1)
(note that the first equality is exact). As was done in Remark 3.23, the details are left
to the reader since this result is not strictly necessary for this paper.
This paper will only use heights on P1K , and for those heights (by linearity) it will
suffice to prove the proposition when V = P1K and D = [α] for some α ∈ P1 (K) .
If α = ∞ , then λv (x) = log+ kxkv defines a Weil function λ for D , and hλ = hK
(exactly). One then obtains (3.26.1) by Proposition 3.16. If α ∈ K , then
(3.26.2)

λα,v (x) = − log− kx − αkv

defines a Weil function for D ; by Theorem 3.22a, λα,v + log kx − αkv defines a Weil
function λ′′ for the divisor [∞] . Theorem 3.22d then gives hλ′′ = hλ + O(1) , and the
proposition then follows from the earlier case.


24

PAUL VOJTA

§4. Roth’s Theorem
This section discusses several equivalent formulations of Roth’s theorem, as well as the
reasons why certain choices have been made in extending Roth’s theorem to arithmetic
function fields.
We also show that all of these variants are equivalent (i.e., can be proved from one
another by relatively short arguments).
4.1. Throughout this section, K is an arithmetic function field, M := (B;
M , . . . , M ) is a big polarization of K with all metrized line sheaves equal to
the same smoothly metrized line sheaf M , MK is derived from this polarization, and S is a subset of MK with finite measure. We also write M as
(B; M ) .
Note that, by Proposition 2.5, if a polarization of a field K is big, then so is the
induced polarization of a finite extension K ′ of K . Also, the set of places of K ′ lying
over places in S has finite measure. Therefore (4.1) is preserved under passing to the
induced polarization of a finite extension.
We start with a definition.
Definition 4.2. Let D be an effective divisor on a nonsingular variety V over a field
K . We say that D is reduced if all components in Supp D occur with multiplicity
1.
The first version of Roth’s theorem is stated using notation from Nevanlinna theory.
Theorem 4.3. Let K , MK , and S be as in (4.1); let D be a reduced effective divisor
on P1K ; let mS (D, ·) be the proximity function associated to some choice of Weil
function for D ; let ǫ > 0 ; and let c ∈ R . Then the inequality
mS (D, ξ) ≤ (2 + ǫ)hK (ξ) + c

(4.3.1)

holds for all but finitely many ξ ∈ K .
The next version of the theorem is close to the above formulation (see the equivalence proof, below) but avoids Weil functions.
Theorem 4.4. Let K , MK , and S be as in (4.1); let α1 , . . . , αq be distinct elements
of K ; let ǫ > 0 ; and let c ∈ R . Then the inequality
(4.4.1)

Z

S




q
X
j=1



− log− kξ − αj kv  dµ(v) ≤ (2 + ǫ)hK (ξ) + c

holds for all but finitely many ξ ∈ K .
Next, the following version is close to the preceding version, and is the statement
that will be proved in this paper.

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

25

Theorem 4.5. Let K , MK , and S be as in (4.1); let α1 , . . . , αq be distinct elements
of K ; let ǫ > 0 ; and let c ∈ R . Then the inequality
(4.5.1)

Z

S

max {0, − log kξ − α1 kv , . . . , − log kξ − αq kv } dµ(v) ≤ (2 + ǫ)hK (ξ) + c

holds for all but finitely many ξ ∈ K .
Finally, we consider a version that is close to Roth’s original theorem.
Theorem 4.6. Let K , MK , and S be as in (4.1), and let α1 , . . . , αq be distinct
elements of K . Choose embeddings ιv,j : K(αj ) ֒→ K v over K for all j = 1, . . . , q
and all v ∈ S in such a way that the function v 7→ − log− kιv,j (ξ − αj )kv is a
measurable function for all j and all ξ ∈ K \ {α1 , . . . , αq } . Assume also that
ιv,j (αj ) 6= ιv,j ′ (αj ′ ) for all v and all j 6= j ′ (this is automatically true unless αj
and αj ′ are conjugate over K ). Then, for all ǫ > 0 and all c ∈ R , the inequality
(4.6.1)

Z

S




q
X
j=1



− log− kιv,j (ξ − αj )kv  dµ(v) ≤ (2 + ǫ)hK (ξ) + c

holds for all but finitely many ξ ∈ K .
Remark 4.7. Roth’s theorem over number fields is often stated in the form of Theorem
0.1, involving choices of αv ∈ Q for all v ∈ S . This leads to the question of whether
a more Rnatural generalization would be to choose a function α : S → K and then
bound S − log− kξ − α(v)kv dµ(v) . I doubt that this is true, although I do not
have a counterexample. I believe that Theorems 4.3–4.6 represent a more natural
generalization, because they correspond more closely to Nevanlinna theory, and because
they are sufficient to prove Siegel’s theorem on integral points (Corollary 4.11). (If the
image of α is required to be finite, then this is strictly weaker than Theorem 4.6, since
the function does not depend on ξ . One can fix a finite subset T of K , though, and
allow α to be a function from S to T depending on ξ . This would then be equivalent
to Theorem 4.6.)
We now show that these four theorems are all equivalent, and therefore proving
any one of them suffices to prove all four.
Proposition 4.8. Theorems 4.3–4.6 are equivalent.
Proof. We first show that Theorems 4.3 and 4.4 are equivalent. Let α1 , . . . , αq be as
in the statement of Theorem 4.4. For fixed α ∈ K , the function ξ 7→ − log− kξ − αkv
defines a Weil function for the divisor [α] on P1 . By additivity of Weil functions, the
integrand in (4.4.1) defines a Weil function for a divisor D := [α1 ] + · · · + [αq ] ; hence
the left-hand side of (4.4.1) equals mS (D, ξ) for this choice of Weil function, so (4.4.1)
and (4.3.1) are equivalent.

26

PAUL VOJTA

This shows that Theorem 4.3 implies Theorem 4.4. It does not (yet) show the
converse, though, since not all reduced effective divisors D on P1K are of the above
form.
To show the converse, let D be a reduced effective divisor on P1K . We first consider
the case in which ∞ ∈
/ Supp D .
Let K ′ be a finite Galois extension of K such that all points in Supp D are
rational over K ′ , let S ′ be the subset of MK ′ lying over S (as in Definition 3.25),
and let D ′ be the pull-back of D to P1K ′ . The proximity function mS (D, ξ) in (4.3.1)
was defined using a specific choice of Weil function for D ; let this be extended to a Weil
function for D ′ on P1K ′ as in (3.24). We then have mS ′ (D ′ , ξ) = [K ′ : K]mS (D, ξ)
and hK ′ (ξ) = [K ′ : K]hK (ξ) for all ξ ∈ K \ Supp D . Therefore Theorem 4.3 for D ′
on P1K ′ implies Theorem 4.3 for D on P1K . Since all points in Supp D ′ are rational
over K ′ , Theorem 4.3 for D ′ follows from Theorem 4.4 applied over K ′ . Therefore
Theorem 4.3 also holds for D .
To drop the assumption ∞ ∈
/ Supp D , let φ be an automorphism of P1K such
that φ(∞) ∈
/ Supp D . One can use the pull-back via φ of a Weil function for D
to give a Weil function for φ∗ D ; we then have mS (φ∗ D, ξ) = mS (D, φ(ξ)) for all
ξ ∈ P1K \ Supp φ∗ D . Also hK (ξ) = hK (φ(ξ)) + O(1) for all ξ , since one can express
hK using Weil functions, and then apply Proposition 3.26. Therefore Theorem 4.3 for
φ∗ D implies Theorem 4.3 for D . Since the former follows from Theorem 4.4, it follows
that Theorems 4.3 and 4.4 are equivalent.
We next show that Theorems 4.4 and 4.5 are equivalent. Let α1 , . . . , αq be distinct
elements of K , and let D = [α1 ] + · · · + [αq ] . For fixed α ∈ K ,
max{0, − log kξ − αkv } = − log− kξ − αkv
gives a Weil function for the divisor [α] . Therefore, by ([Lang 1983], Ch. 10, Prop. 3.2)
(applied with Y = −D , and using the fact that the theory of Weil functions carries
over directly to arithmetic function fields), the integrand in (4.5.1) is a Weil function
for D , and therefore the left-hand sides of (4.4.1) and (4.5.1) differ by O(1) . Thus
Theorems 4.4 and 4.5 are equivalent.
Finally, we show that Theorem 4.6 is equivalent to the other three. Clearly Theorem 4.6 reduces to Theorem 4.4 in the case when all αi lie in K , so Theorem 4.6
implies Theorem 4.4.
For the converse, let α1 , . . . , αq ∈ K and ιj,v : K(αj ) ֒→ K v ( 1 ≤ j ≤ q , v ∈ S )
be as in the statement of Theorem 4.6. Since the inequality (4.6.1) is strengthened
by adding more elements to {α1 , . . . , αq } , we may assume that this set is invariant
under Gal(K/K) . (When doing this, it is possible to choose the embeddings for
the added elements in a way that satisfies the condition on measurability.) Then
K ′ := K(α1 , . . . , αq ) is a finite Galois extension of K . The map {1, . . . , q} →
{α1 , . . . , αq } given by j 7→ ιv,j (αj ) is injective, hence bijective; therefore
(4.8.1)

q
X
j=1

−

− log kιv,j (ξ − αj )kv =

q
X
j=1

− log− kιv (ξ − αj )kv

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

27

for all v ∈ S , all ιv : K ′ → Kv over K , and all ξ ∈ K \ {α1 , . . . , αq } .
We will show that Theorem 4.4, with K replaced by K ′ , S replaced by the set S ′
of all places of K ′ lying over places of S , and c replaced by [K ′ : K]c , implies Theorem
4.6 (with no replacements). Indeed, let µ′ denote the measure on MK ′ associated to
the polarization of K ′ induced by the polarization of K . This is compatible with the
measure µ on MK ; combining this with (3.10.3) and (4.8.1) gives


Z
q
X

− log− kξ − αj kw  dµ′ (w)
S′

j=1

=

Z

S



q
X
X

− log− kξ − αj kw  dµ(v)
j=1 w|v

= [K ′ : K]

Z

S

= [K ′ : K]

Z

S







q
X
j=1

q
X
j=1



− log− kιv (ξ − αj )kv  dµ(v)


− log− kιv,j (ξ − αj )kv  dµ(v) .

Combining this with (3.10.4) then gives that (4.6.1) is equivalent to (4.4.1) (with the
above replacements).

Remark 4.9. For the equivalence of Theorems 4.4 and 4.5, something stronger was
actually proved. The above proof additionally showed that, for any given K , MK , S ,
α1 , . . . , αq , and ǫ , Theorem 4.4 for all c is equivalent to Theorem 4.5 for all c . This
fact will be used in the proof of Proposition 5.7, below.
As is true over number fields, Roth’s theorem and Mordell’s conjecture imply the
author’s “Main Conjecture” ([Vojta 1987], Conj. 3.4.3) in the special case of (rational
points on) curves. This is proved by essentially the same proof as over number fields,
so the proof will only be sketched.
Corollary 4.10. Let X be a smooth projective curve over K of genus g ; let D be a reduced effective divisor on X ; let A be a line sheaf of degree 1 on X ; let mS (D, ·)
and hA (·) be the proximity and height functions, respectively, determined by some
fixed choice of Weil function for D and A , respectively; let ǫ > 0 ; and let c ∈ R .
Then the inequality
(4.10.1)

mS (D, ξ) ≤ (2 − 2g + ǫ)hA (ξ) + c

holds for all but finitely many ξ ∈ X(K) .
Proof (sketch). When g = 0 this is Theorem 4.3, and when g > 1 this follows from
Mordell’s conjecture over K (see the Introduction) since X(K) is finite. This leaves
the case g = 1 . In this case, (4.10.1) reduces to mS (D, ξ) ≤ ǫ hA (ξ) + c .

28

PAUL VOJTA

As in the proof of Proposition 4.8, we may assume that all points of D are rational
over K . We may also assume that D 6= 0 , so in particular X(K) 6= ∅ . Thus X is an
elliptic curve.
Assume that the statement is false. Then the inequality
(4.10.2)

mS (D, ξ) > ǫ hA (ξ) + c

holds for infinitely many ξ ∈ X(K) .
√
Following Lang [1960], fix an integer n > 2/ ǫ . Since the Mordell–Weil theorem
is known for X(K) (see the Introduction), the subgroup nX(K) is of finite index in
X(K) . Therefore some coset ξ0 + nX(K) contains infinitely many points ξ for which
(4.10.2) holds. Let φ : X → X be the K-morphism ξ 7→ nξ + ξ0 . Then, for some
constant c′ , the inequality
mS (φ∗ D, ξ ′ ) > ǫ hφ∗ A (ξ ′ ) + c′
holds for infinitely many ξ ′ ∈ X(K) .
Pick a morphism ψ : X → P1K over K of degree 2 . Let D ′ be the reduced
divisor on P1K whose support is ψ(Supp φ∗ D) . Since φ is étale, the divisor φ∗ D
is reduced (as well as effective). Therefore the divisor ψ ∗ D ′ − φ∗ D is effective, so
mS (ψ ∗ D ′ , ξ ′ ) ≥ mS (φ∗ D, ξ ′ ) + O(1) for all ξ ′ ∈ X(K) . In addition, φ∗ A and ψ ∗ O(1)
have degrees n2 and 2 , respectively; therefore, for any ǫ′′ such that 2 + ǫ′′ < n2 ǫ/2 ,
standard properties of heights (which extend straightforwardly to arithmetic function
fields) give
ǫ hφ∗ A (ξ ′ ) ≥ (2 + ǫ′′ )hψ∗ O(1) (ξ ′ ) + O(1) = (2 + ǫ′′ )hK (ψ(ξ ′ )) + O(1) .
By choice of n , we may take ǫ′′ > 0 . Thus, up to O(1) at each step,
mS (D ′ , ψ(ξ ′ )) = mS (ψ ∗ D ′ , ξ ′ ) ≥ mS (φ∗ D, ξ ′ ) > ǫ hφ∗ A (ξ ′ ) ≥ (2 + ǫ′′ )hK (ψ(ξ ′ )) .
This holds for infinitely many points ψ(ξ ′ ) in P1 (K) , which contradicts Theorem 4.3.

This leads, in the usual way, to Siegel’s theorem on integral points on curves, due
to Lang ([1960], Thm. 4); see also ([Lang 1991], Ch. IX Thm. 3.1):
Corollary 4.11. Let K be a field finitely generated over Q , let R be a subring of K
finitely generated over Z , and let C be an affine curve over K . Assume that
either none of the irreducible components of C ×K K are rational, or that there
exists a projective completion of C having at least three points. Then, for any
closed embedding i : C ֒→ AnK over K , the set i−1 (Rn ) of integral points on C
is finite.
Proof. The proof follows the classical proof over number fields very closely.

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

29

By enlarging K , we may assume that C is geometrically integral. Fix a big
polarization M = (B; M ) of K such that B is normal and generically smooth. Let
∞
S ⊆ MK be the union of MK
and the set of all prime divisors Y on B such that some
generator of R has a pole along Y . Then S has finite measure, and R is contained
in the ring of S-integers of K . Let X0 be a projective closure of C .
Let i : C → AnK be a closed embedding over K , and let x1 , . . . , xn be the pullbacks to C of the coordinate functions on AnK . Then, for each v ∈ MK the function
X0 (Cv ) → R ∪ {∞} given by
λv (ξ) = max{0, log kx1 (ξ)kv , . . . , log kxn (ξ)kv }
defines a Weil function λ on X0 for an effective divisor D0 such that Supp D0 = X0 \C.
Let Σ = i−1 (Rn ) , and assume that this is an infinite set. By construction we have
λv (ξ) = 0 for all v ∈ MK \ S and all ξ ∈ Σ .
Let π : X → X0 be the normalization of X0 , let D be the reduced divisor on
X such that Supp D = X \ π −1 (C) , and choose a Weil function λD for D on X .
Then there is an MK -constant (cv ) such that λD,v (ξ) ≤ cv for all v ∈
/ S and all
ξ ∈ π −1 (Σ) . It then follows that
(4.11.1)

mS (D, ξ) = hD (ξ) + O(1)

for all ξ ∈ π −1 (Σ) , where mS (D, ·) and hD are proximity and height functions defined
using λD .
Let g be the genus of X . The hypotheses on C imply that deg D > 2g − 2 , so
(4.11.1) contradicts Corollary 4.10 by basic properties of heights (which still hold over
arithmetic function fields).

§5. Reductions
In this section we begin the main line of the proof of Roth’s theorem over arithmetic
function fields. Specifically, Theorem 4.5 will be proved in the remaining sections of
the paper (and the other variations will then follow, by Proposition 4.8).
The purpose of this section is to show that it will suffice to prove Theorem 4.5
under the following additional hypotheses:
5.1.
5.2.
5.3.
5.4.

the set S contains all of the archimedean places,
B is generically smooth,
M is ample, and
the metric on M is positive.

We start by noting that the integrand of (4.5.1) is nonnegative, so enlarging the
set S will only strengthen the theorem. In particular, we may assume that (5.1) holds.
Next, consider the condition (5.2). Recall from (4.1) that M = (B; M ) is a big
polarization of K . Let π : B ′ → B be a generic resolution of singularities of B , and
let M ′ = π ∗ M . Then M ′ := (B ′ ; M ′ ) is also a big polarization of K .

30

PAUL VOJTA

The map π induces a bijection π gen : B ′ (C)gen → B(C)gen which preserves measures and absolute values.
As for non-archimedean places, let Y ′ ∈ (B ′ )(1) , and let Y = π(Y ′ ) . First consider
the case in which codim Y = 1 . Then Y ∈ B (1) , and hM (Y ) = hM ′ (Y ′ ) by (1.9).
Also ordY ′ (ξ) = ordY (ξ) for all ξ ∈ K ∗ , so we have kξkY ′ = kξkY for all ξ ∈ K .
Next consider Y ′ for which codim Y > 1 . Then π∗ (Y, 0) = 0 in Z1D (B) , so
hM ′ (Y ′ ) = 0 by (1.8). Therefore kξkY ′ = 1 for all ξ ∈ K ∗ .
Therefore, it is clear from (3.5) that hM (ξ) remains the same when one changes
the polarization from M to M ′ .
′
Next let S ′ be the subset of MK
defined by
S ′ = B ′ (C)gen ∪ {Y ′ ∈ (B ′ )(1) : π(Y ′ ) ∈ S ∩ B (1) } .
Since S ⊇ B(C)gen by (5.1), the integral in (4.5.1) is unchanged when S is replaced
by S ′ . Therefore, for each ξ ∈ K , (4.5.1) is true for the polarization M if and only if
it is true for M ′ , and therefore it suffices to prove Theorem 4.5 under the additional
conditions (5.1) and (5.2).
This leaves (5.3) and (5.4). We begin with a result from Arakelov theory.
In the remainder of this section, it will be convenient to work with slightly different
c
notation. For an integral scheme X , projective over Spec Z , let Pic(X)
denote the
group of smoothly metrized line sheaves on X , whose group operation is tensor product.
c
A smoothly metrized Q-line sheaf on X is an element of Pic(X)
⊗ Q . The previous
definitions of “nef,” “big,” and “ample” extend to this group. For simplicity, elements
c
of Pic(X)
⊗ Q will be written additively.
Since the intersection number c1 (L1 ) · · · c1 (Ln ) on an arithmetic variety X is
multilinear, its definition extends to allow the Li to be smoothly metrized Q-line
sheaves, and correspondingly we allow smoothly metrized Q-line sheaves to be used in
polarizations.
Lemma 5.5. Let B be a generically smooth arithmetic variety, and let M and A be
smoothly metrized line sheaves on B . Assume that M is big and nef, that A is
ample, and that the metric on A is positive. Then
(a). For all rational δ > 0 , M + δA is ample, and its metric is positive.
(b). Let δ ∈ Q>0 . Let K = κ(B) , and let hK and h′K denote the naı̈ve heights
computed using the polarizations (B; M ) and (B; M + δA ) , respectively.
Then h′K (ξ) ≥ hK (ξ) for all ξ ∈ K .
(c). For any given ǫ′′ > 0 there is a rational δ > 0 such that the inequality


(5.5.1)
c1 (M + δA )Y )·d ≤ (1 + ǫ′′ )c1 M Y )·d
holds for all but finitely many Y ∈ B (1) .

Proof. First, we claim that the inequality
 ·dim Y
 ·dim Y
≥ c1 M Y
(5.5.2)
c1 (M + δA )Y

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

31

holds for all rational δ > 0 and all integral closed subschemes Y of X . Indeed,
 ·dim Y
 ·dim Y
− c1 M Y
c1 (M + δA )Y
dim
XY dim Y 
 ·(dim Y −i)
 ·i
=
δi c1 M Y
· c1 A Y
,
i
i=1

and each term on the right-hand side is nonnegative.
By a similar argument,
 ·dim Y
 ·dim Y
.
≥ δdim Y c1 A Y
(5.5.3)
c1 (M + δA )Y

Now consider (a). The metric on M + δA is positive because the metrics on A
and M are positive and semipositive, respectively. Also M + δA is vertically nef
because both M and A are.
Since the metric on M is semipositive, MQ is nef, and therefore (M + δA )Q is
ample (by either Kleiman’s or Seshadri’s criterion for ampleness).
Finally, M + δA is horizontally positive by (5.5.3) and horizontal positivity of
A . Thus M + δA is ample.
Next consider (b). Let ξ ∈ K . By (3.5),
(5.5.4)
h′K (ξ)

− hK (ξ) =

Z

B(C)gen

+

log+ |ξ(b)| d(µ′∞ (b) − µ∞ (b))

X

Y ∈B (1)

max{0, − ordY (ξ)}(hM ′ (Y ) − hM (Y )) ,

where µ∞ and µ′∞ are the measures on B(C)gen defined using M and M ′ , respectively. The signed measure µ′∞ − µ∞ is associated to the (d, d)-form
∧d

c1 (k · kM +δA )

∧d

− c1 (k · kM )

=

d  
X
d
i=1

i

δi c1 k · kM

∧(d−i)

∧ c1 k · kA

∧i

,

and this is nonnegative because each term on the right is nonnegative. Also, by (5.5.2),
hM ′ (Y ) ≥ hM (Y ) for all Y ∈ B (1) . Therefore, the right-hand side of (5.5.4) is nonnegative, and this gives (b).
Finally, consider (c).
By ([Moriwaki 2014], Prop. 5.43), there is a rational η > 0 such that some
positive integer multiple of M − ηA has a nonzero strictly small global section.
Let s be such a global section. Let Y ∈ B (1) , and assume that Y does not occur
in the support
 of (s)fin . This excludes only finitely many Y .
Since sY is nonzero and both M and A are nef, Proposition 1.12b gives

(5.5.5)

 
 ·j
 ·(d−1−j)
· c1 (M − ηA )Y ≥ 0
· c1 A Y
c1 M Y

32

PAUL VOJTA

for all j = 0, . . . , d − 1 .
Let ǫ′′ > 0 be given. Choose a rational δ > 0 such that
(1 + ǫ′′ )η d ≥ (η + δ)d .
Since
′′

d

d

d ′′

(1 + ǫ )η − (η + δ) = η ǫ −
we have
j  
X
d

η j ǫ′′ −

(5.5.6)

i=1

i

d  
X
d
i=1

i

η d−i δi ,

η j−i δi ≥ 0

for all j = 0, . . . , d .
For j = 0, . . . , d let
Cj =

η j ǫ′′ −

j  
X
d

η j−i δi

!

 ·j
 ·(d−j)
· c1 A Y
c1 M Y

i
 
d
X
 ·i
 ·(d−i)
d i
.
−
· c1 A Y
δ c1 M Y
i
i=j+1
i=1

We claim that Cj ≥ 0 for all j . This will be proved by descending induction on
j . When j = d , we have
!
d  
X
 ·d
d
Cd = η d ǫ′′ −
,
η d−i δi c1 A Y
i
i=1

and this is nonnegative by (5.5.6) and Proposition 1.12a. For j = 0, . . . , d − 1 , we have
j ′′

Cj+1 = η η ǫ −

and therefore
Cj − Cj+1 =

j  
X
d
i=1

i

η

j−i i

δ

!

 ·(d−j−1)
 ·(j+1)
c1 M Y
· c1 A Y

 
d
X
 ·i
 ·(d−i)
d i
−
,
· c1 A Y
δ c1 M Y
i
i=j+1

η j ǫ′′ −

j  
X
d
i=1

i

η j−i δi

!


 ·(d−j)
 ·j
 ·(d−j−1)
 ·(j+1) 
· c1 M Y
· c1 A Y
− ηc1 M Y
· c1 A Y
.

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

33

By (5.5.6) and (5.5.5), the right-hand side is nonnegative; hence Cj ≥ Cj+1 .
We then have C0 ≥ 0 . Since
d  
 ·d X
 ·i
 ·(d−i)
d i

−
C0 = ǫ c1 M Y
· c1 A Y
δ c1 M Y
i
i=1
 ·d


·d
,
− c1 (M + δA )Y
= (1 + ǫ′′ )c1 M Y
′′

we have (5.5.1).



This sets the stage for the main result of this section.
Remark 5.6. In the proof of the following proposition, it will be convenient to consider
polarizations (B; M ′ ) in which M ′ is a smoothly metrized Q-line sheaf. This can be
justified as follows.
Let (B; M ) be a polarization of K , and let n be a positive integer. Then
(B; nM ) is also a polarization, with the same set MK of places. The archimedean
absolute values of this new polarization are the same as those of the original polarization, but the measure µ∞ is multiplied by nd . For non-archimedean places, the
counting measure is of course unchanged, but the absolute values for (B; nM ) are the
nd powers of the absolute values for (B; M ) . Therefore the naı̈ve height is multiplied
by nd by this change. Similarly, let D be a Cartier divisor on a variety V over K ,
and let λ be a Weil function for D using the polarization (B; M ) . Define a function
λ′ by letting λ′v = λv for all archimedean v and λ′ = nd λv for all non-archimedean
v . Then λ′ is a Weil function for D relative to (B; nM ) . It then follows that the
proximity and counting functions obtained using λ′ and (B; nM ) are equal to nd
times those obtained using λ and (B; M ) .
Therefore, one obtains well-defined notions of absolute value, naı̈ve height, Weil
functions, proximity functions, and counting functions for polarizations with smoothly
metrized Q-line sheaves. And, if Theorem 4.5 holds for polarizations as defined earlier,
then it is also true for polarizations using smoothly metrized Q-line sheaves.
Proposition 5.7. To prove Theorem 4.5, it suffices to prove that it holds under the
additional hypotheses (5.1)–(5.4).
Proof. As noted earlier, we may already assume that (5.1) and (5.2) hold, so it remains
to show that if Theorem 4.5 holds under (5.1)–(5.4) then it holds when only (5.1) and
(5.2) are true. By Remark 4.9, we may work with Theorem 4.4 instead of 4.5.
So let K , MK , and S be as in (4.1), where S contains all archimedean places,
and the polarization M = (B; M ) satisfies (5.2); i.e., B is generically smooth. Also
let α1 , . . . , αq , ǫ , and c be as in the statement of Theorem 4.4.
Pick ǫ′ > 0 and ǫ′′ > 0 such that
(5.7.1)

q − 2 − ǫ′
=q−2−ǫ.
1 + ǫ′′

34

PAUL VOJTA

Choose an ample smoothly metrized line sheaf A on B with positive metric, and
let δ > 0 be as in Lemma 5.5c. We may assume that S contains all of the (finitely
many) Y ∈ B (1) for which (5.5.1) fails to hold.
Let D = [α1 ] + · · · + [αq ] , and let λD be the Weil function for D defined by
(5.7.2)

λD,v = −

q
X
i=1

log− kξ − αi kv .

Also let mS (D, ξ) and NS (D, ξ) be as in Definition 3.25. By Proposition 3.26,
(5.7.3)

mS (D, ξ) + NS (D, ξ) = q hK (ξ) + O(1)

for all ξ ∈ K \ {α1 , . . . , αq } .
Let M ′ = M + δA , and let M ′ = (B; M ′ ) . Note that MK depends only on B ,
so it is the same for both polarizations M and M ′ . Define h′K (ξ) , λ′D , m′S (D, ξ) ,
and NS′ (D, ξ) similarly to hK (ξ) , λD , etc., but using M ′ instead of M . Again, we
have
(5.7.4)

m′S (D, ξ) + NS′ (D, ξ) = q h′K (ξ) + O(1)

for all ξ ∈ K \ {α1 , . . . , αq } .
By Lemma 5.5a, M ′ is ample with positive metric. Therefore, we can apply
Theorem 4.4 to get that, for all c′ ∈ R , the inequality
m′S (D, ξ) ≤ (2 + ǫ′ )h′K (ξ) + c′
holds for all but finitely many ξ ∈ K (where the excluded set depends on c′ as well
as all other data here). By (5.7.4) there is a constant a′ , independent of c′ , such that
NS′ (D, ξ) ≥ (q − 2 − ǫ′ )h′K (ξ) − c′ − a′ .
By Lemma 5.5b and (5.5.1), we have h′K (ξ) ≥ hK (ξ) and NS′ (D, ξ) ≤ (1 + ǫ′′ )NS (D, ξ)
for all ξ ∈ K \ {α1 , . . . , αq } . Therefore
(1 + ǫ′′ )NS (D, ξ) ≥ (q − 2 − ǫ′ )hK (ξ) − c′ − a′
for all but finitely many ξ ∈ K . By (5.7.1) and (5.7.3), there is a constant a , independent of c′ , such that
mS (D, ξ) ≤ (2 + ǫ)hK (ξ) +

c′ + a′
+a .
1 + ǫ′′

We can then take c′ small enough so that (c′ + a′ )/(1+ ǫ′′ )+ a ≤ c to get (4.4.1).



ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

35

§6. Reduction to Simultaneous Approximation: The Main Analytic Part
The proof of Theorem 4.5 follows the classical proof over number fields very closely.
Most parts carry over directly without difficulty. The main exception to this is the part
of the proof that is often called “reduction to simultaneous approximation”. This is
briefly described in the Introduction; see also ([Lang 1983], Ch. 7, § 2), ([Hindry and
Silverman 2000], Thm. D.2.2), or ([Bombieri and Gubler 2006], 6.4.2–6.4.4).
In more detail, reduction to simultaneous approximation is as follows. In the
special case of number fields, (4.5.1) reduces to the inequality
X

v∈S

max − log− kξ − αj kv ≤ (2 + ǫ)hK (ξ) + c ,

1≤j≤q

where S is a finite set. Reduction to simultaneous approximation consists of showing
that, to prove Roth’s theorem, it suffices to prove the following
P statement. For all
functions j : S → {1, . . . , q} and all (cv )v∈S ∈ R#S such that
cv > 2 , only finitely
many ξ ∈ K simultaneously satisfy
− log− kξ − αj(v) kv > cv hK (ξ)
for all v ∈ S .
In the number field case S is finite, so this is proved by a simple compactness
argument combined with the pigeonhole principle. In the case of arithmetic function
∞
fields, though, S ∩ MK
is a subset of a complex manifold and v 7→ − log− kξ − αj kv is
∞
a smooth function (with singularities on the manifold outside of MK
). This becomes
a question in analysis, reminiscent of the Arzelà–Ascoli theorem. In fact, the proof
presented here is motivated by the proof of the Arzelà–Ascoli theorem. The singularities
∞
can be handled by removing a subset T of bounded measure from MK
. It is possible
∞
to do this, for basically the same reason as in [Wirsing 1971]. Since MK
\ T may
now be locally disconnected, though, it is necessary to work with differences instead of
derivatives.
Another challenge in reducing to simultaneous approximation is the fact that the
analytic estimates in the proof need to be uniform in the rational points. Simple
compactness arguments will not work here. For example, in the d = 1 case the degree
of the rational function can be arbitrarily large. Instead, we can use the fact that
− log kξ −αj kv is a Green function for the principal divisor (ξ −αj ) , and use properties
of Green forms and functions from Arakelov theory to write this function as an integral
whose integrand can be treated using compactness arguments (see Proposition 6.3).
The proof of reduction to simultaneous approximation for arithmetic function fields
takes up the next three sections of this paper. They form the core of this paper.
This section carries out the main analytic arguments leading up to Proposition
6.16, which is motivated by a part of the proof of the Arzelà–Ascoli theorem. Section
7 gives an upper bound on what is lost by removing the set T ; this is Proposition 7.3.
Section 8 then carries these two results over to the arithmetical setting, and proves the

36

PAUL VOJTA

main result on reduction to simultaneous approximation (Proposition 8.9). This is the
part that uses the pigeonhole argument.
Ultimately the proof of Proposition 6.16 relies on the following elementary lemma
on integration (which is used in proving Lemma 6.13).
Lemma 6.1. Let X be a space with measure µ , let g : X → [0, ∞] be a measurable
function with finite integral, and let c > 0 . Then
Z
1
g dµ .
µ({x ∈ X : g(x) ≥ c}) ≤
c X
Wirsing’s proof also uses this lemma (via its reliance on Chebyshev’s inequality).
Results in this section and the next will be phrased in terms of a smooth complex
projective variety X . The topology on X will be the classical topology. In Section 8
we will apply these results as X varies over all connected components of B(C) , where
B is the arithmetic variety in some polarization of K . Note that K is a subfield of
κ(X) (in fact, κ(X) is the compositum of K and C over the algebraic closure F of
Q in K , for some choice of embedding of F into C ).
Definition 6.2. Let X be a smooth complex projective variety and let Y ⊆ X be an
irreducible closed subvariety of X of codimension p > 0 . Then a Green form for
Y is a smooth (p − 1, p − 1)-form on X \ Y whose associated current on X is a
Green current for Y . A Green form of log type for Y is a Green form for Y that
is of logarithmic type along Y ([Soulé 1992], Def. II.3).
Proposition 6.3. Let X be a smooth complex projective variety of dimension d ≥ 1 .
Let ∆ be the diagonal in X × X , let π : W → X × X be the blowing-up of
X × X along ∆ , choose a smooth metric on the line sheaf O(E) , and let s be the
canonical section of this line sheaf. Then there exist smooth (d − 1, d − 1)-forms
α and β on W for which the following are true.
(a). There is a Green form g∆ of log type for ∆ on X × X such that
(6.3.1)

π ∗ g∆ = (− log ksk2 )α + β

on W \ E .

e → X be
(b). For each prime divisor D on X , define gD as follows. Let j : D
e → D is a desingularization of D ,
a proper map with image D such that D
e
let q : D × X → X be the projection to the second factor, and let

(6.3.2)

gD = q∗ (j × IdX )∗ g∆ .

Then gD is a Green form of log type for D on X .
∗
(c). For each
P ξ ∈ κ(X) , write the principal divisor (ξ) as a (finite) sum
(ξ) = D nD D , where each D is a prime divisor and nD ∈ Z for all D .
Then there is a constant c such that
X
(6.3.3)
− log |ξ|2 =
nD gD + c .
D

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

37

Proof. Part (a) is proved in Step 2 of the proof of ([Soulé 1992], Thm. II.3), where f
is taken to be the identity map on X .
For part (b), note that (j × IdX )−1 (∆) is the graph Γj of j . Since
codimD×X
Γj = codimX×X ∆ ,
e
it follows from ([Soulé 1992], § II.3.2) that (j × IdX )∗ g∆ is a Green form of log type
for Γj .
Since the push-forward q∗ Γj equals D (as cycles on X ), it follows from ([Soulé
1992], II Lemma 2 (ii)) and ([Soulé 1992], proof of III Thm. 3 (ii)) that q∗ (j×IdX )∗ g∆
is a Green form of log type for D on X . This gives P
part (b).
2
For part (c), we note that both − log |ξ| and
nD gD are Green forms for the
same divisor (ξ) . Therefore, by ([Gillet and Soulé 1990], Lemma 1.2.4), there is a
smooth function f : X → R such that
(6.3.4)

− log |ξ|2 =

X

nD gD + log f

everywhere outside of the support of the divisor (ξ) .
Since g∆ is a Green form for ∆ on X × X , the (d, d)-form ddc g∆ extends to a
smooth form ω∆ on X × X . Similarly, if D is a prime divisor then ddc gD extends to
a smooth form ωD on X . By functoriality, ddc ((j × IdX )∗ g∆ ) extends to the smooth
e × X , and by ([Soulé 1992], proof of III Thm. 3 (ii)) we have
form (j × IdX )∗ ω∆ on D
(6.3.5)

q∗ (j × IdX )∗ ω∆ = ωD .

Let H i,j (M ) denote the set of harmonic (i, j)-forms on M for some fixed choice
of Kähler (or Riemannian) metric on a complex manifold M ([Griffiths and Harris
1978], p. 82). Fix such a metric on X and use the induced metric on X × X .
By the construction in Step 2 of the proof of ([Soulé 1992], Thm. II.3), we may
choose g∆ such that ω∆ is any given representative of ∆ in H∂d,d
¯ (X × X) . By
the Hodge decomposition ([Griffiths and Harris 1978], p. 116), each cohomology
class is represented by a unique harmonic form. Therefore we may assume that ω∆ is
harmonic.
By the Künneth formula ([Griffiths and Harris 1978], p. 104),
H d,d (X × X) =

M

i+j=d
i′ +j ′ =d

′

′

H i,j (X) ⊗ H i ,j (X) .

Applying this decomposition to ω∆ , the only component that affects the value of
q∗ (j × IdX )∗ ω∆ is the one with j = j ′ = 1 . Therefore there are forms
u1 , . . . , un ∈ H d−1,d−1 (X)

and

v1 , . . . , vn ∈ H 1,1 (X)

38

PAUL VOJTA

e ×X → D
e
such that if p̃, q̃ : X ×X → X are the first and second projections and if p : D
is the first projection, then
q∗ (j × IdX )∗ ω∆ =
=

n
X

i=1
n
X
i=1

=

q∗ (j × IdX )∗ (p̃∗ ui ⊗ q̃ ∗ vi )
q∗ (p∗ j ∗ ui ⊗ q ∗ vi )

n Z
X
i=1

e
D


j ∗ u i q ∗ vi .

In particular, byP(6.3.5), ωD is harmonic.
Therefore,
nD ωD is also harmonic. Since it represents the (trivial) cohomology
class of the principal divisor (ξ) , it must be zero. By (6.3.4), we then have
ddc log f = −ddc log |ξ|2 = 0 ,
and therefore f is constant.



e
Remark 6.4. In part (b), we may assume that j maps a Zariski-open subset U of D
e
isomorphically to the smooth locus Dreg of D . Since D \ U has measure zero and g∆
is a form (as opposed to a current), we can compute gD by integrating over Dreg :
(6.4.1)

gD (x) =

Z

g∆
Dreg ×{x}

for all x ∈ X \ D .

The following construction will be used often in obtaining analytic estimates.
Lemma 6.5. Let M1 and M2 be complex manifolds of dimension d ≥ 1 , and let ψ be
a smooth positive (d−1, d−1)-form on M2 . Let α be a smooth (d−1, d−1)-form
on an open subset U of M1 × M2 . Let Gr1 T M1 be the Grassmannnian of hyperplanes in fibers of the tangent bundle T M1 , and let τ1 : Gr1 T M1 → M1 be the
structural morphism. Let G = (Gr1 T M1 )×M2 and τ = τ1 ×IdM2 : G → M1 ×M2 .
This can be regarded as the Grassmannian of hyperplanes in fibers of the relative tangent bundle of M1 × M2 over M2 , taken relative to the projection
q : M1 × M2 → M2 to the second factor.
Then there is a unique smooth function χα : τ −1 (U ) → C , depending only
on M1 , M2 , ψ , U , and α , such that the following is true for all locally closed
submanifolds N of M1 of dimension d − 1 .
First of all, for dimension reasons, there is a smooth function
ρα,N : (N × M2 ) ∩ U → C

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

39

such that
(6.5.1)



α(N ×M2 )∩Ux = ρα,N · (p∗ ψ)(N ×M2 )∩Ux

for all x ∈ M2 ,

where Ux = (M1 × {x}) ∩ U and p : M1 × M2 → M1 is the projection to the first
factor.
On the other hand, at each w ∈ N , the tangent space Tw N is a hyperplane
in Tw M1 , and this gives a smooth section σN,1 : N → Gr1 T M1 of τ1−1 (N ) → N .
Similarly, σN := σN,1 ×IdM2 : N ×M2 → G is a section of τ −1 (N ×M2 ) → N ×M2 .
Then we have
(6.5.2)

ρα,N (w, x) = χα (σN (w, x))

for all (w, x) ∈ (N × M2 ) ∩ U ,

so that (6.5.1) becomes


(6.5.3)
α(N ×M2 )∩Ux = ((χα ◦ σN ) · (p∗ ψ))(N ×M2 )∩Ux

for all x ∈ M2 .

Proof. The lemma is local on M1 , so we may assume that M1 is an open subset of
Cd . Then one can define χα using hyperplanes, and note that if N and N ′ are locally
closed submanifolds of M1 of dimension d− 1 that are tangent to each other at a point
w , then ρα,N (w, x) = ρα,N ′ (w, x) for all x such that (w, x) ∈ U . Indeed, this is true
because pull-backs of differential forms depend only on first derivatives.

Corollary 6.6. Applying this lemma to χg∆ , (6.4.1) becomes
Z
χg∆ (σDreg ,1 (w), x) · ψ(w)
for all x ∈ X \ D .
(6.6.1)
gD (x) =
w∈Dreg

The first application of this construction will be to give bounds on the behavior of
α and β in Proposition 6.3 near ∆ .
Lemma 6.7. Let V be an open subset of Cd with d ≥ 1 , and let ψ be a smooth positive
(d−1, d−1)-form on V . Let π : WV → V ×V be the (analytic) blowing-up of V ×V
along the diagonal ∆ , and let α be a smooth (d−1, d−1)-form on U := (V ×V )\∆
that extends to a smooth form on WV . Let τ : (Gr1 T V ) × V → V × V and
χα : τ −1 (U ) → C be as in Lemma 6.5.
We have T V ∼
= V × (Pd−1 )∗ , canon= V × Cd and therefore Gr1 T V ∼
d−1 ∗
ically (where (P ) is taken to be a point if d = 1 ). Thus we let pairs
(w, H) ∈ V × (Pd−1 )∗ denote points in Gr1 T V .
Let L1 and L2 be compact subsets of V . Then, for all (w, z) ∈ (L1 ×L2 )∩U
and all H ∈ (Pd−1 )∗ , we have


1
,
(6.7.1)
|χα (w, H, z)| ≤ O
|w − z|2d−2

40

PAUL VOJTA





∂χα (w, H, z)
1
≤O

,


∂zi
|w − z|2d−1

(6.7.2)
and





∂χα (w, H, z)
1

≤O
,


∂z i
|w − z|2d−1

(6.7.3)

i = 1, . . . , d ,

i = 1, . . . , d ,

where z1 , . . . , zd are the coordinates of z . Moreover, the implicit constants in
O(·) are uniform over τ −1 ((L1 × L2 ) ∩ U ) .
Proof. If d = 1 , then π is an isomorphism and α is a smooth function on V × V , so
(6.7.1)–(6.7.3) are trivial.
Therefore, we assume from now on that d ≥ 2 .
For points (w, z) ∈ U , write w = (w1 , . . . , wd ) and z = (z1 , . . . , zd ) . Let
vi = wi − zi for i = 1, . . . , d ; then (v1 , . . . , vd , z1 , . . . , zd ) is a (global) coordinate
system on V × V in which ∆ is given by v1 = · · · = vd = 0 .
For each l = 1, . . . , d let Ul be the subset of points P ∈ U such that
max{|v1 (P )|, . . . , |vd (P )|} = |vl (P )| .

(6.7.4)

Note that U1 ∪ · · · ∪ Ud = U (and that the sets Ul are not open). From now on, for
convenience of notation, we assume that l = 1 unless otherwise specified.
Let u1 = v1 and ui = vi /v1 for i = 2, . . . , d . Then (u1 , . . . , ud , z1 , . . . , zd )
is a local coordinate system on WV near all points of π −1 (U1 ) . Let W1 be the
largest open subset of WV on which the functions ui are regular for all i 6= 1 . Then
(u1 , . . . , ud , z1 , . . . , zd ) is a coordinate system on W1 , and
π −1 (U1 ) = {P ∈ W1 : |ui (P )| ≤ 1 for all i 6= 1 } .
As l varies, the similarly defined sets Wl cover all of WV .
Let q : V × V → V denote the projection to the second factor. Then, on fibers of
q ◦ π , we have du1 = dv1 = dw1 and
 
v1 dvi − vi dv1
v1 dwi − vi dw1
vi
=
=
,
i = 2, . . . , d .
(6.7.5)
dui = d
2
v1
v1
v12
√
By (6.7.4), we have |v1 | ≤ |w−z| ≤ d|v1 | over U1 . Then√all coefficients 1 , 1/v1 , and
−vi /v12 above are bounded in absolute value by max{1, d/|w − z|} over U1 (again
using |vi | ≤ |v1 | ). The same estimates hold for the coefficients obtained when writing
dui in terms of dw 1 and dw i for all i = 1, . . . , d .
Next, for all z ∈ V , let Wz denote the fiber of q ◦ π over z ; it is isomorphic to
the blowing-up of V at z . For all z ∈ V , we have

αW

1 ∩Wz

=

d X
d
X
i=1 j=1

ci ∧ · · · ∧ dud ∧ du1 ∧ · · · ∧ du
dj ∧ · · · ∧ dud ,
αij du1 ∧ · · · ∧ du

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

41

where c denotes omission and αij : W1 → C are smooth. Using the above substitutions for dui in terms of dw1 and dwi , and letting Uz = (V \ {z}) × {z} , we then
have
d X
d
X

d̃ ∧ · · · ∧ dw d ,
dı̃ ∧ · · · ∧ dwd ∧ dw1 ∧ · · · ∧ dw

α̃ı̃̃ dw1 ∧ · · · ∧ dw
α W1 ∩π−1 (Uz ) =
ı̃=1 ̃=1

where

(6.7.6)

α̃ı̃̃ =

X
i,j

αij · Pijı̃̃ (1/v1 , 1/v 1 , v2 /v12 , v 2 /v 21 , . . . , vd /v12 , v d /v 21 )

and each Pijı̃̃ is a polynomial of degree 2d − 2 with constant coefficients, which
depends only on d , i , j , ı̃ , and ̃ .
Now we restrict to a hyperplane H ⊆ Tw V . This hyperplane is given by the
vanishing of a nontrivial linear combination of dw1 , . . . , dwd . Therefore there is an
index m such that H is given by
X
(6.7.7)
dwm =
ci dwi
with ci ∈ C and |ci | ≤ 1 for all i 6= m .
i6=m

Then, for any locally closed submanifold N of Uz of dimension d − 1 tangent to H
at w , we have
(6.7.8)

dm ∧ · · · ∧ dwd ∧ dw1 ∧ · · · ∧ dw
[
at w ,
αN = αm (w, H, z) dw1 ∧ · · · ∧ dw
m ∧ · · · ∧ dw d

where

(6.7.9)

αm =

d X
d
X
ı̃=1 ̃=1

σı̃m σ̃m cı̃ c̃ (α̃ı̃̃ ◦ τ ) ,

σkm = ±1 depending on k and m , and cm = 1 .
Now let K1 = {P ∈ W1 ∩ π −1 (L1 × L2 ) : |ui (P )| ≤ 1 for all i 6= 1 } . This set is
compact. For all i and j let Mij be the maximum value of |αij | over K1 . By (6.7.6)
there is a constant Cd , depending only on d , such that
(6.7.10)

|α̃ı̃̃ | ≤

X
Cd
Mij
min{1, |w − z|}2d−2 i,j

on K1 ∩ π −1 (U ) .

Let K1,m be the set of elements of τ −1 (π(K1 ) ∩ U ) such that the hyperplane H
satisfies (6.7.7). By (6.7.9) and (6.7.10), we then have
(6.7.11)

|αm | ≤

X
d2 Cd
Mij
min{1, |w − z|}2d−2 i,j

on K1,m .

42

PAUL VOJTA

′
Let Km
be the set of all points (w, H) ∈ τ1−1 (L1 ) for which H satisfies (6.7.7).
′
′
This set is compact and Km
× L2 contains K1,m . For all (w, H) ∈ Km
and all locally
closed submanifolds N of V of dimension d − 1 tangent to H at w , we have
(6.7.12)

√ d−1
\
−1
ψm (w, H) dw1 ∧ dw1 ∧ · · · ∧ dwm
∧ dw m ∧ · · · ∧ dwd ∧ dw d
at w ,
ψ =
N

′
where ψm : Km
→ R is continuous and positive. Let Dm > 0 be the minimum value
′
of ψm on Km .
Combining (6.7.8) and (6.7.12) gives


(−1)(d−2)(d−1)/2 αm (w, H, z) 
ψN
αN =
√ d−1
ψm (w, H)
−1

at (w, H, z)

for all (w, H, z) ∈ K1,m . By (6.5.3) and the fact that σN (w, z) = (w, H, z) , we have
χα (w, H, z) =

(−1)(d−2)(d−1)/2 αm (w, H, z)
,
√ d−1
ψm (w, H, z)
−1

and therefore, by (6.7.11) and the definition of Dm ,
|χα (w, H, z)| ≤

d2 Cd X
1
Mij ·
Dm i,j
min{1, |w − z|}2d−2

for all (w, H, z) ∈ K1,m .
Combining these estimates for all l and all m then gives (6.7.1), uniformly over
τ −1 ((L1 × L2 ) ∩ U ) .
Now consider (6.7.2) and (6.7.3).
First of all, it is important to note that the notation ∂/∂zk is ambiguous. If taken
with respect to the coordinate system u1 , . . . , ud , z1 , . . . , zd , then u = (u1 , . . . , ud ) is
kept fixed (as well as all zh with h 6= k ), whereas if taken with respect to the coordinate
system w1 , . . . , wd , z1 , . . . , zd then w is kept fixed. We denote these (different) partials
∂u /∂zk and ∂w /∂zk , respectively, and define ∂u /∂z k and ∂w /∂z k similarly.
The proof of (6.7.2) and (6.7.3) is similar to that of (6.7.1), but is more complicated
due to the presence of partial derivatives.
First look at (6.7.5). Recalling that vi = wi −zi , we have ∂w vi /∂zk = −δik (using
the Kronecker delta), and therefore
 vi
if k = 1 ,
−
  ( 1

 
 v13
if k = 1 ,
∂w 1
vi
∂w
v12
1
=
− 2 =
and
if k = i ,
v2

∂zk v1
∂zk
v1
0
otherwise ,
 1
0
otherwise .
This gives
(6.7.13)

 
  



  ∂w 1   ∂w
 ∂w
vi 
2





(1) , 
.
,
− 2  ≤
max 

∂zk
∂zk v1
∂zk
v1
d · |w − z|2

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

43

Similar bounds hold for (∂w /∂z k )(1/v 1 ) and (∂w /∂z k )(−vi /v 21 ) . (Of course we also
have (∂w /∂z k )(1/v1 ) = 0 , etc.).
Next we need bounds for |∂w αij /∂zk | and |∂w αij /∂z k | .
From the formulas u1 = v1 = w1 − z1 and uh = vh /v1 = (wh − zh )/(w1 − z1 ) for
all h 6= 1 and the multivariable chain rule, we have
( ∂αij Pd vh ∂αij
− ∂u1 + h=2 v2 ∂uh if k = 1 ,
∂u αij
∂w αij
1
=
+
1 ∂αij
∂zk
∂zk
−
if k 6= 1
v1 ∂uk

−1

on W1 ∩ π (U ) . Using bounds for |∂αij /∂uh | and |∂u αij /∂zk | on K1 , we find
constants Mijk such that


∂w αij 
Mijk


(6.7.14)
 ∂zk  ≤ min{1, |w − z|}
on K1 ∩ π −1 (U ) . A similar argument gives the same bound for |∂w αij /∂z k | (after
possibly enlarging Mijk ).
By (6.7.13) and (6.7.14), we then have
(6.7.15)


 X

X
∂w α̃ı̃̃ 
1
′
′′
≤

C
M
+
C
M
on K1 ∩ π −1 (U )
ij
ijk
d
d
 ∂zk  min{1, |w − z|}2d−1
i,j
i,j

(corresponding to (6.7.10)), where again Cd′ and Cd′′ depend only on d . Again, the
same bound is true for |∂w α̃ı̃̃ /∂z k by the same argument.
(Note that the bounds (6.7.13) and (6.7.14) are worse than the corresponding
bounds used when proving (6.7.1) by a factor 1/|w − z| or 1/ min{1, |w − z|} , so
the bound in (6.7.15) is worse than (6.7.10) by that same amount since each term in
Leibniz’s rule contains only one derivative.)
The rest of the proofs of (6.7.2) and (6.7.3) proceed as for (6.7.1).

The following lemma applies the preceding lemma to give local information on
forms of type (6.3.1).
Lemma 6.8. Let V ′′ ⋐ V ′ ⋐ V be open subsets of Cd with d ≥ 1 and V ′′ convex.
Let ∆ , U , and π : WV → V × V be as in Lemma 6.7. Let α , β , and γ be
smooth (d − 1, d − 1)-forms on U such that
(6.8.1)

γ = (− log |z − w|2 )α + β

at all (w, z) ∈ U , and such that π ∗ α and π ∗ β extend to smooth forms on WV .
Let τ : (Gr1 T V ) × V → V × V , ψ , and χγ : τ −1 (U ) → C be as in Lemma 6.5.
Then there exist real constants r0 ∈ (0, 1] , c2 , and c3 , depending only on V ′′ ,
V ′ , ψ , α , and β , such that the bound
|χγ (w, H, z) − χγ (w, H, z′ )|


c2 + c3 (− log ρ) c2 + c3 (− log ρ′ )
≤ max
,
|z − z′ |
ρ2d−1
(ρ′ )2d−1

44

PAUL VOJTA

holds for all (w, H) ∈ Gr1 T V and all z, z′ ∈ V ′′ such that w ∈ V ′ \ {z, z′ } ,
where
ρ = min{r0 , |z − w|}

ρ′ = min{r0 , |z′ − w|} .

and

Proof. Fix r0 > 0 such that r0 ≤ 1 and r0 is at most the distance between V ′′ and
Cd \ V ′ .
Let w , H , z , and z′ be as in the statement of the lemma. We may assume that
|z − w| ≤ |z′ − w| . Then ρ ≤ ρ′ .
Let B be the open ball of radius ρ about w .
We first claim that there is a piecewise smooth path from z to z′ of length at
most (π/2)|z − z′ | and lying entirely in V ′ \ B . Indeed, start with the straight-line
path from z to z′ . It lies entirely in V ′′ . If it does not pass through B , then we
are done. Otherwise, replace the segment in B with a path along a great circle on ∂B
of minimal length that joins the endpoints of that segment. This increases the length
of that segment by a factor of at most π/2 , so the revised path has length at most
(π/2)|z − z′ | . Also, no point on the great circle is further than ρ ≤ r0 from a point on
the original line segment, so the revised path stays entirely in V ′ . (This rerouting can
take place within a plane in Cd = R2d that contains the three points w , z , and z′ .)
Let y : [0, ℓ] → V ′ \ B be this path, parameterized by arc length. It will then
suffice to show that


d


 ≤ 2 · c2 + c3 (− log ρ)
(6.8.2)
χ
(w,
H,
y(t))
γ
 dt
 π
ρ2d−1
at smooth points of the path, since that would give
|χγ (w, H, z) − χγ (w, H, z′ )| ≤

c2 + c3 (− log ρ)
|z − z′ | .
ρ2d−1

To see (6.8.2), let χα and χβ be as in Lemma 6.5. Then
χγ (w, H, y) = (− log |y − w|2 )χα (w, H, y) + χβ (w, H, y)
for all y ∈ V . Then (6.8.2) follows from the bounds (6.7.1)–(6.7.3) applied to χα and
χβ , together with the inequality |(d/dt)(− log |y(t) − w|) ≤ 1/ρ at smooth points of
the path.

This can be translated to a result on the complex manifold X .
Corollary 6.9. Let X be a smooth complex projective variety of dimension d ≥ 1 . Let
ψ be a smooth positive (d − 1, d − 1)-form on X . Let (U, φ) be a coordinate chart
on X , and let U ′′ ⋐ U be a nonempty open subset such that φ(U ′′ ) is convex.
Then there is a measurable function f : X × U ′′ → [0, ∞] such that
(i). for all ξ ∈ κ(X)∗ , the inequality
(6.9.1)
Z

 
X

− log |ξ(x)| + log |ξ(x′ )| ≤ φ(x) − φ(x′ )
f (w, x) + f (w, x′ ) · ψ(w)
|nD |
D

Dreg

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

45

P
holds for all x, x′ ∈ U ′′ , where (ξ) = D nD D as in Proposition 6.3c; and
(ii). there exists a constant c4 , depending only on X , γ , ψ , U , U ′′ , and φ ,
such that
Z
f (w, x) dφ∗ µ(x) ≤ c4
(6.9.2)
U ′′

for all w ∈ X , where µ is the standard measure on Cd .
Proof. Let g∆ be as in Proposition 6.3, write γ = g∆ , and let χγ be as in Lemma 6.5
(applied with M1 = M2 = X and α = γ ).
We first claim that there exists a function f for which the inequality
(6.9.3)

|χγ (w, H, x) − χγ (w, H, x′ )| ≤ max{f (w, x), f (w, x′ )}|φ(x) − φ(x′ )|

holds for all w ∈ X and all x, x′ ∈ U ′′ \ {w} .
Pick an open subset U ′ such that U ′′ ⋐ U ′ ⋐ U . Let τ1 : Gr1 T X → X be as in
Lemma 6.3.
Note that
(6.9.4)

χ(φ−1 )∗ γ (φ(w), H, φ(x)) = χγ (w, H, x)

for all (w, H) ∈ τ1−1 (U ) and all x ∈ U \ {w} , and that (φ−1 )∗ γ is of the form
(6.8.1) (using the fact that if s and k · k are as in Proposition 6.3 then the function
(w, z) 7→ − log ks(φ−1 (w), φ−1 (z))k2 + log |z − w|2 extends to a smooth function on
φ(U ) × φ(U ) ).
Then, by Lemma 6.8, there are real constants r0 > 0 , c2 , and c3 , such that,
letting
c2 + c3 (− log min{r0 , |φ(x) − φ(w)|})
f (w, x) =
min{r0 , |φ(x) − φ(w)|}2d−1
for all w ∈ U ′ and all x ∈ U ′′ \ {w} , (6.9.3) holds whenever w ∈ U ′ .
Since the set τ1−1 (X \ U ′ ) × U ′′ is compact and χγ is smooth on an open neighborhood of this set, there is a constant c4 such that
|Dz ((w, H, z) 7→ χγ (w, H, φ−1 (z)))| ≤ c4
for all (w, H) ∈ τ1−1 (X \ U ′ ) and all z ∈ φ(U ′′ ) . Here Dz means the vector consisting
of all partial derivatives in the coordinates of z . Then, letting
f (w, x) = c4
for all w ∈
/ U ′ , it now follows that (6.9.3) holds without additional restrictions on w .

46

PAUL VOJTA

By (6.3.3), (6.6.1), and (6.9.3), we then have


− log |ξ(x)| + log |ξ(x′ )|



X

′ 
nD (gD (x) − gD (x ))
=


D
Z
X


χγ (σD ,1 (w), x) − χγ (σD ,1 (w), x′ ) · ψ(w)
≤
|nD |
reg
reg
Dreg

D

′

≤ |φ(x) − φ(x )|

X
D

|nD |

Z

Dreg

max{f (w, x), f (w, x′ )} · ψ(w) ,

and this gives (6.9.1).
Finally, (6.9.2) follows from the fact that φ(U ′′ ) is bounded and that the integrals
Z

Dd

dµ(z)
|z|2d−1

Z

and

Dd

log |z|
dµ(z)
|z|2d−1

converge.



The next lemma combines Corollaries 6.6 and 6.9 to show that − log |ξ| obeys a
Lipshitz condition after removing a set of arbitrarily small (but nonzero) measure, with
prescribed uniformities.
We start with a definition.
Definition 6.10. Let X be a smooth projective variety of dimension d ≥ 1 , and let M
be an ample line sheaf on X .
(a). For all divisors D on X , let
degM D = c1 (M )·(d−1) · D .
(b). For all ξ ∈ κ(X)∗ , write (ξ) =
let
(6.10.1)

degM ξ =

P

D

nD D as in Proposition 6.3c. Then we

1X
|nD | degM D .
2
D

If, moreover, X is a variety over C and if M is a smoothly metrized line sheaf
on X such that Mfin is ample, then degM is defined to be degMfin in the above
two contexts.
Remark 6.11. Let X , M , and ξ be as above. Then the divisors
(ξ)0 :=

X
D

max{0, nD }D

and

(ξ)∞ :=

X
D

max{0, −nD }D

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

47

are linearly equivalent, so
(6.11.1)

degM ξ = degM (ξ)∞ .

In particular, if X = P1 and M = O(1) , then degM ξ coincides with the degree of ξ
as a rational function.
Remark 6.12. Let X be a smooth complex projective variety of dimension d ≥ 1 , let
M be a smoothly metrized line sheaf on X such that Mfin is ample, and let D be a
prime divisor on X . Then
Z
Z
∧(d−1)
c1 (k · kM )∧(d−1) .
c1 (k · kM )
=
(6.12.1)
degM D =
Dreg

D

Therefore if ξ ∈ κ(X)∗ , then by (6.10.1)
(6.12.2)

degM

1X
|nD |
ξ=
2
D

Z

Dreg

c1 (k · kM )∧(d−1) .

Lemma 6.13. Let X , U , U ′′ and φ be as in Corollary 6.9, and let M be a smoothly
metrized line sheaf on X with positive metric. Then for all ǫ1 > 0 there is a
constant c5 such that the following is true. For each ξ ∈ κ(X)∗ there is a closed
subset T of U ′′ such that µ(φ(T )) ≤ ǫ1 and such that the inequality
(6.13.1)





− log |ξ(x)| + log |ξ(x′ )| ≤ c5 (degM ξ)φ(x) − φ(x′ )

holds for all x, x′ ∈ U ′′ \ T .

Proof. We apply Corollary 6.9 with ψ = c1 (k · kM )∧(d−1) (note that ψ is positive by
Proposition 1.5a). This gives a function f : X × U ′′ → [0, ∞] and a constant c4 that
satisfy (6.9.1) and (6.9.2). Let
4c4
.
c5 =
ǫ1
P
Let ξ ∈ κ(X)∗ , and write (ξ) = D nD D as in Proposition 6.3c. By (6.9.1), it
then suffices to construct a suitable set T such that
Z
X

f (w, x) + f (w, x′ ) · ψ(w) ≤ c5 degM ξ
|nD |
Dreg

D

for all x, x′ ∈ U ′′ \ T . For this, in turn, it suffices to find T such that
(6.13.2)

X
D

|nD |

Z

Dreg

f (w, x) · ψ(w) ≤

c5
degM ξ
2

48

PAUL VOJTA

for all x ∈ U ′′ \ T .
Let g : U ′′ → [0, ∞] be the function defined by
Z
X
f (w, x) · ψ(w) .
g(x) =
|nD |
Dreg

D

Then (6.13.2) holds with
n
o
c5
T = x ∈ U ′′ : g(x) ≥
degM ξ .
2

It remains only to show that µ(φ(T )) ≤ ǫ1 . Indeed, by Tonelli’s theorem, (6.9.2), and
(6.12.2), we have
Z
Z
Z
X
∗
f (w, x) · ψ(w) dφ∗ µ(x)
g(x) dφ µ =
|nD |
U ′′

D

=

X
D

≤

X
D

|nD |
|nD |

Z

Z

x∈U ′′

w∈Dreg

w∈Dreg

Z

x∈U

′′

f (w, x) dφ∗ µ(x) · ψ(w)

c4 ψ
Dreg

= 2c4 degM ξ
ǫ1 c5
degM ξ .
=
2
Then µ(φ(T )) ≤ ǫ1 by Lemma 6.1.



Coordinate charts as in Corollary 6.9 and Lemma 6.13 will now be used to obtain
global results on X , via the following construction.
Let X be a smooth complex projective variety of dimension d ≥ 1 . Since X is
compact, there exists a finite collection
(6.14)

{(Ui , φi , Ui′′ ) : i = 1, . . . , n}

with U1′′ , . . . , Un′′ covering X , such that for each i , (Ui , φi ) is a coordinate chart on
X , Ui′′ ⋐ Ui is a nonempty open subset, and φi (Ui′′ ) is convex.
Let M be a smoothly metrized line sheaf on X with positive metric, and let
θ = c1 (k · kM )∧d . This is a positive (d, d)-form by Proposition 1.5a, so it defines
a measure µθ on X . For all i , the measures µθ and φ∗i µ on Ui are related by
µθ = ρi · φ∗i µ , where ρi : Ui → R>0 is smooth. Since Ui′′ is compact, there are
constants c6,i and c7,i such that
(6.15)

c6,i φ∗i µ ≤ µθ ≤ c7,i φ∗i µ

on Ui′′ .
This construction then leads to the main result of this section.

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

49

Proposition 6.16. Let X be a smooth complex projective variety of dimension d ≥ 1 ,
let M be a smoothly metrized line sheaf on X with positive metric, let
θ = c1 (k · kM )∧d , and let µθ be the corresponding measure on X . Then, for
all ǫ2S
> 0 and ǫ3 > 0 there is a finite collection of subsets C1 , . . . , CΛ of X such
that l Cl = X and such that the following is true. For each ξ ∈ κ(X)∗ there is
a measurable subset T of X such that µθ (T ) ≤ ǫ2 and such that


− log− |ξ(x)| + log− |ξ(x′ )| ≤ ǫ3 degM ξ
(6.16.1)
for all x, x′ ∈ Cl \ T and all l = 1, . . . , Λ .

Proof. Choose triples (Ui , φi , Ui′′ ) as in (6.14), and fix for now an index i . Let c7,i be
as in (6.15).
By Lemma 6.13, there is a constant c5,i such that for each ξ ∈ κ(X)∗ there is
a subset Ti ⊆ Ui′′ such that µ(φi (Ti )) ≤ ǫ2 /nc7,i and such that (6.13.1) holds for all
x, x′ ∈ Ui′′ \ Ti .
S
Choose subsets Ci,1 , . . . , Ci,Λi of Ui′′ such that l Ci,l = Ui′′ and such that φ(Ci,l )
has diameter at most ǫ3 /c5,i for all l . Let ξ ∈ κ(X)∗ . Then




− log |ξ(x)| + log |ξ(x′ )| ≤ c5,i (degM ξ)φ(x) − φ(x′ )
≤ ǫ3 degM ξ
for all l = 1, . . . , Λi and all x, x′ ∈ Ci,l \ Ti , where Ti is the subset chosen above for
the given ξ .
Now,
Sletting i vary, let C1 , . . . , CΛ be the collection of all Ci,l . Given ξ as above,
let T = i Ti ; then
µθ (T ) ≤

n
X
i=1

c7,i µ(φi (Ti )) ≤

n
X
ǫ2
i=1

n

= ǫ2 ,

and (6.16.1) holds for T .



§7. Reduction to Simultaneous Approximation: The Excluded Set T
Proposition 6.16 in the previous section involved excluding a set T , which can be
chosen to have arbitrarily small measure. This section provides the key estimate needed
in order to show that excluding this set does not affect the diophantine estimates
excessively.
7.1. Throughout this section, X is a smooth complex projective variety of
dimension d ≥ 1 , M is a smoothly metrized line sheaf on X with positive
metric, θ = c1 (k · kM )∧d , ψ = c1 (k · kM )∧(d−1) , and µθ is the measure on
X associated to θ .
We start with some definitions.

50

PAUL VOJTA

Definition 7.2. Let
·d

degM X = c1 (Mfin ) =
and let
hX (ξ) =
∗

Z

X

Z

θ,
X

− log− |ξ|2 · θ

for all ξ ∈ κ(X) .
The main result of this section is then the following.
Proposition 7.3. Let X , d , M , θ , and µθ be as in (7.1). Then for all ǫ4 > 0 there
is an ǫ5 > 0 such that the inequality
(7.3.1)

Z

T

− log− |ξ|2 · θ ≤ ǫ4 degM ξ +

µθ (T )
(2hX (ξ) + c8 degM ξ) .
degM X

holds for all ξ ∈ κ(X)∗ and all measurable T ⊆ X with µθ (T ) ≤ ǫ5 . Here c8 is
a constant that depends only on X and M .
To prove the proposition, we write
− log |ξ|2 =

(7.4)

X

nD gD + cξ

D

for all ξ ∈ κ(X)∗ as in (6.3.3), and bound the integrals of each term on the right-hand
side separately.
Lemma 7.5. Let (U, φ) be a coordinate chart on X , and let U ′′ ⋐ U be a nonempty
open subset. Then for all ǫ6 > 0 thereP
is an ǫ7 > 0 such that the following is
∗
true. Let ξ ∈ κ(X) , and write (ξ) = D nD D in the notation of (7.4). Then
for all measurable subsets T ⊆ U ′′ such that µ(φ(T )) ≤ ǫ7 , we have
Z
X
gD (x) dφ∗ µ(x) ≤ ǫ6 degM ξ .
(7.5.1)
nD
T

D

Proof. Let γ = g∆ and let χγ be as in Lemma 6.5. By (6.6.1) and Tonelli’s theorem,
(7.5.1) is equivalent to
Z
Z
X
χγ (σDreg ,1 (w), x) dφ∗ µ(x) · ψ(w) ≤ ǫ6 degM ξ .
(7.5.2)
nD
D

Dreg

T

To prove this, it suffices to show that the inequality
Z
ǫ6
|χγ (w, H, x)| dφ∗ µ(x) ≤
(7.5.3)
2
T

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

51

holds for all w ∈ X , all H , and all T ⊆ U ′′ with µ(φ(T )) ≤ ǫ7 (where ǫ7 is to be
chosen later). Indeed, integrating (7.5.3) and applying (6.12.2) implies (7.5.2).
To show (7.5.3), choose an open subset U ′ ⊆ U such that U ′′ ⋐ U ′ ⋐ U , and let
V = φ(U ) , V ′ = φ(U ′ ) , and V ′′ = φ(U ′′ ) . Fix r0 ∈ (0, 1] such that r0 is at most
the distance between V ′′ and Cd \ V ′ . By (6.9.4) and the fact that (φ−1 )∗ γ is of the
form (6.8.1), we obtain from (6.7.1) that there are constants c and c′ , depending only
on X , γ , ψ , U , U ′ , U ′′ , φ , and r0 , such that
(7.5.4)

|χγ (w, H, x)| ≤

c + c′ (− log ρ)
ρ2d−2

for all w ∈ U ′ , all H , and all x ∈ U ′′ \ {w} , where
ρ = min{r0 , |φ(w) − φ(x)|} .
We may assume that c, c′ ≥ 0 .
Next, we claim that for all ǫ6 > 0 there is an ǫ7 > 0 such that, for all Te ⊆ V ′′
with µ(Te) ≤ ǫ7 and for all w ∈ V ′ , we have
Z
c + c′ (− log min{r0 , |w − z|})
ǫ6
(7.5.5)
dµ(z) ≤
.
2d−2
min{r
,
|w
−
z|}
2
e
0
T
Basically, this follows from the fact that the integrand is a function of w − z , and that
the latter function is locally L1 .
In more detail, let Ddr = {z ∈ Cd : |z| < r} . The integral in (7.5.6) converges for
all r > 0 ; therefore there is a number r > 0 such that
Z
ǫ6
c + c′ (− log min{r0 , |z|})
dµ(z) ≤
.
(7.5.6)
2d−2
min{r0 , |z|}
2
Dd
r
Pick such an r and let ǫ7 = µ(Drd ) . Then
Z
Z
c + c′ (− log min{r0 , |z|})
ǫ6
c + c′ (− log min{r0 , |z|})
dµ(z)
≤
dµ(z) ≤
2d−2
2d−2
min{r0 , |z|}
min{r0 , |z|}
2
e
Dd
T
r
for all Te ⊆ Cd with µ(Te) ≤ ǫ7 . This then gives (7.5.5) by translation.
Combining (7.5.5) with (7.5.4) then gives (7.5.3) for all w ∈ U ′ .
Next consider w ∈
/ U ′ . Let τ1 : Gr1 T X → X be as in Lemma 6.5, and let c′′ be
the maximum of |χγ | over the compact set τ1−1 (X \ U ′ ) × U ′′ . We then have
Z
|χγ (w, H, x)| dφ∗ µ(x) ≤ c′′ ǫ7
T

for all w ∈ X \ U ′ , all H , and all T ⊆ U ′′ for which µ(φ(T )) ≤ ǫ7 .
Assume now that ǫ7 has been chosen so that c′′ ǫ7 ≤ ǫ6 /2 . Then (7.5.3) holds also
for all w ∈
/ U ′ , so it holds for all w ∈ X .

The following lemma translates the above lemma into the global setting.

52

PAUL VOJTA

Lemma 7.6. For all ǫ4 > 0 there isPan ǫ5 > 0 such that the following is true. Let
ξ ∈ κ(X)∗ , and write (ξ) =
D nD D in the notation of (7.4). Then for all
measurable subsets T ⊆ X such that µθ (T ) ≤ ǫ5 , we have
(7.6.1)

X

Z

nD

gD (x) dµθ (x) ≤ ǫ4 degM ξ .

T

D

Proof. Choose triples (Ui , φi , Ui′′ ) as in (6.14), and fix for now an index i . Let c6,i
and c7,i be as in (6.15).
By Lemma 7.5 there is an ǫ7,i > 0 such that (7.5.1) holds with ǫ6 = ǫ4 /nc7,i for
all T ⊆ Ui′′ with µ(φi (T )) ≤ ǫ7,i and all ξ ∈ κ(X)∗ . By (7.5.1) and (6.15),
X

nD

D

Z

T

gD (x) dµθ (x) ≤

ǫ4
degM ξ
n

for all such T and ξ .
Now let
ǫ5 = min c6,i ǫ7,i .
1≤i≤n

Let T be a measurable subset of X with µθ (T ) ≤ ǫ5 . By (6.15), we have
µ(φi (T ∩ Ui′′ )) ≤ ǫ5 /c6,i ≤ ǫ7,i
for all i , and therefore
X

nD

D

Z

T ∩Ui′′

gD (x) dµθ (x) ≤

ǫ4
degM ξ
n

holds for all ξ and all i . Summing over i then gives (7.6.1).
The next step in proving Proposition 7.3 is to find an upper bound for cξ .
To find this bound, we first find an upper bound for
(7.7)

c′ξ

:=

1
degM X

Z

X

− log |ξ|2 · θ

(this is the average value of − log |ξ|2 over X ).
Lemma 7.8. Let ξ ∈ κ(X)∗ . Then
c′ξ ≤

2
degM X

hX (ξ) .



ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

53

′

Proof. Let ξ0 = ecξ /2 ξ , so that − log |ξ(x)|2 = − log |ξ0 (x)|2 + c′ξ and therefore
Z
− log |ξ0 |2 · θ = 0 .
X

Hence
(7.8.1)

hX (ξ0 ) =

Z

−

X

2

− log |ξ0 | · θ =

Z

X

log+ |ξ0 |2 · θ .

2

Let λ(x) = − log |ξ0 (x)| for all x ∈ X outside of the support of the principal divisor
(ξ0 ) = (ξ) , and for t ∈ R let
Z
max{0, λ + t} · θ .
f (t) =
X

Then hX (ξ) =

f (c′ξ ) ,

so it suffices to show that
f (t) ≥

(7.8.2)

degM X
t
2

for all t ∈ R .
Note that f is continuous, and is differentiable outside a countable set. Also
f ′ (t) = µθ ({x ∈ X : λ(x) + t ≥ 0})

(7.8.3)

wherever f ′ (t) is defined. By abuse of notation, we use (7.8.3) to extend f ′ to a
function on all of R . Note that f ′ is an increasing function of t , so f is concave
upward. Also
lim f (t) = lim f ′ (t) = 0

t→−∞

Let

t→−∞

and

lim f ′ (t) = degM X .

t→∞



degM X
′
β = sup t : f (t) ≤
.
2

Then, by concavity, it suffices to show that (7.8.2) holds when t = β .
This is trivial when β ≤ 0 , so assume that β > 0 .
We have
degM X
µθ ({x : λ(x) + β > 0}) = lim f ′ (β − 1/n) ≤
;
n→∞
2
hence
µθ ({x : log |ξ0 (x)|2 ≥ β}) = µ({x : λ(x) ≤ −β}) ≥

degM X
.
2

Then, by (7.8.1) and trivial properties of integration,
Z
degM X
log+ |ξ0 (x)|2 · θ ≥
f (β) ≥ f (0) = hX (ξ0 ) =
β.
2
X
To bound cξ , it then suffices to compare cξ and c′ξ .



54

PAUL VOJTA

Lemma 7.9. There is a constant c8 , depending only on X and M , such that
|c′ξ − cξ | ≤

c8 degM ξ
degM X

for all ξ ∈ κ(X)∗ .

Proof. Let V ′′ ⋐ V ′ ⋐ V , γ , and χγ be as in Lemma 6.8. By (6.8.1) and (6.7.1),


max{1, − log |z − w|}
|χγ (w, H, z)| ≤ O
|z − w|2d−2

for all w ∈ V ′′ and all z ∈ V ′ \ {w} , where the implicit constant is independent of z
and w . Therefore
Z
|χγ (w, H, z)| dµ(z) ≤ O(1)
V′

′′

for all w ∈ V and all H , uniformly in w and H .
Let U ′′ ⋐ U ⊂ X and φ : U → Cd be as in Corollary 6.9, let γ and χγ be as in
the proof of Corollary 6.9, and let U ′ be an open subset of X with U ′′ ⋐ U ′ ⋐ U .
Then, by (6.15),
Z
U′

|χγ (w, H, x)| · θ(x) ≤ O(1)

for all w ∈ U ′′ and all H , uniformly in w and HR. A standard compactness argument
on τ1−1 (U ′′ ) × (X \ U ′ ) gives a similar bound on X |χγ (w, H, x)| · θ(x) for all w ∈ U ′′
and all H .
Applying this bound to all charts in a finite set of charts as in (6.15) then gives a
constant c8 such that
Z
c8
|χγ (w, H, x)| · θ(x) ≤
(7.9.1)
2
X
for all w ∈ X and all H .
By (7.7), (7.4), (6.6.1), Tonelli’s theorem, (7.9.1), and (6.12.2), we then have

Z

 X
1


′
nD gD · θ 
|cξ − cξ | =


degM X  X
D
Z
! 
Z


X
1


=
χγ (σDreg ,1 (w), x) · ψ(w) · θ 
nD


degM X  X
Dreg
D
Z
Z
X


1
χγ (σDreg ,1 (w), x) · θ(x) · ψ(w)
|nD |
≤
degM X
Dreg X
D
Z
X
1
c8
≤
|nD |
· ψ(w)
degM X
Dreg 2
D

c8 degM ξ
.
=
degM X



ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

55

The proof of Proposition 7.3 is then a matter of combining these lemmas, as follows.
Proof of Proposition 7.3. Let ξ ∈ κ(X)∗ , and let T be as in the statement of the
proposition. Let T ′ = {x ∈ T : |ξ(x)| < 1} . Then µθ (T ′ ) ≤ µθ (T ) and
Z
Z
2
− log− |ξ|2 · θ ,
− log |ξ| · θ =
T

T′

so instead of (7.3.1) it will suffice to prove
(7.10)

Z

T

− log |ξ|2 · θ ≤ ǫ4 degM ξ +

µθ (T )
(2hX (ξ) + c8 degM ξ)
degM X

for all T as in the proposition.
Given ǫ4 > 0 , let ǫ5 > 0 be as in Lemma 7.6. Then (7.10) follows from (7.4),
Lemma 7.6, Lemma 7.8, and Lemma 7.9.

§8. Reduction to Simultaneous Approximation: Arithmetic
This section translates Propositions 6.16 and 7.3 into the arithmetic setting, and proves
a result on reduction to simultaneous approximation (Proposition 8.9) that will be
sufficient to prove Roth’s theorem.
Recall from (4.1) that K is an arithmetic function field, that M = (B; M ) is a
(big) polarization of K , and that S ⊆ MK is a subset of finite measure. Also recall
from (5.1)–(5.4) that S contains all archimedean places of K , that B is generically
smooth, and that M is ample with positive metric.
Let F be the algebraic closure of Q in K (i.e., the set of all elements of K that
are algebraic over Q ). It is a number field (by ([Lang 2002], Ch. VII, Ex. 4) it is
finitely generated over Q , and by definition it is algebraic over Q ; hence [F : Q] < ∞ ).
Since B is normal and OF is integral over Z , the canonical morphism B → Spec Z
factors uniquely through a morphism π : B → Spec OF . Also, we write BF = B×OF F ,
and if L is a continuously metrized line sheaf on B then LF will denote the pull-back
of Lfin to BF .
For any embedding σ : F → C , we let Cσ denote the field C , viewed as an
extension field of F via σ , and let Bσ = (BF ×F Cσ )an . We then have
B(C) =

a

Bσ .

σ : F →C

By ([Grothendieck 1965], EGA IV 4.5.10), BF is geometrically integral over F .
Therefore the schemes BF ×F Cσ are integral for all σ , and the Bσ correspond to the
irreducible components of B ×Z C .
Let L be a continuously metrized line sheaf on B . For all σ : F ֒→ C , we let
Lσ denote the restriction LC Bσ . Then, for example, a global section of L is strictly
small if and only if its pull-back to Lσ is strictly small for all σ .

56

PAUL VOJTA

Definition 8.1. For all ξ ∈ K ∗ , we define
(8.1.1)


deg ξ = degM ξ = degMF (ξ)∞ BF ,


where degMF (ξ)∞ B is as in Definition 6.10. (In the latter, note that the interF
section degree is taken relative to F .)
We also let
∞
deg B = degM B = µ(MK
).

(8.1.2)

For all σ : F ֒→ C , let Mσ denote the pull-back of M to Bσ , and for all ξ ∈ K ∗
let ξσ denote the pull-back of ξ to an element of κ(Bσ ) . Then
(8.2)

deg ξ = degMσ ξσ

for all σ .

Also, µθ in (7.1) coincides with µ on Bσ ⊆ B(C) for all σ . Therefore
(8.3)

µ(Bσ ) = degMσ Bσ = c1 (MF )·d =

∞
µ(MK
)
deg B
=
[F : Q]
[F : Q]

by (3.3) and (8.1.2).
Next we show that deg ξ is bounded by a linear function of the height.
Lemma 8.4. For all ξ ∈ K ,
(8.4.1)

deg ξ ≪ hK (ξ) ,

where the implicit constant depends only on K and the polarization.
Proof. For all a ∈ R let Va be the line sheaf on B defined as in Proposition 2.12.
By Proposition 2.12, there is an ǫ > 0 such that N := M ⊗ V−ǫ is ample. Let h′K
denote the height on K defined using the polarization M ′ := (B; N ) .
As noted below (3.5),
(8.4.2)

h′K (ξ) ≥ 0

for all ξ ∈ K .
∞
Since c1 (k · kV−ǫ ) = 0 , the measure µ on MK
is the same for M ′ as for the


(1)
polarization M = (B, M ) . Now consider Y ∈ B . Since c1 V−ǫ Y · c1 V−ǫ Y = 0 ,
we have
 ·(d−1)
 
hM ′ (Y ) − hM (Y ) = d c1 M Y
· c1 V−ǫ Y
 ·(d−1)
= d c1 M Y
· (0, −2ǫ)
Z
∧(d−1)
c1 k · kM
= −ǫd
YC

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

57

by (1.7). If Y is vertical then this is zero; otherwise it equals −ǫd[F : Q] degM Y by
(6.12.1) and (8.2). By (3.5), (8.1.1), and (8.4.2), we then have
hK (ξ) = h′K (ξ) + ǫd[F : Q] deg ξ ≫ deg ξ .



Note that µθ coincides with µ on Bσ ⊆ B(C) . Therefore, by (3.5) and the
product formula (3.4),
X
(8.5)
hBσ (ξ) ≤ hK (1/ξ) = hK (ξ)
σ : F ֒→C

for all ξ ∈ K ∗ , where hBσ is as in Definition 7.2.
Finally, we note that
(8.6)

hK (ξ ± α) ≤ hK (ξ) + hK (α) + (log 2) deg B

for all ξ, α ∈ K . Indeed, this follows from the elementary inequality

1 if v is non-archimedean ,
max{1, kξ ± αkv } ≤ max{1, kξkv } · max{1, kαkv } ·
2 if v is archimedean ,
together with (3.5) and (8.1.2).
The following lemma adapts Proposition 7.3 to K and its polarization.
Lemma 8.7. For each ǫ8 > 0 there is an ǫ5 > 0 such that
Z
− log− kξkv dµ(v) ≤ ǫ8 hK (ξ)
(8.7.1)
T

∞
holds for all ξ ∈ K ∗ and all measurable T ⊆ MK
for which µ(T ) ≤ ǫ5 .

∞
Proof. If d = 0 then MK
is a finite set and µ is the counting measure, so the result
is trivial with ǫ5 = 1/2 .
Now assume that d ≥ 1 .
For each σ : F ֒→ C , Proposition 7.3, (8.2), and (8.3) imply that for each ǫ4 > 0
there is an ǫ5 > 0 such that
Z

c8
µ(T ∩ Bσ ) 
ǫ4
hBσ (ξ) +
deg ξ +
deg ξ
− log− kξkv dµ(v) ≤
(8.7.2)
2
µ(Bσ )
2
T ∩Bσ

holds for all ξ ∈ K ∗ and all measurable T ⊆ B(C) with µ(T ∩ Bσ ) ≤ ǫ5 .
Let c′ be the implicit constant in (8.4.1). Choose ǫ4 > 0 and shrink ǫ5 if necessary
so that
c′ ǫ4 [F : Q] ǫ5 [F : Q] 
c8 
1 + c′ ≤ ǫ8 .
+
2
deg B
2
Summing (8.7.2) over all σ then gives (8.7.1), by (8.3) and (8.5).

The following proposition gives a similar adaptation of Proposition 6.16.



58

PAUL VOJTA

Proposition 8.8. For all ǫ9 > 0 and all ǫ10 > 0 there is a finite collection C1 , . . . , CΛ
of measurable subsets of S that cover S , such that the following condition is true.
∞
For all ξ ∈ K ∗ there is a measurable subset T ⊆ MK
such that µ(T ) ≤ ǫ9 , and
such that


− log− kξkv + log− kξkv′  ≤ ǫ10 hK (ξ)
(8.8.1)
for all v, v ′ ∈ Cl \ T and all l = 1, . . . , Λ .
In addition, we may assume that µ(Cl ) > 0 for all l .

Proof. If d = 0 then S is a finite set, and we can let C1 , . . . , CΛ be disjoint oneelement sets whose union is S . Then the proposition holds trivially with T = ∅ for all
ξ.
Therefore, assume from now on that d ≥ 1 .
Let c′ be the implicit constant in (8.4.1). Applying Proposition 6.16 with X = Bσ
for all σ , and with ǫ2 = ǫ9 /[F : Q] and ǫ3 = ǫ10 /c′ , gives measurable subsets
C0,1 , . . . , C0,Λ0 of B(C) whose union is B(C) , such that for all ξ ∈ K ∗ there is a
measurable subset Tξ of B(C) such that µ(Tξ ) ≤ ǫ9 for all σ , and such that


− log− |ξ(x)| + log− |ξ(x′ )| ≤ ǫ10 hK (ξ)

for all x, x′ ∈ C0,l \ Tξ and all l = 1, . . . , Λ0 .
Let Cl = C0,l ∩ S for all l = 1, . . . , Λ0 , and let CΛ0 +1 , . . . , CΛ be disjoint one0
element sets whose union is S ∩ MK
. Then C1 , . . . , CΛ are measurable subsets of S
that cover S . Moreover (8.8.1) holds for each ξ ∈ K ∗ , with T = Tξ ∩ S .
For the last assertion, that all Cl have nonzero measure, it suffices to reduce the
proposition to the same statement without that assertion.
So assume that C1 , . . . , CΛ satisfy the conditions of the proposition, except that
some of them may have measure zero. Let T0 be the union of those Cl that have
measure zero. Let C1′ , . . . , CΛ′ ′ be the list of subsets of S obtained from the original
list by (i) removing all Cl that have measure zero, and (ii) adding the elements of T0
to some remaining Cl that contains archimedean places. Then, if T is a subset of S
that satisfies the conditions of (b) with respect to C1 , . . . , CΛ , then T ∪ T0 satisfies

those conditions with respect to C1′ , . . . , CΛ′ ′ .
The next result is the main result of this section. It carries out reduction to
simultaneous approximation, in a way that gives what is needed for the next step of
the proof.

Proposition 8.9. Let α1 , . . . , αq be distinct elements of K . Let ǫ > 0 and c ∈ R ,
and assume that (4.5.1) is false for these values of ǫ and c and for all ξ in an
infinite subset Σ of K . Let n be a positive integer, let ǫ′ ∈ (0, ǫ) , let c′ ∈ R ,
and let rmin ∈ R . Then there exist ξ1 , . . . , ξn ∈ Σ and disjoint measurable subsets
T1 , . . . , Tq of S such that
(8.9.1)

hK (ξi )
≥ rmin
hK (ξi−1 )

for all i = 2, . . . , n

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

59

and
(8.9.2)

q Z
X
j=1

Tj

c′
− log− kξi − αj kv
dµ(v) ≥ 2 + ǫ′ +
.
1≤i≤n
hK (ξi )
hK (ξ1 )
min

Proof. Choose ǫ8 > 0 , ǫ10 > 0 , and hmin > 0 such that
(8.9.3)

(4 + 2c9 )ǫ10 µ(S) + qǫ8 (1 + c9 ) +

where
c9 =

1
hmin



max{0, c′ − c}
≤ ǫ − ǫ′ ,
hmin

max hK (αj ) + (log 2) deg B

1≤j≤q



.

Note that, by (8.6), if ξ ∈ K and hK (ξ) ≥ hmin then
hK (ξ − αj ) ≤ (1 + c9 )hK (ξ)

(8.9.4)

for all j = 1, . . . , q .
We may assume that αj ∈
/ Σ for all j , and that hK (ξ) ≥ hmin for all ξ ∈ Σ .
By Lemma 8.7 there is an ǫ5 > 0 such that
Z
− log− kξkv dµ(v) ≤ ǫ8 hK (ξ)
(8.9.5)
T

∞
for all ξ ∈ K ∗ and all measurable T ⊆ MK
for which µ(T ) ≤ ǫ5 .
Let ǫ9 = ǫ5 /2nq . By Proposition 8.8 there are subsets C1 , . . . , CΛ of S , covering
∞
S , such that for all ξ ∈ Σ and all j = 1, . . . , q there is a measurable subset Tξ,j ⊆ MK
with µ(Tξ,j ) ≤ ǫ9 such that

(8.9.6)



− log− kξ − αj kv + log− kξ − αj kv′  ≤ ǫ10 hK (ξ − αj ) ≤ (1 + c9 )ǫ10 hK (ξ)

for all v, v ′ ∈ Cl \ Tξ,j and all l = 1, . . . , Λ , where the last step used (8.9.4). We may
assume that C1 , . . . , CΛ are disjoint.
Let Tξ = Tξ,1 ∪ · · · ∪ Tξ,q . Then µ(Tξ ) ≤ qǫ9 and (8.9.6) holds for all j = 1, . . . , q ,
all v, v ′ ∈ Cl \ Tξ , and all l .
For all ξ ∈ Σ let λξ : S → R be the function
λξ (v) = max − log− kξ − αj kv

(8.9.7)

1≤j≤q



(this is the integrand of (4.5.1)). For each ξ ∈ Σ and each l = 1, . . . , Λ , let
mξ,l



 µ(C ) 
l
.
= inf t ∈ R : µ {v ∈ Cl : λξ (v) ≥ thK (ξ)} ≤
2

60

PAUL VOJTA

(One can think of this as “a median value of λξ (v)/hK (ξ) on Cl .”) Note that, for all
ξ and l , both sets
(8.9.8)

{v ∈ Cl : λξ (v) ≤ mξ,l hK (ξ)}

and

{v ∈ Cl : λξ (v) ≥ mξ,l hK (ξ)}

have measure at least µ(Cl )/2 .
For the next step, we claim that there are constants c10,l , l = 1, . . . , Λ , independent of ξ , such that mξ,l ≤ c10,l for all ξ and l that satisfy µ(Cl ∩ Tξ ) < µ(Cl )/2 .
To show this, let ξ and l be such that µ(Cl ∩Tξ ) < µ(Cl )/2 . Then (with reference
to the second set in (8.9.8)) there is a vξ,l ∈ Cl \ Tξ such that λξ (vξ,l ) ≥ mξ,l hK (ξ) .
Pick j = jξ,l such that λξ (vξ,l ) = − log− kξ − αj kvξ,l . By (8.9.6), we then have
− log− kξ − αj kv ≥ mξ,l hK (ξ) − ǫ10 hK (ξ − αj )
for all v ∈ Cl \ Tξ . Since Cl \ Tξ has measure at least µ(Cl )/2 ,
µ(Cl )
(mξ,l hK (ξ) − ǫ10 hK (ξ − αj )) ≤
2

Z

Cl

− log− kξ − αj kv dµ(v) ≤ hK (ξ − αj ) ;

therefore

µ(Cl )
1+
ǫ10 hK (ξ − αj )
2


µ(Cl )
ǫ10 (1 + c9 )hK (ξ)
≤ 1+
2

µ(Cl )
mξ,l hK (ξ) ≤
2



by (8.9.4), which gives the desired upper bound c10,l independent of ξ .
Next comes a pigeonhole argument.
For each ξ ∈ Σ let mξ be the vector in RΛ whose l-th coordinate is
m′ξ,l

:=



mξ,l
0

if µ(Cl ∩ Tξ ) < µ(Cl )/2 ,

otherwise .

QΛ
Then mξ ∈ l=1 [0, c10,l ] for all ξ ∈ Σ . By a pigeonhole argument, there is a vector
m0 = (m01 , . . . , m0Λ ) ∈ RΛ such that
(8.9.9)

mξ ∈

Λ
Y
[m0l − ǫ10 , m0l + ǫ10 ]
l=1

is true for infinitely many ξ ∈ Σ . Similarly, there are j1 , . . . , jΛ ∈ {1, . . . , q} such that
infinitely many ξ ∈ Σ satisfy both (8.9.9) and
(8.9.10)

jξ,l = jl

for all l = 1, . . . , Λ .

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

61

Therefore, we may choose ξ1 , . . . , ξn ∈ Σ that satisfy (8.9.9), (8.9.10), and also
(8.9.1).
It remains only to show that (8.9.2) holds for this choice of ξ1 , . . . , ξn .
Let T00 = Tξ1 ∪ · · · ∪ Tξn , and let T0 be the union of T00 and all Cl for which
µ(Cl ∩ T00 ) ≥ µ(Cl )/2 . Then µ(T0 ) ≤ 2µ(T00 ) ≤ 2nqǫ9 = ǫ5 , so letting η = ξ1 and
using (8.9.7), (8.9.5), and (8.9.4) (with ξ = η ), we have
Z

(8.9.11)

T0

q
X
λη (v)
hK (η − αj )
dµ(v) ≤ ǫ8
≤ qǫ8 (1 + c9 ) .
hK (η)
hK (η)
j=1

Pick l such that Cl * T0 , and let j = jl . Pick i ∈ {1, . . . , n} and let ζ = ξi .
By (8.9.6) and (8.9.7),
|λζ (v) − λζ (v ′ )|
≤ (1 + c9 )ǫ10
hK (ζ)

(8.9.12)

for all v, v ′ ∈ Cl \ Tζ .
Let v ′′ = vζ,l , and recall that v ′′ ∈ Cl \ Tζ and λζ (v ′′ ) ≥ mζ,l hK (ζ) . Similarly,
there is v ′ ∈ Cl \ Tη such that λη (v ′ ) ≤ mη,l hK (η) .
Then, for all v ∈ Cl \ T0 , and by (8.9.12), the choice of v ′ , (8.9.9), the choice of
′′
v , the definition of j = jl = jζ,l , and (8.9.6), we have
λη (v ′ )
λη (v)
≤
+ (1 + c9 )ǫ10
hK (η)
hK (η)
≤ mη,l + (1 + c9 )ǫ10
≤ mζ,l + (3 + c9 )ǫ10

≤

λζ (v ′′ )
+ (3 + c9 )ǫ10
hK (ζ)

=

− log− kζ − αj kv′′
+ (3 + c9 )ǫ10
hK (ζ)

≤

− log− kζ − αj kv
+ (4 + 2c9 )ǫ10 .
hK (ζ)

Letting i (and therefore ζ ) vary, we then have
(8.9.13)

Z

Cl \T0



λη (v)
− log− kξi − αj kv
− min
hK (η) 1≤i≤n
hK (ξi )



dµ(v) ≤ (4 + 2c9 )ǫ10 µ(Cl ) .

By assumption, (4.5.1) is false for η ; hence
(8.9.14)

Z

S

λη (v)
max{0, c′ − c}
c′
dµ(v) ≥ 2 + ǫ −
+
.
hK (η)
hmin
hK (η)

62

PAUL VOJTA

For all j = 1, . . . , q , let Tj be the union of all Cl for which jl = j . Then, by (8.9.13),
(8.9.11), (8.9.14), and (8.9.3), we have
q Z
X
j=1

− log− kξi − αj kv
dµ(v)
hK (ξi )
Tj 1≤i≤n
Z
λη (v)
≥
dµ(v) − (4 + 2c9 )ǫ10 µ(S)
S\T0 hK (η)
Z
λη (v)
dµ(v) − (4 + 2c9 )ǫ10 µ(S) − qǫ8 (1 + c9 )
≥
S hK (η)
max{0, c′ − c}
c′
≥ 2 + ǫ − (4 + 2c9 )ǫ10 µ(S) − qǫ8 (1 + c9 ) −
+
hmin
hK (η)
′
c
≥ 2 + ǫ′ +
,
hK (η)
min

which is (8.9.2) since η = ξ1 .



§9. Siegel’s Lemma and the Auxiliary Polynomial
Since M is ample, work of X. Yuan and (independently) H. Chen allows one to control
the number of small global sections of M ⊗m as m → ∞ , providing a counterpart to
Axioms 1a and 1b of ([Lang 1983], Ch. 7, § 1).
In more detail, by ([Yuan 2009], § 1.1 and Thm. 2.7) (see also [Chen 2008pre]),
we have
h0 (B, M ⊗m )
= c1 (M )·(d+1) > 0 ,
lim
m→∞ md+1 /(d + 1)!
since M is ample by assumption (5.3). (Recall Definition 2.3a and that dim B = d+1 .)
Therefore there are constants c11 and c12 , with c12 > c11 > 0 , and an integer
m0 (depending on c11 , c12 , and M ), such that the inequality
(9.1)

c11 md+1 ≤ h0 (B, M ⊗m ) ≤ c12 md+1

holds for all integers m ≥ m0 . (Also, c11 and c12 can be taken so that c12 /c11 is
arbitrarily close to 1 , although this fact will not be used here.)
This estimate is sufficient for proving the following Siegel lemma for arithmetic
function fields.
Theorem 9.2. Let c11 , c12 , and m0 be as in (9.1). Let h and b be positive integers,
and let A be an M × N matrix with entries in H 0 (B, M ⊗h ⊗ V− log N ) . Assume
that b ≥ m0 and that
(9.2.1)



h
1+
b

d+1

<

N c11
.
M c12

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

63

Then there is a nonzero vector v ∈ H 0 (B, M ⊗b ⊗ Vlog 2 )N such that Av = 0 (in
⊗(h+b) M
H 0 (B, Mfin
) ).
Proof. By (9.1),
log #H 0 (B, M ⊗b )N ≥ N c11 bd+1 .

On the other hand, if v ∈ H 0 (B, M ⊗b )N then Av lies in H 0 (B, M ⊗(b+h) )M , and
log #H 0 (B, M ⊗(b+h) )M ≤ M c12 (b + h)d+1 .
Therefore, by (9.2.1),
H 0 (B, M ⊗b )N > H 0 (B, M ⊗(b+h) )M ,
so there are distinct vectors v1 , v2 ∈ H 0 (B, M ⊗b )N such that Av1 = Av2 . Let
v = v1 − v2 . Then
v ∈ H 0 (B, M ⊗b ⊗ Vlog 2 )N ,
v 6= 0 , and Av = 0 , as was to be shown.



Now we recall the index of a polynomial in K[x1 , . . . , xn ] .
Definition 9.3. Let n, d1 , . . . , dn ∈ Z>0 , let P ∈ K[x1 , . . . , xn ] be a nonzero polynomial, and let ξ = (ξ1 , . . . , ξn ) be a point in K n . Write P as a polynomial in
x1 − ξ 1 , . . . , xn − ξ n :
X
(9.3.1)
P (x1 , . . . , xn ) =
ak (x1 − ξ1 )k1 · · · (xn − ξn )kn ,
k∈Nn

with ak ∈ K for all k , where k = (k1 , . . . , kn ) . Then the index of P at ξ with
respect to d = (d1 , . . . , dn ) is the number


kn
k1
+ ··· +
: ak 6= 0 .
td (P, ξ) = min
d1
dn
Following ([Lang 1983], Ch. 7, § 3), we may express the definition of index using
(repeated) divided partial derivatives of P , as follows. The expansion (9.3.1) is just
the Taylor expansion of P at ξ , so ak = ∂k P (ξ) , where

k 1
k n

1
∂
∂
∂k =
···
.
k1 ! · · · kn ! ∂x1
∂xn
In particular, the coefficients of ∂k P are integral multiples of the coefficients of P .
Assume from now on that for all i the degree of P with respect to xi is at most
di . Then the integral factors in question are nonnegative and bounded by
   
dn
d1
≤ 2d1 +···+dn .
···
(9.4)
kn
k1

64

PAUL VOJTA

For any τ ∈ R , a polynomial P as above has index ≥ τ at ξ P
if and only if
∂k P (ξ) = 0 for all k = (k1 , . . . , kn ) such that ki ≤ di for all i and
i ki /di < τ .
Let Jd (τ ) denote the number of such conditions.
Following ([Esnault and Viehweg 1984], § 9), let Voln (τ ) be the Lebesgue
measure of the set {x = (x1 , . . . , xn ) ∈ [0, 1]n : x1 + · · · + xn < τ } . Then


1
1
Jd (τ )
= Voln (τ ) + O
+ ··· +
,
d1 . . . dn
d1
dn
where the implicit constant depends only on n .
Now we introduce (as is typical of proofs of Roth’s theorem) an auxiliary polynomial. The degree of this polynomial will be taken large, depending on a real number
D which in the end will be taken sufficiently large depending on everything else in the
proof (except for things defined using D ).
Proposition 9.5. Let n be a positive integer, and let τ be a positive real number such
that Voln (τ ) < 1/q . Let c11 and c12 be as in (9.1), let β be a positive real
number such that
d+1

c11
1
,
<
(9.5.1)
1+
β
qc12 Voln (τ )
and let h1 , . . . , hn be positive real numbers. Then there exist a positive integer u ,
depending only on α1 , . . . , αq and M , and a real number D0 > 0 , depending on
all of the foregoing, such that the following is true for all D ≥ D0 . Let di = ⌊D/hi ⌋
for all i , let d = (d1 , . . . , dn ) , let h = u(d1 + · · · + dn ) , and let b = ⌊βh⌋ . Then
there is a nonzero polynomial
(9.5.2)

P ∈ H 0 (B, M ⊗b ⊗ Vlog 2 )[x1 , . . . , xn ] ,

of degree at most di in xi for all i , such that
(9.5.3)

td (P, (αj , . . . , αj )) ≥ τ

for all j = 1 . . . , q .

Proof. Let E be an effective divisor on BQ such that E + (αj ) is effective for all
j = 1, . . . , q . Let F be a smoothly metrized line sheaf on B such that FQ ∼
= O(E) ,
and such that the canonical section 1E of O(E) satisfies k1E kv ≤ 1/2 and
∞
|αj |v k1E kv ≤ 1/2 for all v ∈ MK
and all j . For all j let sj = αv 1E , so that
∞
sj is a global section of F and ksj kv ≤ 1/2 for all v ∈ MK
. By ([Moriwaki 2014],
∨
Prop. 5.43), there is a positive integer u such that F ⊗ M ⊗u has a nonzero strictly
small global section ρ .
Now let h1 , . . . , hn , D , d1 , . . . , dn , d , h , and b be as in the statement of the
proposition. We aim to use Theorem 9.2 (Siegel’s lemma) to construct P , by letting
the coefficients of P be the unknowns in the linear algebra problem and using the
conditions ∂k P (αj , . . . , αj ) = 0 ( j = 1, . . . , q ) as the equations.

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

65

Let N be the number of terms in P and M be the number of constraints (as
mentioned above). Then
N=

n
Y

(di + 1)

and

M = qJd (τ ) .

i=1

Q
P
Q
P
Since N/ di = 1 + O( d−1
di = q Voln (τ ) + O( d−1
i ) and M/
i ) , (9.2.1) follows
from (9.5.1) for all sufficiently large D .
For all k and all j , ∂k P (αj , . . . , αj ) is a homogeneous linear form in the coefficients of P . The coefficients of this linear form are elements of K of the form
   
dn l1 +···+ln
d1
α
···
kn j
k1
with 0 ≤ ki ≤ di and 0 ≤ li ≤ di for all i = 1, . . . , n . By (9.4), multiplying
d1 +···+dn
these latter coefficients by 1E
gives small global sections of F ⊗(d1 +···+dn ) ;
tensoring these with ρd1 +···+dn then gives (strictly) small sections of M ⊗h . Since ρ
is a strictly small section and since log N = o(D) = o(h) , all of these products lie in
H 0 (B, M ⊗h ⊗ V− log N ) for sufficiently large D .
Finally, since b grows roughly linearly in D , we have b ≥ m0 for all sufficiently
large D . Therefore Theorem 9.2 applies, and this gives the polynomial P that satisfies
(9.5.2) and (9.5.3).

§10. Conclusion of the Proof
The remainder of the proof of Roth’s theorem consists of choosing ξ1 , . . . , ξn ∈ K ,
constructing an auxiliary polynomial P , finding a lower bound for the index of P at
(ξ1 , . . . , ξn ) , and finally putting everything together to produce a contradiction. The
last step in obtaining a contradiction usually involves Roth’s lemma. Although Roth’s
lemma is almost certainly true over arithmetic function fields, here it is more expedient
to use Dyson’s lemma [Esnault and Viehweg 1984], simply because it is already
proved over all fields of characteristic zero.
We start by finding a lower bound for the index. Since this involves a polynomial
whose coefficients are global sections of a line sheaf, it involves metrics on that line
sheaf at all places, including non-archimedean places.
Definition 10.1. Let L be a smoothly metrized line sheaf on B , let s be a nonzero
rational section of L , let v be a non-archimedean place of K , and let Y be the
prime divisor on B corresponding to v . Let nY be the multiplicity of Y in the
divisor (s) of s on B . Then we define kskv = exp(−nY hM (Y )) . (Recall also
that kskv at an archimedean place v is defined using the metric of L .)
The following lemma may be regarded as an extension of the product formula
(which is the case b = 0 here).

66

PAUL VOJTA

Lemma 10.2. Let b ∈ Z and let s be a nonzero rational section of M ⊗b on B . Then
Z
− log kskv dµ(v) = bc1 (M )·(d+1) .
(10.2.1)
MK

P

nY · Y . Then, by Lemma 1.11,
Z
X
 ·d
·(d+1)

log ksk c1 (k · kM )∧d
−
bc1 (M )
=
nY c1 M Y

Proof. Write (s)fin =

Y

=

X
Y

=

nY hM (Y ) −

X

0
v∈MK

=

Z

MK

Z

B(C)

∞
MK

− log kskv −

Z

log kskv dµ(v)

∞
MK

log kskv dµ(v)

− log kskv dµ(v)



We are now ready to prove a lower bound for the index of the polynomial P
constructed in Proposition 9.5 at a point ξ satisfying certain conditions. This will
involve using the approximation condition (8.9.2) to obtain bounds on kP (ξ)kv for all
v.
Proposition 10.3. Let n , τ , u , and D0 be as in Proposition 9.5. Let σ > 0 be a real
number such that
(10.3.1)

(2 + ǫ′ )(τ − σ) > n ,

let rmin ≥ 1 be a real number, and let


q
X
n
(log 12) deg B +
(10.3.2)
c′ =
hK (αj ) .
τ −σ
j=1

Let ξ1 , . . . , ξn be elements of K that satisfy (8.9.1) and (8.9.2) for some ǫ′ > 0 and
some T1 , . . . , Tq ⊆ S . Let hi = hK (ξi ) for all i = 1, . . . , n . Let d = (d1 , . . . , dn ) ,
b , and P be as in Proposition 9.5. Then the polynomial P also satisfies

(10.3.3)

td (P, (ξ1 , . . . , ξn )) ≥ σ .

Proof. This proof is adapted from the argument at the end of ([Lang 1983], Ch. 7,
§ 3).
It will suffice to show that ∂k P (ξ1 , . . . , ξn ) = 0 for all k = (k1 , . . . , kn ) ∈ Nn
satisfying
kn
k1
+ ··· +
<σ.
d1
dn

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

67

Assume by way of contradiction that k is an n-tuple that satisfies the above
inequality, but that
(10.3.4)

∂k P (ξ1 , . . . , ξn ) 6= 0 .

To avoid cluttered notation, let Q = ∂k P .
Note that
td (Q, (αj , . . . , αj )) ≥ τ − σ

for all j = 1, . . . , q , and therefore ∂ℓ Q(αj , . . . , αj ) 6= 0 only if
(10.3.5)

ℓ1
ℓn
+ ··· +
≥τ −σ .
d1
dn

We start by estimating kQ(ξ1 , . . . , ξn )kv for all v ∈ MK . Here we will think
of the coefficients of P as being global sections of M ⊗b , having norms ≤ 2 at all
archimedean places (and hence not necessarily small sections). Coefficients of Q will
then also be global sections of M ⊗b , and values of Q such as Q(ξ1 , . . . , ξn ) will be
rational sections of M ⊗b .
Let T1 , . . . , Tq be as in Proposition 8.9. By shrinking T1 , . . . , Tq if necessary, we
may assume that
(10.3.6)

− log− kξi − αj kv
>0
1≤i≤n
hK (ξi )
min

for all v ∈ Tj , j = 1, . . . , q . This does not affect (8.9.2).
First, let v be an archimedean place of K such that v ∈ Tj for some j .
We consider the Taylor expansion
X
(10.3.7)
Q(x1 , . . . , xn ) =
∂ℓ Q(αj , . . . , αj )(x1 − αj )ℓ1 · · · (xn − αj )ℓn ,
ℓ∈Λ

where Λ is the set of all n-tuples ℓ = (ℓ1 , . . . , ℓn ) ∈ Nn with ℓi ≤ di for all i and
i
satisfying
that ∂ℓ Q = ∂ℓ ∂k P , that the operator ∂ℓ ∂k takes xm
to
i
 mi −ki −ℓNote
 (10.3.5).
mi −ki mi
mi −ki mi
i
is
a
trinomial
coefficient
with
m
≤
d
x
,
and
that
i
i.
i
ki
ℓi
ki
ℓi
d1 +···+dn
Hence ∂ℓ Q(αj , . . . , αj ) can be written as a sum of at most 2
terms, each with
d1 +···+dn
an additional factor of at most 3
coming from ∂ℓ ∂k , so we have
k∂ℓ Q(αj , . . . , αj )kv ≤ 2 · 2d1 +···+dn · 3d1 +···+dn · max{1, kαj kv }d1 +···+dn .
The Taylor expansion (10.3.7) then gives the bound
(10.3.8)
− log



kQ(ξ1 , . . . , ξn )kv
(ξ1 − α1 )ℓ1 · · · (ξn − αj )ℓn 
≥
−
log
max
v
ℓ∈Λ
2(12 max{1, kαj kv })d1 +···+dn
!
n
X
ℓi − log− kξi − αj kv
≥ (D + o(D)) min
·
ℓ∈Λ
d
hK (ξi )
i=1 i
− log− kξi − αj kv
.
1≤i≤n
hK (ξi )

≥ (D + o(D))(τ − σ) min

68

PAUL VOJTA

Here we use the bound |Λ| ≤ 2d1 +···+dn in the first step (this changes 6 to 12 in the
left-hand side) and (10.3.5) in the last step. Also, the limiting behavior of o(D) can
be taken independent of k .
For non-archimedean v ∈ Tj satisfying (10.3.6), a similar argument gives
(10.3.9) − log

− log− kξi − αj kv
kQ(ξ1 , . . . , ξn )kv
.
≥
(D+o(D))(τ
−σ)
min
1≤i≤n
(max{1, kαj kv })d1 +···+dn
hK (ξi )

Next consider archimedean v with v ∈
/ T1 ∪ · · · ∪ Tq .
By bounds on binomial coefficients arising from applying ∂k to P , the norms of
coefficients of Q at archimedean places are bounded by 21+d1 +···+dn . Since Q has at
most 2d1 +···+dn terms, we have
(10.3.10)

kQ(ξ1 , . . . , ξn )kv ≤ 2 · 4d1 +···+dn · max{1, kξ1 kv }d1 · · · max{1, kξn kv }dn .

Finally, for non-archimedean v ∈
/ T1 ∪ · · · ∪ Tq , we have simply
kQ(ξ1 , . . . , ξn )kv ≤ max{1, kξ1 kv }d1 · · · max{1, kξn kv }dn .

(10.3.11)

Combining (10.3.8)–(10.3.11) and (8.9.2), we then have
Z
Z

X 
log 2 + (log 12)
di dµ(v)
− log kQ(ξ1 , . . . , ξn )kv dµ(v) ≥ −
MK

−

X

∞
MK


X
hK (αj )
di + (D + o(D))(τ − σ) 2 + ǫ′ +

c′
hK (ξ1 )



−

X

di hK (ξi ) .

By (10.3.4) and Lemma 10.2, the left-hand side equals bc1 (M )·(d+1) . By (8.1.2) and
(10.3.2), this then becomes
(τ − σ)c′ X
di + (log 2) deg B
n

 X
c′
′
≥ (D + o(D))(τ − σ) 2 + ǫ +
−
di hK (ξi ) .
hK (ξ1 )

bc1 (M )·(d+1) +

By definition of di , we have di hK (ξi ) = D + o(D) for all i . Furthermore, (8.9.1)
and
P the assumption that rmin ≥ 1 imply that hK (ξi ) ≥ hK (ξ1 ) for all i ; hence
di ≤ n(D + o(D))/hK (ξ1 ) . Therefore we have
bc1 (M )·(d+1) + (log 2) deg B ≥ (D + o(D))((τ − σ)(2 + ǫ′ ) − n) .

By (10.3.1) this gives a contradiction for large enough D ; hence (10.3.3) is true.



The next (and next to last) step in the proof is to choose the main parameters of
the proof. It is based on ([Esnault and Viehweg 1984], Lemma 9.7).

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

69

Lemma 10.4. Let q ≥ 2 be an integer and let ǫ′ > 0 be given. Then there is an integer
n0 = n0 (q, ǫ′ ) ≥ 2 such that for all n ≥ n0 there are real numbers τ and σ such
that
(10.4.1)

q Voln (τ ) < 1 < q Voln (τ ) + Voln (σ)

and
(2 + ǫ′ )(τ − σ) > n .

(10.4.2)

Proof. We will show that the lemma holds with σ = 1 and with τ chosen such that
q Voln (τ ) = 1 −

(10.4.3)

1
.
2 · n!

For each n there is such a τ , and since Voln (1) = 1/n! , these choices satisfy (10.4.1).
Consider the inequality

(10.4.4)

s

log q − log 1 −
6n

1
2·n!



+

1
1
1
< −
.
n
2 2 + ǫ′

Its left-hand side tends to zero as n → ∞ , so there is an integer n0 ≥ 2 such that this
inequality holds for all n ≥ n0 . It remains only to check that (10.4.2) holds for these
values of n , τ , and σ .
Bombieri and Gubler ([2006], Lemma 6.3.5) showed that
Voln



 
2
1
− η n ≤ e−6nη
2

for all η ≥ 0 . If η satisfies (1/2 − η)n = τ and τ satisfies (10.4.3), then
log q − log 1 −
η2 ≤
6n

1
2·n!



,

and therefore by (10.4.4)
1
1
1
−η− >
.
2
n
2 + ǫ′
The left-hand side equals (τ − σ)/n , so (10.4.2) is true.
We now introduce Dyson’s lemma, as proved by Esnault and Viehweg.



70

PAUL VOJTA

Theorem 10.5 ([Esnault and Viehweg 1984], Thm. 0.4). Let K be a field of characteristic zero. Let ζj = (ζj,1 , . . . , ζj,n ) , j = 1, . . . , M , be points in K n ; let d ∈ Zn
with d1 ≥ d2 ≥ · · · ≥ dn > 0 ; let t1 , . . . , tM ∈ [0, ∞) ; and let P ∈ K[x1 , . . . , xn ] .
Assume that
(i). ζj,i 6= ζj ′ ,i for all j 6= j ′ and i = 1, . . . , n ;
(ii). P has degree at most di in xi for all i ;
(iii). td (P, ζj ) = tj for all j = 1, . . . , M .
Then
!
M
n
n
X
Y
X
dl
(10.5.1)
.
Voln (tj ) ≤
1 + max{M − 2, 0}
d
i
j=1
i=1
l=i+i

Remark 10.6. Esnault and Viehweg [1984] stated this theorem only with K = C , but
it is true over arbitrary fields of characteristic zero (as above) by the Lefschetz principle
in algebraic geometry, or (in the present situation) just by embedding K into C .
More generally, let B be an integral scheme whose function field K has characteristic zero, and let L be a line sheaf on B . Then Dyson’s lemma also holds for
polynomials with coefficients in H 0 (B, L ) . Indeed, one can tensor all coefficients with
a fixed nonzero element of the stalk of L ∨ at the generic point of B . The resulting
polynomial will have coefficients in K , and it will have the same degree and index
properties, so (10.5.1) will then apply to the original polynomial.
Proof of Theorem 4.5. The proof will be by contradiction. Let K , MK , S , α1 , . . . , αq ,
ǫ > 0 ; and c ∈ R be as in the statement of Theorem 4.5, and assume that (4.5.1) fails
to hold for infinitely many ξ ∈ K . Pick ǫ′ ∈ (0, ǫ) , and choose n , τ , and σ such that
(10.4.1) and (10.4.2) hold.
We shall apply Dyson’s lemma with M = q + 1 , ζj = (αj , . . . , αj ) ( j = 1, . . . , q ),
and ζM = ξ , with ξ yet to be determined.
First, by (10.4.1), we may choose rmin ≥ 1 such that
!
n
n
Y
X
1
.
(10.7)
q Voln (τ ) + Voln (σ) >
1 + (q − 1)
r l−i
i=1
l=i+1 min

By Propositions 8.9, 9.5, and 10.3, there are ξ1 , . . . , ξn ∈ K satisfying (8.9.1), such that
the following is true for all sufficiently large D . Let hi = hK (ξi ) and di = ⌊D/hi ⌋ for
all i = 1, . . . , n . Then there is a nonzero polynomial P as in (9.5.2), of degree at most
di in xi for all i , such that (9.5.3) and (10.3.3) hold. By (8.9.1) and (10.7), we may
also assume that D is sufficiently large so that
!
n
n
X
Y
dl
.
1 + (q − 1)
(10.8)
q Voln (τ ) + Voln (σ) >
di
i=1
l=i+i

Let ξ = (ξ1 , . . . , ξn ) . Then, in the notation of Theorem 10.5, we have tj ≥ τ for all
j = 1, . . . , q and tq+1 ≥ σ by (9.5.3) and (10.3.3), respectively.
Thus (10.8) contradicts (10.5.1) (via Remark 10.6), and Theorem 4.5 is proved.


ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

71

References
Bombieri, Enrico and Gubler, Walter
2006
Heights in Diophantine geometry, New Mathematical Monographs 4, Cambridge University
Press, Cambridge, 2006.
Bosch, Siegfried; Güntzer, Ulrich; and Remmert, Reinhold
1984
Non-Archimedean analysis, Grundlehren der Mathematischen Wissenschaften 261, SpringerVerlag, Berlin, 1984.
Burgos Gil, José Ignacio; Philippon, Patrice; and Sombra, Martı́n
2016
Height of varieties over finitely generated fields. Kyoto J. Math. 56, 13–32 (2016).
Chen, Huayi
2008pre Positive degree and arithmetic bigness (preprint 2008). arXiv:0803.2583.
Dyson, F. J.
1947
The approximation to algebraic numbers by rationals. Acta Math. 79 (1947), 225–240.
Esnault, Hélène and Viehweg, Eckart
1984
Dyson’s lemma for polynomials in several variables (and the theorem of Roth). Invent. Math.
78 (1984), 445–490.
Faltings, Gerd
1992
Lectures on the Riemann–Roch theorem, notes taken by S. Zhang, Annals of Math. Studies
127, Princeton Univ. Press, Princeton, NJ, 1992.
Gillet, Henri and Soulé, Christophe
1990
Arithmetic intersection theory. Inst. Hautes Études Sci. Publ. Math. 72 (1990), 93–174.
Griffiths, Phillip and Harris, Joseph
1978
Principles of algebraic geometry. Pure and Applied Mathematics. Wiley-Interscience [John
Wiley & Sons], New York, 1978.
Grothendieck, Alexander
1965
Éléments de géométrie algébrique. IV. Étude locale des schémas et des morphismes de
schémas. II. Inst. Hautes Études Sci. Publ. Math. No. 24 (1965).
Gubler, Walter
1997
Heights of subvarieties over M -fields. In: Arithmetic geometry, F. Catanese (ed.), Symp.
Math. 37 (1997), 190–227.
Hartshorne, Robin
1977
Algebraic Geometry, Graduate Texts in Mathematics, No. 52, Springer-Verlag, New YorkHeidelberg, 1977.
Hindry, Marc and Silverman, Joseph H.
2000
Diophantine geometry, Graduate Texts in Mathematics 201, Springer-Verlag, New York,
2000.

72

PAUL VOJTA

Lang, Serge
1960
Integral points on curves. Inst. Hautes Études Sci. Publ. Math., 6 (1960), 27–43.
1962
Diophantine geometry, Interscience Tracts in Pure and Applied Mathematics, No. 11, Interscience Publishers (a division of John Wiley & Sons), New York-London, 1962.
1974
Higher dimensional diophantine problems. Bull. Amer. Math. Soc. 80 (1974), 779–787.
1983
Fundamentals of Diophantine geometry, Springer-Verlag, New York, 1983.
1986
Hyperbolic and Diophantine analysis. Bull. Amer. Math. Soc. (N.S.) 14 (1986), 159–205.
1987
Introduction to Complex Hyperbolic Spaces, Springer-Verlag, New York, 1987.
1991
Number theory III: Diophantine geometry (Encyclopaedia of mathematical sciences 60),
Springer, Berlin Heidelberg, 1991.
2002
Algebra, revised third edition (Graduate Texts in Mathematics 211), Springer-Verlag, New
York, 2002.
LeVeque, William Judson
1956
Topics in number theory, Vol. 2. Addison-Wesley Publishing Co., Inc., Reading, Mass., 1956.
Moriwaki, Atsushi
2000
Arithmetic height functions over finitely generated fields. Invent. Math. 140 (2000), pp. 101–
142.
2004
Diophantine geometry viewed from Arakelov geometry [translation of Sugaku 54 (2002),
113–129]. Sugaku Expositions 17 (2004), 219–234.
2009
Continuity of volumes on arithmetic varieties. J. Algebraic Geom. 18 (2009), 407–457.
2014
Arakelov geometry (Translations of Mathematical Monographs 244), American Mathematical
Society, Providence, R.I., 2014. Originally published in Japanese: Arakerofu kika, Iwanami
Shoten, Tokyo, 2008.
Rastegar, Arash
2015pre A geometric formulation of Siegel’s diophantine theorem (preprint 2015). arXiv:1504.03162.
Ridout, D.
1958
The p-adic generalization of the Thue–Siegel-Roth theorem. Mathematika 5 (1958) 40–48.
Roth, Klaus Friedrich
1955
Rational approximations to algebraic numbers. Mathematika 2 (1955), pp. 1–20; corrigendum, 168.
Soulé, Christophe
1992
Lectures on Arakelov geometry, with the collaboration of D. Abramovich, J.-F. Burnol, and
J. Kramer, Cambridge Studies in Advanced Mathematics 33, Cambridge Univ. Press, 1992.
Vojta, Paul
1987
Diophantine approximations and value distribution theory, Lecture Notes in Mathematics
1239, Springer-Verlag, Berlin, 1987.
2006pre Nagata’s embedding theorem (preprint 2006). arXiv:0706.1907.
2011
Diophantine approximation and Nevanlinna theory. In: Arithmetic geometry, Lecture Notes
in Mathematics 2009, Springer, Berlin, 2011, pp. 111–224.
Wirsing, Eduard A.
1971
On approximations of algebraic numbers by algebraic numbers of bounded degree. In: 1969
Number Theory Institute (Proc. Sympos. Pure Math., Vol. XX, State Univ. New York, Stony
Brook, N.Y., 1969), pp. 213–247. Amer. Math. Soc., Providence, R.I., 1971.

ROTH’S THEOREM OVER ARITHMETIC FUNCTION FIELDS

73

Yuan, Xinyi
2008
Big line bundles over arithmetic varieties. Invent. Math. 173 (2008), 603–649.
2009
On volumes of arithmetic line bundles. Compos. Math. 145 (2009), 1447–1464.
Zhang, Shouwu
1995
Positive line bundles on arithmetic varieties. J. Amer. Math. Soc. 8 (1995), pp. 187–221.
Department of Mathematics, University of California, 970 Evans Hall
Berkeley, CA 94720-3840

#3840,

