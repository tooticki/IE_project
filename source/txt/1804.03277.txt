arXiv:1804.03277v1 [math.PR] 9 Apr 2018

IDENTIFIABILITY FOR GRAPHEXES
AND THE WEAK KERNEL METRIC
CHRISTIAN BORGS, JENNIFER T. CHAYES, HENRY COHN,
AND LÁSZLÓ MIKLÓS LOVÁSZ

Abstract. In two recent papers by Veitch and Roy and by Borgs, Chayes,
Cohn, and Holden, a new class of sparse random graph processes based on
the concept of graphexes over σ-finite measure spaces has been introduced. In
this paper, we introduce a metric for graphexes that generalizes the cut metric
for the graphons of the dense theory of graph convergence. We show that
a sequence of graphexes converges in this metric if and only if the sequence
of graph processes generated by the graphexes converges in distribution. In
the course of the proof, we establish a regularity lemma and determine which
sets of graphexes are precompact under our metric. Finally, we establish an
identifiability theorem, characterizing when two graphexes are equivalent in
the sense that they lead to the same process of random graphs.

Contents
1. Introduction
2. Definitions and statements of main results
3. Preliminaries
4. Tightness
5. Regularity lemma and compactness
6. Subgraph counts
6.1. Proof of the counting lemma
6.2. GP-convergence and subgraph counts
6.3. Metric convergence implies GP-convergence
7. Sampling
7.1. Closeness of graphexes implies closeness of samples
7.2. Samples converge to graphex
7.3. Proofs of Theorem 2.18, Proposition 2.13, and Theorem 2.23
8. Identifiability
8.1. Infimum is minimum
8.2. Canonical graphex
9. Uniform integrability and uniform tail regularity
9.1. Uniform integrability
9.2. Uniform tail regularity
Acknowledgements
Appendix A. Local finiteness
Appendix B. Sampling with loops
References
1

2
3
19
43
50
59
60
65
71
71
72
76
80
80
81
86
93
93
96
101
102
106
108

2

BORGS, CHAYES, COHN, AND LOVÁSZ

1. Introduction
The theory of graph limits has been extensively developed for dense graph
sequences [7, 21, 22, 8, 10, 9], but the sparse case is not as well understood. In
this paper, we study a model introduced and studied in a sequence of papers
[11, 26, 3, 17, 25, 18, 4] based on the notion of graphexes. In contrast to the
graphons of the dense theory, which are symmetric two-variable functions defined
over a probability space, graphexes are defined over σ-finite measure spaces, and, in
addition to a graphon part W , contain two other components: a function S taking
values in R+ , and a parameter I ∈ R+ . Formally, the graphex is then the quadruple
W = (W, S, I, Ω), where Ω = (Ω, F, µ) is the underlying measure space.
A graphex then leads to a process (GT (W))T ≥0 of random graphs as follows: starting from a Poisson process over Ω with intensity T µ, one attaches Poisson(T S(xi ))
leaves to each Poisson point xi , and in addition, joins two Poisson points xi , xj with
probability W (xi , xj ). Finally, one adds Poisson(T 2 I) isolated edges not connected
to any of the other points. Removing isolated vertices as well as the labels of the
remaining vertices gives a graphex process (GT (W))T ≥0 of unlabeled graphs sampled
from W.
Several notions of convergence for graphexes were introduced in [3] and [25] and
further studied in [18]. Among these notions, we will be particularly interested in
graphex process convergence (GP-convergence), which was introduced in [25]. A
sequence of graphexes is GP-convergent if the random graph processes generated
by the graphexes in the sequence converge. It was pointed out in [18] that GPconvergence can be metricized using the abstract theory of probability measures
over Polish spaces, but this does not give a very explicit metric on graphexes; in
fact, it does not even allow us to determine when two graphexes lead to the same
random graph process.
In this paper, we introduce a concrete notion of distance for graphexes that is
equivalent to GP-convergence, which can be thought of as corresponding to the “cut
distance” in the dense case. For reasons we explain in the next section, we call it
the “weak kernel distance”. We show that convergence in this distance is equivalent
to GP-convergence.
In general, the set of all graphexes is not compact. Indeed, it is not difficult to show
that for a set to be compact under GP-convergence, certain uniform boundedness
assumptions are necessary on the set of graphexes, which we call “tightness”. As
a part of our proof that our weak kernel distance metricizes GP-convergence, we
develop a (Frieze-Kannan-type) regularity lemma for graphexes and show that the
sets that are precompact under the weak kernel metric are precisely those that are
tight.
Finally, we prove an identifiability theorem, showing to what extent a graphex
can be identified from its graphex process. Formulated differently, we give a
characterization of the equivalence classes of graphexes, where two graphexes are
called equivalent if they give rise to the same graphex process. Generalizing a
construction that was developed by Janson for the dense case [16], we assign to each
graphex W a “canonical version” c
W such that W is a pullback of c
W and show that
if two graphexes are equivalent, then their canonical versions are isomorphic up to
measure zero changes. This in turn will imply that two graphexes W1 and W2 are
equivalent if and only if there is a third graphex W3 (which can be taken to be their
canonical graphex) such that after restricting the two graphexes to their “support”

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

3

(strictly speaking, we have to restrict them to their “degree support”, a notion we
will define in the next section) both W1 and W2 are pullbacks of W3 . We note that
this proves a conjecture of Janson; see Remark 5.4 in [17].
We note that in this paper we treat graphexes slightly differently from the
definition in [26, 17, 25, 18, 4]. Namely, as in [3], we follow the convention from the
theory of dense graph limits, and define the graphex process corresponding to a
graphex as a process of graphs without loops. Indeed, we believe that a theory with
loops is most naturally embedded into a more general theory of graphex processes
with multi-edges and loops, which is beyond the scope of this paper.
Nonetheless, it is worth pointing out that the reader interested in the theory
with loops (but not multi-edges) can derive many results for this theory from those
developed here, even though some of the theorems will need to be modified to
accommodate additional technical complications. For the identifiability theorem,
this is done in Appendix B.
Finally, we note that while signed graphexes (i.e., graphexes for which W , S and
I are not necessarily non-negative) do not make much sense if we want to use them
to generate a random graph process, they are quite natural from an analytic point
of view. Indeed, we will prove several of our results for signed graphexes. Still,
the goal of this paper is to study unsigned graphexes, and our results on signed
graphexes should be considered more of an aside at this point.
2. Definitions and statements of main results
Definition 2.1. A graphex W = (W, S, I, Ω) consists of a σ-finite measure space
Ω = (Ω, F, µ), a symmetric measurable function W : Ω × Ω → [0, 1], a measurable
function S : Ω → R+ , and a nonnegative real number I such that the following local
finiteness conditions hold:
(1) W (·, x) is integrable for almost all x ∈ Ω, and
(2) there exists a measurable subset Ω0 ⊆ Ω such that µ(Ω \ Ω0 ) < ∞ and W|Ω0
is integrable.
The quadruple will be called a signed graphex if instead of taking values in [0, 1] and
R+ , W , S and I take values in R. The graphex W = (W, S, I, Ω) is called integrable
if
Z
Z
kWk1 :=
|W (x, y)| dµ(x) dµ(y) + 2
|S(x)| dµ(x) + 2|I| < ∞,
Ω×Ω

Ω

and the restriction W|Ω0 of W to Ω0 ⊆ Ω is defined as the quadruple W0 =
(W 0 , S 0 , I 0 , Ω0 ) with Ω0 = (Ω0 , F 0 , µ0 ), where F 0 = {A ∈ F : A ⊆ Ω0 }, µ0 is the
restriction of µ to F 0 , S 0 is the restriction of S to Ω0 , and W 0 is the restriction of
W to Ω0 × Ω0 .
We often refer to W as a signed graphex over Ω, and we will refer to the function
W as a graphon, or the graphon part of W. Similarly, S will be called a star intensity,
or the star part of W, and I will be called a dust density, or the dust part of W.
(The reason for this terminology will become clear when we discuss the random
graph process generated by an unsigned graphex W; as we will see, the star part of
W will lead to stars, and the dust part will lead to isolated edges, which we call
dust following [18].) If two signed graphexes W1 , W2 are defined on the same space
Ω, then we say that W1 = W2 almost everywhere if W1 = W2 almost everywhere,
S1 = S2 almost everywhere, and I1 = I2 .

4

BORGS, CHAYES, COHN, AND LOVÁSZ

We define the marginal of a graphex W = (W, S, I, Ω) over Ω = (Ω, F, µ) as the
a.e. finite function DW : Ω → R+ defined by
Z
DW (x) = DW (x) + S(x) where DW (x) =
W (x, y) dµ(y).
Ω

We say that W has D-bounded marginals if kDW k∞ ≤ D. Finally, we define its
degree support as the set
dsupp W = {x ∈ Ω : DW (x) > 0} .
Note that W is integrable if and only if its marginals are integrable.
Given a graphex W, we will define a stochastic process (GT (W))T ≥0 indexed by
T ∈ R+ and taking values in the set of graphs with labels in R+ . To make this
precise, we need to define a σ-algebra over the set of countable graphs with vertices
in R+ . To this end, we first define the adjacency measure ξG of a countable graph
G with vertices in R+ as the measure ξG on R2+ given by
X
ξG =
δ(t,t0 ) .
t,t0 ∈V (G):{t,t0 }∈E(G)

We call ξ an adjacency measure if there exists a countable graph G such that ξ = ξG .
We then equip the set of adjacency measures with the smallest σ-algebra such that
the maps ξ 7→ ξ(A) are measurable for all bounded Borel sets A ⊆ R2+ , and the set
of countable graphs with vertices in R+ with the smallest σ-algebra such that the
maps G 7→ ξG are measurable.
A graphex W = (W, S, I, Ω) then generates a family (GT (W))T ≥0 of random
graphs as follows: we start with a Poisson point process with intensity λ × µ on
R+ × Ω, where λ is the Lebesgue measure on R+ , and then connect two points
(t, x) and (t0 , x0 ) of the Poisson process with probability W (x, x0 ), independently
for all pairs of points. For each point of the Poisson process (t, x), we take another
Poisson point process on R+ with intensity S(x)λ, and connect (t, x) to a vertex
with “birth time” ti for each point ti in the process. We also take a Poisson process
with intensity I(λ × λ) on R2+ , and for each point (tx , ty ) we take an isolated edge
between vertices with birth time tx and ty . If we ignore the labels in the feature
space Ω and delete the vertices with degree zero, this leads to an infinite graph
G∞ (W) with vertices labeled by their birth time t ∈ R+ . We then define GT (W) by
first taking the induced subgraph on the set of vertices which lie in [0, T ] and then
deleting vertices whose neighbors in G∞ (W) all lie outside the interval [0, T ].
We will refer to the part of G∞ (W) generated with the help of the dust intensity
I as the dust part of G∞ (W), and as the part generated with the help of the star
intensity S as the stars in G∞ (W). While it may not be a priori clear whether these
parts can be inferred from just observing the infinite graph G∞ (W), this is actually
the case, a fact which was first noted in Remark 5.4 in [17]: almost surely, the dust
part consists of all edges in G∞ (W) that are isolated, the star part consists of all
edges with one vertex of degree one and a second vertex of infinite degree, and the
remaining edges are generated by the graphon part of W and have two endpoints
with infinite degree.
Definition 2.2. Let W be a graphex, let (GT (W))T ≥0 be the random family of
graphs defined above, and let ξ[W] be the random adjacency measure ξG∞ (W) . We
call the stochastic process (GT (W))T ≥0 the graphex process generated by W, and
the adjacency measure ξ[W] the adjacency measure generated by W. We say two

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

5

graphexes are equivalent, if the graphex processes generated by these graphons are
equal in law.
Remark 2.3. (1) Following [4], we defined a graphex process as a stochastic process
taking values in a space of graphs with labels in R+ . Alternatively, one might want
to define a graphex process as a process taking values in the space of unlabeled
graphs without isolated vertices. In our current context, this would correspond to
ignoring the time labels of the graphs in GT (W), leading to a graph which we denote
by GT (W). When it is important to distinguish them, we will refer to the process
(GT (W))T ≥0 as the unlabeled graphex process corresponding to W, and to the
process (GT (W))T ≥0 as the labeled graphex process corresponding to W. Note that
it is easy to recover GT (W) from GT (W): just assign i.i.d. labels chosen uniformly
at random in [0, T ] to all vertices. A related observation is the fact that GT (W) can
be generated by first choosing (xi )i≥1 according to a Poisson process with intensity
T µ in Ω, then connecting i and j with probability W (xi , xj ), then adding a star
whose number of leaves are chosen as a Poisson random variable with mean T S(xi )
to each point of the process (xi )i≥1 , and finally adding independent edges with rate
IT 2 . Forgetting the labels then gives us GT (W). Relabeling each vertex in the
resulting graph independently by a uniform t ∈ [0, T ], we obtain GT (W).
(2) It is sometimes convenient to assign a feature value to the endpoints of the
isolated edges generated from the dust part I in the graphex, as well as to the leaves
of the stars generated using the function S. For our purpose, we will say that these
vertices have the feature label ∞, and we will extend the marginal DW to Ω ∪ {∞}
by setting
Z
DW (∞) =

S(x) dµ(x) + 2I.
Ω

R

Note that with this notation, kWk1 = Ω DW (x) dµ(x) + DW (∞).
e = Ω∪{∞}
(3) In view of (2), one might want to equip the extended feature space Ω
with a σ-finite measure by keeping the original measure on Ω, and assigning some
finite measure Q = µ
e(∞) to the feature value ∞, giving a new σ-finite measure
e Q . On Ω
e Q , one can then define a graphex of the form f
e
fQ , 0, 0, Ω)
space Ω
WQ = ( W
fQ equal to W on Ω × Ω and to 2I/Q2 on {∞} × {∞}, and by setting
by setting W
f
f (∞, y) = S(y)/Q if only one of the two features x, y
W (x, ∞) = S(x)/Q and W
lies in Ω. With this construction, DW
fQ (∞) = DW (∞)/Q, DW
fQ (x) = DW (x) if
R
fQ k1 = dµ(x)D f + QD f (∞), with the notation in (2)
x ∈ Ω, and kWk1 = kW
W1

W

corresponding to the case Q = 1. It is clear that the graphon process generated
from f
W cannot have exactly the same distribution as the one generated from W
unless I and S are zero (to see this, note that in G∞ (f
W), all vertices have infinite
degrees, while G∞ (W) has vertices of degree one). But one might wonder whether
the process generated from the “pure graphon” f
W approximates the one generated
from W. As we will see in Remark 7.7, this is indeed the case, in the sense that for
any fixed T , the distribution of GT (f
WQ ) converges to GT (W).

It is relatively easy to see that the local finiteness conditions (1) and (2) from
Definition 2.1 imply that the adjacency measure ξ[W] is a.s. locally finite (i.e.,
ξ[W](A) < ∞ for all bounded Borel sets A ⊂ R2+ ), or equivalently, that for all
T < ∞, the graphs GT (W) are a.s. finite. It turns out that these conditions are
also necessary for the local finiteness of ξ[W]. This is the main statement of the

6

BORGS, CHAYES, COHN, AND LOVÁSZ

following proposition, which we will prove in Appendix A. For graphexes over R+
equipped with the Lebesgue measure, a similar condition was established in [26],
building on the work of [19] (the condition considered by [26] and [19] is the same
as our condition (E) below, specialized to the case D = 1, even though it is clear
that both [26] and [19] knew that for graphexes over R+ , conditions (D) and (E)
are equivalent.) To state the proposition, we use the notation {DW > D} for the set
{x ∈ Ω : DW (x) > D}, while {DW > D}, {DW ≤ D}, and {DW ≤ D} are defined
analogously.
Proposition 2.4. Let W = (W, S, I, Ω) be a 4-tuple consisting of a σ-finite measure
space Ω = (Ω, F, µ), a symmetric measurable function W : Ω × Ω → [0, 1], a
measurable function S : Ω → R+ , and a nonnegative real number I. Then the local
finite conditions (1) and (2) from Definition 2.1 are equivalent to the local finiteness
of the adjacency measure generated by W. If we assume condition (1), then following
are equivalent:
(A)
(B)
(C)
(D)

The graphex W obeys the local finiteness condition (2).
For all D > 0, µ({DW > D}) < ∞ and W|{DW ≤D} is integrable.
There exists a D > 0 such that µ({DW > D}) < ∞ and W|{DW ≤D} is integrable.
For all D > 0, µ({DW > D}) < ∞, and both W |{DW ≤D} and min{S, 1} are
integrable.
(E) There exists a D > 0 such that µ({DW > D}) < ∞, and both W |{DW ≤D} and
min{S, 1} are integrable.

Note that this proposition implies in particular that a graphex with bounded
marginals is integrable, since for graphexes with kDW k∞ ≤ D the graphex W and
the graphex W|{DW }≤D are the same.
Having defined the graphex process associated with a graphex W, there are
several natural questions one might want to answer. In particular, one might want
to characterize when two graphexes lead to the same process, i.e., when ξ[W] and
ξ[W0 ] have the same distribution. More generally, one might want to define a metric
on the set of graphexes such that the distributions of ξ[W] and ξ[W0 ] are close if W
and W0 are close. Addressing these questions is one of the main goals of this paper.
Before discussing this further, it will be useful to embed the theory of graphex
processes into the general theory of locally finite point processes. To this end,
we first introduce the set N = N (R2+ ) of locally finite counting measures on R2+
(i.e., the set of measures ξ such that ξ(A) is a finite, non-negative integer for all
bounded Borel sets A ⊂ R2+ ), and equip it with the Borel σ-algebra inheritedR from
the vague topology (defined as the coarsest topology for which the maps ξ 7→ f dξ
are continuous for all continuous functions f : R2+ → R+ with compact support). As
shown in, e.g., [13], Appendix A2.6, the vague topology on N can be metricized in
such a way that N becomes a complete, separable metric space, making N into a
Polish space, and the Borel σ-algebra inherited from this topology is the smallest
σ-algebra such that for all bounded Borel sets A ⊂ R2+ the maps µ 7→ µ(A) are
measurable.
As usual, a locally finite point process on R2+ is then defined as a random measure
on N (R2+ ) equipped with this Borel algebra, and convergence in distribution is
defined as weak convergence in the set of probability measures on N , so that
convergence in distribution of a sequence of locally finite point process ξn on R2+ to
a locally finite point process ξ is defined by the condition that E[F (ξn )] → E[F (ξ)]

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

7

for all continuous, bounded functions F , with continuity defined with respect to
the vague topology on N . As observed in [18], the fact that N is Polish makes the
set of probability distributions on N a Polish space as well (see, e.g., [1], Appendix
III for a proof), showing that convergence in distribution for locally finite point
processes on R2+ can be metricized.
Next we consider the set Ĝ of simple graphs G with vertices in R+ such that
(a) no vertex in G is isolated, and (b) for all T < ∞, the induced subgraph of
G on V (G) ∩ [0, T ] is finite. We also consider the subset Ĝ0 of finite graphs in
Ĝ. The map G 7→ ξ(G) then gives a one-to-one map between graphs in Ĝ and
adjacency measures. In particular, Ĝ and its subset Ĝ0 inherit the vague topology
and corresponding Borel σ-algebra from N . In this language, the graphex process
(GT (W))T ≥0 then becomes a CADLAG stochastic process with values in Ĝ0 indexed
by a time T ∈ R+ .
Note that Ĝ should be distinguished from the set of unlabeled countable graphs
without isolated vertices, G. While we will not equip G with any topology, the set
of finite unlabeled graphs without isolated vertices, denoted by G0 , will be given
the discrete topology. In this language, the unlabeled graphex process (GT (W))T ≥0
introduced in Remark 2.3 is then a CADLAG process with values in G0 .
In [18], various notions of convergence for graphons and graphexes (proposed
originally in [3] and [25]) were studied. Here we are most interested in what [25]
introduces as GP-convergence, where GP stands for graphex process. This notion is
closely related to the notion of sampling convergence for graphs introduced in [4];
see Lemma 5.4 in that paper, as well as the discussion at the end of this section.
Janson showed that the following are equivalent if W, W1 , W2 , . . . are graphexes:
(1) ξ(G(Wn )) → ξ(G(W)) in distribution.
(2) For every T < ∞, ξ(GT (Wn )) → ξ(GT (Wn )) in distribution.
(3) For every T < ∞, GT (Wn ) → GT (W ) in distribution.
Following [25] we call this notion of convergence GP-convergence, and say that Wn
is GP-convergent to W if one of these equivalent conditions holds.
As already alluded to above, Janson also observed that by the abstract theory
of probability measures over Polish spaces, this notion of convergence can be
metricized, turning the set of graphexes into a complete, separable metric space.
But this abstract theory does not give a very explicit metric on the space of locally
finite graphexes; in fact, it does not even address the question of when two graphexes
are equivalent in the sense that the resulting point processes are equal in law.
To discuss the second question, we define measure-preserving transformations,
pullbacks, and couplings. Given two σ-finite spaces Ω = (Ω, F, µ) and Ω0 =
(Ω0 , F 0 , µ0 ), we say that a map φ : Ω0 → Ω is a measure-preserving transformation
if φ is measurable and µ0 (φ−1 (A)) = µ(A) for all A ∈ F. If W = (W, S, I, Ω)
is a signed graphex over Ω, we define its pullback under φ to be the graphex
Wφ = (W φ , S φ , I, Ω0 ) where W φ (x0 , y 0 ) = W (φ(x0 ), φ(x0 )) and S φ (x0 ) = S(φ(x)).
It is clear that for unsigned graphexes W and Wφ give rise to the same process of
random graphs. Note that we can define the pullback even when ϕ is measurable
but not measure-preserving, but in this case the two graphexes do not necessarily
give rise to the same random process. Nevertheless, we will sometimes use pullbacks
0
in this situation. If we do, we will write Wϕ,µ to emphasize the dependence on the
measure on Ω0 . Given two σ-finite spaces Ω1 = (Ω1 , F1 , µ1 ) and Ω2 = (Ω2 , F2 , µ2 ),

8

BORGS, CHAYES, COHN, AND LOVÁSZ

we say that µ is a coupling of µ1 and µ2 if µ is a measure on F1 × F2 such that
µ(Ω1 × S2 ) = µ2 (S2 ) and µ(S1 × Ω2 ) = µ1 (S1 ) for all S1 ∈ F1 and all S2 ∈ F2 . Note
that the existence of such a coupling implies that µ1 (Ω1 ) = µ(Ω1 × Ω2 ) = µ2 (Ω2 ).
It turns that this condition is both necessary and sufficient for the existence of a
coupling; see [3] for a proof.
Based on the known results for dense graphs, one might conjecture that two
graphexes are equivalent if and only if there exists a third graphex such that both
are pullbacks of this third graphex. It turns out that this is not quite correct, but
that it is correct once we remove the part of the underlying space on which DW = 0.
This is the statement of the following theorem, which is one of the main results of
this paper, and will be proved in Section 8.
Theorem 2.5. Let W1 = (W1 , S1 , I1 , Ω1 ) and W2 = (W2 , S2 , I2 , Ω2 ) be graphexes,
where Ωi = (Ωi , Fi , µi ) are σ-finite spaces. Then Gt (W1 ) and Gt (W2 ) have the
same distribution for all t ∈ R+ if and only if there exists a third graphex W =
(W, S, I, Ω) over a σ-finite measure space Ω = (Ω, F, µ) and measure preserving
maps φi : dsupp Wi → Ω such that Wi |dsupp Wi = Wφi almost everywhere.
Remark 2.6. If the two graphexes are defined over Borel spaces, we can prove
an analogous statement where the measure-preserving maps are turned around.
Specifically, for the case where Ω1 and Ω2 are σ-finite Borel spaces, we can prove
that Gt (W1 ) and Gt (W2 ) have the same distribution for all t ∈ R+ if and only
if there exists a σ-finite Borel space Ω = (Ω, F, µ) and measure preserving maps
πi : Ω → dsupp Wi such that (W1 |dsupp W1 )π1 = (W2 |dsupp W2 )π2 almost everywhere.
In this case, the space Ω can be chosen to be a coupling of Ω1 and Ω2 , with πi
being the coordinate projections from Ω1 × Ω2 to Ωi . See Theorem 8.2 in Section 8.
For graphexes without a dust and star part, this was independently established in
[3] (using a different proof); see also [17], which establishes a similar result (with
yet another proof), this time giving a coupling of the two graphexes (again without
dust and star part) after trivially extending them rather than restricting them to
the support of their marginals.
To address the first question, concerning the relationship between graphexes and
the point processes generated by them, we would like to define an analogue of the
cut distance for graphons between graphexes, so that two graphexes are close if
and only if their graphex processes are close. To this end, we first define some
norms of a function U over Ω1 × Ω2 for two σ-finite spaces Ω1 = (Ω1 , F1 , µ1 ) and
Ω2 = (Ω2 , F2 , µ2 ). We denote by kU kp the Lp norm of U as a function over Ω1 × Ω2
(so we forget the product structure). Given two measurable functions f : Ω1 → R
and g : Ω2 → R, let
Z
f ◦ U (y) =
f (x)U (x, y) dy,
Ω1

Z
U ◦ g(x) =

U (x, y)g(y) dy,
Ω2

and
Z
f ◦U ◦g =

f (x)U (x, y)g(y) dy.
Ω1 ×Ω2

We will also use the notation Ux for the function y 7→ U (x, y).

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

9

Definition 2.7. Given a function U defined on Ω1 × Ω2 for two σ-finite measure
spaces Ωi = (Ωi , Fi , Ωi ) for i = 1, 2, we define
kU k2→2 =

sup
f,g:kf k2 =kgk2 =1

f ◦U ◦g =

sup

kU ◦ gk2 .

g:kgk2 =1

Note that the norm kU k2→2 is simply the operator norm when we consider U
b from L2 (Ω2 ) to L2 (Ω1 ). We will therefore call it the
the kernel of an operator U
kernel norm of U . Our next norm is a modification of the standard cut norm; in the
dense graph setting, it was first systematically used in [20], where it was defined as
a norm for functions defined over a probability space.
Definition 2.8. Given a measurable function U defined on Ω × Ω for a σ-finite
measure space Ω, we define the jumble norm


Z


1


kU k = sup  p
U (x, y) dµ(x) dµ(y) .

µ(S)µ(T ) S×T
S,T ⊆Ω 
Here the supremum is over subsets with finite and nonzero measure.
It is easy to show that these are norms; in particular, they satisfy the triangle
inequality, and are equal to 0 if and only if U is zero almost everywhere. If we want
to stress the dependence of these norms on the measure µ and the function U , we
write kU k∗,µ instead of kU k∗ , where ∗ is replaced by the appropriate norm.
We will see later that for graphexes with uniformly bounded marginals and
uniformly bounded k · k1 norms, the k · k2→2 norm and the k · k norm are equivalent
(Lemma 3.22), implying in particular that they are equivalent in the theory of dense
graph limits (where Ω has bounded measure). In the dense setting, the above two
norms are also equivalent to the standard cut norm, defined as
Z




kU k = sup 
U (x, y) dµ(x) dµ(y) =
sup
|f ◦ U ◦ g|.
S,T ⊆Ω

S×T

f,g : Ω→[0,1]

p
Indeed, kU k ≤ kU k µ(Ω) and kU k ≤ kU k kU k∞ , where the second bound
follows from the fact that
Z




U (x, y) dµ(x) dµ(y) ≤ inf{λ(S)λ(T )kU k∞ , kU k }.

S×T

Therefore, in the theory of dense graph limits all three norms are equivalent. However,
although the cut norm is the simplest to state, we believe that the kernel norm
k · k2→2 norm is the correct extension to graphexes.
We now define some distances between graphexes. First, we define the δ2→2 distance, which will define a notion of convergence that is equivalent to GP-convergence
for graphexes with uniformly bounded marginals. The definition of δ2→2 will make
sense for signed graphexes, provided both the graphon parts and the absolute
marginals are in L1 ∩ L2 . We will therefore define the δ2→2 metric in this more
general1 setting.
1To see that this setting is indeed more general than the assumption of bounded marginals
for (unsigned) graphexes we recall that by Proposition 2.4, a graphex with bounded marginals is
integrable. Using this, and the fact that by definition, the graphon part of a graphex is bounded,
the claim is easy to verify.

10

BORGS, CHAYES, COHN, AND LOVÁSZ

Definition 2.9. A signed graphex W = (W, S, I, Ω) over Ω = (Ω, F, µ) is said
to be in L1 ∩ L2 if both W and D|W| are in L1 ∩ L2 . Here |W| is the graphex
|W| = (|W |, |S|, |I|, Ω).
Suppose W1 = (W1 , S1 , I1 , Ω) and W2 = (W2 , S2 , I2 , Ω) are defined on the same
underlying space Ω. We then define their d2→2 -distance as
(2.1)


p
p
d2→2 (W1 , W2 ) = max kW1 − W2 k2→2 , kDW1 − DW2 k2 , 3 |ρ(W1 ) − ρ(W2 )| ,
where ρ(Wi ) is the “edge density” of the signed graphex Wi ,
Z
Z
(2.2)
ρ(Wi ) = Wi + 2 Si + 2I.
The reason we take
become clearer
we define the general
√the roots will
√ later when
√
√
√
√
distance δ . Since c1 + c2 ≤ c1 + c2 and 3 c1 + c2 ≤ 3 c1 + 3 c2 , this is indeed
a metric.
Next, suppose two signed graphexes in L1 ∩ L2 , W1 = (W1 , S1 , I1 , Ω1 ) and
W2 = (W2 , S2 , I2 , Ω2 ), are defined over two σ-finite spaces Ω1 = (Ω1 , F1 , µ1 ) and
Ω2 = (Ω2 , F2 , µ2 ) with µ1 (Ω1 ) = µ2 (Ω2 ). Let π1 : Ω1 × Ω2 → Ω1 and π2 : Ω1 × Ω2 →
Ω2 be the projections. Then we define δe2→2 (W1 , W2 ) as the infimum
(2.3)

δe2→2 (W1 , W2 ) = inf d2→2 (Wπ1 1 ,µ , Wπ2 2 ,µ ),
µ

where the infimum is over all couplings µ of µ1 and µ2 .
To define the δ2→2 -distance we need one more notion, that of a trivial extension
of W = (W, S, I, Ω), where Ω = (Ω, F, µ) is a σ-finite measure space. It is defined
as a quadruple W0 = (W 0 , S 0 , I 0 , Ω0 ) where Ω0 = (Ω0 , F 0 , µ0 ) is a σ-finite measure
space such that Ω ∈ F 0 , F = {A ∈ F 0 : A ⊆ Ω}, and µ is the restriction of µ0 to
F, while W 0 is the extension of W that is 0 on the complement of Ω × Ω, S 0 is the
extension of S that is 0 on the complement of Ω, and I 0 = I. It is easy to see that
taking a trivial extension of a graphex has no effect on GT or G∞ (since Poisson
points sampled in the complement of Ω will be isolated for all T ).
Definition 2.10. Let W1 and W2 be signed graphexes in L1 ∩ L2 . Then we define
(2.4)
δ2→2 (W1 , W2 ) = δe2→2 (W0 , W0 ),
1

2

where W01 and W02 are trivial extensions of W1 and W2 to measure spaces of infinite
total mass. We refer to δ2→2 (W1 , W2 ) as the kernel distance of W1 and W2 and
call δ2→2 the kernel metric.
The existence of these extensions is trivial, since we can always append an interval
equipped with the Lebesgue measure. Nevertheless, it is not clear that δ2→2 (W1 , W2 )
is well defined, since the right side of (2.4) could depend on the particular choice of
the extensions W01 and W02 . In a similar way, while it is clear that δ2→2 is symmetric
and that δ2→2 (W, W) = 0, it is not clear that it is a metric (even after factoring
out the null space), since it is not clear that it satisfies the triangle inequality. The
following theorem addresses both questions, and will be proved in Section 3.
Theorem 2.11. Let W1 and W2 be signed graphexes in L1 ∩ L2 . Then the right
side of (2.4) does not depend on the choice of the trivial extensions W01 and W02 .
Furthermore, given three signed graphexes W1 , W2 , W3 in L1 ∩ L2 ,
δ2→2 (W1 , W3 ) ≤ δ2→2 (W1 , W2 ) + δ2→2 (W2 , W3 ).

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

11

Therefore, δ2→2 is a well-defined pseudometric.
Remark 2.12. In [3], when defining the cut distance between two graphons, it was
only necessary to extend the smaller space to the larger one, and it was not necessary
to extend further. It is natural to ask whether a trivial extension to a space of
infinite metric is necessary, or, equivalently, whether for two graphexes W1 , W2
defined on spaces with the same (finite) measure, δe2→2 (W1 , W2 ) = δ2→2 (W1 , W2 ).
In contrast to the cut distance discussed in [3], for the kernel metric it is sometimes
necessary to take trivial extensions of both spaces, not just an extension of the
smaller space to one of the same measure as the larger one. See Example 3.11 in
Section 3.
Our next theorem states that on sets with uniformly bounded marginals, the
topology induced by the kernel metric δ2→2 is equivalent to the topology of GPconvergence. We will prove it in Sections 6 and 7.
Theorem 2.13. For any D > 0, δ2→2 -convergence is equivalent to GP-convergence
on the space of graphexes with D-bounded marginals.
In general, δ2→2 -convergence implies GP-convergence, but the reverse is not true.
This is because if we do not assume bounded marginals, it is possible to have a
very small measure set with very large degree. This will have a non-negligible effect
on δ2→2 distance; however, for a fixed T , the chances of obtaining a vertex in the
small set is small, and thus has a small effect on sampling. To give a more concrete
example, let Wn be equal to 1 on [0, 1/n] × [1, 1 + n] and [1, 1 + n] × [0, 1/n], and zero
everywhere else. Let Wn = (Wn , 0, 0, R+ ). Then for any fixed T , the probability of
seeing a single edge in GT (Wn ) converges to 0, and therefore Wn is GP-convergent
to 0. However, it is easy to see that δ2→2 (Wn , 0) does not converge to 0. To address
this issue, we will define a new distance such that two graphexes whose graphex
processes can be obtained from each other by removing a small set of vertices are
close in the new metric. Our construction is loosely motivated by the construction
of the usual metric of weak convergence. For that reason, we will refer to the new
metric as the weak kernel metric.
Before defining this distance, we introduce the notation µ − r ≤ µ0 ≤ µ whenever
µ, µ0 are two measures over the same measurable space (Ω, F) such that
µ(B) − r ≤ µ0 (B) ≤ µ(B)
for all measurable sets B. Note that this property
is equivalent to the existence of a
R
function h : Ω → [0, 1] such that µ0 (B) = B h dµ and k1 − hk1,µ ≤ r. An example
of such a function, which we will often use, is the indicator function of a set Ω0 ⊆ Ω
such that µ(Ω \ Ω0 ) ≤ r.
We will define the weak kernel metric for arbitrary graphexes (removing the
condition that they are in L1 ∩ L2 ), and in fact will again allow for signed graphexes.
We will assume that the graphon parts of these signed graphexes are bounded in
the L∞ norm, a condition which is true for unsigned graphexes, since for these, the
graphon part takes values in [0, 1].
Definition 2.14. Let W1 = (W1 , S1 , I1 , Ω1 ) and W2 = (W2 , S2 , I2 , Ω2 ) be signed
graphexes, where Ωi = (Ωi , Fi , µi ) and kWi k∞ < ∞ for i = 1, 2. We define
δ (W1 , W2 ) as the infimum of the set of real numbers c such that there exist two
measures µ
e1 and µ
e2 over (Ω1 , F1 ) and (Ω2 , F2 ) that satisfy the following: the signed

12

BORGS, CHAYES, COHN, AND LOVÁSZ

W1 and f
W2 obtained from W1 and W2 by replacing µ1 and µ2 by µ
graphexes f
e1
and µ
e2 , respectively, are in L1 ∩ L2 , and
(1) for i = 1, 2, we have µi − c2 ≤ µ
ei ≤ µi , and
(2) δ2→2 (f
W1 , f
W2 ) ≤ c.
We refer to δ (W1 , W2 ) as the weak kernel distance between W1 and W2 and call
δ the weak kernel metric.
Note that for unsigned graphexes, the weak kernel distance is well defined and
finite. Indeed, given 0 < D < ∞, choose µ
ei as the restriction of µi to {DWi ≤ D}.
Proposition 2.4 then implies that {DWi > D} has finite measure, and Wi |{DWi ≤D}
is integrable and hence in L1 ∩ L2 . The fact that δ (W1 , W2 ) is well defined for
signed graphexes with bounded graphon part follows from Proposition 2.4 and
further arguments, and is deferred to Section 3; see in particular Lemma 3.12 in
that section.
We will show that δ is a pseudometric. It is clear that it is symmetric, and that
δ (W, W) = 0. It is not obvious that it satisfies the triangle inequality. We will
prove this fact in Section 3.
Theorem 2.15. Given three signed graphexes W1 , W2 , W3 with bounded graphon
part,
δ (W1 , W3 ) ≤ δ (W1 , W2 ) + δ (W2 , W3 ).
Therefore, δ is a pseudometric.
Remark 2.16. Given a signed graphex W = (W, S, I, Ω) with Ω = (Ω, F, µ) and a
measure-preserving map ϕ : Ω0 → Ω, let W0 = Wϕ almost everywhere. We can take a
coupling µ
e on Ω0 ×Ω defined by µ
e(A×B) = µ0 (A∩ϕ−1 (B)). It is easy to see that then
the pullbacks of the two signed graphexes to Ω0 × Ω will be equal almost everywhere,
which implies that δ2→2 (W, W0 ) = δe2→2 (W0 , W) = δ (W0 , W) = δe (W0 , W) = 0.
With this new metric, we now have a definition of distance for any pair of
graphexes. Note that in general, the metrics δ2→2 and δ are not be the same, even
if both are finite. However, we will show that for graphexes with uniformly bounded
marginals, the two metrics provide the same topology. This is the content of the
next proposition, which will be proved in Section 3.
Proposition 2.17. Fix D < ∞. Then δ and δ2→2 give an equivalent topology on
the space of graphexes with D-bounded marginals.
We will also show that convergence in the weak kernel metric δ is indeed
equivalent to GP-convergence. This is the statement of the next theorem, and
is one of the two main results of this paper. It will be proved using three main
ingredients: a compactness statement stemming from a suitable analogue of the
Frieze-Kannan regularity lemma, a counting lemma showing that subgraph counts
in the graphs GT (W) are close if the corresponding graphexes are close in the metric
δ2→2 (and the graphexes have uniformly bounded marginals), and a sampling lemma
showing that as T → ∞, the suitably rescaled graphex process GT (W) converges to
W in probability. These techniques are developed in Sections 5, 6, and 7, and are
combined to prove the theorem at the end of Section 7, where we will also prove
Theorem 2.13.
Theorem 2.18. Given a sequence of graphexes Wn and a graphex W, Wn is
GP-convergent to W if and only if δ (Wn , W) → 0.

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

13

Remark 2.19. The reader might wonder whether instead of building our metric for
GP-convergence around the kernel norm k · k2→2 , one could equivalently build it
around the cut norm, k · k . Concretely, one might want to define d by replacing
the kernel norm in (2.1) by the cut norm and the L2 norm by the L1 norm, then
proceed as in (2.3) and (2.4) to obtain a cut distance δ between graphexes with
bounded marginals, and finally proceed as in Definition 2.14 to obtain a “weak cut
metric” for arbitrary graphexes.
The following example shows that this approach does not work, in that it will
not metricize GP-convergence. Define Wn to be the graphex that is constant and
equal to n−2 over [0, n]2 and 0 everywhere else, and set Wn = (Wn , 0, 0, R+ ), where
R+ is equipped with the Lebesgue measure. The marginal DWn of Wn is then equal
to 1/n times the indicator function of the interval [0, n], and its L1 norm is equal
to 1. It is then not hard to check that Wn converges to the pure dust graphex
(0, 0, 1, R+ ) in the metric δ . Indeed, kWn k2→2 → 0 and kDWn k2 = n−1/2 → 0,
while kWn k = 1 → 1 = kWk1 , which immediately implies convergence in the metric
δ and hence GP-convergence (based on the proof of equivalence in this paper,
though for this specific case it is simple to check GP-convergence directly). By
contrast, kWn k = kWn k1 = 1 stays bounded away from zero, showing in particular
that Wn does not converge to W in the cut metric δ . Since changing the Lebesgue
measure to a measure µn such that λ − εn ≤ µn ≤ λ with εn → 0 will asymptotically
not change the cut norm of Wn , the graphexes Wn do not converge to W in the
weak cut metric either. Note that this can’t be cured by choosing a different norm
for the marginal difference DW1 − DW2 , e.g., by keeping the L2 norm for that part,
since the above counter example works independently of the norm used for that
part.
In studying the general topology of graphexes, we define a notion of tightness
for sets of graphexes. Tight sets play an important role, in particular, they are
the precompact sets in our topology: any sequence that is tight has a convergent
subsequence, and any convergent sequence must be tight.
Definition 2.20. A set S of graphexes is tight if for every ε > 0, there exist C and
D such that for every W ∈ S, W = (W, S, I, Ω) with Ω = (Ω, F, µ), there exists
Ωε ⊆ Ω such that µ(Ωε ) ≤ ε and the graphex W0 = W|Ω\Ωε is (C, D)-bounded.
Here a graphex W0 is called (C, D)-bounded if its marginals are D-bounded and
kW0 k1 ≤ C.
Note that Proposition 2.4 implies that every finite set of graphexes is tight. In
Section 4, we will prove that a set S of graphexes is tight if and only if for all fixed
T , the corresponding set {GT (W)}W∈S of unlabeled graphex processes at time T
is tight (which will also be equivalent to the existence of some T > 0 such that
{GT (W)}W∈S is tight; see Theorem 4.1 below). Here, as usual, a collection S of
distributions on finite graphs is called tight if for every ε > 0, there exists a finite
set T of graphs such that for each of the random graphs in S , the probability that
the random graph is not isomorphic to a graph in T is at most ε. This is equivalent
to the set of random measures being tight under the discrete topology on the set of
isomorphism classes of finite graphs, or the set of distributions of the number of
edges being tight.
Our main theorem concerning tightness is the following theorem. It will be
proved in Section 5, where we will establish a version of the weak (or Frieze-Kannan)

14

BORGS, CHAYES, COHN, AND LOVÁSZ

regularity lemma for graphexes. Note that while our regularity lemma will hold for
signed graphexes, the following is only stated for unsigned graphexes. The reason is
that our proof relies heavily on the notion of tightness, which we only develop for
unsigned graphexes; see also Remark 4.8 in Section 4.
Theorem 2.21. The space of all graphexes is complete under the topology induced
by the weak kernel metric δ . A subset is relatively compact if and only if it is tight.
In particular, for any C and D, the set of graphexes with kWk1 ≤ C is compact
under δ , and the set of (C, D)-bounded graphexes is compact under both δ and
δ2→2 .
Remark 2.22. As mentioned above, we only develop the theory of tightness for
unsigned graphexes. In particular, we don’t characterize the set of precompact
signed graphexes. That notwithstanding, some of our compactness results do hold
for signed graphexes. Here we only mention that the analogue of the statement for
the set of graphexes with kWk1 ≤ C holds for signed graphexes as well, provided
we restrict the L∞ norm of the graphon part (which by definition is bounded
by 1 for unsigned graphexes). To be explicit, any sequence of signed graphexes
Wn = (Wn , Sn , In , Ωn ) with kWn k∞ ≤ B and kWn k1 ≤ C has a subsequence
converging to a signed graphex W = (W, S, I, Ω) with kW k∞ ≤ B and kWk1 ≤ C.
See Remark 5.10 in Section 5 below.
The advantage of (C, D)-bounded (unsigned) graphexes is that although there is
no a priori bound on the size of GT (W) at any given time T , for any finite graph
F , the expected number of copies of F in GT (W) is finite. Furthermore, it turns
out that under the assumption of (C, D)-boundedness, if two graphexes have the
same subgraph densities, then they are equivalent, i.e., have δ2→2 distance 0. In
this way, we can heuristically think of these subgraph densities as being analogous
to moments of random variables: it is well known that moments determine the
distribution of random variables, provided the moments do not grow too quickly.
To make these statements precise, we will define homomorphism densities for a
graphex W. To this end, we first consider a finite, labeled graph F and a graphon
W , and define
Z
Y
Y
t(F, W ) =
W (xi , xj )
dµ(xi ).
ΩV (F ) (i,j)∈E(F )

i∈V (F )

Given a connected multigraph F = (V, E) on k ≥ 2 vertices with no loops, and a
graphex W = (W, S, I, Ω), we define t(F, W) as follows. First, if F consists of a
single edge, we define
Z
Z
t(F, W) =
W (x, y) dµ(x) dµ(y) + 2
S(x) dµ(x) + 2I = ρ(W).
Ω2

Ω

Otherwise, let V≥2 be the set of vertices of F with degree at least 2, and for each
such vertex v, let d1 (v) be the number of neighbors of v that have degree 1. Then
Z
Y
Y
t(F, W) =
W (zv , zw )
DW (zv )d1 (v) dµ(zv ).
V≥2

Ω

{v,w}∈E(F (V≥2 ))

v∈V≥2

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

15

Finally, for any multigraph F with no isolated vertices, let F1 , F2 , . . . , Fk be the
components of F . Then we define the homomorphism density of F in W as
t(F, W) =

k
Y

t(Fi , W).

i=1

As we will see in Proposition 3.24, these homomorphism densities are defined in such
a way that for a simple graph F and a graphex W, they are equal to the expected
number of injective homomorphisms from F into GT (W) times T −|V (F )| .
Having defined the subgraph densities t(F, W), we can summarize the main
relationship between convergence in the metric δ2→2 , convergence of subgraph
counts, and GP-convergence in the following theorem. Its proof will also be given
at the end of Section 7.
Theorem 2.23. Assume that W and Wn for n ≥ 1 are graphexes whose marginals
are D-bounded for some finite D. Then the following are equivalent.
(1) δ2→2 (Wn , W) → 0.
(2) For every graph F with no isolated vertices, t(F, Wn ) → t(F, W).
(3) For every connected graph F , t(F, Wn ) → t(F, W).
(4) GT (Wn ) → GT (W) in distribution for every T .
(5) GT (Wn ) → GT (W) in distribution for some T .
Remark 2.24. The above theorem implies in particular that in order to check whether
a sequence Wn of graphexes with uniformly bounded marginals is GP-convergent,
it is enough to check convergence of GT (Wn ) for a single T > 0. In a similar way,
several other properties of sequences or sets of graphexes can be equivalently stated
for all T > 0 or some T > 0 (see, in particular, the already mentioned Theorem 4.1
about tightness and Theorem 9.1 about uniform integrability). But for general
sequences of graphexes, we do not know whether GP-convergence is equivalent to
the convergence of GT (Wn ) for just one T > 0.
It is instructive to compare our notions of convergence to the notions of graph
convergence introduced in [3] and [4]. Before defining these notions, we first introduce
the notion of a dilated empirical graphon corresponding to a finite graph G. It
involves a “dilation parameter” ρ ∈ R+ and is defined as the graphex W(G, ρ)
consisting of a zero dust part, a zero star part, a measure space consisting of the
vertex set V (G) where each vertex has measure ρ, and a graphon W (G, ρ) which is
simply the adjacency matrix of G. The usual way to embed graphs into the space
of graphons in the dense case correspondsp
to ρ = 1/|V (G)|.
By contrast, in [3], ρ was chosen to be 1/ 2|E(G)|; the resulting dilated empirical
graphon was called the stretched empirical graphon, and a sequence
was said to
p
converge in the stretched cut metric if the graphons W (G, 1/ 2|E(G)|) converge
in the cut metric δ . It was then shown that this leads to completeness (every
Cauchy sequence has a limit), that convergence implies a certain condition called
uniform tail regularity, and that any uniformly tail regular sequence has a convergent
subsequence.
The notion of convergence in [4] is slightly different. It does not start from
a metric, and instead tries to emulate the notion of subgraph convergence from
dense graphs. Roughly speaking, it asks that certain random subgraphs of the
graphs in the sequence converge in distribution to some well-defined distribution
over finite graphs. More precisely, given a parameter p ∈ [0, 1], define Smpl(G, p) as

16

BORGS, CHAYES, COHN, AND LOVÁSZ

the unlabelled graph obtained by first taking each vertex i.i.d. with probability p,
then removing all isolated vertices in the resulting subgraph, and finally discarding
all the labels. A sequence Gn is then said to be sampling convergent if for all t > 0,
the samples
p
Smpl(Gn , min{1, t/ 2|E(Gn )|})
converge in distribution. It was then shown that any sequence of finite graphs has
a convergent subsequence, and that the limiting distribution can be expressed as
Gt (W) for some integrable graphex W with kWk1 ≤ 1. It was also shown that this
inequality holds with equality if and only if the sequence has a property called
uniform sampling regularity.
It is instructive to relate the results and notions from [4] to those developed in
this paper. To this end, we first note that—as already observed in [4]—a sequence
of graphs p
is sampling convergent if and only if the stretched canonical graphexes
W(Gn , 1/ 2|E(Gn )|) are GP-convergent. Since by definition, the stretched canonical graphex has L1 norm 1, this sequence is tight. By our compactness theorem,
Theorem 2.21, it therefore has a convergent subsequence.
To relate some of the other notions and results from [3] and [4] to those of this
paper, we introduce a couple of definitions. The first notion is that of uniform
integrability. Recall that a set S of random variables with values in R is called
uniformly integrable if for every ε > 0, there exists K ∈ R such that for every
X ∈ S,
E[|X|1|X|>K ] < ε.
Note that this implies that E[|X|] ≤ ε + K, so the set of random variables consists of
integrable variables with uniformly bounded integrals. This motivates the following
definition.
Definition 2.25. A set of graphexes S is called uniformly integrable if the graphexes
in S have uniformly bounded k · k1 -norms, and for every ε > 0, there exists a D
such that for all W ∈ S, kDW 1DW >D k1 < ε.
As we will see in Theorem 9.1 below, uniform integrability of a set S of graphexes
is equivalent to uniform integrability of the random variables {E(GT (W)) : W ∈ S}
for all T > 0 (which is also equivalent to uniform integrability of this set of random
variables for some T > 0).
The notion of uniform sampling regularity from [4] is then simply uniform
integrability of the stretched empirical graphexes, and the following theorem is a
more or less straightforward generalization of Corollary 3.10 in [4], which states that
the limiting graphex of a sampling convergent sequence of graphs has norm 1 if and
only if it is uniformly sampling regular. We will prove the theorem in Section 9.
Theorem 2.26. Suppose Wn is a sequence of integrable graphexes with uniformly
bounded k · k1 -norms that converges to a graphex W in the weak kernel metric. Then
kWk1 ≤ lim inf kWn k1 .
n→∞

In particular, W is integrable. We furthermore have that
lim kWn k1 = kWk1

n→∞

if and only if the sequence Wn is uniformly integrable.

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

17

Our next set of theorems relates the notion of sampling convergence from [4]
to the notion of convergence in the cut metric from [3]. We start by recalling the
definition of uniform tail regularity from [3] (see also Lemma 9.3 in Section 9 for
other, equivalent definitions).
Definition 2.27 ([3]). Given a set of signed, integrable graphons S, we say that
they are uniformly tail regular if for any ε > 0, there exists M such that for each
W ∈ S with the usual notation, there exists Ω0 ⊆ Ω such that µ(Ω0 ) ≤ M and
kW k1 − kW |Ω0 k1 ≤ ε.
Note that uniform tail regularity is more restrictive than uniform integrability
(for the set of graphexes obtained by setting the dust and star part to zero). For
sequences of graphs, the corresponding result was shown in [4], but it holds in our
more general setting as well, with essentially the same proof; see Lemma 9.2 in
Section 9 below. More interestingly, any sequence of graphons that is convergent in
cut metric has uniformly regular tails, and any sequence of graphons with uniformly
regular tails has a subsequence that converges in cut metric. Motivated by this
(which is one of the central results of [3]), here we prove the following.
Theorem 2.28. Given a sequence of integrable graphexes of the form
Wn = (Wn , 0, 0, Ωn ),
the following are equivalent.
(1) The sequence Wn converges to a graphon W in cut metric.
(2) The sequence Wn is uniformly tail regular, and in the weak kernel metric,
the sequence Wn converges to a graphex of the form W = (W, 0, 0, Ω).
(3) The sequence Wn is uniformly tail regular, and in the weak kernel metric,
the sequence Wn converges to some graphex W.
This theorem, as well as our next theorem, will also be proved in Section 9.
Theorem 2.29. Given a sequence of uniformly integrable graphexes
Wn = (Wn , Sn , In , Ωn ),
which converge to a graphex W = (W, S, I, Ω) in the weak kernel metric, the following
are equivalent.
(1) The graphex W is of the form W = (W, 0, 0, Ω).
(2) kSn k1 → 0 and In → 0, and the sequence of graphons Wn has uniformly
regular tails.
(3) kSn k1 → 0 and In → 0, and the sequence of graphons Wn converges in the
cut metric.
Recall that a sequence of graphs is sampling convergent if and only if the stretched
canonical graphexes are GP-convergent. This fact, Theorem 2.26, and Theorem 2.29
together imply that given a sequence of graphs that is sampling convergent to a
graphex of norm one, the sequence converges to a pure graphon if and only if the
sequence is uniformly tail regular. We have therefore given a characterization of when
the notion of sampling convergence from [4] reduces to the notion of convergence in
the stretched cut metric from [3].
Remark 2.30. In the above theorem, the assumption of uniform integrability is
necessary. To see this, let Wn be the graphon defined by being 1 on the set

18

BORGS, CHAYES, COHN, AND LOVÁSZ

[0, 1/n] × [1, n + 1] and its transpose, and 0 otherwise, and let Wn = (Wn , 0, 0, R+ ).
Then the sequence Wn converges to the zero graphex in the weak kernel metric,
which is a pure graphon. However, the sequence is clearly not uniform tail regular
(or even uniformly integrable). We can also let Sn (x) = 1/n on the set [0, n], and 0
everywhere else. In that case the sequence still converges to 0 in the weak kernel
metric, but kSn k1 does not converge to 0.

We close this section by discussing possible extensions of our theory. First, as
already discussed in the introduction, it would be natural to extend the theory of
graphexes to a theory that naturally generates multi-graphs. Note that a priori, this
falls plainly in the framework of exchangeable random measures on R2+ as developed
by Kallenberg; in fact, it falls into the framework of exchangeable random counting
measures. Generalizing the approach of [26, 3], this will give a natural notion of
“multi-graphexes” characterizing all exchangeable multi-graphs with vertices labelled
by R+ . But extending the current work to multi-graphexes is beyond the scope of
this paper, in particular given that it would require to generalize at least some of
the results from [26, 17, 25, 18, 4] to this setting in a first step. See [6] for some
very preliminary steps in this direction.
The next extension one might want to consider is the extension of our analytical
results (i.e., those of our results which do not refer to the graphex process generated
by a graphex) to signed graphexes. In contrast to the theory of cut metric convergence
for graphons over σ-finite measure spaces developed in [3], which works as well for
signed, unbounded graphons as for graphons with values in [0, 1], here we focused
most of the theory of graphex convergence on unsigned graphexes (with graphon
parts taking values in [0, 1]). While several of our technical proofs and results hold
for signed graphexes (in particular, all of Section 3, as well as parts of Sections 5
and 6 are formulated in this language), the core analytic concepts and results
such as tightness, precompactness, etc., have only been formulated for unsigned
graphexes. Indeed, we believe that the generalization of Theorem 2.21 to signed
graphexes requires modifications to either our topology or our notions of tightness;
see Remark 4.8 below. In a similar way, while the identification theorem of [3] works
for signed graphons, our identification theorem requires non-negative graphexes,
even though one might conjecture that when stated as a characterization of the
equivalence classes under the weak kernel metric, it should hold for signed graphexes
as well, at least when suitably formulated.
Finally, one might want to consider graphexes where the graphon part W is
unbounded, whether non-negative or signed. For non-negative graphexes, one
could, for example, follow the approach in [6] and use such a graphex to generate
multi-graphs by adding Pois(W (xi , yi )) many edges to a pair of Poisson points with
features xi and xj , or one could try to generalize the approach of [5] to the setting
of graphexes, by taking a decreasing “dilution probability” pt , and then connect two
Poisson points with features xi and xj with probability min{1, pt W (xi , xj )} (see
[2] for a related approach). But is far from obvious what the analogue of the weak
kernel metric should be, and how to generalize our other results to this setting. As
the other open questions discussed here, we leave these questions as open research
problems.

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

19

3. Preliminaries
In this section, we study the metrics δ2→2 and δ . In particular, we will prove
Theorems 2.11 and 2.15, as well as Proposition 2.17 relating the two for graphexes
with bounded marginals (in fact, we will prove its generalization to signed graphexes,
stated as Proposition 3.15 below).
In addition, we study the metric δ obtained from δ2→2 by replacing d2→2 as
defined in (2.1) by
(3.1)

d (W1 , W2 ) = max {kW1 − W2 k , kDW1 − DW2 k , |ρ(W1 ) − ρ(W2 )|} .

Here we use the norm k · k both for functions from Ω2 → R (see Definition 2.8)
and functions from Ω → R, where it is defined as


Z

 1


F (x)dµ(x) .
kF k = sup  p


µ(S) S
S⊆Ω
We will in particular show that the analogue of Theorem 2.11 holds for this metric.
Theorem 3.1. Let W1 and W2 be signed graphexes in L1 ∩ L2 . Define δ by
replacing the right side of (2.4) with δe , which in turn is obtained from δe2→2 by
replacing d2→2 with d . Then the value of δ (W1 , W2 ) does not depend on the
choice of the trivial extensions W01 and W02 , and δ obeys the triangle inequality,
making it a well-defined pseudometric.
This jumble metric will be particularly useful when establishing the regularity
lemma for graphexes, which takes a nicer form when stated in terms of the distance
d instead of the distance d2→2 , both because of the absence of the various roots,
and because the proof of the regularity lemma leads more naturally to bounds in
term of k · k rather than k · k2→2 . To obtain our compactness results for the metric
δ (which is derived from d2→2 ), we will then need to compare the two. We will do
this in Proposition 3.19 and Remark 3.23 below.
We will also establish a simple lemma relating the kernel norm to 4-cycle counts
(Lemma 3.22). Finally, we will prove that the homomorphism densities t(F, W)
indeed describe the expected number of injective homomorphisms from F into
GT (W) (Proposition 3.24).
Except for the last result, all results in this section are as easily derived for signed
graphexes as for unsigned graphexes. We therefore formulate everything in this
section in the language of signed graphexes. To do so, we need very little extra
notation, except for the following.
First, we define the absolute marginal of a signed graphex W as D|W| , and say
that W has D-bounded absolute marginals if kD|W| k∞ ≤ D. We say that W is
(C, D)-bounded if in addition kWk1 ≤ C. Furthermore, we introduce the notion of
(B, C, D)-boundedness of a graphex W = (W, S, I, Ω) by requiring that
(3.2)

kW k∞ ≤ B,

kWk1 ≤ C,

and

kD|W| k∞ ≤ D,

and finally, we say that W has a bounded graphon part if kW k∞ < ∞.
We use the following standard facts about measure-preserving transformations,
which we prove for completeness.
Lemma 3.2. Suppose φ : Ω → Ω0 is a measure preserving map between two σ-finite
measure spaces (Ω, F, µ) and (Ω0 , F 0 , µ0 ).
(1) For any σ-algebra G ⊆ F, L1 (Ω, G, µ) is a closed subspace in L1 (Ω, F, µ).

20

BORGS, CHAYES, COHN, AND LOVÁSZ

(2) If f ∈ L1 (Ω, φ−1 (F 0 ), µ), then there exists a function f 0 ∈ L1 (Ω0 , F 0 , µ0 )
such that f = f 0φ = f 0 ◦ φ almost everywhere.
φ
(3) The map φ∗ : L1 (Ω0 , F 0 , µ0 ) → L1 (Ω, φ−1 (F 0 ), µ) with f 0 7→ f 0 is an iso∗
metric isomorphism, implying that φ and its inverse are continuous and
hence Borel measurable.
(1) L1 (Ω, G, µ) is clearly a subspace of L1 (Ω, F, µ). Since they are both
Banach spaces, they are both complete. Since L1 (Ω, G, µ) ⊆ L1 (Ω, F, µ) is
an isometric embedding, the only way we can have a complete subset of a
complete space is if the subset
R itself is closed.
(2) The map sending A ⊆ Ω to A f defines a finite, signed measure ν on Ω,
absolutely continuous with respect to µ. This measure pushes forward to a
signed measure ν 0 on Ω0 . If B ⊆ Ω0 has µ0 (B) = 0, then µ(φ−1 (B)) = 0, so
ν 0 (B) = ν(φ−1 (B)) = 0. Therefore ν 0 is absolutely continuous with respect
to µ0 , so it has a Radon-Nikodym derivative f 0 . It is straightforward to check
that, since f is φ−1 (F 0 ) measurable, we have f = f 0φ almost everywhere.
(3) This follows from the previous parts.


Proof.

We will also need the following lemma.
Lemma 3.3. Suppose that Ω = (Ω, F, µ) with µ(Ω) < ∞, and suppose that g ∈
L2 (Ω). Let
R



 Ω f g dµ 
q
.
(3.3)
S=
sup
 R

f ∈L∞ (Ω),0≤f ≤1 
f dµ 
Ω

Then S ≤ kgk2 < ∞, and there exists X ⊆ Ω such that

R
 g dµ
X
S= p
.
µ(X)
Note that this expression is the same as taking f = 1X in (3.3).
Proof. First, note that if 0 ≤ f ≤ 1, then
 sR
R
sR
R


2 dµ
2 dµ
 Ω f gdµ 
f
g
f 2 dµ
Ω R
Ω
Ω
≤
q
R
=
kgk
≤ kgk2 < ∞.
2
 R

f dµ
f dµ


Ω
Ω
f
dµ
Ω
Next, we will show that there exists a δ > 0 such that in (3.3), it suffices to consider
e = Ω × [0, 1] and µ
f with kf k1 ≥ δ. Let Ω
e = µ × λ, where λ is the Lebesgue
measure, and let ge(x, t) = g(x). Then the expression in (3.3) is the same as taking
the supremum of
R

 ge de
µ
X
p
µ
e(X)
e Indeed, given X ⊆ Ω,
e we can plug in the function f (x) = λ({t : (x, t) ∈
over X ⊆ Ω.
X}) into (3.3), which is defined almost everywhere, and given f as in (3.3), we can
take X = {(x, t) : t ≤ f (x)}. It is straightforward to check that (3.3) and the above
expression give the same value. Note that we have
R

 ge de
µ
X
p
≤ ke
g |X k 2 .
µ
e(X)

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

21

Since ke
g k2 < ∞, for any ε > 0, there exists a K such that
Z
Z
ε2
ge2 dµ ≤ ge2 1ge>√K + K µ
e(X) ≤
+ Kµ
e(X).
2
X
Thus, given ε > 0, we can find a δ > 0 such that if µ(X) < δ, then ke
g |X k2 ≤ ε.
Taking
ε
=
S/2
(note
that
unless
g
=
0,
S
>
0),
we
obtain
a
δ
such
that if
R
f
dµ
<
δ,
then
the
expression
in
(3.3)
is
less
than
S/2.
This
means
that
it
suffices
Ω
to take the supremum over f with kf k1 ≥ δ.
Recall that we assumed that Ω has finite measure. The set of f ∈ L∞ (Ω)
with 0 ≤ f ≤ 1 and kf k1 ≥ δ is weak-∗ closed and therefore weak-∗ compact.
The expression in (3.3) is weak-∗ continuous; therefore, there exists an f which
maximizes the expression.
Clearly such an f is supported either on the set {g > 0} or {g < 0}. Assume
without loss of generality that it is supported on {g > 0}. Suppose that f is not
equal to 0 or 1 almost everywhere. Then we can find 0 ≤ h ≤ e
h ≤ 1, supported
on {g > 0}, such that f = (e
h + h)/2, and it is not the case that e
h = h almost
everywhere. This implies that
Z
(e
h − h) dµ > 0
Ω

and
Z
(e
h − h)g dµ > 0.
Ω

Let ht = te
h + (1 − t)h. Note that for t ∈ [0, 1], 0 ≤ ht ≤ 1 almost everywhere. Let
R
ht g
p(t) = qΩR
.
h
t
Ω
We have
d
p(t) =
dt

R
Ω

(e
h − h)g dµ

R
Ω

R
R
h − h) dµ Ω (te
h + (1 − t)h)g dµ
(te
h + (1 − t)h) dµ − 21 Ω (e
.
R
3/2
e
(t
h
+
(1
−
t)h)
dµ
Ω

Notice that the denominator above is always positive, and the numerator above is
of the form At + B, where
Z
Z
Z
Z
1
A = (e
h − h)g dµ (e
h − h) dµ −
(e
h − h) dµ (e
h − h)g dµ
2 Ω
Ω
Ω
Z
ZΩ
1
=
(e
h − h) dµ (e
h − h)g dµ > 0.
2 Ω
Ω
d
This means that there are three possibilities for dt
p(t): it can be positive for every
t ∈ (0, 1), it can be negative for every t ∈ (0, 1), or it can be negative and then
positive. Either of these cases implies that the maximum of p on [0, 1] is attained at
one or both of the endpoints, and therefore either p(0) or p(1) is strictly greater
than p(1/2). This contradicts the assumption that f was maximal, completing the
proof of the lemma.


Using the previous two lemmas, we prove the following proposition. We will use it
for functions which arise as the difference of two graphons with bounded marginals.

22

BORGS, CHAYES, COHN, AND LOVÁSZ

Proposition 3.4. Let Ω = (Ω, F, µ) and Ω0 = (Ω0 , F 0 , µ0 ) be σ-finite measure
spaces, and let ϕ : Ω0 → Ω be measurable. If U : Ω × Ω → R and F : Ω → R are
square integrable, then
kU k2→2 = kU ϕ k2→2 ,

kF k = kF ϕ k ,

and

kU k = kU ϕ k .

If instead of square integrability, we assume that U is integrable, then
kU k = kU ϕ k .
Proof. For any f, g ∈ L2 (Ω), it is easy to see that f ◦ U ◦ g = f ϕ ◦ U ϕ ◦ g ϕ , and we
furthermore have that f φ , g φ ∈ L2 (Ω0 ) with kf φ k2 = kf k2 and kg φ k2 = kgk2 . This
implies that
kU k2→2 ≤ kU ϕ k2→2 .
To prove the opposite inequality, let fb, gb ∈ L2 (Ω0 ), and assume first that fb, gb ∈
L1 (Ω0 ) as well. Let f 0 = E[fb|ϕ−1 (F)] and g 0 = E[b
g |ϕ−1 (F)]. That is, f 0 is a
−1
−1
ϕ (F)-measurable function such that for any ϕ (F)-measurable set S 0 ⊆ Ω0 ,
R
R
f 0 = S 0 fb, and same for g 0 . These functions exist by the Radon-Nikodym
S0
theorem (since all measures are σ-finite). Then kf 0 k2 ≤ kfbk2 , kg 0 k2 ≤ kb
g k2 . We
claim that f 0 ◦ U ϕ ◦ g 0 = fb ◦ U ϕ ◦ gb. Indeed, for any x0 ∈ Ω0 ,
(U ϕ )x0 (y 0 ) = U ϕ (x0 , y 0 ) = U (ϕ(x0 ), ϕ(y 0 )) = Uϕ(x0 ) (ϕ(y 0 )) = (Uϕ(x0 ) )ϕ (y 0 ),
showing that (U ϕ )x0 is the pullback of an F-measurable function, and is thus
ϕ−1 (F)-measurable. Therefore, for every x0 ∈ Ω0 ,
Z
Z
U ϕ (x0 , y 0 )b
g (y 0 ) dµ0 (y 0 ) =
U ϕ (x0 , y 0 )g 0 (y 0 ) dµ0 (y 0 ),
Ω0

Ω0

which shows that fb◦ U ϕ ◦ gb = fb◦ U ϕ ◦ g 0 . We can analogously show that fb◦ U ϕ ◦ g 0 =
f 0 ◦ U ϕ ◦ g 0 . Then, since f 0 and g 0 are ϕ−1 (F)-measurable, there exist by Lemma 3.2
f, g ∈ L1 (Ω) with f 0 = f ϕ and g 0 = g ϕ . This implies that kf k2 ≤ kfbk, kgk2 ≤ kb
g k2 ,
ϕ
b
and f ◦ U ◦ g = f ◦ U ◦ gb, which shows that
fb ◦ U ϕ ◦ gb ≤ kU k2→2
whenever fb, gb ∈ L2 (Ω0 ) ∩ L1 (Ω0 ) and kfbk2 , kb
g k2 ≤ 1. Since Ω0 is σ-finite, any
2
0
function in L (Ω ) can be written as a limit of functions in L2 (Ω0 ) ∩ L1 (Ω0 ). A
dominated convergence argument then shows that the above bound holds whenever
fb, gb ∈ L2 (Ω0 ) and kfbk2 , kb
g k2 ≤ 1, proving that
kU ϕ k2→2 ≤ kU k2→2 .
To prove the statement for the cut norm, we use the representation kU k =
supf,g : Ω→[0,1] |f ◦ U ◦ g|. Using this representation, the proof for the cut norm
proceeds along the same lines as the proof for the k · k2→2 norm.
Next, let us prove that kF k = kF ϕ k . First, for any measurable X ⊆ Ω with
µ(X) < ∞, since µ is the pushforward of µ0 ,
R
R
F ϕ dµ0
F dµ
ϕ−1 (X)
X
p
= p
.
0
−1
µ (ϕ (X))
µ(X)

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

23

This shows that kF k ≤ kF ϕ k . Suppose now that X 0 ⊆ Ω0 , and let f 0 =
E[1X |ϕ−1 (F)]. Then there exists f ∈ L1 (Ω) so that f 0 = f ϕ . Since F ϕ is ϕ−1 (F)measurable,
R
R
R
f F dµ
F ϕ dµ0
f 0 F ϕ dµ0
X0
Ω0
p
= qΩR
= qR
.
0
0 dµ0
µ (X)
f
f
dµ
Ω
Ω
Fix ε > 0. Since Ω is σ-finite, there exists Ω0 ⊆ Ω with µ(Ω0 ) < ∞ and
R
R
f F dµ
f F dµ
Ω0
qR
≥ (1 − ε) qΩR
.
f dµ
f dµ
Ω0
Ω
By the previous lemma, there exists a measurable set X ⊆ Ω0 so that
R
R
R
f F dµ
F
dµ
f F dµ
Ω0
X
p
q
q
.
≥ R
≥ (1 − ε) ΩR
µ(X)
f dµ
f dµ
Ω0
Ω
Since this holds for any ε > 0, this proves that kF k ≥ kF ϕ k .
Finally, we show that kU k = kU ϕ k . As before, for any measurable X, Y ⊆ Ω
with µ(X), µ(Y ) < ∞, since µ is the pushforward of µ0 ,
R
R
U ϕ (dµ0 )2
U (dµ)2
ϕ−1 (X)×ϕ−1 (Y )
p
p
= pX×Y p
.
µ0 (ϕ−1 (X)) µ0 (ϕ−1 (Y ))
µ(X) µ(Y )
This shows that kU k ≤ kU ϕ k . For the other direction, let X 0 , Y 0 ⊆ Ω0 with finite
measure. By the previous argument, there exist functions f, g : Ω → [0, 1] such that
R
R
U ϕ (dµ0 )2
f (x)U (x, y)g(y) dµ(x) dµ(y)
X 0 ×Y 0
Ω2
qR
= p
.
R
µ0 (X 0 )µ0 (Y 0 )
f dµ g dµ
Ω

Ω

Fix ε > 0. By the previous argument, there exists X ⊆ Ω such that
R
R
U (x, y)g(y) dµ(x) dµ(y)
2 f (x)U (x, y)g(y) dµ(x) dµ(y)
X×Ω
q
qR
≥ (1 − ε) Ω
.
R
R
µ(X) Ω g dµ
f dµ Ω g dµ
Ω
Then, applying it again, there exists Y ⊆ Ω such that
R
R
U (x, y)g(y) dµ(x) dµ(y)
U (x, y) dµ(x) dµ(y)
X×Y
p
≥ (1 − ε) X×Ω q
.
R
µ(X)µ(Y )
µ(X) g
Ω

Combining these, we obtain
R
R
U (x, y) dµ(x) dµ(y)
U ϕ dµ0
X×Y
2 X 0 ×Y 0
p
≥ (1 − ε) p
.
µ(X)µ(Y )
µ0 (X 0 )µ0 (Y 0 )
Since this holds for any ε > 0, we obtain that kU k ≥ kU ϕ k .



Next we establish a sequence of lemmas leading to the proof of Theorem 2.11,
which states that δ2→2 is a pseudometric. To state the first lemma, we define the
vectors
∆2→2 (W1 , W2 ) = (kW1 − W2 k2→2 , kDW1 − DW2 k2 , |ρ(W1 ) − ρ(W2 )|)
∆ (W1 , W2 ) = (kW1 − W2 k , kDW1 − DW2 k , |ρ(W1 ) − ρ(W2 )|) ,

and

24

BORGS, CHAYES, COHN, AND LOVÁSZ

where again we require the signed graphexes W1 and W2 to be in L1 ∩ L2 . Note
that each coordinate satisfies the triangle inequality. We will also use the following
property.
Lemma 3.5. Let Ω = (Ω, F, µ) and Ω0 = (Ω0 , F 0 , µ0 ) be σ-finite measure spaces,
let ϕ : Ω → Ω0 be a measure-preserving map, and let W1 , W2 be signed graphexes in
L1 ∩ L2 . Then
ϕ
∆2→2 (W1 , W2 ) = ∆2→2 (Wϕ
1 , W2 )

and

ϕ
∆ (W1 , W2 ) = ∆ (Wϕ
1 , W2 ).

ϕ
Proof. Clearly ρ(W1 ) = ρ(Wϕ
1 ) and ρ(W2 ) = ρ(W2 ), which means that their
differences are equal too. We also have for every x ∈ Ω, DWi (ϕ(x)) = DWϕi (x),
which implies that kDW1 − DW2 k2 = kDWϕ1 − DWϕ2 k2 . Therefore it remains to show
that
kW1 − W2 k2→2 = kW1ϕ − W2ϕ k2→2
as well as

and kW1 − W2 k = kW1ϕ − W2ϕ k .

kDW1 − DW2 k = kDWϕ1 − DWϕ2 k

ϕ

Note that DWϕ1 − DWϕ2 = (DW1 − DW2 )
Proposition 3.4, we are done.

and W1ϕ − W2ϕ = (W1 − W2 )ϕ , so by


To prove the triangle inequality, we would like to take a coupling of Ω1 and Ω2
and a coupling of Ω2 and Ω3 , and use them to obtain a coupling of Ω1 and Ω3 .
Unfortunately this cannot be done for general signed graphexes. We can, however do
it if the signed graphexes involved are step graphexes. To define these, we first define
a subspace partition of a measure space Ω = (Ω, F, µ) as a partition of a measurable
subset Ω0 ⊆ Ω into countably many measurable subsets. Such a subspace partition
is called finite if it is a partition into finitely many sets of finite measure. A signed
graphex U is then called a step graphex over the subspace partition P = (P1 , . . . , Pm )
if P is a finite subspace partition, dsupp U ⊆ P1 ∪ P2 ∪ · · · ∪ Pm , and for all x, x0 ∈ Pi ,
S(x) = S(x0 ) and Wx = Wx0 , where, as before, Wx is the function y 7→ W (x, y).
Remark 3.6. Given a signed step graphex W = (W, S, I, Ω) over a finite subspace partition P = (P1 , P2 , . . . , Pm ), we can define another signed graphex W0 =
(W 0 , S 0 , I 0 , Ω0 ) with Ω0 = (Ω0 , F 0 , µ0 ), where Ω0 = [m], F 0 consists of all subsets,
and the measure is defined by µ0 ({i}) = µ(Pi ). Setting I 0 = I, S 0 (i) = S(x) for any
x ∈ Pi (they are all equal), and W 0 (i, j) = W (x, y) for x ∈ Pi , y ∈ Pj (again the
choice of x and y does not matter), we obtain that W = (W0 )ϕ where ϕ : Ω → Ω0
is the map with ϕ(x) = i for x ∈ Pi . In particular, by Remark 2.16, the distance
between W and W0 is zero (for any of the distance notions). Suppose now that
W00 = (W 00 , S 00 , I 00 , Ω00 ) with Ω00 = (Ω00 , F 00 , µ00 ) is another signed step graphex over
a finite subspace partition Q = {Q1 , Q2 , . . . , Qm }, with I 00 = I, µ00 (Qi ) = µ(Pi ),
and S 00 (x00 ) = S(x), W 00 (x00 , y 00 ) = W (x, y) for x ∈ Pi , x00 ∈ Qi , y ∈ Pj , y 00 ∈ Qj .
Then Ω00 can also be mapped to Ω0 so that W00 is the pullback of W0 (by mapping
Qi to i). This implies that the distance of both W and W00 from W0 is 0, which (by
the still to be proven triangle inequality) implies that their distance from each other
is 0 (again for any of the notions of distance).
Returning to the proof of the triangle inequality, we will in fact consider signed
graphexes that are countable step graphexes, i.e., the number of “steps” is countable,
and each step has finite measure. First, however, we need the following technical
lemma:

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

25

Lemma 3.7. Let W1 = (W1 , S1 , I1 , Ω) and W2 = (W2 , S2 , I2 , Ω) be signed graphexes
in L1 ∩ L2 . Assume that both are countable step graphexes on Ω = (Ω, F, µ) with
common refinement P = {P1 , P2 , . . . , Pm , . . . }, suppose µ0 is another measure on Ω
with µ(Pi ) = µ0 (Pi ), and let Ω0 = (Ω, F, µ0 ) and W0i = (Wi , Si , Ii , Ω0 ). Then
∆2→2 (W1 , W2 ) = ∆2→2 (W01 , W02 )

and

∆ (W1 , W2 ) = ∆ (W01 , W02 ).

Proof. Let ΩP = (ΩP , FP , µP ) where ΩP = {x1 , x2 , . . . , xm , . . . }, FP is the set of
all subsets of ΩP , and µP (xi ) = µ(Pi ). Let ϕ, ϕ0 : Ω → ΩP with ϕ(x) = ϕ0 (x) = xi
for x ∈ Pi . Then ϕ : Ω → ΩP and ϕ0 : Ω0 → ΩP are both measure preserving (these
are the same function on Ω but as maps between measure spaces are different).
Define Wi,P = (Wi,P , Si,P , Ii ) with Si,P (xj ) = Si (x) for any x ∈ Pj (they are all
equal), and Wi,P (xj , xk ) = W (x, y) for x ∈ Pj , y ∈ Pk (again, they are all equal).
ϕ0
0
Then Wϕ
i,P = Wi and Wi,P = Wi . Therefore, by Lemma 3.5, we have
∆2→2 (W1 , W2 ) = ∆2→2 (W1,P , W2,P ) = ∆2→2 (W01 , W02 ),
and similarly for ∆ .



To state the next lemma, we use the symbol πij,k to denote the coordinate
projection from a product space Ωi × Ωj to Ωk , where k = i or k = j.
Lemma 3.8. Let Wi = (Wi , Si , Ii , Ωi ), for i = 1, 2, 3, be countable step graphexes
in L1 ∩ L2 . Let µ12 be a coupling measure on Ω1 × Ω2 , and µ23 be a coupling measure
on Ω2 × Ω3 . Then there exists a coupling measure µ13 on Ω1 and Ω3 such that
π

∆2→2 (W1 13,1
≤

,µ13

π

, W3 13,3

,µ13

)

π
,µ
π
,µ
∆2→2 (W1 12,1 12 , W3 12,2 12 )

π

,µ23

,µ23

, W3 23,3

+ ∆2→2 (W1 23,2

π

,µ23

,µ23

),

, W3 23,3

)

and
π

∆ (W1 13,1
≤

,µ13

π

, W3 13,3

,µ13

)

π
,µ
π
,µ
∆ (W1 12,1 12 , W3 12,2 12 )

π

+ ∆ (W1 23,2

π

where the inequalities hold coordinate-wise.
Proof. Let the steps of W1 be A1 , A2 , . . . , the steps of W2 be B1 , B2 , . . . , and the
steps of W3 be C1 , C2 , . . . . Without loss of generality, we may assume that each
µ1 (Ap ) > 0, each µ2 (Bq ) > 0, and each µ3 (Cr ) > 0. First, take the measure µ123
on Ω1 × Ω2 × Ω3 where
X µ12 (Ap × Bq )µ23 (Bq × Cr )
µ123 (E) =
(µ1 × µ2 × µ3 ) (E ∩ Ap × Bq × Cr ).
µ1 (Ap )µ2 (Bq )2 µ3 (Cr )
p,q,r
Then
µ123 (Ap0 × Bq0 × Ω3 ) =

X µ12 (Ap × Bq )µ23 (Bq × Cr )
µ1 (Ap )µ2 (Bq )2 µ3 (Cr )
p,q,r

· (µ1 × µ2 × µ3 ) (Ap0 × Bq0 × Ω3 ∩ Ap × Bq × Cr )
X
µ23 (Bq0 × Cr )
= µ12 (Ap0 × Bq0 )
µ1 (Ap0 )µ2 (Bq0 )µ3 (Cr )
2
µ
(A
1
p0 )µ2 (Bq0 ) µ3 (Cr )
r
X µ23 (Bq × Cr )
0
= µ12 (Ap0 × Bq0 )
= µ12 (Ap0 × Bq0 ).
µ
(B
2
q0 )
r

26

BORGS, CHAYES, COHN, AND LOVÁSZ

In other words, if π123,12 is the projection from Ω1 × Ω2 × Ω3 to Ω1 × Ω2 and
π123,12
π123,23
µ012 = µ123
, then µ120 (Ap × Bq ) = µ12 (Ap × Bq ). Analogously, if µ023 = µ123
,
then µ230 (Ap × Bq ) = µ23 (Ap × Bq ). Furthermore, for any F ⊆ Ω1 ,
µ123 (F × Ω2 × Ω3 )
X µ12 (Ap × Bq )µ23 (Bq × Cr )
=
(µ1 × µ2 × µ3 ) (F × Ω2 × Ω3 ∩ Ap × Bq × Cr )
µ1 (Ap )µ2 (Bq )2 µ3 (Cr )
p,q,r
=

X µ12 (Ap × Bq )µ23 (Bq × Cr )
µ1 (F ∩ Ap )µ2 (Bq )µ3 (Cr )
µ1 (Ap )µ2 (Bq )2 µ3 (Cr )
p,q,r

=

X µ12 (Ap × Bq )µ23 (Bq × Cr )
X µ12 (Ap × Bq )
µ1 (F ∩ Ap ) =
µ1 (F ∩ Ap )
µ1 (Ap )µ2 (Bq )
µ1 (Ap )
p,q,r
p,q

=

X µ12 (Ap × Ω2 )
µ1 (Ap )

p

µ1 (F ∩ Ap ) =

X

µ1 (F ∩ Ap ) = µ1 (F ).

p
π

123,13
Analogously, for any G ⊆ Ω3 , µ123 (Ω1 × Ω2 × G) = µ3 (G). Therefore, µ13 = µ123
is a coupling measure on Ω1 × Ω3 of µ1 and µ3 . By Lemma 3.5 and the triangle
inequality for the coordinates of ∆2→2 , we then have

π

∆2→2 (W1 13,1
=
≤
=
=

,µ13

π

, W3 13,3

,µ13

)

π
,µ
π
,µ
∆2→2 (W1 123,1 123 , W3 123,3 123 )
π
,µ
π
,µ
∆2→2 (W1 123,1 123 , W2 123,2 123 )
π
,µ0
π
,µ0
∆2→2 (W1 12,1 12 , W2 12,2 12 )
π
,µ
π
,µ
∆2→2 (W1 12,1 12 , W2 12,2 12 )

+
+

π

+ ∆2→2 (W2 123,2

,µ123

π

, W3 123,3

,µ123

)

π
,µ0
π
,µ0
∆2→2 (W2 23,2 23 , W3 23,3 23 )
π
,µ
π
,µ
∆2→2 (W2 23,2 23 , W3 23,3 23 ).

The proof for ∆ is the same.



We are now ready to prove that δe2→2 and the distance δe (obtained by replacing
d2→2 in (2.3) with d ) obey the triangle inequality.
Lemma 3.9. Suppose that Wi = (Wi , Si , Ii , Ωi ) with Ωi = (Ωi , Fi , µi ), for i =
1, 2, 3, are signed graphexes in L1 ∩ L2 , and assume that µ1 (Ω1 ) = µ2 (Ω2 ) = µ3 (Ω3 ).
Then
δe2→2 (W1 , W3 ) ≤ δe2→2 (W1 , W2 ) + δe2→2 (W2 , W3 )
and
δe (W1 , W3 ) ≤ δe (W1 , W2 ) + δe (W2 , W3 ).
Proof. We first claim that it is enough to prove that for any coupling measure µ12
on Ω1 × Ω2 , any coupling measure µ23 on Ω2 × Ω3 and any ε > 0, there exists a
coupling measure µ13 on Ω1 × Ω3 , such that
(3.4)

π

∆2→2 (W1 13,1
≤

,µ13

π

, W3 13,3

,µ13

)

π
,µ
π
,µ
∆2→2 (W1 12,1 12 , W2 12,2 12 )

π

+ ∆2→2 (W2 23,2

,µ23

π

, W3 23,3

,µ23

) + (ε, ε, ε)

and
(3.5)

π

∆ (W1 13,1
≤

,µ13

π

, W3 13,3

,µ13

)

π
,µ
π
,µ
∆ (W1 12,1 12 , W2 12,2 12 )

π

+ ∆ (W2 23,2

,µ23

π

, W3 23,3

,µ23

) + (ε, ε, ε).

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

27

Indeed, given that ε > 0 is arbitrary, (3.5) clearly implies the triangle inequality
for δe . To see that (3.4) implies the triangle inequality for δe2→2 , observe that
(x + y)1/k ≤ x1/k + y 1/k whenever k ≥ 1.
Next, we claim that for any ε > 0, any W = (W, S, I, Ω) in L1 ∩ L2 can be
approximated by a signed step graphex W0 such that
∆ (W, W0 ) ≤ ∆2→2 (W, W0 ) ≤ (ε, ε, ε).
Indeed,
S let Ω = (Ω, F, µ), let Ω1 ⊆ Ω2 ⊆ · · · ⊆ Ω be such that µ(Ωn ) < ∞ and
Ω = n Ωn , and let Wn = (Wn , Sn , I, Ω), where Wn = W 1Ωn ×Ωn and Sn = S1Ωn .
Using the dominated convergence theorem and the assumption that W is in L1 ∩ L2 ,
we then have that
|ρ(W) − ρ(Wn )| ≤ kW − Wn k1 = k |W |(1 − 1Ωn ×Ωn )k1 → 0,
kW − Wn k2→2 ≤ kW − Wn k2 = k W (1 − 1Ωn ×Ωn )k2 → 0,
and
kS − Sn k2 = k S(1 − 1Ωn )k2 → 0
as n → ∞. Next, defining χn by χn (x, y, z) = (1 − 1Ωn ×Ωn (x, y))(1 − 1Ωn ×Ωn (y, z)),
we bound
sZ
kDW − DWn k2

≤

|W (x, y)||W (y, z)|χn (x, y, z) dµ(x) dµ(y) dµ(z).

Since χn goes to zero pointwise and D|W | is in L2 , the right side again goes to zero
by the dominated convergence theorem. Therefore,
kDW − DWn k2 ≤ kDW − DWn k2 + kS − Sn k2 → 0.
This shows that for n large enough ∆2→2 (W, Wn ) ≤ ε/4.
Fixing n such that this holds, we now define W (k) = Wn 1|Wn |≤k and S (k) =
Sn 1|Sn |≤k . Another application of the dominated convergence theorem then shows
that for k large enough, ∆2→2 (W(k) , Wn ) ≤ ε/4, giving us a graphon W00 =
(W 00 , S 00 , I, Ω) such that the degree support of W00 has finite measure, both W 00
and DW00 are bounded, and ∆2→2 (W00 , W) ≤ ε/2. But such a graphex can be
approximated to arbitrary precision by a step graphex with finitely many steps,
proving the claim for ∆2→2 . Since on two variable functions, k · k is bounded by
k · k2→2 , and on functions of one variable it is bounded by k · k2 , the claim for ∆
follows as well.
Fix ε > 0, and let W01 , W02 , W03 be approximations of W1 , W2 , W3 by signed step
graphexes such that for k = 1, 2, 3,
∆2→2 (Wk , W0k ) ≤ (ε/6, ε/6, ε/6).
If µij is a coupling measure on Ωi × Ωj and πij,k is the projection onto Ωk , k = i or
j, then πij,k is measure preserving. Therefore, by Lemma 3.5,


∆2→2 (Wk )πij,k ,µij , (W0k )πij,k ,µij ≤ (ε/6, ε/6, ε/6).

28

BORGS, CHAYES, COHN, AND LOVÁSZ

Combined with Lemma 3.8, we conclude that there exists a coupling measure µ13
on Ω1 × Ω3 such that


π
,µ
π
,µ
∆2→2 (W1 13,1 13 , W3 13,3 13 ) ≤ ∆2→2 (W01 )π13,1 ,µ13 , (W03 )π13,3 ,µ13 + (ε/3, ε/3, ε/3)




≤ ∆2→2 (W01 )π12,1 ,µ12 , (W02 )π12,2 ,µ12 + ∆2→2 (W02 )π23,2 ,µ23 , (W03 )π23,3 ,µ23
+ (ε/3, ε/3, ε/3)
π

≤ ∆2→2 (W1 12,1

,µ12

π

, W2 12,2

,µ12

π

) + ∆2→2 (W2 23,2

,µ23

π

, W3 23,3

,µ23

) + (ε, ε, ε)

proving (3.4) and hence the first statement of the lemma. The proof of (3.5) and
the second statement follows in the same way.

The proof of Theorems 2.11 and 3.1 will be an easy corollary of Lemma 3.9 and
the following extension lemma.
Lemma 3.10. Let W = (W, S, I, Ω) be a signed graphex in L1 ∩ L2 , with possibly
unbounded graphon parts, and let Ω = (Ω, F, µ).
(1) If W0 and W00 are trivial extensions of W by σ-finite spaces of infinite
measure, then
δe (W0 , W00 ) = δe2→2 (W0 , W00 ) = 0.
e is obtained from W by appending an
f , S,
e I, Ω)
W = (W
(2) If µ(Ω) = ∞ and f
arbitrary σ-finite space of infinite measure, then
δe2→2 (W, f
W) = δe (W, f
W) = 0.
Proof. To prove the first statement, let Ω0 = (Ω0 , F 0 , µ0 ) and Ω00 = (Ω00 , F 00 , µ00 ) be
the spaces Ω has been extended by. Let µ
b be the measure on Ω × Ω which couples
µ to itself along the diagonal, choose an arbitrary coupling µ
e of µ0 and µ00 , and let
µ
b0 be the measure on (Ω ∪ Ω0 ) × (Ω ∪ Ω00 ) defined by
µ
b0 (A) = µ
b(A ∩ (Ω × Ω)) + µ
e(A ∩ (Ω0 × Ω00 )).
Using the fact that µ
b0 (Ω × Ω00 ) = µ
b0 (Ω0 × Ω) = 0, it is easy to see that
0
0
δe2→2 (W0 , W00 ) ≤ d2→2 ((W0 )π1 ,bµ , (W00 )π2 ,bµ ) = d2→2 (Wπ1 ,bµ , Wπ2 ,bµ ) = 0.

This proves the first statement for the metric δe2→2 . The proof for the metric δe is
identical.
e = (Ω,
e F,
e µ
To prove, the second statement, let Ω
e). Since Ω is σ-finite,
we can
S
find a sequence of measurable subsets Ωn ⊆ Ω such that Ω = Ωn and each
Ωn has finite measure. Replacing Ωn by Ω1 ∪ · · · ∪ Ωn , we may further assume
that Ωn is an increasing sequence of sets. Let Wn be equal to W on Ωn × Ωn
and 0 everywhere else, and let Sn = S on Ωn and 0 outside of Ωn . Let Wn be
the corresponding graphex on Ω (with the same value I), and f
Wn be its trivial
e
extension to Ω. By monotone convergence, Wn → W in both L1 and L2 , and
Sn → S in L1 and L2 , implying that δe2→2 (Wn , W) ≤ d2→2 (Wn , W) → 0. For the
same reason, δe2→2 (f
Wn , f
W) → 0. But since f
Wn and Wn can both be obtained from
the restriction of Wn to Ωn by appending a space of infinite total measure, we have
δe2→2 (Wn , f
Wn ) = δe2→2 (Wn , Wn ) = 0 by the first statement of the lemma. Using
the triangle inequality for δe2→2 , this proves the second statement for the distance
δe2→2 . The proof for the metric δe follows from the fact that the jumble norm is

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

29

bounded by the kernel norm, which in turn implies that d (Wn , W) → 0 whenever
d2→2 (Wn , W) → 0.

We are now ready to prove Theorems 2.11 and 3.1.
Proof of Theorems 2.11 and 3.1. The first statement of Lemma 3.10 implies that if
W01 and W02 are trivial extensions of W1 and W2 obtained by appending two σ-finite
spaces of infinite measure, then δe2→2 (W01 , W02 ) and δe (W01 , W02 ) do not depend on
the choice of these extensions, and the second (combined with the triangle inequality)
allows us to conclude that this remains true for extensions to spaces of infinite
measure, which completes the proof of the first statements of the two theorems.
Since clearly δ2→2 is symmetric and δ2→2 (W, W) = 0 for all integrable graphexes,
all that remains to be proved is the triangle inequality for δ2→2 , which follows from
the (already established) triangle inequality for δe2→2 . The same holds for δe . 
The following example shows that the extension to infinite spaces in the definition
of δ2→2 is really needed.
Example 3.11. Let W1 = (W1 , 0, 0, Ω1 ) where Ω1 consists of just two atoms a
and b, with weight p and 1 − p, where 0 < p < 1/2, and W1 (a, a) = W1 (b, b) = 0,
W1 (a, b) = W1 (b, a) = 1. Furthermore, let W2 = (W2 , 0, 0, Ω2 ) where
Ω2 consists
p
of just one atom c with weight 1, and W2 is the constant a = p(1 − p). Then
π1
π2
we have just one choice of coupling.
will have two
p For this coupling, W1 − W2 p
atoms, and it will be equal to − p(1 − p) on the diagonal, and 1 − p(1 − p) off
the diagonal. It is then not difficult to see that kW1 − W2 k2→2 is equal to the largest
eigenvalue (in absolute value) of the matrix


−pa
(1 − p)(1 − a)
.
p(1 − a)
−(1 − p)a
The trace of this matrix is −a, and the determinant is
p(1 − p)a2 − p(1 − p)(1 − a)2 = p(1 − p)(2a − 1) < 0.
p
Here we used that a = p(1 − p) < 1/2. We then have that the two eigenvalues of
the matrix have opposite signs, and their sum is −a, which implies that the negative
one must be less than −a; i.e., it must have larger absolute value than a.
On the other hand, clearly kW1 k2→2 = a, and kW2 k2→2 is equal to the largest
eigenvalue (in absolute value) of the matrix


0 1−p
,
p
0
p
which can easily be seen to be equal to p(1 − p) = a.
Therefore, if we extend W1 and W2 by spaces of total measure at least 1, and
couple each Ωi to the extension, then
f1 − W
f2 k2→2 = max{kW
f1 k2→2 , kW
f2 k2→2 } = a.
kW
Therefore, by extending, we can obtain a better coupling.
Finally, note that in (2.1), if we multiply the measure of the underlying space
by c, then the first term is multiplied by c, the second by c3/4 , and the third by
c2/3 . We can therefore take c large enough so that the maximum in the term is
dominated by kW1 − W2 k2→2 . Therefore, we obtain that also for minimizing d2→2 ,
we obtain a better coupling if we extend by trivial extensions than if we do not.

30

BORGS, CHAYES, COHN, AND LOVÁSZ

Next, we would like to prove Theorem 2.15. Before doing so, we note that
the distance δ is well defined and finite for signed graphexes as well, provided
the graphon part is bounded in the L∞ norm. As the reader may easily verify,
this immediately follows from the following lemma, which is an easy corollary to
Proposition 2.4.
Lemma 3.12. Let W be a signed graphex with bounded graphon part, and let
0 < D < ∞. Then the set {D|W| > D} has finite measure, and W|{D|W| ≤D} is
integrable and hence in L1 ∩ L2 .
Proof. Let W = (W, S, I, Ω) with Ω = (Ω, F, µ), and assume that kW k∞ ≤ K. If
K ≤ 1, the lemma follows from Proposition 2.4 applied to W0 = |W|. Otherwise, we
define W0 = (W 0 , S 0 , I 0 , Ω) where W 0 = |W |/K, S 0 = |S|, and I 0 = |I|. Applying
1
D|W| ≤ DW0 ≤ D|W| , we see that
Proposition 2.4 to this graphex, and noting that K
µ({D|W| > D}) ≤ µ({D|W0 | > D/K}) < ∞ and kW|D|W| ≤D k1 ≤ kW|DW0 ≤D k1 ≤
KkW0|D 0 ≤D k1 < ∞, as claimed.

W

To prove Theorem 2.15, we need to establish the triangle inequality. The reason
it is not obvious is because when we decrease the measure on the underlying set,
the δ2→2 distance can increase. In the following lemma, we show that although it
can increase under restrictions to subsets or decreasing of the underlying measure,
it cannot increase too much.
Lemma 3.13. Let W1 = (W1 , S1 , I1 , Ω) and W2 = (W2 , S2 , I2 , Ω) be signed
graphexes in L1 ∩ L2 , let Ω = (Ω, F, µ), and let
(1) kW1 − W2 k2→2,µ = a,
(2) kDW1 − DW2 k2,µ = b, and
(3) |ρ(W1 ) − ρ(W2 )| = c.
If W01 = (W1 , S1 , I1 , Ω0 ) and W02 = (W2 , S2 , I2 , Ω0 ) where Ω0 = (Ω, F, µ0 ) for some
measure µ0 such that µ − r ≤ µ0 ≤ µ for some r < ∞, then
(1) kW1 − W2 k2→2,µ0 ≤ a, √
0
0
0
(2) kD
r, and
 W1 − DW2 k2,µ ≤ b+ a √


0
0
(3) |ρ(W1 ) − ρ(W2 )| − c ≤ 2b r + ar.
We recall that µ − r ≤ µ0 ≤ µR if and only if there exists a measurable function
h : Ω → [0, 1] such that µ0 (B) = B h dµ for all measurable sets B, and k1 − hk1,µ ≤
r < ∞. An interesting special case is the case where h is the characteristic function
of Ω \ R for a set R of measure r, in which case W0i is the restriction of W to Ω \ R,
after neglecting points outside the degree support.
Proof. To show property (1), let f, g be such that kf k2,µ0 = kgk2,µ0 = 1. In other
words,
Z
Z
1=
f 2 dµ0 =
hf 2 dµ,
Ω

Ω

and
Z
1=

2

0

Z

g dµ =
Ω

Ω

hg 2 dµ.

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

31

Let U = W1 − W2 . We then have

Z




Ω×Ω

 Z
 
f (x)U (x, y)g(y) d(µ × µ ) = 
0

0

Ω×Ω



f (x)U (x, y)g(y)h(x)h(y) d(µ × µ)

≤ kU k2→2,µ kf hk2,µ kghk2,µ .

We also have

kf hk22,µ =

Z

f (x)2 h(x)2 dµ(x) ≤

Ω

Z

f (x)2 h(x) dµ(x) = 1.

Ω

Similarly, kghk2,µ ≤ 1. Therefore,

Z




Ω×Ω



f (x)U (x, y)g(y) d(µ0 × µ0 ) ≤ a.

Since this holds for any f, g such that kf k2,µ0 = kgk2,µ0 = 1, we have kU k2→2,µ0 ≤
kU k2→2,µ = a.
For (2), let

Z
Di (x) = DWi (x) − D

W0i

Wi (x, y)(1 − h(y)) dµ(y).

(x) =
Ω

Then

kDW01 − DW02 k2,µ0 ≤ kDW01 − DW02 k2,µ
Z
= sup
(DW01 − DW02 )(x)g(x) dµ(x)
g:kgk2,µ =1

Ω

Z
=

((DW1 − DW2 )(x)g(x) − (D1 − D2 )(x)g(x)) dµ(x)

sup
g:kgk2,µ =1

Ω

Z
=

(DW1 − DW2 )(x)g(x) dµ(x)

sup
g:kgk2,µ =1

Ω

!

Z
−

g(x)(W1 − W2 )(x, y)(1 − h(y)) d(µ × µ)
Ω×Ω

√
≤ b + akgk2,µ k1 − hk2,µ ≤ b + a r.

32

BORGS, CHAYES, COHN, AND LOVÁSZ

To prove (3), we use that
Z
Z
0
ρ(Wi ) =
h(x)Wi (x, y)h(y) dµ(x) dµ(y) + 2
Si (x)h(x) dµ(x) + Ii
Ω×Ω
Ω
Z
= ρ(Wi ) −
(1 − h(x))Wi (x, y) dµ(x) dµ(y)
Ω×Ω
Z
−
Wi (x, y)(1 − h(y)) dµ(x) dµ(y)
Ω×Ω
Z
+
(1 − h(x))Wi (x, y)(1 − h(y)) dµ(x) dµ(y)
Ω×Ω
Z
− 2 (1 − h(x))S(x) dµ(x)
Ω
Z
= ρ(Wi ) − 2 (1 − h(x))DWi (x) dµ(x)
Ω
Z
+
(1 − h(x))Wi (x, y)(1 − h(y)) dµ(x) dµ(y).
Ω×Ω

Therefore,


 

 ρ(W01 )−ρ(W02 ) − ρ(W1 ) − ρ(W2 )
 Z

≤ 2 (1 − h(x))(DW1 − DW2 )(x) dµ(x)
Ω

Z

−
(1 − h(x))(W1 − W2 )(x, y)(1 − h(y)) dµ(x) dµ(y)
Ω×Ω
√
≤ 2b r + ar.
p
√
Here we used the fact that k1 − hk2 ≤ k1 − hk1 ≤ r. This implies the claim. 
We also use the following equivalent representation of the weak kernel distance
δ .
Lemma 3.14. For i = 1, 2, let Wi be graphexes over Ωi = (Ωi , Fi , µi ), and let
W0i be trivial extensions of Wi to σ-finite measure spaces Ω0i = (Ω0i , Fi0 , µ0i ) with
µ0i (Ω0i ) = ∞. Then δ (W1 , W2 ) = δe (W01 , W02 ), where δe (W01 , W02 ) is defined as the
infimum over all c such that there exists a measure µ0 over Ω01 × Ω02 obeying the
conditions
(1) µ0i − c2 ≤ (µ0 )πi ≤ µ0i for i = 1, 2, and
0
0
(2) d2→2 ((W01 )π1 ,µ , (W02 )π2 ,µ ) ≤ c.
Proof. Let µ0 and c be such that they obey the conditions in the statement of
the lemma. For i = 1, 2, let µ
ei be the restriction of (µ0 )πi to Ωi , and let f
Wi be
obtained from Wi by replacing µi by µ
ei . Then µi − c2 ≤ µ
ei ≤ µi . Furthermore,
(µ0 )πi extends µ
ei to Ω0i , and (µ0 )πi (Ω0i \ Ωi ) ≥ µ0i (Ω0i \ Ωi ) − c2 = ∞, showing that
this defines an extension by a space of infinite measure. Finally, µ0 is a coupling of
(µ0 )π1 and (µ0 )π2 . Together, these facts imply that δ2→2 (f
W1 , f
W2 ) ≤ c, proving that
0
0
e
δ (W1 , W2 ) ≤ c. This shows that δ (W1 , W2 ) ≤ δ (W1 , W2 ).
To prove the reverse inequality, assume that c is such that there are measures
W1 , f
W2 ) ≤ c and µi − c2 ≤ µ
µ
e1 and µ
e2 over Ω1 and Ω2 such that δ2→2 (f
ei ≤ µi for

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

33

Wi is again obtained from Wi by replacing µi by µ
i = 1, 2, where f
ei . If we transform
0
0
0
f0
e 0 by setting µ
Ω0i into a space Ω
e
to
µ
e
on
Ω
,
and
to
µ
on
Ω
\
Ω
i
i
i
i
i
i
i , and define Wi as
e 0 , then Theorem 2.11 implies that δe2→2 (f
the trivial extension of f
Wi to Ω
W01 , f
W02 ) =
i
0
f
f
δ2→2 (W1 , W2 ) ≤ c. This means that for all ε > 0, there is a coupling µ of µ
e01
0
0 π1 ,µ0
0 π2 ,µ0
and µ
e2 such that d2→2 ((W1 )
) ≤ c + ε. Observing that the bound
, (W2 )
µi − c2 ≤ µ
ei ≤ µi and our construction of µ
e0i imply that µ0i − c2 ≤ µ
e0i = (µ0 )πi ≤ µ0i ,
0
0
and that (f
W0i )πi ,eµ = (W0i )πi ,eµ , this shows that δe (W01 , W02 ) ≤ c + ε. Since ε was
arbitrary, this shows that δ (W1 , W2 ) ≥ δe (W01 , W02 ).

We are now ready to prove Theorem 2.15.
Proof of Theorem 2.15. It is clear that δ is symmetric, and that δ (W, W) = 0. So
we have to prove the triangle inequality. By Lemma 3.14, taking trivial extensions of
each graphex to a space of infinite measure, it suffices to prove the triangle inequality
for δe .
Let W1 , W2 , W3 be three graphexes with the usual notation, defined over measure
spaces which all have infinite measure. Let µ12 be a measure on Ω1 × Ω2 that
shows that δe (W1 , W2 ) ≤ c1 , let µ23 be a measure on Ω2 × Ω3 that shows that
δe (W1 , W2 ) ≤ c2 , let µ01 and µ02 be the marginals of µ12 , and let µ002 and µ003 be the
marginals of µ23 . We would like to use Lemma 3.9 to create a coupling of µ01 and
µ003 , but unfortunately, the conditions of the lemma require that µ02 = µ002 , which we
cannot guarantee. To deal with this problem, we will slightly decrease µ12 and µ23
so that after this perturbation, the second marginal of the first is equal to the first
marginal of the second.
Let πij,i be the projection map from Ωi × Ωj to Ωi for i, j ∈ [3], and let Wij,i =
πij,i ,µij
dµ0
dµ00
Wi
. Let µ02 = µ12 π12,2 and µ002 = µ23 π23,2 . Let h0 = dµ22 and h00 = dµ22 . Then
we can assume that 0 ≤ h0 , h00 ≤ 1, k1 − h0 k1,µ2 ≤ c21 , and k1 − h00 k1,µ2 ≤ c22 . Let
e
h(x) = min(h0 (x), h00 (x)), and let µ
e2 be the measure defined by
Z
e
µ
e2 (A) =
h dµ2 .
A

Then kh0 − e
hk1,µ2 ≤ k1 − h00 k1,µ2 ≤ c22 . For x ∈ Ω1 × Ω2 , let h12 (x) =
and let µ
e12 be the measure defined by
Z
µ
e12 (A) =
h12 (x) dµ12 .

e
h(π12,2 (x))
h0 (π12,2 (x))

≤ 1,

A

π

Note that µ
e1212,2 = µ
e2 . Furthermore, since h̃(x) ≤ h0 (x),
!
Z
Z
e

h(x)
dµ02 (x)
1 − h12 (x) dµ12 (x) =
1− 0
h (x)
Ω1 ×Ω2
Ω2
!
Z
e
h(x)
=
1− 0
h0 (x) dµ2 (x) = kh0 − e
hk1,µ2 ≤ c22 .
h
(x)
Ω2
This means that for any set A ⊆ Ω1 × Ω2 ,
µ12 (A) − c22 ≤ µ
e12 (A) ≤ µ12 (A).
This implies that for any A ⊆ Ω1 ,
π

π

π

µ1 (A) − c21 − c22 ≤ µ1212,1 (A) − c22 ≤ µ
e1212,1 (A) ≤ µ1212,1 (A) ≤ µ1 (A).

34

BORGS, CHAYES, COHN, AND LOVÁSZ
π

We similarly construct µ
e23 and Ω2 × Ω3 so that µ
e2323,2 = µ
e2 and for any set
A ⊆ Ω2 × Ω3 ,
µ23 (A) − c21 ≤ µ
e23 (A) ≤ µ23 (A),
which implies that for any A ⊆ Ω3 ,
π

π

π

µ3 (A) − c21 − c22 ≤ µ2323,3 (A) − c21 ≤ µ
e2323,3 (A) ≤ µ2323,3 (A) ≤ µ3 (A).
π

π

Let µ
e1 = µ
e1212,1 and µ
e3 = µ
e2323,3 , and note that µ
e12 is a coupling of µ
e1 and µ
e2 , µ
e23
is a coupling of µ
e2 and µ
e3 , and µ1 − c21 − c22 ≤ µ
e1 ≤ µ1 and µ3 − c21 − c22 ≤ µ
e3 ≤ µ3 .
Let f
Wi be equal to Wi but with the measure µi replaced by µ
ei . Fix ε > 0.
π
By Lemma 3.9, there exists a measure µ
e13 on Ω1 × Ω3 such that µ
e1313,1 = µ
e1 and
π13,3
µ
e13 = µ
e3 , and we have
π
π
π
π
π
π
∆2→2 (f
W1 13,1 , f
W3 13,3 ) ≤ ∆2→2 (f
W1 12,1 , f
W2 12,2 ) + ∆2→2 (f
W2 23,2 , f
W3 23,3 ) + (ε, ε, ε).

Note that by the above inequalities,
π

µ1 − (c1 + c2 )2 ≤ µ1 − c21 − c22 ≤ µ
e1 = µ
e1313,1 ≤ µ1
and
π

µ3 − (c1 + c2 )2 ≤ µ3 − c21 − c22 ≤ µ
e3 = µ
e1313,3 ≤ µ3 .
By Lemma 3.13,
f π12,1 − W
f π12,2 k2→2,eµ ≤ kW12,1 − W12,2 k2→2,µ ≤ c1 ,
kW
1

2

12

12

kDW
µ12 ≤ kDW12,1 − DW12,2 k2,µ12 + kW12,1 − W12,2 k2→2,µ12 c2
e π12,2 k2,e
e π12,1 − DW
1

2

≤ c21 + c1 c2 ,
and finally


 fπ12,1

π
W2 12,2 ) ≤ |ρ(W12,1 ) − ρ(W12,2 )| + 2kDW12,1 − DW12,2 k2,µ12 c2
ρ(W1 ) − ρ(f
+ kW12,1 − W12,2 k2→2,µ12 c22
≤ c31 + 2c21 c2 + c1 c22 .
To summarize, this means that
π
fπ12,1 , f
∆2→2 (W
W 12,2 ) ≤ (c1 , c2 + c1 c2 , c3 + 2c2 c2 + c1 c2 ).
1

1

2

1

1

2

Similarly,
π
π
∆2→2 (f
W2 23,2 , f
W3 23,3 ) ≤ (c2 , c22 + c1 c2 , c32 + 2c1 c22 + c21 c2 ).

Therefore,
π

π

f 13,1 − W
f 13,3 k2→2,eµ ≤ c1 + c2 + ε,
kW
13
1
3
2
2
2
kDW
e 1 − DW
e 3 k2,e
µ13 ≤ c1 + c1 c2 + c2 + c1 c2 + ε = (c1 + c2 ) + ε,
and finally


 f
f3 ) ≤ c3 + 2c2 c2 + c1 c2 + c3 + 2c1 c2 + c2 c2 + ε = (c1 + c2 )3 + ε.
ρ(W1 ) − ρ(W
1
1
2
2
2
1

Since this can be done for any ε > 0, this completes the proof that δe is a metric.
With the help of Lemma 3.14 the triangle inequality for δe implies that for δ . 
Next we prove Proposition 2.17, as well the following version for signed graphexes.
Proposition 3.15. Fix B, C, D < ∞. Then δ and δ2→2 define the same topology
on the space of (B, C, D)-bounded signed graphexes.

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

35

To prove these propositions, we need a lemma complementing the bounds from
Lemma 3.13. Recall that in Lemma 3.13, we showed that the distance between two
graphexes defined on the same measure space cannot increase too much when we
decrease of the underlying measure. Our next lemma shows that if the graphexes
involved are signed graphexes that are (B, C, D)-bounded, we can also go in the
other direction.
Lemma 3.16. Let Wi = (Wi , Si , Ii , Ω), for i = 1, 2, be (B, C, D)-bounded signed
graphexes on the same measure space Ω, and let µ0 , r, W01 , and W02 be as in
Lemma 3.13. Then
√
(1) kW
 1 − W2 k2→2,µ0 ≤ kW1 − W2 k2→2,µ ≤ kW1 − W2 k2→2,µ0 + 4 BDr,


(2) kDW1 − DW2 k22,µ − kDW01 − DW02 k22,µ0  ≤ (4D2 + 8BC)r, and


 


(3) ρ(W01 ) − ρ(W02 ) − ρ(W1 ) − ρ(W2 ) ≤ 4Dr.
Proof. Let U = W1 − W2 . Then for any f, g with kf k2,µ = kgk2,µ = 1,
Z
f (x)U (x, y)g(y) dµ(x) dµ(y)
Ω×Ω
Z
=
f (x)h(x)U (x, y)h(y)g(y) dµ(x) dµ(y)
Ω×Ω
Z
+
f (x)((1 − h(x))U (x, y)h(y))g(y) dµ(x) dµ(y)
ZΩ×Ω
+
f (x)U (x, y)(1 − h(y))g(y) dµ(x) dµ(y).
Ω×Ω

We have
Z
Ω×Ω

f (x)h(x)U (x, y)h(y)g(y) dµ(x) dµ(y)
Z
=
f (x)U (x, y)g(y) dµ0 (x) dµ0 (y) ≤ kf k2,µ0 kU k2→2,µ0 kgk2,µ0
Ω×Ω

≤ kf k2,µ kU k2→2,µ0 kgk2,µ ≤ kU k2→2,µ0 .
Furthermore,
Z
f (x)U (x, y)(1 − h(y))g(y) dµ(x) dµ(y)
Ω×Ω
Z
≤ kf k2,µ
kUy k2,µ (1 − h(y))|g(y)| dµ(y)
Ω
Z
√
≤ kf k2,µ 2 BD (1 − h(y))|g(y)| dµ(y)
Ω
√
√
≤ 2 BDkf k2,µ k1 − hk2,µ kgk2,µ ≤ 2 BDr.
Here we used the fact that kU k∞ ≤ 2B and kD|U |,µ k∞ ≤ 2D, which implies that
√
kUy k2,µ ≤ 2 BD. Analogously, we have
Z
f (x)((1 − h(x))U (x, y)h(y))g(y) dµ(x) dµ(y)
Ω×Ω
√
√
≤ 2 BDkf k2,µ k1 − hk2,µ khgk2,µ ≤ 2 BDr.

36

BORGS, CHAYES, COHN, AND LOVÁSZ

Adding this all up, we have
Z
√
f (x)U (x, y)g(y) dµ(x) dµ(y) ≤ kU k2→2,µ0 + 4 BDr.
Ω×Ω

This proves the upper bound in the first claim. The lower bound follows from
Lemma 3.13.
To prove the second claim, we observe that
Z
Z
2
0 ≤ (DW1 (x) − DW2 (x)) dµ(x) − (DW1 (x) − DW2 (x))2 dµ0 (x)
Ω
ZΩ
Z
2
= (DW1 (x) − DW2 (x)) (1 − h(x)) dµ(x) ≤
4D2 (1 − h(x)) dµ(x) ≤ 4D2 r.
Ω

Ω

Furthermore, since kU k∞ ≤ 2B, we have that for any x ∈ Ω,





 DW1 (x) − DW0 (x) − DW2 (x) − DW0 (x) 


1
2
Z



=  (1 − h(y))U (x, y) dµ(y) ≤ 2Br.
Ω

Therefore,
Z

Z


2
0
 (DW (x) − DW (x))2 dµ0 (x) −

0
0
D
(x)
−
D
(x)
dµ
(x)
W1
W2
1
2


Ω
Ω
Z 


= 
(DW1 (x) − DW2 (x)) − DW01 (x) − DW02 (x)
Ω




(DW1 (x) − DW2 (x)) + DW01 (x) − DW02 (x) dµ0 (x)
Z 

 

|DW1 (x)| + |DW2 (x)| + DW01 (x) + DW02 (x) dµ0 (x) ≤ 8BCr.
≤ 2Br
Ω

Combining these two inequalities proves the second claim.
To prove the third claim, we use the following bound, where the first inequality
was already established when proving the last claim of Lemma 3.13:


 

 ρ(W01 )−ρ(W02 ) − ρ(W1 ) − ρ(W2 )
 Z

≤ 2 (1 − h(x))(DW1 − DW2 )(x) dµ(x)
Ω

Z

−
(1 − h(x))(W1 − W2 )(x, y)(1 − h(y)) dµ(x) dµ(y)
 Z Ω×Ω

= 2 (1 − h(x))(S1 − S2 )(x) dµ(x)
Ω

Z

+
(1 − h(x))(W1 − W2 )(x, y)(2 − 1 + h(y)) dµ(x) dµ(y)
Z Ω×Ω
≤ 2 (1 − h(x))(D|W1 | + D|W2 | )(x) ≤ 4Dr.

Ω

Our next lemma is an easy corollary to Lemma 3.16, and in turn immediately
implies Proposition 2.17 and 3.15.

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

37

Lemma 3.17. Suppose Wi = (Wi , Si , Ii , Ωi ), for i = 1, 2, are signed graphexes with
kWi k∞ ≤ B and kD|W| k∞ ≤ D, and let δ (W1 , W2 ) ≤ ε. Then |ρ(W1 ) − ρ(W2 )| ≤
ε3 + 4ε2 D. If, in addition, kW ki ≤ C, then δ2→2 (W1 , W2 ) ≤ f (ε), where



1/2
p
√
1/3
, ε3 + 4ε2 D
f (ε) = max ε + 4ε BD, ε2 + 2ε D2 + 2BC
Proof. We first note that by Lemma 3.12, kWi k1 < ∞, so even without the assumption that kWi k1 ≤ C, we always have that kWi k1 ≤ C for some C < ∞.
Next, let Ωi = (Ωi , Fi , µi ), for i = 1, 2, and let c > ε. By the definition of δ ,
there exist measures µ
ei such that µ
ei ≤ µi and δi = µi (Ωi ) − µ
ei (Ωi ) ≤ c2 and such
that δ2→2 (f
W1 , f
W2 ) < c for the signed graphexes f
Wi obtained from Wi by replacing
µi by µ
ei .
Consider an arbitrary σ-finite space Ω00i of infinite measure, and two intervals Ji
of length c − δi . Define Ω0i by appending Ω00i and the interval Ji equipped with the
e 0 by appending the same spaces, except that we
Lebesgue measure to Ωi , and define Ω
i
equip Ji with the zero measure. By Lemma 3.10 and the definition of δ2→2 , we then
have that δe2→2 (f
W01 , f
W02 ) = δ2→2 (f
W1 , f
W2 ) < c, where f
W0i are the trivial extensions
0
0
0
e . Furthermore, by our construction, Ω = (Ωi , F 0 , µ0 ) and Ω
e 0 = (Ω
e i , Fe0 , µ
to Ω
i
i
i
i
i
i ei )
e i , Fe0 ), µ
are such that (Ω0i , Fi0 ) = (Ω
e0i ≤ µ0i , and µ0i (Ω0i ) − µ
e0i (Ω0i ) = c2 .
i
0
0
0
0
e
Given a coupling µ
e of µ
e1 and µ
e2 , let Ui be the pullback of f
W0i under the
0
coordinate projections onto Ωi . By the definition of the distance δe2→2 , we can find
e0 , U
e 0 ) ≤ c2 . Choose a coupling µ0 of µ0 and µ0 by
a coupling µ
e0 such that d2→2 (U
1
2
1
2
0
0
coupling µi − µ
ei arbitrarily. Then µ0 − c ≤ µ
e0 ≤ µ0 . Defining U0i to be the pullbacks
of W0i under the coordinate projections onto Ω0i , we may then apply Lemma 3.16
with r = c2 to conclude that |ρ(W1 ) − ρ(W2 )| = |ρ(U01 ) − ρ(U02 )| ≤ c3 + 4c2 D and
δ2→2 (W1 , W2 ) ≤ d2→2 (U01 , U02 )



1/2
p
√
1/3
2
3
2
2
≤ max c + 4c BD, c + 2c D + 2BC
, c + 4c D
Since c > ε was arbitrary, this concludes the proof.



Proof of Propositions 2.17 and 3.15. By the definition of δ , we clearly have that
δ ≤ δ2→2 . For signed graphexes that are (B, C, D)-bounded, a bound in the
opposite direction follows immediately from Lemma 3.17, proving Proposition 3.15.
To prove Proposition 2.17 we note that if δ (Wn , W) → 0 and both Wn and W are
(unsigned) graphexes with D-bounded marginals, then kWk1 ≤ C for some C < ∞
by Proposition 2.4. Since kWn k1 = ρ(Wn ) converges to ρ(W) = kW k1 ≤ C by the
e for some C
e < ∞, at
first statement of the lemma, we must have that kWn k1 ≤ C
which point the proof proceeds as the proof for the signed case.

Our next lemma relates the kernel norm k · k2→2 of a two variable function U to
the 4-cycle counts of U .
Lemma 3.18. Let U : Ω × Ω → R be a measurable function. Then
kU k42→2 ≤ t(C4 , U ) ≤ kU k22→2 kU k22 .

38

BORGS, CHAYES, COHN, AND LOVÁSZ

Proof. For any f, g with kf k2 = kgk2 = 1, we have (using Cauchy’s inequality)
kf ◦ U ◦ gk42 ≤ kU ◦ gk42 = (g ◦ U ◦ U ◦ g)2
Z
2
=
g(x)U ◦ U (x, y)g(y) dµ(x) dµ(y)
2
ZΩ
 Z

2
2
2
≤
g(x) g(y) dµ(x) dµ(y)
(U ◦ U (x, y)) dµ(x) dµ(y)
Ω2

Ω2

= t(C4 , U ).
This proves the first inequality. For the second, we have
Z
t(C4 , U ) =
U (x, y)U (y, z)U (z, w)U (w, x) dµ(x) dµ(y) dµ(z) dµ(w)
4
ZΩ Z
Z
=
(U ◦ Uz )(x)2 dµ(x) dµ(z) =
dµ(z)kU ◦ Uz k22
Ω
ZΩ Ω
2
2
2
2
≤
kU k2→2 kUz k2 = kU k2→2 kU k2 .



Ω

Our next goal is to relate the jumble and the kernel distances. The next proposition shows that for (B, C, D)-bounded graphexes, they are equivalent. As we will
see, similarly to the proof of Propositions 2.17 and 3.15, the proof also gives that
for (unsigned) graphexes, the metrics δ2→2 and δ are equivalent on the space of
graphexes with D-bounded marginals; see Remark 3.23 below.
Proposition 3.19. Given B, C, D < ∞, there exists a constant c < ∞ such that if
W1 and W2 are (B, C, D)-bounded signed graphexes, then the following hold.
(1) If d2→2 (W1 , W2 ) ≤ εe, then d (W1 , W2 ) ≤ max{e
ε√, εe3 }.√
(2) If d (W1 , W2 ) ≤ ε, then d2→2 (W1 , W2 ) ≤ max{ 3 ε, c 4 ε}.
If the graphexes are such that ρ(W1 ) = ρ(W
√ 2 ), then these bounds can be replaced by
d (W1 , W2 ) ≤ εe and d2→2 (W1 , W2 ) ≤ c 4 ε.
To prove the proposition, we establish three preliminary lemmas.
Lemma 3.20. Given a bounded, nonnegative, measurable function f on some
measure space (Ω, F, µ), we have
kf k22
p

kf k1 kf k∞

1

Z

≤ sup p
µ(S)
S⊆Ω

f dµ ≤ kf k2 .
S

In particular, the second and third term define equivalent norms, for any C, D, on
the space of nonnegative functions with kf k1 ≤ C, kf k∞ ≤ D.
Proof. The second inequality follows from Cauchy’s inequality. For the first one, let
kf k∞ = K. First, note that
Z

K

Z
dc

0

Z
f dµ =

{f ≥c}

Z
dµ(x)f (x)

Ω

f (x)

Z
dc =

0

Ω

f 2 dµ.

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

39

We then have
kf k42 =

Z

f 2 dµ

2

Z

!2

Z

=

f dµ dc
{f ≥c}

0

Ω

R
!2
f dµ
p
{f ≥c}
dc µ({f ≥ c}) p
µ({f ≥ c})
R
2
Z K
f dµ
{f ≥c}
dc
µ({f ≥ c}) dc.
µ({f ≥ c})
0

K

Z
=
0
K

Z

K

≤
0

Using the fact that
Z

K

Z
µ({f ≥ c}) dc =

f dµ,
Ω

0

we have that
Z

K

R

f dµ
{f ≥c}

2
dc ≥

kf k42
,
kf k1

µ({f ≥ c})
which means that there exists some c such that
R
2
f dµ
{f ≥c}
kf k42
kf k42
≥
=
.
µ({f ≥ c})
kf k1 K
kf k1 kf k∞
0

Taking S to be {f ≥ c}, the lemma is proved.



The following lemma is an easy corollary of Lemma 3.20.
Lemma 3.21. Given a bounded, measurable, not necessarily nonnegative function
f on some measure space (Ω, µ), we have

Z


1
kf k22

p
f dµ ≤ kf k2 .
≤ sup p

2kf k1 kf k∞
µ(S) S
S⊆Ω
Proof. The second inequality again follows from Cauchy’s inequality, so we just
have to prove the first one. Note that the left term is not affected by replacing f
with |f |. Let S be any subset of Ω, let S + consist of the points in S where f is
nonnegative, and let S − be the rest. Then
R
p
R
p
Z
 + f dµ µ(S + )  − f dµ µ(S − )
1
S
S
p
p
p
|f | dµ = p
+ p
µ(S) S
µ(S + )
µ(S)
µ(S − )
µ(S)
!
R
 R
! p
p
 + f dµ  − f dµ
+
µ(S )
µ(S − )
S
S
p
≤ max p
, p
+ p
µ(S + )
µ(S − )
µ(S)
µ(S)
R
 R
!
Z

 + f dµ  − f dµ √
√


1
S
S
 f dµ .
≤ max p
2 ≤ 2 sup p
, p


µ(S + )
µ(S − )
µ(S) S
S⊆Ω
Therefore, we have
Z

Z


1
1
kf k22


√
p
p
f
dµ
≥
sup
|f
|
dµ
≥
.
sup p
 S⊆Ω 2 µ(S)
µ(S)  S
2kf k1 kf k∞
S⊆Ω
S
1

This completes the proof.



40

BORGS, CHAYES, COHN, AND LOVÁSZ

Lemma 3.22. For any measurable U : Ω × Ω → R,
kU k2→2 ≥ kU k ≥

kU k42→2
3/4

3/4

3/2

8kU k∞ kD|U | k∞ kD|U | k2

≥

kU k42→2
3/4

3/2

3/4

8kU k∞ kD|U | k∞ kU k1

.

Proof. Fix f and g with kf k2 = kgk2 = 1 and recall that we use Ux to denote the
function y 7→ U (x, y). First, we have
q
kU ◦ gk∞ ≤ sup kUx k2 ≤ kU k∞ kD|U | k∞ .
x

We also have
Z

Z

Z
Z




kU ◦ gk1 ≤ 2 sup  dx
U (x, y)g(y) dy  = 2 sup  dy g(y) U (x, y) dx
S⊆Ω
S⊆Ω
S
Ω
Ω
S
Z
≤2
|g(y)|D|U | (y) ≤ 2kD|U | k2 .
Ω

Combined with the first bound from Lemma 3.21 and the fact that |f ◦ U ◦ g| ≤
kU ◦ gk2 , this shows that

Z


kU ◦ gk22
1
≥ p

sup p
U
◦
g(x)
dµ(x)

µ(S) 
2kU ◦ gk kU ◦ gk
S⊆Ω
S

∞

≥

(f ◦ U ◦ g)

1

2

1/2
1/4
1/4
2kU k∞ kD|U | k∞ kD|U | k2

.

Analogously, defining gS as the function x 7→ √ 1 1x∈S , and observing that
µ(S)
R

√ 1  S (U ◦ g) dµ = |g ◦ U ◦ gS | ≤ kU ◦ gS k2 , we have
µ(S)


Z


1


sup  p
dµ(x)dµ(y)U (x, y)

µ(T )µ(S) S×T
T ⊆Ω 

Z


1
 (U ◦ gS )(y) dµ(y)
= sup p


µ(T ) T
T ⊆Ω
≥
≥

kU ◦ gS k22
1/4

1/2

1/4

2kU k∞ kD|U | k∞ kD|U | k2
(f ◦ U ◦ g)4
3/4

3/4

3/2

8kU k∞ kD|U | k∞ kD|U | k2

.

Therefore,
kU k ≥

kU k42→2
3/4

3/4

3/2

8kU k∞ kD|U | k∞ kD|U | k2

≥

kU k42→2
3/4

3/2

3/4

8kU k∞ kD|U | k∞ kU k1

,

where in the last step we used that kD|U | k22 ≤ kD|U | k1 kD|U | k∞ = kU k1 kD|U | k∞ .



Proof of Proposition 3.19. The proposition follows immediately from Lemmas 3.21
and 3.22 and
of the distances d2→2 and d , with c being the constant
√
√ the definition
4
c = max{ 8 8CD, 64B 3/4 D3/2 C 3/4 }.

Remark 3.23. The above proof can easily be modified to see that for any 0 < D < ∞
the metrics δ2→2 and δ are equivalent on the space of (unsigned) graphexes with Dbounded marginals. Indeed, if W has bounded marginals, it is integrable, and if either

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

41

δ2→2 (Wn , W) → 0 or δ (Wn , W) → 0, then kWn k1 = ρ(Wn ) → ρ(W) = kWk1 .
This shows that we can assume that the sequences are (C, D)-bounded for some C,
which means they are (B, C, D)-bounded for B = 1.
We close this section with the (straightforward) proof that the homomorphism
densities t(F, W) indeed describe the expected number of injective homomorphisms
from F into GT (W).
Proposition 3.24. For any simple graph F with no isolated vertices and graphex
W,

E [inj(F, GT (W))] = T |V (F )| t(F, W).

If the marginals of W are bounded, then the right side is finite, with

t(F, W) ≤

Y

i )−2
kWk1 kDW kv(F
,
∞

i

where the product runs over the components of F and vi is the number of vertices
in Fi .
Proof. Recall that we extended the feature space Ω to include an additional point
∞, and that we labeled the vertices corresponding to the leaves of a star generated
by S, as well as the two endpoints of the isolated edges coming from I, by ∞. Let
k = |V (F )|. First, suppose that Ω has finite measure. Then the probability that
n
there are n points sampled from Ω is e−µ(Ω)T (T µ(Ω))
. Let V2 be the set of vertices
n!
of F of degree at least 2, let V1 be the set of vertices of degree 1 whose neighbor is
in V2 , and let V0 be the set of vertices that belong to an isolated edge. Each vertex
in V2 must be mapped to a vertex with feature label in Ω. Each vertex in V1 must
be mapped either to a vertex with feature label in Ω or a vertex coming from the
leaves of a the star attached to such a vertex (in which case its feature label is ∞).
For an isolated edge, there are three possibilities: either it is mapped to two vertices
with feature label in Ω, one endpoint is mapped to such a vertex and the other to a
leaf of a star whose center is the first vertex, or it is mapped to an isolated edge
generated by I (in which case both feature labels are ∞). Let us fix for each vertex
in V1 and V0 whether its feature label is ∞ or lies in Ω, noting that this uniquely
determines all the choices we just discussed. Let V00 ⊆ V0 and V10 ⊆ V1 be the sets
of vertices mapped to a vertex coming from Ω, and let V 0 = V00 ∪ V10 ∪ V2 . Let U be
the set of remaining vertices. Let J be the set of isolated edges, and J 00 the set of
isolated edges where we have fixed that they are mapped to an edge generated by I;
i.e., they have both endpoints in U . For a vertex i ∈ V 0 , let dU (i) be its degree to

42

BORGS, CHAYES, COHN, AND LOVÁSZ

U . Conditioned on V 0 , we have

E[inj(F, GT )|V 0 ] =

∞
X

e−µ(Ω)T

n=0

Z

(T µ(Ω))n (n)|V 0 |
n!
µ(Ω)|V 0 |
Y
Y
00
(T S(xi ))dU (i) (2T 2 I)|J |
W (xi , xj )

ΩV 0 {i,j}∈E(F | )
V0

=

∞
X

0

T |V | e−µ(Ω)T

n=|V 0 |

Z
ΩV 0


= T |V | 

Y

W (xi , xj )

Y

(S(xi ))dU (i) (2I)|J

00

|

i∈V 0
0

e−µ(Ω)T

n=|V 0 |



(T µ(Ω))n−|V | 
(n − |V 0 |)!


Y

ΩV 0

Z

Y

W (xi , xj )

00

(S(xi ))dU (i) (2I)|J | 

i∈V 0

{i,j}∈E(F |V 0 )

Y

ΩV 0

|

{i,j}∈E(F |V 0 )


Z

= T |V |

(T µ(Ω))n−|V
(n − |V 0 |)!

T |U |

∞
X

i∈V 0
0

W (xi , xj )

Y

00

(S(xi ))dU (i) (2I)|J | .

i∈V 0

{i,j}∈E(F |V 0 )

Therefore,

E[inj(F, GT )] = T |V |

X Z
V00 ⊆V0
V10 ⊆V1

Y

ΩV 0 {i,j}∈E(F | )
V0

W (xi , xj )

Y

00

(S(xi ))dU (i) (2I)|J | .

i∈V 0

Now, it is not difficult to check that this is multiplicative over connected components
of F . Indeed, each term with fixed V00 , V10 is multiplicative, and the choice of which
vertices to put in V00 , V10 from each of the components is independent. Therefore, we
may assume that F is connected.
If F consists of a single edge {i, j}, then the above expression gives

E[inj(F, GT )] = T

2

Z
W (x, y) dx dy + 2
Ω2



Z
S(x) dx + 2I
Ω

= T 2 t(F, W),

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

43

as required. Otherwise, F has no isolated edges, so V0 is empty (and so is J 00 ). We
then have
X Z
Y
Y
E[inj(F, GT )] = T |V |
W (xi , xj )
(S(xi ))dU (i)
V10 ⊆V1

= T |V |

ΩV 0 {i,j}∈E(F | )
V0

Z

Y

i∈V2

W (xi , xj ) ·

ΩV2 {i,j}∈E(F )
V2





Y

X


i∈V2

= T |V |

Z

Ti ⊆NV1 (i)

Y

Z
ΩTi

Y

W (xi , xj )S(xi )|NV1 (i)|−|Ti | 

j∈Ti

W (xi , xj ) ·

ΩV2 {i,j}∈E(F )
V2

Y Z
i∈V2

|NV1 (i)|
W (xi , xj )dxj + S(xi )

Ω

= T |V | t(F, W).
This completes the proof of the first statement if Ω has finite measure. The general
σ-finite case follows by monotone convergence, with both sides being possibly infinite
in the limit.
To prove the second statement we consider the components of F separately.
Furthermore, given a component F 0 of F , we use the fact that kW k∞ ≤ 1 to delete
edges from F 0 until F 0 becomes a tree. At this point, we can remove the leaves of
the tree at the cost of a factor D for each leaf, getting a new tree with less edges. We
continue until we are left with a single edge, at which point we bound the remaining
integral by kWk1 .


4. Tightness
The goal of this section is to establish various equivalent notions of tightness,
and to then use tightness to relate convergence in the kernel and the weak kernel
metric. In particular, we will relate the convergence of a sequence of graphexes in
the weak kernel metric δ to convergence of a “regularized” sequence in the kernel
metric δ2→2 , where the regularized sequence is obtained from the original one by
discarding the part of the space which has large marginals; see Proposition 4.6 below.
In contrast to the last section, in this section we restrict ourselves to unsigned
graphexes since we believe that the obvious generalization of the notion of tightness
to signed graphexes will not be the right notion of tightness for the metric δ ; see
Remark 4.8 at the end of this section.
We start by establishing the equivalence of various formulations of tightness.
Theorem 4.1. Given a set of graphexes S, the following are equivalent:
(1) S is tight. In other words, for every ε > 0, there exist C and D such
that for every graphex W ∈ S, W = (W, S, I, Ω) with Ω = (Ω, F, µ), there
exists Ωε ⊆ Ω such that µ(Ωε ) ≤ ε and W0 = W|Ω\Ωε has kW0 k1 ≤ C,
kDW0 k∞ ≤ D.

44

BORGS, CHAYES, COHN, AND LOVÁSZ

(2) For every ε > 0, there exist C such that for every graphex W ∈ S, W =
(W, S, I, Ω), there exists Ωε ⊆ Ω such that µ(Ωε ) ≤ ε and W0 = W|Ω\Ωε has
kW0 k1 ≤ C.
(3) For every ε, there is a D and C such that for any W ∈ S, taking Ω≤D to be
the set of points with DW (x) ≤ D, µ(Ω \ Ω≤D ) ≤ ε, and kW|Ω≤D k1 ≤ C.
(4) For every T > 0, the set of random unlabeled finite graphs GT (W) with
W ∈ S is tight.
(5) There exists T > 0 such that the set of random unlabeled finite graphs
GT (W) with W ∈ S is tight.
Corollary 4.2. Let S be a set of graphexes.
(1) If there exists a C < ∞ such that kWk1 ≤ C for all W ∈ S, then S is tight.
(2) If S is tight and has uniformly bounded marginals, then there exist C, D < ∞
such that S is (C, D)-bounded.
Proof. (1) Taking Ωε = ∅ for any ε, the set S clearly satisfies condition (2) from
the theorem.
(2) Choose ε arbitrarily, say ε = 1, and let C 0 , D0 be such that (3) from
Theorem 4.1 holds. Furthermore, let D be such that the marginals of all graphexes
in S are bounded by D. Then
Z
Z
kWk1 ≤ kW|Ω≤D0 k1 + 2 W (x, y)1DW (x)>D0 dµ(x)dµ(y) + 2
S(x) dµ(x)
DW >D 0
Z
≤ C0 + 2
DW(x) dµ(x) ≤ C 0 + 2Dε = C 0 + 2D =: C,
DW >D 0

proving the claim.



In order to prove Theorem 4.1, we will use the following lemma.
Lemma 4.3. The probability that GT (W) has more than KT 2 kWk1 edges is at
most
T 2 kWk1 /2 + T 3 kDW k22
,
(K − 1/2)2 T 4 kWk21
and the probability that it has less than T 2 kWk1 /4 edges is at most
16(T 2 kWk1 /2 + T 3 kDW k22 )
T 4 kWk21
Proof. Let XT be the number of edges of GT (W). By Proposition 3.24, XT has
expectation T 2 kWk1 /2. To calculate the variance, note that we have
inj(F1 , GT ) inj(F2 , GT )
+
+ inj(F3 , GT ),
2
4
where F1 consists of a single edge, F2 consists of a pair of disjoint edges, and F3 consists of two edges joined at one vertex. Therefore, we can again use Proposition 3.24
to conclude that
XT2 =

Var(XT ) = E[XT2 ] − E[XT ]2
T 2 kWk1
T 4 kW1 k2
+
+ T 3 kDW k22 −
2
4
T 2 kWk1
=
+ T 3 kDW k22 .
2

=



T 2 kWk1
2

2

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

45

The bounds on the probabilities of having too many or too few edges follow from
Chebyshev’s inequality.

Proof of Theorem 4.1. (1) ⇒ (2) is obvious.
(2) ⇒ (1): Suppose S satisfies (2), and let ε > 0. Take C from property (2) for
ε/2, and take D = 2C/ε. For each W ∈ S with underlying space Ω, there is a set
Ω0 ⊆ Ω with µ(Ω \ Ω0 ) ≤ ε/2 so that the restriction W0 = W|Ω has kW0 k1 ≤ C.
Suppose µ(x ∈ Ω0 : DW0 (x) > D) > ε/2. Then we would have kW 0 k1 > Dε/2 = C,
a contradiction. Therefore, removing the set of points with DW0 (x) > D, we
have removed points with total measure at most ε, and the restricted graphex is
(C, D)-bounded.
(3) ⇒ (1) is obvious.
0
(1) ⇒ (4): Fix T > 0 and ε > 0. Take ε0 such that e−T ε > 1 − ε/2, and take
C, D for S from the definition of tightness. Given W ∈ S, there exists Ωε0 ⊆ Ω
such that µ(Ωε0 ) ≤ ε0 and W0 = W|Ω\Ωε0 has kW0 k1 ≤ C, kDW0 k∞ ≤ D. The
probability that GT (W) samples a point in Ω \ Ωε0 during the Poisson process is at
0
most 1 − e−T ε < ε/2. Conditioned on this not happening, the sample is equivalent
to a sample from GT (W0 ). For this, we have that kDW0 k22 ≤ CD; therefore we
can take K = K(C, D) large enough so that the probability that there are more
than KT 2 C edges in GT (W0 ) is at most ε/2 (independently of W0 ). Therefore, the
probability that there are more than KT 2 C edges in GT (W) is at most ε.
(4) ⇒ (5) is obvious.
(5) ⇒ (3): Let ε > 0. First, we show that there exists a D so that for every
W ∈ S, the measure of the set {DW > D} is at most ε. Suppose not. We will show
that this implies that for each M we can find a W ∈ S such with probability at
least 12 (1 − e−εT /2 ), the number of edges in GT (W) is at least M . This contradicts
the assumption that the set of random graphs GT (W) is tight.
Assume thus that for every D, there exists a W = W(D) ∈ S such that the
set {DW > D} has measure larger than ε. Take GT (W) and randomly color the
vertices red and blue. With probability at least 1 − e−εT /2 , there exists at least one
blue point whose feature label falls into the set {DW > D}. Conditioned on this,
taking a blue point with feature label x ∈ {DW > D}, the number of red neighbors
it has is a Poisson random variable with mean T DW (x)/2. Given M < ∞, choose
D = D(M, T ) in such a way that a Poisson random variable with mean at least
T D/2 has probability at least 1/2 of being greater than M . As a consequence, given
T and an arbitrary large M and we can find a D and W = W(D) ∈ S such that
with probability at least 12 (1 − e−εT /2 ), the number of edges in GT (W) is at least
M , contradicting tightness.
We claim that kW|Ω≤D k1 can’t be arbitrarily large. Set W0 = W|Ω≤D and assume
that kW0 k1 = C. Then the probability that GT (W0 ) has less than T 2 C/4 edges is
at most
8 + 16T D
.
T 2C
If C is large enough, this is less than 1/2. But then for large enough C with
probability at least 1/2, the number of edges is at least T 2 C/4, contradicting the
assumption of tightness. This means that C can’t be arbitrarily large.
This completes the proof of the theorem.


46

BORGS, CHAYES, COHN, AND LOVÁSZ

Remark 4.4. It will sometimes be useful to transform a graphex W over an arbitrary
σ-finite space Ω = (Ω, F, µ) into a graphex over an atomless space by mapping Ω
to the product space Ω × [0, 1] equipped with the measure µ × λ, with λ denoting
the Lebesgue measure, and mapping W to Φ(W) = Wφ , with φ : Ω × [0, 1] → Ω
denoting the coordinate projection onto Ω. It is easy to see that δ (W, Φ(W)) = 0,
which together with the triangle inequality implies that the map Φ does not change
distances between graphons. It is also easy to check that if S is a tight set of
graphexes, then the set of graphexes obtained by mapping each graphex W ∈ S to
the corresponding atomless graphex Φ(W) is tight as well.
Let us analyze when graphexes converge under δ . To this end, we first prove a
few lemmas.
Lemma 4.5. Given C, D, M ∈ (0, ∞), there exists a function f : [0, ∞)2 → [0, ∞)
such that f (x) → 0 as x → 0 and such that the following holds
(1) Let W be a graphex over (Ω, F, µ), and let µ
e be a second measure over (Ω, F)
f
such that µ − r ≤ µ
e ≤ µ. If W is obtained from W by replacing µ with µ
e
then
µ(DW > D + r) − r ≤ µ
e(DW
e > D) ≤ µ(DW > D)
for all D > 0.
(2) Let W1 and W2 be graphexes with bounded marginals, defined over the same
space (Ω, F, µ). Suppose that d2→2 (W1 , W2 ) < ε. Then
µ({|DW1 − DW2 | ≥ ε}) < ε2 .
W1 and f
W2 be graphexes with bounded marginals, defined over (Ω1 , F1 , µ
(3) Let f
e1 )
and (Ω2 , F2 , µ
e2 ). If δ2→2 (f
W1 , f
W2 ) < ε and D > ε, then
2
2
µ
e1 ({DW
e2 ({DW
e1 ({DW
e 1 > D + ε}) − ε ≤ µ
e 2 > D}) ≤ µ
e 1 > D − ε}) + ε .

(4) For i = 1, 2, let Wi be graphexes defined over (Ωi , Fi , µi ), and let Wi,≤D
be the restriction of Wi to the subset {DWi ≤ D} of Ωi . Assume that
ε + ε2 < D, µ1 ({DW1 > D}) + µ2 ({DW2 > D}) ≤ M , kW2,≤D k1 ≤ C,
δ (W1 , W2 ) ≤ ε, and µ2 ({D − ε − ε2 < DW2 ≤ D + ε + ε2 }) ≤ δ. Then
δ2→2 (W1,≤D , W2,≤D ) ≤ f (ε, δ).
Proof. (1) The assumption µ − r ≤ µ
e ≤ µ clearly implies that for all x ∈ Ω,
DW (x) − r ≤ DW
e (x) ≤ DW (x).
As a consequence,
µ(DW > D + r) − r ≤ µ
e(DW > D + r) ≤ µ
e(DW
e > D)
and
µ
e(DW
e(DW > D) ≤ µ(DW > D).
e > D) ≤ µ
(2) By the definition of d2→2 , kDW1 − DW2 k22 < ε4 , which clearly implies that
µ({|DW1 − DW2 | ≥ ε}) < ε2 .
0
e 0 , Fe0 , µ
(3) For i = 1, 2, let (Ω
ei ) by
i
i ei ) be a measure space obtained from (Ωi , Fi , µ
W0i be the trivial extension
appending some space of infinite total measure, and let f

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

47

0
0
e 0 , Fe0 , µ
Wi onto (Ω
of f
e01 and µ
e02 such that
i
i ei ). Furthermore, let µ be a coupling of µ
0
d2→2 (W01 , W02 ) ≤ ε, where W0i = (f
W0i )πi ,µ for i = 1, 2. Then by (2),

µ
e1 ({DW
e01 ({DW
e 1 > D + ε}) = µ
e 0 > D + ε})
1

= µ0 ({DW01 > D + ε})
≤ µ0 ({DW02 > D}) + µ0 ({|DW01 − DW02 | ≥ ε})
≤ µ0 ({DW02 > D}) + ε2
=µ
e2 ({DW2 > D}) + ε2 ,
proving the first bound in (2). The second is proved analogously.
(4) For i = 1, 2, let W0i be the trivial extension of Wi to a space (Ω0i , Fi0 , µ0i )
obtained from (Ωi , Fi , µi ) by appending some σ-finite space of infinite total mass.
Recalling Lemma 3.14, we can use the assumption δ (W1 , W2 ) < ε to infer the
0
0
existence of a measure µ0 over Ω01 × Ω02 such that d2→2 ((W01 )π1 ,µ , (W02 )π2 ,µ ) < ε
0
and µ0i − ε2 ≤ (µ0 )πi ≤ µ0i , i = 1, 2. For i = 1, 2, define µ
ei = (µ0 )πi , U0i = (W0i )πi ,µ ,
and Ω0i,≤D = {x ∈ Ω0i : DW0i (x) ≤ D}. Then W01,≤D := (W01 )|Ω01,≤D and W02,≤D :=
(W02 )|Ω02,≤D are extensions of W1,≤D and W2,≤D by spaces of infinite measure. Let
µ01,D and µ02,D be the marginals of the measure µ0 |Ω01,≤D ×Ω02,≤D . We then have that
µ01,D ≤ µ01 . Observing that DW0i (πi (x))−ε2 ≤ DU0i (x) ≤ DW0i (πi (x)), we furthermore
have that
0 ≤ (µ01 − µ01,D )(Ω01,≤D ) ≤ ε2 + (e
µ01 − µ01,D )(Ω01,≤D )
= ε2 + µ0 (π1−1 ({DW01 ≤ D}) × π2−1 ({DW02 > D}))
≤ ε2 + µ0 ({DU01 ≤ D} ∩ {DU02 > D − ε2 })
≤ 2ε2 + µ0 ({D − ε2 < DU02 ≤ D + ε})
e
≤ 2ε2 + µ2 ({D − ε2 < DW2 ≤ D + ε + ε2 }) ≤ 2ε2 + δ =: δ.
Here we used the fact that d2→2 (U01 , U02 ) < ε, which meant that we could apply (2).
Similarly, µ02,D ≤ µ02 and
e 02,≤D )
0 ≤ (µ02 − µ02,D )(Ω
≤ ε2 + µ0 ({DU01 > D − ε2 } ∩ {DU02 ≤ D})
≤ 2ε2 + µ0 ({D − ε − ε2 < DU02 ≤ D})
e
≤ 2ε2 + µ2 ({D − ε − ε2 < DW2 ≤ D + ε2 }) ≤ δ.
Next we claim that we may assume without loss of generality that
e
(µ01 − µ01,D )(Ω1,≤D ) = (µ02 − µ02,D )(Ω02,≤D ) ≤ δ.
Indeed, we can trivially extend either W01 or W02 by appending a space of total
measure δ 0 ≤ δe (e.g., the interval [0, δ 0 )), setting µ0 to zero on the additional set.
This corresponds to trivially extending both U01 and U02 by either [0, δ 0 ] × Ω02 or
Ω01 × [0, δ 0 ]. Since µ0 = 0 on the extension, this does not change d2→2 (U01 , U02 ).
Note also that
µ0 (Ω01 × Ω02 \ Ω01,≤D × Ω02,≤D ) ≤ µ0 ({DW01 > D} × Ω02 ) + µ0 (Ω01 × {DW02 > D})
≤ µ1 ({DW1 > D}) + µ2 ({DW2 > D}) ≤ M.

48

BORGS, CHAYES, COHN, AND LOVÁSZ

If U001 and U002 are the restrictions of U01 and U02 to Ω01,≤D × Ω02,≤D , and µ00 is the
restriction of µ0 , then by Lemma 3.13,
kU001 − U002 k2→2,µ00 ≤ ε,
√
kDU001 − DU002 k2,µ00 ≤ ε2 + M ε,
and

√
|kU001 k1 − kU002 k1 | ≤ ε3 + 2 M ε2 + M ε.

Next, we increase µ00 to a measure µ on Ω01,≤D × Ω02,≤D by coupling µ01 − µ01,D
and µ02 − µ02,D arbitrarily. Then µ has marginals µ01 |Ω01,≤D and µ02 |Ω02,≤D and µ − δe ≤
µ00 ≤ µ. If we apply Lemma 3.16, we then obtain a coupling of W01,≤D and W02,≤D
000
such that the pullbacks U000
1 and U2 obey the bounds
p
000
e
kU000
−
U
k
≤
ε
+
2
2Dδ,
2→2,µ
1
2
and

√
000
3
2
e
|kU000
1 k1 − kU2 k1 | ≤ ε + 2 M ε + M ε + 2D δ.

Setting

√
e
e = C + ε3 + 2 M ε2 + M ε + 2Dδ,
C
000
e
we then have max{kU000
1 k1 , kU2 k1 } ≤ C and hence

2
√
2
2
e
e δe + D2 δ.
000 k
kDU000
−
D
≤
ε
+
M
ε
+ 4C
U
2,µ
1
2
This completes the proof of (4).



Suppose (Wn )∞
n=1 and W are graphexes over the σ-finite measure spaces Ωn =
(Ωn , Fn , µn ) and Ω = (Ω, F, µ). Define, for any D > 0,
Ωn,≤D = {x ∈ Ωn : DWn (x) ≤ D}

and

Ωn,>D = {x ∈ Ωn : DWn (x) > D}.

Recall that we have µn (Ωn,>D ) < ∞. Let Wn,≤D consist of Wn restricted to Ωn,≤D .
Define Ω≤D , Ω>D , and W≤D similarly. We then have the following.
Proposition 4.6. Given a sequence of graphexes Wn and a graphex W over the
σ-finite measure spaces Ωn = (Ωn , Fn , µn ) and Ω = (Ω, F, µ), respectively, define
Wn,≤D and W≤D as above. Then the following are equivalent.
(1) For all D > 0 such that µ({DW = D}) = 0, we have δ2→2 (Wn,≤D , W≤D ) →
0 and µn (Ωn,>D ) → µ(Ω>D ).
(2) The sequence is tight, and for all D > 0 such that µ({DW = D}) = 0, we
have δ2→2 (Wn,≤D , W≤D ) → 0.
(3) For every ε > 0 and n ∈ N there exist subsets Ωn,ε ⊆ Ωn and a subset Ωε ⊆ Ω
with µn (Ωn \ Ωn,ε ) ≤ ε and µ(Ω \ Ωε ) ≤ ε, such that δ2→2 (W0n , W0 ) → 0,
where W0n = (Wn )|Ωn ,ε and W0 = W|Ωε .
(4) δ (Wn , W) → 0.
Proof. (1) ⇒ (2): We have to prove tightness. For any ε, there exists a D such that
µ(Ω>D ) ≤ ε/2. Assuming without loss of generality that D is chosen in such a way
that µ({DW = D}) = 0, we further have µn (Ωn,>D ) → µ(Ω>D ). This means that
for all but a finite set of n, µn (Ωn,>D ) ≤ ε. By increasing D, we can guarantee this
for all n. Since δ2→2 convergence implies in particular that kWn,≤D k1 → kW≤D k1 ,
we have that kWn,≤D k1 is bounded. This proves property 3 from Theorem 4.1.

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

49

(2) clearly implies (3), because tightness implies that for any ε, there exists a D
such that the measure of points with degree greater than D is at most ε, and we
can increase D to make sure that µ({DW = D}) = 0.
To show that (3) implies
√ (4), we note that the conditions in (3) imply that
lim supn→∞ δ (Wn , W) ≤ ε. Since ε is arbitrary, this gives (4).
It remains to show that (4) implies (1). The assumption δ (Wn , W) → 0 implies
that for all ε > 0 there exists an n0 such that for n ≥ n0 , δ (Wn , W) < ε. Recalling
Definition 2.14 and combining statements (1) and (3) of the previous lemma, this
implies that for D > ε + ε2 > 0 and n ≥ n0 ,
µ(DW > D + ε + ε2 ) − 2ε2 ≤ µn (DWn > D) ≤ µ(DW > D − ε2 − ε) + 2ε2 .
By our assumption that µ({DW = D}) = 0, we have that D is a continuity point of
the function x 7→ µ({DW > x}), showing that the upper and lower bound converge
to µ({DW > D}) as ε → 0. This shows that µn (DWn > D) → µ({DW > D}) as
n → ∞.
Next we define
M = sup µn (Ωn,>D )+µ(Ω>D )
n

and

δ(ε) = µ({D −ε−ε2 < DW ≤ D +ε+ε2 }).

Note that M is finite by the fact that µn (Ωn,>D ) → µ(Ω>D ), and that δ(ε) → 0 as
ε → 0 by the fact that µ({DW = D}) = 0. We now apply the previous lemma (with
W1 replaced by Wn and W2 replaced by W) to conclude the proof.

The following proposition is an easy corollary of Proposition 4.6.
Proposition 4.7. Given two graphexes W1 , W2 , let Wi,≤D be the graphex Wi
restricted to Ωi,≤D = {x ∈ Ωi : DWi (x) ≤ D}. Then the following are equivalent.
(1) For any D > 0,
µ1 (Ω1 \ Ω1,≤D ) = µ2 (Ω2 \ Ω2,≤D ) and δ2→2 (W1,≤D , W2,≤D ) = 0.
(2) For any D > 0, δ2→2 (W1,≤D , W2,≤D ) = 0.
(3) For any ε > 0, there exist subsets Ω1,ε ⊆ Ω1 , Ω2,ε ⊆ Ω2 with µi (Ωi \Ωi,ε ) ≤ ε,
such that if W0i is the restriction to Ωi \ Ωi,ε , then δ2→2 (W01 , W02 ) ≤ ε.
(4) δ (W1 , W2 ) = 0.
It is easy to see that this is an equivalence relation.
Proof. Observing that the functions fi : R+ → R+ defined by D 7→ µi (Ωi \ Ωi,≤D )
for i = 1, 2 are equal if and only if f1 (D) = f2 (D) for all continuity points of f1 ,
this follows by applying Proposition 4.6 with W = W1 and each Wn = W2 .

Remark 4.8. It is not a priori clear how to generalize the notion of tightness
to signed graphexes, even if we restrict ourselves to the case where the graphon
parts are uniformly bounded, for example by taking graphons that take values in
[−1, 1]. Indeed, recalling Lemma 3.12 and the role it played in showing that δ is
finite for signed graphexes with bounded graphon part, one might want to modify
Definition 2.20 for such graphexes by replacing the notion of D-bounded marginals
by that of D-bounded absolute marginals, since this would, in particular, guarantee
that a finite set of signed graphexes with graphon parts in [−1, 1] is tight. It would
also make the generalization of several of our results straightforward, since this
definition just reduces the notion of tightness of a set of graphexes S to the set of
graphexes S 0 = {|W| : W ∈ S}.

50

BORGS, CHAYES, COHN, AND LOVÁSZ

The following example shows that this straightforward generalization of Definition 2.20 to signed graphexes does not give a characterization of precompact sets
with respect to the metric δ , as it did for unsigned graphexes; see Theorem 2.21.
Let Wn be equal to n−3/4 on [0, 1) × [1, n + 1) ∪ [1, n + 1) × [0, 1), equal to −n−3/4
on [0, 1) × [n + 1, 2n + 2) ∪ [n + 1, 2n + 1) × [0, 1), and zero everywhere else on
R2+ . Define Wn to be the graphex with graphon part Wn and zero star and dust
part. Then DWn is equal to n−3/4 on [1, n + 1), equal to −n−3/4 on [n + 1, 2n + 1),
−1/2
and 0 everywhere
and
√ −1/2else. Finally, ρ(Wn ) = 0 for all n. Since kWn k2 = 2n
kDWn k2 = 2n
, Wn tends to the zero graphex in the metric δ2→2 and hence
also in δ . But kWn k1 = kW k1 = 4n1/4 → ∞, a fact which can’t be changed by
removing just a part of measure ε from the underlying space, R+ . This shows
that with the obvious generalization of Definition 2.20 to signed graphexes not all
sequences of signed graphexes that are convergent in δ2→2 or δ are tight.
We therefore believe that a complete theory of signed graphexes, even in the
simplified case where all graphons take values in [−1, 1], requires either a modification
of the metric, or modification of the notion of tightness. We leave this problem as
an open research problem.
5. Regularity lemma and compactness
In this section, we will prove a regularity lemma (Theorem 5.3 below), and use
it to prove Theorem 2.21, which in turn is an important ingredient in our proof
that GP-convergence and δ -convergence are equivalent. To state the regularity
lemma, we recall that a finite subspace partition of a measure space Ω = (Ω, F, µ)
is a partition of a measurable subset of Ω into finitely many measurable subsets of
finite measure. Throughout this section, we will use the notation P = (ΩP , P) for
a finite subspace partition, with ΩP denoting the subset of Ω, and P = (P1 , . . . , Pm )
denoting the partition of ΩP . We will also need the notion of refinement.
Definition 5.1. Given two subspace partitions P = (ΩP , P) and Q = (ΩQ , Q),
we say that P refines Q if ΩQ ⊆ ΩP and P is a refinement of Q ∪ {ΩP \ ΩQ }.
Given an integrable, signed graphex W, a subspace partition P naturally generates a step function WP by “averaging”. The precise definition is as follows.
Definition 5.2. Given a signed graphex W = (W, S, I, Ω) and a finite subspace
partition P = (ΩP , P), take WP to be the signed graphex WP = (WP , SP , IP , Ω)
defined by
Z
Z
1
IP =
W (x, y) dµ(x) dµ(y) +
S(x) dµ(x) + I,
2 (Ω\ΩP )×(Ω\ΩP )
Ω\ΩP
1
SP (x) =
µ(Pi )

Z
S(x) +
Pi

!

Z
W (x, y) dµ(y)

dµ(x)

if x ∈ Pi

Ω\ΩP

for some i ∈ {1, . . . , k}, and 0 everywhere else, and
Z
1
WP (x, y) =
W (x0 , y 0 ) dµ(x0 ) dµ(y 0 )
µ(Pi )µ(Pj ) Pi ×Pj

if

for some i, j ∈ {1, . . . , k} and WP (x, y) = 0 everywhere else.

(x, y) ∈ Pi × Pj

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

51

Note that with this definition, for x ∈ Pi ,
Z
1
DWP (x) =
DW (x) dµ(x).
µ(Pi ) Pi
We also have ρ(WP ) = ρ(W), as well as kWP k1 ≤ kWk1 , kDWP k∞ ≤ kDW k∞ , and
kWP k∞ ≤ kW k∞ .
Theorem 5.3. For any B, C, D < ∞, and ε > 0, there exists an M (ε) and N (ε)
such that for any signed graphex W that is (B, C, D)-bounded there exists a partition
(ΩP , P) with P = {P1 , . . . , Pm }, m ≤ M (ε), and µ(ΩP ) ≤ N (ε) such that
d (W, WP ) ≤ ε.
We can take
M (ε) = 2(2BC+CD)/ε

2

N (ε) = (4C 3 D + 8BC 2 D)/ε4 .

and

Given any finite subspace partition Q = (ΩQ , Q), we can require the subspace
partition P = (ΩP , P) to be a refinement of Q. In this case, the bound on the
number of parts is |Q|M (ε) and the bound on µ(ΩP ) is µ(ΩQ ) + N (ε).
Proof. Motivated by the original proof of the weak regularity lemma (see in particular
the proof of Theorem 12 in [14], which to our knowledge is the first place where a
weak regularity lemma for functions W : [0, 1]2 → R was established), we construct
a sequence of partitions P0 , P1 , . . . , P` such that eventually, we must have that
d (W, WP` ) ≤ ε. We start with the trivial partition P0 = (∅, ∅) (so that WP0
is the graphex with zero graphon and star part, and dust part ρ(W)), and then
construct a sequence of refinements P0 , P1 , . . . , P` .
In a preliminary step, we claim that for any partition P,
Z
hW − WP , WP i =
(W (x, y) − WP (x, y))WP (x, y) dx dy = 0
Ω×Ω

and

Z
hDW − DWP , DWP i =

Ω

(DW (x) − DWP (x))DWP (x) dx = 0

This follows from the fact that for any pair of finite parts Pi , Pj , WP and DWP
are constant, and the integral of W − WP and DW − DWP is zero. Since WP is
zero between pairs of parts where at least one is non-finite, and DWP is zero on
non-finite parts, this implies the claim. Therefore, we have
kW k22 = kWP k22 + kW − WP k22
and
kDW k22 = kDWP k22 + kDW − DWP k22 .
If we have a finite subspace partition P = (ΩP , P) and a refinement P 0 , it is then
easy to check that (WP 0 )P = WP ; therefore, the same properties hold for WP
and WP 0 .
Suppose now that we have constructed a sequence of refinements P0 , P1 , . . . , Pi
such that d (W, WPj ) > ε for all j ≤ i. Then we in particular have that
d (W, WPi ) > ε, which implies that kDW − DWPi k > ε or kW − WPi k > ε. If
the former holds, then there exists a set S ⊆ Ω (of finite measure) such that
Z

Z


1
 DW (x) dµ(x) −
 = A > ε.
p
(5.1)
D
(x)
dµ(x)
WPi


µ(S)
S

S

52

BORGS, CHAYES, COHN, AND LOVÁSZ

Let Pi+1 = (ΩPi+1 , Pi+1 ) with ΩPi+1 = ΩPi ∪ S and let Pi+1 be the partition
that refines each part of Pi by the intersection with S; in particular, this divides
each part into at most 2 parts, and µ(ΩPi+1 ) ≤ µ(ΩPi ) + µ(S). We also have
Z

Z


1

p
DWPi+1 (x) dµ(x) −
DWPi (x) dµ(x) = A.

µ(S) S
S
Therefore,
*
kDWPi+1 −

DWPi k22

≥

DWPi+1

χS
− DWPi , p
µ(S)

+2
= A2 .

Overall, this implies that we have
kDWPi k22 + ε2 ≤ kDWPi+1 k22 ≤ kDW k22 .
We also have
If kW − WPi k > ε,
Z

1

(5.2) p
µ(S)µ(T ) 

kWPi k22 ≤ kWPi+1 k22 ≤ kW k22 .
then there exist sets S, T ⊆ Ω (of finite measure) such that

Z

W (x, y) dµ(x) dµ(y) −
WPi (x, y) dµ(x) dµ(y) > ε.

S×T

S×T

Let Pi+1 = (ΩPi+1 , Pi+1 ) with ΩPi+1 = ΩP ∪ S ∪ T and let Pi+1 be the partition
that refines each part of Pi by the intersection with S and T , in particular, this
refines each part into at most 4 parts, and µ(ΩPi+1 ) ≤ µ(ΩPi ) + µ(S) + µ(T ).
Proceeding as before, we have
kWPi k22 + ε2 ≤ kWPi+1 k22 ≤ kW k22 ,
and furthermore,
kDWPi k2 ≤ kDWPi+1 k2 ≤ kDW k2 .
The first step can occur at most kDW k2 /ε2 times, and the second at most kW k22 /ε2
times. Since in the first step, the number of partition classes at most doubles, and
in the second it goes up by at most a factor of four, this proves that there exists a
partition P with at most
2

2

2

2

2(2kW k2 +kDW k2 )/ε ≤ 2(2BC+CD)/ε = M (ε)
classes such that d (W, WP ) ≤ ε.
To prove that µ(ΩP ) ≤ N (ε), we claim that in each step, (5.1) implies that
µ(S) ≤

4C 2
,
ε2

and (5.2) implies that
µ(S), µ(T ) ≤

4CD
.
ε2

Indeed, for any S ⊆ Ω,
Z



 DW (x) − DW (x) ≤ 2C.
Pi


S

This implies that if
Z

Z


 DW (x) dµ(x) −
≥ε
D
(x)
dµ(x)
WPi


µ(S)
1

p

S

S

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

then

4C 2
.
ε2

µ(S) ≤
On the other hand,

Z




W
−
W
P  ≤ 2C


53

Z




and

S×T

S×T



W − WP  ≤ 2Dµ(T ).

Therefore,
Z




S×T


p

W − WP  ≤ 2 CDµ(T ).

This implies that if
Z


µ(S)µ(T ) 
1

p

S×T

then
µ(S) ≤



W − WPi  ≥ ε

4CD
.
ε2

The bound for µ(T ) follows similarly.
Since first step can occur at most kDW k2 /ε2 times, and the second at most
kW k22 /ε2 times, this shows that

4C 2 kDW k22
4CD kW k22
4 3
2
µ(ΩP ) ≤ 2
+
2
≤
C
D
+
2BC
D
= N (ε).
ε
ε2
ε2
ε2
ε4
The second statement follows by choosing P0 = Q.

Remark 5.4. With the help of Proposition 3.19, Theorem 5.3 can immediately be
transformed into a similar statement for the kernel distance d2→2 (W, WP ), provided
8
N (ε) and M (ε) are replaced by bounds of the form M (ε) = 2c/ε and N (ε) = d/ε16
where c and d are constants depending on B, C and D.
We would like to prove a version of this “regularity lemma” for d2→2 where the
parts have equal size. We first show some preliminary lemmas.
Lemma 5.5. Let W1 , W2 be two graphexes on the same space Ω, and let P be a
finite subspace partition of Ω. Then
kW1,P − W2,P k2→2 ≤ kW1 − W2 k2→2
and
kDW1,P − DW2,P k2 ≤ kDW1 − DW2 k2 .
Proof. Note that
kW1,P − W2,P k2→2 =

sup

f ◦ (W1,P − W2,P ) ◦ g

f,g∈L2 (Ω)
kf k2 =kgk2 =1

=

sup

f ◦ (W1,P − W2,P ) ◦ g.

f,g∈L2 (ΩP )
kf k2 =kgk2 =1

If we let fP and gP consist of the average values of f and g on each part of P and
zero outside ΩP , then
f ◦ (W1,P − W2,P ) ◦ g = fP ◦ (W1,P − W2,P ) ◦ gP = fP ◦ (W1 − W2 ) ◦ gP ,
which implies the first claim. The second claim follows similarly.



54

BORGS, CHAYES, COHN, AND LOVÁSZ

Corollary 5.6. Suppose that W is a graphex, and that U is a step graphex over
the same space as W. If P = (ΩP , P) is a finite subspace partition such that U is
constant on each part of P and zero outside ΩP , then
kWP − W k2→2 ≤ 2kU − W k2→2
and
kDWP − DW k2 ≤ 2kDU − DW k2 .
Proof. Note that UP = U. We have
kWP − W k2→2 ≤ kWP − U k2→2 + kU − W k2→2
= kWP − UP k2→2 + kU − W k2→2 ≤ 2kU − W k2→2 .
Similarly,
kDWP − DW k2 ≤ kDWP − DU k2 + kDU − DW k2
= kDWP − DUP k2 + kDU − DW k2 ≤ 2kDU − DW k2 .



Theorem 5.7. Given B, C, D, and ε > 0, there exists ρ0 = ρ0 (ε, B, C, D) > 0
and N0 = N0 (ε, B, C, D) such that for any ρ < ρ0 , any m ≥ N0 /ρ, and any
(B, C, D)-bounded signed graphex W on an atomless space with infinite measure,
there exists a subspace partition P = (ΩP , P) with exactly m parts of size ρ such
that d2→2 (W, WP ) ≤ ε. If P0 = (ΩP0 , P0 ) is an arbitrary finite subspace partition,
we can require P to refine P0 , as long as each part of P0 is divisible by ρ (and
increasing the bound on N0 (ε) and decreasing ρ0 appropriately depending on |P0 |
and µ(ΩP0 )).
Proof. Apply Theorem 5.3 and Proposition 3.19 to obtain a subspace partition P 0
with at most M (ε/3) parts and size at most N (ε/3) such that d2→2 (W, WP 0 ) ≤ ε/3.
We first construct a refinement Q = (ΩQ , Q) as follows. Add a part from Ω \ ΩP 0
so that the total measure of ΩQ is equal to mρ (this will require m ≥ N (ε/3)/ρ),
and divide each part of P 0 ∪ {ΩQ \ ΩP 0 } into parts of size ρ, with perhaps one part
remaining of smaller size. We then define P by combining the parts of Q that have
size smaller than ρ, including the part added from Ω \ ΩP 0 , into a single set Ω0 , and
then dividing Ω0 into parts of size ρ (and keeping the remaining parts of Q). Then
WQ and WP differ only on Ω0 , which has size at most (M (ε/3) + 1)ρ, implying that
kWQ − WP k22→2 ≤ kWQ − WP k22
Z
Z
2
≤2
(WQ − WP ) ≤ 2
B(|WQ | + |WP |)
Ω×Ω0
Ω×Ω0
Z
≤ 4B
D|W | ≤ 4(M (ε/3) + 1)ρBD.
Ω0

We also have
sZ
kDWQ − DWP k2 ≤ 2

D|W| (x)2 dµ(x) ≤ 2

p
(M (ε/3) + 1)ρD.

Ω0

Furthermore, we know that WP 0 is constant on each part of Q. Therefore, applying
Corollary 5.6, we have
kW − WQ k2→2 ≤ 2kW − WP 0 k2→2 ≤ 2ε/3
and
kDW − DWQ k2 ≤ 2kDW − DWP0 k2 ≤ 2ε2 /9.

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

55

Therefore, if ρ is small enough, then
kW − WP k2→2 ≤ ε
and
kDW − DWP k2 ≤ ε2 .
We can add parts of zero measure and the above argument still works. If we
want P to be a refinement of a starting partition P0 , we apply Theorem 5.3 and
Proposition 3.19 and make sure to combine the leftover parts so that they are within
the same part of P0 , this can be done since each part of P0 is divisible by ρ.

We close this section by proving Theorem 2.21. To this end, we will first establish
two lemmas.
Lemma 5.8. Let S be a set of signed graphexes over atomless spaces of infinite
measure such that the following condition holds:
(a) For every ε > 0, there exists B, C, D such that for any W = (W, S, I, (Ω, F, µ)) ∈
S, taking Ω≤D to be the set of points with D|W| (x) ≤ D, we have that µ(Ω \
Ω≤D ) ≤ ε, kW |Ω≤D k∞ ≤ B, and kW|Ω≤D k1 ≤ C.
Then there exist strictly increasing sequences of integers ak ≥ 2k and bk ≥ k and
sequences of positive real numbers Bk , Ck , and Dk such that the following holds. For
any graphex W ∈ S, W = (W, S, I, Ω) with Ω = (Ω, F, µ), there exists a sequence of
subsets Pk,0 ⊆ Ω and subspace partitions Pk = (ΩPk , Pk ), Pk = {Pk,1 , . . . , Pk,mk }
with mk = 2ak +bk , such that for all k, ΩPk is disjoint from Pk,0 and
(1)
(2)
(3)
(4)
(5)

Pk+1,0 ⊆ Pk,0 and µ(Pk,0 ) = 2−2k ,
Wk = W|Ω\Pk,0 is (Bk , Ck , Dk )-bounded,
Pk+1 refines Pk ,
Pk,i for i ≥ 1 has measure 2−ak , and
d2→2 (Wk , (Wk )Pk ) ≤ 2−k .

Note that by property (3) from Theorem 4.1, every tight set of unsigned graphexes
obeys the condition (a) (with B = 1), showing that the conclusions of the theorem
hold for any tight set S of graphexes over atomless spaces of infinite measure.
Proof. Define
Dk = inf{D : for all W ∈ S, µ(Ω \ Ω≤D ) ≤ 2−2k },
and let Bk = supW∈S kW |Ω≤Dk k∞ and Ck = supW∈S kW|Ω≤Dk k1 . By the condition
(a) these are finite, and by construction they are monotone non-decreasing functions
0
of k. Given a graphex, we then first set each Pk,0
to be the set of points with
0
0
degree greater than Dk . In this way we have each Pk+1,0
⊆ Pk,0
; however, they may
be strictly smaller than the required size. We therefore extend them one by one,
starting with P0,0 , and make sure that we still have each Pk+1,0 ⊆ Pk,0 . Taking Wk
to be the restrictions, properties (1) and (2) are satisfied.
Next, apply Theorem 5.7 with ε = 1 to obtain N0 and ρ0 . Increasing N0 (if needed)
so that it is of the form 2b0 for some nonnegative integer b0 , we then choose a0 such
that 2−a0 < ρ0 . For any graphex, take P0 according to the theorem with ρ = 2−a0 .
Keep iterating the theorem, in each step applying Theorem 5.7 with B = Bk , C = Ck ,
D = Dk , ε = 2−k , and P0 = (ΩPk−1 ∪(Pk−1,0 \Pk,0 ), Pk ∪{Pk−1,0 \Pk,0 }), ensuring
in each step that ak ≥ max{2k, ak−1 + 1}, 2−ak < ρk , and bk > bk−1 .


56

BORGS, CHAYES, COHN, AND LOVÁSZ

Lemma 5.9. Every tight sequence of graphexes has a subsequence that is δ convergent. More generally, every sequence of signed graphexes obeying the condition
(a) from Lemma 5.8 has a δ -convergent subsequence. If condition (a) holds with
one or more of the constants B, C, D not depending on ε, then the subsequential
limit inherits the corresponding bound.
During the proof, we will use the following.
graphex, P = (ΩP , P) is a
Claim. Suppose that W = (W, S, I, Ω) is a signed S
finite subspace partition, and P0 ⊆ P. Let Ω0 = P ∈P0 P , P 0 = P \ P0 , and
P 0 = (Ω0P 0 , P 0 ), where Ω0P 0 = ΩP \ Ω0 . Then (WP )|Ω0 = (W|Ω0 )P 0 .
Proof. Note that Ω \ ΩP = Ω0 \ Ω0P 0 (since Ω0 is disjoint from both). First, we have
Z
Z
1
S(x) dµ(x) + I
W (x, y) dµ(x) dµ(y) +
IP =
2 (Ω\ΩP )×(Ω\ΩP )
(Ω\ΩP )
Z
Z
1
=
W (x, y) dµ(x) dµ(y) +
S(x) dµ(x) + I = IP 0 .
2 (Ω0 \Ω0 0 )×(Ω0 \Ω0 0 )
(Ω0 \Ω0 0 )
P

P

P

We also have for x ∈ Ω0 , if x ∈ Pi , then
!
Z
Z
1
S(x) +
W (x, y) dµ(y) dµ(x)
SP (x) =
µ(Pi ) Pi
Ω\ΩP
!
Z
Z
1
=
S(x) +
W (x, y) dµ(y) dµ(x) = SP 0 (x),
µ(Pi ) Pi
Ω0 \Ω0P
and SP (x) = 0 = SP 0 (x) if x ∈ Ω0 \ Ω0P 0 . Finally, if x, y ∈ Ω0 and x ∈ Pi , y ∈ Pj
with Pi , Pj ∈ P 0 , then
Z
1
W (x0 , y 0 ) dµ(x0 ) dµ(y 0 ) = (W |Ω0 )sP 0 ,
WP (x, y) =
µ(Pi )µ(Pj ) Pi ×Pj
and 0 otherwise.



Proof of Lemma 5.9. Let W1 , W2 , . . . , Wn , . . . be a sequence of signed graphexes
obeying the condition (a), and let f
Wi be obtained from Wi by appending an arbitrary
σ-finite space of infinite measure. Then f
W1 , f
W2 , . . . , f
Wn , . . . obeys the condition
(a) as well, and arguing as in Remark 4.4, we can assume without loss of generality
that f
W1 , f
W2 , . . . , f
Wn , . . . are all defined over atomless spaces. We want to show
that they have a subsequence that converges to a graphex.
fn,k as in
We can take for each n and k sets Pen,k,0 and subspace partitions P
e n \ Pen,k,0 . For
Lemma 5.8, defining in particular f
Wn,k as the restriction of f
Wn to Ω
f
f
e
e
k ≥ k0 , we will also define Wn,k,k0 as the restriction of (Wn,k )P
fn,k to Ωn \ Pn,k0 ,0 .
fn,k,k consists of the classes
By the above claim, f
Wn,k,k = (f
Wn,k ) f
, where P
0

0

Pn,k,k0

0

fn,k which are subsets of Ω
fn,k,k is
e n \ Pen,k ,0 . This implies in particular that W
in P
0
0
(Bk0 , Ck0 , Dk0 )-bounded.
Furthermore, in view of Remark 3.6, we can replace each (f
Wn,k )Pn,k by an
equivalent step function Wn,k over R+ , where the first part is Pn,k,0 := [0, 2−2k )
(which is disjoint from dsupp Wn,k ), the remaining parts Pn,k,i for i ≥ 1 are of the
form [`/2ak , (` + 1)/2ak ) for some nonnegative integer `, and we extend Wn,k to
zero above Nk + 2−2k , where Nk = 2bk .

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

57


Let Pk0 = [2−2k , Nk + 2−2k ), Pk0 , where Pk0 partitions [2−2k , Nk + 2−2k ) into
intervals of length 2−ak . Note that after this change, the bound (5) from Lemma
Wn,k , Wn,k ) ≤ 2−k . In this way, we have mapped the
5.8 becomes the bound δ2→2 (f
“steps” of each step graphex to Pk0 . For each k, the graphex Wn,k then just depends
on a finite number of parameters, each bounded. We can then use a diagonalization
argument to take a subsequence so that for every k, Wn,k converges to some Wk
as n → ∞, in the sense that Wk is a step graphex with the same parts and each
value of the function converges, which also implies that kWn,k k1 → kWk k1 and
Wn,k → Wk in the metric δ2→2 (since there are a finite number of steps).
Given k ≥ k0 , let Wk,k0 be equal to Wk restricted to [2−2k0 , ∞), let Pk,k0 consist
of those intervals in Pk0 which are above 2−2k0 , and finally, let Pk,k0 = (Ωk,k0 , Pk,k0 )
0
where Ωk,k0 = [2−2k0 , Nk + 2−2k ). We claim that Wk,k0 = Wk+1,k
Pk,k . This follows
0

from the fact that for any n, if Wn,k,k0 is Wn,k restricted to [2−2k0 , ∞), then
(Wn,k+1,k0 )Pk,k = Wn,k,k0 , by the above claim.
0
Next, recalling that f
Wn,k,k0 is (Bk0 , Ck0 , Dk0 )-bounded for each n and k, we
have that Wk,k0 is (Bk0 , Ck0 , Dk0 )-bounded as well, implying in particular that
kWk,k0 k1 ≤ Ck0 . Also note that if Pi , Pj ∈ Pk,k0 , then
Z
Z
|W k,k0 (x, y)| dµ(x) dµ(y) ≤
|W k+1,k0 (x, y)| dµ(x) dµ(y).
Pi ×Pj

Pi ×Pj

Since W k,k0 is supported on the union of Pi × Pj for all choices of Pi and Pj , this
implies that kW k,k0 k1 cannot decrease as k increases. Together, these observations
0
imply that the limit limk0 →∞ kW k ,k0 k1 exists and is at most Ck0 . Given ε > 0, we
0
can therefore find k(ε, k0 ) < ∞ such that limk0 →∞ kW k ,k0 k1 − kW k,k0 k1 < ε for
all k ≥ k(ε, k0 ). Furthermore, because Ω2k,k0 is the support of W k,k0 ,
Z
Ω2k,k

|W k,k0 (x, y)| dµ(x) dµ(y) ≤

Z

|W k+1,k0 (x, y)| dµ(x) dµ(y).

Ω2k,k

0

0

As a consequence, for all k 0 ≥ k(ε, k0 ),
Z
0
|W k ,k0 (x, y)| dµ(x) dµ(y) < ε.
R2+ \Ω2k,k

0

Therefore, the random variables W k,k0 are uniformly integrable. By the martingale
0
0
convergence theorem (applied to each [2−2k0 , 2−2k + Nk0 ] × [2−2k0 , 2−2k + Nk0 ]
with k 0 ≥ k0 ), the graphon part W k,k0 of Wk,k0 is pointwise convergent almost
f k0 defined on [2−k0 , ∞)2 , and it also converges to W
f k0
everywhere to a function W
1
k,k0
2
in L . Since kW
k∞ ≤ Bk0 , this implies convergence in L , and hence in the
kernel metric k · k2→2 . Furthermore, the graphon marginals converge in L1 , because
k,k0
f k0 k1 −−−−→ 0.
kDW k,k0 − DW
−W
f k0 k1 ≤ kW
k→∞

We also have
Z
Pi

Z
|DWk,k0 (x)| dµ(x) ≤

Pi

|DWk+1,k0 (x)| dµ(x).

58

BORGS, CHAYES, COHN, AND LOVÁSZ

This implies that kDWk,k0 k1 cannot decrease as k increases. Since Ωk,k0 is the
support of DWk,k0 ,
Z
Z
|DWk,k0 (x)| dµ(x) ≤
|DWk+1,k0 (x)| dµ(x).
Ωk,k0

Ωk,k0

As before, this implies that the functions DWk,k0 are uniformly integrable and
uniformly bounded (by Dk0 ). We can again use the martingale convergence theorem
0
(applied to each [2−2k0 , 2−2k + Nk0 ]) to show that DWk,k0 converges pointwise and
1
2
in L , and therefore in L , to a function DWk0 taking values in [−Dk0 , Dk0 ]. Define
Sek0 (x) = DW
e k0 (x) − DW
f k0 (x).
Since we also have
S k,k0 (x) = DWk,k0 (x) − DW k,k0 (x),
and since both terms in the difference converge in L1 , S k,k0 converges in L1 to Sek0 .
By Theorem 3.12 in [24] this implies that some subsequence converges pointwise
almost everywhere, showing in particular that in the unsigned case, Sek0 ≥ 0 almost
everywhere.
We also have that ρ := ρ(Wk,k0 ) is constant in k. Define
Z
Z
f k0 .
I k0 = ρ − 2 Sek0 − W
Since for each k,
I k,k0 = ρ − 2

Z

S k,k0 −

Z

W k,k0 ,

f k0 , respectively, this
and since S k,k0 and W k,k0 converge in L1 to Sek0 and W
k,k0
k,k0
k,k
k,k
k
implies that I
converges to Ie 0 . Because W 0 , S 0 , and DW
converge in L1
(and hence pointwise almost everywhere on some subsequence), the limit inherits
(Bk0 , Ck0 , Dk0 )-boundedness from Wk,k0 .
Since for each k, Wk,k0 +1 , when restricted to [2−2k0 , ∞), is equal to Wk,k0 , and
since f
Wk0 +1 and f
Wk0 are pointwise limits along some subsequence, f
Wk0 is also the
k0 +1
−2k0
f
restriction of W
to [2
, ∞). Therefore, we can define a signed graphex W on
R+ as the “union” of the signed graphexes f
Wk0 . Note that the limit W is locally
finite by the fact that f
Wk0 is (Bk0 , Ck0 , Dk0 )-bounded. This also implies that W
inherits any of these bounds from f
Wk0 that do not depend on k0 .
We claim that on the subsequence where Wn,k converges to Wk in δ2→2 for each
k, Wn → W in the weak kernel metric δ . To see this, we first note that f
Wk0 is
−2k0
k,k0
obtained from W by removing a set of measure 2
, and W
is obtained from
Wk by removing a set of the same measure, showing that for any k0 ,
δ (W, Wk ) ≤ max{2−k0 , δ2→2 (f
Wk0 , Wk,k0 )}.
Given ε > 0, choose k0 such that 2−k0 ≤ ε/2. Since δ2→2 (Wk,k0 , f
Wk0 ) → 0 for each
k
k0 as k → ∞, this shows that for k large enough, δ (W, W ) ≤ ε/2. In a similar
way,
δ (Wn , Wk ) = δ (f
Wn , Wk ) ≤ max{2−k , δ2→2 (f
Wn,k , Wk )}.
Since δ2→2 (f
Wn,k , Wn,k ) ≤ 2−k and δ2→2 (Wn,k , Wk ) → 0 for each k as n → ∞, we
can first choose k and then n large enough to guarantee that the right side is smaller

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

59

than ε/2. Combined with the triangle inequality for δ , this shows that for all ε > 0
we can find an n0 such that for n ≥ n0 , we have δ (Wn , W) ≤ ε, as claimed.

Remark 5.10. It is not hard to see that a sequence of signed graphexes Wn =
(Wn , Sn , In , Ωn ) with kWn k∞ ≤ B and kWn k1 ≤ C obeys the condition (a) from
Lemma 5.8. If B ≤ 1, this follows by applying Corollary 4.2 (1) to the sequence
|Wn |, and for B > 1 it follows by applying Corollary 4.2 (1) to the sequence
(|Wn |/B, |Sn |/B, |In |/B, Ωn ). Choosing a convergent subsequence, it is clear from
the last proof that the limiting graphex W = (W, S, I, Ω) must obey the bound
kW k∞ ≤ B. The statement from Remark 2.22 therefore is a direct consequence of
Lemma 5.9.
Proof of Theorem 2.21. By Corollary 4.2 (1), any set of graphexes whose L1 norms
are bounded by C is tight, so by Lemma 5.9 any such sequence of graphexes has a
subsequence with a limit W in the metric δ . Lemma 5.9 also implies that the limit
inherits the bound on the L1 norm, and therefore the set of graphexes whose L1
norms are bounded by C is compact. The same proof gives the statement of the
theorem for (C, D)-bounded graphexes.
Suppose now that W1 , W2 , . . . , Wn , . . . is a Cauchy sequence in δ . We first
claim that it must be tight. Indeed, for any ε > 0, there exists n such that for any
m > n, δ (Wn , Wm ) < ε. Fix such an n and an m > n. By Lemma 3.14, we can
then decrease the measures µn , µm by at most ε2 such that the δ2→2 distance of the
cn and W
cm is less than ε. Let W0n , W0m be trivial extensions of
resulting graphexes W
the modified graphexes by spaces of infinite measure, and let f
W0n , f
W0m be pullbacks
0
0
according to a coupling so that d2→2 (f
Wn , f
Wm ) < ε, which exists by the definition
of δ2→2 . Furthermore, since every finite set of graphexes is tight, we can find (C, D)
such that we can remove a set of measure ε2 from c
Wn to make it (C, D)-bounded
(independent of m). If we remove the pullback of this set from the underlying space
of f
W0n and f
W0m and replace them by the restrictions, then the two graphexes will
still have δ2→2 distance at most 2ε by Lemma 3.13. In particular, this means that
kf
W0m k1 ≤ C + 8ε3 . We also have
√
√
kDW
CD + 4ε2 ≤ 2 CD.
e 0 k2 ≤ kDW
e 0 k2 + kDW
e 0 − DW
e 0 k2 ≤
m
n
m
n
p
Therefore, the measure of the points x for which DW
CD/ε is at most 4ε.
e 0 (x) >
m
p
0
0
Taking C = C + ε and D = CD/ε, we have obtained that for any m > n we
can remove a set of measure at most 6ε so that the remainder is (C 0 , D0 )-bounded.
Since any finite set is tight, and the union of two tight sets is tight, this means that
the entire sequence is tight. Therefore, it must have a convergent subsequence that
converges to a graphex W. But then because the original sequence was a Cauchy
sequence, the entire sequence must converge to W. This proves that the space of
graphexes is complete.
The above lemma implies that every tight set is relatively compact, and the fact
that any Cauchy sequence must be tight implies that every relatively compact set is
tight.

6. Subgraph counts
In this section we will prove that convergence in the weak kernel metric implies
GP-convergence. The main technical tool for this proof will be the following counting

60

BORGS, CHAYES, COHN, AND LOVÁSZ

lemma, which says that given any C, D < ∞, two (C, D)-bounded graphexes that
are close in kernel metric δ2→2 must have close subgraph counts.
While this lemma and its corollary are formulated only for unsigned graphexes,
we note that both have natural generalizations to signed graphexes. See Remark 6.9
at the end of Section 6.1 below.
Lemma 6.1. Let F be a simple, connected graph with m edges and n ≥ 3 vertices,
and let C, D < ∞. Suppose that W1 and W2 are graphexes on the same underlying
space Ω, with kWi k1 ≤ C and kDWi k∞ ≤ D for i = 1, 2, and let ε = max{kW1 −
W2 k2→2 , kDW1 −W2 k2 }. Then

e = max{C,
where C

√

e n−3 ,
|t(F, W1 ) − t(F, W2 )| ≤ mεCD
CD}.

Corollary 6.2. Suppose Wn , W have uniformly bounded marginals. If
δ2→2 (Wn , W) → 0,
then for any finite graph F with no isolated vertices, t(F, Wn ) converges to t(F, W).
Proof. By the definition of δ2→2 , if F is an edge, then t(F, Wn ) → t(F, W). This
implies in particular that kWk1 and kWn k1 are uniformly bounded. By Lemma 6.1,
it follows that t(F, Wn ) → t(F, W) for any connected graph F . Since homomorphism
densities factor over connected components of the graph F , this means that if F is
a finite graph without isolated vertices, then t(F, Wn ) → t(F, W).

In a addition to the above counting lemma, we will need to show that convergence
of subgraph counts implies GP-convergence. Thinking of the subgraph counts as
the moments of a graphex, this result is similar to standard moment theorems for
random variables that show that under suitable growth conditions, the distribution
of a random variable is determined by its moments.
Theorem 6.3. Assume that the marginals of Wn and W are bounded by some finite
constant D. Then the following are equivalent:
(1) GT (Wn ) → GT (W) in distribution for every T .
(2) GT (Wn ) → GT (W) in distribution for some T .
(3) For every graph F with no isolated vertices, t(F, Wn ) → t(F, W).
(4) For every connected graph F , t(F, Wn ) → t(F, W).
We will prove the counting lemma in Subsection 6.1 below, and Theorem 6.3 in
Subsection 6.2. In the final subsection, Subsection 6.3, we use these results to first
show that under the assumption of uniformly bounded marginals, δ2→2 -convergence
implies GP-convergence (Theorem 6.16 below). With the help of the results about
tightness established in Section 4, this in turn allows us to show that without any
assumption on the marginals, δ -convergence implies GP-convergence (Theorem 6.17
below).
6.1. Proof of the counting lemma. In order to prove the counting lemma, it
will be convenient to consider several variants of the homomorphism densities. For
these variants, it will be natural to consider signed graphexes, since we will need to
consider differences of graphexes for the proof of the counting lemma anyway. Note
that our proof of the counting lemma can easily be generalized to signed graphons;
see Remark 6.9 below.

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

61

Definition 6.4. Suppose we have a connected multigraph F , and signed graphexes
We assigned to each edge e ∈ E(F ) (refer to this vector of graphexes as WF ), each
with the same feature space Ω. Let V≥2 be the set of vertices with degree at least 2.
If V≥2 is nonempty (i.e., F does not consist of a single edge), then we define
Z
Y
t(F, WF ) =
dzV≥2
W{v,w} (zv , zw )
V≥2

Ω

{v,w}∈E(F (V≥2 ))

·

Y

Y

DW{v,w} (zv ).

v∈V≥2 w∈V \V≥2 :
{v,w}∈E(F )

If F consists of just a single edge f , then
t(F, WF ) = ρ(Wf ),
with ρ(Wf ) as in (2.2). Note that for signed graphexes t(F, WF ) is in general only
well defined if the integrals are absolutely convergent, a condition which can, e.g.,
abs
be guaranteed by requiring that t(F, Wabs
F ) < ∞, where WF is obtained from WF
by replacing the graphexes Wf by |Wf |.
Note that t(F, WF ) is a multilinear function of the signed graphexes We in WF .
If each We is equal to some fixed W, then this is just the previous definition.
We also define a conditional density where we fix the image of a single vertex.
Definition 6.5. Suppose we have a connected multigraph F with a labeled vertex
v0 , more than one edge, and signed graphexes We assigned to each edge as before. Let
0
x ∈ Ω, and define zv0 = x. Take, furthermore, V≥2
= V≥2 \{v0 } and Ve≥2 = V≥2 ∪{v0 }.
Then we define tx (F, WF ) to be
Z
Y
Y
Y
0
dz
W
(z
,
z
)
DW{v,w} (zv ).
v
w
V
{v,w}
0
≥2
V
Ω

≥2

e≥2 ))
{v,w}∈E(F (V

v∈V≥2 w∈V \(V
e≥2 ):
{v,w}∈E(F )

If F consists of just a single edge f adjacent to v0 , then we set tx (F, W) = DW (x).
Again, for signed graphexes, this is in general only well defined if the integrals are
absolutely convergent.
Note that if v0 ∈ V≥2 , then tx (F, WF ) is obtained from t(F, WF R) by simply fixing
the feature corresponding to v0 to be x, implying in particular that tx (F, WF ) dx =
t(F, WF ) (assuming the integrals defining these are absolutely convergent). If
v0 ∈
/ V≥2 , i.e., if v0 has degree 1, and if F has more than one edge, then the situation
is slightly more complicated, since the “feature” of the image of v0 could be either
an element of Ω, or the special value ∞, interpreted earlier as the feature of the
leaves of the star part of a graphon process. With this reinterpretation, tx (F, WF )
is still obtained
R from t(F, WF ) by fixing the feature corresponding to v0 to be x, but
the integral tx (F, WF ) dx now misses the contribution of x = ∞, and hence is in
general only bounded above by t(F, WF ). It is, however, equal to t(F, W0F ), where
W0F is obtained from WF by setting the star part of the graphex corresponding to
the edge containing v0 to 0.
Lemma 6.6. Suppose F is a connected multigraph with no loops and a labeled
vertex v0 , T is a spanning tree, and We is a signed graphex corresponding to each

62

BORGS, CHAYES, COHN, AND LOVÁSZ

edge e, each with the same feature space Ω. Let f ∈ T be an edge adjacent to v0 ,
and x ∈ Ω. Then
Y
Y
|tx (F, WF )| ≤ D|Wf | (x)
kD|We | k∞
kWe k∞ .
e∈T \f

e∈E(F )\T

Proof. Replacing all signed graphexes We by the non-negative versions |We |, and
noting that |tx (F, WF )| ≤ tx (F, Wabs
F ), we may without loss of generality assume
that We and Se are non-negative.
Next, assume that F is a tree, i.e., F = T . We then prove the claim by
induction on the number of edges. If F consists of a single edge, then by definition
tx (F, W) = DW (x), which is exactly the bound in the lemma. Otherwise, we can
find an edge {v, w} not equal to f , such that v has degree at least two, and w has
degree 1 and is different from v0 . The edge {v, w} then contributes DW{v,w} (zv ) to
the second product in the integral representing tx (F, WF ). For each zv , this is at
most kDW{v,w} k∞ . Taking a factor kDW{v,w} k∞ out of the integral, and defining F 0
to be the restriction of F to V (F ) \ {w}, we therefore have that
tx (F, WF ) ≤ kDW{v,w} k∞ tx (F 0 , WF 0 ).
Note that this bound is actually weaker than necessary if the vertex v becomes a
vertex of degree one in F 0 , in which case we could have obtained a contribution of
DW{v,v0 } (zv0 ) for its neighbor v 0 instead of the contribution DW{v,v0 } (zv0 ) implicit in
the above bound.
Suppose now that F has edges outside T . Let {v, w} be such an edge. Note that
both v and w must be in V≥2 . Therefore, this edge contributes W{v,w} (zv , zw ) to
the product, which is at most kW{v,w} k∞ . We can therefore conclude the lemma by
induction on the number of edges of F outside T .

Lemma 6.7. Suppose F is a connected multigraph with no loops, and we have a
signed graphex We corresponding to each edge e ∈ F . Let T be any spanning tree in
F , and f ∈ T . Then
Y
Y
|t(F, WF )| ≤ kWf k1
kD|We | k∞
kWe k∞ .
e∈T \f

e∈E(F )\T

Proof. If F consists of a single edge f , then |t(F, WF )| = |ρ(Wf )| ≤ kWf k1 by
definition, and if F has more than one edge, then
Z
|t(F, WF )| ≤
|tx (F, WF )| dµ(x)
ZΩ
Y
Y
≤
D|Wf | (x)
kD|We | k∞
kWe k∞ dµ(x)
Ω

≤ kWf k1

e∈T \f

Y
e∈T \f

kD|We | k∞

e∈E(F )\T

Y

kWe k∞ .



e∈E(F )\T

Proof of Lemma 6.1. Let f = {u, v} be an edge in F , and let WF,f be a vector of
graphexes where we assign one of W1 or W2 to each edge e 6= f , and (W1 − W2 , S1 −
S2 , 0, Ω) to f (since F is a connected graph with at least 2 edges, the dust parts
of W1 and W2 don’t contribute to t(F, W1 ) − t(F, W2 ) and can be set to 0). We
would like to bound |t(F, WF,f )|.
First, assume both endpoints of f have degree at least 2. Let the components
of F restricted to V (F ) \ {u, v} be C1 , C2 , . . . , Ck , with corresponding vertex sets

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

63

V1 , . . . , Vk . There can be three types of components: those with at least one edge to
u but none to v, those with at least one edge to v but none to u, and those with at
least one edge to both. Let Cu be the set of components connected to u, Cv the set
of those connected to v, and Cuv the set connected to both. For each i ∈ Cu , let Fi
be the labeled graph where we add u back to Ci as the labeled vertex, and for each
i ∈ Cy , let Fi be the labeled graph where we add v back to Ci as the labeled vertex.
Furthermore, for each i ∈ Cu ∪ Cv , choose an additional vertex vi ∈ Vi such that vi
is incident to an edge in Fi . Let Vuv consist of vertices that belong to a component
in Cuv .
Given a set of vertices U , let U 0 be the set of vertices in U that have degree at
least 2 in F , and let
Y
WF,U,u (zu , zU 0 ) =
W{u,w} (zu , zw )
w∈U 0
{u,w}∈E(F )

and
Y

WF,U,v (zv , zU 0 ) =

W{v,w} (zv , zw ).

w∈U 0
{v,w}∈E(F )

Let us also use the notation
Y
WF,U (zU 0 ) =

W{w,w0 } (zw , zw0 )

Y

w∈U 0

{w,w0 }∈E(F (U 0 ))

Y
0

DW{w,w0 } (zw ).
0

w ∈U \U
{w,w0 }∈E(F )

0
Observe that if a vertex in Vuv is adjacent to u or v, it must be in Vuv
. We therefore
express t(F, WF,f ) as

Z

Z
0

ΩVuv

0 )
WF,Vuv (zVuv

Ω2

0 )WF,V
0 )Wf (zu , zv )
WF,Vuv ,v (zv , zVuv
(zu , zVuv
uv ,u

!
Y
i∈Cu

tzu (Fi , WF,f )

Y

tzv (Fi , WF,f ) ,

i∈Cv

and bound the inner integral by




Y


0 )
t· (Fi , WF,f )
WF,Vuv ,u (·, zVuv


i∈Cu
2




Y


0 )
t· (Fi , WF,f ) kWf k2→2
WF,Vuv ,v (·, zVuv


i∈Cv
2




Y


0 )
≤ WF,Vuv ,u (·, zVuv
DWuvi 


i∈Cu
2




Y
Y


0 )
DWvvi  kWf k2→2
WF,Vuv ,v (·, zVuv


i∈Cv

2

D|Vi |−1 ,

i∈Cv ∪Cu

where in the last step we used Lemma 6.6 and the fact that the number of edges
in a spanning tree for Fi is |V (Fi )| − 1 = |Vi |. Inserting this bound into the outer

64

BORGS, CHAYES, COHN, AND LOVÁSZ

integral, an application of the Cauchy-Schwartz inequality then gives the bound
v
2

uZ


Y
u


0 )
0 ) WF,V
D
t(F, WF,f ) ≤ kWf k2→2 t
(·,
z
W
(z

W
,u
V
F,V
V
uv
uv
uv
uv
uv
i
0
Vuv


Ω
i∈Cu
2
v

2
uZ


Y
Y
u


0 ) WF,V
0 )
·t
W
(z
(·,
z
D
D|Vi |−1

F,V
V
,v
V
W
uv
uv
vv
uv
uv
i
0
Vuv

Ω
2 i∈Cv ∪Cu

i∈Cv

We claim that the expressions under the square roots can be written as t(Fu0 , WF,f )
and t(Fv0 , WF,f ) for some suitable multigraphs Fu0 and Fv0 . Indeed, starting from
F (Vuv ∪ {u}), we first duplicate every edge in this graph that joins u to some vertex
in Vuv , keeping the edges between vertices in Vuv as simple edges. The graph Fu0
is obtained from this graph by adding two more edges for each component i ∈ Cu :
the edge uvi , and a second edge uvi0 , with vi0 being a new vertex we should think of
as a twin of vi (in Fu0 , they both have degree one and are connected to u). This
gives a connected multigraph on Vu0 = V (Fu0 ) with |Vuv | + 1 + 2ku many vertices and
|E(F (Vuv ))| + 2du + 2ku many edges where du is the number of vertices v 0 ∈ Vuv
such that uv 0 is an edge in F , and ku = |Cu |. Define Fv0 (as well as dv and kv )
analogously. We then can reexpress the above bound as
q
Y
t(F, WF,f ) ≤ kWf k2→2 t(Fu0 , WF,f )t(Fv0 , WF,f )
D|Vi |−1
i∈Cv ∪Cu

≤ kWf k2→2 CD|Vuv |+ku +kv −1

Y

D|Vi |−1

i∈Cv ∪Cu

= kWf k2→2 CDn−3 .
If f has one endpoint with degree 1, and the other endpoint with degree at least
2, then let v be the endpoint with degree at least 2, and let u0 6= u be a neighbor of
v. Let WF −f be the graphex assignment restricted to the edges in F − f . Then

Z


|t(F, WF,f )| = 
txv (F − f, WF −f )DW1 −W2 (xv ) dµ(xv )
Ω

≤ kDW1 −W2 k2 kt· (F − f, WF −f )k2
√
≤ kDW1 −W2 k2 kDWvu0 k2 Dn−3 ≤ CDDn−3 kDW1 −W2 k2 .
Now, let e1 , e2 , . . . , em be the edges of F . Let WF,i be the vector of graphexes where
we assign W1 − W2 to ei , W1 to ej with j < i, and W2 to ej with j > i. Then,
m 

 X





e n−3 .

t(F, W1 ) − t(F, W2 ) ≤
t(F, WF,i ) ≤ mεCD
i=1

Remark 6.8. It is instructive to note that the bound in Lemma 6.1 can be tightened
to give the constant
e = max max{kWi k2 , kDW k2 }
C
i
i
√
e = max{C, CD}. To see this, we first note that near the
instead of the constant C
√
end of the proof, we bounded kDWvu0 k2 by CD, even though it is possible that
the first term is finite while the second is infinite. In a similar way, bounding the
integral representing t(Fu0 , WF,f ) and t(Fv0 , WF,f ) with the help of Lemma 6.7 is
suboptimal. Indeed, the multi-graph Fv0 always contains at least one double edge,

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

65

or contain at least one edge uvi and its twin uvi0 , with both vi and vi0 having degree
one. In the first case, Lemma 6.7 can be improved to extract a factor kWf k2 instead
of a factor kWf k1 , in the second it can be improved to extract a factor kDWf k2 .
Inserted into the proof of Lemma 6.1, this gives the claimed improvement.
Remark 6.9. As the reader can easily verify, the above proof immediately generalizes
to signed graphexes, showing that Lemma 6.1 holds for (B, C, D) bounded graphexes,
provided we include a factor of B m−(n−1) on the right side. As a consequence,
Corollary 6.2 holds for sequences of (B, C, D)-bounded graphexes that converge in
the kernel distance δ2→2 .
6.2. GP-convergence and subgraph counts. In this subsection, we prove Theorem 6.3. We start by establishing the following theorem.
Theorem 6.10. Let G and Gn , for n ≥ 1, be random finite graphs with no isolated
vertices, and let X and Xn , for n ≥ 1, be the random variables that correspond to
the number of vertices in G and Gn , respectively. If, for every t > 0, E[etX ] and
E[etXn ] are finite and uniformly bounded, then the following are equivalent:
(1) For any graph G, the probability that Gn is isomorphic to G converges to
the probability that G is isomorphic to G.
(2) For every graph F , E[inj(F, Gn )] → E[inj(F, G)].
(3) For every graph F with no isolated vertices, E[inj(F, Gn )] → E[inj(F, G)].
To prove the theorem, we will first establish a couple of lemmas. As a preparation,
note that if E[etX ] ≤ C, then for any graph F on k vertices,
∞
∞
X
X
k!
k!
E[inj(F, G)] ≤
P (X = n)nk ≤
P (X = n) k etn = k E[etX ] ≤ C 0 .
t
t
n=0
n=0
k

Here we use the fact that etn ≥ (tn)
k! . The same bound holds for Gn . In other words,
for any graph F the values E[inj(F, Gn )] and E[inj(F, G)] are bounded uniformly in
n.
Our first lemma roughly says that if a random graph model does not have isolated
vertices, and the number of vertices is not too large with high probability, then the
expected number of counts of finite graphs without isolated vertices determines the
expected number of counts of all graphs.
Lemma 6.11. Suppose we have two random finite graphs with no isolated vertices, G
and G0 . Suppose that for every finite graph F with no isolated vertices, E[inj(F, G)] =
E[inj(F, G0 )]. Let X be the random variable that gives the number of vertices in G,
and suppose that for every t, E[etX ] is finite. Then E[inj(F, G)] and E[inj(F, G0 )]
are equal for every finite graph F .
Proof. We prove this by induction on the number of isolated vertices in F . If
F has zero isolated vertices, the claim is true by the assumptions of the lemma.
Otherwise, let F consist of F 0 plus an isolated vertex w0 . For every k, and graph
G, let inj∗ (F 0 , k, G) be equal to the number of ways we can take an injective image
of F 0 in G, take a vertex v0 not in the image of F 0 , and take a k-term sequence of
distinct neighbors of v0 (which may or may not be in the image of F 0 ). If G has no
isolated vertices, then
∞
X
(−1)k−1 ∗ 0
inj(F, G) =
inj (F , k, G).
k!
k=1

66

BORGS, CHAYES, COHN, AND LOVÁSZ

This follows from the fact that for each injective copy of F , if v0 is the image of w0 ,
then this contributes (d(v0 ))k to inj∗ (F 0 , k, G). Since G is finite and has no isolated
vertices, we must have 0 < d(v0 ) < ∞; therefore,
∞
X
(−1)k−1

k!

k=1

d(v0 )

(d(v0 ))k =

X

(−1)k−1

k=1



d(v0 )
= 1.
k

Next, we claim that
E[inj(F, G)] =

∞
X
(−1)k−1

k!

k=1

E[inj∗ (F 0 , k, G)].

To show this, it suffices to show that
∞
X
E[inj∗ (F 0 , k, G)]
k=1

k!

< ∞.

Fix k. Then inj∗ (F 0 , k, G) is the sum of terms of the form inj(F 00 , G). The terms
are obtained as follows. Let L = V (F 0 ) ∪ z0 , where z0 is disjoint from V (F 0 ). Let
` = (`1 , `2 , . . . , `k ) be a sequence of k elements of L. Suppose further that any vertex
in V (F 0 ) appears at most once in `. Then we define F 00 (`) by taking a copy of F 0 , a
disjoint vertex w0 , for each `i ∈ V (F 0 ), we add an edge from w0 to `i , for each other
`i we add an edge going to a new vertex. For example, if ` = (z0 , z0 , z0 , . . . , z0 ),
then F 00 (`) is the disjoint union of F 0 and a star with k edges. It is then not difficult
to see that
X
inj∗ (F 0 , k, G) =
inj(F 00 (`), G).
`

Let a = |L|. For each k, the number of such sequences is at most ak . Furthermore,
for each such F 00 (`), the number of vertices is at most a + k. Thus,
inj∗ (F 0 , k, G) ≤ ak (|V (G)|)(a+k) .
Therefore, recalling that X = |G|, we have that
∞
X
E[inj∗ (F 0 , k, G)]

k!

k=1

=

∞
X
k=1

≤

∞
X
ak E[(X)(a+k) ]

k!
k=1





X −a
E ak X(a)
= E X(a) (a + 1)X−a < ∞.
k

Finally, we claim that E[inj∗ (F 0 , k, G)] = E[inj∗ (F 0 , k, G0 )] for every k. This
follows from the fact that the graphs F 00 (`) above each have fewer isolated vertices
than F , so E[inj(F 00 (`), G)] = E[inj(F 00 (`), G0 )] for each F 00 (`), and inj∗ (F 0 , k, G)
and inj∗ (F 0 , k, G0 ) are each a finite sum of such terms. Therefore, for G0 ,
∞
X
E[inj∗ (F 0 , k, G0 )]
k=1

k!

< ∞.

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

67

We therefore have
E[inj(F, G)] =
=

∞
X
(−1)k−1
k=1
∞
X
k=1

k!

E[inj∗ (F 0 , k, G)]

(−1)k−1
E[inj∗ (F 0 , k, G0 )] = E[inj(F, G0 )].
k!



Lemma 6.12. Suppose we have two random finite graphs, G and G0 . Suppose
that for every finite graph F , E[inj(F, G)] = E[inj(F, G0 )]. Let X be the random
variable that gives the number of vertices in G, and suppose that for some ε > 0,
E[(2 + ε)X ] is finite. Then G and G0 give rise to the same distribution on graphs
(up to isomorphism).
We would like to emphasize that in these two lemmas, it suffices to assume the
finiteness condition for G, not G0 (for which it follows).
Proof. For graphs F and G, let X(F, G) be equal to the random variable which is
equal to inj(F, G) if G has the same number of vertices as F , and gives 0 otherwise.
Fix a graph F with k vertices, and let Fi be the graph obtained by adding i isolated
vertices to F . We can then write
∞
X
(−1)i
inj(Fi , G).
X(F, G) =
i!
i=0
Indeed, if G has the same number of vertices as F , then each term with i > 0 is
zero, and the i = 0 term gives inj(F0 , G) = inj(F, G). If G has fewer vertices, then
the entire expression is zero. If G has k + ` vertices where ` > 0, then each injective
copy of G contributes (since `i = 0 if i > `)
 
`
X
i `
(−1)
= 0;
i
i=0
therefore the entire expression is 0. Next, we claim that
∞
X
E[inj(Fi , G)]

i!

i=0

< ∞.

To see this, note that for every i,
E[inj(Fi , G)] ≤

X

P(X = n)(n)k+i .

n

By the condition on X, there exists an ε > 0 and c such that P(X = n) ≤ c(2 + ε)−n .
Therefore,


∞
X
n−k
E[inj(Fi , G)] X X
−n
≤
c(2 + ε) (n)k
i!
i
n
i=0
i
X
=
c(2 + ε)−n 2n−k (n)k < ∞.
n

We therefore have that
∞
∞
X
X
(−1)i
(−1)i
E[X(F, G)] =
E[inj(Fi , G)] =
E[inj(Fi , G0 )] = E[X(F, G0 )].
i!
i!
i=0
i=0

68

BORGS, CHAYES, COHN, AND LOVÁSZ

Thus, by an inclusion-exclusion formula, we can express the probability that G and
G0 is isomorphic to a graph F for any F , and the two probabilities must also be
equal. This completes the proof.

Proof of Theorem 6.10. We first show that (1) implies (2). Recall that for any
graph F , E[inj(F, Gn )] and E[inj(F, G)] are uniformly bounded. Fix a graph F on
k vertices. We claim that E[inj(F, Gn )2 ] and E[inj(F, G)2 ] are uniformly bounded.
This follows
that for a graph G, inj(F, G)2 is a linear combination of
P from the fact
0
0
the form F 0 cF inj(F , G), where cF 0 is independent of G and zero for all but a
finite number of graphs F 0 . We also know that inj(F, Gn ) converges to inj(F, G) in
distribution. Since their second moments are uniformly bounded, their expectations
must converge as well.
It is clear that (2) implies (3). Let us show that (3) implies (1). Assume Gn
satisfies (3). We first claim that the sequence Gn is tight. That is, we claim that for
every ε, there exists a finite set of graphs such that for each n, with probability at
least 1 − ε, Gn is in this set. Indeed, the expected number of edges E[inj(K2 , Gn )]
is uniformly bounded, which means that for any ε, there exists an M such that the
probability of having more than M edges is at most ε. But the number of graphs
with M edges and no isolated vertices is finite; therefore Gn is tight.
This means that there is a subsequence that converges to a random graph H in
the sense of (1), which also has no isolated vertices. First, we claim that for any
F with no isolated vertices, E[inj(F, H)] is finite, and E[inj(F, Gn )] converges to
it. This again follows from the fact that E[inj(F, Gn )2 ] is uniformly bounded. But
then this implies that E[inj(F, H)] = E[inj(F, G)] for every graph F with no isolated
vertices. Therefore, the two distributions are equal by Lemmas 6.11 and 6.12. 
Lemma 6.13. Given t > 0, let t0 = 2t + log 4. Then the following holds for any
positive integer n and any graph G on n vertices with no isolated vertices. Suppose
we randomly color the vertices red and blue, and let X be the number of vertices
that are colored red, and have at least one blue neighbor. Then
0

E[et X ] ≥ etn .
Proof. Without loss of generality, we may assume G is the disjoint union of stars,
since otherwise we can delete an edge and G will still have no isolated vertices.
Suppose that G P
is the disjoint union of stars with edge count s1 , s2 , . . . , sk , where
each si ≥ 1 and i si = n − k. Note that k ≤ n/2. Then
!sk
!!
k
h 0 i Y
t0
t0
sk
1
e
+
1
1
e
+
2
−
1
E et X =
+
2
2
2
2sk
i=1
!n−k
0
0
et + 1
≥
2−k ≥ (et + 1)n/2 2−n ≥ etn ,
2
0

given that our choice of t0 implies that (et + 1)/4 ≥ e2t .



Lemma 6.14. For any T, t, C, D ∈ R+ , there exists a finite B such that the
following holds. Suppose we have a graphex W, with kDW k∞ ≤ D and kWk1 ≤ C.
Let X be the number of vertices (that are not isolated) of GT (W). Then E[etX ] ≤ B.
Proof. Note that since X is nonnegative, we only need to worry about t > 0. First,
let X 0 be obtained by randomly coloring the vertices of GT red and blue, and

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

69

taking the red vertices with at least one blue neighbor. By the above lemma, for
t0 = 2t + log 4 > 0, we have
0
0
E[et X ] ≥ E[etX ].
We claim that
 Z 


0
0
t0
t0
T 2I
T
T
(6.1)
E[et X ] ≤ e 2 (e −1) exp
e 2 DW (x)(e −1) − 1 dµ(x) .
2 Ω
Let us show how this implies uniform boundedness. We know that DW is bounded
by D. Since the function z → ez − 1 is 0 at z = 0 and convex, there exists a constant
K depending only on t0 , T , and D such that
T

e 2 DW (x)(e

t0

−1)

−1≤

DW (x) T D(et0 −1)
e2
= KDW (x).
D

Therefore,
T 2 I t0
T
(e − 1)+
2
2

Z 

t0


− 1 dµ(x)
Ω
Z
T 2 I t0
T
≤
(e − 1) +
KDW (x) dµ(x)
2
2 Ω
T 2 C t0
KT C
≤
(e − 1) +
.
4
2
In order to prove (6.1), we first show that it is enough to consider the case where
µ(Ω) < ∞. To see S
this, we write a general σ-finite measure space as the union of
finite spaces, Ω = n Ωn where Ωn is an increasing sequence with µ(Ωn ) < ∞ for
all n. For a fixed T , let GT,n consist of the induced graph on those vertices which
were born in Ωn , come from a star of a vertex born in Ωn , or come from a dust
edge, and define Xn0 to be the number of red vertices in GT,n with at least one
blue neighbor in GT,n . It is easy to see that 0 ≤ X10 ≤ X20 ≤ · · · ≤ Xn0 ≤ . . . . By
0
0
0
0
monotone convergence, the expectation of et Xn converges to E[et X ]. The bound
0
0
we obtain also converges, giving the required bound on E[et X ].
Assume thus that µ(Ω) < ∞. In this case, almost surely, a finite number of blue
points will be created. Suppose that these are x1 , x2 , . . . , xk . Conditioned on this,
red vertices that have blue neighbors can be created as follows. They can be created
by the Poisson process on Ω, and then be connected to at least one of the xi . If
a point isQcreated at x, the probability that it is connected to at least one of the
xi is 1 − (1 − W (xi , x)). It can also be created as a leaf of a star created at one
of the xi . Finally, it can be created by a dust edge being colored red and blue.
Since the number of red vertices coming from each of these cases is independent,
the number of red vertices with at least one blue neighbor is a Poisson distribution
with expectation
!
Z
k
k
Y
T X
T
T 2I
f (x1 , . . . , xk ) :=
1−
(1 − W (xi , x)) dµ(x) +
S(xi ) +
2 Ω
2 i=1
2
i=1
!
Z
k
k
X
T
T X
T 2I
≤
W (xi , x) dµ(x) +
S(xi ) +
2 Ω i=1
2 i=1
2
=

T

e 2 DW (x)(e

k
T X
T 2I
DW (xi ) +
.
2 i=1
2

−1)

70

BORGS, CHAYES, COHN, AND LOVÁSZ

In particular, this means that (for t0 > 0) we have
0

0

E[et X |x1 , x2 , . . . , xk ] = ef (x1 ,...,xk )(e

t0

−1)

Pk

≤ e 2 (T I+
T

i=1

0

DW (xi ))(et −1)

.

Therefore
0

0

∞
X

Z
t0
(T /2)k µ(Ω)k 1
ef (x1 ,x2 ,...,xk )(e −1) dµ(x1 ) . . . dµ(xk )
k
k!
µ(Ω) Ωk
k=0
Z
∞
Pk
X
t0
T
T
(T /2)k
≤
e− 2 µ(Ω)
e 2 (T I+ i=1 DW (xi ))(e −1) dµ(x1 ) . . . dµ(xk )
k!
Ωk
k=0
Z
k
∞
X T
t0
t0
T 2I
T
(T /2)k
e− 2 µ(Ω)
= e 2 (e −1)
e 2 DW (x)(e −1) dµ(x) .
k!
Ω

E[et X ] =

T

e− 2 µ(Ω)

k=0

0

Here we think of Ω as consisting of a single point on which f is 0. We then have
0

0

E[et X ] ≤ e
=e

T 2I
2

T 2I
2

0

(et −1)
t0

(e −1)

T

e2
e

T
2

T

R
Ω

e 2 DW (x)(e


R
Ω

T

t0 −1)

dµ(x)− T2 µ(Ω)

t0 −1)

e 2 DW (x)(e


−1

dµ(x)

.

So we know that (6.1) is true for any Ω with finite measure. This completes the
proof of the lemma.

After these preparations, the proof of Theorem 6.3 is straightforward.
Proof of Theorem 6.3. We first note that it is enough to prove the lemma for the
case that Wn and W are (C, D)-bounded for some finite C, D < ∞. Indeed, both
(3) and (4) clearly imply a bound on the k · k1 -norm, but also (2) (and therefore (1))
does, since (2) implies that the random graphs GT (Wn ) are tight, which implies that
the set of graphexes is tight, which by Corollary 4.2 (2) implies uniform boundedness
of the k · k1 -norms.
Assume thus that Wn and W are (C, D)-bounded for some finite C, D < ∞.
The equivalence of (3) and (4) follows from the fact that t is multiplicative over
components of F . (1) ⇒ (2) is obvious. Using Lemma 6.14, we can apply the
equivalence in Theorem 6.10 and Proposition 3.24 to show that (2) ⇒ (3) and
(3) ⇒ (1).

A slight modification of the above proof gives the following theorem.
Theorem 6.15. Given two graphexes W, W0 with bounded marginals, the following
are equivalent:
(1) GT (W) and GT (W0 ) have the same distribution for every T .
(2) GT (W) and GT (W0 ) have the same distribution for some T .
(3) For every graph F with no isolated vertices, t(F, W) = t(F, W0 ).
(4) For every connected graph F , t(F, W) = t(F, W0 ).
Proof. As before, the equivalence of (4) and (3) follows from the product property
of t. The implication (1) ⇒ (2) is obvious. To prove (2) ⇒ (3), we use the
fact that t(F, W) = T −|V (F )| E[inj(F, GT (W))] and the same holds for W0 . Since
inj(F, GT (W)) and inj(F, GT (W0 )) have the same distribution, their expectations
must be equal. With the help of Proposition 3.24, this implies (3). (3) ⇒ (1) follows
from Proposition 3.24, the observation that graphexes with bounded marginals are
integrable, and Lemmas 6.14, 6.11, and 6.12.


IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

71

6.3. Metric convergence implies GP-convergence. We close this section by
proving that under the assumption of uniformly bounded marginals, δ2→2 -convergence
implies GP-convergence. We then use this result to show that without any assumptions on the marginals, δ -convergence implies GP-convergence.
Theorem 6.16. Suppose Wn and W have uniformly bounded marginals, and
δ2→2 (Wn , W) → 0. Then Wn is GP-convergent to W.
Proof. Note that δ2→2 convergence implies that kWn k1 → kWk; therefore the
sequence is (C, D)-bounded for some C, D. If F is a graph without isolated vertices,
then t(F, Wn ) → t(F, W) by Corollary 6.2. Therefore, by Theorem 6.3, for any T ,
GT (Wn ) converges to GT (W) in distribution.

Theorem 6.17. Suppose that graphexes W and (Wn )∞
n=1 have the property that
δ (Wn , W) → 0. Then Wn is GP-convergent to W.
Proof. By Proposition 4.6, the sequence is tight, and for all D such that µ({DW =
D}) = 0, we have that µn (Ωn,>D ) → µ(Ω>D ) and δ2→2 (Wn,≤D , W≤D ) → 0.
Fix T and ε > 0, and take δ small enough so that for all sets Ωδ of measure
at most δ the probability that any of the vertices in GT has a feature in Ωδ is at
most ε/3. Take D large enough so that for all n, µn (Ωn,>D ) and µ(Ω>D ) are at
most δ. Then the total variation distance between GT (Wn,≤D ) and GT (Wn ) is
at most ε/3, and the same is true for GT (W≤D ) and GT (W). We also know that
δ2→2 (Wn,≤D , W≤D ) → 0, which in particular implies that the sequence is uniformly
(C, D)-bounded for some C. Therefore, it is GP-convergent. In particular, for n
large enough, the total variation distance between GT (Wn,≤D ) and GT (W≤D ) is
at most ε/3. This implies that for n large enough, the total variation distance
between GT (Wn ) and GT (W) is at most ε, which shows that the sequence is
GP-convergent.

7. Sampling
In this section, we prove that GP-convergence implies convergence in the weak
kernel metric, completing the proof of the equivalence of convergence in the metric
δ and GP-convergence (Theorem 2.18). The main technical tool to establish this
will be a “sampling lemma”, showing that as T → ∞, the graphs GT (W) sampled
from a graphex W converge to the generating graphex according to δ .
To make this precise, we need a way to compare graphs to graphexes. As in [3]
and [4], we do this by transforming the graph into a suitable “empirical graphon”
and corresponding “empirical graphex”. Differing slightly from both [3] and [4],
where the empirical graphon was a graphon over R+ , here we define it to be a
graphon over the vertex set of the graph. Explicitly, given a finite graph G and
ρ > 0, we define the graphon W (G, ρ) as follows. Let Ω = (Ω, F, µ), where Ω is the
set of vertices, F is the σ-algebra consisting of all subsets, and µ is the measure
where each vertex has weight ρ. Set W (x, y) to be 1 if there is an edge between the
corresponding vertices, and 0 otherwise. This gives us the graphon W (G, ρ). We
then set W(G, ρ) = (W, 0, 0, Ω). Similarly, if H is a weighted graph with countably
many vertices, we define Ω to be the set of vertices, F to be the σ-algebra consisting
of all subsets of Ω, and µ to be the σ-finite measure which gives weight ρ to each
vertex; W (H, ρ) and W(H, ρ) are then the graphon and graphex obtained by taking
W according to edge weights.
With these definitions, we are ready to state the sampling lemma.

72

BORGS, CHAYES, COHN, AND LOVÁSZ

Theorem 7.1. For every graphex W and ε > 0,
lim P[δ (W(GT (W), 1/T ), W) > ε] = 0.

T →∞

For a set of graphexes that is tight, the convergence is uniform.
Remark 7.2. The above theorem only claims convergence in probability. However,
once we establish equivalence of GP-convergence and convergence in the weak
kernel norm, the results of [18] imply convergence with probability one (since there
convergence with probability one is proved for GP-convergence). Nevertheless, to
establish the equivalence, all we need is convergence in probability, so this is all we
will prove here.
7.1. Closeness of graphexes implies closeness of samples. In order to prove
the sampling lemma, we will first prove that two graphexes with bounded marginals
that are close in the kernel metric lead to samples that are close. This is formalized
in the following theorem.
Theorem 7.3. Suppose W1 , W2 are two (C, D)-bounded graphexes on the same
space Ω, and suppose that d2→2 (W1 , W2 ) ≤ c for some 0 < c < 1. Then there exists
a T0 (depending only on c, C, and D) such that for any T > T0 , there exists a
coupling of the random graphs GT (W1 ) and GT (W2 ) so that
h

i
√
3
P δ2→2 (W(GT (W1 ), 1/T ), W(GT (W2 ), 1/T )) > min (31cC)1/4 , 2c3/4 , 3c < c.
For graphons, or graphexes with only a graphon part, we can think of obtaining
GT as having two phases: first we sample the set of vertices, and then we sample the
edges according to the edge probability. If we do not do the second phase, we obtain
a weighted graph. We will work with this intermediate graph in this section. To
make this precise, given a graphon (W, Ω), define HT (W ) as the random weighted
graph where we take a Poisson process on Ω × [0, T ], set these to be the vertices of
HT (W ), and for each pair of vertices (xi , ti ) and (xj , tj ), put a weighted edge with
weight W (xi , xj ) (with 0 weights on the diagonals).
In order to prove the theorem, we need to find a coupling of the random processes
that provide GT (W1 ) and GT (W2 ). Since W1 and W2 have the same underlying
space, it is natural to couple the Poisson processes that generate the vertices into a
single Poisson process. Conditioned on this, we generate the two random graphs
independently (this is not optimal but it is satisfactory for our purposes). Let
W0i = Wi (GT (Wi ), 1/T ) = (Wi0 , Si0 , Ii0 , Ω0i ). The underlying space of W0i consists of
the vertex set of GT (Wi ), everything with weight 1/T . We couple the two underlying
spaces by matching vertices that correspond to the same point in Ω, and couple the
other vertices arbitrarily (adding points with degree 0 if necessary). We will show
that in this way, all three components of our distance will be close
Let us first show that kW10 − W20 k2→2 is small, with high probability. Note that
GT (W) consists of the edges in GT (W ), and the edges generated by the stars and the
independent edges. In the following lemma, we show that the extra edges generated
have a small effect on this distance
Lemma 7.4. Let W = (W, S, I, Ω) be a (C, D)-bounded graphex, and T > 1/D.
e T (W) consist of only those
Let GT (W) be the usual sample at time T , and let G

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

73

edges which come from I or S. Then
"
1/4 #

2CD
1
e T (W), 1/T )k2→2 > √
P kW (G
<√ .
T
T
Proof. Suppose we have sampled stars with s1 , s2 , . . . , s` leaves, and we have sampled
e T (W), 1/T ). Then
m isolated edges. Let U = W (G
!
X
1
2
t(C4 , U ) = 4 2
si + 2m .
T
i
Therefore,
(T 2 S(x)2 + T S(x)) dµ(x) 2T 2 I
C(D + 1/T )
2CD
+
≤
≤
,
4
4
T
T
T
T
and hence


2CD
1
√
P t(C4 , U ) >
<√ .
T
T
Using the fact that kU k2→2 ≤ t(C4 , U )1/4 (Lemma 3.18), the lemma follows.

E[t(C4 , U )] =

2T

R

Ω

This lemma implies that for the 2 → 2 component of the distance, we can compare
GT (W1 ) and GT (W2 ) instead of GT (W1 ) and GT (W2 ). The following lemma will
imply that it in fact suffices to compare HT (W1 ) and HT (W2 ), because GT is close
to HT , as long as HT (Wi ) satisfies certain boundedness conditions (which, by the
boundedness of the Wi , will be satisfied with high probability).
Lemma 7.5. Suppose H is a weighted graph on N with weights Hi,j ∈ [0, 1], and
Hi,i = 0. Suppose that G is generated by taking an edge betweenP
i and j with
probability Hi,j , independently for every pair of vertices. Suppose that i,j Hi,j ≤ E
P
and i,j,k Hi,j Hj,k ≤ F where the sum goes over pairwise distinct vertices. Let
0 < ρ. Then
√
P[kW(G, ρ) − W(H, ρ)k2→2 > ρ7/8 (E + 2F )1/4 ] < ρ.
Proof. Let Xi,j = Gi,j − Hi,j . Notice that EXi,j = 0 and Xi,j over different pairs
are independent. Also, each Xi,i = 0. Therefore,
X
X
4
2
2
E[t(C4 , W(G, ρ) − W(H, ρ))] = ρ4 E
Xi,j
+2
Xi,j
Xj,k
i,j

+

i,j,k

X


Xi,j Xj,k Xk,l Xl,i ,

i,j,k,l

where in each of the sums, all indices are pairwise distinct. Here
 X
X
X
4
4
E[Xi,j
]=
Hi,j (1 − Hi,j )4 + (1 − Hi,j )Hi,j
≤
Hi,j ≤ E.
i,j

i,j

i,j

Also,
X

 2 2  X


2
2
2
2
E Xi,j
Xj,k =
Hi,j − 2Hi,j
+ Hi,j
Hj,k − 2Hj,k
+ Hj,k

i,j,k

i,j,k

=

X
i,j,k

≤ F.

Hi,j (1 − Hi,j )Hj,k (1 − Hj,k ) ≤

X
i,j,k

Hi,j Hj,k

74

BORGS, CHAYES, COHN, AND LOVÁSZ

Finally, for any pairwise distinct i, j, k, `,
E[Xi,j Xj,k Xk,` X`,i ] = 0.
Therefore,
0 ≤ E[t(C4 , W(G, ρ) − W(H, ρ))] ≤ ρ4 (E + 2F ).

(7.1)

This implies that
h
i √
P t(C4 , W(G, ρ) − W(H, ρ)) > ρ7/2 (E + 2F ) < ρ.
1/4

Using the fact that kU k2→2 ≤ (t(C4 , U ))

(Lemma 3.18), the lemma follows.



Proof of Theorem 7.3. We are now ready to show that with high probability, kW10 −
W20 k2→2 is small. Recall that we have a coupling of HT (W1 ) and HT (W2 ) such that
HT (W1 ) − HT (W2 ) = HT (W1 − W2 ) with probability one. Let U = W1 − W2 , so
that HT (W1 ) − HT (W2 ) = HT (U ).
Let us first show that kW (HT (U ), 1/T )k2→2 is small. First, suppose that µ =
µ(Ω) is finite. Let
Z
X=
U (x1 , x2 )4 dµ(x1 ) dµ(x2 ) ≤ 2C,
Ω2

Z

U (x1 , x2 )2 U (x2 , x3 )2 dµ(x1 ) dµ(x2 ) dµ(x3 ) ≤ 4CD,

Y =
Ω3

and
Z
Z=

U (x1 , x2 )U (x2 , x3 )U (x3 , x4 )U (x4 , x1 ) = t(C4 , U )
Ω4

≤ kW1 − W2 k22→2 kW1 − W2 k22
≤ kW1 − W2 k22→2 kW1 − W2 k1
≤ 2c2 C,
where we used Lemma 3.18, the fact that both graphexes are (C, D)-bounded, and
the fact that d2→2 (W1 , W2 ) ≤ c. If T > max{16 cD2 , 2/c}, then

∞
X
(T µ)n n(n − 1)
n(n − 1)(n − 2)
E[t(C4 , HT (U ))] =
e−T µ
X +2
Y
4 µ2
n!
T
T 4 µ3
n=0

n(n − 1)(n − 2)(n − 3)
+
Z
T 4 µ4
2C
8CD
+ 2c2 C ≤ 3c2 C.
≤ 2 +
T
T
In general,
we can take a sequence of finite measure subsets Ω1 ⊆ · · · ⊆ Ωn ⊆ . . .
S
with n Ωn = Ω to show that the above bound on the expectation holds for general
Ω. Therefore,
c
.
P[kHT (U )k2→2 > (30cC)1/4 ] ≤ P[t(C4 , HT (U )) > 30cC] <
10
Next, let P2 be the star with two leaves. If T is large enough, then

E[t(P2 , HT (W1 ))] = t(P2 , W1 )T 3 + T 2 kW1 k1 ≤ CDT 3 + CT 2 ≤ 2CDT 3 .

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

75

Therefore,


20CDT 3
c
≤
P t(P2 , HT (W1 )) >
.
c
10
Also, since
E[kHT (W1 )k1 ] ≤ CT 2 ,
we also have


10CT 2
c
P kHT (W1 )k1 >
≤
.
c
10
Conditioned on neither of these happening, we can apply Lemma 7.5 with
E + 2F ≤

10CT 2
20CDT 3
50CDT 3
+2
≤
.
c
c
c

This means that
"



P kW(GT (W1 ), 1/T ) − W(HT (W1 ), 1/T )k2→2 >

50CD
√
c T

1/4 #

1
≤√ .
T

fi = W (G
e T (Wi ), 1/T )
Clearly the analogous statements hold for HT (W2 ). Let W
(i.e., the part consisting of edges generated by the stars and independent edges).
ci = W (GT (Wi ), 1/T ) − W (HT (Wi ), 1/T ). Assuming none of the bad
Also, let W
events happen, if T is large enough, then
f1 k2→2 + kW
f2 k2→2
kW10 − W20 k2→2 ≤ kW
c1 k2→2 + kW
c2 k2→2 + kW (HT (U ), 1/T )k2→2
+ kW
1/4
1/4


(50CD)1/4
2CD
√
+2
+ (30cC)1/4 ≤ (31cC)1/4 .
≤2 √
T
c T
The probability of one of the bad events happening is at most
2
c
2
c
6c
√ +4 + √ +
≤
.
10
10
10
T
T
Let us now bound the probability that kDW01 − DW02 k2 is large. For x ∈ Ω, let
Z
DW1 W2 (x) =
W1 (x, y)W2 (x, y) dµ(y).
Ω

With our coupling,
"
# Z
X

2
E
dGT (W1 ) (v) =
T (T DW1 (x))2 + T DW1 (x) dµ(x),
Ω

v∈VT

"
E

#
X

Z

dGT (W1 ) (v)dGT (W2 ) (v) =

T ((T DW1 (x))(T DW2 (x)) + T DW1 W2 (x)) dµ(x),
Ω

v∈VT

"
E

#
X

v∈VT

2

dGT (W2 ) (v)

Z
=
Ω


T (T DW2 (x))2 + T DW2 (x) dµ(x).

76

BORGS, CHAYES, COHN, AND LOVÁSZ

Therefore,
"
E

#
X

2
dGT (W1 ) (x) − dGT (W2 ) (x)

v∈VT

= T3

Z

2

(DW1 (x) − DW2 (x)) dµ(x)
Z
2
+T
(DW1 (x) + DW2 (x) − 2DW1 W2 (x)) dµ(x)
Ω

Ω

≤ T 3 kDW1 − DW2 k22 + T 2 kW1 k1 + T 2 kW2 k1 ,
This means that if T is large enough,


E kDW01 − DW02 k22 ≤ c4 + 2C/T ≤ 2c4 .
Therefore,

c
.
8
Finally, recall that by Lemma 4.3, the number of edges of GT (Wi ) has expectation
T 2 kWi k1 /2 and variance T 2 kWi k1 /2 + T 3 kDWi k22 . Therefore, the probability that
GT (Wi ) has more than T 2 (kWi k1 + c3 )/2 or less than T 2 (kWi k1 − c3 )/2 edges is
less than
T 2 kWi k1 /2 + T 3 kDWi k22
2C + 4T CD
c
≤
≤ .
c6 T 4 /4
c6 T 2
8
Here we used the fact that kDWi k22 ≤ kDWi k1 kDWi k∞ = kWi k1 kDWi k∞ , and we
are assuming that T is large. Assuming neither of these events happens, kW0i k1 is
between kWi k1 − c3 and kWi k1 + c3 . Since |kW1 k1 − kW2 k1 | ≤ c3 , we have that
|kW01 k1 − kW02 k1 | ≤ 3c3 .
To summarize, we have that with high probability,
√
3
d2→2 (W01 , W02 ) ≤ min(31cC)1/4 , 2c3/4 , 3c).
P[kDW01 − DW02 k2 > 4c3/2 ] ≤

The probability that this does not happen is at most
6c
c
c
+ + 2 ≤ c.
10 8
8
This completes the proof.



7.2. Samples converge to graphex. In this subsection, we prove the sampling
lemma, Theorem 7.1. To this end, we will first establish two lemmas. The first one
states that each (C, D)-bounded graphex can be approximated by a step graphon,
i.e., a graphex where the star and dust part is zero, and the graphon part is a step
graphon.
Lemma 7.6. For every ε, C, and D, there exist M , N , and ρ such that the following
holds. For every (C, D)-bounded graphex W, there exists a (C, D)-bounded graphex
Wε = (Wε , 0, 0, Ωε ), where Ωε = (Ωε , Fε , µε ) and µε (Ωε ) ≤ N , and furthermore
the graphon Wε is a step function with at most M steps, with each part having size
equal to ρ, and δ2→2 (W, Wε ) ≤ ε.
Proof. By Remark 4.4, we may assume that W is a graphex over an atomless
measure space Ω = (Ω, F, µ). By Theorem 5.7, there exists M (ε) and ρ such that
there is a partition P = {P1 , P2 , . . . , Pm } of ΩP ⊆ Ω with m ≤ M (ε) such that
δ2→2 (WP , W) ≤ ε/2 and each part has size ρ. Let Ωε = ΩP ∪ Q where Q is any

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

77

set disjoint from ΩP , and obtain µε by extending µ to Q (with measure to be
determined later). Let Wε = (Wε , 0, 0, Ωε ) with


WP (x, y) if x ∈ Pi , y ∈ Pj ,



 SP (x)
if x ∈ Pi , y ∈ Q,
Wε (x, y) = Sµ(Q)
P (y)

if x ∈ Q, y ∈ Pi , and
 µ(Q)


 2IP
if x, y ∈ Q.
µ(Q)2

Extend WP by 0 to Q. Since WP is (C, D)-bounded, there exists K depending only
on ε, C, D such that if µ(Q) ≥ K, then Wε − WP is at most ε2 /(4C) everywhere,
which implies that
kWε − WP k2→2 ≤ kWε − WP k2
p
p
≤ kWε − WP k1 kWε − WP k∞ ≤ Cε2 /(4C) = ε/2.
For x ∈ ΩP ,
DWε (x) = DWP (x) + µ(Q)

SP (x)
= DWP (x).
µ(Q)

We also have that for x ∈ Q,
X
2IP
+
DWε (x) = µ(Q)
2
µ(Q)
i

Z
Pi

SP (y)
DWP (∞)
dµ(y) =
.
µ(Q)
µ(Q)

0

Therefore, there exists a K depending only on ε, C, and D such that if µ(Q) ≥ K 0 ,
then
Z
2
kDWε − DWP k22 =
(DWε (x) − DWP (x)) dµ(x)
ΩP ∪Q

Z 
=
Q

DWP (∞)
µ(Q)

2
=

DWP (∞)2
≤ ε4 /16.
µ(Q)

Also, by construction, kWε k1 = kWP k1 . Therefore δ2→2 (Wε , WP ) ≤ ε/2, and
hence δ2→2 (Wε , W) ≤ ε.

Remark 7.7. Using the ideas of the previous proof, it is not hard to see that
e D)
fQ , 0, 0, Ω
in distribution, the process generated from the graphex f
WQ = ( W
constructed in Remark 2.3 (3) converges to the one generated from W. Indeed, we
claim that
δ (f
WQ , W) → 0
as
Q → ∞.
To see this, fix ε > 0 and choose D in such a way that the set Ω>D = {DW > D}
e ≤D = Ω≤D ∪ {∞} = Ω
e \ Ω>D .
has measure at most ε2 . Let Ω≤D = Ω \ Ω>D and Ω
f
f
f
Setting WQ,≤D = (WQ )|Ω\Ω
e >D and W≤D = W|Ω\Ω>D and defining W≤D as the
e ≤D , we will want to show that for Q large enough,
trivial extension of W≤D to Ω
d2→2 (f
W≤D , f
WQ,≤D ) ≤ ε, since this implies that δ2→2 (W≤D , f
WQ,≤D ) ≤ ε and hence
f
δ (WQ , W) ≤ ε. But this follows by essentially the same argument as the one in the
f≤D is (C, D)-bounded
previous proof; all that is needed is that by Proposition 2.4, W
for some C < ∞.
Our second lemma estimates the distance between the empirical graphex corresponding to a weighted graph H with weights in [0, 1] and the one corresponding
to the graph G obtained from H by choosing the edge in G randomly according

78

BORGS, CHAYES, COHN, AND LOVÁSZ

to H. More precisely, given a finite weighted graph H with weights Hi,j ∈ [0, 1]
and Hi,i = 0, define G(H) as the graph generated by taking an edge between i
and j with probability Hi,j , independently for every pair of vertices. Our next
lemma estimates the distance between the empirical graphon of H and the empirical
graphon of G(H).
Lemma 7.8. For every N0 , ε, and δ, there exists n0 such that the following holds.
For any weighted graph H on n ≥ n0 vertices with weights in [0, 1], and any N ≤ N0 ,
the probability that δ2→2 (W(H, N/n), W(G(H), N/n)) > ε is at most δ.
Proof. We first extend both H and G trivially to N, and then define U as the
1/4
graphon U = W (G(H), N/n) − W (H, N/n). Then kU k2→2 ≤ (t(C4 , U ))
by
Lemma 3.18. As a consequence, the probability that kU k2→2 > ε is bounded by
ε−4 E[t(C4 , U )]. Using the bound (7.1) from the proof of Lemma 7.5 with E = n2 ,
F = n3 , and ρ = N/n, we get that the probability that kU k2→2 > ε is bounded by

N4
N4
N4
ε−4 E[t(C4 , U )] ≤ ε−4 4 n2 + 2n3 ≤ 3ε−4 n3 4 ≤ 3ε−4 0 ≤ δ/2,
n
n
n0
provided n0 ≥ 6ε−4 δ −1 N04 . Let us now bound the other two components of ∆2→2 .
For a fixed vertex v, by Hoeffding’s inequality [15],
P[|dG(H) (v) − dH (v)| > ε0 n] ≤ 2e−2ε

02

n

.

Therefore, by a union bound,
P[there exists a vertex v such that |dG(H) (v) − dH (v)| > ε0 n] ≤ 2ne−2ε

02

n

.

0

For any fixed ε , if n is large enough, this probability is less than δ/2. If this does
not happen, then for every vertex v,




DW (G(H), Nn ) (v) − DW (H, Nn ) (v) ≤ N ε0 .
Therefore, for ε0 small enough,
kDW (G(H),N/n) − DW (H,N/n) k2 ≤ N 3/2 ε0 ≤ε2 ,
and


|kW (G(H), N/n)k1 − kW (H, N/n)k1 | = kDW (G(H),N/n) k1 − kDW (H,N/n) k1 
≤ N 2 ε0 ≤ ε3 .
This completes the proof of the lemma.



With these preparations, we are ready to prove the sampling lemma.
Proof of Theorem 7.1. Fix ε > 0. We know from the definition of tightness that
there exist C and D so that we can remove a set Ωε of measure at most ε2 /2 to
obtain a (C, D)-bounded graphex. Then the expected number of points in GT whose
feature lies inside Ωε is ε2 T /2. Therefore, since it is a Poisson distribution, the
probability that GT (W) has more than ε2 T points in Ωε is at most
e

ε2 T
2

(1−2 log 2)

.

This converges to 0 as T → ∞. If GT (W) does not have more than ε2 T points, then
we can remove those points from GT (W) and the sample is equivalent to a sample
from the graphex restricted to Ω \ Ωε . (It may have isolated vertices but this does
not affect our distance.) Since a set of ε2 T points in GT (W) corresponds to a set

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

79

of measure ε2 in W(GT (W, 1/T )), this shows that we may assume without loss of
generality that the original set is (C, D)-bounded, and prove Theorem 7.1 for δ2→2
instead of δ .
Choose Wδ as in Lemma 7.6 (with δ taking the role of ε) so that in particular
δ2→2 (W, Wδ ) ≤ δ. For sufficiently small δ, Theorem 7.3 then implies that there
exists a T0 such that if T > T0 , then the samples from W and Wδ can be coupled
so that
P[δ2→2 (W(GT (W), 1/T ), W(GT (Wδ ), 1/T )) > (31Cδ)1/4 ] < δ.
This means that it suffices to prove Theorem 7.1 for step function graphons with
equal size parts, uniformly over any set of graphons with a bounded number of parts
with the same size. Indeed, for any ε > 0, let δ > 0 be such that
2δ + (31δC)1/4 < ε.
If we then take Wδ as above, then δ2→2 (Wδ , W) ≤ δ, so by Theorem 7.3, for large
enough T , we can couple W(GT (Wδ , 1/T )) and W(GT (W, 1/T )) so that the probability that they have δ2→2 distance more than (31δC)1/4 is at most δ. Furthermore, we
can take T large enough so that the probability that δ2→2 (W(GT (Wδ ), 1/T ), Wδ ) > δ
is at most δ (detailed below). Overall, by the triangle inequality, this implies that
the probability that δ2→2 (W(GT (W), 1/T ), W) ≥ ε is at most 2δ. Since this works
for arbitrarily small δ, the theorem follows.
Suppose therefore that W = (W, 0, 0, Ω), where W is a step graphon with step
size ρ and m steps total. Fix ε > 0 and δ > 0. For a fixed part Pi and T , let XT,i
be the number of points in Pi in the Poisson process. The expectation of each XT,i
is ρT . For ε0 > 0, we have
0

0

0

0

P [XT,i > (1 + ε0 )ρT ] < eρT (ε −(1+ε ) log(1+ε )) = e−ρT c(ε )
for a nonnegative number c(ε0 ). We also have
0

0

1

0

0

P [XT,i < (1 − ε0 )ρT ] < eρT (−ε +(1−ε ) log( 1−ε0 ) = e−ρT c (ε )
for a nonnegative number c0 (ε0 ). Therefore, if T is large enough, then the probability
that any part Pi has more than (1 + ε0 )ρT or less than (1 − ε0 )ρT points is less than
δ/2. Note that in particular this means that the total measure of nonzero points
is at most (1 + ε0 )ρm. Therefore, with probability at least 1 − δ/2, we can add or
delete points with total measure at most ε0 ρm to obtain W from W (HT (W ), ρ).
This means that we can couple W(HT (W ), ρ) and W so that they differ on points
with total measure at most ε0 ρm, and hence
kW (HT (W ), ρ) − W k1 ≤ 2ε0 (1 + ε0 )ρ2 m2 .
Therefore, we have the same bound for |kW (HT (W ), ρ)k1 − kW k1 |. Since both
graphons are between 0 and 1, we also have
kW (HT (W ), ρ) − W k2→2 ≤ kW (HT (W ), ρ) − W k2
p
p
≤ kW (HT (W ), ρ) − W k1 ≤ 2ε0 (1 + ε0 )ρm.
Finally, we have
3

2

kDW(HT (W ),ρ) − DW k22 ≤ ρm(ε0 ρm)2 + ε0 ρm((1 + ε0 )ρm)2 = (ε0 + 3ε0 + ε0 )ρ3 m3 .
We can therefore take ε0 small enough that δ2→2 (W(HT (W ), ρ), W) < ε/2 with
probability at least 1 − δ/2.

80

BORGS, CHAYES, COHN, AND LOVÁSZ

Using Lemma 7.8 for ε/2 and δ/2, we have that with probability at least 1 − δ/2,
ε
δ2→2 (W, HT (W, 1/T )) ≤ ,
2
and with probability at least 1 − δ/2,
ε
δ2→2 (W(HT (W ), 1/T ), W(GT (W), 1/T )) ≤ .
2
Therefore, with probability at least 1 − δ,
δ2→2 (W,W(GT (W), 1/T ))
≤ δ2→2 (W, HT (W, 1/T )) + δ2→2 (W(HT (W ), 1/T ), W(GT (W), 1/T ))
ε ε
≤ + = ε.
2 2
This completes the proof of Theorem 7.1.

7.3. Proofs of Theorem 2.18, Proposition 2.13, and Theorem 2.23. Having
completed the proof of Theorem 7.1, we are finally ready to establish that δ
convergence is equivalent to GP-convergence, together with several of the other
equivalences stated in Section 2. To this end, we first prove the following theorem.
Theorem 7.9. Given a pair of graphexes W, W0 , we have δ (W, W0 ) = 0 if and
only if for every T > 0, GT (W) and GT (W0 ) have the same distribution.
Proof. If δ (W0 , W) = 0, then taking Wn = W 0 for each n, Theorem 6.17 implies
that GT (W) and GT (W0 ) must have the same distribution for every T . Suppose
now that GT (W) and GT (W0 ) have the same distribution for every T . By Theorem
7.1, we can choose T such that with probability at least 0.99, δ (GT (W), W) < ε/2
and δ (GT (W0 ), W0 ) < ε/2. Since GT (W) and GT (W0 ) have the same distribution,
the two graphexes have distance at most ε. Since this holds for every ε, the lemma
follows.

Proof of Theorems 2.18, Proposition 2.13, and Theorem 2.23. We start with the
proof of Theorem 2.18. One direction follows from Theorem 6.17. Suppose now that
Wn is GP-convergent to W. We know by Theorem 4.1 that then the set Wn is tight.
By Theorem 2.21, Wn therefore has a subsequence that converges according to δ to
a graphex W0 , which in turn implies the subsequence is GP-convergent to W0 . This
implies that for any T > 0, GT (W) and GT (W0 ) have the same distribution. By Theorem 7.9, δ (W, W0 ) = 0, so δ (Wn , W) → 0. Next recall that by Proposition 2.17,
the distances δ and δ2→2 give equivalent topologies on sets with uniformly bounded
marginals, showing that Theorem 2.18 implies Proposition 2.13. We conclude by
noting that Theorem 2.23 follows from Corollary 6.2 and Proposition 2.13.

8. Identifiability
In this section, we prove Theorem 2.5. In fact, we will prove the following version,
which by Theorem 7.9 is equivalent.
Theorem 8.1. Let W1 = (W1 , S1 , I1 , Ω1 ) and W2 = (W2 , S2 , I2 , Ω2 ) be graphexes,
where Ωi = (Ωi , Fi , µi ) are σ-finite spaces. Suppose δ (W1 , W2 ) = 0. Then there
exists a third graphex W = (W, S, I, Ω) over a σ-finite measure space Ω = (Ω, F, µ)
and measure preserving maps φi : dsupp Wi → Ω such that Wi |φ−1 (Ω) = Wφi (and
Wi , Si = 0 everywhere else) for i = 1, 2.

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

81

To prove the theorem, we will first prove the following theorem, which may be of
independent interest. We recall that a Borel measure space is a measure space that
is isomorphic to a Borel subset of a complete separable metric space equipped with a
Borel measure, where, as usual, two measure spaces Ω = (Ω, F, µ) and Ω = (Ω, F, µ)
are called isomorphic if there exists a bijective map φ : Ω → Ω0 such that both φ
and its inverse are measure preserving.
Theorem 8.2. Let W1 = (W1 , S1 , I1 , Ω1 ) and W2 = (W2 , S2 , I2 , Ω2 ) be graphexes,
where Ωi = (Ωi , Fi , µi ) are σ-finite Borel spaces. Suppose further that DWi > 0
everywhere for i = 1, 2, and δ (W1 , W2 ) = 0. Then µ1 (Ω1 ) = µ2 (Ω2 ), I1 = I2 , and
there exists a coupling of Ω1 and Ω2 , that is, a measure ν on (Ω1 × Ω2 , F1 × F2 )
with marginals µ1 and µ2 , such that if πi : Ω1 × Ω2 → Ωi is the projection map, then
W1π1 = W2π2 ν-almost-everywhere, and S1π1 = S2π2 ν-almost-everywhere.
Theorem 8.2 should be compared to Proposition 8 from [3] which states the
analogous result for integrable Borel graphons that have cut distance zero (without
the assumption that W1 and W2 are non-negative), using a different proof technique.
Using still different proof techniques, Janson proved a similar result (again without
assuming non-negativity), showing that after trivially extending two integrable Borel
graphons with cut distance zero they can be coupled so that the projections are
equal almost everywhere; see [17]. We will prove Theorem 8.2 in Section 8.1.
Remark 8.3. Throughout this paper, we have considered graphexes where all three
parts are non-negative. While this makes sense when considering graphexes as
generators of a graphex process, from an analytical point of view, it is less natural.
Indeed, it is easy to define the kernel and weak kernel distance for graphexes where
the three parts take values in R. Taking, e.g., the kernel distance d2→2 defined
in (2.1), all we need to Rdo is replace the RL1 norms in the third part by a signed
“edge density” ρ(Wi ) = W dµ × dµ + 2 S dµ + 2I, and then use the third root
of |ρ(W1 ) − ρ(W2 )| instead of the third root of |kW1 k1 − kW2 k|. In particular in
view of the just discussed results from [3] and [17], we conjecture that Theorem 8.2
holds for signed graphexes as well, provided the condition DWi > 0 is replaced by
the condition D|Wi | > 0, where |Wi | is obtained from Wi by replacing all three
components of Wi by their absolute values. We leave the proof of this conjecture as
an open problem.
Once we have established Theorem 8.2, we will then prove Theorem 8.1 by
generalizing a construction which was developed by Janson for the dense case in
[16]. To this end, we will assign to each graphex W a “canonical version” c
W such
that W is a pullback of c
W and show that if two graphexes are equivalent, then their
canonical versions are isomorphic up to measure zero changes. This will be carried
out in Section 8.2.
Remark 8.4. Section 8.2 does not use nonnegativity in any essential way, and should
easily generalizable to signed graphexes. This should give a relatively straightforward
proof of the analogue of Theorem 8.1 for graphons of cut distance zero, and also
allow for the more general setting of signed graphexes, once the above conjectured
generalization of Theorem 8.2 is established. Again we leave this as an open problem.
8.1. Infimum is minimum. In this subsection, we will prove Theorem 8.2. The
proof will be based on a series of lemmas.

82

BORGS, CHAYES, COHN, AND LOVÁSZ

e i ), for i = 1, 2, be trivial extensions of Wi to spaces of
fi , Sei , Iei , Ω
Wi = ( W
Let f
e i = (Ω
e i , Fei , µ
infinite measure, where Ω
ei ), and let ε > 0. By Proposition 4.7 (3),
ε
ε
e
e
e
e
there exist Ωi ⊆ Ωi such that Ωi \ Ωi has measure at most ε, and a measure νε on
f
eε × Ω
e ε with marginals µ
Ω
e1 |Ω
e2 |Ω
e ε and µ
e ε such that for the restricted graphexes Wi,ε ,
1
2
1

2

f π1
kW
1,ε
and

Z
e ε ×Ω
eε
Ω
1
2

f π2 k2→2,ν ≤ ε
−W
ε
2,ε


2
DW
dνε (x, y) ≤ ε4 .
e 1,ε (x) − DW
e 2,ε (y)

e1 × Ω
e 2 by zero. This means that
With a slight abuse of notation, we extend νε to Ω
in fact
f π1 − W
f π2 k2→2,ν ≤ ε
kW
ε
1
2
and
2
kDW
e π1 ,νε − DW
e π2 ,νε k2 ≤ ε .
1

2

We first prove the following lemma.
Lemma 8.5. For any c,
(1) limε→0 νε (Ω1,>c × Ω2,>c ) = µi (Ωi,>c ) for i = 1, 2 (regardless of the choice
of νε ), and
(2) µ1 (Ω1,>c ) = µ2 (Ω2,>c ).
Proof. We first prove (1). By symmetry, it suffices to prove it for i = 1. Note that
e ε,
for any x ∈ Ω
i
DW
e i,ε (x) ≤ DW
e i (x) ≤ DW
e i,ε (x) + ε
e i,>c = Ωi,>c . Therefore,
and that Ω


e 2 \Ω2,>c−(√ε+ε) )
ενε Ω1,>c × (Ω
Z
≤
√
e 2 \Ω
Ω1,>c ×(Ω
2,>c−( ε+ε) )

DW1,ε (x) − DW2,ε (y)

2

≤ ε4 ,

which implies that
e 2 \ Ω2,>c−(√ε+ε) )) < ε3 .
νε (Ω1,>c × (Ω
Now, for any ε,
e 2 ) − νε (Ω1,>c × Ω2,>c )|
|µ1 (Ω1,>c ) − νε (Ω1,>c × Ω2,>c )| ≤ ε + |νε (Ω1,>c × Ω
e 2 \ Ω2,>c ))
= ε + νε (Ω1,>c × (Ω
e 2 \ Ω2,>c−(√ε+ε) )) + νε (Ω1,>c × (Ω2,>c−(√ε+ε) \ Ω2,>c ))
= ε + νε (Ω1,>c × (Ω
< ε + ε3 + µ2 (Ω2,>c−(√ε+ε) \ Ω2,>c ).
This last expression is finite, and tends to 0 as ε → 0, so
lim νε (Ω1,>c × Ω2,>c ) = µ1 (Ω1,>c ).

ε→0

This proves (1). From this, (2) is obvious.



Lemma 8.6. For any n ≥ 1, there exists a measure νn on Ω1,>1/n × Ω2,>1/n such
that the following hold:
(1) νn is a coupling of Ω1,>1/n and Ω2,>1/n ,

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

83

(2) νn+1 |Ω1,>1/n ×Ω2,>1/n = νn ,
(3) W1π1 and W2π2 are equal when restricted to (Ω1,>1/n × Ω2,>1/n )2 , νn × νn almost everywhere, and
(4) DWπ1 1 and DWπ2 2 are equal when restricted to Ω1,>1/n × Ω2,>1/n , νn -almost
everywhere.
Proof. It is well known that any two Borel measurable spaces with the same
cardinality are isomorphic; see, e.g., Theorem 8.3.6 in [12]. As a consequence, each
Borel measure space (Ω, F, µ) with µ(Ω) < ∞ is either empty or isomorphic to a
finite set (with the discrete topology), the countable set {0} ∪ {1/n : n ∈ N} (with
the induced topology from R), or the Cantor cube C = {0, 1}∞ (with the product
topology), equipped with the Borel σ-algebras generated by the topologies, and a
measure that is a finite Borel measure with full support.
We can therefore assume without loss of generality that for each i, Ωi,>1 and
each set Ωi,>1/(n+1) \ Ωi,>1/n are of this form. This means we may without loss of
generality assume the following properties:
(1) Each Ωi,>1/n , and thus each Ω2i,>1/n , is compact.
(2) For any i1 , i2 = 1, 2 and n1 , n2 ∈ N+ , and any finite Borel measure ν on
Ωi1 ,>1/n1 × Ωi2 ,>1/n2 , the set of all step functions on Ωi1 ,>1/n1 × Ωi2 ,>1/n2
corresponding to partitions of Ωij ,>1/nj into clopen sets for j = 1, 2 is dense
in L1 (Ωi1 ,>1/n1 × Ωi2 ,>1/n2 ).
Now, take a sequence εk → 0, and recall that we have an almost coupling measure
e1 × Ω
e 2 with
νεk on Ω
f π1 − W
f π2 k2→2,ν ≤ εk
kW
εk
1
2
and
2
kDW
e π1 ,νεk − DW
e π2 ,νεk k2 ≤ εk .
1

2

We know that for each n, Ω1,>1/n × Ω2,>1/n is compact, and for any K > 0,
the set of measures on it bounded by K is compact under the topology of weak
convergence of measures. Since for any c,
lim νεk (Ω1,>c × Ω2,>c ) = µ1 (Ω1,>c ) = µ2 (Ω2,>c ) < ∞,

k→∞

we can take a subsequence of νεk such that for each n, the measure is convergent
when restricted to Ω1,>1/n × Ω2,>1/n . Without loss of generality we assume that
the original sequence has this property. For each n, we then define νn as the limit
measure on Ω1,1/n × Ω2,>1/n . Having defined νn we now prove (1)–(4).
(1) We have seen in Lemma 8.5 that
νn (Ω1,>1/n × Ω2,>1/n ) = µ1 (Ω1,>1/n ) = µ2 (Ω2,>1/n ).
For any clopen F ⊆ Ω1,>1/n , F × Ω2,>1/n is clopen in Ω1,>1/n × Ω2,>1/n . Therefore,
lim νεk (F × Ω2,>1/n ) = νn (F × Ω2,>1/n ).

k→∞

On the other hand, by Lemma 8.5,
k→∞

e 2 \ Ω2,>1/n )) ≤ νε (Ω1,>1/n × (Ω
e 2 \ Ω2,>1/n )) −−−−→ 0.
νεk (F × (Ω
k
We also have that
k→∞

e 2 ) − µ1 (F )| ≤ εk −−−−→ 0.
|νεk (F × Ω
Therefore for any clopen set, µ1 (F ) = νn (F × Ω2,>1/n ). This implies that µ1 and
the projection of νn onto Ω1,>1/n are the same, which proves (1).

84

BORGS, CHAYES, COHN, AND LOVÁSZ

(2) Since Ω1,>1/n × Ω2,>1/n is clopen in Ω1,>1/(n+1) × Ω2,>1/(n+1) ,
νn+1 (Ω1,>1/n × Ω2,>1/n ) = lim νεk (Ω1,>1/n × Ω2,>1/n ) = νn (Ω1,>1/n × Ω2,>1/n ).
k→∞

Furthermore, for any closed F ⊆ Ω1,>1/n × Ω2,>1/n , F is also closed in Ω1,1/(n+1) ×
Ω2,1/(n+1) , which implies that
lim sup νεk (F ) ≤ νn+1 (F ).
k→∞

This implies that νεk converges weakly to νn+1 |Ω1,>1/n ×Ω2,>1/n , but since it also
converges to νn , the two must be equal.
fi |(Ω
2 . Since
(3) Let Wi,n = W
i,>1/n )
f π1 − W
f π2 k2→2,ν ≤ εk ,
kW
εk
1
2
we have that in particular, for any n,
π1
π2
k2→2,νεk ≤ εk .
kW1,n
− W2,n

This implies that
π2
π1
− W2,n
k,νεk ≤ εk µ1 (Ω1,>1/n ).
kW1,n

Since Ωi,>1/n each have finite measure, we can use Janson’s argument in [16]. We
present the argument for completeness. Fix ε. We can find step graphons U1,n and
U2,n on (Ω1,>1/n )2 and (Ω2,>1/n )2 , with each part in the partition being a clopen
set, such that
kUi,n − Wi,n k1 ≤ ε.
This means that for any coupling measure on Ω1,>1/n × Ω2,>1/n ,
πi
πi
kUi,n
− Wi,n
k1 ≤ ε.
π1
π2
Now, U1,n
− U2,n
is a step function on (Ω1,>1/n × Ω2,>1/n )2 with a partition into
clopen parts. This means that since the restrictions of νεk weakly converge to νn ,
k→∞

π1
π2
π1
π2
kU1,n
− U2,n
k,νεk −−−−→ kU1,n
− U2,n
k,νn .

Take k large enough so that εk µ1 (Ω1,>1/n ) ≤ ε and


 π

kU 1 − U π2 k,ν − kU π1 − U π2 k,ν  ≤ ε.
2,n
1,n
2,n
εk
n
 1,n
We then have
π1
π2
kW1,n
− W2,n
k,νn
π1
π1
π1
π2
π2
π2
≤ kW1,n
− U1,n
k1,νn + kU1,n
− U2,n
k,νn + kU2,n
− W2,n
k1,νn
π1
π2
≤ 3ε + kU1,n
− U2,n
k,νεk
π1
π1
π1
π2
π2
π2
≤ 3ε + kW1,n
− U1,n
k1,νεk + kW1,n
− W2,n
k,νεk + kU2,n
− W2,n
k1,νεk

≤ 6ε.
Since this holds for any ε, this proves (3).

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

85

(4) Fix ε > 0 and assume that εk ≤ ε. Since DW
e i,ε (x) ≤ DWi (x) ≤ DW
e i,ε (x)+εk
k
k
ε
e ,
for all x ∈ Ωi ∩ Ω
i


n
o


νε x ∈ Ω1,>1/n × Ω2,>1/n : DWπ1 1 (x) − DWπ2 2 (x) ≥ 2ε


n
o


π1 ,νε (x) − D π2 ,νε (x) ≥ ε
≤ νε x ∈ Ω1,>1/n × Ω2,>1/n : DW
k
k
e
e
W
1

2

2
−2 4
≤ ε−2 kDW
εk .
e π1 ,νεk − DW
e π2 ,νεk k2 ≤ ε
1

2

Since for all ε > 0 the right side converges to 0 as k → ∞ this shows that νn is
supported on {x ∈ Ω1,>1/n × Ω2,>1/n : DWπ1 1 (x) = DWπ2 2 (x)}.

Proof of Theorem 8.2. After these preparations, we are ready to define the measure
µ on Ω1 × Ω2S
. Note that since before the extensions DWi > 0 almost everywhere,
we have that n Ωi,>1/n = Ωi . For A ⊆ Ω1 × Ω2 , let
ν(A) = lim νn (A ∩ (Ω1,>1/n × Ω2,>1/n ))
=

n→∞
∞
X

νn (A ∩ ((Ω1,>1/n × Ω2,>1/n ) \ (Ω1,>1/(n−1) × Ω2,>1/(n−1) ))).

n=1

Here with a slight abuse of notation we think of Ωi,1/0 as the empty set. To show
that this a coupling, note that for any measurable set X ⊆ Ω1 ,
µ1 (X) = lim µ1 (X ∩ Ω1,>1/n )
n→∞

= lim νn ((X ∩ Ω1,>1/n ) × Ω2,>1/n )
n→∞

= lim νn ((X × Ω2 ) ∩ (Ω1,>1/n × Ω2,>1/n )) = ν(X × Ω2 ),
n→∞

where in the second step we used that for each n, the restriction of ν to Ω1,>1/n ×
Ω2,>1/n is equal to νn , which is a coupling. Clearly the analogous argument works
for subsets Y ⊆ Ω2 .
Now, let
N = {(x, y) = ((x1 , x2 ), (y1 , y2 )) ∈ (Ω1 × Ω2 )2 : W1π1 (x, y) 6= W2π2 (x, y)}
and
M = {x = (x1 , x2 ) ∈ (Ω1 × Ω2 ) : DWπ1 1 (x) 6= DWπ2 2 (x)}.
Let
Nn = {(x, y) ∈ (Ω1,>1/n × Ω2,>1/n )2 : W1π1 (x, y) 6= W2π2 (x, y)}
and
Mn = {x = (x1 , x2 ) ∈ (Ω1,>1/n × Ω2,>1/n ) : DWπ1 1 (x) 6= DWπ2 2 (x)}.
S
S
Since S n Ωi,>1/n = Ωi and Ωi,>1/n ⊆ Ωi,1/(n+1) , we have that N = n Nn and
M = n Mn . By Lemma 8.6 (3,4), (ν ×ν)(Nn ) = (νn ×νn )(Nn ) = 0 and ν(Mn ) = 0,
which implies that (ν × ν)(N ) = 0 and ν(M ) = 0, and hence W1π1 = W2π2 and
DWπ1 1 = DWπ2 2 almost everywhere. Since W1π1 = W2π2 almost everywhere implies
that DW1π1 = DW2π2 almost everywhere, this in turn implies that S1π1 = S2π2 ν-almost
everywhere.
To prove that I1 = I2 , we again use Proposition 4.7, but instead of (3) we this
time use (2). Fix D > 0. Since δ2→2 (W1,≤D , W2,≤D ) = 0, we in particular have

86

BORGS, CHAYES, COHN, AND LOVÁSZ

that kW1,≤D k1 = kW2,≤D k1 . But since W1π1 = W2π2 and DWπ1 1 = DWπ2 2 almost
everywhere,
Z
Z
W1 dµ1 × dµ1 =
W1π1 1DWπ1 ≤D dν × dν
1
(Ω1 ,≤D)2
(Ω1 ×Ω2 )2
Z
=
W2π2 1DWπ2 ≤D dν × dν
2
(Ω1 ×Ω2 )2
Z
=
W2 dµ2 × dµ1 .
(Ω2 ,≤D)2

In a similar way,
I1 = I2 .

R
Ω1 ,≤D

S1 =

R
Ω2 ,≤D

S2 . Therefore kW1,≤D k1 = kW2,≤D k1 implies


Corollary 8.7. Let W = (W, S, I, Ω) and W0 = (W 0 , S 0 , I 0 , Ω0 ) be graphexes that
are equivalent, and suppose that DW , DW0 > 0 everywhere. Then there exist a
positive integer n and a chain of graphexes Wi = (Wi , Si , Ii , Ωi ) for i = 0, . . . , n,
with DWi > 0 everywhere for each i = 0, . . . , n, W0 = W, Wn = W0 , and for each
i ≥ 1, either Wi−1 = Wφi i almost everywhere for some measure preserving map φi
i
from Ωi−1 to Ωi , or Wi = Wφi−1
almost everywhere for some φi from Ωi to Ωi−1 .
In fact, we can take n = 4.
Proof. By the construction in the next section (which itself does not use Corollary 8.7), there exists W1 = (W1 , S1 , I1 , Ω1 ) such that Ω1 is Borel and a measurepreserving map φ1 from Ω0 to Ω1 with W = W0 = W1φ1 almost everywhere. Then
Ω0 = dsupp W0 = φ−1 (dsupp W1 ), so by replacing Ω1 by its restriction to dsupp W2 ,
we may assume that DW1 > 0 everywhere. Similarly, there exists (W3 , Ω3 ) with
Ω3 Borel and a measure preserving map φ4 from Ω4 to Ω3 with W 0 = W4 = W3φ4
almost everywhere and DW3 > 0 everywhere. Now, we can apply Theorem 7.1
to show that δ (W1 , W3 ) = 0. We can then apply Theorem 8.2 to (W1 , Ω1 ) and
(W3 , Ω3 ) to find a Borel space Ω2 and measure preserving maps φ2 from Ω2 to Ω1
and φ3 from Ω2 to Ω3 such that W3φ3 = W1φ2 almost everywhere. We can then take
W2 to be, say, W1φ2 .

8.2. Canonical graphex. In this section, we prove Theorem 8.1. We follow the
approach of Janson in [16], based on the construction of Lovász and Szegedy in [23].
Concretely, given a graphex W = (W, S, I, Ω), where Ω = (Ω, F, µ), define a map
ψW : Ω → L1 (Ω, F, µ) by x 7→ W (x, ·), and define a map ψW : Ω → L1 (Ω, F, µ) × R
by x 7→ (W (x, ·), S(x)), where we equip L1 (Ω, F, µ) with the standard Borel σalgebra and L1 (Ω, F, µ) × R with the standard product Borel σ-algebra. Note that
in general, we only know that ψW (x) ∈ L1 (Ω, F, µ) for almost all x ∈ Ω, but by
changing W on a set of measure zero, we may assume that this holds for all x ∈ Ω;
we will assume that throughout this section. We will see in Lemma 8.9 that ψW ,
and thus ψW , is measurable. Defining µW and µW as the pushforward of µ under
ψW and ψW respectively, and ΩW and ΩW as the corresponding supports, we then
construct a graphex c
W over ΩW (equipped with the Borel σ-algebra and the measure
µW ) such that W is almost everywhere equal to a pullback of c
W. Furthermore, we
will show that if W0 is a.e. equal to a pullback of W, then we can find a measure
c0 )φ∗ a.e. Combined with
preserving bijection φ∗ from ΩW to Ω0W such that c
W = (W
Corollary 8.7, this will establish Theorem 8.1.

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

87

We first state some preliminary lemmas. Recall that if (Ω, F, µ) is a measure
space, then L1 (Ω, F, µ) is a Banach space where each point is an equivalence class
consisting of integrable measurable functions from Ω to R, where two functions are
equivalent if they are equal almost everywhere (or equivalently their L1 distance
is 0). Note that in general, the space L1 (Ω, F, µ) is not separable, a fact which
will lead to technical complications when considering measurable functions into
L1 (Ω, F, µ) (e.g., the sum of two such functions is in general not measurable). As in
[16], we will avoid these difficulties by carefully constructing separable subspaces of
L1 (Ω, F, µ) such that the functions of interest take values in these subspaces. See
Lemma 8.8 below.
Throughout this section, we will frequently consider two measure spaces (Ω, F, µ)
and (Ω0 , F 0 , µ0 ), where Ω = Ω0 , F 0 ⊆ F, and µ0 is the restriction of µ to F 0 . With a
slight abuse of notation, we will often denote the second space by (Ω, F 0 , µ), rather
than (Ω, F 0 , µ|F 0 ).
As already noted, the space L1 (Ω, F, µ) is in general not separable (if Ω is a
Borel space, it is, but we want to define this construction for general Ω). We will
therefore need the following lemma.
Lemma 8.8. Suppose that (Ω, F, µ) and (Ω0 , F 0 , µ0 ) are σ-finite measure spaces,
W : Ω × Ω0 → R is measurable, and for all x ∈ Ω, the function W (x, ·) is integrable.
Let ψW : Ω → L1 (Ω, F, µ) be the map x 7→ W (x, ·). Then we can find a separable
closed subspace B of L1 (Ω0 , F 0 , µ0 ) such that ψW (x) ∈ B for all x ∈ Ω.
Proof. First, assume that W is bounded and both µ(Ω) < ∞ and µ(Ω0 ) < ∞. The
statement of the lemma then clearly holds for all step functions, and by a monotone
class argument it holds for all bounded W .
Next, relax the condition that µ0 (Ω0 ) < ∞. Let Ω01 ⊆ Ω02 ⊆S· · · ⊆ Ω0n ⊆ . . . be a
∞
sequence of measurable subsets of Ω0 with finite measure and n=1 Ω0n = Ω0 . Then
1
0
for every n we can find a separable closed subspace Bn ⊆ L (Ωn , F 0 |Ω0n , µ0 |Ω0n ) such
en consist of those f ∈ L1 (Ω0 , F 0 , µ0 )
that for every x ∈ Ω, W (x, ·)|Ω0n ∈ Bn . Let B
en is isomorphic to Bn , and
that have f |Ω0n ∈ Bn and f |Ω0 −Ω0n ≡ 0. Clearly B
S e
thus separable. Let B be the closure of the space generated by n B
n ; this is
separable. We claim that for any x ∈ Ω, the function W (x, ·) is contained in B.
en such that
It suffices to show that for any ε, there is an n ∈ N and a g ∈ B
kW (x, ·) − gk1 < ε. Since W (x, ·) ∈ L1 (Ω0 , F 0 , µ0 ), we can take n large enough
en , we have
that kW (x, ·) − W (x, ·)χ(Ω0n )k1 < ε. But then by the definition of B
0
0
e
W (x, ·)χ(Ωn ) ∈ Bn , so taking g = W (x, ·)χ(Ωn ), we are done.
In a similar way, we can approximate an unbounded W by the function W 1|W |≤n
to relax the condition that W is bounded.
Finally, for general Ω and Ω0 , we can write Ω as the disjoint union of finite
measure sets Ω1 , Ω2 , . . . , Ωn , . . . . We know that the image of each Ωn is contained
1
0
0
in a separable closed subspace Bn ⊆
S L (Ω , F ). Therefore, taking B to be the
closure of the subspace generated by n Bn , the image of the map ψW is contained
in B.

Lemma 8.9. Suppose (Ω, F, µ) and (Ω0 , F 0 , µ0 ) are σ-finite measure spaces, W : Ω×
Ω0 → R is F × F 0 -measurable, and that for all x ∈ Ω, the function W (x, ·) is
integrable. Then the map ψW : Ω → L1 (Ω0 , F 0 , µ0 ) with x 7→ W (x, ·) is measurable
with respect to the standard Borel σ-algebra on L1 (Ω, F, µ). .

88

BORGS, CHAYES, COHN, AND LOVÁSZ

Proof. Our goals is to show that c ∈ [0, ∞) and any f ∈ L1 (Ω0 , F 0 , µ0 ), the set
B(f, W, c) = {x ∈ Ω : kW (x, ·) − f k1 ≤ c}
is measurable.
Assume that x ∈ B(f, W, c), and let FW ⊂ L1 (Ω0 , F 0 , µ0 ) be a countable set such
that W (x, ·) lies in the closure of FW for all x ∈ Ω (the existence of such a set
follows from Lemma 8.8). Given any ε > 0, we can then find an fb ∈ FW such that
x ∈ B(fb, W, ε), and kf − fbk1 ≤ c + ε. If, on the other hand, kf − fbk1 ≤ c + ε
T
and x ∈ B(fb, W, ε) then x ∈ B(f, W, c + 2ε). Since B(f, W, c) = i B(f, W, c + εi )
whenever εi → 0, this proves that it is enough to prove measurability of B(fb, W, εi )
for all fb ∈ FW and an arbitrary sequence εi ∈ (0, ∞) such that εi → 0.
Using this observation, it is easy to see that if W1 and W2 obey the conclusions
of the lemma, then so does any linear combination. The lemma is clearly also true
for all step functions. A standard monotone class argument then implies that the
lemma holds for all bounded, measurable W .
If W is unbounded, we use that by assumption, ψW (x) ∈ L1 (Ω0 , F 0 , µ0 ) for all
for all x ∈ Ω. Using this fact, one easily shows that
B(f, W, c) =

∞
\

B(f, W (x, ·)1|W (x,·)|≤n , c).

n=1

Since B(f, W (x, ·)1|W (x,·)|≤n , c) is measurable, this proves the statement for unbounded W ,

We will also use the following technical lemma, which is Lemma G.1 in [16] (the
proof also works for σ-finite measures):
Lemma 8.10. Let (Ω, F, µ) be any σ-finite measure space, and B ⊆ L1 (Ω, F, µ) a
closed separable subspace. Then there exists a measurable evaluation map
Φ: B × Ω → R
such that for any f ∈ B, for almost every x ∈ Ω, f (x) = Φ(f, x) (note that f (x) is
only defined almost everywhere). In particular, if L1 (Ω, F, µ) is separable, we can
take B = L1 (Ω, F, µ).
We need one more lemma.
Lemma 8.11. Suppose that (Ω, F, µ) and (Ω0 , F 0 , µ0 ) are σ-finite measure spaces,
W : Ω × Ω0 → R is measurable, and for all x ∈ Ω and x0 ∈ Ω0 , both W (x, ·) and
W (·, x0 ) are integrable. Let ψW be the map Ω → L1 (Ω0 , F 0 , µ0 ) with x 7→ W (x, ·),
0
and ψW
be the map Ω0 → L1 (Ω, F, µ) with y 7→ W (·, y). Further, let G be the Borel
σ-algebra on L1 (Ω, F, µ), and let
−1

0
FW
= ψ 0 W (G).
0
Then for almost every x ∈ Ω, ψW (x) ∈ L1 (Ω0 , FW
, µ0 ).
0
Proof. By Lemma 8.8, the image of ψW
is contained in a separable subspace
1
B ⊆ L (Ω, F, µ). By Lemma 8.10, there exists a measurable map Φ : B × Ω → R
f on Ω × Ω0
such that for any f ∈ B and almost any x ∈ Ω, f (x) = Φ(f, x). Define W
by
0
f (x, y) = Φ(ψW
W
(y), x).

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

89

f (x, y) = W (x, y), so W
f = W almost
Then for every y and almost every x, W
0
everywhere on Ω×Ω . Thus, if we define ψW
f analogously to ψW , then for almost every
x ∈ Ω, kψW
f (x)−ψW (x)kL1 (Ω0 ,F 0 ,µ0 ) = 0; that is, for almost all x, ψW (x) = ψW
f (x) as
0
elements of L1 (Ω0 , F 0 , µ0 ). However, since Φ is B × Ω-measurable, and ψW
: Ω0 → B
f is F × F 0 -measurable, so in particular ψ f (x) is F 0 -measurable
is measurable, W
W
W
W
1
0
0
0
for all x. Since ψW (x) = ψW
f (x) ∈ L (Ω , F , µ ) for almost every x, it follows that
0
ψW (x) ∈ L1 (Ω0 , FW
, µ0 ) for almost every x ∈ Ω.

Let (W, S, I, Ω) be a graphex over Ω = (Ω, F, µ) such that W (x, ·) is integrable
for all x. For each x ∈ Ω, we have the section Wx ∈ L1 (Ω, F, µ) defined by
Wx (y) = W (x, y), giving us the map
ψW : Ω → L1 (Ω, F, µ)
defined by x 7→ Wx . Let
ψW : Ω → L1 (Ω, F, µ) × R
be defined by x 7→ (Wx , S(x)). By Lemma 8.9, ψW , and thus ψW , is measurable. Let
µW = µψW and µW = µψW , and let ΩW ⊆ L1 (Ω, F, µ) and ΩW ⊆ L1 (Ω, F, µ) × R
be the supports of µW and µW , respectively, i.e.,
ΩW = {f ∈ L1 (Ω, F, µ) : µW (U ) > 0 for every open U ⊆ L1 (Ω, F, µ) with f ∈ U },
and
ΩW = {(f, c) ∈ L1 (Ω, F, µ) × R :
µW (U ) > 0 for every open U ⊆ L1 (Ω, F, µ) × R with (f, c) ∈ U }.
e F,
e µ
Alternatively, we can also define ψW and µW as follows. Let (Ω,
e) be defined
e
as Ω = Ω ∪ {Ω∞ }, where Ω∞ is an atom with measure 1. Then we can think
e F,
e µ
of ψW (x) as a function in L1 (Ω,
e), with ψW (x)(y) = W (x, y) if y ∈ Ω and
ψW (x)(y) = S(x) if y = Ω∞ , and kψW (x)k1 = DW (x). This gives a bijection
e F,
e µ
e F,
e µ
L1 (Ω,
e) ≡ L1 (Ω, F, µ) × R and ψW as a map from Ω to L1 (Ω,
e). Note that
µW is the projection of µW , and thus ΩW is the closure of the projection of ΩW .
Equipping ΩW with the standard Borel σ-algebra GW , this gives us a measure space
(ΩW , GW , µW ), and similarly we obtain ΩW = (ΩW , GW , µW ).
e F,
e µ
e), respectively.
Let G and Ge be the Borel σ-algebra on L1 (Ω, F, µ) and L1 (Ω,
Via the maps ψW and ψW they induce two different σ-algebras on Ω, the σ-algebras
−1
FW = ψW
(G)

and
−1 e
FW = ψW
(G).
e
e
We also define FW = FW × B and FW = FW × B. Note that FW ⊆ FW , with
the example of a zero graphon but a nonconstant S function showing that strict
inequality is possible.
It is easy to see that if W0 is equal to W almost everywhere, then µW = µW0 and
hence ΩW = ΩW0 . Indeed, if W = W0 a.e., then for almost all x, ψW (x) = ψW0 (x)
when viewed as vectors in L1 . This implies that there exists a set N ⊆ Ω of measure
e the symmetric difference of ψ −1 (A) and ψ −10 (A) lies in
zero such that for all A ∈ G,
W
W
N , which shows that µW = µW0 . Furthermore, under the same change, FW , FW and
FW 0 , FW0 only change on a set of measure zero, implying that the Banach spaces
L1 (Ω, FW , µ) and L1 (Ω, FW , µ) remain unchanged.

90

BORGS, CHAYES, COHN, AND LOVÁSZ

Note that in general, µW is not σ-finite. Indeed, choosing W to be the graphon
−1
0 over any space of infinite measure, and I, S to be 0, we have that ψW
(A) = Ω
e F,
e µ
e), so µW (A) = µ(Ω) = ∞ if 0 ∈ A,
for every A containing the origin (0) ∈ L1 (Ω,
and µW (A) = 0 otherwise. So in particular ΩW = {(0)} and µW (ΩW ) = ∞. This
also means µW is not σ-finite.
It turns out, however, that this problem can be avoided if we require that the set
where DW = 0 has measure zero; see Lemma 8.13 below. Before stating the lemma,
we prove the following:
Proposition 8.12. The space ΩW as defined above is a complete, separable metric
e F,
e µ
space, with the metric induced by L1 (Ω,
e), and µW has full support in ΩW .
1 e e
1 e e
Furthermore, ΩW ⊆ L (Ω, FW , µ
e) ⊆ L (Ω, FW , µ
e). Finally, after modifying W and
S on a set of measure zero ψW becomes an everywhere defined, measure-preserving
−1
map from (Ω, F, µ) to (ΩW , GW , µW ), and we furthermore have ψW
(GW ) = FW .
Proof. By Lemma 8.8, the image of ψW is contained in a closed separable subspace
e = B × R,
B of L1 (Ω, F, µ). This means that the image of ψW is contained in B
1 e e
which is a closed separable subspace of L (Ω, F, µ
e). We will show that in fact
ΩW = {f ∈ B : µW (U ) > 0 for every open U ⊆ B with f ∈ U }.
and
e : µW (U ) > 0 for every open U ⊆ B
e with (f, c) ∈ U }.
ΩW = {(f, c) ∈ B
−1
Indeed, since ψW
(L1 (Ω, F, µ) \ B) = ∅, we have µW (L1 (Ω, F, µ) \ B) = 0, which
in turn implies that support of µW is contained in B. Let, for a moment, the
above defined set be Ω0W . First, if f ∈ Ω0W , then for any open set U ⊆ L1 (Ω, F, µ)
with f ∈ U , we have µW (U ) ≥ µW (U ∩ B) > 0. Conversely, if f ∈ ΩW , we know
we must have f ∈ B, and for any open U ⊆ B with f ∈ U , we can find an open
V ⊆ L1 (Ω, F, µ) with U = V ∩ B, so in particular f ∈ V . Then µW (V ) > 0, and
since µW (L1 (Ω, F, µ)\B) = 0, we have µW (U ) = µW (V ) > 0, showing that f ∈ Ω0W .
e = B × R.
A similar, argument shows the second claim, noting that ΩW ⊆ B
e with µW (U ) = 0. Then ΩW = B
e \V .
Now take the union V of all open sets U ⊆ B
e
Since B is separable and thus second countable,
we can find a countable collection
S
U1 , U2 , . . . , Un , . . . with µW (Un ) = 0 and n Un = V . This means that µW (V ) = 0,
−1
so µ(ψW
(V )) = 0, and thus almost every point in Ω is mapped to ΩW . Since V is
e so it is a closed subset of a separable Banach space; thus it
open, ΩW is closed in B,
is a complete, separable metric space.
To see that µW has full support, consider an open subset U ⊆ ΩW with µW (U ) = 0.
e and µW (B
e \ ΩW ) = 0, we can find an open subset Ũ ⊆ B
e
Since ΩW is closed in B
e
such that U = Ũ ∩ ΩW and µW (Ũ ) = µW (U ) = 0, so in particular Ũ ⊆ V = B \ ΩW .

But this implies U = Ũ ∩ ΩW = ∅, as required.
Next, we use Lemma 8.11 to infer that ψW (x) ∈ L1 (Ω, FW , µ) for almost all
e FeW , µ
x ∈ Ω, which in turn implies that ψW (x) ∈ L1 (Ω,
e) for almost all x ∈ Ω. As a
e F,
e µ
e FeW , µ
consequence, the open set U = L1 (Ω,
e) \ L1 (Ω,
e) has measure zero:
−1
e FeW , µ
µW (U ) = µ(ψW
(U )) = µ({x ∈ Ω : ψW (x) ∈
/ L1 (Ω,
e)}) = 0.

Since µW has full support on ΩW , the open set U ∩ ΩW ⊆ ΩW is empty, showing
e FeW , µ
that ΩW ⊆ L1 (Ω,
e).

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

91

−1
e \ ΩW . We have seen that µ(N ) =
Let N = ψW
(V ), where as above V = B
−1
0. Furthermore, for A ∈ GW , A ⊆ ΩW and hence ψW
(A) ⊆ Ω \ N . Finally,
−1
µ(ψW (A)) = µW (A) by the definition of µW . Fix some f ∈ ΩW . On N × (Ω \ N ),
change W (x, y) to f (y), and change it on (Ω \ N ) × N to make it symmetric. Finally,
change it to 0 on N × N , and on N , change S to f (Ω∞ ). Clearly it is still the case
that W and S are measurable and W (x, ·) integrable for every x. We have changed
W and S on a set of measure zero, so ΩW and µW did not change, and we now
have that ψW is an everywhere defined, measure-preserving map from (Ω, F, µ) to
(ΩW , GW , µW ).
−1
To complete the proof, we need to show that ψW
(GW ) = FW . To this end, we
−1
−1
1 e e
note that for each open A ⊆ L (Ω, FW , µ
e), ψW (A) = ψW
(A ∩ ΩW ), which shows
−1 e
−1
that ψW (G) = ψW (GW ). This proves the last claim.


Lemma 8.13. Let ΩW and µW be as defined above, and let GW be the Borel σalgebra over ΩW . If W is locally finite, W (x, ·) is integrable for all x ∈ Ω, and
µ(Ω \ dsupp W) < ∞, then (ΩW , GW , µW ) is σ-finite.
Remark 8.14. Note that the condition µ(Ω \ dsupp W) < ∞ is necessary, since
otherwise the point {(0, 0)} becomes an atom with infinite measure.
Proof. By Proposition 8.12, we can change W on a set of measure zero such that it
still satisfies the conditions of the lemma, and ψW becomes a measure-preserving
map from (Ω, F, µ) to (ΩW , GW , µW ). Let Ω0 ⊂ L1 (Ω, F, µ) × R be the subspace
consisting of just the origin, i.e., Ω0 = {(0, 0)}. Then
−1
µW (Ω0 ) = µ(ψW
(Ω0 )) = µ({x ∈ Ω : kψW (x)k1 = 0}) = µ(Ω \ dsupp W) < ∞.

Next define Ωn = {(f, c) ∈ ΩW : kf k1 + c ≥ 1/n} for n ≥ 1. Then
µW (Ωn ) = µ({x ∈ Ω : kψW (x)k1 +S(x) ≥ 1/n}) = µ({x ∈ Ω : DW (x) ≥ 1/n}) < ∞.
Here the last inequality follows from Proposition 2.4. Since ΩW = Ω0 ∪ Ω1 ∪ . . . ,
this proves that µW is σ-finite.

W on ΩW such that its
Next, we would like to show that we can define a graphex c
pullback is equal almost everywhere to W. Using Proposition 8.12, we can without
loss of generality assume that ψW is a measure-preserving map from (Ω, F, µ) to
∗
(ΩW , GW , µW ). By Lemma 3.2, this implies that the map ψW
: L1 (ΩW , GW , µW ) →
−1
ψW
1
and FW = ψW (GW ) is an isometric isomorphism. Note
L (Ω, FW , µ) with f 7→ f
∗
∗ −1
that this in particular implies that ψW
and (ψW
)
are continuous, and hence
measurable.
Now, since ΩW is a separable metric space, L1 (ΩW , GW , µW ) is separable, so there
exists an evaluation map
Φ : L1 (ΩW , GW , µW ) × ΩW → R
such that for every α ∈ L1 (ΩW , GW , µW ) and almost every g ∈ ΩW , α(g) = Φ(α, g).
Note that by definition, we also have that for every fixed α and almost every y ∈ Ω,
∗
ψW
(α)(y) = α(ψW (y)) = Φ(α, ψW (y)).
e FeW , µ
By Proposition 8.12, ΩW ⊆ L1 (Ω,
e) = L1 (Ω, FW , µ) × R, which means that
∗ −1
(ψW ) (f |Ω ) is well defined for all f ∈ ΩW . We therefore may define

∗ −1
c0 (f, g) = Φ (ψW
W
) (f |Ω ), g

92

BORGS, CHAYES, COHN, AND LOVÁSZ

and



c0 (f, g) + W
c0 (g, f ) .
c (f, g) = 1 W
W
2
∗ −1
c0 and hence W
c is measurable.
Since (ψW
) is measurable, W
Suppose ψW (x) ∈ ΩW . Then, noting that for all x, ψW (x)|Ω = ψW (x), we have
for almost all y,

c0 (ψW (x), ψW (y)) = Φ( ψ ∗ )−1 (ψW (x)|Ω ), ψW (y)
W
W


∗
∗ −1
= ψW
(ψW
) (ψW (x)|Ω ) (y) = ψW (x)(y) = W (x, y),
where the third and the fourth terms are only defined for almost all y. Thus
c ψW and hence W
c ψW is equal to W almost everywhere on Ω × Ω. We also define
W
0
b ) = f (Ω∞ ), which gives us that for x ∈ Ω,
S(f
b W (x)) = ψW (x)(Ω∞ ) = S(x),
S(ψ
W =
implying that S ψW = S. Finally, we take Ib = I, giving us a graphex c
c , S,
b I,
b ΩW ) such that c
(W
WψW = W almost everywhere.
Note that this implies in particular that c
W inherits the local finiteness property
from W, so c
W is a bona fide graphex over the σ-finite Borel space (ΩW , GW , µW ).
c ψW = W and SbψW = S almost everywhere
Note that the requirement that W
c
c0
uniquely determines W up to changes on a set of measure zero. Indeed, if W
0ψ
ψ
c W = W
c W (µ × µ)-almost everywhere, then by the
is another graphon with W
c0 = W
c must hold
definition of pullbacks and the definition of µW , the equality W
0
b
(µW × µW )-almost everywhere. Similarly, if S is another function with Sb0ψW = SbψW
µ-almost everywhere, then Sb0 = Sb µW -almost everywhere. Also by definition we
b
must have Ib0 = I.
On the other hand, suppose we have two graphexes W1 and W2 on the same
space Ω with W1 = W2 almost everywhere, S1 = S2 almost everywhere, and I1 = I2 .
We have seen that ΩW1 = ΩW2 and µW1 = µW2 . Since their pullbacks are equal
c1 = W
c2 almost everywhere for any choices of
almost everywhere, we must have W
c
c
b
b
b
b
W1 and W2 , and S1 = S2 and I1 = I2 by definition.
Finally, if the graphex W only has the property that W (x, ·) is integrable for
c such
almost every x, we can still define ΩW and µW in the same way, and find a W
that the pullback is defined almost everywhere on Ω × Ω and equal to W almost
everywhere. Again, it is easy to see that we obtain the same ΩW and µW if we first
modify W on a set of measure zero to make W (x, ·) integrable for every x, and any
c will be equal almost everywhere. Therefore, this construction gives a
choice of W
c
graphex W on (ΩW , GW , µW ) for any graphex W.
Next, we show the following:
Lemma 8.15. For i = 1, 2, let Wi = (Wi , Si , Ii , Ωi ) be graphexes with Ωi =
(Ω1 , Fi , µi ) and µi (Ωi \dsupp Wi ) = 0. Suppose that there exists a measure-preserving
e1 → Ω
e2
map φ : Ω1 → Ω2 such that W1 = Wφ2 almost everywhere. Extend φ to φe : Ω
∗
1 e
1 e
e
e
by φ(Ω1,∞ ) = Ω2,∞ . Then the map φ : L (Ω2 ) → L (Ω1 ) defined by f 7→ f ◦ φe
restricts to a map ΩW2 → ΩW1 , which is an isometric measure-preserving bijection
∗
between (ΩW2 , GW2 , µW2 ) and (ΩW1 , GW1 , µW1 ), and c
W2 = c
Wφ1 almost everywhere,
for any choices of c
W1 and c
W2 .

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

93

Proof. By the remarks before the lemma, we may assume that W1 = Wφ2 everywhere,
not just almost everywhere, and W1 (x, ·) and W2 (x0 , ·) are always integrable. Since
e 2 , Fe2 , µ
φ and thus φe is measure preserving, φe∗ is isometric and injective from L1 (Ω
e2 )
1 e
−1 e
e
to L (Ω1 , φ (F2 ), µ
e2 ) by Lemma 3.2. If x ∈ Ω1 , then for almost every y ∈ Ω1 (note
that the first two terms below are only defined for almost every y),
(φ∗ ◦ ψW2 ◦ φ)(x)(y) = (ψW2 ◦ φ)(x)(φ(y)) = W2 (φ(x), φ(y)) = W1 (x, y).
Therefore φ∗ ◦ ψW2 ◦ φ = ψW1 a.e. Furthermore,
(id ◦S2 ◦ φ)(x) = S2 (φ(x)) = S1 (x),
which implies that (id ◦S2 ◦ φ) = S1 . Since φe∗ = φ∗ × id and ψWi = ψWi × S, this
e 1 ) be Borel
implies that φe∗ ◦ ψW2 ◦ φ = ψW1 almost everywhere. Now let A ⊆ L1 (Ω
measurable. Then
µW ((φe∗ )−1 (A)) = µ2 (ψ −1 ((φe∗ )−1 (A)))
2

W2

= µ1 (φ

−1

−1 e∗ −1
(ψW
((φ ) (A))))
2

−1
= µ1 (ψW
(A)) = µW1 (A).
1

So φ∗ × id : L1 (Ω2 ) × R → L1 (Ω1 ) × R is a measure preserving isometry. Since it is
an isometry, in particular, it is continuous. Thus, (φ∗ × id)−1 (L1 (Ω1 ) × R \ ΩW1 )
is an open set with measure zero, so it is disjoint from ΩW2 . This implies that φ∗
restricts to a measure-preserving injection ΩW2 → ΩW1 . Since ΩW2 is complete,
(φ∗ × id)(ΩW2 ) is a complete subset of ΩW1 , which is itself complete. Therefore
φ∗ (ΩW2 ) is a closed subset of ΩW1 . However, we also have that
µW1 (ΩW1 \φ∗ (ΩW2 )) = µW2 ((φ∗ )−1 (ΩW1 \φ∗ (ΩW2 ))) = µW2 ((φ∗ )−1 (ΩW1 )\ΩW2 ) = 0.
But ΩW1 \ φ∗ (ΩW2 ) is an open subset of ΩW1 of measure 0, which means it must be
the empty set because µW1 has full support in ΩW1 . Therefore, φ∗ : ΩW2 → ΩW1 is
a measure-preserving isometry of metric measure spaces.
∗
c φe = W
c2 . We have that almost everywhere on
Now, we want to show that W
1
Ω 1 × Ω1 ,
e∗
∗
c φe )ψW2 )φ = W
c φ ◦ψW2 ◦φ = W
c ψW1 = W1 = W φ .
((W
1

∗

1

1

2

∗

c φ )ψW2 = W2 almost everywhere, but then W
cφ = W
c2 almost everyTherefore (W
1
1
∗
φ
where. By definition, we also have Sb1 = Sb2 , and Ib1 = I1 = I2 = Ib2 .

Now, suppose W1 and W2 are equivalent. Then their restrictions to their
respective degree supports are also equivalent. By Corollary 8.7, there exists
a chain of pullbacks that link W1 and W2 . We have seen that if a graphex is a
pullback of another, then the construction above yields an isomorphism between the
corresponding graphexes, up to almost everywhere changes. This clearly extends to
chains of pullbacks; thus, we may find an isomorphism between ΩW1 and ΩW2 so that
c
W1 and c
W2 are equal almost everywhere. We can extend the map ψWi : Ωi → ΩWi ,
which is defined almost everywhere, to be defined everywhere, by mapping the rest
of the points in Ωi to an arbitrary point.
9. Uniform integrability and uniform tail regularity
9.1. Uniform integrability. The goal of this subsection is to prove Theorem 2.26.
Before doing this we establish that several alternative definitions of uniform integrability are equivalent to Definition 2.25.

94

BORGS, CHAYES, COHN, AND LOVÁSZ

Theorem 9.1. Given a set of integrable graphexes S, the following are equivalent.
(1) S is uniformly integrable.
(2) The graphexes in S have uniformly bounded k · k1 -norms, and for every
ε > 0, there exists a D such that for all W ∈ S, kWk1 − kW≤D k1 < ε.
(3) For any T > 0, the random variables E(GT (W)) with W ∈ S are uniformly
integrable.
(4) There exists T > 0 such that the random variables E(GT (W)) with W ∈ S
are uniformly integrable.
Proof. Throughout this proof, let Ω>D , Ω≤D , W>D , W≤D , etc, be defined as before.
Let us first show (1) ⇒ (2). We have that
Z
Z
kW1 k1 − kW≤D k1 = 2
S(x) dµ(x) + 2
W (x, y) dµ(x) dµ(y)
Ω>D ×Ω≤D

Ω>D

Z
+

W (x, y) dµ(x) dµ(y)
Z
DW (x) dµ(x) −
W (x, y) dµ(x) dµ(y)
Ω>D ×Ω>D

Z
=2

Ω>D ×Ω>D

Ω>D

Z
≤2
Ω

DW 1DW >D dµ.

Therefore, taking D for ε/2 in uniform integrability gives a good D for ε in (2).
To show that (2) ⇒ (3), we first show that if a set of graphexes has uniformly
bounded marginals, then the set of random variables is uniformly integrable. Let
ET be the random variable for a fixed W ∈ S that gives the number of edges of
GT (W). Recall that by Lemma 4.3, ET has expectation T 2 kWk1 /2 and variance
T 2 kWk1 /2 + T 3 kDW k22 . Let C be a bound on kWk1 for W ∈ S. We then have that
for any K > T 2 kWk1 /2,
P[ET > K] ≤

T 2 C/2 + T 3 CD
T 2 kWk1 /2 + T 3 kDW k22
≤
.
(K − T 2 kWk1 /2)2
(K − T 2 C/2)2

If K ≥ T 2 C, then this gives
P[ET > K] ≤

T 2 C/2 + T 3 CD
T 2 C/2 + T 3 CD
2T 2 C + 4T 3 CD
≤
=
.
2
2
2
(K − T C/2)
(K/2)
K2

Therefore, for K0 ≥ T 2 C,
E[ET 1ET >K0 ] =
≤

∞
X
K=K0 +1
∞
X
K=K0 +1

P[ET ≥ K]
2T 2 C + 4T 3 CD
2T 2 C + 4T 3 CD
≤
.
K2
K0

Suppose now that instead of uniformly bounded marginals, we have only (2). For
D > 0, let ET,D be the number of edges that either have both endpoints labeled
with a vertex in Ω≤D , one endpoint is labeled with a vertex in Ω≤D and the edge is
generated as a star from that vertex, or the edge is a dust edge. We then have that

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

95

for all D > 0,
E[ET 1ET >2K0 ] = E[ET 1ET >2K0 ,ET ,D >K0 ] + E[ET 1ET >2K0 ,ET ,D ≤K0 ]
≤ E[ET − ET,D ] + E[ET,D 1ET ,D >K0 ]
+ E[ET,D 1ET ,D ≤K0 ,ET −ET ,D >K0 ]
2T 2 C + 4T 3 CD
+ K0 P[ET − ET,D > K0 ]
K0
2T 2 C + 4T 3 CD
≤ 2E[ET − ET,D ] +
,
K0

≤ E[ET − ET,D ] +

provided K0 ≥ T 2 C. Condition (2) now implies that for any ε > 0, there exists a D
such that E[ET,D − ET ] < ε. Given such a D, we choose K0 in such a way that the
last term in the above bound is at most ε, implying that for each ε > 0 we can find
a K0 such that E[ET 1ET >2K0 ] ≤ 3ε. This proves that the set of random variables
ET are indeed uniformly integrable.
It is clear that (3) implies (4). Suppose now that (4) holds. Since the expectation
of ET is T 2 kWk1 /2, kWk1 must be uniformly bounded for W ∈ S. Let C be an
upper bound. Suppose that (1) is false. Then there exists a fixed ε > 0, such that
for any D, there exists a graphex W ∈ S such that
Z
DW 1DW >D dµ ≥ ε.
Ω>D

Since E[DW ] ≤ kWk1 ≤ C, we have that µ(Ω>D ) ≤ C/D. By taking D large enough,
we can assume that C/D ≤ D/2. Let FT,D be the number of edges in GT (W) that
have exactly one endpoint in Ω>D . Then
Z
Z
E[FT,D ] ≥
T 2 (DW (x) − C/D) dµ(x) ≥ T 2
(DW (x)/2) dµ(x) ≥ T 2 ε/2.
Ω>D

Ω>D

If there are no points sampled in Ω>D , then FT,D = 0. Conditioned on there being
at least one point sampled in Ω>D , the number of neighbors of a point whose feature
is x ∈ Ω>D is a Poisson random variable with mean equal to T DW (x)/2 ≥ T D/2.
Therefore,
E[FT,D |FT,D > 0] ≥ T D/2.
We also have that
E[FT,D 1FT ,D ≤T D/4 |FT,D > 0] ≤ T D/4.
Therefore,
E[FT,D 1FT ,D >T D/4 |FT,D > 0] ≥

1
E[FT,D |FT,D > 0].
2

We then have
E[FT,D 1FT ,D >T D/4 ] = E[FT,D 1FT ,D >T D/4 |FT,D > 0]P[FT,D > 0]
1
1
≥ E[FT,D |FT,D > 0]P[FT,D > 0] = E[FT,D ] ≥ T 2 ε/4.
2
2
Since D can be arbitrary (above some D0 ), this contradicts Condition (4).
Theorem 2.26 is an easy corollary of Theorem 9.1.



96

BORGS, CHAYES, COHN, AND LOVÁSZ

Proof of Theorem 2.26. By Theorem 2.18, Wn is GP-convergent to W. Fix a subsequence ni such that lim inf n→∞ kWn k1 = limi→∞ kWni k1 , and fix T > 0. Let ei
be the number of edges in GT (Wni ), and let e be the number of edges in GT (W).
Following the proof of Corollary 3.10 in [4], for λ > 0 define fλ : R+ → R+ by
fλ (x) = x1x≤λ . Then E[fλ (ei )] ≤ E[ei ] = T 2 kWni k1 . Since ei → e in distribution,
E[fλ (e)] = limi→∞ E[fλ (ei )] ≤ T 2 limi→∞ kWi k1 = lim inf n→∞ kWn k1 . The monotone convergence theorem then gives that T 2 kWk1 = E[e] = limλ→∞ E[fλ (e)] ≤
T 2 lim inf n→∞ kWn k1 , proving the first part of the theorem.
To prove the second part, assume first that Wn is uniformly integrable, and fix
ε > 0. By Theorem 9.1 (2), for every ε > 0, there exists a D such that each Wn has
|kWn k1 − kWn,≤D k1 | ≤ ε.
Since W is integrable, after possibly increasing D, we can also assume that
|kWk1 − kW≤D k1 | ≤ ε.
Increasing D further, we may also assume that µ({DW = D}) = 0. By Proposition 4.6, δ2→2 (Wn,≤D , W≤D ) → 0, which implies in particular that kWn,≤D k1 →
kW≤D k1 . Therefore, we can take n0 so that if n ≥ n0 , then
|kW≤D k1 − kWn,≤D k1 | ≤ ε.
These three inequalities imply that if n ≥ n0 , then
|kWn k1 − kWk1 | ≤ 3ε.
Since ε was arbitrary, this completes the proof of the first direction.
For the other direction, fix ε. Since W is integrable, there exists D > 0 such that
kW≤D k1 ≥ kWk1 − ε/2.
By increasing D, we can assume that µ({DW = D}) = 0. By Proposition 4.6,
kWn,≤D k1 → kW≤D k1 .
We then have that



lim sup kWn k1 − kWn,≤D k1 = lim sup (kWn k1 − kWk1 ) + (kWk1 − kW≤D k1 )
n→∞
n→∞

+ (kW≤D k1 − kWn,≤D k1 ) ≤ ε/2.
Therefore, there exists an n0 such that if n > n0 , then
kWn k1 − kWn,≤D k1 < ε.
Since W1 , W2 , . . . , Wn0 is a finite set of graphexes, each of which is integrable, we
can increase D so that the above inequality holds for each n, which by Theorem 9.1
means that they are uniformly integrable.

9.2. Uniform tail regularity. The goal of this subsection is to prove Theorem 2.28.
Before doing this, we show that uniform tail regularity implies uniform integrability.
Lemma 9.2. Suppose that a set of graphexes consisting only of graphons is uniformly
tail regular. Then the set is uniformly integrable.

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

97

Proof. Fix ε > 0. By the definition of tail regularity, we can find an M < ∞ such
that for each graphon W in the set there exists a subset Ω0 of measure at most
M such that kW k1 − kW |Ω0 k1 ≤ ε/3. Note that clearly kW k1 ≤ M 2 + ε/3, so in
particular the set of graphons has uniformly bounded L1 norm. Let
A = {x ∈ Ω0 , DW (x) > 2M }.
Note that for any x ∈ A,
Z
Z
W (x, y) dµ(y) ≥ DW (x) −
Ω\Ω0

W (x, y) dµ(y) ≥ DW (x) − M ≥ M,

Ω0

which implies that
µ(A) ≤

1
M

Z

W dµ2 ≤

A×Ω\Ω0

1
M

Z
DW dµ ≤
Ω\Ω0

ε
.
3M

We then have
Z
Z
Z
DW dµ +
DW dµ
DW 1DW >2M dµ ≤
A
Ω
Ω\Ω0
Z
Z
DW dµ +
W (x, y) dµ(x) dµ(y)
=
A×(Ω\Ω0 )
Ω\Ω0
Z
W (x, y) dµ(x) dµ(y)
+
A×Ω0
Z
Z
W (x, y) dµ(x) dµ(y)
DW dµ +
≤2
Ω\Ω0

A×Ω0

≤ 2ε/3 + µ(A)µ(Ω0 ) ≤ ε.



Next, we show the following lemma. As before, Ω>δ is the set {x ∈ Ω : DW (x) >
δ}.
Lemma 9.3. Given a set of graphons S, the following are equivalent:
(1) The set of graphons is uniformly tail regular.
(2) The set of graphons has a uniform bound on their k · k1 -norm, and for every
ε, there exists a δ such that kW k1 − kW |Ω>δ k1 ≤ ε.
(3) The set of graphons has a uniform bound on their k · k1 -norm, and for every
ε, there exists a δ such that kDW 1DW ≤δ k1 ≤ ε.
Corollary 9.4. Given a set of graphons S, suppose that we replace each graphon
with a pullback. Let S 0 be the new set. Then S 0 is uniformly tail regular if and only
if S is.
Proof. Property (2) in Lemma 9.3 is unaffected by taking pullbacks.



Proof of Lemma 9.3. We first show that (1) implies (2). Fix ε > 0. Take M for
ε/2 as in the definition of uniform tail regularity, let δ = ε/4M . Fix an arbitrary
graphon W ∈ S, and let Ω0 be a set of measure M such that
kW k1 − kW |Ω0 k1 ≤ ε/2.
1

Note that W has L norm at most M 2 + ε/2, which proves that the graphs have a
uniform bound on their k · k1 -norm. Now, we have
kW k1 −kW |Ω>δ k1 ≤ kW k1 −kW |Ω0 k1 +kW |Ω0 k1 −kW |Ω0 ∩Ω>δ k1 ≤ ε/2+2δM ≤ ε.
This shows that (1) implies (2).

98

BORGS, CHAYES, COHN, AND LOVÁSZ

The fact that (2) implies (1) follows from the observation that
Z
Z
DW (x)
1
µ(Ω>δ ) = dµ(x)1DW (x)>δ ≤ dµ(x)
= kW k1 .
δ
δ
Finally, (2) and (3) are equivalent by the fact that
Z
Z
Z
Z
W ≤
W−
W ≤2
Ω×Ω\Ω>δ

Ω×Ω

Ω>δ ×Ω>δ

W.



Ω×Ω\Ω>δ

To prove Theorem 2.28 we establish three more lemmas.
Lemma 9.5. Suppose that a sequence of integrable graphons Wn converge to a
graphon W in the cut metric. Then for any D > 0 such that µ(DW = D) = 0, the
graphons Wn,≤D converge to W≤D in the cut metric.
e n be the
Proof. Let µ
en be a coupling of trivial extensions of Wn and W , and let Ω
f
f
product space on which the coupling is defined. Let Wn and W be the pullbacks of
e n , and suppose that
the trivial extensions to Ω
fn − W
f k < ε.
kW
Defining A = {DW
fn − DW
f > 0} and B = {DW
f − DW
fn > 0}, we then have that
µ
en ({|DW
fn − DW
f| >

√

1
ε}) ≤ √ kDW
f k1
fn − DW
ε
Z
Z

√
1 
fn − W
f) +
f−W
fn ) < 2 ε.
=√
(W
(W
ε A×Ω
en
en
B×Ω

As a consequence,
µ
en ({DW
f ≤ D})
fn > D, DW

√
√
≤µ
en ({|DW
ε}) + µ
en ({D − ε < DW
f| >
fn − DW
f ≤ D})
√
√
< 2 ε + µ({D − ε < DW ≤ D}).

For any δ > 0, we can take ε small enough so that this is at most δ. Similarly, we
have
µ
en ({DW
fn ≤ D, DW
f > D})

√
√
ε}) + µ
en ({D < DW
ε})
≤µ
en ({|DW
f ≤D+
fn − DW
f| >
√
√
< 2 ε + µ({D < DW ≤ D + ε}),

which is also at most δ if ε is small enough.
Next we trivially extend Wn,≤D and W≤D first to the spaces Wn and W are
fn,≤D and W
f≤D
defined on, and then to the spaces used in the coupling µ
en . Let W
2
f0
f
be the pullbacks, let W
f ≤ D} and 0 otherwise,
n,≤D be equal to Wn,≤D on {DW
0
2
f
f≤D on {D f ≤ D} and 0 otherwise. Then W
fn,≤D
and let W
be equal to W
≤D

Wn

f0
and W
fn ≤ D, DW
f > D} × {DW
fn ≤ D} and its transpose.
n,≤D differ only on {DW
Indeed, if DW
>
D
in
either
coordinate,
then
both
graphons are zero, and if
fn
DW
≤
D
in
both
coordinates,
then
by
the
definition
they are the same. Since
f
f
Wn,≤D has maximum degree D, this implies that
0
0
fn,≤D − W
fn,≤D
fn,≤D − W
fn,≤D
kW
k ≤ kW
k1 ≤ 2e
µn ({DW
fn ≤ D, DW
f > D})D ≤ 2δD.

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

99

Analogously,
0
f≤D − W
f≤D
kW
k ≤ 2δD.
f0
f0
f
f
Note that W
fn ≤
n,≤D and W≤D are equal to Wn and W , respectively, on {DW
2
0
0
f
f
D, D f ≤ D} , and zero everywhere else, which implies that W
is the
−W
n,≤D

W

≤D

fn − W
f to {DW ≤ D, DW ≤ D}2 . This implies that
restriction of W
n
0
0
fn,≤D
f≤D
fn − W
f k < ε,
kW
−W
k ≤ kW

which in turn implies that
fn,≤D − W
f≤D k ≤ kW
fn,≤D − W
f0
f0
f0
kW
n,≤D k + kWn,≤D − W≤D k
f0 − W
f≤D k
+ kW
≤D
≤ 4δD + ε.
Taking ε small enough, this can be made arbitrarily small, which completes the
proof.

We also have the following:
Lemma 9.6. Suppose that a sequence of integrable graphons Wn have uniformly
bounded marginals, and converge to a (necessarily integrable) graphon W in the cut
metric. Then W has the same bound on its marginals, and δ2→2 (Wn , W) → 0.
Proof. Suppose that for each n, DWn ≤ D almost everywhere, but DW > D on a set
of positive measure. Then there exists D0 ≥ D such that µ({DW > D0 }) > 0 and
µ({DW = D0 }) = 0. By Lemma 9.5, Wn,≤D0 converges to W≤D0 in the cut metric,
but the cut distance of Wn,≤D0 from Wn is 0, since DWn ≤ D almost everywhere.
Therefore, the cut distance of W≤D0 and W is 0, which is a contradiction.
Now, we have the following. Since kWn k1 → kW k1 , there exists a uniform bound
C on kWn k1 and kW k1 , which implies that kWn − W k1 ≤ 2C. Furthermore, for
any x, |D|Wn −W | (x)| ≤ DWn (x) + DW (x) ≤ 2D. By Lemma 3.22, and recalling
p
that kU k ≤ kU k kU k∞ , we have

1/4
3/4
3/2
kWn − W k2→2 ≤ 8kWn − W k kWn − W k3/4
kD
k
kW
−
W
k
n
|W
−W
|
∞
∞
1
n

1/4
1/2
3/4
3/2
≤ 8kWn − W k kWn − W k5/4
kD
k
kW
−
W
k
n
|Wn −W | ∞
∞
1

1/4
1/2
≤ 100D3/2 C 3/4 kWn − W k
→ 0.
Furthermore, note that
kDWn


Z



− DW k1 ≤ 2 sup  DWn − DW  ≤ 2kWn − W k .
S
S

Therefore,
kDWn − DW k2 = kDWn − DW k2
p
p
≤ kDWn − DW k1 kDWn − DW k∞ ≤ 4DkWn − W k → 0.
Finally,
kWn k1 = kWn k1 → kW k1 = kWk1 .
The last lemma we need to prove Theorem 2.28 is the following.



100

BORGS, CHAYES, COHN, AND LOVÁSZ

Lemma 9.7. Suppose that δ (W, W0 ) = 0 for two integrable graphexes, and suppose
that W = (W, 0, 0, Ω). Then W0 = (W 0 , 0, 0, Ω0 ) and δ (W, W 0 ) = 0.
Proof. Since δ (W, W0 ) = 0, ξ(G(W)) and ξ(G(W0 )) have the same distribution.
But, as already observed in Remark 5.4 in [17], almost surely, the dust part of W0
generates edges which are isolated, the star part generates edges with one vertex of
degree one and a second vertex of infinite degree, and the graphon part generates
edges with two endpoints of infinite degree. Since ξ(G(W)) has no star or dust
edges, ξ(G(W0 )) doesn’t have these either, showing that W0 = (W 0 , 0, 0, Ω0 ). Finally,
since the graphon process generated by W and W 0 have the same distribution,
δ (W, W 0 ) = 0 by Theorem 27 in [3].

We are now ready to prove Theorem 2.28.
Proof of Theorem 2.28. First, we show that if a sequence converges in the cut
metric, then it converges in δ . We show property (2) from Proposition 4.6. Since
the graphons converge in cut metric, we must have in particular that kWn k1 =
kWn k1 → kW k1 = kWk1 , which implies that the set {kWn k}n is uniformly bounded;
therefore, the sequence is tight by Corollary 4.2 (1). By Lemma 9.5, for any D > 0
with µ({DW = D}) = 0, Wn,≤D converges to W≤D in cut metric, and by Lemma
9.6, they must also converge in δ2→2 , which completes the proof that cut metric
convergence implies weak kernel convergence. Since we know that any cut metric
convergent sequence is uniformly tail regular, this completes that proof that (1)
implies (2). It is clear that (2) is stronger than (3), so it remains to show that (3)
implies (1).
To this end, we first note that uniform tail regularity implies uniformly bounded
L1 norms, which by Theorem 2.26 implies that W is integrable. Suppose that W
does not consist of only a graphon part, or that Wn does not converge to it in the cut
metric. Since the sequence Wn is uniformly tail regular, we may choose a subsequence
that converges to an integrable graphon W 0 , such that either δ (W 0 , W ) 6= 0, or
W is not just a graphon. In either case, letting W0 = (W 0 , 0, 0, Ω0 ), we have by
Lemma 9.7 that δ (W, W0 ) 6= 0. However, since δ (Wn , W 0 ) → 0, we must have that
δ (Wn , W0 ) → 0, which implies that δ (W0 , W) = 0, which is a contradiction. This
completes the proof that (3) implies (1), and thus we have proven the theorem. 
Proof of Theorem 2.29. First, assume that W = (W, 0, 0, Ω), and let us prove (2).
Assume first that the sequence has uniformly bounded marginals. In this case,
δ2→2 (Wn , W) → 0. Take a sequence of couplings of trivial extensions of Wn and W
which show that their kernel distance goes to zero, let Ω0n be the space for each n,
and W0n and Wn the pulled back graphexes, and let Wn0 and W n be their graphon
parts. By Corollary 9.4, it is enough to prove uniform tail regularity for Wn0 . Given
ε > 0, let δ > 0 be such that
kW k1 − kW |Mδ k1 ≤ ε,
where Mδ is the set
Mδ = {x ∈ Ω : DW (x) ≥ δ}.
Let

Mδn

be the pullback to Ω0n . We then have that
kWn0 − W n k2→2 → 0.

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

Since Mδn has finite measure, this implies that
Z
Z
Wn0 →
Mδn ×Mδn

W.

Mδ ×Mδ

Since kW0n k1 = kWn k1 → kWk1 = kW k1 , this implies that
Z
Z



lim sup kWn0 k1 −
Wn0 ≤ lim sup kW0n k1 −
n→∞

n→∞

Mδn ×Mδn

101

Mδn ×Mδn


Wn0 ≤ ε.

This can be made arbitrarily small by taking δ small enough, which proves uniform
tail regularity under the assumption of uniformly bounded marginals. On the other
hand,




2 lim sup kSn k1 + In = lim sup kWn k1 − kWn0 k1
n→∞
n→∞
Z
≤ kW k1 − lim
Wn0 ≤ ε,
n→∞

Mδn ×Mδn

which implies that kSn k1 → 0 and In → 0, completing the proof of (2) under the
assumption of uniformly bounded marginals.
If instead of uniformly bounded marginals, we have uniform integrability, then
the claims follow from the fact that for each
R D > 0, δ2→2 (Wn,≤D , W≤D ) → 0, and
we can take D large enough so that each Ωn,>D Sn is less than ε and
Z
Wn < ε,
Ω×Ω>D

and In is unaffected by the restriction.
Conversely, assume (2). Let, for each n, W0n = (Wn , 0, 0, Ω) (so we are replacing
Sn and In with 0). Since kSn k1 → 0 and In → 0,
δ (Wn , W0n ) → 0
R
Indeed, clearly |kWn k1 − kW0n k1 | → 0, and for any D > 0, we have that Ω≤D Sn2 ≤
DkSn k1 → 0. Taking D large enough that Ω>D has small measure, we can show
that δ (Wn , W0n ) is arbitrarily small for large enough n. Now, the statement follows
from Theorem 2.28; specifically, we have shown that (3) holds for the sequence W0n ,
which by (2) implies that the limit is a pure graphon.
The equivalence of (2) and (3) follows from Theorem 2.28 applied to the sequence
W0n .


Acknowledgements
László Miklós Lovász thanks Microsoft Research New England for an internship
in the summer of 2016, when most of the research part of this work was done. László
Miklós Lovász was also supported by NSF Postdoctoral Fellowship Award DMS
1705204 for part of this work. All of us thank Svante Janson and Nina Holden for
various discussions about the work presented here.

102

BORGS, CHAYES, COHN, AND LOVÁSZ

Appendix A. Local finiteness
In this appendix, we prove Proposition 2.4.
Throughout this appendix, Ω = (Ω, F, µ) will be a σ-finite measure space,
S : Ω → R+ will
P be measurable, W : Ω × Ω → [0, 1] will be a symmetric, measurable
function, η = i δxi will be a Poisson point process on Ω with intensity µ, and
X
X
η(S) =
S(xi )
and
η 2 (W ) =
W (xi , xj ).
i

i6=j

We start with the following lemma, which is the analogue of Lemma A.3.6 from [19]
for general measure spaces. We use E to denote expectations Rwith respect to the Poisson point process and W ◦W to denote the function (x, y) 7→ W (x, z)W (z, y) dµ(z).
Lemma A.1. Let ψ(x) = 1 − e−x . Then the following hold, with both side of the
various identities being possibly infinite:
(1) E[η(S)] = kSk1 and E[η 2 (W )] = kW k1 ,
(2) E[ψ(η(S))] = ψ(kψ(S)k1 ), and
(3) E[(η 2 (W ))2 ] = kW k21 + 4kW ◦ W k2 + 2kW 2 k1 .
Proof. We first assume that m = µ(Ω) is finite and S is bounded. Then η can be
generated by first choosing N as a Poisson random variable with rate m and then
1
choosing x1 , . . . , xN i.i.d. according to the distribution m
µ. Conditioned on N , the
N (N −1)
N
2
expectations of η(S) and η (W ) are m kSk1 and m2 kW k1 , respectively, and the
expectation of ψ(η(S)) is
E[ψ(η(S)) | N ] = 1 − E[e−
=1−

N
Y

PN

1
m
i=1

i=1

Z

S(xi )

]

dµ(xi )e−S(xi ) = 1 −

Ω

1 Z
N
dµ(x)e−S(x) .
m Ω

Therefore,
∞
X

E[η(S)] =

e−m

N =0

∞
X
mN N
mN −1
kSk1 =
e−m
kSk1 = kSk1 .
N! m
(N − 1)!
N =1

Also,
∞
X

E[η 2 (W )] =

e−m

N =0

∞
X
mN −2
mN N (N − 1)
kW
k
=
e−m
kW k1 = kW k1 .
1
2
N!
m
(N − 2)!
N =,

Finally,
∞
X

mN
N!


1 Z
N 
1−
dµ(x)e−S(x)
m Ω
N =0
Z
∞
N
X
mN  1
=1−
e−m
dµ(x)e−S(x)
N! m Ω
N =0
Z

Z

= 1 − exp
e−S(x) dµ(x) − m = 1 − exp
−ψ(S(x)) dµ(x)

E[ψ(η(S))] =

e−m

Ω

= 1 − ekψ(S)k1 = ψ(kψ(S)k1 ).

Ω

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

103

To calculate the expectation of
(η 2 (W ))2 =

XX

E[W (xi , xj )W (xk , x` )]

i6=j k6=`

we distinguish whether {i, j} and {k, `} intersect in 0, 1, or 2 elements, leading to
the expression
E[(η 2 (W ))2 | N ] =

N (N − 1)(N − 2)(N − 3)
kW k21
m4
4N (N − 1)(N − 2)
2N (N − 1)
+
kW ◦ W k1 +
kW 2 k1 .
m3
m2

Taking the expectation over N gives the expression in the lemma similarly. This
completes the proof for spaces of finite measure and bounded functions S. The
general case follows by the monotone convergence theorem.

Using Lemma A.1, we now prove the following proposition, which is the analogue
of the relevant parts for us of Theorem A3.5 from [19] for general σ-finite measure
spaces.
Proposition A.2. Let S : Ω → R+ be measurable, and let W : Ω × Ω → [0, 1] be
symmetric and measurable. Then the following hold:
(1) η(S) < ∞ a.s. if and only if k min{S, 1}k1 < ∞, and
(2) η 2 (W ) < ∞ a.s. if and only if there exists a finite D > 0 such that the
following three conditions hold:
(a) DW < ∞ almost surely,
(b) µ({x ∈ Ω : DW (x) > D}) < ∞, and
(c) kW |{x∈Ω:DW (x)≤D} k1 < ∞.
Proof. Since 12 min{1, x} ≤ ψ(x) ≤ min{1, x}, the condition k min{S, 1}k1 < ∞ in
(1) is equivalent to the statement that kψ(S)k1 < ∞, which is equivalent to the
statement that ψ(kψ(S)k1 ) < 1. By Lemma A.1 (2), this is equivalent to saying
that E[ψ(η(S))] < 1, which holds if and only if η(S) < ∞ with positive probability.
By Kolmogorov’s zero-one law, we either have η(S) < ∞ almost surely, or η(S) = ∞
almost surely; therefore we have obtained that k min{S, 1}k1 < ∞ if and only if
η(S) < ∞ almost surely.
To prove the second statement, assume first that the conditions (a)–(c) hold.
Condition (a) then implies that a.s., no Poisson point falls into the set {DW = ∞},
which means we may replace Ω by a space such that DW (x) < ∞ for all x ∈ Ω. Let
Ω>D = {x ∈ Ω : DW (x) > D} and Ω≤D = Ω \ Ω>D . Since Ω>D has finite measure
by assumption (b), we have that a.s., only finitely many Poisson points fall into this
set, which in particular implies that the contribution of the points xi , xj ∈ Ω>D to
η 2 (W ) is a.s. finite. Next let us consider the contributions to η 2 (W ) from pairs of
points xi , xj such that one lies in Ω>D and the other one lies in Ω≤D . Observing
that the Poisson process in Ω>D and Ω≤D are independent, and that a.s., there
are only finitely many points in Ω>D , it will clearly be enough to show that for all
x ∈ Ω>D , a.s. with respect to the Poisson process in Ω≤D ,
X
W (x, xj ) < ∞.
j:xj ∈Ω≤D

104

BORGS, CHAYES, COHN, AND LOVÁSZ

But by Lemma A.1 (1) applied to the function S 0 : Ω≤D → R+ defined by S 0 (y) =
W (x, y), the expectation of this quantity is equal to
Z
Z
0
S (y) dµ(y) =
W (x, y) dµ(y).
Ω≤D

Ω≤D

This is bounded by DW (x) and hence finite, which proves that the sum is a.s. finite.
We are thus left with estimating η 2 (W |Ω≤D ). Again by Lemma A.1 (1), we have
that E[η 2 (W |Ω≤D )] = kW |Ω≤D k1 which is finite by assumption (c), showing that
η 2 (W |Ω≤D ) is a.s. finite.
Conversely, let us assume that a.s., η 2 (W ) < ∞. First we will prove that this
implies µ({DW = ∞}) = 0. Assume for a contradiction that this is not the case.
Since µ is σ-finite, we can find a measurable set N ⊆ Ω such that DW (x) = ∞
for all x ∈ N and 0 < µ(N ) < ∞. Consider the contribution to η 2 (W ) by all
Poisson points (xi , xj ) such that xi ∈ N and xj ∈ N c = Ω \ N . Since the Poisson
processes on N and N c arePindependent, the finiteness of η 2 (W ) implies that for
almost all x ∈ N , the sum j:xj ∈N c W (x, xj ) is a.s. finite. Applying statement (1)
of the current proposition to W (x, ·)
R (and recalling that W is bounded by 1), we
W (x, y) dµ(y)
conclude that for almost
all
x
∈
N
,
< ∞, which implies that for
Nc
R
R
almost all x ∈ N , N W (x, y) dµ(y) = DW (x) − N c W (x, y) dµ(y) = ∞. This is a
contradiction since µ(N ) < ∞ and W ≤ 1.
We next prove (b) (for any value of D). Suppose for a contradiction that
µ({x ∈ Ω : DW (x) > D}) = ∞. We then claim that almost surely, η 2 (W ) = ∞.
After obtaining the Poisson process, color each point randomly red or blue, with equal
probability, independently. We can then obtain the red and blue points equivalently
by taking two independent Poisson processes, both with intensity µ/2. We claim that
almost surely, the sum of W (x, y) just over red-blue pairs is already ∞. We know
that almost surely, there are an infinite number of red points
P∞ xi with DW (xi ) > D.
Let xn be such a sequence, and given y ∈ Ω, let S 0 (y) = n=1 W (xn , y). Then the
sum of W over red-blue edges is equal to η(S 0 ) for the Poisson process with intensity
µ/2. Therefore, it suffices to prove that k min{S 0 , 1}k1,µ/2 = ∞. First, note that if
either µ({y ∈ Ω : S 0 (y) = ∞}) > 0 or µ({y ∈ Ω : S 0 (y) > 1}) = ∞, then it clearly
holds. Otherwise, we have that as D0 → ∞, µ({y ∈ Ω : S 0 (y) > D0 }) → 0; therefore,
there exists some D0 (without loss of generality, we may assume D0 ≥ 1) such that
µ({y ∈ Ω : S 0 (y) > D0 }) < D/2. Let Ω0 be the complement of {y ∈ Ω : S 0 (y) > D0 }.
We then have that for each xn ,
Z
Z
Z
dµ(y)
dµ(y)
dµ(y)
W (xn , y)
=
W (xn , y)
−
W (xn , y)
2
2
2
0
0
Ω
Ω
Ω\Ω
1
1
D D
≥ DW (xn ) − µ(Ω \ Ω0 ) ≥
− .
2
2
2
4
We also have that
Z
Z X
∞
dµ(y)
dµ(y)
0
S (y)
=
W (xn , y)
2
2
0
0
Ω
Ω n=1
Z
∞
∞
X
dµ(y) X
=
W (xn , y)
≥
D/4 = ∞.
2
0
n=1 Ω
n=1

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

105

Therefore,
Z
Z
dµ(y)
dµ(y)
min{S 0 (y), 1}
≥
min{S 0 (y), 1}
2
2
Ω
Ω0
Z
Z
1
1
dµ(y)
0
0 dµ(y)
≥ 0
min{S (y), D }
= 0
S 0 (y)
= ∞.
D Ω0
2
D Ω0
2
This contradiction completes the proof.
We are left with proving (c) (we will again prove it for any value of D). Assume
the
S opposite, and let Λn ⊆ Λ be an increasing sequence such that µ(Λn ) < ∞ and
n Λn = Ω≤D . Let Un = W |Λn . Then kUn k1 < ∞, kUn k1 ↑ kW |Ω≤D k1 = ∞, and
kDUn k∞ ≤ D, implying in particular that kUn ◦ Un k1 = kDUn k22 ≤ DkDUn k1 =
DkUn k1 . Given an arbitrary constant λ, we claim that


(kUn k1 − λ)2
,
(A.1)
P η 2 (W |Ω≤D ) > λ ≥
kUn k21 + (4D + 2)kUn k1
provided n is large enough to ensure that kUn k1 > λ. Indeed, writing
E[η 2 (Un )] = E[η 2 (Un )1η2 (Un )≤λ ] + E[η 2 (Un )1η2 (Un )>λ ],
p
we can bound the first term by λ and the second by E[(η 2 (Un ))2 ]P[η 2 (Un ) > λ],
using Cauchy’s inequality. We therefore obtain that
p
E[η 2 (Un )] ≤ λ + E[(η 2 (Un ))2 ]P[η 2 (Un ) > λ].
Rearranging, we obtain the bound

 (E[η 2 (U )] − λ)2
(kUn k1 − λ)2
n
=
P η 2 (Un ) > λ ≥
,
2
2
2
E[(η (Un )) ]
kUn k1 + 4kUn ◦ Un k1 + kUn2 k1
where we used Lemma A.1 (1) and (3) in the last step. Observing that
Pr(η 2 (W |Ω≤D ) > λ) ≥ Pr(η 2 (Un ) > λ)
and bounding 4kUn ◦ Un k1 + kUn2 k1 by (4D + 2)kUn k1 , we obtain (A.1). Since
the right side of (A.1) goes to 1 as n → ∞, we get that with probability one,
η 2 (W |Ω≤D ) > λ for all λ, which contradicts the assumption that η 2 (W |Ω≤D ) < ∞
a.s.

Proof of Proposition 2.4. We first prove the equivalence of (A) – (E). Clearly (B) ⇒
(C) ⇒ (A) and (D) ⇒ (E). It is also not hard to see that (E) ⇒ (A). Indeed, note
first that for any D, the condition on S is equivalent to the condition that min{S, D}
is integrable (which implies that µ({S > D}) < ∞.) Set Ω0 = {DW ≤ D}∩{S ≤ D}.
Then (E) implies that
kW|Ω0 k1 ≤ 2I + kW{DW ≤D} k1 + 2kS1S≤D k1
≤ 2I + kW{DW ≤D} k1 + 2k min{S, D}k1 < ∞
0

and µ(Ω \ Ω ) ≤ µ({DW > D}) + µ({S > D}) < ∞, proving (A). So it will be
enough to show (A) ⇒ (B) and (A) ⇒ (D).
Suppose that (A) holds, and let Ω0 be a set such that µ(Ω \ Ω0 ) < ∞, W0 = W|Ω0 ,
and kW0 k1 = C < ∞. Let D > 0. First, assume that D > D0 = µ(Ω \ Ω0 ). Then
{x ∈ Ω : DW (x) > D} ⊆ (Ω \ Ω0 ) ∪ {x ∈ Ω0 , DW0 (x) > D − D0 }.

106

BORGS, CHAYES, COHN, AND LOVÁSZ

Since kDW0 k1 ≤ kW0 k1 = C, this set has measure at most
D0 +

C
.
D − D0

Now, let W00 = W|{x:DW (x)≤D} . Then
Z
00
0
kW k1 ≤ kW k1 + 2
{x∈Ω\Ω0 :DW (x)≤D}

DW (x) ≤ kW0 k1 + 2DD0 .

We have thus proven that (B) holds for all D larger than some D0 , and more
generally for any D for which there exists an Ω0 ⊆ Ω with µ(Ω \ Ω0 ) < D and
kW|Ω0 k1 < ∞.
Note that if W|{x:DW (x)≤D} is integrable for D > D0 , then it must remain
integrable if we decrease D, since that is just a restriction to a subset. Therefore,
this implies that W|{x:DW (x)≤D} is integrable for all D. Since DW < ∞ almost
everywhere, we further have that µ({x ∈ Ω : DW (x) ≥ λ}) tends to 0 as λ tends to
∞ (since we at least know that it is finite for large enough λ). Fixing D > 0, we
can therefore take D0 large enough so that µ({x ∈ Ω : DW (x) ≥ D0 }) < D. Taking
Ω0 := Ω \ {x ∈ Ω : DW (x) ≥ D0 }, we get a set Ω0 such that µ(Ω \ Ω0 ) < D and
kW|Ω0 k1 < ∞ proving that (B) holds for all D > 0.
On the other hand if (A) holds for some Ω0 , then kW |Ω0 k1 < ∞ and kS1Ω0 k1 < ∞.
Proceeding exactly as above we conclude that for all D, µ({DW > D}) < ∞ and
kW |{DW ≤D} k1 < ∞, as well as µ({S > D}) < ∞ and kS1{S≤D} k1 < ∞. Since
k min{S, D}k1 = Dµ({S > D}) + kS1{S≤D} k1 < ∞,
the latter condition is equivalent to k min{S, D}k1 < ∞, as required.
We are left with proving that the local finiteness conditions in Definition 2.1 are
necessary and sufficient for the almost sure finiteness of GT (W) for all T < ∞. It
is easy to check that the local finiteness conditions are not affected if we multiply
the underlying
measure by T and S by T . We therefore assume that T = 1. Let
P
η = i δxi be a Poisson process of intensity µ on Ω, let Yi be Poisson random
variable with mean S(xi ), and let Yij be Bernoulli with mean W (xi , xj ), all of them
independent of each other. We will have to show that the local finiteness conditions
on W are equivalent to the a.s. finiteness of the sums
X
X
eS =
Yi
and
eW =
Yij .
i

i>j

We
P next use the fact that a sum of
Pindependent, non-negative random variables
Z
is
a.s.
finite
if
and
only
if
k
k
i E[min{Zi , 1}] < ∞. In the case of eW , Yi,j
is bounded, and therefore we immediately have that eW is a.s. finite if and only
if η 2 (W ) is a.s. finite. Proposition A.2 (b) then proves this case. In the case of
eS , setting S 0 = min{S, P
1}, applying Proposition A.2 to S 0 , and noting that S 0 is
bounded, we have that i S 0 (xi ) is almost surely finite if and only if kS 0 k1 < ∞.
This is exactly the condition on S.

Appendix B. Sampling with loops
In this section, we discuss how to handle samples with loops. The sampling
process is adjusted as follows. We follow the same process as for GT (W) and G∞ (W);
however, for each vertex labeled as (t, x), with probability W (x, x), we add a loop
to the vertex. Deleting isolated vertices as before, and then removing the feature

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

107

labels from the vertices, we obtain a family (GeT (W))T ≥0 of labelled graphs with
S
loops, as well as the infinite graph Ge∞ (W) = T ≥0 GeT (W).
Note that a vertex that was previously isolated may not be isolated anymore
if it receives a loop, so a vertex may have been deleted from GT (W) but not from
GeT (W). We add a further condition for local finiteness:
Z
W (x, x) dµ(x) < ∞.
Ω

Note that if W is atomless, then the values W (x, x) do not have an effect on GT
and G∞ , and the diagonal constitutes a zero measure set in Ω × Ω.
As stated, Theorem 2.5 is false for sampling with loops. Since the diagonal may
be a zero measure set, almost everywhere equal pullbacks do not imply having the
same looped samples. We could further add the condition that W (x, x) is equal
to the pullback almost everywhere, but the theorem would still be false. This is
demonstrated by the following example. Let Ω1 = Ω2 = [0, 1]. Take W1 to be
constant 1/2 on [0, 1]×[0, 1], and let W2 be constant 1/2 off the diagonal, 0 if x < 1/2,
1 otherwise. Let Wi = (Wi , 0, 0, Ωi ). Then we claim that GeT (W1 ) and GeT (W2 ) have
the same distribution. Indeed, both are equivalent to taking Poisson(T ) vertices,
adding a loop to each vertex with probability 1/2, independently, and also taking an
edge between each pair of vertices with probability 1/2, independently over different
pairs.
It turns out that in general, allowing diagonal values strictly between 0 and 1 is
not necessary, because we could extend the feature space to determine whether each
vertex has loops. For graphexes where the diagonal is 0 or 1, we can then conclude
an analogous theorem from Theorem 2.5.
We first show the following:
Proposition B.1. For any graphex W = (W, S, I, Ω), there exists a graphex f
W=
e such that on the diagonal, W
e on an atomless space Ω
f , S,
e I,
e Ω)
f is {0, 1} valued
(W
W) and GeT (f
W) are equivalent to Ge∞ (W) and GeT (W), respectively.
and such that Ge∞ (f
e = Ω × [0, 1], and let π1 , π2 be the projection maps. Note that we
Proof. Let Ω
e × R+ by taking a Poisson process on Ω × R,
can obtain a Poisson process on Ω
and independently labeling each point with a uniform random real number from
e is atomless, so the diagonal
[0, 1], which becomes the second coordinate. Clearly Ω
f (x, y) =
values only affect the generation of the loops. Define Ie = I, Se = S ◦ π1 , W
W (π1 (x), π1 (y)) if x 6= y, and
(
1, if π2 (x) ≤ W (π1 (x), π1 (x))
f
W (x, x) =
.
0, otherwise.
Then the sampling of edges between vertices is not affected by the second coordinate
of a vertex. Note that the probability that there exist two vertices corresponding
e is zero, since Ω
e is atomless. For the loops, since we can
to the same point in Ω
obtain the vertices by first taking the Poisson process on Ω × R and then randomly
labeling each vertex with a [0, 1] real number, we can see that for a point y ∈ Ω, if
it ends up as a point, there is a W (y, y) probability that the point x corresponding
f (x, x) = 1, and 1 − W (y, y) that W
f (x, x) = 0, and this is independent
to it has W
over different points. Therefore, the distribution of loops is the same.


108

BORGS, CHAYES, COHN, AND LOVÁSZ

Using this proposition, sampling loops according to the diagonal is equivalent
to the following theory. The objects are graphexes with special subsets W =
(W, S, I, Ω, A) where W , S, I, and Ω are as before, and the special set A ⊆ Ω is
a measurable subset with finite measure. We sample Ge∞ (W) in the same way as
G∞ (W), except that we add a loop to each vertex with a feature label in A. We
then take the non-isolated vertices with time label at most T for GeT (W). We can
extend the definition of measure-preserving map by requiring that points in the
special set be mapped to points in the special set, and points not in the special set
be mapped to points not in the special set. We also define dsupp as earlier, except
it contain all points in A (even if otherwise they would not be included).
Theorem B.2. Let W1 and W2 be graphexes with special subsets as above. Then
GeT (W1 ) and GeT (W2 ) have the same distribution for all T ∈ R+ if and only if there
exists a third graphex with special subset W such that W1 and W2 are pullbacks of
W.
Proof. It is clearly enough to prove the only if direction. Suppose therefore that
W1 and W2 have the same distribution. Then for any 0 < c < 1, cW1 and cW2
have the same distributions (i.e., W, S, I are all multiplied by c, and the special
fi be obtained by taking Wi /2, adding a set Bi of
set stays the same). Then let W
measure 1 to Ωi , and extending Wi to be 1 on Bi × Bi , 1 between Bi and Ai , and 0
fi ) from G
e T (Wi ) by the following
between Bi and Ωi \ Ai . Then we can obtain GT (W
process. We first keep each edge that is not a loop with probability 1/2, and delete
it otherwise, independently. We keep all the loops. Then we take Poisson(T ) new
vertices, put an edge between every pair, and put an edge between each new vertex
and each vertex that had a loop (and delete loops). It is clear that in this way,
the distributions GT (f
W1 ) and GT (f
W2 ) are the same for every T . Therefore, there
e such that f
f , S,
e I,
e Ω)
exists a graphex f
W = (W
W1 and f
W2 are both pullbacks of f
W.
f
f
It is clear that W must have a set of measure 1, call it B, which has W (x, y) = 1 if
f (x, y) is either 0 or 1 if x ∈ B, y ∈
x, y ∈ B, and W
/ B, and only depends on y, and
f
W (x, y) ≤ 1/2 if x, y ∈
/ B, and B must pullback to exactly B1 and B2 . If we let A
f (x, y) = 1 for any and all y ∈ B, then A must pullback
be the set of points x with W
e \ B, and be equal to 2f
to A1 and A2 . If we therefore let W have underlying set Ω
W
restricted to this set, and special set A, then W pulls back to both W1 and W2 . 
References
[1] P. Billingsley, Convergence of Probability Measures, Wiley, New York, 1968.
[2] C. Borgs, J. T. Chayes, H. Cohn, and N. Holden, in preparation, 2018.
[3] C. Borgs, J. T. Chayes, H. Cohn, and N. Holden, Sparse exchangeable graphs and their limits
via graphon processes, arXiv:1601.07134, to appear in Journal of Machine Learning Research.
[4] C. Borgs, J. T. Chayes, H. Cohn, and V. Veitch, Sampling perspectives on sparse exchangeable
graphs, arXiv:1708.03237.
[5] C. Borgs, J. T. Chayes, H. Cohn, and Y. Zhao, An Lp theory of sparse graph convergence I:
limits, sparse random graph models, and power law distributions, arXiv:1401.2906, to appear
in Transactions of the American Mathematical Society.
[6] C. Borgs, J. T. Chayes, S. Dhara, and S. Sen, Limits of sparse configuration models and
beyond: graphexes and multi-graphexes, in preparation, 2018.
[7] C. Borgs, J. T. Chayes, L. Lovász, V. Sós, and K. Vesztergombi, Counting graph homomorphisms, Topics in Discrete Mathematics (M. Klazar, J. Kratochvı́l, M. Loebl, J. Matoušek,
R. Thomas, and P. Valtr, eds.), Springer, 2006, pp. 315–371.

IDENTIFIABILITY FOR GRAPHEXES AND THE WEAK KERNEL METRIC

109

[8] C. Borgs, J. T. Chayes, L. Lovász, V. Sós, and K. Vesztergombi, Convergent graph sequences I:
subgraph frequencies, metric properties, and testing, Advances in Math. 219 (2008), 1801–1851.
[9] C. Borgs, J. T. Chayes, L. Lovász, V. Sós, and K. Vesztergombi, Convergent graph sequences
II: multiway cuts and statistical physics, Ann. of Math. 176 (2012), 151–219.
[10] C. Borgs, J. Chayes, and L. Lovász, Moments of two-variable functions and the uniqueness
of graph limits, Geom. Funct. Anal. 19 (2010), 1597–1619.
[11] F. Caron and E. B. Fox, Sparse graphs using exchangeable random measures, J. R. Stat. Soc.
Ser. B. Stat. Methodol. 79 (2017), 1295–1366.
[12] D. L. Cohn, Measure Theory, second edition. Birkhäuser Advanced Texts: Basler Lehrbücher.
Birkhäuser/Springer, New York, 2013.
[13] D. J. Daley and D. Vere-Jones, An Introduction to the Theory of Point Processes: Volume I:
Elementary Theory and Methods, second edition, Springer, 2003.
[14] A. Frieze and R. Kannan, Quick approximation to matrices and applications, Combinatorica
19 (1999), 175–220.
[15] W. Hoeffding, Probability inequalities for sums of bounded random variables, Journal of the
American Statistical Association 58 (1963), 13–30.
[16] S. Janson, Graphons, cut norm and distance, couplings and rearrangements, New York Journal
of Mathematics. NYJM Monographs, vol. 4, State University of New York, University at
Albany, Albany, NY, 2013.
[17] S. Janson, Graphons and cut metric on sigma-finite measure spaces, arXiv:1608.01833, 2016.
[18] S. Janson, On convergence for graphexes, arXiv:1702.06389, 2017.
[19] O. Kallenberg, Probabilistic Symmetries and Invariance Principles, Springer, 2005.
[20] D. Kunszenti-Kovács, L. Lovász, and B. Szegedy, Multigraph limits, unbounded kernels, and
Banach space decorated graphs, arXiv:1406.7846, 2014.
[21] L. Lovász and B. Szegedy, Limits of dense graph sequences, J. Combin. Theory Ser. B 96
(2006), 933–957.
[22] L. Lovász and B. Szegedy, Szemerédi’s lemma for the analyst, Geom. Funct. Anal. 17 (2007),
252–270.
[23] L. Lovász and B. Szegedy, Regularity partitions and the topology of graphons, in An Irregular
Mind, Bolyai Soc. Math. Stud., vol. 21, János Bolyai Math. Soc., Budapest, 2010, pp. 415–446.
[24] W. Rudin, Real and Complex Analysis, third edition, McGraw-Hill Book Co., New York, 1987.
[25] V. Veitch and D. M. Roy, Sampling and estimation for (sparse) exchangeable graphs,
arXiv:1611.00843, 2016.
[26] V. Veitch and D. M. Roy, The class of random graphs arising from exchangeable random
measures, arXiv:1512.03099, 2015.
Microsoft Research, One Memorial Drive, Cambridge, MA 02142
E-mail address: borgs@microsoft.com
Microsoft Research, One Memorial Drive, Cambridge, MA 02142
E-mail address: jchayes@microsoft.com
Microsoft Research, One Memorial Drive, Cambridge, MA 02142
E-mail address: cohn@microsoft.com
Mathematics Department, UCLA, Los Angeles, CA 90095
E-mail address: lmlovasz@math.ucla.edu

