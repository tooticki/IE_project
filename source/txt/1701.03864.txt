arXiv:1701.03864v2 [math.NA] 30 May 2017

3D B2 Model for Radiative Transfer Equation
Part I: Modelling
Ruo Li* and Weiming Li†
October 4, 2018

Abstract
We extend to three-dimensional space the approximate M2 model for the slab
geometry studied in [3]. The B2 model therein, as a special case of the second order extended quadrature method of moments (EQMOM), is proved to be globally
hyperbolic. The model we propose here extends EQMOM to multiple dimensions
following the idea to approximate the maximum entropy closure for the slab geometry case. Like the M2 closure, the ansatz of the new model has the capacity
to capture both isotropic and beam-like solutions. Also, the new model has fluxes
in closed-form; thus, it is applicable to practical numerical simulations. The rotational invariance, realizability, and hyperbolicity of the model are studied.

Keywords: Radiative transfer, moment model, maximum entropy closure

1

Introduction

The radiative transfer equations describe the transportation of light in a medium [14].
They are kinetic equations, and the unknown is the specific intensity of photons. The
specific intensity is a function of time, spatial coordinates, frequency, and angular variables. The moment method is an efficient approach for reducing the computation cost
brought about by the high-dimensionality of variables of kinetic equations.
Moments are obtained by integrating the specific intensity against monomials of
the angular variables. In many applications, the quantities of interest are the few lowest order moments. Therefore moments are good choices for discretizing the angular
variables. However, moment systems are not closed. Closing the system by specifying a constitutive relationship is known as the moment-closure problem. One approach
towards moment-closure is to recover the angular dependence of the specific intensity
from the known moments. The reconstructed specific intensity is called an ansatz. Ideally, the ansatz should be non-negative for all moments which can be generated by a
non-negative distribution. Also, one would like the system to be hyperbolic since hyperbolicity is necessary for the local well-posedness of Cauchy problem. Other natural
* School of Mathematical Sciences, Peking University and State Key Laboratory of Space Weather, Chinese Academy of Sciences, Beijing. Email: rli@math.pku.edu.cn
† School of Mathematical Sciences, Peking University. Email: liweiming@pku.edu.cn

1

requirements include that the ansatz satisfies rotational invariance and reproduces the
isotropic distribution at equilibrium. Numerous forms of ansätze have been studied in
the literature [14, 12]. Yet, in multi-dimensional cases, the maximum entropy method,
referred to as the Mn model, is perhaps the only method known so far to have both
realizability and global hyperbolicity [5]. However, the flux functions of the maximum
entropy method are generally not explicit 1 , so numerically computing such models
involve solving highly nonlinear and probably ill-conditioned optimization problems
frequently. There have been continuous efforts on speeding up the computation process [2, 1, 7]. Recently, there are also attempts in deriving closed-form approximations
of the maximum entropy closure in order to avoid the expensive computations. For
1D cases, an approximation to the Mn models using the Kershaw closure is given in
[15]. For multi-dimensional cases, a model based on directly approximating the closure relations of the M1 and M2 methods is proposed in [13]. Our work in this paper
also aims at constructing closed-form approximations of the maximum entropy model.
Like [13], we seek a closed-form approximation to the M2 method in 3D. But unlike
[13], we derive our model from an ansatz with some similarity to that of the M2 model.
In a previous study [3], we analyzed the second order extended quadrature method
of moments (EQMOM) introduced in [16] which we call the B2 model. In this work,
we propose an approximation of the M2 model in 3D space by extending the B2 model
studied in [3] to 3D. The reason for this approach is that the B2 ansatz shares the
following properties with the M2 ansatz:
1. it interpolates smoothly between isotropic and Dirac distribution functions;
2. it captures anisotropy in opposite directions.
The B2 closure in [3] is for slab geometries. Preserving rotational invariance when
extending it to 3D space is non-trivial. We use the sum of the axisymmetric B2 ansätze
in three mutually orthogonal directions as the ansatz for a second order moment model
in 3D space. This new model is referred to as the 3D B2 model. The consistency
of known moments requires the three mutually orthogonal directions to be the three
eigenvectors of the second-order moment matrix. We point out that there are three free
parameters in the ansatz of the 3D B2 model after the consistency of known moments
is fulfilled. These parameters are specified as functions of the first-order moments and
the eigenvalues of the second-order moment matrix. We prove that the 3D B2 model
is rotationally invariant. The region where the model possesses a non-negative ansatz
is illustrated, as well as the hyperbolicity region of the model with vanished first-order
moment. Though far from perfect, the 3D B2 model shares some important features of
the M2 closure. Also, the model has explicit flux functions, making it very convenient
for numerical simulations.
The rest of this paper is organized as follows. In Section 2 we recall the basics of
moment models, and briefly, introduce the M2 method as well as the B2 model for 1D
slab geometry. In Section 3 we propose the 3D B2 model. In Section 4 we analyze its
properties. Finally, in Section 5 we summarize and discuss future work.
1

With the first order maximum entropy model for the grey equations as the only exception [5].

2

2

Preliminaries

The specific intensity I(t, r, ν, Ω) is governed by the radiative transfer equation
1 ∂I
+ Ω ⋅ ∇I = C(I),
c ∂t

(1)

where c is the speed of light. The variables in the equation are time t ∈ R+ , the spatial
coordinates r = (x, y, z) ∈ R3 , the angular variables Ω = (Ωx , Ωy , Ωz ) ∈ S2 , and
frequency ν ∈ R+ . The right-hand side C(I) describes the interactions between photons
and the background medium and are not the focus of this paper. A typical right-hand
side takes the form
C(I) = −σa I(Ω) − σs (I(Ω) −

1
∫ I(Ω) dΩ) ,
4π S2

where σa and σs are constant parameters. We introduce the moment method in the
context of second order models. Let
v=[

1,
(Ω ⋅ ex ),

(Ω ⋅ ey ),

(Ω ⋅ ez ),

(Ω ⋅ ex )2 , (Ω ⋅ ex )(Ω ⋅ ey ), (Ω ⋅ ex )(Ω ⋅ ez ),
(Ω ⋅ ey )2 ,
(Ω ⋅ ey )(Ω ⋅ ez )

(2)
]T .

Use ex , ey and ez to denote the unit vectors along the coordinate axes. Define
⟨ψ⟩ := ∫ ψ(ν, Ω) dΩ.
S2

Multiplying equation (1) by the vector v defined in (2) and integrating over the angular
variables give
1 ∂ ⟨vI⟩ ∂ ⟨Ωx vI⟩ ∂ ⟨Ωy vI⟩ ∂ ⟨Ωz vI⟩
+
+
+
= ⟨vC(I)⟩ .
c ∂t
∂x
∂y
∂z

(3)

In system (3), the time evolution of second-order moments relies on third-order moments. Therefore (3) is not a closed system. If we approximate the third-order moments
in (3) using lower order moments, we could get a closed system. Let2
E 0 ≃ ⟨I⟩ ,

E1 ≃ ⟨ΩI⟩ ,

E 2 ≃ ⟨Ω ⊗ ΩI⟩ ,

E 3 ≃ ⟨Ω ⊗ Ω ⊗ ΩI⟩ .

A closed system of equations has the form
1 ∂E 0
+ ∇ ⋅ E1 = r0 (E 0 , E1 , E 2 ),
c ∂t
1 ∂E1
+ ∇ ⋅ E 2 = r1 (E 0 , E1 , E 2 ),
c ∂t
1 ∂E 2
+ ∇ ⋅ [E 3 (E 0 , E1 , E 2 )] = r 2 (E 0 , E1 , E 2 ).
c ∂t
2

The notation a ≃ b means ‘a is an approximation of b.’

3

(4)

The choice of E 3 , r0 , r1 , and r 2 specify a closure. The system (4) is a second order
moment model. The following properties of a moment model concern us the most,
which were frequently discussed in the literature.
Rotational invariance: Consider a conservation law in multi-dimensions,
∂U D ∂Fi (U)
+∑
= 0.
∂t i=1 ∂xi

(5)

It satisfies rotational invariance if for any unit vector n = (n1 , ⋯, nD )T ∈ RD ,
there exists a matrix T depending on n, such that
D

−1
∑ ni Fi (U) = T F1 (TU).
i=1

Hyperbolicity: Let Ji be the Jacobian matrix of the flux function Fi in equation
D

(5). The system (5) is hyperbolic if for any unit vector n ∈ RD , ∑ ni Ji is real
i=1

diagonalizable.
Realizability: The realizability domain is defined as moments which could be
generated by a nonnegative distribution function [9]. A closure is said to be realizable if the higher order moments it closes belong to the realizability domain.
For one dimensional problem, [4] gives necessary and sufficient conditions for
realizability. Its results cover moments of arbitrary order. For multi-dimensional
case, only the conditions for the first and second order models are currently
known [10], while the conditions for moments of higher order remain open problems.
The maximum entropy models are equipped with all the properties mentioned
above. For detailed discussions we refer to [9, 11, 5]. We review the principles for
deriving the maximum entropy models by taking the second order case as an example.
It is called the M2 model. Solve the following constrained variational minimization
problem
minimize H(I)
subject to ⟨I⟩ = E 0 , ⟨ΩI⟩ = E1 , and ⟨Ω ⊗ ΩI⟩ = E 2

(6)

where H(I) is the Bose-Einstein entropy
H(I) := ⟨

2kB ν 2
(χI log (χI) − (χI + 1) log (χI + 1))⟩ ,
c3

(7)

c2
where χ = ̵ 3 . This gives us an ansatz
2hν
−1
̵
1
hν
IˆM (ν, Ω) = (exp (− α ⋅ v) − 1) ,
χ
kB

4

(8)

where α ⋅ v is a second order polynomial of Ω ∈ S2 . The parameters α is the unique
vector such that
⟨IˆM ⟩ = E 0 ,

⟨ΩIˆM ⟩ = E1 , and

⟨Ω ⊗ ΩIˆM ⟩ = E 2 .

The M2 method is defined by taking
E 3 := ⟨Ω ⊗ Ω ⊗ ΩIˆM ⟩ ,
r1 := ⟨ΩC(IˆM )⟩ ,

r0 := ⟨C(IˆM )⟩ ,
r 2 := ⟨Ω ⊗ ΩC(IˆM )⟩ .

(9)

in (4).
However, the M2 closure is not given explicitly, so (9) has to be computed by
solving the optimization problem (6) numerically. The numerical optimization at each
time step for all spatial grid is extremely expensive.
Recent work [13] proposes an approximation of the M2 method in multi-dimensions
by directly approximating its closure relation, though the corresponding ansatz to the
closure is not clarified. We adopt the approach of constructing an ansatz to approximate
the M2 ansatz, then the closure relation is given naturally as in (9).
In a previous work [3], we examined the properties of second order extended
quadrature method of moments (EQMOM) proposed in [16] in slab geometry, and
the model was referred as the B2 model. In EQMOM, the ansatz Iˆ is reconstructed by
a combination of beta distributions. The beta distribution on [−1, 1] is given by
F(µ; γ, δ) =

1 + µ ξ−1 1 − µ η−1
1
(
) (
) ,
2B(ξ, η)
2
2

ξ=

γ
,
δ

η=

1−γ
.
δ

where B(ξ, η) is the beta function. For the B2 model in 1D slab geometry, the ansatz
is taken as
wF(µ; γ, δ)
where the parameters w, γ, and δ are given by consistency to the known moments.
We found that the 1D B2 model shares the key features of the M2 model in slab
geometry, including existence of non-negative ansatz and therefore realizability, as well
as global hyperbolicity. It is the focus of this paper to extend the 1D B2 model to threedimensional case.
Our motivation to this extension is based on observing a common attribute between
the B2 and the M2 ansatz in 1D slab geometry. Both ansatz can exactly recover the
isotropic distribution, and at the same time, give a combination of Dirac functions on
the boundary of the realizability domain. Dirac functions could not be recovered by the
standard spectral method which has a polynomial as an ansatz. It has been pointed out
that the inability to capture anisotropy is a drawback of the standard spectral method
[6].
In three-dimensional space, the anisotropy of the specific intensity could come in
orthogonal directions. For example, we consider a setup similar to the double beam
problem discussed in [13] 3 . For the region [x, y] ∈ [−1, 1] × [−1, 1], consider equation
3 In [13], this example is used to demonstrate the advantage of the M model over its first-order counter2
part, the M1 model.

5

(1) with the right-hand side chosen as isotropic scattering (which means σs is a nonnegative constant):
1
C(I) = σs (−I +
⟨I⟩) .
4π
Laser beams are imposed as boundary inflow from orthogonal directions: I = δ(Ω ⋅
ex − 1) on the boundary x = −1, and I = δ(Ω ⋅ ey − 1) on the boundary y = −1.
For the extreme case when the medium is vacuum and σs = 0, the exact solution
for any ct > 2 is
I = δ(Ω ⋅ ex − 1) + δ(Ω ⋅ ey − 1).
(10)
It is pointed out in [13] that the M2 ansatz is able to exactly reproduce the distribution
in (10) from the moments. We aim to construct an ansatz that can capture anisotropy
in orthogonal directions, like the M2 ansatz.
For non-vanishing scattering, the steady-state solution of the above problem is an
isotropic distribution. For any period before steady-state is reached, the exact specific
intensity I should be somewhere between double beams, as in (10), and isotropic. The
ansatz of the M2 model provides a smooth interpolation between these two extremes,
giving it an advantage in simulating such problems. We aim to propose an ansatz with
similar features. This will be discussed in the following sections.

3

3D B2 Model

For second order models, which are the subject of this paper, the set of realizable
moments as given in [10] is
M = { (E 0 , E1 , E 2 ) ∈ R × R3 × R3×3 , s.t. 0 < E 0 = Trace(E 2 ),
∥E1 ∥ ≤ E 0 , and E 0 E 2 − E1 ⊗ E1 symmetric non-negative}.

(11)

It is also referred to as the realizability domain. Our goal is to reconstruct an ansatz of
the specific intensity given moments within M.
We take the summation of three axisymmetric distributions as the ansatz for the
specific intensity:
3
1
wi f (Ω ⋅ Ri ; γi , δi ),
(12)
IˆB (Ω) = ∑
2π
i=1
where Ri are three mutually orthogonal unit vectors. We assume that the matrix R =
[R1 , R2 , R3 ] satisfy det(R) = 1. It is also assumed that f (µ; γ, δ) is a non-negative
1

function of µ with two shape parameters γ and δ, and ∫ f (µ; γ, δ) dµ = 1. All the
−1
parameters in the ansatz, including Ri , wi , γi , and δi , i = 1, 2, 3, are functions of
known moments and are independent of Ω. We first discuss the properties of (12) for
any arbitrary non-negative function f (µ; γ, δ) whose integral over µ ∈ [−1, 1] is one.
To simplify the computing process in discussing the consistency conditions, we first
make the following observation which will be used later.

6

Lemma 3.1. For any permutation l, m, k of 1, 2, 3, ∀nl , nm , nk ∈ N, we have
⟨(Ω ⋅ Rl )nl (Ω ⋅ Rm )nm (Ω ⋅ Rk )nk f (Ω ⋅ Rk ; γk , δk )⟩ =
⎧
0, if either nl or nm is odd,
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
1
⎨ 2π ∫−1 µnk f (µ; γk , δk ) dµ, if nl = nm = 0,
⎪
⎪
⎪
⎪
⎪
⎪
1
2
nk
⎪
⎪
⎩ π ∫−1 (1 − µ )µ f (µ; γk , δk ) dµ, if nl = 2, nm = 0.
Proof. Note that f (Ω ⋅ Rk ; γk , δk ) is an axisymmetric function with Rk as its symmetric axis. Once Ri , i = 1, 2, 3, are given, the value of
nl
nm
nk
∫ 2 (Ω ⋅ Rl ) (Ω ⋅ Rm ) (Ω ⋅ Rk ) f (Ω ⋅ Rk ; γk , δk ) dΩ,
S

can be calculated conveniently by setting Rk as coordinate axes. Below, we will repeatedly use this method to compute the moments.
Set the z-axis to be aligned to Rk , the x-axis to be aligned to Rl , and the y-axis
aligned to Rm . Then
nl
nm
nk
∫ 2 (Ω ⋅ Rl ) (Ω ⋅ Rm ) (Ω ⋅ Rk ) f (Ω ⋅ Rk ; γk , δk ) dΩ
S

π

=∫

0
π

=∫

0

2π

(∫

0

(sin θ cos φ)nl (sin θ sin φ)nm (cos θ)nk f (cos θ; γk , δk ) dφ) sin θ dθ

(sin θ)nl +nm (cos θ)nk f (cos θ; γk , δk ) sin θ dθ ∫

2π

(cos φ)nl (sin φ)nm dφ.

0

Assume that nl is odd, let nl = 2j + 1. Then
2π

∫

(cos φ)nl (sin φ)nm dφ

0
2π

=∫

(cos φ)2j+1 (sin φ)nm dφ

0
2π

=∫

(1 − (sin φ)2 )j (sin φ)nm d sin φ

0

= 0.
Other cases are proved similarily.
To calculate
1
nk
∫ (Ω ⋅ Rk ) f (Ω ⋅ Rk ; γk , δk ) dΩ,
2π S2
we set up the coordinate system such that Rk is aligned to the z-axis. Let µ = Ω ⋅ Rk ,
then
1
nk
∫ (Ω ⋅ Rk ) f (Ω ⋅ Rk ; γk , δk ) dΩ
2π S2
π
2π
1
= ∫ (∫
(cos θ)nk f (cos θ; γk , δk ) dφ) sin θ dθ
2π 0
0
π

=∫

0
1

=∫

−1

(cos θ)nk f (cos θ; γk , δk ) sin θ dθ
µnk f (µ; γk , δk ) dµ.
7

If we let the z-axis to be aligned to Rk and the y-axis to be aligned to Rl , we have
1
2
nk
∫ (Ω ⋅ Rl ) (Ω ⋅ Rk ) f (Ω ⋅ Rk ; γk , δk ) dΩ
2π S2
2π
π
1
(sin θ sin φ)2 (cos θ)nk f (cos θ; γk , δk ) dφ) sin θ dθ,
= ∫ (∫
2π 0
0
2π
π
1
= ∫ (sin θ)2 (cos θ)nk f (cos θ; γk , δk ) sin θ dθ ∫
(sin φ)2 dφ
2π 0
0
1 1
= ∫ (1 − µ2 )µnk f (µ; γk , δk ) dµ.
2 −1
Summarizing the results from the above three cases completes the proof of this lemma.
Take v as defined in (2), the moments of interest are
2
2
2
2
2 T
E = [E 0 , E11 , E21 , E31 , E11
, E12
, E13
, E22
, E23
] = ∫ vIˆB dΩ.
S2

The moment system based on the ansatz (12) is derived as
∂E ∂fx (E) ∂fy (E) ∂fz (E)
+
+
+
= r(E),
∂t
∂x
∂y
∂z

(13)

where
2
2
2
3
3
3
3
3
fx = [E11 , E11
, E12
, E13
, E111
, E112
, E113
, E122
, E123
]T = ∫ (Ω ⋅ ex )vIˆB dΩ,
S2

2
2
2
3
3
3
3
3
fy = [E21 , E21
, E22
, E23
, E211
, E212
, E213
, E222
, E223
]T = ∫ (Ω ⋅ ey )vIˆB dΩ,
S2

fz =

2
2
2
3
3
3
3
3
[E31 , E31
, E32
, E33
, E311
, E312
, E313
, E322
, E323
]T

= ∫ (Ω ⋅ ez )vIˆB dΩ,
S2

and r(E) is calculated from the scattering term, which is out of the scope of our interests in this paper.
The parameters Ri , wi , γi , and δi have to satisfy the consistency conditions:
E 0 = ⟨IˆB ⟩ ,

E1 = ⟨ΩIˆB ⟩ ,

and

E 2 = ⟨Ω ⊗ ΩIˆB ⟩ .

(14)

The vectors Ri in (12) are determined by the consistency conditions (14) instantly,
as shown in the following lemma.
Lemma 3.2. The consistency constraints (14) require that Rj , j = 1, 2, 3, be the eigenvectors of E 2 .
Proof. Let R = [R1 , R2 , R3 ]. As R is an orthogonal matrix, we have R−1 = RT . To
prove the lemma, it suffices to show that
RTj E 2 Ri = ⟨(Ω ⋅ Rj )(Ω ⋅ Ri )IˆB ⟩ = 0,

if j =/ i.

(15)

The reason is that (15) would indicate that R−1 E 2 R is a diagonal matrix, and therefore
Rj , j = 1, 2, 3, are the eigenvectors of E 2 .
8

In order to prove (15), consider the case j = 1, i = 2,
RT1 E 2 R2 = ⟨(Ω ⋅ R1 )(Ω ⋅ R2 )IˆB ⟩ =

3
1
∫ 2 (Ω⋅R1 )(Ω⋅R2 ) ∑ wi f (Ω⋅Ri ; γi , δi ) dΩ.
2π S
i=1

By Lemma 3.1,
∫ 2 (Ω ⋅ R1 )(Ω ⋅ R2 )wk f (Ω ⋅ Rk ; γk , δk ) dΩ = 0,

k = 1, 2, 3.

S

Therefore RT1 E 2 R2 = 0. Similar arguments show that RT1 E 2 R3 = RT2 E 2 R3 =
0.
With the parameters Ri determined, we now consider the consistency requirements
under the coordinate system (R1 , R2 , R3 ). In this coordinate system, E 2 is a diagonal
matrix. Also, as Lemma 3.2 specify Rj , j = 1, 2, 3, to be the eigenvectors of E 2 ,
consistency of all the non-diagonal elements of E 2 are naturally satisfied. Therefore
we only need to look at the consistency of E 0 , E1 , and all the eigenvalues of E 2 . This
leaves us with 6 constraints. On the other hand, with Rj , j = 1, 2, 3 fixed, there are 9
parameters in the ansatz (12). Denote
1

σi = w i ∫

−1

µ2 f (µ; γi , δi ) dµ.

(16)

The following lemma shows that once σi , i = 1, 2, 3 are specified, then wi for i = 1, 2, 3
would be determined by consistency constraints.
Lemma 3.3. Let λi be the eigenvalue corresponding to Ri . Then wi , σi and λi satisfy
the following constraints:
w1 = 2σ1 − (σ2 + σ3 ) − λ1 + λ2 + λ3 ,
w2 = 2σ2 − (σ1 + σ3 ) − λ2 + λ1 + λ3 ,
w3 = 2σ3 − (σ1 + σ2 ) − λ3 + λ1 + λ2 .
Proof. Firstly,
λ1 = ⟨(Ω ⋅ R1 )2 IˆB ⟩ =

3
1
2
∫ 2 (Ω ⋅ R1 ) ∑ wi f (Ω ⋅ Ri ; γi , δi ) dΩ.
2π S
i=1

By Lemma 3.1,
1
1
2
2
∫ 2 (Ω ⋅ R1 ) w1 f (Ω ⋅ R1 ; γ1 , δ1 ) dΩ = w1 ∫ µ f (µ; γ1 , δ1 ) dµ = σ1 .
2π S
−1

For k = 2, 3, again by Lemma 3.1,
1
2
∫ (Ω ⋅ R1 ) wk f (Ω ⋅ Rk ; γk , δk ) dΩ
2π S2
1
1
1
= wk ∫ (1 − µ2 )f (µ; γk , δk ) dµ = (wk − σk ).
2
2
−1
9

(17)

Therefore,

1
1
λ1 = σ1 + (w2 − σ2 ) + (w3 − σ3 ).
2
2

(18)

1
λ2 = σ2 + (w1 − σ1 ) +
2
1
λ3 = σ3 + (w1 − σ1 ) +
2

(19)

By symmetry, we have
1
(w3 − σ3 ),
2
1
(w2 − σ2 ).
2

Rewriting (18) and (19) by solving the equations as a linear system of wi yields the
final results (17).
Once wi , i = 1, 2, 3, are given, consistency requires that γi and δi satisfy
1

wi ∫

−1

µf (µ; γi , δi ) dµ = Fi ,

(20)

where Fi = E1 ⋅ Ri . If wi = 0, then the term wi f (Ω ⋅ Ri ; γi , δi ) does not appear in the
ansatz (12). From now on we assume wi =/ 0. Recall that by definition, the function
f (µ; γ, δ) is a non-negative distribution on µ ∈ [−1, 1], and its zeroth moment is 1.
Fi
σi
Moreover, the first and second-order moments of f are respectively
and
. So,
wi
wi
combining (16) and (20) define a 1D moment problem. This means that once the value
of the three parameters σi , i = 1, 2, 3 are specified, the consistency condition (14) could
be decomposed into three decoupled 1D moment problems
⎧
Fi
1
⎪
⎪
,
⎪
∫−1 µf (µ; γi , δi ) dµ =
⎪
⎪
wi
⎪
⎨
⎪
σi
⎪
1 2
⎪
⎪
,
⎪
∫−1 µ f (µ; γi , δi ) dµ =
⎪
w
⎩
i

(21)

for i = 1, 2, 3. According to [4], the realizability domains of the 1D moment problems
in (21) are:
Fi 2 σi
( ) ≤
≤ 1, i = 1, 2, 3.
(22)
wi
wi
A sufficient condition for the existence of non-negative ansatz IˆB is wi ≥ 0, i =
1, 2, 3. It follows that a non-negative ansatz IˆB exists under the following conditions:
(

Fi 2 σ i
) ≤
≤ 1,
wi
wi

wi ≥ 0,

i = 1, 2, 3.

(23)

One would like to give a non-negative ansatz for as large a part of the realizability
domain as possible to have a realizable closure. Before examining the non-negativity
of the ansatz (12), we give the following result, which is an alternative characterization
of the realizable moments:

10

Lemma 3.4. Let {λj , Rj }, j = 1, 2, 3, be the eigenpairs of E 2 , and Fj = E1 ⋅Rj . Then
the realizability domain M given by (11) is
Fi2
≤ E0 } .
λ
i=1 i

3

3

M = {(E 0 , E1 , E 2 ) ∣ 0 < ∑ λi = E 0 , ∑
i=1

In (24), the term

(24)

Fi2
= 0 is taken to be zero if λi = 0.
λi

Proof. Denote the normalized first and second-order moments by Ê1 =
E2
. Let
E0

√
√ ⎫
√
⎧
⎪
λ2
λ3 ⎪
⎪
⎪ λ1
Λ = diag ⎨
,
,
⎬,
0
0
0⎪
⎪
E
E
E
⎪
⎪
⎭
⎩

λ1 λ2 λ3
Λ = diag { 0 , 0 , 0 } ,
E E E

1
2

and denote
R = [R1 , R2 , R3 ],
Then

2
E1
and Ê =
E0

1

T = Λ 2 R.

2

Ê = RT ΛR = T T T .
2

Assuming that λi =/ 0, i = 1, 2, 3. Then non-negativity of the matrix Ê − Ê1 ⊗ Ê1 is
equivalent to the non-negativity of the matrix I − T −T Ê1 (Ê1 )T T −1 , which, in turn,
is equivalent to ∥(Ê1 )T T −1 ∥2 ≤ 1, and therefore equivalent to
Fi2
≤ E0.
λ
i
i=1
3

∑

(25)

The cases when there exists i for which λi = 0 can be proved by entirely similar
arguments.
Remark 3.1. The above lemma could also be proved by applying the method for solving modified eigenvalue problems proposed in [17].
Making use of Lemma 3.4, the realizability domain can be visualized as: take any
λ1 λ2 λ3
point inside a triangle and let ( 0 , 0 , 0 ) be its barycentric coordinates. Then
E E E
the corresponding (F1 , F2 , F3 ) lie in the ellipsoid (25). Each side of the triangle corresponds to the cases where at least one eigenvalue of E 2 vanishes. In such cases
non-negativity of IˆB given in (12) would impose the following constraints on the first
and second-order moments:
Lemma 3.5. The non-negativity of the ansatz IˆB requires that if there exists i = 1, 2 or
3 such that λi = 0, then
{

Fi = 0 and σi = 0,
∣Fj ∣ ≤ σj ≤ λj , for ∀j =/ i.
11

Proof. Consider the case i = 1. Since
0 = λ1 = ∫ (Ω ⋅ R1 )2 IˆB (Ω) dΩ,
S2

(26)

then IˆB can only be non-zero when Ω ⋅ R1 = 0. This gives
F1 = ∫ (Ω ⋅ R1 )IˆB (Ω) dΩ = 0.
S2

To prove σ1 = 0, let us study two cases.
1. For w1 = 0, it can be seen from (16) that σ1 = 0.
2. If w1 =/ 0. Recall that IˆB can only be non-zero when Ω ⋅ R1 = 0. Then (16)
shows σ1 = 0.
Next, we show that σj ≥ ∣Fj ∣, j = 2, 3. We look at two cases.
1. In the case that wj = 0, by (20) we have Fj = 0, and by (16) we see that σj = 0.
Hence σj ≥ ∣Fj ∣.
2. If wj =/ 0. Again, note that IˆB can only be non-zero when Ω ⋅ R1 = 0, therefore
for j =/ 1, the function f (Ω ⋅ Rj ; γj , δj ) has the form
f (Ω ⋅ Rj ; γj , δj ) = αj− δ(Ω ⋅ Rj + 1) + αj+ δ(Ω ⋅ Rj − 1).
From (16) we know that in such cases σj = wj . Combine this with the left
inequality in (23), and we have σj ≥ ∣Fj ∣.
Finally, we prove σj ≤ λj , j = 2, 3. Plugging σ1 = λ1 = 0 into (17) gives
σ2 − σ3 = λ2 − λ3 ,
and
σ2 + σ3 = λ2 + λ3 − w1 ,
If IˆB is non-negative, then w1 ≥ 0. Combine the above and notice that λ2 + λ3 = E 0 ,
we have
σj ≤ λj , j = 2, 3.
The proofs for i = 2, 3, follows in a similar manner.
Remark 3.2. As a special case of Lemma 3.5, if there exists j such that λj = E 0 , and
λi = 0 for i =/ j, then
{

∣Fj ∣ ≤ σj ≤ λj = E 0 ,
Fi = 0 and σi = 0, for ∀i =/ j.

12

From Lemma 3.5, it is clear that when λi = 0 is the only zero eigenvalue of E 2 ,
the region for which the ansatz (12) admits a non-negative distribution is limited to the
rectangle ∣Fj ∣ ≤ λj , j =/ i. We point out that this rectangle can cover only 4 points for
the boundary of the realizability domain in (25), which in this case becomes the ellipse
Fj2
λj

+

Fk2
= E0,
λk

j =/ k.

For other boundary moments, we have the following result:
Lemma 3.6. Suppose λi > 0, i = 1, 2, 3. Then on the boundary of the realizability
domain, where
F12 F22 F32
+
+
= E0,
(27)
λ1 λ2 λ3
there are only two kinds of moments for which IˆB can be non-negative:
F2
1. ∃i, such that λi = i0 . Meanwhile for j, k =/ i, the relationships λj = λk and
E
Fj = Fk = 0 hold.
2. ∀j = 1, 2, 3, the constraint ∣Fj ∣ = λj is satisfied.
Proof. Let the covariance matrix of the distribution function be
T

V =

E2
E1
E1
−
(
)
(
) .
E0
E0
E0

If

F12 F22 F32
+
+
= E0,
λ1 λ2 λ3
then there exists at least one zero eigenvalue for V . Denote the corresponding eigenvector by U, and [10] has shown that any non-negative distribution could be non-zero
1
only when Ω ⋅ U = 0 (E1 ⋅ U). We will repeatedly make use of this fact in the
E
following discussions.
We study the two possible cases:
1. Suppose U is aligned with some eigenvector of E 2 . Without loss of generality,
we assume R3 //U. Then a non-negative distribution could be non-zero only on
F3
Ω ⋅ R3 = 0 . In addition,
E
⎡
T⎤
⎢ 1
E1
E1 ⎥
F3 2
λ3
0 = UT V U = RT3 ⎢⎢ 0 E 2 − ( 0 ) ( 0 ) ⎥⎥ R3 = 0 − ( 0 ) ,
(28)
E
E
E
E
⎢E
⎥
⎣
⎦
F32
. If F3 = 0 then λ3 = 0, which has been ruled out in our
E0
assumptions. So F3 =/ 0, which means a non-negative distribution (12) can only
be
E0
F3
IˆB =
δ (Ω ⋅ R3 − 0 ) .
(29)
2π
E

which gives λ3 =

13

Therefore w1 = w2 = 0, and by (16) and (20) we would have σ1 = σ2 = F1 =
1
F2 = 0. Substituting this into (17) gives λ1 = λ2 = (w3 − λ3 ). Conversely,
2
F2
moments satisfying λ1 = λ2 and F1 = F2 = 0 in addition to λ3 = 30 could be
E
generated by the ansatz (29).
2. Consider the case when U is not aligned to any Rj . The only way to give a
non-negative distribution for (12) in this case is
3

IˆB = ∑[αi+ δ(Ω ⋅ Ri − 1) + αi− δ(Ω ⋅ Ri + 1)].
i=1

Hence σj = wj , j = 1, 2, 3. Combining these with (17) gives σj = λj , j = 1, 2, 3.
But condition (23) require
∣Fj ∣ ≤ λj ,

j = 1, 2, 3.

(30)

Recall assumption (27), and notice
E0 =

F12 F22 F32
+
+
≤ λ1 + λ2 + λ3 = E 0 .
λ1 λ2 λ3

(31)

For all inequalities to hold, we need
∣Fj ∣ = λj , j = 1, 2, 3.

(32)

Conversely, for moments satisfying condition (32), choosing
σj = λj ,

j = 1, 2, 3.

(33)

would give a non-negative ansatz.
The proof is completed.
We now turn to specifying the formula for f . We take f to be the beta distribution
used in the B2 ansatz for slab geometry
f (µ; γ, δ) = F(µ; γ, δ),

ξ=

γ
,
δ

η=

1−γ
.
δ

(34)

Retaining only one term in (12) would provide the same ansatz as the one-dimensional
B2 ansatz which we studied previously [3]. Taking ξ = η = 1 in equation (34) would
give f as a constant function. If either ξ or η approach zero, the limit of the function f is
a Dirac function. If both of them go to zeros at a fixed rate, the function f will become
a combination of two Dirac functions. This capacity of (34) to interpolate between the
constant function and Dirac functions is a feature it shares with the M2 ansatz. Also,
for slab geometry, the B2 model possesses numerous nice properties similar to the M2
model; therefore, we use it as building blocks for three-dimensional ansatz.

14

If (34) is the distribution function f in (16) and (20), then for σi , wi and Fi satisfying the realizability condition (22), we have
ξi ≥ 0,

ηi ≥ 0,

which gives an integrable function for (34). For the above cases, the parameters γi and
δi are given as follow:
Lemma 3.7. If (23) is fulfilled, we have
γi =

Fi + wi
2wi

and

δi = −

Fi2 − σi wi
,
wi2 − σi wi

Proof. Note that the standard β distribution

∀i = 1, 2, 3.

(35)

1
xξ−1 (1 − x)η−1 has the properties
B(ξ, η)

[8]:
1

1
ξ
xξ−1 (1 − x)η−1 =
,
B(ξ, η)
ξ+η
1
ξ(ξ + 1)
1
2
xξ−1 (1 − x)η−1 =
.
∫ x
B(ξ, η)
(ξ + η)(ξ + η + 1)
0
∫

x

0

Therefore,
1

x= 12 (1+µ)

1

1
xξi −1 (1 − x)ηi −1 dx
B(ξi , ηi )
(36)
1
1
ξi
=2 ∫ x
xξi −1 (1 − x)ηi −1 dx − 1 = 2
− 1 = 2γi − 1.
B(ξi , ηi )
ξi + ηi
0
∫

−1

µf (µ; γi , δi ) dµ ÔÔÔÔÔ ∫

(2x − 1)

0

Also,
1

x= 12 (1+µ)

1

1
xξi −1 (1 − x)ηi −1 dx
B(ξi , ηi )
0
−1
1
1
1
1
=4 ∫ x2
xξi −1 (1 − x)ηi −1 dx − 4 ∫ x
xξi −1 (1 − x)ηi −1 dx + 1
B(ξi , ηi )
B(ξi , ηi )
0
0
ξi (ξi + 1)
γi (γi − 1)
ξi
=4
−4
+1=4
+ 1.
(ξi + ηi )(ξi + ηi + 1)
ξi + η i
1 + δi
(37)
∫

µ2 f (µ; γi , δi ) dµ ÔÔÔÔÔ ∫

(2x − 1)2

Combining (36), (37) with (16), (20) gives us (35).
Note that (16), (20), and (17) together are the necessary and sufficient conditions
for consistency constraints to all known moments. This leaves σi , i = 1, 2, 3, to be
the three free parameters. We shall return to the problem of determining σi later. For
the present, we assume σi , i = 1, 2, 3 are all given, and the following lemma gives the
closure relationship of the B2 model.

15

Lemma 3.8. Let R = [R1 , R2 , R3 ] ∈ R3×3 , and denote by Rij the entries of the matrix
R, the flux closure is then given by f (E 0 , E1 , E 2 ), which relies on E1 , E 2 and E 3 ,
with E 3 given as
3
Eijk
= ⟨(Ω ⋅ Rl )(Ω ⋅ Rm )(Ω ⋅ Rn )IˆB ⟩ Ril Rjm Rkn ,

where the Einstein summation convention is used. For distribution ansatz IˆB given by
(12),
⟨(Ω ⋅ Rl )(Ω ⋅ Rm )(Ω ⋅ Rn )IˆB ⟩ =
⎧
Fl (σl2 + 2Fl2 − 3wl σl )
⎪
⎪
⎪
, if l = m = n,
⎪
⎪
2Fl2 − wl σl − wl2
⎪
⎪
⎪
⎪
⎪
σl2 + 2Fl2 − 3wl σl
⎨ Fl
⎪
) , if m = n, m =/ l,
(1
−
⎪
⎪
⎪
2
2Fl2 − wl σl − wl2
⎪
⎪
⎪
⎪
⎪
⎪
⎩ 0, if l =/ m =/ n.

(38)

Proof. Consider the case when l = m = n = 1 at first.
3
1
3
⟨(Ω ⋅ Rl )(Ω ⋅ Rm )(Ω ⋅ Rn )IˆB ⟩ =
∫ 2 (Ω ⋅ R1 ) ∑ wi f (Ω ⋅ Ri ; γi , δi ) dΩ.
2π S
i=1

By Lemma 3.1,
3
3
∫ 2 (Ω ⋅ R1 ) w2 f (Ω ⋅ R2 ; γ2 , δ2 ) dΩ = ∫ 2 (Ω ⋅ R1 ) w3 f (Ω ⋅ R3 ; γ3 , δ3 ) dΩ = 0,
S

S

and
1
1
3
3
∫ 2 (Ω ⋅ R1 ) w1 f (Ω ⋅ R1 ; γ1 , δ1 ) dΩ = w1 ∫ µ f (µ; γ1 , δ1 ) dµ.
2π S
−1
1
Note that the standard β distribution
xξ−1 (1 − x)η−1 has the property [8]:
B(ξ, η)
1

∫

0

x3

ξ(ξ + 1)(ξ + 2)
1
xξ−1 (1 − x)η−1 =
.
B(ξ, η)
(ξ + η)(ξ + η + 1)(ξ + η + 2)

Therefore,
1

x= 12 (1+µ)

1

1
xξ1 −1 (1 − x)η1 −1 dx
B(ξ1 , η1 )
−1
0
1
1
1
1
=8 ∫ x3
xξ1 −1 (1 − x)η1 −1 dx − 12 ∫ x2
xξ1 −1 (1 − x)η1 −1 dx
B(ξ1 , η1 )
B(ξ1 , η1 )
0
0
1
1
+ 6∫ x
xξ1 −1 (1 − x)η1 −1 dx − 1
B(ξ1 , η1 )
0
8ξ1 (ξ1 + 1)(ξ1 + 2)
12ξ1 (ξ1 + 1)
6ξ1
=
−
+
−1
(ξ1 + η1 )(ξ1 + η1 + 1)(ξ1 + η1 + 2) (ξ1 + η1 )(ξ1 + η1 + 1) ξ1 + η1
(ξ1 − η1 )(ξ12 − 2ξ1 η1 + 3ξ1 + η12 + 3η1 + 2)
=
.
(ξ1 + η1 )(ξ1 + η1 + 1)(ξ1 + η1 + 2)
∫

µ3 f (µ; γ1 , δ1 ) dµ ÔÔÔÔÔ ∫

(2x − 1)3

16

Recall (34) and Lemma 3.7 for the values of ξ1 and η1 , we have
1

∫

−1

µ3 f (µ; γ1 , δ1 ) dµ

(ξ1 − η1 )(ξ12 − 2ξ1 η1 + 3ξ1 + η12 + 3η1 + 2)
(ξ1 + η1 )(ξ1 + η1 + 1)(ξ1 + η1 + 2)
F1 (σ12 + 2F12 − 3w1 σ1 )
=
.
2F12 − w1 σ1 − w12

=

For l = m = n = 2 or l = m = n = 3 the computation is similar.
Now consider the case when m = n, m =/ l. Suppose m = n = 1 and l = 2. Let us
start by proving
⟨(Ω ⋅ R1 )2 (Ω ⋅ R2 )IˆB ⟩ = ⟨(Ω ⋅ R3 )2 (Ω ⋅ R2 )IˆB ⟩ .
First, compute ⟨(Ω ⋅ R1 )2 (Ω ⋅ R2 )IˆB ⟩.
⟨(Ω ⋅ R1 )2 (Ω ⋅ R2 )IˆB ⟩ =

3
1
2
∫ 2 (Ω ⋅ R1 ) (Ω ⋅ R2 ) ∑ wi f (Ω ⋅ Ri ; γi , δi ) dΩ.
2π S
i=1

Again by Lemma 3.1,
2
∫ 2 (Ω ⋅ R1 ) (Ω ⋅ R2 )w3 f (Ω ⋅ R3 ; γ3 , δ3 ) dΩ
S

= ∫ (Ω ⋅ R1 )2 (Ω ⋅ R2 )w1 f (Ω ⋅ R1 ; γ1 , δ1 ) dΩ
S2

=0,
and
1
1
1
2
2
∫ 2 (Ω⋅R1 ) (Ω⋅R2 )w2 f (Ω⋅R2 ; γ2 , δ2 ) dΩ = w2 ∫ (1−µ )µf (µ; γ2 , δ2 ) dµ.
2π S
2
−1

Thus we have
1
1
⟨(Ω ⋅ R1 )2 (Ω ⋅ R2 )IˆB ⟩ = w2 ∫ (1 − µ2 )µf (µ; γ2 , δ2 ) dµ,
2
−1

and similarly,
1
1
⟨(Ω ⋅ R3 )2 (Ω ⋅ R2 )IˆB ⟩ = w2 ∫ (1 − µ2 )µf (µ; γ2 , δ2 ) dµ.
2
−1

Then we get
⟨(Ω ⋅ R1 )2 (Ω ⋅ R2 )IˆB ⟩ = ⟨(Ω ⋅ R3 )2 (Ω ⋅ R2 )IˆB ⟩ .
On the other hand,
⟨(Ω ⋅ R1 )2 (Ω ⋅ R2 )IˆB ⟩+⟨(Ω ⋅ R3 )2 (Ω ⋅ R2 )IˆB ⟩+⟨(Ω ⋅ R2 )3 IˆB ⟩ = ⟨(Ω ⋅ R2 )IˆB ⟩ = F2 .
17

It follows that
F2
σ 2 + 2F 2 − 3w2 σ2
⟨(Ω ⋅ R1 )2 (Ω ⋅ R2 )IˆB ⟩ = ⟨(Ω ⋅ R3 )2 (Ω ⋅ R2 )IˆB ⟩ =
).
(1 − 2 2 2
2
2F2 − w2 σ2 − w22
Now we look at ⟨(Ω ⋅ R1 )(Ω ⋅ R2 )(Ω ⋅ R3 )IˆB ⟩. Once more by Lemma 3.1,
∫ 2 (Ω ⋅ R1 )(Ω ⋅ R2 )(Ω ⋅ R3 )w1 f (Ω ⋅ R1 ; γ1 , δ1 ) dΩ
S

= ∫ (Ω ⋅ R1 )(Ω ⋅ R2 )(Ω ⋅ R3 )w2 f (Ω ⋅ R2 ; γ2 , δ2 ) dΩ
S2

= ∫ (Ω ⋅ R1 )(Ω ⋅ R2 )(Ω ⋅ R3 )w3 f (Ω ⋅ R3 ; γ3 , δ3 ) dΩ
S2

= 0.
Therefore,
⟨(Ω ⋅ R1 )(Ω ⋅ R2 )(Ω ⋅ R3 )IˆB ⟩ = 0.
Summarizing the results from the above three cases completes the proof of this lemma.

P2
P3

P

P1
Figure 1: Schematic diagram of the interpolation
It remains to give σi , i = 1, 2, 3. Note that the trace of the matrix E 2 equals E 0 , so
λi satisfy the constraint
λ1 + λ2 + λ3 = E 0 .
And due to the positive semi-definiteness of E 2 , we have λi ≥ 0, i = 1, 2, 3. This
λ1 λ2 λ3
allows us to regard ( 0 , 0 , 0 ) as the barycentric coordinates of a point P within a
E E E
triangle (see Figure 1). At the vertices of this triangle, only one of the three eigenvalues
of E 2 is non-zero. By the similar arguments in the proof of Lemma 3.5, a non-negative
IˆB in such cases retains only one of its three terms. Combining this fact with (17) gives
us the closure at the vertices of the triangle:
(

λ1 λ2 λ3
,
,
)
E0 E0 E0
(1, 0, 0)
(0, 1, 0)
(0, 0, 1)

↦

(σ1 , σ2 , σ3 )
(E0 , 0, 0)
(0, E0 , 0)
(0, 0, E0 )

18

Now that the value of (σ1 , σ2 , σ3 ) at the vertices are specified by the closure relation,
we are to propose a smooth extension of the functions σi at the vertices to the whole triangle, then a smooth extension of the closure relation is achieved. A natural extension
is a scaled identity map as
(

λ1 λ2 λ3
,
,
) ↦ (λ1 , λ2 , λ3 ) ,
E0 E0 E0

However, by (17) this extension results in wj = σj . As a consequence, the ansatz would
always be linear combinations of Dirac functions. It cannot include any smooth functions, particularly it cannot recover a constant distribution at the equilibrium. Moreover, such an extension does not depend on the first-order moments Fi at all, which is
definitely not appropriate. This motivates us to seek other ways of extending.
To figure out an appropriate extension, we assume it takes the following general
but decomposed form
3

σi = ∑ sj σij ,

i = 1, 2, 3.

(39)

j=1

It is assumed that sj is a weight function that relies only on λj , and σij is a function
that depends on both the first-order moments and the eigenvalues of the second-order
moments but that is independent of λj .
First, we determine the values of the weights, sj . Our approach is motivated by
geometric considerations. It is illustrated in Figure 1. For the point P, we connect
each vertex to P and extend the line segment until it intersects with the opposite side.
Those three intersection points are denoted Pj , j = 1, 2, 3, where the index j indicates
that Pj lies on the side where λj = 0. Denote the barycentric coordinates of Pj by
λj λj λj
Pj = ( 10 , 20 , 30 ). Therefore,
E E E
3

λi = ∑ sj λji ,

j = 1, 2, 3,

j=1

where

1
1
1
s1 = (λ2 + λ3 ), s2 = (λ1 + λ3 ), s3 = (λ1 + λ2 ).
(40)
2
2
2
The functions in (40) are used as the weights sj , j = 1, 2, 3.
The next thing is to specify σij . Consider a 3 × 3 matrix with the nine functions,
λ1 λ2 λ3 F1 F2 F3
σij ( 0 , 0 , 0 ; 0 , 0 , 0 ), i, j = 1, 2, 3, as its elements. Naturally, one would
E E E E E E
expect σij to have symmetry in the permutation of indices. Precisely, if τ is a permutation on the index set {1, 2, 3}, then for ∀i, j = 1, 2, 3,
σij (

λ1 λ2 λ3 F1 F2 F3
τ (j) λτ (1) λτ (2) λτ (3) Fτ (1) Fτ (2) Fτ (3)
, 0 , 0 ; 0 , 0 , 0 ) = στ (i) ( 0 ,
,
;
,
,
).
0
E E E E E E
E
E0
E0
E0
E0
E0

Thus, we have only two functions for all σij :
19

• The three diagonal entries, σii , i = 1, 2, 3, have the same form;
• All six off-diagonal entries, σij , i ≠ j, have the same form.
Since σij is assumed to be independent of λj , it should be constant on the line segment
PPj . As an example, since σi1 does not depend on λ1 , it should be independent of
λ3
λ2
and
to replace λ2 and λ3 as variables
λ2 +λ3 . Therefore, one may use
λ2 + λ3
λ2 + λ3
λ3
λ2
in σi1 . Noticing that (0,
,
) is the barycentric coordinate of P1 , we thus
λ2 + λ3 λ2 + λ3
1
1
have σi ∣P = σi ∣P , and it is constant on line PP1 .
1

Moreover, this makes us assume σij is also independent of Fj . The reason is as
follows. By Lemma 3.5, the only region in which (12) might have a non-negative
distribution when λj = 0 is the rectangle ∣Fk ∣ ≤ λk , k ≠ j. Therefore, even when all
three λj , j = 1, 2, 3, are positive, we restrict our expected region to have a non-negative
distribution inside the box ∣Fk ∣ ≤ λk , k = 1, 2, 3. Note that this domain of Fj depend
on λj while σij does not rely on λj , so we are induced to let σij to be independent of
Fj .
We proceed to specify σij by constraints at vertices and sides of the triangle. We
first investigate the vertices to conclude that
Lemma 3.9. With the assumptions above on σij , we have
σii ≡ 0,

i = 1, 2, 3.

Proof. First, take the vertex in which λ1 = 1 and λ2 = λ3 = 0. On this vertex one needs
σ1 = 1, and σ2 = σ3 = 0. We have
1
σ1 ∣λ1 =1 = ( σ12 ∣λ =1 + σ13 ∣λ =1 ).
1
1
2
Due to symmetry we know σ12 = σ13 on this vertex. Therefore, we have to let σ12 ∣λ
σ13 ∣λ =1
1

1 =1

=

= 1. Meanwhile,

1
σ2 ∣λ1 =1 = ( σ22 ∣λ =1 + σ23 ∣λ =1 ) = 0.
1
1
2
2
3
This induces us to impose σ2 = σ2 = 0 on this vertex. Next, consider the case on the
side where λ1 = 0. By Lemma 3.5, σ1 = 0. Recalling the consistency constraints (17),
we have
σ2 − σ3 = λ2 − λ3 .
(41)
Consider any point P on the side λ1 = 0. Then, in (39), the function σ11 takes its value
at P itself, while σ12 is evaluated at the vertex λ3 = 1, and σ13 is evaluated at the vertex
λ2 = 1. Then, on this side, we have
1
1
1
σ1 = (λ2 + λ3 )σ11 + (λ1 + λ3 ) σ12 ∣λ =1 + (λ1 + λ2 ) σ13 ∣λ =1
3
2
2
2
2
1 1 1
1
= σ1 + λ3 σ12 ∣λ =1 + λ2 σ13 ∣λ =1
3
2
2
2
2
1 1
= σ1 = 0.
2
20

This proves that σ11 = 0 on this side.
The above discussions show that σii vanishes both at the vertex with λi = 1 and on
the side with λi = 0. Also, recall that σii is constant along straight lines passing through
the vertex λ1 = 1. Hence it is zero on the whole triangle. By symmetry, we have σii ≡ 0,
i = 1, 2, 3, on the whole triangle.
We now turn to specifying σij on the sides. On the side where λ1 = 0, we also have
1
1
1
σ2 = (λ2 + λ3 )σ21 + (λ1 + λ3 ) σ22 ∣λ =1 + (λ1 + λ2 ) σ23 ∣λ =1
3
2
2
2
2
1 1 1
= σ2 + λ2 σ23 ∣λ =1
notice σ23 = 1 on this vertex
2
2
2
1
1
= σ21 + λ2 ,
2
2
and

1
1
σ3 = σ31 + λ3 .
2
2
Substracting these two equations yields
1
1
σ2 − σ3 = (σ21 − σ31 ) + (λ2 − λ3 ).
2
2
By (41), we have
σ21 − λ2 = σ31 − λ3 .
Recalling our previous assumption that σ21 and σ31 are independent of λ1 and F1 , one
has to set
σ21 = λ2 + h (λ2 , λ3 ; F2 , F3 ) ,
σ31 = λ3 + h (λ2 , λ3 ; F2 , F3 ) ,

(42)

where h is a function with symmetry
h(x, y; Fx , Fy ) = h(y, x; Fy , Fx ).
The only thing remaining is to specify a particular function h, so that all σij , i ≠ j,
would be assigned. In choosing the function h, we have some constraints. For example:
1. On all three vertices, the values of σkj given by (42) are consistent with the discussions above.
2. The ansatz should cover the equilibrium distribution at the barycenter of the
triangle.
With these constraints, our objective is to find an h for which the region where IˆB is a
non-negative integrable function is as large as possible. The requirements for h can be
summarized in the following lemma:

21

Lemma 3.10. Consider the case when λ1 = 0. For consistency with previous constraints on the vertices, the need to contain equilibrium, and to generate a non-negative
ansatz for all moments within the region specified by Lemma 3.5, h should satisfy the
following:
1. h(λ2 , λ3 ; F2 , F3 ) ≤ 0, within the rectangle ∣Fj ∣ ≤ λj , j = 2, 3.
2. − 12 h(λ2 , λ3 ; F2 , F3 ) ≤ min {λ2 − ∣F2 ∣, λ3 − ∣F3 ∣}.
3. h(0, 1; 0, Fy ) = 0, h(1, 0; Fx , 0) = 0.
4. h( 21 , 21 , 0, 0) = − 13 .
5. h(x, y; ±x, ±y) = 0.
Proof. Items 1 and 2 come from requiring IˆB to be a non-negative distribution for the
rectangle region in Lemma 3.5. Recalling that on the side λ1 = 0, we have
1
σj = λj + h(λ2 , λ3 ; F2 , F3 ),
2

j = 2, 3.

(43)

From Lemma 3.5, a non-negative distribution for (12) in such cases require ∣Fj ∣ ≤ σj ≤
λj , j = 2, 3. Hence
h(λ2 , λ3 ; F2 , F3 ) ≤ 0,
and

1
− h(λ2 , λ3 ; F2 , F3 ) ≤ min {λ2 − ∣F2 ∣, λ3 − ∣F3 ∣} .
2
Item 3 is due to consistency on vertices. For instance, consider the case when
λ2 = 1, which should correspond to σ2 ∣λ2 =1 = 1, σ3 ∣λ2 =1 = 0. Plugging these into (43)
gives item 3.
1
Item 4 comes from recovering equilibrium. At equilibrium, λj = , Fj = 0, j =
3
1, 2, 3. Direct calculation gives item 4.
Item 5 also derives from the non-negativity of the ansatz. It is a direct consequence
of the discussions in Lemma 3.5. In fact, it will naturally be satisfied if both requirements 1 and 2 are satisfied. However, unlike either, it poses a direct constraint on
the value of h at certain points, which, therefore, is particularly useful when trying to
propose a formula for h.
In seeking h(x, y; Fx , Fy ), we start with item 5 in Lemma 3.10, which suggests
that h(x, y; Fx , Fy ) contains the factor
q(x, y; Fx , Fy ) = (x −

Fy2
Fx2
) (y −
).
x
y

(44)

Note that as discussed in Lemma 3.5, λ2 = 0 would induce F2 = 0, so this construction
also guarantees item 3. Also, q(λ2 , λ3 ; F2 , F3 ) ≥ 0 within the rectangle ∣Fj ∣ ≤ λj ,

22

j = 2, 3. Therefore, the remaining factor, h(x, y; Fx , Fy )/q(x, y; Fx , Fy ) is always
non-positive within ∣Fj ∣ ≤ λj , j = 2, 3. We choose this factor as a constant scaling of
r(x, y; Fx , Fy ) = − (1 −

2
Fx2 Fy
−
),
x
y

which is always non-positive within the realizability domain. The constant factor is
then given as 4/3 based on item 4 in Lemma 3.10. Therefore, the function h is set as
4
h(x, y; Fx , Fy ) = q(x, y; Fx , Fy )r(x, y; Fx , Fy ).
3

(45)

It is clear that it satisfies all items in Lemma 3.10 except for item 2. The precise
depiction of the extent to which item 2 is fulfilled is deferred to the investigation of
realizability in the next section.
With h given, the whole model is closed. Direct calculation gives us the closing
relation of σi , i = 1, 2, 3, as below:
σ1 = λ1 − g(λ1 , λ2 ; F1 , F2 ) − g(λ1 , λ3 ; F1 , F3 ),
σ2 = λ2 − g(λ2 , λ1 ; F2 , F1 ) − g(λ2 , λ3 , F2 , F3 ),

(46)

σ3 = λ3 − g(λ3 , λ1 ; F3 , F1 ) − g(λ3 , λ2 ; F3 , F2 ),
where
g(x, y; Fx , Fy ) =

2q(x, y; Fx , Fy )(x + y − 1 − r(x, y; Fx , Fy ))
,
3(x + y)2

satisfying g(x, y; Fx , Fy ) = g(y, x; Fy , Fx ).
With σj given as above, we substitute it into (17) to give wi , i = 1, 2, 3, as
w1 = σ1 + 2g(λ2 , λ3 ; F2 , F3 ),
w2 = σ2 + 2g(λ1 , λ3 ; F1 , F3 ),

(47)

w3 = σ3 + 2g(λ1 , λ2 ; F1 , F2 ).
Then we plug wi and σi into (35) to get γi and δi . With formula for wi , γi and δi ,
i = 1, 2, 3, we now have the complete closed formula for the ansatz IˆB in (12).
This closes our 3D B2 model.

4

Model Properties

In this section, we will study the rotational invariance, realizability, and hyperbolicity
of the 3D B2 model proposed.
The proof of rotational invariance is almost straightforward for our model. This is
because all the parameters Ri , wi , γi , and δi in the ansatz IˆB are given as functions of
known moments E 0 , E1 , and E 2 . Consequently, the ansatz is rotationally invariant, so
we conclude that the moment system produced by IˆB has rotational invariance. More
precisely, we have

23

Theorem 4.1. The 3D B2 model (13) is rotationally invariant.
Proof. For any unit vector n = (nx , ny , nz ) ∈ R3 , there exists a rotation to transform
n to the x-axis. Let n = T ex , where T is the rotation matrix. The rotated velocity is
denoted by Ω̃ = T T Ω. We denote ẽx = n = T ex , ẽy = T ey and ẽz = T ez . After
the rotation, the known moments are denoted by Ẽ, and we write the ansatz before and
after the rotation with explicit dependence on the known moments by IˆB (Ω; E) and
2
IˆB (Ω; Ẽ). We use Ẽ 0 , Ẽ1 , and Ẽ to denote the corresponding moments after the
rotation, respectively. Let us define ṽ as
ṽ = [ 1,
(Ω ⋅ ẽx ),

(Ω ⋅ ẽy ),

(Ω ⋅ ẽz ),

2

(Ω ⋅ ẽx ) , (Ω ⋅ ẽx )(Ω ⋅ ẽy ), (Ω ⋅ ẽx )(Ω ⋅ ẽz ),
(Ω ⋅ ẽy )2 ,
(Ω ⋅ ẽy )(Ω ⋅ ẽz )

]T .

It is clear there exists a transformation matrix T which depends only on T such that
ṽ = Tv,
where v is defined in (2). Thus, the known moments satisfy Ẽ = TE and
Ẽ 0 = E 0 ,

Ẽ1 = T E1 ,

2

Ẽ = T T E 2 T .

2

Consequently, the eigenvectors R̃i of Ẽ are R̃i = T T Ri , and thus,
Ω̃ ⋅ R̃i = Ω ⋅ Ri ,
F̃i = Ẽ1 ⋅ R̃i = E1 ⋅ Ri = Fi .
The given closure for wi , γi , and δi are functions of the eigenvalues of E 2 and Fi ,
i = 1, 2, 3. Thus, these parameters are exactly the same before and after the rotation.
Therefore, the ansatz after the rotation satisfies
3
1
wi f (Ω̃ ⋅ R̃i ; γi , δi )
IˆB (Ω̃; TE) = ∑
2π
i=1
3

1
wi f (Ω ⋅ Ri ; γi , δi ) = IˆB (Ω; E).
i=1 2π

=∑

Meanwhile, notice that we have the relation
ṽ = [ 1,
(Ω̃ ⋅ ex ),

(Ω̃ ⋅ ey ),

(Ω̃ ⋅ ez ),

(Ω̃ ⋅ ex )2 , (Ω̃ ⋅ ex )(Ω̃ ⋅ ey ), (Ω̃ ⋅ ex )(Ω̃ ⋅ ez ),
(Ω̃ ⋅ ey )2 ,
(Ω̃ ⋅ ey )(Ω̃ ⋅ ez )

24

]T

Therefore,
nx fx (E) + ny fy (E) + nz fz (E) = ∫ (nx Ωx + ny Ωy + nz Ωz )vIˆB (Ω; E) dΩ
S2

= ∫ (Ω ⋅ ẽx ) (T−1 ṽ) IˆB (Ω̃; TE) ∣T ∣ dΩ̃
S2

= T−1 ∫ (Ω̃ ⋅ ex ) ṽIˆB (Ω̃; TE) dΩ̃
−1

=T

S2

∫ 2 (Ω ⋅ ex ) vIˆB (Ω; TE) dΩ
S

= T−1 fx (TE).
This gives us rotational invariance 4 .
Let us turn to the realizability of our model. First, we point out that the 3D B2
model provides a non-negative ansatz even for some moments on the boundary of the
realizability domain. For example, the moments satisfying ∣Fi ∣ = λi , ∀i = 1, 2, 3,
correspond to ansätze of the form
3

IˆB = ∑ [αi+ δ(Ω ⋅ Ri − 1) + αi− δ(Ω ⋅ Ri + 1)] .
i=1

We recall the following results from Lemma 3.6: if λi are distinct positive values,
then the eight vertices of the rectangular box ∣Fj ∣ ≤ λj , j = 1, 2, 3, are the only points
on the boundary of the realizability domain where a non-negative ansatz for IˆB may
exist. Moreover, the ansatz contains the equilibrium distribution. Moments satisfying
E0
E0
λi =
, i = 1, 2, 3, and E1 = 0 reproduce IˆB =
.
3
4π
Recall that (23) is a sufficient condition for (12) to give a non-negative ansatz. It is
equivalent to
0 ≤ σi ≤ wi , and σi wi ≥ Fi2 , i = 1, 2, 3.
(48)
We examine this condition to check the realizability of our model. Define the following
discriminant
(49)
∆ ≜ min {w1 σ1 − F12 , w2 σ2 − F22 , w3 σ3 − F32 } .
Instantly, we have
Theorem 4.2. For ∣Fj ∣ ≤ λj ≠ 0, j = 1, 2, 3, the 3D B2 model has a non-negative
ansatz IˆB if
3λ2i + λi (λj + λk ) − λj λk > 0,

∀ i, j, k, mutually different,

(50)

and
∆ ≥ 0.
4 We

note that the proof is not at all dependent on whether the function f in the ansatz is assigned as a
beta distribution.

25

Proof. We first prove σ1 ≤ w1 . Notice that
4 (λ2 −
w1 − σ1 = 2g(λ2 , λ3 ; F2 , F3 ) =

F22
F2
F2
F2
) (λ3 − 3 ) (λ2 − 2 + λ3 − 3 )
λ2
λ3
λ2
λ3
.
2
3(λ2 + λ3 )

Also, if ∣Fj ∣ ≤ λj , we have
λj −

Fj2
λj

≥ 0.

Therefore, inside the rectangular box ∣Fj ∣ ≤ λj , j = 1, 2, 3, we have w1 − σ1 ≥ 0.
Similarly, we could prove σ2 ≤ w2 and σ3 ≤ w3 .
We now discuss the condition for σi ≥ 0, i = 1, 2, 3. We begin by examining σ1 .
From (46), we see that for fixed λi , i = 1, 2, 3, the function σ1 monotonically increases
for any ∣Fj ∣. Therefore, if σ1 ≥ 0 holds for E1 = 0, then it is valid for the whole
rectangular box ∣Fj ∣ ≤ λj , j = 1, 2, 3. So, the problem becomes seeking (λ1 , λ2 , λ3 )
for which σ1 ∣F1 =F2 =F3 =0 ≥ 0 holds. As
σ1 ∣F1 =F2 =F3 =0 =

λ1 (3λ21 + λ1 λ2 + λ1 λ3 − λ2 λ3 )
,
3(λ1 + λ2 )(λ1 + λ3 )

the necessary and sufficient condition for σ1 > 0 is
3λ21 + λ1 (λ2 + λ3 ) − λ2 λ3 > 0,

(51)

which completes our proof.
From the proof of Theorem 4.2 we have the following corollary.
Corollary 4.1. Let E1 = 0. If (50) is valid and λi ≠ 0, ∀i = 1, 2, 3, the 3D B2 model
has a non-negative ansatz.
Proof. In the case of E1 = 0, ∆ > 0 is automatically valid under the conditions specified in the corollary.
Given λi and Fi , i = 1, 2, 3, we could use the condition placed on the discriminant ∆ in Theorem 4.2 to verify whether a non-negative ansatz exists. For each fixed
(λ1 , λ2 , λ3 ), we sample for the whole region within the rectangular box ∣Fj ∣ ≤ λj ,
λi
1
j = 1, 2, 3. It is found that if 0 ≥ , i = 1, 2, 3, then for any (F1 , F2 , F3 ) belonging
E
7
to the region ∣Fj ∣ ≤ λj , j = 1, 2, 3, the 3D B2 model has a non-negative ansatz. Note
that the realizability domain for Fj is the ellipsoid given in Lemma 3.4, and the rectangular box ∣Fj ∣ ≤ λj , j = 1, 2, 3, is contained within the ellipsoid, with its eight vertices
touching the domain boundary. Figure 2 illustrates the region that is found to admit a
non-negative ansatz.
Remark 4.1. By Lemma 3.8, for E1 = 0, the third-order moments given by the 3D B2
ansatz is a zero tensor, equal to that given by M2 . For this particular case, even when
there is no non-negative ansatz, the closure relation is still realizable.
26

λ1 λ2 λ3
,
,
) are taken as barycenE0 E0 E0
tric coordinates within the triangle. The
outer triangle is the realizability domain.
The curves correspond to the outer
boundary of the constraints (50). The
blue region gives non-negative ansatz
for 3D B2 model for all E1 satisfying
∣Fj ∣ ≤ λj , j = 1, 2, 3.

(a) (

(b) The sphere correspond to the realizability domain of E1 when λ1 =
λ2 = λ3 .The rectangle within
the sphere is the region for E1
when the 3D B2 model has a nonnegative ansatz.

Figure 2: Region which correspond to a non-negative ansatz for 3D B2 model.
We proceed to study the hyperbolicity of the model. Due to the extreme complexity
of the formula, we restrict our discussions to the case that E1 = 0. We first prove the
following facts:
Lemma 4.1. In the interior of the realizability domain M, if E1 = 0, we have
wi > 0,

σi + wi > 0,

i = 1, 2, 3.

Proof. Take i = 1 for example. First, note
g(x, y; 0, 0) =

2q(x, y; 0, 0)(x + y − 1 − r(x, y; 0, 0))
2xy
=
.
3(x + y)2
3(x + y)

Therefore,
w1 =λ1 − g(λ1 , λ2 ; 0, 0) − g(λ1 , λ3 ; 0, 0) + 2g(λ2 , λ3 ; 0, 0)
1
2λ1 λ2
2λ1 λ3
4λ2 λ3
= (3λ1 −
−
+
)
3
λ1 + λ2 λ1 + λ3 λ2 + λ3
1
2λ1 λ2
2λ1 λ3
4λ2 λ3
= (λ1 −
+ 2λ1 −
+
)
3
λ1 + λ2
λ1 + λ3 λ2 + λ3
1
2λ1 λ2
2λ1 (λ1 + λ3 − λ3 ) 4λ2 λ3
= (λ1 −
+
+
)
3
λ1 + λ2
λ1 + λ3
λ2 + λ3
1
2λ1 λ2
2λ21
4λ2 λ3
= (λ1 −
+
+
).
3
λ1 + λ2 λ1 + λ3 λ2 + λ3
We need to prove w1 ≥ 0 for two cases:
27

1. λ1 ≥ λ2 or λ1 ≥ λ3 . Because w1 is symmetric with respect to λ2 and λ3 , we only
need to discuss the case λ1 ≥ λ2 .
2. λ1 < λ2 and λ1 < λ3 . Due to w1 being symmetric about λ2 and λ3 , we only need
to discuss the case λ1 < λ2 ≤ λ3 .
The proof is as follows:
1. If λ1 ≥ λ2 , then
−

2λ1 λ2
2λ1 λ2
≥−
= −λ1 ,
λ1 + λ2
λ2 + λ2

therefore
w1 =

2λ1 λ2
2λ21
4λ2 λ3
1
2λ21
4λ2 λ3
1
(λ1 −
+
+
)≥ (
+
) > 0.
3
λ1 + λ2 λ1 + λ3 λ2 + λ3
3 λ1 + λ3 λ2 + λ3

2. If λ1 < λ2 ≤ λ3 , then
−
and

2λ1 λ2
2λ1 λ2
≥−
= −λ2 ,
λ1 + λ2
λ1 + λ1
4λ2 λ3
4λ2 λ3
≥
= 2λ2 .
λ2 + λ3 λ3 + λ3

Therefore
w1 =

1
2λ1 λ2
2λ21
4λ2 λ3
1
2λ21
(λ1 −
+
+
) ≥ (λ1 − λ2 +
+ 2λ2 ) > 0.
3
λ1 + λ2 λ1 + λ3 λ2 + λ3
3
λ1 + λ3

This proves w1 > 0. Similarly, wj > 0, j = 2, 3.
Next, we prove σ1 + w1 > 0. We have
σ1 +w1 =

2
2λ1 λ2
2λ1 λ3
2λ2 λ3
2
2λ1 λ2
2λ21
2λ2 λ3
(3λ1 −
−
+
) = (λ1 −
+
+
).
3
λ1 + λ2 λ1 + λ3 λ2 + λ3
3
λ1 + λ2 λ1 + λ3 λ2 + λ3

Similar to discussions on w1 , we have
1. If λ1 ≥ λ2 , then
σ1 + w1 =

2
2λ1 λ2
2λ21
2λ2 λ3
2
2λ21
2λ2 λ3
(λ1 −
+
+
)≥ (
+
).
3
λ1 + λ2 λ1 + λ3 λ2 + λ3
3 λ1 + λ3 λ2 + λ3

2. If λ1 < λ2 ≤ λ3 , then
σ1 +w1 =

2
2λ1 λ2
2λ21
2λ2 λ3
2
2λ21
(λ1 −
+
+
) ≥ (λ1 − λ2 +
+ λ2 ) > 0.
3
λ1 + λ2 λ1 + λ3 λ2 + λ3
3
λ1 + λ3

Similarly, σi + wi > 0, i = 2, 3.
28

To study hyperbolicity, we start with calculating the Jacobian matrix of the flux fx ,
fy , and fz . Due to the rotational invariance of the 3D B2 model, it could be assumed
without loss of generality that E 2 is diagonal, R1 is parallel to the x-axis, R2 is parallel
to the y-axis, and R3 is parallel to the z-axis, respectively. The most involving part in
calculating the Jacobian matrix is the derivatives of third-order moments. We first note
that, by Lemma 3.8, fixing E1 = 0 makes the value of all third-order moments zero, no
matter what the values of the other moments are. Therefore,
3
∂Eijk

∂E 0

= 0,

So we only need to compute

3
∂Eijk
2
∂Elm

3
∂Eijk

∂El1

= 0,

∀i, j, k, l, m = 1, 2, 3.

. First, we have

3
∂ ⟨(Ω ⋅ Ri )(Ω ⋅ Rj )(Ω ⋅ Rk )IˆB ⟩
∂E123
=
Ri1 Rj2 Rk3
1
∂El
∂El1
∂ ⟨(Ω ⋅ R1 )(Ω ⋅ R2 )(Ω ⋅ R3 )IˆB ⟩
=
= 0.
∂El1

For the terms
3
∂Eiij

∂Ek1

3
∂Eiij

∂Ek1

, we have

∂ ⟨(Ω ⋅ Rl )(Ω ⋅ Rm )(Ω ⋅ Rn )IˆB ⟩
=

∂Ek1

Rli Rmi Rnj =

∂ ⟨(Ω ⋅ Ri )2 (Ω ⋅ Rj )IˆB ⟩
∂Ek1

.

And by
Fi = E1 ⋅ Ri = E11 R1i + E21 R2i + E31 R3i ,
3
∂Eiij
∂Fi
=
δ
,
which
is
used
below
in
computing
.
ik
∂Ek1
∂Ek1
If i = j and k =/ i,

we get

∂ ⟨(Ω ⋅ Ri )3 IˆB ⟩
∂Ek1

= Fi

σ 2 + 2F 2 − 3wi σi
∂
( i 2 i
) = 0.
1
∂Ek 2Fi − wi σi − wi2

And if i =/ j and k =/ j,
∂ ⟨(Ω ⋅ Ri )2 (Ω ⋅ Rj )IˆB ⟩
∂Ek1

=

σj2 + 2Fj2 − 3wj σj
Fj ∂
(1
−
) = 0.
2 ∂Ek1
2Fj2 − wj σj − wj2
3
∂Eiij

only. By rotational
∂Ej1
invariance of the model, we need only study the Jacobian matrix in the x-direction,
Therefore, the non-zero entries in the Jacobian matrix can be

29

∂fx
, which is
∂E
⎛
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
Jx = ⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎝

0

1

0

0

0

0

0

0

0

0

0

0

1

0

0

0

0

0

0

0

0

1

0

0

0

0

0

0

0

0

1

0

0

3
∂E111
∂E11

0

0

0

0

0

0

0

0

3
∂E112
∂E21

0

0

0

0

0

0

0

0

3
∂E113
∂E31

0

0

0

0

0

3
∂E122
∂E11

0

0

0

0

0

0

0

0

0

0

0

0

0

0

⎞
0 ⎟
⎟
⎟
0 ⎟
⎟
⎟
⎟
⎟
0 ⎟
⎟
⎟
⎟
0 ⎟
⎟
⎟
⎟
⎟
0 ⎟
⎟.
⎟
⎟
⎟
0 ⎟
⎟
⎟
⎟
⎟
0 ⎟
⎟
⎟
⎟
⎟
0 ⎟
⎟
⎟
⎟
⎟
0 ⎠

(52)

For the non-zero entries in Jx , we have the following bounds:
Lemma 4.2. In the interior of the realizability domain M, if E1 = 0, we have
1. 0 <

3
∂E11k
1
< , for k = 2, 3;
∂Ek1
2

2. 0 <

3
∂E111
≤ 1 if and only if σ1 > 0.
∂E11

Proof. For the first item, we only need to verify for k = 2. By Lemma 3.8, one has
3
∂ ⟨(Ω ⋅ R1 )2 (Ω ⋅ R2 )IˆB ⟩
∂E112
=
∂E21
∂E21

1
σ 2 + 2F 2 − 3w2 σ2
= (1 − 2 2 2
)
2
2F2 − w2 σ2 − w22
=

1 (w2 − σ2 )2
.
2 w2 (σ2 + w2 )

3
∂E112
> 0. In addition, from
∂E21
3
∂E112
1
the proof of Theorem 4.2, we have σ2 ≤ w2 , therefore
< .
1
∂E2
2

By Lemma 4.1 we have w2 > 0 and σ2 + w2 > 0, thus,

30

For the second item, we have by Lemma 3.8,
3
∂ ⟨(Ω ⋅ R1 )3 IˆB ⟩ σ12 + 2F12 − 3w1 σ1
∂E111
=
=
∂E11
∂E11
2F12 − w1 σ1 − w12

=

σ1 (3w1 − σ1 )
(w1 − σ1 )2
=1−
≤ 1,
w1 (σ1 + w1 )
w1 (σ1 + w1 )

3
∂E111
> 0 is equivalent to σ1 (3w1 − σ1 ) > 0. As σ1 ≤ w1 , we have 3w1 − σ1 ≥
∂E11
3
∂E111
2w1 > 0, implying that
> 0 is equivalent to σ1 > 0.
∂E11

And

We now give the condition for the real diagonalizability of the Jacobian matrix Jx
as follows:
Theorem 4.3. The Jacobian matrix Jx defined in (52) is real diagonalizable if and
only if σ1 > 0.
Proof. The characteristic polynomial of Jx is
∣λI − Jx ∣ = λ3 (λ2 −

3
3
3
∂E111
∂E112
∂E113
2
2
)
(λ
−
)
(λ
−
),
∂E11
∂E21
∂E31

(53)

thus zero is a multiple eigenvalue of Jx . The corresponding eigenvectors are
(0, 0, 0, 0, 0, 0, 0, 0, 1)T ,
In the case that

(0, 0, 0, 0, 0, 0, 0, 1, 0)T ,

3
∂E111
≥ 0,
∂E11

3
∂E112
≥ 0,
∂E21

the corresponding eigenvalues of the matrix are
¿
¿
3
3
Á ∂E112
Á ∂E111
±
±
Á
À
À
λ1 = ±
, λ2 = ±Á
,
1
∂E1
∂E21

(1, 0, 0, 0, 0, 0, 0, 0, 0)T .

3
∂E113
≥ 0,
∂E31

λ±3

¿
3
Á ∂E113
À
= ±Á
,
∂E31

and the corresponding eigenvectors are
1
⎛
⎜ λ±1
⎜
⎜
0
⎜
⎜
0
⎜
⎜ ∣λ± ∣2
⎜
1
⎜
⎜
0
⎜
⎜
0
⎜
⎜ ∂E 3
⎜
122
⎜
⎜ ∂E11
⎝
0

⎞
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟,
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎠

⎛
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎝

0
0
−1
0
0
λ±2
0
0
0

31

⎞
⎟
⎟
⎟
⎟
⎟
⎟
⎟,
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎠

⎛
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎝

0
0
0
−1
0
0
λ±3
0
0

⎞
⎟
⎟
⎟
⎟
⎟
⎟
⎟.
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎠

It could be verified directly that if any of the eigenvalues λ±i , i = 1, 2, 3, equals zero,
the Jacobian matrix is not real diagonalizable. If we have
3
∂E111
> 0,
∂E11

3
∂E112
> 0,
∂E21

3
∂E113
> 0,
∂E31

(54)

by the linear independence of the eigenvectors, one concludes that the Jacobian matrix
is real diagonalizable. Then the proof is finished by Lemma 4.2.
As a direct consequence of Theorem 4.3, the 3D B2 model is hyperbolic at equilibrium. This can be proved by the following arguments. Let Rj , j = 1, 2, 3 be the three
eigenvectors of E 2 . Denote the k-th component of the vector Rj to be Rkj . Define
3

the Jacobian matrix of the 3D B2 model (13) along Rj , j = 1, 2, 3 to be ∑ Rkj Jk .
k=1

Theorem 4.3 shows that for the cases E1 = 0, condition (50) is the necessary and sufficient condition for the Jacobian matrix along Rj , ∀j = 1, 2, 3 to be real diagonalizable.
The above result holds because for any given Rj , j = 1, 2, 3, we could always rotate
the coordinate system, such that Rj is aligned with the x-axis. Theorem 4.2 gives (51)
as the necessary and sufficient condition for σ1 > 0, and rotation of coordinates can
permute the indices in (51), which results in (50). Notice that at equilibrium, E 2 is a
scalar matrix, so any direction is an eigenvector of E 2 . Therefore, the 3D B2 model is
hyperbolic at equilibrium.
For given moments, we could always choose a coordinate system such that E 2
is a diagonal matrix. The system is hyperbolic if and only if for an arbitrary n =/
0, we always have nx Jx + ny Jy + nz Jz to be real diagonalizable. For E1 = 0, we
sample for all possible (λ1 , λ2 , λ3 ) and all unit vectors n, to check if the matrix is
real diagonalizable. There is a hyperbolicity region around equilibrium for E1 = 0 as
in Figure 3. The hyperbolicity region is a smaller region than that enclosed by (50).
However, it does cover a neighborhood of the equilibrium.
Finally, we point out that although the 3D B2 model is aimed at approximating the
M2 model, there is an interesting difference between them. This difference arises from
the fact that the ansatz is assumed to be the form IˆB in (12), and is independent of
choice for the function f (µ; γ, δ). When the given moments satisfy
∃i =/ j, such that λi = λj , and Fi = Fj = 0,

(55)

the corresponding ansatz in the M2 model is an axisymmetric function. This includes the equilibrium distribution. Exactly at the equilibrium, the 3D B2 ansatz IˆB
is isotropic, and, thus, axisymmetric. However, even in neighbourhoods of the equilibrium, moments corresponding to an axisymmetric ansatz in the M2 model would
usually not reproduce an axisymmetric ansatz for the 3D B2 model. In other words,
for arbitrary  > 0, there exist moments in the set
2
⎧
⎫
3
⎪
⎪
E0
⎪
⎪
A = ⎨(E 0 , E1 , E 2 ) ∈ M ∣ E1 = 0, ∑ ∣λi −
∣ < , and (55) is valid⎬ ,
⎪
⎪
3
⎪
⎪
i=1
⎩
⎭

32

1.8
1.6
1.4
1.2
1
0.8
0.6
0.4
0.2
0
-1

-0.5

0

0.5

1

λ1 λ2 λ3
,
,
) are taken as barycenE0 E0 E0
tric coordinates within the triangle. The outer triangle is the realizability domain. The
curves correspond to the outer boundary of the constraints (50). The 3D B2 model is
found to be hyperbolic within the dotted blue region.

Figure 3: Region of hyperbolicity when E1 = 0. (

for which the 3D B2 ansatz IˆB is not axisymmetric; otherwise, the closure relation
may lose the necessary regularities. More precisely, we claim:
Theorem 4.4. There are no functions wi (λ1 , λ2 , λ3 ; F1 , F2 , F3 ), i = 1, 2, 3, in the 3D
B2 ansatz IˆB satisfying both items below:
1. wi , i = 1, 2, 3, are differentiable at the equilibrium state.
2. The ansatz IˆB is axisymmetric for any moments in A .
Proof. We prove by contradiction. Suppose that (12) is an axisymmetric distribution.
Without losing generality we assume the corresponding moments satisfy λ2 = λ3 ,
therefore the symmetric axis is aligned to R1 , and F2 = F3 = 0. To get axisymmetry in (12), the contributions from w2 f (Ω ⋅ R2 ; γ2 , δ2 ) and w3 f (Ω ⋅ R3 ; γ3 , δ3 ) have
w2
w3
to be either zero or constant functions, hence σ2 =
and σ3 =
, giving
3
3
σ1 + σ2 + σ3 = λ1 .
Similar relations could be obtained when the symmetric axis is aligned to R2 or R3 .
Consider the case when E1 = 0. Let
σ(λ1 , λ2 , λ3 ) = σ1 (λ1 , λ2 , λ3 ; 0, 0, 0) + σ2 (λ1 , λ2 , λ3 ; 0, 0, 0) + σ3 (λ1 , λ2 , λ3 ; 0, 0, 0).
Based on the above arguments, we have
⎧
⎪
λ1 ,
⎪
⎪
⎪
⎪
⎪
σ(λ1 , λ2 , λ3 ) = ⎨ λ2 ,
⎪
⎪
⎪
⎪
⎪
⎪
⎩ λ3 ,

if

λ2 = λ3 = 12 (E 0 − λ1 ),

if

λ1 = λ3 = 12 (E 0 − λ2 ),

if
33

λ1 = λ2 =

1
(E 0
2

− λ3 ).

(56)

If all wi , i = 1, 2, 3, are differentiable, then all σi , i = 1, 2, 3, are differentiable, so ∇σ
should be a continuous function for all realizabile moments. Let
1 1
n1 = (1, − , − ),
2 2

1
1
n2 = (− , 1, − ),
2
2

1 1
n3 = (− , − , 1),
2 2

then ∇σ ⋅ (n1 + n2 + n3 ) = 0. On the other hand, ∇σ ⋅ n1 is equivalent to taking the
derivative of σ along λ2 = λ3 = 21 (E 0 − λ1 ), and we have similar relationships for n2
E0
and n3 . So evaluating ∇σ ⋅ nj at λj =
, j = 1, 2, 3 and E1 = 0 according to (56)
3
gives ∇σ ⋅ (n1 + n2 + n3 ) = 3, leading to a contradiction. Therefore the two items can
not be satisfied simultaneously.
Notice that the proof of this lemma does not make use of the specific form of the
function f in (12). In fact, it can be seen from the proof that this inconsistency is due
to the fact that the ansatz is a linear combination of three axisymmetric distributions.
However, although the new model does not reproduce an axisymmetric ansatz for moments corresponding to an axisymmetric ansatz in the M2 model, in such cases the
closure of the new model retain the same structure as the M2 closure. Without loss of
generality consider the case when λ2 = λ3 = 0 and F2 = F3 = 0. From (38), we have
⟨(Ω ⋅ R1 )2 (Ω ⋅ R2 )IˆB ⟩ = ⟨(Ω ⋅ R1 )2 (Ω ⋅ R3 )IˆB ⟩ = 0,
1
⟨(Ω ⋅ R1 )(Ω ⋅ R2 )2 IˆB ⟩ = ⟨(Ω ⋅ R3 )(Ω ⋅ R2 )2 IˆB ⟩ = (F1 − ⟨(Ω ⋅ R1 )3 ⟩) ,
2

(57)

satisfying the same equalities as that given by an M2 ansatz with R1 as the symmetric
axis.
Define
E1 =

∥E1 ∥
,
E0

E2 =

1
(E1 )T E 2 E1 ,
(E 0 )3

E3 =

1
3
ˆ .
⟨(Ω ⋅ E1 ) I⟩
0
4
(E )

Then Ei , i = 1, 2, 3 would be the scaled first, second and third-order moments for slab
geometry cases. We compare the contour of E3 between the 3D B2 model and the M2
model for slab geometry5 in Figure 4. It is shown in Figure 4 that the 3D B2 model
provides realizable closure which is qualitatively similar to that of M2 closure for most
of realizable moments.

5

Conclusion and Future Work

We proposed a 3D B2 model that is an extension of the EQMOM (B2 model) in 1D.
We showed, step by step, how the structure of the new model is gradually refined.
Particularly, we studied the main properties of this new model, including rotational
invariance, realizability, and hyperbolicity.
5 The figure for the slab geometry was reproduced based on the data used to plot the corresponding figure
in [3], and the computation was carried out by Dr. Alldredge using his own code during our collaboration
therein.

34

B2

1

1.0

0.8

1

1.0

0.8

0.5

0.5

E2

0.6

E2

0.6
0.0

0.4

0.0
0.4

−0.5

0.2
0
−1

M2 Monochromatic

−0.5

0

0.5

1

−0.5

0.2
0
−1

−1.0

E1

−0.5

0

0.5

1

−1.0

E1

(a) The value of E3 in slab geometry for normalized
realizable moments using the 3D B2 closure.

(b) The value of E3 for normalized realizable moments using the maximum entropy closure in
slab geometry for the monochromatic case.

Figure 4: Comparing the value of the closing moment E3 for M2 for the monochromatic case and for the 3D B2 model in slab geometry.
We are currently carrying out numerical simulations using the new model. For the
first step, we hope that the model provides satisfactory results on standard benchmark
problems.

Acknowledgements
The authors appreciate the financial supports provided by the National Natural Science Foundation of China (NSFC) (Grant No. 91330205, 11421110001, 11421101
and 11325102) and by the Specialized Research Fund for State Key Laboratories.

References
[1] Graham W Alldredge, Cory D Hauck, Dianne P OLeary, and André L Tits. Adaptive change of basis in entropy-based moment closures for linear kinetic equations. Journal of Computational Physics, 258:489–508, 2014.
[2] Graham W Alldredge, Cory D Hauck, and André L Tits. High-order entropybased closures for linear transport in slab geometry ii: A computational study of
the optimization problem. SIAM Journal on Scientific Computing, 34(4):B361–
B391, 2012.
[3] Graham W Alldredge, Ruo Li, and Weiming Li. Approximating the m 2 method
by the extended quadrature method of moments for radiative transfer in slab geometry. Kinetic & Related Models, 9(2), 2016.
[4] R. Curto and L. Fialkow. Recursiveness, positivity and truncated moment problems. Houston J. Math, 17(4):603–635, 1991.

35

[5] B. Dubroca and J.-L. Fuegas. Étude théorique et numérique d’une hiérarchie de
modèles aus moments pour le transfert radiatif. C.R. Acad. Sci. Paris, I. 329:915–
920, 1999.
[6] Martin Frank, Bruno Dubroca, and Axel Klar. Partial moment entropy approximation to radiative heat transfer. Journal of Computational Physics, 218(1):1–18,
2006.
[7] C Kristopher Garrett, Cory Hauck, and Judith Hill. Optimization and large scale
computation of an entropy-based moment closure. Journal of Computational
Physics, 2015.
[8] Norman Lloyd Johnson and Samuel Kotz. Discrete Distributions: Continuous
Univariate Distributions-2. Wiley, 1970.
[9] Michael Junk. Maximum entropy for reduced moment problems. Mathematical
Models and Methods in Applied Sciences, 10(07):1001–1025, 2000.
[10] DS Kershaw. Flux limiting natures own way. Lawrence Livermore National
Laboratory, UCRL-78378, 1976.
[11] C David Levermore. Moment closure hierarchies for kinetic theories. Journal of
Statistical Physics, 83(5-6):1021–1065, 1996.
[12] E. E. Lewis and W. F. Miller, Jr. Computational Methods in Neutron Transport.
John Wiley and Sons, New York, 1984.
[13] T Pichard, GW Alldredge, S Brull, B Dubroca, and M Frank. An approximation of the m 2 closure: Application to radiotherapy dose simulation. Journal of
Scientific Computing, pages 1–38, 2016.
[14] Gerald C Pomraning. The equations of radiation hydrodynamics. Courier Dover
Publications, 1973.
[15] Florian Schneider. Kershaw closures for linear transport equations in slab geometry i: Model derivation. Journal of Computational Physics, 322:905 – 919,
2016.
[16] V Vikas, CD Hauck, ZJ Wang, and Rodney O Fox. Radiation transport modeling using extended quadrature method of moments. Journal of Computational
Physics, 246:221–241, 2013.
[17] Kai-Bor Yu. Recursive updating the eigenvalue decomposition of a covariance
matrix. Signal Processing, IEEE Transactions on, 39(5):1136–1145, 1991.

36

