On the removal lemma for linear configurations in finite abelian groups
Lluı́s Vena∗

arXiv:1505.02280v1 [math.CO] 9 May 2015

July 31, 2018

Abstract
We present a general framework to represent discrete configuration systems using hypergraphs. This representation allows one to transfer combinatorial removal lemmas to their analogues for configuration systems.
These removal lemmas claim that a system without many configurations can be made configuration-free by
removing a few of its constituent elements. As applications of this approach we give; an alternative proof of the
removal lemma for permutations by Cooper [6], a general version of a removal lemma for linear systems in finite
abelian groups, an interpretation of the mentioned removal lemma in terms of subgroups, and an alternative
proof of the counting version of the multidimensional Szemerédi theorem in abelian groups with generalizations.

1

Introduction

In 1976 Ruzsa and Szemerédi introduced the Triangle Removal Lemma [28], which roughly states that in a graph
with not many triangles (copies of the complete graph on 3 vertices), we can remove a small proportion of the
edges to leave the graph with no copies of the triangle at all.1 They gave a short proof of Roth’s theorem [27]
as an application: any subset of the integers with positive (upper) density contains non-trivial 3-term arithmetic
progressions.2 The case for k-term arithmetic progressions, conjectured by Erdős and Turán [38], was established
by Szemerédi in 1975 and is now called Szemerédi’s Theorem.
Both the Triangle Removal Lemma and Szemerédi’s Theorem use Szemerédi’s Regularity Lemma [35] in their
original proofs.3 However, Szemerédi’s Theorem does not seem to easily follow from the Triangle Removal Lemma
(or the general Removal Lemma for Graphs [8, 11].) Indeed, while the Triangle Removal Lemma follows almost
immediately from the Regularity Lemma, the proof of Szemerédi’s Theorem is more involved and the Regularity
Lemma is used in only one, yet crucial, step.
In [10] Frankl and Rödl showed that a k-uniform hypergraph version of the Removal Lemma suffices to establish the
existence of non-trivial (k + 1)-term arithmetic progressions in subsets of the integers with positive density.4 The
argument is similar to the one used by Ruzsa and Szemerédi [28] to show the 3-term case using the Triangle Removal
Lemma.5 This simple proof of Szemerédi’s Theorem, along with the many applications that the Regularity Lemma
for Graphs has (see the surveys [18, 17]), were the main motivations to extend the Regularity and the Removal
lemmas from graphs to hypergraphs. This extension was done by several authors following different approaches:
∗ Department of Mathematics, University of Toronto, Canada.
Supported by a University of Toronto Graduate Student Fellowship.
Charles University, Czech Republic.
Supported by ERC-CZ project LL1201 CORES.
E-mail: lluis.vena@gmail.com
1 Recall that a (hyper)graph is composed by an ordered pair of sets; the vertex set and the set of edges, which are subsets of vertices.
A hypergraph is said to be k-uniform if all the edges are subsets of k vertices. A graph is a 2-uniform hypergraph. A copy of a triangle
is an injective map from {1, 2, 3} to the vertex set of the graph that sends an edge of the triangle to an edge in the graph. To be precise,
Ruzsa and Szemerédi showed the (6, 3)–Theorem, which states the following: in any 3-uniform hypergraph with δn2 edges, there are 6
vertices spanning (or inducing) 3 edges if n > n0 (δ).
2 The k-term arithmetic progressions are the configurations {a, a + d, . . . , a + (k − 1)d} with a ∈ Z and d ∈ Z
≥0
3 Szemerédi’s Regularity Lemma states that the vertex set of any graph can be partitioned into finitely many parts, such that between
most of the pairs, we have a quasi-random bipartite graph.
4 The Removal Lemma for Hypergraphs states that if a given k-uniform hypergraph K has few copies of a fixed k-uniform hypergraph
H, then it can be made free of copies of H by removing few edges. See Theorem 11.
5 In this paper, the argument of Ruzsa and Szemerédi can be found in the proof of Theorem 6 but the construction of the hypergraph
and the use of the Removal Lemma for Hypergraphs has been substituted by the removal lemma for homomorphisms Theorem 2.

1

a combinatorial approach from Nagle, Rödl, Schacht, and Skokan [23, 25], an approach using quasirandomness by
Gowers [14], a probabilistic approach from Tao [36], and a non-standard measure-theoretic approach by Elek and
Szegedy [7].

1.1

Arithmetic removal lemmas

In [15], Green used Fourier analysis techniques to establish a regularity lemma and a removal lemma for linear
equations in finite abelian groups. These statements are analogous to their combinatorial counterparts. The Group
Removal Lemma [15, Theorem 1.5] ensures that for every ε > 0 and every positive integer m, there exists a
δ = δ(ǫ, m) > 0 such that, for any finite abelian group G, if
x1 + · · · + xm = 0

(1)

has less than δ|G|m−1 solutions with xi ∈ Xi ⊂ G, then we can, by removing less than ε|G| elements in each Xi ,
create sets Xi′′ for which there is no solution to (1) with xi ∈ Xi′′ for all i ∈ [1, m].
Král’, Serra and the author [20] gave an alternative proof of the above removal lemma, showed by Green as [15,
Theorem 1.5], using the removal lemma for directed graphs [1]. With this alternative approach, the result was
extended to any finite group, eliminating the need of commutativity.
While a removal lemma for linear systems for some 0/1-matrices was shown to hold in [20] using graphs, the work
of Frankl and Rödl [10] suggested that the hypergraph setting might provide the right tools to extend the removal
lemma for one equation to a linear system. Indeed, Shapira [32], and independently Král’, Serra, and the author
[22], used the Removal Lemma for Hypergraphs to obtain a removal lemma for linear systems over finite fields and
proved a conjecture by Green [15, Conjecture 9.4] regarding a removal lemma for linear systems in the integers. A
partial result for finite fields was obtained by Král’, Serra, and the author [19], and also independently by Candela
[3].
In addition to showing the removal lemma for finite fields, Shapira [32] raised the issue of whether an analogous
result holds for linear systems over finite abelian groups. In [21], Král’, Serra, and the author answered the question
affirmatively provided that the determinantal6 of the integer matrix that defines the system is coprime to the
cardinality of the finite abelian group. See [21, Theorem 1] or Theorem 3 for the result.
In a different direction, Candela and Sisask [4] proved that a removal lemma for integer linear systems holds over
certain compact abelian groups. The main result in [4] has been recently extended by Candela, Szegedy and the
author [5] to any compact abelian group provided that the integer matrix has determinantal 1.
Previous combinatorial arguments. The proof schemes of the previous arithmetic removal lemmas in [20, 22,
21, 32] are inspired by the approaches of [28] and [10], and can also be found in [14, 33, 34, 37]. Concisely, the main
argument involves constructing a pair of graphs (or hypergraphs) (K, H) so as to make it possible to transfer the
removal lemma from the graph/hypergraph combinatorial setting to an arithmetic context. The pair (K, H) is said
to be a representation of the system and usually satisfies the property that each copy of H in K is associated with
a solution of our system. Moreover, these copies of H should be evenly distributed throughout the edges of K. The
notion of representability of a system by a hypergraph has been formalized by Shapira in [32, Definition 2.4].

1.2

Main notions and results

This paper is built around two main pieces. The first one is the generalization of the combinatorial representability
notion introduced by Shapira in [32]. This generalization is stated as Definition 10. The second piece is a removal
lemma for homomorphisms of finite abelian groups; given a finite abelian group G and a homomorphism A from Gm
to Gk , if a set X = X1 × · · · × Xm does not contain many x ∈ X with Ax = 0, then X can be made solution-free by
removing a small proportion of each Xi . The detailed statement can be found below as Theorem 2. Additionally,
we provide an interpretation of Theorem 2 in terms of subgroups, which is stated as Theorem 4, and can be seen
as a removal lemma for finite abelian subgroups.
6 The determinantal of order i of an integer matrix A is the greatest common divisor of all the i × i submatrices of A. In this paper,
the term determinantal is used to refer to the determinantal of maximal order. See [24, Chapter II, Section 13] or Section 5.2 for
additional details and more of its properties.

2

1.2.1

Systems of configurations and representability

Systems of configurations. Let us introduce the notion of a (finite) system of configurations. Let m be a
positive integer and let G be a set. A system of degree m over G consists of a pair (A, G), where A is a property
on the configurations of Gm , A : Gm → {0, 1}. If x ∈ Gm is such that A(x) = 1, then x is said to be a solution to
(A, G). In this paper all the sets G considered are finite.
Representable systems. We introduce as Definition 10 a more general notion of representability for systems
than the one given by Shapira in [32, Definition 2.4]. Although rather technical, Definition 10 asks for the existence
of a pair of hypergraphs (K, H), associated to a finite system of configurations (A, G), with the following summary
of properties (in parenthesis appear references to the properties described in Definition 10):
• Each copy of H in K is associated to a solution of (A, G) (domain and range of r in RP2.) The edges are
associated with elements of G (RP1, third point.)
• Given a solution of (A, G), there are many copies of H in K associated to such solution (cardinality of
r−1 (x, q) in RP2.) Those copies are well (evenly) distributed through the edges associated to the elements
that configure the solution (RP3 and RP4.)
• The number of vertices in H is bounded (first point in RP1.)
All these points are sufficient to prove a removal lemma for representable systems, which has Theorem 1 as the
precise statement.
Let us mention that the representations used in [20, 22, 21, 32] can be seen to give a representation according
to Definition 10. In [21], the authors used Shapira’s definition, with an extra post-processing, to show a removal
lemma for integer linear systems with determinantal 1 and where the sets to be removed are small with respect to
the total group, [21, Theorem 1]. The additional features of Definition 10 with respect to the representation notion
given by Shapira in [32] allow us to extend the result [21, Theorem 1] (Theorem 3 in this paper) to Theorem 2 in
the following way.
• The set Q is used to remove the determinantal condition and to extend the result to any homomorphism A
with domain Gm and image in Gk .
• The vector γ or, more precisely, the vector of proportions (1/γ1 , . . . , 1/γm ), allows us to claim that the i-th
removed set is an ǫ-proportion of the projection of the whole solution set onto the i-th coordinate. The
projection of the solution set is, in general, smaller than the whole abelian group G.7 See Theorem 1 for
further details.
1.2.2

Removal lemma for representable systems.

Let I ⊂ N be a set of indices. Consider (A, G, m) = {(Ai , Gi )}i∈I a family of systems of degree m. Let S(A, G)
denote the set of solutions for (A, G) ∈ (A, G, m) and let S(A, G, X) denote the subset of x ∈ S(A, G) with
x ∈ X ⊂ Gm .
Let Γ = {γ(i)}i∈I = {(γ1 (i), . . . , γm (i))}i∈I be a family of m-tuples of positive real numbers indexed by I. The
family (A, G, m) of systems is said to be Γ-representable, and the system (Ai , Gi ) is said to be associated with γi , if
Definition 10 in Section 2 holds. The representability property suffices to show a removal lemma for configuration
systems.
Theorem 1 (Removal lemma for representable systems). Let (A, G, m) be a Γ-representable family of systems.
Let (A, G) be an element in the family associated to γ = (γ1 , . . . , γm ). Let X1 , . . . , Xm be subsets of G and let
X = X1 × · · · × Xm .
For every ε > 0 there exists a δ = δ(m, ε) > 0, universal for all the members of the family, such that if
|S(A, G, X)| < δ|S(A, G)|,
7 For instance, the projection onto the first coordinate of the solution set of the equation x + 2(x + x ) = 0, with x ∈ Z , is
1
2
3
6
i
isomorphic to Z3 .

3

then there are sets Xi′ ⊂ Xi with |Xi′ | < ε|G|/γi for which
S (A, G, X \ X ′ ) = ∅,
′
where X \ X ′ = (X1 \ X1′ ) × · · · × (Xm \ Xm
).

Let us notice that, if a family of systems is Γ-representable, then the conclusions of Theorem 1 holds with smaller
γj (i)’s as the restrictions on the theorem decrease with the γ’s. In the representability notion of Shapira [32], as
well as in other works like [20, 22, 21], the γj (i) are all 1. Thus, the notion of representability Definition 10 is an
extension of [32, Definition 2.4].
1.2.3

Removal lemma for finite abelian groups.

Let G be a finite abelian group. Given b ∈ Gk , a homomorphism A from Gm to Gk induces a property (A, b)
in Gm given by: x ∈ S((A, b), G) if and only if A(x) = b. Let (A, G, m) be the family of systems given by the
homomorphisms (A, b) with fixed m. These are the configuration systems that we consider for most of the paper,
especially in Section 3 and onwards.
The set of homomorphisms A : Gm → Gk are in bijection with k × m homomorphism matrices (ϑi,j ) for some
homomorphisms ϑi,j : G → G depending on A.8 In particular, given b = (b1 , . . . , bk )⊤ ∈ Gk , (x1 , . . . , xm ) ∈
S ((A, b) , G) if and only if

 


b1
x1
ϑ1,1 · · · ϑ1,m
m
 ..
..   ..  =  ..  ⇐⇒ X ϑ (x ) = b , ∀j ∈ [1, k].
.
.
 .
j,i i
j
.
.  .   . 
ϑk,1

···

ϑk,m

xm

bk

i=1

Thus, we may use the term k × m homomorphism system on G to refer to the system induced by a homomorphism
from Gm to Gk .
Let Si ((A, b), G), i ∈ [1, m] denote the projection of the solution set S((A, b), G) to the i-th coordinate of Gm ,
Si ((A, b), G) = πi (S((A, b), G)). The solution set S((A, b), G) is denoted by S(A, G) when b = 0 or understood
by the context.
In the sections 4 and 5 of this paper, we show that the family of homomorphisms of finite abelian groups is Γrepresentable with γi = |G|/|Si ((A, b), G)| when m ≥ k + 2. Hence Theorem 1, together with the additional
comments to the construction presented in Section 6, implies Theorem 2.
Theorem 2 (Removal lemma for linear systems over abelian groups). Let G be a finite abelian group and let m, k
be two positive integers. Let A be a group homomorphism from Gm to Gk . Let b ∈ Gk . Let Xi ⊂ G for i = [1, m],
and X = X1 × · · · × Xm .
For every ε > 0 there exists a δ = δ(m, ε) > 0 such that, if
|S((A, b), G, X)| < δ |S((A, b), G)| ,
then there are sets Xi′ ⊂ Xi ∩ Si ((A, b), G) with |Xi′ | < ε|Si ((A, b), G)| and
′
S ((A, b), G, X \ X ′ ) = ∅, where X \ X ′ = (X1 \ X1′ ) × · · · × (Xm \ Xm
).

Also, let I ⊂ [1, m] be such that Xi ⊃ Si ((A, b), G) for i ∈ I. The previous statement holds with the extra condition
that Xi′ = ∅ for i ∈ I.
Let us state the known arithmetic removal lemma for finite abelian groups [21, Theorem 1].
Theorem 3 (Removal lemma for finite abelian groups, Theorem 1 in [21]). Let G be a finite abelian group and
let m, k be two positive integers. Let A be a k × m integer matrix with determinantal coprime with the order of
the group |G|.9 Let b ∈ Gk . Let Xi ⊂ G for i = [1, m], and X = X1 × · · · × Xm . For every ε > 0 there exists a
δ = δ(m, ε) > 0 such that, if
|S((A, b), G, X)| < δ |S((A, b), G)| = δ|Gm−k |,
8 See

[39, Section 13.10]
determinantal can be assumed to be 1. This restriction implies that |S((A, b), G)| = |Gm−k |, which is not true in the general
case, as Observation 25, or footnote 7 shows.
9 The

4

then there are sets Xi′ ⊂ Xi ∩ Si ((A, b), G) with |Xi′ | < ε|G| and
′
S ((A, b), G, X \ X ′ ) = ∅, where X \ X ′ = (X1 \ X1′ ) × · · · × (Xm \ Xm
).

We can see that Theorem 2 extends Theorem 3 in three ways:
• The coprimality condition between the determinantal of A and the order of the group is not needed.
• The systems induced
Qtby homomorphisms are more general than the systems induced by integer matrices. In
particular, if G = i=1 Zni , ni+1 |ni , and we let x = (x1 , . . . , xt ) ∈ G with xi ∈ Zni , then the homomorphism systems allow for linear equations between the components xi and xj . This fact is used to prove the
multidimensional version of Szemerédi’s Theorem. See Section 1.3.
• The sizes of the deleted sets Xi′ are an ε-proportion of |Si ((A, b), G)| and not of |G|. In particular, if
|Si ((A, b), G)| = 1, ε < 1, and Xi contains that element, then Xi′ = ∅. This makes the result best possible in
the following sense: if S((A, b), G, X) > δ|S((A, b), G)|, then, in order to delete all the solutions, there should
exist an i with |Xi′ | > |Si ((A, b), G)|δ/m. Therefore, we remove, at most, an ε-proportion of the right order
of magnitude.
• The set of variables xi with Xi = Si (A, G) and for which no element should be removed is arbitrary. The
argument leading to [21, Theorem 1], allows the existence of a set of indices I of full sets from which no element
is removed. However, the argument from [21] imposes an upper bound on the size of I. The argument in
Section 5.9 remove those bounds on I.10
1.2.4

Removal lemma for finite abelian subgroups

As Theorem 2 can be applied to any finite abelian group G and any homomorphism, we can rephrase the result in
terms of subgroups.
Theorem 4 (Removal lemma for subgroups). For every ǫ > 0 and every positive integer m, there exists a δ =
δ(ǫ, m) > 0 such Q
that the following holds. Let G1 , . . . , Gm be finite abelian groups. Let S be a subgroup of G1 × · · · ×
Gm and let s ∈ i∈[m] Gi . Let Xi be a subset of Gi for each i ∈ [1, m]. If | [X1 × · · · × Xm ] ∩ s + S| < δ|S| then
′
′
there exist X1′ , . . . , Xm
, with |Xi′ | < ǫπi (S) for all i ∈ [1, m], such that {[X1 \ X1′ × · · · × Xm \ Xm
] ∩ s + S} = ∅. If
′
πi (s + S) ⊂ Xi , for some i ∈ [1, m] then we can assume Xi = ∅.
Indeed, any subgroup
ofi a finite abelian group is the kernel of a homomorphism (namely the quotient map
hQ
Q
Q
i∈[m] Gi , we could
i∈[m] Gi →
i∈[m] Gi /S, S being our subgroup of interest.) Notice also that, instead of
Q
m
consider our domain to be a supergroup G > i∈[m] Gi , for some suitable finite abelian group G, as S is also
a subgroup of Gm . Moreover, we can assume Gm /S < Gk for some k (take, for instance k = m.) Therefore,
Theorem 2 suffices to show Theorem 4. Since the kernel of a homomorphism generates a subgroup of Gm , Theorem 4 implies Theorem 2. Hence the version of the result for subgroups Theorem 2, and the version for systems of
homomorphisms Theorem 4, are equivalent.

1.2.5

Removal lemma for permutations

In [6], Cooper introduced a regularity lemma and a removal lemma for permutations. Let S(i) denote the set of
bijective maps from [0, i−1] to [0, i−1]. Slightly modifying the notation in [6], let Λτ (σ), for τ ∈ S(m) and σ ∈ S(n),
be the set of occurrences of the pattern τ in σ. That is to say, the set of index sets {x0 < · · · < xm−1 } ⊂ [0, n − 1]
such that σ(xi ) < σ(xj ) if and only if τ (i) < τ (j).
Proposition 5 (Proposition 6 in [6]). Suppose that σ ∈ S(n), τ ∈ S(m). For every ǫ > 0 there exist a δ =
δ(ǫ, m) > 0 such that, if |Λτ (σ)| < δnm , then we may delete at most ǫn2 index pairs to destroy all copies of τ in σ.
In Section 2.3.2 we can find a representation where the valid configurations are given by the set Λτ (σ), and where
we shall delete pairs of indices to destroy them. Hence Proposition 5 follows from Theorem 1.
10 The

argument of Section 5.9 and of Observation 34 could be applied to [21, Theorem 1] to add this extra property.

5

1.3

Applications

Multidimensional Szemerédi. One of the main applications of Theorem 2 is a new proof of the counting version
of the multidimensional Szemerédi’s Theorem for finite abelian groups.
The original proof of the multidimensional Szemerédi theorem for the integers was given by Furstenberg and
Katznelson [12] and uses ergodic theory. Solymosi [33] observed that a removal lemma for hypergraphs would
imply the multidimensional Szemerédi theorem (a detailed construction can be found in [14]). Solymosi’s geometric
argument uses hypergraphs and follows the lines of the argument by Ruzsa and Szemerédi [28] to obtain Roth’s
Theorem [27] from the Triangle Removal Lemma. With the development of the Regularity Method for Hypergraphs
[14, 23, 25, 36] and the corresponding Removal Lemma for Hypergraphs [14, 23, 36], a combinatorial proof of the
multidimensional version of Szemerédi’s Theorem for the integers could be pushed forward [14, 33].
In [37], Tao uses the same construction as Solymosi [33] to show [37, Theorem B.2] and a lifting trick to obtain
a generalized version of the multidimensional Szemerédi theorem for finite abelian groups, [37, Theorem B.1].
Theorem 2 can be used to prove both [37, Theorem B.1] and [37, Theorem B.2].
The argument to deduce [37, Theorem B.2] (Theorem 6 in this paper) from Theorem 2 explicitly shows that the
dependencies in [37, Theorem B.2] and in [37, Theorem B.1] are independent of the dimension of the space and
depend only on the number of points required in the configuration. On the other hand, the relation between δ and
ǫ obtained using Theorem 2 is worse than the direct construction of [37, Theorem B.2] due to the larger uniformity
of the hypergraph used.
Theorem 6 (Multidimensional Szemerédi for finite abelian groups, Theorem B.2 in [37]). Let ε > 0. Let Gm be
a finite abelian group and let S ⊂ Gm be such that |S|/|Gm | ≥ ε. There exists δ = δ(ε, m + 1) > 0 such that
the number of configurations of the type {(x1 , . . . , xm ), (x1 + a, x2 , . . . , xm ), . . . , (x1 , x2 , . . . , xm + a)} ⊂ S, for some
a ∈ G, is at least δ|G|m+1 .
Proof of Theorem 6. Consider the abelian group P = Gm , Xi = S ⊂ P , for i ∈ [1, m + 1]. Let xi = (xi,1 , . . . , xi,m ),
i ∈ [1, m + 1], be the variables of the homomorphism system that can be derived from the following linear equations:

x1,1 − x2,1 = x1,j − xj+1,j for j ∈ [2, m]
(2)
x1,j = xi,j
for all (i, j) ∈ [1, m + 1] × [1, m], i 6= j + 1.
Indeed, x1 is thought of as the centre of the configuration. The first equations state that the difference between
the j-th coordinate of xj+1 and the j-th coordinate of x1 is the same regardless of j; this is achieved by setting all
the differences to be equal to the difference between the first coordinate of x2 and the first coordinate of x1 . The
second set of equations treat the other coordinates, imposing that all the other coordinates of xj+1 , except the j-th,
should be equal to those of x1 . Therefore, (x1 , . . . , xm+1 ) is a solution to the system defined by (2) if and only if
x1 = (y1 , . . . , ym ), x2 = (y1 + a, . . . , ym ), . . . , xm+1 = (y1 , . . . , ym + a) for some y1 , . . . , ym , a ∈ G.
By adding some trivial equations, like 0 = 0, the system induces a homomorphism A : P m+1 → P m , with
S(A, P ) ∼
= Gm+1 . Observe that Si (A, P ) ∼
= Gm as any point in P = Gm can be the i-th element in the configuration.
Consider the δ = δTheorem 2 (m + 1, ε/(m + 1)) coming from Theorem 2 applied with ε/(m + 1) and m + 1. Let us
proceed by contradiction and assume that the number of solutions is less than δS(A, P ) = δ|G|m+1 . Now we apply
′
Theorem 2 and find sets X1′ , . . . , Xm+1
with |Xi′ | < |Gm |ε/(m + 1) such that the sets Xi = S \ Xi′ bear none of the
desired configurations.
Observe that any point x ∈ S ⊂ Gm generates a solution to the linear system as (x, . . . , x) ∈ P m+1 is a valid
configuration with a = 0G . Consider S ′ = S \ (∪Xi′ ). Since |S| > ε|Gm | and |Xi′ | < |Gm |ε/(m + 1), there exists
an element s in S ′ , as S ′ is non-empty. Therefore s ∈ Xi for every i ∈ [1, m + 1]. Thus (s, . . . , s) ∈ P m+1 is a
solution that still exists after removing the sets Xi′ of size at most ε/(m + 1) from S. This contradicts Theorem 2.
Therefore, we conclude that at least δ|G|m+1 solutions exist.
Other linear configurations. More generally, we can show the following corollary of Theorem 2.
Corollary 7. Let G be a finite abelian group, let A be a k × m homomorphism for G and let b ∈ Gk . Assume that
S(A, G) = S((A, b), G) ⊂ Gm contains a set R satisfying the following conditions.
(i) The projection of R onto the i-th coordinate of Gm is Si (A, G). This is, πi (R) = Si (A, G).
6

(ii) For each i ∈ [1, m] and for each pair g1 , g2 ∈ Si (A, G), |πi−1 (g1 ) ∩ R| = |πi−1 (g2 ) ∩ R|.
Then, for every ε > 0 there exists a δ = δ(ε, m) > 0 such that, for any S ⊂ G with |S m ∩ R| > ε|R|, we have
|S(A, G, S m )| ≥ δ |S(A, G)|.
assume that |S(A, G, S m )| <
Proof. We proceed by contradiction. Choose δ = δTheorem 2 (m, ε/(m + 1) and
Qm
′
′
δ |S(A, G)|. Then there are sets Xi , with |Xi | < ε/(m
that S(A, G, i=1
S \ Xi′ ) = ∅. However, by
Qm + 1), such
Qm
m
′
(i) and (ii) we delete at most ǫ m+1 |R| hence R ∩ i=1 S \ Xi 6= ∅, thus S(A, G, i=1 S \ Xi′ ) 6= ∅ reaching a
contradiction.
In particular, if the linear system (A, G) satisfies Si (A, G) = G for all i ∈ [1, m] and (x, . . . , x) ∈ S(A, G) for each
x ∈ G, then Corollary 8 shows that any set S ⊂ G with |S| ≥ ǫ|G|, satisfies that |S(A, G, S m )| > δ|S(A, G)| for
some δ > 0 depending on ǫ and m. That is, any set with positive density will contain a positive proportion of the
solutions. Corollary 7 can be particularized as Corollary 8 which presents a perhaps more directly applicable form.
Corollary 8. Let G be a finite abelian group, let G1 , . . . Gs be subgroups of G. Let Φ1 , . . . , Φt be group homomorphisms
Φi : G1 × · · · × Gs → G
(x1 , . . . , xs ) 7→ Φi (x1 , . . . , xs ).
For every ǫ > 0 there exists a δ = δ(ǫ, t) > 0 such that, for every S ⊂ G with S ≥ ǫ|G|,
(
)
s


Y

t 
Gi | (x + Φ1 (x), . . . , x + Φt (x)) ∈ S  >
 x ∈ G, x ∈


i=1
(
)
s


Y


Gi | (x + Φ1 (x), . . . , x + Φt (x)) ∈ Gt  .
δ  x ∈ G, x ∈


i=1

Qs
Proof. Consider R = {(x, . . . , x)}x∈G . Observe that the configuration set {x ∈ G, x ∈ i=1 Gi | (x + Φ1 (x), . . . , x +
Φt (x)) ∈ Gt } is a subgroup of Gt , whence there exists a homomorphism A such that S(A, G) is the configuration
set and, in this case, Si (A, G) = G = πi (R) for all i. Thus the hypotheses of Corollary 7 are fulfilled and the result
follows.
Corollary 8 encompasses the simplex-like configurations from the multidimensional version of Szemerédi’s theorem
with the evaluation: G = Zkp , G1 = Zp , Φt = 0 and Φ1 , . . . , Φk being the coordinate homomorphisms
Φi : Zp → Ztp
i

z}|{
x 7→ (0, . . . , 0, x , 0, . . . , 0).
Additionally Corollary 8 generalizes [37, Theorem B.1] which asserts that given a finite abelian group G, for every
ǫ > 0 and t, m positive integers, there are, in any set S ⊂ Gm with |S| > ǫ|G|m , δ(ǫ, t, m)|G|m+1 configurations
m

{y ∈ Gm , x ∈ G | (y + Φ1 (x), . . . , y + Φ(2t+1)m (x)) ∈ S (2t+1) }
with
Φi (x) = (χ1 (i)x, . . . , χm (i)x)
where (χ1 (i), . . . , χm (i)) are the components of i in base 2t + 1 shifted by −t so their values lie in [−t, t] instead of
the usual [0, 2t]. An example of an extra configuration that Corollary 8 covers are the “rectangles” (x, x + x1 , x +
n−log(n)
x2√, x + x1 + x2 ) ∈ S 4 , for S ⊂ G = Zn3 , with x1 ∈ G1 and x2 ∈ G2 two subgroups of G, isomorphic to Z3
and
n
Z3 respectively, and such that G1 + G2 = G.
The arguments to show Corollary 8, Corollary 7, or Theorem 6 exemplify that Theorem 2 presents a comprehensive
approach to the asymptotic counting of homothetic-to-a-point structures found in dense sets of products of finite
7

abelian groups. More precisely, the constants involved in the lower bound of the number of configurations depend
only on the number of points of the configuration and on the density of the set, but not on the configuration itself
nor on the structure of the finite abelian group.
If we ask for configurations in the integers, the constant does depend on the configuration as we are not interested
in solutions that occur due to the cyclic nature of the components of the finite abelian group. Therefore, we should
reduce the density of the sets to allow only the desired solutions. This affects the total number of configurations
found in the finite abelian group.
Monochromatic solutions. Theorem 2 also allows us to extend the results in [29] regarding a counting statement
for the monochromatic solutions of bounded torsion groups. In particular, weensure that there are Ω (|S(A, G)|)
monochromatic solutions, thus improving the asymptotic behaviour Ω |G|m−k stated in [29]. Here S(A, G) represents the solution set of Ax = 0, x ∈ Gm , when A is a k × m full rank integer matrix and the asymptotic behaviour
depends on the number of colours.
Hypergraph containers. Using the hypergraph containers tools from [30], Theorem 2 can be used to extend
[30, Theorem 10.3] or [31, Theorem 2.10], regarding the number of subsets free of solutions of a given system of
equations, and show for instance Theorem 9, where homomorphism systems are considered. Following the notation
in [30], a homomorphism system A is said to be full rank if there exists a solution to Ax = b for any b ∈ Gk .
A full rank k × m homomorphism system A (or with coefficients over a finite field) is said to be abundant if any
k × m − 2 subsystem of A formed using m − 2 columns of homomorphisms also has full rank. Given a set Z ⊂ Gm of
discounted solutions and b ∈ Gk , a set X ⊂ G is said to be Z-solution-free if there is no x ∈ X m − Z with Ax = b.
Let ex(A, b, G) denote the size of the maximum Z-solution-free set.
Theorem 9 (Saxton, Thomason, Theorem 10.3/2.10 in [30]/[31] with Theorem 2). Let {Gi }i∈I be a sequence of
finite abelian groups. Let Ai be a sequence of abundant k × m homomorphism systems and bi ∈ Gki a sequence
of independent vectors such that |S((Ai , bi ), Gi )| = |Gi |m−k . Let Z be such that Z ⊂ S((Ai , bi ), Gi ) and |Z| =
o(|Gi |m−k ). Then the number of Z-solution-free subsets of Gi is 2ex(Ai ,bi ,Gi )+o(|Gi |) .

1.4

Outline of the paper

The main results of the paper are Theorem 1 and Theorem 2. To prove Theorem 1, we observe that the notion of
representation, Definition 10, is sufficient to transfer the hypergraph removal lemma, Theorem 11 in this paper, to
the representable setting. The argument can be found in Section 2. Some examples of representable systems and
their correspondent removal lemmas are presented.
In Section 3 we introduce the notion of µ-equivalent linear systems (see Section 3.1). In Section 3.2, we show some
relations between the representability of the systems (A1 , G1 ) and (A2 , G2 ) whenever (A2 , G2 ) is µ-equivalent to
(A1 , G1 ). These results are used in the proof of Theorem 2. Indeed, the strategy of the proof can be summarized
as finding a suitable sequence of µ-equivalent systems, from the system of our interest, to a representable one. As
Section 3.2 shows, we can then find a representation for our original system.
In Section 4 and Section 5 we prove Theorem 2 by arguing that the systems involved in the statement of the theorem
are representable. Section 6 is devoted to show the cases where m ≤ k + 1 and to prove the second part of the
result involving the sets Xi for which Xi ⊃ πi (S(A, G)).
Qt
The sketch of the construction for the representation is as follows. Given G = i=1 Zni with n = n1 and ni |nj for
i ≥ j, we interpret the homomorphism A : Gm → Gt as a homomorphism A′ from (Ztn )m to (Ztn )k in a natural way.
Then any solution of S(A, G) is related to |S(A′ , Ztn )|/|S(A, G)| solutions of S(A′ , Ztn ). This reduction process is
detailed in Section 4.
tk
As Section 5.1 shows, the homomorphism matrix A′ can be thought of as an integer matrix from Ztm
n to Zn with
tm variables and tk equations in Zn . This interpretation as an integer matrix allows for the construction of the
representation by using the ideas in the proof of [21, Lemma 4]. The construction is detailed in Section 5 and
involves several transformations to the pair (A′ , G′ ) to address the different issues like the determinantal being
larger than 1. The main characteristics of those transformations are described in the statements of Section 3.2.
The Γ-representability with γj (i) > 1 involves the generation of several systems. The construction of such systems

8

is detailed in Section 5.5 and they are combined in Section 5.8 to create a single 1-strongly-representable system.11
A summary of all the transformations can be found in a table in Section 5.10.

2

Representable systems

In this work [a, b] stands for the integers between a and b, both included. If x ∈ Gm , then (x)i denotes the i-th
component of x. Let us recall some notions regarding hypergraphs. Given a hypergraph K = (V, E), V = V (K)
denotes the vertex set, E = E(K) denotes the edge set and |K| = |V (K)| denotes the size of the vertex set. A
hypergraph K with vertex set V = V (K) and edge set E = E(K) is said to be s-uniform if each edge in E contains
precisely s vertices. Throughout this paper, we consider hypergraphs with edges coloured by integers. A hypergraph
K is said to be m-coloured if each edge in K bears a colour in [1, m]. If K is an m-coloured hypergraph, Ei (K)
denotes the set of edges coloured i ∈ [1, m] in K. By a copy of H in K we understand an injective homomorphism
of colored hypergraphs of H into K respecting the colors of the edges (the map is from vertices to vertices, injective,
and maps edges colored i to edges with color i). We use C(H, K) to denote the set of colored copies of H in K. If
H has m edges {e1 , . . . , em } with ei colored i then H can be identified with (e1 , . . . , em ).

2.1

Representability

The definition of a representable system, Definition 10, is a generalized notion of the one formalized in [32] that
suffices to obtain a removal lemma; in our case Theorem 1. These representability notions have been used in several
works like [3, 19, 20, 22, 21, 32, 34] to translate the conclusion of the removal lemma for graphs or hypergraphs to
linear systems of equations. The representable system notion could potentially be used in more general contexts
than the homomorphism systems described in this work.
Recall that a system (A, G) is a pair given by a finite set G and a property A : Gm → {0, 1}. S(A, G) denotes
the preimage of 1 by A. γ denotes a tuple of m positive real numbers (γ1 , . . . , γm ). (A, G, m) denotes a family of
systems and Γ a collection of γ’s, one for each system.
Definition 10 ((strongly) representable system). The family of finite systems (A, G, m) is said to be Γ-representable
if there are positive real numbers χ1 , χ2 , depending on the family (A, G, m), and for each (A, G) ∈ (A, G, m) and the
γ = (γ1 , . . . , γm ) ∈ Γ associated with (A, G), there exists a pair of coloured hypergraphs (K, H) with the following
properties RP1, RP2 and RP3.
• K and H are s-uniform m-colored hypergraphs.

RP1

• H has m different edges {e1 , . . . , em } and the edge ei is coloured i. Moreover χ1 ≥ |V (H)| = h > s ≥ 2.
• Each edge in K bears a label in G given by l : E(K) → G.
RP2 There exist a positive integer p, a set Q, and a surjective map r
r : C(H, K) −→ S(A, G) × Q
H = {e1 , . . . , em } 7−→ (r0 (H), rq (H))
such that r0 (H) = (l(e1 ), . . . , l(em )), and, for any given x ∈ S(A, G) and q ∈ Q, the set r−1 (x, q) has size
|r−1 (x, q)| = pλ

m
Y

γi with λ = c

i=1

|K|s
|G|

for some c ≥ χ2 .
RP3 If ei is an edge coloured i in a copy H ∈ r−1 (x, q), then p

Qm

j=1

γi

γj

copies of H in r−1 (x, q) contain ei .

If, additionally,
RP4 For any edge ei coloured i and l(ei ) = xi , there exists a copy of H ∈ r−1 (x, q), with (x)i = xi , containing ei ,
11 See

Definition 10 for the additional conditions of the strong-representability.

9

then the family is said to be strongly Γ-representable.
If H ∈ r−1 (x, q) we say that H is related to x through q. If a system (A, G) belongs to a Γ-representable family
of systems and has γ as its associated parameters then (A, G) is said to be γ-representable. If γ1 = · · · = γm = 1
we say that the system is 1-representable. The vector (K, H, γ, l, r, Q, p, c) defines the γ-representation and the key
parameters are χ1 and χ2 .
Comments on Definition 10. In the definition, the hypergraphs H and K could have also been asked to be
directed.
By choosing Q = {1}, p = 1 and γ1 = · · · = γm = 1 for all the systems (A, G), Definition 10 covers the representation
notions in [20, 21, 22, 32]. The main purpose of the introduction of the set Q is to accommodate the determinantal
condition from [21, Theorem 1]. The different p and γ allow for removing different proportions for different sets
Si (A, G), the projections of the solution set to the coordinates of Gm .
Asking for the bounds on s, h and c to depend on m and on the family of systems as a whole is one of the key
points in the representability notion. The existence of r in RP2 and the definition of r0 (q), imply that the labels of
the edges of each copy of H in K, ordered by colours, form a solution of the system (A, G).
For each solution x = (x1 , . . . , xm ) ∈ S(A, G), the set Q equipartitions the copies of H in K related to x. The
conditions RP2 and RP3 guarantee, for each x, q and i ∈ [1, m], the existence of a set of i-colored edges with size
|Ei (x, q)| = λγi = c

|K|s
γi ,
|G|

where
c is lower bounded by a function of m such that the following holds. For each edge e ∈ Ei (x, q), there are
Q
m

γj

copies of H in K related to (x, q) containing e. p is independent on x, i, q or e. By the existence of r in
p j=1
γi
RP2, any copy of H in K related to x through q intersects Ei (x, q) for all i ∈ [1, m].
If the system is strongly representable, then Ei (x, q) is the set of edges labelled with (x)i .

In Definition 10, we could have made the constants c to depend on the pair (x, q) as long as cx,q ≥ χ2 for any
(x, q) ∈ S(A, G) × Q. The proof of Theorem 1 in Section 2.2 can be adapted to this case by using the bound χ2
instead of c.
If the system is γ-strongly-representable, then the new set Q can be considered to be {1} at the expense of increasing
the value of p to p|Q|. Indeed, for any q, the set of hypergraphs
H in K related to (x, q) contains all the edges
Q
labelled (x)i . Therefore any edge labelled (x)i contains p

2.2

m
j=1

γi

γj

|Q| copies of H related to x in ∪q∈Q r−1 (x, q).

Representable systems and the removal lemma

The proof of the removal lemma for representable systems, Theorem 1, uses the coloured version of the hypergraph
removal lemma, Theorem 11 in this work. Theorem 11 can be deduced from Austin and Tao’s [2, Theorem 1.5].
Alternatively, the coloured version of the hypergraph removal lemma can be proved using the arguments that lead
to the colourless version of the hypergraph removal lemma [7, 14, 26, 36], or it can be found in Ishigami’s [16].
Theorem 11 (Removal lemma for colored hypergraphs [2]). For any positive integers r, h, s with h ≥ s ≥ 2 and
every ε > 0 there exists δ > 0 depending on r, h, s and ε such that the following holds.
Let H and K be r-colored s-uniform hypergraphs with h = |V (H)| and M = |V (K)| vertices respectively. If the
number of copies of H in K (preserving the colors of the edges) is at most δM h , then there is a set E ′ ⊆ E(K) of
size at most εM s such that the hypergraph K ′ with edge set E(K) \ E ′ is H–free.
Proof of Theorem 1. Let (K, H) be the hypergraph pair that γ-represents the system (A, G), with γ = (γ1 , . . . , γm ).
Let us denote the labelling by l : E(K) → G and the representation function by r : C(H, K) → S(A, G) × Q. The
components of r are given by r0 : C(H, K) → S(A, G) and rq : C(H, K) → Q. Recall that, by Definition 10, if
H0 = {e1 , . . . , em } is a copy of H in K, then r0 (H) = (l(e1 ), . . . , l(em )). Let KX be the subhypergraph of K with
the same vertex set as K and the edges belonging to r0−1 (S(A, G, X)). In other words, KX ⊂ K is the hypergraph
containing only the edges whose labels belong to the restricted solution set.
10

By the property RP2 of the γ-representability of the system, the total number of copies of H in K is, for the c and
p provided by the representation, at most
c

m
Y
|K|s
γi .
p|Q||S(A, G)|
|G|
i=1

s

Let λ = c |K|
|G| . Since H has h vertices, it follows that
λp|Q||S(A, G)|

m
Y

γi < |K|h .

i=1

On the other hand, the hypothesis |S(A, G, X)| < δ|S(A, G)|, δ to be determined later, implies that the total
number of copies of H in KX is at most
λp|Q||S(A, G, X)|

m
Y

γi < δλp|Q||S(A, G)|

m
Y

γi < δ|K|h .

i=1

i=1

We apply the Removal Lemma for colored hypergraphs, Theorem 11, with ε′ = cε/m. By setting δ according to ε′
and H in Theorem 11, we obtain a set of edges E ′ ⊂ E(KX ) with cardinality at most ε′ |K|s such that KX \ E ′
has no copy of H. We note that δ depends on s, h, m and ε′ , which in our context and by the representability, all
depend on m and ε.
We next define the sets Xi′ ⊂ Xi as follows. The element x is in Xi′ (x is removed from Xi ) if E ′ contains at least
λγi /m edges labelled x and colored i. We observe that
|Xi′ | ≤

|G|
m|G| ′ 1
|E ′ |
|E | ≤ ε
.
=
(λγi /m)
c|K|s
γi
γi

Qm
′
We claim that S(A, G, X \ X ′ ), with X \ X ′ =
Indeed, pick one element x = (x1 , . . . , xm ) ∈
Qm i=1 Xi \ Xi , is empty.
S(A, G, X) and q ∈ Q. By RP2 there are pλ i=1 γi copies of H in r−1 (x, q). Since x ∈ S(A, G, X), all
Q these copies
belong to KX . On the other hand, by RP3, every edge of K coloured i is contained in at most p j∈[1,m]\{i} γj
′
denote the set of edges in E ′ labelled with xi and colored i. Then
copies of H in r−1 (x, q). Let Ei,x
i


m
Y
Y
X
′
|Ei,x
γj
γj  ≥ pλ
|p
i
i=1

j∈[1,m]\{i}

j∈[1,m]

′

as there are no copies related to (x, q) after E has been removed. By the pigeonhole principle, at least one of
′
′
| > λγi /m. By the definition of Xi′ , the element xi belongs to Xi′ and thus
is such that |Ei,x
the sets Ei,x
i
i
′
′
x 6∈ X \ X ⊃ S(A, G, X \ X ). This proves the claim and finishes the proof of the result.

2.3
2.3.1

Examples of representable systems and removal lemmas
Subhypergraph copies

As expected, the coloured hypergraph removal lemma can be retrieved from Theorem 11. The system of configurations induced by “the copies of an r-coloured k-uniform hypergraph H0 in an r-coloured k-uniform hypergraph
K0 ” can be represented by Definition 10 as follows. Order the edges of H arbitrarily. H = H0 and K = K0 as the
pair of hypergraphs that represents the system. The property A is the map from E(K)|E(H)| to {0, 1} such that
A(e1 , . . . , e|E(H)| ) = 1 if and only if the edges (e1 , . . . , e|E(H)| ) conform a copy of H in K in which ei is the i-th
edge of H with the chosen order. The map l is given by the identity map of the edge in K, r0 is the identity map
induced by the property A, Q = {1}, λ = c = γi = 1. The sets Xi in the removal lemma Theorem 1 are the edges
in K0 coloured using the colour of the i-th edge in H.
2.3.2

Permutations

The copies of τ ∈ S(t) in σ ∈ S(n), as defined by the set Λτ (σ) in Section 1.2.5, can be
 represented using directed
and coloured graphs H and K in Definition 10 as follows. Given a finite set V , let Vi denote the set of subsets of
11

|([0,t−1]
)|
2
i different elements of V . Let A be the property A : [0,n−1]
→ {0, 1} such that A(e1 , . . . , et(t−1)/2 ) = 1 if
2
and only if the collection of endpoints of the edges {e1 , . . . , et(t−1)/2 } configure an m-element set {x0 < · · · < xt−1 }
in [0, n − 1] belonging to Λτ (σ).
Given a permutation σ ∈ S(n), let us define the loopless bicolored directed graph Gσ as follows. The vertex set
V (Gσ ) is given by the n-element set [0, n − 1]. The directed edge e = (i, j) or e = {i → j}, from i to j, belongs to
E(Gσ ) if and onlyif σ(i) < σ(j). The edge e = {i → j} is painted blue if i < j and painted red if i > j. Observe
that |E(Gσ )| = n2 .
We claim that the system for the permutations involved in Proposition 5 is representable with A as above, H = Gτ ,
K = Gσ , m = 2t , Q = {1}, γi = c = λ = 1 and r0 given as follows. If {x0 < . . . < xt−1 } ⊂ [0, n − 1] = V (K) is a
set of indices that generates a copy of H in K, then r0 ({x0 < . . . < xt−1 }) = {x0 < . . . < xt−1 }.

Claim 1. If H0 , with V (H0 ) = {x0 < · · · < xt−1 }, is a copy of Gτ = ([0, t − 1], E(Gτ )) in Gσ , then the only map
(homomorphism) from f : V (Gτ ) → V (H0 ) with the property “if e = {i → j} ∈ E(Gτ ) and is coloured c, then
{f (i) → f (j)} ∈ E(Gσ |V (H0 )) and is coloured c” is the map f (i) = xi for all i ∈ [0, t − 1].
Proof. The map f must be bijective. Indeed, since Gτ is a complete graph if f were not bijective, then the graph
induced by V (H0 ) would contain a loop as f is a homomorphism, but Gσ is loopless.
If f is not the map f (i) = xi , then there exist a pair i, j ∈ [1, t − 1] with i < j but f (i) > f (j). If the edge between
i and j is e = {i → j}, then f (e) = {f (i) → f (j)}. In such case, e is painted blue as i < j and f (e) is painted red
as f (i) > f (j), hence f is not an homomorphism. If the edge between i and j is e′ = {j → i}, then e is coloured
red but f (e′ ) is blue. Therefore, if f is a homomorphism, it has to be the isomorphism with f (i) = xi .
Claim 2. If H0 , with V (H0 ) = {x0 < · · · < xt−1 } is a copy of Gτ in Gσ where xi ∈ V (Gσ ) corresponds to the i-th
vertex of Gτ , then {x0 < · · · < xm−1 } ∈ Λτ (σ).
Proof. Let e = {xi → xj } be an edge in Gσ , then σ(xi ) < σ(xj ). Since H0 is a copy of Gτ where xi corresponds
to the i-th vertex of Gτ , e′ = {i → j} is an edge in Gτ meaning that τ (i) < τ (j) as wanted. Since the reverse
implication also holds, the result is shown.
Claim 3. If {x0 < · · · < xt−1 } ∈ Λτ (σ) then the graph induced by x0 , x1 , . . . , xt−1 in Gσ is a copy of Gτ with the
map from V (Gτ ) = [0, t − 1] to {x0 , x1 , . . . , xt−1 } ⊂ V (Gσ ) given by i 7→ xi for i ∈ [0, t − 1].

Proof. Assume the pair {i, j} ∈ [0,t−1]
, with i < j, is such that σ(xi ) < σ(xj ). By the construction of Gσ we have
2
the edge {xi → xj } and is painted blue (as xi < xj ). Since {x0 < · · · < xt−1 } ∈ Λτ (σ), then τ (i) < τ (j). Hence Gτ
has the edge {i → j} coloured blue (as i < j).

Assume now that the pair {i, j} ∈ [0,t−1]
, with i < j, is such that σ(xi ) > σ(xj ). Gσ contains the edge {xj → xi }
2
painted red (as xj > xi ). On the other side we have τ (i) > τ (j) as {x0 < · · · < xt−1 } ∈ Λτ (σ). Hence Gτ has the
edge {j → i} coloured red (as j > i).
Therefore, the map i 7→ xi , for i ∈ [0, t − 1], is a graph homomorphism preserving the colours and the directions of
the edges as claimed.
Combining claims 1-3, we observe that r0 is well defined and the representation of Λτ (σ) is given by the pair

(Gτ , Gσ ) with the parameters described above. Proposition 5 is shown by using Theorem 1 with Xi = [0,n−1]
2
for all i ∈ [t(t − 1)/2]. In this case the proof of Theorem 1 should use, instead of Theorem 11, a removal lemma
for directed and coloured graphs that can by obtained by combining the arguments from [1, Lemma 4.1] with [18,
Theorem 1.18].12

3

Equivalent systems and representability

In this section we assume that the systems are defined by a homomorphism. The definition for µ-equivalent systems
is introduced in Section 3.1 and in Section 3.2 the relations between µ-equivalent systems and their representations
are explored.
12 For

a detailed argument of how to obtain a removal lemma for directed and coloured graphs, the reader may refer to [41].

12

3.1

Equivalent systems

1
→ Gk22 is said to be µ-equivalent
Let µ be a positive integer. The homomorphism system (A2 , G2 ) with A2 : Gm
2
m1
k2
to the homomorphism system (A1 , G1 ), A1 : G1 → G1 , with m2 ≥ m1 , if

• µ|S(A1 , G1 )| = |S(A2 , G2 )|.
• There exist an injective map σ : [1, m1 ] → [1, m2 ] and affine homomorphisms φ1 , . . . , φm1 , φi : G2 → G1 such
that the map

φ(x1 , . . . , xm2 ) = φ1 (xσ(1) ), . . . , φm1 (xσ(m1 ) )
induces a µ-to-1 surjective map φ : S(A2 , G2 ) → S(A1 , G1 ).

An affine homomorphism is a map φi : G2 → G1 with φi (x) = b + φ′i (x), where φ′i is a homomorphism and b is a
fixed element in G1 . Observe that, if necessary, we can restrict φi to map from the subgroup Si (A2 , G2 ) (or a coset
of the subgroup Si ((A2 , 0), G2 )) to Si (A1 , G1 ). If G1 = G2 and the {φi }i∈[1,m1 ] are affine automorphisms, then
φi (Si (A2 , G2 )) = Si (A1 , G1 ) and their sizes are the same. In this case the systems are said to be auto-equivalent.

3.2

Operations on equivalent systems and representability

The propositions 12 through 15 proved in this section expose how the property of equivalence between systems, as
defined in Section 3.1, is related with their representability properties, Definition 10. For this section G, G1 and
G2 are finite abelian groups and the systems are homomorphism systems.

3.3

1-auto-equivalent systems

Proposition 12 (1-auto-equivalent systems). Let ((A2 , b2 ), G) be a k2 ×m2 system 1-auto-equivalent to ((A1 , b1 ), G),
a k1 × m1 system. Assume ((A2 , b2 ), G) is γ ′ -representable by (K ′ , H ′ ) with constants χ1 , χ2 . If the edges coloured
by σ(1), . . . , σ(m1 ) cover all the vertices of H ′ , then (A1 , G) is γ-representable with the same constants χ1 , χ2 and
′
γi = γσ(i)
. If ((A2 , b2 ), G) is strongly representable, then so is ((A1 , b1 ), G).
Proof of Proposition 12. Let φ be the map that defines the 1-auto-equivalence φ : S(A2 , G) → S(A1 , G) with
φ(x1 , . . . , xm2 ) = φ1 (xσ(1) ), . . . , φm1 (xσ(m1 ) ) . Let (K ′ , H ′ , γ ′ , l′ , r′ , Q′ , p′ , c′ ) be the vector defining the γ ′ -representation
for (A2 , G). Let s be the uniformity of the edges of H ′ .
′
The vector (K, H, γ, l, r, Q′, p′ , c′ ) defines the γ-representation of ((A1 , b1 ), G) as follows. γi = γσ(i)
for i ∈ [1, m1 ].
H and K are the hypergraph on the same vertex set of H ′ and K ′ respectively, and with the edges given by the
colours σ(1), . . . , σ(m1 ). Repaint the edge coloured σ(i) with colour i. If e = {v1 , . . . , vs } is an edge coloured σ(i)
in K ′ and labelled l′ (e), then e is an edge coloured i in K and labelled l(e) = φi (l′ (e)). rq (H0 ) = rq′ (H0′ ) where H0′
is the unique copy of H ′ in K ′ spanned by the vertices of H0 seen as vertices of K ′ .

Each copy of H in K induces a unique copy of H ′ in K ′ and vice-versa. Moreover, φ is a bijection between the solution
sets and (K ′ , H ′ , γ ′ , l′ , r′ , Q′ , p′ , c′ ) is a γ ′ -representation for ((A2 , b2 ), G). Therefore, (K, H, γ, l, r, Q, p, c) as defined
above induces a γ-representation for ((A1 , b1 , G) and have the same constants χ1 and χ2 as (K ′ , H ′ , γ ′ , l′ , r, Q′ , p′ , c′ ).
Since φi are affine automorphisms, if the representation for ((A2 , b2 ), G) is strong, the so is the representation for
((A1 , b1 , G) here presented.

3.4

µ-auto-equivalent systems

Proposition 13 (µ-auto-equivalent systems). Let ((A2 , b2 ), G) be a k2 ×m2 system µ-auto-equivalent to the k1 ×m1
system ((A1 , b1 ), G), m2 ≥ m1 . Let
φ : S((A2 , b2 ), G) −→ S((A1 , b1 ), G)
(x1 , . . . , xm2 ) 7−→ (x1 , . . . , xm1 )

13

′
)-representable by (K ′ , H ′ ) with
be the map that defines the µ-auto-equivalence. Assume ((A2 , b2 ), G) is (γ1′ , . . . , γm
2
′
′
)constants χ1 , χ2 . If the edges coloured by 1, . . . , m1 cover all the vertices of H , then ((A1 , b1 ), G) is (γ1′ , . . . , γm
1
representable with χ1 , χ2 as constants. If ((A2 , b2 ), G) is strongly representable, then so is ((A1 , b1 ), G).

Proof of Proposition 13. Let ι be a map from S((A2 , b2 ), G) to [1, µ] where, given x1 , x2 ∈ S((A2 , b2 ), G) such that
φ(x1 ) = φ(x2 ) and x1 6= x2 , then ι(x1 ) 6= ι(x2 ). If φ is a µ-to-1 map, such ι exist, is exhaustive and induces an
equipartition in S((A2 , b2 ), G).
Let (K ′ , H ′ , γ ′ , l′ , r′ , Q′ , p′ , c′ ) be the vector defining the γ ′ -representation for ((A2 , b2 ), G). Let s be the uniformity
of the edges of H ′ . The candidate vector (K, H, γ, l, r, Q, p, c) is defined as follows.
• Q = Q′ × [1, µ], p = p′

Q m2

i=m1 +1

γi′ , c = c′ , γ is such that γi = γi′ for i ∈ [1, m1 ].

• H and K are the hypergraphs on the vertex sets of H ′ and K ′ respectively. e = {v1 , . . . , vs } is an edge in K
coloured i ∈ [1, m1 ] if and only e is an edge coloured i ∈ [1, m1 ] in K ′ .
• l is defined by l(e) = l′ (e) for e an edge coloured i ∈ [1, m1 ].
• If H0 ∈ C(H, K), then rq (H0 ) = (rq′ (H0′ ), ι(r0′ (H0′ ))) where H0′ is the unique copy of H ′ in K ′ spanned by the
vertices of H0 , seen as vertices of K ′ .
Selecting x ∈ S((A1 , b1 ), G) and q = (q ′ , j) ∈ Q = Q′ × [1, µ] is equivalent to select the y ∈ S((A2 , b2 ), G), with
y ∈ φ−1 (x) such that ι(y) = j, and q ′ ∈ Q′ , first coordinate of q. Moreover, each copy of H in K induces a unique
copy of H ′ in K ′ and vice-versa. Therefore, the class of copies of H related to (x, q) is the same as the copies of H ′
related to (y, q ′ ).
Since each edge ei ∈ E(K ′ ), i ∈ [1, m1 ], is contained in p′
Q m1

Q m2

Q m2

j=1
γi′

γj′

copies of H ′ related to (y, q ′ ), then it also contains,

′
j=1 γj

′
j=1 γj
γi′

= p γi
copies of H related to (x, q). Therefore, (K, H, γ, l, r, Q, p, c) as defined
seen as an edge in K, p′
above induces a γ-representation for (A1 , G) and have the same constants χ1 and χ2 as (K ′ , H ′ , γ ′ , l′ , r′ , Q′ , p′ , c′ ).
Moreover, since φi is the identity map for each i, if the representation for ((A2 , b2 ), G) is strong, then so is the
presented representation for ((A1 , b1 ), G).

3.5

µ-equivalent systems

Proposition 14 (µ-equivalent systems 1). Let ((A2 , b2 ), G2 ) be a k2 × m1 system µ-equivalent to the k1 × m1
system ((A1 , b1 ), G1 ) with
φ : S((A2 , b2 ), G2 ) −→ S((A1 , b1 ), G1 )
(x1 , . . . , xm1 ) 7−→ (φ1 (x1 ), . . . , φ1 (xm1 ))
′
′
be the map that defines the µ-equivalence. Assume (A
Q2m,1G2 )−1is (γ1 , . . . , γm1 )-representable by (K , H ) with constants
χ1 , χ2 . If φ1 : G2 → G1 is surjective and φ−1 (x) = i=1
φ1 ((x)i ) then ((A1 , b1 ), G1 ) is (γ1 , . . . , γm1 )-representable
with the same constants χ1 , χ2 . If ((A2 , b2 ), G) is strongly representable, then so is ((A1 , b1 ), G).

Proof of Proposition 14. Observe that, for i ∈ [1, m1 ], φ1 (Si ((A2 , b2 ), G2 )) = Si ((A1 , b1 ), G1 ) as φ is surjective.
Since φ1 is affine, |{yi ∈ Si ((A2 , b2 ), G2 ) : φ1 (yi ) = xi }| is the same for each xi ∈ Si ((A1 , b1 ), G1 ). Since φ−1 (x) =
Q
m1 −1
i=1 φ1 ((x)i ) and φ1 is affine, then we can let β = |Si ((A2 , b2 ), G2 )|/|Si ((A1 , b1 ), G1 )|, as its value is independent
of i ∈ [1, m1 ]. Therefore, µ = β m1 . Additionally, since φ1 is surjective, β = |G2 |/|G1 |.
Let ι be a map from G2 to Zβ such that, if y1 , y2 ∈ G2 with φ1 (y1 ) = φ1 (y2 ) and y1 6= y2 , then ι(y1 ) 6= ι(y2 ). Since
φ1 is a β-to-1 map between G2 and φ1 (G2 ) = G1 , then such ι exist, is exhaustive and induces an equipartition of
G2 in β classes. Moreover, ι induces the bijections
G2
y

1
S((A2 , b2 ), G2 ) −→ S((A1 , b1 ), G1 ) × Zm
−→ φ1 (G2 ) × Zβ
β
and
7−→ (φ1 (y), ι(y))
y
7−→ (φ(y), ι(y))

m1
1
where ι((y1 , . . . , ym1 )) = (ι(y1 ), . . . , ι(ym1 )). Let π : Zm
β → Zβ /h1, . . . , 1i be the quotient map.

Let (K ′ , H ′ , γ ′ , l′ , r′ , Q′ , p′ , c′ ) be the vector defining the γ ′ -representation for ((A2 , b2 ), G2 ). Let s be the uniformity
of the edges of H ′ . The candidate vector (K, H, γ, l, r, Q, p, c) is defined as follows.
14

h
i
1
• Q = Q′ × Zm
/h1,
.
.
.
,
1i
, p = p′ , c = c′ , γi = γi′ for i ∈ [1, m1 ].
β

• H and K are the hypergraphs on the same vertex sets and edge sets as H ′ and K ′ respectively. e = {v1 , . . . , vs }
is an edge in K coloured i ∈ [1, m1 ] if and only e is an edge coloured i ∈ [1, m1 ] in K ′ .
• l(e) = φ1 (l′ (e)) if e is an edge coloured i ∈ [1, m1 ] as an edge in K ′ .
• Given H0 ∈ C(H, K), let H0′ be the unique copy of H ′ in K ′ spanned by the vertices of H0 and let y =
(y1 , . . . , ym1 ) = r0′ (H0′ ) ∈ S((A2 , b2 ), G2 ) the solution spanned by H0′ . Then rq (H0 ) = (rq′ (H0′ ), π(ι(y))).

Property RP1 is fulfilled with the same parameters and each edge bears a label given by l. The function r = (r0 , rq )
goes from C(H, K) to S((A1 , b1 ), G1 ) × Q by the definition of r′ = (r0′ , rq′ ), ι, φ1 and π. r is surjective because r′
−1
1
is surjective and S((A2 , b2 ), G2 ) is in bijection with S((A1 , b1 ), G1 ) × Zm
(x, q) is the union of
β . Observe that r
′−1
′
′
those r (y, q ), with y ∈ S((A2 , b2 ), G2 ), such that φ(y) = x and q = (q , π(ι(y))). This union has β elements, as
1
this is the size of each class in the quotient Zm
β /h(1, . . . , 1)i. Therefore,

which shows RP2.

m1
m
′ s Y
 −1



|K|s Y1
r (y, q) = β r′−1 (x, q ′ ) = βp′ c′ |K |
γi′ = pc
γi ,
|G2 | i=1
|G1 | i=1

All the solutions (y1 , . . . , ym ) = y ∈ S((A2 , b2 ), G2 ) that conform the union just mentioned have the property that
any component yi takes all the possible β values of φ1−1 ((x)i ). Indeed, from all the solutions (y1 , . . . , ym ) = y that,
along with the q ′ , conform the sets of copies of H given by r−1 (x, q), there is only one solution y with yi having
a particular value in φ−1
e ∈ H0 ∈Qr−1 (x, q), then they
1 ((x)i ). Therefore, if two copies of H in K share an edge
Q i
belong to the same set r′−1 (y, q ′ ) if seen as copies of H ′ in K ′ . Thus, there are p′
K sharing ei . This shows RP3.

m
j=1
γi′

γj′

=p

m
j=1

γi

γj

copies of H in

Let x ∈ S((A1 , b1 ), G1 ) and q = (q ′ , j) ∈ Q. Pick ei with l(ei ) = (x)i for some i ∈ [1, m1 ]. Let yi = l′ (ei ) by seen ei
as an edge in K ′ . Let y be the unique solution to S((A2 , b2 ), G2 ) such that φ(y) = x, (y)i = yi , and π(ι(y)) = j. If
((A2 , b2 ), G2 ) is strongly representable, there exists a H0′ , H0′ ∈ r′−1 (y, q ′ ), with ei ∈ H0′ . If H0 is the unique copy
of H in K on the vertices of H0′ , then ei ∈ H0 and H0 ∈ r−1 (x, q). This shows RP4 for the system ((A1 , b1 ), G1 )
when ((A2 , b2 ), G2 ) is strongly representable and finishes the proof of the proposition.
Proposition 15 (µ-equivalent systems 2). Let ((A2 , b2 ), G2 ) be a k2 × m2 system µ-equivalent to the k1 × m1
system ((A1 , b1 ), G1 ) with m2 ≥ m1 . Let
φ : S((A2 , b2 ), G2 ) −→ S((A1 , b1 ), G1 )
(x1 , . . . , xm2 ) 7−→ (φ1 (x1 ), . . . , φm1 (xm1 ))
be the map that defines the µ-equivalence. Assume ((A2 , b2 ), G2 ) is γ ′ -strongly-representable by (K ′ , H ′ ) with
constants χ1 , χ2 . Assume the following.
(i) The edges coloured by [1, m1 ] cover all the vertices of H ′ .
(ii) Given x ∈ S((A1 , b1 ), G1 ) and i ∈ [1, m1 ], then
|{y ∈ S((A2 , b2 ), G2 ) : φ(y) = x and (y)i = yi }|
is constant for any yi ∈ Si ((A2 , b2 ), G2 ) with φi (yi ) = (x)i .
i ((A2 ,b2 ),G2 )| |G1 |
Then ((A1 , b1 ), G) is strongly γ-representable with γi = γi′ |S
|Si ((A1 ,b1 ),G1 )| |G2 | for i ∈ [1, m1 ] and the same constants
χ1 , χ2 .

The condition (ii) is not superfluous. If A2 = (1, 1), A1 = (1, 2), b1 = b2 = 0, G1 = G2 = Z2 and φ(x1 , x2 ) =
(2x1 , x2 ), then φ is one to one but φ1 does not satisfy (ii) for the solution (0, 0) ∈ S(A1 , G1 ). However, the number
of solutions y ∈ S(A2 , G2 ) with φ(y) = x and (y)i = yi is either zero (if there is no such solution y with (y)i = yi ),
or it is a positive fixed value for any i ∈ [1, m1 ] if there exist some solution y ∈ φ−1 (x) with (y)i = yi . The reason
being that φ and φi are affine homomorphisms and the preimage by φ and φi has a coset/subgroup-like structure.
Therefore, the condition (ii) can be rephrased as
15

(ii’) Given x ∈ S((A1 , b1 ), G1 ) and i ∈ [1, m1 ] then, for any yi ∈ Si ((A2 , b2 ), G2 ) with φi (yi ) = (x)i , there exists
a y ∈ S((A2 , b2 ), G2 ) with φ(y) = x and (y)i = yi .
Proof of Proposition 15. Since φ is surjective, so is φi : Si ((A2 , b2 ), G2 ) → Si ((A1 , b1 ), G1 ) for i ∈ [1, m1 ]. Since
φi is affine, |{yi ∈ Si ((A2 , b2 ), G2 ) : φi (yi ) = xi }| is the same for each xi ∈ Si ((A1 , b1 ), G1 ). As φ and φi are
affine homomorphisms, given x ∈ S((A1 , b1 ), G1 ), the solutions y ∈ S((A2 , b2 ), G2 ) such that φ(y) = x can be
partitioned into
{y ∈ S((A2 , b2 ), G2 ) : φ(y) = x} =
[

{y ∈ S((A2 , b2 ), G2 ) : φ(y) = x and (y)i = yi } . (3)

yi ∈Si ((A2 ,b2 ),G2 )
φi (yi )=(x)i

By the assumptions, the size of the sets {y ∈ S((A2 , b2 ), G2 ) : φ(y) = x and (y)i = yi } is independent of each yi
with φi (yi ) = (x)i and we denote it by µi . Therefore (3) is an equipartition. Let βi = |Si ((A2 , b2 ), G2 )|/|Si ((A1 , b1 ), G1 )|
be the number of preimages by φi of each xi ∈ Si ((A1 , b1 ), G1 ) in Si ((A2 , b2 ), G2 ). Then µi is such that µi βi = µ.
Let (K ′ , H ′ , γ ′ , l′ , r′ , Q′ , p′ , c′ ) be the vector defining the γ ′ -strong-representation for ((A2 , b2 ), G2 ). Let s be the
uniformity of the edges of H ′ . The candidate vector (K, H, γ, l, r, Q, p, c) is defined as follows.
• Q = Q ′ , c = c′ ,
m1 −1

|Si ((A2 ,b2 ),G2 )| |G1 |
|G2 |
• γi = γi′ |S
for i ∈ [1, m1 ]. p = µp′ |G
m −1
i ((A1 ,b1 ),G1 )| |G2 |
1| 1

Qm2

i=m1 +1

γi′

 hQm1

|Si ((A1 ,b1 ),G1 )|
i=1 |Si ((A2 ,b2 ),G2 )|

i

.

• H and K are hypergraphs on the same vertex sets as H ′ and K ′ respectively. e = {v1 , . . . , vs } is an edge in
K (respectively H) coloured i ∈ [1, m1 ] if and only if e is an edge coloured i ∈ [1, m1 ] in K ′ (respectively H ′ .)
• l(e) = φi (l′ (e)) if e is an edge coloured i ∈ [1, m1 ] as an edge in K ′ .
• Given H0 ∈ C(H, K), let H0′ be the unique copy of H ′ in K ′ spanned by the vertices of H0 . Then rq (H0 ) =
rq′ (H0′ ).
RP1 is satisfied for (K, H) with the same bounds and the labelling function l′ . By the hypothesis (i), each copy of
H ′ in K ′ spans a unique copy of H in K and vice-versa. Since
[
r−1 (x, q) =
r′−1 (y, q)
(4)
y∈φ−1 (S((A1 ,b1 ),G1 ))∩S((A2 ,b2 ),G2 )

and there are µ different y ∈ S((A2 , b2 ), G2 ) with φ(y) = x, then the union (4) is disjoint and
|r−1 (x, q)| = µ|r′−1 (y, q)| = µp′ c
′ s

|
as each set r′−1 (y, q) contains p′ c |K
|G2 |

By the definition of γ and p we have
|r−1 (x, q)| = µp′ c

m
|K ′ |s Y2 ′
γ =
|G2 | i=1 i

Qm2

i=1

m
|K ′ |s Y2 ′
γ.
|G2 | i=1 i

γi′ copies of H ′ in it.

|K|s
µp′
|G2 |

"

m2
Y

i=m1 +1

γi′

# "m
Y1

#
m
|Si ((A1 , b1 ), G1 )| |G2 |m1
|K|s Y1
γi
γi . (5)
=
pc
|Si ((A2 , b2 ), G2 )| |G1 |m1
|G1 | i=1
i=1

Since r′ is a γ ′ -representation function and φ = (φ1 , . . . , φm1 ) defines the µ-equivalence between systems (in particular, is surjective), RP2 is satisfied for r.
Given x ∈ S((A1 , b1 ), G1 ) and q ∈ Q, let ei be an edge coloured i and with l(ei ) = (x)i . H0 , a copy of H in
K, belongs to r(x, q) and contains ei if and only if H0 , as a copy of H ′ in K ′ , contains ei and belongs to one of
the r′−1 (y, q) with φ(y) = x. Since ((A2 , b2 ), G2 ) is γ ′ -strongly-represented, each set r′−1 (y, q) with (y)i = l′ (ei )
16

contains an H0′ , a copy of H ′ in K ′ , with ei ∈ H0′ . By RP3, there are p′
set r′−1 (y, q) whenever (y)i = l′ (ei ).

Qm2

j=1
γi′

γj′

copies of H ′ containing ei in any

There are µi = µ/βi solutions y ∈ S((A2 , b2 ), G2 ) such that φ(y) = x with (y)i = l′ (ei ). Therefore, there is a total
of

Q
Q m2 ′
m1
m2
′
Y
γ
µ
j
j=1 γj
j=1
′
′
=
p
γ
µi p ′
j
γi′
βi
γi′
j=m1 +1
i hQ
i
 hQm

m1 |Sj ((A2 ,b2 ),G2 )| |G1 |m1
1
m1
m2
γj′
Y
j=1
j=1
|S
((A
,b
),G
)|
|G2 |m1 |G2 |m1 −1 Y |Sj ((A1 , b1 ), G1 )|
j
1
1
1
γj′ 
= µp′ 
|G1 |
|G1 |m1 −1 j=1 |Sj ((A2 , b2 ), G2 )|
γi′ βi |G
j=m1 +1
2|
Qm1
j=1 γj
=p
γi
copies of H ′ in K ′ through ei that, seeing as copies of H in K, belong to r−1 (x, q). Hence, the vector (K, H, γ, l, r, Q, p, c)
fulfills RP3.
To show RP4, choose q and let ei be an edge in K and let x be a solution to ((A1 , b1 ), G1 ) such that (x)i = l(ei ).
By the surjectivity of φ there exists a y ∈ S((A2 , b2 ), G2 ) with φ(y) = x. By the assumption (ii), we can choose
the solution y such that (y)i = l′ (ei ). Since r′−1 (y, q) contains a copy H0′ of H ′ with ei ∈ H0′ , then r−1 (x, q)
contains H0 , the copy of H over the vertices of H0′ , and satisfies ei ∈ H0 . This shows RP4 and finishes the proof of
Proposition 15.
Comment. In Propositions 13, 14, and 15, the permutation σ has been omitted as the variables are assumed to
be properly ordered so that σ(i) = i for i ∈ [1, m1 ].

4

Proof of Theorem 2: from G to Ztn

Sketch of the proof of Theorem 2. Let ((A, b), G) be a homomorphism system with A : Gm → Gk . We
will see that each element of the family of the homomorphism systems on m variables and k equations, with
m ≥ k + 2, admits a representation where the constants χ1 and χ2 involved only depend on m. For any given
system ((A, b), G), we find a sequence of µ-equivalent systems {((A(i) , b(i) , G(i) )}, i ∈ [1, κ] for some κ ∈ N,
such that ((A(κ) , b(κ) ), G(κ) ) is strongly representable. Moreover, the sequence is equipped with affine morphisms
φ : S((A(i+1) , b(i+1) , G(i+1) ) → S((A(i) , b(i) , G(i) ) that fulfill the hypotheses of an appropriate proposition from
Section 3.2. By concatenating these propositions, we obtain the final result Proposition 33. The final argument of
the construction is summarized in Section 5.10. For the cases regarding m < k + 2 and to show the second part of
Theorem 2, the additional argument from Section 6 is used.
The sequence of systems {((A(i) , b(i) , G(i) )}i∈[1,κ] deals with different features of the solution set S((A, b), G) so
that, for the last element of the sequence, a 1-strong-representation can be found using the methods from [21].
In Section 4.1 the case of non-homogeneous systems is reduced to the homogeneous case (A, G). In Section 4.2,
we observe that the representation for any abelian group can be reduced to the homocyclic case Ztn , for some
appropriate t and n. Section 5 is devoted to the γ-representation for any system with G = Ztn . In Section 5.1 we
describe the interpretation of A as an integer matrix in the case of G = Ztn . Once we have an integer matrix, we
prepare the system for any determinantal in Section 5.2 while Section 5.5 prepares the systems to deal with the
cases where γ 6= 1. Sections 5.7 and Section 5.8 are devoted to the representation by hypergraphs using the tools
detailed in Section 5.6.

4.1

Representation and the independent vector

Proposition 16 below shows that we can restrict ourselves to consider homogeneous systems Ax = 0.
Proposition 16 (Representation: any independent vector). Either there is no solution to Ax = b, x ∈ Gm or
((A, 0), G) is 1-auto-equivalent to ((A, b), G).
17

Proof of Proposition 16. Assume that Ax = b has a solution y = (y1 , . . . , ym ). The map φ : S((A, 0), G) →
S((A, b), G) with φ((x1 , . . . , xm )) = (x1 + y1 , . . . , xm + ym ) defines a 1-auto-equivalence.

4.2

Representability for Ztn implies representability for G

This section shows how to obtain, for some system A′ and integers t and n, a system (A′ , Ztn ) µ-equivalent to
the given homogeneous system (A, G). Moreover, the map defining the µ-equivalence fulfills the hypothesis of
Proposition 14. Thus, a representation result for any system (A, Ztn ) is enough.
By the Fundamental Theorem of Finite Abelian Groups, G can be expressed, for some n1 , . . . , nt > 1 as the product
of cyclic groups G = Zn1 × · · · × Znt , with ni |nj for i ≥ j. Let G′ = Ztn1 . The group G can be seen as a quotient
of G′ . Let us denote by τ : G′ → G the quotient map


n1
n1
a1 , . . . , at
τ (a1 , . . . , at ) =
n1
nt
and let β = |G′ |/|G|. Let τ ′ denote the extension of τ from G′ to G′m using the diagonal action; if (x1 , . . . , xm ) =
x ∈ G′m then τ ′ (x) = (τ (x1 ), . . . , τ (xm )).
Recall that the set of homomorphisms A : Gm → Gk are in
some homomorphisms ϑi,j : G → G with
 


b1
x1
ϑ1,1 · · · ϑ1,m
 ..
..   ..  =  ..
.
.
 .
.
.  .   .
ϑk,1

···

ϑk,m

xm

bk

See, for instance [39, Section 13.10, p. 66].

bijection with k × m homomorphism matrices (ϑi,j ) for


m
X

ϑj,i (xi ) = bj , ∀j ∈ [1, k].
⇐⇒

i=1

By considering the matrix of homomorphisms (ϑ′i,j ) = (ϑi,j ◦ τ ), any homomorphism A : Gm → Gk induces a
homomorphism A′ : G′m → G′k . If we see b ∈ G′k ⊃ Gk , then the system ((A, b), G) induces a system ((A′ , b), G′ ).
Indeed if y ∈ S((A′ , b), G′ ) then τ ′ (y) ∈ S((A, b), G) and for any x ∈ S((A, b), G), then τ ′−1 (x) ⊂ S((A′ , b), G′ )
and τ ′−1 (x) 6= ∅.
Observation 17. τ ′ : S((A′ , b), G′ ) → S((A, b), G) is surjective. If Si ((A, b), G) is the translated subgroup obtained
by projecting the solution set to the i-th coordinate of Gm , then τ −1 (Si ((A, b), G)) = Si ((A′ , b), G′ ) and
|G|
|G′ |
=
.
|Si ((A, b), G)|
|Si ((A′ , b), G′ )|
Qm
Moreover, for any x ∈ S((A, b), G), τ ′−1 (x) = i=1 τ −1 ((x)i ).

Remark 18. Observe that ((A′ , b), Ztn ) is µ-equivalent to ((A, b), G) with the surjective map τ ′ : S(A′ , G′ ) →
S(A, G) and that the hypotheses of Proposition 14 regarding the map φ = τ ′ hold by Observation 17.

Therefore, using Proposition 16, it is enough to find a γ-representation for ((A′ , 0), Ztn ), alternatively denoted by
(A′ , Ztn ), with γi = |Ztn |/|Si (A′ , Ztn )|.

5

Proof of Theorem 2: γ-representability of (A, Ztn)

In this section we prove the γ-representability of (A, Ztn ) for homomorphism systems A with m ≥ k + 2. The
other cases with m < k + 2 are treated in Section 6. Following Section 4.2, A can be seen as a k × m matrix of
homomorphisms. As previously mentioned, the construction involves creating a sequence of µ-equivalent sequence,
each element of the sequence being a modification of the pair matrix-group from the previous one.

5.1

From a homomorphism to an integer matrix
i

Let gi = (0, . . . , 0, 1, 0, . . . , 0), i ∈ [1, t], be the canonical generators of G = Ztn . Any variable xi in Ztn can be
decomposed into t variables xi = (xi,1 , . . . , xi,t ), with xi,j ∈ Zn . Therefore, any k × m homomorphism matrix in
18

Ztn can be expressed as a tk × tm integer matrix by replacing each homomorphism ψ : Ztn → Ztn by a t × t integer
matrix Ψ = (ψi,j ); ψi,j is the coefficient of gi in the image of gj by ψ expressed as a linear combination of the
generators g1 , . . . , gt . Indeed, the image of gj by ψ is an element of Ztn , hence it can be thought of as a tuple in
[0, n − 1]t ; ψi,j is the i-th component of such tuple.
With these considerations, the system A can be interpreted as an integer system of dimensions tk × tm with the
variables in Zn : A (x1,1 , · · · , x1,t , · · · , xm,1 , · · · , xm,t )⊤ = 0 with


Ψ1,1 · · · Ψ1,m

..  , where Ψ is a t × t block of integers.
..
A =  ...
i,j
.
. 
Ψk,1

···

Ψk,m

If Ai is a column of zeros in A, we can exchange it with any column vector whose components are multiples of
n. If the determinant of the kt × kt submatrix of A formed by the first kt columns is zero, as a matrix with
coefficients in Z, then we add appropriate multiples of n to the main diagonal so that the modified matrix has
non-zero determinant in Z.13 The modified matrix and the original are equivalent in Zn .
Even though A is treated as an integer matrix for most of Section 5, the arguments should take in consideration
the origins of A as a homomorphism matrix. In particular, the t variables xi,1 , . . . , xi,t coming from xi are kept
consecutive as they represent a unique variable xi .

5.2

Union of systems: independent vectors simulation

Let S(A) denote the Smith Normal Form of A. Recall that the i-th determinantal divisor of A, denoted by Di (A) and
named i-th determinantal for short, is the greatest common divisor of the determinants of all the i ×
Qii submatrices
of A (choosing i rows and i columns). The product of the first i elements in the diagonal of S(A), j=1 dj , equals
Q
the i-th determinantal of A, so Di (A) = ij=1 dj . Ai denotes the i-th row of A while Ai its i-th column.
Proposition 19 (Row multiples). Let A be a k × m, m ≥ k integer matrix. Let d1 , . . . , dk denote its diagonal
elements of the Smith Normal Form of A. There is a matrix A(1) , equivalent to A (row reduced), such that the row
A(1)
j satisfies


	
gcd A(1)
j,i i∈[1,m] = dj .

Furthermore, assume that di 6= 0 for i ∈ [1, k]. The matrix A(2) , obtained from A(1) by dividing the row A(1)
j by dj ,
has k-th determinantal one.
Proof of Proposition 19. Let S = U −1 AV −1 be the Smith Normal Form of A, where U and V are integer unimodular
matrices that convey, respectively, the row and column operations that transform A into S. We have S = (D|0),
where D is a k × k diagonal integer matrix with det(D) = Dk (A) and 0 is an all–zero k × (m − k) matrix. di is the
i-th element in the main diagonal of D. Let A(1) = U −1 A = SV . Notice that the system A(1) x = 0 is equivalent to
Ax = 0.
As A(1) has been obtained from S by column operations using integer coefficients, the j-th row A(1)
j is formed by
integer multiples of dj . Since V is unimodular, then


	
gcd A(1)
j,i i∈[1,m] = dj ,

which proves the first part of the statement. Let A(2) be the matrix obtained by dividing each row A(1)
j by dj . We
have A(2) = S (2) V , where S (2) = (Ik |0) is the Smith Normal Form of A(2) and Ik is the k × k identity matrix. This
completes the proof.

Pdi
The integer di induces a homomorphism di : G → G with di (x) = di x =
j=1 x. Let Pdi (G) denote the set
−1
di (0) ⊂ G, this is, the subgroup of preimages of 0 by the homomorphism induced by di inside G.
13 This

can be done as, for instance, nikt grows faster than (kt)!ni when i increases and n ≥ 2.

19

Observation 20 (Solution set). Using Proposition 19:
S(A, G) =

[

S((A(2) , b), G), for b ∈

k
Y

Pdi (G),

i=1

b

where di is the greatest common divisor of the i-th row of A(1) .
Proof of Observation 20. Let x ∈ Gm be a solution to Ax = 0, or, equivalently, A(1) x = 0. Observe the j-th
equation for A(1) :

(2)
(2)
(1)
A(1)
j,1 x1 + · · · + Aj,m xm = 0 ⇐⇒ dj Aj,1 x1 + · · · + Aj,m xm = 0.

(2)
Thus, A(2)
j,1 x1 + · · · + Aj,m xm is an element of Pdj (G). Doing the same for all the rows (equations) of the system
Q
gives us that A(2) x = b for some independent vector b in ki=1 Pdi (G) ⊂ Gk . Also, any solution to A(2) x = b for
Qk
some b ∈ i=1 Pdi (G) is a solution to A(1) x = 0 by multiplying the i-th equation by di .

We introduce dummy variables yj ∈ G to account for those independent vectors that occur by Observation 20. The
variables yi ∈ G are called simulating variables.
Observation 21 (Simulating the independent vector for Zsn ). Assume G = Zsn . For each row A(1)
j , the equation
(2)
A(2)
j,1 x1 + · · · + Aj,m xm −

n
yj = 0,
gcd(n, dj )

where yj is a new variable with yj ∈ G, is |Pn/ gcd(n,dj ) (G)|-auto-equivalent to

(2)
(2)
(1)
A(1)
j,1 x1 + · · · + Aj,m xm = dj Aj,1 x1 + · · · + Aj,m xm = 0.

The application (x1 , . . . , xm , yi ) → (x1 , . . . , xm ) gives the |Pn/ gcd(n,dj ) (G)|-auto-equivalence.
Moreover, for each value of the j-th component of the independent vector g ∈ Pdj (G), there are |G|/|Pdj (G)| values
for yj with
n
yj = g.
gcd(n, dj )
Proof of Observation 21. Since G = Zsn then Pdj (G) ∼
= Zsgcd(n,dj ) . Observe that the introduction of y j in
(2)
A(2)
j,1 x1 + · · · + Aj,m xm − y j = 0

with yj ∈ Zsgcd(n,dj ) simulates the independent vector.
n
n
n
: Zsn → Zsgcd(n,dj ) with gcd(n,d
(g) = gcd(n,d
g is a |Pn/ gcd(n,dj ) (G)|-to-1 surjective homomorphism, we
As gcd(n,d
j)
j)
j)
n
s
can replace the variable y j ∈ Zgcd(n,dj ) by the variable yj ∈ Zsn multiplied by gcd(n,d
and obtain the two parts of
j)
the observation.

Let A(3) denote the new matrix of the system with the simulating variables. This is, A(3) = (A(2) Y ) where Y is a
collection of columns of a k × k diagonal integer matrix.
Remark. If A is a tk×tm integer matrix coming from a homomorphism matrix, then we use Observation 21 on each
row with G = Zn (or s = 1). Additionally, Observation 20 should consider the matrices as tk × tm integer matrices
and b ∈ Ztk
n . Adding the simulating variables is only needed when gcd(di , n) 6= 1. To simplify the arguments, we
may add some additional columns in the matrix Y , with its coefficients being multiples of n, so that the final matrix
A(3) has dimensions tk × tm(3) , with m(3) = m + k. Since Dtk (A(2) ) = 1, then Dtk (A(3) ) = 1.
Remark 22. The system (A(3) , Ztn ) is µ-auto-equivalent to (A(1) , Ztn ) with
φ : S(A(3) , Ztn ) −→ S(A(1) , Ztn )
(x1 , . . . , xm , xm+1 , . . . , xm(3) ) 7−→ (x1 , . . . , xm ),
where µ is the number of preimages by φ of each x ∈ S(A(1) , Ztn ) in S(A(3) , Ztn ). If m(3) = m + k then µ =
Qtk
n
i=1 gcd(di ,n) .
20

5.3

From the determinantal to the determinant

Lemma 23 (Matrix extension, Lemma 9 in [21]). Let A be a k × m integer matrix, m ≥ k. There is an m × m
integer matrix N that contains A in its first k rows and is such that det(N ) = Dk (A).
Let us include a proof for completeness.
Proof of Lemma 23. Let S = U AV = (D|0) be the Smith Normal Form of A, where U and V are unimodular
matrices and D is a k × k diagonal matrix. Consider




U
0
D
0
.
and U ′ =
S′ =
0 Im−k
0 Im−k
Then N = U ′−1 S ′ V −1 is an integer matrix as U ′ is unimodular and satisfy the thesis of the lemma.
As Dtk (A(2) ) = 1, we use Lemma 23 to extend the tk × tm integer matrix A(2) to a tm × tm determinant 1 integer
matrix
 (2) 
 (2) 
A
A
N=
, det
= det(N ) = 1,
M
M
which is a part of the matrix
(4)

A

 (2)
A
=
M

0
Itm−tk

Y
0



.

Therefore, the matrix A(4) can be row reduced into a new matrix A(5) in such a way that

A(5) = Itm B ∼ A(4)

for some tm × [(tm − tk) + (tm(3) − tm)] = tm × tm(4) integer matrix B. Moreover, we can assume that the columns
of the matrix Itm from A(5) correspond to the ordered original variables ((x1,1 , . . . , x1,t ), · · · , (xm,1 , . . . , xm,t )).
Observe that A(5) has tm rows and tm(5) columns, where m(5) = m + m(4) .
Remark 24. The system ((A(4) , 0), G), hence ((A(5) , 0), G), is 1-auto-equivalent to ((A(3) , 0), G). Indeed, for any
solution y ∈ S(A(4) , G) there exists one, and only one, solution x ∈ S(A(3) , G) such that the projection
y = (y1 , . . . , ytm(5) ) 7−→ (y1 , . . . , ytm , ytm+(tm−tk)+1 , . . . , ytm(5) )

gives x.14
Let us show an observation that is helpful in Section 5.8.

Observation 25. Let A = A′ B , with B being a k × m, m ≥ k integer matrix and A′ denotes a square matrix
of dimension k. Let n be a positive integer and assume that gcd(Dk (B), n) = 1. Then, for any value of x1 , . . . , xk ,
xi ∈ Zn , there are nm−k values for (xk+1 , . . . , xk+m ) ∈ Zm
n with Ax = 0.
Proof of Observation 25. Extend the matrix A with Lemma 23 to a 1-auto-equivalent system


  
 ′
B
A B
0
with gcd det
, n = 1.
A′ =
M
0 M Im−k
Select a value for x1 , . . . , xk and any value for the last m − k variables of A′ . Then the value of the variables
xk+1 , . . . , xk+m in Zn is uniquely determined as the determinant is coprime with n.
14 The

coordinates to be omitted correspond to the columns of 0
the values on the first m coordinates.

21

Itm−tk

⊤

for A(4) . The value of these variables is determined by

5.4

Grouping the variables: on the matrix B

In Section 5.1 we have assigned an integer matrix in Zn to a given homomorphism matrix. Let us partially reverse
this transformation. Consider A(5) to be formed by mm(5) blocks of size t × t, where m(5) = m(4) + m. Let A(5)
i be
can
be
the matrix formed by the i-th row of blocks. Omitting the blocks of zeroes from the Itm part of A(5) , A(5)
i
written as

Bi ,
A(5)
i = It

where Bi corresponds to the rows B(i−1)t+1 , . . . , B(i−1)t+t from A(5) . We can assume that Dt (Bi ) 6= 0 in Z.
Otherwise, we can add an appropriate multiple of n to each of the elements of Bi ; the new matrix is equivalent in
Zn and has non-zero determinantal in Z.

By Proposition 19, Bi has an equivalent, row reduced, matrix Bi(1) where the greatest common divisors of the rows
are the elements in the diagonal of the Smith Normal Form of Bi . By performing such row reductions into A(5)
i , or
in the whole A(5) using the corresponding rows, the matrix It turns into a unimodular matrix Ui related with the
row operations conducted on Bi to obtain Bi(1) . Since Dt (Bi(1) ) = Dt (Bi ) 6= 0, Bi(1) has no zero row in Z.
As Ui is unimodular, it induces an automorphism in G = Ztn denoted by φ(1)
i : G → G, with
⊤
x1
 −1  .. 
(1)
φ(1)
 .  .
i (x) = φi ((x1 , . . . , xt )) = Ui
xt


Consider the matrix A(6) = Itm




B (1) where B (1) is formed by collecting all the rows from Bi(1) , i ∈ [1, m].

Remark 26. (A(6) , Ztn ) is 1-auto-equivalent to (A(5) , Ztn ) with

φ : S(A(6) , Ztn ) −→ S(A(5) , Ztn )
(1)
x = (x1 , . . . , xm(5) ) 7−→ (φ(1)
1 (x1 ), . . . , φm(5) (xm(5) ))

being the map between the solutions sets.

5.5

Towards γ 6= 1: constructing several systems

We create several auxiliary systems to achieve an appropriate γ 6= 1 that are combined in Section 5.8. The purpose
of its combination is to create a strongly 1-representable system (A(7) , G(7) ) with Si (A(7) , G(7) ) = G(7) for any i.
(A(7) , G(7) ) is µ-equivalent to (A(6) , Ztn ) and the map of the µ-equivalence fulfills the hypotheses of Proposition 15.
See Remark 31.
(1)
with j ∈ [1, t], by
Let Bi(2) be the matrix obtained from Bi(1) by dividing each row of Bi(1) , denoted by Bi,[j]
(1)
(2)
15
di,j = gcd(Bi,[j] ). Therefore, the greatest common divisor of each row in Bi is one.
Let B (2) be the matrix
formed by collecting the rows in Bi(2) , i ∈ [1, m]. That is to say, for i ∈ [1, m] and j ∈ [1, t], the (i − 1)t + j-th row
of B (2) is the j-th row of Bi(2) .
(2)
denote the matrix
Given i ∈ [1, m] and j ∈ [1, t], let Bi(j)

(2)
Bi(j)




(2)
B[t(i−1)+1,t(i−1)+j−1]


(1)
Bi,[j]
=

(2)
B[t(i−1)+j+1,ti]

(1)
denotes the j-th row of Bi(1) . This
where B[i(2)1 ,i2 ] denotes the set of rows with indices in [i1 , i2 ] from B (2) and Bi,[j]
(2)
are the same as the rows of Bi(2) except the j-th, which is the same as the j-th row in Bi(1) .
is, all the rows of Bi(j)

15 We

(1)
by the the minimum di,j such that gcd(di,j /di,j , n) = 1.
could have chosen to divide the coefficients of the row Bi,j

22

For i ∈ [1, m] and j ∈ [1, t] let J(i,j) be the matrix formed by

′
J(i,j)

j



(2)
It(i−1) 0
0
0
0
B[1,t(i−1)]
0
(2)
 0
0
It
0
ej
0
Bi(j)

(2)
=
0
0
0
I
0
0
B
t(m−i)

[ti+1,tm]
 0
0
0
1
0
0
1
0
0
0
0 It−1
0
0

(2)
0
It(i−1) 0
0
0
0
B[1,t(i−1)]
(2)
 0
It
0
0
0
Bi(j)
−ej

(2)
∼
0
0
I
0
0
B
0
t(m−i)

[ti+1,tm]
 0
0
0
1
0
0
1
0
0
0
0 It−1
0
0


(3)
= It(m+1) B(i,j) = J(i,j)



0
0
0
0
It−1







0
0
0
0

It−1








where ej = (0, . . . , 0, 1, 0, . . . , 0)⊤ ∈ Zt .
The variables in the system associated to J(i,j) take values over G(i,j) = d−1
i,j (0) ⊂ Zn , the subgroup of Zn formed
16
by the preimage of zero by the homomorphism induced by di,j in Zn . The matrix J(i,j) can be considered as a
homomorphisms system over G(i,j) or over Gt(i,j) , by considering J(i,j) to be formed by blocks of size t × t. In the
first case the system is denoted by (J(i,j) , G(i,j) ) and, in the second, by (J(i,j) , Gt(i,j) ).
With respect to A(6) , t equations and 2t variables in G(i,j) have been added to J(i,j) . The added variables form the
(m + 1)-th block of t variables in J(i,j) and the last block of t variables over G(i,j) . The added equation corresponds
to the last one in J(i,j) and it involves the 2t variables added.
Let J(1,0) be the system induced by the matrix
J(1,0)


I
= tm
0

0
It

B (2)
0

0
It




= It(m+1)

(3)
B(1,0)



that configures a system (J(1,0) , Zn ) or (J(1,0) , Ztn ) if J(1,0) is seen as a block matrix. Let us denote G(1,0) = Zn .
Let Υ = (1, 0) ∪ {[1, m] × [1, t]}. The systems Jκ , κ ∈ Υ, thought of as integer matrices, have some common
properties.
(i) Jκ have m(J) = m(6) + 2 = m(5) + 2 variables and k (J) = k (6) + 1 = m + 1 equations over Gtκ .
(ii) The groups Gκ are cyclic: Gκ =

n
gcd(dκ ,n)

· Zn ⊆ Zn . Jκ can be seen as a homomorphism system (Jκ , Gtκ ).


(iii) Jκ can be displayed as It(m+1) B (3) for certain B (3) depending on κ and with dimensions t(m + 1) ×
(3)
(3)
, |Gκ |) = 1. Moreover, the block of t
from B (3) have gcd(B[i]
t((m(5) + 2) − (m + 1)). All the rows B[i]
(3)
(3)
consecutive rows Bi = B[(i−1)t+1,...,(i−1)t+t] , i ∈ [1, m + 1], is such that gcd(Dt (Bi(3) ), |Gκ |) = 1. Even more,
gcd(Dt (Bi(3) ), n) = 1
Remark 27. For any κ ∈ Υ, the homomorphism
fκ : S(Jκ , Gtκ ) −→ S(A(6) , Gtκ ) ⊂ S(A(6) , Ztn )



d1,1 x(1,1) , . . . , d1,t x(1,t)
..


 



.
x(1,1) , . . . , x(1,t)




d
x
,
.
.
.
,
d
x
(6)
(6)
(6)
(6)


..
k ,1 (k ,1)
k ,t (k  ,t) 

 7−→ 
.


x
,
.
.
.
,
x
(J)
(J)

(k +1,1)
(k +1,t)


x(m(J) ,1) , . . . , x(m(J) ,t)


.
..



x(m(J) −1,1) , . . . , x(m(J) −1,t)

is surjective and |Gtκ |-to-1.
16 Observe

that, if gcd(di,j , n) = 1, then G(i,j) = {0}.

23

Proof of Remark 27. The variables with indices [k (6) +1, m(6) ] from (A(6) , Gtκ ) parameterize the solution set (A(6) , Gtκ ).
This is, any choice of x(k(6) +1,·) , . . . , x(m(6) ,·) ∈ Gtκ provide a unique solution to (A(6) , Gtκ ). The same holds true for
the variables indexed by [k (J) + 1, m(J) ] in the system (Jκ , Gtκ ).
Assume (i, j) ∈ Υ \ {(1, 0)}. The (i, j)-th equation for (A(6) , Gtκ ) can be written as
(2)
x(i,j) + di,j B[(i−1)t+j]
· x(k(6) +1,j) , . . . , x(m(6) ,j)

On the other hand, the (i, j)-th equation in (Jκ , Gtκ ) is












(3)
· y(k(J) +1,j) , . . . , y(m(J) ,j)
y(i,j) + Bκ,[(i−1)t+j]

⊤

=

⊤
)

=0

⊤
(2)
· y(k(J) +1,j) , . . . , y(m(J) −1,j) = 0
= y(i,j) + B[(i−1)t+j]
)
⊤
(3)
· y(k(J) +1,j) , . . . , y(m(J) ,j) =
y(i,j) + Bκ,[(i−1)t+j]
⊤
(2)
· y(k(J) +1,j) , . . . , y(m(J) −1,j) − y(m(J) ,j) = 0
y(i,j) + di,j B[(i−1)t+j]

if (i, j) 6= κ
if (i, j) = κ.



Therefore, if we let x(k(6) +1,·) , . . . , x(m(6) ,·) = y(k(J) +1,·) , . . . , y(m(J) −1,·) , the variables y(i,j) and x(i,j) are such
that di,j y(i,j) = x(i,j) for (i, j) 6= κ. If (i, j) = κ, then di,j Gκ = 0 and (x)κ = 0 = di,j (y)κ for any pair of solutions
x ∈ S(A(6) , Gtκ ) and y ∈ S(Jκ , Gtκ ). This shows that the map fκ exists.
Since fκ maps the subset of parameterizing variables (y(k(J) +1,·) , . . . , y(m(J) −1,·) ) to the parameterizing variables
(x(k(6) +1,·) , . . . , x(m(6) ,·) ) using the identity map, fκ is surjective. Moreover, since the image by fκ is independent
of the variable y(m(J) ,·) , the map is |Gtκ |-to-1.
In the following part, Section 5.6, we adapt to the case of homomorphisms matrices the properties of the n-circular
matrices used to show 1-strong-representations in [21] and [3, 19].17 In particular, Proposition 28 in Section 5.6
constructs, given an n-circular matrix, a matrix C with good properties for the representation.
In Section 5.7 an n-circular matrix J κ is constructed for each matrix Jκ , κ ∈ Υ. The final construction of the
1-strong-representation is conducted in Section 5.8; it involves combining the matrices J κ , κ ∈ Υ, in a single matrix
A(7) , as well as combining all the matrices Cκ , provided by Section 5.6, in a single matrix C.

5.6

n-circular matrices and properties

An integer matrix A formed by k × m square blocks, m ≥ k, is said to be block n–circular if all the matrices formed
by k consecutive columns of blocks of A, (Ai , . . . , Ai+k−1 ) (considering the indices modulo m) have determinant
coprime with n. A matrix is called standard n–circular if it is n-circular and with the shape Ik B . When the
size of the blocks is one this definition coincides with the one provided in [21, Definition 3]. The properties of
the n-circular matrices described in Proposition 28 are used in the construction of the representation described in
Section 5.8.
Proposition 28. Let A be a kt × mt integer matrix, m ≥ k, formed by km blocks of size t × t. Assume that
A is block n–circular. Then there exists a m × m block integer matrix C = (Ci,j ), each block of size t × t and
(i, j) ∈ [1, m]2 , with the following properties.
i. AC = 0
ii. The i-th row of t × t blocks is such that Ci,j = 0, for j
matrix looks like

∗ ∗
0 ∗

0 0
C =
∗ 0

∗ ∗
∗ ∗

∈ {i + k + 1, . . . , i − 1} with indices modulo m. So, the

∗ ∗ 0 0
∗ ∗ ∗ 0

∗ ∗ ∗ ∗

0 ∗ ∗ ∗

0 0 ∗ ∗
∗ 0 0 ∗

iii. gcd(det(Ci,i ), n) = 1 and gcd(det(Ci,k+i ), n) = 1 for all i ∈ [1, m] with indices taken modulo m.

17 Although the final representation to prove [21, Theorem 1] is not strong, the one established in [21, Lemma 4] has the strong
property.

24

Proof of Proposition 28. Consider the square matrix formed by the column blocks A[i,i+k−1] = (A[i] , . . . , A[i+k−1] )
with i ∈ [1, m]. By assumption A[i,i+k−1] is a square non-singular matrix as it has non-zero determianant. For the
j-th vector in the column block A[i+k] , A[i+k],j , with j ∈ [1, t], we can find rational coefficients b(i−1)t+w,(i+k−1)t+j ,
w ∈ [1, kt], with
X
b(i−1)t+w,(i+k−1)t+j A[i,i+k−1],w
A[i+k],j =
w∈[1,kt]

[i,i+k−1],w

where A
stands for the w-th column in A[i,i+k−1] and corresponds to the ((i − 1)t + w)-th column in A.
Moreover, since the determinant is coprime with n, there exists an integer c(i+k−1)t+j,(i+k−1)t+j , coprime with n,
such that
X
c(i−1)t+w,(i+k−1)t+j A[i,i+k−1],w
(6)
− c(i+k−1)t+j,(i+k−1)t+j A[i+k],j =
w∈[1,kt]

where, for w ∈ [1, kt], c(i−1)t+w,(i+k−1)t+j = −c(i+k−1)t+j,(i+k−1)t+j b(i−1)t+w,(i+k−1)t+j are integers.
The coefficients of the matrix C are

(a) cw1 ,w2 whenever the subscripts (w1 , w2 ) coincide with one the c’s found in the relations given by (6) for the mk
column vectors of A.
(b) 0 otherwise.
Consider the matrix C as divided into t × t blocks C·,· . C satisfy property ii. Indeed, given a column of C indexed
by j = j1 t + j2 , with j1 ∈ [0, m − 1] and j2 ∈ [1, t], the indices i of the rows involved in the relations given by (6)
satisfy i ∈ [(j1 − k)t, (j1 + 1)t].
The relation (6) can be rearranged as
X

0 = c(i+k−1)t+j,(i+k−1)t+j A[i+k],j +

c(i−1)t+w,(i+k−1)t+j A[i,i+k−1],w

w∈[1,kt]

P

l

and can be extended to w∈[1,tm] cw,(i+k−1)t+j A considering that all the other c’s that appear in the sum are zero
by (b). Thus i is satisfied.
Observe that Ci,i is a diagonal matrix where all the elements in the diagonal are coprime with n. Hence the first
part of property iii is satisfied. To show the second part observe that, for each i ∈ [1, m], indices modulo m,


0 0
···
0 Ci−k,i



[i]
..  =
[i−k+1]
[i−1]
A[i−k] · · · A[i−1] 

A
A
·
·
·
A
It(k−1)
.
Ci−1,i
[i]

[i],j

where the columns of A are multiples of the columns of A[i] by (6). Indeed, A
= −c(i−1)t+j,(i−1)t+j A[i],j .
Therefore


 Y
c(i−1)t+j,(i−1)t+j
det A[i−k+1] · · · A[i−1] A[i] = det A[i−k+1] · · · A[i−1] A[i]
j∈[1,t]

which is a product of integers coprime with n. Since

0 0
···
0

det 
It(k−1)


Ci−k,i
..  = ± det(C
i−k,i )
. 
Ci−1,i





and (± det(Ci−k,i )) · det A[i−k] · · · A[i−1] = det A[i−k+1] · · · A[i−1] A[i] , then det(Ci−k,i ) is an integer
coprime with n. This proves the second part of iii and finalizes the proof of the proposition.

5.7

Construction of the n-circular matrix

Let n be a positive integer and let G be
 an abelian group of order n. For our purposes, we can assume G = Zn .
Let A be a kt × mt matrix A = Itk B though of as built with km blocks of size t × t. Moreover, we shall assume
that gcd (Dt (Bi ), n) = 1, where Bi is the i-th block
of t rows of the submatrix B, i ∈ [1, k]. In this section we build

a tk (9) × tm(9) integer matrix A(9) = Itk(9) B such that:
25

• (A(9) , Gt ) is 1-auto-equivalent to (A, Gt ).
• A(9) is n-circular with blocks of length 1, hence n-circular with blocks of size t.
We enlarge the t × (m − k)t matrix Bi using Lemma 23 to the (m − k)t × (m − k)t matrix
 
 
Bi
Bi
= 1.
with det
Bi(4) =
Mi
Mi

By adding some new variables taking values in G, Ai = It Bi turns into the matrix denoted by A(8)
i with



It
0
Bi
= I(m−k)t Bi(4)
A(8)
i =
0 I(m−k−1)t Mi
Let us denote by B (4) the matrix formed by attaching together all the rows in {Bi(4) }i∈[1,k]
 (4) 
B1


B (4) =  ...  .
Bk(4)


Denote by A(8) the matrix A(8) = Ik(m−k)t B (4) . The variables added with respect to A take values over the
whole G. The system (A(8) , G) and (A(8) , Gt ) are 1-auto-equivalent to (A, G) and (A, Gt ) respectively.
A Lemma for the building blocks. Lemma 29 improves [21, Lemma 11] so that each block can be constructed
by adding a linear number of rows with respect to the original number of columns.
Lemma 29. Let n and r be positive integers and let M be an r × r integer matrix with determinant coprime with
n. There are r × r integer matrices S and T such that
 
Ir
S
 

M′ = 
M 
T 
Ir

is a 5r × r integer matrix with the property that each r × r submatrix of M ′ , consisting of r consecutive rows, has
a determinant coprime with n.
Proof of Lemma 29. We detail the construction of T . Let us define the matrices r − i × r matrices
 i 
Mi+1
 .. 
i
M =  .  , i ∈ [0, r − 1],
Mri

i−1
i−1
together with the rows Ti+1 inductively. Let M 0 = M . Let di = gcd(Mi,i
, . . . , Mr,i
), i ∈ [1, r], be the greatest
i−1
common divisor of the column M·,i . Let

Ti = λii Mii−1 + · · · + λir Mri−1
where λii , . . . , λir are such that

i−1
i−1
λii Mi,i
+ · · · + λir Mr,i
= di

(7)

and where λii is some prime, pi , larger than n. This pi exists, subjected to the constrain (7), by the Dirichlet theorem
regarding the containment of infinitely many primes in the arithmetic progressions a+bZ with gcd(a, b) = 1. Observe
that
 i−1 
 i−1 
Mi+1
Mi
 .. 
 .. 
 . 
 . 




M i−1 
M i−1 
r
r




det 
 = pi det  T1 
 T1 


 . 
 . 
 .. 
 .. 
Ti−1

Ti

26

i−1
The rows of the matrix M i , denoted by Mji , are Mji = Mji−1 − (Mj,i
/di )Ti , for j ∈ [i + 1, r] and with T0 = 0. The
i
first i columns of M are the zero columns.

Observe that gcd(di , n) = 1 as



 i 
i−1 
Mi+1
Mi+1
 .. 
 .. 
 . 
 . 




i 
M i−1 

r
 = det  Mr 
det 
 T1 
 T1 




 . 
 . 
 .. 
 .. 
Ti

Ti

is coprime with n and the original matrix M has determinant coprime with n. Therefore the equivalent matrix
 i  

Mi+1
Mi+1
 ..   .. 
 .   . 

 

 Mri   Mr 

∼

 T1   T1 

 

 .   . 
 ..   .. 
Ti

Ti

also has a determinant coprime with n. This shows the property regarding the coprimality of the determinant of
consecutive rows for the first r rows constructed in this way, T1 , . . . , Tr . Observe that
i−1

z }| {
Ti = (0 · · · 0 di ∗ · · · ∗).

Since each di is coprime with n, we can add the identity matrix after the matrix T and the claimed properties
are satisfied. The matrix S is built similarly but we start from the last column and we construct a lower diagonal
matrix S.
Attaching building blocks. We use Lemma 29 on each matrix Bi(4) to obtain matrices


It(m−k)


 Si 
It(m−k)
 (4) 
 B
  B (5) 
i
 i =
 Ti 
It(m−k)
It(m−k)
that are put together into a large matrix

A(9)

It(m−k)
B1(5)
It(m−k)
..
.






= I(4k+1)t(m−k)


It(m−k)


Bk(5)
It(m−k)








 = I(4k+1)t(m−k)





B (9)



that is n-circular. This is, any r = (4k + 1)t(m − k) consecutive columns form a matrix with determinant coprime
with n. Indeed, the matrix formed by the first r columns is the identity matrix. On the other cases, some columns
of the left most identity matrix Ir are selected, along with some other columns from the B (9) part. Therefore the
determinant is, up to a sign, the determinant of the submatrix formed by the columns selected in B (9) and the rows
corresponding to the indices of the columns not picked from Ir . If the set of columns selected are consecutive and
contains all the columns of B (9) , the determinant is coprime with n as so is the determinant formed with t(m − k)
consecutive rows from B (9) . Since the first and the last square blocks of B (9) are identity matrices, the remaining
cases are shown.

27

For Gt = Ztn , the equations induced by the new rows in B (9) with respect to B (4) are
t(m−k)

xi +

X

(9)
xr+j = 0, xi ∈ Zn .
Bi,j

j=1

t

Therefore, (A , G ) is a k
(9)

(9)

×m

(9)

homomorphism system 1-auto-equivalent to (A(8) , Gt ).

Remark 30. The system (A(9) , Ztn ) is 1-auto-equivalent to (A, Ztn ) by projecting onto the original coordinates using
maps φi equal to the identity map. Indeed, any solution to (A, Ztn ) can be extended uniquely to a solution in (A(9) , Ztn )
as the last m − k variables in both systems parameterize the solutions in both cases.

5.8

Final composition for γ 6= 1 and representation for (A(7) , G)


 	
Joining the matrices and groups. Let J κ κ∈Υ , be the n–circular integer matrices obtained from Jκ = It(m+1)
(3)
using the procedure in Section 5.7. This applies by (iii) in Section 5.5 regarding gcd(Dt (Bκ,i
), n) = 1. All the ma(J’)
(J)
(J)
(J)
(J’)
(J)
(J)
trices J κ have the same dimensions tk = (4k + 1)t(m − k ), tm = (4k + 2)t(m − k (J) ) over Gκ .
Consider Υ to be ordered lexicographically; given (κ1 , κ2 ), (κ3 , κ4 ) ∈ Υ, (κ1, κ2 ) < (κ3 , κ4 ) if and only if κ1 m + κ2 <
v
κ3 m + κ4 . The columns of the matrix A(7) correspond to the columns J κ using the lexicographical order for the

ordered set [1, tm(J’) ] × Υ ∋ (v, κ). The rows A(7) correspond to the rows J κ w using the lexicographically ordered
set [1, tk (J’) ] × Υ ∋ (w, κ). The coefficients of A(7) are zero wherever the intersection of a column and a row does
not appear in any of the matrices J κ . This is, the (i, j) element of A(7) is given by


i = (λ1 − 1)(1 + mt) + 1 + (κ1 − 1)t + κ2


if



j = (µ1− 1)(1 + mt) + 1 + (κ1 − 1)t + κ2

J κ λ1 ,µ1
λ1 ∈ [1, tk (J’) ], µ1 ∈ [1, tm(J’) ]
(A(7) )i,j =
for
some


κ = (κ1 , κ2 ) ∈ Υ



0
otherwise.
Consider A(7) to be the block-diagonal matrix containing the matrices {J κ }κ∈Υ as the blocks in the diagonal. The
matrix A(7) can be seen as an appropriate permutation of rows and columns of the block matrix A(7) . Let P1 and
P2 denote, respectively, the row and column permutations so that A(7) = P1 A(7) P2 .
Q
A(7) can be considered as formed by t2 k (J’) m(J’) blocks of size (1 + tm) × (1 + tm) over the groups G = κ∈Υ Gκ .
Furthermore, t2 of the (1 + tm) × (1 + tm) blocks can be grouped in a single block of size t(1 + tm) × t(1 + tm). This
t
Q
allows us to interpret A(7) as formed by k (9) m(9) blocks of size t(1+tm)×t(1+tm) over the groups Gt =
κ∈Υ Gκ .
Therefore, if we denote k (7) = k (J’) and m(7) = m(J’) , A(7) can be considered as a k (7) × m(7) homomorphism system
over Gt denoted by (A(7) , Gt ). (A(7) , Gt ) hasthe particularity
that the solution set of the system A(7) , S(A(7) , Gt ),
	
t
is the cartesian product of the solution sets S J κ , Gκ κ∈Υ .
Matrix C for A(7) . Since each of the matrices {J κ }κ∈Υ is n–circular with block size 1, we use Proposition 28 to
find band-shape matrices Cκ related to J κ for κ ∈ Υ.
All the {Cκ }κ∈Υ are joined into a single C fulfilling the properties stated in Proposition 28 for A = A(7) . Indeed,
let C be the block matrix with the matrices {Cκ }κ∈Υ in the diagonal and zeros everywhere else. Observe that
A(7) C = 0. Let C = P2−1 CP2 , where P2 is the column permutation from A(7) into A(7) . Then the equality
A(7) C = 0 follows.
If we group the consecutive rows and columns of C by blocks of size t(1 + mt) × t(1 + mt), then C can be considered
as a (t(1 + mt))2 -sized-block matrix C = (Ci,j ) with (i, j) ∈ [1, m(7) ] × [1, m(7) ]. Moreover, C has the band-shape
inherited from {Cκ }κ∈Υ . In particular.
• Ci,i , i ∈ [1, m(7) ], is a t(1 + mt) × t(1 + mt) upper triangular matrix where each coefficient in the diagonal is
coprime with n.
• Ci,i+k(7) , i ∈ [1, m(7) ], is a t(1 + mt) × t(1 + mt) lower triangular matrix where each coefficient in the diagonal
is coprime with the order of the group on which it is acting.18
18 The matrix is lower triangular and not only block lower triangular (with the blocks in the diagonal having determinant coprime
with n.) Indeed, the matrices J κ built using Lemma 29 are n-circular for blocks of size 1.

28

Bκ(3)

	

κ∈Υ

• Ci,j = 0 for i ∈ [1, m(7) ] and j ∈ [i + k (7) + 1, . . . , i − 1], indices modulo m(7) .
Strongly 1-representation for (A(7) , Gt ). We use a similar machinery as in [21, Lemma 4] to construct, assuming
m(7) ≥ k (7) + 2, a strongly 1-representation for (A(7) , G) denoted by (K, H).
t
Q
(7)
(7)
(7)
Let the hypergraph K have the vertex set V (K) =
κ∈Υ Gκ × [1, m ]. H has [1, m ] as its vertex set and m
(7)
(7)
(7)
(7)
(7)
(7)
edges ei = {i, . . . , i + k } mod m for i ∈ [1, m ] with ei coloured i. Since m ≥ k + 2, H has m pair-wise
distinct edges.
The edges in K (7) form a m(7) -partite (k (7) + 1)-uniform hypergraph. The edge ei = {gi , . . . , gi+k(7) }, with gj ∈
Gt × {j} ⊂ V (K), is coloured i and is labelled g if and only
(7)
i+k
X

Ci,j (gj ) = g.

j=i

These labels on the edges define a labelling function l : E(K) → Gt . Furthermore, the uniformity of the edges is
k (7) + 1 which is bounded by m(7) = |V (H)|. This shows RP1 from Definition 10 with χ1 = m(7) .
For RP2, observe that all the copies of H in K should contain one, and exactly one, vertex in each of the vertex
clusters Gt ×{j} in V (K). Given H0 ∈ C(H, K) with V (H0 ) = {g1 , . . . , gm(7) }, the labels on the edges e1 , . . . , em(7) of
H0 are given by (l(e1 ), . . . , l(em(7) ))⊤ = C(g1 , . . . , gm(7) )⊤ . Since A(7) C = 0, then (l(e1 ), . . . , l(em(7) )) ∈ S(A(7) , Gt ).
Let Q = {1}, rq (H0 ) = 1 for each H0 ∈ C(H, K) and p = 1. Then we define
r : C(H, K) −→ S(A(7) , Gt ) × Q
H0 = {e1 , . . . , em(7) } 7−→ (r0 (H0 ), rq (H0 )) = ((l(e1 ), . . . , l(em(7) )), 1) .
We claim that r induces a strong 1-representation for some c bounded by a function of m(7) . Let (x1 , . . . , xm(7) ) =
(7)
x ∈ S(A(7) , Gt ) be a solution. For each i ∈ [1, m(7) ], there are |Gt |k edges labelled xi . Indeed, as Ci,i is a block
with determinant coprime with the order of the group Gt , for any choice of the vertices {gi+1 , . . . , gi+k } there is a
Pi+k(7)
Pi+k(7)
−1
(xi − j=i+1 Ci,j (gj )).19
unique vertex gi ∈ G × {i} such that j=i Ci,j (gj ) = xi , namely gi = Ci,i

Given the solution x and an edge ei coloured i and labelled xi in K, there is a unique H0 , copy of H in K, with
r0 (H0 ) = x and ei ∈ H0 . Indeed, if ei has the vertices {gi , . . . , gi+k(7) } as its support, then there exists a unique
gi−1 ∈ Gt × {i − 1} ⊂ V (K) such that l({gi−1 , . . . , gi+k(7) −1 }) = xi−1 . This process can be repeated a total of
m(7) − k (7) − 1 times. Indeed, the vertices gi−1 , gi−2 , . . . , gi+k(7) +1 that complete, together with gi , . . . , gi+k(7) , a
copy of H in K can be uniquely determined using the coordinate values xi−1 , . . . , xi+k(7) +1 of the solution x and a
subset of the previously determined vertices.
Let H0 denoted this copy of H in K. By the existence of r, r0 (H0 ) ∈ S(A(7) , Gt ). Even more, we claim that
r0 (H0 ) = x. Indeed, by the n–circularity of A(7) , any m(7) − k (7) consecutive values of {xj } determines the
solution. The copy H0 has been constructed so that it contains edges labelled with the m(7) − k (7) consecutive
values xi , xi−1 , . . . , xi+k(7) +1 and coloured appropriately with {i, i − 1, . . . , i + k (7) + 1}. Since the only solution
y ∈ S(A(7) , Gt ) that satisfies (y)j = xj for j ∈ {i, i − 1, . . . , i + k (7) + 1} is y = x and r0 (H0 ) ∈ S(A(7) , Gt ), then
r0 (H0 ) = x.
Hence, given x ∈ S(A(7) , Gt ) and i ∈ [1, m(7) ], each copy of ei coloured i and labelled xi can be extended to a unique
copy of H in K related to x. This shows RP3 and RP4. Moreover, the number of copies of H related to x in K is
(7)

|r

−1

t k(7)

(x, 1)| = |G |

|Gt |k +1
=
=
|Gt |



1
m(7)

k(7) +1

(7)

(7)

|K|k +1
|K|k +1
=
c
|Gt |
|Gt |

(7)

as there are |Gt |k edges labelled (x)i for any i ∈ [1, m(7) ]. This shows RP2 and finishes the strong 1-representation
for (A(7) , Gt ) by (K, H).
Relation with previous systems. Observe that each of the systems {(Jκ , Gtκ )}κ∈Υ have one more equation
and two more variables than (A(6) , Ztn ) and that (A(7) , Gt ) have the same number of equations and variable as any
(J κ , Gtκ ). Thus, A(7) has dimensions k (7) = (4k (6) + 5)(m(6) − k (6) + 1) and m(7) = (4k (6) + 6)(m(6) − k (6) + 1) over Gt .
19 All

−1
the rational numbers appearing in Ci,i
have denominators co-prime with |Gt |, hence inducing automorphisms in G.

29

If xi is a variable in (A(7) , Gt ), then it can be decomposed into t variables x(i,j) ∈ G with j ∈ [1, t]. Furthermore,
each x(i,j) can be understood as formed by mt + 1 variables x(i,j),κ ∈ Gκ , where κ ∈ Υ.
Remark 31. The system (A(7) , Gt ) is µ-equivalent to (A(6) , Ztn ) with the injection
σ : [1, m(6) ] −→ [1, m(7) ]

4(i − 1)(m(6) − k (6) + 1) + 3(m(6) − k (6) + 1) + 1
i 7−→
(4k (6) + 5)(m(6) − k (6) + 1) + i − k (6)

if i ∈ [1, k (6) ]
if i ∈ [k (6) + 1, m(6) ]

and
φ : S(A(7) , Gt ) −→ S(A(6) , Ztn )
(x1 , . . . , xm(6) ) 7−→ (φ1 (xσ(1) ), . . . , φm(6) (xσ(m(6) ) ))
with
φi (x(σ(i),j) ) =



P
di,j
P κ∈Υ x(σ(i),j),κ
κ∈Υ x(σ(i),j),κ

for i ∈ [1, k (6) ]
,
for i ∈ [k (6) + 1, m(6) ]

where di,j is the greatest common divisor of the j-th row of the block Bi(1) from A(6) = Itm


B (1) .20

Additionally, for any x ∈ S(A(6) , Ztn ) and i ∈ [1, m(6) ], the number of y ∈ S(A(7) , Gt ) with φ(y) = x and fixed (y)σ(i)
is independent of the (y)σ(i) ∈ φ−1
i ((x)i ).
Proof of Remark 31. The system (A(7) , Gt ) is formed by joining the systems {(J κ , Gtκ )}κ∈Υ together. The k (J’) ×m(J’)
system (J κ , Gtκ ) is 1-auto-equivalent to (Jκ , Gtκ ) by Remark 30 for any κ ∈ Υ.21 Let φ′κ be the map defining the
1-auto-equivalence from S(J κ , Gtκ ) to S(Jκ , Gtκ )
Any solution x ∈ S(A(7) , Gt ) induces (mt + 1) solutions xκ ∈ S(J κ , Gtκ ) and vice-versa. By the 1-auto-equivalence,
these solutions can be seen in (Jκ , Gtκ ) considering xκ = φ′κ (xκ ) ∈ S(Jκ , Gtκ ). We use the maps fκ from Remark 27
to conclude that
X
φ(x) =
fκ (xκ ) ∈ S(A(6) , Ztn )
κ∈Υ

as φ is the sum over Υ of the compositions of the homomorphisms fκ with the φ′κ .

Since the homomorphism f(1,0) associated to (J(1,0) , Ztn ) = (J(1,0) , Gt(1,0) ) is surjective, so is φ.22 As φ is a homomorphism, φ is µ-to-1 for µ = |S(A(7) , Gt )|/|S(A(6) , Ztn )|.
Let us show the second part of the result for x ∈ S(A(6) , Ztn ). Given yκ ∈ S(Jκ , Gtκ ), (yκ )i ∈ Gtκ , i ∈ [1, m(J) ], denotes
the i-th coordinate of yκ and (yκ )i,j ∈ Gκ denotes the (i, j)-th coordinate of the solution with (i, j) ∈ [1, m(J) ]×[1, t].
Any collection of solutions yκ ∈ S(Jκ , Gtκ ) induce a unique y ∈ (A(7) , Gt ). The variables indexed in [k (6) + 1, m(6) ]
parameterize the solutions in S(A(6) , Ztn ). Therefore, if we have
X
(x)i =
(yκ )i+1 , for all i ∈ [k (6) + 1, m(6) ]
(8)
κ∈Υ

for our selected x, then φ(y) = x. The condition (8) is also necessary; if the collection of solutions {yκ }κ∈Υ inducing
y does not satisfy (8) for some index i ∈ [k (6) +1, m(6) ], then φ(y) 6= x. The variables that parameterize the solutions
for any system (Jκ , Gtκ ) are those indexed in [k (J) + 1, m(J) ]; once the value of (yκ )i is selected for i ∈ [k (J) + 1, m(J) ],
the solution yκ ∈ S(Jκ , Gtκ ) exists and is unique. As the proof of Remark 27 highlights, the variable m(J) does not
appear in (8); the value of φ(y) is independent of the values (yκ )m(J) for κ ∈ Υ.
Pick an i ∈ [k (6) + 1, m(6) ] and a value for (y)i+1 ∈ Gt such that φi ((y)i+1 ) = (x)i . All the solutions y ∈ S(A(7) , Gt )
with φ(y) = x can be found by selecting a value for the remaining parameterizing variables (y)i1 with i1 ∈ [k (J) +
1, m(J) ]\{i+1} appropriately to configure a solution in S(A(7) , Gt ) with φ(y) = x. For i1 ∈ [k (J) +1, m(J) −1]\{i+1},
we can select any (y)i1 ∈ Gt as long as
X
(x)i1 −1 =
(yκ )i1 = φi1 −1 ((y)i1 ).
κ∈Υ

20 See

Section 5.4.
Indeed, (J κ , Gtκ ) is built from (Jκ , Gtκ ) by adding some variables and the same number of equations in a way that the new equations
are: new variable equal linear equation involving old variables. Therefore, a projection onto the right variables using the identity as
maps φi configure the application φ of the 1-auto-equivalence.
22 Observe that S(J , Gt ) contains the trivial solution 0 and {f }
κ
κ κ∈Υ are homomorphisms.
κ
21

30

Additionally, we can select any value for (y)m(J) . Observe that the number of choices is independent on the
particular value (y)l+1 with φl ((y)l+1 ) = (x)l we have picked.
Given x ∈ S(A(6) , Ztn ), i ∈ [1, k (6) ] and any y (i) ∈ Gt with φi (y (i) ) = (x)i we shall find all the solutions y ∈ S(A(7) , Gt )
with φ(y) = x and (y)i = y (i) . For κ ∈ [1, m] × [1, t], select any solution yκ′′′ ∈ S(Jκ , Gtκ ) such that
(yκ′′′ )i = yκ(i) .

(9)

′
Pick an auxiliary solution y(1,0)
∈ S(J(1,0) , Gt(1,0) ), defined by the last m(J) − k (J) variables,
′
• choosing a value for (y(1,0)
)m(J) in Ztn (any value.)
P
′
• (y(1,0)
)j+1 = (x)j − κ∈Υ\{(1,0)} (yκ′′′ )j+1 for j ∈ [k (6) + 1, m(6) ].

′
Let y′ be the solution in S(A(7) , Gt ) defined by the mt + 1 solutions {y(1,0)
, {yκ′′′ }κ∈Υ\{(1,0)} }. Observe that
φ(y′ ) = x. Indeed, for j ∈ [k (6) + 1, m(6) ],
X
X
X
′
(yκ′′′ )j+1 = (x)j .
(yκ′′′ )j+1 +
(yκ′′′ )j+1 = (x)j −
)j+1 +
φj (y′ ) = (y(1,0)
κ∈Υ\{(1,0)}

κ∈Υ\{(1,0)}

κ∈Υ\{(1,0)}

Since φ(y′ ) ∈ S(A(6) , Ztn ) and x is unique given the value of its last m(6) − k (6) variables, the claim follows and we
have a solution y′ ∈ S(A(7) , Gt ) such that φ(y′ ) = x.
However, it is not yet clear that (y)i = y (i) ; by (9), we know this equality holds for all coordinates in Υ \ (1, 0).
(i)
′
′
If y(1,0)
would be such that (y(1,0)
)j = y(1,0) , then the solution y′ ∈ S(A(7) , Gt ) defined before satisfies the claims
φ(y′ ) = x and (y′ )i = y (i) . Let us define ǫi,j = ǫi,j (x, {yκ′′′ }κ∈Υ\{(1,0)} , y (i) ), for j ∈ [1, t], as the difference between
(i)

′
the j-th components of the i-th coordinate of y(1,0)
and its aimed value (y(1,0) )j :
(i)

′
(y(1,0)
)i,j − (y(1,0) )j = ǫi,j (x, {yκ′′′ }κ∈Υ\{(1,0)} , y (i) ).

Observe that ǫi,j ∈ Gi,j . Indeed,
(φi (y (i) ))j = di,j

X

(yκ(i) )j

κ∈Υ

!

= (x)i,j

φ(y′ )=x

=



′
(φi (y′ ))j = di,j (y(1,0)
)i,j +



(i)
′
)i,j − (y(1,0) )j = 0 as claimed.
Therefore di,j ǫi,j = di,j (y(1,0)

X



(yκ(i) )j  .

κ∈Υ\{(1,0)}

(j)

Using ǫi,j we pick, one for each j ∈ [1, t], a total of t auxiliary solutions y(1,0) ∈ S(J(1,0) , Gt(i,j) ) ⊂ S(J(1,0) , Gt(1,0) ),
such that
(j)

• (y(1,0) )m(J) = 0.
(j)

• (y(1,0) )i,j = ǫi,j .
(j)

• (y(1,0) )i,r = 0 for r ∈ [1, t] 6= j.23
(j)

(3)
These {y(1,0) }j∈[1,t] exist because the greatest common divisor of the coefficients of the ((i − 1)t + j)-th row of B(1,0)
from J(1,0) , that define the (i, j)-th variable, is 1.

′′
′′
Consider the collection of t solutions {y(i,j)
}j∈[1,t] , y(i,j)
∈ S(J(i,j) , Gt(i,j) ), that are determined by sharing the last
(j)

(j)

′′
′′
)i = 0 since
)r = (y(1,0) )r for r ∈ [k (J) + 1, m(J) ]. Observe that (y(i,j)
m(J) − k (J) variables with y(1,0) : (y(i,j)
j
′′
′′
′′
• (y(i,j)
)i,j = 0 as (y(i,j)
)i,j = (y(i,j)
)m(J) ,1 = (y(1,0)
)m(J) ,1 = 0.
23 There

(J)

are |Gt(i,j) |m

−k(J) −2

such solutions for each j ∈ [1, t] by Observation 25. We only select one per each j.

31

(j)

′′
• For r 6= j, the equations defining (y(i,j)
)i,r and (y(1,0) )i,r from the last m(J) − k (J) variables are the same.
(j)

′′
)i,r .
Since (y(1,0) )i,r = 0, then so is (y(i,j)

Let y be the solution in S(A(7) , Gt ) formed by
• yκ = yκ′′′ for κ ∈ ([1, m] \ {i}) × [1, t].
• yκ = yκ′′ + yκ′′′ for κ ∈ {i} × [1, t].
Pt
(j)
′
• y(1,0) = y(1,0)
− j=1 y(1,0) .
Observe that
(j)

′′
∈ S(J(i,j) , Gt(i,j) ) for all
• for κ ∈ Υ, yκ ∈ S(Jκ , Gtκ ) as y(1,0) ∈ S(J(1,0) , Gt(i,j) ) ⊂ S(J(1,0) , Gt(1,0) ) and y(i,j)
j ∈ [1, t].

• φ(y) = x as φ(y) ∈ S(A(6) , Ztn ) and, for r ∈ [k (6) + 1, m(6) ],
X
X
(y(i,j) )r+1
(yκ )r+1 +
φr (y) = (y(1,0) )r+1 +
j∈[1,t]

κ∈([1,m]\{i})×[1,t]

′
)r+1 −
= (y(1,0)

t
X

(j)

(y(1,0) )r+1 +

j=1

X

+

(yκ′′′ )r+1 +

′
= (y(1,0)
)r+1 +

′′′
′′
)r+1
)r+1 + (y(i,j)
(y(i,j)

j∈[1,t]

κ∈([1,m]\{i})×[1,t]

X

X 



(yκ′′′ )r+1 = (x)r

κ∈Υ\{(1,0)}
(i)

′′
• (y)i = y (i) . Indeed, for κ ∈ ([1, m] \ {i}) × [1, t], (yκ )i = (yκ′′′ )i = yκ by hypothesis. Since (y(i,j)
)i = 0,
(i)

′′
′′′
(y(i,j) )i = (y(i,j)
)i + (y(i,j)
)i = y(i,j) for j ∈ [1, t]. Additionally, for each j ∈ [1, t],

′
)i,j −
(y(1,0) )i,j = (y(1,0)

t
X

(j)

(r)

(i)

′
′
)i,j − ǫi,j = (y(1,0) )j .
)i,j − (y(1,0) )i,j = (y(1,0)
(y(1,0) )i,j = (y(1,0)

r=1

Therefore, the set of solutions {yκ }κ∈Υ provides a unique solution y with φ(y) = x and (y)i = y (i) as desired.
Using Observation 25 on the matrices Jκ , the number of choices made to find y is independent of the particular
y (i) . Even more, the excesses ǫi,j define a quotient structure among the possible choices of {yκ′′′ }κ∈Υ\{(1,0)} and
(j)

′
value for (y(1,0)
)m(J) (the other choices for the solutions y(1,0) can be thought to be fixed depending on ǫi,j .) This
finishes the proof of the remark.

Remark 32. Since the system is n–circular and |G| is a divisor of nα , for some positive integer α, Si (A(7) , Gt ) = Gt
for all i ∈ [1, m(7) ].

5.9

Observation on adding variables

The number of variables in A(7) , as well as its relative order, is the same as for matrix J κ . This is, the i-th variable
in J κ , seen as a system (J κ , Gtκ ), is one of the coordinates that configure the i-th variable in the system (A(7) , Gt ).
The hypergraph H used in the representation of (A(7) , Gt ) can be obtained in the following way. Consider the
original k × m system (A, G0 ). Let H0 be a (k + 1)-uniform hypergraph over the vertex set V = {v1 , . . . , vm }
with edges ei = {vi , . . . , vi+k }, indices modulo m. Let us pair the edge ei with the i-th variable of A, xi . Let
ei = {vi , . . . , vi+k } and ej = {vj , . . . , vj+k } be the edges associated with xi and xj respectively. The variable xi is
said to be before xj if vj ∈ ei . If xi is before xj then the variables xi+1 , . . . , xj−1 are said to be in-between xi and
xj .
32

Assume that (A′ , G′ ) is built from (A, G0 ) by adding a new variable and a new equation. Let H1 denote the
hypergraph associated with (A′ , G′ ) as described in the procedure above. Alternatively, H1 can be constructed
from H0 as follows. When a new variable xl is added to the system (A, G), a new vertex vm+1 is added to V (H). If
a new equation is added, the uniformity of the edges increases by 1. The edges e1 , . . . , el−1 in H1 start at the same
point as the corresponding edges in H0 and have one more vertex in them. The edges el+1 , . . . , em+1 in H1 start
one vertex later and have one additional vertex than the corresponding ones in H0 (they finish two vertices later
than el , . . . , em in H0 .) In particular, if two edges ei and ej , with associated variables xi and xj , share a vertex in
H0 and xi is before xj , then the corresponding edges in H1 share the same number of vertices if the new variable
xl is between xi and xj .24 If the added variable xl is not between them, then the corresponding edges to ei and ej
in H1 share an additional vertex. Moreover, some edges that did not share any vertex in H0 , may share a vertex in
H1 .
If (A′ , G′ ) is built from (A, G0 ) by adding only a new variable, then H1 is built from H0 by adding a new vertex
vm+1 but not increasing the uniformity of the edges. If xi is before xj in H0 and the new variable xl is between xi
and xj , then ei and ej+1 , the edges corresponding to xi and xj in (A′ , G′ ) intersect in one vertex less. Otherwise,
the intersection between the new edges does not change with respect to the intersection of the corresponding edges
in H0 .
Observe that the hypergraph H provided by the procedures from Section 5.8 to represent (A(7) , Gt ) can be thought
of as coming from an embryonal cycle H0 as described above. Let H2 be the hypergraph obtained from H by
removing the edges related to the added variables from (A, G0 ) to (Jκ , Gtκ ). Observe that most of the added
variables involve the addition of equations. In these cases, removing the edges from H represents no problems in
terms of connectedness of H2 . However, some variables were added without the addition of any equation. Those
free variables correspond to the parts of the construction dealing with γ 6= 1, Section 5.5, and to simulate the
independent vectors in Section 5.2. Since the number of variables used in the simulation of the independent vectors
is less than k, the k + 1-uniformity of the hypergraph embryo H0 allows H2 to be connected.
The remaining cases involve the additional variable added in Section 5.5 to each of the systems (Jκ , Gtκ ) with respect
to (A(6) , Ztn ). Since m(6) − k (6) ≥ 2, the procedure from Section 5.7 ads at least four variables between any pair
of the first k (J) variables from (Jκ , Gtκ ). Notice that the first k (6) variables of Jκ contains the original set of m
variables of (A, G0 ). Hence, the set of added variables is non-empty and well distributed throughout the original set
of variables, with several variables placed in-between original ones and others before, increasing the connectedness.
This justifies that H2 is connected and supported over the same set of vertices as H.

5.10

From the representation of (A(7) , Gt ) to (A, Ztn )

Let us summarize the steps followed to construct
(A(7) , Gt ) and its relation with the previous systems. Recall that
Qt
the original homomorphism system (A′ , i=1 Zni ) = (A0 , G0 ) has dimensions k × m. Moreover, we assume that
m ≥ k + 2.
From
(A0 , G0 )
(A, Ztn )
(A(1) , Ztn )

To
(A, Ztn )
(A(1) , Ztn )
(A(3) , Ztn )

Relation
µ-equivalent 1
equivalent
µ-auto-equiv.

(A(3) , Ztn )

(A(4) , Ztn )

1-auto-equiv.

(A(4) , Ztn )
(A(5) , Ztn )

(A(5) , Ztn )
(A(6) , Ztn )

equivalent
1-auto-equiv.

(A(6) , Ztn )

(Jκ , Gtκ ),
with κ ∈ Υ
J κ , Gtκ ,
with κ ∈ Υ
(A(7) , Gt )

splitting

(A(7) , Gt )

µ-equivalent 2

(Jκ , Gtκ ),
with κ ∈ Υ

J κ , Gtκ
with κ ∈ Υ
(A(6) , Ztn )
24 Here

1-auto-equiv.
joining

Dimensions
k eq., m var.
k eq., m var.
k eq.,
m + k = m(3) var.
m(3) eq.,
2m(3) − k (3) var.
m(3) × 2m(3) − k (3)
k (5) eq., m(5) var.

k (6) + 1 eq.,
m(6) + 2 var. each
k (J’) eq.,
m(J’) var. each
k (J’) = k (7) eq.,
m(J’) = k (7) var.
k (7) eq.,
m(7) var.

Description
Q
From G0 = ti=1 Zni to Ztn1
row reduction
from determinantal n to 1, independent vector simulation
determinantal 1
to determinant 1

row reduction to Im(3) B
row-reduce t-row blocks in B;
product of gcd of the rows is
the determinantal of the block

find systems Jκ = Ik(6) B
with Dt (B[ti+1,ti+t] ) = 1
find n-circular systems
for (Jκ , Gtκ )
group the systems (J κ , Gtκ )
in a single one
conclusion from joining
the systems

xl is assumed to be between the variables corresponding to xi and xj in H1 .

33

In
4.2
5.2
5.2
5.3
5.3
5.4

5.5
5.7
5.8
5.8

Where k (J’) = (4k (J) + 1)(m(J) − k (J) ), m(J’) = (4k (J) + 2)(m(J) − k (J) ), and G =

Q

κ∈Υ Gκ .

We prove the first part of Theorem 2 under the conditions m ≥ k + 2 by concatenating Proposition 15, 14, 13 and
12 between the different pairs of µ-equivalent systems appropriately. For instance we shall use
• Proposition 15 from (A(7) , Gt ) to (A(6) , Ztn ) by Remark 31.
• Proposition 12 from (A(6) , Ztn ) to (A(5) , Ztn ) by Remark 26.
• No proposition is needed from (A(5) , Ztn ) to (A(4) , Ztn ) as they are equivalent.
• Proposition 12 from (A(4) , Ztn ) to (A(3) , Ztn ) by Remark 24.
• Proposition 13 from (A(3) , Ztn ) to (A(1) , Ztn ) by Remark 22.
• Proposition 14 from (A(1) , Ztn ) to (A0 , G0 ) by Remark 18 (with A(1) = A′ and (A0 , G0 ) = (A, G).)
These propositions can be concatenated by Section 5.9. Indeed, the edges related to the remaining variables, after
the composition of the maps defining the µ-equivalences, still cover all the vertices of the initial hypergraph H.
Thus this shows the following proposition.
Proposition 33 (Representation for homomorphisms). Let G be a finite abelian group and let m, k be two positive
integers with m ≥ k + 2. Let A be a homomorphism A : Gm → Gk and let b ∈ Gk be given. Then the system of
linear configurations ((A, b), G) is γ-strongly-representable with γi = |G|/|Si (A, G)| and where χ1 , χ2 depend only
on m.
By means of Theorem 1, Proposition 33 proves the first part of Theorem 2 when m ≥ k + 2. The second part of
Theorem 2 and the treatment of the cases when m < k + 2 are proved in Section 6.

6

Proof of Theorem 2: second part and the cases m < k + 2

The cases where k > m can be reduced to m = k by eliminating the redundant equations (for instance, thinking
of them as equations in Zn using Section 4.2 and Section 5.1 and performing Gaussian elimination on the matrices
only allowing integer operations.)
Qm
Qm
Let G0 be a finite abelian group. If the system Ax
= 0, x ∈ i=1 Xi , with |S (A, G0 , i=1 Xi )| < δ|S(A, G0 )| has
Q
m
k equations and m variables, then A′ x = 0, x ∈ i=1 Xi × G20 , with

 
 |G0 | |G0 |

  0
0 

 
A′ = A  .
.. 
.


. 
 .
 0
0


Qm
has k equations in m + 2 variables and S A′ , G0 , i=1 Xi × G20  < δ|S(A′ , G0 )|. Therefore, the cases m < k + 2
can be proved using the second part of Theorem 2 restricted to the case m ≥ k + 2. This is encapsulated in
Observation 34.
Observation 34 (Do not remove from full sets). Assume that the γ-representation of the k × m homomorphism
system (A, G0 ), with m ≥ k + 2, is constructed using a system with an n–circular matrix (A(7) , G) by the methods
exposed in sections 4.1 through 5.10. Let I ⊂ [1, m] be a set of indices such that Xi = G0 , i ∈ I. Then Theorem 2
holds with Xi′ = ∅.
Proof of Observation 34. Suppose m ≥ k + 2. By reordering the variables, assume that I = [j, m] for some j.
Represent the system (A, G0 ) by the s-uniform hypergraph pair (K0 , H). By the construction in Section 5.8 and
Section 5.10 and the comments in Section 5.9, H is connected and K0 isQ|H|-partite. Let V1 , . . . , V|H| denote the
m
stable sets in K0 and recall that |Vi | = |Vj | for i, j ∈ [1, |H|]. Let K = K0 ( i=1 Xi ) represent the hypergraph where
′
′
only the edges labelled xi ∈ Xi and colored i appear. Let K and H be the hypergraphs obtained by removing the
edges colored i ∈ [j, m] from K and H respectively. Assume e1 = {1, . . . , s} ⊂ H is the edge related to x1 .
34

Let d be the number of vertices in H ′ with no edges. By the construction of the representation from the n–circular
matrix provided in the third part of Section 5.8 and knowing that the deleted edges have the largest indices, the
stable sets Vi (clusters of vertices) of K ′ with no edge incident with them are the consecutive ones V|H|−d+1 , . . . , V|H| .
Since every subset of s clusters from K ′ span, at most, one color class of edges, the connected component of H ′ has
one vertex in each of the first |H|− d clusters. The isolated vertices of H ′ can be placed in any cluster Vi , i ∈ [1, |H|].

Q
|K|−(|H|−d)
Thus, each copy of H in K ( m
≈ c′ |K|d copies of H ′ in K ′ , for some constant c′ .
i=1 Xi ) generates
d
Let H ′′ be the hypergraph built from H ′ by removing its isolated vertices. Let K ′′ be built from K ′ by removing the
isolated stables V|H|−d+1 , . . . , V|H| . Then (K ′′ , H ′′ ) is a representation of the system (A, G0 ) where (x1 , . . . , xj−1 )
is a solution if and only if there is some (xj , . . . , xm ) ∈ Gm−j+1
0
 for which (x1 , . . . , xj−1 , xj , . . . , xm ) is a solution.
Q|H|

′′
′′
Indeed, we can extend any copy H in K to  i=|H|−d+1 Vi  = |Vi |d = c|K|d copies of H in K by selecting one
additional vertex in each of the last d clusters. Since Xi = G0 , K has all the possible edges coloured i ∈ I in
the vertices {(·, j)}j∈{i1 ,...,is } , where {i1 , . . . , is } is the support of the edge coloured i in H. Therefore, any choice
Q|H|
in i=|H|−d+1 Vi completes a copy of H ′′ in K ′′ to a copy of H in K. On the other hand, any copy of H in K
generates one copy of H ′′ in K ′′ . Thus,
|C(H, K)| = |C(H ′′ , K ′′ )| |Vi |d = |C(H ′′ , K ′′ )| c|K|d
′′

and the proportions |K||H| /|C(H, K)| and |K ′′ ||H | /|C(H ′′ , K ′′ )| are such that
′′

|K||H|
|K ′′ ||H |
|K||H|
=
= c′′
d
′′
′′
|C(H, K)|
c|K| |C(H , K )|
|C(H ′′ , K ′′ )|
where c′′ only depends on m.
Qj−1
)| < δ|S(A, G0 )|, then, by the representability for (A, G0 ) by (K, H),
Therefore, if |S(A, G0 , i=1
Xi × Gm−j+1
0
′′
′
|H|
′′
′′
|C(H, K)| < δ |K| . Hence |C(H , K )| < δ ′′ |K ′′ ||H | . By applying the same procedure of Theorem 1 to
(K ′′ , H ′′ ), we show a removal lemma by obtaining sets Xi′ ⊂ Xi , i ∈ [1, j − 1], as those are the represented variables,
Qj−1
such that i=1 Xi \ Xi′ has no solution (for any value of the last variables.) Therefore, we obtain the additional
property that Xi′ = ∅ for i ∈ [j, m].
Let us observe that Observation 34 can be used to obtain a similar additional conclusion for [21, Theorem 1].

7

Conclusions and final comments

In this paper we have presented Definition 10, a notion of representation of a system of configurations using a
pair of hypergraphs that generalizes previous definitions. Additionally, the notion is strong enough to translate the
combinatorial removal lemma, Theorem 11, to the context of system of configurations, Theorem 1. We observe
that the systems of configurations induced by “copies of a hypergraph H in K” is representable. Additionally, we
present a representation for the systems induced by “patterns of the permutation τ in the permutation σ”.
The extra flexibility given by Definition 10 with respect to previous notions allows us to show that the configuration
systems defined by homomorphisms between finite abelian groups are representable (see Proposition 33). The
combination of Proposition 33 and Theorem 1 is reflected in the removal lemma for homomorphism systems of
finite abelian groups, Theorem 2, which is the main result of the paper. Several applications of Theorem 2 are given
in the introduction.
In [5], a more algebraic definition of representation tied with the infinite aspect of the compact abelian groups is
presented as [5, Definition 3.7], which follows the lines of [34]. Indeed, the strong version of Definition 10 can be
seen as the discrete and combinatorial analogue of [5, Definition 3.7]. Let us mention that the construction of the
representation for the homomorphisms of finite abelian groups presented in sections 4-6 can be adapted to fit [5,
Definition 3.7]. It is natural to ask if a removal lemma result holds for homomorphisms in compact abelian groups.
However, such result presents technical difficulties involving some aspects of the construction presented here that
arise when generic compact abelian groups are considered.25
25 These

difficulties are related with the extension of matrices performed in Section 5.7.

35

Acknowledgements
The author wants to thank Oriol Serra, Balázs Szegedy and Pablo Candela for fruitful discussions, improvement
suggestions as well as carefully reading the manuscript.

References
[1] N. Alon, A. Shapira. Testing subgraphs in directed Graphs. Journal of Computer and System Sciences 69 (3)
(2004), 354–382.
[2] T. Austin, T Tao. Testability and repair of hereditary hypergraph properties. Random Structures and Algorithms 36 (4) (2010), 373–463.
[3] P. Candela. Developments at the interface between combinatorics and Fourier analysis. (2009), Ph. D. Thesis,
University of Cambridge, United Kingdom.
[4] P. Candela, O. Sisask. A removal lemma for linear configurations in subsets of the circle. Proc. Edinb. Math.
Soc. (2) 56 (2013), no. 3, 657–666.
[5] P. Candela, B. Szegedy, L. Vena. On linear configurations in subsets of compact abelian groups, and invariant
measurable hypergraphs. arXiv:math/1408.6753 [math.CO], (2014).
[6] J. Cooper, A Permutation Regularity Lemma, The Electronic Journal of Combinatorics 13 (1), (2006), Research
Paper 22, 20 pp.
[7] G. Elek, B. Szegedy. A measure-theoretic approach to the theory of dense hypergraphs. Adv. Math., 231
(2012), 3-4, 1731–1772.
[8] P. Erdős, P. Frankl, V. Rödl. The asymptotic number of graphs not containing a fixed subgraph and a problem
for hypergraphs having no exponent. Graphs Combin. 2 (2) (1986), 113–121.
[9] P. Erdős, R. L. Graham, P. Montgomery, B. L. Rothschild, J. Spencer. Euclidean Ramsey theorems. I. Journal
of Combinatorial Theory. Series A (1973) (14), 341-363.
[10] P. Frankl, V. Rödl. Extremal problems on set systems. Random Structures and Algorithms (2002) 20 (2),
131–164.
[11] Z. Füredi. Extremal hypergraphs and combinatorial geometry. Proceedings of the International Congress of
Mathematicians, Vol. 1, 2 (Zrich, 1994), 1343–1352, Birkhuser, Basel, 1995.
[12] H. Furstenberg, Y. Katznelson. An ergodic Szmereédi theorem for commuting transformations. Journal
d’Analyse Mathmatique 34 (1978), 275–291 (1979).
[13] R. L. Graham, B. L. Rothschild, J. Spencer. Ramsey Theory. Second edition, Wiley-Interscience Series in
Discrete Mathematics and Optimization. A Wiley-Interscience Publication. John Wiley & Sons, Inc., New
York, 1990.
[14] T. Gowers. Hypergraph regularity and the multidimensional Szemerédi theorem. Annals of Mathematics, Second Series (2007) vol. 166 (3) pp. 897–946.
[15] B. Green. A Szemerédi-type regularity lemma in abelian groups, with applications. Geometric and Functional
Analysis 15 (2) (2005), 340–376.
[16] Y. Ishigami. A Simple Regularization of Hypergraphs. arXiv:math/0612838 [math.CO], (2006).
[17] J. Komlós, A. Shokoufandeh, M. Simonovits, E. Szemerédi, The regularity lemma and its applications in graph
theory, Theoretical aspects of computer science (Tehran, 2000), Lecture Notes in Comput. Sci., 2292, 84–112.
[18] L. Komlós, M. Simonovits. Szemerédi’s regularity lemma and its applications in graph theory. Combinatorics,
Paul Erdős is eighty, Vol. 2 (Keszthely, 1993), 295–352, Bolyai Soc. Math. Stud., 2, János Bolyai Math. Soc.,
Budapest, 1996.
[19] D. Král’, O. Serra, L. Vena. A removal lemma for linear systems over finite fields. Sixth Conference on Discrete
Mathematics and Computer Science (VI JMDA), 417–423, Univ. Lleida, Lleida, 2008.
36

[20] D. Král’, O. Serra, L. Vena. A combinatorial proof of the removal lemma for groups. Journal of Combinatorial
Theory, Series A 116 (4) (2009), 971–978.
[21] D. Král’, O. Serra, L. Vena. On the removal lemma for linear systems abelian groups. European Journal of
Combinatorics 34 (2013), 248–259.
[22] D. Král’, O. Serra, L. Vena. A removal lemma for systems of linear equations over finite fields. Israel Journal
of Mathematics 187 (2012), 193–207.
[23] B. Nagle, V. Rödl, M. Schacht, The counting lemma for regular k-uniform hypergraphs, Random Structures
and Algorithms (2006) 28 (2), 113–179.
[24] M. Newman. Integral matrices. Academic Press, New York, 1972.
[25] V. Rödl, J. Skokan. Regularity lemma for k-uniform hypergraphs. Random Structures Algorithms. 25 (2004)(1),
1–42.
[26] B. Nagle, V. Rödl, M. Schacht. The counting lemma for regular k-uniform hypergraphs. Random Structures
and Algorithms 28 (2006) (2), 113–179.
[27] Roth, K. F., On certain sets of integers, J. London Math. Soc., 28 (1953), 104–109.
[28] I.Z. Ruzsa, E. Szemerédi. Triple systems with no six points carrying three triangles. Combinatorics (Proc. Fifth
Hungarian Colloq., Keszthely, 1976) (1978) vol. 18, 939–945.
[29] O. Serra, L. Vena. On the number of monochromatic solutions of integer linear systems on Abelian groups.
European J. Combin. 35 (2014), 459–473.
[30] D. Saxton, A. Thomason. Hypergraph containers. arXiv:1204.6595v2 [math.CO].
[31] D. Saxton, A. Thomason. Hypergraph containers. arXiv:1204.6595v3 [math.CO].
[32] A. Shapira. A proof of Green’s conjecture regarding the removal properties of sets of linear equations. J. Lond.
Math. Soc. (2010) 81 (2), 355–373.
[33] J. Solymosi. A note on a question of Erdős and Graham. Combinatorics, Probability and Computing (2004)
13 (2), 263–267.
[34] B. Szegedy. The symmetry preserving removal lemma. Proceedings of the American Mathematical Society
(2010) 138 (2), 405–408.
[35] E. Szemerédi. Regular partitions of graphs. Problèmes combinatoires et thorie des graphes (Colloq. Internat.
CNRS, Univ. Orsay, Orsay, 1976), pp. 399–401, Colloq. Internat. CNRS, 260, CNRS, Paris, 1978.
[36] T. Tao. A variant of the hypergraph removal lemma. Journal of Combinatorial Theory, Series A (2006) 113
(7), 1257–1280.
[37] T. Tao. Mixing for progressions in nonabelian groups. Forum Math. Sigma 1, (2013), e2, 40.
[38] P. Turán. Eine Extremalaufgabe aus der Graphentheorie. (Hungarian. German summary) Mat. Fiz. Lapok 48,
(1941), 436–452.
[39] B.L. van der Waerden. Algebra. Vol. II, 1991, Springer-Verlag, New York.
[40] L. Vena. The removal lemma for products of systems. Midsummer Combinatorial Workshop 2012, KAMDIMATIA Series. Available as http://kam.mff.cuni.cz/workshops/work18/mcw2012booklet.pdf.
[41] L. Vena. The regularity Lemma in additive combinatorics. Master’s Thesis supervised by O. Serra. Available
as http://hdl.handle.net/2099.1/4726.

37

