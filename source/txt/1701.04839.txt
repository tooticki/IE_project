arXiv:1701.04839v3 [math.AG] 8 May 2018

A NON-ARCHIMEDEAN OHSAWA–TAKEGOSHI EXTENSION THEOREM
MATTHEW STEVENSON

Abstract. We prove an Ohsawa–Takegoshi-type extension theorem on the Berkovich closed unit disc over
certain non-Archimedean ﬁelds. As an application, we establish a non-Archimedean analogue of Demailly’s
regularization theorem for quasisubharmonic functions on the Berkovich unit disc.

1. Introduction
The Ohsawa–Takegoshi theorem is one of the fundamental extensions theorems in complex geometry. Originating in the foundational paper [OT87] of Ohsawa–Takegoshi, many generalizations and improvements have
since been shown; see [Man93, Ber96, Siu96, Dem00, MV07]. Its many applications include Siu’s much-celebrated
proof [Siu98] of the deformation invariance of plurigenera. In its simplest form, the classical Ohsawa–Takegoshi
theorem asserts the following: given a plurisubharmonic function ϕ on the complex unit disc D, a point
z ∈ D\{ϕ = −∞}, and a value a ∈ C, there is a holomorphic function f on D such that f (z) = a and
Z
|f (x)|2 e−2ϕ(x) dλ ≤ π|f (z)|2 e−2ϕ(z) .
D

The constant π is optimal, as shown in [Blo13, Theorem 1]. There is also an adjoint formulation of the result,
which concerns the extension of a holomorphic 1-form rather than of a holomorphic function.
In [Ber90, Ber93], Berkovich introduced his theory of analytic spaces over a complete non-Archimedean ﬁeld.
In recent years, analogues of many theorems from complex geometry have been developed in the non-Archimedean
setting, notably the solution in [BFJ15] of a non-Archimedean Calabi–Yau-type problem. It is natural to ask
for an analogue of the Ohsawa–Takegoshi extension theorem in the non-Archimedean setting, as well.
Let k be a ﬁeld, complete with respect to a non-Archimedean absolute value | · |. Let k{T } denote the Tate
algebra in one variable over k, X = Ek (1) denote the Berkovich closed unit disc over k, and AX : X → [0, +∞]
denote Temkin’s canonical metric on the canonical bundle ωX/k (more concretely, AX is − log of the radius
function). For any quasisubharmonic function ϕ on X and analytic function f ∈ k{T }, consider the norm
kf kϕ := sup |f |e−ϕ−AX
X\Z(ϕ)

where Z(ϕ) := {ϕ = −∞}. The function ϕ + AX can be thought of as a metric on ωX/k and f as a global section
of ωX/k , so the norm kf kϕ measures the length of the section f in the metric ϕ + AX . See §2 for further details.
Our ﬁrst main result is a non-Archimedean version of the Ohsawa–Takegoshi extension theorem on the
Berkovich closed unit disc X = Ek (1).
Theorem A. Assume k is algebraically closed, trivially-valued, or is spherically complete of residue characteristic zero. Let ϕ be a quasisubharmonic function on X = Ek (1). For any z ∈ X, there exists a nonzero polynomial
f ∈ k[T ] such that
lim+ kf k(1+ǫ)ϕ ≤ |f (z)|e−ϕ(z) .
ǫ→0

If ϕ(z) = −∞, then we may find f such that limǫ→0+ kf k(1+ǫ)ϕ < +∞. Moreover, if k is algebraically closed
and z is a rigid point of X, then for any value a ∈ H(z)∗ = k ∗ , we may find f such that f (z) = a.
Date: May 9, 2018.
1

2

MATTHEW STEVENSON

To clarify the relationship between Theorem A and the adjoint formulation of the Ohsawa–Takegoshi extension
theorem, we must discuss the non-Archimedean analogues of (pluri)subharmonic functions and volume forms,
which arise in the statement of the latter. We are interested in the class of quasisubharmonic functions on the
Berkovich closed unit disc, which are the non-Archimedean analogue of (pluri)subharmonic functions on the
complex unit disc. These are brieﬂy discussed in §2.2; see [BR10, Jon15] for a comprehensive treatment.
On complex manifolds, volume forms naturally correspond to smooth metrics on the canonical bundle. The
non-Archimedean analogue of a metric on the canonical bundle has been examined by Temkin in [Tem16]. Temkin
produces a canonical lower-semicontinuous metric AX on the canonical bundle ωX/k of a k-analytic space X,
extending the weight function of Mustat, ă–Nicaise [MN15]. Temkin’s metric is discussed in §2.3. This is the
natural candidate to replace the volume form that appears in the statement of the classical Ohsawa–Takegoshi
theorem.
In Theorem A, a section is measured using the sequence of norms k · k(1+ǫ)ϕ as ǫ → 0+ instead of with the
single norm k · kϕ , which is what one might expect from the classical Ohsawa–Takegoshi theorem. The former
proves to give the correct analogy with the complex setting, as the following example demonstrates. Consider the
(pluri)subharmonic
function ϕ = α log |z|, with α > 0, on the complex unit disc D; then, it is elementary to check
R
that D e−2ϕ dλ < +∞ if and only if α < 1. Similarly, consider the quasisubharmonic function ϕ = α log |T |,
with α > 0, on the Berkovich unit disc X = Ek (1); then, limǫ→0+ k1k(1+ǫ)ϕ < +∞ if and only if α < 1.
As an application of Theorem A, we prove a regularization theorem for quasisubharmonic functions on the
Berkovich unit disc. Certain results in this direction already exist in the literature: in [Jon15, Theorem 2.10],
it was shown that any quasisubharmonic function on X is the decreasing limit of bounded quasisubharmonic
functions. A similar argument appears in [FRL06, §4.6]. However, these constructions use only the tree structure
on the Berkovich unit disc (in particular, they do not incorporate the analytic structure). It is therefore unlikely
that these proofs can be generalized to higher dimensions.
As inspiration, we use the much-celebrated regularization theorem of Demailly for a plurisubharmonic function
φ on a bounded pseudoconvex domain Ω ⊂ Cn . To a plurisubharmonic function φ on Ω and a positive integer
m, we associate the Hilbert space Hmφ of holomorphic functions on Ω satisfying the integrability condition
Z
|f |2 e−2mφ dλ < +∞.
Ω

The Demailly approximation associated to Hmφ is a plurisubharmonic function φm on Ω with analytic singu1
larities, and the sequence (φm )∞
m=1 converges pointwise and in Lloc to φ. See [Dem92] for further details.
We adopt the same philosophy in the non-Archimedean setting: to a quasisubharmonic function ϕ on X, we
associate the ideal Hϕ of the Tate algebra k{T } consisting of those analytic functions f satisfying the ﬁniteness
condition
−(1+ǫ)ϕ−AX
kf k+
< +∞
ϕ := lim+ sup |f |e
ǫ→0

X\Z(ϕ)

For each positive integer m, we deﬁne the non-Archimedean Demailly approximation ϕm by the formula
!∗
1
|f |
sup
log
ϕm :=
,
m f ∈Hmϕ \{0}
kf k+
mϕ
where (−)∗ denotes the upper-semicontinuous regularization. We show that ϕm is a quasisubharmonic function
with analytic singularities on X.
The ideal sheaf on X associated to Hϕ behaves like a non-Archimedean multiplier ideal associated to ϕ, and
may be of independent interest. This idea is brieﬂy explored in §4.2, where we show that Hϕ generates the
stalks of a locally-deﬁned multiplier ideal sheaf associated to ϕ. These multiplier ideals are used to show that
the ideals Hϕ satisfy a subadditivity property.
We prove the following non-Archimedean analogue of Demailly’s regularization theorem.

A NON-ARCHIMEDEAN OHSAWA–TAKEGOSHI EXTENSION THEOREM

3

Theorem B. Assume k is algebraically closed, trivially-valued, or is spherically complete with residue characteristic zero. If ϕ is a quasisubharmonic function on X with ϕ ≤ 0, then ϕ ≤ ϕm ≤ ϕ + AmX . In particular, the
sequence (ϕm )∞
m=1 converges pointwise to ϕ on {AX < +∞} ⊆ X.
In Theorem B, the crucial inequality ϕm ≥ ϕ is a consequence of Theorem A. In principle, a statement similar
to Theorem B ought to be possible in higher dimensions, but this would likely require a higher-dimensional version
of the Ohsawa–Takegoshi theorem on analytic spaces.
Nonetheless, there has been much work done on the development of pluripotential theory on analytic spaces.
Quite generally, Chambert-Loir and Ducros have introduced in [CLD12] the notion of continuous plurisubharmonic functions. In addition, semipositive metrics on line bundles were studied in detail by [Zha95, Gub98],
among others. On analytic curves, potential theory is well-established, due to the work of Thuillier [Thu05]. A
regularization theorem similar to Theorem B is proven in the higher-dimensional setting in [BFJ16, Theorem
B]. A related discussion appears in [BFJ08, §5].
The techniques involved in the proof of Theorem A rely crucially on the tree structure of the Berkovich
unit disc, and thus the proof does not, a priori, generalize to higher dimensions. More precisely, the proof
proceeds by ﬁrst constructing a ﬁnite subtree Γϕ of X that captures the worst of the singularities of ϕ, and
reducing to proving Theorem A on the convex hull of Γϕ ∪ {z}. For some end of the tree Γϕ , we construct a
new quasisubharmonic function φ such that Γφ ( Γϕ and reduce to proving Theorem A for φ. This inductively
reduces Theorem A to a simple case, which is solved directly.
The paper is organized as follows. In §2, we brieﬂy review the deﬁnition of the Berkovich unit disc, and its
potential theory. In §2.3, we discuss Temkin’s metric on the canonical bundle. In §3, we prove Theorem A and
a variant thereof. In §4, we construct the ideal Hϕ and the non-archimedean Demailly approximation ϕm associated to a quasisubharmonic function ϕ and a positive integer m ≥ 1. These are then used to prove Theorem B.
Acknowledgements. I would like to thank my advisor, Mattias Jonsson, for suggesting the problem and for his
invaluable help, guidance, and support. I would also like to thank Kiran Kedlaya, Jérôme Poineau, and Daniele
Turchetti for helpful conversations regarding Lemma 2.1. I am grateful to Takumi Murayama and Emanuel
Reinecke for their many comments on a previous draft. Finally, I would like to thank the anonymous referee
for their many helpful comments, and for pointing out an error in a previous version. This work was partially
supported by NSF grant DMS-1600011.
2. Preliminaries
Let k be a ﬁeld complete with respect to a (possibly trivial) non-Archimedean absolute value | · |, and let
K := kca denote its completed algebraic closure. Let k ◦ := {| · | ≤ 1} denote the valuation ring of k, and K ◦ the
valuation ring of K.
To establish conventions, we brieﬂy recall in §2.1 the deﬁnition of the Berkovich unit disc over a (not necessarily
algebraically closed) non-Archimedean ﬁeld k, and describe its points; in §2.2, we review the metric tree structure
and potential theory on the Berkovich unit disc. Finally, in §2.3, we discuss the canonical metric of Temkin on
the canonical bundle of a k-aﬃnoid space.
2.1. The Berkovich unitPdisc. The Tate algebra k{T } in the variable T is the subalgebra of k[[T ]] consisting
∞
of those power series f = i=0 ai T i , with ai ∈ k, such that |ai | → 0 as i → ∞. The Tate algebra is a Banach
k-algebra when equipped with the Gauss norm
|f (xG )| := max |ai |.
i≥0

See [BGR84, §5.1] for further details.
The Berkovich unit disc is the set X := M(k{T }) of multiplicative seminorms on the Tate algebra k{T }
which extend the absolute value on k and which are bounded above by the Gauss norm xG . When equipped

4

MATTHEW STEVENSON

with the topology of pointwise convergence, X is a compact Hausdorﬀ path-connected space. Let H(x) denote
the completed residue ﬁeld of x ∈ X.
Deﬁne a partial order ≤ on X by declaring that x ≤ y if and only if |f (x)| ≤ |f (y)| for all f ∈ k{T }; in
this way, the pair (X, ≤) becomes a rooted tree with root at the Gauss point xG . The tree structure on X is
discussed in more detail in § 2.2.
Let Gal(k a /k) denote the group of automorphisms of k a ﬁxing k (though k a /k is not Galois when k is not
perfect), and let XK := M(K{T }) denote the ground ﬁeld extension of X to K, which comes equipped with a
continuous surjective map π : XK → X. The ground ﬁeld extension XK carries a Gal(k a /k)-action, extending
∼
the natural action on K by isometries, such that π induces a homeomorphism XK /Gal(k a /k) −→ X, where
a
XK /Gal(k /k) has the quotient topology. See [Ber90, p.18] and [BR10, §1] for further details.
Given z ∈ K ◦ and r ∈ [0, 1], we may construct a point xz,r ∈ XK as the sup-norm over the closed disc
D(z, r) ⊂ K ◦ of radius r about z; that is,
|f (xz,r )| :=

sup

|f (z ′ )|,

f ∈ K{T }.

z ′ ∈D(z,r)

The point π(xz,r ) ∈ X will again be denoted by xz,r . When K 6= k, it is possible that two pairs (z, r) and (z ′ , r′ )
may deﬁne the same point of X; for example, if z ′ ∈ Gal(k a /k) · {z} and r > 0, then xz′ ,r = xz,r .
When z ∈ (k a )◦ and r = 0, the associated point xz,0 is called a rigid point ; the seminorm xz,0 coincides with
the seminorm induced by the maximal ideal of k{T } generated by the minimal polynomial of z over k. Let X rig
denote the subset of rigid points. The points of X can be classiﬁed into 4 types:
(i)
(ii)
(iii)
(iv)

a type 1 point is of the form xz,0 ∈ X for z ∈ K ◦ ;
a type 2 point is of the form xz,r ∈ X for z ∈ K ◦ and r ∈ (0, 1] ∩ |K ∗ |;
a type 3 point is of the form xz,r ∈ X for z ∈ K ◦ and r ∈ (0, 1]\|K ∗ |;
a type 4 point is the pointwise limit of xzi ,ri such that the corresponding discs D(zi , ri ) form a decreasing
sequence with empty intersection.

See [Ber90, p.18] for further details; when K 6= k, see also [Ked11, Proposition 2.2.7]. When k is nontriviallyvalued, the set of rigid points and the set of type 2 points are both dense in X. Points of type 4 exist only when
k is not spherically complete.
For any x ∈ X, the multiplicity of x is m(x) := #π −1 (x) ∈ Z>0 ∪ {∞}. The points of type 1 with ﬁnite
multiplicity are precisely the rigid points. All points of type 2 and type 3 have ﬁnite multiplicity.
Lemma 2.1. Assume k is trivially-valued or has residue characteristic zero. For any x ∈ X of type 2 or 3,
there exists x′ ∈ X rig such that x′ ≤ x and m(x′ ) = m(x).
The statement of Lemma 2.1 is not necessarily true for a nontrivially-valued ﬁeld of positive residue character2p−1
istic. For example, if k = Qp and x is the type 2 point of XCp corresponding to the closed disc D(p1/p , |p| p(p−1) )
in (Cp )◦ , then π(x) ∈ X is a type 2 point of with m(π(x)) = 1, but there is no Qp -rational point lying below it.
Proof. Let d = m(x), let x1 , . . . , xd be the π-preimages of x, and let G := Gal(k a /k). Each xi is the sup-norm
over a closed disc Di ⊆ K ◦ of radius r(x) > 0. It suﬃces to show that there is z1 ∈ D1 ∩ (k a )◦ such that
G · {z1 } = {z1 , . . . , zd } with zi ∈ Di . Fix any z1 ∈ D1 ∩ (k a )◦ , then it is easy to see that any such z1 has
#G · {z1 } ≥ d.
Assume k is trivially-valued. If r(x) = 1, the problem is trivial. If r(x) < 1, then each D i contains a unique
rigid point; in particular, G · {z1 } has size precisely equal to d.
Assume now that k has residue characteristic zero. The case when d = 1 is [Ax70, Proposition 2’] and we
deduce the general case using a similar strategy (the d = 1 case also follows from the main result of [Sch15]).
Let z1 , . . . , zℓ ∈ G · {z1 } be those conjugates of z1 that lie in D1 . We claim each Di contains precisely ℓ
elements of the orbit G · {z1 }. Indeed, by assumption there exists σi ∈ G such that σi (z1 ) ∈ Di , from which it
follows that σi (zj ) ∈ Di for all j = 1, . . . , ℓ since G acts by isometries. As σi is an automorphism of k a , it must

A NON-ARCHIMEDEAN OHSAWA–TAKEGOSHI EXTENSION THEOREM

5

∼

give a bijection G · {z1 } ∩ D1 → G · {z1 } ∩ Di , which gives the claim. Now, for all i = 1, . . . , d, set
X
wi := ℓ−1
u.
u∈G·{z1 }∩Di

As the residue characteristic of k is zero, |ℓ| = 1 and hence




X



|σi (z1 ) − u| ≤ r(x).
|σi (z1 ) − wi | = ℓσi (z1 ) −
u ≤
max

 u∈G·{z1 }∩Di
u∈G·{z }∩D
1

i

In particular, wi ∈ Di . Moreover, we have G · {w1 } = {w1 , . . . , wd } by construction.



The Berkovich unit disc X comes equipped with a structure sheaf OX on the G-topology on X. The k-algebra
of global sections of OX is the Tate algebra k{T }. See [Ber90, 2.3] for further details.
2.2. Quasisubharmonic functions on the Berkovich unit disc. In this section, we discuss the metric
tree structure and potential theory on the Berkovich unit disc. For a comprehensive treatment, see [BR10]
and [Jon15].
For each x ∈ X, deﬁne an equivalence relation ∼ on the set X\{x} by declaring y ∼ z if the paths (x, y] and
(x, z] intersect. The tangent space TX,x at x is the set of equivalences classes of X\{x} modulo ∼. For each
~v ∈ TX,x , let U (~v ) be the set of points of X representing ~v , and set m(~v ) := inf y∈U(~v) m(y). The subsets of the
form U (~v ), for some tangent direction ~v , form a subbasis of open sets for the topology on X. See [Jon15, §2.3]
for further details.
The closed unit disc X may be equipped with a generalized metric, in the sense that the distance between two
points may be inﬁnite; in particular, X gains the structure of a metric tree. This generalized metric is described
as follows. Let r : X → [0, 1] denote the radius function, which can be thought of as a Gal(k a /k)-equivariant
function on XK . Deﬁne a function α : X → [0, +∞] by specifying that α(xG ) = 0 and
Z x
1
d (log r(z)) ,
(2.1)
α(x) − α(y) = −
m(z)
y
for any two distinct points x, y ∈ X, where the integral is taken over the unique path in X joining the points x
and y. These constraints completely determine a function α : X → [−∞, +∞] whose restriction to any segment
is monotone decreasing. Observe that, when k = k a , α = − log r. This, in turn, induces a generalized metric d
on X by setting
d(x, y) := |α(x) − α(x ∨ y)| + |α(y) − α(x ∨ y)|
for x, y ∈ X; here, x ∨ y is the least upper bound of x and y. The rooted tree (X, ≤) acquires the structure
of a metric tree when equipped with the generalized metric d. It is important to note that the topology on X
induced by d is strictly ﬁner than the native topology.
One can discuss potential theory and the notion of quasisubharmonic functions on any metric tree, as developed in [Jon15, §2.5]. We brieﬂy recall this theory in the special case of the Berkovich disc. This is also discussed
in [BR10, §5] (though our conventions diﬀer slightly).
Fix a ﬁnite atomic measure ρ0 supported at xG , i.e. ρ0 is a positive real multiple of the Dirac mass δxG at
the Gauss point xG . A function ϕ : X → [−∞, ∞) is called ρ0 -subharmonic if it satisﬁes:
(1) for every ﬁnite subtree Y ⊂ X\X rig containing xG , ϕ|Y is a continuous function on Y such that:
(a) ϕ|Y is convex on any segment in Y that does not contain xG ;
(b) for any y ∈ Y ,
X
ρ0 {y} +
d~v (ϕ|Y ) ≥ 0,
~
v ∈Ty Y

where d~v (ϕ|Y ) denotes the directional derivative of ϕ|Y in the direction ~v .

6

MATTHEW STEVENSON

(2) ϕ is the limit of its retractions to ﬁnite subtrees containing xG ; more precisely, if {Yi }i∈I denotes the
net of ﬁnite subtrees of X\X rig containing xG and if ri : X → Yi is the (continuous) retraction map of
X onto Yi , then ϕ = lim r∗i ϕ.
i

The condition (b) is equivalent to the subaverage property: for any y ∈ Y , there exists r > 0 such that
X
1
ϕ(z) + mass(ρ0 )r · 1{xG } (y),
ϕ(y) ≤
|BY (y, r)|
z∈BY (y,r)

where BY (y, r) := {z ∈ Y : d(y, z) = r} is the ball of radius r about y in Y , and 1{xG } is the indicator function
of the point xG . This is reminiscient of the classical deﬁnition of subharmonic functions on Rn .
A function is said to be quasisubharmonic if it is ρ0 -subharmonic for some measure ρ0 as above. The class
of ρ0 -subharmonic functions on X is a convex set, which is closed under taking ﬁnite maxima and decreasing
(pointwise) limits. A quasisubharmonic function is upper-semicontinuous, but it may take the value −∞; this
can only occur at those points x ∈ X such that α(x) = +∞.
Given a topological space Z and a function φ : Z → [−∞, ∞) that is locally bounded above, the uppersemicontinuous (usc) regularization φ∗ of φ is deﬁned by the formula
φ∗ (z) := lim sup φ(y),

z ∈ Z.

y→z

The usc regularization φ∗ is the smallest usc function such that φ∗ ≥ φ.
Lemma 2.2. If {ϕi }i∈I is a net of ρ0 -subharmonic functions on X which is locally bounded above, then the usc
regularization ψ ∗ of ψ := supi∈I ϕi is ρ0 -subharmonic. Furthermore, ψ ∗ = ψ on X\{α = +∞}.
The proof of Lemma 2.2 is a minor variation on [BR10, Proposition 8.23(E)].
The rest of this section is devoted to a brief discussion of the Laplacian of a quasisubharmonic function.
Given a ρ0 -subharmonic function ϕ and any ﬁnite subtree Y ⊂ X containing xG , let ∆(ϕ|Y ) be the unique
signed Borel measure on Y determined by the following rule: if ~v1 , . . . , ~vn are tangent directions in Y such that
U (~vi ) ∩ U (~vj ) 6= ∅ and U (~vi ) 6⊆ U (~vj ) for all i 6= j, then
!
n
n
X
\
dv~i (ϕ|Y ) .
U (~
vi ) = −
∆(ϕ|Y )
i=1

i=1

The Laplacian is the signed Borel measure ∆ϕ uniquely characterized by the following property: for any ﬁnite
subtree Y ⊂ X containing xG ,
(rY )∗ (ρ0 + ∆ϕ) = ρ0 + ∆ (ϕ|Y ) ,
where rY : X → Y is the (continuous) retraction map of X onto Y . There are several Laplacians deﬁned in the
literature, and the above deﬁnition follows the conventions of [FJ05, Jon15] and it diﬀers from that of [BR10]
by a negative sign; see [BR10, §5.8] for a discussion of the various Laplacian operators.
Quasisubharmonic functions and their Laplacians behave well with respect to the ground ﬁeld extension
morphism π : XK → X, in the following sense: given a ρ0 -subharmonic function ϕ on X, π ∗ ϕ is a π ∗ ρ0 subharmonic function on XK and ∆ϕ = π∗ ∆(π ∗ ϕ).
Example 2.3. For any irreducible f ∈ k{T }, the function ϕ := log |f | is ρ0 -subharmonic, where ρ0 = m(x) · δxG
and x ∈ X rig is the rigid point of X corresponding to the maximal ideal (f ) of k{T }. It is easy to check that
∆ϕ = m(x) (δx − δxG ) .
More generally, for any f ∈ k{T }, the function log |f | is quasisubharmonic and its Laplacian can be identiﬁed,
up to scaling and adding a multiple of δxG , with the divisor of zeros of f via the Poincaré–Lelong formula.
See [BR10, Example 5.20].
In fact, for any x ∈ X with m(x) < +∞, the function ϕ = −α(x ∨ ·) is m(x) · δxG -subharmonic with Laplacian
given by ∆ϕ = m(x) (δx − δxG ).

A NON-ARCHIMEDEAN OHSAWA–TAKEGOSHI EXTENSION THEOREM

7

For a quasisubharmonic function ϕ on X, we may construct a metric on OX : to a local section f of OX over
an analytic domain V ⊂ X, we assign the function x 7→ |f (x)|e−ϕ(x) , for x ∈ V . This convention mirrors how
(semipositive) metrics on line bundles on complex manifolds are locally given by plurisubharmonic functions, as
in e.g. [Dem12, §3].
2.3. Temkin’s metric. In [Tem16], Temkin introduces a canonical lower-semicontinuous metric AZ on the
canonical bundle ωZ/k of any k-analytic space Z. We will explain the construction of AZ when Z is a k-aﬃnoid
space. In the sequel, the metric AZ will play a crucial role when Z is the closed unit disc.
To a contractive morphism A → B of seminormed rings, the module ΩB/A of Kähler diﬀerentials may be
equipped with the maximal seminorm k · kB/A making the derivation d : B → ΩB/A into a contractive A-module
morphism. Explicitly,
kskB/A = Pinf ′ max |bi | · |b′i |,
s=

i

bi d(bi )

i

P

b B/A denote the separated completion of
where the inﬁmum is taken over all representations s = i bi d(b′i ). Let Ω
b B/A is the completed module of Kähler
ΩB/A with respect to k · kB/A ; this is a Banach B-module. We say that Ω
b B/A . See [Tem16, 4.1] for further details.
differentials and we say its norm k · kB/A is the Kähler norm on Ω
b A/k has an alternate description: if J is the kernel of the multiplication
For a k-aﬃnoid algebra A, the module Ω
2
b
b A/k is induced from the bounded map A → J
b
map A⊗k A → A, then ΩA/k = J /J . The derivation d : A → Ω
b A/k as an A-module.
b − a⊗1.
b The image of the derivation d generates Ω
of Banach A-modules given by a 7→ 1⊗a
This is the approach taken in [Ber93, 3.3].
b A/k determines a coherent OZ -module
Let Z = M(A) be a k-aﬃnoid space. The ﬁnite Banach A-module Ω
b A/k ) on Z. Temkin provides a canonical metric on each stalk of ΩZ/k , as well as on the stalks of its
ΩZ/k := OZ (Ω
exterior powers (and in particular, on the canonical bundle). This was originally introduced as a generalization
of the weight function of [MN15]. It has arisen in other contexts more recently, e.g. as a log discrepancy-type
function in [BJ16, 5.6].
For any z ∈ Z, there is a natural homomorphism of k-algebras
≃ b
ψz : ΩZ/k,z −→ ΩZ/k,z ⊗OZ,z H(z) −→ Ω
H(z)/k ,

which extends the natural isomorphism from the completed ﬁbre of ΩZ/k at z to the completed module of Kähler
diﬀerentials of H(z)/k. Let π : ZK → Z denote the ground ﬁeld extension of Z.
Fix z ∈ Z. The canonical metric k · kz on ΩZ/k,z is deﬁned by the following rule: for any germ s ∈ ΩZ/k,z , set
kskz := kψz′ (π ∗ s) kH(z′ )/k
for any z ′ ∈ π −1 (z). This is independent of the choice of z ′ . In particular, if k = k a , then kskz = kψz (s)kH(z)/k ,
b H(z)/k . This metric naturally extends to
i.e. k · kz is the norm on ΩZ/k,z deﬁned by pulling back the norm on Ω
the the exterior powers of ΩZ/k and, in particular, to the canonical bundle ωZ/k . For the various properties of
the canonical metric, see [Tem16, §6].
The canonical metric, as deﬁned above, is called the “geometric Kähler norm” in [Tem16, 6.3.15]. When
b H(z)/k (without ﬁrst passing
k 6= k a , if one deﬁnes the metric on the stalk ΩZ/k,z by pulling back the metric on Ω
to the completed algebraic closure), then the metric may be quite poorly behaved (for example when k has wild
extensions). See [Tem16, 6.2].
If ωZ/k is trivial, a trivializing section η of ωZ/k gives rise to a lower-semicontinuous function AZ : Z → [0, +∞]
deﬁned by the following property: for any z ∈ Z, write a germ s ∈ ωZ/k,x as s = f · ηx for some f ∈ OZ,z , where
ηx is the image of η in ωZ/k,z . Then,
kskz = |f (z)|e−AZ (z) .
The function AZ depends on the choice of trivializing section η, but we suppress this dependence in the notation.

8

MATTHEW STEVENSON

For our purposes, the important special case is when X = M(k{T }) is the closed unit disc. The completed
b k{T }/k of Kähler diﬀerentials is the free Banach k{T }-module on the diﬀerential dT and, followmodule Ω
ing [Tem16, 6.2.1], the canonical metric admits a simple description: for any x ∈ X and any global section f · dT
b k{T }/k , we have
of Ω
kf · dT kx = |f (x)|r(x) = |f (x)|e−AX (x) ,

where r : X → [0, 1] is the radius function. Thus, AX = − log r. This description holds regardless of whether or
not k is algebraically closed. Observe that AX = +∞ on the type 1 points of X.
The function AX is convex on any segment of X and, in fact, its directional derivatives admit a simple
expression: if x ∈ X with m(x) < +∞ and ~v ∈ TX,x is a direction such that U (~v ) ∩ X rig 6= ∅, then d~v A = m(~v )
X (x)
. Moreover, (2.1) shows that Am(x)
≤ α(x) ≤ AX (x) for x ∈ X.
In §3 and §4, we will be concerned with “twists” of the canonical metric AX on ΩX/k by a metric on OX .
More precisely, for any quasisubharmonic function ϕ on X and any x ∈ X, we consider the metric k · kϕ,x which,
to a global section f · dT of ΩX/k , assigns the number
kf · dT kϕ,x := |f (x)|e−ϕ(x)−AX (x) .
In fact, we will be interested in supx∈X kf · dT kϕ,x, which we write as kf kϕ in the sequel.
3. An Ohsawa–Takegoshi-type extension theorem

Let us brieﬂy recall the notation established in §2. Let k be a complete non-Archimedean ﬁeld, and assume in
addition that k is algebraically closed, trivially-valued, or is spherically complete of residue characteristic zero.
Let X = M(k{T }) be the Berkovich closed unit disc over k with Gauss point xG , let r : X → [0, 1] be the radius
function, and let A := − log r : X → [0, +∞] be Temkin’s metric.
In this section, we prove the following variant of Theorem A and derive Theorem A as an easy consequence.
Theorem 3.1. Let ϕ be a quasisubharmonic function on X with ϕ(xG ) = 0, and let Z(ϕ) = {ϕ = −∞} denote
the polar locus of ϕ. For any z ∈ X, there exists a constant ǫ0 > 0 and a nonzero polynomial f ∈ k[T ] such that
kf k(1+ǫ)ϕ :=

|f (x)|e−(1+ǫ)ϕ(x)−A(x) ≤ |f (z)|e−ϕ(z) for all ǫ ∈ [0, ǫ0 ].

sup
x∈X\Z(ϕ)

If ϕ(z) = −∞, then we may find f such that kf k(1+ǫ)ϕ < +∞ for all ǫ ∈ [0, ǫ0 ]. Moreover, if k is algebraically
closed and z ∈ X rig , then for any value a ∈ H(z)∗ = k ∗ , we may find f such that f (z) = a.
We will prove Theorem 3.1 in §3.1. The hypotheses of Theorem 3.1 may be weakened to allow ϕ(xG ) ≥ 0, but
it is false if ϕ(xG ) < 0 (e.g. if ϕ = −1, then the only f that could satisfy the inequality in Theorem 3.1 at the
Gauss point is f = 0). Nonetheless, Theorem A, which has no hypothesis on the value of ϕ(xG ), may be easily
deduced from Theorem 3.1. Furthermore, the presence of the hypotheses on the ﬁeld k is discussed immediately
after the proof of Lemma 3.6
Proof of Theorem A. Given a quasisubharmonic function ϕ on X and a point z ∈ X, set φ := ϕ − ϕ(xG ). Theorem 3.1 asserts that there is a nonzero polynomial f ∈ k[T ] such that kf k(1+ǫ)φ ≤ |f (z)|e−φ(z) for all ǫ > 0
suﬃciently small. Thus,
lim kf k(1+ǫ)ϕ = eϕ(xG ) lim+ eǫϕ(xG ) kf k(1+ǫ)φ ≤ |f (z)|e−φ(z)+ϕ(xG ) = |f (z)|e−ϕ(z) .

ǫ→0+

ǫ→0

This completes the proof of Theorem A.



As discussed in §1, the optimal constant appearing in the classical Ohsawa–Takegoshi theorem for the complex
unit disc is π. In the non-Archimedean setting, however, the optimal constant is 1, in the following sense.

A NON-ARCHIMEDEAN OHSAWA–TAKEGOSHI EXTENSION THEOREM

9

Corollary 3.2. For any z ∈ X, let c(z) be the smallest positive number such that for any quasisubharmonic
function ϕ on X, there exists a nonzero f ∈ k{T } satisfying
lim kf k(1+ǫ)ϕ ≤ c(z)|f (z)|e−ϕ(z).

ǫ→0+

Then, c(z) = 1.
Proof. If ϕ ≡ 0, then |f (xG )| = limǫ→0+ kf k(1+ǫ)ϕ ≤ c(z)|f (z)| ≤ c(z)|f (xG )|. As |f (xG )| 6= 0, it follows that

c(z) ≥ 1. Theorem A asserts that the lower bound c(z) = 1 is achieved for any z.
3.1. Proof of Theorem 3.1. Fix z ∈ X. Suppose ϕ is ρ0 -subharmonic for some ﬁnite (atomic) measure ρ0
supported at the Gauss point xG , and ϕ(xG ) = 0. To simplify the exposition, we assume ϕ(z) > −∞. When
ϕ(z) = −∞, the proof is similar: one proves analogues of the sequence of lemmas below, each of which is made
easier because one is only concerned with ensuring that a quantity is ﬁnite, as opposed to ensuring that the
same quantity is less than some ﬁxed value.
The strategy of the proof is to use strong induction on ⌊mass(ρ0 )⌋. For this reason, the following terminology
will be quite helpful.
Definition 3.3. Let ǫ0 > 0. A nonzero polynomial f ∈ k[T ] is a (ϕ, ǫ0 )-extension at z if the inequality
kf k(1+ǫ)ϕ ≤ |f (z)|e−ϕ(z)
holds for all ǫ ∈ [0, ǫ0 ]. Equivalently, f is a (ϕ, ǫ0 )-extension if for all x ∈ X\Z(ϕ) and all ǫ ∈ [0, ǫ0 ], we have
log |f (x)| − log |f (z)| ≤ A(x) + (1 + ǫ)ϕ(x) − ϕ(z).
As ϕ ≤ 0, in order to verify that f is an (ϕ, ǫ0 )-extension at z, it suﬃces to check kf k(1+ǫ0 )ϕ ≤ |f (z)|e
as opposed to verifying it for all ǫ ∈ [0, ǫ0 ].
The key players in the proof of Theorem 3.1 are the ﬁnite subtrees


n
Γϕ,n := x ∈ X : (ρ0 + ∆ϕ){y ≤ x} ≥
m(x) .
n+1

(3.1)
−ϕ(z)

,

n
m(x)
for n ≥ 1. Note that Γϕ,n is indeed a ﬁnite subtree of X, since any end x of Γϕ,n satisﬁes (ρ0 +∆ϕ){x} ≥ n+1
and ρ0 + ∆ϕ is a positive measure of ﬁnite mass equal to mass(ρ0 ). It is clear that Γϕ,n ⊇ Γϕ,n+1 for any n ≥ 1;
in particular,
\
Γϕ :=
Γϕ,n = {x ∈ X : (ρ0 + ∆ϕ){y ≤ x} ≥ m(x)}
n≥1

is a ﬁnite subtree of X that is contained in Γϕ,n for any n ≥ 1.
The subtrees Γϕ,n are crucial in reducing Theorem 3.1 to a “ﬁnite” problem. Observe that any point of Γϕ,n
must have a ﬁnite multiplicity because mass(ρ0 ) is ﬁnite and, moreover, Γϕ,n ∩ X rig ⊆ Z(ϕ). Variants of this
tree appear in [Jon15, Prop 2.8] and [FJ05, Lem 7.7].
The following is the base case for our induction.

Lemma 3.4. If mass(ρ0 ) < 1, there exists a constant ǫ0 > 0 such that any nonzero constant function is a
(ϕ, ǫ0 )-extension at z.
0)
Proof. Set ǫ0 := 1−mass(ρ
v (1 + ǫ)ϕ| ≤ (1 + ǫ) mass(ρ0 ) ≤ 1 for all tangent
mass(ρ0 ) . Since mass(ρ0 ) < 1, Γϕ = ∅ and |d~
directions ~v in X, provided ǫ ∈ [0, ǫ0 ]. To check that any constant function is a (ϕ, ǫ0 )-extension at z, it suﬃces
to check that 0 ≤ A + (1 + ǫ)ϕ − ϕ(z) on X\Z(ϕ). This inequality is satisﬁed at the Gauss point:

A(xG ) + (1 + ǫ)ϕ(xG ) − ϕ(z) = −ϕ(z) ≥ 0.
Moreover, the convexity of ϕ and of A ensures that it is enough to check that, in any tangent direction at xG ,
the function (1 + ǫ)ϕ + A only increases in that direction. However, in any such direction ~v ,
d~v ((1 + ǫ)ϕ + A) ≥ −(1 + ǫ) mass(ρ0 ) + 1 ≥ 0,

10

MATTHEW STEVENSON

which completes the proof.



Now, if mass(ρ0 ) ≥ 1, then xG ∈ Γϕ,n for all n ≥ 1, because m(xG ) = 1. In particular, Γϕ,n 6= ∅ and the set of
ends1 Ends(Γϕ,n ) is nonempty. Let Γ′ϕ,n denote the convex hull of Γϕ,n ∪ {z}. Let rΓ′ϕ,n : X → Γ′ϕ,n denote the
retraction of X onto Γ′ϕ,n . For any n ≥ 1, observe that a (r∗Γ′ϕ,n ϕ, ǫ0 )-extension f at z is also a (ϕ, ǫ1 )-extension
at z, where ǫ1 = min{ǫ0 , n1 }. Indeed, for any x ∈ Γ′ϕ,n and any direction ~v ∈ TX,x such that U (~v ) ∩ Γ′ϕ,n = ∅, we
have


n
d~v ((1 + ǫ)ϕ + A) > −(1 + ǫ)
+ 1 m(x) ≥ 0
n+1

for all ǫ ∈ [0, ǫ1 ]. Thus, for ﬁxed n ≥ 1, we may replace ϕ with r∗Γ′ϕ,n ϕ to assume that ϕ is locally constant oﬀ
of Γ′ϕ,n .
Fix n ≥ 1 such that
G
Γϕ,n \Γϕ =
[xj , x̃j ),
(3.2)
j∈J

where J is a ﬁnite index set, and for all j ∈ J, x̃j ∈ Γϕ and the point xj is of type 2 or 3 such that the multiplicity
function is constant on [xj , x̃j ). Moreover, for each j ∈ J, if ~vj ∈ TX,x̃j denotes the unique tangent direction at
x̃j with xj ∈ U (~vj ), then d~vj ϕ = −m(xj ).
As mentioned before, the strategy of the proof of Theorem 3.1 is by strong induction on ⌊mass(ρ0 )⌋. In
the following sequence of lemmas, we explain how to reduce the problem of the existence of a (ϕ, ǫ0 )-extension
at z to the existence of a (φ, ǫ1 )-extension at z, where φ is a ρ-subharmonic for some ﬁnite measure ρ with
mass(ρ) ≤ mass(ρ0 ) − 1 and 0 < ǫ1 ≤ ǫ0 . As mass(ρ0 ) is ﬁnite, after ﬁnitely-many such reductions we must
ﬁnd ourselves in the setting of Lemma 3.4. The hypotheses of each lemma are concerned with which types of
points may arise in the ﬁnite set Ends(Γϕ,n ); in particular, if one assumes that k is spherically complete, one
can ignore Lemma 3.7.
Lemma 3.5. Suppose that mass(ρ0 ) ≥ 1 and that there exists x ∈ Ends(Γϕ,n ) of type 1. Then, there exists
ǫ1 > 0 and a ρ-subharmonic function φ, with mass(ρ) ≤ mass(ρ0 ) − 1, such that a (ϕ, ǫ0 )-extension f at z may
be constructed from a (φ, ǫ1 )-extension f˜ at z.
Proof. By assumption, x ∈ Γϕ and so it satisﬁes m(x) < +∞; in particular, x ∈ X rig , because x is of type 1.
In addition, as Γϕ ∩ X rig ⊆ Z(ϕ) and z 6∈ Z(ϕ), we have x 6= z. Let mx denote the maximal ideal of k{T }
corresponding to x, and let g be a polynomial generator of mx with |g(xG )| = 1. As type-1 points are minimal
with respect to the partial order ≤, we have
1 ≤ m(x) ≤ (ρ0 + ∆ϕ){y ∈ X : y ≤ x} = ∆ϕ{x}.
Set c :=

∆ϕ{x}
m(x)

≥ 1, γ := ⌊c⌋, and ρ := ρ0 − γδxG , then the function φ := ϕ − γ log |g| is ρ-subharmonic and
φ(xG ) = 0. Suppose there exists ǫ1 > 0 and a (φ, ǫ1 )-extension f˜ ∈ k[T ] at z and set f := g γ f˜. We claim that
there exists ǫ0 ∈ (0, ǫ1 ] such that f is a (ϕ, ǫ0 )-extension at z.
Case 1. Consider the case when c is an integer. If z ′ := rΓϕ,n (z), then Γ′ϕ,n = Γϕ,n ∪ [z, z ′ ]. If z ′ 6= z, let
~vz ∈ TX,z′ be the unique direction at z ′ with z ∈ U (~vz ). The function y 7→ |f (y)|e−(1+ǫ0 )ϕ(y)−A(y) is decreasing
m(~
vz )
in the direction ~vz provided d~vz (−(1 + ǫ0 )ϕ − A) ≤ 0. This occurs if ǫ0 ≤ nm(z
′ ) . Thus, it suﬃces to ﬁnd ǫ0 > 0
such that
|f (y)|e−(1+ǫ0 )ϕ(y)−A(y) ≤ |f (z)|e−ϕ(z) = |f˜(z)|e−φ(z)
1If Γ is a subtree of X that contains x , we adopt the following conventions: if Γ ) {x }, then Ends(Γ) consists of those points
G
G
in Γ with a unique tangent direction in Γ; if Γ = {xG }, then Ends(Γ) = Γ.

A NON-ARCHIMEDEAN OHSAWA–TAKEGOSHI EXTENSION THEOREM

11

e φ,n = Γφ,n ∪ {xG } (where we must include xG in case Γφ,n is empty). If y ∈ Γ
e φ,n , then
for all y ∈ Γϕ,n . Set Γ
n
φ(y) ≤ − n+1 α(y), and hence
n
−ǫ0 cm(x)+ n+1

(ǫ1 −ǫ0 )
|g(y)|−ǫ0 c e(ǫ1 −ǫ0 )φ(y) ≤ e−α(y)

and this is less than or equal to 1 provided ǫ0 ≤

ǫ1 n
m(x)c(n+1)+n .

Granted this, observe that

|f (y)|e−(1+ǫ0 )ϕ(y)−A(y) = |g(y)|−ǫ0 c e(ǫ1 −ǫ0 )φ(y) |f˜(y)|e−(1+ǫ1 )φ(y)−A(y) ≤ |f˜(y)|e−(1+ǫ1 )φ(y)−A(y) ≤ |f˜(z)|e−φ(z) ,
e φ,n ∩ [x, xG ] and let ~vx ∈ TX,x̃ be the unique direction
as required. Let x̃ denote the minimal element of Γ
e
at x̃ such that x ∈ U (~vx ). As Γϕ,n = Γφ,n ∪ [x, xG ], it suﬃces to ﬁnd an ǫ0 > 0 such that the function
y 7→ |f (y)|e−(1+ǫ0 )ϕ(y)−A(y) is decreasing in the direction ~vx , or equivalently
d~vx (ǫ0 m(x)cα − (1 + ǫ0 )φ − A) ≤ 0.

m(~
vx )
.
This occurs if ǫ0 ≤ (c(n+1)+n)m(x)
Case 2. Now, suppose c is not an integer, i.e. c > γ. Write ϕ = ψ + c log |g| for some quasisubharmonic
. It is straightforward to check that ǫ1 φ ≤ ǫ0 ϕ on all of X. Thus,
function ψ on X with ψ ≤ 0. Set ǫ0 = ǫ1 (c−γ)
c
for any y ∈ X\Z(ϕ), we have

|f (y)|e−(1+ǫ0 )ϕ(y)−A(y) = eǫ1 φ(y)−ǫ0 ϕ(y) |f˜(y)|e−(1+ǫ1 )φ(y)−A(y) ≤ |f˜(z)|e−φ(z) = |f (z)|e−ϕ(z) ,
which completes the proof.

Lemma 3.6. Suppose that mass(ρ0 ) ≥ 1 and that there exists x ∈ Ends(Γϕ,n ) of type 2 or of type 3 such that
rΓϕ,n (z) 6= x. Then, there exists ǫ1 > 0 and a ρ-subharmonic function φ, with mass(ρ) ≤ mass(ρ0 ) − 1, such that
a (ϕ, ǫ0 )-extension f at z may be constructed from a (φ, ǫ1 )-extension f˜ at z.
Proof. By Lemma 2.1, there exists x′ ∈ X rig such that rΓϕ,n (x′ ) = x and m(x′ ) = m(x). If x ∈ Γϕ , then set
′
c := ∆ϕ{x}
m(x) ≥ 1. We construct a new ρ0 -subharmonic function ϕ by extending ϕ linearly with slope cm(x) from
′
′
the end x to the rigid point x ; more precisely, ϕ is given by the formula
ϕ′ (y) := ϕ(y) + cm(x) (α(y ∨ x) − α(y ∨ x′ )) .
It is clear that ϕ′ (xG ) = 0, ϕ′ (z) = ϕ(z), and ϕ′ ≤ ϕ. In particular, any (ϕ′ , ǫ0 )-extension at z is also a
(ϕ, ǫ0 )-extension at z.
If x ∈ Γϕ,n \Γϕ , then by the assumption (3.2), we can replace ϕ with a function that is linear on [x, rΓϕ (x)]

with slope m(rΓϕ (x)) and then repeat the same argument as above.
The proof of Lemma 3.6 is one point in the proof of Theorem 3.1 where the additional assumptions on the ﬁeld
k are needed (in order to be able to apply Lemma 2.1). If one were to pick x′ ∈ X rig such that m(x′ ) > m(x),
then the function ϕ′ need not be quasisubharmonic.
In addition, the conditions on the ﬁeld k are such that the hypotheses of the following lemma can only occur
when k is algebraically closed and nontrivially-valued.
Lemma 3.7. Suppose that mass(ρ0 ) ≥ 1 and that there exists x ∈ Ends(Γϕ,n ) of type 4 and x 6= z. Then, there
exists ǫ1 > 0 and a ρ-subharmonic function φ, with mass(ρ) ≤ mass(ρ0 ) − 1, such that a (ϕ, ǫ0 )-extension f at
z may be constructed from a (φ, ǫ1 )-extension f˜ at z.
Proof. By assumption, k is algebraically closed and nontrivially-valued (so the type 2 points of X are dense).
Moreover, all multiplicities are equal to 1 and α = A.
Note that, since x is of type 4, A(x) ∈ (0, +∞). Recall that Γ′ϕ,n denotes the convex hull of Γϕ,n ∪ {z} (we
allow the possibility that z ∈ Γϕ,n , so it is possible that Γ′ϕ,n = Γϕ,n ). Let x̃ ∈ (x, xG ] be the minimal point

12

MATTHEW STEVENSON

xG •

z∨x •

•

• x̃

rΓϕ (z) •

•

z •

•

•u • x
• u′

Figure 1. One possible conﬁguration for Γϕ,n in the setting of Lemma 3.7.
with the property that {y ∈ Γ′ϕ,n : y ≤ x̃} 6= [x, x̃]. That is, x̃ is the minimal point on (x, xG ] such that (x̃, x]
does not intersect any branches of Γ′ϕ,n other than the one containing x. It follows that rΓϕ,n (z) 6∈ (x̃, x]. An
example is in Fig. 1.
Set c := −d~v ϕ ≥ 1, where ~v ∈ TX,x̃ is the unique tangent direction at x̃ with x ∈ U (~v ); then, after possibly
replacing ϕ with a smaller quasisubharmonic function, we may assume that ϕ is linear of slope −c on [x, x̃], i.e.
ϕ(y) = ϕ(x̃) − c (α(y) − α(x̃))
for y ∈ [x, x̃]. If γ := ⌊c⌋, and ρ := ρ0 − γδxG , then the function φ(y) := ϕ(y) + γα(y ∨ x) is ρ-subharmonic and
φ(xG ) = 0. Suppose there exists ǫ1 > 0 and a (φ, ǫ1 )-extension f˜ ∈ k[T ] at z.
Pick u ∈ (x, x̃) of type 2 such that α(x) − α(u) ∈ (0, η), where η is a positive number chosen to be less than
A(x)
and, if φ(x) < 0, then we also require that η < −ǫ1cφ(x) .
c
Pick u′ ∈ X rig such that rΓϕ,n (u′ ) = u, and a polynomial generator g of mu′ with |g(xG )| = 1. Set f := f˜g γ .
By construction, z ∨ u = z ∨ x, and hence we have
|f (z)|e−ϕ(z) = |g(z)|γ |f˜(z)|eγα(z∨u) e−φ(z) = |f˜(z)|e−φ(z) .
Case 1. Suppose that c is an integer and φ(x) = 0. Then, φ|[x,xG ] = 0, and hence ϕ(y) = −cα(y ∨ x) for
y ∈ [x, xG ]. Arguing as in Case 1 of Lemma 3.5, it suﬃces to ﬁnd an ǫ0 > 0 such that
|f (y)|e−(1+ǫ0 )ϕ(y)−A(y) ≤ |f˜(z)|e−φ(z)

(3.3)

for y ∈ Γϕ,n . By assumption, Γφ,n ∩[x, xG ] ⊆ {xG }, so the left-hand side of (3.3) is equal to |f˜(y)|e−(1+ǫ0 )φ(y)−A(y)
for y ∈ Γφ,n , in which case (3.3) holds. Thus, it suﬃces to verify (3.3) for y ∈ [x, xG ]. It holds when y = xG
by assumption, and the function y 7→ |f (y)|e−(1+ǫ0 )ϕ(y)−A(y) is decreasing on [u, xG ], but increasing on [u, x].
Therefore, it is enough to check (3.3) at y = x. Let β := log |f˜(x)| − log |f˜(xG )| ≤ 0 and suppose there exists an
ǫ0 > 0 such that
eβ |g(x)|c e−(1+ǫ0 )ϕ(x)−A(x) ≤ 1.
(3.4)
−(1+ǫ0 )ϕ(x)−A(x)
−φ(z)
˜
˜
˜
Then, |f (x)|e
≤ |f (xG )|, and |f (xG )| is less than or equal to |f (z)|e
by assumption. Thus,
it suﬃces to show (3.4). Observe that
eβ |g(x)|c e−(1+ǫ0 )ϕ(x)−A(x) = exp (β − cα(u) − (1 + ǫ0 )ϕ(x̃) + (1 + ǫ0 )c (α(x) − α(x̃)) − A(x))
≤ exp (−c (α(u) − α(x)) − A(x) + ǫ0 cα(x)) ,
so (3.4) holds at y = x if ǫ0 ≤

A(x)−cη
cα(x) .

A NON-ARCHIMEDEAN OHSAWA–TAKEGOSHI EXTENSION THEOREM

13

Case 2. Suppose that c is an integer and φ(x) < 0. As in Case 1 of Lemma 3.5, it suﬃces to ﬁnd ǫ0 > 0
e φ,n = Γφ,n ∪ {xG }. Again arguing as in Case 1 of Lemma 3.5, (3.3)
such that (3.3) holds for all y ∈ Γϕ,n . Set Γ
ǫ1 n
e
holds for y ∈ Γφ,n provided ǫ0 ≤ n+c(n+1) . Finally, as in Case 1, the function y 7→ |f (y)|e−(1+ǫ0 )ϕ(y)−A(y) on
e φ,n is maximized at y = x, so it suﬃces to ﬁnd an ǫ0 > 0 so that holds (3.3) there. Observe that
Γϕ,n \Γ
|g(u)|c e(ǫ1 −ǫ0 )φ(x)+(1+ǫ0 )cα(x) ≤ 1

provided ǫ0 ≤

−ǫ1 φ(x)−cη
−φ(x)+cα(x) ,

where −ǫ1 φ(x) − cη > 0 by the choice of u. It follows that

|f (x)|e−(1+ǫ0 )ϕ(x)−A(x) = |g(u)|c e(ǫ1 −ǫ0 )φ(x) e(1+ǫ0 )cα(x) |f˜(x)|e−(1+ǫ1 )φ(x)−A(x) ≤ |f˜(z)|e−φ(z) ,
which completes the proof in Case 2.
Case 3. Suppose c > γ. Following the previous two cases, it suﬃces to ﬁnd ǫ0 > 0 such that (3.3) holds for
e φ,n = Γφ,n ∪ {xG }. If y ∈ Γ
e φ,n , then φ(y) ≤ − n α(y), and hence
all y ∈ Γϕ,n . Set Γ
n+1
n

 n+1
(ǫ1 −ǫ0 )−γǫ0
.
exp ((ǫ1 − ǫ0 )φ(y) + γǫ0 α(y ∨ u′ )) ≤ e−α(y)

This last quantity is less than or equal to 1 provided ǫ0 ≤

ǫ1 n
γ(n+1)+n .

In this case, we have

′
|f (y)|e−(1+ǫ0 )ϕ(y)−A(y) ≤ eγǫ0 α(y∨u )+(ǫ1 −ǫ0 )φ(y) |f˜(y)|e−(1+ǫ1 )φ(y)−A(y) ≤ |f˜(z)|e−φ(z) .

e φ,n ∩[u, xG ]. If ~v ′′ ∈ TX,x′′ is the unique direction at x′′ with x ∈ U (~v ′′ ),
Let x′′ ∈ [u, xG ] be the minimal point of Γ
−(1+ǫ0 )ϕ(y)−A(y)
then the function y 7→ |f (y)|e
is decreasing on [u, x′′ ] provided
d~v′′ (ǫ0 γα − (1 + ǫ0 )φ − A) ≤ 0.

n
Using the fact that d~v′′ φ ≥ − n+1
, this holds if ǫ0 ≤

1
(n+1)γ+n .

Now, the function y 7→ |f (y)|e−(1+ǫ0 )ϕ(y)−A(y) on [x, u) achieves its maximum at y = x, so it suﬃces to ﬁnd
an ǫ0 > 0 such that (3.3) holds at y = x. If φ(x) = 0, one can argue as in Case 1. If φ(x) < 0, then it follows
that
|g(u)|γ e(ǫ1 −ǫ0 )φ(x)+(1+ǫ0 )γα(x) ≤ exp (γη + ǫ1 φ(x) − ǫ0 ϕ(x)) ,
and this is bounded above by 1 provided ǫ0 ≤
Therefore, we have

−φ(x)ǫ1 −γη
;
−ϕ(x)

note that −φ(x)ǫ1 − γη > 0 by the choice of u.

|f (x)|e−(1+ǫ0 )ϕ(x)−A(x) ≤ |g(u)|γ e(ǫ1 −ǫ0 )φ(x)+γ(1+ǫ0 )α(x) |f˜(x)|e−(1+ǫ1 )φ(x)−A(x) ≤ |f˜(z)|e−φ(z) ,
which completes the proof.
If none of the hypotheses of the previous 4 lemmas hold, then
case is addressed below.


Γ′ϕ,n

must be the interval [z, xG ]. This special

Lemma 3.8. Suppose mass(ρ0 ) ≥ 1 and Γ′ϕ,n = [z, xG ], then there exists ǫ0 > 0 such that any nonzero constant
function is a (ϕ, ǫ0 )-extension at z.
Proof. It suﬃces to ﬁnd ǫ0 > 0 such that −(1 + ǫ0 )ϕ(y) − A(y) ≤ −ϕ(z) for any y ∈ [z, xG ]. For such y,
ϕ(z) − ϕ(y) ≤ 0 and hence it suﬃces to ﬁnd ǫ0 > 0 such that −ǫ0 ϕ(y) − A(y) ≤ 0 for all such y. This holds for
any ǫ0 > 0 at y = xG . Thus, if ~v ∈ TX,xG is the unique direction at xG with z ∈ U (~v ), then it suﬃces to ﬁnd
m(~
v)
ǫ0 > 0 such that d~v (−ǫ0 ϕ − A) ≤ 0. This holds if ǫ0 ≤ −d
.

~
vϕ
Let us now summarize the proof of Theorem 3.1: if mass(ρ0 ) < 1, then a (ϕ, ǫ0 )-extension at z exists by
Lemma 3.4. Suppose now that mass(ρ0 ) ≥ 1; in particular, Γϕ,n 6= ∅ and Ends(Γϕ,n ) 6= ∅. As discussed at
the start of the section, we assume that ϕ is locally constant oﬀ of the convex hull of Γϕ ∪ {z}. By repeatedly
applying Lemma 3.5, Lemma 3.6, and Lemma 3.7, we may assume that Ends(Γϕ,n ) consists of a single type-2
or type-3 point onto which z retracts. This is precisely the setting of Lemma 3.8, which then asserts that a

14

MATTHEW STEVENSON

(ϕ, ǫ0 )-extension at z exists. Now, if z ∈ X rig and k = k a , then H(z) = k, so the second assertion is immediate
from the ﬁrst. This concludes the proof of Theorem 3.1.
4. Non-Archimedean Demailly approximation of quasisubharmonic Functions
Let X be the Berkovich closed unit disc over k. Given a quasisubharmonic ϕ on X, one may wish to approximate it by a sequence of quasisubharmonic functions whose singularities are controlled. One such result
is already well known: [Jon15, Theorem 2.10] shows that there is a decreasing sequence of bounded quasisubharmonic functions (ϕn )∞
n=1 on X which decrease pointwise to ϕ. Let us brieﬂy recall the construction: if ϕ is
ρ0 -subharmonic, for each n ≥ 1, consider the ﬁnite subtree
o
n
Γn := x ∈ X : (ρ0 + ∆ϕ){y ≥ x} ≥ 2−n and d(xG , x) ≤ 2n ,

where d is the generalized metric on X from §2.2. If rn : X → Γn denotes the retraction map of X onto Γn , then
ϕn is, up to translation by a constant, equal to (rn )∗ ϕ. A similar argument appears in [FRL06, §4.6].
Notice that the construction of the sequence (ϕn )∞
n=1 heavily uses the tree structure on X (indeed, the same
proof yields an analogous result for any metric tree) and moreover it depends on the choice of exhausting
sequence of subtrees Γn . Without involving the analytic structure, it is unlikely that such a regularization
result will generalize to higher-dimensional analytic spaces. The goal of this section is to construct a canonical
regularization of a quasisubharmonic function on the Berkovich unit disc. The inspiration is the much-celebrated
regularization theorem of Demailly [Dem92, Proposition 3.1].
Let us brieﬂy recall the construction of the Demailly approximation of a plurisubharmonic function on the
complex unit disc. Let D be the open unit disc in C, and let ϕ be a plurisubharmonic function on D. Consider
the Hilbert space Hϕ of holomorphic functions f on D satisfying the integrability condition
Z
|f |2 e−2ϕ dλ < +∞,
kf k2ϕ :=
D

where dλ is the Lebesgue measure. For each m ≥ 1, let (fm,n )∞
n=1 be an orthonormal basis of Hmϕ and deﬁne
a plurisubharmonic function ϕm on D by the formula
!
∞
X
1
log
|fm,n |2 .
ϕm =
2m
n=1

This function ϕm is called the Demailly approximation
associated
to Hmϕ ; ϕm has analytic singularities, in
P

N
2
the sense that it can be locally written as c log
+ β for some constant α > 0, local holomorphic
i=1 |gi |
functions gi , and a locally bounded function β. The Demailly approximation may also be expressed as
1
ϕm = sup log |f |,
m
f

where the supremum ranges over all holomorphic functions f in the unit ball of Hmϕ . In [Dem92, Proposition
1
3.1], it is shown that the sequence (ϕm )∞
m=1 converges pointwise (and in Lloc ) to ϕ and, after passing to a
subsequence, is decreasing in m.
In §4.1, given a quasisubharmonic function ϕ on the Berkovich unit disc X, we construct an ideal Hϕ of the
Tate algebra and the non-Archimedean Demailly approximation ϕm associated to Hmϕ . Using Theorem 3.1, we
show that the sequence (ϕm )∞
m=1 converges to ϕ. In §4.2, we brieﬂy discuss the connection between the ideals
Hϕ and a locally-deﬁned non-Archimedean multiplier ideal associated to ϕ.
4.1. Non-Archimedean Demailly approximation and a regularization theorem. Let ϕ be a quasisubharmonic function on X with ϕ ≤ 0. The case when ϕ may be positive will be addressed later. As in §3, consider
the function k · kϕ : k{T } → [0, +∞] deﬁned by
kf kϕ :=

sup
x∈X\Z(ϕ)

|f (x)|e−ϕ(x)−A(x) , f ∈ k{T }.

A NON-ARCHIMEDEAN OHSAWA–TAKEGOSHI EXTENSION THEOREM

15

This gives a non-Archimedean norm on the subset {k · kϕ < +∞}. The norms of this form are not submultiplicative in general, but they do satisfy a monotonicity property: if ϕ, φ are quasisubharmonic and such that
ϕ ≤ φ ≤ 0, then kf kφ ≤ kf kϕ for any f ∈ k{T }. In particular, the limit
kf k+
ϕ := lim kf k(1+ǫ)ϕ
ǫ→0+

exists (though it may be inﬁnite). Consider the subset Hϕ of the Tate algebra consisting of those series f ∈ k{T }
+
such that kf k+
ϕ < +∞. The function k·kϕ deﬁnes a non-Archimedean norm on Hϕ , which is not submultiplicative
in general. With this norm, Hϕ is a normed k{T }-module.
Lemma 4.1. The subset Hϕ is a principal ideal of k{T }, which is complete for the norm k · k+
ϕ . In particular,
Hϕ is a Banach k{T }-module.
Proof. It is clear that Hϕ is closed under addition. Given g ∈ k{T }, the image of the function x 7→ |g(x)| is
contained in the interval [0, |g(xG )|]. For any f ∈ Hϕ and for any ǫ > 0, kf gk(1+ǫ)ϕ ≤ |g(xG )| · kf k(1+ǫ)ϕ. In
particular, f g ∈ Hϕ . Furthermore, the Tate algebra k{T } is a principal ideal domain (when k is nontriviallyvalued, see [Bos14, Corollary 2.2.10]; otherwise, k{T } = k[T ]) and hence Hmϕ is principal.
+
∞
Let (fj )∞
j=1 ⊂ Hϕ be a Cauchy sequence in the norm k · kϕ . It follows that (fj )j=1 is also a Cauchy sequence
+
for the Gauss norm, since | · |xG ≤ k · kϕ . By the completeness of k{T }, the sequence (fj )∞
j=1 admits a limit
f ∈ k{T }. All ideals of k{T } are closed, so f ∈ Hϕ . If Hϕ = (h), then we can write fj = gj h and f = gh for
some gj , g ∈ k{T } such that gj → g in | · |xG . For any δ > 0, take ǫ > 0 suﬃciently small so that khk(1+ǫ)ϕ < +∞
δ
and take j ≫ 0 so that |(gj − g)(xG )| < khk
+ . It follows that
ϕ
!
δ
+
kfj −f kϕ ≤ kfj −f k(1+ǫ)ϕ ≤
sup |(gj − g)(x)| khk(1+ǫ)ϕ = |(gj −g)(xG )|·khk(1+ǫ)ϕ <
khk(1+ǫ)ϕ ≤ δ.
khk+
ϕ
x∈X\Z(ϕ)
+
Therefore, fj → f in the norm k · k+
ϕ , and hence Hϕ is complete with respect to k · kϕ .



Proposition 4.2. Let ϕ, φ be two quasisubharmonic functions on X with ϕ, φ ≤ 0. If there exist C1 , C2 > 0
such that φ − C2 ≤ ϕ ≤ φ + C1 on X, then
+
+
C2
e−C1 k · k+
φ ≤ k · kϕ ≤ e k · kφ

as functions on k{T }. In particular, Hϕ and Hφ coincide as ideals of k{T } and the identity map between them
is an isomorphism of Banach k{T }-modules. Moreover, if ϕ is bounded, then Hϕ = k{T }.
The proof of Proposition 4.2 is elementary. However, Proposition 4.2 may be used to deﬁne Hϕ for a quasisubharmonic function ϕ such that supX ϕ > 0, in which case it is not clear that the limit deﬁning the norm
k · k+
ϕ exists.
The ideals Hϕ satisfy the subadditivity-type property below.
Proposition 4.3. If ϕ, φ are quasisubharmonic functions on X, then Hϕ+φ ⊆ Hϕ Hφ .
The proof of Proposition 4.3 requires studying the extension of the ideal Hϕ to each local ring OX,x of X.
This is discussed in §4.2. This proof is simpler than in the complex setting, where the proof of the subadditivity
theorem for multiplier ideals relies crucially on the Ohsawa–Takegoshi theorem on the unit bidisc.
We will now deﬁne the non-Archimedean analogue of a plurisubharmonic function with analytic singularities.
Definition 4.4. A quasisubharmonic function ϕ on X is said to have analytic singularities if there exists a cover
{Vi }i∈I of X by aﬃnoid domains such that for each i ∈ I, there are analytic functions fi,1 , . . . , fi,ni ∈ OX (Vi ),
positive numbers αi,1 , . . . , αi,ni > 0, and a bounded function βi : Vi → R such that
ϕ|Vi = βi +

ni
X
j=1

αi,j log |fi,j |

on Vi .

16

MATTHEW STEVENSON

Quasisubharmonic functions with analytic singularities, like their complex counterparts, are quite wellbehaved. One instance of this is illustrated below.
Example 4.5. Let ϕ be a quasisubharmonic function on X with analytic singularities and suppose it admits a
decomposition ϕ = β +α log |f |, with f ∈ k{T } irreducible, α > 0, and β : X → R bounded. Then, Hϕ = (f ⌊α⌋ ).
Given a quasisubharmonic function ϕ on X and a positive integer m ≥ 1, the non-Archimedean Demailly
approximation associated to Hmϕ is the function
!∗
|f |
1
sup
log
ϕm :=
,
m f ∈Hmϕ \{0}
kf k+
mϕ
where (−)∗ denotes the upper-semicontinuous regularization. When k is nontrivially-valued, ϕm may equivalently
be deﬁned in terms of a supremum over f ∈ B(1)mϕ := {f ∈ Hmϕ : kf k+
mϕ ≤ 1}, the unit ball in Hmϕ . This
mirrors the deﬁnition of the Demailly approximation in the complex setting.
Proposition 4.6. Let ϕ be a quasisubharmonic function on X and let m ≥ 1. The non-Archimedean Demailly
approximation ϕm is quasisubharmonic with analytic singularities.
1
log kf|fk+| ≤ ϕ(xG ) and hence by Lemma 2.2, the function ϕm is quasisubharmonic.
Proof. For each f ∈ Hmϕ , m
mϕ
Let h ∈ Hmϕ be any generator. To show ϕm has analytic singularities, it suﬃces to show that the function
!∗
1
|f (x)|
1
|h(x)|
β(x) :=
sup
log
− log
+
m f ∈Hmϕ \{0}
m
kf k+
khk
mϕ
mϕ
−mϕ(xG )
is bounded. As kghk+
6= 0 for any nonzero g ∈ k{T }, we have
mϕ ≥ |g(xG )||h(xG )|e

sup
g∈k{T }\{0}

log

|h(x)|
|h(x)||g(x)|
≤ log
+ mϕ(xG ).
+
|h(x
kghkmϕ
G )|

This upper bound is upper semicontinuous in x, so it follows that β(x) ≤

1
m

khk+

log |h(xmϕ
+ ϕ(xG ). For a lower
G )|

|h(x)|
1
bound, taking g = 1 gives β ≥ 0. Note that the decomposition ϕm = β + m
log khk
is not unique – it depends
+
mϕ
on the choice of generator h of the ideal Hmϕ .


Remark 4.7. It is not true in general that, if ϕ has analytic singularities, then ϕm = ϕ for all m ≥ 1. Rather,
ϕm is an “algebraic approximation” to ϕ, as the following example demonstrates. Let ϕ = α · log |f | for some
rig
is the rigid point
α > 0 and f ∈ k{T } irreducible. It is easy to verify that ϕm = ⌊mα⌋
m log |f |. If x ∈ X
corresponding to the maximal ideal (f ) of k{T }, then ϕm has rational slope along the branch [x, xG ] of X;
however, this will not be the case for ϕ if α ∈ R\Q.
Example 4.8. The sequence (ϕm )∞
m=1 does not, in general, decrease monotonically in m. If ϕ =
(
ϕ,
m = 2n
ϕm = 3n+1
log
|T
|,
m = 2n + 1.
2n+1

3
2

log |T |, then

In particular, ϕ2n = ϕ for all n ≥ 0, but the subsequence (ϕ2n+1 )n≥0 decreases monotonically to ϕ. It is not
clear whether or not the sequence ϕm admits a decreasing subsequence in general. For related results in the
complex case, see [Kim14].
The following is a non-Archimedean analogue of Demailly’s regularization theorem [Dem92, Proposition 3.1].
Theorem 4.9. Assume k is algebraically closed, trivially-valued, or is spherically complete of residue characteristic zero. Let ϕ be a quasisubharmonic function on X with ϕ ≤ 0, and let m ≥ 1. For any x ∈ X,
1
ϕ(x) ≤ ϕm (x) ≤ ϕ(x) + A(x).
m

A NON-ARCHIMEDEAN OHSAWA–TAKEGOSHI EXTENSION THEOREM

17

In particular, ϕm converges pointwise to ϕ on {A < +∞} ⊆ X.
The estimate in Theorem 4.9 in fact yields a stronger assertion than just the pointwise convergence of the
non-Archimedean Demailly approximation ϕm to ϕ. Indeed, for any compact subset K ⊆ X such that α|K
is bounded above, ϕm converges uniformly to ϕ; this is reminiscent of the L1loc convergence of the Demailly
approximation in the complex case. The estimate in Theorem 4.9 can thus be thought of as asserting that ϕm
converges to ϕ in a non-Archimedean version of the Hartog’s sense, as introduced in [DS09, Deﬁnition 3.2.3].
The key ingredient in the proof of Theorem 4.9 is Theorem 3.1. Moreover, the proof shows that the hypothesis
that ϕ ≤ 0 is only needed for the upper bound, whereas the lower bound always holds.
Proof. Consider ﬁrst the upper bound on ϕm . If A(x) = +∞, then the upper bound is trivial. Suppose that
A(x) < +∞, in which case α(x) < +∞ as well, so ϕm (x) may be calculated without the upper-semicontinuous
regularization by Lemma 2.2. The upper bound then follows from the observation that
m(ϕm − ϕ) − A = sup log
f ∈Hmϕ

|f |e−mϕ−A
≤ 0,
kf k+
mϕ

where we have used that ϕ ≤ 0 to conclude that |f |e−mϕ−A ≤ kf k+
mϕ .
mϕ(xG )
To get the lower bound, let φ := ϕ − ϕ(xG ) and observe that Hmϕ = Hmφ and kf k+
kf k+
mϕ for
mφ = e
any f ∈ Hmϕ . For any x ∈ X, Theorem 3.1 asserts that there exists an ǫ0 > 0 and a (mφ, ǫ0 )-extension f ∈ k[T ]
at x. In particular, f ∈ Hmφ and
1≤
or equivalently ϕ(x) ≤

1
m

|f (x)| −mϕ(x)
|f (x)| −mφ(x)
=
e
,
+ e
kf kmφ
kf k+
mϕ

|f (x)|
log kf
≤ ϕm (x).
k+



mϕ

Remark 4.10. A quasisubharmonic function cannot, in general, be bounded pointwise below by a quasisubharmonic function with analytic singularities. Indeed, a general quasisubharmonic function can have a dense set
of poles in X: for example, if {aj : j ≥ 0} forms a dense subset of k ◦ , set
ϕ :=

∞
X

cj log |T − aj |,

j=0

P∞
for some cj > 0 satisfying j=0 cj = 1. However, a quasisubharmonic function with analytic singularities on
X must have a ﬁnite set of poles. This is analogous to the fact that a subharmonic function with analytic
singularities on the complex unit disc has a discrete set of poles.
4.2. Non-Archimedean multiplier ideals. Let A = k{T } and X = M(A). The stalk OX,x of the structure
sheaf OX at x ∈ X is a noetherian local ring, which may be computed as the direct limit of the aﬃnoid algebras
AV over all aﬃnoid neighborhoods V of x. The unique maximal ideal mx of OX,x consists of those germs
f ∈ OX,x such that |f (x)| = 0. We say that a germ f ∈ OX,x is defined on an aﬃnoid domain V ⊂ X if it lies
in the image of the natural map AV → OX,x .
For x ∈ X rig , let mx denote the corresponding maximal ideal of A. As in [BGR84, 7.3.2/1], mx is the
extension of mx along the natural map A → OX,x (though this is false for arbitrary points of an aﬃnoid space,
as demonstrated by [Ber93, Remark 2.2.9]). Moreover, for x ∈ X rig , the natural map A → OX,x factors through
∼ b
the localization Amx , which induces an isomorphism Abmx → O
X,x on completions.
In complex geometry, we associate to each plurisubharmonic function (or more generally, to a semipositive
metric on a line bundle) a multiplier ideal sheaf, which measures the singularities of the plurisubharmonic
function. We propose a non-Archimedean analogue of this notion.

18

MATTHEW STEVENSON

Definition 4.11. Let ϕ be a quasisubharmonic function on X with ϕ ≤ 0. For any x ∈ X, the local multiplier
ideal of ϕ at x, denoted J (ϕ)x , consists of those germs f ∈ OX,x such that for all ǫ > 0, there is an aﬃnoid
neighborhood Vǫ of x on which f is deﬁned such that
sup |f |e−(1+ǫ)ϕ−A < +∞.
Vǫ \Z(ϕ)

It is easy to check that the local multiplier ideal J (ϕ)x is indeed an ideal of the local ring OX,x . Furthermore,
it is immediate from the deﬁnition that the local multiplier ideals satisfy J (ϕ + β)x = J (ϕ)x where β is a
bounded usc function on X. In particular, if supX ϕ > 0, we may deﬁne the local multiplier ideal of ϕ at x to
be J (ϕ − ϕ(xG ))x . For simplicity, we assume from now on that all quasisubharmonic functions are nonpositive.
The name of a multiplier ideal is justiﬁed by examples of the following form: if f ∈ A is irreducible, c > 0,
⌊c⌋
and ϕ := c · log |f |, then J (ϕ)x = mx , where x ∈ X rig is the rigid point corresponding to the maximal ideal
(f ) of A. More generally, the local multiplier ideals admit a similar description for a general quasisubharmonic
function, as is made precise in the following lemma.
⌊c ⌋
Lemma 4.12. For x ∈ X rig , J (ϕ)x = mx x , where cx :=

∆ϕ{x}
m(x) .

For x ∈ X\X rig , J (ϕ)x = OX,x .

The quantity cx may be thought of as the “non-Archimedean Lelong number” of ϕ at the point x.
Proof. Fix x ∈ X rig . For a germ f ∈ OX,x , let ordx (f ) denote the maximal power of mx to which f belongs. To
say f ∈ J (ϕ)x is equivalent the existence of an ǫ > 0 such that ordx (f ) − (1 + ǫ)cx + 1 ≥ 0, which occurs if and
⌊c ⌋
only if ordx (f ) > cx − 1, i.e. ordx (f ) ≥ ⌊cx ⌋. Thus, J (ϕ)x = mx x .
rig
Fix x ∈ X\X
and any ǫ0 > 0. There are only ﬁnitely-many rigid points z1 , . . . , zn ∈ X rig satisfying (1 + ǫ0 )czi ≥ 1, so we may ﬁnd an aﬃnoid neighborhood V of x which avoids z1 , . . . , zn and hence
supV \Z(ϕ) |1|e−(1+ǫ)ϕ−A < +∞ for all ǫ ∈ [0, ǫ0 ]. Thus, 1 ∈ J (ϕ)x .

One can show that the local multiplier ideals J (ϕ)x arise as the stalks of a coherent sheaf of ideals on X.
More precisely, the local multiplier ideals satisfy a “coherence” property similar to [Dem12, Proposition 5.7],
originally due to Nadel [Nad90].
Lemma 4.13. For x ∈ X rig , J (ϕ)x = Hϕ · OX,x .
Proof. The inclusion Hϕ · OX,x ⊆ J (ϕ)x is clear. The local ring OX,x is a dvr, so the ideal Hϕ · OX,x can be
written as mdx for some d ∈ Z≥0 ; the power d is the largest integer such that Hϕ ⊆ mdx . We ﬁrst show that
d ≥ ⌊cx ⌋: pick a net (xj )j∈J in {α < +∞} that converges to x such that xj ≥ x for all j ∈ J. After shifting ϕ
by a constant, assume that ϕ(xG ) = 0, and arguing as in [Jon15, Lemma 2.9] we have
Z xj
Z xj
(∆ϕ){x}dα(y) = −∆ϕ{x}α(xj ).
(4.1)
(∆ϕ){y ∈ X : y ≤ xj }dα(y) ≤ −
ϕ(xj ) = −
xG

xG

Fix a generator gx of mx . For any f ∈ Hϕ , there is a unique factorization f = gxa h (up to units) for some a ∈ Z≥0
and h ∈ A\mx . For suﬃciently small ǫ > 0, (4.1) implies that
+∞ > sup |f |e−(1+ǫ)ϕ−A ≥ sup |f (xj )|e−(1+ǫ)ϕ(xj )−A(xj )
X\Z(ϕ)

j∈J

≥ sup |h(xj )|e−am(xj )α(xj )+(1+ǫ)(∆ϕ{x})α(xj )−m(xj )α(xj )
j∈J

≥ sup |h(xj )|eα(xj )(−am(x)+(1+ǫ)(∆ϕ{x})−m(x))
j∈J

where we have used that m(x) ≥ m(xj ) and m(xj )α(xj ) ≥ A(xj ), which follows from (2.1). This last supremum
is ﬁnite only if −am(x) + (1 + ǫ)(∆ϕ{x}) − m(x) ≤ 0, and this must hold for all ǫ > 0 suﬃciently small; said
diﬀerently, a ≥ ⌊cx ⌋. Thus, d ≥ ⌊cx ⌋.

A NON-ARCHIMEDEAN OHSAWA–TAKEGOSHI EXTENSION THEOREM

19

Now, any generator f of Hϕ , there is a unique way to write f = gxd h (up to units) for some h ∈ A\mx .
⌊c ⌋
If d > ⌊cx ⌋, then it is easy to check that gx x h lies in Hϕ (it is the same calculation as above near x, and
⌊c ⌋
⌊c ⌋
hence gx x h must be a generator of Hϕ ; this is a contradiction, so d = ⌊cx ⌋. Thus, Hϕ · OX,x = mx x and we
apply Lemma 4.12 to conclude.

It is not hard to check that the local multiplier ideals satisfy many of the usual properties of multiplier ideals
on complex algebraic varieties, e.g. invariance under small perturbations, the behavior under adding integral
divisors, and the subadditivity property (in the subsequent lemma). This further justiﬁes the terminology.
Lemma 4.14. If ϕ, φ are quasisubharmonic functions on X and x ∈ X, then J (ϕ + φ)x ⊆ J (ϕ)x J (φ)x .
Proof. The assertion follows from Lemma 4.12 and the observation that ⌊∆(ϕ + φ){x}⌋ ≥ ⌊∆ϕ{x}⌋ + ⌊∆φ{x}⌋.

Proof of Proposition 4.3. After translating ϕ and φ by constants, we may assume that they are nonpositive. The
inclusion Hϕ+φ ⊆ Hϕ Hφ holds if and only if there is an inclusion Hϕ+φ Abmx ⊆ (Hϕ Hφ ) Abmx of the extensions
along A → Abmx , for every maximal ideal mx of A. The claim then follows from Lemma 4.13 and Lemma 4.14. 

As demonstrated by Lemma 4.12, the local multiplier ideals on the Berkovich unit disc are somewhat degenerate, principally because the types of singularities of quasisubharmonic functions that can occur in one dimension
are limited. In this paper, they serve only to prove Proposition 4.3. However, the deﬁnition naturally extends
to higher dimensions and, in that more complicated setting, could prove quite useful.
Remark 4.15. Given a quasisubharmonic function ϕ on X and x ∈ X,
S it is easy to see that ideals Hϕ and
J (ϕ)x satisfy an analogue of the openness conjecture. That is, Hϕ = ǫ>0 H(1+ǫ)ϕ and similarly for J (ϕ)x .
The openness conjecture, for a plurisubharmonic function deﬁned on a neighborhood of the origin in Cn , has
been solved in [Ber13].
References
[Ax70]
[Ber90]
[Ber93]
[Ber96]
[Ber13]
[BFJ08]
[BFJ15]
[BFJ16]
[BGR84]

[BJ16]
[Blo13]
[Bos14]
[BR10]
[CLD12]

James Ax. Zeros of polynomials over local ﬁelds—The Galois action. J. Algebra, 15:417–428, 1970.
Vladimir G. Berkovich. Spectral theory and analytic geometry over non-Archimedean fields, volume 33 of Mathematical
Surveys and Monographs. American Mathematical Society, Providence, RI, 1990.
Vladimir G. Berkovich. Étale cohomology for non-Archimedean analytic spaces. Inst. Hautes Études Sci. Publ. Math.,
(78):5–161 (1994), 1993.
Bo Berndtsson. The extension theorem of Ohsawa-Takegoshi and the theorem of Donnelly-Feﬀerman. Ann. Inst. Fourier
(Grenoble), 46(4):1083–1094, 1996.
Bo Berndtsson. The openness conjecture for plurisubharmonic functions. arXiv:1305.5781.
Sébastien Boucksom, Charles Favre, and Mattias Jonsson. Valuations and plurisubharmonic singularities. Publications of
the Research Institute for Mathematical Sciences, 44(2):449–494, 2008.
Sébastien Boucksom, Charles Favre, and Mattias Jonsson. Solution to a non-Archimedean Monge-Ampère equation. J.
Amer. Math. Soc., 28(3):617–667, 2015.
Sébastien Boucksom, Charles Favre, and Mattias Jonsson. Singular semipositive metrics in non-Archimedean geometry. J.
Algebraic Geom., 25(1):77–139, 2016.
S. Bosch, U. Güntzer, and R. Remmert. Non-Archimedean analysis, volume 261 of Grundlehren der Mathematischen
Wissenschaften [Fundamental Principles of Mathematical Sciences]. Springer-Verlag, Berlin, 1984. A systematic approach
to rigid analytic geometry.
Sébastien Boucksom and Mattias Jonsson. Tropical and non-Archimedean limits of degenerating families of volume forms.
arXiv:1605.05277. To appear in J. Éc. polytech. Math.
Zbigniew Blocki. Suita conjecture and the Ohsawa-Takegoshi extension theorem. Invent. Math., 193(1):149–158, 2013.
Siegfried Bosch. Lectures on formal and rigid geometry, volume 2105 of Lecture Notes in Mathematics. Springer, Cham,
2014.
Matthew Baker and Robert Rumely. Potential theory and dynamics on the Berkovich projective line, volume 159 of
Mathematical Surveys and Monographs. American Mathematical Society, Providence, RI, 2010.
Antoine Chambert-Loir and Antoine Ducros. Formes diﬀérentielles réelles et courants sur les espaces de Berkovich.
arXiv:1204.6277.

20

MATTHEW STEVENSON

[Dem92] Jean-Pierre Demailly. Regularization of closed positive currents and intersection theory. J. Algebraic Geom., 1(3):361–409,
1992.
[Dem00] Jean-Pierre Demailly. On the Ohsawa-Takegoshi-Manivel L2 extension theorem. In Complex analysis and geometry (Paris,
1997), volume 188 of Progr. Math., pages 47–82. Birkhäuser, Basel, 2000.
[Dem12] Jean-Pierre Demailly. Analytic methods in algebraic geometry, volume 1 of Surveys of Modern Mathematics. International
Press, Somerville, MA; Higher Education Press, Beijing, 2012.
[DS09] Tien-Cuong Dinh and Nessim Sibony. Super-potentials of positive closed currents, intersection theory and dynamics. Acta
Math., 203(1):1–82, 2009.
[FJ05]
Charles Favre and Mattias Jonsson. Valuative analysis of planar plurisubharmonic functions. Invent. Math., 162(2):271–
311, 2005.
[FRL06] Charles Favre and Juan Rivera-Letelier. Équidistribution quantitative des points de petite hauteur sur la droite projective.
Math. Ann., 335(2):311–361, 2006.
[Gub98] Walter Gubler. Local heights of subvarieties over non-Archimedean ﬁelds. J. Reine Angew. Math., 498:61–113, 1998.
[Jon15] Mattias Jonsson. Dynamics of Berkovich spaces in low dimensions. In Berkovich spaces and applications, volume 2119 of
Lecture Notes in Math., pages 205–366. Springer, Cham, 2015.
[Ked11] Kiran S. Kedlaya. Semistable reduction for overconvergent F -isocrystals, IV: local semistable reduction at nonmonomial
valuations. Compos. Math., 147(2):467–523, 2011.
[Kim14] Dano Kim. A remark on the approximation of plurisubharmonic functions. C. R. Math. Acad. Sci. Paris, 352(5):387–389,
2014.
[Man93] Laurent Manivel. Un théorème de prolongement L2 de sections holomorphes d’un ﬁbré hermitien. Math. Z., 212(1):107–122,
1993.
[MN15] Mircea Mustat, ă and Johannes Nicaise. Weight functions on non-Archimedean analytic spaces and the KontsevichSoibelman skeleton. Algebr. Geom., 2(3):365–404, 2015.
[MV07] Jeﬀery D. McNeal and Dror Varolin. Analytic inversion of adjunction: L2 extension theorems with gain. Ann. Inst. Fourier
(Grenoble), 57(3):703–718, 2007.
[Nad90] Alan Michael Nadel. Multiplier ideal sheaves and Kähler-Einstein metrics of positive scalar curvature. Ann. of Math. (2),
132(3):549–596, 1990.
[OT87] Takeo Ohsawa and Kenshō Takegoshi. On the extension of L2 holomorphic functions. Math. Z., 195(2):197–204, 1987.
[Sch15] Tobias Schmidt. Forms of an aﬃnoid disc and ramiﬁcation. Ann. Inst. Fourier (Grenoble), 65(3):1301–1347, 2015.
[Siu96] Yum-Tong Siu. The Fujita conjecture and the extension theorem of Ohsawa-Takegoshi. In Geometric complex analysis
(Hayama, 1995), pages 577–592. World Sci. Publ., River Edge, NJ, 1996.
[Siu98] Yum-Tong Siu. Invariance of plurigenera. Invent. Math., 134(3):661–673, 1998.
[Tem16] Michael Temkin. Metrization of Differential Pluriforms on Berkovich Analytic Spaces. In: Baker M., Payne S. (eds)
Nonarchimedean and Tropical Geometry. Simons Symposia. Springer, Cham, 2016.
[Thu05] Amaury Thuillier. Théorie du potentiel sur les courbes en géométrie analytique non archimédienne. Applications à la
théorie d’Arakelov. PhD thesis, Université Rennes 1, 2005.
[Zha95] Shouwu Zhang. Small points and adelic metrics. J. Algebraic Geom., 4(2):281–300, 1995.
Department of Mathematics, University of Michigan, Ann Arbor, MI 48109–1043, USA
E-mail address: stevmatt@umich.edu
URL: http://www-personal.umich.edu/~ stevmatt/

