arXiv:1701.04839v3 [math.AG] 8 May 2018

A NON-ARCHIMEDEAN OHSAWAâ€“TAKEGOSHI EXTENSION THEOREM
MATTHEW STEVENSON

Abstract. We prove an Ohsawaâ€“Takegoshi-type extension theorem on the Berkovich closed unit disc over
certain non-Archimedean ï¬elds. As an application, we establish a non-Archimedean analogue of Demaillyâ€™s
regularization theorem for quasisubharmonic functions on the Berkovich unit disc.

1. Introduction
The Ohsawaâ€“Takegoshi theorem is one of the fundamental extensions theorems in complex geometry. Originating in the foundational paper [OT87] of Ohsawaâ€“Takegoshi, many generalizations and improvements have
since been shown; see [Man93, Ber96, Siu96, Dem00, MV07]. Its many applications include Siuâ€™s much-celebrated
proof [Siu98] of the deformation invariance of plurigenera. In its simplest form, the classical Ohsawaâ€“Takegoshi
theorem asserts the following: given a plurisubharmonic function Ï• on the complex unit disc D, a point
z âˆˆ D\{Ï• = âˆ’âˆ}, and a value a âˆˆ C, there is a holomorphic function f on D such that f (z) = a and
Z
|f (x)|2 eâˆ’2Ï•(x) dÎ» â‰¤ Ï€|f (z)|2 eâˆ’2Ï•(z) .
D

The constant Ï€ is optimal, as shown in [Blo13, Theorem 1]. There is also an adjoint formulation of the result,
which concerns the extension of a holomorphic 1-form rather than of a holomorphic function.
In [Ber90, Ber93], Berkovich introduced his theory of analytic spaces over a complete non-Archimedean ï¬eld.
In recent years, analogues of many theorems from complex geometry have been developed in the non-Archimedean
setting, notably the solution in [BFJ15] of a non-Archimedean Calabiâ€“Yau-type problem. It is natural to ask
for an analogue of the Ohsawaâ€“Takegoshi extension theorem in the non-Archimedean setting, as well.
Let k be a ï¬eld, complete with respect to a non-Archimedean absolute value | Â· |. Let k{T } denote the Tate
algebra in one variable over k, X = Ek (1) denote the Berkovich closed unit disc over k, and AX : X â†’ [0, +âˆ]
denote Temkinâ€™s canonical metric on the canonical bundle Ï‰X/k (more concretely, AX is âˆ’ log of the radius
function). For any quasisubharmonic function Ï• on X and analytic function f âˆˆ k{T }, consider the norm
kf kÏ• := sup |f |eâˆ’Ï•âˆ’AX
X\Z(Ï•)

where Z(Ï•) := {Ï• = âˆ’âˆ}. The function Ï• + AX can be thought of as a metric on Ï‰X/k and f as a global section
of Ï‰X/k , so the norm kf kÏ• measures the length of the section f in the metric Ï• + AX . See Â§2 for further details.
Our ï¬rst main result is a non-Archimedean version of the Ohsawaâ€“Takegoshi extension theorem on the
Berkovich closed unit disc X = Ek (1).
Theorem A. Assume k is algebraically closed, trivially-valued, or is spherically complete of residue characteristic zero. Let Ï• be a quasisubharmonic function on X = Ek (1). For any z âˆˆ X, there exists a nonzero polynomial
f âˆˆ k[T ] such that
lim+ kf k(1+Ç«)Ï• â‰¤ |f (z)|eâˆ’Ï•(z) .
Ç«â†’0

If Ï•(z) = âˆ’âˆ, then we may find f such that limÇ«â†’0+ kf k(1+Ç«)Ï• < +âˆ. Moreover, if k is algebraically closed
and z is a rigid point of X, then for any value a âˆˆ H(z)âˆ— = k âˆ— , we may find f such that f (z) = a.
Date: May 9, 2018.
1

2

MATTHEW STEVENSON

To clarify the relationship between Theorem A and the adjoint formulation of the Ohsawaâ€“Takegoshi extension
theorem, we must discuss the non-Archimedean analogues of (pluri)subharmonic functions and volume forms,
which arise in the statement of the latter. We are interested in the class of quasisubharmonic functions on the
Berkovich closed unit disc, which are the non-Archimedean analogue of (pluri)subharmonic functions on the
complex unit disc. These are brieï¬‚y discussed in Â§2.2; see [BR10, Jon15] for a comprehensive treatment.
On complex manifolds, volume forms naturally correspond to smooth metrics on the canonical bundle. The
non-Archimedean analogue of a metric on the canonical bundle has been examined by Temkin in [Tem16]. Temkin
produces a canonical lower-semicontinuous metric AX on the canonical bundle Ï‰X/k of a k-analytic space X,
extending the weight function of Mustat, aÌ†â€“Nicaise [MN15]. Temkinâ€™s metric is discussed in Â§2.3. This is the
natural candidate to replace the volume form that appears in the statement of the classical Ohsawaâ€“Takegoshi
theorem.
In Theorem A, a section is measured using the sequence of norms k Â· k(1+Ç«)Ï• as Ç« â†’ 0+ instead of with the
single norm k Â· kÏ• , which is what one might expect from the classical Ohsawaâ€“Takegoshi theorem. The former
proves to give the correct analogy with the complex setting, as the following example demonstrates. Consider the
(pluri)subharmonic
function Ï• = Î± log |z|, with Î± > 0, on the complex unit disc D; then, it is elementary to check
R
that D eâˆ’2Ï• dÎ» < +âˆ if and only if Î± < 1. Similarly, consider the quasisubharmonic function Ï• = Î± log |T |,
with Î± > 0, on the Berkovich unit disc X = Ek (1); then, limÇ«â†’0+ k1k(1+Ç«)Ï• < +âˆ if and only if Î± < 1.
As an application of Theorem A, we prove a regularization theorem for quasisubharmonic functions on the
Berkovich unit disc. Certain results in this direction already exist in the literature: in [Jon15, Theorem 2.10],
it was shown that any quasisubharmonic function on X is the decreasing limit of bounded quasisubharmonic
functions. A similar argument appears in [FRL06, Â§4.6]. However, these constructions use only the tree structure
on the Berkovich unit disc (in particular, they do not incorporate the analytic structure). It is therefore unlikely
that these proofs can be generalized to higher dimensions.
As inspiration, we use the much-celebrated regularization theorem of Demailly for a plurisubharmonic function
Ï† on a bounded pseudoconvex domain â„¦ âŠ‚ Cn . To a plurisubharmonic function Ï† on â„¦ and a positive integer
m, we associate the Hilbert space HmÏ† of holomorphic functions on â„¦ satisfying the integrability condition
Z
|f |2 eâˆ’2mÏ† dÎ» < +âˆ.
â„¦

The Demailly approximation associated to HmÏ† is a plurisubharmonic function Ï†m on â„¦ with analytic singu1
larities, and the sequence (Ï†m )âˆ
m=1 converges pointwise and in Lloc to Ï†. See [Dem92] for further details.
We adopt the same philosophy in the non-Archimedean setting: to a quasisubharmonic function Ï• on X, we
associate the ideal HÏ• of the Tate algebra k{T } consisting of those analytic functions f satisfying the ï¬niteness
condition
âˆ’(1+Ç«)Ï•âˆ’AX
kf k+
< +âˆ
Ï• := lim+ sup |f |e
Ç«â†’0

X\Z(Ï•)

For each positive integer m, we deï¬ne the non-Archimedean Demailly approximation Ï•m by the formula
!âˆ—
1
|f |
sup
log
Ï•m :=
,
m f âˆˆHmÏ• \{0}
kf k+
mÏ•
where (âˆ’)âˆ— denotes the upper-semicontinuous regularization. We show that Ï•m is a quasisubharmonic function
with analytic singularities on X.
The ideal sheaf on X associated to HÏ• behaves like a non-Archimedean multiplier ideal associated to Ï•, and
may be of independent interest. This idea is brieï¬‚y explored in Â§4.2, where we show that HÏ• generates the
stalks of a locally-deï¬ned multiplier ideal sheaf associated to Ï•. These multiplier ideals are used to show that
the ideals HÏ• satisfy a subadditivity property.
We prove the following non-Archimedean analogue of Demaillyâ€™s regularization theorem.

A NON-ARCHIMEDEAN OHSAWAâ€“TAKEGOSHI EXTENSION THEOREM

3

Theorem B. Assume k is algebraically closed, trivially-valued, or is spherically complete with residue characteristic zero. If Ï• is a quasisubharmonic function on X with Ï• â‰¤ 0, then Ï• â‰¤ Ï•m â‰¤ Ï• + AmX . In particular, the
sequence (Ï•m )âˆ
m=1 converges pointwise to Ï• on {AX < +âˆ} âŠ† X.
In Theorem B, the crucial inequality Ï•m â‰¥ Ï• is a consequence of Theorem A. In principle, a statement similar
to Theorem B ought to be possible in higher dimensions, but this would likely require a higher-dimensional version
of the Ohsawaâ€“Takegoshi theorem on analytic spaces.
Nonetheless, there has been much work done on the development of pluripotential theory on analytic spaces.
Quite generally, Chambert-Loir and Ducros have introduced in [CLD12] the notion of continuous plurisubharmonic functions. In addition, semipositive metrics on line bundles were studied in detail by [Zha95, Gub98],
among others. On analytic curves, potential theory is well-established, due to the work of Thuillier [Thu05]. A
regularization theorem similar to Theorem B is proven in the higher-dimensional setting in [BFJ16, Theorem
B]. A related discussion appears in [BFJ08, Â§5].
The techniques involved in the proof of Theorem A rely crucially on the tree structure of the Berkovich
unit disc, and thus the proof does not, a priori, generalize to higher dimensions. More precisely, the proof
proceeds by ï¬rst constructing a ï¬nite subtree Î“Ï• of X that captures the worst of the singularities of Ï•, and
reducing to proving Theorem A on the convex hull of Î“Ï• âˆª {z}. For some end of the tree Î“Ï• , we construct a
new quasisubharmonic function Ï† such that Î“Ï† ( Î“Ï• and reduce to proving Theorem A for Ï†. This inductively
reduces Theorem A to a simple case, which is solved directly.
The paper is organized as follows. In Â§2, we brieï¬‚y review the deï¬nition of the Berkovich unit disc, and its
potential theory. In Â§2.3, we discuss Temkinâ€™s metric on the canonical bundle. In Â§3, we prove Theorem A and
a variant thereof. In Â§4, we construct the ideal HÏ• and the non-archimedean Demailly approximation Ï•m associated to a quasisubharmonic function Ï• and a positive integer m â‰¥ 1. These are then used to prove Theorem B.
Acknowledgements. I would like to thank my advisor, Mattias Jonsson, for suggesting the problem and for his
invaluable help, guidance, and support. I would also like to thank Kiran Kedlaya, JeÌroÌ‚me Poineau, and Daniele
Turchetti for helpful conversations regarding Lemma 2.1. I am grateful to Takumi Murayama and Emanuel
Reinecke for their many comments on a previous draft. Finally, I would like to thank the anonymous referee
for their many helpful comments, and for pointing out an error in a previous version. This work was partially
supported by NSF grant DMS-1600011.
2. Preliminaries
Let k be a ï¬eld complete with respect to a (possibly trivial) non-Archimedean absolute value | Â· |, and let
K := kca denote its completed algebraic closure. Let k â—¦ := {| Â· | â‰¤ 1} denote the valuation ring of k, and K â—¦ the
valuation ring of K.
To establish conventions, we brieï¬‚y recall in Â§2.1 the deï¬nition of the Berkovich unit disc over a (not necessarily
algebraically closed) non-Archimedean ï¬eld k, and describe its points; in Â§2.2, we review the metric tree structure
and potential theory on the Berkovich unit disc. Finally, in Â§2.3, we discuss the canonical metric of Temkin on
the canonical bundle of a k-aï¬ƒnoid space.
2.1. The Berkovich unitPdisc. The Tate algebra k{T } in the variable T is the subalgebra of k[[T ]] consisting
âˆ
of those power series f = i=0 ai T i , with ai âˆˆ k, such that |ai | â†’ 0 as i â†’ âˆ. The Tate algebra is a Banach
k-algebra when equipped with the Gauss norm
|f (xG )| := max |ai |.
iâ‰¥0

See [BGR84, Â§5.1] for further details.
The Berkovich unit disc is the set X := M(k{T }) of multiplicative seminorms on the Tate algebra k{T }
which extend the absolute value on k and which are bounded above by the Gauss norm xG . When equipped

4

MATTHEW STEVENSON

with the topology of pointwise convergence, X is a compact Hausdorï¬€ path-connected space. Let H(x) denote
the completed residue ï¬eld of x âˆˆ X.
Deï¬ne a partial order â‰¤ on X by declaring that x â‰¤ y if and only if |f (x)| â‰¤ |f (y)| for all f âˆˆ k{T }; in
this way, the pair (X, â‰¤) becomes a rooted tree with root at the Gauss point xG . The tree structure on X is
discussed in more detail in Â§ 2.2.
Let Gal(k a /k) denote the group of automorphisms of k a ï¬xing k (though k a /k is not Galois when k is not
perfect), and let XK := M(K{T }) denote the ground ï¬eld extension of X to K, which comes equipped with a
continuous surjective map Ï€ : XK â†’ X. The ground ï¬eld extension XK carries a Gal(k a /k)-action, extending
âˆ¼
the natural action on K by isometries, such that Ï€ induces a homeomorphism XK /Gal(k a /k) âˆ’â†’ X, where
a
XK /Gal(k /k) has the quotient topology. See [Ber90, p.18] and [BR10, Â§1] for further details.
Given z âˆˆ K â—¦ and r âˆˆ [0, 1], we may construct a point xz,r âˆˆ XK as the sup-norm over the closed disc
D(z, r) âŠ‚ K â—¦ of radius r about z; that is,
|f (xz,r )| :=

sup

|f (z â€² )|,

f âˆˆ K{T }.

z â€² âˆˆD(z,r)

The point Ï€(xz,r ) âˆˆ X will again be denoted by xz,r . When K 6= k, it is possible that two pairs (z, r) and (z â€² , râ€² )
may deï¬ne the same point of X; for example, if z â€² âˆˆ Gal(k a /k) Â· {z} and r > 0, then xzâ€² ,r = xz,r .
When z âˆˆ (k a )â—¦ and r = 0, the associated point xz,0 is called a rigid point ; the seminorm xz,0 coincides with
the seminorm induced by the maximal ideal of k{T } generated by the minimal polynomial of z over k. Let X rig
denote the subset of rigid points. The points of X can be classiï¬ed into 4 types:
(i)
(ii)
(iii)
(iv)

a type 1 point is of the form xz,0 âˆˆ X for z âˆˆ K â—¦ ;
a type 2 point is of the form xz,r âˆˆ X for z âˆˆ K â—¦ and r âˆˆ (0, 1] âˆ© |K âˆ— |;
a type 3 point is of the form xz,r âˆˆ X for z âˆˆ K â—¦ and r âˆˆ (0, 1]\|K âˆ— |;
a type 4 point is the pointwise limit of xzi ,ri such that the corresponding discs D(zi , ri ) form a decreasing
sequence with empty intersection.

See [Ber90, p.18] for further details; when K 6= k, see also [Ked11, Proposition 2.2.7]. When k is nontriviallyvalued, the set of rigid points and the set of type 2 points are both dense in X. Points of type 4 exist only when
k is not spherically complete.
For any x âˆˆ X, the multiplicity of x is m(x) := #Ï€ âˆ’1 (x) âˆˆ Z>0 âˆª {âˆ}. The points of type 1 with ï¬nite
multiplicity are precisely the rigid points. All points of type 2 and type 3 have ï¬nite multiplicity.
Lemma 2.1. Assume k is trivially-valued or has residue characteristic zero. For any x âˆˆ X of type 2 or 3,
there exists xâ€² âˆˆ X rig such that xâ€² â‰¤ x and m(xâ€² ) = m(x).
The statement of Lemma 2.1 is not necessarily true for a nontrivially-valued ï¬eld of positive residue character2pâˆ’1
istic. For example, if k = Qp and x is the type 2 point of XCp corresponding to the closed disc D(p1/p , |p| p(pâˆ’1) )
in (Cp )â—¦ , then Ï€(x) âˆˆ X is a type 2 point of with m(Ï€(x)) = 1, but there is no Qp -rational point lying below it.
Proof. Let d = m(x), let x1 , . . . , xd be the Ï€-preimages of x, and let G := Gal(k a /k). Each xi is the sup-norm
over a closed disc Di âŠ† K â—¦ of radius r(x) > 0. It suï¬ƒces to show that there is z1 âˆˆ D1 âˆ© (k a )â—¦ such that
G Â· {z1 } = {z1 , . . . , zd } with zi âˆˆ Di . Fix any z1 âˆˆ D1 âˆ© (k a )â—¦ , then it is easy to see that any such z1 has
#G Â· {z1 } â‰¥ d.
Assume k is trivially-valued. If r(x) = 1, the problem is trivial. If r(x) < 1, then each D i contains a unique
rigid point; in particular, G Â· {z1 } has size precisely equal to d.
Assume now that k has residue characteristic zero. The case when d = 1 is [Ax70, Proposition 2â€™] and we
deduce the general case using a similar strategy (the d = 1 case also follows from the main result of [Sch15]).
Let z1 , . . . , zâ„“ âˆˆ G Â· {z1 } be those conjugates of z1 that lie in D1 . We claim each Di contains precisely â„“
elements of the orbit G Â· {z1 }. Indeed, by assumption there exists Ïƒi âˆˆ G such that Ïƒi (z1 ) âˆˆ Di , from which it
follows that Ïƒi (zj ) âˆˆ Di for all j = 1, . . . , â„“ since G acts by isometries. As Ïƒi is an automorphism of k a , it must

A NON-ARCHIMEDEAN OHSAWAâ€“TAKEGOSHI EXTENSION THEOREM

5

âˆ¼

give a bijection G Â· {z1 } âˆ© D1 â†’ G Â· {z1 } âˆ© Di , which gives the claim. Now, for all i = 1, . . . , d, set
X
wi := â„“âˆ’1
u.
uâˆˆGÂ·{z1 }âˆ©Di

As the residue characteristic of k is zero, |â„“| = 1 and hence




X



|Ïƒi (z1 ) âˆ’ u| â‰¤ r(x).
|Ïƒi (z1 ) âˆ’ wi | = â„“Ïƒi (z1 ) âˆ’
u â‰¤
max

 uâˆˆGÂ·{z1 }âˆ©Di
uâˆˆGÂ·{z }âˆ©D
1

i

In particular, wi âˆˆ Di . Moreover, we have G Â· {w1 } = {w1 , . . . , wd } by construction.



The Berkovich unit disc X comes equipped with a structure sheaf OX on the G-topology on X. The k-algebra
of global sections of OX is the Tate algebra k{T }. See [Ber90, 2.3] for further details.
2.2. Quasisubharmonic functions on the Berkovich unit disc. In this section, we discuss the metric
tree structure and potential theory on the Berkovich unit disc. For a comprehensive treatment, see [BR10]
and [Jon15].
For each x âˆˆ X, deï¬ne an equivalence relation âˆ¼ on the set X\{x} by declaring y âˆ¼ z if the paths (x, y] and
(x, z] intersect. The tangent space TX,x at x is the set of equivalences classes of X\{x} modulo âˆ¼. For each
~v âˆˆ TX,x , let U (~v ) be the set of points of X representing ~v , and set m(~v ) := inf yâˆˆU(~v) m(y). The subsets of the
form U (~v ), for some tangent direction ~v , form a subbasis of open sets for the topology on X. See [Jon15, Â§2.3]
for further details.
The closed unit disc X may be equipped with a generalized metric, in the sense that the distance between two
points may be inï¬nite; in particular, X gains the structure of a metric tree. This generalized metric is described
as follows. Let r : X â†’ [0, 1] denote the radius function, which can be thought of as a Gal(k a /k)-equivariant
function on XK . Deï¬ne a function Î± : X â†’ [0, +âˆ] by specifying that Î±(xG ) = 0 and
Z x
1
d (log r(z)) ,
(2.1)
Î±(x) âˆ’ Î±(y) = âˆ’
m(z)
y
for any two distinct points x, y âˆˆ X, where the integral is taken over the unique path in X joining the points x
and y. These constraints completely determine a function Î± : X â†’ [âˆ’âˆ, +âˆ] whose restriction to any segment
is monotone decreasing. Observe that, when k = k a , Î± = âˆ’ log r. This, in turn, induces a generalized metric d
on X by setting
d(x, y) := |Î±(x) âˆ’ Î±(x âˆ¨ y)| + |Î±(y) âˆ’ Î±(x âˆ¨ y)|
for x, y âˆˆ X; here, x âˆ¨ y is the least upper bound of x and y. The rooted tree (X, â‰¤) acquires the structure
of a metric tree when equipped with the generalized metric d. It is important to note that the topology on X
induced by d is strictly ï¬ner than the native topology.
One can discuss potential theory and the notion of quasisubharmonic functions on any metric tree, as developed in [Jon15, Â§2.5]. We brieï¬‚y recall this theory in the special case of the Berkovich disc. This is also discussed
in [BR10, Â§5] (though our conventions diï¬€er slightly).
Fix a ï¬nite atomic measure Ï0 supported at xG , i.e. Ï0 is a positive real multiple of the Dirac mass Î´xG at
the Gauss point xG . A function Ï• : X â†’ [âˆ’âˆ, âˆ) is called Ï0 -subharmonic if it satisï¬es:
(1) for every ï¬nite subtree Y âŠ‚ X\X rig containing xG , Ï•|Y is a continuous function on Y such that:
(a) Ï•|Y is convex on any segment in Y that does not contain xG ;
(b) for any y âˆˆ Y ,
X
Ï0 {y} +
d~v (Ï•|Y ) â‰¥ 0,
~
v âˆˆTy Y

where d~v (Ï•|Y ) denotes the directional derivative of Ï•|Y in the direction ~v .

6

MATTHEW STEVENSON

(2) Ï• is the limit of its retractions to ï¬nite subtrees containing xG ; more precisely, if {Yi }iâˆˆI denotes the
net of ï¬nite subtrees of X\X rig containing xG and if ri : X â†’ Yi is the (continuous) retraction map of
X onto Yi , then Ï• = lim râˆ—i Ï•.
i

The condition (b) is equivalent to the subaverage property: for any y âˆˆ Y , there exists r > 0 such that
X
1
Ï•(z) + mass(Ï0 )r Â· 1{xG } (y),
Ï•(y) â‰¤
|BY (y, r)|
zâˆˆBY (y,r)

where BY (y, r) := {z âˆˆ Y : d(y, z) = r} is the ball of radius r about y in Y , and 1{xG } is the indicator function
of the point xG . This is reminiscient of the classical deï¬nition of subharmonic functions on Rn .
A function is said to be quasisubharmonic if it is Ï0 -subharmonic for some measure Ï0 as above. The class
of Ï0 -subharmonic functions on X is a convex set, which is closed under taking ï¬nite maxima and decreasing
(pointwise) limits. A quasisubharmonic function is upper-semicontinuous, but it may take the value âˆ’âˆ; this
can only occur at those points x âˆˆ X such that Î±(x) = +âˆ.
Given a topological space Z and a function Ï† : Z â†’ [âˆ’âˆ, âˆ) that is locally bounded above, the uppersemicontinuous (usc) regularization Ï†âˆ— of Ï† is deï¬ned by the formula
Ï†âˆ— (z) := lim sup Ï†(y),

z âˆˆ Z.

yâ†’z

The usc regularization Ï†âˆ— is the smallest usc function such that Ï†âˆ— â‰¥ Ï†.
Lemma 2.2. If {Ï•i }iâˆˆI is a net of Ï0 -subharmonic functions on X which is locally bounded above, then the usc
regularization Ïˆ âˆ— of Ïˆ := supiâˆˆI Ï•i is Ï0 -subharmonic. Furthermore, Ïˆ âˆ— = Ïˆ on X\{Î± = +âˆ}.
The proof of Lemma 2.2 is a minor variation on [BR10, Proposition 8.23(E)].
The rest of this section is devoted to a brief discussion of the Laplacian of a quasisubharmonic function.
Given a Ï0 -subharmonic function Ï• and any ï¬nite subtree Y âŠ‚ X containing xG , let âˆ†(Ï•|Y ) be the unique
signed Borel measure on Y determined by the following rule: if ~v1 , . . . , ~vn are tangent directions in Y such that
U (~vi ) âˆ© U (~vj ) 6= âˆ… and U (~vi ) 6âŠ† U (~vj ) for all i 6= j, then
!
n
n
X
\
dv~i (Ï•|Y ) .
U (~
vi ) = âˆ’
âˆ†(Ï•|Y )
i=1

i=1

The Laplacian is the signed Borel measure âˆ†Ï• uniquely characterized by the following property: for any ï¬nite
subtree Y âŠ‚ X containing xG ,
(rY )âˆ— (Ï0 + âˆ†Ï•) = Ï0 + âˆ† (Ï•|Y ) ,
where rY : X â†’ Y is the (continuous) retraction map of X onto Y . There are several Laplacians deï¬ned in the
literature, and the above deï¬nition follows the conventions of [FJ05, Jon15] and it diï¬€ers from that of [BR10]
by a negative sign; see [BR10, Â§5.8] for a discussion of the various Laplacian operators.
Quasisubharmonic functions and their Laplacians behave well with respect to the ground ï¬eld extension
morphism Ï€ : XK â†’ X, in the following sense: given a Ï0 -subharmonic function Ï• on X, Ï€ âˆ— Ï• is a Ï€ âˆ— Ï0 subharmonic function on XK and âˆ†Ï• = Ï€âˆ— âˆ†(Ï€ âˆ— Ï•).
Example 2.3. For any irreducible f âˆˆ k{T }, the function Ï• := log |f | is Ï0 -subharmonic, where Ï0 = m(x) Â· Î´xG
and x âˆˆ X rig is the rigid point of X corresponding to the maximal ideal (f ) of k{T }. It is easy to check that
âˆ†Ï• = m(x) (Î´x âˆ’ Î´xG ) .
More generally, for any f âˆˆ k{T }, the function log |f | is quasisubharmonic and its Laplacian can be identiï¬ed,
up to scaling and adding a multiple of Î´xG , with the divisor of zeros of f via the PoincareÌâ€“Lelong formula.
See [BR10, Example 5.20].
In fact, for any x âˆˆ X with m(x) < +âˆ, the function Ï• = âˆ’Î±(x âˆ¨ Â·) is m(x) Â· Î´xG -subharmonic with Laplacian
given by âˆ†Ï• = m(x) (Î´x âˆ’ Î´xG ).

A NON-ARCHIMEDEAN OHSAWAâ€“TAKEGOSHI EXTENSION THEOREM

7

For a quasisubharmonic function Ï• on X, we may construct a metric on OX : to a local section f of OX over
an analytic domain V âŠ‚ X, we assign the function x 7â†’ |f (x)|eâˆ’Ï•(x) , for x âˆˆ V . This convention mirrors how
(semipositive) metrics on line bundles on complex manifolds are locally given by plurisubharmonic functions, as
in e.g. [Dem12, Â§3].
2.3. Temkinâ€™s metric. In [Tem16], Temkin introduces a canonical lower-semicontinuous metric AZ on the
canonical bundle Ï‰Z/k of any k-analytic space Z. We will explain the construction of AZ when Z is a k-aï¬ƒnoid
space. In the sequel, the metric AZ will play a crucial role when Z is the closed unit disc.
To a contractive morphism A â†’ B of seminormed rings, the module â„¦B/A of KaÌˆhler diï¬€erentials may be
equipped with the maximal seminorm k Â· kB/A making the derivation d : B â†’ â„¦B/A into a contractive A-module
morphism. Explicitly,
kskB/A = Pinf â€² max |bi | Â· |bâ€²i |,
s=

i

bi d(bi )

i

P

b B/A denote the separated completion of
where the inï¬mum is taken over all representations s = i bi d(bâ€²i ). Let â„¦
b B/A is the completed module of KaÌˆhler
â„¦B/A with respect to k Â· kB/A ; this is a Banach B-module. We say that â„¦
b B/A . See [Tem16, 4.1] for further details.
differentials and we say its norm k Â· kB/A is the KaÌˆhler norm on â„¦
b A/k has an alternate description: if J is the kernel of the multiplication
For a k-aï¬ƒnoid algebra A, the module â„¦
2
b
b A/k is induced from the bounded map A â†’ J
b
map AâŠ—k A â†’ A, then â„¦A/k = J /J . The derivation d : A â†’ â„¦
b A/k as an A-module.
b âˆ’ aâŠ—1.
b The image of the derivation d generates â„¦
of Banach A-modules given by a 7â†’ 1âŠ—a
This is the approach taken in [Ber93, 3.3].
b A/k determines a coherent OZ -module
Let Z = M(A) be a k-aï¬ƒnoid space. The ï¬nite Banach A-module â„¦
b A/k ) on Z. Temkin provides a canonical metric on each stalk of â„¦Z/k , as well as on the stalks of its
â„¦Z/k := OZ (â„¦
exterior powers (and in particular, on the canonical bundle). This was originally introduced as a generalization
of the weight function of [MN15]. It has arisen in other contexts more recently, e.g. as a log discrepancy-type
function in [BJ16, 5.6].
For any z âˆˆ Z, there is a natural homomorphism of k-algebras
â‰ƒ b
Ïˆz : â„¦Z/k,z âˆ’â†’ â„¦Z/k,z âŠ—OZ,z H(z) âˆ’â†’ â„¦
H(z)/k ,

which extends the natural isomorphism from the completed ï¬bre of â„¦Z/k at z to the completed module of KaÌˆhler
diï¬€erentials of H(z)/k. Let Ï€ : ZK â†’ Z denote the ground ï¬eld extension of Z.
Fix z âˆˆ Z. The canonical metric k Â· kz on â„¦Z/k,z is deï¬ned by the following rule: for any germ s âˆˆ â„¦Z/k,z , set
kskz := kÏˆzâ€² (Ï€ âˆ— s) kH(zâ€² )/k
for any z â€² âˆˆ Ï€ âˆ’1 (z). This is independent of the choice of z â€² . In particular, if k = k a , then kskz = kÏˆz (s)kH(z)/k ,
b H(z)/k . This metric naturally extends to
i.e. k Â· kz is the norm on â„¦Z/k,z deï¬ned by pulling back the norm on â„¦
the the exterior powers of â„¦Z/k and, in particular, to the canonical bundle Ï‰Z/k . For the various properties of
the canonical metric, see [Tem16, Â§6].
The canonical metric, as deï¬ned above, is called the â€œgeometric KaÌˆhler normâ€ in [Tem16, 6.3.15]. When
b H(z)/k (without ï¬rst passing
k 6= k a , if one deï¬nes the metric on the stalk â„¦Z/k,z by pulling back the metric on â„¦
to the completed algebraic closure), then the metric may be quite poorly behaved (for example when k has wild
extensions). See [Tem16, 6.2].
If Ï‰Z/k is trivial, a trivializing section Î· of Ï‰Z/k gives rise to a lower-semicontinuous function AZ : Z â†’ [0, +âˆ]
deï¬ned by the following property: for any z âˆˆ Z, write a germ s âˆˆ Ï‰Z/k,x as s = f Â· Î·x for some f âˆˆ OZ,z , where
Î·x is the image of Î· in Ï‰Z/k,z . Then,
kskz = |f (z)|eâˆ’AZ (z) .
The function AZ depends on the choice of trivializing section Î·, but we suppress this dependence in the notation.

8

MATTHEW STEVENSON

For our purposes, the important special case is when X = M(k{T }) is the closed unit disc. The completed
b k{T }/k of KaÌˆhler diï¬€erentials is the free Banach k{T }-module on the diï¬€erential dT and, followmodule â„¦
ing [Tem16, 6.2.1], the canonical metric admits a simple description: for any x âˆˆ X and any global section f Â· dT
b k{T }/k , we have
of â„¦
kf Â· dT kx = |f (x)|r(x) = |f (x)|eâˆ’AX (x) ,

where r : X â†’ [0, 1] is the radius function. Thus, AX = âˆ’ log r. This description holds regardless of whether or
not k is algebraically closed. Observe that AX = +âˆ on the type 1 points of X.
The function AX is convex on any segment of X and, in fact, its directional derivatives admit a simple
expression: if x âˆˆ X with m(x) < +âˆ and ~v âˆˆ TX,x is a direction such that U (~v ) âˆ© X rig 6= âˆ…, then d~v A = m(~v )
X (x)
. Moreover, (2.1) shows that Am(x)
â‰¤ Î±(x) â‰¤ AX (x) for x âˆˆ X.
In Â§3 and Â§4, we will be concerned with â€œtwistsâ€ of the canonical metric AX on â„¦X/k by a metric on OX .
More precisely, for any quasisubharmonic function Ï• on X and any x âˆˆ X, we consider the metric k Â· kÏ•,x which,
to a global section f Â· dT of â„¦X/k , assigns the number
kf Â· dT kÏ•,x := |f (x)|eâˆ’Ï•(x)âˆ’AX (x) .
In fact, we will be interested in supxâˆˆX kf Â· dT kÏ•,x, which we write as kf kÏ• in the sequel.
3. An Ohsawaâ€“Takegoshi-type extension theorem

Let us brieï¬‚y recall the notation established in Â§2. Let k be a complete non-Archimedean ï¬eld, and assume in
addition that k is algebraically closed, trivially-valued, or is spherically complete of residue characteristic zero.
Let X = M(k{T }) be the Berkovich closed unit disc over k with Gauss point xG , let r : X â†’ [0, 1] be the radius
function, and let A := âˆ’ log r : X â†’ [0, +âˆ] be Temkinâ€™s metric.
In this section, we prove the following variant of Theorem A and derive Theorem A as an easy consequence.
Theorem 3.1. Let Ï• be a quasisubharmonic function on X with Ï•(xG ) = 0, and let Z(Ï•) = {Ï• = âˆ’âˆ} denote
the polar locus of Ï•. For any z âˆˆ X, there exists a constant Ç«0 > 0 and a nonzero polynomial f âˆˆ k[T ] such that
kf k(1+Ç«)Ï• :=

|f (x)|eâˆ’(1+Ç«)Ï•(x)âˆ’A(x) â‰¤ |f (z)|eâˆ’Ï•(z) for all Ç« âˆˆ [0, Ç«0 ].

sup
xâˆˆX\Z(Ï•)

If Ï•(z) = âˆ’âˆ, then we may find f such that kf k(1+Ç«)Ï• < +âˆ for all Ç« âˆˆ [0, Ç«0 ]. Moreover, if k is algebraically
closed and z âˆˆ X rig , then for any value a âˆˆ H(z)âˆ— = k âˆ— , we may find f such that f (z) = a.
We will prove Theorem 3.1 in Â§3.1. The hypotheses of Theorem 3.1 may be weakened to allow Ï•(xG ) â‰¥ 0, but
it is false if Ï•(xG ) < 0 (e.g. if Ï• = âˆ’1, then the only f that could satisfy the inequality in Theorem 3.1 at the
Gauss point is f = 0). Nonetheless, Theorem A, which has no hypothesis on the value of Ï•(xG ), may be easily
deduced from Theorem 3.1. Furthermore, the presence of the hypotheses on the ï¬eld k is discussed immediately
after the proof of Lemma 3.6
Proof of Theorem A. Given a quasisubharmonic function Ï• on X and a point z âˆˆ X, set Ï† := Ï• âˆ’ Ï•(xG ). Theorem 3.1 asserts that there is a nonzero polynomial f âˆˆ k[T ] such that kf k(1+Ç«)Ï† â‰¤ |f (z)|eâˆ’Ï†(z) for all Ç« > 0
suï¬ƒciently small. Thus,
lim kf k(1+Ç«)Ï• = eÏ•(xG ) lim+ eÇ«Ï•(xG ) kf k(1+Ç«)Ï† â‰¤ |f (z)|eâˆ’Ï†(z)+Ï•(xG ) = |f (z)|eâˆ’Ï•(z) .

Ç«â†’0+

Ç«â†’0

This completes the proof of Theorem A.



As discussed in Â§1, the optimal constant appearing in the classical Ohsawaâ€“Takegoshi theorem for the complex
unit disc is Ï€. In the non-Archimedean setting, however, the optimal constant is 1, in the following sense.

A NON-ARCHIMEDEAN OHSAWAâ€“TAKEGOSHI EXTENSION THEOREM

9

Corollary 3.2. For any z âˆˆ X, let c(z) be the smallest positive number such that for any quasisubharmonic
function Ï• on X, there exists a nonzero f âˆˆ k{T } satisfying
lim kf k(1+Ç«)Ï• â‰¤ c(z)|f (z)|eâˆ’Ï•(z).

Ç«â†’0+

Then, c(z) = 1.
Proof. If Ï• â‰¡ 0, then |f (xG )| = limÇ«â†’0+ kf k(1+Ç«)Ï• â‰¤ c(z)|f (z)| â‰¤ c(z)|f (xG )|. As |f (xG )| 6= 0, it follows that

c(z) â‰¥ 1. Theorem A asserts that the lower bound c(z) = 1 is achieved for any z.
3.1. Proof of Theorem 3.1. Fix z âˆˆ X. Suppose Ï• is Ï0 -subharmonic for some ï¬nite (atomic) measure Ï0
supported at the Gauss point xG , and Ï•(xG ) = 0. To simplify the exposition, we assume Ï•(z) > âˆ’âˆ. When
Ï•(z) = âˆ’âˆ, the proof is similar: one proves analogues of the sequence of lemmas below, each of which is made
easier because one is only concerned with ensuring that a quantity is ï¬nite, as opposed to ensuring that the
same quantity is less than some ï¬xed value.
The strategy of the proof is to use strong induction on âŒŠmass(Ï0 )âŒ‹. For this reason, the following terminology
will be quite helpful.
Definition 3.3. Let Ç«0 > 0. A nonzero polynomial f âˆˆ k[T ] is a (Ï•, Ç«0 )-extension at z if the inequality
kf k(1+Ç«)Ï• â‰¤ |f (z)|eâˆ’Ï•(z)
holds for all Ç« âˆˆ [0, Ç«0 ]. Equivalently, f is a (Ï•, Ç«0 )-extension if for all x âˆˆ X\Z(Ï•) and all Ç« âˆˆ [0, Ç«0 ], we have
log |f (x)| âˆ’ log |f (z)| â‰¤ A(x) + (1 + Ç«)Ï•(x) âˆ’ Ï•(z).
As Ï• â‰¤ 0, in order to verify that f is an (Ï•, Ç«0 )-extension at z, it suï¬ƒces to check kf k(1+Ç«0 )Ï• â‰¤ |f (z)|e
as opposed to verifying it for all Ç« âˆˆ [0, Ç«0 ].
The key players in the proof of Theorem 3.1 are the ï¬nite subtrees


n
Î“Ï•,n := x âˆˆ X : (Ï0 + âˆ†Ï•){y â‰¤ x} â‰¥
m(x) .
n+1

(3.1)
âˆ’Ï•(z)

,

n
m(x)
for n â‰¥ 1. Note that Î“Ï•,n is indeed a ï¬nite subtree of X, since any end x of Î“Ï•,n satisï¬es (Ï0 +âˆ†Ï•){x} â‰¥ n+1
and Ï0 + âˆ†Ï• is a positive measure of ï¬nite mass equal to mass(Ï0 ). It is clear that Î“Ï•,n âŠ‡ Î“Ï•,n+1 for any n â‰¥ 1;
in particular,
\
Î“Ï• :=
Î“Ï•,n = {x âˆˆ X : (Ï0 + âˆ†Ï•){y â‰¤ x} â‰¥ m(x)}
nâ‰¥1

is a ï¬nite subtree of X that is contained in Î“Ï•,n for any n â‰¥ 1.
The subtrees Î“Ï•,n are crucial in reducing Theorem 3.1 to a â€œï¬niteâ€ problem. Observe that any point of Î“Ï•,n
must have a ï¬nite multiplicity because mass(Ï0 ) is ï¬nite and, moreover, Î“Ï•,n âˆ© X rig âŠ† Z(Ï•). Variants of this
tree appear in [Jon15, Prop 2.8] and [FJ05, Lem 7.7].
The following is the base case for our induction.

Lemma 3.4. If mass(Ï0 ) < 1, there exists a constant Ç«0 > 0 such that any nonzero constant function is a
(Ï•, Ç«0 )-extension at z.
0)
Proof. Set Ç«0 := 1âˆ’mass(Ï
v (1 + Ç«)Ï•| â‰¤ (1 + Ç«) mass(Ï0 ) â‰¤ 1 for all tangent
mass(Ï0 ) . Since mass(Ï0 ) < 1, Î“Ï• = âˆ… and |d~
directions ~v in X, provided Ç« âˆˆ [0, Ç«0 ]. To check that any constant function is a (Ï•, Ç«0 )-extension at z, it suï¬ƒces
to check that 0 â‰¤ A + (1 + Ç«)Ï• âˆ’ Ï•(z) on X\Z(Ï•). This inequality is satisï¬ed at the Gauss point:

A(xG ) + (1 + Ç«)Ï•(xG ) âˆ’ Ï•(z) = âˆ’Ï•(z) â‰¥ 0.
Moreover, the convexity of Ï• and of A ensures that it is enough to check that, in any tangent direction at xG ,
the function (1 + Ç«)Ï• + A only increases in that direction. However, in any such direction ~v ,
d~v ((1 + Ç«)Ï• + A) â‰¥ âˆ’(1 + Ç«) mass(Ï0 ) + 1 â‰¥ 0,

10

MATTHEW STEVENSON

which completes the proof.



Now, if mass(Ï0 ) â‰¥ 1, then xG âˆˆ Î“Ï•,n for all n â‰¥ 1, because m(xG ) = 1. In particular, Î“Ï•,n 6= âˆ… and the set of
ends1 Ends(Î“Ï•,n ) is nonempty. Let Î“â€²Ï•,n denote the convex hull of Î“Ï•,n âˆª {z}. Let rÎ“â€²Ï•,n : X â†’ Î“â€²Ï•,n denote the
retraction of X onto Î“â€²Ï•,n . For any n â‰¥ 1, observe that a (râˆ—Î“â€²Ï•,n Ï•, Ç«0 )-extension f at z is also a (Ï•, Ç«1 )-extension
at z, where Ç«1 = min{Ç«0 , n1 }. Indeed, for any x âˆˆ Î“â€²Ï•,n and any direction ~v âˆˆ TX,x such that U (~v ) âˆ© Î“â€²Ï•,n = âˆ…, we
have


n
d~v ((1 + Ç«)Ï• + A) > âˆ’(1 + Ç«)
+ 1 m(x) â‰¥ 0
n+1

for all Ç« âˆˆ [0, Ç«1 ]. Thus, for ï¬xed n â‰¥ 1, we may replace Ï• with râˆ—Î“â€²Ï•,n Ï• to assume that Ï• is locally constant oï¬€
of Î“â€²Ï•,n .
Fix n â‰¥ 1 such that
G
Î“Ï•,n \Î“Ï• =
[xj , xÌƒj ),
(3.2)
jâˆˆJ

where J is a ï¬nite index set, and for all j âˆˆ J, xÌƒj âˆˆ Î“Ï• and the point xj is of type 2 or 3 such that the multiplicity
function is constant on [xj , xÌƒj ). Moreover, for each j âˆˆ J, if ~vj âˆˆ TX,xÌƒj denotes the unique tangent direction at
xÌƒj with xj âˆˆ U (~vj ), then d~vj Ï• = âˆ’m(xj ).
As mentioned before, the strategy of the proof of Theorem 3.1 is by strong induction on âŒŠmass(Ï0 )âŒ‹. In
the following sequence of lemmas, we explain how to reduce the problem of the existence of a (Ï•, Ç«0 )-extension
at z to the existence of a (Ï†, Ç«1 )-extension at z, where Ï† is a Ï-subharmonic for some ï¬nite measure Ï with
mass(Ï) â‰¤ mass(Ï0 ) âˆ’ 1 and 0 < Ç«1 â‰¤ Ç«0 . As mass(Ï0 ) is ï¬nite, after ï¬nitely-many such reductions we must
ï¬nd ourselves in the setting of Lemma 3.4. The hypotheses of each lemma are concerned with which types of
points may arise in the ï¬nite set Ends(Î“Ï•,n ); in particular, if one assumes that k is spherically complete, one
can ignore Lemma 3.7.
Lemma 3.5. Suppose that mass(Ï0 ) â‰¥ 1 and that there exists x âˆˆ Ends(Î“Ï•,n ) of type 1. Then, there exists
Ç«1 > 0 and a Ï-subharmonic function Ï†, with mass(Ï) â‰¤ mass(Ï0 ) âˆ’ 1, such that a (Ï•, Ç«0 )-extension f at z may
be constructed from a (Ï†, Ç«1 )-extension fËœ at z.
Proof. By assumption, x âˆˆ Î“Ï• and so it satisï¬es m(x) < +âˆ; in particular, x âˆˆ X rig , because x is of type 1.
In addition, as Î“Ï• âˆ© X rig âŠ† Z(Ï•) and z 6âˆˆ Z(Ï•), we have x 6= z. Let mx denote the maximal ideal of k{T }
corresponding to x, and let g be a polynomial generator of mx with |g(xG )| = 1. As type-1 points are minimal
with respect to the partial order â‰¤, we have
1 â‰¤ m(x) â‰¤ (Ï0 + âˆ†Ï•){y âˆˆ X : y â‰¤ x} = âˆ†Ï•{x}.
Set c :=

âˆ†Ï•{x}
m(x)

â‰¥ 1, Î³ := âŒŠcâŒ‹, and Ï := Ï0 âˆ’ Î³Î´xG , then the function Ï† := Ï• âˆ’ Î³ log |g| is Ï-subharmonic and
Ï†(xG ) = 0. Suppose there exists Ç«1 > 0 and a (Ï†, Ç«1 )-extension fËœ âˆˆ k[T ] at z and set f := g Î³ fËœ. We claim that
there exists Ç«0 âˆˆ (0, Ç«1 ] such that f is a (Ï•, Ç«0 )-extension at z.
Case 1. Consider the case when c is an integer. If z â€² := rÎ“Ï•,n (z), then Î“â€²Ï•,n = Î“Ï•,n âˆª [z, z â€² ]. If z â€² 6= z, let
~vz âˆˆ TX,zâ€² be the unique direction at z â€² with z âˆˆ U (~vz ). The function y 7â†’ |f (y)|eâˆ’(1+Ç«0 )Ï•(y)âˆ’A(y) is decreasing
m(~
vz )
in the direction ~vz provided d~vz (âˆ’(1 + Ç«0 )Ï• âˆ’ A) â‰¤ 0. This occurs if Ç«0 â‰¤ nm(z
â€² ) . Thus, it suï¬ƒces to ï¬nd Ç«0 > 0
such that
|f (y)|eâˆ’(1+Ç«0 )Ï•(y)âˆ’A(y) â‰¤ |f (z)|eâˆ’Ï•(z) = |fËœ(z)|eâˆ’Ï†(z)
1If Î“ is a subtree of X that contains x , we adopt the following conventions: if Î“ ) {x }, then Ends(Î“) consists of those points
G
G
in Î“ with a unique tangent direction in Î“; if Î“ = {xG }, then Ends(Î“) = Î“.

A NON-ARCHIMEDEAN OHSAWAâ€“TAKEGOSHI EXTENSION THEOREM

11

e Ï†,n = Î“Ï†,n âˆª {xG } (where we must include xG in case Î“Ï†,n is empty). If y âˆˆ Î“
e Ï†,n , then
for all y âˆˆ Î“Ï•,n . Set Î“
n
Ï†(y) â‰¤ âˆ’ n+1 Î±(y), and hence
n
âˆ’Ç«0 cm(x)+ n+1

(Ç«1 âˆ’Ç«0 )
|g(y)|âˆ’Ç«0 c e(Ç«1 âˆ’Ç«0 )Ï†(y) â‰¤ eâˆ’Î±(y)

and this is less than or equal to 1 provided Ç«0 â‰¤

Ç«1 n
m(x)c(n+1)+n .

Granted this, observe that

|f (y)|eâˆ’(1+Ç«0 )Ï•(y)âˆ’A(y) = |g(y)|âˆ’Ç«0 c e(Ç«1 âˆ’Ç«0 )Ï†(y) |fËœ(y)|eâˆ’(1+Ç«1 )Ï†(y)âˆ’A(y) â‰¤ |fËœ(y)|eâˆ’(1+Ç«1 )Ï†(y)âˆ’A(y) â‰¤ |fËœ(z)|eâˆ’Ï†(z) ,
e Ï†,n âˆ© [x, xG ] and let ~vx âˆˆ TX,xÌƒ be the unique direction
as required. Let xÌƒ denote the minimal element of Î“
e
at xÌƒ such that x âˆˆ U (~vx ). As Î“Ï•,n = Î“Ï†,n âˆª [x, xG ], it suï¬ƒces to ï¬nd an Ç«0 > 0 such that the function
y 7â†’ |f (y)|eâˆ’(1+Ç«0 )Ï•(y)âˆ’A(y) is decreasing in the direction ~vx , or equivalently
d~vx (Ç«0 m(x)cÎ± âˆ’ (1 + Ç«0 )Ï† âˆ’ A) â‰¤ 0.

m(~
vx )
.
This occurs if Ç«0 â‰¤ (c(n+1)+n)m(x)
Case 2. Now, suppose c is not an integer, i.e. c > Î³. Write Ï• = Ïˆ + c log |g| for some quasisubharmonic
. It is straightforward to check that Ç«1 Ï† â‰¤ Ç«0 Ï• on all of X. Thus,
function Ïˆ on X with Ïˆ â‰¤ 0. Set Ç«0 = Ç«1 (câˆ’Î³)
c
for any y âˆˆ X\Z(Ï•), we have

|f (y)|eâˆ’(1+Ç«0 )Ï•(y)âˆ’A(y) = eÇ«1 Ï†(y)âˆ’Ç«0 Ï•(y) |fËœ(y)|eâˆ’(1+Ç«1 )Ï†(y)âˆ’A(y) â‰¤ |fËœ(z)|eâˆ’Ï†(z) = |f (z)|eâˆ’Ï•(z) ,
which completes the proof.

Lemma 3.6. Suppose that mass(Ï0 ) â‰¥ 1 and that there exists x âˆˆ Ends(Î“Ï•,n ) of type 2 or of type 3 such that
rÎ“Ï•,n (z) 6= x. Then, there exists Ç«1 > 0 and a Ï-subharmonic function Ï†, with mass(Ï) â‰¤ mass(Ï0 ) âˆ’ 1, such that
a (Ï•, Ç«0 )-extension f at z may be constructed from a (Ï†, Ç«1 )-extension fËœ at z.
Proof. By Lemma 2.1, there exists xâ€² âˆˆ X rig such that rÎ“Ï•,n (xâ€² ) = x and m(xâ€² ) = m(x). If x âˆˆ Î“Ï• , then set
â€²
c := âˆ†Ï•{x}
m(x) â‰¥ 1. We construct a new Ï0 -subharmonic function Ï• by extending Ï• linearly with slope cm(x) from
â€²
â€²
the end x to the rigid point x ; more precisely, Ï• is given by the formula
Ï•â€² (y) := Ï•(y) + cm(x) (Î±(y âˆ¨ x) âˆ’ Î±(y âˆ¨ xâ€² )) .
It is clear that Ï•â€² (xG ) = 0, Ï•â€² (z) = Ï•(z), and Ï•â€² â‰¤ Ï•. In particular, any (Ï•â€² , Ç«0 )-extension at z is also a
(Ï•, Ç«0 )-extension at z.
If x âˆˆ Î“Ï•,n \Î“Ï• , then by the assumption (3.2), we can replace Ï• with a function that is linear on [x, rÎ“Ï• (x)]

with slope m(rÎ“Ï• (x)) and then repeat the same argument as above.
The proof of Lemma 3.6 is one point in the proof of Theorem 3.1 where the additional assumptions on the ï¬eld
k are needed (in order to be able to apply Lemma 2.1). If one were to pick xâ€² âˆˆ X rig such that m(xâ€² ) > m(x),
then the function Ï•â€² need not be quasisubharmonic.
In addition, the conditions on the ï¬eld k are such that the hypotheses of the following lemma can only occur
when k is algebraically closed and nontrivially-valued.
Lemma 3.7. Suppose that mass(Ï0 ) â‰¥ 1 and that there exists x âˆˆ Ends(Î“Ï•,n ) of type 4 and x 6= z. Then, there
exists Ç«1 > 0 and a Ï-subharmonic function Ï†, with mass(Ï) â‰¤ mass(Ï0 ) âˆ’ 1, such that a (Ï•, Ç«0 )-extension f at
z may be constructed from a (Ï†, Ç«1 )-extension fËœ at z.
Proof. By assumption, k is algebraically closed and nontrivially-valued (so the type 2 points of X are dense).
Moreover, all multiplicities are equal to 1 and Î± = A.
Note that, since x is of type 4, A(x) âˆˆ (0, +âˆ). Recall that Î“â€²Ï•,n denotes the convex hull of Î“Ï•,n âˆª {z} (we
allow the possibility that z âˆˆ Î“Ï•,n , so it is possible that Î“â€²Ï•,n = Î“Ï•,n ). Let xÌƒ âˆˆ (x, xG ] be the minimal point

12

MATTHEW STEVENSON

xG â€¢

zâˆ¨x â€¢

â€¢

â€¢ xÌƒ

rÎ“Ï• (z) â€¢

â€¢

z â€¢

â€¢

â€¢u â€¢ x
â€¢ uâ€²

Figure 1. One possible conï¬guration for Î“Ï•,n in the setting of Lemma 3.7.
with the property that {y âˆˆ Î“â€²Ï•,n : y â‰¤ xÌƒ} 6= [x, xÌƒ]. That is, xÌƒ is the minimal point on (x, xG ] such that (xÌƒ, x]
does not intersect any branches of Î“â€²Ï•,n other than the one containing x. It follows that rÎ“Ï•,n (z) 6âˆˆ (xÌƒ, x]. An
example is in Fig. 1.
Set c := âˆ’d~v Ï• â‰¥ 1, where ~v âˆˆ TX,xÌƒ is the unique tangent direction at xÌƒ with x âˆˆ U (~v ); then, after possibly
replacing Ï• with a smaller quasisubharmonic function, we may assume that Ï• is linear of slope âˆ’c on [x, xÌƒ], i.e.
Ï•(y) = Ï•(xÌƒ) âˆ’ c (Î±(y) âˆ’ Î±(xÌƒ))
for y âˆˆ [x, xÌƒ]. If Î³ := âŒŠcâŒ‹, and Ï := Ï0 âˆ’ Î³Î´xG , then the function Ï†(y) := Ï•(y) + Î³Î±(y âˆ¨ x) is Ï-subharmonic and
Ï†(xG ) = 0. Suppose there exists Ç«1 > 0 and a (Ï†, Ç«1 )-extension fËœ âˆˆ k[T ] at z.
Pick u âˆˆ (x, xÌƒ) of type 2 such that Î±(x) âˆ’ Î±(u) âˆˆ (0, Î·), where Î· is a positive number chosen to be less than
A(x)
and, if Ï†(x) < 0, then we also require that Î· < âˆ’Ç«1cÏ†(x) .
c
Pick uâ€² âˆˆ X rig such that rÎ“Ï•,n (uâ€² ) = u, and a polynomial generator g of muâ€² with |g(xG )| = 1. Set f := fËœg Î³ .
By construction, z âˆ¨ u = z âˆ¨ x, and hence we have
|f (z)|eâˆ’Ï•(z) = |g(z)|Î³ |fËœ(z)|eÎ³Î±(zâˆ¨u) eâˆ’Ï†(z) = |fËœ(z)|eâˆ’Ï†(z) .
Case 1. Suppose that c is an integer and Ï†(x) = 0. Then, Ï†|[x,xG ] = 0, and hence Ï•(y) = âˆ’cÎ±(y âˆ¨ x) for
y âˆˆ [x, xG ]. Arguing as in Case 1 of Lemma 3.5, it suï¬ƒces to ï¬nd an Ç«0 > 0 such that
|f (y)|eâˆ’(1+Ç«0 )Ï•(y)âˆ’A(y) â‰¤ |fËœ(z)|eâˆ’Ï†(z)

(3.3)

for y âˆˆ Î“Ï•,n . By assumption, Î“Ï†,n âˆ©[x, xG ] âŠ† {xG }, so the left-hand side of (3.3) is equal to |fËœ(y)|eâˆ’(1+Ç«0 )Ï†(y)âˆ’A(y)
for y âˆˆ Î“Ï†,n , in which case (3.3) holds. Thus, it suï¬ƒces to verify (3.3) for y âˆˆ [x, xG ]. It holds when y = xG
by assumption, and the function y 7â†’ |f (y)|eâˆ’(1+Ç«0 )Ï•(y)âˆ’A(y) is decreasing on [u, xG ], but increasing on [u, x].
Therefore, it is enough to check (3.3) at y = x. Let Î² := log |fËœ(x)| âˆ’ log |fËœ(xG )| â‰¤ 0 and suppose there exists an
Ç«0 > 0 such that
eÎ² |g(x)|c eâˆ’(1+Ç«0 )Ï•(x)âˆ’A(x) â‰¤ 1.
(3.4)
âˆ’(1+Ç«0 )Ï•(x)âˆ’A(x)
âˆ’Ï†(z)
Ëœ
Ëœ
Ëœ
Then, |f (x)|e
â‰¤ |f (xG )|, and |f (xG )| is less than or equal to |f (z)|e
by assumption. Thus,
it suï¬ƒces to show (3.4). Observe that
eÎ² |g(x)|c eâˆ’(1+Ç«0 )Ï•(x)âˆ’A(x) = exp (Î² âˆ’ cÎ±(u) âˆ’ (1 + Ç«0 )Ï•(xÌƒ) + (1 + Ç«0 )c (Î±(x) âˆ’ Î±(xÌƒ)) âˆ’ A(x))
â‰¤ exp (âˆ’c (Î±(u) âˆ’ Î±(x)) âˆ’ A(x) + Ç«0 cÎ±(x)) ,
so (3.4) holds at y = x if Ç«0 â‰¤

A(x)âˆ’cÎ·
cÎ±(x) .

A NON-ARCHIMEDEAN OHSAWAâ€“TAKEGOSHI EXTENSION THEOREM

13

Case 2. Suppose that c is an integer and Ï†(x) < 0. As in Case 1 of Lemma 3.5, it suï¬ƒces to ï¬nd Ç«0 > 0
e Ï†,n = Î“Ï†,n âˆª {xG }. Again arguing as in Case 1 of Lemma 3.5, (3.3)
such that (3.3) holds for all y âˆˆ Î“Ï•,n . Set Î“
Ç«1 n
e
holds for y âˆˆ Î“Ï†,n provided Ç«0 â‰¤ n+c(n+1) . Finally, as in Case 1, the function y 7â†’ |f (y)|eâˆ’(1+Ç«0 )Ï•(y)âˆ’A(y) on
e Ï†,n is maximized at y = x, so it suï¬ƒces to ï¬nd an Ç«0 > 0 so that holds (3.3) there. Observe that
Î“Ï•,n \Î“
|g(u)|c e(Ç«1 âˆ’Ç«0 )Ï†(x)+(1+Ç«0 )cÎ±(x) â‰¤ 1

provided Ç«0 â‰¤

âˆ’Ç«1 Ï†(x)âˆ’cÎ·
âˆ’Ï†(x)+cÎ±(x) ,

where âˆ’Ç«1 Ï†(x) âˆ’ cÎ· > 0 by the choice of u. It follows that

|f (x)|eâˆ’(1+Ç«0 )Ï•(x)âˆ’A(x) = |g(u)|c e(Ç«1 âˆ’Ç«0 )Ï†(x) e(1+Ç«0 )cÎ±(x) |fËœ(x)|eâˆ’(1+Ç«1 )Ï†(x)âˆ’A(x) â‰¤ |fËœ(z)|eâˆ’Ï†(z) ,
which completes the proof in Case 2.
Case 3. Suppose c > Î³. Following the previous two cases, it suï¬ƒces to ï¬nd Ç«0 > 0 such that (3.3) holds for
e Ï†,n = Î“Ï†,n âˆª {xG }. If y âˆˆ Î“
e Ï†,n , then Ï†(y) â‰¤ âˆ’ n Î±(y), and hence
all y âˆˆ Î“Ï•,n . Set Î“
n+1
n

 n+1
(Ç«1 âˆ’Ç«0 )âˆ’Î³Ç«0
.
exp ((Ç«1 âˆ’ Ç«0 )Ï†(y) + Î³Ç«0 Î±(y âˆ¨ uâ€² )) â‰¤ eâˆ’Î±(y)

This last quantity is less than or equal to 1 provided Ç«0 â‰¤

Ç«1 n
Î³(n+1)+n .

In this case, we have

â€²
|f (y)|eâˆ’(1+Ç«0 )Ï•(y)âˆ’A(y) â‰¤ eÎ³Ç«0 Î±(yâˆ¨u )+(Ç«1 âˆ’Ç«0 )Ï†(y) |fËœ(y)|eâˆ’(1+Ç«1 )Ï†(y)âˆ’A(y) â‰¤ |fËœ(z)|eâˆ’Ï†(z) .

e Ï†,n âˆ©[u, xG ]. If ~v â€²â€² âˆˆ TX,xâ€²â€² is the unique direction at xâ€²â€² with x âˆˆ U (~v â€²â€² ),
Let xâ€²â€² âˆˆ [u, xG ] be the minimal point of Î“
âˆ’(1+Ç«0 )Ï•(y)âˆ’A(y)
then the function y 7â†’ |f (y)|e
is decreasing on [u, xâ€²â€² ] provided
d~vâ€²â€² (Ç«0 Î³Î± âˆ’ (1 + Ç«0 )Ï† âˆ’ A) â‰¤ 0.

n
Using the fact that d~vâ€²â€² Ï† â‰¥ âˆ’ n+1
, this holds if Ç«0 â‰¤

1
(n+1)Î³+n .

Now, the function y 7â†’ |f (y)|eâˆ’(1+Ç«0 )Ï•(y)âˆ’A(y) on [x, u) achieves its maximum at y = x, so it suï¬ƒces to ï¬nd
an Ç«0 > 0 such that (3.3) holds at y = x. If Ï†(x) = 0, one can argue as in Case 1. If Ï†(x) < 0, then it follows
that
|g(u)|Î³ e(Ç«1 âˆ’Ç«0 )Ï†(x)+(1+Ç«0 )Î³Î±(x) â‰¤ exp (Î³Î· + Ç«1 Ï†(x) âˆ’ Ç«0 Ï•(x)) ,
and this is bounded above by 1 provided Ç«0 â‰¤
Therefore, we have

âˆ’Ï†(x)Ç«1 âˆ’Î³Î·
;
âˆ’Ï•(x)

note that âˆ’Ï†(x)Ç«1 âˆ’ Î³Î· > 0 by the choice of u.

|f (x)|eâˆ’(1+Ç«0 )Ï•(x)âˆ’A(x) â‰¤ |g(u)|Î³ e(Ç«1 âˆ’Ç«0 )Ï†(x)+Î³(1+Ç«0 )Î±(x) |fËœ(x)|eâˆ’(1+Ç«1 )Ï†(x)âˆ’A(x) â‰¤ |fËœ(z)|eâˆ’Ï†(z) ,
which completes the proof.
If none of the hypotheses of the previous 4 lemmas hold, then
case is addressed below.


Î“â€²Ï•,n

must be the interval [z, xG ]. This special

Lemma 3.8. Suppose mass(Ï0 ) â‰¥ 1 and Î“â€²Ï•,n = [z, xG ], then there exists Ç«0 > 0 such that any nonzero constant
function is a (Ï•, Ç«0 )-extension at z.
Proof. It suï¬ƒces to ï¬nd Ç«0 > 0 such that âˆ’(1 + Ç«0 )Ï•(y) âˆ’ A(y) â‰¤ âˆ’Ï•(z) for any y âˆˆ [z, xG ]. For such y,
Ï•(z) âˆ’ Ï•(y) â‰¤ 0 and hence it suï¬ƒces to ï¬nd Ç«0 > 0 such that âˆ’Ç«0 Ï•(y) âˆ’ A(y) â‰¤ 0 for all such y. This holds for
any Ç«0 > 0 at y = xG . Thus, if ~v âˆˆ TX,xG is the unique direction at xG with z âˆˆ U (~v ), then it suï¬ƒces to ï¬nd
m(~
v)
Ç«0 > 0 such that d~v (âˆ’Ç«0 Ï• âˆ’ A) â‰¤ 0. This holds if Ç«0 â‰¤ âˆ’d
.

~
vÏ•
Let us now summarize the proof of Theorem 3.1: if mass(Ï0 ) < 1, then a (Ï•, Ç«0 )-extension at z exists by
Lemma 3.4. Suppose now that mass(Ï0 ) â‰¥ 1; in particular, Î“Ï•,n 6= âˆ… and Ends(Î“Ï•,n ) 6= âˆ…. As discussed at
the start of the section, we assume that Ï• is locally constant oï¬€ of the convex hull of Î“Ï• âˆª {z}. By repeatedly
applying Lemma 3.5, Lemma 3.6, and Lemma 3.7, we may assume that Ends(Î“Ï•,n ) consists of a single type-2
or type-3 point onto which z retracts. This is precisely the setting of Lemma 3.8, which then asserts that a

14

MATTHEW STEVENSON

(Ï•, Ç«0 )-extension at z exists. Now, if z âˆˆ X rig and k = k a , then H(z) = k, so the second assertion is immediate
from the ï¬rst. This concludes the proof of Theorem 3.1.
4. Non-Archimedean Demailly approximation of quasisubharmonic Functions
Let X be the Berkovich closed unit disc over k. Given a quasisubharmonic Ï• on X, one may wish to approximate it by a sequence of quasisubharmonic functions whose singularities are controlled. One such result
is already well known: [Jon15, Theorem 2.10] shows that there is a decreasing sequence of bounded quasisubharmonic functions (Ï•n )âˆ
n=1 on X which decrease pointwise to Ï•. Let us brieï¬‚y recall the construction: if Ï• is
Ï0 -subharmonic, for each n â‰¥ 1, consider the ï¬nite subtree
o
n
Î“n := x âˆˆ X : (Ï0 + âˆ†Ï•){y â‰¥ x} â‰¥ 2âˆ’n and d(xG , x) â‰¤ 2n ,

where d is the generalized metric on X from Â§2.2. If rn : X â†’ Î“n denotes the retraction map of X onto Î“n , then
Ï•n is, up to translation by a constant, equal to (rn )âˆ— Ï•. A similar argument appears in [FRL06, Â§4.6].
Notice that the construction of the sequence (Ï•n )âˆ
n=1 heavily uses the tree structure on X (indeed, the same
proof yields an analogous result for any metric tree) and moreover it depends on the choice of exhausting
sequence of subtrees Î“n . Without involving the analytic structure, it is unlikely that such a regularization
result will generalize to higher-dimensional analytic spaces. The goal of this section is to construct a canonical
regularization of a quasisubharmonic function on the Berkovich unit disc. The inspiration is the much-celebrated
regularization theorem of Demailly [Dem92, Proposition 3.1].
Let us brieï¬‚y recall the construction of the Demailly approximation of a plurisubharmonic function on the
complex unit disc. Let D be the open unit disc in C, and let Ï• be a plurisubharmonic function on D. Consider
the Hilbert space HÏ• of holomorphic functions f on D satisfying the integrability condition
Z
|f |2 eâˆ’2Ï• dÎ» < +âˆ,
kf k2Ï• :=
D

where dÎ» is the Lebesgue measure. For each m â‰¥ 1, let (fm,n )âˆ
n=1 be an orthonormal basis of HmÏ• and deï¬ne
a plurisubharmonic function Ï•m on D by the formula
!
âˆ
X
1
log
|fm,n |2 .
Ï•m =
2m
n=1

This function Ï•m is called the Demailly approximation
associated
to HmÏ• ; Ï•m has analytic singularities, in
P

N
2
the sense that it can be locally written as c log
+ Î² for some constant Î± > 0, local holomorphic
i=1 |gi |
functions gi , and a locally bounded function Î². The Demailly approximation may also be expressed as
1
Ï•m = sup log |f |,
m
f

where the supremum ranges over all holomorphic functions f in the unit ball of HmÏ• . In [Dem92, Proposition
1
3.1], it is shown that the sequence (Ï•m )âˆ
m=1 converges pointwise (and in Lloc ) to Ï• and, after passing to a
subsequence, is decreasing in m.
In Â§4.1, given a quasisubharmonic function Ï• on the Berkovich unit disc X, we construct an ideal HÏ• of the
Tate algebra and the non-Archimedean Demailly approximation Ï•m associated to HmÏ• . Using Theorem 3.1, we
show that the sequence (Ï•m )âˆ
m=1 converges to Ï•. In Â§4.2, we brieï¬‚y discuss the connection between the ideals
HÏ• and a locally-deï¬ned non-Archimedean multiplier ideal associated to Ï•.
4.1. Non-Archimedean Demailly approximation and a regularization theorem. Let Ï• be a quasisubharmonic function on X with Ï• â‰¤ 0. The case when Ï• may be positive will be addressed later. As in Â§3, consider
the function k Â· kÏ• : k{T } â†’ [0, +âˆ] deï¬ned by
kf kÏ• :=

sup
xâˆˆX\Z(Ï•)

|f (x)|eâˆ’Ï•(x)âˆ’A(x) , f âˆˆ k{T }.

A NON-ARCHIMEDEAN OHSAWAâ€“TAKEGOSHI EXTENSION THEOREM

15

This gives a non-Archimedean norm on the subset {k Â· kÏ• < +âˆ}. The norms of this form are not submultiplicative in general, but they do satisfy a monotonicity property: if Ï•, Ï† are quasisubharmonic and such that
Ï• â‰¤ Ï† â‰¤ 0, then kf kÏ† â‰¤ kf kÏ• for any f âˆˆ k{T }. In particular, the limit
kf k+
Ï• := lim kf k(1+Ç«)Ï•
Ç«â†’0+

exists (though it may be inï¬nite). Consider the subset HÏ• of the Tate algebra consisting of those series f âˆˆ k{T }
+
such that kf k+
Ï• < +âˆ. The function kÂ·kÏ• deï¬nes a non-Archimedean norm on HÏ• , which is not submultiplicative
in general. With this norm, HÏ• is a normed k{T }-module.
Lemma 4.1. The subset HÏ• is a principal ideal of k{T }, which is complete for the norm k Â· k+
Ï• . In particular,
HÏ• is a Banach k{T }-module.
Proof. It is clear that HÏ• is closed under addition. Given g âˆˆ k{T }, the image of the function x 7â†’ |g(x)| is
contained in the interval [0, |g(xG )|]. For any f âˆˆ HÏ• and for any Ç« > 0, kf gk(1+Ç«)Ï• â‰¤ |g(xG )| Â· kf k(1+Ç«)Ï•. In
particular, f g âˆˆ HÏ• . Furthermore, the Tate algebra k{T } is a principal ideal domain (when k is nontriviallyvalued, see [Bos14, Corollary 2.2.10]; otherwise, k{T } = k[T ]) and hence HmÏ• is principal.
+
âˆ
Let (fj )âˆ
j=1 âŠ‚ HÏ• be a Cauchy sequence in the norm k Â· kÏ• . It follows that (fj )j=1 is also a Cauchy sequence
+
for the Gauss norm, since | Â· |xG â‰¤ k Â· kÏ• . By the completeness of k{T }, the sequence (fj )âˆ
j=1 admits a limit
f âˆˆ k{T }. All ideals of k{T } are closed, so f âˆˆ HÏ• . If HÏ• = (h), then we can write fj = gj h and f = gh for
some gj , g âˆˆ k{T } such that gj â†’ g in | Â· |xG . For any Î´ > 0, take Ç« > 0 suï¬ƒciently small so that khk(1+Ç«)Ï• < +âˆ
Î´
and take j â‰« 0 so that |(gj âˆ’ g)(xG )| < khk
+ . It follows that
Ï•
!
Î´
+
kfj âˆ’f kÏ• â‰¤ kfj âˆ’f k(1+Ç«)Ï• â‰¤
sup |(gj âˆ’ g)(x)| khk(1+Ç«)Ï• = |(gj âˆ’g)(xG )|Â·khk(1+Ç«)Ï• <
khk(1+Ç«)Ï• â‰¤ Î´.
khk+
Ï•
xâˆˆX\Z(Ï•)
+
Therefore, fj â†’ f in the norm k Â· k+
Ï• , and hence HÏ• is complete with respect to k Â· kÏ• .



Proposition 4.2. Let Ï•, Ï† be two quasisubharmonic functions on X with Ï•, Ï† â‰¤ 0. If there exist C1 , C2 > 0
such that Ï† âˆ’ C2 â‰¤ Ï• â‰¤ Ï† + C1 on X, then
+
+
C2
eâˆ’C1 k Â· k+
Ï† â‰¤ k Â· kÏ• â‰¤ e k Â· kÏ†

as functions on k{T }. In particular, HÏ• and HÏ† coincide as ideals of k{T } and the identity map between them
is an isomorphism of Banach k{T }-modules. Moreover, if Ï• is bounded, then HÏ• = k{T }.
The proof of Proposition 4.2 is elementary. However, Proposition 4.2 may be used to deï¬ne HÏ• for a quasisubharmonic function Ï• such that supX Ï• > 0, in which case it is not clear that the limit deï¬ning the norm
k Â· k+
Ï• exists.
The ideals HÏ• satisfy the subadditivity-type property below.
Proposition 4.3. If Ï•, Ï† are quasisubharmonic functions on X, then HÏ•+Ï† âŠ† HÏ• HÏ† .
The proof of Proposition 4.3 requires studying the extension of the ideal HÏ• to each local ring OX,x of X.
This is discussed in Â§4.2. This proof is simpler than in the complex setting, where the proof of the subadditivity
theorem for multiplier ideals relies crucially on the Ohsawaâ€“Takegoshi theorem on the unit bidisc.
We will now deï¬ne the non-Archimedean analogue of a plurisubharmonic function with analytic singularities.
Definition 4.4. A quasisubharmonic function Ï• on X is said to have analytic singularities if there exists a cover
{Vi }iâˆˆI of X by aï¬ƒnoid domains such that for each i âˆˆ I, there are analytic functions fi,1 , . . . , fi,ni âˆˆ OX (Vi ),
positive numbers Î±i,1 , . . . , Î±i,ni > 0, and a bounded function Î²i : Vi â†’ R such that
Ï•|Vi = Î²i +

ni
X
j=1

Î±i,j log |fi,j |

on Vi .

16

MATTHEW STEVENSON

Quasisubharmonic functions with analytic singularities, like their complex counterparts, are quite wellbehaved. One instance of this is illustrated below.
Example 4.5. Let Ï• be a quasisubharmonic function on X with analytic singularities and suppose it admits a
decomposition Ï• = Î² +Î± log |f |, with f âˆˆ k{T } irreducible, Î± > 0, and Î² : X â†’ R bounded. Then, HÏ• = (f âŒŠÎ±âŒ‹ ).
Given a quasisubharmonic function Ï• on X and a positive integer m â‰¥ 1, the non-Archimedean Demailly
approximation associated to HmÏ• is the function
!âˆ—
|f |
1
sup
log
Ï•m :=
,
m f âˆˆHmÏ• \{0}
kf k+
mÏ•
where (âˆ’)âˆ— denotes the upper-semicontinuous regularization. When k is nontrivially-valued, Ï•m may equivalently
be deï¬ned in terms of a supremum over f âˆˆ B(1)mÏ• := {f âˆˆ HmÏ• : kf k+
mÏ• â‰¤ 1}, the unit ball in HmÏ• . This
mirrors the deï¬nition of the Demailly approximation in the complex setting.
Proposition 4.6. Let Ï• be a quasisubharmonic function on X and let m â‰¥ 1. The non-Archimedean Demailly
approximation Ï•m is quasisubharmonic with analytic singularities.
1
log kf|fk+| â‰¤ Ï•(xG ) and hence by Lemma 2.2, the function Ï•m is quasisubharmonic.
Proof. For each f âˆˆ HmÏ• , m
mÏ•
Let h âˆˆ HmÏ• be any generator. To show Ï•m has analytic singularities, it suï¬ƒces to show that the function
!âˆ—
1
|f (x)|
1
|h(x)|
Î²(x) :=
sup
log
âˆ’ log
+
m f âˆˆHmÏ• \{0}
m
kf k+
khk
mÏ•
mÏ•
âˆ’mÏ•(xG )
is bounded. As kghk+
6= 0 for any nonzero g âˆˆ k{T }, we have
mÏ• â‰¥ |g(xG )||h(xG )|e

sup
gâˆˆk{T }\{0}

log

|h(x)|
|h(x)||g(x)|
â‰¤ log
+ mÏ•(xG ).
+
|h(x
kghkmÏ•
G )|

This upper bound is upper semicontinuous in x, so it follows that Î²(x) â‰¤

1
m

khk+

log |h(xmÏ•
+ Ï•(xG ). For a lower
G )|

|h(x)|
1
bound, taking g = 1 gives Î² â‰¥ 0. Note that the decomposition Ï•m = Î² + m
log khk
is not unique â€“ it depends
+
mÏ•
on the choice of generator h of the ideal HmÏ• .


Remark 4.7. It is not true in general that, if Ï• has analytic singularities, then Ï•m = Ï• for all m â‰¥ 1. Rather,
Ï•m is an â€œalgebraic approximationâ€ to Ï•, as the following example demonstrates. Let Ï• = Î± Â· log |f | for some
rig
is the rigid point
Î± > 0 and f âˆˆ k{T } irreducible. It is easy to verify that Ï•m = âŒŠmÎ±âŒ‹
m log |f |. If x âˆˆ X
corresponding to the maximal ideal (f ) of k{T }, then Ï•m has rational slope along the branch [x, xG ] of X;
however, this will not be the case for Ï• if Î± âˆˆ R\Q.
Example 4.8. The sequence (Ï•m )âˆ
m=1 does not, in general, decrease monotonically in m. If Ï• =
(
Ï•,
m = 2n
Ï•m = 3n+1
log
|T
|,
m = 2n + 1.
2n+1

3
2

log |T |, then

In particular, Ï•2n = Ï• for all n â‰¥ 0, but the subsequence (Ï•2n+1 )nâ‰¥0 decreases monotonically to Ï•. It is not
clear whether or not the sequence Ï•m admits a decreasing subsequence in general. For related results in the
complex case, see [Kim14].
The following is a non-Archimedean analogue of Demaillyâ€™s regularization theorem [Dem92, Proposition 3.1].
Theorem 4.9. Assume k is algebraically closed, trivially-valued, or is spherically complete of residue characteristic zero. Let Ï• be a quasisubharmonic function on X with Ï• â‰¤ 0, and let m â‰¥ 1. For any x âˆˆ X,
1
Ï•(x) â‰¤ Ï•m (x) â‰¤ Ï•(x) + A(x).
m

A NON-ARCHIMEDEAN OHSAWAâ€“TAKEGOSHI EXTENSION THEOREM

17

In particular, Ï•m converges pointwise to Ï• on {A < +âˆ} âŠ† X.
The estimate in Theorem 4.9 in fact yields a stronger assertion than just the pointwise convergence of the
non-Archimedean Demailly approximation Ï•m to Ï•. Indeed, for any compact subset K âŠ† X such that Î±|K
is bounded above, Ï•m converges uniformly to Ï•; this is reminiscent of the L1loc convergence of the Demailly
approximation in the complex case. The estimate in Theorem 4.9 can thus be thought of as asserting that Ï•m
converges to Ï• in a non-Archimedean version of the Hartogâ€™s sense, as introduced in [DS09, Deï¬nition 3.2.3].
The key ingredient in the proof of Theorem 4.9 is Theorem 3.1. Moreover, the proof shows that the hypothesis
that Ï• â‰¤ 0 is only needed for the upper bound, whereas the lower bound always holds.
Proof. Consider ï¬rst the upper bound on Ï•m . If A(x) = +âˆ, then the upper bound is trivial. Suppose that
A(x) < +âˆ, in which case Î±(x) < +âˆ as well, so Ï•m (x) may be calculated without the upper-semicontinuous
regularization by Lemma 2.2. The upper bound then follows from the observation that
m(Ï•m âˆ’ Ï•) âˆ’ A = sup log
f âˆˆHmÏ•

|f |eâˆ’mÏ•âˆ’A
â‰¤ 0,
kf k+
mÏ•

where we have used that Ï• â‰¤ 0 to conclude that |f |eâˆ’mÏ•âˆ’A â‰¤ kf k+
mÏ• .
mÏ•(xG )
To get the lower bound, let Ï† := Ï• âˆ’ Ï•(xG ) and observe that HmÏ• = HmÏ† and kf k+
kf k+
mÏ• for
mÏ† = e
any f âˆˆ HmÏ• . For any x âˆˆ X, Theorem 3.1 asserts that there exists an Ç«0 > 0 and a (mÏ†, Ç«0 )-extension f âˆˆ k[T ]
at x. In particular, f âˆˆ HmÏ† and
1â‰¤
or equivalently Ï•(x) â‰¤

1
m

|f (x)| âˆ’mÏ•(x)
|f (x)| âˆ’mÏ†(x)
=
e
,
+ e
kf kmÏ†
kf k+
mÏ•

|f (x)|
log kf
â‰¤ Ï•m (x).
k+



mÏ•

Remark 4.10. A quasisubharmonic function cannot, in general, be bounded pointwise below by a quasisubharmonic function with analytic singularities. Indeed, a general quasisubharmonic function can have a dense set
of poles in X: for example, if {aj : j â‰¥ 0} forms a dense subset of k â—¦ , set
Ï• :=

âˆ
X

cj log |T âˆ’ aj |,

j=0

Pâˆ
for some cj > 0 satisfying j=0 cj = 1. However, a quasisubharmonic function with analytic singularities on
X must have a ï¬nite set of poles. This is analogous to the fact that a subharmonic function with analytic
singularities on the complex unit disc has a discrete set of poles.
4.2. Non-Archimedean multiplier ideals. Let A = k{T } and X = M(A). The stalk OX,x of the structure
sheaf OX at x âˆˆ X is a noetherian local ring, which may be computed as the direct limit of the aï¬ƒnoid algebras
AV over all aï¬ƒnoid neighborhoods V of x. The unique maximal ideal mx of OX,x consists of those germs
f âˆˆ OX,x such that |f (x)| = 0. We say that a germ f âˆˆ OX,x is defined on an aï¬ƒnoid domain V âŠ‚ X if it lies
in the image of the natural map AV â†’ OX,x .
For x âˆˆ X rig , let mx denote the corresponding maximal ideal of A. As in [BGR84, 7.3.2/1], mx is the
extension of mx along the natural map A â†’ OX,x (though this is false for arbitrary points of an aï¬ƒnoid space,
as demonstrated by [Ber93, Remark 2.2.9]). Moreover, for x âˆˆ X rig , the natural map A â†’ OX,x factors through
âˆ¼ b
the localization Amx , which induces an isomorphism Abmx â†’ O
X,x on completions.
In complex geometry, we associate to each plurisubharmonic function (or more generally, to a semipositive
metric on a line bundle) a multiplier ideal sheaf, which measures the singularities of the plurisubharmonic
function. We propose a non-Archimedean analogue of this notion.

18

MATTHEW STEVENSON

Definition 4.11. Let Ï• be a quasisubharmonic function on X with Ï• â‰¤ 0. For any x âˆˆ X, the local multiplier
ideal of Ï• at x, denoted J (Ï•)x , consists of those germs f âˆˆ OX,x such that for all Ç« > 0, there is an aï¬ƒnoid
neighborhood VÇ« of x on which f is deï¬ned such that
sup |f |eâˆ’(1+Ç«)Ï•âˆ’A < +âˆ.
VÇ« \Z(Ï•)

It is easy to check that the local multiplier ideal J (Ï•)x is indeed an ideal of the local ring OX,x . Furthermore,
it is immediate from the deï¬nition that the local multiplier ideals satisfy J (Ï• + Î²)x = J (Ï•)x where Î² is a
bounded usc function on X. In particular, if supX Ï• > 0, we may deï¬ne the local multiplier ideal of Ï• at x to
be J (Ï• âˆ’ Ï•(xG ))x . For simplicity, we assume from now on that all quasisubharmonic functions are nonpositive.
The name of a multiplier ideal is justiï¬ed by examples of the following form: if f âˆˆ A is irreducible, c > 0,
âŒŠcâŒ‹
and Ï• := c Â· log |f |, then J (Ï•)x = mx , where x âˆˆ X rig is the rigid point corresponding to the maximal ideal
(f ) of A. More generally, the local multiplier ideals admit a similar description for a general quasisubharmonic
function, as is made precise in the following lemma.
âŒŠc âŒ‹
Lemma 4.12. For x âˆˆ X rig , J (Ï•)x = mx x , where cx :=

âˆ†Ï•{x}
m(x) .

For x âˆˆ X\X rig , J (Ï•)x = OX,x .

The quantity cx may be thought of as the â€œnon-Archimedean Lelong numberâ€ of Ï• at the point x.
Proof. Fix x âˆˆ X rig . For a germ f âˆˆ OX,x , let ordx (f ) denote the maximal power of mx to which f belongs. To
say f âˆˆ J (Ï•)x is equivalent the existence of an Ç« > 0 such that ordx (f ) âˆ’ (1 + Ç«)cx + 1 â‰¥ 0, which occurs if and
âŒŠc âŒ‹
only if ordx (f ) > cx âˆ’ 1, i.e. ordx (f ) â‰¥ âŒŠcx âŒ‹. Thus, J (Ï•)x = mx x .
rig
Fix x âˆˆ X\X
and any Ç«0 > 0. There are only ï¬nitely-many rigid points z1 , . . . , zn âˆˆ X rig satisfying (1 + Ç«0 )czi â‰¥ 1, so we may ï¬nd an aï¬ƒnoid neighborhood V of x which avoids z1 , . . . , zn and hence
supV \Z(Ï•) |1|eâˆ’(1+Ç«)Ï•âˆ’A < +âˆ for all Ç« âˆˆ [0, Ç«0 ]. Thus, 1 âˆˆ J (Ï•)x .

One can show that the local multiplier ideals J (Ï•)x arise as the stalks of a coherent sheaf of ideals on X.
More precisely, the local multiplier ideals satisfy a â€œcoherenceâ€ property similar to [Dem12, Proposition 5.7],
originally due to Nadel [Nad90].
Lemma 4.13. For x âˆˆ X rig , J (Ï•)x = HÏ• Â· OX,x .
Proof. The inclusion HÏ• Â· OX,x âŠ† J (Ï•)x is clear. The local ring OX,x is a dvr, so the ideal HÏ• Â· OX,x can be
written as mdx for some d âˆˆ Zâ‰¥0 ; the power d is the largest integer such that HÏ• âŠ† mdx . We ï¬rst show that
d â‰¥ âŒŠcx âŒ‹: pick a net (xj )jâˆˆJ in {Î± < +âˆ} that converges to x such that xj â‰¥ x for all j âˆˆ J. After shifting Ï•
by a constant, assume that Ï•(xG ) = 0, and arguing as in [Jon15, Lemma 2.9] we have
Z xj
Z xj
(âˆ†Ï•){x}dÎ±(y) = âˆ’âˆ†Ï•{x}Î±(xj ).
(4.1)
(âˆ†Ï•){y âˆˆ X : y â‰¤ xj }dÎ±(y) â‰¤ âˆ’
Ï•(xj ) = âˆ’
xG

xG

Fix a generator gx of mx . For any f âˆˆ HÏ• , there is a unique factorization f = gxa h (up to units) for some a âˆˆ Zâ‰¥0
and h âˆˆ A\mx . For suï¬ƒciently small Ç« > 0, (4.1) implies that
+âˆ > sup |f |eâˆ’(1+Ç«)Ï•âˆ’A â‰¥ sup |f (xj )|eâˆ’(1+Ç«)Ï•(xj )âˆ’A(xj )
X\Z(Ï•)

jâˆˆJ

â‰¥ sup |h(xj )|eâˆ’am(xj )Î±(xj )+(1+Ç«)(âˆ†Ï•{x})Î±(xj )âˆ’m(xj )Î±(xj )
jâˆˆJ

â‰¥ sup |h(xj )|eÎ±(xj )(âˆ’am(x)+(1+Ç«)(âˆ†Ï•{x})âˆ’m(x))
jâˆˆJ

where we have used that m(x) â‰¥ m(xj ) and m(xj )Î±(xj ) â‰¥ A(xj ), which follows from (2.1). This last supremum
is ï¬nite only if âˆ’am(x) + (1 + Ç«)(âˆ†Ï•{x}) âˆ’ m(x) â‰¤ 0, and this must hold for all Ç« > 0 suï¬ƒciently small; said
diï¬€erently, a â‰¥ âŒŠcx âŒ‹. Thus, d â‰¥ âŒŠcx âŒ‹.

A NON-ARCHIMEDEAN OHSAWAâ€“TAKEGOSHI EXTENSION THEOREM

19

Now, any generator f of HÏ• , there is a unique way to write f = gxd h (up to units) for some h âˆˆ A\mx .
âŒŠc âŒ‹
If d > âŒŠcx âŒ‹, then it is easy to check that gx x h lies in HÏ• (it is the same calculation as above near x, and
âŒŠc âŒ‹
âŒŠc âŒ‹
hence gx x h must be a generator of HÏ• ; this is a contradiction, so d = âŒŠcx âŒ‹. Thus, HÏ• Â· OX,x = mx x and we
apply Lemma 4.12 to conclude.

It is not hard to check that the local multiplier ideals satisfy many of the usual properties of multiplier ideals
on complex algebraic varieties, e.g. invariance under small perturbations, the behavior under adding integral
divisors, and the subadditivity property (in the subsequent lemma). This further justiï¬es the terminology.
Lemma 4.14. If Ï•, Ï† are quasisubharmonic functions on X and x âˆˆ X, then J (Ï• + Ï†)x âŠ† J (Ï•)x J (Ï†)x .
Proof. The assertion follows from Lemma 4.12 and the observation that âŒŠâˆ†(Ï• + Ï†){x}âŒ‹ â‰¥ âŒŠâˆ†Ï•{x}âŒ‹ + âŒŠâˆ†Ï†{x}âŒ‹.

Proof of Proposition 4.3. After translating Ï• and Ï† by constants, we may assume that they are nonpositive. The
inclusion HÏ•+Ï† âŠ† HÏ• HÏ† holds if and only if there is an inclusion HÏ•+Ï† Abmx âŠ† (HÏ• HÏ† ) Abmx of the extensions
along A â†’ Abmx , for every maximal ideal mx of A. The claim then follows from Lemma 4.13 and Lemma 4.14. 

As demonstrated by Lemma 4.12, the local multiplier ideals on the Berkovich unit disc are somewhat degenerate, principally because the types of singularities of quasisubharmonic functions that can occur in one dimension
are limited. In this paper, they serve only to prove Proposition 4.3. However, the deï¬nition naturally extends
to higher dimensions and, in that more complicated setting, could prove quite useful.
Remark 4.15. Given a quasisubharmonic function Ï• on X and x âˆˆ X,
S it is easy to see that ideals HÏ• and
J (Ï•)x satisfy an analogue of the openness conjecture. That is, HÏ• = Ç«>0 H(1+Ç«)Ï• and similarly for J (Ï•)x .
The openness conjecture, for a plurisubharmonic function deï¬ned on a neighborhood of the origin in Cn , has
been solved in [Ber13].
References
[Ax70]
[Ber90]
[Ber93]
[Ber96]
[Ber13]
[BFJ08]
[BFJ15]
[BFJ16]
[BGR84]

[BJ16]
[Blo13]
[Bos14]
[BR10]
[CLD12]

James Ax. Zeros of polynomials over local ï¬eldsâ€”The Galois action. J. Algebra, 15:417â€“428, 1970.
Vladimir G. Berkovich. Spectral theory and analytic geometry over non-Archimedean fields, volume 33 of Mathematical
Surveys and Monographs. American Mathematical Society, Providence, RI, 1990.
Vladimir G. Berkovich. EÌtale cohomology for non-Archimedean analytic spaces. Inst. Hautes EÌtudes Sci. Publ. Math.,
(78):5â€“161 (1994), 1993.
Bo Berndtsson. The extension theorem of Ohsawa-Takegoshi and the theorem of Donnelly-Feï¬€erman. Ann. Inst. Fourier
(Grenoble), 46(4):1083â€“1094, 1996.
Bo Berndtsson. The openness conjecture for plurisubharmonic functions. arXiv:1305.5781.
SeÌbastien Boucksom, Charles Favre, and Mattias Jonsson. Valuations and plurisubharmonic singularities. Publications of
the Research Institute for Mathematical Sciences, 44(2):449â€“494, 2008.
SeÌbastien Boucksom, Charles Favre, and Mattias Jonsson. Solution to a non-Archimedean Monge-AmpeÌ€re equation. J.
Amer. Math. Soc., 28(3):617â€“667, 2015.
SeÌbastien Boucksom, Charles Favre, and Mattias Jonsson. Singular semipositive metrics in non-Archimedean geometry. J.
Algebraic Geom., 25(1):77â€“139, 2016.
S. Bosch, U. GuÌˆntzer, and R. Remmert. Non-Archimedean analysis, volume 261 of Grundlehren der Mathematischen
Wissenschaften [Fundamental Principles of Mathematical Sciences]. Springer-Verlag, Berlin, 1984. A systematic approach
to rigid analytic geometry.
SeÌbastien Boucksom and Mattias Jonsson. Tropical and non-Archimedean limits of degenerating families of volume forms.
arXiv:1605.05277. To appear in J. EÌc. polytech. Math.
Zbigniew Blocki. Suita conjecture and the Ohsawa-Takegoshi extension theorem. Invent. Math., 193(1):149â€“158, 2013.
Siegfried Bosch. Lectures on formal and rigid geometry, volume 2105 of Lecture Notes in Mathematics. Springer, Cham,
2014.
Matthew Baker and Robert Rumely. Potential theory and dynamics on the Berkovich projective line, volume 159 of
Mathematical Surveys and Monographs. American Mathematical Society, Providence, RI, 2010.
Antoine Chambert-Loir and Antoine Ducros. Formes diï¬€eÌrentielles reÌelles et courants sur les espaces de Berkovich.
arXiv:1204.6277.

20

MATTHEW STEVENSON

[Dem92] Jean-Pierre Demailly. Regularization of closed positive currents and intersection theory. J. Algebraic Geom., 1(3):361â€“409,
1992.
[Dem00] Jean-Pierre Demailly. On the Ohsawa-Takegoshi-Manivel L2 extension theorem. In Complex analysis and geometry (Paris,
1997), volume 188 of Progr. Math., pages 47â€“82. BirkhaÌˆuser, Basel, 2000.
[Dem12] Jean-Pierre Demailly. Analytic methods in algebraic geometry, volume 1 of Surveys of Modern Mathematics. International
Press, Somerville, MA; Higher Education Press, Beijing, 2012.
[DS09] Tien-Cuong Dinh and Nessim Sibony. Super-potentials of positive closed currents, intersection theory and dynamics. Acta
Math., 203(1):1â€“82, 2009.
[FJ05]
Charles Favre and Mattias Jonsson. Valuative analysis of planar plurisubharmonic functions. Invent. Math., 162(2):271â€“
311, 2005.
[FRL06] Charles Favre and Juan Rivera-Letelier. EÌquidistribution quantitative des points de petite hauteur sur la droite projective.
Math. Ann., 335(2):311â€“361, 2006.
[Gub98] Walter Gubler. Local heights of subvarieties over non-Archimedean ï¬elds. J. Reine Angew. Math., 498:61â€“113, 1998.
[Jon15] Mattias Jonsson. Dynamics of Berkovich spaces in low dimensions. In Berkovich spaces and applications, volume 2119 of
Lecture Notes in Math., pages 205â€“366. Springer, Cham, 2015.
[Ked11] Kiran S. Kedlaya. Semistable reduction for overconvergent F -isocrystals, IV: local semistable reduction at nonmonomial
valuations. Compos. Math., 147(2):467â€“523, 2011.
[Kim14] Dano Kim. A remark on the approximation of plurisubharmonic functions. C. R. Math. Acad. Sci. Paris, 352(5):387â€“389,
2014.
[Man93] Laurent Manivel. Un theÌoreÌ€me de prolongement L2 de sections holomorphes dâ€™un ï¬breÌ hermitien. Math. Z., 212(1):107â€“122,
1993.
[MN15] Mircea Mustat, aÌ† and Johannes Nicaise. Weight functions on non-Archimedean analytic spaces and the KontsevichSoibelman skeleton. Algebr. Geom., 2(3):365â€“404, 2015.
[MV07] Jeï¬€ery D. McNeal and Dror Varolin. Analytic inversion of adjunction: L2 extension theorems with gain. Ann. Inst. Fourier
(Grenoble), 57(3):703â€“718, 2007.
[Nad90] Alan Michael Nadel. Multiplier ideal sheaves and KaÌˆhler-Einstein metrics of positive scalar curvature. Ann. of Math. (2),
132(3):549â€“596, 1990.
[OT87] Takeo Ohsawa and KenshoÌ„ Takegoshi. On the extension of L2 holomorphic functions. Math. Z., 195(2):197â€“204, 1987.
[Sch15] Tobias Schmidt. Forms of an aï¬ƒnoid disc and ramiï¬cation. Ann. Inst. Fourier (Grenoble), 65(3):1301â€“1347, 2015.
[Siu96] Yum-Tong Siu. The Fujita conjecture and the extension theorem of Ohsawa-Takegoshi. In Geometric complex analysis
(Hayama, 1995), pages 577â€“592. World Sci. Publ., River Edge, NJ, 1996.
[Siu98] Yum-Tong Siu. Invariance of plurigenera. Invent. Math., 134(3):661â€“673, 1998.
[Tem16] Michael Temkin. Metrization of Differential Pluriforms on Berkovich Analytic Spaces. In: Baker M., Payne S. (eds)
Nonarchimedean and Tropical Geometry. Simons Symposia. Springer, Cham, 2016.
[Thu05] Amaury Thuillier. TheÌorie du potentiel sur les courbes en geÌomeÌtrie analytique non archimeÌdienne. Applications aÌ€ la
theÌorie dâ€™Arakelov. PhD thesis, UniversiteÌ Rennes 1, 2005.
[Zha95] Shouwu Zhang. Small points and adelic metrics. J. Algebraic Geom., 4(2):281â€“300, 1995.
Department of Mathematics, University of Michigan, Ann Arbor, MI 48109â€“1043, USA
E-mail address: stevmatt@umich.edu
URL: http://www-personal.umich.edu/~ stevmatt/

