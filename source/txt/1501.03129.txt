A proof of the stability of extremal graphs,

arXiv:1501.03129v1 [math.CO] 13 Jan 2015

Simonovits’ stability from Szemerédi’s regularity
Zoltán Füredi

∗

Alfréd Rényi Institute of Mathematics,
13–15 Reáltanoda Street, 1053 Budapest, Hungary.
E-mail: z-furedi@illinois.edu

Abstract
The following sharpening of Turán’s theorem is proved. Let Tn,p denote the complete p–
partite graph of order n having the maximum number of edges. If G is an n-vertex Kp+1 -free
graph with e(Tn,p ) − t edges then there exists an (at most) p-chromatic subgraph H0 such
that e(H0 ) ≥ e(G) − t.
Using this result we present a concise, contemporary proof (i.e., one using Szemerédi’s
regularity lemma) for the classical stability result of Simonovits [21].

1

The Turán problem

Given a graph G with vertex set V (G) and vertex set E(G) its number of edges is denoted by e(G).
The neighborhood of a vertex x ∈ V is denoted by N (x), note that x ∈
/ N (x). For any A ⊂ V
the restricted neighborhood NG (x|A) stands for N (x) ∩ A. Similarly, degG (x|A) := |N (x) ∩ A|.
If the graph is well understood from the text we leave out subscripts. The Turán graph Tn,p is
the largest p-chromatic graph having n vertices, n, p ≥ 1. Given a partition (V1 , . . . , Vp ) of V
the complete multipartite graph K(V1 , . . . , Vp ) has vertex set V and all the edges joining distinct
partite sets. A △ B stands for the symmetric difference of the sets A and B. For further notations
and notions undefined here see, e.g., the monograph of Bollobás [4].
Turán [23] proved that if an n vertex graph G has at least e(Tn,p ) edges then it contains a
complete subgraph Kp+1 , except if G = Tn,p . Given a class of graphs L, a graph G is called
∗

Research supported in part by the Hungarian National Science Foundation OTKA 104343, by the Simons
Foundation Collaboration Grant #317487, and by the European Research Council Advanced Investigators Grant
267195.
2010 Mathematics Subject Classifications: 05C35.
furedi˙2015˙01˙12˙sim˙stability
Key Words: Turán number, extremal graphs, stability.
January 14, 2015

1

Z. Füredi: Stability of extremal graphs

2

L-free if it does not contain any subgraph isomorphic to any member of L. The Turán number
ex(n, L) is defined as the largest size of an n-vertex, L-free graph. Erdős and Simonovits [11]
gave a general asymptotic for the Turán number as follows. Let p + 1 := min{χ(L) : L ∈ L}.
Then
 

n
1
+ o(n2 ) as n → ∞.
(1)
ex(n, L) = 1 −
p
2
They also showed that if G is an extremal graph, i.e., e(G) = ex(n, L), then it can be obtained
from Tn,p by adding and deleting at most o(n2 ) edges. This result is usually called Erdős–Stone–
Simonovits theorem, although it was proved first in [11], but indeed (1) easily follows from a
result of Erdős and Stone [12].
The aim of this paper is to present a new proof for the following stronger version of (1), a
structural stability theorem, originally proved by Erdős and Simonovits [11], Erdős [7, 8], and
Simonovits [21]. For every ε > 0 and forbidden subgraph class L there is a δ > 0, and n0 such
that if n > n0 and G is an n-vertex, L-free graph with

 
1
n
e(G) ≥ 1 −
− δn2 ,
p
2
then
|E(Gn ) △ E(Tn,p )| ≤ εn2 .

(2)

I.e., one can change (add and delete) at most εn2 edges of G and obtain a complete p-partite graph.
In other words, if an n-vertex L-free graph G is almost extremal, min{χ(L) : L ∈ L} = p + 1, then
the structure of G is close to a p-partite Turán graph. This result is usually called Simonovits’
stability of the extremum.
Our main tool is a very simple proof for the case L = {Kp+1 }.
Stability results are usually more important than their extremal counterparts. That is why
there are so many investigations concerning the edit distance of graphs. Let G1 = (V, E1 ) and
G2 = (V, E2 ) be two (finite, undirected) graphs on the same vertex set. The edit distance from
G1 to G2 is ed(G1 , G2 ) := |E1 △ E2 |. Let P denote a class of graphs and G be a fixed graph. The
edit distance from G to P is ed(G, P) = min{ed(G, F ) : F ∈ P, V (G) = V (F )}. This notion was
explicitly introduced in [3], Alon and Stav [2] proved connections with Turán theory. For more
recent results see Martin [18].

2

How to make a Kp+1-free graph p-chromatic

Ever since Erdős [5] observed that one can always delete at most e/2 edges from any graph G to
make it bipartite there are many generalizations and applications of this (see, e.g., Alon [1] for a
more precise form). Here we prove a version dealing with a narrower class of graphs. Recall that
P
e(Tn,p ) := max{e(K(V1 , . . . , Vp )) :
|Vi | = n}, the maximum size of a p-chromatic graph.

3

Z. Füredi: Stability of extremal graphs

Theorem 1 Suppose that Kp+1 6⊂ G, |V (G)| = n, t ≥ 0, and
e(G) = e(Tn,p ) − t.
Then there exists an (at most) p-chromatic subgraph H0 , E(H0 ) ⊂ E(G) such that
e(H0 ) ≥ e(G) − t.
Corollary 2 (Stability of ex(n, Kp+1 )) Suppose that G is Kp+1 -free with e(G) ≥ e(Tn,p ) − t.
Then there is a complete p-chromatic graph K := K(V1 , . . . , Vp ) with V (K) = V (G), such that
|E(G) △ E(K)| ≤ 3t.
Indeed, delete t edges of G to obtain the p-chromatic H0 . Since e(H0 ) ≥ e(Tn,p ) − 2t one can add
at most 2t edges to make it a complete p-partite graph. (Here Vi = ∅ is allowed).
✷
There are other more exact stability results, e.g., Hanson and Toft [15] showed that for
t < n/(2p) − O(1) the graph G itself is p-chromatic, there is no need to delete any edge. Some
results of E. Győri [14] implies a stronger form, namely that e(H0 ) ≥ e(G) − O(t2 /n2 ). Erdős,
Győri, and Simonovits [10] considers only dense triangle-free graphs. The advantage of our
Theorem 1 is that it contains no ε, δ, n0 , it is true for every n, p and t.
The inequality in Corollary 2 is simple because we estimate the edit distance of G from a not
necessarily balanced p partite graph K. If we are interested in ed(G, Tn,p ) then we can use the
following inequality. If e(K((V1 , . . . , Vp )) ≥ e(Tn,p ) − 2t, then a simple calculation shows that the
P
sizes of Vi ’s should be ’close’ to n/p (more exactly we get 4t ≥ i (|Vi | − (n/p))2 ) and hence
p
ed(K, Tn,p ) ≤ n t/p
(3)
Proof of Theorem 1.
We find the large p-partite subgraph H0 ⊂ G by analyzing Erdős’
degree majorization algorithm [6] what he used to prove Turán’s theorem. Our input is the
P
Kp+1 -free graph G and the output is a partition V1 , V2 , . . . , Vp of V (G) such that i e(G|Vi ) ≤ t.
Let x1 ∈ V (G) be a vertex of maximum degree and let V1 := V \ N (x1 ), V1+ := V \ V1 . Note
that x1 ∈ V1 and deg(x) ≤ |V1+ | for all x ∈ V1 . Hence
X
deg(x) ≤ |V1 ||V1+ |.
2e(G|V1 ) + e(V1 , V1+ ) =
x∈V1

+
In general, define V0+ := V (G) and let xi be a vertex of maximum degree of the graph G|Vi−1
,
+
+
+
+
let Vi := Vi−1 \ N (xi ), Vi := V (G) \ (V1 ∪ · · · ∪ Vi ). We have xi ∈ Vi , deg(xi , Vi−1 ) = |Vi | and
X
+
2e(G|Vi ) + e(Vi , Vi+ ) =
deg(x|Vi−1
) ≤ |Vi ||Vi+ |.
(4)
x∈Vi

The procedure stops in s steps when no more vertices left, i.e., if V1 ∪ · · · ∪ Vs = V (G). Note that
s ≤ p because {x1 , x2 , . . . , xs } span a complete graph.

4

Z. Füredi: Stability of extremal graphs

P
Add up the left hand sides of (4) for 1 ≤ i ≤ s, we get e(G) + ( i e(G|Vi )). The sum of the
right hand sides is exactly e(K(V1 , V2 , . . . , Vs )). We obtain
!
!
X
X
e(G|Vi ) ≤ e(K(V1 , V2 , . . . , Vp )) ≤ e(Tn,p )
e(G|Vi ) = e(G) +
e(Tn,p ) − t +
i

implying

3

P

i

i

e(G|Vi ) ≤ t.

✷

Az application of the Removal Lemma

We only need a simple consequence of Szemerédi’s Regularity Lemma. Recall that the graph
H contains a homomorphic image of F if there is a mapping ϕ : V (F ) → V (H) such that the
image of each F -edge is an H-edge. There is a ϕ : V (F ) → V (Ks ) homomorphism if and only if
s ≥ χ(H). If there is no any ϕ : V (F ) → V (H) homomorphism then H is called hom(F )-free.
Lemma 3 (A simple form of the Removal Lemma) For every α > 0 and graph F there
is an n1 such that if n > n1 and G is an n-vertex, F -free graph then it contains a hom(F )-free
subgraph H with e(H) > e(G) − αn2 .
This means that H does not contain any homomorphic image of F as a subgraph, especially
if χ(F ) = p + 1 then H is Kp+1 -free. The Removal Lemma can be attributed to Ruzsa and
Szemerédi [20]. It appears in a more explicit form in [9] and [13]. For a survey of applications of Szemerédi’s regularity lemma in graph theory see Komlós-Simonovits [16] or KomlósShokoufandeh-Simonovits-Szemerédi [17].
Proof of (2) using Lemma 3 and Corollary 2. Suppose that F ∈ L, χ(F ) = p + 1 and α > 0 an
arbitrary real. Suppose that G is F -free with n > n1 (F, α) and e(G) > e(Tn,p ) − αn2 . We have
to show that the edit distance of G to Tn,p is small. First we claim that the edit distance of G
to a complete p–partite graph K(V1 , . . . , Vp ) is at most 7αn2 . Indeed, using the Removal Lemma
we obtain a Kp+1 -free subgraph H of G such that e(H) > e(G) − αn2 > e(Tn,p ) − 2αn2 . Apply
Theorem 1 to H we get a p–partite H0 with e(H0 ) > e(Tn,p ) − 4αn2 . Then Corollary 2 yields a
K := K(V1 , . . . , Vp ) with ed(K, H) < 6αn2 , giving ed(K, G) ≤ 7αn2 .
Since e(K) ≥ e(H0 ) > e(Tn,p ) − 4αn2 , we can use (3) with t = 2αn2 to get ed(K, Tn,p ) ≤
p
p
n2 2α/p. This completes the proof that ed(G, Tn,p ) ≤ (7α + 2α/p)n2 .
✷

Acknowledgments. The author is greatly thankful to M. Simonovits for helpful conversations.
This result was first presented in a public lecture at Charles University, Prague, July 2006. Since
then there were several references to it, e.g., in [19].

Z. Füredi: Stability of extremal graphs

5

References
[1] N. Alon: Bipartite subgraphs. Combinatorica 16 (1996), 301–311.
[2] N. Alon and U. Stav: The maximum edit distance from hereditary graph properties. J. Combin.
Theory, Ser. B 98 (2008), 672–697.
[3] M. Axenovich and R. Martin: Avoiding patterns in matrices via a small number of changes. SIAM
J. Discrete Math. 20 (2006), 49–54.
[4] B. Bollobás: Extremal Graph Theory. London Math. Soc. Monographs, Academic Press, 1978.
[5] P. Erdős: On even subgraphs of graphs. (Hungarian), Mat. Lapok 18 (1967), 283–288.
[6] P. Erdős: On the graph theorem of Turán. (Hungarian) Mat. Lapok 21 (1970), 249–251 (1971).
[7] P. Erdős: Some recent results on extremal problems in graph theory. Theory of Graphs, International
Symp. Rome, 1966, 118–123.
[8] P. Erdős: On some new inequalities concerning extremal properties of graphs. Theory of Graphs,
Proc. Coll. Tihany, (Hungary) 1966, 77–81.
[9] P. Erdős, P. Frankl, and V. Rödl: The asymptotic number of graphs not containing a fixed subgraph
and a problem for hypergraphs having no exponent. Graphs Combin. 2 (1986), 113–121.
[10] P. Erdős, E. Győri, and M. Simonovits: How many edges should be deleted to make a triangle-free
graph bipartite? Sets, graphs and numbers (Budapest, 1991), 239–263, Colloq. Math. Soc. János
Bolyai, 60, North-Holland, Amsterdam, 1992.
[11] P. Erdős and M. Simonovits: A limit theorem in graph theory. Studia Sci. Math. Hungar. 1 (1966),
51–57.
[12] P. Erdős and A. H. Stone: On the structure of linear graphs. Bull. Amer. Math. Soc. 52 (1946),
1089–1091.
[13] Z. Füredi: Extremal hypergraphs and combinatorial geometry. Proc. Internat. Congress of Mathematicians, Vol. 1, 2 (Zürich, 1994), 1343–1352, Birkhäuser, Basel, 1995.
[14] E. Győri: On the number of edge disjoint cliques in graphs of given size. Combinatorica 11 (1991),
231–243.
[15] D. Hanson and B. Toft: k-saturated graphs of chromatic number at least k. Ars Combin. 31 (1991),
159–164.
[16] J. Komlós and M. Simonovits: Szemerédi’s regularity lemma and its applications in graph theory.
Combinatorics, Paul Erdős is eighty, Vol. 2 (Keszthely, 1993), 295–352, Bolyai Soc. Math. Stud., 2,
Budapest, 1996.
[17] J. Komlós, Ali Shokoufandeh, M. Simonovits, and E. Szemerédi: The regularity lemma and its
applications in graph theory. Theoretical aspects of computer science (Tehran, 2000), 84–112, Lecture
Notes in Comput. Sci., 2292, Springer, Berlin, 2002.
[18] R. R. Martin: On the computation of edit distance functions. Discrete Math. 338 (2015), 291–305.
[19] D. Mubayi: Books versus triangles, Journal of Graph Theory 70 (2012), 171–179.
[20] I. Z. Ruzsa and E. Szemerédi: Triple systems with no six points carrying three triangles. Combinatorics Proc. Fifth Hungarian Colloq., Keszthely, 1976, Vol. II, pp. 939–945, Colloq. Math. Soc. János
Bolyai, 18, North-Holland, Amsterdam-New York, 1978.

Z. Füredi: Stability of extremal graphs

6

[21] M. Simonovits: A method for solving extremal problems in graph theory. Theory of Graphs, (P. Erdős
and G. Katona, eds.) Proc. Coll. Tihany (1966), 279–319.
[22] E. Szemerédi: Regular partitions of graphs. Problemes Combinatoires et Theorie des Graphes (ed.
I.-C. Bermond et al.), CNRS, 260 Paris, 1978, pp. 399–401.
[23] P. Turán: On an extremal problem in graph theory. Matematikai Lapok, 48 (1941), 436–452 (in
Hungarian). Reprinted in English in: Collected papers of Paul Turán. Akadémiai Kiadó, Budapest,
1989. Vol 1–3.

