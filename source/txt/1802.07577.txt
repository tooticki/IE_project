COMPLEX CELLULAR STRUCTURES

arXiv:1802.07577v1 [math.CV] 21 Feb 2018

GAL BINYAMINI AND DMITRY NOVIKOV

Abstract. We introduce the notion of a complex cell, a complexification of
the cells/cylinders used in real tame geometry. Complex cells are equipped
with a natural notion of holomorphic extension, and the hyperbolic geometry
of a cell within its extension provides the class of complex cells with a rich
geometric function theory absent in the real case. We use this to prove a
complex analog of the cellular decomposition theorem of real tame geometry.
In the algebraic case we show that the complexity of such decompositions
depends polynomially on the degrees of the equations involved.
Using this theory, we sharpen the Yomdin-Gromov algebraic lemma on C r smooth parametrizations of semialgebraic sets: we show that the number of
C r charts can be taken to be polynomial in the smoothness order r and in the
complexity of the set. The algebraic lemma was initially invented in the work
of Yomdin and Gromov to produce estimates for the topological entropy of C ∞
maps. Combined with work of Burguet, Liao and Yang, our refined version
establishes an optimal sharpening of these estimates for analytic maps, in the
form of tight bounds on the tail entropy and volume growth. This settles a
conjecture of Yomdin who proved the same result in dimension two in 1991.
A self-contained proof of these estimates using the refined algebraic lemma is
given in an appendix by Yomdin.
The algebraic lemma has more recently been used in the study of rational
points on algebraic and transcendental varieties. We use the theory of complex
cells in these two directions. In the algebraic context we prove a sharpening of a
result of Heath-Brown on interpolating rational points in algebraic varieties. In
the transcendental context we prove an interpolation result for (unrestricted)
logarithmic images of subanalytic sets.

Contents
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.

Introduction
Complex cellular structures
Generalities on complex cells
Semialgebraic and subanalytic sets
The principal lemmas
Geometric constructions with cells
Cellular Weierstrass Preparation Theorem
Proofs of the CPT and CPrT
Analysis on complex cells
Smooth parametrization results

2
12
21
25
27
34
41
48
54
59

Date: February 22, 2018.
2010 Mathematics Subject Classification. 14P10,37B40,03C64,30C99.
Key words and phrases. Gromov-Yomdin reparametrization, Cellular decomposition, Topological entropy, Diophantine geometry.
This research was supported by the ISRAEL SCIENCE FOUNDATION (grant No. 1167/17)
and by funding received from the MINERVA Stiftung with the funds from the BMBF of the
Federal Republic of Germany.
1

2

GAL BINYAMINI AND DMITRY NOVIKOV

Appendix A. Applications in dynamics
Appendix B. Applications in diophantine geometry
References

65
70
77

1. Introduction
In this section we aim to provide an intuitive motivation for the formal notion of
complex cells introduced in §2. We discuss the smooth parametrization problem,
particularly the Yomdin-Gromov algebraic lemma and its sharpenings established
in this paper. We then discuss the hyperbolic obstruction to a Gromov-Yomdin
type lemma in the holomorphic category and motivate the notion of a complex cell
as a way of overcoming this obstruction. Finally we briefly discuss the applications
of our parametrization results in smooth dynamics and in diophantine geometry.
1.1. Smooth parametrizations.
1.1.1. The Yomdin-Gromov Algebraic Lemma. In [50, 49] Yomdin gave a proof of
Shub’s entropy conjecture for C ∞ -maps. A key step in this proof was the construction of C r -smooth parametrizations of semialgebraic sets with the number of
charts depending only on the combinatorial data. More precisely, for a C r -smooth
function f : U → Rn on a domain U ⊂ Rm we denote by kf k the maximum norm
on U and
kDα f k
kf kr := max
.
(1)
α!
|α|6r
The original parametrization theorem of [50, 49] involved a technical condition on
the removal of a small piece from the semialgebraic set being parameterized. The
formulation was further sharpened by Gromov [21], who proved the result in the
following clean formulation known as the Yomdin-Gromov Algebraic Lemma (see
also [13] for a detailed proof).
Theorem ([21, 3.3. Algebraic Lemma]). Let X ⊂ [0, 1]n be a semialgebraic set of
dimension
µ defined by conditions pj (x) = 0 or pj (x) < 0 where pj are polynomials
P
and
deg pj = β. Let r ∈ N. There exists a constant C = C(n, µ, r, β) and
semialgebraic maps φ1 , . . . , φC : (0, 1)µ → X of such that their images cover X and
kpj kr 6 1 for j = 1, . . . , C.
Understanding the behavior of the constant C(n, µ, r, β) has been the key difficulty in establishing a conjectural sharpening of Yomdin’s results for analytic maps,
as we discuss in §1.3. More precisely, what is needed is an estimate C(n, µ, r, β) =
polyn (r, β). Such an estimate is our first main result.
Theorem 1. In the Yomdin-Gromov algebraic lemma one may take C(n, µ, r, β) =
polyn (β)·rµ . Moreover the maps φj can be chosen to be semialgebraic of complexity
poly` (β, r).
1.1.2. Pila-Wilkie’s generalization to o-minimal structures. Parametrizations by
C r -smooth functions have also been used to great effect in the seemingly unrelated study of rational points on algebraic and transcendental sets. The algebraic
lemma was first introduced to this subject by Pila and Wilkie [37], who proved its
far-reaching generalization for arbitrary o-minimal structures.

COMPLEX CELLULAR STRUCTURES

3

Theorem ([37, Theorem 2.3]). Let {Xp ⊂ [0, 1]n } be a family of sets definable in
an o-minimal structure, with dim Xp 6 µ. There exists a constant C = C(X, r)
such that for any p there exist definable maps φ1 , . . . , φC : (0, 1)µ → Xp such that
their images cover X and kφj kr 6 1 for j = 1, . . . , C.
In the diophantine direction, understanding the behavior of C(X, r) with respect
to the geometry of the family X and the smoothness order r is also a question of
great importance as we discuss in §1.4. In the recent paper [17] Cluckers, Pila and
Wilkie made significant progress in this direction by proving that for subanalytic
sets (and also sets in the larger structure Rpow
an ) one has C(X, r) = polyX (r). For
subanalytic sets we obtain a similar result with a precise control over the degree.
Theorem 2. In the Pila-Wilkie algebraic lemma for Ran one may take C(X, r) =
OX (rµ ) where µ := maxp (dim Xp ).
1.1.3. Mild parametrizations. It is natural to inquire whether one can in fact replace the C r -charts in the algebraic lemma with C ∞ charts with appropriate control over the derivatives. In [39] Pila introduced a notion of this type called mild
parametrization and investigated its diophantine applications related to the Wilkie
conjecture.
Definition 1 (Mild parametrization). A smooth map f : U → [0, 1]n on a domain
U ⊂ Rm is said to be (A, C)-mild if
kDα f k 6 α!(A|α|C )|α| ,

∀α ∈ Nm .

(2)
n

In [26] it is shown that every subanalytic set X ⊂ [0, 1] admits (A, 0)-mild
(i.e. analytic) parametrizations, but this result is not uniform over families and its
diophantine applications are restricted to the case of curves [26] and surfaces [27].
We prove the following uniform version.
Theorem 3. Let {Xp ⊂ [0, 1]n } be a subanalytic family of sets, with dim Xp 6 µ.
There exist constants A = A(X) and C = C(X) such that for any p there exist
(A, 2)-mild maps φ1 , . . . , φC : (0, 1)µ → Xp whose images cover X. If {Xp } is
semialgebraic as in the Yomdin-Gromov algebraic lemma then one may take A, C =
polyn (β).
The construction of a mild parametrization is a-priori more delicate than its C r
counterpart since it requires one to control derivatives of all orders at once. In
fact, Thomas [47] has shown that there exist o-minimal structures without definable mild parametrizations. In our results there is also a key difference between
the C r algebraic lemma and its mild counterpart. Namely, in the C r version the
parameterizing maps are themselves subanalytic, and can be chosen to depend subanalytically on the parameters of the family. We make no such guarantee in the
mild version. In fact, we show that any parameterization of a family of hyperbolas
by a definable family of Ran maps must have unbounded C r -norms for some finite
r. More precisely we have the following sharp estimate.
Proposition 2. Let F := (x, y) : [0, 1]2 → [0, 1]2 be an Ran -definable map satisfying
x(e, t) · y(e, t) = e. Suppose that for each r there exists a constant Mr such that
|∂tr x(e, t)| < Mr

|∂tr y(e, t)| < Mr

(3)

whenever the derivatives are defined. Then the Euclidean length of log F (e0 , [0, 1])
is bounded by a constant independent of e0 6= 0 (here log is applied coordinate-wise).

4

GAL BINYAMINI AND DMITRY NOVIKOV

This result is easily seen to be essentially tight: one can indeed construct parameterizations F as in Proposition 2 to cover any definable family of intervals of constant logarithmic length in the hyperbolas. Somewhat surprisingly, our proof goes
via reduction using complex cells to the following simple statement from geometric
function theory, which is proved using a p-valent version of the Koebe 1/4-theorem.
Lemma 3. Let ξ : D(2) → C \ {0} be holomorphic and suppose that ξ is p-valent.
Then the length of log ξ([−1, 1]) is bounded by a constant 8πp(p + 1).
The proof of Proposition 2 and Lemma 3 is given in §10.4.
1.2. Holomorphic parametrizations. In the preceding section we discussed the
problem of constructing smooth parametrizations for semialgebraic and subanalytic
sets. It is natural to wonder whether such constructions can be analytically continued to give holomorphic parametrizations in some suitable sense. In this section
we demonstrate an obstruction of a hyperbolic-geometric nature to a naive formulation, and motivate the notion of a complex cell as a possible way of overcoming
this obstruction.
1.2.1. Parametrizations of analytic curves and questions of uniformity. Let D ⊂ C
denote the unit disc and D1/2 ⊂ C denote the disc of radius two. If X is a
holomorphic curve and K ⊂ X is compact then one can always cover K by images
of analytic charts fj : D → X. To avoid bad behavior near the boundary, we can
also require that each fj extend as a holomorphic map to D1/2 (this is an arbitrary
choice which could be replaced by any fixed neighborhood of D̄). Parameterizations
of this type are useful in analysis: they allow one to study holomorphic structures
on X in terms of their pullback to D ⊂ D1/2 , where a rich geometric function
theory is available. Moreover, the theory of resolution of singularities shows that
this type of parametrization can be extended to parametrizations of analytic sets
of any dimension. A notion of this type was introduced by Yomdin [51] under the
name analytic complexity unit (acu). A similar notion was considered under the
name “doubling coverings” in [19].
Ideally one would like to prove that holomorphic parameterizations of the type
described above can be made with a uniform number of charts when X is replaced by
an analytic family Xε of curves (or higher dimensional sets) and K by its compact
subfamily. Indeed, this would be an appropriate analog of the Yomdin-Gromov
algebraic lemma in the holomorphic category. Unfortunately this is impossible,
even for simple families of algebraic curves. Consider the family Xε of hyperbolas
restricted to the polydisc of radius 2 and Kε their restriction to a polydisc of radius
1,
Xε := {(x, y) : xy = ε, x, y ∈ D1/2 }

Kε := Xε ∩ (D × D).

(4)

The projection to the x-axis gives biholomorphisms Kε ' Aε := A(ε, 1) and Xε '
1/2
1/2
Aε := A(ε/2, 2) where A(r1 , r2 ) := {r1 < |z| < r2 }. Let f : D1/2 → Xε ' Aε . If
1/2
we equip D1/2 and Aε with their respective hyperbolic metric then the SchwarzPick lemma implies that f is distance-contracting (see §5 for a brief reminder on this
1/2
subject). In particular the diameter of f (D) in Aε is bounded by the diameter of
D in D1/2 , which is a constant independent on ε. On the other hand, the diameter
1/2
of Kε ' Aε in Aε tends to infinity as ε → 0 (in fact with order log | log ε|, see
Remark 41). It follows that to cover Kε by images of maps as above at least

COMPLEX CELLULAR STRUCTURES

5

log | log ε| charts are required, and this is easily seen to be a tight asymptotic. We
note that Yomdin [52] obtains a similar result with | log ε| which holds under the
assumption that the maps are p-valent for some fixed p.
1.2.2. A uniform parameterization result with discs and annuli. It turns out that in
the one-dimensional case, the hyperbolic restriction described above is essentially
the only obstacle to uniform parametrization. Namely, suppose that in addition
to covering Kε by images f (D) of holomorphic maps f : D1/2 → Xε we allow
also images f (A) of holomorphic maps f : A1/2 → Xε for any annulus A. Note
that the diameter A in Aδ is not uniformly bounded: it depends on the conformal
modulus. With this added freedom one can indeed construct a parameterization
with a uniformly bounded number of charts for a family of curves. We proceed to
explain the elementary geometric considerations that lead to this result.
To simplify our presentation we suppose that Xε ⊂ C2 ×Cε is a family of algebraic
plane curves which project properly under π : (x, y) → x (although a similar local
argument works in the analytic case without the assumption of properness as well).
We will parameterize the fibers of Kε := Xε ∩(D×D). Fix ε ∈ C. Let Σ ⊂ C denote
the finite set of critical values of π|Xε . Denote by ν the order of the monodromy
group of π. Note that #Σ and ν are bounded in terms of deg Xε and in particular
uniformly in ε. Suppose C ⊂ C is one of the following three types:
(1) A disc p + D(r) such that p + D(2r) does not meet Σ.
(2) A disc p+D(r) such that p ∈ Σ and p+D(2ν r) does not meet any additional
points in Σ.
(3) An annulus p + A(r1 , r2 ) such that p + A(r1 /2ν , 2ν r2 ) does not meet Σ.
In case 1 one can construct a map f : D → p + D(r) → Xε by lifting π. In cases
2,3 the lift might be multivalued with a monodromy of finite order ν (uniformly
bounded in ε), but precomposing with the map z → z ν we similarly obtain univalued charts f : D → Xε or f : Ar → Xε . Moreover the assumption on C ensure that
1/2
f extends holomorphically to D1/2 or Ar . Taking the deg Xε different lifts of π
−1
we thus obtain charts covering Xε ∩ π (C).
It remains to show that D can be covered by finitely many domains C as above,
with their number depending only on the number of points in Σ (but not on their
positions). This is a simple exercise in plane geometry which we urge the reader to
attempt for themselves. It is also instructive to check that a similar statement would
not hold had we not allowed annuli as in item 3 above.
In Figure 1 we illustrate such
√
a decomposition for the critical points Σ = {± ε} of the hyperbola y 2 = x2 − ε
(this is just our original example xy = ε rotated to satisfy our assumption of proper
projection to the x-axis).
Decompositions of a similar type appeared under the name “Swiss-cheese decompositions” in [23] where they were used in the study of Green functions on Riemann
surfaces. They also appeared in [8] where they were used in the study of collisions
of singular points of Fuchsian differential equations.
1.2.3. Parametrizing higher dimensional sets. It is natural to ask whether a similar
“uniform parametrization” statement might hold in higher dimensions. A naive
attempt might be to use products of discs and annuli as the domains of definition.
However, since complex annuli (unlike discs) have conformal moduli, it turns out
to be more natural to allow domains consisting of families of annuli with varying

6

GAL BINYAMINI AND DMITRY NOVIKOV

Figure 1. Covering of the hyperbola
√ with discs and annuli, where
∗ corresponds to points of Σ = {± ε}.
moduli. As an illustrative example, in the two-dimensional case we allow domains
of the form
C = D◦ (1)  A(z1 , 2) := {(z1 , z2 ) : 0 < |z1 | < 1, |z1 | < |z2 | < 2}.

(5)

The notation  above is an example of a more general notation introduced in §2,
and the domain above is an example of a complex cell. The definition closely
resembles the notion of cells/cylinders in semialgebraic/subanalytic geometry, with
the order relation x < y replaced by the complex |x| < |y|.
To generalize the parametrization result from curves to higher dimensional sets
we require not only an analog of the domains D or A, but also an analog of their
extensions D1/2 , A1/2 . Correspondingly our complex cells C are endowed with a
natural notion of δ-extension C ⊂ Cδ . In the example above
Cδ = Dδ (1)  Aδ (z1 , 2) = D(δ −1 )  A(δz1 , 2δ −1 ) :=
{(z1 , z2 ) : |z1 | < δ −1 , δ|z1 | < |z2 | < 2δ −1 }. (6)
This is defined for any 1/2 < δ < 1: we require the original fiber A(z1 , 2) to remain
an annulus over the extension Dδ (1), and for δ < 1/2 it would become an empty
set.
Our main result, Theorem 8, shows in particular that one can uniformly uniformize any family of analytic sets if one is permitted to use general complex cells
as the domains for the charts. More generally, Theorem 8 provides a cellular analog
of the constructions of local resolution of singularities (LRS), see e.g. [5]. Loosely
speaking it allows one to transform a collection of analytic functions into normal
crossings uniformly over families - using complex cells as the domains of the charts.
In the algebraic category, Theorem 8 gives effective control (polynomial in the degrees) on the number and complexity of the charts in terms of the complexity of
the functions being transformed into normal crossings. This is where the most important step toward improving the asymptotics of the Yomdin-Gromov algebraic
lemma takes place, and the proof makes extensive use of the hyperbolic properties
of a cell C viewed as a subset of it extension Cδ .
1.2.4. Sectorial parametrizations. In the preceding sections we discussed the problem of establishing an analog of the algebraic lemma with holomorphic functions
admitting extensions to whole discs, and showed that (unless one also allows annuli
and more general complex cells) such an analog is impossible for hyperbolic reasons. A more modest goal might be to establish an analog of the algebraic lemma

COMPLEX CELLULAR STRUCTURES

7

where the parametrizing maps admits analytic continuation to some suitable large
domain (though not a full disc). If the domain is sufficiently large, one could then
hope to control the derivatives using complex-analytic methods, for instance the
Cauchy estimates.
It turns out that the correct domains for analytic continuation are complex
sectors. More specifically, let S(ε) denote the sector S(ε) = {Arg z < ε, |z| < 2},
and for B = (0, 1)µ let B(ε) denote the direct product of µ copies of S(ε). All of
our refinements of the algebraic lemma follow from the following statement about
parametrizations with complex-analytic continuation to sectors.
Theorem 4. Let {Xp ⊂ [0, 1]n } be a subanalytic family of sets, with dim Xp 6 µ.
Set B = (0, 1)µ . There constants C = C(X) and ε = ε(X) such that for any p there
exist maps φ1 , . . . , φC : B → Xp whose images cover Xp . Moreover each φj extends
holomorphically to B(ε) and has unit C 1 -norm there. If {Xp } is semialgebraic as
in the Yomdin-Gromov algebraic lemma then one may take C, ε−1 = polyn (β).
This theorem is proved (in a more general form) in §10.1. We start by constructing a complex-cellular parameterization for Xp , and then show how to construct
maps from B into a complex cell which extend to B(ε) with bounded C 1 -norms.
The C r and mild statements of the algebraic lemma are deduced from the sectorial
version by a simple (and self-contained) argument based on the Cauchy estimates
in §10.3.
1.3. Applications in dynamics. The Yomdin-Gromov algebraic lemma was first
invented for the purpose of studying the properties of the topological entropy of
smooth maps. We recall the basic notions of topological entropy theory, Shub’s
entropy conjecture and Yomdin’s result for C ∞ -maps. We then discuss a refinement
of these results in the analytic category culminating in Theorem 5 confirming in
arbitrary dimension a conjecture of Yomdin that was previously known only in
dimension two. Theorem 5 follows immediately from the refined algebraic lemma
in combination with the work of Burguet, Liao and Yang [14]. A self-contained
proof of Theorem 5 using the refined algebraic lemma is given in §A (by Yomdin).
Below we mostly follow the notations and presentation of [14] in our survey.
1.3.1. Topological entropy. Let M be a compact metric space with metric d : M 2 →
R>0 and let f : M → M be a continuous map. For n ∈ N define the n-th iterated
metric by
dn : M × M → R>0 ,

dn (x, y) =

max

i=0,...,n−1

d(f ◦i (x), f ◦i (y)).

(7)

Recall if X is a metric space and Λ ⊂ X we say that a set K ⊂ X is ε-spanning
for Λ if the ε-neighborhood of K contains Λ. For any subset Λ ⊂ M and ε > 0 and
n ∈ N we let rn (f, Λ, ε) denote the minimal cardinality of an ε-spanning set of Λ
with respect to the dn -metric.
The ε-topological and topological entropies of Λ are defined by
h(f, Λ, ε) = lim sup
n→∞

1
log rn (f, Λ, ε),
n

h(f, Λ) = lim f (f, Λ, ε).
ε→0

(8)

We set h(f, ε) := h(f, M, ε) and h(f ) := h(f, M ). This latter quantity is called the
topological entropy of f . As its name implies, the topological entropy is independent
of the choice of metric d. It was first defined by Adler, Konheim and McAndrew

8

GAL BINYAMINI AND DMITRY NOVIKOV

[1] in a purely topological fashion, and later shown by Bowen [10] to be equivalent
to the metric definition presented above.
1.3.2. Tail entropy. For x ∈ M we define the infinite dynamical ball B∞ (x, ε) by
B∞ (x, ε) := {y ∈ M : dn (x, y) < ε ∀n ∈ N}.

(9)

Following Bowen [11], the ε-tail and tail entropies of f are defined by
h∗ (f, ε) = sup h(f, B∞ (x, ε)),

h∗ (f ) = lim h∗ (f, ε).
ε→0

x∈M

(10)

Bowen [11] has shown that the ε-tail entropy bounds the difference between the
ε-entropy and the entropy, that is
|h(f ) − h(f, ε)| < h∗ (f, ε).

(11)

If h∗ (f, ε) = 0 for some ε > 0 then the system (f, M ) is called entropy-expansive (hexpansive); if h∗ (f ) = 0 then it is called asymptotically entropy expansive (asymptotically h-expansive). This notion of tail entropy was first introduced (with a
different definition) by Misiurewicz [32] under the name conditional entropy. Misiurewicz showed that for asymptotically h-expansive systems the measure-theoretical
entropy is upper-semicontinuous, and such systems therefore always admit an invariant measure of maximal entropy.
1.3.3. Yomdin’s results for smooth maps. Assume from now on that M is a compact
C ∞ -smooth manifold equipped with a Riemannian metric. In [50] Yomdin proved
Shub’s entropy conjecture for C ∞ maps. This conjecture states that the logarithm
of the spectral radius of Spec f of f∗ : H∗ (M, R) → H∗ (M, R) is a lower bound for
h(f ). In fact it is relatively easy to show (by comparing volumes) that
log Spec f < h(f ) +

max

k=1,...,dim M

vk∗ (f )

(12)

where vk∗ (f ) is the k-dimensional local volume growth, a quantity related to h∗ (f )
whose precise definition we postpone to §A. Yomdin’s fundamental result was that
if f is a C r -map then
vk∗ (f ) 6

kR(f )
,
r

R(f ) = lim

n→∞

1
sup kDx f ◦n k
n x∈M

(13)

For C ∞ -maps this implies vk∗ (f ) = 0, and in combination with (12) yields Shub’s
entropy conjecture. Buzzi [16] later observed that Yomdin’s argument also implied
the same estimate h∗ (f ) 6 (dim M/r)R(f ) for the tail entropy. For C ∞ -maps this
implies h∗ (f ) = 0, i.e. that C ∞ -maps are asymptotically h-expansive.
1.3.4. Controlling h∗ (f, ε) for analytic maps. Bounding h∗ (f, ε) explicitly as a function of ε is an important problem with consequences for the computation of h(f )
(for instance using (11)) and for the study of the semicontinuity properties of the
entropy. However, for arbitrary C ∞ maps f : M → M the rate of convergence
of h∗ (f, ε) to zero as ε → 0 can be arbitrarily slow, as shown by the examples of
Burguet, Liao and Yang [14, Theorem L].
In [51] Yomdin considered the case of a real-analytic map f : M → M of a
compact analytic surface M . In this context, using a holomorphic variant of the

COMPLEX CELLULAR STRUCTURES

9

algebraic lemma based on the Bernstein inequality for polynomials, he was able to
prove that
log | log ε|
v1∗ (f, ε) 6 C(f ) ·
.
(14)
| log ε|
Yomdin conjectured [51, Conjecture 6.1] that a similar estimate should hold (for vk∗ )
for M of arbitrary dimension, but the limitation of the holomorphic parametrization
technique to one dimension prevented such a generalization (see [52] for some results
in this direction in dimension two). In [14, Theorem N] it is shown that the bound
in Yomdin’s conjecture is essentially sharp (for class slightly larger than the analytic
class).
In [14] Burguet, Liao and Yang revisited the problem of the rate of convergence
of the tail entropy for analytic, and more general, maps. The precise statement of
their main result is technical and depends on the behavior of the algebraic lemma’s
constant C(n, µ, r, β). However, under the hypothesis C(n, µ, r, β) = polyn (r, β)
the results of [14, Corollary B] take a particularly simple form: namely, they imply
the generalization of Yomdin’s result (both for vk∗ and h∗ ) to arbitrary dimension
(and also for a class of functions somewhat larger than the analytic class). It is also
shown in [14] that C(n, 1, r, β) = polyn (r, β) and this recovers Yomdin’s result for
analytic surfaces.
To summarize, following the work of [14] it has been clear that proving the
C(n, µ, r, β) = polyn (r, β) is the missing step to establishing Yomdin’s conjecture.
Combined with the refined algebraic lemma proved in this paper this is now a
theorem.
Theorem 5. Let M be a compact analytic manifold and f : M → M be an analytic
map. Then
h∗ (f, ε) 6 C(f ) ·

log | log ε|
,
| log ε|

vk∗ (f, ε) 6 C(f ) ·

log | log ε|
| log ε|

(15)

for k = 1, . . . , dim M .
Proof. We indicate the proof with the notations of [14]. Applying the refined algebraic lemma to the graph of the polynomial map P : [0, 1]l → [0, 1]l in [14,
Section 2.1.2] one obtains the estimate Cr,l,m = polym,l (r). This implies that the
2
sequence Mk := k k is (l, m)-admissible for any l, m ∈ N. Then [14, Corollary B]
2
applies to any map f which satisfies kf kr < Crr for some constant C and every
r > 0. In particular, it applies to analytic maps. We also have


t
GM (t) = sup{k log k < t} = Θ
.
(16)
log t
k
Thus (15) follows from the conclusion of [14, Corollary B].



1.4. Applications in diophantine geometry. For p ∈ P` (Q) we define H(p) to
be maxi |pi | where p ∈ Z`+1 is a projective representative of p with
gcd(p0 , . . . , p` ) = 1.

(17)

For x ∈ A` (Q) we define its height to be the height of ι(x) for the standard embedding
ι : A` → P` ,
ι(x1..` ) = (1 : x1 : · · · : x` ).
(18)

10

GAL BINYAMINI AND DMITRY NOVIKOV

For a set X ⊂ P` (R) we denote
X(Q, H) := {x ∈ X ∩ P(Q)` : H(x) 6 H},

(19)

and similarly for X ⊂ R` .
In [9] Bombieri and Pila introduced the interpolation determinant method for
estimating the quantity #X(Q, H) as a function of H when X is the graph of a
C r (or C ∞ ) smooth function f : [0, 1] → R. It turns out that two very different
asymptotic behaviors are obtained depending on whether the graph of f belongs
to an algebraic plane curve. The algebraic lemma has been used in both of these
directions, to generalize from graphs of functions to more general sets. In §B.1 we
give a complex-cellular analog of the Bombieri-Pila determinant method and use
it to deduce some applications for both the algebraic and transcendental contexts.
We briefly describe the main results below.
1.4.1. A result for algebraic varieties. We prove the following result.
Theorem 6. Let X ⊂ P(C)` be an irreducible algebraic variety of dimension m
and degree d. Then X(Q, H) is contained in N hypersurfaces of degree k, none of
which contain X, where
−1/m

N = poly` (d, k) · H (m+1)d

(1+poly` (d)/k)

.

(20)

We make note of two particular choices for k, namely
k = poly` (d)/ε

=⇒

k = poly` (d) · log H

=⇒

N = poly` (d, 1/ε) · H (m+1)d

−1/m

+ε

−1/m

N = poly` (d, log H) · H (m+1)d

.

(21)
(22)

The first choice improves the dependence on the degree d to polynomial in HeathBrown’s result [25] for hypersurfaces and Broberg’s result [12, Theorem 1] (see
also Marmon [30]). The second choice replaces an H ε factor by a power of log H,
similar to the various results established for curves by Pila [40] and Salberger [45].
We remark that in the case of curves, Walsh [48] recently proved a result eliminating
the log H factor altogether and it would be interesting to study whether this can be
generalized to arbitrary dimension. We briefly survey the history of these results
in §B.2.1 and prove Theorem 6 in §B.2.2.
1.4.2. The Pila-Wilkie theorem. Let f : I → R2 and suppose that Xf := f (I) is
transcendental. Bombieri and Pila [9] and Pila [36] used the determinant method to
show that #X(Q, H) = OX,ε (H ε ) for any ε > 0. To generalize this result to higher
dimensions, let X ⊂ R` and denote by X alg the union of all positive dimensional
connected semialgebraic sets contained in X and by X trans := X \ X alg . Pila and
Wilkie [37] proved that for any X definable in an o-minimal expansion of R we have
#X trans (Q, H) = OX,ε (H ε )

∀ε > 0.

(23)

Moreover, if X varies over a definable family then the asymptotic constants can
be taken uniform over the family. The o-minimal version of the Yomdin-Gromov
algebraic lemma plays the central role in the proof of the Pila-Wilkie theorem.

COMPLEX CELLULAR STRUCTURES

11

1.4.3. The Wilkie conjecture. Wilkie [37] has conjectured that for sets definable in
Rexp the asymptotic in the Pila-Wilkie theorem can be improved to polyX (log H),
and it is natural to make similar conjectures for other “natural” geometric structures (although such a result does not hold for general subanalytic curves, see [38,
Example 7.5]). One of the key obstacles to proving the Wilkie conjecture, at least
following the Pila-Wilkie strategy, is to obtain an estimate on C(X, r) which is
polynomial in r and the complexity of X. Some one-dimensional and some restricted two-dimensional cases of the Wilkie conjecture have been established using
methods involving Pfaffian functions and mild parametrizations [41, 27, 42, 15]. In
[6] we developed a complex-analytic approach to the Pila-Wilkie theorem in the
subanalytic case, and in [7] we used this approach to prove the Wilkie conjecture
for the structure RRE generated by the exponential and trigonometric functions
restricted to some finite interval.
1.4.4. Applications to unlikely intersections in diophantine geometry. The PilaWilkie theorem has been applied to great effect in the study of unlikely intersections
in diophantine geometry. We briefly mention Pila-Zannier’s proof the the ManinMumford conjecture [44], Pila’s proof of the André-Oort conjecture for modular
curves [43] and Masser-Zannier’s work on simultaneous torsion points in elliptic
families [31]. We refer the reader to [53, 46] for a survey. Some of the most striking diophantine applications, particularly around the study of modular curves and
Shimura varieties, require the generality of the Pila-Wilkie theorem for Ran,exp , i.e.
beyond the subanalytic category. Obtaining polylogarithmic asymptotics for such
unrestricted sets is the natural challenge going beyond the scope of [7].
1.4.5. Interpolating rational points on log-sets. For definiteness let loge : C \ {0} →
C denote the principal branch of the standard complex logarithm. Below log can
denote λ loge (·) for any λ ∈ C \ {0}, i.e. logarithm with respect to any (fixed) base.
We extend log as a function of several variables coordinate-wise.
Definition 4 (Log-set). If A ⊂ (C \ {0})` is a bounded subanalytic set (where C`
is identified with R2` ) then we call log A a log-set.
Any bounded subanalytic set is a log-set, but log-sets are of course more general
as they involve application of an unrestricted logarithm. In §B.3.1 we show that
log-sets appear naturally in the application of the Pila-Wilkie theorem to the AndrèOort conjecture for modular curves in Pila’s work [43]. They are therefore perhaps
the most natural candidate to consider looking for results in the direction of the
Wilkie conjecture for unrestricted sets (with an eye to the diophantine applications).
We prove the following result in this direction.
Proposition 5. Let {Xλ ⊂ [0, 1]` } be an Ran -definable family let n denote the
maximal dimension of the fibers of X. Fix k ∈ N. There exists an Ran -definable
family {Yλ,µ ⊂ Xλ } with maximal fiber dimension strictly smaller than n, such
−1/n
)
that for any parameter λ there is a collection of N = H OX (k
parameters {µj }
satisfying
N
[
(log Xλ )trans (Q, H) ⊂
log Yλ,µj
(24)
j=1

Each Yλ,µ is defined by intersecting Xλ with a collection of polynomial equations of
degree k in the variables log x1 , . . . , log x` .

12

GAL BINYAMINI AND DMITRY NOVIKOV

Proposition 5 is reminiscent of the main inductive step in the proof of the PilaWilkie theorem. In particular, fixing k such that N = H ε and using induction
over the fiber dimension, the proposition immediately yields a proof of the PilaWilkie theorem for log-sets. On the other hand, setting k = (log H)n yields an
interpolation result using a constant number of hypersurfaces of polylogarithmic
degree and can be seen as the first inductive step toward the Wilkie conjecture.
This is similar to the main result of [17] for sets definable in Rpow
an .
The proof of Proposition 5 is given in §B.3.3. It relies heavily on the theory
of complex cells, and is effective in the following sense: a generalization of the
polynomial complexity of the algebraic CPT to a reduct of Ran which includes the
restricted logarithm would automatically yield a proof of the Wilkie conjecture for
log-sets log A with A definable in the reduct. While we do not prove such a version
of the CPT in this paper (and there appear to be some technical obstacles to doing
so), this seems to offer a plausible approach to proving the Wilkie conjecture for a
large class of unrestricted sets that are important in applications.
Even for the case that k is a constant independent of H, Proposition 5 yields
additional information compared to the standard proof of the Pila-Wilkie theorem.
Namely, in the standard proof the sets Yλ,µ are also defined by intersecting Xλ with
a collection of polynomial equations of degree k in the variables log x1 , . . . , log x` .
In general such sets would not be subanalytic. In our version certain cancellations
in the logarithmic terms allow one to find suitable equations which are subanalytic
on Xλ , thus proving that Yλ,µ are also subanalytic. This eventually implies that
the part of Xλalg responsible for the presence of many points of height H is also a
union of log-sets.
2. Complex cellular structures
2.1. Discs and annuli in the complex plane. For r ∈ C (resp. r1 , r2 ∈ C) with
|r| > 0 (resp. |r2 | > |r1 | > 0) we denote
D(r) := {|z| < |r|}

D◦ (r) := {0 < |z| < |r|}

A(r1 , r2 ) := {|r1 | < |z| < |r2 |}

∗ := {0}.

(25)
(26)

We also set S(r) := ∂D(r). For any 0 < δ < 1 we define the δ-extensions, denoted
by superscript δ, by
Dδ (r) := D(δ −1 r)
δ

A (r1 , r2 ) := A(δr1 , δ

−1

D◦δ (r) := D◦ (δ −1 r)
r2 )

δ

∗ := ∗.

(27)
(28)

We also set S δ (r) = A(δr, δ −1 r). The notion of δ-extension is naturally associated
with the Euclidean geometry of the complex plane. However, in many cases it is
more convenient to use a different normalization associated with the hyperbolic
geometry of our domains. For any 0 < ρ < ∞ we define the {ρ}-extension F{ρ} of
F to be Fδ where δ satisfies the equations
2πδ
for F of type D,
ρ=
1 − δ2
(29)
π2
ρ=
for F of type D◦ , A.
2| log δ|
The motivation for this notation comes from the following fact, describing the
hyperbolic-metric properties of a fiber F within its {ρ}-extension. For a reminder

COMPLEX CELLULAR STRUCTURES

13

on the hyperbolic metric associated to a planar domain see §5. Fact 6 is proved by
explicit computation in §5.6.
Fact 6. Let F be a fiber of type A, D, D◦ and let S be a component of the boundary
of F in F{ρ} . Then the length of S in F{ρ} is at most ρ.
2.2. Complex cells.
2.2.1. The general setting. We introduce a notation that will be used throughout
the paper. Let X, Y be sets and F : X → 2Y be a map taking points of X to subsets
of Y. Then we denote
X  F := {(x, y) : x ∈ X, y ∈ F(x)}.

(30)

In this paper X will be taken to be a subset of C and Y will be C. If r : X →
C \ {0} then for the purpose of this notation we understand D(r) to denote the
map assigning to each x ∈ X the disc D(r(x)), and similarly for D◦ , A.
We now introduce the central notion of this paper, namely the notion of a complex cell of length ` ∈ Z>0 and type T(C) ⊂ {∗, D, D◦ , A}` . If U is a complex
manifold we denote by O(U ) the space of holomorphic functions on U , and by
Ob (U ) ⊂ O(U ) the subspace of bounded functions.
n

Definition 7 (Complex cells). To base our induction, a complex cell C of length
zero is the singleton C0 . The type of C is the empty word. A complex cell of length
` + 1 has the form C1..`  F where the base C1..` is a cell of length `, and the fiber
F is one of ∗, D(r), D◦ (r), A(r1 , r2 ) where r ∈ Ob (C1..` ) satisfies |r(z1..` )| > 0 for
z1..` ∈ C1..` ; and r1 , r2 ∈ Ob (C1..` ) satisfy 0 < |r1 (z1..` )| < |r2 (z1..` )| for z1..` ∈ C1..` .
The type T(C) is T(C1..` ) followed by the type of the fiber.
Next, we define the notion of a δ-extension (resp. {ρ}-extension) of a cell of
length ` where δ ∈ (0, 1)` (resp. ρ ∈ (0, ∞)` ).
Definition 8. The cell of length zero is defined to be its own δ-extension. A cell
1..`
C of length ` + 1 admits a δ-extension Cδ := Cδ1..`
 Fδ`+1 if C1..` admits a δ 1..` extension, and if the function r (resp. r1 , r2 ) involved in F admits holomorphic
1..`
continuation to Cδ1..`
and satisfies |r(z1..` )| > 0 (resp. 0 < |r1 (z1..` )| < |r2 (z1..` )|)
in this larger domain. The {ρ}-extension C{ρ} is defined in an analogous manner.
As a shorthand, when we speak of a complex cell Cδ (resp. C{ρ} ) we imply that
C is a complex cell admitting a δ (resp {ρ}) extension. We will usually speak about
δ-extensions where δ ∈ (0, 1) by identifying δ with δ := (δ, . . . , δ) and similarly with
ρ ∈ (0, ∞).
Remark 9. It is sometimes convenient to consider repeated extensions. We denote
C{ρ1 }{ρ2 } := (C{ρ1 } ){ρ2 } . A simple computation shows that C{ρ1 }{ρ2 } ⊂ Cρ where
−1
ρ−1 = poly(ρ−1
1 , ρ2 ).
The dimension of a cell denoted dim C is its length minus the number of ∗s in
its type. This clearly agrees with the dimension of C as a complex manifold.
2.2.2. The real setting. We introduce the notions of a real (complex) cell C, the real
part of a real cell C, and a real holomorphic function on a complex cell. Below we
let R+ denote the set of positive real numbers.

14

GAL BINYAMINI AND DMITRY NOVIKOV

Definition 10 (Real structure on complex cells). The cell of length zero is real
and equals its real part. A cell C := C1..`  F is real if C1..` is real and the radii
involved in F can be chosen to be real on C1..` ; The real part RC (resp. positive real
part R+ C) of C is defined to be C ∩ R` (resp. C ∩ R`+ ); A holomorphic function on
C is said to be real if it is real on RC.
A simple induction shows that a real cell is invariant under the conjugation
z → z̄. Note that he positive real part of a real cell is connected, while the real
part is disconnected if C has fibers of type D◦ , A. We remark that for a function
f : C → R to be real it is enough to require that it is real on R+ C. Indeed, in this
case f (z) = f (z̄) on R+ C and it follows by holomorphicity the equality holds over
C.
2.2.3. Algebraicity. For X ⊂ C` a pure-dimensional algebraic variety we define
the degree deg X to be the number of intersections between X and a generic affinelinear hyperplane of complementary dimension (this is the same as the degree of the
projective closure of X in CP ` ). We extend this by linearity to arbitrary varieties.
We remind the reader that deg(X × Y ) = deg X · deg Y and by the Bezout theorem
deg(X ∩ Y ) 6 deg X · deg Y .
For a domain U ⊂ C` , we say that a holomorphic function f : U → C is algebraic
if its graph Gf ⊂ C` ×C is an analytic component of (U ×C)∩X, where X ⊂ C` ×C
is an algebraic variety. The minimal degree β of a variety X satisfying this condition
is called the degree, or complexity, of f . For F : U → Ck we say that F is algebraic
if each of its components is, and we define its complexity to be the maximum among
the complexities of the components. As an easy consequence of the Bezout theorem
we have for any pair of composable algebraic maps F, G the estimate
deg F ◦ G 6 poly`,k (deg F, deg G).

(31)

We define the notion of an algebraic complex cell of complexity β by induction
as follows: a cell of length 0 is algebraic of complexity 1; A cell C = C1..`  F
is algebraic if C1..` is algebraic and the radii involved in F are algebraic, and the
complexity of C is the maximum among the complexity of C1..` and the complexities
of the radii defining F.
2.3. Cellular maps. We equip the category of complex cells with cellular maps
defined as follows.
Definition 11 (Cellular map). Let C, Ĉ be two cells of length `. We say that
a holomorphic map f : C → Ĉ is cellular if it takes the form wj = φj (z1..j )
where φj ∈ Ob (C1..j ) for j = 1, . . . , ` and moreover φj is a monic polynomial
in zj . We say that a cellular map f is prepared (resp. a translate) in zj if
φj (z1..j ) = zqj + φ̃j (z1..j−1 ) for some q ∈ N>1 (resp. q = 1) and φ̃j is holomorphic
on C1..j−1 . We say that f is prepared (resp. a translate) if it is prepared (resp. a
translate) in z1 , . . . , z` . We say that f is real if C, Ĉ are real and the components
of f are real.
Cellular maps preserve the length and dimension of cells. The composition of
two cellular maps is cellular, but note that the composition of two prepared cellular
maps is not necessarily prepared. We will often be interested in covering a cell by
cellular images of other cells. Toward this end we introduce the following definition.

COMPLEX CELLULAR STRUCTURES

15

0

Definition 12. Let Cδ be a cell and {fj : Cδj → Cδ } be a finite collection of cellular
maps. We say that this collection is a (δ 0 , δ)-cellular cover of C if C ⊂ ∪j (fj (Cj )).
If (δ 0 , δ) are clear from the context we will speak simply of cellular covers.
The number of maps fj in a cellular cover is called the size of the cover. If the
maps fj are all algebraic of complexity β we say that the cover has complexity β.
The real analog of a cellular cover is defined as follows.
0

Definition 13. Let Cδ be a real cell and {fj : Cδj → Cδ } be a finite collection of
real cellular maps. We say that this collection is a real (δ 0 , δ)-cellular cover of C if
R+ C ⊂ ∪j (fj (R+ Cj )). If (δ 0 , δ) are clear from the context we will speak simply of
real cellular covers.
The restriction to positive real parts in the definition of real cellular covers is
a notational convenience. One can cover the remaining components of RC, for
instance using the signed covering maps introduced in §3.1.
0

Remark 14. We remark that if {fj : Cδj → Cδ } is a cellular cover of C and
00
0
{fjk : Cδjk → Cδj } is a cellular cover of Cj then {fj ◦ fjk } is a (δ 00 , δ)-cover of C.
We will often use this basic principle without further reference.
The following theorem implies in particular, by the remark above, that a cellular
cover can always be replaced by a cellular cover consisting of prepared maps.
Theorem 7 (Cellular Preparation Theorem, CPrT). Let f : C{ρ} → Ĉ be a (real)
{ρ}
cellular map. Then there exists a (real) cellular cover {gj : Cj → C{ρ} } of size
polyf (ρ) such that each f ◦ gj is prepared.
If C, Ĉ, f vary in a definable family then the size of the cover is poly(ρ) uniformly
over the family, and the maps gj can be chosen from a single definable family. If
C, Ĉ, f are algebraic of complexity β then the cover has size poly(β, ρ) and complexity
poly(β).
In this paper when we say that a family of sets or functions is definable we mean
that it is definable in Ran . The reader unfamiliar with this terminology can think
instead of a family whose total space is a bounded subanalytic set.
2.4. The Cellular Parameterization Theorem. Recall that in semialgebraic
geometry, a cell is said to be compatible with a function if the function vanishes
either identically or nowhere on the cell. We introduce a complex analog below.
Definition 15. For C a complex cell and F ∈ Ob (C) we say that F is compatible
with C if F vanishes either identically or nowhere on C. For f : Ĉ → C a cellular
map we say that f is compatible with F if f ∗ F is compatible with Ĉ.
The following is our main result.
Theorem 8 (Cellular Parameterization Theorem, CPT). Let ρ, σ ∈ (0, ∞). Let
C{ρ} be a (real) cell and F1 , . . . , FM ∈ Ob (C{ρ} ) (real) holomorphic functions. Then
{σ}
there exists a (real) cellular cover {fj : Cj → C{ρ} } of size polyC,{Fj } (ρ, 1/σ),
such that each fj is prepared and compatible with each Fk .
If C, F1 , . . . , FM vary in a definable family then the cover has size poly(ρ, 1/σ)
uniformly over the family and the fj can be chosen from a single definable family. If
C, F1 , . . . , FM are algebraic of complexity β then the cover has size poly` (β, M, ρ, 1/σ)
and complexity poly(M, β).

16

GAL BINYAMINI AND DMITRY NOVIKOV

In §3.2 we show that the cellular structure of the maps essentially implies automatic uniformity over families in the statements of the CPT and CPrT. We state
the family versions of these theorems for convenience of use, to avoid having to
make such reductions on numerous occasions.
2.5. Topology and hyperbolic geometry of complex cells. A complex cell C
is homotopically equivalent to
Qa product of points (for fibers ∗, D) and circles (for
fibers D◦ , A). Thus π1 (C) ' Gi where Gi is trivial for ∗, D and Z for D◦ , A. We
let γi denote the generator of Gi chosen with positive complex orientation for Gi
non-trivial and γi = e otherwise.
Definition 16. Let f : C → C \ {0} be continuous. We define the monomial
associated to f to be zα(f ) where
αi (f ) = f∗ γi ∈ Z ' π1 (C \ {0}).

(32)

It is easy to verify that f 7→ α(f ) is a group homomorphism from the multiplicative group of continuous maps f : C → C \ {0} to the multiplicative group of
monomials, which sends each monomial to itself.
For any hyperbolic Riemann surface X we denote by dist(·, ·; X) hyperbolic
distance on X (see §5 for a reminder on this topic). We use the same notation
when X = C to denote the usual Euclidean distance, and when X = CP 1 to
denote the Fubini-Study metric. For x ∈ X and r > 0 we denote by B(x, r; X) the
r-ball around x in X. For A ⊂ X we denote by B(A, r; X) the union of r-balls
around all points of A.
The following lemma shows that a holomorphic function with a non-vanishing
bounded {ρ}-extension is equivalent to its associated monomial up to a unit in a
strong sense.
Lemma 17 (Monomialization lemma). Let 0 < ρ < ∞ and let f : C{ρ} → C \ {0}
be a bounded holomorphic map. Then f = zα(f ) · U (z) and
diam(Re log U (C); R) < Of (1) · ρ,

diam(Im log U (C); R) < Of (1).

(33)

If C and f vary in a definable family then |α(f )| and the asymptotic constants
in (33) are uniformly bounded over the family. If C, f are algebraic of complexity
β then |α(f )| = poly` (β) and
diam(Re log U (C); R) < poly` (β) · ρ,

diam(Im log U (C); R) < poly` (β).

(34)

In light of the monomialization lemma, the CPT can be viewed as a cellular
analog of the monomialization of functions/ideals in the theory of resolution of
singularities. Indeed, if C{ρ} is a cell compatible with F then either F vanishes
identically or F : Cδ → C \ {0}, in which case F is equivalent to zα(f ) up to a unit
on C; hence the cells constructed in the CPT may be viewed as “cellular charts”
where F1 , . . . , FM are monomialized.
We now give several results on the geometry of holomorphic maps from cells
to hyperbolic Riemann surfaces. We begin with the following domination lemma,
which is valid for arbitrary cellular extensions. In this paper we never use this
lemma directly: instead, we use the finer fundamental lemmas stated later, which
are valid only for extensions with a sufficiently small ρ. However we still state
and prove the domination lemma to stress another line of close analogy between
complex cells and resolution of singularities.

COMPLEX CELLULAR STRUCTURES

17

Lemma 18 (Domination Lemma). Let C{ρ} be a complex cell and suppose1 that
ρ > 2e. Let f : C{ρ} → C \ {0, 1} be holomorphic. Then on C one of the following
holds:
|f | = O` (log log ρ),

|1/f | = O` (log log ρ).

(35)

The domination lemma can be seen as a cellular analog of a standard argument
from the theory of resolution of singularities [5, Lemma 4.7]: suppose f, g and f − g
are monomials (up to a unit). Then either f divides g or g divides f . This allows
one to principalize an ideal by monomializing its generators and their pairwise
differences. To see the analogy with the domination lemma, suppose C{ρ} is a cell
compatible with f, g, f −g. Then f /g : C{ρ} → C\{0, 1} and the domination lemma
applies to show that either f /g or g/f is bounded from above (i.e. one divides the
other in Ob (C)). Moreover, the bound depends only on ` and ρ.
Remark 19. The domination lemma for one-dimensional discs immediately implies the Little Picard Theorem. Indeed, suppose f : C → C \ {0, 1} is entire.
Applying the domination lemma to f |D(r) for every r > 0 we see that f is bounded
away from 0 or ∞ uniformly in C and therefore constant by Liouville’s theorem.
Similarly, the domination lemma for one-dimensional annuli implies the Great
Picard Theorem. Indeed, suppose f : D◦ (1) → C\{0, 1} has an essential singularity
at 0. Applying the domination lemma to f |A(ε,1/2) for every 0 < ε < 1/2 we see
that f is bounded away from 0 or ∞ uniformly in D◦ (1/2) which is impossible, for
instance by the removable singularity theorem.
Next, we state the more refined fundamental lemmas on maps f : C{ρ} → X
into a hyperbolic Riemann surface X. By contrast with the domination lemma,
these lemma yield more precise asymptotic estimates on the image of a complex
cell as the extension ρ tends to zero. The proofs of the fundamental lemmas rely
on the (hyperbolic) geometry and topology of X. Rather than formulate the most
general possible form, we prefer to give three separate formulations for the most
useful cases X = D, D \ {0}, C \ {0, 1}.
Lemma (Fundamental Lemma for D). Let C{ρ} be a complex cell. Let f : C{ρ} → D
be holomorphic. Then
diam(f (C); D) = O` (ρ).
(36)
Lemma (Fundamental Lemma for D \ {0}). Let C{ρ} be a complex cell. Let f :
C{ρ} → D \ {0} be holomorphic. Then one of the following holds:
f (C) ⊂ B(0, e−Ω` (1/ρ) ; C),

diam(f (C); D \ {0}) = O` (ρ).

(37)

diam(log | log |f (C)||; R) = O` (ρ).

(38)

In particular, one of the following holds:
log |f (C)| ⊂ (−∞, −Ω` (1/ρ)),

Lemma (Fundamental Lemma for C \ {0, 1}). Let C
be a complex cell and
0 < ρ < 1. Let f : C{ρ} → C \ {0, 1} be holomorphic. Then one of the following
holds:
{ρ}

f (C) ⊂ B({0, 1, ∞}, e−Ω` (1/ρ) ; CP 1 ),

diam(f (C); C \ {0, 1}) = O` (ρ).

(39)

The proofs of the monomialization, domination and fundamental lemmas are
given in §5.
1Note that if C admits a {ρ}-extension it also admits a ρ0 -extension for any ρ0 > ρ, so the
restriction on ρ is only relevant for the asymptotics in (35).

18

GAL BINYAMINI AND DMITRY NOVIKOV

2.6. Overview of the proof of the CPT. In this section we aim to give an
intuitive overview of the proof of the CPT. We will consider only the algebraic
case, which requires the most delicate arguments to control the complexity with
respect to β. We will construct a covering using general cellular maps instead of
prepared maps (one can later use the CPrT to obtain a prepared cover).
2.6.1. Reduction to a single F . We first note that the CPT can be easily reduced
to the case of one function F . Indeed, suppose we wish to perform a cellular
decomposition for the functions F1 , . . . , FM . Let F be the product of all the Fj ,
except those that vanish identically on C. We construct a cellular decomposition
{σ}
fj : Cj → C{ρ} compatible with F . Each of the maps fj whose image is disjoint
from the zeros of F is already compatible with each Fk . Each of the remaining cells
Cj has dimension strictly smaller than C since cellular maps preserve dimension.
Thus we can proceed by induction over the dimension.
2.6.2. Reduction to arbitrary ρ, σ. We will allow ourselves to assume that ρ is as
small as we wish as long as 1/ρ = poly` (β). We will also allow ourselves to assume
that σ is as large as we wish as long as σ = poly` (β). Both of these assumptions
are justified by Theorem 9 which shows that cells with a given extension can be
“refined” into cells with a finer extension. This theorem generalizes the idea of
covering a disc or annulus by several smaller discs or annuli. The proof of this
theorem is independent of the CPT and the reader can safely skip the details for
now.
2.6.3. Reduction to a proper covering map. We proceed with the case of a single
F ∈ C[z1..`+1 ]. Let C := C1..`  F. We begin the proof by induction over `. Let
D ∈ C[z1..` ] denote the discriminant of F and construct a cellular decomposition
{ρ}
{ρ}
fj : Cj → C1..` compatible with D. Any of the cells fj with fj (Cj ) contained in
the zeros of D has dimension strictly smaller than C1..`−1 , and we can therefore
handle the cell Cj  (fj∗ F) with the function fj∗ F by induction over dimension. The
images of these cells under (fj , id) cover the part of C lying over the zeros of D.
It remains to cover the part lying over the images fj (Cj ) that are disjoint from
the zeros of D. For each such cell we can reduce again to the cell Cj  (fj∗ F)
and the function fj∗ F . We return to the original notation, replacing C  F, F by
Cj  (fj∗ F), fj∗ F . What we have gained is that the projection
π : (C  F){ρ} ∩ {F = 0} → C,

π(z1..`+1 ) = z1..`

(40)

is now a proper covering map. We denote the degree of π by ν, and note that
ν = poly` (β).
2.6.4. Covering the zeros. The projection π admits ν possibly multivalued sections
yj : C → C. If we set Ĉ := C×ν! then yj can be lifted to a univalued section
yj : Ĉ → C. However, the covering of order ν! has complexity exponential in ν
and therefore in β, and thus cannot be used explicitly in our construction. In fact,
one can show that yj already lifts to a univalued function on yj : C×νj → C where
νj 6 ν is the size of the π1 (C)-orbit of yj , see Lemma 47. This is a simple statement
about permutation groups, using crucially the fact that π1 (C) is abelian. We denote
Ĉj := C×νj .
Using the maps yj we construct cellular maps (Rνj , id) : Ĉj  ∗ → C  F whose
images are contained in the zeros of F and hence compatible with F . Moreover

COMPLEX CELLULAR STRUCTURES

19

Proposition 22 shows that these maps admit {ρ · νj }-extensions, and choosing ρ ·
νj < σ gives the required extension property.
2.6.5. Covering the complement of the zeros. We now make a simplifying assumption, namely we replace F by C. This simplifies the presentation by allowing us to
avoid minor technicalities around ∂F. Since C is unbounded we will formally have
to allow unbounded cells in the covering that we construct, but the difference will
be minor. The goal is therefore to cover each fiber C \ {y1 , . . . , yν } by a finite collection of discs, punctured discs and annuli admitting {σ}-extensions. The challenge
is that this covering should depend holomorphically on the base point z1..` ∈ C,
and should be of size poly` (β).
2.6.6. The affine invariants si,j,k . To achieve our goal we will study the relative
positions of the points yj ∈ C. Toward this end we introduce the following notation.
Let yi , yj , yk be three distinct sections and denote Ĉi,j,k := C×νi νj νk . We define a
map si,j,k as follows,
yi − yj
.
(41)
si,j,k : Ĉi,j,k → C \ {0, 1},
si,j,k =
yi − yk
By the fundamental lemma for maps into C \ {0, 1} one of the following holds:
si,j,k (Ĉi,j,k ) ⊂ B({0, 1, ∞}, e−Ω` (1/(ν

3

ρ))

; CP 1 ),

diam(si,j,k (Ĉi,j,k ); C \ {0, 1}) = O` (ν 3 ρ).

(42)

We remark that equivalently (42) holds if we replace Ĉi,j,k by Ĉ, since si,j,k on Ĉ
factors through Ĉi,j,k . We note that si,j,k is invariant under affine transformations
of C, and is in fact the only affine invariant of (yi , yj , yk ). We think of (42) as
implying that the relative positions of any three sections move very little for ρ  1.
This is the crucial ingredient from hyperbolic geometry that will enable us to carry
out the decomposition into discs and annuli uniformly over the base Ĉi,j,k .
Remark 20 (Fulton-MacPherson compactification). In [20] Fulton and MacPherson construct a compactification X[ν] for the configuration space X ν \∆ of ν distinct
labeled points in an algebraic variety X (where ∆ is the union of all diagonals). In
the case X = C, the construction using screens is as follows. Write y1 , . . . , yν for
the coordinates on Cν \ ∆. For every subset S ⊂ {1, . . . , ν} define the map
ιS : Cν \ ∆ → P(C|S| /C),

iS (y1 , . . . , yν ) = (yα )α∈S

(43)

where C ⊂ C|S| is the diagonally embedded subspace. The map ιS remembers the
relative positions of {yα }α∈S up to translation (corresponding to the diagonally
embedded C) and homothety (corresponding to the projectivization). Consider the
map
Y
ν
ι : Cν \ ∆ → (P1 )(3) ,
ι=
ιS .
(44)
|S|=3

Then C[ν] is the Zariski closure of the graph of ι. It is an important fact that only
the screens ιS for S of size three are required to fully determine the compactification:
if one defines ι by a product over all S ⊂ {1, . . . , ν} one obtains an isomorphic
compactification.
In our setting, we have a natural map y = (y1 , . . . , yν ) : Ĉ → Cν \ ∆. For
an appropriate choice of the a rational coordinate on each P1 factor in (44), the

20

GAL BINYAMINI AND DMITRY NOVIKOV

Figure 2. Clustering around yi ; distances are in log-scale.

coordinates of ι can be identified with our maps si,j,k which are indeed invariant
under translation and homothety. The equations (42) imply in particular that the
image y(Ĉ) is of small diameter, not only in the metric induced from Cν , but also
in the finer metric induced from the compactification C[ν]. It is crucial here that
one only needs to use the screens S of size three. If we were to write equations
similar to (42) for screens of arbitrary size the factor ν 3 would be replaced by ν!,
which is exponential in β and hence too large for our purposes.
As we proceed to describe the cellular cover for C \ {y1 , . . . , yν } we will make
no explicit reference to the Fulton-MacPherson compactification, working instead
directly with (42). However the reader may find it helpful to interpret these inequalities as estimates on the metric induced from C[ν].
2.6.7. Clustering around a center yi . We fix a section yi . We will cluster the remaining sections into annuli based on their relative distance from yi . Since our
constructions are invariant under affine transformations we may assume after an
appropriate transformation that yi = 0.
Pick an arbitrary base point p ∈ Ĉ. We will say that yj is close to yk if they satisfy
log |yk (p)/yj (p)| < 1/ν, and define the clusters around yi to be the equivalence
classes of the transitive closure of this relation. Then for any yj , yk , if they are in the
same cluster we have log |yk (p)/yj (p)| < 1 and otherwise we have log |yk (p)/yj (p)| >
1/ν.
2.6.8. The Voronoi cells associated to yi . We will use the clusters around yi to
construct a collection of Voronoi cells mapping into C  C. Their defining property,
which motivates our choice of naming, is the following: the Voronoi cells associated
to yi cover every point z ∈ C \ {y1 , . . . , yν } such that dist(z, yi ) 6 2 dist(z, yj ) for
any j 6= i. In other words, for every section yi we will construct cells that cover
every point in C except those that are (twice) closer to some other section yj .
Clearly then the union of these cells for every yi will cover C \ {y1 , . . . , yν }, which
is our goal.
We begin by covering the empty area between two clusters. This is fairly straightforward. Suppose that yj is a section with |yj (p)| maximal within its cluster, and
yk is a section with |yk (p)| minimal within the next cluster. Then the annulus
A(yj eε , yk e−ε ) for say ε = 1/ν 2 does not meet any of the sections yj over p, and
assuming ρ is sufficiently small this remains true uniformly over Ĉ by (42). We
similarly cover the area between yi = 0 and the first cluster by a punctured disc,
and outside the last cluster by A(·, ∞).

COMPLEX CELLULAR STRUCTURES

21

Figure 3. Voronoi cells in a cluster
2.6.9. Voronoi cells in a cluster. It remains to cover the part of C that lives outside
the annuli above, i.e. near one of the clusters. Choose one of the clusters and let
yj be a section in the cluster. Since our constructions are invariant under affine
transformations we may assume after an appropriate transformation that yi = 0
and also yj = 1. With this choice of coordinates si,k,j = yk and (42) implies that
yk does not move much over the cell Ĉ. We will construct our cells over the base
Ĉi,j := C×νi νj . Note that the complexity of this cell is poly` (β) as required.
Suppose yj1 (resp. yj2 ) is the section with r1 := |yj1 (p)| minimal (resp. r2 :=
|yj2 (p)| maximal) within its cluster. Then 1/e < r1 < r2 < e. Moreover the sections in the cluster uniformly remain within A := A(r1 e−ε , r2 eε ) while the sections
belonging to other clusters remain outside AΘ(1−1/ν) .
Let U be the set obtained from A by removing discs of radius 1/10 around each
of the points yk (p) for yk belonging to the cluster. Note that any point in these
discs is much closer to yk (p) than to yi (p) = 0, so we not need to cover them with
the Voronoi cells of yi . Moreover, the same remains true uniformly over Ĉ since
by (42) the points yk move very little. To finish the construction we must therefore
cover U using discs whose {σ}-extensions remain inside AΘ(1−1/ν) and away from
the 1/20-balls around the points yk (p) (this way even as p varies over Ĉ the discs
and their extensions will not meet them). This is clearly possible to achieve with
poly` (ν) = poly` (β) discs as required.
3. Generalities on complex cells
In this section we cover some generalities on complex cells, their subanalytic
structure and some uniformity results for families.
3.1. The ν-cover of a cell. A key difference between the classical notion of real
cellular decompositions and the complex counterpart is the presence of a non-trivial
fundamental group, and with it the existence of non-trivial
covering maps. Recall
Q
that for a cell C of length ` we identify π1 (C) ' Gi where Gi is trivial for ∗, D
and Z for D◦ , A.
Definition 21 (The ν-cover of a cell). Let C be a cell of length ` and let ν =
(ν 1 , . . . , ν ` ) ∈ π1 (C) be such that ν j |ν k whenever j > k and Gj = Gk = Z. We

22

GAL BINYAMINI AND DMITRY NOVIKOV

define the ν-cover C×ν of C and the associated cellular map Rν : C×ν → C by
induction on `. For ` = 0 we let C×ν := C and Rν := id. For C = C1..`−1  F we
let
C×ν ` := (C1..`−1 )×ν 1..`−1  (Rν∗ F×ν ` )
(45)
where D(r)×ν ` := D(r1/ν ` ) and similarly for D◦ , A. We set Rν (z1..` )k := zν .
Note that the D◦ (r)×ν ` fiber (and similarly with A) does not conform, a-priori,
with the definition of a complex cell since r1/ν ` may in general be multivalued
(with cyclic monodromy of order dividing ν ` ). However the divisibility conditions on ν guarantee that Rν : (C1..`−1 )×ν 1..`−1 → C1..`−1 maps π1 (C1..`−1 )×ν into
ν ` π1 (C1..`−1 ) and the pullback Rν∗ ` (D◦ (r))×ν ` is indeed univalued and well defined
up to a root of unity. We will usually consider the ν-cover with ν ∈ N, meaning
that we take ν with ν i = ν when Gi = Z and ν i = 1 otherwise.
A minor technicality arises in the real setting. Namely, the real part RC×ν does
always not cover RC: if ν is even then only the positive real part is covered. To
cover the remaining components of the real part we introduce the notion of a signed
cover. Namely, for a sequence σ ∈ {±1}` we define C×ν,σ and Rν,σ by induction
as above but taking Rν,σ (z1..`+1 )k := σ k · zνk . It is then clear that RC×ν,σ cover
RC when σ ranges over all possible signs.
The pullback to a ν-cover will be used in our treatment to resolve the ramification of multivalued cellular maps. We record a simple proposition concerning the
interaction between extensions and ν-covers.
Proposition 22. Let C be a complex cell and ν ∈ N.
(1) If C admits a δ-extension then C×ν admits a δ 1/ν -extension and the covering
1/ν
map Rν extends to Rν : (C×ν )δ
→ Cδ .
(2) If C admits a {ρ}-extension then C×ν admits an {νρ}-extension and the
covering map Rν extends to Rν : (C×ν ){νρ} → C{ρ} .
If C is algebraic of complexity β then C×ν is algebraic of complexity poly` (β, ν).
We leave the simple inductive proof to the reader. We remark that for the part
2 it is crucial that covering maps are defined to be identical on fibers of type D.
3.2. Uniformity in families. In this section we show how the cellular structure of
our maps implies automatic uniformity over families, for instance in the statement
of the CPT.
For p ∈ C1..j we denote
Cp = {zj+1..` : (p, zj+1..` ) ∈ C}.

(46)

If C has type F1  · · ·  F` then Cp is a cell of type Fj+1  · · ·  F` . If C admits a
δ-extension then so does Cp .
By definition cellular map f : C → Ĉ induces a cellular map f1..j : C1..j → Ĉ1..j
for j = 1, . . . , ` by restriction to the first j coordinates. The following proposition
follows directly from the definitions.
Proposition 23. Let f : C → Ĉ be a cellular map between cells of length ` and
−1
j = 1, . . . , `. Then the number of points in f1..j
(p) for p ∈ Ĉ1..j is bounded by a
constant ν(f, j) independent of p. More explicitly, one may take
v(f, j) =

j
Y
k=1

degzk φk

(47)

COMPLEX CELLULAR STRUCTURES

23

in the notations of Definition 11.
The following remark illustrates how the cellular structure of the maps in the
CPT automatically implies uniformity over families.
Remark 24. Suppose ` = n + m and we view C in the statement of the CPT as a
{σ}
family of m-dimensional cells Cp parameterized over p ∈ C1..n . Let fj : Cj → C{ρ}
be the maps constructed in the CPT. By Proposition 23 the sets
Pj = {pj,k } := (fj )−1 (p)

(48)

are finite with the number of points uniformly bounded over p. For each pj,k re{σ}
{ρ}
striction of fj to the fiber gives a prepared cellular map fj,k : (Cj )pj,k → Cp which
is compatible with the restrictions of F1 , . . . , Fm to Cp , and such that fj,k ((Cj )pj,k )
cover Cp . In other words we obtain a cellular decomposition as in the CPT for the
fibers Cp with the number of cells uniformly bounded over p.
3.3. Laurent expansion in a complex cell. Let C = F1  · · ·  F` be a complex
cell. In this section we show that any holomorphic function on C can be expanded
into a series analogous to the classical Laurent series. We begin by introducing
the notion of normalized monomials. Let α ∈ Z` . We define the C-normalized
[α ]
[α ]
monomial z[α] := z1 1 · · · z` ` where: if Fj = D(rj ) or Fj = D◦ (rj ) then
(
(zj /rj )αj αj > 0
[αj ]
zj =
(49)
0
otherwise;
if Fj = A(r1,j , r2,j ) then
[α ]
zj j

(
(zj /r1,j )αj
=
(zj /r2,j )αj

αj > 0
otherwise;

(50)

and if Fj = ∗ then
[α ]
zj j

(
1 αj = 0
=
0 otherwise.

(51)

The normalization is such that z[α] is bounded by 1 in C and achieves the bound
only when α = 0.
Below we write pos δ for the vector whose i-th coordinate is |δ i |.
Proposition 25. Let f ∈ Ob (C). Then f has a series expansion, absolutely convergent on compacts in C, as follows:
X
f (z) =
cα z[α]
(52)
α∈Z`

where |cα | 6 kf k. If C admits a δ-extension and f ∈ Ob (Cδ ) then also |cα | <
δ pos α kf kCδ .
Proof. We proceed by induction on `. The case F` = ∗ reduces immediately to
the claim for C1..`−1 . Otherwise the standard formula for Laurent expansions in F`
gives
∞
X
[α ]
f (z) =
cα` (z1..`−1 )z` `
(53)
α` =−∞

24

GAL BINYAMINI AND DMITRY NOVIKOV

where
cα` (z1..`−1 ) =

`
zα
`

[α
z` `

(2πi)−1
]

I

f (z1..`−1 , ζ)
dζ
ζ α` +1

(54)

and the integral is over a simple positively oriented curve in F` . The Cauchy
estimate now implies kcα` kC1.`−1 6 kf k and we proceed to expand cα` by induction
on ` to obtain a series (52) with |cα | < kf k. To see that this multivariate series is
absolutely convergent on compacts note that for every z ∈ C and α ∈ Z` we have
|z[α] | 6 ρ|α|

where

ρ :=

max

σ∈{−1,1}`

z[σ] < 1

(55)

P
and (52) is thus majorated by α (ρ + ε)|α| in a neighborhood of z. For the final
claim we write a Laurent expansion in Cδ and rewrite the Cδ -normalized monomials
as C-normalized monomials, gaining an extra factor of δ pos α .

Let P` := D(1)×` denote the standard unit polydisc. We write simply P when `
is clear from the context.
Corollary 26. Let f ∈ Ob (C). Then there is a decomposition
X
fσ (z[σ] )
f (z) =

(56)

σ∈{−1,1}`

where fσ ∈ O(P). If C admits a δ-extension and f ∈ Ob (Cδ ) then fσ ∈ O(Pδ ), and
moreover for any δ < ε < 1 we have
kfσ kPε 6 (1 − δ/ε)−` kf kCδ .

(57)

Proof. For the first statement we simply collect all summands with index α of sign
σ in (52) into fσ (if αj = 0 we arbitrarily treat it as positive for this purpose). For
the second part, we have
X
X
kf1,...,1 (w)kPε 6
|cα | kwα kPε 6
(δ/ε)|α| = (1 − δ/ε)−` , (58)
α∈(Z>0 )`

α∈(Z>0 )`

and similarly for the other choices of the signs.



3.4. Subanalyticity. We say that a function is subanalytic on a domain U ⊂ Cn
if it is defined there and its graph over U forms a subanalytic set. Our goal in this
section is to prove the following proposition.
Proposition 27. Let 0 < δ < 1. A complex cell C admitting a δ-extension is a
subanalytic set. If f ∈ Ob (Cδ ) then f is subanalytic on C.
Proof. We prove both claims by induction on the length of C, the case of length
zero being vacuous. Let C = C1..`  F. Then the radii r(z) or r1 (z), r2 (z) of
F are subanalytic by induction and it easily follows that C is subanalytic. Now
let f ∈ Ob (Cδ ). By Corollary 26 we may write f as a sum of 2`+1 summands
fσ (z[σ] ). In the definition of z[σ] each of the radii involved are subanalytic on C1..`
by induction, and each of the divisions involved are “restricted” in the sense of [18],
i.e. we always have |z[σ] | 6 1 for z ∈ C. It then follows, for instance using the
subanalytic language of [18], that the graph of each fσ and hence of f is indeed
subanalytic over C.


COMPLEX CELLULAR STRUCTURES

25

4. Semialgebraic and subanalytic sets
In our terminology, a cell in an o-minimal structure (below classical cell ) is the
-product of a sequence of intervals (either closed or open on each side) with the
two endpoints given by continuous definable functions. The image f (R+ C) of a
real prepared cellular map is itself a cell in this classical sense. More explicitly if
q
f (z1..` )j = zj j + φj (z1..j−1 ) and C = F1  · · ·  F` then


Fj = ∗
{φj }
q
j
f (R+ C) = I1  · · ·  I` , Ij := (φj , φj + |r |)
Fj = D(r), D◦ (r) (59)

q
q

(φj + |r1j |, φj + |r2j |) Fj = A(r1 , r2 ).
Furthermore, we note that f restricts to a real-analytic diffeomorphism from R+ C
onto its image.
A classical cell is called compatible with a continuous function F if sign F is
constant on the cell. Since R+ C is connected, we see that f (R+ C) is compatible
with F in this classical sense if and only if f is compatible with F in our sense.
4.1. Cellular parametrizations for semialgebraic and subanalytic sets.
Definition 28. A semialgebraic set S ⊂ Rn has complexity (`, β) if S = π1..n (S̃)
where S̃ ⊂ R` is given by
S̃ = {sign P1 (x1..` ) = σ1 , . . . , sign PN = σN },

σ1 , . . . , σN ∈ {−1, 0, 1}

(60)

where P1 , . . . , PN ∈ R[x1..` ] have degrees at most β and N 6 β. If ` = n we will
say simply that S has complexity β.
The following semialgebraic parametrization result is a simple consequence of
the CPT.
Corollary 29. Let ρ, σ ∈ R+ and let S ⊂ (0, 1)n be semialgebraic of complexity
{σ}
{ρ}
(`, β). Then there exist poly` (β, ρ, 1/σ) real cellular maps fj : Cj → Pn , each
{σ}

of complexity poly` (β), such that fj (R+ Cj

) ⊂ S and ∪j fj (R+ Cj ) = S.

Proof. We first reduce to the case S̃ ⊂ (0, 1)` in the notations of Definition 28.
We may split S̃ to a union of sets and prove the result for each of their projections
separately, so we reduce to the case S̃ ⊂ (0, 1)n ×In+1 ×· · ·×I` where each Ij is one
of {0}, (0, ∞), (−∞, 0). In the case of {0} we can forget the xj variable, and in the
case (−∞, 0) we can replace xj by −xj , reducing to the case S̃ ⊂ (0, 1)n × (0, ∞)m .
In the same manner but using xj → 1/(1 + xj ) (which increases the degrees at most
polynomially) we reduce to the case S̃ ⊂ (0, 1)` .
{ρ}
Now apply the real CPT to the cell P` with the collection of polynomials
{σ}
{ρ}
defining S̃. We obtain a collection of real prepared maps f˜j : C̃j → P` with the
{σ}
required complexity estimates such that f˜j (R+ C̃j ) ⊂ S̃ and ∪j f˜j (R+ C̃j ) = S̃. The
cellular structure of f˜j implies that if we now take Cj := (C̃j )1..n and fj := (f˜j )1..n
{σ}

we have indeed fj (R+ Cj

) ⊂ S and ∪j fj (R+ Cj ) = S.



In an analogous manner one obtains the following subanalytic version.
Corollary 30. Let ρ, σ ∈ R+ and let S ⊂ (0, 1)n be subanalytic. Then there exist
{σ}
{ρ}
{σ}
polyS (ρ, 1/σ) real cellular maps fj : Cj → Pn such that fj (R+ Cj ) ⊂ S and
∪j fj (R+ Cj ) = S.

26

GAL BINYAMINI AND DMITRY NOVIKOV

Remark 31. We remark that from the proof it is clear that in Corollaries 29
and 30 one can also require the maps fj to be compatible with an additional col{ρ}
lection of functions Fj ∈ Ob (Pn ). We also remark that by rescaling one can
clearly replace the domain (0, 1)n in Corollaries 29 and 30 by any other bounded
semialgebraic/subanalytic ambient set. We will sometimes use [0, 1]n .
4.2. Preparation theorems. The real CPT implies the preparation theorem for
subanalytic functions of Parusinski [35] and Lion-Rolin [29], as we illustrate below.
We illustrate the algebraic case here (where we get more effective information)
but the subanalytic case follows in a similar manner. Let F : (−1, 1)n → R be a
bounded semialgebraic function and let GF ⊂ Rnx × Ry be its graph. We aim to
cover (0, 1)n by cylinders where F admits a simple expansion.
We apply Corollary 29 for the set GF , requiring also that the maps fj be com{σ}
1/2
patible with y (see Remark 31). We obtain maps fj : Cj → Pn × P1/2 admitting
{σ}

such that fj (R+ Cj ) ⊂ GF and fj (R+ Cj ) cover GF , and moreover each map is
compatible with y.
1/2
Let f : C{σ} → Pn × P1/2 be one of the maps fj . Since GF is a graph the type
of C must end with ∗. It follows from the monomialization lemma that on each
C{σ} we have either f ∗ y ≡ 0 or
f ∗ y = zα(j) Uj (z)

(61)

where U is a holomorphic map bounded away from zero and infinity on C. To
rewrite this expansion in the x-coordinates recall that
zj = (xj − φj (z1..j−1 ))1/νj

(62)

where we restrict zj to the positive real part R+ Cj and take the positive branch.
Since F (x) ≡ y on GF we have on the cylinder f (R+ Cj ) the expansion
F (x) = zα U (z)

(63)

where z is given by (62). In other words we have obtained cylinders where F
expands as a monomial with fractional powers times a unit. This implies the
preparation theorem of [29] (in the bounded semialgebraic case). Indeed, in [29]
the unit is required to be bounded away from zero and infinity and satisfy an
analytic expansion of the form U (z) = V (ψ(x1..n−1 , xn )) where
ψ(x1..n−1 , xn ) = (ψ1 (x1..n−1 ), . . . , ψs (x1..n−1 ),
1/p
x1/p
n /a1 (x1..n−1 ), b1 (x1..n−1 )/xn ), (64)

with p a positive integer and ψi , a1 , b1 are bounded subanalytic functions, and V
is a non-zero analytic function on the compact closure of the image of ψ. In our
case this expansion is the Laurent expansion of Uj (z) with respect to zn . We of
course obtain a wealth of additional information on the number of cylinders, their
complexity, and effective estimates on the monomial zα and the unit U (z) from the
algebraic monomialization lemma.
We remark that, as usual in the passage from the real analytic to the holomorphic
category, the definitions involving existence of converging expansions are replaced
by purely local counterparts. For instance, while the notion of a function reducible
in a cylinder requires a careful inductive definition in [29], any holomorphic function
compatible with a complex cell is automatically reducible there. Similarly, while the
definition of of a unit involves a delicate analytic expansion (64) in [29], a unit in a

COMPLEX CELLULAR STRUCTURES

27

complex cell is a holomorphic function satisfying a purely topological definition (the
associated monomial being equal to zero), which in turn implies the real condition.
5. The principal lemmas
5.1. Hyperbolic geometry of complex cells. For the proofs of the domination,
fundamental and monomialization lemmas we will require some basic notions of
hyperbolic geometry. Recall that the upper half-plane H admits a unique hyperbolic
metric of constant curvature −4 given by | dz|/2y. A Riemann surface X is called
hyperbolic if its universal cover is the upper half-plane H. In this case U inherits
from H a unique metric of constant curvature −4 which we denote by dist(·, ·; U ) (we
sometimes omit U from this notation if it is clear from the context). In particular
a domain U ⊂ C is hyperbolic if its complement contains at least two points. The
Schwarz-Pick lemma states that any holomorphic map between hyperbolic Riemann
surfaces is non-expanding in their respective hyperbolic metrics.
5.2. Maps from cells into hyperbolic Riemann surfaces. We will require the
following notion of skeleton of a cell.
Definition 32 (Skeleton of a cell). If C is a cell whose type does not include D◦
then we define its skeleton S(C) as follows: the skeleton of the cell of length zero is
the singleton C0 ; The skeleton of C1..`  F is S(C1..` )  ∂F where
∂∗ := ∗

∂D(r) := S(r)

∂A(r1 , r2 ) := S(r1 ) ∪ S(r2 ).

(65)

Each connected component of S(C) is a product of ` circles and points, and the
number of connection components is equal to 2α , where α is the number of symbols
A in the type of C.
Let C be a complex cell whose type does not contain D◦ . For the results discussed
in this section any coordinate with type ∗ can be removed without loss of generality,
so we assume that the type does not contain ∗. Then dim C = `(C) and we denote
this number by n. We assume that C admits a {ρ} extension for some {ρ} > 0 and
that f : C{ρ} → X is a holomorphic map to a hyperbolic Riemann surface X. We
begin by studying the hyperbolic behavior of f on the skeleton S(C).
Lemma 33. Let S a component of the skeleton S(C). Then
diam(f (S); X) < nρ.

(66)

Proof. We proceed by induction and suppose the claim is proved for cells of dimension smaller than n. Let z, z00 ∈ S. We will construct a point z0 ∈ S such that
dist(f (z), f (z0 )) < ρ and such that z01 = z001 . Then z02..n , z002..n both belong to the
n − 1 dimensional cell Cz01 and applying the inductive hypothesis to the restriction
of f to this fiber we conclude that dist(f (z0 ), f (z00 )) < (n − 1)ρ thus finishing the
proof.
By definition of the skeleton, we have
z1 = ε1 r1

z2 = ε2 r2 (z1 )

...

zn = εn rn (z1..n−1 ),

|εi | = 1.

(67)

where r1 > 0 and r2 , . . . , rn are holomorphic functions on C{ρ} . Let F denote the
first fiber in C. We define a map γ(z1 ) : F{ρ} → C{ρ} by γ(z1 ) = (z1..n ) where
z2 = ε2 r2 (z1 )

...

zn = εn rn (z1..n−1 ).

(68)

28

GAL BINYAMINI AND DMITRY NOVIKOV

Then γ is holomorphic in F{ρ} and satisfies γ(z1 ) = z and γ({|z1 | = r1 }) ⊂ S. We
take z0 := γ(z001 ) ∈ S and note that
dist(f (z), f (z0 ); X) = dist(f ◦ γ(z1 ), f ◦ γ(z001 ); X) 6 dist(z1 , z001 ; F{ρ} ) 6 ρ

(69)

where the first inequality follows from the Schwarz-Pick lemma for f ◦ γ and the
second inequality follows since z1 , z001 belong to the boundary of F in F{ρ} .

Next, we show (essentially by the open mapping theorem) that the boundary of
f (C) is controlled by the skeleton.
Lemma 34. We have the inclusion ∂f (C) ⊂ f (S(C)).
Proof. We assume for simplicity that the type of C is A · · · A (the difference with
disc fibers is purely notational). Let p ∈ ∂f (C) and fix a point z ∈ C such that
f (z) = p. If z ∈ S then we are done. Otherwise one of the following holds
r1,1 <|z1 | < r1,2
|r2,1 (z1 )| <|z2 | < |r2,2 (z1 )|
..
.

(70)

|rn,1 (z1..n−1 )| <|zn | < |rn,2 (z1..n−1 )|.
Let k be the largest index for which such inequalities hold. Let
A := A(rj,1 (z1..j−1 ), rj,2 (z1..j−1 )).

(71)

We suppose further that z is chosen such that k is the minimal possible. We define
a map γ(zk ) : Aδ → C by γ(zj ) = (z1..n ) where z1..k−1 = z1..k−1 and
zj+1
zj+1 =
rj+1,i(j+1) (z1..j ),
j>k
(72)
rj+1,i(j+1) (z1..j )
where i(j) is the index, either 1 or 2, such that equality instead of inequality holds
in the jth line of (70). By definition we have γ(zj ) = z.
If f ◦ γ is non-constant then by the open mapping theorem p = f ◦ γ(zj ) is an
interior point of f ◦ γ(A) ⊂ f (C) contrary to our assumption. Otherwise we have
p = f (z0 ) where z0 = γ(zj0 ) and zj0 is any point on ∂A. The index k obtained for
z0 is by definition smaller than that obtained for z, which yields a contradiction to
our choice of z.

Finally, we show that under a suitable topological condition the hyperbolic diameter of f (C) itself can be bounded.
Lemma 35. Suppose that f∗ (π1 (C)) = {e} ⊂ π1 (X). Then
diam(f (C); X) < 2n nρ.

(73)

Proof. Denote by π : D → X the universal covering map. By our assumption we
may lift f to a map F : C{ρ} → D satisfying f = π ◦ F . Since π is non-expanding
it is enough to prove the claim for the hyperbolic diameter of F (C). By Lemma 33
the hyperbolic diameter of F (S), where S is any component of the skeleton S(C),
is bounded by nρ. By Lemma 34 we also have the inclusion ∂F (C) ⊂ F (S(C)).
Recall that we assume that the type of C does not contain D◦ and hence C̄ ⊂ Cδ .
In particular it follows that Z := F (C) is relatively compact, and hence bounded, in
D. Let U denote the unbounded component of D \ Z̄ and set U c := D \ U and Γ :=

COMPLEX CELLULAR STRUCTURES

29

Figure 4. Proof of Lemma 35.
∂U . To avoid pathologies of plane topology we remark that Z is subanalytic, hence
Z, U and their boundaries can be triangulated and the Mayer-Vietoris sequence
0 = H1 (D) → H0 (Γ) → H0 (Ū ) ⊕ H0 (U c ) → H0 (D) → 0

(74)

is exact. Since H0 (D) = H0 (Ū ) = Z we have H0 (Γ) ' H0 (U c ). We claim that U c
and hence U c is connected. Assume otherwise and write U c = V1 ∪ V2 . Since Z̄
is connected we have without loss of generality Z̄ is contained in V1 and therefore
disjoint from V2 . In particular ∂V2 is disjoint from Z̄, contradicting
∂V2 ⊂ ∂U c = ∂U ⊂ ∂Z.

(75)

(U c )

In conclusion we have H0 (Γ) ' H0
= Z, i.e. Γ is connected.
We claim that the hyperbolic diameter of F (C) is bounded by the hyperbolic
diameter of Γ. Indeed, for any two points p, q ∈ F (C) let ` denote the geodesic
line connecting them and denote by p0 ∈ ` ∩ Γ some point on ` before p and by
q 0 ∈ ` ∩ Γ some point on ` after q. Then dist(p, q) 6 dist(p0 , q 0 ) which is bounded
by the diameter of Γ. Finally, recall that Γ is connected and contained in the union
of F (Sj ) where Sj run over the components of S(C) (whose number is at most 2n ),
and the diameter of each F (Sj ) is bounded by nρ. From this it follows easily that
the diameter of Γ is at most 2n nρ.

5.3. Proof of the domination lemma. We begin by assuming that the type of
C does not contain D◦ . Let
U0 := {|z| < 21 }

U1 := {|z − 1| < 21 }

U∞ = {|z| > 2}.

(76)

Uqs

We choose s > 1 such that the hyperbolic distance between
and ∂Uq is greater
than nρ for q = 0, 1, ∞. From the explicit computations in §5.6 we can take
s
s = O(log | log(nρ)|). If f (C) does not meet U0s or U∞
then the proof of the
domination lemma is completed. Henceforth we assume that f (C) meets both U0s
s
and U∞
.
s
Lemma 36. Suppose f (C) meets both U0s and U∞
. Then

f∗ π1 (C) = {e} ⊂ π1 (C \ {0, 1}).

(77)

Proof. Recall that we assume that the type of C does not contain D◦ , and in
particular C̄ ⊂ Cδ . Thus f extends to a continuous function C̄, so f (C̄) ⊂ C \ {0, 1}
s
is compact and it follows that ∂f (C) meets both U0s and U∞
. By Lemma 34 we
conclude that there exist two components S0 , S∞ of the skeleton S(C) such that
s
f (S0 ) meets U0s and f (S∞ ) meets U∞
. From Lemma 33 and the choice of s we
conclude that f (S0 ) does not meet the boundary of U0 , i.e. f (S0 ) ⊂ U0 and
similarly f (S∞ ) ⊂ U∞ .

30

GAL BINYAMINI AND DMITRY NOVIKOV

Figure 5. Proof of the domination lemma.
It is easy to verify (it is enough to check this for the standard polyannulus)
that π1 (S) → π1 (C) is epimorphic. In particular, if γ ∈ π1 (C) denotes any loop
then this loop is free-homotopy equivalent to a loop contained in S0 and to a
loop contained in S∞ . Consequently f∗ (γ) is free-homotopy equivalent to a loop
contained in U0 and to a loop contained in U∞ . However two such loops cannot
be homotopically equivalent in C \ {0, 1} unless they are both contractible, hence
proving the claim.

Lemma 36 implies the condition of Lemma 35, and we conclude that the hyperbolic diameter of f (C) is bounded by 2n nρ. We now choose ŝ > 1 such that the
ŝ
is greater than 2n nρ. By §5.6 we may take
hyperbolic distance between U0ŝ and U∞
ŝ
and the domination
ŝ = O(log(n + log ρ)). Then f (C) cannot meet both U0ŝ , U∞
lemma is proved.
It remains to consider the case that the type of C contains D◦ . Let 0 < ε < 1
and let Cε be the cell obtained from C by replacing each occurrence of a fiber D◦ (r)
by A(εr, r). It is clear that Cε admits a {ρ}-extension and ∪ε>0 Cε = C. The
domination lemma for C thus follows immediately from the domination lemma for
Cε , which was already established.
5.4. Proofs of the fundamental lemmas. In this section we assume that the
type of C does not contain D◦ . The general case can be reduced to this case as in
the end of §5.3. The fundamental lemma for D is already proved as a consequence
of Lemma 35. The proof in the case of D \ {0} is based on the following simple
geometric lemma.
Lemma 37. Let z ∈ D \ {0} and let γz denote the shortest non-contractible loop
passing through z. Then length(γz ) ∼ 1/| log |z||.
Proof. Let ζ = i−1 log z. Lifting to the universal cover exp(iζ) : H → D \ {0} we
must calculate dist(ζ, ζ + 2π; H). By a standard formula for the hyperbolic distance
we have
!
p
π + π 2 + Im2 ζ
dist(ζ, ζ + 2π; H) = 2 ln
∼ 1/ Im ζ.
(78)
Im ζ

Let f : C{ρ} → D \ {0} be holomorphic and let z be the maximum value of |f |
on C, which by Lemma 34 is obtained on a component S of the skeleton of C. By
Lemma 33 we have diam(f (S); D \ {0}) = O` (ρ). In particular, if 1/| log |z|| =

COMPLEX CELLULAR STRUCTURES

31

Ω` (ρ) then f (S) cannot contain a non-contractible loop in D \ {0}. Then, since
π1 (S) → π1 (C) is epimorphic we have
f∗ (π1 (C)) = f∗ (π1 (S)) = {e} ⊂ π1 (D \ {0}).

(79)

In this case by Lemma 35 we have diam(f (C); D \ {0}) = O` (ρ). Otherwise we have
log |z| = −Ω` (1/ρ), which concludes the proof of the first statement. The second
statement follows from the simple fact
dist(ζ1 , ζ2 ; H) > dist(log Im ζ1 , log Im ζ2 ; R).

(80)

We now pass to the proof of the fundamental lemma for C \ {0, 1}. Let S be a
component of the skeleton of C. By Lemma 33 we have diam(f (S); C \ {0, 1}) =
O` (ρ). In particular, for ρ = O(1) we see that f (S) cannot meet more than one of
U0 , U1 , U∞ in the notation (76). Suppose first the f (S) meets none of these sets.
Let ρ0 denote the length of the shortest non-contractible loop in the compact set
(U0 ∪ U1 ∪ U∞ )c ⊂ C \ {0, 1}. Then for ρ = O(ρ0 ) = O(1) we get diam(f (C); C \
{0, 1}) = O` (ρ) as in the proof of the case D \ {0}.
Next, suppose that for two different components S, S 0 the images f (S), f (S 0 )
meet two of the sets U0 , U1 , U∞ , say U0 and U1 respectively. Then for ρ = O(1) the
images f∗ (π1 (S)) (resp. f∗ (π1 (S 0 )) can only be a power of the fundamental loop
around 0 (resp. 1) and as in the proof of the domination lemma we conclude that
f∗ (π1 (C)) = {e} and diam(f (C); C \ {0, 1}) = O` (ρ).
Finally, suppose all skeleton components S meet one of the sets U0 , U1 , U∞ , say
U0 . Then for ρ = O(1) we see that f (S) ⊂ D \ {0} for each skeleton component.
In this case we can finish the proof as in the case of D \ {0}. We need only the
estimate for the length of the shortest geodesic in C \ {0, 1} passing through a given
point z close to 0: this is asymptotically the same as in the metric of D \ {0}, for
instance by the estimate (87) of [3], given explicitly in §5.6.
5.5. Proof of the monomialization lemma. The Voorhoeve index [28] of a
holomorphic function f : U → C along a subanalytic curve Γ ⊂ U is defined by
Z
1
VΓ (f ) :=
| d Arg f (z)|.
(81)
2π Γ
We will need the following basic fact about Voorhoeve indices.
Lemma 38. Fix ρ > 0. Let Fλ be a definable family of one-dimensional cells, let
fλ : U ρ → C a definable family of holomorphic functions, and let Γλ ⊂ Fλ be a
definable family of curves. Then VΓλ (fλ ) is uniformly bounded over λ.
If f, Γ are algebraic of complexity β then VΓ (f ) = poly(β).
Proof. Note that 2πVΓ (f ) is the total length of the curve ( |ff | )(Γ) ⊂ S(1), which
by standard integral geometry is given by the average number of intersections between the curve and a ray through the origin, i.e. the average number of (isolated)
solutions of the equation Arg f (z) = α for z ∈ Γ α ∈ [0, 2π). By o-minimality the
maximal number (and in particular the average number) of (isolated) solutions for
the pair fλ , Γλ is bounded by a constant independent of λ. In the algebraic case
the number of solutions is bounded by O(β 2 ) by the Bezout theorem.

The basic ingredient in the proof of the monomialization lemma is the following
one-dimensional version, proved using the Voorhoeve index.

32

GAL BINYAMINI AND DMITRY NOVIKOV

Lemma 39. Let F be a one-dimensional cell and f : F{ρ} → C \ {0}. Then
f = z α(f ) · U (z) where
diam(Re log U (F); R) < Of (ρ),

diam(Im log U (F); R) < Of (1).

Moreover if F, f vary in a definable family then |α(f )| and the asymptotic constants
in Of (·) can be taken to be uniform over the family. If f is algebraic of complexity
β then |α(f )| = poly(β) and
diam(Re log U (F); R) < poly(β) · ρ,

diam(Im log U (F); R) < poly(β).

Proof. We follow the idea of [28, Section 4.5]. By definition α(f ) is equal to the
total winding number of f along a concentric circle contained in F for types D◦ , A
and zero in type D. In particular it is bounded by VΓ (f ) where Γ is such a circle,
and the statements about α(f ) then follow from Lemma 38. In the algebraic case
we see also that the complexity of U is poly(β).
Any two points in F can be joined by two consecutive algebraic curve: a radial
ray and a circle concentric with F. By Lemma 38 the Voorhoeve index of f along
these curves is uniformly bounded (resp. bounded by poly(β) in the algebraic
case). Having already established that |α(f )| is uniformly bounded (resp. bounded
by poly` (β) in the algebraic case) we conclude that the Voorhoeve index of U along
any two such curves is similarly bounded by a uniform constant v (and v = poly` (β)
in the algebraic case).
Let p ∈ F be an arbitrary point. Since the claim is invariant under scalar
multiplication of f we may assume without loss of generality that U (p) = 1. Since
U∗ π1 (F) = {e} we have a well-defined root W : F{ρ} → C \ {0} satisfying W =
iU 1/(4v) and W (p) = i. Connecting p to any other point q ∈ F by two curves as
above, the Voorhoeve index of W along the curves is bounded by 1/4, hence the
total variation of argument is bounded by π/2. Since Arg W (p) = π/2 we conclude
that in fact W : F{ρ} → H. By Lemma 33 we then have diam(W (F); H) = O(ρ).
In particular this implies
diam(Re log W (F); R) = O(ρ)

diam(Im log W (F); R) < π

(82)

and the claim for U follows immediately (using the fact that v = poly` (β) in the
algebraic case).

We are now ready to finish the proof of the monomialization lemma by induction
on `. Let C = C1..`  F. The case F = ∗ reduces trivially to the claim for C1..`−1
and the case ` = 0 is proved in Lemma 39. Up to renormalization we may assume
{ρ}
that the outer radius of F is 1. Let fˆ : C1..` → C \ {0} be defined by fˆ := f (z1..` , 1).
If C, f are algebraic of complexity β then fˆ is algebraic of complexity poly` (β).
ˆ
By definition we have α(fˆ) = α1..` (f ), so Û := U (z1..` , 1) is equal to fˆ/zα(f ) .
By the inductive hypothesis we have
diam(Re log Û (C1..` ); R) < Ofˆ(1) · ρ,

diam(Im log Û (C1..` ); R) < Ofˆ(1)

(83)

with uniform constants if C, f vary in a definable family. In the algebraic case
|α(fˆ)| = poly` (β) and
diam(Re log Û (C1..` ); R) < poly` (β) · ρ,

diam(Im log Û (C1..` ); R) < poly` (β).
(84)

COMPLEX CELLULAR STRUCTURES

33

Also, for each fixed p ∈ C1..` we have by Lemma 39 for the fiber Cp
diam(Re log U (Cp ); R) < Of (ρ),

diam(Im log U (Cp ); R) < Of (1)

(85)

with uniform constants if C, f vary in a definable family. In the algebraic case
|α`+1 (f )| = poly(β) and
diam(Re log U (Cp ); R) < poly` (β) · ρ,

diam(Im log U (Cp ); R) < poly` (β).

(86)

The triangle inequality now finishes the proof.
5.6. Hyperbolic lengths. We fix the hyperbolic metric, λD (z)|dz| with λD (z) =
(1 − |z|2 )−1 , of constant curvature −4 on the unit disc D. An explicit lower bound
for the hyperbolic metric λ0,1 (z)|dz| on C \ {0, 1} in U0 is given in [3],
λ0,1 (z) >

1
√ 
√
,
2|z| 2 4 + log(3 + 2 2) − log |z|

|z| 6

1
.
2

(87)

Integrating (87), we see that the hyperbolic distance from {|z| = r} to {|z| = 1/2}
is greater than s for r < ρ̃(s) < 21 , where
log ρ̃(s) = −eΘ(s) + O(1).
As z → z −1 is an isometry of C \ {0, 1}, the hyperbolic distance from {|z| = r} to
{|z| = 2} is greater than s for r > ρ̃(s)−1 .
5.6.1. Proof of Fact 6. First, consider the case of F of type D. Up to rescaling,
Fδ = D(1) and ∂F = {|z| = δ}. Then λD (z) |dz| ≡ (1 − δ 2 )−1 |dz| on ∂F, so the
2πδ
length of ∂F in D is equal to 1−δ
2.
Second, consider the cases F of type D◦ , A. If S(r) is (a component of) ∂F, then
S(r) ⊂ S δ (r) ⊂ Fδ . Therefore, by Schwartz-Pick lemma, it is enough to prove the
following
Lemma 40. The length of S(1) in the hyperbolic metric of the annulus S δ (1) is
π2
equal to 2|log
δ| .
πi
2|log δ| log z maps
π2
with φ−1 ([0, |log
δ| ])

Proof. Indeed, the mapping φ(z) =
to the strip Π = {| Im w| 6

π
2 },

the universal cover of S δ (1)
= S 1 . This map preserves
2

π
hyperbolic distances, so it is enough to find the hyperbolic length of [0, |log
δ| ] in
the hyperbolic metric λΠ (w) |dw| of Π. As Π is invariant under shifts by reals, it
w
is enough to find the λΠ (0). The map ψ(w) = eew −1
+1 send Π isometrically to the
2

π
unit disc, with ψ(0) = 0, so λΠ (0) = ψ 0 (0) = 1/2 and the length of [0, |log
δ| ] in Π

is equal to

π2
2|log δ| .



Remark 41. The same chain of conformal mappings allows to compute explicitly
the distance between r > 0 and 1 in the hyperbolic metric of Aδ = A(δr, δ −1 ):


π
log δ
1 + tan φ
√
distAδ (r, 1) = log
, where φ =
1−
.
(88)
1 − tan φ
4
log(δ r)
As r → 0, we get

distAδ (r, 1) = log

√ 
16 log(δ r)
+ O(1) = log |log r| + O(1).
π log δ

(89)

34

GAL BINYAMINI AND DMITRY NOVIKOV

From the inequalities distAδ (r, 1) < diamAδ A < distAδ (r, 1) +
diamAδ A = log |log r| + O(1)

as

π2
2|log δ| ,

r → 0.

we see that
(90)

6. Geometric constructions with cells
In this section we develop the two key geometric constructions used in the proofs
of our main theorems: cellular refinement and clustering in fibers of proper covers.
6.1. Refinement of cells. In this section we show how cells with a {ρ}-extension
can be refined into cells with a {σ}-extension for 0 < σ < ρ. We remark that while
the statement appears innocuous, the proof actually requires the full strength of
the fundamental lemma for D\{0}. The key difficulty is to construct the refinement
of an annulus fiber in a manner that depends holomorphically on the base.
Theorem 9 (Refinement theorem). Let C{ρ} be a (real) cell and 0 < σ < ρ. Then
{σ}
there exists a (real) cellular cover {fj : Cj → C{ρ} } of size poly` (ρ, 1/σ) where
each fj is a cellular translate map.
If C varies in a definable family (and σ, ρ vary under the condition 0 < σ < ρ <
∞) then the cells Cj and maps fj can also be chosen from a single definable family.
If C is algebraic of complexity β then Cj , fj are algebraic of complexity poly` (β).
Remark 42 (Refinement and monomialization). The type of any cell Cj obtained
by refinement of C{ρ} is obtained from the type of C by possibly replacing some
D◦ , A fibers by D fibers. Moreover (fj )∗ : π1 (Cj ) → π1 (C) is the natural injection.
In particular if F : C → C \ {0} then α(fj∗ F ) is obtained from α(F ) by eliminating
those indices that correspond to fibers that were replaced by D in Cj .
The proof of the refinement theorem will occupy the remainder of this subsection.
We begin with the complex case, and indicate the necessary modifications for the
real case at the end. We proceed by induction on ` (the case ` = 0 is vacuous).
Consider a cell C  F. By applying the inductive hypothesis to C and replacing
C  F by each Cj  fj∗ F we may assume without loss of generality that the base C
already admits E-extension, where E will be chosen later. The case F = ∗ reduces
to the inductive hypothesis directly with E = {σ}.
As a notational convenience we allow ourselves to rescale the fiber F by a nonvanishing holomorphic function s ∈ Ob (C{σ} ), where it is understood that the
covering cells Cj that we construct will eventually be rescaled to cover the original
F. When we describe the covering of F we allow ourselves to use discs centered at
a point p ∈ Ob (C{σ} ) where it is understood that such discs will be centered at the
origin in the covering cells Cj that we construct, and the maps fj will translate the
origin to p. We note that rescaling has the effect of eventually rescaling the centers
of the covering discs that we construct below by a factor of s. In the algebraic case
we will always choose s and p to be algebraic of complexity poly(β) so that the
maps that we eventually construct will indeed be of complexity poly(β).
We will consider two separate cases: ρ > 1, σ = 1 and ρ = 1, σ < 1. The general
case can be reduced to a composition of these two cases, first refining {ρ}-extensions
into {1}-extensions and then refining {1}-extensions into {σ}-extensions
6.1.1. The case ρ > 1, σ = 1. In this case regardless of the type of F we have
F{ρ} = Fδ where δ = 1 − Θ(ρ−1 ). We will consider the different fiber types
separately.

COMPLEX CELLULAR STRUCTURES

35

Suppose F is of type D. Up to rescaling F = D(1). Then we take E = {1}. Up
to rescaling the fiber, our goal to cover D(1) by discs whose Ω(1)-extensions remain
in D(δ −1 ) = D(1 + Ω(ρ−1 )). One can use for example any disc of radius O(ρ−1 )
centered in D(1); clearly poly(ρ) such discs suffice to cover D(1).
Suppose F is of type D◦ . Up to rescaling F = D◦ (1). Again we take E = {1}.
We first embed D◦ (O(1)) in D◦ (1) choosing the radius in such a way that the
{1}-extension remains in D◦ (1). It remains to cover the annulus A(Ω(1), 1) using
poly(ρ) discs whose Ω(1)-extensions remain in D◦ (1). This can be done as in the
case F = D(r).
Suppose F is of type A. Up to rescaling F = A(r, 1). We take E = {1}{ρ̂} where
ρ̂ will be chosen later. By the fundamental lemma for D \ {0} applied to r on the
cell C{1} one of the following holds
log |r(C{1} )| ⊂ (−∞, −Ω` (1/ρ̂)),

diam(log | log |r(C{1} )||; R) = O` (ρ̂).

(91)

We will use the following simple lemma.
Lemma 43. Let α ∈ (0, 1] (resp. β ∈ [1, ∞)) and suppose r < α (resp. rβ < 1)
uniformly in C{1} . Then one can cover C  S 1−Ω(1/ρ) (α) (resp. C  S 1−Ω(1/ρ) (βr))
by poly(ρ) cells whose {1}-extensions remain in (C  F){ρ} .
Proof. The {1}-extension of a disc of radius O(α/ρ) around a point of S(α) remains
in S 1−Ω(1/ρ) (α). Moreover for any point in C{1} this remains in A{ρ} (r, 1) since
r < α. We choose a collection of poly(ρ) such discs to cover S 1−Ω(1/ρ) (α). Then
CDi gives the required covering. The respective case is similar, with S(α) replaced
by S(βr).

Suppose that we are in the first case of (91). Inside A(r, 1) we choose the annulus
A such that A{1} = A(r, 1): this is possible if we choose ρ̂ = Ω(1). It remains to
cover the two annuli components of A(r, 1) \ A. Each of these has width O(1) in the
logarithmic scale. Lemma 43 allows us to cover subannuli of width Ω(1/ρ): with
α for the outer component and with β for the inner component. Clearly poly(ρ)
applications of the lemma suffice to cover the two components.
Suppose that we are in the second case of (91). If we choose ρ̂ = Ω(1) we may
assume that the ratio of log |r| between any two points of C{1} is in (9/10, 10/9).
We again distinguish two cases: first, suppose that we can uniformly over C{1}
choose inside A(r, 1) the annulus A such that A{1} = A(r, 1). In this case we
can proceed as above. Otherwise, over some point in C{1} we have r(z1..` ) = r0
with log |r0 | = −O(1). We now apply Lemma 43 to cover the annulus given in
the logarithmic scale by (2/3 log |r0 |, 0) (using α) and the annulus given in the
logarithmic scale by (log |r|, log |r| − 2/3 log |r0 |) (using β). Crucially, the ratio
condition on log |r| in C{1} ensures that these two annuli remain in A(r, 1) and
cover it uniformly over C{1} . Since the width of each of these annuli is O(1) we see
as above that poly(ρ) applications of the lemma suffice to cover them.
6.1.2. The case ρ = 1, σ < 1. In this case we have F{σ} = Fε where ε ∼ σ in
type D and ε = e−Θ(1/σ) in types D◦ , A. We will consider the different fiber types
separately.
Suppose F is of type D. Up to rescaling F = D(1). Then we take E = {σ}.
Up to rescaling the fiber, our goal to cover D(1) by discs whose Ω(σ)-extensions

36

GAL BINYAMINI AND DMITRY NOVIKOV

remain in D(1){1} . One can use for example any disc of radius O(σ) centered in
D(1); clearly poly(1/σ) such discs suffice to cover D(1).
Suppose now that F is of type D◦ or A. Up to rescaling F = D◦ (1) or F = A(r, 1).
We will use the following analog of Lemma 43. The β-case of the lemma is valid
only for type A.
Lemma 44. Let α ∈ (0, 1] (resp. β ∈ [1, ∞)) and suppose r < α (resp. rβ < 1)
uniformly in C{σ} . Then one can cover C  S Ω(1) (α) (resp. C  S Ω(1) (βr)) by
poly(1/σ) cells whose {σ}-extensions remain in (C  F){1} .
Proof. The {Ω(1)}-extension of a disc of radius Ω(α) around a point of S(α) remain
in S Ω(1) (α). We choose a collection of O(1) such discs to cover S Ω(1) (α). By what
was already proved for discs, we can further cover each of the discs by poly(1/σ)
discs whose {σ}-extensions remain in S Ω(1) (α). Moreover for any point in C{σ}
this remains in F{1} (in type A we use that r < α). If {Di } denotes the collection
of all discs obtained in this process then C  Di gives the required covering. The
respective case is similar, with S(α) replaced by S(βr).

Suppose F = D◦ (1). We take E = {σ}. We first embed D◦ (e−Θ(1/σ) ) in D◦ (1)
so that the {σ}-extensions remains in D◦ (1). It remains to cover the annulus
A(e−Θ(1/σ) , 1), or in the logarithmic scale (−Θ(1/σ), 0). Lemma 44 allows us to
cover subannuli of logarithmic width Ω(1), and indeed poly(1/σ) applications suffice
to cover the annulus.
Finally suppose F = A(r, 1). We take E = {σ}{ρ̂} where ρ̂ will be chosen later.
By the fundamental lemma for D \ {0} applied to r on the cell C{σ} one of the
following holds
log |r(C{σ} )| ⊂ (−∞, −Ω` (1/ρ̂)),

diam(log | log |r(C{σ} )||; R) = O` (ρ̂).

(92)

Suppose that we are in the first case of (92). Inside A(r, 1) we choose the annulus
A (uniformly over C{σ} ) such that A{σ} = A(r, 1): this is possible if log |r| =
−Ω(1/σ), i.e. if we choose ρ̂ = Ω(σ). It remains to cover the two annuli components
of A(r, 1) \ A. Each of these has width O(1/σ) in the logarithmic scale. Lemma 44
allows us to cover subannuli of width Ω(1): with α for the outer component and
with β for the inner component. Clearly poly(1/σ) applications of the lemma suffice
to cover the two components.
Suppose that we are in the second case of (92). If we choose ρ̂ = Ω(1) we may
assume that the ratio of log |r| between any two points of C{1} is in (9/10, 10/9).
We again distinguish two cases: first, suppose that we can uniformly over C{σ}
choose inside A(r, 1) the annulus A such that A{σ} = A(r, 1). In this case we
can proceed as above. Otherwise, over some point in C{σ} we have r(z1..` ) = r0
with log |r0 | = −O(1/σ). We now apply Lemma 44 to cover the annulus given
in the logarithmic scale by (2/3 log |r0 |, 0) (using α) and the annulus given in the
logarithmic scale by (log |r|, log |r| − 2/3 log |r0 |) (using β). Crucially, the ratio
condition on log |r| in C{σ} ensures that these two annuli remain in A(r, 1) and
cover it uniformly over C{σ} . Since the logarithmic width of each of these annuli is
O(1/σ) we see as above that poly(1/σ) applications of the lemma suffice to cover
them.
6.1.3. The real case. Only a very minor modification is needed in order to treat
the real case. If C is real then all the rescalings performed during the proof are

COMPLEX CELLULAR STRUCTURES

37

also real. Wherever we construct a collection of discs to cover a domain F by discs
in the complex case, we now choose a collection of discs with real centers to cover
R+ F. This ensures that the cells that we construct are real, and the rest of the
proof remains unchanged.
6.1.4. Uniformity over families and Remark 42. The statement regarding uniformity over families follows by inspection of the proof. By induction the refinement
maps chosen for the base can all be chosen from a single definable family. The
covering constructed for the fiber, after a uniform rescaling, consists of discs or
annuli with a constant center and radius. The family of all such discs or annuli is
certainly definable.
Remark 42 follows immediately from the proof: it suffices to note that D fibers
are always covered by D fibers, and D◦ , A fibers are covered by a collection of D
fibers and possibly one additional fibers of type D◦ , A; and this additional fiber is
always centered at zero, and hence homotopy equivalent to the original fiber by the
injection map.
6.2. Monomial cells. Let C be a cell of length `. An admissible monomial on C is
a function of the form c · zα where c ∈ C and α = α(f ) is the associated monomial
of some function f ∈ Ob (C).
Definition 45 (Monomial cell). We will say that a cell C is monomial if C = ∗;
or if C = C1..`  F and the radii involved in F are admissible monomials on C1..` .
Using the refinement theorem and the monomialization lemma we prove the
following proposition.
Proposition 46. In the conclusion of the refinement theorem one can further require that each Cj is a monomial cell.
Proposition 46 implies that we could use monomial cells, rather than general
complex cells, as our standard models for cellular covers. In some cases this is
more convenient, as the monomial cells have a more transparent combinatorial and
algebraic structure. However for the most part we have chosen in this paper to
state our constructions for general complex cells.
The proof of Proposition 46 will occupy the remainder of this section. We start
by applying the refinement theorem to C with some {σ̂} = {σ̂1 }{σ̂2 } to be chosen
later. Recall that all of the cells constructed in the refinement theorem can be
chosen from one definable family independent of σ̂. By the monomialization lemma,
if r(z) is any of the radii involved in the definition of one of these cells Cj then we
have r(z) = zα(r) U (z) where
{σ̂2 }

diam(Re log U (Cj

); R) < OC (σ̂1 )

{σ̂ }
diam(Re log U (Cj 2 ); R)

(93)

< poly` (β) · σ̂1

in the subanalytic and algebraic cases respectively. We will now construct a mono{σ}
{σ}
mial cell C̃j such that Cj ⊂ C̃j ⊂ C̃j ⊂ C{σ̂} , and the identity map then gives
the covering of Cj by a monomial cell as required.
We construct C̃j by induction. If Cj is of length zero or one then it is already
^
monomial so we may take C̃j := Cj . If Cj := (Cj )1..` F then we set C̃j := (C
j )1..` F̃

38

GAL BINYAMINI AND DMITRY NOVIKOV

where F̃ is defined as follows. Suppose F = A(r1 , r2 ) and write r1 = zα1 U1 and
r2 = zα2 U2 . Then F̃ = A(r̃1 , r̃2 ) where
r̃1 = zα1

|r1 (z)|

min

r̃2 = zα1

max

|r2 (z)|.

(94)

^
{σ}
z1..` ∈(Cj )1..`

^
{σ}
z1..` ∈(Cj )1..`

{σ}

It is clear that Cj ⊂ C̃j , and what remains to be verified is that C̃j

{σ̂}

⊂ Cj

.

{σ̂ }
By (93), for an appropriate choice of σ̂1 we can make diam(Re log U (Cj 2 ); R) < 1,
{σ̂ }
which implies that r̃1 /r1 > 1/e and r̃2 /r1 < e on Cj 2 . Now choosing σ̂2 < σ and
{σ}
{σ̂}
also {σ̂} < {σ}/e we have indeed C̃j ⊂ Cj .

6.3. Clustering in fibers of proper covering maps.
6.3.1. The general (complex) setting. Let C{ρ} be a cell and let Z ⊂ C{ρ} × C be
an analytic set such that the natural projection π : Z → C{ρ} is a proper covering
map. Let ν denote the degree of π and set Ĉ := C×ν! . Let Ẑ ⊂ Ĉ × C be the
pullback (Rν! , id)∗ Z. Then the sections yj : Ĉ → C of Ẑ over Ĉ are univalued, and
we denote their collection by Σ. Each section yj in fact extends holomorphically to
the cell Ĉ{ν!·ρ} by Proposition 22, but this exponential (in ν) loss in the size of the
extension is too coarse for our purposes. Instead, we denote by νj 6 ν the size of
the π1 (C)-orbit of yj thought of as a multivalued section over C.
Lemma 47. Let yj ∈ Σ. Then yj is already univalued as a section over the cover
{ν ·ρ}
Ĉj := C×νj , and extends holomorphically to Ĉj j .
Proof. The group π1 (C) is abelian. It is enough to check that the for any g ∈ π1 (C)
we have g νj (yj ) = yj . This is elementary: the hgi-action induces a partition of the
orbit π1 (C) · yj of size νj into hgi-orbits, and π1 (C) acts transitively on these orbits.
Thus they are all of the same size, which in particular divides νj , and this is true
in particular for the orbit hgi · yj .

Let yi , yj , yk ∈ Σ be three distinct sections. Since π is unramified, the sections
are pairwise distinct over any point of Ĉ. We let νi,j,k := lcm(νi , νj , νk ) and Ĉi,j,k :=
C×νi,j,k . We define a map si,j,k as follows,
{ν

i,j,k
si,j,k : Ĉi,j,k

·ρ}

→ C \ {0, 1},

si,j,k =

yi − yj
.
yi − yk

(95)

By the fundamental lemma for maps into C \ {0, 1} one of the following holds:
si,j,k (Ĉi,j,k ) ⊂ B({0, 1, ∞}, e−Ω` (1/(ν

3

ρ))

; CP 1 ),

diam(si,j,k (Ĉi,j,k ); C \ {0, 1}) = O` (ν 3 ρ).

(96)

We remark that equivalently (96) holds if we replace Ĉi,j,k by Ĉ, since si,j,k on Ĉ
factors through Ĉi,j,k .
Fix yi ∈ Σ. We will cluster the remaining sections into annuli according to
their relative distances from yi , which are expressed by the quantities si,j,k . Since
these quantities are invariant under affine transformations of C, we may assume for
simplicity of the notation that yi = 0. We record a useful corollary of (96) in this
normalization.

COMPLEX CELLULAR STRUCTURES

39

Lemma 48. Suppose ρ = O` (1/ν 3 ). Let j, k 6= i and write R := log |yj /yk |. One
of the following holds:
R|Ĉ < −Ω` (1/ν 3 ρ)

or

R|Ĉ > Ω` (1/ν 3 ρ),

diam(R(Ĉ), R) = O` (ν 3 ρ)

(97)

maxz∈Ĉ R(z)
< 1 + O` (ν 3 ρ).
minz∈Ĉ R(z)
Proof. If at some point in Ĉ we have yj /yk ∈ A(1/2, 2) then for ρ = O(1) we have
by (96) that yj /yk (Ĉ) ⊂ A(1/4, 4). In this domain the log | · |-distance is bounded
up to constant by the C \ {0, 1} distance so diam(R(Ĉ); R) = O` (ν 3 ρ). It remains
to consider the case yj /yk (Ĉ) ⊂ D◦ (1/2) (or A(2, ∞) which is the same up to
inversion). In the first case of (96) we have R = −Ω` (1/(ν 3 ρ)). In the second case
of (96), since the C \ {0, 1} metric is equivalent to the D◦ (1) metric in D◦ (1/2) we
have (as in the fundamental lemma for D◦ ) the estimate
diam(log |R(Ĉ)|; R) = O` (ν 3 ρ).

(98)

With our assumption on ρ this means that R(Ĉ) varies multiplicatively by a factor
of size at most 1 + O` (ν 3 ρ).

We fix a quantity 0 < γ < 1 which we call the gap. Pick an arbitrary point p ∈ Ĉ
and let
Si := {log |yj (p)| : yj ∈ Σ, yj 6= yi } ⊂ R.
(99)
We say that two points s, s0 in Si belong to the same cluster if they are connected in
the transitive closure of the relation |s − s0 | < 5| log γ|. We order the clusters with
respect to < on R. For cluster number q = 1, . . . , mi we let Ii,q denote the minimal
closed interval containing the 2| log γ|-neighborhood of the cluster. For each q we
arbitrarily choose ŷi,q ∈ Σ to be one of the sections with log |ŷi,q (p)| ∈ Ii,q , and call
it the center of the cluster. We define
γ −2 <ri,q < γ −5ν

γ 5ν <li,q < γ 2 ,

(100)

by the condition
eIi,q = [li,q |ŷi,q (p)|, ri,q |ŷi,q (p)|].
(101)
We also fix some δ < 1 arbitrarily close to 1 (merely to ensure that the boundary
circles below are covered).
We define three types of fibers over Ĉ as follows:
Fi,q = Aδ (li,q ŷi,q , ri,q ŷi,q )
Fi,q+ = A (ri,q ŷi,q , li,q+1 ŷi,q+1 ),
δ

Fi,0+ =

D◦δ (li,1 ŷi,1 ),

q = 1, . . . , mi
q = 1, . . . , mi − 1

Fi,m+ = A (ri,q ŷi,q , ∞).
δ

(102)
(103)
(104)

Note that each of these fibers actually depends only on yi , ŷi,q for Fi,q and on
yi , ŷi,q , ŷi,q+1 for Fi,q+ . Thus they actually factor as domains defined over a cover
Ĉi,j,k for an appropriate choice of the indices. We denote this cover by Ĉi,q or Ĉi,q+ .
The key properties of these domains are summarized in the following proposition.
Proposition 49. Suppose 1/ρ > poly` (ν, | log γ|). Then the following hold uniformly over Ĉ:
(1) The fibers Fi,q , Fi,q+ are well-defined and cover C \ {0}.

40

GAL BINYAMINI AND DMITRY NOVIKOV
γ
\Fi,q do not contain any of the points yj for q = 1, . . . , mi .
(2) The domains Fi,q
γ
(3) The domains Fi,q+
do not contain any of the points yj for q = 0, . . . , mi .

Proof. The only non-trivial assertion in the first statement is that Fi,q+ is welldefined, i.e. that ri,q ŷi,q < li,q+1 ŷi,q+1 uniformly over Ĉ. At p we have by construction
log |ŷi,q+1 (p)/ŷi,q (p)| > log(ri,q /li,q+1 ) + | log γ|.
(105)
We need to prove that
log |ŷi,q+1 /ŷi,q | > log(ri,q /li,q+1 )

(106)

uniformly over Ĉ. This follows easily from Lemma 48 for an appropriate choice
of ρ. The only non-trivial case is the last one, which follows if one recalls that
log(ri,q /li,q+1 ) < 10ν| log γ|.
The third statement follows from the second: over p all the point yj except yi = 0
lie in the domains Fi,q , and assuming that they never cross into the boundaries
γ
Fi,q
\ Fi,q this remains true uniformly over Ĉ. We proceed to the proof of the
second statement. We will show that yj does not belong to the outer boundary of
γ
Fi,q
\ Fi,q (the case of the inner boundary is similar). By construction over p one
of the following holds:
log |yj (p)/ŷq (p)| < log ri,q − 2| log γ|,

log |yj (p)/ŷq (p)| > log ri,q + 3| log γ|.
(107)

We must prove that one of
log |yj /ŷq | < log ri,q ,

log |yj /ŷq | > log ri,q + | log γ|,

(108)

holds uniformly over Ĉ. This follows in the same manner as the first statement.



Since the sections yj do not meet the Fi,q+ and ∂Fi,q , it follows that each section
yj 6= yi uniformly lies in a single Fi,q . We say that such sections belong to the cluster
Fi,q .
Remark 50. If we focus our attention on a single cluster Fi,q then it is convenient,
up to an affine transformation over Ĉi,q , to assume that both yi = 0 and ŷi,q = 1.
With γ, ρ as in Proposition 49 we then have Fi,q = Aδ (li,q , ri,q ). For any yj in the
Fi,q cluster our choice of ρ ensures that the second option of (96) holds, and we
have diam(yj (Ĉi,q ), C \ {0, 1}) = O(ν 3 ρ).
6.4. The real setting. Suppose that C{ρ} is a real cell and Z ⊂ C{ρ} ×C is real, i.e.
invariant under z → z̄. In this case we would like to construct the fibers Fi,q , Fi,q+
to be real as well. However, the construction above produces fibers whose centers
and radii are given in terms of the sections yj , which are generally not real. We
now modify this construction to produce real fibers. We fix p ∈ RĈ.
The pullbacks Ĉ, Ẑ of C, Z by Rν! are also real. Since Ẑ is a cover, each section
yj is either always real or always non-real on RĈ. We denote the former sections
by ΣR and the latter by ΣC . If yj ∈ Σ then by the symmetry of Ẑ there exists a
symmetric section yj̄ ∈ Σ defined by yj̄ (z) := yj (z̄).
Definition 51. Let yj ∈ ΣC . Making a real affine transformation we pass to a
chart where yj (p) = i, yj̄ (p) = −i. Then the pair yj , yj̄ is called admissible if
D(1/10) contains none of the points yk (p) for yk ∈ Σ.

COMPLEX CELLULAR STRUCTURES

41

An admissible center is a map of the form (yj +yj̄ )/2 where yj ∈ ΣR or yj , yj̄ ∈ ΣC
is an admissible pair. Every admissible center is real on RĈ. We denote the set of
admissible centers by {c1 , . . . , ct }.
Lemma 52. Let yj ∈ ΣC and by a real affine transformation pass to a chart where
yj (p) = i, yj̄ (p) = −i. Then D(1/5) contains cl (p) for an admissible center cl .
Proof. If yj , yj̄ is admissible then the claim is obvious. Otherwise there exists a
section yk (p) ∈ D(1/10). Rescaling to make yk (p) = i we see that it will be enough
to prove the claim for yk . Clearly this process must terminate after no more than
ν steps.

The motivation for the notion of admissibility comes from the following lemma.
Lemma 53. Suppose 1/ρ = poly` (ν). For every section yj and admissible center
cl we have cl 6= yj uniformly over Ĉ, unless cl = yj ∈ ΣR .
Proof. If cl = yk ∈ ΣR for some k then the claim follows from the fact that Ẑ is
a cover whose sections are pairwise distinct over any point of Ĉ. Assume therefore
that cl = (yk +yk̄ )/2 for yk ∈ ΣC . We make a real affine transform to pass to a chart
where yk (p) = i. Suppose toward contradiction that at some point p̃ ∈ Ĉ we have
yj = (yk +yk̄ )/2, i.e. sj,k,k̄ (p̃) = −1. Then by (96) we have |sj,k,k̄ (p)+1| = O` (ν 3 ρ).
For a suitable choice of ρ this readily implies that |yj (p)| < 1/10, contradicting the
admissibility of cl .

Lemma 53 implies that we can define maps s̃l,j,k as follows
cl − yj
{νl,j,k ·ρ}
.
(109)
s̃l,j,k : Ĉl,j,k
→ C \ {0, 1},
si,j,k =
cl − y k
Fix an admissible center cl . We will cluster the sections yj into annuli according
to their relative distances from cl in analogy with the complex construction. As
before, we make a real affine transformation and assume that cl = 0.
We define the intervals Il,q in the same way as in the complex setting. However, a
small variation is needed in the choice of ŷl,q , which must be real on RĈ to maintain
the real structure of our construction. Let yj be one of the sections with yj (p) ∈ Il,q .
√
We define ŷl,q := yj yj̄ . Clearly ŷl,q is real on RĈ. To see that it is univalued on Ĉ
note that yj and yj̄ have the same associated monomial by symmetry, hence yj yj̄
has an even associated monomial and admits a univalued square root.
With ŷl,q chosen as above we continue the construction as in the complex case.
To verify that all the arguments remain valid we need an analog of Lemma 48
√
where either yj or yk (or both) are replaced by a cluster center ŷl,q := yh yh̄ . This
follows essentially from the same lemma applied to yh and to yh̄ , and we leave the
details for the reader. As a consequence we see that Proposition 49 and Remark 50
continue to hold, with the fibers Fi,q and Fi,q+ now real on RĈ.
7. Cellular Weierstrass Preparation Theorem
In this section we state and prove a cellular analog of the Weierstrass preparation
theorem. We stress that unlike the classical theorem, the cellular version does not
involve a change in the order of coordinates.
Definition 54. Let γ > 0 and C  Fγ be a cell and let F ∈ Ob (C  Fγ ). We say
that C  Fγ is a Weierstrass cell with gap γ for F if:

42

GAL BINYAMINI AND DMITRY NOVIKOV

• F vanishes identically on C  Fγ , or
• F is non-vanishing on C  ∗ if F = ∗, or
• F is non-vanishing on C  (Fγ \ F) if F = D, D◦ , A.
If Ĉ is a cell and F ∈ Ob (Ĉ) we say that a cellular map f : C  Fγ → Ĉ is
Weierstrass with gap γ for F if C  Fγ is a Weierstrass cell with gap γ for f ∗ F .
Theorem 10 (Cellular Weierstrass Preparation Theorem (WPT)). Let ρ, σ > 0.
Let C{ρ} be a (real) cell and F ∈ Ob (C{ρ} ) a (real) function. Then there exist
{σ}
N = polyF,F (ρ, 1/σ) (real) Weierstrass maps fj : Cj  Fjγ → C{ρ} for F with gap
γ < 1 such that C ⊂ ∪j fj (Cj  Fj ).
If C, F vary in a definable family then N, γ can be taken uniform over the family
and the maps fj can be chosen from a single definable family. If C, F are algebraic
of complexity β then one may take N = poly` (β, ρ, 1/σ) and γ = 1 − 1/ poly` (β).
We will prove the WPT and CPT by induction on ` := `(C) and dim C. The
cases ` = 0 and dim C = 0 are vacuous. We now prove the WPT for a cell C  F of
length ` + 1 assuming that the CPT and WPT are true for cells of smaller length
or equal length and smaller dimension. The case F = ∗ reduces to the CPT for C
so we assume F is D, D◦ , A.
We will give two separate proofs: one in the algebraic case, and one in the
analytic case. This is the only part of the proof of the main theorems where our
arguments significantly diverge for these two cases.
7.1. Proof in the algebraic case.
7.1.1. Algebraic discriminants. We will require the following simple lemma on discriminants.
Lemma 55. Let C be a cell of length ` and F ∈ Ob (C), both algebraic of complexity
β. Suppose that F does not vanish identically on C. Then there exist:
• A polynomial P ∈ C[z1..` ] of complexity poly(β), not identically vanishing
on C, and satisfying {F = 0} ⊂ {P = 0}.
• A polynomial D ∈ C[z1..`−1 ] of complexity poly(β), not identically vanishing on C1..`−1 , such that the projection
π : (C1..` × C) ∩ {P = 0} → C1..`−1 ,

π(z1..` ) = z1..`−1

(110)

is proper covering map outside {D = 0}.
If F is real then P, D can be chosen real as well.
Proof. We may assume without loss of generality that the type of C does not contain
∗, since any such coordinate can be ignored for the statement of the lemma. Then
C ⊂ C` is open.
By definition the graph of F is contained in some irreducible algebraic variety
GF ⊂ C` × Cw . Since F is not identically vanishing on C, the equation w = 0 cuts
GF properly in a subvariety of dimension ` − 1, and the projection of this variety to
C` contains {F = 0} and is contained in a proper algebraic hypersurface of degree
poly(β), i.e. in a set {P = 0} where P ∈ C[z1 ..`] is not identically vanishing (on
C, since C is open). We may also assume that P is square-free as a polynomial in
C(z1..`−1 )[z` ], and in particular has no multiple roots for a generic value of z1..`−1 .
Then the classical discriminant D of P satisfies the conditions of the lemma.

COMPLEX CELLULAR STRUCTURES

43

For the final statement, if F is real then its graph is invariant under conjugation,
and the same is then also true for GF . The polynomial P is then also real by
construction.

7.1.2. Proof of the algebraic WPT. We now proceed to the proof of the WPT.
Suppose F = A(r1 , r2 ) (the cases D(r), D◦ (r) are similar). Applying the refinement
theorem, we may assume that ρ is already as small as we wish as long as 1/ρ =
poly` (1/σ, β).
There is no harm in replacing F by the polynomial P obtained from Lemma 55
applied to the function F · (z`+1 − r1 ) · (z`+1 − r2 ). In other words we may assume
without loss of generality that F is a polynomial in the z` variable and that it
vanishes when z` is either 0, r1 (z1..` ) or r2 (z1..` ). We let D denote the corresponding
discriminant.
{ρ}
We apply the CPT to C with D and let fj : Cj → C{ρ} denote the resulting
{ρ}

cellular cover. If fj (Cj ) is contained in {D = 0} then since cellular maps preserve
dimension dim Cj 6 dim{D = 0} 6 dim C − 2. In this case we set
Ĉj := Cj  fj∗ F

{ρ}
fˆj := (fj , id) : Ĉj → C{ρ}

(111)

and inductively apply the WPT to Ĉj and fˆj∗ F . We obtain Weierstrass maps
{σ}
{ρ}
{σ}
fj,k : C
 Fγ → Ĉ
for F , and the compositions fj,k ◦ fˆj : C
 Fγ → C{ρ}
j,k

j

j,k

are Weierstrass maps for F which cover f (Cj )  F.
{ρ}
It remains to consider the case that fj (Cj ) is disjoint from {D = 0}. In the
same way as before, it will suffice to prove the WPT for Ĉj and fˆj∗ F . We return
now to the original notation replacing this pair by C, F . We note that F is still
polynomial in z` (though perhaps not in the other coordinates) and the projection
π : (C{ρ} × C) ∩ {P = 0} → C{ρ} ,

π(z1..`+1 ) = z1..`

(112)

is a proper covering map. It will suffice to prove the WPT under these conditions.
We are now in a position to use the constructions of §6.3.1. Note that ν = poly` (β).
We will choose γ = 1 − 1/ poly` (β) (the precise choice will be determined later).
Recall that we may choose ρ small as long as 1/ρ = poly` (1/σ, β). We take
{ρ} < {σ} · {ρ̂} where ρ̂ is chosen in such a way that Proposition 49 holds over
C{σ} . The zero map is a section of π which we denote by y0 . Since r1 , r2 are sections
of π they belong to certain clusters around y0 = 0, say with indices q1 6 q2 . We
may also assume that r1 = ŷq1 and if q1 6= q2 then r2 = ŷq2 .
If q1 = q2 = q then we define F̃ = F0,q . If q1 < q2 then we define
F̃ := Aδ (lq1 r1 , rq2 r2 ),

(113)

i.e. we take the left endpoint of the F0,q1 cluster and the right endpoint of the
F0,q2 cluster. Since r1 , r2 are univalued over C this is actually a fiber over C and
the Weierstrass condition is provided by Proposition 49. The inclusion F̃γ ⊂ F{ρ}
follows from (100) for an appropriate choice of γ.
7.1.3. The real setting. If C and F are real then P is also real, and consequently
the coverings constructed by inductive applications of the CPT can be taken to be
real. After these reductions, the fiber constructed in (113) is clearly real as well.

44

GAL BINYAMINI AND DMITRY NOVIKOV

7.2. Proof in the analytic case. Before giving the proof of the WPT in the
analytic case we develop some general results concerning the Laurent coefficients
of definable families of holomorphic functions.
7.3. Laurent domination in definable families. We will study the following
property of the Taylor/Laurent coefficients of a holomorphic function.
Definition 56 (Taylor domination). A holomorphic function f : D(r) → C is
said to P
posses the (p, M ) Taylor domination property2 [2] if its Taylor expansion
f (z) = ak (z − z0 )k satisfies the estimate
|ak |rk < M max |aj |rj ,
j=0,...,p

k = p + 1, p + 2, . . .

(114)

Similarly, for r2 > r1 > 0 a holomorphic function f : A(r1 , r2 ) → C is said to
posses
the (p, M ) Laurent domination property if its Laurent expansion f (z) =
P
ak (z − z0 )k satisfies the estimates
|ak |r2k < M
|ak |r1k < M

max

|aj |r2j ,

k = p + 1, p + 2, . . .

max

|aj |r1j ,

k = −p − 1, −p − 2, . . .

j=−p,...,p
j=−p,...,p

(115)

We will need the following lemma on Laurent expansions.
2

Lemma 57. Let S := S(1) and fλ : S δ → C a definable family of holomorphic
functions for some 0 < δ < 1. Then there exists B such that for every λ ∈ Λ we
have
(116)
kfλ kS δ 6 B kfλ kS .
P
k
If we write fλ (z) =
ak (λ)z then there exists p ∈ N and m > 0 such that for all
λ we have
|aj (λ)| > m kfλ kS

for some j = j(λ) ∈ {−p, . . . , p}.

(117)

Proof. As we have seen in the proof of Lemma 39, the Voorhoeve index of fλ along
2
any circle in S δ is uniformly bounded over λ (and over the circle). Fix λ and
assume without loss of generality (up to rotation) that the maximum of fλ on S δ
is attained at δi or δ −1 i. Let C be the circle intersecting iR at δ ±1 i and fix some
2
disc D with C ⊂ D and D̄ ⊂ S δ . The Voorhoeve index of fλ over ∂D is uniformly
bounded over λ, and it follows from [28, Theorem 3]3 that BS∩D,D (fλ ) is uniformly
bounded by some constant B1 , where
BK,U (f ) = log max |f (z)| − log max |f (z)|.

(118)

kfλ kS δ = max |f (z)| 6 eB1 kfλ kS

(119)

z∈Ū

z∈K

Thus
z∈D̄

proving the first part.
From the first part and the Cauchy estimate it follows that
|ak (λ)| 6 Bδ |k| kfλ kS .

(120)

2note that we use a slightly simplified form of the definition given in [2].
3The result there is stated for K with nonempty interior, but actually holds for K of the form

S ∩ D, see [28, Section 4.1].

COMPLEX CELLULAR STRUCTURES

45

Then
kfλ kS 6

X

X

|ak (λ)| =

k∈Z

X
k∈{−p,...,p}

X

|ak (λ)| +

|ak (λ)| 6

(121)

k6∈{−p,...,p}

k∈{−p,...,p}

2Bδ p+1
|ak (λ)| +
kfλ kS
1−δ

and the result now follows with p such that

(122)

2Bδ p+1
1−δ

< 1/2 and m = 1/(4p + 2). 

As a direct corollary of Lemma 57 we obtain the following result. We remark
that a similar statement for families of discs appeared (in a slightly different form
and with a different proof) in [17]. The disc case also follows fairly directly from
a classical theorem of Biernacki [4]. However the annulus case does not seem to
follow in a similar manner.
Corollary 58. Let Fλ be a definable family of discs or annuli and let fλ : Fλε → C
be a definable family of holomorphic functions, for some 0 < ε < 1. Then the
functions fλ have the (p, M ) Laurent domination property in Fλ for some uniformly
bounded p, M .
Proof. We prove the annuli case, the disc case being simpler. Since the claim is
invariant under rescaling, we may assume without loss of generality that Fλ is of
the form A(r1 , 1). We need to prove
|ak | < M

max

j=−p,...,p

|aj |,

k = p + 1, p + 2, . . .

(123)

And indeed by the Cauchy estimates and Lemma 57 with δ 2 = ε we have
B
|aj (λ)|
for some j ∈ {−p, . . . , p}.
(124)
m
For k = −p − 1, . . . we proceed similarly, assuming now that Fλ is of the form
A(1, r2 ).

|ak (λ)| 6 B kfλ ks δ k 6

We record a simple consequence of the Taylor domination property.
Proposition 59. Let A := A(r1 , r2 ) and 0 < δ < 1. Let f : Aδ → C be a
holomorphic function with (p, M ) Taylor domination. Write
p
X

f (z) =

aj z j + Rp (z).

(125)

j=−p

Then for z ∈ A we have
|Rp (z)| <

2δ
M max |aj z j |.
1 − δ j=−p,...,p

(126)

Proof. The Taylor domination property in Aδ gives
|ak |r2k < δ k−p M

max

j=−p,...,p

|ak |r1k < δ −k−p M

max

|aj |r2j ,

j=−p,...,p

|aj |r1j ,

k = p + 1, p + 2, . . .
k = −p − 1, −p − 2, . . .

(127)

and the same clearly holds with r1 , r2 replaced by z ∈ A. Summing over k =
p + 1, . . . , ∞ and k = −p − 1, . . . , −∞ we obtain (126).


46

GAL BINYAMINI AND DMITRY NOVIKOV

7.3.1. Proof of the analytic WPT. We may assume without loss of generality that
C  F admits an extension slightly larger than {ρ}. Then (C  F){ρ} is subanalytic,
and in particular the family of all discs or annuli of the form {z1..` } × F̃ with
{z1..` } × F̃1/2 ⊂ (C  F){ρ} is definable. Applying Lemma 58 we find p, M such
that F satisfies the (p, M ) Laurent domination property on every fiber {z1..` } × F̃
as above.
Applying the refinement theorem, we may assume that ρ is already as small as
we wish as long as 1/ρ = poly` (1/σ). Since the maps constructed in the refinement
theorem are cellular translate maps, every disc/annulus {z1..` }×F̃1/2 ⊂ (CF){ρ} in
a refined cell maps to a disc/annulus satisfying the same requirement in our original
cell C. Thus we may assume that after refinement our function F still satisfies the
(p, M ) Laurent domination property on every fiber {z1..` } × F̃ as above. Note that
crucially (p, M ) does not depend on our choice of {ρ}.
Suppose F = A(r1 , r2 ) (the cases D(r), D◦ (r) are similar). If F vanishes identically on C  F then there is nothing to prove, so suppose otherwise. Rescaling F
by r2 we may assume that r2 = 1 and |r1 | < 1. We write a Laurent expansion
F (z1..`+1 ) =

∞
X

ak (z1..` )zk`+1

(128)

k=−∞

where ak ∈ Ob (C{ρ} ). We apply the CPT to the collection a−p , . . . , ap on C{ρ} . In
the same way as in §7.1 we may reduce to the case where every ak is either identically
or non-vanishing on C{ρ} . Note also that since this step only reparametrizes the
base without affecting the fiber, the (p, M ) Laurent domination property still holds
uniformly for every z1..` ∈ C{ρ} .
Let Π ⊂ {−p, . . . , p} denote the indices k such that ak 6= 0. For j 6= k ∈ Π we
define
s
aj (z1..` )
rjk (z1..` ) = k−j
,
(129)
ak (z1..` )
that is, S(|rjk |) is the circle in z`+1 where the j-th and k-th terms of (128) are of
the same modulus. Note that rjk is multivalued. We let Σ denote the set consisting
of 1, 2 and the pairs (j, k) ∈ Π2 , j 6= k, and set µ := 2 + (2p + 1)p > #Σ.
We show that the zeros of F can only occur in concentric annuli of bounded
width around the radii rjk . It is more convenient to state this in the logarithmic
scale. We set sα := log |rα | for every α ∈ Σ and note that sα is single valued on
C1..` .
Lemma 60. There exists a constant B = B(M, p) such that for any z1..`+1 ∈ C
satisfying
| log |z`+1 | − sα (z1..` )| > B

for α ∈ Σ.

(130)

we have F (z1..`+1 ) 6= 0.
Proof. Assume that (130) holds for some unspecified constant B which will be
chosen later. Set r := |z`+1 |. For k, j ∈ Π2 with k 6= j we have



|aj zj`+1 | 

(131)
log
 = |(j − k)[− log(|rjk | + log r]| > B.

|ak zk`+1 | 

COMPLEX CELLULAR STRUCTURES

47

0
In particular there exist one term j0 ∈ Π such that |aj0 zj`+1
| is maximal and we
have
0
|ak zk`+1 | < e−B |aj0 zj`+1
|,

k ∈ {−p, . . . , p} \ {j0 }.

(132)

Set
Rp (z1..`+1 ) := F (z1..`+1 ) −

p
X

aj (z1..` )zk`+1 .

(133)

k=−p

Since 1, 2 ∈ Σ we have eB r1 (z1..` ) < r < e−B r2 (z1..` ). Then Proposition 59 implies
(with δ = e−B ) that
2M
|aj zj0 |.
(134)
|Rp (z1..` )| < B
e − 1 0 `+1
In particular choosing B such that 2pe−B + e2M
B −1 < 1 we see that
X
0
|Rp (z1..` )| +
|ak zk`+1 | < |aj0 zj`+1
|

(135)

k∈Π\{j0 }

so F (z1..`+1 ) 6= 0 as claimed.



In light of Lemma 60 our goal will be to construct an annulus A ⊂ F{ρ} which
contains F and such that Aγ \ A remains at logarithmic distance at least B from
each of the |rα |, uniformly over C{σ} .
Apply the CPT to the cell C{ρ} and the hypersurfaces {rα = rβ } for α 6= β ∈ Σ
(formally we raise both sides to a power and clear denominators to obtain a bounded
analytic equation). Once again we may reduce to the case that each of these
equations is satisfied either identically or nowhere in C{ρ} .
We let Z denote the union of the graphs of the zero function and of rα over C{ρ}
for α ∈ Σ. By the condition above π : Z → C{ρ} is a proper covering map. We are
now in a position to use the constructions of §6.3.1. We choose γ = eB .
Recall that we may choose ρ small as long as 1/ρ = poly` (1/σ). We take {ρ} <
{σ} · {ρ̂} where ρ̂ is chosen in such a way that Proposition 49 holds over C{σ} . The
zero map is a section of π which we denote by y0 . Since r1 , r2 are sections of π they
belong to certain clusters around y0 = 0, say with indices q1 6 q2 . We may also
assume that r1 = ŷq1 and if q1 6= q2 then r2 = ŷq2 .
If q1 = q2 then we define F̃ = F0,q . If q1 < q2 then we define
F̃ := Aδ (rq1 r1 , lq2 r2 ),

(136)

i.e. we take the left endpoint of the F0,q1 cluster and the right endpoint of the
F0,q2 cluster. Since r1 , r2 are univalued over C this is actually a fiber over C and
the Weierstrass condition is provided by Proposition 49. The inclusion F̃γ ⊂ F{ρ}
follows from (100) provided that we choose {ρ} large enough (note that B and
hence γ did not depend on our choice of {ρ}).
7.3.2. The real setting. If C and F are real then the Laurent coefficients aj are also
real, and consequently the coverings constructed by inductive applications of the
CPT can be taken to be real. After these reductions, the fiber constructed in (136)
is clearly real as well.

48

GAL BINYAMINI AND DMITRY NOVIKOV

7.3.3. Uniformity over families. Uniformity of the number of cells over definable
families follows readily from the proof. Indeed the indices p, M have already been
shown to be uniformly bounded over families. The fact that all Weierstrass cells
can be chosen from a single definable family follows exactly as in the case of the
refinement theorem.
7.3.4. Analytic discriminants. Later we will also require the following lemma on
analytic discriminants.
Lemma 61. Let C{ρ} be a cell and let Z ⊂ C{ρ} × C such that the projection
π : Z → C{ρ} is proper. Then there exists 0 6= D ∈ Ob (C) such that π is a covering
map outside {D = 0}. If C, Z are real then D can be chosen real as well. If C, Z
vary in a definable family then D can also be chosen to vary from a definable family.
Proof. According to [22, Theorem III.21] the map π is an analytic cover and in
particular it is a λ-sheeted covering map, for some λ ∈ N, outside a negligible set
A ⊂ C{ρ} . Then letting
Y
PZ (z, w) :=
(w − η)
(137)
η∈π −1 (z)

we obtain a monic polynomial of degree λ with holomorphic locally bounded coefficients in C{ρ} \ A, which by the removable singularity theorem extend to holomorphic locally bounded coefficients in C{ρ} . Then D can be taken to be the classical
discriminant of PZ with respect to w. If C, Z are real then PZ and hence D are
also real. It is clear that this construction can be made uniform over definable
families.

8. Proofs of the CPT and CPrT
In this section we finish the proof of the CPT and CPrT for a cell C  F. We proceed by induction on the length and dimension. By the note following Theorem 10,
we may already assume that the WPT holds for C  F.
8.1. Proof of the CPT. We will prove the CPT in a slightly weakened form,
replacing the prepared maps fj by arbitrary cellular maps. We later prove that this
weaker form implies the CPrT, which in turn directly implies the stronger form of
the CPT. We describe the proof for the complex version of the CPT, and at the
end indicate the changes required for the real version. To avoid cluttering the text,
we state our proof for the algebraic version of the CPT with polynomial estimates
in the complexity β. The subanalytic version where these polynomial estimates are
replaced by uniformity over definable families is obtained in a completely analogous
manner.
8.1.1. Reduction to the case of a single function. We claim that it is enough to
prove the CPT for a single function F . We suppose that this is already proved
and prove the result for an arbitrary collection F1 , . . . , FM . We may suppose that
none of the Fj vanish identically on C. Let F := F1 · · · FM and apply the CPT
{σ}
to C, F to obtain a cellular cover fj : Cj → (C  F){ρ} compatible with F . Fix
{σ}

some fj . If fj (Cj ) lies outside the zeros of F then it is already compatible with
F1 , . . . , FM . Otherwise it lies in the zeros of F , and since cellular maps preserve
dimension we have dim Cj < dim C  F. By induction we obtain cellular maps fjk :

COMPLEX CELLULAR STRUCTURES
{σ}

49

{σ}

Cjk → Cj which are compatible with fj∗ F1 , . . . , fj∗ FM . Then the compositions
fj ◦ fjk are compatible with F1 , . . . , FM and cover fj (Cj ), and taken together this
gives a cellular cover of C  F with poly` (β, 1/σ, ρ) maps as required.
8.1.2. Reduction to large σ and small ρ. Applying the refinement theorem to C we
may suppose that it already admits a {ρ̂}-extension for ρ̂−1 = poly` (ρ, β). Below
we will assume that ρ is already as small as we wish subject to this asymptotic.
Similarly, it is enough to prove the CPT with any σ̂ = poly` (β) since we may
afterwards apply the refinement theorem to the resulting cells to obtain cells with
σ-extensions. Below we will assume that σ is already as large as we wish subject
to this asymptotic.
8.1.3. Reduction to a Weierstrass cell for F . We apply the WPT to cover C  F by
{ρ}
cells of the form fj : Cj  Fjγ → (C  F){ρ} which are Weierstrass for F with gap
γ = 1−1/ poly` (β). It is enough to prove the CPT for each of these cells separately,
i.e. we may assume that F ∈ Ob (C{ρ}  Fγ ) does not vanish in C{ρ}  (Fγ \ F). If
F is of type ∗ the CPT reduces to the CPT for C1..`−1 . Suppose F = A(r1 , r2 ) (the
cases D(r), D◦ (r) are similar).
8.1.4. Reduction to a proper covering map. Since C{ρ}  F is a Weierstrass cell
for F the zero locus of F in this cell is proper cover of C under the projection
π : C{ρ} × C → C{ρ} . We define Z to be the union of this zero locus with the graphs
of the functions 0, r1 , r2 : C{ρ} → C. Then by Lemma 61 there exists D ∈ Ob (C{ρ} )
not identically vanishing on C such that the projection π|Z is a proper covering
map outside {D = 0}. In the algebraic case, applying Lemma 55 to the function
F · z`+1 (z`+1 − r1 )(z`+1 − r2 ) we see that D can be taken to be a polynomial of
complexity poly(β).
{ρ}
We apply the CPT to C with D and let fj : Cj → C{ρ} denote the resulting
{ρ}

cellular cover. If fj (Cj ) is contained in {D = 0} then since cellular maps preserve
dimension dim Cj 6 dim{D = 0} 6 dim C − 2. In this case we set
Ĉj := Cj  fj∗ F

{ρ}
fˆj := (fj , id) : Ĉj → C{ρ}

(138)

{ρ̂}

and note that fj∗ F ∈ Ob (Ĉj ) for ρ̂ = poly(ρ, β). We inductively apply the CPT
{σ}
{ρ̂}
to Ĉj with its ρ̂-extension and fˆj∗ F . We obtain a cellular cover fj,k : Cj,k → Ĉj
{σ}
compatible with F , and the compositions fj,k ◦ fˆj : C
→ C{ρ} are compatible
j,k

with F and cover f (Cj )  F.
{ρ}
It remains to consider the case that fj (Cj ) is disjoint from {D = 0}. In the
same way as before, it will suffice to prove the CPT for Ĉj and fˆj∗ F . We return
now to the original notation replacing this pair by C, F so that
π : (C{ρ}  Fγ ) ∩ {F = 0} → C,

π(z1..`+1 ) = z1..`

(139)

is a proper covering map. We are now in a position to use the constructions of §6.3.1.
We denote the degree of π by ν, and note that ν = poly` (β).
8.1.5. Covering the zeros. By Lemma 47, each section yj of π lifts to a univalued
ν ·ρ
map yj : Ĉj j → C. By definition the image of this maps lies in (C{ρ}  Fγ ) ∩ {F =
0}, i.e. it gives a cell compatible with F . The collections of all of these cells cover

50

GAL BINYAMINI AND DMITRY NOVIKOV

the zeros of F in C  F. The remaining (and far more non-trivial) task is to cover
the complement of this set of zeros.
8.1.6. The Voronoi cells associated to y0 = 0. For the remainder of the proof we fix
a point p ∈ Ĉ. We may assume that ρ is small enough that Proposition 49 holds,
not only over C but over C{σ} . The zero map is a section of π which we denote by
y0 . We will construct a collection of cells which we call the Voronoi cells of y0 .
Since r1 , r2 are sections of π they belong to certain clusters around y0 = 0, say
γ
with indices q1 6 q2 . For q = q1 , . . . , q2 − 1 the fibers F0,q+
over Ĉ0,q contain none
γ
of the zeros yj and are contained in F . Therefore the maps Ĉ0,q+  F0,q+ → C  F
admit γ-extensions compatible with F . These give our first Voronoi cells.
Now fix q = q1 , . . . , q2 and consider the cluster F0,q . Up to an affine transformation as in Remark 50 we may assume that ŷ0,q = 1 and F0,q = Aδ (l0,q , r0,q ). Recall
that γ = 1 − 1/ poly` (β), and therefore we have F0,q ⊂ A(1/2, 2). Recall also that
diam(yj (Ĉ), C \ {0, 1}) = O(ν 3 ρ)

(140)

for any of the yj belonging to F0,q .
γ
Let α > 0 be such that the balls of radius α around yj (p) belongs to F0,q
(p).
−1
Clearly we can choose α = poly` (β). Let Up (α) be the set obtained from F0,q (p)
by removing all of these balls. We can cover Up (α) be poly` (β) discs Dk centered
1/2
at Up (α) such that Dk does not meet the balls of radius α/2 around yj (p). These
1/2
give our remaining Voronoi cells. We claim that Ĉ0,q  Dk is compatible with F .
Indeed, over p the discs Dk remain at distance α/2 from the zeros, and by (140)
the points yj do not move enough to meet Di for ρ sufficiently small. By the same
reasoning we obtain the following fundamental property of the Voronoi cells.
Lemma 62. The Voronoi cells associated to y0 cover every point z1..`+1 ∈ C  F
such that
dist(z`+1 , y0 ) < (2α)−1 dist(z`+1 , yj )
(141)
for every yj .
8.1.7. The Voronoi cells associated to yi . Let yi be one of the non-zero sections of
π. We will construct a collection of Voronoi cells for yi by analogy with y0 : the
only additional difficulty is making sure that all cells remain in Fγ . Our goal will
be to construct cells with the following property.
Lemma 63. The Voronoi cells associated to yi cover every point z1..`+1 ∈ C  F
such that
dist(z`+1 , yi ) 6 2α dist(z`+1 , y0 )
(142)
and
dist(z`+1 , yi ) 6 (2α)−1 dist(z`+1 , yj )
(143)
for every yj 6= y0 , yi .
We make an affine transformation such that yi = 0. Since yi ∈ F, we know that
in these coordinates D(ry0 ) ⊂ Fγ for r ∼ 1 − γ = 1/ poly(β). In the notations
of §6.3.1, let Fi,q0 be the last cluster whose outer boundary at p is smaller than
ry0 (p). With our choice of γ the logarithmic width of each cluster can be assumed
to be bounded by log 2. Therefore the inner boundary of Fi,q0 +1 at p is at least
ry0 (p)/2. If the outer boundary of Fi,q0 is smaller than γ 2 ry0 (p)/2 then we also set
F̃i,q0 + = Aδ (ri,q0 ŷi,q0 , γry0 /2).

(144)

COMPLEX CELLULAR STRUCTURES

51

Figure 6. Construction of the F̃i,q0 + fiber near the boundary.
One can check in the same way as in Proposition 49 that when defined, F̃i,q0 + is a
γ
well defined annulus over Ĉi,q0 + and F̃i,q
⊂ Fγ contains no zeros.
0+
The fibers Fi,q , Fi,q+ for q = 1, . . . , q0 −1, the fiber Fi,q0 , and F̃i,q0 + if it is defined
cover D(γ 2 ry0 /2) uniformly over Ĉ. We can choose our α = 1/ poly` (β) in such a
way that this disc contains all points satisfying (142). It will be enough to construct
the Voronoi cells covering the points in these fibers which also satisfy (143). This
is done in a manner completely analogous to the Voronoi cells of y0 , except that in
place of F0,q1 + , . . . , F0,(q2 −1)+ we use Fi,0+ , . . . , Fi,(q0 −1)+ and F̃i,q0 + if it is defined;
and instead of F0,q1 , . . . , F0,q2 we use Fi,1 , . . . , Fi,q0 −1 .
8.1.8. Conclusion. We claim that the Voronoi cells for y0 and the roots yj cover
C  F \ {F = 0}. Indeed, let z ∈ C  F. If dist(z`+1 , y0 ) < (2α)−1 dist(z`+1 , yj ) for
every yj then z is covered by the Voronoi cells of y0 . Otherwise it is covered by the
Voronoi cell of yj for the root yj closest to z`+1 . Since the roots of {F = 0} were
already covered in §8.1.5, this concludes the proof of the CPT in the complex case.
8.1.9. The real case of the CPT. The proof of the CPT in the real case proceeds
in the same manner up to §8.1.5. At this point one should cover only the sections
yj that are real, ensuring that we indeed obtain real cells. Since the sections yj are
locally unramified, each of them is either purely real or purely non-real on R+ C so
we can indeed choose those yj that are real to obtain a covering of the zeros of F
in R+ (C  F).
The next step is the construction of the Voronoi cells. To ensure that the constructed cells are real, one should replace the construction of §6.3.1 by that of §6.4
as we explain below.
The section y0 = 0 is real and therefore forms an admissible center. The Voronoi
cells for y0 are constructed as in the complex case, except that the discs Dk are
now chosen with real centers such that their positive parts cover R+ Up (α). The
points z`+1 that are left uncovered over p are those that have distance at most α
to some root yk . If z`+1 ∈ R then by Lemma 52 such points also have distance at
most α to some admissible center cl = (yj + yj̄ )/2. By analogy with Lemma 62 we
obtain the following lemma.

52

GAL BINYAMINI AND DMITRY NOVIKOV

Lemma 64. The Voronoi cells associated to y0 cover every point z1..`+1 ∈ R+ (C 
F) such that
dist(z`+1 , y0 ) < (2α)−1 dist(z`+1 , cl )
(145)
for every admissible center cl .
For the remaining Voronoi cells, we construct them centered around the admissible centers cl rather than the sections yj . The construction is analogous, replacing
again the covering of Up (α) by a real covering of R+ Up (α). We similarly obtain the
following lemma.
Lemma 65. The Voronoi cells associated to cl cover every point z1..`+1 ∈ R+ (CF)
such that
dist(z`+1 , cl ) 6 2α dist(z`+1 , y0 )
(146)
and
dist(z`+1 , cl ) 6 (2α)−1 dist(z`+1 , cm )
(147)
for every cm 6= y0 , yl .
The proof is then concluded in the same manner.
8.2. Proof of the CPrT. In this section we will prove the CPrT using the WPT
and CPT. We will need a simple remark on the structure of the maps constructed
in these two theorems.
Remark 66. The maps constructed in the CPT can be assumed to be translates in
the final variable, as the reader may easily verify by examining the inductive proof.
Similarly, the maps constructed in the WPT can be assumed to be translates in the
final two variables: the CPT and refinement theorems are applied in the base to
give a translate in the next-to-last variable, whereas in the last variable the map is
the identity.
The main inductive step for the proof of the CPrT is contained in the following
lemma.
Lemma 67. Let f : C{ρ} → Ĉ be a (real) cellular map. Then there exists a (real)
{ρ}
cellular cover {gj : Cj → C{ρ} } of size polyf (ρ) such that each f ◦ gj is prepared
in the last variable.
If C, Ĉ, f vary in a definable family then the size of the cover is poly(ρ) uniformly
over the family, and the maps gj can be chosen to vary definably over the family. If
C, Ĉ, f are algebraic of complexity β then the cover has size poly(β, ρ) and complexity
poly(β).
Proof. We describe the proof for the complex case, and at the end indicate the
changes required for the real version. We treat the case of one cell and briefly
indicate the minor points related to uniformity over families.
Let C := C1..` F. Recall that the last coordinate of f has the form P (z1..` ; z`+1 )
where P is a monic polynomial in z`+1 (say of degree µ) with coefficients holomorphic in Cδ1..` . If F = ∗ then we can just replace z`+1 by zero in the expression above,
so f itself is already prepared. So assume F is of type D, D◦ , A.
Let Σ ⊂ C denote the set critical points of P with respect to z`+1 , i.e.


∂P
(z1..`+1 ) = 0 .
(148)
Σ :=
∂z`+1

COMPLEX CELLULAR STRUCTURES

53

Note that since P is a monic polynomial of positive degree in z`+1 the hypersurface
Σ has zero dimensional fibers over C1..` .
{ρ}
We apply the CPT to C and Σ to obtain a cellular cover {gj : Cj → C{ρ} }
compatible with Σ. If the image of gj is contained in Σ then, since the fibers of Σ
over C1..` are zero dimensional, Cj has type ending with ∗ and in this case f ◦ gj
is already prepared as noted above. It remains to consider the case that the image
of gj is disjoint from Σ. Recall from Remark 66 that gj is a translate in its last
variable w`+1 . Then we have
∂
∂P
(P ◦ gj ) =
(gj (w1..`+1 )) 6= 0
∂w`+1
∂z`+1

(149)

since the image of gj is disjoint from Σ. It will now be enough to prove the lemma
with f replaced by each f ◦ gj as above. In other words we may assume without
loss of generality that Σ = ∅.
Recall that P is bounded in absolute value by some constant N on C{ρ} . Write
D := D(N ) and consider the cell
C̃ := C1..`  D  F

(150)

with coordinates z1..` , w, z`+1 , which also admits a {ρ}-extension. Let Γ ⊂ C̃{ρ} be
the hypersurface given by
Γ := {w = P (z1..` ; z`+1 )}.

(151)
{ρ/µ}
Fαγ
Cα

→ C{ρ} }
We apply the WPT to C̃{ρ} , Γ to obtain a cellular covering {gα :
of C̃ by Weierstrass cells for Γ.
Suppose first that gα (Cα ) ⊂ Γ. Then since Γ has zero-dimensional fibers over
C1..`  D (because P is monic) the type of Cα ends with ∗, and we have
ψα (z1..` , w) := gα (z1..` , w, ∗) = (· · · , w + φα (z1..` ), ζα (z1..` , w))

(152)

where ψα : (Cα )1..` → Γ is a cellular map admitting a {ρ/µ}-extension. Here we
used the fact that gα is a translate in its next to last variable. For later purposes
we set ν(α) = 1.
Suppose now that gα is not compatible with Γ. Then by the definition of a
Weierstrass cell it follows that gα∗ Γ forms a cover of (Cα )1..`+1 . Since we are assuming that Σ = 0, this is a covering map of degree ν(α) 6 µ. Then gα∗ Γ admits ν(α)
multivalued sections. Each section sα,j : (Cα )1..`+1 → gα∗ Γ takes the form
sα,j (z1..` , w) = (z1..` , w, ζ̂α,j (z1..` , w))

(153)

where ζ̂ is ramified of order at most ν(α, j) 6 ν(α) (see Lemma 47). We note that
in the algebraic case, sα,j is algebraic of degree poly` (β) since it is the section of a
hypersurface of complexity poly` (β). In the family case ν(α) and the sections sα,j
vary definably.
We set
Cα,j := ((Cα )1..`+1 )×ν(α,j) .
(154)
Precomposing with Rν(α,j) : Cα,j → (Cα )1..`+1 we obtain a univalued map sα,j ◦
Rν(α,j) : Cα,j → gα∗ Γ and finally composing with gα we obtain a map ψα,j :=
gα ◦ sα,j ◦ Rν(α,j) : Cα,j → Γ of the form
ψα,j (z1..` , w) = (· · · , wν(α,j) + φα,j (z1..` ), ζα,j (z1..` , w)).

(155)

54

GAL BINYAMINI AND DMITRY NOVIKOV

Here again we used the fact that g is a translate in its next to last variable. By
construction ψ admits a {ρ}-extension.
Let β be one of the indices α or (α, j) for the maps ψ constructed in (152),(155).
{ρ}
Set fβ := ((ψβ )1..` , ζβ ) : Cβ → C. Then f ◦ fβ is prepared in its final variable:
indeed, since ψ maps into Γ we have
wν(α) + φβ (z1..` ) = P ((ψβ )1..` (z1..` ), ζβ (z1..` , w)) = (f ◦ fβ )`+1

(156)

{ρ}

for every (z1..` , w) ∈ Cβ . It remains to show that fβ (Cβ ) cover C. But this is clear,
since ψβ (Cβ ) covers C̃ ∩ Γ by construction and the projection of C̃ ∩ Γ to z1..`+1
equals C by our choice of D.
We now consider the real case. We proceed in the same manner up to the
construction of the sections ψα,j . Note that some of these sections may not be
real. However, since the critical locus Σ is empty it follows that on R+ Cα,j the
section ψα,j is either always real or always non-real (real roots of a real holomorphic
function can only leave the real line if they collide). Since we are only interested in
covering R+ Γ we may replace the full set of sections ψα,j by those sections that are
real on R+ Cα,j . With this modification we obtain a real cover of C as required. 
We are now ready to finish the proof of the CPrT by induction: suppose that the
CPrT is already proved for cells of length `, and we will prove it for a cell C := C1..` 
F. By Lemma 67 we may assume that the map f is already prepared in its final
{ρ}
{ρ}
variable. By the inductive hypothesis we can find a cellular cover gj : Cj → C1..`
such that f1..` ◦ gj is prepared. Then ĝj := gj  id : (Cj  (gj∗ F)){ρ} → C{ρ} is a
cellular cover for C with f ◦ ĝj is prepared as required.
9. Analysis on complex cells
In this section we prove some basic estimates on holomorphic functions in complex cells. We also introduce the notion of a quadric cell which allows for some
finer estimates and is used in the construction of smooth parametrizations in the
sequel.
We fix the notation for the remainder of this section. We let C = F1  · · ·  F`
denote a complex cell. As a matter of normalization, we assume that Fj is is one of
the forms ∗, D(1), D◦ (1) or A(rj , 1). Every cell is isomorphic to a cell of this form
by an appropriate rescaling map. We say that such a cell C is normalized. We fix
0 < δ < 1 and assume that C admits a δ-extension.
9.1. Logarithmic derivatives. The following proposition is a cellular analog of
the classical fact that a logarithmic derivative of a holomorphic function admits at
most first order poles.
Proposition 68. Let 0 < δ < 1/8 and let f ∈ Ob (Cδ ) be non-vanishing. Then for
z ∈ C we have


 1 ∂f 
−1


for i = 1, . . . , `.
(157)
 f ∂zi  6 O` (|zi | )
If C, f are algebraic of complexity β then


 1 ∂f 
−1


 f ∂zi  6 poly` (β) · |zi |

for i = 1, . . . , `.

(158)

COMPLEX CELLULAR STRUCTURES

55

P
Proof. By the monomialization Lemma 17 we have log f = k mk log zk + log U
where g = log U is holomorphic and bounded in C1/2 . The derivative of the first
term is bounded by |mi zi |−1 , and in the algebraic case |mi | = poly` (β). It re∂g
mains to give a similar estimate for ∂z
. Since we only care about the derivatives
i
we may, after a translate, assume that the image of g contains 0. Then by the
monomialization lemma in the algebraic case kgkC 1/4 6 poly` (β).
P
Write a decomposition g = σ gσ (z[σ] ) as in Corollary 26,
gσ ∈ Ob (Pδ ),

kgσ kP1/2 = O` (kgkC 1/4 ).

We estimate the derivative by




[σ j ] 
` 
 ∂gσ  X
∂(z
)


j


.
(gσ )0j (z[σ] )
 ∂zi  6

∂zi 

(159)

(160)

j=1



By the Cauchy formula for gσ in P1/2 we see that (gσ )0j P = O` (kgσ kP1/2 ), which
is poly` (β) in the algebraic case.
[σ ]

The derivatives

∂(zj j )
∂zi

are either 0 or 1 for σ j = 1; and either 0 or −ri /z2i or

∂rj
z−1
j ∂zi

for σ = −1. But

 

 ri   ri 1 
−  =  ·  6 |zi |−1 ,
 z2   zi zi 
i


 

 −1 ∂rj   rj 1 ∂rj 
−1
z
= ·

 j ∂zi   zj rj ∂zi  6 K|zi |

(161)

where and the final inequality follows by induction on ` and K = poly` (β) in the
∂g
< K 0 |zi |−1 for an appropriate
algebraic case. From the above we conclude that ∂z
i
0
constant K as claimed.

9.2. Quadric cells. We say that the C cell is quadric if the radii rj (for Fj of
annulus type) have a univalued square root, rj = ρ2j on C1..j−1 . This can also be
stated by saying that the associated monomial of rj has even degrees. We note if
C is quadric then Cδ is quadric as well. We denote by QC the positive quadrant
defined by replacing each fiber Fj = A(rj , 1) in the definition of C by A(ρj , 1). We
denote by Qδ C the cell obtained by taking F̃j = A(rj , δ −1 ). Note that this is the
same as Q(Cδ ) up to renormalizing all outer radii to 1.
Proposition 69. Let C be a cell admitting a δ-extension. Set ν := (2`−1 , . . . , 1).
`−1
Then C×ν is quadric and admits a δ 1/2 -extension.
Proof. If (α1 , . . . , αj−1 ) are the degrees of the associated monomial of rj then the associated monomial of the j-th fiber of C×ν has degrees 2j−` (2`−1 α1 , . . . , 2`−j+1 αj−1 ),
`−1
all of which are even as claimed. The existence of a δ 1/2 -extension is a simple
exercise.

Suppose C is a quadric cell and σ ∈ {−1, 1}` , with negative entries allowed only
for indices j such that Fj is an annulus. We define the inversion map Iσ : C → C
by the identity on coordinates zj with σ = 1 and by rj /zj on coordinates zj with
σ = −1. Using inversions we can prove the following.
Proposition 70. Let C be a real cell admitting a δ-extension. There exists a collection of quadric normalized cells Cj and real cellular maps fj : Cj → Cδ admitting
δ-extensions such that fj (QCj ) covers C and fj (R+ QCj ) covers R+ C. If C is algebraic of complexity β then Cj , fj are algebraic of complexity poly` (β).

56

GAL BINYAMINI AND DMITRY NOVIKOV

Proof. First, by subdividing C using the real CPT we may assume that it admits a
`
δ 2 -extension. Applying Proposition 69 we see that C×ν admits a δ 2 -extension, is
quadric, and after rescaling may also be assumed to be normalized. It will suffice
to prove the claim for C×ν , so henceforth we replace C by C×ν .
We essentially want to use the collection of all the inversion maps Iσ to cover
C by Iσ (QC) and R+ C by Iσ (R+ QC). The minor technical issue is that this does
not cover the equators {zj = ρj }. To avoid this problem, in the case σ = (1, . . . , 1)
we use a slightly larger cell C̃. Namely, we replace each fiber Fj = A(rj , 1) by
F̃j = A(δrj , 1). Since C admits a δ 2 -extension C̃ admits a δ-extension, and now the
equator of C is covered by QC̃.

The following proposition is our principal motivation for introducing the notion
of a quadric cell.
Lemma 71. Let δ < 1/4 and let Cδ be a quadric cell and f ∈ Ob (Cδ ). Then


 ∂f 


for j = 1, . . . , `.
(162)
 ∂zj  6 O` (kf kCδ · δ)
QC
Proof. We assume without loss of generality that kf kCδ = 1. By Corollary 26,
P
f = σ fσ (z[σ] ) with kfσ kP2δ = O` (1). It will suffice to prove the claim for each
of these summands, so fix σ ∈ {−1, 1}` .
If σ j = 1 then
X
∂
1 ∂rk
fσ (z[σ] ) = (fσ )0j (z[σ] ) +
(fσ )0k (z[σ] ) ·
·
.
(163)
∂zj
zk ∂zj
k>j,σ k =−1

By the Cauchy formula
√



(fσ )0j  = O` (δ kfσ k 2δ ) = O` (δ).
P
P

(164)

rk is holomorphic of norm at most 1 in Cδ1..k−1 we have by

 √ √ 

 1 ∂rk 



 = 2 ∂ rk rk  6 O` (δ)
(165)
 zk ∂zj 
 ∂zj zk 
QC
QC
√
where we used the fact that rk /zk < 1 in QC. Combining these estimates we see


that  ∂z∂ j fσ (z[σ] ) = O` (δ).
QC
The case σ j = −1 is similar. We have
X
rj
∂
1 ∂rk
fσ (z[σ] ) = −(fσ )0j (z[σ] ) · 2 +
·
,
(166)
(fσ )0k (z[σ] ) ·
∂zj
zj
zk ∂zj
k>j,σ k =−1
 
r 
which can be estimated in the same manner noting that  zj2  6 1 by definition.

Also, since ρk =
induction

j

QC



9.3. Straightening the positive quadrant. Let C be a normalized quadric cell
admitting a δ = 1/100 extension. To simplify the notations we assume that C
contains no fibers of type D (we can replace each fiber of this type by fibers of type
D◦ and ∗). To further simplify the notation we further assume that C contains no
fibers of type ∗ (if it does then one should add additional single coordinates to B
defined below in order to preserve the cellular structure of the map).

COMPLEX CELLULAR STRUCTURES

57

Denote n := dim C and let B := (0, 1)×n . We define a map h : B → R+ Cδ
inductively by
p
hi (u) = ui + Ri (u1..i−1 ),
Ri := ri ◦ h1..i−1 .
(167)
Here ri denotes the inner radius of Fi if it is of type A, and 0 if it is of type D, D◦ .
Since C is normalized it follows that R+ QC ⊂ h(B) ⊂ Cδ . We think of h as a
straightening of the positive quadrant. Our goal will be to show that h can be
analytically continued to a sector
S` (ε) := {| Arg ui | < ε, |ui | < 2 : i = 1, . . . , `}

(168)

for some positive ε > 0. This will later be used to construct parametrizations of
R+ C with control on derivatives.
Proposition 72. There exists ε > 0 such that h can be analytically extended to
S` (ε) and we have
h(S` (ε)) ⊂ Q1/4 C ∩ {Arg zj 6 π/4 : j = 1, . . . , `}.
Moreover for any j such that Fj is an annulus we have


 ui ∂Rj 


6 M` , i = 1, . . . , `
 Rj ∂ui 
S` (ε)

(169)

(170)

for some M` > 0, i.e. log Rj is a C 1 -bounded function of log u. If C is algebraic of
complexity β then ε−1 , M` = poly` (β).
Proof. By induction on ` we may assume that h1..`−1 extends to S`−1 (ε) for a
sufficiently small ε, that
h1..`−1 (S`−1 (ε)) ⊂ Q1/4 C1..`−1 ∩ {Arg zj 6 π/4 : j = 1, . . . , `},

(171)

and that (170) already holds for R1..`−1 with an appropriate constant M`−1 (as a
shorthand notation we write R1..`−1 to mean only those Rj which are defined, i.e.
such that Fj is an annulus). Our first goal is to prove (170) for R` assuming F` is
an annulus.
Since log R1..`−1 is a C 1 -bounded function of log u1..`−2 we may, taking ε <
π/(4M`−1 ), suppose that on S`−1 (ε) we have
| Arg ui |, | Arg Ri | 6 π/4,

i = 1, . . . , ` − 1.

(172)

Indeed Ri is real on RSi−1 (ε), and since every point of Si−1 (ε) lies at logarithmic
distance at most ε from this real part, it follows that log Ri and in particular Arg Ri
is at distance at most M`−1 · ε from zero. We note that this implies
|ui |, |Ri | 6 |ui + Ri | = |zi |,

i = 1, . . . , ` − 1.

(173)

Now computing the left hand side of (170) with j = ` we have



√
X ∂Rj  1 ∂ √r`
1 ∂ r`
ui ∂R`
= ui √
◦ h1..`−1 + ui
◦ h1..`−1 . (174)
√
R` ∂ui
r` ∂zi
∂ui
r` ∂zj
i<j<`

58

GAL BINYAMINI AND DMITRY NOVIKOV

Figure 7. Analytic continuation of h to S` (ε).
1/4

By (171) the image h1..`−1 (S`−1 (ε)) is contained in C1..`−1 . Applying Proposition 68
and using (173) we have for some K > 0


 
√


 
ui √1 ∂ r` ◦ h1..`−1  6  Kui  6 K
(175)



r` ∂zi
zi 


√
 1 ∂ r`

K
K
√

(176)
 r` ∂zj ◦ h1..`−1  6 |zj | 6 |Rj | .
Plugging into (174) and using the inductive (170) we get






X  ui ∂Rj 
 ui ∂R` 





6 K 1 +
 R` ∂ui 
 Rj ∂ui  6 K 1 + (` − i − 1)M`−1
S`−2 (ε)

(177)

i<j<`

as claimed. In the algebraic case K = poly` (β) and by induction we have indeed
M` = poly` (β).
We now pass to proving that h can be analytically extended to S` (ε), satisfying (169). By assumption h1..`−1 is already extended and satisfies (171). If F` is an
annulus (the other cases are similar but easier) what remains to be verified is that
Rl (u1..`−1 ) + {| Arg u` | < ε, |u` | < 2} ⊂ {|R` | < |z` | < 4}

(178)

for u1..`−1 ∈ S`−1 (ε). Having established (170) for R` , we can now assume that (172)
holds for R` as well (for a sufficiently small ε). Then (178) follows by an elementary
geometric argument illustrated in Figure 7.

Corollary 73. Let S` (ε) be as in Proposition 72. Then the Jacobian of h satisfies



 ∂hi



6 O` (δ).
(179)
 ∂uj − I`×` 
S` (ε)
Proof. By induction on ` we may assume that the Jacobian of h1..`−1 already sat∂h`
isfies the condition. It remains to produce a bound for each ∂u
with j < `. We
j

COMPLEX CELLULAR STRUCTURES

have
∂
∂h`
=
∂uj

√

R` ◦ h1..`−1 )
,
∂uj

59

(180)

and since the√norm of the Jacobian of h1..`−1 is O` (1) it remains to show that the
derivatives ∂∂zRk ` ◦ h are bounded by O` (δ) for k = 1, . . . , ` − 1. Since h(S` (ε)) ⊂
√
Q1/4 C and R` is bounded by 1 in Cδ , this follows from Lemma 71.

The following is a direct corollary of Lemma 71 and Corollary 73.
Corollary 74. Let F ∈ Ob (Cδ ) and let Φ := F ◦ h. Then


 ∂Φ 


< O` (kF k · δ)
i = 1, . . . , `.
 ∂ui 
S` (ε)

(181)

10. Smooth parametrization results
In this section we use complex cells to prove the various refinements of the
Yomdin-Gromov algebraic lemma described in §1.1. All of these results follow
fairly directly from a parametrization result involving functions with a holomorphic
continuation to a complex sector, which we describe first.
10.1. Sectorial parametrizations of subanalytic sets. We say that B ⊂ R` is
a cube if it is a direct product of intervals (0, 1) and singletons {0}. We will say
that a map h : B → R` is cellular if hj depends only on x1..j . The sectorial cube
B(ε) ⊂ C` corresponding to B is the direct product where we replace each interval
(0, 1) by the sector S(ε) := {Arg z < ε, |z| < 2}. We call ε the angle of B(ε).
Theorem 11. Let S ⊂ [0, 1]` be subanalytic. There exists a collection of cubes
B1 , . . . , BN and injective cellular maps φj : Bj → S such that S = ∪j φj (Bj ).
Moreover, there exists ε > 0 such that each φj extends to a holomorphic map
1/2
φj : Bj (ε) → P` with unit C 1 -norm.
If S is semialgebraic of complexity β then we have N, 1/ε = poly` (β).
Proof. Set δ = 1/100 as in §9.3. We begin by applying Corollary 29 in the semialgebraic case or Corollary 30 in the subanalytic case with {ρ} < 1/2 and {σ} < δ,
followed by Proposition 70 to construct a collection quadric normalized cells Cj
1/2
and real cellular maps fj : Cδj → P` such that fj (R+ Cδ ) ⊂ A and fj (R+ QCj )
covers R+ C. By construction each fj is a composition of a prepared cellular map,
a covering map and an inversion maps. Since each of these maps is injective on the
positive real part we see that fj is injective on R+ Cj .
Let hj : Bj (ε) → R+ Cδ be the straightening map constructed for Cj in §9.3 and
set φj := fj ◦ hj . The map hj is cellular and injective by construction, so φj is
cellular and injective on Bj . We have
[
[
A⊂
fj (R+ QCj ) ⊂
φj (Bj ) ⊂ A
(182)
j

j

Finally, by Corollary 74 the C 1 -norm of φj is bounded by O` (1). Making an additional subdivision of Bj into O` (1) parts and rescaling one can make this norm
bounded by 1, thus proving the claim.


60

GAL BINYAMINI AND DMITRY NOVIKOV

Later we will use the Cauchy estimate to pass from the sectorial parametrizations
of Theorem 11 to parametrizations with bounded higher-order derivatives. Toward
this end the following simple combinatorial lemma will be useful.
Proposition 75. Let B(ε) be a sectorial cube and let Φ : B(ε) → C have C 1 -norm
1. There is a decomposition
X
Φ(u) =
ΦI (u)
(183)
I⊂{1,...,`}

where ΦI : B(ε) → C depends on ui : i ∈ I only, vanishes on ∪i∈I {ui = 0} and has
C 1 -norm bounded by O` (1). In particular
|ΦI (u)| 6 O` (min |ui |),
i∈I

for u ∈ B(ε).

(184)

Proof. We proceed by reverse induction on j, defined as the minimal i ∈ {1, . . . , `}
such that Φ depends on uj and does not vanish identically on {uj = 0}. If the
condition defining j is empty then we may take Φ = ΦI where I denotes the set of
indices that Φ depends on. Otherwise write
Φ = (Φ − R) + R,

R(u) = Φ(u1 , . . . , uj−1 , 0, uj+1 , . . . , u` ).

(185)

Since the first summand vanishes on {uj = 0} and the second summand does not
depend on uj we may finish for each of them by induction (the C 1 -norm of the
summands are majorated by 2, 1 respectively).

10.2. The algebraic reparametrization lemmas. We give more detailed statements of the algebraic lemmas in the C r -smooth and mild contexts, and show that
these statements imply the statements appearing in §1.1. Our result in the C r case
is as follows.
Theorem 12. Let X ⊂ [0, 1]` be subanalytic. There exists A > 0, cubes B1 , . . . , BC
and subanalytic injective cellular maps φj : Bj → X whose images cover X, with
kDα φj k 6 α!(Ar)|α| ,

for |α| 6 r.

(186)

If X is semialgebraic of complexity β then A, C = poly` (β) and the maps φj are
semialgebraic of complexity poly` (β, r).
The cellular structure and injectivity of the parametrizing maps implies that
the result of Theorem 12 is automatically uniform over families. Indeed, suppose
X ⊂ Rn+m is a bounded subanalytic set viewed as a family Xp of subsets of Rm .
Construct φ1 , . . . , φN as above. For any p ∈ Rn and any j = 1, . . . , N , the fiber of
m
(φj )−1
1..n (p) is either empty or a cube Bp,j ⊂ R . The φj of the latter type restrict
to parameterizing maps for Xp with the same C r -norm bound (186) (now in m
variables). One can subdivide the domains of the φj into smaller cubes to obtain
a parametrization with unit C r norms. Let µ := dim Xp . Subdividing Bj into
N µ subcubes of side length 1/N and rescaling back to the unit cube gives maps
φj,k : Bj,k → R` with
 |α|
kDα φj,k k
Ar
6
, for |α| 6 r.
(187)
α!
N
Taking N = Ar one obtains unit norms above. This gives the C r statements of §1.1.
Our result in the mild case is as follows.

COMPLEX CELLULAR STRUCTURES

61

Theorem 13. Let X ⊂ [0, 1]` be subanalytic. There exists A < ∞, cubes B1 , . . . , BC
and (A, 2)-mild injective cellular maps φj : Bj → X whose images cover X.
If X is semialgebraic of complexity β then one may take A, C = poly` (β).
As in the case of Theorem 12, the result of Theorem 13 is automatically uniform
over families due to the cellular structure and the injectivity of the maps.
10.3. Proofs of the smooth parametrization results. Let X be as in Theorem 12 or Theorem 13. By Theorem 11 there exists a collection of cubes B1 , . . . , BN
and injective cellular maps φj : Bj → X such that X = ∪j φj (Bj ), and each φj
extends to a holomorphic map φj : Bj (ε) → C` with unit C 1 -norm. Moreover in the
algebraic case N, 1/ε = poly` (β). It will be enough to prove the parametrization
results for each φj (Bj ) separately, so we fix a pair (B, φ) := (Bj , φj ) and proceed
to consider the problem of parametrizing φ(B).
Let Φ denote one of the coordinates of φ and recall that Φ has unit C 1 -norm.
To control higher derivatives we will consider the map φ̃ := φ ◦ S where S is a
“flattening” bijection S : B → B. We will see that an appropriate choice of S (one
for the C r version and another for the mild version) allows one to control the higher
derivatives of Φ ◦ S using the Cauchy estimate.
To simplify the notation, we will suppose below that B is of the form (0, 1)` (in
general the direct product may also contain copies of ∗, but these obviously have
no impact on parametrization questions). We will take Φ to be any function of unit
C 1 -norm in B(ε).
10.3.1. Proof of the C r -parametrization result. Consider the bijection
Pr : B → B,

Pr (w1..` ) = (w1r , . . . , w`r ).

(188)

In the notation of §10.3, Theorem 12 follows from the following lemma.
Lemma 76. The function Φ ◦ Pr is has bounded C r -norm,




|α|
for |α| 6 r.
(Φ ◦ Pr )(α) (w) 6 α! (O` (r/ε))

(189)

Proof. Since Φ extends holomorphically to S` (ε), the composition Φ ◦ Pr extends
holomorphically to
Ω := S` (ε/r) ∩ {|ζi | < 21/r , i = 1, . . . , `}.

(190)

In particular for every w ∈ B it contains the polydisc Dw = {|ξi − wi | 6 (sin rε )wi }.
Denote by SC(Dw ) its skeleton.
Using Proposition 75 we see that
X
X
(Φ ◦ Pr )(α) (w) =
(ΦI ◦ Pr )(α) (w) =
(ΦI ◦ Pr )(α) (w),
(191)
I

supp α⊂I

so it is enough to consider (ΦI ◦Pr )(α) (w) only for those summands with supp α ⊂ I.
Applying the Cauchy formula we have


Z


 
ΦI ◦ Pr (ξ)

 

(α)
−`
Q
dξ
.
.
.
dξ

(ΦI ◦ Pr ) (w) = (2πi) α!
1
`


(ξi − wi )αi +1
SC(Dw )

Y
−α
i
ε
6 α!
wi sin
max |ΦI ◦ Pr (ξ)| . (192)
r
ξ∈SC(Dw )

62

GAL BINYAMINI AND DMITRY NOVIKOV

Figure 8. Reparametrization of S` (ε) in the C r case.
Denote wmin := mini∈I wi . By Proposition 75 we have
r
|ΦI ◦ Pr (ξ)| 6 O` (1) · min |ξir | 6 O` (1) · |wmin
|,
i∈I

r
where in the last inequality we used 1 + sin r < e. Then (192) implies



 −|α|


r−|α|
|α|
α!wmin 6 α! (O` (r/ε))
(ΦI ◦ Pr )(α) (w) 6 O` (1) sin
r
as long as |α| 6 r.

(193)

(194)


10.3.2. Proof of the mild parametrization result. Consider the bijection





1
1
Exp : B → B,
Exp(w1..` ) = exp 1 −
, . . . , exp 1 −
.
w1
w`

(195)

In the notation of §10.3, Theorem 13 follows from the following lemma.
Lemma 77. The function Φ ◦ Exp is (A, 2)-mild,




(Φ ◦ Exp)(α) (w) 6 α!(A|α|2 )|α|

for α ∈ N`

(196)

with A = O` (1/ε).
Proof. Since Φ extends holomorphically to S` (ε), the composition Φ ◦ Exp extends
holomorphically to the domain Ω := Exp−1 S` (ε) and it is easy to check that for
any w ∈ B,
1
Dw := {|ξi − wi | 6 εwi2 } ⊂ Ω.
(197)
2
Denote by SC(Dw ) := {|ξi − wi | = 21 εwi2 } the skeleton of Dw .
Using Proposition 75 in the same way as in §10.3.1 we see that it is enough to
consider (ΦI ◦ Exp)(α) (w) only for those summands with supp α ⊂ I. Applying
the Cauchy formula we have


Z


 
ΦI ◦ Exp(ξ)

 

(α)
−`
Q
dξ
.
.
.
dξ
(ΦI ◦ Exp) (w) = (2πi) α!

1
`


(ξi − wi )αi +1
SC(Dw )
Y  ε −αi
6 α!
wi2
max |ΦI ◦ Exp(ξ)| . (198)
2
ξ∈SC(Dw )

COMPLEX CELLULAR STRUCTURES

63

Figure 9. Reparametrization of S` (ε) in the mild case.
By Proposition 75 we have


|ΦI ◦ Exp(ξ)| 6 O` (1) min exp 1 − ξi−1 
i∈I

6 O` (1)/ exp(max Re ξi−1 ) 6 O` (1)/ exp(max Re wi−1 ), (199)
i∈I

i∈I

−1

where in the last inequality we used the fact that for w < ε ,the mapping ξ →
7 1/ξ
maps the circle {|ξ − w| 6 21 εw2 } inside the circle {ξ − w−1  < 2}.
Denote wmin = mini∈I wi . Then (198) implies




−2|α| − 1
(ΦI ◦ Exp)(α) (w) 6 α!O` (1)(2/ε)|α| wmin e wmin


(200)
2|α| −2|α|
6 α!O` (2/ε)|α| |α|
e
where the final estimate is a simple maximization exercise (with the maximum
1
).

attained at wmin = − 2|α|
10.4. Uniform parametrizations in Ran . In this section we give a proof of
Proposition 2. We begin by proving Lemma 3.
Proof of Lemma 3. It is enough to prove that log ξ has derivative bounded by
4πp(p + 1) in [−1, 1]. Note that log ξ is well defined and p-valent in D(2). Let
r := |(log ξ)0 (z0 )| for some z0 ∈ D(1). By the p-valent analog of the Koebe 1/4theorem log ξ(z0 + D(1)) contains a disc of radius at least 1/4p · r, see [24, Theorem 5.1]. On the other hand, it cannot contain a disc of radius larger than π(p + 1)
since then ξ = elog ξ would not be p-valent. Thus r 6 4πp(p + 1) as claimed.

We now proceed to the proof of Proposition 2. As a first step we will reduce to the
case of a single complex cell. Let GF ⊂ [0, 1]2 × [0, 1]2 denote the graph of F (e, t).
According to Theorem 30 and Remark 31 there exists a collection of prepared
1/4
1/2
1/2
cellular maps fj : Cj → P4 such that fj (R+ Cj ) covers GF and fj (R+ Cj ) ⊂
GF . By Remark 31 we may also assume that fj is compatible with the function e.
Let C denote one of the cells Cj and f := fj . It will be enough to prove that
log[f (R+ C) ∩ {e = e0 }]

(201)

has bounded Euclidean length independent of e0 6= 0.
We first note that since C maps into a graph, its type must end with ∗∗. We
proceed to consider the first two fiber types. If the type of C begins with ∗ then
f (R+ C) meets only one line e = e0 and the length of (201) is bounded by the (finite)
log-length of the hyperbola xy = e0 in [0, 1]2 . Similarly if the type of C begins with
D or A then since fj is compatible with e we conclude that fj (R+ C) meets only
lines e = e0 with e0 bounded away from 0, and the same argument holds. The only

64

GAL BINYAMINI AND DMITRY NOVIKOV

non-trivial case is therefore when the type of C begins with D◦ and f maps this
punctured disc to a disc centered around e = 0.
Let C be of the form C = D◦ (R)  F  ∗  ∗. If F = ∗, then f (R+ C) meets, for
every e0 , only one point in xy = e0 . Otherwise we may write f in the form
(e, t, x, y) = f (ε, τ, ∗, ∗) = (εm , τ n + φ(ε), ξ(ε, τ ), η(, τ )).

(202)

If F = D(r), then the functions ξ(ε, τ ), η(, τ ) are p-valent in τ ∈ D1/2 (r), for
some p uniform over ε ∈ D◦ (R) by subanalyticity of f restricted to C1/2 (see
Proposition 27). The claim then follows from Lemma 3. If F = D◦ (r), then by
removable singularity theorem both ξ(ε, τ ) and η(, τ ) can be extended to D◦ (R) 
D(r), with extensions satisfying the same relation ξ · η = εm for ε ∈ D◦ (R). In
particular, both ξ(ε, τ ) and η(, τ ) do not vanish, and we can proceed as above.
The remaining case is F = A(r1 , r2 ). We now make two reductions. First, we
replace f with
(e, t, x, y) = g(ε, τ, ∗, ∗) = (εm , τ n /r2n (ε), ξ(ε, τ ), η(ε, τ ))

(203)

defined on the same cell. This amounts to an affine transformation of the time
variable. Evidently, the image of ξ, τ is unchanged, and the constant Mr in (3) is
replaced by |r2nr (ε)| Mr , which is again uniformly bounded in ε. Second, we replace
C with C̃ = D◦ (R)  A(r, 1)  ∗  ∗ for r := r1 (ε)/r2 (ε), and replace g with the
composition
(e, t, x, y) = g̃(ε, τ, ∗, ∗) = g ◦ π = (εm , τ n , ξ(ε, τ r2 (ε)), η(ε, τ r2 (ε))) ,

(204)

where π : C̃ → C is the mapping (ε, τ, ∗, ∗) → (ε, τ r2 (ε), ∗, ∗). This only amounts to
a reparametrization of the set g(C) leaving both the image of ξ, η and the bounds
(3) unchanged. Finally by a similar rescaling of ε we may assume that R = 1.
Without loss of generality we return to our original notation, assuming now that
C = D◦ (1)  A(r, 1)  ∗  ∗ and f (ε, τ, ∗, ∗) = (εm , τ n , ξ(ε, τ ), η(ε, τ )).
Decompose η as
η(ε, τ ) = a(ε, τ ) + b(ε, τr ),

(205)
1/2

where both a, b are holomorphic and bounded in a neighborhood of P2 . We have
1−n
∂t = τ n ∂τ and a straightforward induction shows that if ∂tr η is bounded then ∂τr η
is bounded as well. Since ∂τr a is bounded uniformly in ε by the Cauchy estimates
for a, we conclude that ∂τr b(ε, τr ) is also bounded uniformly in ε. We claim that
this is impossible unless b ≡ b(ε) or r ∼ 1. In the former case η itself extends as a
1/2
holomorphic function to P2 and we return to the case of functions on discs treated
above using Lemma 3. In the latter case, we may (for instance following the proof
of the refinement theorem) cover D◦ (1)  A(r, 1) by finitely many cells of the type
D◦ (1)  D(1) return again to the disc case.
It remains to prove our claim above. Let v = τr , so b(ε, v) is holomorphic and
bounded in a neighborhood of P1/2 . Suppose
r(ε) = εm (c + . . . ),
X
b(ε, v) =
ε` b` (v),
`>0

m > 0, c 6= 0
b` ∈ Ob (D

1/2

(206)
),

(207)

COMPLEX CELLULAR STRUCTURES

65

and let `0 be the first index such that b`0 is non-constant. A simple computation
2
using ∂τ = − vr ∂v gives
X
∂τk b(ε, v) =
ε` b̃`,k (v),
(208)
`>`0 −mk

where
 2 k
b̃`0 −mk,k = − vc ∂v b`0 (v) 6≡ 0

(209)

and the final inequality follows since b`0 is non-constant, and the operator (v 2 ∂v )k
does not kill any non-constant holomorphic functions as can be seen by examining
its action on Taylor expansions. For k such that `0 − mk < 0 we see that ∂τk b(ε, v)
has a pole in ε = 0 for any v such that b̃`0 −mk,k (v) 6= 0 and is therefore unbounded
as ε → 0, contradicting our assumption.
Appendix A. Applications in dynamics
YOSEF YOMDIN

A.1. Non-dynamical parametrization results. In this section we present a
non-dynamical result, based on the refined algebraic lemma. This result reduces
the problem of bounding dynamical local entropy (considered in §A.2 below) to a
“combinatorial” analysis of the complexity of long compositions of smooth functions. Set Q := [0, 1]. Our basic unit of complexity is defined as follows.
Definition 78 (k-complexity unit (k-cu)). A k-complexity unit is a map φ : Ql →
Rm with kφkk 6 1. We say that {φq : Ql → Rm } is a k-cu cover of a set A ⊂ Rm
if A is contained in the union of the images of φq .
Theorem 14 below can be considered as a kind of “Taylor formula” for C k parametrizations: it measures the complexity of the graph of a C k -map in terms of
a covering by k-cu’s; exactly as in the usual Taylor formula, the estimates depend
only on the k-th derivative. A result of this type appears (in a weaker form) in
[50, Theorem 2.1]. In [21] it is improved and split into “Main lemma” and “Main
corollary”. Following [21], we split below Theorem 2.1 of [50] into Theorem 14
and Corollary 79, and incorporate other improvements due to Gromov. Below we
denote by Gg the graph of a map g.


Theorem 14. Let g : Ql → Rm be a C k -mapping such that maxx∈Ql dk g  6 M.
Then Gg ∩Ql+m admits a k-cu cover of the form {(φq , g◦φq )} of size polyl,m (k)M l/k .
Proof. Let S := {x ∈ Ql : kg(x)k 6 1}. We subdivide Ql into sub-cubes Qlj of
size γ = (kM 1/k )−1 and parametrize each Qlj by an affine mapping ηj : Ql → Qlj .
The number N1 of the sub-cubes is k l M l/k . Since the k-th derivative
this
 under

parametrization is multiplied by γ k , we get for θj := g ◦ηj the bound dk θj  6 k −k .
Let Pj be the Taylor polynomial of θj of degree k − 1 at the center of Ql . By
the Taylor remainder formula we have
 l

1
d θj − dl Pj  ≤
,
l = 0, . . . , k.
(210)
(k − l)!k k
Put Sj = {x ∈ Ql : ||Pj (x)|| 6 32 }. By (210) we have |θj − Pj | < 12 , and hence the
sets ηj (Sj ) for j = 1, . . . , N1 cover S.

66

GAL BINYAMINI AND DMITRY NOVIKOV

In the next step, which is central for all the construction, we apply the refined
algebraic lemma to the graph of Pj over Sj with smoothness order k. We get kcu’s ψij : Ql → Sj for i = 1, . . . , N2 with the images of ψij covering Sj , such that
Pj ◦ψij are also k-cu’s. Moreover N2 6 polyl,m (k). Now we estimate the derivatives
(θj ◦ ψij )(s) for s = 1, . . . , k, comparing them with the derivatives of Pj ◦ ψij via
the Faà di Bruno formula:
(F ◦ G)(s) =

s
X

Bsl (G0 , G00 , . . . , G(s−l+1) ) · F (l) ◦ G,

(211)

l=1

with Bsl the so-called Bell polynomials, satisfying in particular
Bs :=

s
X

Bsl (1, . . . , 1) < ss .

(212)

l=1

This formula is linear with respect to F , and applying it to F = θj −Pj and G = ψij
we get for s = 1, . . . , k,
|(θj ◦ ψij )(s) − (Pj ◦ ψij )(s) | = |((θj − Pj ) ◦ ψij )(s) | ≤
s
X

(k−l+1)

0
00
Bsl (ψij
, ψij
, . . . , ψij

l=1

) · |(θj − Pj )(l) ◦ ψij | 6

Bs
6 1, (213)
kk

by the bounds (210), and because ψij are k-cu’s. Since Pj ◦ ψij is also a k-cu
we conclude that |(θj ◦ ψij )(s) | 6 2. Therefore, another subdivision of Ql into
sub-cubes of size 12 and the corresponding affine parametrizations of these subcubes reduces the derivative bounds to 1. We denote by {ψi,j,p } the collection of
N1 N2 2l = polyl,m (k)M l/k maps obtained in this way. Set φi,j,p := ηj ◦ ψi,j,p . Then
φi,j,p is a k-cu since ψi,j,p is, and g ◦ φi,j,p = θj ◦ ψi,j,k is a k-cu as shown above. 
Next we modify Theorem 14 to make it suitable to apply to n-fold iterations
f ◦n = f ◦ f ◦ . . . ◦ f . The main reason to separate Theorem 14 from Corollary 79
below is that in the latter it is not enough to assume that ||dk g|| 6 M only for the
highest derivative: we need ||ds g|| 6 M for all s = 1, . . . , k.
Corollary 79. Let g : Ql → Rm be a C k -mapping such that maxx∈B 0 kds gk 6 M
for s = 1, . . . , k. Let σ : Ql → Ql be a k-cu and put h = g ◦ σ. Then Gh ∩ Ql+m
admits a k-cu cover of the form {(φq , h ◦ φq )} of size polyl,m (k)M l/k .
Proof. By the Faà di Bruno formula (211) we have for the k-th derivative of h
k
X

Bkl (σ 0 , σ 00 , . . . , σ (k−l+1) ) · g (l) ◦ σ| < k k M.

(214)

Now we apply Theorem 14 to h, and get the required covering by k-cu’s.



|h(k) | = |(g ◦ σ)(k) | = |

l=1

A.2. Applications to volume growth and entropy. Let Y be a compact mdimensional C ∞ -smooth Riemannian manifold, and let f : Y → Y be a smooth
(at least C 1+µ , with µ > 0) mapping. The topological entropy h(f ) was defined
in §1.3. Below we consider another “entropy-type” dynamical invariant called the
volume growth.

COMPLEX CELLULAR STRUCTURES

67

A.2.1. Volume growth. For σ l : Ql → Y a C k -mapping, and for S ⊂ Ql a measurable subset, let v(σ l , S) denote the l-dimensional volume of the image of σ l (S) in
Y . Put v(f, σ l , S, n) = v(f ◦n ◦ σ l , S), and put
v(f, σ l , S) = lim sup
n→∞

1
log v(f, σ l , S, n),
n

v(f, σ l ) = v(f, σ l , Ql ).

(215)

Finally, we put
vl,k (f ) = sup v(f, σ l ),

vk (f ) = max vl,k (f ),
l

σl

v(f ) = v∞

(216)

where the supremum is taken over all C k maps σ l : Ql → Y . An important inequality obtained by Newhouse in [34] connects the volume growth to the topological
entropy,
h(f ) 6 v(f ).
(217)
The inverse inequality is not always true, but the question of its validity is important
in many dynamical applications. In particular, as it was explained in §1.3.3, this
inverse inequality implies Shub’s entropy conjecture. In order to analyze its validity
we define a δ-local volume growth at x ∈ Y as
1
log v(f, σ l , Bδn (x), n) (218)
vl,k (f, δ, x) = sup v(f, σ l , Bδn (x)) = sup lim sup
n
n→∞
σl
σl
where Bδn (x) is the δ-ball around x in the n-th iterated metric dn . The quantity
vl,k (f, δ, x) measures the exponential rate of volume growth of the part of the images
of f ◦n ◦ σ l which always stay at a distance at most δ from the orbit of f ◦n (x) for
n → ∞. Finally, we put
vl,k (f, δ) = sup vl,k (f, δ, x),
x∈Y

0
vl,k
(f ) = lim vl,k (f, δ).
δ→0

(219)

The δ-tail entropy can be also be defined in an analogous manner setting h∗ (f, δ, x) =
h(f, Bδn (x)) and h∗ (f, δ) := supx∈Y h∗ (f, δ, x). There is a version of Newhouse’s inequality (217) for these invariants.
A.2.2. Local volume growth and entropy. The following partial inverse to (217) is
almost immediate:
vl,k (f ) 6 h(f, δ) + vl,k (f, δ).
(220)
Indeed, h(f, δ) counts the minimal number of the balls Bδn (x) covering Y , while
vl,k (f, δ) bounds the volume growth on each of these balls. As δ → 0 we obtain the
bound
0
vl,k (f ) 6 h(f ) + vl,k
(f ).
(221)
0
Thus the inverse to the Newhouse inequality is satisfied if vl,k
(f ) = 0. Our first
goal is to establish the following result.
0
Theorem 15 ([50]). If f : Y → Y is C ∞ -smooth then vl,k
(f ) = 0.

A.2.3. Local C k -complexity growth. From now on we concentrate on bounding from
above the local volume growth vk,l (f, δ, x) for a given x ∈ Y . For this purpose we
define yet another entropy-like invariant hl,k (f, δ, x), which measures the “local
C k -complexity growth” in a δ-neighborhood of the orbit of x (cf. [21, 51]):
hl,k (f, δ, x) = sup lim sup
σl

n→∞

1
log Nk (f, σ l , δ, x, n),
n

(222)

68

GAL BINYAMINI AND DMITRY NOVIKOV

where σ l : Ql → Y varies over all C k -smooth mappings and Nk (f, σ l , δ, x, n) is the
minimal number of k-cu’s ψj : Ql → Ql , whose images cover (σ l )−1 (Bδn (x)), and
for which f ◦n ◦ σ l ◦ ψj are k-cu’s.
An almost immediate fact is that
vl,k (f, δ, x) 6 hl,k (f, δ, x).

(223)

Indeed, since f ◦n ◦ σ l ◦ ψj are k-cu’s, the l-volume of their image does not exceed
a certain constant depending only on l, m and hence
vl,k (f, σ l , Bδn (x), n) 6 Om (Nk (f, σ l , δ, x, n))

(224)

As n → ∞ in (215) and (222) the asymptotic constant disappears. Thus it remains
to bound from above hl,k (f, δ, x).
Below the derivatives of f : Y → Y , and their norms, are defined via the local
coordinate charts on Y .
Proposition 80. Assume that for certain positive constants L, M the inequalities
1

max kds f k s−1 6 M

kdf k 6 L,

(225)

s=2,...,k

are satisfied. Then for each x ∈ Y and for each δ 6 M −1 we have
hl,k (f, δ, x) 6

l log L
+ log polym (k).
k

(226)

Proof. Using the local coordinate charts at the points x, f (x), f ◦2 (x), . . . of the orbit
of x under f , we replace iterations of f with compositions of a non-autonomous
sequence F of mappings fi : B1m → Rm with fi (0) = 0, where B1m is the unit ball
in Rm , centered at the origin.
Fix δ 6 M −1 , and consider the concentric ball Bδm ⊂ B1m . Let η : B1m → Bδm be
a linear contraction η(x) = δx. We consider instead of the sequence F of mappings
fi a sequence F̄ of δ-rescaled mappings f¯i = η −1 ◦ fi ◦ η : B1m → Rm . For the
derivatives we have ds f¯i = δ s−1 ds fi , and by the assumptions we get
||df¯i || 6 L,

max ||ds f¯i || 6 1.

(227)

s=2,...,k

Thus δ-rescaling “kills” all the derivatives of fi , starting with the second one. The
first derivative (having a dynamical meaning) does not change.
We have to estimate the number N̄k,n := Nk (F̄, σ l , 1, 0, n), which, by an evident
change of notations, is the minimal number of k-cu’s ψj : Ql → Ql , whose images
cover (σ l )−1 (B̄1n (0)), and for which f¯n ◦ f¯n−1 ◦ . . . ◦ f¯1 ◦ σ l ◦ ψj are k-cu’s.
We will prove via induction by n that
nl

N̄k,n ≤ L k C n

(228)

where C = polym (k) is the constant from Corollary 79. Assume that (228) is valid
for n. To prove it for n + 1 we use Corollary 79. We apply it to g = f¯n+1 and to
each k-cu ν of the form
ν = f¯n ◦ f¯n−1 ◦ . . . ◦ f¯1 ◦ σ l ◦ ψj ,

(229)
l
k

obtained in the n-th step. For each ν we get at most N = CL new k-cu’s
φq : Ql → Ql whose images cover (σ l )−1 (B̄1n+1 (0)), and for which the compositions

COMPLEX CELLULAR STRUCTURES

69

f¯n+1 ◦ ν ◦ φq are also k-cu’s. By the induction assumption, the number N̄k,n of the
nl
k-cu’s ν is at most L k C n . Therefore
l

N̄k,n+1 6 N̄k,n N 6 N̄k,n CL k 6 L

(n+1)l
k

C n+1 .

(230)

This completes the induction, proving (228) for n ∈ N. Taking log and dividing by
n finishes the proof.

To finish the proof of Theorem 15 we should eliminate the extra term log polym (k)
in (226). We do this by replacing f by its iterate f ◦q for some sufficiently large q.
Let f be as in Proposition 80. For each q ∈ N the first derivative of f ◦q is
bounded by Lq . Denote by Mq a constant satisfying
1

max ||ds f q || s−1 6 Mq .

s=2,...,k

(231)

The constants Mq can be estimated from L, M using Faà di Bruno formula (see,
e.g. [14]). We do not provide here an explicit expression, since below, for analytic
f , we get it in a much easier way. Using the equality hl,k (f ◦q , δ, x) = qhl,k (f, δ, x)
and applying Proposition 80 to f ◦q we obtain the following result, which contains
Theorem 15.
Corollary 81. For each δ 6 1/Mq we have
hl,k (f, δ, x) 6

l log L log polym (k)
+
.
k
q

(232)

In particular, for q → ∞ and δ → 0,
0
vl,k
(x) 6 h0l,k (x) 6

l log L
,
k

0
vl,∞
(x) = h0l,∞ (x) = 0.

(233)

A.2.4. Volume growth for analytic maps. Now we show, following [14] how the
Corollary 81 can be used to provide an explicit bound for the local volume growth
log k
and local entropy. Setting q(k) = Om (1)· kl log
L we immediately obtain the following.
Corollary 82. For each δ ≤ δ(k) =

1
Mq(k)

we have

hl,k (f, δ, x) 6

2l log L
.
k

(234)

For C ∞ functions f Corollary 82 reduces the problem of estimating the asymptotic behavior of hl,k (f, δ) as δ → 0 to the problem of estimating the high-order
derivatives of f ◦q(k) . We find it explicitly for analytic f , referring the reader to
[14], where a much more general setting is presented.
Let Y ⊂ Rp be a compact m-dimensional real analytic submanifold, and let
f : Y → Y be a real analytic mapping. We assume that f is extendible to a
complex analytic mapping f˜ : U → Cp in a neighborhood U of Y in Cp of size
ρ. More accurately, for each point x ∈ Y the complex polydisc at x of radius ρ
is contained in U . We assume that the norm ||f˜|| is bounded by D in U , and the
norm of its first derivative ||df˜|| is bounded there by L. The following theorem
immediately implies the statement about volume growth in Theorem 5 since the
volume of the image of a k-cu is universally bounded; the statement about tail
entropy follows similarly but we omit the details.

70

GAL BINYAMINI AND DMITRY NOVIKOV

Theorem 16. For f as above, for each x ∈ Y , and for all k sufficiently big we
have
log | log δ|
hl,k (f, δ, x) 6 Om (log L) ·
.
(235)
| log δ|
Proof. Since, by the assumptions, ||df˜|| 6 L, this complex mapping can expand
distances at most L times. Therefore, the q-th iterate f ◦q is extendible to at least
a complex neighborhood Uq of Y of the size Lρq , and it is bounded there by D.
Applying Cauchy formula, we conclude that for each x ∈ Y we have
 q s


L
 s ˜◦q 
6
Ds!
f
,
s = 0, 1, 2, . . .
(236)

d
ρ
Therefore



Lq
 s ˜◦q 1/s
6 D1/s · s ·
,
s = 0, 1, 2, . . .
d f 
ρ
In particular, for s = 0, 1, 2, . . . , k we have


DkLq
 s ˜◦q 1/s
6
= 2Om (k log k)
d f 
ρ

(237)

(238)

for k sufficiently big. Therefore Mq(k) = 2Om (k log k) (note that the difference between the 1/s and 1/(s − 1) power is absorbed into the asymptotic constant), and
Corollary 82 applies with δ = 2−Om (k log k) . Solving for fixed δ, we see that Corollary 82 applies with


| log δ|
k = Ωm
.
(239)
log | log δ|
With this k, Corollary 82 gives
hl,k (f, δ, x) 6

2l log L
log | log δ|
= Om (log L) ·
.
k
| log δ|

as claimed.

(240)


Appendix B. Applications in diophantine geometry
For p ∈ P` (Q) we define H(p) to be maxi |pi | where p ∈ Z`+1 is a projective
representative of p with gcd(p0 , . . . , p` ) = 1. For x ∈ A` (Q) we define its height to
be the height of ι(x) for the standard embedding
ι : A` → P` ,

ι(x1..` ) = (1 : x1 : · · · : x` ).

(241)

X(Q, H) := {x ∈ X ∩ P(Q)` : H(x) 6 H},

(242)

`

For a set X ⊂ P (R) we denote
`

and similarly for X ⊂ R .
In [9] Bombieri and Pila introduced a method for studying the quantity #X(Q, H)
as a function of H when X is the graph of a C r (or C ∞ ) smooth function f : [0, 1] →
R. It turns out that two very different asymptotic behaviors are obtained depending on whether the graph of f belongs to an algebraic plane curve. The YomdinGromov algebraic lemma has been used in both of these directions, to generalize
from graphs of functions to more general sets. In §B.1 we give a complex-cellular
analog of the Bombieri-Pila determinant method. We then present an application
in the algebraic context in §B.2 and in the transcendental context in §B.3.

COMPLEX CELLULAR STRUCTURES

71

B.1. The Bombieri-Pila method for complex cells. The Bombieri-Pila method
is based on a clever estimate for certain interpolation determinants of a collection
of functions, which is obtained using Taylor expansions. In this section we develop a parallel theory over complex cells, replacing Taylor expansions by Laurent
expansions.
B.1.1. Interpolation determinants. Let µ ∈ N. Let f := (f1 , . . . , fµ ) be a collection
of functions with a common domain U and p := (p1 , . . . , pµ ) ∈ U µ a collection of
points. For minor technical simplifications we will assume that f1 ≡ 1.
We define the interpolation determinant
∆(f ; p) := det(fi (pj ))16i,j6µ .

(243)

The key to the Bombieri-Pila [9] is an estimate for the interpolation determinant
assuming that f are sufficiently smooth and p are contained in a sufficiently small
ball. In our complex analytic analog the small ball will be replaced by a cell C with
a δ-extension and the smoothness assumption will be replaced by boundedness in
Cδ .
Let C be a complex cell and let m 6 dim C denote the number of D-fibers. Set
m
(m!)1/m .
(244)
E = E(m) :=
m+1
1+1/m

Fix 0 < δ < 1/2, and let δ be given by δ in the D-coordinates and δ Eµ
A, D◦ coordinates.

in the

Lemma 83. With Cδ as above, suppose f1 , . . . , fµ ∈ Ob (Cδ ) with diam(fi (Cδ ), C) 6
M and p1 , . . . , pµ ∈ C. Then
|∆(f ; p)| 6 M µ µO` (µ) δ Eµ

1+1/m

+O` (µ)

.

(245)

4

When m = 0 the bound above holds if we replace m = 0 by m = 1.
Proof. Since f1 ≡ 1 the interpolation determinant is unchanged if we replace each
fj by fj − const for j > 2. In this way we may assume without loss of generality
that kfi kCδ 6 M . We may also assume by rescaling that M = 1.
Write a Laurent expansion


X
fi (z) = 
ci,α z[α]  + Ri (z)
(246)
α∈Z` ,|α|<Eµ1+1/m

and note that by Proposition 25 we have |ci,α | < δ pos α and
X
X
1+1/m
kRi kC 6
δ pos α 6
(2k + 1)` δ k = O` (µ2` )δ Eµ
|α|>Eµ1+1/m

(247)

k>Eµ1+1/m

where the final two estimates are elementary and left to the reader. We expand
the determinant ∆(f , p) multilinearly into µO` (µ) determinants ∆I where each fi
is replaced by one of the summands in (246). We may consider only those ∆I
where each normalized monomial appears at most once: otherwise the determinant
has two identical columns. We claim that each such ∆I is majorated in C by
1+1/m
µO` (µ) δ Eµ
.
Consider first the case that ∆I contains a residue Ri or one of the coefficients ci,α
where α contains a non-vanishing A, D◦ coordinate. Expand ∆I into µ! summands.
4In fact one can easily derive better estimates in this case but this is not needed in this paper.

72

GAL BINYAMINI AND DMITRY NOVIKOV

Each summand contains either a term Ri (pj ) or ci,|α| as above, and the estimate
then follows from (247) or from our assumption on δ.
The remaining determinants ∆I involve only the m variables of type D, which
we assume for simplicity of the notation are given by z1..m . We expand ∆I into a
µ! summands. Each summand is a product
1

µ

c1,α1 z[α ] · · · cµ,αµ z[α ] ,

α1 , . . . , αµ ∈ N m

(248)

with distinct P
αj . By the estimate on the Laurent coefficients this summand is
j
bounded by δ i,j αi . Let Lm (k) denote the number of monomials of degree k in m
variables. The minimal term δ q will clearly be obtained if we choose Lm (0) of the
j
α
Pνs of degree 0, Lm (1) of degree
Pν 1 and so on. Let ν be the largest integer satisfying
L
(k)
6
µ.
Then
q
>
m
k=0
k=0 Lm (k) · k. Simple computations give
Lm (k) =

k m−1
+ Om (k m−2 )
(m − 1)!
νm
µ=
+ O(ν m−1 )
m!

k
X

Lm (j) =

j=0

km
+ Om (k m−1 )
m!

(249)

ν = (m!µ)1/m + O(1)

and finally q = Eµ1+1/m + O(µ) as claimed.



Lemma 83 gives essentially the same estimate as the classical Bombieri-Pila
method, but with dimension m instead of dim C. The key point is that for δ corresponding to {ρ}-extensions with ρ  1 the D◦ , A-coordinates have order 2−1/ρ
(compared with order ρ for the D coordinates), which allows us to produce cellular
covers satisfying the conditions of Lemma 83. Roughly one may say that the punctured discs and annuli that we produce are so thin that they may be ignored for
the purposes of the Bombieri-Pila method. More accurately we have the following
version of the refinement theorem
Lemma 84. Let C1/2 be a (real) complex cell with m coordinates of type D. Let
µ ∈ N and 0 < δ < 1, and define δ as in Lemma 83. Then there exists a (real)
cellular cover {fj : Cδj → C1/2 } of size
(
poly` (µ log(1/δ)) · δ −2m for complex covers
(250)
N=
poly` (µ log(1/δ)) · δ −m for real covers
where each fj is a cellular translate map.
If C varies in a definable family (and σ, ρ vary under the condition 0 < σ < ρ <
∞) then the cells Cj and maps fj can also be chosen from a single definable family.
If C is algebraic of complexity β then Cj , fj are algebraic of complexity poly` (β).
1+1/m

Proof. In the D◦ , A coordinates δ has value δ Eµ
. We begin by constructing,
{ρ}
using the refinement theorem, a cellular cover {gj : Cj → C1/2 } with 2−1/ρ =
1+1/m

O` (δ Eµ
). The size of this cover is poly` (µ log δ). We now fix some g = gj . It
{ρ}
will be enough to construct a cellular cover {fj : Cδj → Cj } of size O` (δ −m ) where
each fj is as in the conclusion of the lemma. Since each D◦ , A coordinate already
has the desired extension, we need only refine the D fibers to achieve a δ-extension.
This is elementary: after rescaling each D-fiber to D(1) we simply cover D(1) (resp.
(−1, 1)) by δ 2 (resp. δ) discs (resp. real discs) of radius δ.


COMPLEX CELLULAR STRUCTURES

73

B.1.2. Polynomial interpolation determinants. Let Λ ⊂ N` be a finite set and set
d := maxα∈Λ |α| and µ := #Λ. For minor technical simplifications we assume
0 ∈ ∆. Let f := (f1 , . . . , f` ) be a collection of functions with a common domain
U and p := (p1 , . . . , pµ ) ∈ U µ a collection of points. We define the polynomial
interpolation determinant
∆Λ (f ; p) := ∆(g; p),

g := (f α : α ∈ Λ).

(251)

Basic linear algebra shows that for S ⊂ U the set f (S) ⊂ C` belongs to a hypersurface {P = 0} with supp P ⊂ Λ if and only if ∆Λ (f ; p) vanishes for any p ⊂ S of
size µ.
The following is due to Bombieri and Pila [9].
Lemma 85. Let H ∈ N and suppose H(f (pj )) 6 H for any i = 1, . . . , ` and
j = 1, . . . , µ. Then ∆Λ (f ; p) either vanishes or satisfies
|∆d (f ; p)| > H −µd .

(252)

Proof. Let Qj 6 H denote the common denominator of f (pj ). The row corresponding to pj in ∆Λ (f ; p) consists of rational numbers with common denominator
dividing Qdj . Factoring this common denominator from each row we obtain a matrix with integer entries whose determinant is either vanishing or an integer. In the
latter case
µ
Y
−µd
|∆Λ (f ; p)| >
Q−d
.
(253)
j >H
j=1


B.2. Rational points on algebraic hypersurfaces.
B.2.1. Previous work. Let X ⊂ P2 (C) be an irreducible curve of degree d. Let
f : I → X be a C r -smooth function with kf kr 6 1 and write Xf := f (I). Pila [36]
proves, using a generalization of the method of [9], that for a sufficiently large
r = r(d) one has #Xf (Q, H) = Oε,d (H 2/d+ε ) for any ε > 0.
If one allows r = r(d, H), for instance if f is C ∞ smooth, then the BombieriPila method can be pushed further to replace H 2/d+ε by H 2/d logk H for some
k > 0. The study of #X(Q, H) is therefore directly related to the C r parameterization complexity of X in the sense of the Yomdin-Gromov algebraic lemma.
Using an explicit parameterization construction Pila [40] proved that #X(Q, H) 6
(6d)10 4d H 2/d (log H)5 .
In [25] Heath-Brown has developed a non-Archimedean version of the BombieriPila method and used it to derive the estimate #X(Q, H) = Oε,d (H 2/d+ε ). This
was later improved (in arbitrary dimension `) by Salberger [45] to O`,d (H 2/d log H)
and very recently by Walsh [48] to O`,d (H 2/d ).
For a general irreducible variety X ⊂ P(C)` of dimension m, Broberg [12, Theorem 1] (generalizing a result of Heath-Brown [25]) has proved that X(Q, H) is
−1/m
+ε
contained in O`,d,ε (H (m+1)d
) hypersurfaces {Pi = 0}, which have degrees
O`,d,ε (1) and which do not contain X. Intersecting X with each of the hypersurfaces one obtains varieties of dimension m − 1, and could potentially proceed by
induction to eventually obtain estimates on #X(Q, H). Marmon [30] has recovered
this result using the Bombieri-Pila method by appealing to the Yomdin-Gromov
algebraic lemma.

74

GAL BINYAMINI AND DMITRY NOVIKOV

B.2.2. Proof of Theorem 6. In this section we will prove Theorem 6 using the
complex-cellular version of the Bombieri-Pila method. We remark that a result
similar to Theorem 6 could probably also be proved by following the argument of
[30] and replacing the Yomdin-Gromov algebraic lemma by our refined version.
We will work in the affine setting. Let ιj denote the j-th standard chart x1..` →
(· · · : xj : 1 : xj+1 : · · · ). If z = (z0 : · · · : z` ) ∈ P` (C) with |zj | maximal then in the
ιj -chart z corresponds to a point x ∈ P̄` , and moreover H(z) = H(x). We assume
without loss of generality that j = 0. Below x denotes the affine coordinates in this
chart. It will suffice to count the points of height H in P̄` ∩ ι−1
0 (X).
We fix some degree-lexicographic monomial ordering on C[x1..` ] and let Λ :=
N` \ LT(I) where I ⊂ C[x1..` ] denotes the ideal of X and LT(I) the set of leading
terms of I with respect to the fixed ordering. Set Λ(k) := Λ ∩ {|α| 6 k}. Then
µ(k) := #Λ(k) is the Hilbert function of X. This function eventually equals the
Hilbert polynomial, and by Nesterenko’s estimate [33] we have

 

k+m+1
k+m+1−d
µ(k) >
−
= dk m /m! + polym (d)k m−1 .
(254)
m+1
m+1
We will apply the Bombieri-Pila method with Λ(k) interpolation determinants.
1/2
Let C ⊂ P` be a complex cell as in Lemma 83 and let p ⊂ C(Q, H). Then by
Lemmas 83 and 85 we have
1+1/m

H −µk 6 |∆Λ(k) (x; p)| 6 2µ µO` (µ) δ Eµ

+O` (µ)

(255)

Λ(k)

unless ∆
(x; p) = 0. Note that in the right hand side of (255), Lemma 83 gives
the estimate with m equal to the number of disc fibers in C (which is at most dim C),
and this implies the same estimate with m = dim X. Thus unless ∆Λ(k) (x; p) = 0
we have, for k > polym (d),
−k log H − O` (1)
−O` (log µ) − k log H
=
=
Eµ1/m + O` (1)
Eµ1/m + O` (1)
m+1
m + 1 log H
−k log H − O` (1)
=−
· 1/m
· 1/m (1 + poly` (d)/k). (256)
m
m
kd
(1 + polym (d)/k)1/m
d
Therefore, for
m+1 −1/m
(1+poly` (d)/k)
(257)
δ = H− m d
Λ(k)
we have ∆
(x; p) = 0 for any p as above, and C(Q, H) is therefore contained in a
hypersurface {P = 0} satisfying supp P ⊂ Λ(k). In particular P is of degree at most
1/2
k and does not vanish identically on X. It remains to show that RP` ∩ι−1
0 (X) can
−m
be covered by δ
poly(µ log(1/δ)) real cells satisfying the conditions of Lemma 83.
1/2
For this we first use the CPT to construct a real cover of R(P` ∩ ι−1
0 (X)) of size
poly` (β) admitting 1/2-extensions, and then apply Lemma 84 to further refine each
of the cells to satisfy the conditions of Lemma 83.
log δ >

B.3. Rational points on transcendental sets.
B.3.1. Log-sets in diophantine applications of the Pila-Wilkie theorem. In some of
the most remarkable applications of the Pila-Wilkie theorem, particularly those
related to modular curves and more general Shimura varieties, it is necessary to
count rational points on sets that are definable in Ran,exp but not in Ran . We briefly
recall the most standard example coming from the universal covers of modular
curves.

COMPLEX CELLULAR STRUCTURES

75

Recall that the universal covering map j : H → SL2 (Z)\H ' C can be factored as
a composition j(τ ) = J(q) where q = e2πiτ and J(q) : D◦ (1) → C is meromorphic
in a neighborhood of q = 0. We extend j, J as a function of several variables
coordinate-wise, and denote by Ω ⊂ Hn the (coordinate-wise) standard fundamental
domain for j. In [43] a key step is the application of the Pila-Wilkie theorem to sets
of the form Y := Ω ∩ j −1 (X) where X ⊂ Cn is an algebraic variety. This set is not
(in general) subanalytic: it is of the form Y = log A where log(·) = (2πi)−1 loge (·)
and A := J −1 (X). Note that since J is meromorphic the set A is subanalytic, so
that Y is a log-set.
B.3.2. An interpolation result for logarithms of complex cells. Let Cδ/2 be a complex
cell as in Lemma 83, and let n := dim C and m denote the number of fibers of type
D. Let f := (f0 , . . . , fn ) be a tuple of non-vanishing holomorphic functions on Cδ/2 .
We write x0..n = log f0..n and denote X := x(C).
Recall that π1 (C) ' Zn−m , so we may take α(fj ) ∈ Zn−m for j = 0, . . . , n.
Then there exist m + 1 vectors γ 0 , . . . , γ m ∈ Zn+1 linearly independent over Z and
P k
Q γk
satisfying
γ j α(fj ) = 0. We write gk = j fj j . Then g0..m are non-vanishing
holomorphic functions on Cδ/2 with trivial associated monomials. Then the logarithms y0..m := log g0..m , which are Z-linear combinations of the x-variables, are
holomorphic univalued functions in Cδ/2 .
Proposition 86. Let H ∈ N. If
log δ < −Of (k −1/m log H)

(258)

then X(Q, H) is contained in an algebraic hypersurface {P (y) = 0} of degree at
most k in Cn+1 .
If C, f vary over a definable family such that the type of C and the associated
monomials of f0..n are fixed then the asymptotic constants can be taken uniformly
over the family.
Proof. Since y are fixed Z-linear combinations of x we have H(y) = Of (H(x)).
Thus it will be enough to prove the statement for Y (Q, H) instead of X(Q, H)
where Y := y(C).
By the monomialization lemma the diameter of yj (Cδ ) is bounded in C for j =
0, . . . , m by some quantity M = Of (1) which can be taken uniform over definable
families. We are thus in position to apply Lemma 83 with
Λ(k) = {α ∈ Nm+1 : |α| 6 k},

µ(k) ∼ k m+1 .

(259)

Let p ⊂ Y (Q, H). Then by Lemmas 83 and 85 we have
H −µk 6 |∆Λ(k) (y; p)| 6 M µ µO` (µ) δ Eµ

1+1/m

+O` (µ)

(260)

unless ∆Λ(k) (x; p) = 0. In the former case we have
log δ >

−Og (k log H)
= −Og (k −1/m log H).
k 1+1/m + O` (1)

(261)

Therefore, for δ satisfying (258) we have ∆Λ(k) (y; p) = 0 for any p as above,
and Y (Q, H) is indeed contained in a hypersurface of degree at most k in the
y-variables.


76

GAL BINYAMINI AND DMITRY NOVIKOV
1/2

Remark 87 (Logarithms in families). We remark that if gλ : Cλ → C \ {0} is a
definable family of functions with trivial associated monomials then log gλ : Cλ → C
is not necessarily definable (in Ran ) as illustrated by the example gλ ≡ λ for λ ∈
(0, 1]. However, if we define g̃λ = gλ / kgλ kCλ then log g̃λ is definable. Indeed by
the monomialization lemma we know that w = log g̃λ (C) ⊂ D(M + 2π) for some
uniformly bounded M . Then the graph of a (univalued) branch of log g̃λ is definable,
being one of the components of the definable set ew = g̃λ (z) with w ∈ D(M ) and
z ∈ Cλ (note that the exponential here is restricted to a compact set).
B.3.3. Proof of Proposition 5. We apply Corollary 30 to the subanalytic set given by
the total space X ⊂ RK of the family {Xλ }, where we order the parameter variables
1/2
1/2
before the fiber variables. We obtain real cellular maps fj : Cj → PK such
1/2

that fj (R+ Cj ) ⊂ X and ∪j fj (R+ Cj ) = X. We may also require by Remark 31
that each fj is compatible with the fiber variables x1..` . It will be enough to
prove the statement for each fj (R+ Cj ) separately, so fix C, f = Cj , fj and assume
X = f (R+ C).
We view C as a subanalytic family of cells Cλ of length `. If the type of Cλ has
dimension strictly less then n then we can take Y = X, so assume it has dimension
n. Below we let f0..n denote the f -pullback of some fixed n+1-tuple of the variables
x1..` . Note that the associated monomials α(fj ) of fj on Cλ are independent of λ (it
is obtained from the associated monomial of fj on C by eliminating the λ variables).
Let R = {fλ,θ : Cλ,θ → Cλ } denote the refinement family consisting of the
refinement cells of Cλ as in Lemma 84. We split R into subfamilies R(T) consisting
of the cells Cλ,θ of type T. According to Remark 42 the types T are those obtained
from the type of Cλ by possibly replacing some D◦ , A fibers by D. Fix some T and
∗
let m denote the number of fibers of type D. The associated monomial of fλ,θ
fj
is constant over R(T): it is obtained from α(fj ) by eliminating those indices that
correspond to fibers that were replaced by D in T.
∗
We can thus apply Proposition 86 to fλ,θ
f0..n to deduce that if the cell Cλ,θ
admits δ/2 extension and if δ = H −OX (k

−1/m

)

then

[xλ,θ (Cλ,θ )](Q, H) ⊂ {P (yλ,θ ) = 0}

(262)

for some polynomial P (yλ,θ ) of degree k, where yλ,θ are some fixed Z-linear combiδ/2
∗
nations of xλ,θ := log(fλ,θ
f0..n ) which are holomorphic in Cλ,θ . Note that yλ,θ does
not necessarily depend definably on the parameters. However, the normalized ỹλ,θ
defined by replacing xλ,θ with their normalized versions x̃λ,θ is definable according
to Remark 87. For each fixed value of the parameters we have ỹλ,θ = yλ,θ + const,
and in particular the hypersurface {P (yλ,θ ) = 0} can be rewritten as a hypersurface
{P̃ (ỹλ,θ ) = 0} in the ỹλ,θ -variables.
We now define a family Ỹλ,θ,c with the parameter θ of Rλ,θ and the parameter c
encoding the coefficients of an arbitrary non-zero polynomial Pc of degree k,
Ỹλ,θ,c := R(fλ,θ (Cλ,θ ) ∩ {Pc (ỹλ,θ ) = 0}).

(263)

For any λ we can choose, according to Lemma 84 a collection of
N = poly` (δ) = H −OX (k

−1/n

)

(264)

COMPLEX CELLULAR STRUCTURES

77

cells Cλ,θj which admit δ-extensions, satisfy the conditions of Lemma 83, and
cover Cλ . For each of them there exists a polynomial Pcj (ỹλ,θj ) whose zeros contain [xλ,θ (Cλ,θ )](Q, H). The union over j = 1, . . . , N of log Ỹλ,θj ,cj thus contains
(log Xλ )(Q, H).
Recall that Ỹ was constructed for some choice of n + 1 of the coordinates x1..` .
We now repeat this construction for each such choice S. We now define a family
Ŷλ,µ with the parameters µ encoding the pair θS , cS for each of the choices S,
\
Ŷλ,µ =
Ỹλ,θS ,cS .
(265)
S
−1/n

)
As before, for every λ there is a choice of N = H −OX (k
parameters µj such
that the union (log Ŷλ,µj )(Q, H) contains (log Xλ )(Q, H).
If Ŷλ,µ has dimension n then Xλ satisfies a polynomial equation of degree k in
log f0..n for every n + 1 tuple of coordinates f0..n among x1..` and in this case log Xλ
is contained in an algebraic variety of dimension n. Since Xλ has pure dimension
n this implies that (log Xλ )trans = ∅. Thus if we define Y by removing from Ŷ any
fibers of dimension n, the conditions of the proposition are satisfied.

References
[1] R. L. Adler, A. G. Konheim, and M. H. McAndrew. Topological entropy. Trans. Amer. Math.
Soc., 114:309–319, 1965.
[2] Dmitry Batenkov and Yosef Yomdin. Taylor domination, difference equations, and Bautin
ideals. In Difference equations, discrete dynamical systems and applications, volume 180 of
Springer Proc. Math. Stat., pages 303–319. Springer, Berlin, 2016.
[3] A. F. Beardon and Ch. Pommerenke. The Poincaré metric of plane domains. J. London Math.
Soc. (2), 18(3):475–483, 1978.
[4] Miecislas Biernacki. Sur les fonctions multivalentes d’ordre p. C. R. Acad. Sci., Paris,
203:449–451, 1936.
[5] Edward Bierstone and Pierre D. Milman. Semianalytic and subanalytic sets. Inst. Hautes
Études Sci. Publ. Math., (67):5–42, 1988.
[6] Gal Binyamini and Dmitry Novikov. The Pila-Wilkie theorem for subanalytic families: a
complex analytic approach. Compositio Mathematica, 153(10):21712194, 2017.
[7] Gal Binyamini and Dmitry Novikov. Wilkie’s conjecture for restricted elementary functions.
Ann. of Math. (2), 186(1):237–275, 2017.
[8] Gal Binyamini, Dmitry Novikov, and Sergei Yakovenko. On the number of zeros of Abelian
integrals. Invent. Math., 181(2):227–289, 2010.
[9] E. Bombieri and J. Pila. The number of integral points on arcs and ovals. Duke Math. J.,
59(2):337–357, 1989.
[10] Rufus Bowen. Entropy for group endomorphisms and homogeneous spaces. Trans. Amer.
Math. Soc., 153:401–414, 1971.
[11] Rufus Bowen. Entropy-expansive maps. Trans. Amer. Math. Soc., 164:323–331, 1972.
[12] Niklas Broberg. A note on a paper by R. Heath-Brown: “The density of rational points on
curves and surfaces” [Ann. of Math. (2) 155 (2002), no. 2, 553–595; mr1906595]. J. Reine
Angew. Math., 571:159–178, 2004.
[13] David Burguet. A proof of Yomdin-Gromov’s algebraic lemma. Israel J. Math., 168:291–316,
2008.
[14] David Burguet, Gang Liao, and Jiagang Yang. Asymptotic h-expansiveness rate of C ∞ maps.
Proc. Lond. Math. Soc. (3), 111(2):381–419, 2015.
[15] Lee A. Butler. Some cases of Wilkie’s conjecture. Bull. Lond. Math. Soc., 44(4):642–660,
2012.
[16] Jérôme Buzzi. Intrinsic ergodicity of smooth interval maps. Israel J. Math., 100:125–161,
1997.

78

GAL BINYAMINI AND DMITRY NOVIKOV

[17] Raf Cluckers, Jonathan Pila, and Alex Wilkie. Uniform parameterization of subanalytic sets
and diophantine applications, 2016.
[18] J. Denef and L. van den Dries. p-adic and real subanalytic sets. Ann. of Math. (2), 128(1):79–
138, 1988.
[19] Omer Friedland and Yosef Yomdin. Doubling coverings of algebraic hypersurfaces. Pure Appl.
Funct. Anal., 2(2):221–241, 2017.
[20] William Fulton and Robert MacPherson. A compactification of configuration spaces. Ann. of
Math. (2), 139(1):183–225, 1994.
[21] M. Gromov. Entropy, homology and semialgebraic geometry. Astérisque, (145-146):5, 225–
240, 1987. Séminaire Bourbaki, Vol. 1985/86.
[22] Robert C. Gunning and Hugo Rossi. Analytic functions of several complex variables. AMS
Chelsea Publishing, Providence, RI, 2009. Reprint of the 1965 original.
[23] Robert Hardt and Dennis Sullivan. Variation of the Green function on Riemann surfaces
and Whitney’s holomorphic stratification conjecture. Inst. Hautes Études Sci. Publ. Math.,
(68):115–137 (1989), 1988.
[24] W. K. Hayman. Multivalent functions, volume 110 of Cambridge Tracts in Mathematics.
Cambridge University Press, Cambridge, second edition, 1994.
[25] D. R. Heath-Brown. The density of rational points on curves and surfaces. Ann. of Math.
(2), 155(2):553–595, 2002.
[26] G. O. Jones, D. J. Miller, and M. E. M. Thomas. Mildness and the density of rational points
on certain transcendental curves. Notre Dame J. Form. Log., 52(1):67–74, 2011.
[27] G. O. Jones and M. E. M. Thomas. The density of algebraic points on certain Pfaffian surfaces.
Q. J. Math., 63(3):637–651, 2012.
[28] A. Khovanskii and S. Yakovenko. Generalized Rolle theorem in Rn and C. J. Dynam. Control
Systems, 2(1):103–123, 1996.
[29] J.-M. Lion and J.-P. Rolin. Théorème de préparation pour les fonctions logarithmicoexponentielles. Ann. Inst. Fourier (Grenoble), 47(3):859–884, 1997.
[30] O. Marmon. A generalization of the Bombieri-Pila determinant method. Zap. Nauchn. Sem.
S.-Peterburg. Otdel. Mat. Inst. Steklov. (POMI), 377(Issledovaniya po Teorii Chisel. 10):63–
77, 242, 2010.
[31] D. Masser and U. Zannier. Torsion anomalous points and families of elliptic curves. Amer.
J. Math., 132(6):1677–1691, 2010.
[32] MichalMisiurewicz. Topological conditional entropy. Studia Math., 55(2):175–200, 1976.
[33] Yu. V. Nesterenko. Estimates for the characteristic function of a prime ideal. Mat. Sb. (N.S.),
123(165)(1):11–34, 1984.
[34] Sheldon E. Newhouse. Entropy and volume. Ergodic Theory Dynam. Systems, 8∗ (Charles
Conley Memorial Issue):283–299, 1988.
[35] Adam Parusiński. Lipschitz stratification of subanalytic sets. Ann. Sci. École Norm. Sup.
(4), 27(6):661–696, 1994.
[36] J. Pila. Geometric postulation of a smooth function and the number of rational points. Duke
Math. J., 63(2):449–463, 1991.
[37] J. Pila and A. J. Wilkie. The rational points of a definable set. Duke Math. J., 133(3):591–616,
2006.
[38] Jonathan Pila. Integer points on the dilation of a subanalytic surface. Q. J. Math., 55(2):207–
223, 2004.
[39] Jonathan Pila. Mild parameterization and the rational points of a Pfaff curve. Comment.
Math. Univ. St. Pauli, 55(1):1–8, 2006.
[40] Jonathan Pila. Note on the rational points of a Pfaff curve. Proc. Edinb. Math. Soc. (2),
49(2):391–397, 2006.
[41] Jonathan Pila. The density of rational points on a Pfaff curve. Ann. Fac. Sci. Toulouse Math.
(6), 16(3):635–645, 2007.
[42] Jonathan Pila. Counting rational points on a certain exponential-algebraic surface. Ann. Inst.
Fourier (Grenoble), 60(2):489–514, 2010.
[43] Jonathan Pila. O-minimality and the André-Oort conjecture for Cn . Ann. of Math. (2),
173(3):1779–1840, 2011.
[44] Jonathan Pila and Umberto Zannier. Rational points in periodic analytic sets and the ManinMumford conjecture. Atti Accad. Naz. Lincei Cl. Sci. Fis. Mat. Natur. Rend. Lincei (9) Mat.
Appl., 19(2):149–162, 2008.

COMPLEX CELLULAR STRUCTURES

79

[45] Per Salberger. On the density of rational and integral points on algebraic varieties. J. Reine
Angew. Math., 606:123–147, 2007.
[46] Thomas Scanlon. Counting special points: logic, Diophantine geometry, and transcendence
theory. Bull. Amer. Math. Soc. (N.S.), 49(1):51–71, 2012.
[47] Margaret E. M. Thomas. An o-minimal structure without mild parameterization. Ann. Pure
Appl. Logic, 162(6):409–418, 2011.
[48] Miguel N. Walsh. Bounded rational points on curves. Int. Math. Res. Not. IMRN, (14):5644–
5658, 2015.
[49] Y. Yomdin. C k -resolution of semialgebraic mappings. Addendum to: “Volume growth and
entropy”. Israel J. Math., 57(3):301–317, 1987.
[50] Y. Yomdin. Volume growth and entropy. Israel J. Math., 57(3):285–300, 1987.
[51] Y. Yomdin. Local complexity growth for iterations of real analytic mappings and semicontinuity moduli of the entropy. Ergodic Theory Dynam. Systems, 11(3):583–602, 1991.
[52] Y. Yomdin. Analytic reparametrization of semi-algebraic sets. J. Complexity, 24(1):54–76,
2008.
[53] Umberto Zannier. Some problems of unlikely intersections in arithmetic and geometry, volume 181 of Annals of Mathematics Studies. Princeton University Press, Princeton, NJ, 2012.
With appendixes by David Masser.
Weizmann Institute of Science, Rehovot, Israel
E-mail address: gal.binyamini@weizmann.ac.il
Weizmann Institute of Science, Rehovot, Israel
E-mail address: dmitry.novikov@weizmann.ac.il

