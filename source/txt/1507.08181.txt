arXiv:1507.08181v5 [math.CO] 20 Dec 2017

D ISCRETE A NALYSIS , 2017:20, 20 pp.
www.discreteanalysisjournal.com

Schwartz-Zippel Bounds for
Two-dimensional Products
Hossein Nassajian Mojarrad∗
Thang Pham∗
Frank de Zeeuw∗

Claudiu Valculescu∗

Received 19 September 2016; Published 20 December 2017

Abstract: We prove bounds on intersections of algebraic varieties in C4 with Cartesian
products of finite sets from C2 , and we point out connections with several classic theorems
from combinatorial geometry. Consider an algebraic variety X ⊂ C4 of degree d, such that
not all polynomials that vanish on X are of the form
F(x, y, s,t) = G(x, y)H(x, y, s,t) + K(s,t)L(x, y, s,t),
where G, H, K, L are polynomials and G and K are not constant. Let P, Q ⊂ C2 be finite sets
of size n. If X has dimension one or two, then we prove |X ∩ (P × Q)| = Od (n), while if X
has dimension three, then |X ∩ (P × Q)| = Od,ε (n4/3+ε ) for any ε > 0. Both bounds are best
possible in this generality (except for the ε).
These bounds can be viewed as different generalizations of the Schwartz-Zippel lemma,
where we replace a product of “one-dimensional” finite subsets of C by a product of “twodimensional” finite subsets of C2 . The bound for three-dimensional varieties generalizes the
Szemerédi-Trotter theorem. A key ingredient in our proofs is a two-dimensional version of a
special case of Alon’s combinatorial Nullstellensatz.
As corollaries of our two bounds, we obtain bounds on the number of repeated and distinct
values of polynomials and polynomial maps of pairs of points in C2 , with a characterization
of those maps for which no good bounds hold. These results generalize known bounds on
repeated and distinct Euclidean distances.
Key words and phrases: combinatorial geometry, incidence bounds, distance problems
∗ Supported

by Swiss National Science Foundation Grants 200020-165977 and 200021-162884.

c 2017 Hossein Nassajian Mojarrad, Thang Pham, Claudiu Valculescu, and Frank de Zeeuw

c b Licensed under a Creative Commons Attribution License (CC-BY)

DOI: 10.19086/da.2750

H OSSEIN NASSAJIAN M OJARRAD , T HANG P HAM , C LAUDIU VALCULESCU , AND F RANK DE Z EEUW

1

Introduction

A special case of the well-known Schwartz-Zippel1 lemma states that for an algebraic curve C ⊂ C2 of
degree d and two finite sets A, B ⊂ C, we have2
|C ∩ (A × B)| = Od (|A| + |B|).

(1)

In other words, it bounds the size of the intersection of an algebraic curve with a Cartesian product of
“one-dimensional” sets (let us informally call a finite set k-dimensional if it is given as a subset of Ck ).
The full Schwartz-Zippel lemma generalizes this statement to polynomials over any field in any number
of variables. A related statement is Alon’s combinatorial Nullstellensatz [1], which (in this case) says that
C contains all of A × B if and only if it is defined by a polynomial of the form g(x)h(x, y) + k(y)l(x, y),
with g vanishing on A and k vanishing on B.
In this paper we study generalizations of these statements to Cartesian products of two-dimensional
sets. More precisely, given a variety3 X ⊂ C4 and two finite sets P, Q ⊂ C2 , we prove upper bounds on
the size of the intersection
|X ∩ (P × Q)|,

(2)

and we determine which X can contain a whole product P × Q. Unlike in the one-dimensional case, we
cannot expect a good bound on (2) for all varieties. Take for instance X = Z(F) with F(x, y, s,t) = xs + yt;
if we take P on the y-axis and Q on the s-axis, then X contains all of P × Q. This example is generalized
in the following definition, which appears to be new. Note the similarity with the special form in the
version of Alon’s Nullstellensatz mentioned above.
Definition 1.1. Given G ∈ C[x, y]\C and K ∈ C[s,t]\C, a polynomial F ∈ C[x, y, s,t] is (G, K)-Cartesian
if it can be written as
F(x, y, s,t) = G(x, y)H(x, y, s,t) + K(s,t)L(x, y, s,t),

(3)

with H, L ∈ C[x, y, s,t]; F is Cartesian if there are non-constant G, K such that F is (G, K)-Cartesian.
Let X be a variety in C4 and let I(X) be its defining ideal. Then X is Cartesian if there are
G ∈ C[x, y]\C, K ∈ C[s,t]\C such that every F ∈ I(X) is (G, K)-Cartesian. Note that a reducible variety
is Cartesian if one of its components is Cartesian, since the ideal of a union of varieties is the intersection
of the ideals of the components.
1 See

[12] for the curious history of this lemma. We use the name that has become standard in combinatorics, even though
others published versions of this statement earlier, and many a nineteenth-century geometer could have proved the statement
that we are referring to.
2 The notation X = O (Y ) (for positive quantities X,Y ) means that there is a constant C , depending only on d, such that
d
d
X ≤ Cd ·Y . Similarly, X = Ωd (Y ) means that there is a Cd > 0 such that X ≥ Cd ·Y .
3 See [5, 20] for definitions of varieties and their dimension and degree. In this paper we only deal with affine varieties
over C, defined as Z(I) = {(x1 , . . . , xm ) ∈ Cm : F(x1 , . . . , xm ) = 0 ∀F ∈ I} for some I ⊂ C[x1 , . . . , xm ]; we write I(X) = {F ∈
C[x1 , . . . , xm ] : F(x1 , . . . , xm ) = 0 ∀(x1 , . . . , xm ) ∈ X} for the ideal of polynomials defining X. Note that a variety can be a union
of components of different dimensions; then its dimension is the maximum of the dimensions of the components.

D ISCRETE A NALYSIS, 2017:20, 20pp.

2

S CHWARTZ -Z IPPEL B OUNDS FOR T WO - DIMENSIONAL P RODUCTS

If X is Cartesian, then we cannot give a better bound on (2) than the trivial |P||Q|. Indeed, given G and
K, we can arbitrarily choose finite subsets P ⊂ Z(G) ⊂ C2 and Q ⊂ Z(K) ⊂ C2 . Then for any polynomial
F of the form (3) we have F(p, q) = 0 for all (p, q) ∈ P × Q, which means that |X ∩ (P × Q)| = |P||Q|.
Our two main theorems show that, as long as X is not Cartesian, much better bounds hold. Moreover,
it turns out that there is a dichotomy between varieties of dimension three and varieties of dimension
less than three4 . When X has dimension one or two, our first main theorem gives a linear bound, which
perhaps makes this statement the most natural generalization of the one-dimensional Schwartz-Zippel
bound (1).
Theorem 1.2. Let X be a variety in C4 of degree d and dimension one or two, and let P, Q ⊂ C2 be finite
sets. Then
|X ∩ (P × Q)| = Od (|P| + |Q|),
unless X is Cartesian.
Our second main theorem concerns varieties of dimension three, where we observe a very different
bound.
Theorem 1.3. Let X be a variety in C4 of degree d and dimension three, and let P, Q ⊂ C2 be finite sets.
Then5


|X ∩ (P × Q)| = Od,ε |P|2/3+ε |Q|2/3 + |P| + |Q| ,
unless X is Cartesian. When P, Q ⊂ R2 , the ε can be omitted.
The ε in Theorem 1.3 could of course just as well be placed in the exponent of |Q|. It comes from the
incidence bound of Sheffer, Szabó, and Zahl [22] that we use. We expect that this ε can be removed in
general, but current techniques do not quite allow for this; see the discussion in Section 6. The statement
holds for P, Q ⊂ R2 without the ε, but it should be understood that the variety is still considered as a
complex variety, and in particular we should take its complex dimension (which may differ from the real
dimension of the corresponding real variety). Similarly, our definition of a polynomial F being Cartesian
is only formulated over C, i.e., the polynomials G, H, K, L could be complex polynomials even when F is
real. With a little more work we could obtain a fully real statement, but we currently do not see much
benefit to that.
We note that many instances of Theorem 1.3 have long been known. Most notably, the SzemerédiTrotter theorem [26], which bounds the number of incidences between points and lines in R2 , can
be rephrased as the case X = Z(F) for F = xs − y + t in Theorem 1.3; indeed, the point (a, b) lies
on the line y = cx + d if and only if F(a, b, c, d) = 0. Another familiar example is the polynomial
F = (x − s)2 + (y − t)2 − 1, which we discuss in Section 5.1. More generally, Theorem 1.3 can be seen
as a variant of the Pach-Sharir theorem [13], and that theorem plays a crucial role in the proof; see the
discussion in Section 6.
4 We will ignore the trivial cases of dimension four, for which the intersection size is always |P||Q|, and dimension zero, for
which Bézout’s inequality immediately gives the bound Od (1).
5 Throughout this paper, when we state a bound involving an ε, we mean that this bound holds for every positive ε ∈ R, with
the multiplicative constant of the O-notation depending on ε.

D ISCRETE A NALYSIS, 2017:20, 20pp.

3

H OSSEIN NASSAJIAN M OJARRAD , T HANG P HAM , C LAUDIU VALCULESCU , AND F RANK DE Z EEUW

Our proofs of Theorems 1.2 and 1.3 rely on two-dimensional versions of the special case of Alon’s
Nullstellensatz mentioned at the start of this introduction. Specifically, instead of asking when a twovariable polynomial vanishes on an entire product A × B ⊂ C × C, we ask when a four-variable polynomial
vanishes on an entire product P × Q ⊂ C2 × C2 . These two-dimensional versions come in several
forms, and to avoid overloading this introduction we state them as we prove them in Section 2. Alon’s
Nullstellensatz has many applications in combinatorics, but it is not yet clear if our two-dimensional
generalizations have similar applications, other than the theorems in this paper.
We will give some applications of Theorems 1.2 and 1.3 concerning repeated and distinct values of
polynomials and polynomial maps. We generalize well-known bounds on the squared Euclidean distance
function (x − s)2 + (y − t)2 to arbitrary polynomials F(x, y, s,t), with exceptions related to the Cartesian
form. Again to avoid overloading the introduction, we present these applications and their background in
Section 5.
Constructions. Theorems 1.2 and 1.3 are best possible for statements of this generality (except for the
ε in the complex case of Theorem 1.3). Let us make clear what we mean by this.
First we consider Theorem 1.2. Let X be any variety in C4 of dimension one or two. Define
projections by π1 (x, y, s,t) = (x, y) and π2 (x, y, s,t) = (s,t). For any n, we can choose a generic subset
R ⊂ X of size n such that |π1 (R)| = n and |π2 (R)| = n. Then setting P = π1 (R) and Q = π2 (R) gives
|X ∩ (P × Q)| ≥ |R| = n. This shows that the bound of Theorem 1.2 is tight, in the sense that the exponents
cannot be improved, at least when |P| = |Q|. When |P| and |Q| are far apart, this construction gives the
lower bound min{|P|, |Q|}, whereas the upper bound in Theorem 1.2 is max{|P|, |Q|}.
Theorem 1.3 is tight in the following weaker sense: There are polynomials F of any degree and point
sets P, Q for which the bound is tight (aside from the ε). This follows from a construction of Elekes [6]
(based on an earlier construction of Erdős) that shows the Szemerédi-Trotter bound to be tight. Consider
F = xs − y + t (it is not hard to verify that this polynomial is not Cartesian). For parameters λ , µ, set
P = {(i, j) : 1 ≤ i ≤ λ , 1 ≤ j ≤ λ µ}, Q = {(i, j) : 1 ≤ i ≤ µ, 1 ≤ j ≤ λ µ}.
Then |P| = λ 2 µ and |Q| = λ µ 2 , and all sizes |P|, |Q| can be approximately obtained in this way. Moreover,
for Ω(λ 2 µ) of the points (x, y) ∈ P there are Ω(µ) points (s,t) ∈ Q such that xs − y + t = 0, so we have
|Z(F) ∩ (P × Q)| = Ω(λ 2 µ 2 ) = Ω(|P|2/3 |Q|2/3 ).
This construction is easily extended to polynomials of any degree; for instance, take the polynomial
F = xs + yd −t d and points of the form (i, j1/d ). Another example of a tight construction is given by Valtr
[28], for the polynomial F = (x − s)2 + y − t.
On the other hand, it is conjectured that for F = (x − s)2 + (y − t)2 − 1 (see also Section 5), the bound
|Z(F) ∩ (P × P)| = O(|P|4/3 ) is not tight. Erdős [7] conjectured the bound Oε (|P|1+ε ), but no better
bound than O(|P|4/3 ) is known for this or any other polynomial. It would be interesting to find out the
distinction between the polynomials for which the bound is tight, and those for which it is not tight.
Outline. In Section 2, we prove our variants of Alon’s Nullstellensatz for two-dimensional products,
which are key tools in our later proofs. In Section 3 we prove Theorem 1.2 and in Section 4 we prove
Theorem 1.3. The applications to repeated and distinct values of polynomials and polynomial maps
follow in Section 5. Finally, in Section 6, we discuss some related results and possible extensions.
D ISCRETE A NALYSIS, 2017:20, 20pp.

4

S CHWARTZ -Z IPPEL B OUNDS FOR T WO - DIMENSIONAL P RODUCTS

2
2.1

Nullstellensätze for two-dimensional products
First Nullstellensatz for two-dimensional products

Here is the form of Alon’s combinatorial Nullstellensatz that we will prove a variant of. We say that a
polynomial is squarefree if it has no repeated factors.
Theorem 2.1. Let f ∈ C[x, y], and let g ∈ C[x], k ∈ C[y] be squarefree. Then Z(g) × Z(k) ⊂ Z( f ) if and
only if there are h, l ∈ C[x, y] such that f = g(x)h(x, y) + k(y)l(x, y).
This statement is a special (but crucial) case of [1, Theorem 1.1]; the general theorem applies to any
field and any number of variables, and comes with bounds on the degrees of h and l. Most applications of
the combinatorial Nullstellensatz use [1, Theorem 1.2], which is a consequence of [1, Theorem 1.1]; the
key observation behind this consequence is that one can tell from a single coefficient of f that f does not
have the special form.
The combinatorial Nullstellensatz is of course named after Hilbert’s Nullstellensatz (see for instance
[5, 20]), which states that if a polynomial f vanishes on the zero set Z(I) of an ideal I, then some power
of f lies in I. In other words, if I = (g1 , . . . , g` ), then Z(I) ⊂ Z( f ) implies f m = ∑ gi hi for some integer
m and polynomials hi . Theorem 2.1 thus gives the slightly more precise information that we can take
m = 1 in the case where I = (g, k) and g, k are univariate polynomials in different variables.
Our first Nullstellensatz is an analogue of Theorem 2.1 for two-dimensional products.
Theorem 2.2. Let F ∈ C[x, y, s,t], and let G ∈ C[x, y]\C, K ∈ C[s,t]\C be squarefree. Then we have
Z(G) × Z(K) ⊂ Z(F) if and only if F is (G, K)-Cartesian.
Proof. One direction is obvious: If F is (G, K)-Cartesian, then Z(G) × Z(K) ⊂ Z(F).
For the other direction, we do the following, using terminology from [5, Chapter 2]. Fix an arbitrary
monomial ordering on the variables x, y, s,t, and apply the multivariate division algorithm ([5, Theorem 2.3.3]) to the polynomials F(x, y, s,t) and G(x, y). The division algorithm tells us that there exist
polynomials H(x, y, s,t) and R(x, y, s,t) such that
F(x, y, s,t) = G(x, y) · H(x, y, s,t) + R(x, y, s,t),

(4)

and no monomial of R(x, y, s,t) is divisible by the leading monomial of G(x, y).
For a fixed q = (sq ,tq ) ∈ Z(K), the fact that Z(G) × Z(K) ⊂ Z(F) implies that Z(G) is contained
in the zero set of F(x, y, sq ,tq ). Because G is squarefree, it follows from Hilbert’s Nullstellensatz that
G(x, y) divides F(x, y, sq ,tq ), so by (4) it also divides R(x, y, sq ,tq ). Suppose that R(x, y, sq ,tq ) 6≡ 0; then
the leading monomial of G(x, y) divides some monomial of R(x, y, sq ,tq ). But a monomial of R(x, y, sq ,tq )
necessarily divides some monomial of R(x, y, s,t), so we would have the leading monomial of G(x, y)
dividing a monomial of R(x, y, s,t), contradicting the stated property of R. Thus we have R(x, y, sq ,tq ) ≡ 0
for every q ∈ Z(K).
If we expand R(x, y, s,t) as
R(x, y, s,t) = ∑ Ri j (s,t)xi y j ,
i, j

D ISCRETE A NALYSIS, 2017:20, 20pp.

5

H OSSEIN NASSAJIAN M OJARRAD , T HANG P HAM , C LAUDIU VALCULESCU , AND F RANK DE Z EEUW

then R(x, y, sq ,tq ) ≡ 0 implies that Ri j (sq ,tq ) = 0 for all i, j. Hence we have Z(K) ⊂ Z(Ri j ) for all i, j.
Since K is squarefree, it follows that K divides Ri j , so for each pair i, j there exists Li j ∈ C[s,t] such that
Ri j (s,t) = K(s,t)Li j (s,t). Then we can write
!
F(x, y, s,t) = G(x, y) · H(x, y, s,t) + K(s,t) ·

i j

∑ Li j (s,t)x y

,

i, j

so setting L = ∑ Li j (s,t)xi y j , we see that F is (G, K)-Cartesian.
Although Theorem 2.2 is a direct generalization of Theorem 2.1, there is one essential difference.
The zero sets Z(g) and Z(k) in Theorem 2.1 are finite sets, while Z(G) and Z(K) in Theorem 2.2 are
algebraic curves. Our second Nullstellensatz (Theorem 2.5 below) concerns finite subsets of C2 , and is
thus perhaps closer in spirit to Theorem 2.1.

2.2

Curves and dual curves

We require the following terminology of curves6 and dual curves, which we will also use in later proofs.
Given F ∈ C[x, y, s,t] and a point q = (sq ,tq ) ∈ C2 , we define an algebraic curve in C2 by
Cq = {(x, y) ∈ C2 : F(x, y, sq ,tq ) = 0}.
Note that it is possible that Cq is not a curve but equal to C2 ; take for instance F = xs + yt and
(sq ,tq ) = (0, 0). Fortunately, this cannot happen often if F is not Cartesian, as we show in Lemma 2.4
below. We will abuse terminology somewhat and always refer to Cq as a “curve”, although of course we
will be careful about this during our proofs.
To help us analyze the curves Cq , we define a “dual” curve for each p = (x p , y p ) ∈ C2 by
C∗p = {(s,t) ∈ C2 : F(x p , y p , s,t) = 0}.
The curves are dual in the sense that p ∈ Cq if and only if q ∈ C∗p (and this is still true if one of the sets
equals C2 ).
To study these curves we need the following slight generalization of Bézout’s inequality. The
difference with the usual Bézout’s inequality is that this statement applies to arbitrary collections of
curves, and that it gives a lower bound on |C0 ∩ I|.
Lemma 2.3. Let S be a (possibly infinite) set of curves in C2 of degree at most d, and suppose that their
intersection ∩C∈SC contains a set I of size |I| > d 2 . Then there is a curve C0 such that C0 ⊂ ∩C∈SC and
|C0 ∩ I| ≥ |I| − (d − 1)2 .
6 We

define a curve in C2 to be the zero set of any polynomial in C[x, y]\C. Note that a one-dimensional variety need not be
a curve, because it may have zero-dimensional components, which cannot be described as the zero set of a single polynomial.
The degree of a curve is the minimum degree of a defining polynomial; a curve of degree d is a union of at most d irreducible
curves (its irreducible components).

D ISCRETE A NALYSIS, 2017:20, 20pp.

6

S CHWARTZ -Z IPPEL B OUNDS FOR T WO - DIMENSIONAL P RODUCTS

Proof. The fact that there is a curve contained in ∩C∈SC is proved in [16, Lemma 3.10]. It remains to be
proved that there is such a curve C0 with |C0 ∩ I| ≥ |I| − (d − 1)2 .
We can choose C0 to be the union of all curves contained in ∩C∈SC. For each C ∈ S, we let C0 be the
curve that remains after removal of C0 ; in other words, it is the Zariski closure of C\C0 (which could be
empty, but that would imply I ⊂ C0 and we would be done). Let S0 be the set of all such curves C0 . Each
curve C0 ∈ S0 has degree at most d − 1, since we removed a curve of degree at least one. Applying the first
part of the lemma to S0 , we get that | ∩C0 ∈S0 C0 | ≤ (d − 1)2 , which implies |C0 ∩ I| ≥ |I| − (d − 1)2 .
With this lemma, we can prove that there are not many points for which Cq is not a curve, unless F is
Cartesian. A very similar fact is proved in [17].
Lemma 2.4. Let F ∈ C[x, y, s,t] be a polynomial that is not Cartesian. Then there are at most d 2 points
q ∈ C2 for which Cq = C2 .
Proof. We can expand F as ∑ Fi j (s,t)xi y j . If for q = (sq ,tq ) we have Cq = C2 , then we must have
Fi j (sq ,tq ) = 0 for all i, j. If we set I = {q ∈ C2 : Cq = C2 }, then we have I ⊂ ∩i, j Z(Fi j ). By Lemma 2.3,
either we have |I| ≤ d 2 , or the curves Z(Fi j ) have a common curve, which means that the polynomials
Fi j (sq ,tq ) have a nontrivial common factor K(s,t). In the second case, F would be Cartesian. To be
precise, it would have the form K(s,t)L(x, y, s,t), so it would be (G, K)-Cartesian for any G, by choosing
H = 0.

2.3

Second Nullstellensatz for two-dimensional products

We can now improve on Theorem 2.2 by using the duality between the curves Cq and the curves C∗p to
show that F being Cartesian is equivalent to Z(F) containing a sufficiently large finite product I × J. This
statement will play a crucial role in the proofs of our main theorems. The proof is similar to that of [16,
Lemma 3.11].
Theorem 2.5. A polynomial F ∈ C[x, y, s,t] of degree d is Cartesian if and only if there are I, J ⊂ C2
with |I|, |J| > d 2 such that I × J ⊂ Z(F).
Proof. If F is (G, K)-Cartesian, then for any I ⊂ Z(G) and J ⊂ Z(K) we have I × J ⊂ Z(F). Suppose
that F is not Cartesian, and that I × J ⊂ Z(F) and |I|, |J| > d 2 . Then for all p ∈ I and q ∈ J we have
F(p, q) = 0, or in other words p ∈ Cq . So I ⊂ Cq for all q ∈ J.
Let J1 be the set of q ∈ J for which Cq is a curve, and let J2 be the set of q ∈ J for which Cq = C2 . By
Lemma 2.4, the assumption that F is not Cartesian, and the fact that |J| > d 2 , the set J1 is not empty. The
curves Cq for q ∈ J1 have degree at most d and we have |I| > d 2 , so by Lemma 2.3, there is a curve C such
that C ⊂ Cq for all q ∈ J1 . We trivially have C ⊂ Cq for all q ∈ J2 , so we can say that C ⊂ Cq for all q ∈ J.
For p ∈ C and q ∈ J we have p ∈ Cq , so by duality q ∈ C∗p ; in other words, we have J ⊂ C∗p for all
p ∈ C. Again by Lemma 2.3 and Lemma 2.4, it follows that there is a curve C∗ such that C∗ ⊂ C∗p for
all p ∈ C. Thus for all p ∈ C and all q ∈ C∗ we have q ∈ C∗p , i.e., F(p, q) = 0. Therefore C ×C∗ ⊂ Z(F),
which by Theorem 2.2 is equivalent to F being Cartesian.
As we said, Theorem 2.5 is closer to Theorem 2.1 than Theorem 2.2 is, because it concerns finite sets.
However, it differs in another way: The connection between the Cartesian product I × J and the G, K in the
D ISCRETE A NALYSIS, 2017:20, 20pp.

7

H OSSEIN NASSAJIAN M OJARRAD , T HANG P HAM , C LAUDIU VALCULESCU , AND F RANK DE Z EEUW

Cartesian form is less clear. It is not necessarily the case that if I × J ⊂ Z(F), then F is (G, K)-Cartesian
with I ⊂ Z(G) and J ⊂ Z(K). The best we can say is the following refinement of Theorem 2.5, which
follows directly by using the last claim of Lemma 2.3 in the proof of Theorem 2.5.
Corollary 2.6. Let F ∈ C[x, y, s,t] have degree d. If I × J ⊂ Z(F) for I, J ⊂ C2 with |I|, |J| > d 2 , then
there are G ∈ C[x, y]\C, K ∈ C[s,t]\C of degree at most d such that F is (G, K)-Cartesian, and moreover
|I ∩ Z(G)| ≥ |I| − (d − 1)2 and |J ∩ Z(K)| ≥ |J| − (d − 1)2 .
Let us discuss a bit further how Theorem 2.2 differs from Alon’s Nullstellensatz. As remarked at the
start of this section, most applications of Theorem 2.1 use the fact that one can see from a single coefficient
of f that f does not have the special form g(x)h(x, y) + k(y)l(x, y). This requires the more detailed
information, given in [1, Theorem 1.1], that deg(h) ≤ deg( f ) − deg(g) and deg(l) ≤ deg( f ) − deg(k).
This implies that any leading terms of g(x)h(x, y) + k(y)l(x, y) are divisible by xdeg(g) or by ydeg(k) . If f
has a leading term xdeg(g)−1 ydeg(k)−1 (say) with a nonzero coefficient, then f cannot have the special form.
In the proof of Theorem 2.2, we could also obtain information on the degrees of H and L. In fact, in
whatever monomial ordering we do the multivariate division (4), the multidegree (see [5, Chapter 2]) of
H is at most the multidegree of F minus that of G. If we choose an ordering that respects the total degree
of the polynomials, then we get deg(H) ≤ deg(F) − deg(G), and similarly deg(L) ≤ deg(F) − deg(K).
However, unlike in the one-dimensional case, we cannot say much about the degree of G or K, which
may be as small as one. Indeed, we could have I × J ⊂ Z(F) with I and J each contained in a line, so
that G and K are linear polynomials. Then it seems hard to deduce anything about the coefficients of
G(x, y)H(x, y, s,t) + K(s,t)L(x, y, s,t).

3

Varieties of dimension one and two

Before proving Theorem 1.2, we establish the following intermediate version, which is a Schwartz-Zippel
bound for a Cartesian product of one-dimensional sets similar to that in (1) in Section 1, but now the
one-dimensional sets are finite subsets of algebraic curves.
Lemma 3.1. Let G ∈ C[x, y]\C, K ∈ C[s,t]\C be irreducible polynomials of degree at most δ , let
F ∈ C[x, y, s,t]\{0} be a polynomial of degree d, and let P ⊂ Z(G), Q ⊂ Z(K) be finite sets. Then
|Z(F) ∩ (P × Q)| = Od,δ (|P| + |Q|),
unless F is (G, K)-Cartesian.
Proof. Recall that Cq = {p ∈ C2 : F(p, q) = 0}. We have
|Z(F) ∩ (P × Q)| =

∑ |Cq ∩ P|,

q∈Q

so it suffices to bound |Cq ∩P| for each q ∈ Q. We set Q1 = {q ∈ Q : Z(G) ⊂ Cq } and Q2 = Q\Q1 . Note that
if Cq = C2 , then q ∈ Q1 , and this will not be a problem. For q ∈ Q2 we have |Cq ∩ P| ≤ |Cq ∩ Z(G)| ≤ d · δ
by Bézout’s inequality (see for instance Lemma 2.3) and the fact that G is irreducible. As a result we have

∑

q∈Q2

|Cq ∩ P| ≤

∑

|Cq ∩ Z(G)| ≤ d · δ · |Q2 | = Od,δ (|Q|).

q∈Q2

D ISCRETE A NALYSIS, 2017:20, 20pp.

8

S CHWARTZ -Z IPPEL B OUNDS FOR T WO - DIMENSIONAL P RODUCTS

If |Q1 | ≤ 2d 2 , then we can use the trivial bound |Cq ∩ P| ≤ |P| to get

∑

|Cq ∩ P| ≤ 2d 2 · |P| = Od (|P|).

q∈Q1

Otherwise, we can set J = Q1 ⊂ Z(K) and let I be any subset of Z(G) with 2d 2 elements. Then
we have I × J ⊂ Z(F) and |I|, |J| > d 2 , so Corollary 2.6 tells us that F is (G0 , K 0 )-Cartesian for some
G0 , K 0 of degree at most d, and moreover we have |I ∩ Z(G0 )| ≥ |I| − (d − 1)2 > d 2 and |J ∩ Z(K 0 )| ≥
|I| − (d − 1)2 > d 2 . Thus |Z(G) ∩ Z(G0 )| > d 2 , so by Bézout’s inequality and the fact that G is irreducible,
G divides G0 , and similarly K divides K 0 . Hence F is (G, K)-Cartesian.
As an aside, we obtain a bound on the number of repeated values of a polynomial on an algebraic
curve. This is a one-dimensional version of the question that we consider in Section 5.1. See [27] for a
discussion of the related question on the number of distinct values on curves.
Corollary 3.2 (Repeated values of polynomials on curves). Let C ⊂ C2 be an algebraic curve of degree
δ and let F ∈ C[x, y, s,t]\{0} be a polynomial of degree d. Then for any a ∈ C and finite set P ⊂ C, the
number of times F takes the value a on P × P satisfies
|{(x, y, s,t) ∈ P × P : F(x, y, s,t) = a}| = Oδ ,d (|P|),
unless F − a is (G, G)-Cartesian (i.e., G divides F − a) for a polynomial G ∈ C[u, v] such that C = Z(G).
Before we get back to varieties in C4 of dimension at most two, we need the following technical
lemma from algebraic geometry. A qualitative version of the lemma can be found for instance in [20,
Theorem I.6.3.7] (where it is called “The theorem on the dimension of the fibers”). However, we need a
quantitative version where the dependence on the degree of the variety is specified. Such a statement is
proved in [4, Lemma 3.7], although the argument there is very general and the dependence on d is not
given explicitly. In this particular case, it would not be hard to show by a direct argument that W has
degree O(d 2 ).
Lemma 3.3. Let π : C4 → C2 be the projection defined by π(x, y, s,t) = (s,t). Let X ⊂ C4 be a variety of
degree d and dimension at most two. Then there is a curve W ⊂ C2 of degree Od (1) such that, for every
(s,t) 6∈ W , π −1 (s,t) ∩ X is a finite set of size at most d.
We are now ready to bound |X ∩ (P × Q)| when X has dimension at most two.
Proof of Theorem 1.2. Let π1 , π2 be the projections defined by π1 (x, y, s,t) = (x, y) and π2 (x, y, s,t) =
(s,t). By Lemma 3.3, there is a curve W ⊂ C2 of degree Od (1) such that for any q ∈
/ W we have
|π2−1 (q) ∩ X| ≤ d. Similarly, there is a curve V ⊂ C2 of degree Od (1) such that for any p ∈
/ V we have
|π1−1 (p) ∩ X| ≤ d.
Let P1 = P\V and P2 = P ∩V , and similarly Q1 = Q\W and Q2 = Q ∩W . Then
|X ∩ (P1 × Q)| ≤

∑ |π1−1 (p) ∩ X| ≤ d · |P1 | = Od (|P|),

(5)

p∈P1

and similarly |X ∩ (P × Q1 )| = Od (|Q|).
D ISCRETE A NALYSIS, 2017:20, 20pp.

9

H OSSEIN NASSAJIAN M OJARRAD , T HANG P HAM , C LAUDIU VALCULESCU , AND F RANK DE Z EEUW

It remains to bound |X ∩ (P2 × Q2 )|. Let Z(G1 ), . . . , Z(Gv ) be the irreducible components of V , and
let Z(K1 ), . . . , Z(Kw ) be the irreducible components of W . Note that v, w = Od (1). We have
|X ∩ (P2 × Q2 )| ≤ ∑ |X ∩ ((P2 ∩ Z(Gi )) × (Q2 ∩ Z(K j ))|.

(6)

i, j

Consider any pair Gi , K j . By Lemma 3.1, for each F ∈ I(X) we have
|Z(F) ∩ ((P2 ∩ Z(Gi )) × (Q2 ∩ Z(K j ))| = Od (|P| + |Q|),

(7)

unless F is (Gi , K j )-Cartesian. In other words, if some F ∈ I(X) is not (Gi , K j )-Cartesian, then we have
this bound, or else all F ∈ I(X) are (Gi , K j )-Cartesian, which implies that X is Cartesian. Thus, if X is
not Cartesian, then for every pair i, j we have the bound (7). Summing the bound in (7) over the Od (1)
pairs i, j as in (6), and combining with (5), we obtain the stated bound.
We note that in Theorem 1.2, the dependence of the bound on d could be determined from our proof,
if one makes the degree Od (1) of W in Lemma 3.3 explicit. For Theorem 1.3 this would be more difficult,
because its proof relies on Theorem 4.1 below, in which the degree dependence is not made explicit.

4

Varieties of dimension three

We now consider three-dimensional varieties X ⊂ C4 . We reduce our problem of bounding |X ∩ (P × Q)|
to the problem of bounding incidences between points and curves, and then apply a well-known incidence
bound. To show that the conditions of this bound are met, we again use the curve duality introduced in
Section 2. This duality was similarly used in combination with incidence bounds in a number of recent
papers, including [14, 16, 21]. The challenge in our situation is to convert the combinatorial condition of
the incidence bound to an algebraic condition on the polynomials defining X.
Our main tool is the following incidence bound. The statement was proved by Pach and Sharir [13]
in R2 , and this was generalized to C2 by Sheffer, Szabó, and Zahl [22], at the cost of an ε. The incidence
graph defined by a set P of points and a set C of curves is the bipartite graph with vertex sets P and C,
with an edge between p ∈ P and C ∈ C if p ∈ C. We denote the number of edges in this graph by I(P, C);
in other words, I(P, C) is the number of incidences between P and C. We denote by Ks,t the complete
bipartite graph on s and t vertices.
Theorem 4.1. Let P ⊂ C2 and let C be a set of algebraic curves of degree at most d. If the incidence
graph of P and C contains no K2,M or KM,2 , then


I(P, C) = Od,M,ε |P|2/3+ε |C|2/3 + |P| + |C| .
If P ⊂ R2 , then the ε can be omitted.
In Theorem 1.3 we are given a polynomial F ∈ C[x, y, s,t] and finite sets P, Q ⊂ C2 . Recall from
Section 2 that for each q = (sq ,tq ) ∈ Q we define a curve
Cq = {(x, y) ∈ C2 : F(x, y, sq ,tq ) = 0},
D ISCRETE A NALYSIS, 2017:20, 20pp.

10

S CHWARTZ -Z IPPEL B OUNDS FOR T WO - DIMENSIONAL P RODUCTS

and for each p = (x p , y p ) ∈ P we define a dual curve
C∗p = {(s,t) ∈ C2 : F(x p , y p , s,t) = 0}.
Let CQ = {Cq : q ∈ Q} be the multiset of curves defined by Q.
Note that we have to be careful when we pass from the point set Q to the curves Cq , because two
different points q, q0 ∈ Q may define the same curve Cq = Cq0 (viewed as sets). For this reason we deal
with CQ as a multiset, and we extend the notion of incidence graph to multisets in the obvious way
(distinct q, q0 give distinct vertices, even if Cq = Cq0 ). Although Theorem 4.1 is not stated for multisets of
curves, our Corollary 4.2 below is.
We now show that for points and curves defined in this way, we can use the duality to obtain a stronger
version of Theorem 4.1 for our situation. Specifically, the condition on the excluded complete bipartite
graph is much weaker. A similar argument was used in [14, Lemma 3.4]. A comparable statement was
proved in a very different way by Fox et al. [8]; see also the discussion in Section 6.
Corollary 4.2. Let P, Q ⊂ C2 and let F ∈ C[x, y, s,t] have degree d. Let CQ be the multiset of curves
defined by Q and F. If the incidence graph of P and CQ contains no KM,M , then


I(P, CQ ) = Od,M,ε |P|2/3+ε |Q|2/3 + |P| + |Q| .
If P, Q ⊂ R2 , then the ε can be omitted.
Proof. First note that we can assume that M > d 2 , since if M ≤ d 2 and the incidence graph contains no
KM,M , then it also contains no Kd 2 +1,d 2 +1 , so we can replace M by d 2 + 1.
We claim that we can partition P into Od,M (1) subsets Pi , and Q into Od,M (1) subsets Q j , so that the
following holds. Each CQ j is a set, and for each pair i, j, the incidence graph of Pi and CQ j contains no
K2,2dM or K2dM,2 . Given this claim, we can apply Theorem 4.1 to the points Pi and the curves CQ j to get


I(Pi , CQ j ) = Od,M,ε |Pi |2/3+ε |Q j |2/3 + |Pi | + |Q j | .
Summing up these bounds for the Od,M (1) pairs i, j proves the corollary.
The rest of the proof concerns the claim that such a partition exists. Construct a graph G with vertex
set P and an edge between two points p, p0 ∈ P if there are at least 2dM points q ∈ Q such that p, p0 ∈ Cq .
By duality, if G has an edge between p and p0 , then the intersection of the curves C∗p and C∗p0 contains a
set I of at least 2dM points of Q. Since 2dM > d 2 , Lemma 2.3 implies that C∗p and C∗p0 contain a common
curve C0 , and moreover |C0 ∩ I| ≥ |I| − (d − 1)2 > dM. This curve has degree at most d and thus at most
d irreducible components, one of which contains at least M points of Q. To summarize, an edge between
p and p0 implies the existence of a common irreducible component of C∗p and C∗p0 that contains at least M
points of Q.
We can use this observation to bound the maximum degree of a vertex of G by dM. Suppose that a
vertex p ∈ P has degree greater than dM. Since C∗p has at most d irreducible components, there must be
an irreducible component C1 of C∗p that contains at least M points of Q, and that is shared with the curve
C∗p0 for at least M neighbors p0 of p. Then there would be a KM,M in the incidence graph of P and CQ ,
D ISCRETE A NALYSIS, 2017:20, 20pp.

11

H OSSEIN NASSAJIAN M OJARRAD , T HANG P HAM , C LAUDIU VALCULESCU , AND F RANK DE Z EEUW

with on one side these M neighbors p0 , and on the other side any M points of Q on C1 . This contradicts
the assumption, so the degree of a vertex of G is at most dM.
By basic graph theory7 , we can color G with dM + 1 colors, or in other words, we can partition P
into dM + 1 = Od,M (1) subsets Pi such that no two vertices in the same subset are adjacent in G. Since
an edge in G corresponds to a K2,2dM in the incidence graph, this means that the incidence graph of Pi
and CQ contains no K2,2dM .
Let Q0 be the subset of q ∈ Q for which Cq contains fewer than 2dM points of P. The curves in CQ0
together give Od,M (|Q|) incidences with P. Using the dual of the procedure above, we can partition Q\Q0
into Od,M (1) subsets Q j such that the incidence graph of P with each multiset CQ j contains no K2dM,2 . It
follows that each CQ j is a set, because if Cq = Cq0 for two q, q0 ∈ Q j , then the fact that q, q0 6∈ Q0 implies
that Cq = Cq0 contains at least 2dM points of P, which would give a K2dM,2 in the incidence graph of P
and CQ j . Hence, each Q j is a set, and each of the Od,M (1) pairs Pi , CQ j defines an incidence graph without
K2,2dM or K2dM,2 . This proves the existence of the claimed partition.
We now have all the pieces in place to prove Theorem 1.3.
Proof of Theorem 1.3. If X has components of dimension less than three, we apply Theorem 1.2 to them,
which gives a bound better than that in Theorem 1.3, unless one of these components is Cartesian. As
noted in Definition 1.1, if any component of X is Cartesian, then so is X.
Therefore, we can assume that every component of X is three-dimensional, so that we can write
X = Z(F) (see for instance [20, Theorem 1.21] for the fact that any variety of codimension one is the zero
set of a single polynomial). If F is chosen to have the minimum degree with this property, then it follows
that deg(F) ≤ d. If F is not Cartesian, then by Theorem 2.5, there are no I, J ⊂ C2 with |I|, |J| > d 2 such
that I × J ⊂ Z(F). Setting M = d 2 + 1, it follows that the incidence graph of P and CQ contains no KM,M .
Corollary 4.2 then gives the bound in Theorem 1.3.

5

Repeated and distinct values of polynomial maps

We now give our applications of Theorems 1.2 and 1.3 to value sets of polynomial maps. We first consider
polynomial maps C4 → C defined by one polynomial, and then polynomial maps C4 → C2 defined
by two polynomials. We could also consider maps defined by more polynomials, but this seems less
interesting.

5.1

Repeated values of polynomials

Erdős [7] asked for the maximum number of unit distances that can occur between the points in a finite
set P ⊂ R2 . The best known upper bound is O(|P|4/3 ), due to Spencer, Szemerédi, and Trotter [24]. We
can rephrase this statement as follows. Let
F(x, y, s,t) = (x − s)2 + (y − t)2 ,
7 See

for instance [3, Chapter 14]; the simple proof is based on a greedy algorithm.

D ISCRETE A NALYSIS, 2017:20, 20pp.

12

S CHWARTZ -Z IPPEL B OUNDS FOR T WO - DIMENSIONAL P RODUCTS

so that F(x, y, s,t) equals the squared Euclidean distance between (x, y) and (s,t). Then the number of
pairs in P × P ⊂ R2 × R2 on which F can take the value 1 is O(|P|4/3 ). Of course, the same statement
holds for any value other than 1.
Theorem 1.3 tells us to which other polynomials this bound can be generalized. Compare this
statement with Corollary 3.2, where a sharper bound is proved for a point set contained in an algebraic
curve of bounded degree.
Corollary 5.1. Let F ∈ C[x, y, s,t], let P ⊂ C2 be a finite set, and let a ∈ C. Then the number of times F
takes the value a on P satisfies
|{(x, y, s,t) ∈ P × P : F(x, y, s,t) = a}| = Od,ε (|P|4/3+ε ),
unless the polynomial F − a is Cartesian. Over R, the ε can be omitted.
The condition that F − a is not Cartesian is necessary, since if F − a is (G, K)-Cartesian, then we
can take half of the points of P in Z(G) and the other half in Z(K), to get Ω(|P|2 ) repeated values. As in
Theorem 1.3, the bound is best possible in general. That the bound is best possible for certain “distances”
was already observed by Valtr [28], who constructed a strictly convex norm, based on the polynomial
F = (x − s)2 + y − t, for which the upper bound O(|P|4/3 ) is tight. On the other hand, it is a major open
problem in discrete geometry to show that for the Euclidean distance, this bound is not tight.

5.2

Distinct values of polynomials

Erdős [7] also asked for the minimum number of distinct distances determined by a finite set P ⊂ R2 .
Guth and Katz [10] proved an almost tight bound Ω(|P|/ log |P|). It is natural to ask the same question
for other functions of pairs of points in the plane. Roche-Newton and Rudnev [18] proved the same lower
bound for the “Minkowski distance” (x − s)2 − (y − t)2 , and Rudnev and Selig [19] extended it to other
quadratic distances. Garibaldi, Iosevich, and Senger [9, Chapter 9] considered the dot product xs + yt, but
only proved the bound Ω(|P|2/3 ) for the number of distinct dot products determined by P; improving
this bound is an interesting open problem. Iosevich, Roche-Newton, and Rudnev [11] proved the slightly
better bound Ω(|P|9/13 ) for the number of distinct values of xt − ys. We are not aware of other such
polynomials for which any bound has been proved.
As a corollary of Corollary 5.1, we obtain a bound on the number of distinct values of a polynomial,
for any polynomial for which it could hold. The bound is basically Ω(|P|2/3 ), so relatively weak, but we
do not know any more elementary proof of such a bound for general polynomials. Any such proof would
have to deal with the fact that there are exceptional polynomials that are related to the Cartesian property,
so techniques like ours seem to be necessary.
Corollary 5.2. Let F ∈ C[x, y, s,t] and let P ⊂ C2 be a finite set. Then the number of distinct values of F
on P satisfies
|F(P × P)| = Ωd,ε (|P|2/3−ε ),
unless there exists an a ∈ C such that F − a is Cartesian. Over R, the ε can be omitted.
Proof. If every value of F is repeated at most T times, then the |P|2 pairs in P × P must give at least
|P|2 /T distinct values. For every a ∈ F(P × P), the fact that F − a is not Cartesian lets us apply Corollary
5.1 to conclude that F has the value a for Od,ε (|P|4/3+ε ) pairs in P × P. The stated bound follows.
D ISCRETE A NALYSIS, 2017:20, 20pp.

13

H OSSEIN NASSAJIAN M OJARRAD , T HANG P HAM , C LAUDIU VALCULESCU , AND F RANK DE Z EEUW

Note that if F − a is (G, G)-Cartesian for a ∈ C, then P ⊂ Z(G) gives F(P × P) = {a}, so there cannot
be a good lower bound on the number of distinct values of F. However, if F − a is (G, K)-Cartesian with
G 6= K, this construction does not work. Thus the right exception in Corollary 5.2 would probably be
“unless there exist a ∈ C and G ∈ C[x, y] such that F − a is (G, G)-Cartesian”; unfortunately, this does not
quite seem to follow from our proof.
The proof of Corollary 5.2 gives a somewhat stronger statement: There exists p ∈ P such that
|F(p × P)| = Ωd,ε (|P|2/3−ε ), unless some F − a is Cartesian.

5.3

Repeated values of polynomial maps

Just as Theorem 1.3 gives us bounds on the number of repeated and distinct values of a single polynomial,
Theorem 1.2 can give us such bounds for polynomial maps defined by two polynomials. We focus on the
case of polynomial maps F : C4 → C2 of the form
F(x, y, s,t) = (F1 (x, y, s,t), F2 (x, y, s,t))
with F1 , F2 ∈ C[x, y, s,t]. Note that for a finite set P ⊂ C2 and a point (a, b) ∈ C2 ,
Z(F1 − a, F2 − b) ∩ (P × P)
is the set of pairs (x, y), (s,t) ∈ P for which F(x, y, s,t) = (a, b).
Corollary 5.3. Let F1 , F2 ∈ C[x, y, s,t] be two polynomials of degree at most d, and let F : C4 → C2 be
the polynomial map defined by F(x, y, s,t) = (F1 (x, y, s,t), F2 (x, y, s,t)). For P ⊂ C2 and (a, b) ∈ C2 , we
have
|{(x, y, s,t) ∈ P × P : F(x, y, s,t) = (a, b)}| = Od (|P|),
unless F1 − a and F2 − b have a common factor, or there are G ∈ C[x, y]\C, K ∈ C[s,t]\C such that F1 − a
and F2 − b are both (G, K)-Cartesian.
Proof. If F1 − a and F2 − b do not have a common factor, then Z(F1 − a, F2 − b) has dimension two, so
that we can apply Theorem 1.2 to X = Z(F1 − a, F2 − b).
Both exceptions are necessary. As before, if F1 − a and F2 − b are both (G, K)-Cartesian, then we
can get |Z(F1 − a, F2 − b) ∩ (P × P)| = Ω(|P|2 ). If F1 − a and F2 − b have a common factor F3 , then
|Z(F1 − a, F2 − b) ∩ (P × P)| ≥ |Z(F3 ) ∩ (P × P)|, and we know from the constructions in Section 1 that
there are polynomials F3 for which we have |Z(F3 ) ∩ (P × P)| = Ω(|P|4/3 ). Of course, Theorem 1.3 could
in this case be used to get the upper bound Od,ε (|P|4/3+ε ).

5.4

Distinct values of polynomial maps

Finally, we consider distinct values of polynomial maps C4 → C2 . We say that F1 and F2 are inner
equivalent if there exist ϕ1 , ϕ2 ∈ C[z] and ψ ∈ C[x, y, s,t] such that F1 = ϕ1 ◦ ψ and F2 = ϕ2 ◦ ψ. Note
that if F1 and F2 are inner equivalent, then the map F = (F1 , F2 ) : C4 → C2 factors into ψ : C4 → C and
(ϕ1 , ϕ2 ) : C → C2 . In this case, the number of distinct values of F is essentially the same as that of ψ,
and thus Corollary 5.2 is the relevant statement.
D ISCRETE A NALYSIS, 2017:20, 20pp.

14

S CHWARTZ -Z IPPEL B OUNDS FOR T WO - DIMENSIONAL P RODUCTS

Corollary 5.4. Let F1 , F2 ∈ C[x, y, s,t] be two polynomials of degree at most d, and let F : C4 → C2 be
the polynomial map defined by F(x, y, s,t) = (F1 (x, y, s,t), F2 (x, y, s,t)). For P ⊂ C2 , we have
|F(P × P)| = Ωd (|P|),
unless F1 and F2 are inner equivalent, or there is an (a, b) ∈ C2 such that F1 − a and F2 − b are both
(G, K)-Cartesian.
Proof. We use a generalization of Stein’s theorem [25] to more variables, a proof of which can be found
for instance in [2]. It states that for a non-composite polynomial F over C in any number of variables,
the number of λ ∈ C for which the polynomial F − λ is reducible is at most 2 deg(F)2 (a polynomial is
composite if there is a nonlinear univariate polynomial ϕ and a polynomial ψ such that F = ϕ ◦ ψ).
We can assume that F1 , F2 are non-composite, because if F1 = ϕ ◦ ψ, then |F1 (P × P)| ≥ d1 |ψ(P × P)|,
and similarly for F2 , so the number of distinct values of F is asymptotically unchanged by removing
the outside functions. Thus there are sets S1 , S2 ⊂ C of size at most 2d 2 , such that for a 6∈ S1 , F1 − a is
irreducible, and for b 6∈ S2 , F2 − b is irreducible.
Let f (d) be the function such that the upper bound in Corollary 5.3 is f (d)|P|. We can assume that
|F1 (P × P)| and |F2 (P × P)| are less than |P|/(16d 2 f (d)), since otherwise we are done.
Consider a ∈ S1 . By Corollary 5.1, there are Od,ε (|P|4/3+ε ) pairs (p, q) ∈ P×P for which F1 (p, q) = a.
Now consider b ∈ F2 (P × P). Let F3 be the greatest common divisor of F1 − a and F2 − b, and set
Fe1 = (F1 − a)/F3 and Fe2 = (F2 − b)/F3 . The pairs (p, q) ∈ P × P for which F3 (p, q) = 0 have been
counted among the ones with F1 (p, q) = a, so it remains to count the ones with Fe1 (p, q) = 0 and
Fe2 (p, q) = 0. If one of Fe1 and Fe2 is constant, then the variety Z(Fe1 , Fe2 ) is empty. Otherwise, Fe1 and
Fe2 are coprime and Z(Fe1 , Fe2 ) has dimension at most two, so by Corollary 5.3 there are Od (|P|) pairs
(p, q) ∈ P × P for which Fe1 (p, q) = 0 and Fe2 (p, q) = 0.
Thus, for a fixed a ∈ S1 , we count
Od,ε (|P|4/3+ε ) + |F2 (P × P)| · f (d)|P| ≤

1
|P|2
8d 2

pairs (p, q) ∈ P × P for which F(p, q) = (a, b) for some b ∈ F2 (P × P). Summing over all a ∈ S1 , we
have fewer than 14 |P|2 pairs (p, q) ∈ P × P for which F(p, q) = (a, b) for some (a, b) ∈ S1 × F2 (P × P).
By a symmetric argument, we have fewer than 14 |P|2 pairs (p, q) ∈ P × P for which F(p, q) = (a, b) for
some (a, b) ∈ F1 (P × P) × S2 . Altogether, there are fewer than 12 |P|2 pairs for which F(p, q) ∈ S1 × S2 .
Consequently, there are at least 12 |P|2 pairs (p, q) ∈ P × P for which F(p, q) = (a, b) with a 6∈ S1 and
b 6∈ S2 .
Now consider a 6∈ S1 and b 6∈ S2 . We have F1 − a and F2 − b both irreducible, which implies that
they do not have a common factor, unless F1 = αF2 + β for some α, β ∈ C. But that would mean that
F1 and F2 are inner equivalent (moreover, they were inner equivalent before we removed any outside
functions). Thus F1 − a and F2 − b do not have a common factor, and Z(F1 − a, F2 − b) has dimension
two. By Corollary 5.3, there are Od (|P|) pairs (p, q) ∈ P × P such that F(p, q) = (a, b), unless F1 − a
and F2 − b are both (G, K)-Cartesian for some G, K. Since there are at least 12 |P|2 pairs (p, q) ∈ P × P for
which F(p, q) = (a, b) with a 6∈ S1 and b 6∈ S2 , there must be Ωd (|P|) distinct (a, b) ∈ F(P × P).
D ISCRETE A NALYSIS, 2017:20, 20pp.

15

H OSSEIN NASSAJIAN M OJARRAD , T HANG P HAM , C LAUDIU VALCULESCU , AND F RANK DE Z EEUW

There are maps for which the bound in Corollary 5.4 is tight. Consider the vector addition map
F(p, q) = p + q = (x + s, y + t). Clearly, if P is a set of points in arithmetic progression (and thus on a
line), then |F(P × P)| = O(|P|). The polynomials F1 = x + s and F2 = y + t are not inner equivalent, and
F1 − a and F2 − b are never both (G, K)-Cartesian (both are Cartesian, but with different G, K).

6

Discussion

Tightness. The main open question regarding Theorem 1.3 is for which varieties the bound is tight, and
for which it can be improved. As mentioned in the Introduction, the bound is tight for various varieties,
while for others it is conjectured that improvement is possible.
Question 6.1. For which non-Cartesian polynomials F ∈ C[x, y, s,t] and sets P, Q of size n is the bound
|Z(F) ∩ (P × Q)| = O(n4/3 ) tight, and for which is it not?
Of course, this is just a generalization of the well-known unit distance problem, but this view does
raise some new possibilities. It may be possible to find a polynomial for which the bound can be improved
more easily than for the Euclidean distance polynomial. It would also be interesting to find and classify
more polynomials for which the bound is tight.
About the ε. Note that Theorem 4.1 is conjectured to hold without the ε, which would imply the same
for our main theorem. Zahl [29] did prove such a bound without ε, but with more restrictive conditions.
Specifically, his theorem requires that the incidences occur at transversal intersection points of the curves,
and that the curves are smooth.
We believe we can handle the first condition in our situation, because for our curves common tangent
lines should be relatively rare. We could handle the second condition if we assume Z(F) to be nonsingular,
because then only a relatively small subset of our curves could be singular. However, if Z(F) is singular,
then it could be that all our curves are singular, in which case we do not see a way to apply Zahl’s theorem.
About the Cartesian form. We currently do not have a good method or algorithm for proving that a
polynomial is not Cartesian, and we do not know any instance where our algebraic condition (that F is
not Cartesian) is easier to establish than the combinatorial condition of Theorem 4.1 (that the incidence
graph does not contain certain complete bipartite subgraphs).
Question 6.2. Is there an algorithm that determines if a polynomial F ∈ C[x, y, s,t] is Cartesian, i.e., if it
can be written as F(x, y, s,t) = G(x, y)H(x, y, s,t) + K(s,t)L(x, y, s,t) with G and K not constant?
Related results. Theorem 1.3 can be thought of as a variant of the Pach-Sharir incidence bound,
where a combinatorial condition is replaced by an algebraic one. Specifically, Theorem 4.1 gives a
bound on I(P, C) if the incidence graph of P and C does not contain a K2,M or KM,2 . In most algebraic
applications of this theorem, there is a polynomial F ∈ R[x, y, s,t] such that the curves in C are of the form
{p : F(p, qi ) = 0} for fixed qi in some finite set Q; see for instance [15, 21, 23]. In such applications, our
theorem replaces the combinatorial condition on the incidence graph by the purely algebraic condition
that F is not Cartesian.
D ISCRETE A NALYSIS, 2017:20, 20pp.

16

S CHWARTZ -Z IPPEL B OUNDS FOR T WO - DIMENSIONAL P RODUCTS

Yet another way to view Theorem 1.3 is as follows. An algebraic graph on R2 ×R2 is a bipartite graph
whose two parts are finite sets P, Q ⊂ R2 , with edges defined by a polynomial F ∈ R[x, y, s,t], i.e., there is
an edge between p ∈ P and q ∈ Q if and only if F(p, q) = 0. Fox et al. [8] proved that if an algebraic
graph on R2 × R2 contains no Kt,t , then the number of edges is bounded by Ot (|P|2/3 |Q|2/3 + |P| + |Q|)
(in fact, they proved much more general statements for semialgebraic graphs with vertex sets in Rd ).
Again, Theorem 1.3 states the same bound, but replaces the combinatorial condition by an algebraic
condition.
Possible extensions. In this paper, we have intentionally not looked beyond C4 , but there are natural
questions to ask for other Cartesian products. We mention a few, without going into too much detail.
We can consider varieties X ⊂ CD × CE and try to bound the intersection |X ∩ (P × Q)| for P ⊂
CD , Q ⊂ CE . There will be exceptions for X defined by “Cartesian” polynomials of the form GH + KL,
with G a polynomial in the first D variables and K a polynomial in the last E variables. In analogy with
Theorem 1.2, we would expect that in the case D = E = dim(X) the bound will be O(|P| + |Q|). For
X of intermediate dimension, we would expect intermediate exponents, probably related to those in
higher-dimensional incidence theorems.
In another direction, we can take X ⊂ (C2 )k and consider |X ∩ ∏ki=1 Pi | for Pi ⊂ C2 . There will be
exceptional varieties X defined by polynomials of the form ∑ki=1 Gi Hi , with each Gi a function of the i-th
pair of variables. In analogy with the general Schwartz-Zippel lemma, we expect that if dim(X) = 2`,
then the bound will be O(|P|` ).
Of course one can combine these two directions and look at arbitrary products ∏ CDi . All such results
would come with corresponding corollaries for value sets of polynomial maps.
Another direction to proceed in is to ask the same questions for other fields, in particular finite fields.
Our proof of Theorem 1.2 seems to carry through for any algebraically closed field, but we have restricted
ourselves to C for simplicity. Theorem 1.3, however, relies on the incidence bound in Theorem 4.1, which
does not yet have any analogue over finite fields (at least not with the same algebraic flexibility).

References
[1] Noga Alon, Combinatorial Nullstellensatz, Combinatorics, Probability and Computing 8:7–29,
1999. 2, 5, 8
[2] Arnaud Bodin, Reducibility of rational functions in several variables, Israel Journal of Mathematics
164:333–347, 2008. 15
[3] Adrian Bondy and U.S.R. Murty, Graph Theory, Springer, 2008. 12
[4] Emmanuel Breuillard, Ben Green, and Terence Tao, Approximate subgroups of linear groups,
Geometric And Functional Analysis 21:774–819, 2011. 9
[5] David Cox, John Little, and Donal O’Shea, Ideals, Varieties, and Algorithms, third edition, Springer,
2007. 2, 5, 8
D ISCRETE A NALYSIS, 2017:20, 20pp.

17

H OSSEIN NASSAJIAN M OJARRAD , T HANG P HAM , C LAUDIU VALCULESCU , AND F RANK DE Z EEUW

[6] György Elekes, SUMS versus PRODUCTS in Number Theory, Algebra and Erdős Geometry, Paul
Erdős and his Mathematics II, Bolyai Society Mathematical Studies 11:241–290, 2002. 4
[7] Paul Erdős, On sets of distances of n points, American Mathematical Monthly 53:248–250, 1946. 4,
12, 13
[8] Jacob Fox, János Pach, Adam Sheffer, Andrew Suk, and Joshua Zahl, A semi-algebraic version of
Zarankiewicz’s problem, Journal of the European Mathematical Society 19:1785–1810, 2017. 11,
17
[9] Julia Garibaldi, Alex Iosevich, and Steven Senger, The Erdős Distance Problem, American Mathematical Society, 2011. 13
[10] Larry Guth and Nets Hawk Katz, On the Erdős distinct distances problem in the plane, Annals of
Mathematics 181:155–190, 2015. 13
[11] Alex Iosevich, Oliver Roche-Newton, and Misha Rudnev, On discrete values of bilinear forms,
arXiv:1512.02670, 2015. 13
[12] Richard Lipton, blog post, available at http://rjlipton.wordpress.com/2009/11/30/
the-curious-history-of-the-schwartz-zippel-lemma/, 2009. 2
[13] János Pach and Micha Sharir, Repeated angles in the plane and related problems, Journal of
Combinatorial Theory, Series A 59:12–22, 1992. 3, 10
[14] János Pach and Frank de Zeeuw, Distinct distances on algebraic curves in the plane, Combinatorics,
Probability and Computing 26:99–117, 2017. 10, 11
[15] Orit Raz, Micha Sharir, and József Solymosi, Polynomials vanishing on grids: The Elekes-Rónyai
problem revisited, American Journal of Mathematics 138:1029–1065, 2016. 16
[16] Orit Raz, Micha Sharir, and Frank de Zeeuw, Polynomials vanishing on Cartesian products: The
Elekes-Szabó Theorem revisited, Duke Mathematical Journal 165:3517–3566, 2016. 7, 10
[17] Orit Raz, Micha Sharir, and Frank de Zeeuw, The Elekes-Szabó Theorem in four dimensions,
arXiv:1607.03600, 2016. To appear in Israel Journal of Mathematics. 7
[18] Oliver Roche-Newton and Misha Rudnev, On the Minkowski distances and products of sum sets,
Israel Journal of Mathematics 209:507–526, 2015. 13
[19] Misha Rudnev and Jon Selig, On the use of the Klein quadric for geometric incidence problems in
two dimensions, SIAM Journal on Discrete Mathematics 30:934–954, 2016. 13
[20] Igor Shafarevich, Basic Algebraic Geometry I: Varieties in Projective Space, third edition, Springer,
2013. 2, 5, 9, 12
[21] Micha Sharir, Adam Sheffer, and József Solymosi, Distinct distances on two lines, Journal of
Combinatorial Theory, Series A 120:1732–1736, 2013. 10, 16
D ISCRETE A NALYSIS, 2017:20, 20pp.

18

S CHWARTZ -Z IPPEL B OUNDS FOR T WO - DIMENSIONAL P RODUCTS

[22] Adam Sheffer, Endre Szabó, and Joshua Zahl, Point-curve incidences in the complex plane,
arXiv:1502.07003, 2015. To appear in Combinatorica. 3, 10
[23] Chun-Yen Shen, Algebraic methods in sum-product phenomena, Israel Journal of Mathematics
188:123–130, 2012. 16
[24] Joel Spencer, Endre Szemerédi, and William Trotter, Unit distances in the Euclidean plane, Graph
Theory and Combinatorics, Academic Press, 293–303, 1984. 12
[25] Yosef Stein, The total reducibility order of a polynomial in two variables, Israel Journal of Mathematics 68:109–122, 1989. 15
[26] Endre Szemerédi and William Trotter, Extremal problems in discrete geometry, Combinatorica
3:381–392, 1983. 3
[27] Claudiu Valculescu and Frank de Zeeuw, Distinct values of bilinear forms on algebraic curves,
Contributions to Discrete Mathematics 11:31–45, 2016. 9
[28] Pavel Valtr, Strictly convex norms allowing many unit distances and related touching questions,
manuscript, 2005. 4, 13
[29] Joshua Zahl, A Szemerédi-Trotter type theorem in R4 , Discrete & Computational Geometry 54:513–
572, 2015. 16
AUTHORS
Hossein Nassajian Mojarrad
École Polytechnique Fédérale de Lausanne
Lausanne, Switzerland
hossein [dot] mojarrad [at] epfl [dot] ch
https://dcg.epfl.ch/hossein
Thang Pham
École Polytechnique Fédérale de Lausanne
Lausanne, Switzerland
phamanhthang [dot] vnu [at] gmail [dot] com
https://dcg.epfl.ch/thang
Claudiu Valculescu
École Polytechnique Fédérale de Lausanne
Lausanne, Switzerland
claudio040788 [at] gmail [dot] com
https://dcg.epfl.ch/page-100304-en.html

D ISCRETE A NALYSIS, 2017:20, 20pp.

19

H OSSEIN NASSAJIAN M OJARRAD , T HANG P HAM , C LAUDIU VALCULESCU , AND F RANK DE Z EEUW

Frank de Zeeuw
École Polytechnique Fédérale de Lausanne
Lausanne, Switzerland
fdezeeuw [at] gmail [dot] com
https://dcg.epfl.ch/page-84876-en.html

D ISCRETE A NALYSIS, 2017:20, 20pp.

20

