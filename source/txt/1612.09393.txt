Gabber’s presentation lemma for finite fields

arXiv:1612.09393v3 [math.AG] 3 Jul 2018

Amit Hogadi and Girish Kulkarni
Abstract. We give a proof of Gabber’s presentation lemma for finite fields. We first prove this
lemma in the special case of open subsets of the affine plane using ideas from Poonen’s proof of
Bertini’s theorem over finite fields. We then reduce the case of general smooth varieties to this
special case.

1. Introduction
A presentation lemma proved by Gabber in [2] (see also [1]) plays a foundational role in A1 -algebraic
topology as developed by F. Morel in [4]. This lemma can be thought of as an algebro-geometric
analogue of tubular neighbourhood theorem in differential geometry. The current published proof of
Gabber’s presentation lemma works only over infinite fields. In a private communication to F. Morel,
Gabber has pointed out that the proof of this theorem also holds for finite fields. Unfortunately there
is no published proof for this case.
The goal of this paper is to prove the following version of Gabber’s presentation lemma over finite
fields.
Theorem 1.1. Let X be a smooth variety of dimension d ≥ 1 over a finite field F and Z ⊂ X be a
π
closed subvariety. Let p ∈ Z be a point. Let AdF −
→ Ad−1
denote the projection onto the first d − 1
F
coordinates. Then there exists
(i) an open neighbourhood U ⊂ X of p,
(ii) a map Φ : U → AdF ,
denotes the composition
(iii) an open neighbourhood V ⊂ Ad−1
of Ψ(p) where Ψ : U → Ad−1
F
F
π

Φ

→ Ad−1
U−
→ AdF −
F
such that
(1) Φ is étale.
(2) Ψ|ZV : ZV → V is finite where ZV := Z ∩ Ψ−1 (V ).
(3) Φ|ZV : ZV → A1V = π −1 (V ) is a closed immersion.
Remark 1.2. Without loss of generality, we may (and will) assume henceforth that X is affine.
Moreover, by [1, 3.2], we may also assume that Z is a principal divisor defined by f ∈ O(X) and p is
a closed point.
Remark 1.3. If one finds U, Φ, V, Ψ satisfying conditions (1),(2),(3) of (1.1), one can also arrange,
by shrinking U if necessary, the following additional condition
(4) ZV = Φ−1 Φ(ZV ).
e denote the image of ZV in A1 . The morphism Φ−1 Φ(ZV ) → Z
e is étale, and it
To see this, let Z
V
−1
e
admits a section as ZV maps isomorphically onto Z. Thus Φ Φ(ZV ) is a disjoint union of ZV and
a closed subset T of Ψ−1 (V ). Replacing U by U \T , one sees that the additional condition (4) is
satisfied.
2000 Mathematics Subject Classification. 14F20, 14F42.
1

2

Amit Hogadi and Girish Kulkarni

The proof of Gabber’s presentation lemma for infinite fields (see [2, 3.1] or [1, 3.1]) shows that
for the maps Φ, Ψ appearing in the statement of the lemma, suitable generic choices work. The
problem in making this proof work over a finite field is very similar to the problem of making Bertini’s
theorem work over a finite field. Bertini’s theorem for finite fields was proved by Poonen in [6] using
an extremely clever counting argument. Because of the broad similarities of the issues involved, it
is natural to try to use Poonen’s argument to prove Gabber’s presentation lemma over finite fields.
However, Poonen’s counting argument, in our opinion, is easier to apply in the case of subvarieties of
an affine space. Thus, the first step of the proof of Theorem 1.1 is reduction to the case where X is
an open subset of AdF . This is done in section 2. Unfortunately, we found even this case too complex
to directly apply Poonen’s ideas from [6]. Fortunately, we are able to reduce this complexity by using
induction on d to reduce to the case where d = 2, i.e. X is an open subset of A2F . This is done in
section 3. This induction argument, although short, was one of the most time-taking tasks for us
in proving Theorem 1.1. An important ingredient of this induction is a slightly modified version of
Noether normalization trick (see 3.1).
The case of open subsets of A2F is now ideal for using Poonen’s counting argument. Indeed, the
handling of points of small degree is very similar to that of [6]. However, we are unable to handle the
error term for ‘high degree points’ as is done in [6]. We fix this with a small trick (4.10).
Acknowledgements: We thank F. Morel for his comments and for answering our questions on the
current status of this result. We thank A. Asok, F. Déglise, M. Levine and J. Riou for their comments
during the early stage of this project. We thank Anand Sawant and Charanya Ravi for pointing out
a mistake in the previous version of the paper. We also thank the referee for numerous suggestions.
2. Reduction to open subsets of AdF
The goal of this section is to prove Lemma 2.4, which reduces Theorem 1.1 to the case where X is
an open subset of AdF and p ∈ Z ⊂ X is a closed point with first d − 1 coordinates equal to 0.
Notation 2.1. Throughout this paper we work over a fixed finite field F . We further fix the following
notation.
(1) Let Y be a subset of a scheme X/F . We let Y≤r := {x ∈ Y | deg(x) ≤ r} and similarly
Y<r := {x ∈ Y | deg(x) < r} and Y=r := {x ∈ Y | deg(x) = r}.
(2) For f1 , ..., fi ∈ F [X1 , ..., Xn ] we let Z(f1 , ..., fi ) denote the closed subscheme of AnF defined by
the ideal (f1 , ..., fi ).
We first start by recalling the following standard trick (see [5]) used in the proof of Noether’s
normalization lemma.
Lemma 2.2. [5, page 2] Let k be any field and n ≥ 1 be any integer. Let Z/k be a finitely generated
affine scheme of dimension at most n − 1. Let
(φ1 ,...,φn )

Z −−−−−−→ Ank
be a finite map. Let Q(T ) ∈ k[T ] be a non constant monic polynomial and Q = Q(φn ). Then for
ℓ >> 0, the map
(φ1 −Qℓ

n−1

,...,φn−1 −Qℓ )

Z −−−−−−−−−−−−−−−−→ Akn−1
is finite.
(φ1 ,...,φn )

(φ1 ,...,Q)

Remark 2.3. We claim that finiteness of Z −−−−−−→ Ank implies that of Z −−−−−−→ Ank . This is
because the later map is a composition of the following two finite maps
(φ1 ,...,φn )

(Y1 ,...,Q(Yn ))

Z −−−−−−→ Ank −−−−−−−−−→ Ank .
One can thus easily reduce the proof of the above general case to the case where Q(T ) = T . Unless
explicitly mentioned, we will usually assume Q(T ) = T while applying the lemma. As in the proof of

Gabber’s presentation lemma for finite fields

3

Noether normalization, the above lemma is usually applied repeatedly until one gets a map from Z
dim(Z)
to Ak
.
Lemma 2.4. Let p ∈ Z ⊂ X be as in Theorem 1.1. Further, assume that X is affine, Z is a principal
divisor and p is a closed point (see Remark 1.2). Then there exists a map ϕ : X → AdF and an open
neighbourhood W of ϕ(p) such that
(1) ϕ−1 (W ) → W is étale.
(2) ZW := Z ∩ ϕ−1 (W ) → W is a closed immersion.
(3) The first d − 1 coordinates of ϕ(p) are 0.
In particular, it suffices to prove Theorem 1.1 where X is an open subset of AdF and the first d − 1
coordinates of p are zero.
Proof. Let
- X = Spec (A).
- Z = Spec (A/(f )) and let A := A/(f ).
- m ⊂ A be the maximal ideal of the closed point p.
- F (p) denote the residue field of p.
Step 1: Since X/F is smooth, dimF (p) (m/m2 ) = d. Choose {x1 , ..., xd−1 } ⊂ m such that they span a
d − 1 dimensional F (p)-subspace of m/m2 . In this step we claim that there exists y ∈ A such that
(1) y mod m is a primitive element of F (p)/F .
(2) The set {x1 , ..., xd−1 , h(y)} (modulo m2 ) gives a F (p)-basis of m/m2 , where h is the minimal
polynomial of y mod m.
η
(3) The map (x1 , . . . , xd−1 , y) : X −
→ Ad is étale at p.
(4) The map η induces an isomorphism on residue fields F (η(p)) → F (p).
Now let w ∈ m be an element such that {x1 , ..., xd−1 , w} span m/m2 as a F (p)-vector space. Let c
be a primitive element of F (p)/F and h be its minimal polynomial. Choose ŷ ∈ A such that
ŷ ≡ c
′

mod m.

′

Since c is separable over F , h (c) 6= 0. Thus h (ŷ) ∈
/ m or equivalently h′ (ŷ) is a unit in the ring A/m2 .
Choose ǫ ∈ m such that
w − h(ŷ)
mod m2 .
ǫ≡
h′ (ŷ)
Thus the F (p)-span of {x1 , ..., xd−1 , h(ŷ) + ǫh′ (ŷ)} is m/m2 . Let
y = ŷ + ǫ.
We note that
h(y) = h(ŷ + ǫ) ≡ h(ŷ) + ǫh′ (ŷ) mod m2 .
Hence {x1 , . . . , xd−1 , h(y)} gives a F (p)-basis for m/m2 .
Now let η be the map (x1 , . . . , xd−1 , y) : X −
→ AdF . Since y mod m is a primitive element of F (p),
one observes that F (η(p)) → F (p) is an isomorphism. It remains to show that η is étale at p. The
maximal ideal of η(p) in F [X1 , ..., Xd ] is n = (X1 , . . . , Xd−1 , h(Xd )). As {x1 , . . . , xd−1 , h(y)} is a
F (p)-basis for m/m2 , that η is étale at p follows from the surjectivity of
η∗

n/n2 −→ m/m2 .
Step 2: Let U be an open neighbourhood of p in X such that η|U is étale. Let
B = (X \ U ) ⊔ Z.
In this step we modify x1 , . . . , xd−1 to z1 , . . . , zd−1 so that
(1) The map ηe = (z1 , . . . , zd−1 , y) : X → AdF is étale on U .
(2) The set {z1 , . . . , zd−1 , h(y)} is a F (p) basis for m/m2 .
(z1 ,...,zd−1 )

(3) The map B −−−−−−−−→ Ad−1
is finite.
F

4

Amit Hogadi and Girish Kulkarni

e := A/I(B) and m
e For any element α ∈ A, let α
e denote the image of m in A.
Let A
e denote its
e
image in A. Choose y1 , ..., ym ∈ A which generate A as an F algebra. We expand this generating set
to include the xi ’s. In particular
A = F [x1 , ..., xd−1 , y1 , ..., ym ],

e = F [e
A
x1 , ..., x
ed−1 , ye1 , ..., yem ].

The image of yi in A/m satisfies a non-constant monic polynomial, say fi , over F . Let
yi,0 := fi (yi ) ∈ m.
xi,0 := xi
A0 := F [x1,0 , .., xd−1,0 , y1,0 , ..., ym,0 ]

e is finite over A
e0 .
Clearly, A

e0 := F [e
A
x1,0 , .., x
ed−1,0 , ye1,0 , ..., yem,0 ]

For 0 ≤ r ≤ m − 1, we inductively define Ar+1 and elements xi,r+1 , yi,r+1 as follows. By 2.2, we
er a finite A
er+1 -algebra. Since any
choose an integer ℓr > 1 such that the following definitions make A
sufficiently large choice of ℓr works, we assume that ℓr is a multiple of the char(F ). Let
i

xi,r+1 := xi,r − (ym−r,r )ℓr

∀ 1≤i≤d−1

ℓd−1+i
r

∀ 1≤i≤m−r−1

yi,r+1 := yi,r − (ym−r,r )

Ar+1 := F [x1,r+1 , .., xd−1,r+1 , y1,r+1 , ..., ym−r−1,r+1 ]
er+1 := F [e
A
x1,r+1 , .., x
ed−1,r+1 , ye1,r+1 , ..., yem−r−1,r+1 ]

Since, xi,0 and yi,0 belong to m, inductively one can observe
yi,r ∈ m
xi,r ∈ m

xi,r+1 ≡ xi,r mod m2
For ease of notation, let us rename
zi := xi,m .
Note that for all i ≤ d − 1, zi − xi is of the form βiki for βi ∈ m and an integer ki divisible by char(F ).
This ensures requirements (1) and (2) of Step 2. Recall that m is an integer such that {y1 , ..., ym } are
the chosen generators of A as an F algebra. It is now straightforward to see that {z1 , ..., zd−1 } ⊂ m
e is a finite algebra over A
em = F [e
such that A
z1 , ..., zed−1 ].

Step 3: In this step we will further modify y while ensuring that (1) and (2) of the above step continue
to hold. Since the map ηe|B : B → Ad−1
is finite, there exists finitely many points {p, p1 , ..., pt } ⊂ B
F
which are contained in the zero locus Z(z1 , ..., zd−1 ). Let mi be the maximal ideal corresponding to pi
for 1 ≤ i ≤ t. By Chinese remainder theorem, choose δ ∈ A such that
δ ≡ 0 mod m
δ

char(F )

≡ −y mod mi ∀ 1 ≤ i ≤ t

...(note that A/mi is perfect)

Let
z = y + δ char(F ) .
For later use, we note that
z ≡ 0 mod mi ∀ 1 ≤ i ≤ t.
Using the fact that z − y is char(F )-th power of an element of m, it is straightforward to deduce the
following from (1) and (2) of the above step.

Gabber’s presentation lemma for finite fields

5

(1) The map ϕ : X → AdF defined by (z1 , ..., zd−1 , z) is étale at p.
(2) {z1 , ..., zd−1 , h(z)} is an F (p)-basis of m/m2 .
(3) z mod m is the primitive element c of F (p)/F .
e = A/(I(B)) :
We further claim that we have the following equality of ideals of A
p
e
(e
z1 , ..., zed−1 , h(e
z )) = m.

To see the claim, we first observe

e
h(z) ∈ m

ei
h(z) ∈
/m

∀ 1 ≤ i ≤ t.

The first containment follows as h is the irreducible polynomial of z mod m. Moreover, since h(0) 6= 0,
the second statement follows from the fact that z ≡ 0 mod mi .
e containing the ideal (e
e m
e 1 , ..., m
e t } are the only prime ideals of A
As {m,
z1 , ..., zed−1 ), and h(z) ∈
/ mi ∀ i,
e containing the ideal (e
e is the unique prime ideal of A
we conclude that m
z1 , ..., zed−1 , h(e
z )). Therefore
p
e
(e
z1 , ..., zed−1 , h(e
z )) = m.
Step 4: We claim that in fact


e
ze1 , ..., zed−1 , h(e
z ) = m.

e
Note that both are m-primary
ideals and hence it is enough to show the equality in the localization
e
e 2 as
Am
e . But the equality holds in this local ring by Nakayama’s Lemma since it holds modulo m
2
2
{z1 , ..., zd−1 , h(z)} mod m gives a basis of m/m (see condition (2) of the the above Step).

Step 5: Recall that ϕ : X → AdF is the map defined by (z1 , ..., zd−1 , z). We claim that p is the
unique point in ϕ−1 ϕ(p) ∩ Z. In fact we have that p is the unique point of ϕ−1 ϕ(p) ∩ B. This is
e is equal to
a direct consequence of Step 3, since the ideal defining ϕ−1 ϕ(p) ∩ B in B = Spec (A)
e . Indeed, what we have observed is that the scheme ϕ−1 ϕ(p) ∩ B is reduced and
(e
z1 , ..., zed−1 , h(e
z )) = m
has p as the only underlying point. Thus the same holds for ϕ−1 ϕ(p) ∩ Z. If n denotes the maximal
ideal in the coordinate ring of AdF of the point ϕ(p), then nA = m. Recall that A := A/(f ) and
Z = Spec (A).
Step 6: In this step we prove the rest of the theorem using a trick used in the proof of [1, 3.5.1]. In
fact, the argument in this step has been directly taken from loc. cit. The map ϕ : Z → AdF is finite.
Let n be the maximal ideal of ϕ(p) in F [X1 , ..., Xd ]. By Step 5, nA = m and the map
F [X1 , ..., Xd ] ϕ∗ A
−−→
n
nA
is an isomorphism, in particular surjective. By Nakayama’s lemma, there exists a g ∈ F [X1 , ..., Xd ]\n
such that the map
F [X1 , ..., Xd ]g → Ag
is surjective. In particular, if V = AdF \Z(g), then
Z ∩ ϕ−1 (V ) → V
is a closed immersion. Note that V is an open neighbourhood of ϕ(p).
Let D ⊂ X be the maximal closed subset on which the map ϕ is not étale. Clearly p ∈
/ D. Also, since
D is a subset of B (see Step 2) and p is the only point in ϕ−1 ϕ(p) ∩ B, we must have ϕ(p) ∈
/ ϕ(D).
However, the map ϕ|B is finite, we have that ϕ(D) is a closed subset of AdF . Let


W := AdF \ϕ(D) ∩ AdF \Z(g) .

6

Amit Hogadi and Girish Kulkarni

Thus ϕ−1 (W ) → W is étale. Moreover, ϕ−1 (W ) is an open neighbourhood of p. It is now clear that
ϕ and W satisfy conditions (1) and (2) of the Lemma. Condition (3) is also immediate since the map
ϕ is defined by (z1 , ..., zd−1 , z) and zi vanish on p for 1 ≤ i ≤ d − 1.

3. Reduction to open subsets of A2F
The previous section reduces the general case of Theorem 1.1 to the case where X is an open subset
of AdF . The goal of this section is to further reduce to the case where d = 2 (see Lemma 3.8). This
reduction, which is an induction argument, is an important step in the proof of Theorem 1.1. One of
the ingredients required for this induction argument to work is the following variation of the standard
Noether normalization trick (see (2.2)).
Lemma 3.1. Let n ≥ 2 be any integer, k be any field and Z/k be an affine variety of dimension n − 1.
Let
(φ1 ,...,φn )
Z −−−−−−→ Ank
be a finite map. Let Q ∈ k[φn ] be a non constant monic polynomial. Then for an integer ℓ >> 0, the
map
(φ1 −Qℓ1 ,...,φn−1 −Qℓn−1 )

Z −−−−−−−−−−−−−−−−→ Akn−1
is finite, where Qi ’s are inductively defined by
Qn−1 := Q.
Qi := φi+1 − Qℓi+1

∀ 1 ≤ i ≤ n − 2.

Proof. The proof is similar to that of 2.2 (see [5, page 2]) and hence we only give a sketch. Since
dim(Z) = n − 1, φ1 , φ2 , . . . , φn cannot be algebraically independent. Thus there exists a non-zero
polynomial f ∈ k[Y1 , ..., Yn ] such that f (φ1 , φ2 , . . . , φn ) = 0. Let ℓ be any integer greater than
e ∈ k[Yn ] be a polynomial such that Q = Q(φ
e n ).
ndeg(f ) where deg(f ) is the total degree of f . Let Q
e
Inductively define Qi for 1 ≤ i ≤ n − 1 as follows:
e n−1 := Q
e
Q

e i := Yi+1 − Q
eℓ
Q
i+1

∀ 1 ≤ i ≤ n − 2.

e i ’s are defined such that
Notice that the polynomials Q

e i (φ1 , ..., φn ) = Qi .
Q

e then each Q
e i is monic in Yn of degree ℓn−i−1 d. Consider
Moreover, we note that if d = Yn -degree of Q
the elements Z1 , ..., Zn−1 ∈ k[Y1 , ..., Yn ] defined as follows:
eℓ
Zi := Yi − Q
i

∀1 ≤ i ≤ n − 1.

We leave it to the reader to check that

k[Z1 , ..., Zn−1 , Yn ] = k[Y1 , ..., Yn ].
For future reference, we note that the map
e ℓ ,...,Yn−1 −Q
eℓ
(Y1 −Q
1
n−1 ,Yn )

η : AnF −−−−−−−−−−−−−−−−−−→ AnF
is an automorphism. It is enough to show that the polynomial f , expressed in the variables Z1 , ..., Zn−1 , Yn
is monic in Yn . Let us write f as
f = ΣI=(i1 ,...in ) αI · mI
where mI ’s are monomials in Y1 , ..., Yn and αI ∈ k. We leave it to the reader to verify that when
expressed in new coordinates Z1 , . . . Zn−1 , Yn , each monomial mI becomes a polynomial which is
n−1
monic in Yn of Yn -degree equal to in + Σk=1
ik · ℓn−k · d. Since ℓ > ndeg(f ), one can show that these
Yn -degrees are distinct. Thus in the coordinates Z1 , ..., Zn−1 , Yn , f remains monic in Yn .


Gabber’s presentation lemma for finite fields

7

Notation 3.2. Let d ≥ 2 be an integer and f, g ∈ F [X1 , ..., Xd ] be nonzero polynomials with no
common irreducible factors (see Remark 3.5). Let X := AdF \Z(g) and Z := Z(f ) ∩ X. Let p ∈ Z be a
closed point (see Remark 1.2) whose first d − 1 coordinates are 0.
Recall that by 2.4 it is enough to prove Theorem 1.1 for (X, Z, p) as above. In order to prove this, we
have to first come up with a map from Φ : X → AdF . Indeed, we will look for maps Φ which are defined
on the whole of AdF . In other words, we will look for suitable polynomials {φ1 , ..., φd } ⊂ F [X1 , ..., Xd ].
The goal of the following definition is to list necessary conditions on these polynomials which will
ensure (see Lemma 3.4) that the resulting map Φ is as desired in (1.1).
Definition 3.3. Let f, g, X, Z, p be as in Notation 3.2. For {φ1 , ..., φd } ⊂ F [X1 , ..., Xd ], let
(φ1 ,...,φd )

(i) Φ : AdF −−−−−−→ AdF .
(ii)
We say
(1)
(2)
(3)
(4)

(φ1 ,...,φd−1 )

Ψ : AdF −−−−−−−−→ Ad−1
F .
that (φ1 , ..., φd ) presents (X, Z(f ), p) if
Ψ|Z(f ) is finite and Ψ(p) = (0, ..., 0).
Ψ−1 Ψ(p) ∩ Z(f ) ⊂ Z
Φ is étale at S := Ψ−1 Ψ(p) ∩ Z.
Φ is radicial at S.

Recall that Φ is said to be radicial [7, Tag 01S2] if Φ|S is injective and for all x ∈ S the residue
field extension F (x)/F (Φ(x)) is trivial.
The following lemma shows that in order to prove Theorem 1.1 for X, Z, p as in Notation 3.2, it is
enough to find φ1 , ..., φd which presents (X, Z(f ), p).
Lemma 3.4. Let X, Z, p be as above. Assume there exists {φ1 , ..., φd } which presents (X, Z(f ), p) and
Φ, Ψ be as in Definition 3.3. Then there exist open neighborhoods V ⊂ Ad−1
of Ψ(p) and U ⊂ X of p,
F
such that Φ|U , Ψ|U , U, V satisfy conditions (1),(2),(3) of Theorem 1.1. Moreover, Ψ−1 (V ) ∩ Z(f ) ⊂ U .
Proof. The argument here is directly taken from [1, 3.5.1]. We construct an open neighbourhood V
−1
of Ψ(p) in Ad−1
(V ) ∩ Z(f ) then
F , such that if ZV := Ψ
(i) ZV ⊂ Z
(ii) Φ is étale at all points in ZV
(iii) Φ|ZV : ZV → A1V is closed immersion
Let B be the smallest closed subset of Z(f ) containing all points of Z(f ) at which Φ is not étale and
also containing Z(f )\Z. Since Ψ|Z(f ) is a finite map, Ψ(B) is closed in Ad−1
F . Moreover, because
of conditions (2) and (3) of Definition 3.3, we have Ψ(p) ∈
/ Ψ(B). Thus, we can choose affine open
−1
subset W ⊂ Ad−1
such that Ψ(p) ∈ W ⊂ Ad−1
(W ). We have following
F
F \Ψ(B). Let ZW = Z ∩ Ψ
commutative diagram of affine schemes and consequently their coordinate rings.
Φ
ZW

A1W

Φ∗
F [ZW ]

π
Ψ

F [A1W ]

Ψ∗

W

F [W ]

Let Ψ(p) = q and mq be the maximal ideal in F [W ] corresponding to q. Thus the ideal corresponding
to S = Ψ−1 (q) ∩ Z in F [ZW ] is mq · F [ZW ]. Since Φ is radicial as well as étale at S,
Φ|S : S ֒→ A1W
is a closed immersion. Thus the map on the coordinate rings
F [ZW ]
F [A1W ] ։
mq F [ZW ]

8

Amit Hogadi and Girish Kulkarni

is surjective. The surjectivity of the above map is equivalent to
C ⊗F [W ]

F [W ]
=0
mq

where


C := Coker F [A1W ] → F [ZW ] .
But C is a finite F [W ] module. Hence by Nakayama’s lemma Cmq = 0. Thus there exists h ∈ F [W ]\mq
such that Ch = 0 or equivalently
F [A1W ]h ։ F [ZW ]h
is surjective. Let V := W \Z(h). The coordinate ring of ZV := Ψ−1 (V ) ∩ Z(f ) is F [ZW ]h and that of
π −1 V is F [A1W ]h . Thus the surjectivity of the above map implies that
ZV ֒→ A1V
is a closed immersion as required.
Let U ⊂ X be the maximal open subset containing points at which Φ is étale. To finish the proof, we
need to show that U, V, Φ|U , Ψ|U satisfy conditions (1), (2), (3) of Theorem 1.1. (1) is clearly satisfied
by the definition of U . To see (2), note that Ψ|Z(f ) is finite, and hence, as ZV = Ψ−1 (V ) ∩ Z(f ),
Ψ|ZV : ZV → V is finite. (3) is precisely the condition (iii) mentioned at the beginning of the proof.
By the construction of W , subsequently V , it follows that Ψ−1 (V ) ∩ Z(f ) ⊂ U .

Remark 3.5. Since our main goal is to prove Theorem 1.1 for (X, Z, p), we may change Z(f ) as long
as it does not change Z. If f and g have common irreducible factors, dividing f by the g.c.d. of f
and g does not change Z(f )\Z(g). This justifies our assumption in Definition 3.2 that f, g have no
common irreducible factors.
The following lemma is proved using a simple coordinate change argument. It will be used in the
proof of (3.8), which is the main result of this section.
Lemma 3.6. Let (φ1 , ..., φd ) present (X, Z(f ), p). as in Lemma 3.4. Then there exist (φe1 , ..., φed )
which present (X, Z(f ), p) such that there exists an open subset V ⊂ Ad−1
satisfying the conclusion of
F
Lemma 3.4 for (φe1 , ..., φed ) and which satisfies the following additional condition:



d−1
= 0.
dim Z(φe1 , ..., φed−2 ) ∩ Ψ−1
A
\V
F
|Z(f )

Proof. We note that if d = 2, by convention,

−1
1
1
Z(φe1 , ..., φed−2 ) ∩ Ψ−1
|Z(f ) (AF \V ) = Ψ|Z(f ) (AF \V )

which is of zero dimension since V is non-empty. Thus we may assume d ≥ 3. For an integer ℓ,
consider the automorphism ρ : Ad−1
→ Ad−1
induced by
F
F
(d−1)−1

ℓ
(X1 , ..., Xd−1 ) 7→ (X1 − Xd−1

(d−1)−2

ℓ
, X2 − Xd−1

1

ℓ
, ..., Xd−2 − Xd−1
, Xd−1 ).

We choose ℓ >> 0, such that by (2.2), (X1 , ..., Xd−2 )|ρ(Ad−1 \V ) is a finite map. Let
d−1−i
φei := φi − φeℓd−1

φei := φi

for i ≤ d − 2

for i = d − 1, d

It is then straightforward to check that (φe1 , ..., φed ) presents (X, Z(f ), p) (since it is obtained by a
coordinate change from the original φi ’s) and moreover


dim Z(φe1 , ..., φed−2 ) ∩ Ψ−1 (Ad−1 \ρ(V )) = 0.
|Z(f )

F



Gabber’s presentation lemma for finite fields

9

Lemma 3.7. Let d ≥ 3, and f, g ∈ F [X1 , ..., Xd ] be two non-zero polynomials with no common
factors. Let p be a closed point of AdF such that Xi (p) = 0 for all i ≤ d − 1. Then there exists a
coordinate change of F [X1 , ..., Xd ], i.e. elements Yi ∈ F [X1 , ..., Xd ] with
F [X1 , ..., Xd ] = F [Y1 , ..., Yd ]
such that f (0, Y2 , ..., Yd ) and g(0, Y2 , ..., Yd ) are nonzero polynomials with no common irreducible factors and Yi (p) = 0 for all i ≤ d − 1.
Proof. The condition that f (0, Y2 , ..., Yd ) and g(0, Y2 , ..., Yd ) are nonzero polynomials with no common
irreducible factors is equivalent to the condition that no irreducible component of Z(f ) ∩ Z(g) is
contained in Z(Y1 ).
By Noether normalization trick 2.2, we may assume, by a suitable coordinate change, that the
projection
η
(X2 , ..., Xd ) : Z(f ) ∩ Z(g) −
→ Ad−1
F
is finite. Note that since d ≥ 3, the image of every irreducible component of Z(f ) ∩ Z(g) under η
is of dimension at least one. Thus we may choose closed points z1 , ..., zτ , one in each irreducible
component of Z(f ) ∩ Z(g) such that η(zi ) are pairwise distinct and also different from η(p). For every
closed point x of AdF , either X1 or X1 + 1 is non-vanishing on x. Thus for each zi , we choose ǫi = 0 or
1, such that X1 + ǫi does not vanish on zi . By Chinese remainder theorem, there exists a polynomial
γ ∈ F [X2 , ..., Xd ] such that
γ(η(zi )) = ǫi and γ(p) = 0.
It is now straightforward to check that
Y1 := X1 − γ

and Yi := Xi ∀ 2 ≤ i ≤ d

satisfies our requirement.



Lemma 3.8. [Reduction to d = 2] Assume that for d = 2 and every f, g, X, Z, p as in Notation 3.2,
there exists φ1 , φ2 ∈ F [X1 , X2 ] which presents (X, Z(f ), p). Then the same holds for every d ≥ 2.
Proof. We prove this lemma by induction on d. Assume d ≥ 3.
Step 0: As before, we let F [X1 , ..., Xd ] be the coordinate ring of AdF . Let f (X2 , ..., Xd ) := f (0, X2 , ..., Xd )
and g(X2 , ..., Xd ) := g(0, X2 , ..., Xd ). By Lemma 3.7, we may assume that then f and g are non-zero
and have no common factors. We let
- X := X ∩ Z(X1 ).
- Z := Z ∩ X.
Note that p ∈ Z and X = Z(X1 )\Z(g) where Z(X1 ) ∼
with coordinate ring F [X2 , ..., Xd ]. By
= Ad−1
F
induction, there exist {φ2 , ..., φd } ⊂ F [X2 , ..., Xd ] which presents (X, Z(f ), p). Let
Φ := (φ2 , ..., φd ) and Ψ := (φ2 , ..., φd−1 ).
By Lemma 3.4, there exist neighbourhoods V ⊂ Ad−1
and U ⊂ X of Ψ(p) and p respectively such
F
that if
−1
Z V := Z ∩ Ψ (V )
then the following conditions of Theorem 1.1
(1) Φ|U is étale
(2) Ψ|Z : Z V → V is finite
V

(3) Φ|Z : Z V → A1V is a closed immersion
V

are satisfied.
Further, by Lemma 3.6, we also assume (without loss of generality) that if E is the closed subset of
Z(f¯) defined by
−1
E := Z(f¯)\Ψ (V )
then

10

Amit Hogadi and Girish Kulkarni

(4) dim(E ∩ Z(φ2 , ..., φd−2 )) = 0.
Note that (4) is vacuously satisfied unless d ≥ 4. Indeed for d = 3, Ad−2
\ V is a finite set, and since
F
d−2
¯
Ψ|Z(f ) : Z(f ) → AF is finite, E is thus a finite set.
(φ2 ,...,φd−1 )

Step 1: Since Z(f ) −−−−−−−−→ Ad−2
is finite (see 3.3(1)), for 2 ≤ i ≤ d, the image of Xi in
F
F [X2 , ..., Xd ]/(f ) satisfies a monic polynomial
Pi (T ) := T mi + ami −1,i T mi −1 + · · · + a0,i
where each ai,j ∈ F [φ2 , ..., φd−1 ]. So Pi (Xi ) is zero in F [X2 , ..., Xd ]/(f¯). Note that each φi is an
element of F [X2 , ..., Xd ]. Thus we have a map of algebras
F [φ2 , ..., φd−1 ][T ] → F [X1 , ..., Xd ][T ]/(f ).
We let Pei (T ) be the image of the polynomial Pi (T ) under this map. Since Pi (Xi ) is zero in F [X2 , ..., Xd ]/(f¯),
Pei (Xi ) maps to zero via the map
X 7→0

F [X1 , ..., Xd ]/(f ) −−1−−→ F [X2 , ..., Xd ]/(f ).

Therefore

Pei (Xi ) = X1 gi
for some gi ∈ F [X1 , ..., Xd ]/(f ). We claim that the map

(φ ,...,φ ,X1 ,X1 g2 ,...,X1 gd )

2
Z(f ) −−−
−−−d−−−−−−−−−−−−→ A2d−1
F

is finite. This is clear because for i ≥ 2, each Xi satisfies the monic polynomial Pei (T ) − X1 gi with
coefficients which are polynomial expressions in the functions defining the above map. Applying 2.2
repeatedly to this map (see Remark 2.3), we get φ2 , ..., φd ∈ F [X1 , ..., Xd ] such that
φi ≡ φi mod X1
and the map (φ2 , ..., φd )|Z(f ) is finite.
Step 2: Consider the maps
(X1 ,φ2 ,...,φd )
e : Ad −
Φ
→ AdF
F −−−−−−−−
(X
,φ
,...,φ
)
1
2
d−1
e : Ad −−−−−−−−−−→
Ψ
Ad−1
F
F .

φ2 ,...,φd
e is étale at x iff Z(X1 ) −
−−−−→ Ad−1
is étale at x. Let E be the
Note that for all points x ∈ Z(X1 ), Φ
F
closed subset of Z(f ) ⊂ Z(f ) defined in Step 0. We have the following:
e |Z(f ) is finite. In fact, the map (φ2 , ..., φd )|Z(f ) is finite.
(1) Φ
e
e
(2) Ψ(p)
∈
/ Ψ(E)
(this follows from the definition of E)
e
(3) Φ restricted to Z(f )\E is a locally closed immersion.
e is étale at all points in Z(f )\E.
(4) Φ

By condition (4) of Step 0,

E ∩ Z(φ2 , ..., φd−2 ) = E ∩ Z(φ2 , ..., φd−2 )1

is finite. Let Q be any non-constant polynomial expression in φd which vanishes on the finite set


 	
E ∩ Z(φ2 , ..., φd−2 ) ∪ p .

Let ℓ be a large enough integer which is divisible by char(F ). Let φ1 = X1 and as in Lemma 3.1, let
Qd−1 := Q and
Qi := φi+1 − Qℓi+1 ∀ i ≤ d − 2.
Let
Φ := (φ1 − Qℓ1 , . . . , φd−1 − Qℓd−1 , φd ) : AdF −→ AdF
1where by convention Z(φ , ..., φ
d
2
d−3 ) is the whole of AF if d ≤ 3.

Gabber’s presentation lemma for finite fields

11

Ψ := (φ1 − Qℓ1 , . . . , φd−1 − Qℓd−1 ) : AdF → Ad−1
F .
By Lemma 3.1 Ψ|Z(f ) is finite. We let S be the finite set of points in Ψ−1 Ψ(p) ∩ Z(f ). To
finish the proof, it suffices to verify the conditions (2)-(4) of Definition (3.3). We first note that
S ⊂ Z(φ1 , ..., φd−2 ). This is because if x ∈ S, then by definition of S,
φi+1 − Qℓi+1 (x) = Qi (x) = 0

∀ i ≤ d − 2.

And thus
φi − Qℓi (x) = φi (x) = 0 ∀ i ≤ d − 2.
We now show that S is disjoint from E. First note that S ⊂ Z(φ1 ) = Z(X1 ). Also Ψ(p) = 0 since
Q(p) = 0 and φi (p) = 0 for 1 ≤ i ≤ d − 1. Let x ∈ S ∩ E if possible. Hence x is necessarily in
E ∩ Z(φ2 , ..., φd−2 ) by the above argument. In particular we note that φd−2 (x) = 0. Now we claim
that
φd−1 (x) = 0.
Since Ψ(x) = 0 we have (φd−2 − Qℓd−2 )(x) = 0. But as φd−2 (x) = 0, we conclude that
Qd−2 (x) = 0.
Thus
φd−1 (x) = (Qd−2 − Qℓ )(x) = 0.
This proves the claim. Consequently, x ∈ Z(φ2 , . . . φd−1 ). By definition of E, x ∈ E implies Ψ̄(x) ∈
/ V̄
where V̄ is as defined in Step 0. As V̄ is a neighborhood of 0 = Ψ(p), we have Ψ̄(x) 6= 0. But as
x ∈ E ⊂ Z(X1 ), we have
Ψ̄(x) = (φ2 , ..., φd−1 )(x) = (φ̄2 , ..., φ̄d−1 )(x).
Hence φi (x) 6= 0 for some i with 2 ≤ i ≤ d − 1. This is a contradiction to the fact that x ∈
e is a locally closed immersion on S by
Z(φ2 , . . . φd−1 ). Hence S must be disjoint from E. Hence Φ
property (3) of Step 2.
As in the proof of Lemma 3.1, we let
η

Ad−2
−−−→ Ad−2
F
F
be the automorphism defined by
e ℓ1 , . . . , Yd−1 − Q
e ℓd−1 , Yd )
η = (Y1 − Q

e i ∈ F [Y1 , ..., Yd ] are polynomials satisfying Qi = Q
e i (φ1 , ..., φd ). It is straightforward to check
where Q
that
e
Φ = η ◦ Φ.
Hence Φ is a locally closed immersion on S, this proves condition (4) of Definition 3.3.
From Lemma 3.4 we have Z(f ) ∩ Ψ−1 (V ) ⊂ X. This with the fact that Z = Z(f ) ∩ X implies
conditions (2) of Definition 3.3. For checking condition (3), i.e. to check Φ is étale at all points in S,
e is étale. In
we note that since ℓ is divisible by char(F ), Φ is étale precisely at those points where Φ
particular Φ is étale at all points of Z(f )\E.

4. Open subsets of A2F

In this section, we finish the proof of Theorem 1.1. By Lemmas 2.4, 3.8 we only have to deal with
the case of open subsets of A2F . While the handling of low degree points is similar, in spirit, to that
of [6], for high degree points we proceed differently (see Lemma 4.10).
Lemma 4.1. Let F be a finite field as before, and C ⊂ A2F be a closed curve such that the projection
onto the Y -coordinate Y|C : C → A1F is finite. Let C (1) denote the set of closed points of C. Then the
following set of points is dense in C

	
x ∈ C (1) | degF (Y (x)) = degF (x) .

12

Amit Hogadi and Girish Kulkarni

Proof. Without loss of generality, we may assume C is irreducible and hence we simply have to show
that the set

	
x ∈ C (1) | degF (Y (x)) = degF (x)
is infinite. Let x1 , ..., xq be the F -rational points of A1F . Let C ′ := C\Y −1 ({x1 , ..., xq }). C ′ is a
dense open subset of C as Y|C is finite. Now, any point x ∈ C ′ of prime degree satisfies degF (Y (x)) =
degF (x). By Lang-Weil estimates [3], for all large enough prime number ℓ, there is a point x ∈ C ′(1) of
degree ℓ. Hence, since ℓ is a prime, we must have degF (Y (x)) = degF (x). This proves the lemma. 
Notation 4.2. Let
(1) A = F [X, Y ] and for d ≥ 0 let A≤d = {h ∈ A | deg(h) ≤ d}. Here deg(h) denotes the total
degree.
(2) f, g ∈ A be two non-constant polynomials, with no common irreducible factors. By performing
a change of coordinates if necessary, we will assume that f is monic in X of degree m.
(3) W := A2F \Z(g). In this section, we call our variety W instead of X, since the later will denote
a coordinate function on A2F .
(4) Z := Z(f ) ∩ W . Note that Z(f )\Z is finite as f, g have no common irreducible components.
(5) p ∈ Z be a closed point such that its X-coordinate is 0. We also choose a set of closed points
{p1 , ..., pt } in Z such that the set T := {p, p1 , ..., pt } satisfies
(a) T contains at least one point from each irreducible component of Z.
(b) No two points in T have same degrees and for all pi ∈ T , deg(Y (pi )) = deg(pi ). This
can be ensured by Lemma 4.1. Note that since X-coordinate of p is 0, we also have
deg(Y (p)) = deg(p).
(6) Let D = {q1 , . . . , qs } be a finite set of closed points in Z(f ) satisfying:
(a) D contains all points in Z(f )\Z.
(b) D contains at least one point from each irreducible component of Z(f ).
(c) D does not contain any point of {p, p1 , ..., pt }.
Moreover, for a point x in Z(f ), the notation Ox (resp. mx ) will denote OA2F ,x (resp. mA2F ,x ) i.e. the
local ring (resp. maximal ideal) of x as a point of A2F .
The main result of this section is the following.
Theorem 4.3. There exists (φ1 , φ2 ) ∈ F [X, Y ] which presents (W, Z(f ), p).
This is enough to prove Theorem 1.1.
Proof of 1.1. This follows from Lemmas 2.4, 3.4 and 3.8 and Theorem 4.3.



To prove 4.3, we will find φ1 by using Lemma 4.4 and φ2 by Lemma 4.10. We heavily use the
counting techniques by Poonen [6] to prove these lemmas.
Recall from 2.1, for Y a subset of a scheme X/F , Y≤r := {x ∈ Y | deg(x) ≤ r}.
Lemma 4.4. Let the notation be as in 4.2. There exists c ∈ N, such that for every d >> 0, there
exists a φ ∈ A≤d satisfying
(1) φ(p) = φ(pi ) = 0 for all i = 1, ..., t and φ(qi ) 6= 0 for all i = 1, . . . , s.
(2) (φ, Y ) is étale at all x ∈ S where S := Z(φ) ∩ Z.
(3) The projection Y : A2F → A1F is radicial at S≤(d−c)/3 .
Remark 4.5. The above lemma is motivated by writing down conditions for φ such that (φ, Y )
presents (W, Z(f ), p), and then keeping only those which we can prove. Indeed, if φ|Z(f ) is a finite map
and Y is radicial at whole of S (as opposed to S(d−c)/3 above), then (φ, Y ) would present (W, Z, p)
thereby proving (4.3).
Remark 4.6. The set S = Z(φ) ∩ Z appearing in the statement of the above Lemma is necessarily
finite. This is because, in each irreducible component of Z, there is at least one qi (see (4.2)(6)(b))
on which φ does not vanish. Since T intersects each irreducible component of Z(f ) (see (4.2)(5)(a)),
we know that any open neighbourhood of S is dense in Z(f ).

Gabber’s presentation lemma for finite fields

13

Following [6] define the density of a subset C ⊂ A by
µ(C) := lim

#

d→∞

(C ∩ A≤d )
# A≤d

provided the limit exists. Similarly, the upper and lower densities of C, denoted by µ(C) and µ(C), are
defined by replacing limit in the above expression by lim sup and lim inf respectively.
To prove the existence of φ in 4.4, we will show that the density of such φ is positive. We prove
Lemma 4.4 in two steps. First, we show (Lemma 4.8) that φ satisfying conditions (1), (3) and condition (2) for points upto certain degree, exists. Next, we show (Lemma 4.9) that the set of φ which
does not satisfy condition (2) for points of higher degrees has zero density.
Let φ ∈ A and r ≥ 1 be an integer. Consider the following conditions on φ, which are closely
related to the conditions (1), (2) and (3) of Lemma 4.4.
(a) φ(p) = φ(pi ) = 0 for all 1 ≤ i ≤ t and φ(qi ) = 1 for all 1 ≤ i ≤ s.
∂φ
(br ) For all x ∈ Z(f )≤r such that φ(x) = 0, ∂X
(x) 6= 0.
(cr ) For all points x1 , x2 ∈ Z(f )≤r , such that deg(x1 ) = deg(x2 ) = deg(Y (x1 )) = deg(Y (x2 )) and
φ(x1 ) = φ(x2 ) = 0, we have Y (x1 ) 6= Y (x2 ).
(dr ) For all x ∈ Z(f )≤r such that φ(x) = 0, deg(Y (x)) = deg(x).
It is easily seen that
Remark 4.7. The main motivation for introducing the above conditions, are the following straightforward implications between them and the conditions of 4.4
- φ satisfies (4.4)(1) if φ satisfies (a).
- φ satisfies (4.4)(2) iff φ satisfies (br ) for all r ≥ 1.
- φ satisfies (4.4)(3) iff φ satisfies (cr ) and (dr ) for all r ≤ (d − c)/3.
Lemma 4.8. There exists integers r0 , c ∈ N, with

	
r0 > max deg(p), deg(p1 ), ..., deg(pt ), deg(q1 ), ..., deg(qs )

such that the lower density of the set
o
[ n
φ ∈ A≤d | φ satisfies (a), (b(d−c)/3 ), (c(d−c)/3 ), (d(d−c)/3 ) and φ(x) = 1 ∀ x ∈ Z(f )≤r0 \T
P :=
d>c+2r0

is positive.

Proof. By Lang-Weil estimates [3] there exists c′ ∈ N such that for all n ≥ 1,

# Z(f )=n ≤ c′ · q n .

For reasons which be clear during the course of the calculations below, we choose r0 and c as
follows. Recall that m is the X-degree of f . Let r0 be any integer satisfying

	
(i) r0 > max deg(p),
deg(p1 ), ..., deg(p
t ), deg(q1 ), ..., deg(qs ) .
!
!
 
X
X 1
m
m
′
<
1
−
·
c
+
q −deg(x) .
+
(ii)
qi
2
2
x∈T

i>r0 /m

Note that it is always possible to ensure (ii) as
!
X 1
→0
qi

as r0 → ∞

i>r0 /m

and as degrees of points in T are distinct we have
∞
X
X
−deg(x)
q −i ≤ 1.
q
<
x∈T

i=1

14

Amit Hogadi and Girish Kulkarni

Let

X

c=

deg(x).

x∈Z(f )≤r0

Let d ≥ c + 2r0 be any integer and r := (d − c)/3. Let
	

T := φ ∈ A≤d | φ satisfies (a) and φ(x) = 1 ∀ x ∈ Z(f )≤r0 \T .

	
Tb := φ ∈ T | φ does not satisfy(br )

	
Tc := φ ∈ T | φ does not satisfy(cr )

	
Td := φ ∈ T | φ does not satisfy(dr )

Let

δ :=

T
, δb :=
# A≤d
#

Tb
, δc :=
# A≤d
#

Tc
, δd :=
# A≤d
#

Td
.
A≤d

#

#

In the following steps we will estimate δ, δb , δc , δd .
Step 1 : (Estimation for δ) : Note that the condition that φ belongs to T depends solely on the
image of φ in the zero dimensional ring
Y
(Ox /mx ).
x∈Z(f )≤r0

Since the dimension over F of the above ring is c and since d ≥ c, by [6, Lemma 2.1] the map
Y
ρ
(Ox /mx )
A≤d −→
x∈Z(f )≤r0

is surjective. One can easily see that T is a coset of Ker(ρ). Therefore
Y
q −deg(x) .
δ=
x∈Z(f )≤r0

Step 2 : (Estimation for δb ) : Let x ∈ Z(f )≤r where recall that r = (d − c)/3. The following are
equivalent :
∂φ
(i) φ ∈ T and φ(x) = 0 and ∂X
(x) = 0.
2
(ii) φ ∈ T and φ mod mx lies in the kernel of the linear map

∂
∂X

:

mx
m2x

→ F (x).

Let us first consider the case when deg(x) > r0 . In this case, each of the above condition for φ
depends only on its image in the zero dimensional ring
!
Y
(Oq /mq ) × (Ox /m2x ).
q∈Z(f )≤r0

The cardinality of the above ring is


Y

y∈Z(f )≤r0

q deg(y)



· q 3deg(x) .

Let us call an element ξ in the above ring as a favorable value iff all φ mapping to ξ satisfy the above
conditions. It is an easy exercise to check that the set of all favorable values has cardinality q deg(x) .
Thus the ratio of the number of favorable values to the cardinality of the ring is nothing but δq −2deg(x) .
The dimension over F of this ring is c + 3·deg(x). Since d ≥ c + 3·deg(x), by [6, Lemma 2.1], A≤d

Gabber’s presentation lemma for finite fields

15

surjects onto this ring. Due to this, the ratio of φ ∈ A≤d satisfying the above two conditions to the
#A≤d is nothing but δq −2deg(x) . In other words,
	

# φ ∈ T | φ(x) = 0, ∂φ (x) = 0
∂X
= δ · q −2deg(x) .
# A≤d
Now let us consider the case where deg(x) ≤ r0 . We claim that unless x ∈ T , there is no φ ∈ T
which vanishes on x. This follows from the definition of T . So let us assume x ∈ T . In this case, the
above two conditions for φ depend solely on the image of φ in the ring
!
Y
(Oq /mq ) × (Ox /m2x ).
q∈Z(f )≤r0
q6=x

Proceeding in a manner similar to the case where deg(x) > r0 , we find that for x ∈ T ,

	
# φ ∈ T | φ(x) = 0, ∂φ (x) = 0
∂X
= δ · q −deg(x) .
# A≤d
Since

[

Tb =


	
∂φ
φ ∈ T | φ(x) = 0,
(x) = 0
∂X

x∈Z(f )≤r such that
x∈T or deg(x)>r0

we get an estimate
δb ≤

X

x∈T

≤δ

X

δq −deg(x) +

X

δ · q −2deg(x)

x∈Z(f )≤r such that
deg(x)>r0

q

−deg(x)

+

x∈T

X

r0 <i≤r

′ −i

cq



where recall that c′ was the constant in Lang-Weil estimates such that #Z(f )=n ≤ c′ q n .
Step 3 : (Estimation for δc ): Let y ∈ A1F with i := deg(y) ≤ r. Let
n
o
Tcy := φ ∈ T | ∃ distinct x1 , x2 ∈ Z(f )=i with Y (x1 ) = Y (x2 ) = y and φ(x1 ) = φ(x2 ) = 0 .

First, note that Tcy is empty unless i > r0 . This is because the only points of degree ≤ r0 on which
a φ ∈ T vanishes are the points in T . However, by choice, all points in x ∈ T have different degrees
and satisfy deg(x) = deg(Y (x)). Thus, let us assume i > r0 . In this case, we claim that
 
# Tcy
m
≤δ·
· q −2i .
# A≤d
2

For fixed x1 , x2 with Y (x1 ) = Y (x2 ) = y,
n
o
φ ∈ T | φ(x1 ) = φ(x2 ) = 0

is a coset of the kernel of the following map
 Y

A≤d −→
(Oq /mq ) × (Ox1 /mx1 ) × (Ox2 /mx2 )
q∈Z(f )≤r0

which is surjective by [6, 2.1]. Thus
n
o
# φ ∈ T | φ(x1 ) = φ(x2 ) = 0.
#

A≤d

≤ δ · q −2i .

16

Amit Hogadi and Girish Kulkarni

Toprove the claim we now simply observe that since f is monic in X of degree m there are atmost
m
2 possible choices for a pair {x1 , x2 } as above.

As discussed above, since Tcy is empty unless i > r0 , we have
[
Tcy .
Tc =
y∈A1F
r0 <deg(y)≤r

For a fixed i,
#

From this, it is elementary to deduce


	
y ∈ A1F | deg(y) = i ≤ q i .

 X m 
Tc
≤δ
δc =
q −i .
# A≤d
2
#

r0 <i≤r

Step 4 : (Estimation for δd ): As in the above step, let y ∈ A1F with i := deg(y) ≤ r. Let
n
o
Tdy := φ ∈ T | ∃ x ∈ Z(f )≤r with φ(x) = 0 , Y (x) = y and deg(x) > i. .

We first claim that Tdy is empty unless deg(y) > r0 /m. Otherwise, there would exist a φ ∈ T and
an x ∈ Z(f )≤r with Y (x) = y, φ(x) = 0 and deg(x) > deg(y). But as f is monic in X of degree m, the
maximum degree of a point x lying over y is m · deg(y) ≤ r0 . Which means x ∈ Z(f )≤r0 . However as
φ ∈ T , the only points in Z(f )≤r0 on which φ vanishes are those in T . Thus x ∈ T . But by (4.2)(5)(c),
for such x, deg(Y (x)) = deg(y) = deg(x) which is a contradiction.
We will now estimate

Tdy
.
# A≤d
with deg(x) > i and Y (x) = y. For this x, we first note that because of
#

Fix a point x ∈ Z(f )≤r
/ T.
(4.2)(5)(c), x ∈
For deg(x) > r0 we note that
n
o
# φ ∈ T | φ(x) = 0.
#

A≤d

≤ δ · q −deg(x) ≤ δ · q −2i .

This is deduced, as before, from the surjectivity of
 Y

A≤d −→
(Oq /mq ) × (Ox /mx )
q∈Z(f )≤r0

n
o
If deg(x) ≤ r0 , φ ∈ T | φ(x) = 0 is empty as there is no points in Z(f )\T on which a φ ∈ T
vanishes. And hence, the above estimate trivially holds in this case also.
As f is monic in X of degree m, and deg(x) ≥ 2i, there are at most m
2 possible choices for x ∈ Z(f )
such that Y (x) = y. This shows that
Tdy
m −2i
≤δ·
·q .
# A≤d
2
#

Since, as discussed above, Tdy is empty unless deg(y) > r0 /m, we have
[
Tdy .
Td =
y∈(A1F )≥r0 /m

For a fixed i,
#


	
y ∈ A1F | deg(y) = i ≤ q i .

Gabber’s presentation lemma for finite fields

Thus
δd =


Td
≤δ
# A≤d

X

#

r0 /m<i≤r

17

m −i 
.
q
2

Step 5 : (Estimation for P): If we let
o
n
Pd := φ ∈ A≤d | φ satisfies (a), (b(d−c)/3 ), (c(d−c)/3 ), (d(d−c)/3 ) and φ(x) = 1 ∀ x ∈ Z(f )≤r0 \T ,

then

Pd = T \(Tb ∪ Tc ∪ Td ).
Therefore
Pd
≥ δ − δb − δc − δd
# A≤d
#
"
X
X
X m
X m
−i
−deg(x)
′ −i
−i
q
≥δ 1−
q
−
cq −
q −
2
2
x∈T
r0 <i≤r
r0 <i≤r
r0 /m<i≤r
"
!#
!
 
X
X
1
m
m
−deg(x)
′
≥δ 1−
q
−
· c +
+
qi
2
2
#

x∈T

r0 /m<i≤r

Note that in the above expression r = (d − c)/3. As d → ∞, so does r. Hence we observe that
"
!#
!
 
 #P 
X
X 1
m
m
d
−deg(x)
′
≥δ 1−
q
−
inf
· c +
+
# A≤d
qi
2
2
x∈T

i>r0 /m

which is positive, thanks to the definition of r0 . Thus the lower density of
[
P=
Pd
d

is positive as required.



Lemma 4.9. Let c be as in Lemma 4.8 and let
o
[n
∂φ
(x) = 0 .
Q :=
φ ∈ A≤d | ∃ x ∈ Z(f )>(d−c)/3 such that φ(x) =
∂X
d≥0

Then µ(Q) = 0.

Proof. The proof is identical to that of [6, 2.6]. We reproduce the argument verbatim here for the
convenience of the reader. We will bound the probability of φ constructed as
φ = φ0 + g p X + hp
∂φ
and for which there is a point x ∈ Z(f )>(d−c)/3 with φ(x) = ∂X
(x) = 0. Note that if φ is of the above
form, then
∂φ0
∂φ
=
+ gp.
∂X
∂X
Further, if φ0 ∈ A≤d , g ∈ A≤d−1/p and h ∈ A≤d/p , then φ ∈ A≤d . Define
 ∂φ 
.
W0 := Z(f ) and W1 := Z f,
∂X
Note that dim(W0 ) = 1.
Let
d
d−1
⌋ and η = ⌊ ⌋.
γ := ⌊
p
p
Claim 1: The probability (as a function of d) of choosing φ0 ∈ A≤d and g ∈ A≤(d−1)/p such that
dim(W1 ) = 0 is 1 − o(1) as d → ∞.

18

Amit Hogadi and Girish Kulkarni

Let V1 , ..., Vℓ be F irreducible components of W0 . Clearly ℓ ≤ deg(f ) (where deg(f ) is the total
degree). Since the projection onto the Y coordinate is finite on Z(f ) (by (4.2)(2)), we know that
Y (Vk ) is of dimension one for all k. We will now bound the set
n
o
∂φ
∂φ0
Gbad
:= g ∈ A≤γ |
=
+ g p vanishes identically on Vk .
k
∂X
∂X

′
bad
If g, g ′ ∈ Gbad
is non-empty, it is a coset of the subspace of
k , then g − g vanishes on Vk . Thus if Gk
functions in Aγ which vanish identically on Vk . The codimension of that subspace, or equivalently the
dimension of the image of Aγ in the regular functions on Vk is at least γ + 1, since no polynomial in Y
∂φ
vanishes on Vk . Thus the probability that ∂X
vanishes on Vk is at most q −γ−1 . Thus, the probability
∂φ
∂φ
−γ−1
= o(1). Since dim(W1 ) = 0 iff ∂X
does not identically
that ∂X vanishes on some Vk is at most ℓq
vanish on any component Vk , the claim follows.

We will now estimate the probability of choosing h such that there is no bad point in Z(f ), i.e. a
∂φ
point in Z(f )>(d−c)/3 where both φ and ∂X
vanish. Note that the set of such bad points is precisely
Z(φ) ∩ W1 ∩ Z(f )>(d−c)/3 .
Claim 2: Conditioned on the choice of φ0 and g such that W1 is finite, the probability of choosing h
such that
Z(φ) ∩ W1 ∩ Z(f )>(d−c)/3 = ∅
is 1 − o(1) as d → ∞.
It is clear by the Bezout theorem that # W1 = O(d). For a given x ∈ W1 , the set

	
H bad = h ∈ Aη | φ = φ0 + g p X + hp vanishes on x

evx
F (x) where F (x) is the residue field of x. For the purpose of this
is either ∅ or a coset of Ker Aη −−→
claim, we only need to consider x such that deg(x) > (d − c)/3. In this case, [6, Lemma 2.5] implies
that
# H bad
≤ q −ν where ν = min(η + 1, (d − c)/3).
# Aη
∂φ
Thus, the probability that both φ and ∂X
vanish at such x is at most q −ν . There are at most # W1
many possibilities for x. Thus the probability that there exists a ’bad point’, i.e. point in x ∈ W1
∂φ
with deg(x) > (d − c)/3 such that both φ and ∂X
vanish at such x is at most # W1 q −ν = O(dq −ν ).
−ν
Since as d → ∞, ν grows linearly in d, O(dq ) = o(1). In other words, the probability of choosing h
such that there is no bad point is 1 − o(1).

Combining the above two claims, it follows that the probability of choosing φ = φ0 + g p X + hp
such that
Z(φ) ∩ W1 ∩ Z(f )>(d−c)/3 = ∅
is equal to (1 − o(1))(1 − o(1)) = 1 − o(1). This shows that µ(Q) = 0.



Proof of Lemma 4.4. Let Q denote the complement of Q in A. Let P be as in Lemma 4.8. To prove
Lemma 4.4 we need to show that P ∩ Q is non-empty. However, combining the above two lemma’s,
we in fact get that µ(P ∩ Q) > 0. This finishes the proof.

Condition (3) of Lemma 4.4 ensures that Y : A2F → A1F is radicial at S≤(d−c)/3 . We would have
ideally liked to have S instead of S≤(d−c)/3 here. If this was the case, and if φ|Z(f ) was finite, as
mentioned in Remark 4.5, we would be able to deduce that (φ, Y ) presents (W, Z(f ), p). However we
are unable to handle points in S of degree greater than (d − c)/3. In order to rectify that, we replace
the map (φ, Y ) with a map (φ, h) for a suitable h as found by the following lemma. Finiteness of φ
will be handled later using a Noether normalization argument.

Gabber’s presentation lemma for finite fields

19

Lemma 4.10. Let c ∈ N be as in Lemma 4.4. Let d >> 0 be an integer such that for every
i > (d − c)/3,
# (A1F )=i > dm.
Let φ ∈ A≤d be as given by (4.4) and S := Z(φ) ∩ Z . Then, there exists h ∈ F [X, Y ] such that
(1) h|S : S → A1 is radicial, i.e. injective and preserves the degree.
(φ,h)

(2) The map A2F −−−→ A2F is étale at all x ∈ S.
(3) h|Z(f ) : Z(f ) → A1F is a finite map.
Proof. Step(1): In this step we will show that with the given choice of d, it is possible to choose h1
which satisfies condition (1) of the Lemma.
We claim that
# S=i ≤ # (A1F )=i ∀ i ≥ 1.
As explained in Remark 4.6, Z(φ) ∩ Z(f ) is finite. By Bezout theorem, # S ≤ deg(φ)deg(f ) = dm.
Thus the above claim holds for all i > (d − c)/3 by the choice of d. On the other hand, the claim
also holds for i ≤ (d − c)/3, since by Lemma 4.4, Y is radicial at S≤(d−c)/3 . Thus we can choose a
e
h

set theoretic map S −
→ A1F which is injective and preserves degree of points. By Chinese remainder
theorem, there exists an h1 ∈ F [X, Y ] such that for all x ∈ S
h1 (x) = e
h(x).
Step(2): Now, using the h1 from above step, we will find a h2 ∈ F [X, Y ] which satisfies conditions (1)
and (2) of the Lemma. It is sufficient to find an h2 ∈ F [X, Y ] such that
(i) h2 ≡ h1

mod mx ∀ x ∈ S

∂h2
(x) = 0 ∀ x ∈ S
∂X
∂h2
(x) = 1 ∀ x ∈ S
(iii)
∂Y
First, we claim that for any closed point x ∈ A2F , there exists an hx ∈ F [X, Y ] such that
(ii)

hx ≡ h1

mod mx

∂hx
(x) = 0
∂X
∂hx
(x) = 1
∂Y
We choose a polynomial f1 ∈ F [X] such that f1 (x) = 0 and ∂f1 /∂X(x) 6= 0. To see that such a choice
is possible, let π1 : A2F → A1F be the projection on to the X-coordinate. The minimal polynomial
of any primitive element of the residue field of π1 (x) satisfies our requirement. Similarly, we choose
f2 ∈ F [Y ] such that f2 (x) = 0 and ∂f2 /∂Y (x) 6= 0. Using Chinese remainder theorem and the fact
that the residue field F (x) is perfect, we choose g1 , g2 ∈ F [X, Y ] such that
g1p (x) = −
g2p (x)
We leave it to the reader that

∂h1 /∂X(x)
,
∂f1 /∂X(x)


1 − ∂h1 /∂Y (x)
=
.
∂f2 /∂Y (x)

hx = h1 + g1p f1 + g2p f2
satisfies the requirement of our claim. Now, by Chinese remainder theorem, there exists h2 ∈ F [X, Y ]
such that
h2 ≡ hx mod m2x ∀ x ∈ S.

20

Amit Hogadi and Girish Kulkarni

It is straightforward to see that h2 satisfies conditions (1) and (2) of the Lemma.
Step (3): Choose a non-constant polynomial β ∈ F [Y ] such that β(x) = 0 for all x ∈ S. Since f is
Y

monic in X, Z(f ) −→ A1F is a finite map. Thus β : Z(f ) → A1F is also a finite map. As dim(Z(f )) = 1,
for a sufficiently large integer ℓ,
h := h2 − β pℓ
h

defines a finite map Z(f ) −
→ A1F by Noether normalization trick (see (2.2)). Clearly h continues to
satisfy conditions (1) and (2) of the Lemma since β pℓ ∈ m2x for all x ∈ S.

(φ,h)
e be the map A2 −
Proof of theorem 4.3. Let φ, h be as in Lemmas 4.4 and 4.10 respectively. Let Φ
F −−→
e := φ. Recall that Se := φ−1 (0) ∩ Z(f ) (with reduced scheme structure). By Remark 4.6 it
A2F , and Ψ
is finite.
e S)
e ⊂ Wg and
Step 1: We claim that there exists a g ∈ F [X, Y ] such that if Wg := A2F \Z(g), then Φ(

e e −1
e −1 (Wg ) ∩ Z(f ) −→ Wg
Φ
|Φ (Wg )∩Z(f ) : Φ

is a closed immersion. The proof of this claim is a repetition of the argument in [1, 3.5.1] (see also
e Since Φ
e is étale and radicial at all points of Se (see
(3.4)). Let {p, x1 , ..., xn } be the set of points in S.
−1 e e
2
e
(4.4)(2) and (4.10)(1) ) we have Φ (Φ(S)) → AF is a closed immersion. Let y0 , ..., yn be the points
e S).
e Let ηi be the maximal ideal in F [X, Y ] corresponding to the closed point yi . Thus the above
in Φ(
closed immersion gives us a surjective map
F [X, Y ] ։

F [Z(f )]
η0 · · · ηn

where F [Z(f )] is the coordinate ring of Z(f ). If C denotes the cokernel of F [X, Y ] → F [Z(f )] (as
F [X, Y ] modules), then the above surjective map implies that
C⊗

F [X, Y ]
= 0.
η0 · · · ηn

e |Z(f ) is a finite map, since h is a finite map ((4.10)(3)). Thus F [Z(f )] is a finite F [X, Y ]
Note that Φ
module. Thus, by Nakayama’s lemma, there exists an element g ∈ F [X, Y ] such that g ∈
/ η0 · · · ηn
and Cg = 0. In other words, the map
F [X, Y ]g ։ F [Z(f )]g
is surjective. This proves the claim since if Wg := A2F \Z(g), the above surjectivity is equivalent to the
following being a closed immersion
e : Z(f ) ∩ Φ
e −1 (Wg ) → Wg .
Φ
Step 2: Let E be the smallest closed subset of Z(f ) satisfying the following three conditions
e is not étale at x.
(i) x ∈ E if x ∈ Z(f ) and Φ
(ii) Z(f )\Z ⊂ E.

e −1 (Wg ) ∩ Z(f ) ⊂ E.
(iii) Z(f )\ Φ

Since Se contains at least one point in each irreducible component of Z(f ), (iii) implies that E is finite
(see also Remark 4.6). Moreover, by the above step and condition (iii) we have
Z(f )\E −→ A2F

Gabber’s presentation lemma for finite fields

21

is a locally closed immersion. Moreover, Se and E are disjoint, and hence φ(p) ∈
/ φ(E). Since E is
finite, we choose a non-constant polynomial expression Q in h which vanishes on p as well as E. For
an integer ℓ >> 0 and divisible by char(F ), we claim that (φ − Qℓ , h) presents (W, Z(f ), p). Let
Φ := (φ − Qℓ , h)

and Ψ := φ − Qℓ .

To prove the claim we need to verify the conditions of the Definition (1)-(4) 3.3. Condition (1),
i.e. finiteness of Ψ|Z(f ) , follows by (2.2) since ℓ is large, and h|Z(f ) is finite. As Q vanishes on p and
E, Ψ(p) ∈
/ Ψ(E) follows from φ(p) ∈
/ φ(E). Thus if S := Ψ−1 Ψ(p) ∩ Z, then S ⊂ Z(f )\E. Conditions
(2) to (4) of (3.3) follow from the conditions (i) to (iii) of E in the beginning of this step.

References
[1] J.L. Colliot-Thélène, R. Hoobler, B. Kahn, The Bloch-Ogus-Gabber theorem, Algebraic K-theory (Toronto,
ON, 1996), 31–94, Fields Inst. Commun., 16, Amer. Math. Soc., Providence, RI, 1997. 1, 2, 5, 7, 20
[2] O. Gabber, Gersten’s conjecture for some complexes of vanishing cycles,Manuscripta Math., 85 (1994), no.
3-4, 323–343. 1, 2
[3] S. Lang, A. Weil, Number of points of varieties in finite fields, Amer. J. Math., 76 (1954), 819-827. 12, 13
[4] F. Morel, A1 -algebraic topology over a field, LNM 2052, Springer, Heidelberg, 2012. 1
[5] D. Mumford, The red book of varieties and schemes: includes the Michigan lectures (1974) on curves and their
Jacobians, Vol. 1358. Springer Science and Business Media, 1999. 2, 6
[6] B. Poonen, Bertini theorems over finite fields, Ann. of Math., (2) 160 (2004), no. 3, 1099–1127. 2, 11, 12, 13,
14, 15, 17, 18
[7] The Stacks Project Authors. Stack Project. http://stacks.math.columbia.edu. 7

Amit Hogadi, IISER Pune, Dr. Homi Bhabha Road, Pashan, Pune : 411008, INDIA
email: amit@iiserpune.ac.in
Girish Kulkarni, IISER Pune, Dr. Homi Bhabha Road, Pashan, Pune : 411008, INDIA
email: girish.kulkarni@students.iiserpune.ac.in

