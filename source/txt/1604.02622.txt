Variations on a Lemma of Nicolas and Serre

arXiv:1604.02622v2 [math.NT] 9 Dec 2016

Paul Monsky
Brandeis University, Waltham MA 02454-9110, USA. monsky@brandeis.edu

Abstract
The “Nicolas-Serre code”, (a, b) ↔ tn , is a bijection between N × N and those tn , n
odd, in Z/2[t]. Suppose An , n odd, in Z/2[t] are defined by: A1 = A5 = 0, A3 = t,
A7 = t5 , and An+8 = t8 An + t2 An+2 . A lemma, Proposition 4.3 of [6], used to study
the Hecke algebra attached to the space of mod 2 level 1 modular forms, gives
information about the codes (a, b) attached to the monomials appearing in An . The
unpublished highly technical proof has been simplified by Gerbelli-Gauthier.
Our Theorem 3.7 generalizes Proposition 4.3. The proof, in sections 1–3, is a
further simplification of Gerbelli-Gauthier’s argument. We build up to the theorem
with variants involving the same recurrence, but having different sorts of initial
conditions.
Section 4 treats the recurrence An+16 = t16 An + t4 An+4 + t2 An+2 . Theorem 4.1,
the analog to Theorem 3.7 for this recurrence, is used in [2] and [3] to analyze level
3 Hecke algebras.
Finally we introduce a variant code, (a, b) ↔ wn which is a bijection between
N × N and those wn , n ≡ 1, 3, 7, 9 mod 20, in Z/2[w]. We then study the recurrence
An+80 = w80 An + w20 An+20 , n ≡ 1, 3, 7, 9 mod 20, with appropriate initial conditions. Lemma 5.5, derived from the results of sections 1–3, is the precise analog of
Proposition 4.3 for this code, this recurrence, and these initial conditions. It is used
in [4] and [5] to analyze level 5 Hecke algebras.

1

Introduction

Let r be a power of 2. Suppose that for each odd n > 0 we have an An in
tZ/2[t2 ], and that these satisfy
(⋆)

An+8r = t8r An + t2r An+2r .

Recursions of this sort arise in the study of the action of the Hecke operator
T3 on certain spaces of mod 2 modular forms. Results about the exponents
appearing in An (and in the An satisfying similar recursions) have been used
1

by Nicolas and Serre [6] to understand the Hecke algebra attached to the space
of mod 2 modular forms of level 1. These questions are often difficult (Nicolas
and Serre have a proof about a recursion attached to T5 that seems quite
inscrutable). The questions I have in mind involve the “Nicolas-Serre code”,
and the proofs rely on the easily proved but central:
Observation 1.1 If the An satisfy (⋆) for r, then they also satisfy (⋆) when
r is replaced by any larger power of 2.
Proposition 4.3 of [6] is the special case of (⋆) with r = 1, A1 = 0, A3 = t, A5 =
0, A7 = t5 . Nicolas and Serre’s highly technical treatment of it was greatly
simplified by Gerbelli-Gauthier [1]. In this note I use Gerbelli-Gauthier’s technique (with some further simplifications) to treat various other initial values
for the An . In each case I get a result concerning the “dominant term” appearing in the Nicolas-Serre code for An .
Theorem 3.1, stated at the end of this section and proved in section 3 is a bit
simpler than Proposition 4.3, and its proof nicely illustrates the general ideas.
Three variants, Theorems 3.3, 3.5 and 3.7, follow. The last of these has (the
algebraic form of) Proposition 4.3 as a corollary.
When one tries to treat modular forms of level Γ0 (3) similarly, one must deal
with the fact that the recursion attached to the Hecke operator U3 is nothing
like (⋆). (But this recursion also leads to results of interest—see [3].) Instead
one may use a recursion attached to T7 :
(⋆⋆)

An+16r = t16r An + t4r An+4r + t2r An+2r .

Under suitable initial conditions there is an analog to Proposition 4.3 for (⋆⋆).
I’ll prove such a result, Corollary 4.2, in section 4. Applications to Hecke
algebras appear in [2] and [3]. The arguments are motivated once again by
Gerbelli-Gauthier’s technique; I’m grateful to her for her ideas. In the final
sections I define a variant of the Nicolas-Serre code, and prove one more Proposition 4.3 analog, using the corollaries to Theorems 3.1, 3.3, 3.5 and 3.7. This
result, Lemma 5.5, has the same role in treating level Γ0 (5) as Corollary 4.2
does in treating level Γ0 (3); see [4] and [5].
We now introduce the Nicolas-Serre code in language that differs slightly from
that of [6].
Definition 1.2 g : N → N is the function with g(2n) = 4g(n), g(2n + 1) =
g(2n) + 1.
Since g(0) = 4g(0), g(0) = 0, and the functional equations above give all the
g(n). One sees immediately that if n is a sum of distinct q, with each q a
power of 2, then g(n) is the sum of the q 2 . It follows that each n in N can be
uniquely written as g(a) + 2g(b) for some a and b in N. So if we let [a, b] be
2

the monomial tn , where n = 1 + 2g(a) + 4g(b), then [a, b] → [a, b] maps N × N
1 − 1 onto the monomials tk , k odd. It follows that:
[0, 0], [1, 0], [0, 1], [2, 0], [1, 1], [0, 2], [3, 0], [2, 1], [1, 2], [0, 3], . . .
is a list of all such monomials.
Definition 1.3 tn “precedes” or “is earlier than” tm if it appears before it in
the above list. In other words to say that [c, d] precedes [a, b] is to say that
c + d ≤ a + b, and that, in case of equality, d < b.
Theorem 3.1 Suppose An in tZ/2[t2 ] satisfy (⋆) of our first paragraph for
some r. Suppose further that the following condition (1γ) holds when n < 8r:
(1γ)

An is a sum of monomials preceding tn .

Then (1γ) holds for all n.
Remark 1.4 Each of 8r, 16r, 32r, . . . can be written as 8q 2 or 16q 2 for some
q which is a power of 2. So Theorem 3.1 is a consequence of the following:
Suppose q is a power of 2 and that An , n > 0 and odd, are in tZ/2[t2 ]. Then:
(1) If the An satisfy (⋆) for some r dividing q 2 (and therefore for r = q 2
by Observation 1.1), and (1γ) holds when n < 8q 2 , then it holds when
n < 16q 2 .
(2) If the An satisfy (⋆) for some r dividing 2q 2 , and (1γ) holds when n <
16q 2 , then it holds when n < 32q 2 .
I’ll say now a few words about the proof of (1). We argue by induction on n.
So suppose k is in (8q 2 , 16q 2 )—we want to show that Ak is a sum of monomials
preceding tk . Let n = k − 8q 2 and write tn as [a, b]. Then 1 + 2g(a) + 4g(b) =
n < 8q 2 , and it follows that a < 2q. So g(a + 2q) = g(a) + 4q 2, and replacing a
2
by a + 2q in 1 + 2g(a) + 4g(b) increases it by 8q 2 . So tk = t8q [a, b] = [a + 2q, b],
and we want to show that Ak is a sum of monomials preceding [a+2q, b]. Since
2
2
(⋆) holds for r = q 2 , Ak = t8q An + t2q An+2q2 , and it’s enough to show that
2
2
t8q An and t2q An+2q2 are such monomial sums. The simple machinery used to
prove that this is true is developed in the next section.
Next I turn to (2). Again we argue by induction on n. So suppose k is in
(16q 2 , 32q 2)—we want to show that Ak is a sum of monomials preceding tk .
Let n = k −16q 2 , and write tn as [a, b]. Then 1 + 2g(a) + 4g(b) = n < 16q 2 , and
b < 2q. Then g(b+2q) = g(b)+4q 2 , and replacing b by b+2q in 1+2g(a)+4g(b)
2
results in an increase of 16q 2 . So tk = t16q [a, b] = [a, b + 2q], and we want to
show that Ak is a sum of monomials preceding [a, b + 2q]. Since (⋆) holds
2
2
2
for r = 2q 2 , Ak = t16q An + t4q An+4q2 , and it’s enough to show that t16q An
3

2

and t4q An+4q2 are such monomial sums. Again, the next section furnishes the
machinery that’s needed.

2

2

The effect of multiplication by t2q and t4q

2

From now on, q is a power of 2. We start with an easy result.
Theorem 2.1 Suppose

j k
a
q

2

is even. Then t2q [a, b] = [a + q, b]. Suppose

j k
b
q

2

is even. Then t4q [a, b] = [a, b + q].
j k

Proof If aq is even, q does not occur when a is written as a sum of distinct
powers of 2. So g(a+q) = g(a)+q 2 , and replacing a by a+q in 1+2g(a)+4g(b)
results in an increase of 2q 2 . The second result is proved similarly. ✷
We assume temporarily that n = 1+2g(a)+4g(b) is 1 mod 2q 2 . This evidently
2
2
holds if and only if q divides a and b. We shall study t2q [a, b] and t4q [a, b]
2
under these assumptions, showing the following: If aq is odd then t2q [a, b] is
2
earlier than [a + q, b]. If qb is odd then t4q [a, b] is earlier than [a, b + q].
Definition 2.2 Suppose i and j are each in {0, q}. Then Si,j takes [a, b] to
[2a + i, 2b + j].
2

Lemma 2.3 If [a, b] = tn , S0,0 , Sq,0 , S0,q and Sq,q take [a, b] to t4n−3 , t(4n−3)+2q ,
2
2
t(4n−3)+4q and t(4n−3)+6q .
Proof This follows from the fact that g(2a) = 4g(a), g(2a + q) = 4g(a) + q 2 ,
g(2b) = 4g(b), g(2b + q) = 4g(b) + q 2 . ✷
Note that if [a, b] precedes [c, d] then Si,j [a, b] precedes Si,j [c, d]; this is key to
what follows.
Lemma 2.4
2

(1) t4q
2
(2) t4q

◦
◦

S0,q = S0,0
Sq,q = Sq,0

◦
◦

2

t2q = t2q
2
t2q .

2

◦

Sq,q .

2

2

2

2

(Here t4q and t2q denote the operations of multiplication by t4q and t2q .)
Proof Applying the operators of Lemma 2.4 to tn , we see from Lemma 2.3
2
that all the operators in (1) give t(4n−3)+8q , while those in (2) give
2
t(4n−3)+10q . ✷
Lemma 2.5 If

a
q

2

is odd, t2q [a, b] precedes [a + q, b].

Proof We argue by induction on a + b. If qb is even, g(a − q) = g(a) − q 2 ,
g(b + q) = g(b) + q 2 , and replacing a and b by a − q and b + q increases
4

2

1 + 2g(a) + 4g(b) by 2q 2 . So t2q [a, b] = [a − q, b + q] which precedes [a + q, b].
Suppose finally that aq and qb are odd. Then [a, b] = Sq,q [c, d] for some c and
2
2
d, divisible by q, and c + d < a + b. By Lemma 2.4, t2q [a, b] = S0,0 t2q [c, d].
2
Theorem 2.1 and the induction show that t2q [c, d] equals or precedes [c + q, d].
2
So t2q [a, b] equals or precedes [2c + 2q, 2d] = [a + q, b − q], which precedes
[a + q, b]. ✷
Lemma 2.6 If

b
q

2

is odd, t4q [a, b] precedes [a, b + q].

Proof If aq is even, then [a, b] = S0,q [c, d] for some c and d divisible by q. By
2
2
2
Lemma 2.4, t4q [a, b] = S0,0 t2q [c, d]. By Theorem 2.1 and Lemma 2.5, t2q [c, d]
2
is [c+q, d] or an earlier monomial. So t4q [a, b] equals or precedes [2c+2q, 2d] =
[a + 2q, b − q], and this precedes [a + q, b]. If aq is odd, then [a, b] = Sq,q [c, d]
2
2
for some c and d divisible by q. By Lemma 2.4, t4q [a, b] = Sq,0 t2q [c, d]. By
2
Theorem 2.1 and Lemma 2.5, t2q [c, d] is [c + q, d] or an earlier monomial. So
2
t4q [a, b] equals or precedes [2c + 3q, 2d] = [a + 2q, b − q], and this precedes
[a, b + q]. ✷
We now drop the assumption that q divides a and b.
Theorem 2.7
(1) If
(2) If

j k
a
jqk
b
q

2

is odd, t2q [a, b] precedes [a + q, b].
2

is odd, t4q [a, b] precedes [a, b + q].

Proof To prove (1), write a as a1 +a2 , b as b1 +b2 where q divides a1 and b1 , and
2
both a2 and b2 are in [0, q). By Lemma 2.5, t2q [a1 , b1 ] = [c1 , d1 ] where q divides
c1 and d1 , and [c1 , d1 ] precedes [a1 + q, b1 ]. Now g(a) = g(a1 ) + g(a2 ) while
g(b) = g(b1 ) + g(b2 ). If we let c = c1 + a2 , d = d1 + b2 , then g(c) = g(c1 ) + g(a2 ),
2
g(d) = g(d1) + g(b2 ). It follows immediately that t2q [a, b] = [c, d]. And since
[c1 , d1] precedes [a1 + q, b1 ], [c, d] precedes [a + q, b]. The proof of (2) is the
same. ✷
Combining Theorems 2.1 and 2.7 we get:
2

2

Corollary 2.8 t2q [a, b] is [a + q, b] or an earlier monomial, while t4q [a, b] is
[a, b + q] or an earlier monomial.

3

Theorems relating to the recursion (⋆)

We now complete the proof, outlined at the end of section 1, of Theorem 3.1.
As we indicated, the argument is a 2 stage one. In the first stage we assume
that (1γ) holds for n < 8q 2 , and argue inductively on k to show that (1γ)
holds for k in (8q 2 , 16q 2 ). Recall that n = k − 8q 2 , that tn = [a, b] and that
5

2

2

tk = [a + 2q, b]. As we’ve seen, it suffices to show that t8q An and t2q An+2q2
are each sums of monomials preceding [a + 2q, b]. Now since n < 8q 2 , (1γ)
holds for n, and An is a sum of [c, d] preceding [a, b]. By Corollary 2.8, with q
2
replaced by 2q, t8q [c, d] is [c + 2q, d] or an earlier monomial, and so precedes
2
2
[a + 2q, b]. Also, tn+2q = t2q [a, b] which, by Corollary 2.8, is [a + q, b] or an
earlier monomial. Since n+2q 2 < k, (1γ) holds for n+2q 2 , and An+2q2 is a sum
2
of [c, d] preceding [a + q, b]. Corollary 2.8 shows that t2q [c, d] is [c + q, d] or an
earlier monomial. Then [c + q, d] precedes [a + 2q, b], and we’re done. Turning
to stage 2 we assume that (1γ) holds for n < 16q 2 , and argue inductively on
k to show that (1γ) holds for k in (16q 2 , 32q 2). Now n = k − 16q 2 , tn = [a, b]
2
2
and tk = [a, b + 2q] It sufices to show that t16q An and t4q An+4q2 are sums of
monomials preceding [a, b + 2q], and we follow the argument of stage 1, once
again using Corollary 2.8 repeatedly. We have proved:
Theorem 3.1 Suppose An , n odd and > 0, are in tZ/2[t2 ] and satisfy the
recursion An+8r = t8r An + t2r An+2r for some r which is a power of 2. If An
is a sum of monomials preceding tn whenever n < 8r 2, then for all n, An is
such a sum.
Corollary 3.2 Let γn be defined by γn+8 = t8 γn + t2 γn+2 , γ1 = 0, γ3 = 0,
γ5 = t3 , γ7 = t5 . Then, for all n, γn is a sum of monomials preceding tn .
For t3 , t5 and t7 are [1, 0], [0, 1] and [1, 1], so the hypotheses of Theorem 3.1
apply.
We now introduce 3 variants, (1β), (1δ) and (1α) of (1γ), and derive parallel
results for them.
(1β) An is tn + a sum of earlier monomials.
(1δ) Suppose tn = [a, b]. If a > 0, An is a sum of monomials preceding [a−1, b].
If a = 0, An is a sum of monomials equal to or preceding [0, b − 1].
(1α) Suppose tn = [a, b]. If a > 0, An = [a − 1, b]+ a sum of earlier monomials.
If a = 0, An is a sum of monomials equal to or preceding [0, b − 1].
Theorem 3.3 Suppose An are as in Theorem 3.1. If An satisfies (1β) whenever n < 8r 2 , every An satisfies (1β).
Corollary 3.4 Let βn be defined by βn+8 = t8 βn + t2 βn+2 , β1 = t, β3 = t3 ,
β5 = t5 , β7 = t7 + t3 . Then, for all n, βn is tn + a sum of earlier monomials.
The proof of Theorem 3.3 uses the same 2 step process. Suppose we’re in
the first stage and k is in (8r 2, 16r 2 ). Again, n = k − 8q 2 , tn = [a, b] and
2
2
tk = [a + 2q, b]. Also Ak = t8q An + t2q An+2q2 . So it suffices to show that
2
2
t8q An is [a + 2q, b] + a sum of earlier monomials, while t2q An+2q2 is a sum
of monomials preceding [a + 2q, b]. The first of these is easy—An is [a, b] + a
2
2
sum of earlier monomials [c, d], t8q [a, b] = [a + 2q, b] and t8q [c, d] = [c + 2q, d],
2
which precedes [a+2q, b]. For the second we use Corollary 2.8 to see that tn+2q
6

is [a + q, b] or an earlier monomial. The induction then shows that An+2q2 is
either a sum of [c, d] preceding [a + q, b] or [a + q, b]+ such a sum. In the
2
first case each t2q An+2q2 is [c + q, d] or an earlier monomial and so precedes
2q 2
[a + 2q, b]. Now in the second case we must
j khave t [a, b] = [a + q, b]; Theorem
2.7 tells us that this only occurs when aq is even. But when this happens,
j

a+q
q

k

2

is odd, so by Theorem 2.7, t2q [a + q, b] precedes [a + 2q, b]. So in all
2

cases t2q An+2q2 is a sum of the desired sort. The argument in the second stage
is almost identical. Now n = k − 16q 2 , tn = [a, b] and tk = [a, b + 2q]. Also
2
2
2
Ak = t16q An + t4q An+4q2 . So it suffices to show that t16q An is [a, b + 2q] + a
2
sum of earlier monomials, and that t4q An+4q2 is a sum of monomials preceding
[a, b + 2q]. The argument to establish these facts is the same as that used in
stage 1, again employing Corollary 2.8 and Theorem 2.7.
Theorem 3.5 Suppose An are as in Theorem 3.1. If An satisfies (1δ) whenever n < 8r 2 , every An satisfies (1δ).
Corollary 3.6 Let δn be defined by δn+8 = t8 δn + t2 δn+2 , δ1 = δ3 = δ5 = 0,
δ7 = t3 . Then if tn = [a, b], a > 0, δn is a sum of monomials preceding [a−1, b].
And if tn = [0, b], δn is a sum of monomials equal to or preceding [0, b − 1].
We use the 2 stage process to prove Theorem 3.5. Suppose we’re in the first
stage. Again, k is in (8q 2 , 16q 2), n = k − 8q 2 , tn = [a, b], and tk = [a + 2q, b].
When a > 0 we argue exactly as in the proof of Theorem 3.1. Suppose a = 0, so
2
2
that tn = [0, b], and tk = [2q, b]. It’s enough to show that t8q An and t2q An+2q2
are each sums of monomials preceding [2q − 1, b]. Since n < 8q 2 , An satisfies
2
(1δ), and is a sum of [c, d] equal to or preceding [0, b−1]. Furthermore, t8q [c, d]
is [c + 2q, d] or an earlier monomial, and so is equal to or precedes [2q, b − 1]
2
which in turn precedes [2q − 1, b]. Also, tn+2q = [q, b]. Since n + 2q 2 < k,
2
An+2q2 satisfies (1δ), and is a sum of [c, d] preceding [q − 1, b]. Then t2q [c, d] is
equal to or precedes [c + q, d] and so precedes [2q − 1, b]. We turn to stage 2.
Now k is in (16q 2 , 32q 2 ), n = k − 16q 2 , tn = [a, b], tk = [a, b + 2q]. When a > 0,
the argument is just as in Theorem 3.1. Suppose a = 0, so that tn = [0, b],
2
tn+4q is [0, b + q] or an earlier monomial, tk = [0, b + 2q]. It will suffice to show
2
2
that t16q An and t4q An+4q2 are each sums of monomials equal to or preceding
[0, b + 2q − 1]. Now since n < 16q 2, An satisfies (1δ) and is a sum of [c, d] equal
2
to or preceding [0, b − 1]. Then t16q [c, d] is [c, d + 2q] or an earlier monomial
and so is equal to or precedes [0, b+2q−1]. Also n+4q 2 < k, and our induction
2
shows that An+4q2 is a sum of [c, d] preceding [0, b + q − 1] (both when t4q
2
is [0, b + q] and when it is earlier). Then t4q [c, d] is [c, d + q] or an earlier
monomial, and so precedes [0, b + 2q − 1], completing the proof.
Theorem 3.7 Suppose An are as in Theorem 3.1. If An satisfies (1α) whenever n < 8r 2 , every An satisfies (1α).
Corollary 3.8 (This is the purely formal algebraic part of Proposition 4.3 of
7

[6].) Let αn be defined by αn+8 = t8 αn + t2 αn+2 , α1 = 0, α3 = t, α5 = 0,
α7 = t5 . Then if tn = [a, b] with a > 0, αn = [a − 1, b] + a sum of earlier
monomials. And if tn = [0, b], αn is a sum of monomials equal to or preceding
[0, b − 1].
Again we employ the 2 stage process. In the first stage, k is in (8q 2 , 16q 2 ),
n = k − 8q 2 , tn = [a, b] and tk = [a + 2q, b]. When a > 0 we proceed as in the
2
proof of Theorem 3.3, showing that t8q An is [a + 2q − 1, b] + a sum of earlier
2
monomials, while t2q An+2q2 is a sum of monomials preceding [a + 2q − 1, b].
2
When a = 0, the situation is different. Since tn = [0, b], tn+2q = [q, b]; see
Theorem 2.1. Now n + 2q 2 < k, so by induction An+2q2 is [q − 1, b] + a sum
2
of earlier monomials [c, d]. By Theorem 2.1, t2q [q − 1, b] = [2q − 1, b], while
2
t2q [c, d], by Corollary 2.8, is [c + q, d] or an earlier monomial, and so precedes
2
[2q − 1, b]. If remains to show that t8q An is a sum of monomials preceding
[2q − 1, b]. Since n < 8q 2 , An is a sum of [c, d] equal to or preceding [0, b − 1],
2
and t8q [c, d] is [c + 2q, d] or an earlier monomial and so is equal to or precedes
[2q, b − 1] which precedes [2q − 1, b]. In the second stage, k is in (16q 2 , 32q 2 ),
2
2
n = k − 16q 2 , tn = [a, b] and tk = [a, b + 2q]. Now Ak = t16q An + t4q An+4q2 .
2
When a > 0 we proceed as in the proof of Theorem 3.3, showing that t16q An
2
is [a − 1, b + 2q] + a sum of earlier monomials, while t4q An+4q2 is a sum of
monomials preceding [a − 1, b + 2q]. Suppose finally that a = 0. Now tk is
[0, b + 2q] and we need to show that Ak is a sum of monomials equal to or
2
preceding [0, b + 2q − 1]. It’s enough to prove this separately for t16q An and
2
t4q An+4q2 . Since tn = [0, b] and n < 16q 2 , An is a sum of [c, d], each of which
2
is [0, b − 1] or earlier. Then t16q [c, d] is [c, d + 2q] or an earlier monomial, and
2
2
so is equal to or precedes [0, b + 2q − 1]. And tn+4q = t4q [0, b] is [0, b + q]
or an earlier monomial. Using the fact that n + 4q 2 < k, we conclude that
An+4q2 is a sum of monomials equal to or preceding [0, b + q − 1] (both when
2
2
tn+4q is [0, b + q] and when it is earlier). Since t4q [c, d] is [c, d + q] or an earlier
monomial, and so is equal to or earlier than [0, b + 2q − 1], we’re done.

4

A theorem related to the recursion (⋆⋆)

In the introduction we described a recursion (⋆⋆) very much like (⋆): An+16r =
t16r An + t4r An+4r + t2r An+2r , where r is once again a power of 2.
Theorem 4.1 Suppose An , n odd and > 0, are in tZ/2[t2 ], and satisfy the
above recursion. If the An satisfy condition (1α) of the last section whenever
n < 16r 2 , then they satisfy it for all n.
Corollary 4.2 Suppose An satisfy An+16 = t16 An + t4 An+4 + t2 An+2 , and that
A1 , A3 , A5 , A7 , A9 , A11 , A13 , A15 are 0, t, 0, t5 , t3 , t9 + t, t7 and t13 + t5 .
Then if tn = [a, b] with a > 0, An is [a − 1, b] + a sum of earlier monomials.
8

And if tn = [0, b], An is a sum of monomials equal to or preceding [0, b − 1].
(Corollary 4.2 appears as Theorem 2.22 of [2], and plays an important part in
establishing the results of that paper.)
We now give the proof of Theorem 4.1. Note first that if the An satisfy (⋆⋆)
for some r then they satisfy it for every larger power of 2. Also, each of
16r, 32r, 64r, . . . is either 32q 2 or 16q 2 for some q which is a power of 2. So we
can use the 2 stage argument of section 3.
In the first stage we know that (1α) holds for n < 32q 2 , and want to treat
k in (32q 2 , 64q 2). We set n = k − 32q 2 , and let tn = [a, b]. The argument
made earlier with q replaced by 2q shows that tk = [a + 4q, b]. Now Ak =
2
2
2
t32q An +t8q An+8q2 +t4q An+4q2 . The proof of Theorem 3.7 shows that the sum
of the first 2 of these 3 terms is [a + 4q − 1, b] + a sum of earlier monomials. It
2
remains to show that t4q An+4q2 is a sum of monomials preceding [a+4q −1, b].
2
2
Now tn+4q = t4q [a, b] is [a, b + q] or an earlier monomial. Also, n + 4q 2 < k.
So by induction, when a > 0, An+4q2 is a sum of [c, d] equal to or preceding
[a − 1, b + q], and when a = 0, it is a sum of [c, d] equal to or preceding
2
[0, b + q − 1]. Then t4q [c, d] is [c, d + q] or an earlier monomial, and so precedes
[a + 4q − 1, b].
In the second stage, we know that (1α) holds for n < 16q 2 , and want to treat
k in (16q 2, 32q 2 ). We set n = k − 16q 2 , and let tn = [a, b]. Then tk = [a, b + 2q].
2
2
2
Now Ak = t16q An + t4q An+4q2 + t2q An+2q2 . The proof of Theorem 3.7 shows
2
2
that t16q An + t4q An+4q2 is a sum of the desired sort, and it remains to show
2
that when a > 0, t2q An+2q2 is a sum of monomials preceding [a − 1, b + 2q],
2
while when a = 0, t2q An+2q2 is a sum of monomials preceding or equal to
2
2
[0, b + 2q − 1]. Now tn+2q = t2q [a, b] is [a + q, b] or an earlier monomial. Since
n + 2q 2 < k, An+2q2 is a sum of [c, d] equal to or preceding [a + q − 1, b]. Now
2
t2q [c, d] is [c + q, d] or an earlier monomial, and so is equal to or precedes
[a + 2q − 1, b]. But when a > 0, [a + 2q − 1, b] precedes [a − 1, b + 2q], while
when a = 0, [2q − 1, b] precedes [0, b + 2q − 1]. This completes the proof.

5

The polynomials Pn . Statement of Lemma 5.5

Recall that in Corollaries 3.8, 3.4, 3.2 and 3.6 we defined, for n odd and
> 0, elements αn , βn , γn and δn of V = tZ/2[t2 ]. Explicitly, these all satisfy
An+8 = t8 An + t2 An+2 , and the initial conditions are:
α1 , α3 , α5 , α7
β1 , β3 , β5 , β7
γ1 , γ3 , γ5 , γ7
δ1 , δ3 , δ5 , δ7

are
are
are
are
9

0, t, 0, t5
t, t3 , t5 , t7 + t3
0, 0, t3 , t5
0, 0, 0, t3

Now let w be an indeterminate over Z/2. If k ≡ 1, 3, 7 or 9 mod 20, then
k = 10n − 9, 10n − 7, 10n − 3 or 10n − 1 for some odd n, and we define Pk in
Z/2[w] as follows:
P10n−9
P10n−7
P10n−3
P10n−1

=
=
=
=

w −3αn (w 10 ) + w −7δn (w 10 )
w −9βn (w 10 ) + w −1δn (w 10 )
w −1αn (w 10 ) + w −9γn (w 10 )
w −7βn (w 10 ) + w −3γn (w 10 )

Theorem 5.1 Pk+80 = w 80 Pk + w 20 Pk+20 . Furthermore, P1 , P3 , P7 , P9 , P21 ,
P23 , P27 , P29 , P41 , P43 , P47 , P49 , P61 , P63 , P67 , P69 are:
0, w, 0, w 3 , w 7 , w 21 , w 9 , w 23 , 0, w 41 , w 21 , w 43 +w 27 , w 47 +w 23 , w 61 +w 29 +w 21 ,
w 49 + w 41 and w 63 + w 47 + w 23 .
Remark 5.2 If V ′ ⊂ Z/2[w] is spanned by the w k with k ≡ 1, 3, 7 or 9 mod
20, then each Pk lies in V ′ .
The recurrence satisfied by the Pk is an immediate consequence of the recurrence satisfied by the αn , βn , γn and δn . And the initial values are immediately
verified.
I will prove a result analogous to that of Corollary 3.8 for the Pk . This involves
putting a linear order on the monomials that lie in V ′ .
Definition 5.3 ϕ : V → V ′ is the following Z/2-linear map:
(a) ϕ takes t, t3 , t5 , t9 to w, w 3, w 7, w 9 .
(b) ϕ takes t7 , t11 , t13 , t15 to w 21 , w 27 , w 23 , w 29 .
(c) ϕ(t16 f ) = w 40 ϕ(f ).
Evidently ϕ maps V bijectively to V ′ .
Definition 5.4 If (a, b) lies in N × N, then ha, bi in V ′ is the monomial
ϕ[a, b], where [a, b] is t1+2g(a)+4g(b) .
The ha, bi run over all the monomials in w lying in V ′ . Just as we had a listing, [0, 0], [1, 0], [0, 1], [2, 0], [1, 1], [0, 2], . . . of the monomials in V , we have a
corresponding listing h0, 0i, h1, 0i, h0, 1i, h2, 0i, h1, 1i, h0, 2i, . . . of the monomials in V ′ . We again use the language of “earlier monomial” or “preceding
monomial”.
The rest of this note is devoted to the following result, which is used to prove
the essential Theorem 3.5 of [4]:
10

Lemma 5.5 Let Pk in V ′ , k ≡ 1, 3, 7 or 9 mod 20 be as in Theorem 5.1.
Suppose that w k = ha, bi. Then
(1) If a > 0, Pk = ha − 1, bi + a sum of earlier monomials.
(2) If a = 0, Pk is a sum of monomials preceding or equal to h0, b − 1i.

6

The operators si,j

Lemma 6.1 If n ≡ 1 (4), the ϕ of Definition 5.3 takes t4n−3 , t4n−1 , t4n+1
and t4n+5 to w 10n−9 , w 10n−7 , w 10n−3 , w 10n−1 .
Proof When n = 1 this is Definition 5.3 (a). Replacing n by n + 4 multiplies
both ϕ(t4n+c ) and w 10n+d by w 40 , giving the result. ✷
Lemma 6.2 If n ≡ 3 (4), the ϕ of Definition 5.3 takes t4n−5 , t4n−1 , t4n+1
and t4n+3 to w 10n−9 , w 10n−3 , w 10n−7 , w 10n−1 .
Proof For n = 3 this is Definition 5.3 (b), and we continue as above. ✷
Definition 6.3 V1 is the subspace of V spanned by tn , n ≡ 1 (4), V3 the
subspace spanned by the tn , n ≡ 3 (4).
Note that V1 is spanned by the [c, d] with c even, while V3 is spanned by the
[c, d] with c odd.
Definition 6.4
(1) If i and j are ≥ 0, si,j : V → V ′ is the Z/2-linear map taking [c, d] to
h2c + i, 2d + ji.
(2) s−1,1 : V3 → V ′ is the Z/2-linear map taking [c, d] to h2c − 1, 2d + 1i.
(Since c > 0 this makes sense.)
Lemma 6.5 If f is in V1 , then s0,0 , s1,0 , s0,1 and s2,0 take f to w −9 f (w 10 ),
w −7 f (w 10 ), w −3 f (w 10 ), w −1 f (w 10 ).
Proof We may assume f = tn with n ≡ 1 (4). Write f = [c, d]. Arguing as in
Lemma 2.3 we find that [2c, 2d] = t4n−3 , [2c+1, 2d] = t4n−1 , [2c, 2d+1] = t4n+1
and [2c + 2, 2d] = t4n+5 . (For the last of these, note that c is even.) Applying
ϕ and using Lemma 6.1 we get the result. ✷
Lemma 6.6 If f is in V3 , then s−1,1 , s1,0 , s0,1 and s1,1 take f to w −9 f (w 10 ),
w −3 f (w 10 ), w −7 f (w 10 ) and w −1 f (w 10).
Proof We may assume f = tn with n ≡ 3 (4). Write f = [c, d]. Since c is odd,
[c, d] = t2 [c − 1, d]. So [c − 1, d] = tn−2 , and [2c − 1, 2d + 1] is, by Lemma 2.3,
just t4n−5 . Lemma 2.3 also shows that [2c + 1, 2d] = t4n−1 , [2c, 2d + 1] = t4n+1 ,
11

[2c + 1, 2d + 1] = t4n+3 . Now apply ϕ and use Lemma 6.2. ✷
Lemma 6.7 If n ≡ 1 (4), βn and δn are in V1 , while αn and γn are in V3 . If
n ≡ 3 (4), αn and γn are in V1 , while βn and δn are in V3 .
Proof This is evidently true when n is 1, 3, 5 or 7. In general it follows from
the recursion. ✷

7

Proof of Lemma 5.5

Lemma 7.1 Lemma 5.5 holds when k ≡ 21, 23, 27 or 29 (40).
Proof We may write k as 10n − 9, 10n − 7, 10n − 3 or 10n − 1 with n ≡ 3 (4).
Let tn = [c, d]; note that c is odd.
Suppose first k ≡ 21 (40). Then s−1,1 (tn ) = h2c − 1, 2d + 1i, which by Lemma
6.6 is w −9 (w 10n ) = w k . So we need to show that Pk = h2c − 2, 2d + 1i + a sum
of earlier monomials. Now Pk = w −3 αn (w 10 ) + w −7 δn (w 10 ), and Lemma 6.7
tells us that αn and δn are in V1 and V3 . By Lemmas 6.5 and 6.6, s0,1 (αn ) =
w −3 αn (w 10 ), s0,1 (δn ) = w −7 δn (w 10 ). So Pk = s0,1 (αn ) + s0,1 (δn ). Corollaries
3.8 and 3.6 show that αn = [c − 1, d] + a sum of earlier monomials, while δn
is a sum of monomials preceding [c − 1, d]. Since the si,j preserve the linear
order on monomials, s0,1 (αn ) + s0,1 (δn ) = h2c − 2, 2d + 1i + a sum of earlier
monomials, as desired.
Suppose k ≡ 23 (40). Then s0,1 (tn ) = h2c, 2d + 1i, which by Lemma 6.6 is
w −7 (w 10n ) = w k . So we need to show that Pk = h2c − 1, 2d + 1i + a sum of
earlier monomials. Now Pk = w −9 βn (w 10 ) + w −1 δn (w 10 ), and Lemma 6.7 tells
us that βn and δn are in V3 . By Lemma 6.6, s−1,1 (βn ) = w −9 βn (w 10 ), while
s1,1 (δn ) = w −1 δn (w 10 ). So Pk = s−1,1 (βn ) + s1,1 (δn ). By Corollaries 3.4 and
3.6, βn = [c, d] + a sum of earlier monomials, while δn is a sum of monomials
preceding [c − 1, d]. So Pk = h2c − 1, 2d + 1i + a sum of earlier monomials.
Suppose k ≡ 27 (40). Then s1,0 (tn ) = h2c + 1, 2di, which by Lemma 6.6 is
w −3 (w 10n ) = w k . So we need to show that Pk = h2c, 2di + a sum of earlier
monomials. Now Pk = w −1αn (w 10 ) + w −9 γn (w 10 ), and Lemma 6.7 tells us that
αn and γn are in V1 . By Lemma 6.5, s2,0 (αn ) = w −1 αn (w 10 ), while s0,0 (γn ) =
w −9 γn (w 10 ). So Pk = s2,0 (αn ) + s0,0 (γn ). By Corollaries 3.8 and 3.2, αn = [c −
1, d] + a sum of earlier monomials, while γn is a sum of monomials preceding
[c, d]. So Pk = h2c, 2di + a sum of earlier monomials.
Finally suppose k ≡ 29 (40). Then s1,1 (tn ) = h2c+1, 2d+1i, which by Lemma
6.6 is w −1 (w 10n ) = w k . So we need to show that Pk = h2c, 2d + 1i + a sum
of earlier monomials. Now Pk = w −7βn (w 10 ) + w −3 γn (w 10 ), and Lemma 6.7
tells us that βn and γn are in V3 and V1 . By Lemmas 6.6 and 6.5, s0,1 (βn ) =
12

w −7 βn (w 10 ), s0,1 (γn ) = w −3 γn (w 10 ). So Pk = s0,1 (βn ) + s0,1 (γn ). By Corollaries
3.4 and 3.2, βn = [c, d] + a sum of earlier monomials, while γn is a sum of
monomials preceding [c, d]. It follows that Pk = h2c, 2d + 1i + a sum of earlier
monomials, completing the proof. ✷
Lemma 7.2 Lemma 5.5 holds when k ≡ 3 or 9 (40).
Proof We may write k as 10n − 7 or 10n − 1 with n ≡ 1 (4). Let tn = [c, d];
note that c is even.
Suppose k ≡ 3 (40). Then s1,0 (tn ) = h2c + 1, 2di, which by Lemma 6.5 is
w −7 w 10n = w k . So we need to show that Pk = h2c, 2di + a sum of earlier
monomials. Now Pk = w −9 βn (w 10 ) + w −1δn (w 10 ), and Lemma 6.7 tells us
that βn and δn are in V1 . So by Lemma 6.5, s0,0 (βn ) = w −9 βn (w 10 ) while
s2,0 (δn ) = w −1δn (w 10 ). So Pk = s0,0 (βn ) + s2,0 (δn ). By Corollaries 3.4 and 3.6,
βn = [c, d] + a sum of earlier monomials, while δn is a sum of monomials
preceding [c − 1, d]. So Pk = h2c, 2di + a sum of earlier monomials.
Suppose k ≡ 9 (40). Then s2,0 (tn ) = h2c + 2, 2di, which by Lemma 6.5 is
w −1 w 10n = w k . So we need to show that Pk = h2c + 1, 2di + a sum of earlier
monomials. Now Pk = w −7 βn (w 10 ) + w −3γn (w 10 ), and Lemma 6.7 tells us that
βn and γn are in V1 and V3 . By Lemmas 6.5 and 6.6, s1,0 (βn ) = w −7 βn (w 10 )
while s1,0 (γn ) = w −3 γn (w 10 ). So Pk = s1,0 (βn )+s1,0 (γn ). By Corollaries 3.4 and
3.2, βn = [c, d] + a sum of earlier monomials, while γn is a sum of monomials
preceding [c, d]. So Pk = h2c + 1, 2di + a sum of earlier monomials, completing
the proof. ✷
Lemma 7.3 Lemma 5.5 holds when k ≡ 1 or 7 (40) and a > 0.
Proof Now k = 10n − 9 or 10n − 3 with n ≡ 1 (4), and tn = [c, d] with c
even.
Suppose k ≡ 1 (40). Then s0,0 (tn ) = h2c, 2di, which by Lemma 6.5 is w −9 w 10n =
w k . So c 6= 0 and we need to show that Pk = h2c − 1, 2di + a sum of earlier
monomials. Now Pk = w −3αn (w 10 )+w −7 δn (w 10 ) and by Lemma 6.7, αn and δn
are in V3 and V1 . Lemmas 6.6 and 6.5 then show that Pk = s1,0 (αn ) + s1,0 (δn ).
By Corollaries 3.8 and 3.6, αn = [c − 1, d] + a sum of earlier monomials, while
δn is a sum of monomials preceding [c − 1, d]. So Pk = h2c − 1, 2di + a sum of
earlier monomials.
Suppose k ≡ 7 (40). Then s0,1 (tn ) = h2c, 2d + 1i, which is w −3 w 10n = w k .
So again c 6= 0 and we need to show that Pk = h2c − 1, 2d + 1i + a sum of
earlier monomials. Now Pk = w −1αn (w 10 ) + w −9γn (w 10 ), and both αn and γn
are in V3 . Lemma 6.6 then shows that Pk = s1,1 (αn ) + s−1,1 (γn ). By Corollaries
3.8 and 3.2, αn = [c − 1, d] + a sum of earlier monomials, while γn = a sum
of monomials preceding [c, d]. So Pk = h2c − 1, 2d + 1i + a sum of earlier
monomials. ✷
13

To complete the proof of Lemma 5.5 we need to consider two final cases—when
w k = h0, bi and k is 1 or 7 mod 40.
Suppose k ≡ 1 (40). Then k = 10n − 9 with n ≡ 1 (4), and as we saw in the
last lemma, tn = [0, d] with b = 2d. Furthermore, Pk = s1,0 (αn ) + s1,0 (δn ). By
Corollaries 3.8 and 3.6, αn and δn are sums of monomials equal to or preceding
[0, d − 1]. Then Pk is a sum of monomials equal to or preceding h1, 2d − 2i.
But h1, 2d − 2i precedes h0, 2d − 1i = h0, b − 1i. Next suppose k ≡ 7 (40).
Then k = 10n − 3 with n ≡ 1 (4), and as we saw in the last lemma, tn = [0, d]
with b = 2d + 1. Also, Pk = s1,1 (αn ) + s−1,1 (γn ). By Corollaries 3.8 and 3.2,
αn is a sum of monomials equal to or preceding [0, d − 1] while γn is a sum
of monomials in V3 preceding [0, d], and consequently equal to or preceding
[1, d − 1]. Thus Pk is a sum of monomials equal to or preceding h1, 2d − 1i.
But h1, 2d − 1i precedes h0, 2di = h0, b − 1i, so we’re done.

References
[1] Gerbelli-Gauthier M. (2016), “The order of nilpotence of Hecke algebras mod
2: a new proof.” Research in Number Theory 2:7.
[2] Monsky P. (2015), “A Hecke algebra attached to mod 2 modular forms of level
3.” arXiv:1508.07523 [math.NT].
[3] Monsky P. (2016), “A characteristic 2 recurrence related to U3 , with a Hecke
algebra application.” arXiv:1603.03910 [math.NT].
[4] Monsky P. (2016), “A Hecke algebra attached to mod 2 modular forms of level
5.” arXiv:1610.07058 [math.NT].
[5] Monsky P. (2016), “A characteristic 2 recurrence related to U5 , with a Hecke
algebra application.” arXiv:1612.01599 [math.NT].
[6] Nicolas J.-L., Serre J.-P. (2012), “Formes modulaires modulo 2 : l’ordre de
nilpotence des opérateurs de Hecke.” C.R. Acad. Sci. Paris, Ser. 1 350 (7–8)
pages 343–348.

14

