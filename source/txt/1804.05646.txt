THE TRAVELING SALESMAN THEOREM IN CARNOT GROUPS

arXiv:1804.05646v1 [math.MG] 16 Apr 2018

VASILIS CHOUSIONIS, SEAN LI, AND SCOTT ZIMMERMAN

Abstract. Let G be any Carnot group. We prove that, if a subset of G is contained in a rectifiable curve, then it satisfies Peter Jones’ geometric lemma with some natural modifications. We
thus prove one direction of the Traveling Salesman Theorem in G. Our proof depends on new
Alexandrov-type curvature inequalities for the Hebisch-Sikora metrics. We also apply the geometric lemma to prove that, in every Carnot group, there exist −1-homogeneous Calderón-Zygmund
kernels such that, if a set E ⊂ G is contained in a 1-regular curve, then the corresponding singular
integral operators are bounded in L2 (E). In contrast to the Euclidean setting, these kernels are
nonnegative and symmetric.

1. Introduction
Let X be a metric space. A set Γ ⊂ X is called a rectfiable curve if it is the Lipschitz image
of a finite interval. The Analyst’s Traveling Salesman Problem asks the following: given a set
E ⊂ X, is there a finite length rectifiable curve Γ ⊂ X so that E ⊆ Γ? This would mean that
it is possible to visit the set E in finite time. In the case when such curves Γ exist, one can also
ask for the smallest length of Γ.
When X = R2 , Jones gave a complete answer to the first question using the notion of β-numbers
[19]. For E ⊂ X, x ∈ R2 , and r > 0 we define
βE (x, r) := inf

sup

L z∈B(x,r)∩E

d(z, L)
,
r

where the infimum is taken over the set of all affine lines L. Thus, βE (x, r) is a scale-invariant
measure of how close the set E lies to some line. He also developed upper and lower bounds for
the infimal length of rectifiable curves containing E by using these β-numbers. Okikiolu later
generalized his result to Euclidean spaces of all dimensions [24]. The following theorem is now
known as the Traveling Salesman Theorem:
Theorem 1.1 (Euclidean Traveling Salesman Theorem (TST) [19, 24]). Let E ⊂ Rn . Then E
lies on a finite length rectifiable curve if and only if
Z Z ∞
dr
(1.1)
γ(E) := diam(E) +
βE (x, r)2 n dx < ∞.
r
Rn 0
Furthermore, if γ(E) < ∞, then we have an estimate on the infimal length of such curves:
1
γ(E) ≤ inf `(Γ) ≤ Cγ(E),
Γ⊃E
C
where C is some constant depending only on n.
It is well known from Rademacher’s theorem that rectifiable curves in Rn infinitesimally resemble lines. However, to answer questions about the boundedness of singular integrals and
V.C. is supported by the Simons Collaboration grant no. 521845. S.L. is supported by NSF grant DMS-1600804.
1

2

VASILIS CHOUSIONIS, SEAN LI, AND SCOTT ZIMMERMAN

other problems of a global nature, Rademacher’s theorem does not provide enough quantitative
information. Stated informally, one would like to know that rectifiable curves admit good affine
approximations “at most places and scales”. This is typically quantified via integrals over space
and scale as in (1.1). Such Carleson integrals convey the right quantitative information required
for the study of certain well known singular integrals. Jones was the first to realize this connection [18]. He used β-numbers to control the Cauchy singular integral on 1-dimensional Lipschitz
graphs. Since Jones’ pioneering work, β-numbers have become crucial tools in harmonic analysis,
geometric measure theory, and their connections. In fact, the introduction of β-numbers may be
viewed as a point of departure for the theory of quantitative rectifiability which was developed
in the 90’s by David and Semmes [8, 9, 10]. The study of quantitative rectifiability led to a rich
geometric framework for singular integrals acting on lower dimensional subsets of Rn . For more
information, we refer the reader to the books [9, 25, 31]
There have been numerous generalizations and variants of Theorem 1.1 beyond Euclidean
spaces. Schul [27] extended Theorem 1.1 to Hilbert spaces, David and Schul [11] recently considered the theorem in the graph inverse limits of Cheeger-Kleiner, and Hahlomaa and Schul
(independently)[15, 16, 26] obtained variants of Theorem 1.1 in general metric spaces. In the last
case, however, there is no natural notion of lines over which one may infimize in the definition of
β, so curvature-type quantities other than β-numbers must be considered.
A natural class of metric spaces in which to study the Analyst’s Traveling Salesman Problem
(TSP) is the class of Carnot groups (introduced in more detail in Section 2). This is a special
subclass of nilpotent Lie groups whose abelian members are precisely the Euclidean spaces. Thus,
these groups can be viewed as nonabelian generalizations of Euclidean spaces. Moreover, Carnot
groups are locally compact geodesic spaces which admit dilations, and they are isometrically
homogeneous. In fact, by a recent observation of Le Donne [20], Carnot groups are the only
metric spaces with these properties. Developing aspects of quantitative rectifiability (such as
the TST) in Carnot groups contributes to the systematic effort which started about 15 years
ago to develop Geometric Measure Theory (GMT) on these sub-Riemannian spaces. Rather
than providing a long list of highlights in sub-Riemannian GMT, we refer the reader to the
recent lecture notes of Serra Cassano [28] which provide a nice overview of the field with ample
references to the continuously growing literature.
Like Euclidean spaces, Carnot groups are Ahlfors regular and contain a rich family of lines
(which are cosets of 1-dimensional subgroups isometric to R). These are the so-called horizontal
lines. Hence the definition of β-numbers readily generalizes in this case. Indeed, in the definition
of βE (x, r), we instead take the infimum inf L over all horizontal lines that intersect B(x, r), and
we use the sub-Riemannian metric to measure distance. Ferrari, Franchi and Pajot [13] initialized
the study of the TSP in the simplest nonabelian Carnot group; the Heisenberg group H. They
2 is bounded, then E lies on a rectifiable curve. Schul
proved that, if the Carleson integral of βE
and the second named author [22, 23] improved the aforementioned result, and they obtained an
almost sharp Traveling Salesman Theorem in H:
Theorem 1.2 ([22]). There exists a universal constant C > 0 so that if Γ ⊂ H is a finite length
rectifiable curve, then
Z Z ∞
dr
diam(Γ) +
βΓ (x, r)4 4 dx ≤ C`(Γ).
r
H 0
Theorem 1.3 ([23]). For any p < 4, there exists C(p) > 0 so that for any E ⊂ H for which
Z Z ∞
dr
γp (E) := diam(E) +
βE (x, r)p 4 dx < ∞,
r
H 0

THE TST IN CARNOT GROUPS

3

then there is a finite length rectifiable curve Γ that contains E and
`(Γ) ≤ Cp γp (E).
It is currently unknown whether Theorem 1.3 holds for p = 4. This would give a sharp converse
is an obvious modification resulting from
to Theorem 1.2. Note that the 4 in the exponent of dr
r4
the Hausdorff dimension of the Heisenberg group. However, the exponent 4 of βE in Theorem
1.2 is a consequence of an Alexandrov-type curvature inequality in H whose rather delicate proof
depends crucially upon the Koranýi metric in H. Note, however, that Theorem 1.2 holds for any
homogeneous metric in H including the sub-Riemannian metric.
We cannot use the Koranýi metric in the general setting since it does not generalize to arbitrary
Carnot groups. Instead, we use another family of metrics – the Hebisch-Sikora metrics [17] – for
which we will establish a similar curvature inequality (Theorem 3.1). With the new curvature
inequality, we can then use the proof of [22] to obtain the following theorem which holds for all
homogenous metrics in any Carnot group G.
Theorem 1.4. Let G be a step r Carnot group with Hausdorff dimension Q. There is a constant
C = C(G) > 0 such that, for any rectifiable curve Γ ⊂ G, we have
Z Z ∞
2 dt
βΓ (B(x, t))2r Q dHQ (x) ≤ CH1 (Γ).
t
G 0
In the case of step 2 Carnot groups (of which the Heisenberg group is an example), this theorem
2
provides a bound on the Carleson integral involving β 2·2 = β 8 . This is weaker than the bound
on the Carleson integral of Theorem 1.2 which involves β 4 . We will prove in Section 5 that,
in the special case of step 2 Carnot groups, the curvature inequality can be improved so that
Theorem 1.4 holds with an exponent 4 on β. Therefore we obtain a genuine generalization of
Theorem 1.2 to any step 2 Carnot group.
Theorem 1.5. Let G be a step 2 Carnot group with Hausdorff dimension Q. There is a constant
C = C(G) > 0 such that, for any rectifiable curve Γ ⊂ G, we have
Z Z ∞
dt
βΓ (B(x, t))4 Q dHQ (x) ≤ CH1 (Γ).
t
G 0
As mentioned earlier, there are deep connections between quantitative rectifiability and singular integral operators (SIO) in Euclidean spaces. In particular, the boundedness of SIOs on
Lipschitz graphs (and beyond) is a classical topic developed by Calderón [1], Coifman-McIntoshMeyer [5], David [6], David-Semmes [8, 9], Tolsa [30], and many others. In all of these contributions, the kernels defining the SIO are odd functions. This is very reasonable since, in order to
define a SIO which makes sense on lines and other “nice” 1-dimensional objects, one heavily relies
on the cancellation properties of the kernel, see e.g. [29, Proposition 1, pp 289]. Surprisingly, the
situation is very different in Carnot groups, and this was first observed in the first Heiseinberg
group in [3]. Using Theorem 1.4, we will prove the following theorem.
Theorem 1.6. Let (G, d) be Carnot group of step r ≥ 2 equipped with a homogeneous metric d.
There exists a nonnegative, symmetric, −1 homogeneous, Calderón-Zygmund kernel K : G\{0} →
(0, ∞) such that the corresponding truncated singular integrals
Z
T ε f (p) =
K(q −1 · p)f (q) dH1 (q)
E\Bd (p,ε)

are uniformly bounded in
curve.

L2 (H1 |E )

for every 1-regular set E which is contained in a 1-regular

4

VASILIS CHOUSIONIS, SEAN LI, AND SCOTT ZIMMERMAN

The paper is organized as follows. In Section 2, we will introduce the basic properties of
Carnot groups that will be needed for our purposes, and we will define the Hebisch-Sikora metric
used throughout the paper. We will introduce and prove the curvature estimate Theorem 3.1 in
Section 3. This curvature bound will be used to prove Theorem 1.4 in Section 4. This section
follows the example set forth in [22]. The case of step 2 groups will be addressed in Section 5.
Finally in Section 6 we will prove Theorem 1.6.
2. Carnot preliminaries
A step r Carnot group is a connected, simply connected Lie group G whose Lie algebra g is
stratified in the following sense:
g = V1 ⊕ · · · ⊕ Vr ,

[V1 , Vi ] = Vi+1 for i = 1, . . . , r − 1,

[V1 , Vr ] = {0}

where V1 , . . . , Vr are non-zero subspaces of the Lie algebra. Any such Lie group may be identified
with RN for some N ∈ N via the exponential coordinates on g. Denote
by | · | the Euclidean norm
Pr
N
in G = R . Say Q is the homogeneous dimension of G i.e. Q = i=1 i dim Vi . There is a natural
family of automorphisms known as dilations on G. If, for any p ∈ G, we write p = (p1 , . . . , pr )
where pi ∈ Rvi for vi = dim Vi , then for any s > 0 define the dilation

δs (p) = sp1 , s2 p2 , . . . , sr pr .
It follows that {δs }s>0 is a one parameter family i.e. δs ◦ δt = δst . Given p ∈ G, we will also often
write p = (p1 , p2 ) ∈ Rv1 × RN −v1 . We may then think of p1 as the “horizontal part” of p. Define
the non-horizontal part of p ∈ G as
N H(p) := π̃(p)−1 p
where π̃ : G → G is the map π̃(p1 , p2 ) = (p1 , 0) (note that this is not a projection!).
We will now endow G with a metric space structure.
Theorem 2.1 (Hebisch and Sikora, 1990). There exists ε0 > 0 so that, for every η < ε0 ,
kxk = inf{t : |δ1/t (x)| < η}

for all x ∈ G

is a homogeneous, subadditive norm on G i.e. for every s > 0 and x, y ∈ G, kδs (x)k = skxk and
kxyk ≤ kxk + kyk. In particular, the unit ball in k · k coincides with the Euclidean ball BRN (0, η).
For any η < ε0 , call this norm the Hebisch-Sikora (HS) norm on G as introduced in [17].
Define the induced metric d on G as d(x, y) = ky −1 xk. The continuity of the Carnot dilations
implies in particular that |δ1/kxk (x)| = η. For any horizontal point (that is, p ∈ Rn × {0}), we
have
(2.1)

kpk = inf{t :

1
t |p|

< η} = inf{t :

1
η |p|

< t} = η1 |p|.

Moreover, we have kπ̃(p)k ≤ kpk for any p ∈ G. Indeed, if there was some t > 0 satisfying both
2
2
p2
p2
kπ̃(p)k > t and |δ1/t (p)| < η, we would have η 2 > t21 + · · · + tp2rr ≥ t21 = kπ̃(p)k
η 2 > η 2 which is
t2
impossible. We also record that for any compact K ⊂ G, there is a constant C > 0 (depending
on K) so that
(2.2)

d(x, y)r ≤ C|x − y| for any x, y ∈ K.

A metric d on G is said to be homogeneous if d : RN × RN → [0, ∞) is continuous with respect
to the Euclidean topology, is left invariant, and is 1-homogeneous with respect to the dilations
{δr }r>0 . The 1-homogeneity of d means that
d(δr (p), δr (q)) = r d(p, q)

THE TST IN CARNOT GROUPS

5

for all p, q ∈ G and all r > 0. We note in particular that the Hebisch-Sikora and the Carnot–
Carathéodory metrics are homogeneous. Any two homogeneous metrics d1 and d2 on a given
Carnot group G are equivalent in the sense that there exists a constant L > 0 so that
L−1 d1 (p, q) ≤ d2 (p, q) ≤ Ld1 (p, q)

(2.3)

for all p, q ∈ G; this is an easy consequence of the assumptions.
We define the Jones β-numbers for a set K ⊂ G as follows: for any x ∈ G and r > 0,
d(z, L)
βK (B(x, r)) = inf
sup
L z∈K∩B(x,r)
r
where the infimum is taken over all possible horizontal lines
L = {pδs (π̃(p−1 q)) : s ∈ R}

where p, q ∈ G.

The following is the famous Baker-Campbell-Hausdorff formula.
Theorem 2.2 (Dynkin, ’47). Suppose e(·) : g → G is the exponential map. Given X, Y ∈ g,
choose Z such that eZ = eX eY . Then
∞
X
(−1)k−1 X
P (r1 , s1 , . . . , rk , sk )[X, · · · [X , [Y, · · · [Y , · · · [X, · · · [X , [Y, · · · Y ]]] · · · ]
Z=
| {z } | {z }
| {z } | {z }
k
k=1

r1

s1

rk

sk

where the second sum is taken over all {r1 , s1 , . . . , rk , sk } ∈ N2k satisfying ri + si > 0 for i =
1, . . . , k, and
1
.
P (r1 , s1 , . . . , rk , sk ) = Pk
Qk
r
!s
!
(r
+
s
)
i
i
i
i
i=1
i=1
Notice that the nested commutators vanish if sk > 1 or if sk = 0 and rk > 1. Also, since
G is nilpotent, the first sum terminates after finitely many terms, and the length of the nested
brackets is bounded from above. That is, there are only finitely many summed nested bracket
terms in the BCH formula for a Carnot group G.
We will later make use of the following estimates established in [17] (for a verification, see the
proof of Lemma 3.2). Choose a, b ∈ G with |a| < 1 and |b| < 1. Write a = (a1 , a2 ) and b = (b1 , b2 )
as above. Then
ab = (a1 + b1 , a2 + b2 + R(a, b))
for some polynomial R given by the BCH formula (Theorem 2.2). Write R1 (a, b) = R((a1 , 0), (b1 , 0))
and R2 = R − R1 . Then the BCH formula gives
(2.4)

|R2 (a, b)| ≤ C2 (|a1 ||b2 | + |a2 ||b1 | + |a2 ||b2 |)

and


 a1
b1 

−
.
(2.5)
|R1 (a, b)| ≤ C1 |a1 ||b1 | 
|a1 | |b1 | 
for some constants C1 and C2 depending only on the group structure of G.
For the remainder of the paper, fix a positive constant η < min{ε0 , 21 } (where ε0 is as in
Theorem 2.1) such that, if |a| ≤ η and |b| ≤ η, then
1
(2.6)
(C2 + 1)(|a1 | + |a2 | + |b1 | + |b2 |) ≤
8
and
1
(2.7)
(5C12 + 1)|a1 ||b1 | ≤ .
2

6

VASILIS CHOUSIONIS, SEAN LI, AND SCOTT ZIMMERMAN

Throughout the paper, we will write a . b to indicate that there is a constant C > 0 depending
only on the metric space (G, d) satisfying a ≤ Cb. Similarly, we will write a .ξ b if the constant
depends also on some other parameter ξ.
3. Curvature bound in a Carnot group
For p, q ∈ G, denote the horizontal segment between them as
Lpq := {p δt (π̃(p−1 q)) : t ∈ [0, 1]}.
While this segment will always originate at p, it will not intersect q in general. Note also that
horizontal segments do not necessarily coincide with Euclidean segments if the step of G is r > 2.
For each t ∈ [0, 1], write Lpq (t) = p δt (π̃(p−1 q)). If p = 0, then Lq := L0q ⊂ Rn × {0} is the
segment
Lq = {δt (π̃(q)) : t ∈ [0, 1]} = {(tq1 , 0) : t ∈ [0, 1]}.
That is, Lq is simply the Euclidean line segment from the origin to π̃(q) = (q1 , 0). Our goal in
this section will be to prove the following curvature estimate in G. Here, fix the value m = 2−217 .
(This value will be important in Section 4. The theorem actually holds for any 0 < m < 1, but
then the constant C0 would depend also on m.)
Theorem 3.1. Suppose a, z, v, w ∈ G satisfy
mρ ≤ min{d(a, z), d(a, v), d(z, v), d(v, w)}
and
max{d(a, z), d(a, v), d(z, v), d(v, w), d(a, w)} ≤ ρ
for some ρ > 0. Then there is a constant C0 = C0 (G) > 0 so that
2

2

sup d(Lav (t), Law )2r + sup d(Lvw (t), Law )2r ≤ C0 ρ2r
t∈[0,1]

2 −1

∆

t∈[0,1]

where ∆ := d(a, z) + d(z, v) + d(v, w) − d(a, w).

Figure 1.
3.1. Preliminary lemmas. We will need the estimates from the following two lemmas in the
proof of Lemma 3.4.
Lemma 3.2. For any a = (a1 , a2 ) and b = (b1 , b2 ) in G with |a| < 1 and |b| < 1, we have


 a1
b1 
r

kN H(ab)k . |a1 ||b1 | 
−
+ |a2 |(|b1 | + |b2 |) + |b2 |(|a1 | + |a2 |).
|a1 | |b1 | 

THE TST IN CARNOT GROUPS

7

In particular, we will use the fact that

2

 a1

b
1
2r
 + (|a2 |(|b1 | + |b2 |) + |b2 |(|a1 | + |a2 |))2
(3.1)
αkN H(ab)k ≤ |a1 ||b1 | 
−
|a1 | |b1 | 
for some 0 < α < 1 depending only on the metric and group structure of G.
Proof. We may write a = eA and b = eB for A, B ∈ g. In other words, A = log a and B = log b.
Write A = A1 + A2 and B = B1 + B2 where A1 , B1 ∈ V1 lie in the horizontal (first) layer of g.
According to the Baker-Campbell-Hausdorff formula (Theorem 2.2) and the bilinearity of the Lie
bracket, log(ab) is a finite sum of constant multiples of
[Z1 , [Z2 , · · · , [Zk−2 , [Zk−1 , Zk ]] · · · ]]

(3.2)

for some positive integer k ≤ r where each Zi is one of A1 , B1 , A2 , or B2 . In particular, [Zk−1 , Zk ]
must have the form
(3.3)

[A1 , B1 ],

[A1 , B2 ],

[A2 , B1 ],

or

[A2 , B2 ].

Indeed, we must have sn = 1 or we have sn = 0 and rn = 1 (for otherwise the brackets vanish),
so the nested brackets (3.2) must have the form
[·, [·, · · · , [A, B] · · · ]] = [·, [·, · · · , [A1 + A2 , B1 + B2 ] · · · ]] =

2 X
2
X

[·, [·, · · · , [Ai , Bj ] · · · ]]

i=1 j=1

(since [A, B] = −[B, A]).
By definition, we have
|N H(ab)| = |π̃(ab)−1 (ab)| = |(−a1 − b1 , 0)(a1 + b1 , a2 + b2 + P (a, b))|
for some polynomial P (given by the BCH formula). Thus by a similar argument as above,
log(N H(ab)) is a finite sum of constant multiples of nested brackets (3.2) each of which ends
with a term of the form (3.3). Consider the norm | · | on g induced by the Euclidean norm on the
exponential coordinates RN . (i.e. for X ∈ g with eX = x ∈ G, we have |X| = |x|.) Since




A1
B1 B1
A1 B1
,
= |A1 ||B1 |
−
,
,
[A1 , B1 ] = |A1 ||B1 |
|A1 | |B1 |
|A1 | |B1 | |B1 |
the bilinearity of the Lie bracket gives the following bound:


 A1

B
1
.
|[A1 , B1 ]| . |A1 ||B1 | 
−
|A1 | |B1 | 
Thus, for those brackets (3.2) ending with [A1 , B1 ], we have
!


k−2
Y
 a1
b1 

|[Z1 , [Z2 , · · · , [Zk−2 , [Zk−1 , Zk ]] · · · ]]| .
|Zi | |[A1 , B1 ]| . |a1 ||b1 | 
−
|a1 | |b1 | 
i=1

since |a| < 1 and |b| < 1. All other nested brackets (3.2) which do not end with [A1 , B1 ] satisfy
|[Z1 , [Z2 , · · · , [Zk−2 , [Zk−1 , Zk ]] · · · ]]| .

k
Y

|Zi | ≤ |a2 |(|b1 | + |b2 |) + |b2 |(|a1 | + |a2 |).

i=1

Since we may estimate |N H(ab)| = | log(N H(ab))| by a finite sum of constant multiples of the
nested brackets (3.2), we have proven


 a1
b1 

|N H(ab)| . |a1 ||b1 | 
−
+ |a2 |(|b1 | + |b2 |) + |b2 |(|a1 | + |a2 |).
|a1 | |b1 | 

8

VASILIS CHOUSIONIS, SEAN LI, AND SCOTT ZIMMERMAN

Hence there is some compact set K ⊂ G (depending only on the group structure and metric) so
that N H(ab) ∈ K for any a and b in the Euclidean unit ball. That is, we may apply (2.2) to
conclude kN H(ab)kr . |N H(ab)|. This completes the proof.

The following lemma is entirely Euclidean in nature and elementary. The details of the proof
are included for completeness.
Lemma 3.3. Fix c, d ∈ Rn . Let `c+d denote the segment from the origin to c + d. Then


c
d 2
2
1

n
dR (c, `c+d ) ≤ 2 |c||d|  −
.
|c| |d| 
Proof. We will make frequent use of the following consequence of the polarization identity:

2
c

d
 = |c|2 + 2|c||d| + |d|2 − |c + d|2 .
(3.4)
|c||d|  −
|c| |d| 
1
Let u denote the scalar projection of c along c + d. That is, u = hc,c+di
|c+d| . If u ≤ 0, then the
closest point in `c+d to c is the origin, so dRn (c, `c+d ) = |c|. We then have2


c
d 2
2
2
2
2
2

2dRn (c, `c+d ) = 2|c| ≤ |c| + |d| − |c + d| ≤ |c||d|  −
.
|c| |d| 

If u ≥ |c + d|, then the closest point in `c+d to c is c + d. Since3 |d|2 ≤ |c|2 − |c + d|2 , we have


c
d 2
2
2
2
2
2
2
2
2

n
2dR (c, `c+d ) = 2|c − (c + d)| = 2|d| = |d| + |d| ≤ |c| + |d| − |c + d| ≤ |c||d|  −
.
|c| |d| 
Now suppose 0 < u < |c + d|. That is, the projection of c to the line containing `c+d actually
lies in `c+d . Since this projection divides `c+d into segments of length u and |c + d| − u, the
Pythagorean Theorem gives
2


c
d
 = |c|2 + 2|c||d| + |d|2 − |c + d|2
|c||d|  −
|c| |d| 

 

= |c|2 − u2 + |d|2 − (|c + d| − u)2 + 2|c||d| + 2u2 − 2u|c + d|
= dRn (c, `c+d )2 + dRn (c, `c+d )2 + 2|c||d| + 2u(u − |c + d|)
= 2dRn (c, `c+d )2 + 2(|c||d| − u|d| + u|d| + u(u − |c + d|))
= 2dRn (c, `c+d )2 + 2|d|(|c| − u) + 2u(|d| − (|c + d| − u))
≥ 2dRn (c, `c+d )2
since (|c + d| − u)2 ≤ (|c + d| − u)2 + dRn (c, `c+d )2 = |d|2 and u ≤ |c| by the Cauchy-Schwartz
inequality.

The technical proof of this next lemma follows the example of the proof from [17] that the
HS-norm is sub-linear. By tightening some of the bounds from [17, Theorem 2], we are able
to estimate the error in the sub-linearity of the norm. Again, we have set m = 2−217 , but this
lemma actually holds for any m ∈ [0, 1].
1Indeed, if u ≤ 0, then the angle between the vector c and `
c+d is between π/2 and 3π/2.
2The assumption u ≤ 0 implies |c|2 + hc, di = hc, ci + hc, di = hc, c + di ≤ 0. Hence the polarization identity yields

2|c|2 ≤ −2hc, di = |c|2 + |d|2 − |c + d|2 .
3The polarization identity gives |d|2 = |c|2 + |c + d|2 − 2hc, c + di ≤ |c|2 + |c + d|2 − 2|c + d|2 since the assumption
u ≥ |c + d| implies −2hc, c + di ≤ −2|c + d|2 .

THE TST IN CARNOT GROUPS

9

Lemma 3.4. Fix x, y ∈ G. Set
dRn (x1 , `x1 +y1 )2
α kN H (xy)k2r
+
(kxk + kyk)2r−1
kxk + kyk

m2r
A :=
16

!
.

If 4A ≤ min{kxk, kyk}, then kxk + kyk − kxyk ≥ A.
Proof. Fix x, y ∈ G. We may assume that neither x nor y is 0 as, in that case, A = 0 and the
result trivially follows. Set a = δ1/kxk (x) and b = δ1/kyk (y) so that |a| = |b| = η. Write
s=

kxk
kxk + kyk − A

and t =

kyk
.
kxk + kyk − A

Note that s, t ∈ [0, 1] since 4A ≤ min{kxk, kyk}. These values have been chosen so that

 





 
(xy) = δ kxk
δ 1 (x) · δ kyk
δ 1 (y)  = |δs (a) δt (b)| .
1
δ
kxk+kyk−A

kxk+kyk−A

kxk

kxk+kyk−A

kyk

Write a = (a1 , a2 ) and b = (b1 , b2 ) as before. For ease of notation, we write write δλ (a1 ) =
δλ ((a1 , 0)) and δλ (a2 ) = δλ ((0, a2 )) for λ > 0, and we similarly use the shorthand δλ (b1 ) and
δλ (b2 ). Write v = δs (a2 ) + δt (b2 ) + (0, R2 (δs (a), δt (b))) where R2 is as defined in Section 2. The
bounds (2.4) and (2.6) give
(2.4)

|v| ≤ s2 |a2 | + t2 |b2 | + C2 (|δs (a1 )||δt (b2 )| + |δs (a2 )||δt (b1 )| + |δs (a2 )||δt (b2 )|)
≤ s2 |a2 | + t2 |b2 | + st(C2 + 1) (|a2 |(|b1 | + |b2 |) + |b2 |(|a1 | + |a2 |))
− (|δs (a2 )|(|δt (b1 )| + |δt (b2 )|) + |δt (b2 )|(|δs (a1 )| + |δs (a2 )|))
(2.6)

≤ s2 |a2 | + t2 |b2 | + 14 st (|a2 | + |b2 |)
− (|δs (a2 )|(|δt (b1 )| + |δt (b2 )|) + |δt (b2 )|(|δs (a1 )| + |δs (a2 )|))

≤ s|a2 | + t|b2 | −

1
2 st (|a2 |

+ |b2 |)

− (|δs (a2 )|(|δt (b1 )| + |δt (b2 )|) + |δt (b2 )|(|δs (a1 )| + |δs (a2 )|)) .
This last inequality follows from the following argument: since 4A ≤ kyk, we have
3
4t

− (1 − s) =

3
4 kyk

kxk + kyk − A

−

A − 14 kyk
kyk − A
=
≤0
kxk + kyk − A
kxk + kyk − A

so ( 34 t + s) ≤ 1 (and similarly ( 34 s + t) ≤ 1), and thus
s2 |a2 | + t2 |b2 | − s|a2 | − t|b2 | + 43 st (|a2 | + |b2 |) = s|a2 |



( 34 t + s) − 1 + t|b2 | ( 34 s + t) − 1 ≤ 0.

Moreover, the inequalities ( 34 t + s) ≤ 1 and ( 34 s + t) ≤ 1 imply that
|v| ≤ s2 |a2 | + t2 |b2 | + 41 st (|a2 | + |b2 |) ≤ |a2 | + |b2 |.
Hence
|v|2 (1 + st) ≤ |v|2 + st|v| (|a2 | + |b2 |)
≤ (|v| + 21 st (|a2 | + |b2 |))2
≤ (s|a2 | + t|b2 | − (|δs (a2 )|(|δt (b1 )| + |δt (b2 )|) + |δt (b2 )|(|δs (a1 )| + |δs (a2 )|)))2
≤ (s|a2 | + t|b2 |)2 − (|δs (a2 )|(|δt (b1 )| + |δt (b2 )|) + |δt (b2 )|(|δs (a1 )| + |δs (a2 )|))2 .
This last inequality follows from the fact that (k − `)2 ≤ k 2 − `2 when ` ≤ k and
|δs (a2 )|(|δt (b1 )| + |δt (b2 )|) + |δt (b2 )|(|δs (a1 )| + |δs (a2 )|

10

VASILIS CHOUSIONIS, SEAN LI, AND SCOTT ZIMMERMAN

≤ st (|a2 |(|b1 | + |b2 |) + |b2 |(|a1 | + |a2 |))
≤ s|a2 | + t|b2 |
since |a| = |b| = η < 12 . Therefore (3.4) together with the fact that 2hu1 , u2 i ≤ st|u1 |2 +
any u1 , u2 ∈ RN gives

|u2 |2
st

for

|δs (a)δt (b)|2 = |δs (a1 ) + δt (b1 )|2 + |v + (0, R1 (δs (a), δt (b)))|2


 δs (a1 )
δt (b1 ) 2
2

≤ (|δs (a1 )| + |δt (b1 )|) − |δs (a1 )||δt (b1 )| 
−
|δs (a1 )| |δt (b1 )| 


1
2
2
+ |v| (1 + st) + |R1 (δs (a), δt (b))| 1 +
st


(2.5)
 δs (a1 )
δt (b1 ) 2
2
2

≤ (s|a1 | + t|b1 |) + (s|a2 | + t|b2 |) − |δs (a1 )||δt (b1 )| 
−
|δs (a1 )| |δt (b1 )| 
− (|δs (a2 )|(|δt (b1 )| + |δt (b2 )|) + |δt (b2 )|(|δs (a1 )| + |δs (a2 )|))2




 δs (a1 )
δt (b1 ) 2
1
C12 |δs (a1 )|2 |δt (b1 )|2 
−
+ 1+
st
|δs (a1 )| |δt (b1 )| 
Now, according to (3.1), we have
− (|δs (a2 )|(|δt (b1 )| + |δt (b2 )|) + |δt (b2 )|(|δs (a1 )| + |δs (a2 )|))2



 δs (a1 )
δt (b1 )  2

≤ |δs (a1 )||δt (b1 )| 
−
− α kN H(δs (a)δt (b))k2r
|δs (a1 )| |δt (b1 )| 
and thus
|δs (a)δt (b)|2


 δs (a1 )
δt (b1 ) 2

≤ (s|a| + t|b|) − |δs (a1 )||δt (b1 )| 
−
|δs (a1 )| |δt (b1 )| 






δt (b1 ) 2
1
2
2
2  δs (a1 )
C1 + 1 |δs (a1 )| |δt (b1 )| 
−
+
1+
− α kN H(δs (a)δt (b))k2r
st
|δs (a1 )| |δt (b1 )| 
2

≤ (s|a| + t|b|)2 − α kN H(δs (a)δt (b))k2r
2

 δs (a1 )

δ
(b
)
t
1

−
+ (st +
+ st |a1 ||b1 | − 1 |δs (a1 )||δt (b1 )| 
|δs (a1 )| |δt (b1 )| 


(2.7)
 δs (a1 )
δt (b1 ) 2
≤ (s|a| + t|b|)2 − α kN H(δs (a)δt (b))k2r − 12 |δs (a1 )||δt (b1 )| 
−
|δs (a1 )| |δt (b1 )| 
1) C12





≤ (s|a| + t|b|)2 − α kN H(δs (a)δt (b))k2r − dRn (sa1 , `sa1 +tb1 )2
by Lemma 3.3. Since sa1 =

x1
kxk+kyk−A ,

tb1 =

y1
kxk+kyk−A ,



and |δs (a) δt (b)| = δ

1
kxk+kyk−A

have
|δs (a)δt (b)| − (s|a| + t|b|) ≤

=

−αkN H(δs (a)δt (b))k2r − dRn (sa1 , `sa1 +tb1 )2
|δs (a)δt (b)| + (s|a| + t|b|)


2r
dRn (x1 ,`x1 +y1 )2


−α N H δ
(xy)  − (kxk+kyk−A)
1
2
kxk+kyk−A

|δs (a)δt (b)| + (s|a| + t|b|)
2r

=

kN H(xy)k
−α (kxk+kyk−A)
2r −

dRn (x1 ,`x1 +y1 )2
(kxk+kyk−A)2

|δs (a)δt (b)| + (s|a| + t|b|)

= (∗).



(xy), we

THE TST IN CARNOT GROUPS

11

We proved in particular above that |δs (a)δt (b)| ≤ s|a| + t|b|. Since |a| = |b| = η, this gives
|δs (a)δt (b)| ≤ 2η < 8m−2r /η. Thus
!
dRn (x1 , `x1 +y1 )2
ηm2r
α kN H (xy)k2r
(∗) ≤ −
+
16
(kxk + kyk − A)2r
(kxk + kyk − A)2
!
dRn (x1 , `x1 +y1 )2
ηm2r α kN H (xy)k2r
(kxk + kyk − A)−1
+
≤−
16
(kxk + kyk)2r−1
kxk + kyk
Since |a| = |b| = η, the definitions of s and t give
s|a| + t|b| =

kxk
kyk
η(kxk + kyk)
|a| +
|b| =
.
kxk + kyk − A
kxk + kyk − A
kxk + kyk − A

In other words,


δ

1
kxk+kyk−A



kxk + kyk −

(xy) = |δs (a)δt (b)| ≤ η 

m2r
16



αkN H(xy)k2r
(kxk+kyk)2r−1

+

dRn (x1 ,`x1 +y1 )2
kxk+kyk

kxk + kyk − A


=η

according to the definition of A. Therefore, the definition of the HS norm gives
!
dRn (x1 , `x1 +y1 )2
m2r α kN H (xy)k2r
kxyk ≤ kxk + kyk −
+
.
16
(kxk + kyk)2r−1
kxk + kyk

Corollary 3.5. Fix v, w ∈ G. If
(3.5)

m2r
4

α kN H (w)k2r
dRn (v1 , `w1 )2
+
(d(0, v) + d(v, w))2r−1 d(0, v) + d(v, w)

m2r
16

α kN H (w)k2r
dRn (v1 , `w1 )2
+
(d(0, v) + d(v, w))2r−1 d(0, v) + d(v, w)

!
≤ min{d(0, v), d(v, w)},

then
(3.6)

!
≤ d(0, v) + d(v, w) − d(0, w).

Proof. Write x = v and y = v −1 w in Lemma 3.4.



3.2. Proof of Theorem 3.1. We are now ready to prove Theorem 3.1. This theorem controls
the deviation of horizontal segments by the excess in a four point triangle inequality. We restate
it here for convenience. Again, we have fixed m = 2−217 .
Theorem 3.1. Suppose a, z, v, w ∈ G satisfy
mρ ≤ min{d(a, z), d(a, v), d(z, v), d(v, w)}
and
max{d(a, z), d(a, v), d(z, v), d(v, w), d(a, w)} ≤ ρ
for some ρ > 0. Then there is a constant C0 = C0 (G) > 0 so that
2

2

sup d(Lav (t), Law )2r + sup d(Lvw (t), Law )2r ≤ C0 ρ2r
t∈[0,1]

t∈[0,1]

where ∆ := d(a, z) + d(z, v) + d(v, w) − d(a, w).

2 −1

∆

12

VASILIS CHOUSIONIS, SEAN LI, AND SCOTT ZIMMERMAN

We may assume without loss of generality from here on out that a = 0. Indeed, the metric is
left invariant, and horizontal segments commute with left multiplication in the following sense:
c−1 Lab (t) = c−1 aδt (π̃(a−1 b)) = c−1 aδt (π̃((c−1 a)−1 (c−1 b))) = L(c−1 a)(c−1 b) (t)
for any b, c ∈ G and any t ∈ [0, 1]. We will first establish the important tools used in the proof
of the theorem.
Lemma 3.6. Under the assumptions of Theorem 3.1, we have
(3.7)

ρ−(2r−1) kN H(w)k2r + ρ−1 dRn (v1 , `w1 )2 . d(0, v) + d(v, w) − d(0, w)

and
(3.8)

ρ−(2r−1) kN H(v)k2r + ρ−1 dRn (z1 , `v1 )2 . d(0, z) + d(z, v) − d(0, v).

Figure 2.
Proof. First, kN H(w)k ≤ kπ̃(w)k + kwk ≤ 2d(0, w) ≤ 2ρ, so
α kN H (w)k2r
(2ρ)2r
≤
≤ 2m−2r min{d(0, v), d(v, w)}.
(d(0, v) + d(v, w))2r−1
(2mρ)2r−1
We also have dRn (v1 , `w1 ) ≤ |v1 − w1 | = ηkπ̃(v −1 w)k ≤ kv −1 wk = d(v, w), so
ρ2
1
dRn (v1 , `w1 )2
≤
≤
min{d(0, v), d(v, w)} < 2m−2r min{d(0, v), d(v, w)}.
d(0, v) + d(v, w)
2mρ
2m2
We have just shown that v and w satisfy the assumption (3.5). Thus Corollary 3.5 gives (3.7).
Identical arguments show that z and v satisfy (3.5) with z in the place of v and v in the place of
w. This gives (3.8) and completes the proof of the lemma.

Consider the following from [21, Lemma 3.8]:
Lemma 3.7. Fix a constant M ≥ 1. For any 0 < ω < M , if f, g : [0, 1] → G are ρ-Lipschitz,
constant speed, horizontal segments satisfying
d(f (0), g(0)) ≤ ωρ
then supt∈[0,1] d(f (t), g(t)) ≤

C 0 ω 1/r ρ

and

d(f (1), g(1)) ≤ ωρ,

for some constant C 0 = C 0 (G, M ) > 0.

In other words, as long as the endpoints of the horizontal segment f are close enough to the
endpoints of g, then any point along f is close to g (up to a factor of a different power). Note
that the original lemma in [21] is stated for 0 < ω < 1, but the triangle inequality gives
d(f (t), g(t)) ≤ d(f (t), f (0)) + d(f (0), g(0)) + d(g(0), g(t)) ≤ ρ + ωρ + ρ
1

≤ 3ωρ ≤ (3M 1− r )ω 1/r ρ.
when 1 ≤ ω < M . Lemma 3.7 translates in our case to the following:

THE TST IN CARNOT GROUPS

13

Lemma 3.8. Suppose the following bounds hold for some C = C(G) > 0:
d(Lv (1), Lw )2r = d(π̃(v), Lw )2r ≤ Cρ2r−1 ∆,

(3.9)
(3.10)

d(Lvw (0), Lw )2r = d(v, Lw )2r ≤ Cρ2r−1 ∆,

(3.11)

d(Lvw (1), Lw )2r = d(v π̃(v −1 w), Lw )2r ≤ Cρ2r−1 ∆.

Then
2

2

sup d(Lv (t), Lw )2r + sup d(Lvw (t), Lw )2r . ρ2r
t∈[0,1]

2 −1

∆.

t∈[0,1]

Proof. Say f = Lvw and ĝ = Lw . (The case of f = Lv is similar and simpler.)
According to (3.10) and (3.11), we have
1

d(f (0), ĝ(t1 )) ≤ C 2r ρ

2r−1
2r

1

1

∆ 2r = ρ(Cρ−1 ∆) 2r

1

and d(f (1), ĝ(t2 )) ≤ ρ(Cρ−1 ∆) 2r

for some t1 , t2 ∈ [0, 1]. Note that f and ĝ are both ρ-Lipschitz. Indeed, for any s, t ∈ [0, 1],
d(f (s), f (t)) = d(v ∗ δs (π̃(v −1 w)), v ∗ δt (π̃(v −1 w))) = d((s(w1 − v1 ), 0), (t(w1 − v1 ), 0))
= k(−t(w1 − v1 ), 0) ∗ (s(w1 − v1 ), 0)k
= k((s − t)(w1 − v1 ), 0)k
= |s − t|kπ̃(v −1 w)k
≤ |s − t|d(v, w) ≤ |s − t|ρ.
The fourth equality follows from the fact that the brackets in the BCH formula all vanish in this
particular product since δs (π̃(v −1 w)) and δt (π̃(v −1 w)) are co-linear in Rn × {0} and [X, X] = 0.
Similarly, one may check that ĝ is ρ-Lipschitz.
Now define g : [0, 1] → G so that g(t) = ĝ(t(t2 −t1 )+t1 ). (We assume without loss of generality
that t1 ≤ t2 . If not, swap the roles of t1 and t2 in the definition of g.) Then g is ρ-Lipschitz,
g(0) = ĝ(t1 ), g(1) = ĝ(t2 ), and
g(t) = δt(t2 −t1 )+t1 (π̃(w)) = δt1 (π̃(w)) ∗ δt (δt1 (π̃(w))−1 δt2 (π̃(w))).
(The last equality holds since the points are co-linear in Rn × {0} (as above).) In other words, g
is the horizontal segment from δt1 (π̃(w)) to δt2 (π̃(w)). The hypotheses of Lemma 3.7 are satisfied
1
1
with ω = (Cρ−1 ∆) 2r ≤ (3C) 2r , so
1

d(Lvw (t), Lw ) ≤ d(f (t), g(t)) ≤ C 0 (ρ−1 ∆) 2r2 ρ
for some C 0 = C 0 (G) > 0 and any t ∈ [0, 1]. Therefore
2

d(Lvw (t), Lw )2r . ρ2r

2 −1

∆.


We now prove Theorem 3.1. Our main tool will be the application of inequalities (3.7) and
(3.8) to prove (3.9), (3.10), and (3.11). We will show that the distance of each endpoint to the
segment Lw is controlled by the distance of π̃(v) to the segment in the horizontal layer plus the
nonhorizontal part of v.

14

VASILIS CHOUSIONIS, SEAN LI, AND SCOTT ZIMMERMAN

Proof of Theorem 3.1. It suffices to prove (3.9), (3.10), and (3.11). We start with (3.9). Note
that π̃(v) ∈ Rn × {0} and Lw ⊂ Rn × {0}. Say pv ∈ Lw is the nearest point in Lw to π̃(v) (in the
Euclidean norm). Therefore, since δs (p) = sp for any p ∈ Rn × {0}, we have


d(π̃(v), pv )2r
d(π̃(v), pv ) 2r
=ρ
= ρ d(δ1/ρ (π̃(v)), δ1/ρ (pv ))2r . ρ |δ1/ρ (π̃(v)) − δ1/ρ (pv )|2
ρ2r−1
ρ
= ρ−1 dRn (v1 , `w1 )2 . ∆
according to (2.2) and (3.7). (Note that the constant from (2.2) here depends only on G since
δ1/ρ (π̃(v)) and δ1/ρ (pv ) lie in the unit ball of G). This gives (3.9).
Let us now prove (3.10). Arguing as above using (3.7) and (3.8) gives
d(v, π̃(v))2r
d(π̃(v), pv )2r
d(v, Lw )2r
.
+
ρ2r−1
ρ2r−1
ρ2r−1
2r
kN H(v)k
d(π̃(v), pv )2r
=
+
ρ2r−1
ρ2r−1
 


dRn (z1 , `v1 )2
kN H(w)k2r
dRn (v1 , `w1 )2
kN H(v)k2r
+
+
+
.
ρ2r−1
ρ
ρ2r−1
ρ
. [d(0, z) + d(z, v) − d(0, v)] + [d(0, v) + d(v, w) − d(0, w)] = ∆.
We will now prove (3.11). Writing v = π̃(v)N H(v) gives
ρ−1 d(vπ̃(v −1 w), π̃(w)) = ρ−1 d(π̃(v)N H(v)π̃(v −1 w), π̃(w))
= kδ1/ρ (π̃(v −1 w)π̃(w)−1 π̃(v))δ1/ρ (N H(v))k.
Since the HS norm is invariant under rotations of Rn × {0} ⊂ RN which fix the other N − n
coordinates, we may assume without loss of generality that the segment Lw lies along the x1 axis
in RN . Under this assumption, we have
π̃(w) = (w1 , 0) = (w11 , 0, 0)

and π̃(v) = (v1 , 0) = (v11 , v12 , 0)

where w11 , v11 ∈ R and v12 ∈ Rn−1 . In particular, it follows that dRn (v1 , `w1 ) = |v12 |. We can thus
write
δ1/ρ (π̃(v −1 w)π̃(w)−1 π̃(v)) = δ1/ρ ((w11 − v11 , −v12 , 0)(−w11 , 0, 0)(v11 , v12 , 0)) = (0, p2 )
where p2 is some BCH polynomial. The bound (2.2) gives
d(vπ̃(v −1 w), π̃(w))2r
. ρkδ1/ρ (N H(v))k2r + ρk(0, p2 )k2r . ρkδ1/ρ (N H(v))k2r + ρ|(0, p2 )|2 .
ρ2r−1
(Again, the constant from (2.2) here depends only on G since (0, p2 ) ∈ B(0, 3)). Arguing as in
the proof of Lemma 3.2, we may see that the polynomial p2 is a finite sum of constant multiples
of terms of the form
(3.12)

[Z1 , [Z2 , · · · , [Zk−2 , [Zk−1 , Zk ]] · · · ]]

where each Zi is either ρ−1 w11 , ρ−1 v11 , or ρ−1 v12 . (Note the abuse of notation here in which we
identify (w11 , 0, 0), (v11 , 0, 0) and (0, v12 , 0) with their associated vectors in the first layer of the
Lie algebra.) Note that the point (w11 , 0, 0) is simply a dilation of the point (v11 , 0, 0). Hence the
associated vector w11 is a constant multiple of the vector v11 . That is, [w11 , v11 ] = 0. In particular,
it follows that each term of the form (3.12) can only end with
[ρ−1 w11 , ρ−1 v12 ]

or

[ρ−1 v11 , ρ−1 v12 ].

THE TST IN CARNOT GROUPS

15

Since η < 1, we have ρ−1 |w11 | = ρ−1 ηkπ̃(w)k ≤ ρ−1 d(0, w) ≤ 1, and similarly we get ρ−1 |v11 | ≤ 1
and ρ−1 |v12 | ≤ 1. Therefore,
|[Z1 , [Z2 , · · · , [Zk−2 , [Zk−1 , Zk ]] · · · ]]| ≤

k
Y

|Zi | ≤ ρ−1 |v12 | = ρ−1 dRn (v1 , `w1 )

i=1

for each term of the form (3.12). Hence we may conclude
d(vπ̃(v −1 w), Lw )2r
kN H(v)k2r
dRn (v1 , `w1 )2
2
2r
−1 n
))
=
.
ρkδ
(N
H(v))k
+
ρ(ρ
d
(v
,
`
+
1
w
R
1/ρ
1
ρ2r−1
ρ2r−1
ρ
which, as in the proof of (3.10), is bounded by a constant multiple of ∆. This concludes the proof
of (3.11). We have therefore proven the hypotheses of Lemma 3.8 and thus the theorem.

4. Using Theorem 3.1 to prove Theorem 1.4
We will now apply the estimates from Section 3 to prove the Traveling Salesman Theorem
(Theorem 1.4) in G. In this section, we will follow the proof of the Traveling Salesman Theorem
in the Heisenberg group [22, Theorem I] given in [22]. Many of the arguments therein hold in
any metric space. As such, this section will provide a rough outline of the proof of Theorem 1.4.
Full proofs will be provided for the results whose proofs differ significantly from those in [22].
4.1. Preliminaries: arcs. First, we will recall the notation from [22]. Fix a connected Γ ⊂ G
with H1 (Γ) < ∞ and a 1-Lipschitz, arc-length parameterization γ : T → Γ (where T is a
circle in R2 ). Such a parameterization exists according to Lemma 2.10 in [22]. Orient T so
that we may discuss a particular direction of flow along Γ. Since βΓ is scale invariant (i.e.
βδλ (Γ) (δλ (B)) = βΓ (B)), we may assume without loss of generality that diam(Γ) = 1.
An arc τ in γ is the restriction γ|Iτ where Iτ = [a(τ ), b(τ )] is some interval in T compatible
with the orientation chosen above. Given two arcs τ and ζ, the notation ζ ⊂ τ means Iζ ⊂ Iτ ,
and we will write diam(τ ) to represent diam(τ (Iτ )).
S
For any L > 0, we define a prefiltration F 0 = n Fn0 to be a collection of arcs in γ satisfying
the following three conditions for any n ∈ N:
(1) For τ ∈ Fn0 , we have L2−100n ≤ diam(τ ) < L2−100n+3 .
(2) The domains of any two distinct arcs in Fn0 are disjoint in T.
0
(3) For any k ∈ N, if the domains of the arcs ζ ∈ Fn+k
and τ ∈ Fn0 intersect non-trivially,
then ζ ⊂ τ .
According to [22, Lemma 2.13], given any prefiltration F 0 , one may construct a filtration F =
∪n Fn generated by F 0 i.e. a collection of arcs in γ satisfying the following for any n ∈ N:
(1) Given ζ ∈ Fn+1 , there is a unique τ ∈ Fn such that ζ ⊂ τ .
(2) For τ ∈ Fn , we have L2−100n−10 ≤ diam(τ ) < L2−100n+4 .
(3) The domains of any two distinct arcs in Fn are either disjoint or intersect in (one or both
of)
S their endpoints.
(4) τ ∈Fn τ = T.
(5) For each arc τ 0 ∈ Fn0 , there is a unique arc τ ∈ Fn such that τ 0 ⊂ τ . Moreover, if I0
and I are the domains of τ0 and τ respectively, then the image of each of the connected
components of I \ I0 under γ has diameter less than L2−100n−10 .

16

VASILIS CHOUSIONIS, SEAN LI, AND SCOTT ZIMMERMAN

4.2. Preliminaries: balls. For each n ∈ Z, choose a 2−n separated net Xn of Γ (i.e. a set
Xn ⊂ Γ such that d(x, y) ≥ 2−n for any x, y ∈ Xn , and such that, for any z ∈ Γ, there is some
x ∈ X with d(z, x) < 2−n ). Define a multiresolution of Γ as follows:
Ĝ = {B(x, 10/2n ) : x ∈ Xn and n ∈ Z}.
We will use [22, Lemma 2.6] (which holds here with the same proof since G is Q-regular) to prove
the Traveling Salesman Theorem (Theorem 1.4) by establishing the bound
X
2
βΓ (B)2r diam(B) ≤ CH1 (Γ)
(4.1)
B∈Ĝ

where C depends only on G. As in [22, Lemma 2.9], it suffices to prove inequality (4.1) when the
sum is taken over the family G of balls in Ĝ with radius less than 1/100.
For a ball B = B(x, r), write αB = B(x, αr). Fix an integer κ > 3. Define B to be the
collection of balls 2B where B ∈ G. According to [22, Lemma 2.11], since G is doubling, there is
a constant D = D(κ) > 0 and a decomposition B = ∪D
i=1 Bi into pairwise disjoint families of balls
satisfying the following for each i:
(1) if B1 , B2 ∈ Bi have the same radius r, then d(B1 , B2 ) > κr.
(2) for any B1 , B2 ∈ Bi , the ratio of their radii equals 2100j for some j ∈ Z.
Fix i ∈ {1, . . . , D}. From each ball B ∈ G with 2B ∈ Bi , we may construct a set Q(B) (called a
cube) so that the family ∆(B, i) of cubes constructed from double-balls in Bi satisfies the following
(see [22, Lemma 2.12]):
(1) 2B ⊂ Q(B) ⊂ (1 + 2−98 )2B.
(2) Fix 2B, 2B 0 ∈ Bi . If Q(B) ∩ Q(B 0 ) 6= ∅ and the radius of B is larger than the radius of
B 0 , then Q(B 0 ) ⊂ Q(B).
(3) Fix balls 2B, 2B 0 ∈ Bi of equal radius. Then d(Q(B), Q(B 0 )) > (κ − 1)r.
Given any cube Q(B) ∈ ∆(B, i), define
Λ(Q(B)) = {τ = γ|I : I is a connected component of γ −1 (Γ ∩ Q(B)) and γ(I) ∩ B 6= ∅}.
These are the arcs
S of γ inside Q(B) that meet B. According to [22, Lemma 2.17], the collection
of arcs F 0,i = Q(B)∈∆(B,i) Λ(Q(B)) is a prefiltration for some Li > 0. As discussed above, this
induces a filtration F i . In particular, for each τ 0 ∈ F 0,i , there is a unique τ ∈ F i with τ 0 ⊂ τ .
We can therefore define the collection of extensions of arcs in Λ(Q(B)) as
Λ0 (Q(B)) = {τ ∈ F i : τ ⊃ τ 0 and τ 0 ∈ Λ(Q(B))}
for each cube Q(B) ∈ ∆(B, i).
For any arc τ of γ with domain Iτ , write Lτ = La(τ )b(τ ) and define
β(τ ) = sup
t∈Iτ

d(γ(t), La(τ )b(τ ) )
d(p, Lτ )
= sup
.
diam(τ )
diam(τ
)
p∈τ

As in [22], write G = G1 ∪ G2 where
G1 = {B ∈ G : there is τ ∈ Λ0 (Q(B)) such that β(τ ) ≥ 10−10 βΓ (B)}
and
G2 = {B ∈ G : β(τ ) < 10−10 βΓ (B) for all τ ∈ Λ0 (Q(B))}.

THE TST IN CARNOT GROUPS

17

4.3. Non-flat balls. In this section, we prove
Proposition 4.1.
X

2

βΓ (B)2r diam(B) . H1 (Γ).

B∈G1

This is half of the estimate (4.1) (and thus half of the proof of Theorem 1.4). We first need to
introduce some notation. There are D different filtrations of γ to consider,
S but we will treat them
individually. Fix i ∈ {1, . . . , D} and write F := F i . Recall that F = k Fk by the definition of
a filtration. Given τ ∈ Fk and j ∈ N, write
Fτ,j = {τ 0 ∈ Fk+j : τ 0 ⊂ τ }.
This is the collection of arcs j layers lower in the filtration which are contained in τ . Define
dτ = max
sup d(z, Lτ )
0
τ ∈Fτ,1 z∈L

for any τ ∈ F.

τ0

According to [22, Lemma 3.4], dτ ≤ 2 diam(τ ). We now prove the following version of Lemma 3.5
in [22]. This is the first place in this section where our proof differs significantly from the
arguments in [22], so details are included. In particular, it is in the proof of this lemma that we
use the curvature bound from Theorem 3.1.
Lemma 4.2. For any τ ∈ F, we have



2
2r
X
dτ
(4.2)
≤ C 00 
d(γ(a(τ 0 )), γ(b(τ 0 ))) − d(γ(a(τ )), γ(b(τ )))
diam(τ )2r2 −1
0
τ ∈F
τ,3

for some C 00 = C 00 (G) > 0.
Proof. Fix some τ ∈ Fk ⊂ F. As in the proof of Lemma 3.5 in [22], we have
2

d2r
2
2
τ
2r2
diam(τ ) ≤ 22r L2−100k+4 = 22r +117 L2−100k−113 .
2 −1 ≤ 2
2r
diam(τ )

(4.3)
Thus if




X





d(γ(a(τ 0 )), γ(b(τ 0 ))) − d(γ(a(τ )), γ(b(τ ))) ≥ L2−100k−113 ,

τ 0 ∈Fτ,3

we are done. Hence we may assume that



X

(4.4)
d(γ(a(τ 0 )), γ(b(τ 0 ))) − d(γ(a(τ )), γ(b(τ ))) < L2−100k−113 .
τ 0 ∈Fτ,3

Write Fτ,1 = {τi }M
i=1 arranged in order of the orientation of T. Set
P =

M
−1
[

{γ(b(τi ))}.

i=1

We will prove
(4.5)

d(P, {γ(a(τ )), γ(b(τ ))}) ≥ L2−100k−113 .

(The proof of this is nearly identical to the proof of (18) in [22].) Suppose (4.5) is not true. That
is, there is some j so that (without loss of generality) d(γ(b(τj )), γ(a(τ ))) < L2−100k−113 . Say ξ

18

VASILIS CHOUSIONIS, SEAN LI, AND SCOTT ZIMMERMAN

is the sub arc of τ defined on [a(τ ), b(τj )]. The arc ξ must contain at least one arc in Fτ,1 , so we
have diam(ξ) ≥ L2−100(k+1)−10 . Thus there is some point w ∈ ξ so that
min{d(γ(a(τ )), w), d(w, γ(b(τj )))} ≥ L2−100(k+1)−12 .
Note that w ∈ τ̃ for some τ̃ ∈ Fτ,2 . Since diam(τ̃ ) ≤ L2−100(k+2)+4 , the triangle inequality gives
min{d(γ(a(τ̃ )), d(γ(a(τ ))), d(γ(a(τ̃ )), γ(b(τj )))} ≥ L2−100k−113 .
Therefore, according to the triangle inequality and the negation of (4.5), we have
X
d(γ(a(τ 0 )), γ(b(τ 0 ))) ≥ d(γ(a(τ )), d(γ(a(τ̃ ))) + d(γ(a(τ̃ )), γ(b(τj ))) + d(γ(b(τj )), γ(b(τ )))
τ 0 ∈Fτ,3

> L2−100k−113 + d(γ(a(τ )), d(γ(b(τj ))) + d(γ(b(τj )), γ(b(τ )))
≥ L2−100k−113 + d(γ(a(τ )), γ(b(τ ))).
This contradicts (4.4). A similar argument in the case of γ(b(τ )) proves (4.5).
For any i ∈ {1, . . . , M }, we can repeat the above proof of (4.5) replacing γ(a(τ )) with γ(a(τi ))
and γ(b(τj )) with γ(b(τi )) to conclude
d(γ(a(τi )), γ(b(τi ))) ≥ L2−100k−113 .

(4.6)

Indeed, if d(γ(a(τi )), γ(b(τi ))}) < L2−100k−113 , we set ξ = τi and follow the previous arguments
to obtain
X
d(γ(a(τ 0 )), γ(b(τ 0 )))
τ 0 ∈Fτ,3

≥ d(γ(a(τ )), d(γ(a(τi ))) + d(γ(a(τi )), d(γ(a(τ̃ ))) + d(γ(a(τ̃ )), γ(b(τi ))) + d(γ(b(τi )), γ(b(τ )))
> d(γ(a(τ )), d(γ(a(τi ))) + L2−100k−113 + d(γ(a(τi )), d(γ(b(τi ))) + d(γ(b(τi )), γ(b(τ )))
≥ L2−100k−113 + d(γ(a(τ )), γ(b(τ )))
which again contradicts (4.4). This proves (4.6).
Fix i ∈ {2, . . . , M − 1}. We will first establish an estimate on the distance from Lγ(a(τ ))γ(b(τi ))
to Lτ . Combining (4.5) and (4.6) allows us to bound
min{d(γ(a(τ )), γ(a(τi ))), d(γ(a(τ )), γ(b(τi ))), d(γ(a(τi )), γ(b(τi ))), d(γ(b(τi )), γ(b(τ )))}
from below by L2−100k+4 2−117 ≥ 2−117 diam(τ ). Therefore, the assumptions of Theorem 3.1 are
satisfied with m = 2−217 and ρ = diam(τ ) where
a = γ(a(τ )),

z = γ(a(τi )),

v = γ(b(τi )),

and w = γ(b(τ )).

Theorem 3.1 then gives
d(Lγ(a(τ ))γ(b(τi )) (t), Lτ )2r
diam(τ )2r2 −1
(4.7)

2

2

d(Lav (t), Law )2r
ρ2r2 −1
. d(γ(a(τ )), γ(a(τi ))) + d(γ(a(τi )), γ(b(τi )))

=

+ d(γ(b(τi )), γ(b(τ ))) − d(γ(a(τ )), γ(b(τ )))
for any t ∈ [0, 1].
We now establish an estimate on the distance from Lτi to Lγ(a(τ ))γ(b(τi )) . Pairing this with (4.7)
will give (4.2). Choose an arc τ̂ ∈ Fτ,2 so that τ̂ is contained in the arc defined on [a(τ ), a(τi )]
and b(τ̂ ) 6= a(τi ). Such an arc always exists because, if it did not, then the only arc in Fτ,2 would

THE TST IN CARNOT GROUPS

19

be the arc defined on [a(τ ), a(τi )], and this violates the diameter bounds (2) in the definition of
a filtration. We may follow the proof of (4.5) to conclude that
min{d(a(τ ), b(τ̂ )), d(b(τ̂ ), a(τi ))} ≥ L2−100k−213 .

(4.8)

Figure 3.
Indeed, assume (without loss of generality) that d(a(τ ), b(τ̂ )) < L2−100k−213 , set ξ to be
the arc defined on [a(τ ), b(τ̂ )], and note that ξ must contain an arc in Fτ,2 . Thus diam(ξ) ≥
L2−100(k+2)−10 , and we can choose τ̃ ∈ Fτ,3 with diam(τ̃ ) ≤ L2−100(k+3)+4 so that
min{d(γ(a(τ̃ )), d(γ(a(τ ))), d(γ(a(τ̃ )), γ(b(τ̂ )))} ≥ L2−100k−213 .
Applying the triangle inequality and the negation of (4.5) leads to a contradiction of (4.4) just
as before. This proves (4.8). We have therefore bounded
min{d(γ(a(τ )), γ(b(τ̂ ))), d(γ(a(τ )), γ(a(τi ))), d(γ(b(τ̂ )), γ(a(τi ))), d(γ(a(τi )), γ(b(τi )))}
from below by 2−217 diam(τ ) as before. The assumptions of Theorem 3.1 are satisfied with
m = 2−217 and ρ = diam(τ ) where
a = γ(a(τ )),

z = γ(b(τ̂ )),

v = γ(a(τi )),

and w = γ(b(τi )).

This gives
d(Lτi (t), Lγ(a(τ ))γ(b(τi )) )2r
diam(τ )2r2 −1
(4.9)

2

2

d(Lvw (t), Law )2r
ρ2r2 −1
. d(γ(a(τ )), γ(b(τ̂ ))) + d(γ(b(τ̂ )), γ(a(τi )))
=

+ d(γ(a(τi )), γ(b(τi ))) − d(γ(a(τ )), γ(b(τi )))
for any t ∈ [0, 1].
Fix t ∈ [0, 1]. Choose p ∈ Lγ(a(τ ))γ(b(τi )) so that
d(Lτi (t), Lγ(a(τ ))γ(b(τi )) ) = d(Lτi (t), p)
and q ∈ Lτ so that
d(p, Lτ ) = d(p, q).
Combining (4.7) and (4.9) gives
2

2

2

d(Lτi (t), Lτ )2r
d(Lτi (t), q)2r
d(Lτi (t), p)2r + d(p, q)2r
≤
.
2
2
ρ2r −1
ρ2r −1
ρ2r2 −1

2

20

VASILIS CHOUSIONIS, SEAN LI, AND SCOTT ZIMMERMAN

d(Lτi (t), Lγ(a(τ ))γ(b(τi )) )2r

2

2

d(p, Lτ )2r
=
+
ρ2r2 −1
ρ2r2 −1
. d(γ(a(τ )), γ(a(τi ))) + d(γ(a(τi )), γ(b(τi )))
+ d(γ(b(τi )), γ(b(τ ))) − d(γ(a(τ )), γ(b(τ )))
+ d(γ(a(τ )), γ(b(τ̂ ))) + d(γ(b(τ̂ )), γ(a(τi )))
+ d(γ(a(τi )), γ(b(τi ))) − d(γ(a(τ )), γ(b(τi )))
≤ 2[d(γ(a(τ )), γ(b(τ̂ ))) + d(γ(b(τ̂ )), γ(a(τi ))) + d(γ(a(τi )), γ(b(τi )))
+ d(γ(b(τi )), γ(b(τ ))) − d(γ(a(τ )), γ(b(τ )))]




≤ 2 

X

d(γ(a(τ 0 )), γ(b(τ 0 ))) − d(γ(a(τ )), γ(b(τ ))) .

τ 0 ∈Fτ,3

In the case i = 1 (similarly, i = M ) where a1 = a (similarly, bM = b), choose τ̂ ∈ Fτ,2 so that
τ̂ is contained in the arc defined on [a(τ ), a(τ2 )] (similarly, the arc defined on [a(τ ), a(τM )]) and
b(τ̂ ) 6= a(τ2 ) (similarly, b(τ̂ ) 6= a(τM )). We may then apply Theorem 3.1 with m = 2−217 and
ρ = diam(τ ) (and noting that a(τ2 ) = b(τ1 )) to
a = γ(a(τ )),

z = γ(b(τ̂ )),

v = γ(a(τ2 )),

and w = γ(b(τ ))

(similarly, v = γ(a(τM ))) to get, as in the proof of (4.7) and (4.9),
d(Lγ(a(τ1 ))γ(b(τ1 )) (t), Lτ )2r

2

diam(τ )2r2 −1

. d(γ(a(τ )), γ(b(τ̂ ))) + d(γ(b(τ̂ )), γ(b(τ1 )))
+ d(γ(b(τ1 )), γ(b(τ ))) − d(γ(a(τ )), γ(b(τ )))

for any t ∈ [0, 1]. Similarly, we have the following bound for i = M :
d(Lγ(a(τM ))γ(b(τM )) (t), Lτ )2r

2

diam(τ )2r2 −1

. d(γ(a(τ )), γ(b(τ̂ ))) + d(γ(b(τ̂ )), γ(a(τM )))
+ d(γ(a(τM )), γ(b(τ ))) − d(γ(a(τ )), γ(b(τ ))).

This gives the result.



We conclude this subsection with the following estimate:
Proposition 4.3.
X

2

β(τ )2r diam(τ ) . H1 (Γ).

τ ∈F

Once this has been proven, we may argue exactly as in [22, Corollary 3.3] to prove Proposition 4.1, and this completes the subsection. (It is in that argument that the definition of G1 is
used.)
Proof of Proposition 4.3. Summing equation (4.2) over all τ ∈ F and all k gives

 

2
∞
X
X
X
X
d2r
τ

≤ C 00
d(γ(a(τ )), γ(b(τ ))) − 
d(γ(a(τ )), γ(b(τ )))
2r2 −1
diam(τ
)
τ ∈Fk+3
τ ∈Fk
τ ∈F
k=1
X
≤ 3C 00 sup
d(γ(a(τ )), γ(b(τ ))) ≤ 3C 00 `(γ).
k∈N τ ∈F

k

THE TST IN CARNOT GROUPS

21

For any τ ∈ F, say {τk }∞
k=0 is a sequence of subarcs with τj ∈ Fτ,j chosen so that dτj is maximal
among all subarcs in Fτ,j . Arguing as in the proof of [22, Proposition 3.1], applying [22, Lemma
2
3.6], using Minkowski’s integral inequality in `2r , and applying property (2) from the definition
of filtrations gives
!1/(2r2 )
!1/(2r2 )
∞
2r2
X
X
X
d
2
τ
k
β(τ )2r diam(τ )
≤
diam(τ
)2r2 −1
τ ∈F
k=0 τ ∈F
!1/(2r2 )
2
∞
2
X
X
d2r
τk
(−100k+14) 2r −1
2
2r
≤
2
diam(τk )2r2 −1
τ ∈F
k=0
00

≤ 3C `(γ)

∞
1/(2r2 ) X

2(−100k+14)

2r 2 −1
2r 2

k=0
1/(2r2 )

. `(γ)


4.4. Flat balls. In this section, we will prove the other half of (4.1):
Proposition 4.4.
X

βΓ (B)2 diam(B) . H1 (Γ).

B∈G2

To do so, we will follow the proof in Section 4 of [22] of a similar bound in the Heisenberg
group. As stated at the beginning of that section, most of the arguments therein may be applied
in any general metric space. The only Heisenberg-specific ingredients of the proof are Lemma 4.1
and equations (23) and (24). Therefore, in order to prove Proposition 4.4, it suffices to verify
these three facts in G.
Equation (23) in [22] requires
diam(B(p, λr)) ≤ λ diam(B(p, r))
for any r > 0, p ∈ G, and λ > 1. In G, we have
(4.10)

diam(B(p, λr)) = λ diam(B(p, r))

for any r > 0, p ∈ G, and λ > 0. This follows from the fact that diam(B(p, r)) = 2r for any left
invariant, homogeneous metric in G [14, Proposition 2.4]. Moreover, equation (24) in [22] is a
result of
(4.11)

d(L(t1 ), L(t2 )) = |t1 − t2 |kπ̃(p−1 q)k

for any horizontal segment L : [0, 1] → G and any t1 , t2 ∈ [0, 1].
It remains to prove Lemma 4.1 from [22] in the Carnot group setting. We first establish the
following:
Lemma 4.5. There is a radius 0 < r0 ≤ 12 such that, for any horizontal segment L which
intersects B(0, r0 ) non-trivially, L is never tangent to the unit sphere ∂B(0, 1) = ∂BRN (0, η).
Proof. Note that we need only consider those horizontal segments in BRn (0, 2η) × RN −n . Indeed,
the projection of the segment to Rn × {0} is a Euclidean segment traversed at constant speed,
and the restriction of a horizontal segment to a subinterval is still a horizontal segment. Hence

22

VASILIS CHOUSIONIS, SEAN LI, AND SCOTT ZIMMERMAN

a horizontal segment will intersect both B(0, r0 ) and ∂B(0, 1) if and only if its restriction to
BRn (0, 2η) × RN −n (which is also a connected, horizontal segment) does as well.
Suppose by way of contradiction that there is a sequence of horizontal segments Lj : [0, 1] → G
in BRn (0, 2η) × RN −n which intersect B(0, 1/j) non-trivially and lie tangent to ∂B(0, 1). Say
Lj = Lpj qj for some pj , qj ∈ G. These horizontal segments are all 4-Lipschitz since
−1
1
d(Lj (s), Lj (t)) = d(δs (π̃(p−1
j qj )), δt (π̃(pj qj ))) = η |s − t||(qj )1 − (pj )1 | ≤ 4|s − t|.

In particular, since each segment Lj meets B(0, 1/j), there is some M0 > 0 so that |pj | < M0 for
every j ∈ N. Write pj = (p1j , p2j ) and qj = (qj1 , qj2 ). By definition, we have

Lj (s) = p1j + s(qj1 − p1j ), p2j + P pj , s(qj1 − p1j ), 0
for any s ∈ [0, 1], j ∈ N
for some polynomial P given by the BCH formula. Therefore,
by the uniform boundedness of |pj |

and |qj1 |, there is some M1 > 0 so that di /dsi (Lj ) < M1 for every i, j ∈ N. The Arzelà-Ascoli
theorem then gives a subsequence of these horizontal segments (also called {Lj }) converging
uniformly in RN (and thus in G) to some C ∞ curve L : [0, 1] → G passing through the origin
so that all derivatives of Lj converge uniformly to the corresponding derivatives of L. Note
that L itself must also be a horizontal segment. Indeed, pj = Lj (0) → p for some p ∈ G, and
−1
n
π̃(p−1
j qj ) = pj Lj (1) → (z, 0) for some z ∈ R . Thus, for any q ∈ G satisfying q1 − p1 = z, we
have
−1
L(s) = lim Lj (s) = lim pj ∗ δs (π̃(p−1
j qj )) = p ∗ δs ((z, 0)) = p ∗ δs (π̃(p q))
j→∞

j→∞

for every s ∈ [0, 1]. Since L is a horizontal segment passing through the origin, it must be the
case that L is a Euclidean line segment in Rn × {0}.4 In particular, L cannot be tangent to the
Euclidean sphere ∂BRN (0, η). Since the derivatives of the segments Lj converge uniformly to the
derivatives of L, it is impossible that Lj lies tangent to the sphere for every j (as these segments
may only intersect the sphere in a neighborhood of L). This is a contradiction and completes the
proof.

The following is the Carnot group version of Lemma 4.1 from [22]. Note that, here, we have
the constant r0 included in the inequality, while, in [22], the constant is 1. This, however, is not
a problem since the constant r0 depends only on G.
Lemma 4.6. Let τ be a connected subarc. Then
sup d(x, τ ) ≤ r0−1 β(τ ) diam(τ ).

(4.12)

x∈Lτ

In particular, if we write Iτ = [a, b], we have
d(Lτ (1), γ(b)) ≤ r0−1 β(τ ) diam(τ ).

(4.13)

Proof. Recall that β(τ ) diam(τ ) = supp∈τ d(p, Lτ ). By the invariance of the metric under left
translation, we may assume that 0 = γ(a) = Lτ (0). We begin by proving (4.13). Choose
t0 ∈ [0, 1] so that d(γ(b), Lτ (t0 )) = d(γ(b), Lτ ) ≤ β(τ ) diam(τ ). Since Lτ (1) = π̃(γ(b)) and
Lτ (t0 ) = δt0 (π̃(γ(b))) are co-linear in Rn × {0}, it follows (as in the proof of Lemma 3.8) that

 

d(Lτ (1), Lτ (t0 )) = δt (π̃(γ(b)))−1 ∗ π̃(γ(b)) = π̃[δt (π̃(γ(b)))−1 ∗ γ(b)] ≤ d(γ(b), Lτ (t0 )).
0

0

Therefore, we have
d(Lτ (1), γ(b)) ≤ d(Lτ (1), Lτ (t0 )) + d(Lτ (t0 ), γ(b)) ≤ 2β(τ ) diam(τ ) ≤ r0−1 β(τ ) diam(τ ).
4Divide L into two segments: the segment ending at 0 and the segment starting at 0. Since both of these must

also be horizontal, they must be Euclidean segments.

THE TST IN CARNOT GROUPS

23

In order to prove (4.12), we will first show that the mapping f : τ → Lτ defined as
f (p) = Lτ (t0 )

where t0 = sup{t ∈ [0, 1] : d(Lτ (t), p) ≤ r0−1 β(τ ) diam(τ )}

is continuous. (Note that d(p, Lτ ) ≤ β(τ ) diam(τ ) for every p ∈ τ , so f is well defined.) In order
to prove that f is continuous, it suffices to prove for every p ∈ τ that Lτ does not lie tangent to
the sphere centered at p with radius r0−1 β(τ ) diam(τ ).
Fix p ∈ τ . We may translate by p−1 and dilate by r0 (β(τ ) diam(τ ))−1 to reduce to the following
problem: show that the horizontal segment L = δr0 (β(τ ) diam(τ ))−1 (p−1 ∗ Lτ ) is never tangent to
the sphere ∂B(0, 1). This follows from Lemma 4.5 since
d(0, L) = d(0, δr0 (β(τ ) diam(τ ))−1 (p−1 ∗ Lτ )) = r0 (β(τ ) diam(τ ))−1 d(p, Lτ ) ≤ r0
implies that the segment L intersects the ball B(0, r0 ) non-trivially. Therefore, f is continuous.
Since τ is connected and f (γ(b)) = Lτ (1) by (4.13), the continuous map f sends τ onto the
interval [f (0), Lτ (1)] ⊂ Lτ . Say t1 ∈ [0, 1] is such that Lτ (t1 ) = f (0). Then, for any t ∈ [t1 , 1],
we have d(Lτ (t), τ ) ≤ d(Lτ (t), p) ≤ r0−1 β(τ ) diam(τ ) for some p ∈ τ by the surjectivity of f , and,
for any t ∈ [0, t1 ], we have
d(Lτ (t), 0) = tkπ̃(γ(b))k ≤ t1 kπ̃(γ(b))k = d(Lτ (t1 ), 0) ≤ r0−1 β(τ ) diam(τ ).
This proves the lemma.



With the above lemmas established, we may now argue exactly as in Section 4 of [22] (with the
constants therein adjusted appropriately to account for r0 ) to conclude Proposition 4.4. This,
together with Proposition 4.1, finishes the proof of (4.1), and thus the proof of Theorem 1.4 is
complete.
5. Step 2 groups
In this section, we will prove Theorem 1.5. In Theorem 1.2 (proven in [22]), the Traveling
Salesman Theorem is established in the Heisenberg group, and the exponent on the β-numbers
is 4. However, this is not the same exponent provided by Theorem 1.4. Indeed, the Heisenberg
group has step r = 2, and we have proven the TST in step 2 groups where the exponent on the
β-numbers is 2r2 = 8.
The following lemma will replace Lemma 3.8 and will allow us to replace all instances of 2r2
with 2r in Theorem 3.1 and in all of the arguments that follow. This will prove Theorem 1.5
and provide a true generalization of Theorem 1.2. In the following proof, we will work with d∞
defined on a step 2 group G as
d∞ (x, y) = N∞ (y −1 x)

where N∞ (p) = max{|p1 |, |p2 |1/2 }

for any p = (p1 , p2 ) ∈ G. Though d∞ is not a true metric (since a scaling constant is present in
the triangle inequality), it is homogeneous and hence bi-Lipschitz equivalent to the HS-distance
d in the sense of (2.3). This will suffice.
Lemma 5.1. Suppose G is a step 2 Carnot group and the following bounds hold for some C =
C(G) > 0:
(5.1)

d(Lv (1), Lw )4 = d(π̃(v), Lw )4 ≤ Cρ3 ∆,

(5.2)

d(Lvw (0), Lw )4 = d(v, Lw )4 ≤ Cρ3 ∆,

(5.3)

d(Lvw (1), Lw )4 = d(v π̃(v −1 w), Lw )4 ≤ Cρ3 ∆.

24

VASILIS CHOUSIONIS, SEAN LI, AND SCOTT ZIMMERMAN

Then
sup d(Lv (t), Lw )4 + sup d(Lvw (t), Lw )4 . ρ3 ∆.
t∈[0,1]

t∈[0,1]

The hypothesis of this lemma is the same as in Lemma 3.8 with the substitution r = 2.
However, the conclusion is different: we have the exponent 4 = 2r rather than 8 = 2r2 . Once
this lemma has been proven, the rest of the arguments in the paper follow in exactly the same
manner with all instances of 2r2 replaced with 4.
Proof. As in the proof of Lemma 3.8, consider the horizontal segment f = Lvw and the subsegment
g(t) = δt(t2 −t1 )+t1 (π̃(w)) = δt1 (π̃(w)) ∗ δt (δt1 (π̃(w))−1 δt2 (π̃(w)))
of Lw where t1 , t2 ∈ [0, 1] are chosen so that
d∞ (f (0), g(0))4 ≤ L4 Cρ3 ∆

(5.4)

and d∞ (f (1), g(1))4 ≤ L4 Cρ3 ∆.

Since the BCH formula reduces to X + Y + 21 [X, Y ] in a step 2 Carnot group, we have for any
t ∈ [0, 1] and t0 = t(t2 − t1 ) + t1
g(t)−1 f (t) = [δt1 (π̃(w)) ∗ δt (δt1 (π̃(w))−1 δt2 (π̃(w)))]−1 vδt (π̃(v −1 w))

= −t0 w1 , 0) ∗ (v1 + t(w1 − v1 ), v2 + 21 [v1 , t(w1 − v1 )]

= v1 + t(w1 − v1 ) − t0 w1 , v2 + 2t [v1 , w1 ] + 21 [−t0 w1 , v1 + t(w1 − v1 )]

= v1 + t(w1 − v1 ) − t0 w1 , v2 + 21 (t + t0 − tt0 )[v1 , w1 ] .
In particular, we have
g(0)−1 f (0) = v1 − t1 w1 , v2 +

t1
2 [v1 , w1 ]




and g(1)−1 f (1) = (1 − t2 )w1 , v2 + 21 [v1 , w1 ] ,

so (5.4) gives
max{|v1 − t1 w1 |, |(1 − t2 )w1 |, |v2 +

1/2
t1
, |v2
2 [v1 , w1 ]|

+ 12 [v1 , w1 ]|1/2 } . ρ3/4 ∆1/4 .

We will now show that d∞ (f (t), g(t)) = N∞ (g(t)−1 f (t)) . ρ3/4 ∆1/4 for any t ∈ [0, 1]. Indeed,
we first have
|v1 + t(w1 − v1 ) − t0 w1 | = |(1 − t)(v1 − t1 w1 ) + t(1 − t2 )w1 | . ρ3/4 ∆1/4 .
To bound the second coordinate, we choose t0 so that t + t0 − tt0 = t0 + (1 − t0 )t1 . That is,


t + t0 − tt0 − t1
t2 − t1
t0 :=
= t + t(1 − t)
∈ [0, 1].
1 − t1
1 − t1
Therefore,





v2 + 1 (t + t0 − tt0 )[v1 , w1 ] ≤ t0 v2 + 1 [v1 , w1 ] + (1 − t0 ) v2 +
2
2

t1

2 [v1 , w1 ]



. ρ3/2 ∆1/2 .

Hence d(Lvw (t), Lw )4 . d∞ (Lvw (t), g(t))4 . ρ3 ∆. In the case f = Lv , it is similar and simpler
to establish the bound on d(Lv (t), Lw ). This completes the proof of the lemma.


THE TST IN CARNOT GROUPS

25

6. Singular integrals on 1-regular curves
Recall that if (X, d) is a metric space, an H1 -measurable set E ⊂ X is 1-(Ahlfors)-regular, if
there exists a constant 1 ≤ C < ∞, such that
C −1 r ≤ H1 (B(x, r) ∩ E) ≤ Cr
for all x ∈ E, and 0 < r ≤ diam(E). In this section we are going to prove Theorem 1.6, which
we reformulate in a more precise manner below.
Theorem 6.1. Let (G, d) be Carnot group of step r ≥ 2 equipped with a homogeneous metric d.
Let Kd : G \ {0} → [0, ∞) be defined by
3

d(N H(p), 0)2r
Kd (p) =
,
d(p, 0)2r3 +1
and let E be a 1-regular set which is contained in a 1-regular curve. Then the corresponding
truncated singular integrals
Z
ε
T f (p) =
Kd (q −1 · p)f (q) dH1 (q)
E\Bd (p,ε)

are uniformly bounded in

L2 (H1 |E ).

Proof. The proof follows as in the proof of [3, Theorem 1.3] once we have at our disposal Theorem
1.4 and Lemma 6.2. Nevertheless we will provide an outline for the convenience of the reader. To
simplify notation we let µ = H1 |E and K = Kd . Since E is 1-regular there exists some constant
cµ ∈ (0, 1] such that
cµ r ≤ µ(B(x, r)) ≤ c−1
µ r,

∀x ∈ E, r > 0.

We first observe that the kernel K is a symmetric 1-dimensional Calderón-Zygmund (CZ)-kernel,
see [3, Definition 2.6 and Lemma 2.7]. We will use the T 1-theorem (which we explain more in
the following) to prove that the operators T ε are uniformly bounded on L2 (µ). For this reason,
we need a system of dyadic-like cubes associated to the set E. These systems were introduced
by David in [7] for regular Euclidian sets and later generalized by Christ [4] to any regular set of
a geometrically doubling metric space. In particular for the set E, there is a constant cd ∈ (0, 1]
and a family of partitions ∆j of E, j ∈ Z, with the following properties;
(D1) If k ≤ j, Q ∈ ∆j and Q0 ∈ ∆k , then either Q ∩ Q0 = ∅, or Q ⊂ Q0 .
(D2) If Q ∈ ∆j , then diam Q ≤ 2−j .
(D3) Every set Q ∈ ∆j contains a set of the form B(pQ , cd 2−j ) ∩ E for some pQ ∈ Q.
We will call the sets in ∆ := ∪∆j the dyadic cubes of E. For a cube S ∈ ∆, we define
∆(S) := {Q ∈ ∆ : Q ⊆ S}.
Given a cube Q ∈ ∆ and λ ≥ 1, we define
λQ := {x ∈ E : d(x, Q) ≤ (λ − 1) diam(Q)}.
It follows from (D2), (D3) and the 1-regularity of E that if Q ∈ ∆j ,
−j
cd 2−j ≤ diam(Q) ≤ 2−j and cd cµ 2−j ≤ µ(Q) ≤ c−1
µ 2 .

To prove the L2 (µ) boundedness of the operator T ε it suffices to verify that there exists a
uniform bound C < ∞ that can depend on cµ , cd so that
(6.1)

kT ε χS k2L2 (S) ≤ Cµ(S),

∀S ∈ ∆, ∀ε > 0

26

VASILIS CHOUSIONIS, SEAN LI, AND SCOTT ZIMMERMAN

where L2 (S) := L2 (µ|S ). These conditions suffice by the T 1 theorem of David and Journé, applied
in the homogeneous metric measure space (E, d, µ), see [31, Theorem 3.21]. Notice that since K
is symmetric, (T ε )∗ = T ε where (T ε )∗ is the formal adjoint of T ε , see also [2, Remark 2.6]. The
statement in Tolsa’s book is formulated for Euclidean spaces, but the proof works with minor
standard changes in homogeneous metric measure spaces; the details can be found in the honors
thesis of Fernando [12]. Observe that we may suppose that E is a 1-regular rectifiable curve as
taking a subset can only decrease the L2 (µ)-bound of T ε χS .
We will now decompose our singular integral dyadically. This approach was used in [2] and [3]
and is inspired by [30]. Let ψ : R → R+ be a Lipschitz function so that χB(0,1/2) ≤ ψ ≤ χB(0,2) .
For any j ∈ Z we let ψj : G → R such that ψj (z) = ψ(2j d(z, 0)) and we set φj :=
P ψj − ψj+1 . Note
1−j
−2−j
that φj is supported on the annulus B(0, 2 )\B(0, 2
) and for any N ∈ Z, n≤N = 1−ψN +1 ,
hence
X
(6.2)
χG\B(0,2−N ) ≤
φn ≤ χG\B(0,2−N −2 ) .
n≤N

For each j ∈ Z, we let K(j) := φj · K and we define
Z
T(j) f (x) = K(j) (y −1 x)f (y) dµ(y).
P
for nonnegative functions f ∈ L2 (µ). For N ∈ Z let SN =
n≤N T(n) . As the kernel K is
positive, (6.2) implies the following pointwise estimates for any nonnegative function f ∈ L2 (µ)
from
0 ≤ T1ε f ≤ Sn f,

∀ε ≥ 2−n .

Thus, to establish the uniform bound (6.1), it suffices to show that there exists some absolute
constant C < ∞ such that
(6.3)

kSn χS k2L2 (S) ≤ Cµ(S),

∀S ∈ ∆, ∀n ∈ Z.

We now fix S ∈ ∆` for some ` ∈ Z. We will show that for any j ∈ Z and x ∈ E, we have
(6.4)

2

T(j) 1(x) .cµ βE (x, 21−j )2r .

In order to prove (6.4) we need the following lemma which was first proven in the case of the
Heisenberg group in [23, Lemma 3.3].
Lemma 6.2. Let (G, d) be Carnot group of step r ≥ 2 equipped with a homogeneous metric d.
Then
d(N H(a−1 b), 0)r
. max{d(a, L), d(b, L)}
(6.5)
d(a, b)r−1
for any a, b ∈ G and any horizontal line L ⊂ G.
Proof. For any p ∈ G, we will write p = (p1 , . . . , pr ) where pk ∈ Rvk and vk = dim Vk . As in the
previous section, we will utilize the homogeneous norm
kpk∞ = max{|pk |1/k }rk=1 .
For x, y ∈ G we will denote d∞ (x, y) := ky −1 xk∞ . Note that d∞ is not a true metric since it does
not satisfy the triangle inequality. Rather, there is a sub-additive constant C∞ ≥ 1. Regardless,
it follows that d∞ is globally equivalent to d in the sense of (2.3). Fix a, b ∈ G and a horizontal
line L ⊂ G. Note that
(6.6)

kN H(a−1 b)k∞ ≤ C∞ (kπ̃(a−1 b)k∞ + ka−1 bk∞ ) ≤ 2C∞ ka−1 bk∞ = 2C∞ d∞ (a, b).

THE TST IN CARNOT GROUPS

27

If d∞ (a, b) < max{d∞ (a, L), d∞ (b, L)}, then
d∞ (N H(a−1 b), 0)r
≤ (2C∞ )r d∞ (a, b) < (2C∞ )r max{d∞ (a, L), d∞ (b, L)}.
d∞ (a, b)r−1
Thus we may assume d∞ (a, b) ≥ max{d∞ (a, L), d∞ (b, L)}.
Write d := d∞ (a, b), and choose `a , `b ∈ L so that d∞ (a, L) = d∞ (a, `a ) and d∞ (b, L) =
d∞ (b, `b ). Without loss of generality, we may assume that `a = 0 so that `b = (x, 0, . . . , 0). We
have

r
kN H(a−1 b)kr∞
kN H(a−1 b)k∞
=d
= dkN H(δ1/d (a−1 b))kr∞ . d|N H(δ1/d (a−1 b))|.
dr−1
d
This last inequality follows from (2.2) with a constant depending only on G since (6.6) implies
N H(δ1/d (a−1 b)) ∈ B∞ (0, 2C∞ ) for any choice of a and b. We can write c = `−1
b b so that
a−1 b = a−1 `b c and kck∞ = d∞ (b, L). This gives
N H(δ1/d (a−1 b)) = π̃(δ1/d (a−1 `b c))−1 ∗ δ1/d (a−1 `b c) = (0, Q)
where Q is a Lie bracket polynomial determined by the BCH formula. As in the proof of
Lemma 3.2, Q is a finite sum of constant multiples of terms of the form
[Z1 , [Z2 , · · · , [Zk−2 , [Zk−1 , Zk ]] · · · ]]

(6.7)

where each Zi is either ai /di , ci /di , or x/d. (Again, we are abusing notation and identifying each
ai and ci with the associated vector in Vi ⊂ g.) The definition of k · k∞ gives




d∞ (a, `a ) i
d∞ (a, L) i d∞ (a, L)
|ai |
≤
=
≤
di
d∞ (a, b)
d∞ (a, b)
d∞ (a, b)
since, by assumption, d∞ (a, L) ≤ d∞ (a, b). Similarly, |ci |/di ≤ d∞ (b, L)/d∞ (a, b). We also have
−2
−2
C∞
|x| = C∞
k`b k∞ ≤ kak∞ + ka−1 bk∞ + kb−1 `b k∞ = d∞ (a, L) + d∞ (a, b) + d∞ (b, L) ≤ 3d.
2 . Now, each nested bracket of the form (6.7) must contain at least one
Therefore, |x|/d ≤ 3C∞
i
i
term ai /d or ci /d (since, otherwise, we would have Zi = x/d for each i, so the brackets would
all vanish). Since max{d∞ (a, L), d∞ (b, L)}/d∞ (a, b) ≤ 1, this gives

|[Z1 , · · · , [Zk−1 , Zk ]] · · · ]| ≤

k
Y

|Zi | .

i=1

max{d∞ (a, L), d∞ (b, L)}
.
d∞ (a, b)

Since the sum in the BCH formula is finite, we have
d∞ (N H(a−1 b), 0)r
. d∞ (a, b)|N H(δ1/d (a−1 b))| . max{d∞ (a, L), d∞ (b, L)}.
d∞ (a, b)r−1
This completes the proof of the lemma.



Let A = E ∩ A(x, 2−2−j , 21−j ). Since ψ is Lipschitz, we have φj (y −1 x) . 2j+2 d(y, x). Hence
Z
Z
3
d(N H(y −1 x), 0)2r
−1
−1
j+2
T(j) 1(x) =
φj (y x)K(y x) dµ(y) . 2
dµ(y)
d(y, x)2r3
E
A
3

d(N H(y −1 x), 0)2r
.
d(x, y)2r3
y∈A

. sup

28

VASILIS CHOUSIONIS, SEAN LI, AND SCOTT ZIMMERMAN

Observe that, if y ∈ A, it holds that d(x, y) ≥ 2−j−2 . Moreover, there exists a horizontal line L
such that
β{x,y} (x, 21−j ) =

max{d(x, L), d(y, L)}
max{d(x, L), d(y, L)} (6.5) d(N H(x−1 y), 0)r
&
.
&
21−j
d(x, y)
d(x, y)r

Hence (6.4) follows as βE (B(x, 21−j )) ≥ β{x,y} (B(x, 21−j )). For any Q ∈ ∆ we define
βE (Q) := βE (pQ , 2c−1
d + 1).
Note that if R ∈ ∆j for some j ∈ Z then (6.4) implies that for any α > 0
Z
2
(6.8)
T(j) 1(x)α dµ(x) .cµ βE (R)2r α µ(R).
R

Using (6.4) and (6.8) and arguing exactly as in [3, pp 1416-1417] we deduce that
X
2
(6.9)
kSn χS k2L2 (S) .cµ
β(Q)2r µ(Q)
Q∈∆(S ∗ )

S∗

where
is the unique cube in ∆`−2 such that S ⊂ S ∗ . Using Theorem 1.4 it is not difficult
to show (see e.g. the discussion in [3, Proposition 3.1]) that there exists an absolute constant
C := C(cµ ) > 0 such that, for any P ∈ ∆, we have
X
2
(6.10)
βE (Q)2r µ(Q) ≤ Cµ(P ).
Q∈∆(P )

Now (6.3) follows by (6.9), (6.10) and the 1-regularity of µ. The proof is complete.



References
[1] Calderón, A.-P. Cauchy integrals on Lipschitz curves and related operators. Proc. Nat. Acad. Sci. U.S.A.
74, 4 (1977), 1324–1327.
[2] Chousionis, V., Fässler, K., and Orponen, T. Boundedness of singular integrals on C 1,α intrinsic graphs
in the heisenberg group. Submitted (2017).
[3] Chousionis, V., and Li, S. Nonnegative kernels and 1-rectifiability in the Heisenberg group. Anal. PDE 10,
6 (2017), 1407–1428.
[4] Christ, M. A T (b) theorem with remarks on analytic capacity and the Cauchy integral. Colloq. Math. 60/61,
2 (1990), 601–628.
[5] Coifman, R. R., McIntosh, A., and Meyer, Y. L’intégrale de Cauchy définit un opérateur borné sur L2
pour les courbes lipschitziennes. Ann. of Math. (2) 116, 2 (1982), 361–387.
[6] David, G. Opérateurs d’intégrale singulière sur les surfaces régulières. Ann. Sci. École Norm. Sup. (4) 21, 2
(1988), 225–258.
[7] David, G. Wavelets and singular integrals on curves and surfaces, vol. 1465 of Lecture Notes in Mathematics.
Springer-Verlag, 1991.
[8] David, G., and Semmes, S. Singular integrals and rectifiable sets in Rn : Beyond Lipschitz graphs. Astérisque,
193 (1991), 152.
[9] David, G., and Semmes, S. Analysis of and on uniformly rectifiable sets, vol. 38 of Mathematical Surveys
and Monographs. American Mathematical Society, Providence, RI, 1993.
[10] David, G., and Semmes, S. Quantitative rectifiability and Lipschitz mappings. Trans. Amer. Math. Soc. 337,
2 (1993), 855–889.
[11] David, G. C., and Schul, R. The analyst’s traveling salesman theorem in graph inverse limits. Ann. Acad.
Sci. Fenn. Math. 42 (2017), 649–692.
[12] Fernando, S. The T1 Theorem in Metric Spaces. Undergraduate honors thesis, University of Connecticut,
2017.
[13] Ferrari, F., Franchi, B., and Pajot, H. The geometric traveling salesman problem in the Heisenberg
group. Rev. Mat. Iberoam. 23, 2 (2007), 437–480.
[14] Franchi, B., Serapioni, R., and Serra Cassano, F. On the structure of finite perimeter sets in step 2
Carnot groups. J. Geom. Anal. 13, 3 (2003), 421–466.

THE TST IN CARNOT GROUPS

29

[15] Hahlomaa, I. Menger curvature and Lipschitz parametrizations in metric spaces. Fund. Math. 185, 2 (2005),
143–169.
[16] Hahlomaa, I. Curvature integral and Lipschitz parametrization in 1-regular metric spaces. Ann. Acad. Sci.
Fenn. Math. 32, 1 (2007), 99–123.
[17] Hebisch, W., and Sikora, A. A smooth subadditive homogeneous norm on a homogeneous group. Studia
Math. 96, 3 (1990), 231–236.
[18] Jones, P. W. Square functions, Cauchy integrals, analytic capacity, and harmonic measure. In Harmonic
analysis and partial differential equations (El Escorial, 1987), vol. 1384 of Lecture Notes in Math. Springer,
Berlin, 1989, pp. 24–68.
[19] Jones, P. W. Rectifiable sets and the traveling salesman problem. Invent. Math. 102, 1 (1990), 1–15.
[20] Le Donne, E. A metric characterization of Carnot groups. Proc. Amer. Math. Soc. 143, 2 (2015), 845–849.
[21] Li, S. Coarse differentiation and quantitative nonembeddability for Carnot groups. J. Funct. Anal. 266, 7
(2014), 4616–4704.
[22] Li, S., and Schul, R. The traveling salesman problem in the Heisenberg group: upper bounding curvature.
Trans. Amer. Math. Soc. 368, 7 (2016), 4585–4620.
[23] Li, S., and Schul, R. An upper bound for the length of a traveling salesman path in the heisenberg group.
Rev. Mat. Iberoam. 32, 2 (2016), 391–417.
[24] Okikiolu, K. Characterization of subsets of rectifiable curves in Rn . J. London Math. Soc. (2) 46, 2 (1992),
336–348.
[25] Pajot, H. Analytic capacity, rectifiability, Menger curvature and the Cauchy integral, vol. 1799 of Lecture
Notes in Mathematics. Springer-Verlag, Berlin, 2002.
[26] Schul, R. Ahlfors-regular curves in metric spaces. Ann. Acad. Sci. Fenn. Math. 32, 2 (2007), 437–460.
[27] Schul, R. Subsets of rectifiable curves in Hilbert space—the analyst’s TSP. J. Anal. Math. 103 (2007),
331–375.
[28] Serra Cassano, F. Some topics of geometric measure theory in Carnot groups. In Geometry, analysis and
dynamics on sub-Riemannian manifolds. Vol. 1, EMS Ser. Lect. Math. Eur. Math. Soc., Zürich, 2016, pp. 1–
121.
[29] Stein, E., and Murphy, T. Harmonic Analysis: Real-variable Methods, Orthogonality, and Oscillatory
Integrals. Monographs in harmonic analysis. Princeton University Press, 1993.
[30] Tolsa, X. Uniform rectifiability, Calderón-Zygmund operators with odd kernel, and quasiorthogonality. Proc.
Lond. Math. Soc. (3) 98, 2 (2009), 393–426.
[31] Tolsa, X. Analytic capacity, the Cauchy transform, and non-homogeneous Calderón-Zygmund theory, vol. 307
of Progress in Mathematics. Birkhäuser/Springer, Cham, 2014.
V. Chousionis: Department of Mathematics, University of Connecticut, 341 Mansfield Road
U1009, Storrs, Connecticut 06269, USA, vasileios.chousionis@uconn.edu
S. Li: Department of Mathematics, University of Connecticut, 341 Mansfield Road U1009, Storrs,
Connecticut 06269, USA, sean.li@uconn.edu
S. Zimmerman: Department of Mathematics, University of Connecticut, 341 Mansfield Road
U1009, Storrs, Connecticut 06269, USA, scott.zimmerman@uconn.edu

