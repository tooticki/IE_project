WARING’S PROBLEM IN FINITE RINGS

arXiv:1709.04428v1 [math.NT] 13 Sep 2017

YEŞİM DEMİROĞLU KARABULUT

A BSTRACT. In this paper we obtain sharp results for Waring’s problem over general finite rings, by using a
combination of Artin-Wedderburn theory and Hensel’s lemma and building on new proofs of analogous results
over finite fields that are achieved using spectral graph theory. We also prove an analogue of Sárközy’s theorem
for finite fields.
Keywords: Waring’s Problem, Spectral Graph Theory, Artin-Wedderburn Theory, Finite Rings.
AMS 2010 Subject Classification: Primary: 11P05; Secondary: 05C25, 16K99.

1. I NTRODUCTION

Waring’s problem has a very long history with an extensive literature spanning many different areas of
mathematics. It seems likely to continue to be a central problem in mathematical research for some time to
come. The original version of the problem was due to Edward Waring, and first appeared in Meditationes
Algebraicae, published in 1770, where he states "Every number is the sum of 4 squares; every number is
the sum of 9 cubes; every number is the sum of 19 biquadrates [4th powers]; and so on.". Although we can
not be sure exactly what Waring had in mind, we assume that he meant that for every k > 2, there exists a
smallest positive integer g(k), with the property that every x ∈ N can be written as a sum of at most g(k)

many kth powers of natural numbers, satisfying g(2) = 4, g(3) = 9, g(4) = 19, etc. The fact that g(2) = 4
is equivalent to the four-squares theorem that was proven by Lagrange the same year Waring published his
general conjecture, but was apparently already known to Diophantus who alluded to it nearly fifteen hundred
years earlier in examples apppearing in his treatise Arithmetica (see [15]).
Hilbert proved the existence of g(k) for arbitrary k by evaluating a 25-fold integral in 1909, and as a result
of the efforts of many mathematicians over a period of many years, explicit formulas for g(k) have now
been found for all but finitely many values of k (see [18]), with multiple areas of mathematics such as the
Gaussian integers and additive number theory developed in the process of obtaining these results. It then
became natural to ask whether the bound g(k) could be improved if instead of considering all x ∈ N, one

limited oneself to considering only those x that are sufficiently large. We let G(k) denote the smallest such
improved bound, and the question of finding explicit values of G(k) for arbitrary k is still wide open, with
the problem having been solved only for k = 2 and k = 4. One of the approaches for attacking this question
involves finding upper bounds for G(k) using variants of the Hardy-Littlewood circle method, which is a
This work was partially supported by NSA grant H98230-15-1-0319.
1

2

YEŞİM DEMİROĞLU KARABULUT

powerful analytic tool also motivated by Waring’s problem (for an overview of the complete history of the
problem, see [18]).
After considering this question in the context of N, it seems natural to generalize it to working over Zn ,
traditionally referred to as Waring’s problem mod n. One can fix a k and look for a result which gives the
smallest m = g(k, n) such that every number in Zn can be written as a sum of at most m many kth powers.
This problem was first completely solved for k = 2, 3 by Small in [16], after which he observed that the
same techniques yield a solution for all k, [13].

1

The main contribution of the current paper is to extend results for Waring’s problem to the context of general
finite rings. As far as we are aware, there do not exist other such results in the literature, so that our results
appear to be the first known ones of this type. We get these generalizations by appealing to Artin-Wedderburn
theory and Hensel’s lemma, allowing us to build on results over finite fields obtained at an earlier point (see
Section 3) in our paper.
In particular, the following represents a sampling of the type of results found in Section 5, (see Theorem 5.2
for a more complete statement).
Let R be a (not necessarily commutative) finite ring. Then any element of R can be written as a sum of n
many kth powers in R
• where n = 2, if k = 3 as long as 3, 4, 7 ∤ |R|
• where n = 5, if k = 4 as long as 2, 9 ∤ |R|
• where n = 3, if k = 5 as long as 5, 11, 16 ∤ |R|
• where n = 7, if k = 6 as long as 2, 3, 25 ∤ |R|
• where n = 4, if k = 7 as long as 7, 8 ∤ |R|
where one can lower the values of n for any given k as long as one is willing to exclude a few more numbers
from dividing |R|.
In order to save space, we limit our explicit statements in Theorem 5.2 to 3 6 k 6 11, but similar results
could easily be obtained for any value of k for which one has results over finite fields. This reduces the
question of Waring’s problem over general finite rings to the analogous questions over finite fields.
Note that Small’s solution to Waring’s problem mod n when n is a prime answers Waring’s problem for a
special class of finite fields. In addition, Small obtains a result for more general finite fields by applying
an inequality from the theory of diagonal equations over such fields to prove that if q > (k − 1)4 , then
1There are a few minor errors in the stated values of g(k, n) that appear in [13], [14], [16]. The correct values should be

g(4, 41) = 2, g(5, 71) = 2 and g(5, 101) = 2.

WARING’S PROBLEM IN FINITE RINGS

3

every element of Fq can be written as a sum of two kth powers in [14] (which when translated into the
language of this paper says γ(k, q) 6 2 whenever q > (k − 1)4 ). In Section 3, we deduce an asymptotically

equivalent result to his and to results of [19], [21] by applying graph theoretic methods yielding self contained
elementary proofs that when q > k4 , every element of the field can be written as a sum of two kth powers,
and when q > k3 , as three kth powers, etc. We also enlist the help of a supercomputer to calculate the values
for γ(k, q) for all q too small to be covered by the above mentioned results when k 6 37.
On top of this, in the process of proving our finite field Waring’s problem results (similar to results that were
already known), we also obtain the following new result providing an analogue of Sárközy’s theorem in the
finite field setting.
qk
Theorem. Let k be a positive integer. If E is a subset of Fq with size |E| > √
then it contains at least
q−1
√ 
two distinct elements whose difference is a kth power. Thus, in particular if k is fixed and |E| = Ω q as

q → ∞, then E contains at least two distinct elements whose difference is a kth power.

Our main tool in the proofs of our finite field and Sárközy’s results is a spectral gap theorem for Cayley
digraphs for which we provide a self-contained proof in Section 2.1. By building on these finite field results,
we also obtain in Section 4 upper bounds for Waring numbers for matrix rings over finite fields (hence over
general semisimple finite rings) that are stronger than our aforementioned results obtained in the case of
more general finite rings. Results relating to matrix rings exist in the literature (see the history section and
references in [10] for a summary), but they often focus on existence results, showing that a given matrix
over a commutative ring can be written as a sum of some number of k th powers, rather than determining how
many kth powers need to be used. As was the case for our more general results mentioned above, our results
over matrix and semisimple finite rings also rely on an efficient use of Hensel’s Lemma, (see Theorem 4.2
for more details).

2. P RELIMINARIES

2.1. Spectral Graph Theory. The material presented here prior to Cayley digraphs is pretty standard and
can be found in any introductory graph theory book, e.g. [7], [20].
A graph G consists of a vertex set V (G), an edge set E(G), and a relation that associates with each edge
two vertices called its endpoints. A directed graph or digraph is a graph in which the endpoints of each edge
is an ordered pair of vertices. If (u, v) also denoted by u → v is such an ordered pair of vertices, that means
there exists an edge in the digraph with tail u and head v. When we draw a digraph, we represent the vertices

with some dots and the directed edges between the vertices with some curves on the plane, and we give each
edge a direction from its tail to its head. We define the out-degree of a vertex u, denoted by d+ (u), as the
number of edges with tail u and the in-degree, d− (u), as the number of edges with head u. Each loop (i.e.

4

YEŞİM DEMİROĞLU KARABULUT

an edge have the same endpoints) contributes +1 to both in- and out-degree. As a side note, notice that the
summation of in-degrees and out-degrees are always equal to each other, and equals to the number of edges.
We define the adjacency matrix AG (or A) of a digraph G as a matrix with rows and columns indexed by the
vertices of G, such that the uv-entry of A is equal to the number of edges with tail u and head v. Since AG is
not necessarily symmetric, unfortunately we lose the spectral theorem of linear algebra in most cases when
G is a digraph, but we can still consider the spectrum of AG and it turns out to be still very useful.
If G is a digraph, a walk of length r in G can be defined as a sequence of vertices (v0 , v1 , · · · , vr ) with the

only restriction that the ordered pair (vi−1 , vi ) is the endpoints of some edge for every 1 6 i 6 r. That is
to say if we want to walk from vi−1 to vi , we need the existence of an edge with the tail vi−1 and head vi ,
i.e. the direction matters in digraphs in contrast to graphs. On the other hand the definition of walk allows
us to go over any edge and any vertex more than once. By induction on k we can show that the uv-entry of
Ak , where A denotes the adjacency matrix of G, counts the (directed) walks of length k from u to v. It is

also easy to show that if G is a simple digraph, i.e. a digraph with no multi-edges and with at most one loop,
P
then the trace of AAT equals u∈G d+ (u) = |E(G)|. Here multi-edge means there exists at least two edges

which correspond to the same endpoints u → v.

Let H be a finite abelian group and S be a subset of H. The Cayley digraph Cay(H, S) is the simple digraph
whose vertex set is H and u → v if and only if v − u ∈ S. By definition Cay(H, S) is a simple digraph

with d+ (u) = d− (u) = |S|. Furthermore, if we have a Cayley digraph, then we can find its spectrum easily

using characters from representation theory, see [12] for a rigorous treatment of character theory. A function

χ : H −→ C is a character of H if χ is a group homomorphism from H into the multiplicative group C∗ .

If χ(h) = 1 for every h ∈ H, we say χ is the trivial character. The following theorem is a very important
well-known fact, see e.g. [4]:

Theorem 2.1. Let A be an adjacency matrix of a Cayley digraph Cay(H, S). Let χ be a character on H.
P
Then the vector (χ(h))h∈H is an eigenvector of A, with eigenvalue s∈S χ(s). In particular, the trivial
character corresponds to the trivial eigenvector 1 with eigenvalue |S|.

Proof. Let u1 , u2 , · · · , un be an ordering of the vertices of the digraph and let A correspond to this ordering.

Pick any ui . Then we have
n
X
j=1

Aij χ(uj ) =

X

ui →uj

χ(uj ) =

X

χ(ui + s) =

s∈S

X
s∈S

χ(ui )χ(s) =

"
X
s∈S

#

χ(s) χ(ui ).

Thus
Aχ =

"

X
s∈S

#

χ(s) χ.


WARING’S PROBLEM IN FINITE RINGS

5

Notice that we get |H| many eigenvectors from the characters as demonstrated in the previous theorem,

and they are all distinct since they are orthogonal by character orthogonality, [12]. This means adjacency

matrix A of a Cayley digraph is diagonalizable and we know all of the eigenvectors explicitly, assuming we
know all of the characters of H. This shows us that A is non-defective and the eigenvectors of A form an
eigenbasis. Indeed, it will be very important in the proof of the spectral gap theorem (upcoming). Recall
when we have a (undirected) graph, since we have A real and symmetric, we know there exists an eigenbasis
of A by the spectral theorem of linear algebra. On the other hand, this is not the case for digraphs in general.
For example, consider the digraph with vertex set V (G) =
 {u, v} and with only one directed edge u → v.
0 1
In this case G is a simple digraph with no loops; AG =
has only one eigenvector, so AG does not
0 0
have an eigenbasis. This makes Cayley digraphs nicer than general simple digraphs.
Theorem 2.2 (viz. spectral gap theorem) below is a very important and widely used tool in graph theory by
itself. Hence we intend to give a self-contained proof.
Theorem 2.2 (Spectral Gap Theorem For Cayley Digraphs). Let Cay(H, S) be a Cayley digraph of order
n. Let {χi }i=1,2,··· ,n be the set of all distinct characters on H such that χ1 is the trivial one. Define
!

X
n


n∗ =
χi (s)
max 
|S| 26i6n
s∈S

and let X, Y be subsets of vertices of Cay(H, S). If

p

|X||Y | > n∗ , then there exists a directed edge

between a vertex in X and a vertex in Y . In particular if |X| > n∗ , then there exists at least two distinct

vertices of X with a directed edge between them.

Proof. Let u1 , u2 , · · · , un be an ordering of the vertices of Cay(H, S) and let A be the adjacency matrix

corresponding to this ordering. By Theorem 2.1 each χi gives us an eigenvector for A with an eigenvalue
P
s∈S χi (s). We can normalize χi for each i ∈ {1, 2, · · · , n} and get vi ’s so that v1 , · · · , vn is an orthonorP
mal basis for Cn . Therefore, any complex n-dimensional vector v can be written as v = nj=1 hv, vj ivj
where h−, −i denotes the Hermitian inner product in Cn . Notice
+
* n
n
n
X
X
X
khv, vj ik2
hv, vj ihvj , vi =
hv, vj ivj , v =
hv, vi =

(1)

j=1

j=1

j=1

which is also known as the Plancherel identity.
Define 1X as the 0-1 column vector whose ith entry is 1 when ui ∈ X and 0 otherwise. Define 1Y similarly.
If we calculate

A1Y




a1
 a2 
 
=  .. 
 .
an

6

YEŞİM DEMİROĞLU KARABULUT

then each ai denotes the number of directed edges from ui to the vertices of Y . If we multiply both sides of
the equation with 1TX from the left, we get

1TX A1Y




a1
 a2 
X
 
= 1TX  ..  =
ai
 .
an

ui ∈X

which is indeed exactly the number of edges from the vertices of X to the vertices of Y . This calculation
shows that as long as 1TX A1Y > 0 there will be a directed edge from a vertex in X to a vertex in Y .
On the other hand we also have
1TX A1Y = h1X , A1Y i =
=

n
X
j=1



+ *

+
n
n
X
X
1X , A  h1Y , vj ivj  = 1X ,  h1Y , vj iλj vj 

*

j=1

h1X , h1Y , vj iλj vj i =

j=1

n
n
X
X
h1X , λj vj ih1Y , vj i =
λj h1X , vj ihvj , 1Y i
j=1

(2)

j=1

By Theorem 2.1 we know one of the eigenvalues of Cay(H, S) is λ1 = |S| with eigenvector v1 =

√1 1
n

and

by substitution in (2) we get

n

1TX A1Y =

|X||Y ||S| X
+
λj h1X , vj ihvj , 1Y i.
n
j=2

Let
E=

n
X
j=2

We will show if

p

|X||Y | > n∗ then

λj hvj , 1Y ih1X , vj i.

|X||Y ||S|
> |E|, and the result will follow.
n

By the Cauchy-Schwarz inequality we have
1/2 

1/2
n
n
X
X
kh1Y , vj ik2  
kh1X , vj ik2 
|E| 6 ( max kλj k) 
26j 6n

j=1

j=1

Moreover by Plancherel’s equality we have
|E| 6
Hence, the result follows as long as




p
|X||Y |.
max kλj k

26j 6n

|S||X||Y |
>
n




p
|X||Y |
max kλj k

26j 6n

holds. The only thing left to point out is that in the statement of the theorem we substituted λj ’s using
Theorem 2.1.



WARING’S PROBLEM IN FINITE RINGS

7

Keep the notation in the previous theorem for the next corollary. Define
!
 k
X
n


n∗,k =
χi (s) .
max 
|S|k 26i6n
s∈S

Corollary 2.3. If n∗,k

p
< |X||Y |, then there exists a directed k-walk from a vertex in X to a vertex in

Y . In particular if n∗,k < |X|, then there exists at least two distinct vertices of X with a directed k-walk
between them.

The proof of the corollary follows from a well-known trick in graph theory. We form a new graph with
the same vertex set Cay(H, S), where every directed edge from u to v in the new graph corresponds to an
oriented walk of length k from u to v in the original digraph. This new graph can be most easily defined
as the digraph with the same vertex set as new graph and adjacency matrix Ak where A is adjacency matrix
of the original graph. Notice Ak has the same orthogonal eigenbasis A does and its eigenvalues are the
kth powers of A’s. So, the corollary follows when we apply the theorem on the new graph. Furthermore,
notice that we can prove this theorem for any digraph with orthogonal eigenbasis, and not just for Cayley
digraphs.
Corollary 2.4 (Spectral Gap Theorem For d-regular Graphs). Let G be a d-regular simple graph with eigenvalues λ1 > · · · > λn . Let



n
max |λi |
d 26i6n
p
and let X, Y ⊂ V (G) be subsets of vertices. If |X||Y | > n∗ , then there exists an edge incident to a vertex
n∗ =

in X and a vertex in Y . In particular if |X| > n∗ , then there exists at least two vertices of X adjacent to
each other.

This corollary does not follow from the statement of the theorem directly, but it follows from the proof. There
are only a few points to change in the theorem’s proof to prove the corollory. First, we do not always know
the eigenvalues and eigenvectors of a regular simple graph explicitly. But we do know if G is a d-regular
simple graph with n vertices, then it should have λ = d as an eigenvalue with multiplicity at least 1 and
there exists an eigenbasis for Rn . Second, since the 1TX A1Y term in the theorem’s proof was the number
of directed edges; it will be the number of edges between the vertices of X and vertices of Y such that the
edges in the intersection counted twice, where the edges in the intersection refers to the edges which has the
endpoints in X ∩ Y . However, the rest of the proof works as demonstrated above.
2.1.1. Cayley Graphs and Character Theory. We need to use characters only for finite fields in this paper.
Let Fp be the finite field of prime order p. Every time we fix a j ∈ {0, 1, · · · , p − 1} and define χj (x) :=

e

2πijx
p

for every x ∈ Fp , χj becomes a character on the additive group structure of Fp , [9]. Since different j

values provide us different characters on Fp , we have p many characters defined in this way, but the theory

8

YEŞİM DEMİROĞLU KARABULUT

tells us we should have p many characters for a group of order p, so we obtained all the characters on
Fp .

Let Fq be the finite field of order q with characteristic p and F∗q denote the multiplicative group of it as usual.
We want to give a characterization for the characters on Fq . Once we know the characters for the base field
Fp , the characters of Fq can be obtained by following the process we are about to explain. Let α ∈ F∗q and

define a map φα : Fq −→ Fp as φα (x) := tr(αx) for every x ∈ Fq . Here αx denotes the multiplication of α

and x in Fq , and tr is the usual field trace of Fq over Fp . We can easily show that for any element α ∈ F∗q and
for any character χj on Fp , χj ◦ φα defines a character on Fq . We can also show that χj ◦ φα is the trivial

character on Fq if and only if j is zero. Then also notice that χj ◦ φα and χj ◦ φβ is the same character if and

only if α = β. Hence, if we fix j = 1 and if we range α in F∗q , χ1 ◦ φα ’s become distinct. That is why we
have q − 1 many distinct nontrivial characters by ranging α. We also have the trivial character, and we can
think of the trivial character as j = 1 and α = 0. In this way we obtain at least q many distinct characters

on Fq , but from the theory we know we should have exactly q many characters on Fq , which means any
character on Fq can be written explicitly as χ1 ◦ φα for some α ∈ Fq .
2.2. Finite Rings, Jacobson Radical and Artin-Wedderburn Theory. As we stated before, the main
purpose of this paper is to solve Waring’s problem for finite rings with identity. We actually have a wide
range of such rings. Some important examples are finite fields, the ring of integers modulo n for each integer
n > 2, matrix rings over finite fields, which we will denote by Fq , Zn , Matn (Fq ), respectively. Some
subrings of Matn (Fq ) (e.g. upper triangular matrices, lower triangular matrices, diagonal matrices etc., or
Fq [A] for A ∈ Matn (Fq )) are also familiar examples. A particular class of examples, which will be used in

Section 4, comes from quotients of
. rings over
 finite fields with some principal ideal generated by
 polynomial
a polynomial over the same field i.e. Fq [x] hf (x)i . If the polynomial is irreducible over Fq , the quotient

ring is isomorphic to a finite field. Otherwise it is not even an integral domain. In addition to those when we
take a finite family of finite rings with identity, we can make the direct sum of underlying abelian groups into
a ring by defining multiplication coordinate-wise and the resulting ring is a finite ring with identity.
Another important family of examples for finite rings with identity come from group rings. When R is a
ring with identity and G is a group with operation ∗, the group ring R[G] is the set of all linear combinations
P
of finitely many elements of G with coefficients in R i.e. any x ∈ R[G] can be written as g∈G ag g

where it is assumed that ag = 0 for all but finitely many elements of G. The 
addition is defined
 P by the rule
P
P
P
P
g∈G ag g +
g∈G bg g =
g∈G (ag +bg )g and the multiplication is given by
g∈G ag g
g∈G bg g =
P
g∈G, h∈H (ag bh )g ∗ h. The group ring of a finite group over any finite ring (or finite field) is a finite ring.

When R is a field, R[G] is called a group algebra. When the characteristic of the finite field divides the order
of the group, the group algebra breaks up into finite rings called block rings.

Artin-Wedderburn theory provides us very useful structure theorems for certain classes of rings. We now
recall the basics of this theory. The omitted proofs are standard and can be found in most (noncommutative)

WARING’S PROBLEM IN FINITE RINGS

9

algebra books presenting the subject. In particular see [6], [8] since our treatment follows theirs closely for
the convention and notation.
Let R be any ring, not necessarily finite. Then there is a left ideal J(R), or just J, called the Jacobson radical
T
m where M is the set of all maximal left ideals. Let x ∈ R. It is a well-known fact
of R such that J =
m∈M

that x ∈ J if and only if 1 + rxs is a unit in R for all r, s ∈ R. We can also prove that J is the intersection of

all maximal right ideals of R. This combined with the definition of J together implies that J is a two-sided
ideal. Also notice that 1 ∈
/ J so J 6= R.

A ring R is said to be semisimple if its Jacobson radical J is zero. As we state later, Artin-Wedderburn theory
gives us Matn1 (Fq1 ) × · · · × Matnj (Fqj ), the direct product of finitely many matrix rings over finite fields,
is a semisimple finite ring. Maschke’s theorem shows many group algebras are semisimple, [5]:

Theorem 2.5 (Maschke’s Theorem). Let H be a finite group and let F be a field whose characteristic does
not divide the order of H. Then F [H], the group algebra of H, is semisimple.

In the case when the characteristic of the finite field divides the order of the group, Maschke’s theorem does
not apply and the group algebra is no longer semisimple. Instead it decomposes into block rings, which are
another class of finite rings, with great importance in modular representation theory, see [1].
We now state the main theorem in Artin-Wedderburn theory that shows in particular that any finite semisimple ring is a product of matrix rings.
Theorem 2.6 (Artin-Wedderburn Theorem). The following conditions on a ring R are equivalent:
• R is a nonzero semisimple left Artinian ring.
• R is a direct product of a finite number of simple ideals each of which is isomorphic to the endomorphism ring of a finite dimensional vector space over a division ring.

• There exist division rings D1 , · · · , Dt and positive integers n1 , · · · , nt such that R is isomorphic to
the ring Matn1 (D1 ) × Matn2 (D2 ) × · · · × Matnt (Dt ).

While in the general theory of Artin-Wedderburn division rings appear, we need not work with division rings
as a result of the following theorem.
Theorem 2.7 (Wedderburn’s Little Theorem). Every finite division ring D is a field.

We will also use Nakayama’s lemma:
Theorem 2.8 (Nakayama’s Lemma). If I1 is an ideal in a ring R with identity, then the following conditions
are equivalent:

10

YEŞİM DEMİROĞLU KARABULUT

• I1 is contained in the Jacobson radical, J
• If I2 is a finitely generated R-module such that I1 I2 = I2 , then I2 = 0.
Corollary 2.9. If R is a finite ring, then J l = 0 for some l ∈ Z+ .
Proof. Since R is finite, the following chain has to stop for some l ∈ Z+
J ⊇ J 2 ⊇ J 3 ⊇ · · · ⊇ J l = J l+1 = J l+2 = · · · .
If J l = 0, we are done. Otherwise, let I1 = J, I2 = J l and apply Nakayama’s lemma.



Actually we do not need R to be a finite ring to have J l = 0 for some l, if R is just Artinian the result still
follows by the same proof. We record this version since we need this result later only when R is finite.

2.3. Hensel’s Lemma in Special Cases. In this section we present and prove Hensel’s lemma for the Jacobson radical of finite commutative rings with identity and polynomial rings over finite fields. These results
of course can be deduced from the general theory easily, but we provide self contained proofs. Our approach
follows the standard proof of Hensel’s lemma in other settings, which usually resemble the classical Newton
approximation method, e.g. see Hensel’s lemma for the p-adic integers in [11].
2.3.1. Hensel’s Lemma for the Jacobson Radical. Let R be a ring with identity and let J denote the Jacobson radical of R. First, we record two general basic facts in the following lemmata, since we need them
later.
Lemma 2.10. If a + J is a left unit in R /J , then a is a left unit in R and this implies a + J i is a left unit in
R /J i for any i > 1.
Proof. If a + J is a left unit in R /J , then there exists some u ∈ R such that (u + J)(a + J) = 1 + J. That

means there exists some u ∈ R and j ∈ J such that ua = 1 + j. This implies that there exists some y ∈ R
such that yua = 1, which says yu is a left inverse of a.

Also notice that (yu + J i )(a + J i ) := yua + J i = 1 + J i which means a + J i is a left unit in R /J i .



One can replace left with right or 2-sided, and both the statement and proof of the previous proposition
extend mutatis mutandis. As a side note also recall that the existence of a left inverse for an element of R
in general does not imply the existence of a right inverse, and vice versa. But finite rings are nicer in this
regard, we can prove that if there exists a left (resp. right) inverse for r ∈ R, then the left (resp. right) inverse
of r is also the right (resp. left) inverse of r.

Lemma 2.11 (Taylor’s expansion of a polynomial). Let R be a commutative ring and p(x) ∈ R[x] be any

polynomial. There exists a polynomial p2 ∈ R[x, y] such that p(x + y) = p(x) + yp′ (x) + y 2 p2 (x, y).

WARING’S PROBLEM IN FINITE RINGS

11

P
Proof. Let p(x) =
an xn . Then,
X
X
X
X
p(x + y) =
an (x + y)n =
an (xn + nxn−1 y + y 2 (· · · )) =
an xn + y
nan xn−1 + y 2 p2 (x, y).



Proposition 2.12. Let R be a commutative finite ring with identity. Let p(x) ∈ R[x] where R[x] stands for
the polynomial ring over R. Assume there exists a root of p(x) in R /J , say a0 + J for some a0 ∈ R, i.e.
p(a0 )
satisfies
p(a0 + J) ≡ 0 mod J. If p′ (a0 ) + J is a unit in R /J , then r = a0 − ′
p (a0 )
(1) p(r) ≡ 0 (mod J 2 )
(2) r = a0 (mod J)
(3) p′ (a0 ) is a unit in R and p′ (r) is a unit in R.
1
follows from Lemma 2.10 and from the assumptions. Suppose we
p′ (a0 )
have a root of p(x) in R /J 2 , let’s denote it with r + J 2 . If we send r + J 2 using the canonical reduction
map from R /J 2 to R /J , the image of r + J 2 should also be a root i.e.

Proof. Notice that the existence of

p(r + J 2 ) ≡ 0

(mod J 2 )

=⇒

p(r + J) ≡ 0

(mod J).

If r + J 2 is a lift of a0 + J then we should have r + J = a0 + J in R /J i.e. r = a0 + j for some j ∈ J.

By Lemma 2.11, we have

p(r) = p(a0 + j) = p(a0 ) + p′ (a0 )j + j 2 b
for some b ∈ R. We need p(a0 + j) ≡ 0 (mod J 2 ) that means we need
p(a0 ) + p′ (a0 ).j ≡ 0 (mod J 2 ).

So, if we let j = −
follow.

p(a0 )
from the beginning, everything works out in these equations and the claims
p′ (a0 )


If a0 + J is a root of p(x) in R /J and p′ (a0 ) is a unit in R, then we can upgrade a0 + J to a root r + J 2
in R /J 2 by the proposition. But notice that using the exact same process, we can lift r + J 2 in R /J 2 to
some root r1 + J 3 in R /J 3 and so on. This process gives us a solution in each R /J i for any i > 1, and
combined with Corollary 2.9, we obtain the following corollaries.
Corollary 2.13. Let R be a finite commutative ring with identity and p(x) ∈ R[x]. If there exists a root of
p(x), say a0 + J, in R /J and p′ (a0 ) + J is a unit in R /J , then there exists a root of p(x) in R.
k mod J
Corollary 2.14. Let R be a finite commutative ring with identity. Let α ∈ R. If α ≡ B1k + · · · + Bm
in R /J for some B1 , B2 , · · · , Bm ∈ R and kB1k−1 is a unit in R, then there exists some β in R such that

k holds.
α = β k + B2k + · · · + Bm

k − α and apply the previous corollary.
Proof. Let p(x) = xk + B2k + · · · + Bm



12

YEŞİM DEMİROĞLU KARABULUT

2.3.2. Hensel’s Lemma for Polynomial Rings. Let Q(t) be a polynomial in Fq [x][t] = Fq [x, t]. We can write
Q(t) as a0 + a1 t + a2 t2 + · · · + an tn for some a0 , a1 , · · · an ∈ Fq [x]. This means we may evaluate Q(t) at

any t ∈ Fq [x] and get outputs in Fq [x].

Let f (x) be an irreducible polynomial in Fq [x]. Let g be any polynomial in Fq [x]. We can define f -adic
valuation of g, say ν(g), such as
ν(g) = m ⇐⇒ g ≡ 0

(mod f m) and g 6≡ 0

(mod f m+1 ) for some m ∈ Z+ .

We also set ν(g) = 0 if f ∤ g.
Proposition 2.15. Let g ∈ Fq [x] satisfy Q(g) ≡ 0 (mod f n ) for some n ∈ Z+ . Suppose m is a positive

integer less than or equal to n. If Q′ (g) 6≡ 0 (mod f ), there exists a g2 ∈ Fq [x] such that Q(g2 ) ≡ 0
(mod f n+m ) and g ≡ g2 (mod f n ). Moreover, g2 is unique modf n+m.
We will refer g2 as a lifting of g in modf n+m .
Remark. We should note that the restriction m 6 n in this proposition is not that important. Since if we want
to find a solution modulo f j for some j > n, we can apply the proposition j − n many times recursively for

m = 1 and lift a solution to modulo f j . The same idea also applies to the next proposition.

Proof. By setting Q(g + f n t) ≡ 0 (mod f n+m ), we can solve for t. By applying Lemma 2.11 on Q we
know that

Q(g + f n t) = Q(g) + f n tQ′ (g) + (f n t)2 Q̃(g, f n t)
≡ Q(g) + f n tQ′ (g)

(mod f n+m )

for some polynomial Q̃

since n > m.

By assumption Q(g) ≡ 0 (mod f n ) i.e. Q(g) = f n h for some h ∈ Fq [x]. So, we should have
Q(g + f n t) ≡ f n h + f n tQ′ (g)
≡ f n (h + tQ′ (g))

(mod f n+m)
(mod f n+m ).

Moreover,
Q(g + f n t) ≡ 0 (mod f n+m) ⇐⇒ f n (h + tQ′ (g)) = f n+m v

⇐⇒ f n (h + tQ′ (g) − f m v) = 0

for some v ∈ Fq [x]
for some v ∈ Fq [x].

To have this, since Fq [x] is an integral domain, we need h + tQ′ (g) − f m v to be zero, that means we need
−h
h
h + tQ′ (g) = f m v which is the same with t ≡ ′
(mod f m ). So, if we define g2 = g − f n ′
=
Q (g)
Q (g)
Q(g)
from the beginning, we are all set.
g− ′
Q (g)
The only point we did not justify here is why Q′ (g)−1 makes sense in modf m . Remember Q′ (g) ∈ Fq [x].

Fq [x] is a PID, that means we have Bézout’s identity in Fq [x]. By assumption we have Q′ (g) 6≡ 0 (mod f ),

which means f doesn’t divide Q′ (g). Since f is irreducible, the only divisors of f are 1 and itself. So,

WARING’S PROBLEM IN FINITE RINGS

13

gcd(Q′ (g), f ) = 1 and this implies gcd(Q′ (g), f m ) = 1. By Bézout, we have AQ′ (g) + Bf m = 1 for some
A, B ∈ Fq [x] which shows Q′ (g)−1 exits in modf m for any m > 1.



Proposition 2.16. Let g ∈ Fq [x] be such that Q(g) ≡ 0 (mod f n ) for some n ∈ Z+ , and let m denote
Q(g)
satisfies
ν(Q′ (g)). If n > 2m, then g2 = g − ′
Q (g)
(1) Q(g2 ) ≡ 0 (mod f n+1 )
(2) g2 ≡ g (mod f n−m )
(3) ν(Q′ (g2 )) = ν(Q′ (g)) = m.

Proof. Since Q(g) ≡ 0 (mod f n ), there exists an h1 ∈ Fq [x] such that Q(g) = f n h1 . Similarly since

ν(Q′ (g)) = m, there exists an h2 ∈ Fq [x] such that Q′ (g) = f mh2 and h2 6≡ 0 (mod f ), which implies h2
is a unit in modf i for any i.

To prove (1) by applying Lemma 2.11 on Q we have


Q(g)
Q(g2 ) = Q g − ′
Q (g)




Q(g) 2
−Q(g)
′
Q̂(· · · )
Q (g) +
= Q(g) +
Q′ (g)
Q′ (g)

for some polynomial Q̂

2
= (f n−m h1 h−1
2 ) Q̂(· · · )

≡0

(mod f n+1 )

since n > 2m.

(2) follows from
g2 − g =

−Q(g)
−f n h1
n−m
=
= −f n−mh1 h−1
).
2 ≡ 0 (mod f
Q′ (g)
f m h2

To prove (3) by applying Lemma 2.11 on Q′ we have

Q′ (g2 ) = Q′ g + (g2 − g)

= Q′ (g) + (g2 − g)Q′′ (g) + (g2 − g)2 Q̌(· · · )




Q(g) 2
Q(g)
′′
′
Q̌(· · · )
Q (g) +
= Q (g) −
Q′ (g)
Q′ (g)

for some polynomial Q̌

′′
n−m
2
= f m h2 − f n−m h1 h−1
h1 h−1
2 Q (g) + (f
2 ) Q̌(· · · )


′′
2n−3m
2
= f m h2 − f n−2m h1 h−1
(h1 h−1
2 Q (g) + f
2 ) Q̌(· · · )

≡ 0 (mod f m )

since n > 2m.




′′
2n−3m (h h−1 )2 Q̌(· · · ) 6≡ 0 (mod f ) we have ν Q′ (g ) = m.
Since h2 − f n−2m h1 h−1
1 2
2
2 Q (g) + f



14

YEŞİM DEMİROĞLU KARABULUT

3. WARING ’ S P ROBLEM

IN

F INITE F IELDS

Let Fq be the finite field with q = ps elements where p is the characteristic of Fq . We pick a k ∈ Z+ and

denote the set of all kth powers in Fq by Rk i.e. Rk = {αk | α ∈ Fq }. Let γ(k, q) denote the smallest m
such that every element of Fq can be written as a sum of m many kth powers in Fq . We are interested in

finding γ(k, q) for different k and q values, but unfortunately γ(k, q) does not always exist. For a fixed value
of k, if every element of Fq can be written as a sum of kth powers, we say Fq is coverable by the kth powers.
Otherwise, we call it an uncoverable field for that specific k.
Since F2 and F3 are coverable for any k, the smallest example of an uncoverable field is F4 with k = 3.
The only cubes in F4 are {0, 1} and any linear combination of 0 and 1 is either 0 or 1, this shows if α is a

primitive cube root of unity in F4 , then it cannot be written as a sum of cubes. Therefore, we say F4 is an

uncoverable field for k = 3 or cubes. This example is a very simple observation, but it actually illustrates
the point very well which is if Rk lies in a proper subfield of Fq , then we cannot cover Fq with kth powers.
Furthermore, the converse also holds meaning Fq is coverable if and only if the set of kth powers does not lie
in a proper subfield, see [21].
Before we proceed, notice that γ(1, q) is trivially 1. In the case of k = 2, if Fq is a field with characteristic 2,
we have the Frobenius automorphism which implies every element of Fq is a square so that γ(2, q) = 1. If
char Fq 6= 2, then exactly half of the elements in F∗q are squares and γ(2, q) = 2 follows by the pigeonhole
principle.

If we look at the k = 3 case, then one can prove that except for q = 4, 7 in every finite field every element
can be written as a sum of at most two cubes, see [2]. F7 requires three cubes since the only cubes in F7 are
{0, −1, +1}, and thus 3 is not the sum of any two cubes. F4 is uncoverable as we discussed above.
We can also easily single out a nice bound for γ(k, q) when it exists, and also the extreme case i.e. when
γ(k, q) = 1:
Proposition 3.1. Let Fq be the finite field with order q and let k be a positive integer. If Fq is coverable with
the kth powers, then Fq ⊆ dRk where d = gcd(k, q − 1). In particular if γ(k, q) exists, then it is less than or

equal to k. Moreover, Fq = Rk if and only if gcd(k, q − 1) = 1.

Proof. We have Rk ⊆ 2Rk ⊆ · · · ⊆ mRk = (m + 1)Rk = · · · for some m since Fq is finite. We assumed

Fq is coverable this implies mRk = Fq . If nRk 6= (n + 1)Rk for some n, that means there exists a nonzero

element α in (n + 1)Rk but not in nRk . Let Rk∗ := Rk \ {0}. Rk∗ is a group under multiplication and it is a

subgroup of F∗q . Notice that if we can write α as a sum of n + 1 many k th powers, then any element in the

coset of α, i.e. in αRk∗ , can be written as a sum of n + 1 many kth powers. This implies if α ∈ (n + 1)Rk∗ ,

then αRk∗ ⊆ (n + 1)Rk∗ . This means the number of the strict inclusions in Rk ⊆ 2Rk ⊆ · · · ⊆ mRk is at

WARING’S PROBLEM IN FINITE RINGS

15

most one less than the number of cosets of Rk∗ inside F∗q . Moreover, since F∗q is cyclic of order q − 1 and Rk∗
is a subgroup of F∗q , Rk∗ has to be a cyclic group. Let F∗q = hγi, then Rk∗ = hγ k i and |Rk∗ | =

the number of cosets is gcd(k, q − 1). Also, it is clear that

F∗q

=

Rk∗

q−1
gcd(k,q−1) .

if and only if gcd(k, q − 1) = 1.

So,


This section proceeds like this. First, we prove that when a finite field is sufficiently large, every element of
the field can be written as a sum of two k th powers, three kth powers etc. There exists some similar old results
in the literature implying our result in [14], [19], [21]; but we will provide as elementary and self-contained
proof as possible by following the graph theoretical approach. Our proof actually turns out to be very fruitful,
since we also obtain an original result which is an analog of Sárközy’s theorem in a finite field setting. After
Sárközy’s we provide the precise values for γ(k, q) for 4 6 k 6 37 for all finite fields (only except some of
the γ(k, q) 6 3). Those results were obtained with the help of a supercomputer.
Theorem 3.2. If q > k4 , then every element of Fq can be written as a sum of two kth powers.
Proof. We will use the spectral gap theorem to prove the result. Since v = 0 is already a sum of two kth
powers, let v ∈ F∗q . We have d = gcd(k, q − 1) many cosets of Rk∗ inside F∗q and v ∈ vRk∗ . The plan is to
take X = Rk∗ , Y = vRk∗ and apply the spectral gap theorem. When we apply it, the theorem will guarantee

the existence of a directed edge from X to Y under the assumption q > k4 . This means there exists some
uk ∈ X and vwk ∈ Y for some u, w, z ∈ F∗q such that uk + z k = vwk i.e. v = ( wu )k + ( wz )k , and the result
follows. The only thing left is to figure out when the spectral gap theorem applies.

First, define a Cayley digraph Cay(Fq , Rk∗ ) whose vertices are the elements of Fq , and there exists a directed
edge from u to v if and only if v − u ∈ Rk∗ . Since Rk∗ does not contain 0, Cay(Fq , Rk∗ ) is loopless. We

know every character on Fq corresponds to an eigenvector of the adjacency matrix, A of Cay(Fq , Rk∗ ) by
Theorem 2.1. For instance if F∗q = hγi we have Fq = {0, γ, γ 2 , · · · , γ q−1 = 1}, and any character χ gives

us a unique eigenvector such that the first entry of the corresponding eigenvector is χ(0), the second entry of
the eigenvector is χ(γ), the third entry is χ(γ 2 ) etc. We can even find the eigenvalues corresponding to those
eigenvectors using the same theorem. Recall that we proved every character on Fq should be in the form of
χ1 ◦ φα for some α ∈ Fq where φα (x) = tr(αx) and χ1 (x) = e

2πix
p

for every x ∈ Fq . Let λα denote the

eigenvalue of A corresponding to the eigenvector induced from χ1 ◦ φα . By Theorem 2.1 we have
X
X 2πi(tr(αx))
p
λα =
.
χ1 ◦ φα (x) =
e
x∈R∗k

x∈R∗k

Notice if αRk∗ = βRk∗ we have
X

x∈R∗k

e

2πi(tr(αx))
p

=

X

e

2πi(tr(βx))
p

= λβ .

x∈R∗k

This calculation shows us if α and β are in the same coset of Rk∗ inside F∗q , the eigenvectors induced by
χ1 ◦ φα and χ1 ◦ φβ correspond to the same eigenvalue. We also have the trivial character which induces 1
as an eigenvector with eigenvalue |Rk∗ |, this means we have at most

|F∗q |
|R∗k |

+ 1 many distinct eigenvalues. Thus

16

YEŞİM DEMİROĞLU KARABULUT

the spectrum of A contains the largest eigenvalue |Rk∗ | with multiplicity 1 and other eigenvalues, λαi ’s each
with multiplicity |Rk∗ |, since |αi Rk∗ | = |Rk∗ |. Therefore, we have
X

α∈Fq

kλα k2 = |Rk∗ |2 +

d
X
i=1

kλαi k2 |Rk∗ |.

(3)

At the same time we know
X

α∈Fq

kλα k2 = tr(A∗ A)

(4)

from basic linear algebra. Notice that we also have
tr(A∗ A) = tr(AT A) = tr(AAT ) =

X

d+ (α)

(5)

α∈Fq

as A is real A∗ = AT , and the last equality holds since Cay(Fq , Rk∗ ) is a simple digraph. By Equations (3),
(4) and (5) we have
|Rk∗ |2 +
Hence

d
X

d
X
i=1

which implies

i=1

kλαi k2 |Rk∗ | = q|Rk∗ |.

kλαi k2 = q − |Rk∗ |

max kλαi k 6

16i6d

It follows that

q

q − |Rk∗ | .

 q
q
n∗ = ∗ max kλαi k 6
|Rk | 16i6d

p

q − |Rk∗ |
.
|Rk∗ |

Now, let x = d = gcd(k, q − 1) and y = q in Lemma A.1 in Appendix A. Notice that since y is the order

of the finite field, it is already in Z+ \ {1}. Besides, there is no harm assuming x 6= 1, since we already

handled x = 1 case before in Proposition 3.1. By the lemma, we have (y − 1)4 − x4 y 3 + (y − 1)y 2 x3 > 0,
(y − 1)4 (y − 1)y 2
by dividing it with x4 we get
+
> y 3 . This means |Rk∗ |4 + |Rk∗ |q 2 > q 3 which is to say
x4
x

|Rk∗ |4 > q 3 − |Rk∗ |q 2 i.e. |Rk∗ |4 > q 2 (q − |Rk∗ |). So q > k4 implies |Rk∗ | > n∗ and the result follows.
Theorem 3.3. If q > k3 , then every element of Fq can be written as a sum of three kth powers.

Proof. We will use Corollary 2.3 and the discussion provided right after that. We define a new digraph using
the Cayley digraph in the previous theorem’s proof. The vertices of the new digraph are the elements of
Fq , and there exists a directed edge from u to v if and only if there is a 2-walk from u to v in the original

graph. Since v = 0 is already a sum of three kth powers, let v ∈ F∗q . Let X = Rk∗ , Y = vRk∗ and apply

Corollary 2.3. It will guarantee the existence of a directed 2-walk from X to Y under the assumption q > k3
and the result will follow.

WARING’S PROBLEM IN FINITE RINGS

17

3
Let x = d = gcd(k, q − 1) and y = q in Lemma A.2 in Appendix
A. By

 the lemma, we have (y − 1) −
3
> y xy−y+1
x2 y(xy − y + 1) > 0, by dividing it with x3 we get (y−1)
. This means |Rk∗ |3 > q(q − |Rk∗ |)
x
x3

i.e. |Rk∗ | >

q(q−|R∗k |)
|R∗k |2

and the result follows.



Remark. If one can prove that y m−1 > x2m implies (y − 1)m − yx

m+1
2

(xy − y + 1)

m−1
2

> 0 for every

m, x, y ∈ Z+ \ {1}, then using the same exact approach in the previous theorems’ proof, we can state this
2m

q > k m−1 =⇒ Fq ⊆ mRk
for every integer m > 1. The required inequality (y − 1)m − yx

y m−1

>

x2m

m+1
2

(xy − y + 1)

m−1
2

> 0 whenever

is proven for m = 2 and m = 3 in Appendix A for the proofs of the previous theorems; but

we did not prove it here for all m ∈ Z+ \ {1}. This assertion is actually already familiar to us, since it is

asymptotically equivalent to Winterhof’s result. Recall Winterhof proved that
2m

q > (k − 1) m−1 =⇒ Fq ⊆ mRk .
He used Jacobi sums to deduce his bound, see [21].

Let the notation stay the same with the last two theorems. Then, we have another nice result:
Theorem 3.4 (Analog of Sárközy’s Theorem in Finite Fields). Let k be a positive integer. If E is a subset
qk
then it contains at least two distinct elements whose difference is a kth power.
of Fq with size |E| > √
q−1
√ 
Thus, in particular if k is fixed and |E| = Ω q as q → ∞, then E contains at least two distinct elements
whose difference is a kth power.

Proof. As in the last two theorems, again we
apply the spectral gap theorem. Our calculations in the
p want to
∗
q q − |Rk |
. We have
proof of Theorem 3.2 showed that n∗ 6
|Rk∗ |
q
p
∗
q
q − q−1
q q − |Rk |
q √ p
d
d qd − q + 1.
=
=
q−1
|Rk∗ |
q−1
d

Since d = gcd(k, q − 1) 6 q − 1 i.e. d + 1 6 q we have
qk
q √ p
qd
q √ p
6 √
d qd − q + 1 6
d d(q − 1) = √
.
q−1
q−1
q−1
q−1
If

√qk
q−1

follows.

< |E|, by Theorem 2.2 there is an edge from a vertex in E to a distinct vertex in E and the result



For example consider F412 = F1681 . If we take an arbitrary subset of F1681 with size greater than or equal to
124 (165, 206 resp.), then we know there exists at least two distinct elements in this set whose difference is
a 3rd (4th , 5th resp.) power.

18

YEŞİM DEMİROĞLU KARABULUT

We claimed before that we will state the precise values of γ(k, q) for every 4 6 k 6 37 only except some of
γ(k, q) 6 3. Hence let 4 6 k 6 37 be given. First note that by the theory, we know that for every k, there
exists only a finite number of finite fields which are not coverable with the kth powers, see e.g. [17]. Table 1
lists all of the uncoverable finite fields for 4 6 k 6 37. If we are given with a specific q as well, then we can
determine if γ(k, q) = 1 using the criteria in Proposition 3.1. Theorem 3.6 and 3.7 (upcoming) handle all
of the cases where γ(k, q) = 4, 5, 6 and some of the cases where γ(k, q) = 3. Theorem 3.8 provides all of
the fields such that γ(k, q) > 7. Therefore, if we pick a 4 6 k 6 37 and a coverable field Fq by taking into
consideration Table 1, and if it doesn’t fall into one of the categories in Theorem 3.2, 3.6, 3.7 or 3.8, then we
can conclude γ(k, q) 6 3.
The results in Proposition 3.5 below are discovered via exhaustive search using Sage, in principle one can
calculate these with Theorem G in [3] doing finitely many calculations.
Proposition 3.5. Table 1 lists all of the uncoverable fields for any 4 6 k 6 37.
TABLE 1. Uncoverable Fields
k
4
5
6
7
8
9
10
12
13
14
15
16
17
18

uncoverable fields for k
9
16
4, 25
8
9, 49
4, 64
16, 81
4, 9, 25, 121
27
8, 169
4, 16
9, 49
256
4, 25, 64, 289

k
20
21
24
25
26
27
28
30
31
32
33
34
35
36

uncoverable fields for k
9, 16, 81, 361
4, 8, 64
4, 9, 25, 49, 121, 529
16
27, 625
4, 64
8, 9, 169, 729
4, 16, 25, 81, 841
32, 125
9, 49, 961
4, 1024
256
8, 16
4, 9, 25, 64, 121, 289

Notice that k = 11, 19, 22, 23, 29, 37 cases are not on the Table 1. It is because there are not any uncoverable
fields corresponding to those k values.
Theorem 3.6. For every integer k satisfying 4 6 k 6 19, Table 2 lists all of the fields with size q such that
γ(k, q) = 3, 4, 5 or 6.
Table 2: Fields
k
4
5
6

γ(k, q) = 3
13, 17, 25, 29
31, 41, 61
37, 43, 49, 61, 67, 73, 79, 109, 139, 223

γ(k, q) = 4
5

γ(k, q) = 5

γ(k, q) = 6

11
19, 31

7, 13

WARING’S PROBLEM IN FINITE RINGS

19

Table 2: (continued)
k
7
8
9
10
11
12

13
14

15

16

17
18

19

γ(k, q) = 3
64, 71, 113, 127
13, 29, 73, 81, 89, 97, 113, 121, 137, 233, 257, 289, 337,
761
7, 73, 109, 127, 163, 181, 199, 271, 307, 343
71, 101, 121, 131, 151, 181, 191, 211, 241, 251, 271, 281,
311, 331, 401, 421, 431, 461, 491, 641, 911
199, 331, 353, 419, 463, 617
17, 29, 43, 67, 79, 139, 157, 169, 181, 193, 223, 241, 277,
289, 313, 337, 349, 361, 373, 397, 409, 421, 433, 457, 541,
577, 625, 661, 673, 733, 841, 877, 1069, 1453, 1669, 1741
131, 157, 313, 443, 521, 547, 599, 677, 859, 911, 937,
1171
64, 197, 211, 239, 281, 337, 379, 421, 449, 463, 491, 547,
617, 631, 659, 673, 701, 743, 757, 827, 911, 953, 967,
1009, 1499, 2927
7, 41, 151, 181, 211, 241, 256, 271, 331, 361, 421, 541,
571, 601, 631, 661, 691, 751, 811, 961, 991, 1021, 1051,
1171, 1201, 3181
13, 29, 73, 89, 121, 137, 233, 241, 289, 337, 353, 401, 433,
449, 529, 577, 593, 625, 641, 673, 761, 769, 881, 929, 977,
1009, 1201, 1249, 1297, 1409, 1489, 1697, 2017, 2401,
2593
239, 307, 409, 443, 613, 647, 919, 953, 1021, 1123, 1259,
1327, 1361, 1531, 1667
43, 49, 61, 67, 79, 139, 223, 307, 343, 361, 379, 433, 487,
523, 541, 577, 613, 631, 739, 757, 811, 829, 883, 919,
937, 991, 1009, 1063, 1117, 1153, 1171, 1279, 1369, 1423,
1459, 1693, 1747, 2089, 2197, 2251, 2269, 2287, 2503,
2719, 3259, 4519
343, 457, 571, 647, 761, 1103, 1217, 1483, 1559, 1597,
1787, 2053, 2129, 2357, 2927

γ(k, q) = 4
29, 43
5, 25, 41

41, 61

γ(k, q) = 5

37
31

89
67
5, 19, 31, 61, 73
97, 109, 229
79
71, 113, 127

121

γ(k, q) = 6

7, 37, 49

53
43

11, 61

5, 25, 41, 81,
113, 193, 257

97

137

103

31, 163, 181, 199
271, 397

7, 13, 109,
127

191, 229, 419

Theorem 3.7. Let 20 6 k 6 37 be any given integer.
• Table 3 lists all of the fields with size q such that γ(k, q) = 4, 5 or 6.
• Table 3 lists all of the fields with size q such that γ(k, q) = 3 and q 6 (k − 1)3 .
(We do not list all of the finite fields with γ(k, q) = 3 here, since when we ran the computer, we used a bound
from [21], which is if q > (k − 1)3 then Fq ⊆ 3Rk .)

20

YEŞİM DEMİROĞLU KARABULUT

Table 3: Fields
k
20

21

22

23

24

25

26

27

28

29

γ(k, q) = 3
13, 17, 25, 29, 71, 131, 151, 191, 211, 251, 271, 281, 311,
331, 401, 421, 431, 461, 491, 541, 601, 641, 661, 701, 761,
821, 841, 881, 911, 941, 961, 1021, 1061, 1181, 1201,
1301, 1321, 1361, 1381, 1481, 1601, 1621, 1681, 1721,
1741, 1861, 1901, 2221, 2281, 2381, 2621, 2861
7, 71, 113, 379, 421, 463, 547, 631, 673, 757, 841, 883,
967, 1009, 1051, 1093, 1303, 1429, 1471, 1597, 1723,
1849, 2143, 2437, 2521, 2647, 2689, 2857, 3319, 5167
243, 353, 397, 529, 617, 661, 683, 727, 859, 881, 947, 991,
1013, 1123, 1277, 1321, 1409, 1453, 1607, 1783, 1871,
2003, 2069, 2113, 2179, 2267, 2333, 2377, 2399, 2531,
2663, 2729, 2927, 3037, 3719, 3851, 3917
461, 599, 691, 829, 967, 1013, 1151, 1289, 1381, 1427,
1657, 1933, 1979, 2209, 2347, 2393, 2531, 3083, 3313,
4831, 4969, 5659, 8419
29, 43, 67, 79, 81, 89, 113, 137, 139, 157, 181, 223, 233,
257, 277, 337, 349, 373, 397, 421, 433, 541, 601, 625, 661,
673, 733, 761, 769, 841, 877, 937, 961, 1009, 1033, 1069,
1129, 1153, 1201, 1249, 1297, 1321, 1369, 1453, 1489,
1609, 1657, 1669, 1681, 1741, 1753, 1777, 1801, 1849,
1873, 1993, 2017, 2089, 2113, 2137, 2161, 2281, 2377,
2401, 2473
31, 41, 61, 401, 601, 701, 751, 1051, 1151, 1201, 1301,
1451, 1601, 1801, 1901, 1951, 2251, 2351, 2551, 2801,
2851, 3001, 3251, 3301, 3851, 5051, 5501
521, 677, 729, 859, 911, 937, 1093, 1171, 1223, 1249,
1301, 1327, 1483, 1613, 1847, 1873, 1951, 2003, 2029,
2081, 2237, 2341, 2393, 2549, 2809, 2861, 2887, 2939,
3121, 3329, 3407, 3433, 3511, 3719, 3797
7, 73, 127, 181, 199, 307, 343, 379, 757, 811, 919, 1297,
1459, 1567, 1621, 1783, 1999, 2053, 2161, 2269, 2377,
2539, 2593, 2647, 2917, 2971, 3079, 3187, 3457, 3727,
3889, 3943, 4051, 4159, 4483, 4591, 4861, 4969, 5023,
6859, 7993, 9397, 9829
13, 17, 25, 64, 211, 239, 379, 463, 491, 547, 631, 659, 673,
701, 743, 757, 827, 841, 911, 953, 967, 1009, 1093, 1289,
1373, 1429, 1499, 1597, 1681, 1709, 1849, 1877, 1933,
2017, 2129, 2213, 2269, 2297, 2381, 2437, 2521, 2549,
2633, 2689, 2801, 2857, 2927, 2969, 3109, 3137, 3221,
3361, 3389, 3529, 3557, 3613, 3697, 4201, 4229, 4397,
4481, 4621, 4649, 4733, 4789, 4817, 4957
523, 929, 1103, 1277, 1451, 1567, 1741, 1973, 2089, 2437,
3191, 3307, 3481, 3539, 4003, 4177, 4409, 4583, 4931,
5569, 5801, 6091, 8237

γ(k, q) = 4
γ(k, q) = 5
5, 181, 241, 521 31, 101

γ(k, q) = 6

29, 169, 211,
337

127

199, 331, 419,
463

277

5, 19, 31, 41, 193, 289
61, 109, 169,
229, 241, 313,
361, 409, 457,
577

251

7, 37

11

313, 443, 547,
599

131

271, 433, 487, 37
541

5, 71, 127, 337, 197, 281
421, 449, 617

349

233

43

WARING’S PROBLEM IN FINITE RINGS

21

Table 3: (continued)
k
30

31

32

33

34

35

36

γ(k, q) = 3
37, 43, 49, 67, 71, 73, 79, 101, 109, 131, 139, 191, 223,
251, 256, 281, 311, 401, 431, 461, 491, 601, 631, 641,
691, 751, 811, 911, 961, 991, 1021, 1051, 1171, 1201,
1231, 1291, 1321, 1381, 1471, 1531, 1621, 1681, 1741,
1801, 1831, 1861, 1951, 2011, 2131, 2161, 2221, 2251,
2281, 2311, 2341, 2371, 2401, 2521, 2551, 2671, 2731,
2791, 2851, 2971, 3001, 3061, 3121, 3181, 3271, 3301,
3331, 3361, 3391, 3511, 3541, 3571, 3631, 3691, 3721,
3931, 4021, 4051, 4111, 4201, 4261, 4441, 4561, 4831,
4861
683, 1024, 1117, 1303, 1427, 1489, 1613, 1861, 2357,
2543, 2729, 2791, 3163, 3659, 3907, 4093, 4217, 4651,
5023, 5147, 5209, 5519, 5581, 5953, 7193
13, 29, 73, 89, 121, 137, 233, 241, 337, 401, 433, 529,
593, 625, 641, 673, 761, 881, 929, 977, 1009, 1153, 1201,
1217, 1249, 1297, 1409, 1489, 1601, 1697, 1889, 2017,
2081, 2113, 2209, 2273, 2401, 2593, 2657, 2689, 2753,
3041, 3137, 3169, 3329, 3361, 3457, 3617, 4001, 4129,
4289, 4513, 4673, 4801, 4993
7, 353, 419, 617, 859, 991, 1123, 1321, 1453, 1783, 1849,
2113, 2179, 2311, 2377, 2707, 2971, 3037, 3169, 3301,
3433, 3499, 3631, 3697, 4027, 4093, 4159, 4357, 4423,
4489, 4621, 4951, 5281, 5347, 5413, 5479, 5743, 6007,
6073, 6271, 6337, 6469, 6997, 7723, 7789, 7921, 8317,
8647, 9439
919, 1021, 1123, 1259, 1327, 1361, 1429, 1531, 1667,
1871, 1973, 2143, 2347, 2381, 2551, 2687, 2789, 2857,
3061, 3163, 3299, 3469, 3571, 3673, 3877, 3911, 4013,
4217, 4421, 4523, 4591, 4931, 4999, 5101, 5237, 5407,
5441, 5849
31, 41, 61, 64, 113, 127, 701, 841, 911, 1051, 1331, 1471,
1681, 2311, 2381, 2521, 2591, 2731, 2801, 3011, 3221,
3361, 3571, 3851, 4096, 4201, 4271, 4481, 4621, 4691,
4831, 5041, 5531, 5741, 5881, 6301, 6581, 6791, 7001,
7351, 7561, 8191, 8681, 8821
17, 29, 43, 67, 79, 139, 157, 169, 193, 223, 241, 277, 307,
313, 337, 343, 349, 373, 379, 409, 421, 457, 487, 523,
625, 631, 661, 673, 733, 739, 811, 829, 841, 877, 883,
919, 937, 991, 1009, 1063, 1069, 1153, 1171, 1279, 1297,
1369, 1423, 1453, 1459, 1549, 1621, 1657, 1669, 1693,
1741, 1747, 1801, 1873, 2017, 2053, 2089, 2161, 2197,
2251, 2269, 2287, 2341, 2377, 2503, 2521, 2557, 2593,
2719, 2809, 2917, 2953, 3061, 3169, 3259, 3313, 3457,
3529, 3637, 3673, 3709, 3853, 3889, 4177, 4357, 4519,
4789, 4861, 4933, 4969

γ(k, q) = 4
γ(k, q) = 5
19, 41, 271, 211, 241
331, 361, 421,
541, 571, 661

311

γ(k, q) = 6
7, 13, 151

373

5, 25, 41, 81,
113, 289, 353,
449, 577, 769

257

89, 397, 463, 331
529, 661, 727

443, 613, 647, 307, 409
953

29, 43,
491, 631

239

421, 11, 281

5, 31, 61, 97, 199, 361, 397 7, 49, 127
163, 229, 271,
433, 541, 577,
613, 757, 1117

22

YEŞİM DEMİROĞLU KARABULUT

Table 3: (continued)
k
37

γ(k, q) = 3
γ(k, q) = 4
1259, 1481, 1777, 1999, 2221, 2591, 2887, 3109, 3257, 593
3331, 3701, 3923, 4219, 4441, 4663, 5107, 5477, 6143,
6217, 6661, 7253, 7549, 7919, 7993, 8363, 8807, 9103,
9473

γ(k, q) = 5

γ(k, q) = 6

Theorem 3.8. For 4 6 k 6 37, the following is the list of all of the fields with size q such that γ(k, q) > 7 :
• γ(8, 17) = 8
• γ(9, 19) = 9
• γ(10, 11) = 10
• γ(11, 23) = 11
• γ(12, 13) = 12
• γ(14, 29) = 14
• γ(15, 31) = 15
• γ(16, 17) = 16
• γ(18, 73) = 7, γ(18, 19) = 18, γ(18, 37) = 18
• γ(20, 121) = 7, γ(20, 61) = 8, γ(20, 11) = 10, γ(20, 41) = 20
• γ(21, 43) = 21
• γ(22, 89) = 7, γ(22, 67) = 8, γ(22, 23) = 22
• γ(23, 139) = 7, γ(23, 47) = 23
• γ(24, 17) = 8, γ(24, 73) = 8, γ(24, 97) = 8, γ(24, 13) = 12
• γ(25, 151) = 7, γ(25, 101) = 9
• γ(26, 157) = 8, γ(26, 79) = 9, γ(26, 53) = 26
• γ(27, 163) = 8, γ(27, 19) = 9, γ(27, 109) = 9
• γ(28, 113) = 7, γ(28, 29) = 28
• γ(29, 59) = 29
• γ(30, 181) = 8, γ(30, 11) = 10, γ(30, 121) = 10, γ(30, 31) = 30, γ(30, 61) = 30
• γ(32, 193) = 8, γ(32, 97) = 10, γ(32, 17) = 16
• γ(33, 199) = 9, γ(33, 23) = 11, γ(33, 67) = 33
• γ(34, 103) = 10, γ(34, 137) = 10

WARING’S PROBLEM IN FINITE RINGS

23

• γ(35, 211) = 9, γ(35, 71) = 35
• γ(36, 181) = 7, γ(36, 109) = 11, γ(36, 13) = 12, γ(36, 19) = 18, γ(36, 37) = 36,
γ(36, 73) = 36

• γ(37, 149) = 9, γ(37, 223) = 9.
Let k be any positive integer. Then, we define γ(k) := max γ(k, q) where we take the maximum value
of γ(k, q) over the set {q | γ(k, q) exists}. Hence, if a finite field is coverable with the kth powers, every

element of the field can be written as a sum of γ(k) many kth powers. By Proposition 3.1 we have γ(k) 6 k.
The following proposition gives us the exact values of γ(k) for k 6 37:
Proposition 3.9. Let k 6 37. If γ(k) is not provided in Table 4, that means γ(k) = k.
TABLE 4. γ(k) values
γ(7) = 4
γ(27) = 9

γ(13) = 6
γ(31) = 5

γ(17) = 6
γ(32) = 16

4. WARING ’ S P ROBLEM

γ(19) = 4
γ(34) = 10

IN

γ(24) = 12
γ(37) = 9

γ(25) = 9

M ATRIX R INGS

Let Fq be the finite field with q elements and let p denote the characteristic of Fq . Also let k be a positive
integer and Matn (Fq ) be the ring of n × n matrices over Fq . In this section we want to find an integer m
with the property that every element of Matn (Fq ) can be written as a sum of at most m many kth powers

in Matn (Fq ). First, we need to develop our machinery. Take any A ∈ Matn (Fq ). Let P (x) ∈ Fq [x] be

any polynomial over Fq , then P (x) = a0 + a1 x + · · · + al xl for some a0 , a1 · · · al ∈ Fq . We can evaluate

any polynomial P (x) at A; for example here P (A) = a0 I + a1 A + · · · + al Al where I denotes the n × n
identity matrix over Fq . Then, we define Fq [A] = {P (A) | P (x) ∈ Fq [x]}. We want to find an m such that

k for some B , · · · , B ∈ Mat (F ). Instead of working with Mat (F ) we will work
A = B1k + · · · + Bm
1
m
n q
n q

with Fq [A], meaning we will try to write A as a sum of kth powers using the elements of Fq [A]. This is more

convenient since we have more tools to use in Fq [A], but we are only able to provide upper bounds for m
with this approach, rather than exact values. Define
ϕ : Fq [x] −→ Fq [A]

a0 + a1 x + · · · + al xl 7−→ a0 I + a1 A + · · · + al Al .
Notice that
ker ϕ = {P (x) ∈ Fq [x] s.t. P (A) = 0n×n } = hmA (x)i
where mA (x) denotes the minimum polynomial of A, and Im ϕ = Fq [A]. By first isomorphism theorem we
have
Fq [x]

.

= Fq [A].
hmA (x)i ∼

24

YEŞİM DEMİROĞLU KARABULUT

Let’s assume mA (x) = p1 (x)i1 · · · pj (x)ij for some p1 , p2 , · · · , pj distinct irreducible polynomials over Fq .

Using Chinese remainder theorem we have
.
.
.
Fq [x] hpi1 · · · pij i ∼
Fq [x] hpi1 i × · · · × Fq [x] hpij i .
=
1
1
j
j

We need one more tool before we state the main result of the section.

Proposition 4.1. Let f (x) be an irreducible polynomial over Fq with degree n. Let i and k be positive
integers such that p ∤ k where p denotes the characteristic of Fq .
.
.
th
F
[x]
F
[x]
q
q
• If every element of
hf (x)i is a k power, then the elements of
hf i (x)i can be written
as a sum of two kth powers.

.
• Assume every element of Fq [x] hf (x)i can be written as a sum of m many kth powers for some
.
m > 1. If −1 is a kth power in Fq , then the elements of Fq [x] hf i (x)i can be written as a sum of m
.
many kth powers. If −1 is not a kth power in Fq , then the elements of Fq [x] hf i (x)i can be written
as a sum of m + 1 many kth powers.

.
Proof. We denote f (x) with f in this proof. Take any element from Fq [x] hf 2 i . Using division algorithm
we can write an equivalence class representative of this element as r1 + r2 f where r1 , r2 ∈ Fq [x] and

deg(r1 ), deg(r2 ) < n. It follows from the assumption that there exist some B1 , B2 , · · · , Bm ∈ Fq [x] such

k (mod f ).
that r1 ≡ B1k + B2k + · · · + Bm

If some of Bi ’s are zeros modulo f , we can erase them from the list of Bi ’s, and use the ones which are not
zero modulo f for the next step. We can erase them, because if Bi ≡ 0 (mod f ), Bik ≡ 0 (mod f ) so the

summation of the kth powers of the reduced list will still be r1 . If all of the Bi ’s are zeros modulo f , then we
need to be a little bit careful. If k is odd, or if k is even and −1 is a k th power in Fq , simply take Bi1 = 1

and Bi2 = −1 and proceed to the next step. If k is even and −1 is not a kth power in Fq , then we can write

0 ≡ Bik1 + (−1) (mod f ) for Bi1 = 1, and we know −1 can be written as a sum of m many kth powers by

assumption. So we can assume Bi1 , · · · , Bij are all nonzero in modf and their summation is equivalent to
r1 in modf .

Define the polynomial Q(t) = tk + Bik1 + · · · + Bikj−1 − r1 − r2 f over Fq [x], use Hensel’s lemma for the

polynomial rings (Proposition 2.16) for Q(t) to conclude there exists a g2 ∈ Fq [x] such that g2k + Bik1 + · · · +

Bikj−1 = r1 + r2 f (mod f 2 ) and the result for i = 2 follows. Here, we are allowed to use Hensel’s lemma,
since Bij is a root of Q(t) in modf and ν(Q′ (Bij )) = 0 < 12 . ν(Q′ (Bij )) = 0 since Q′ (t) = ktk−1 and
Q′ (Bij ) = kBik−1
6≡ 0 (mod f ). This follows from f ∤ k, p ∤ k, f ∤ Bij and f being irreducible.
j

.
.
Once we lift a solution from Fq [x] hf (x)i to Fq [x] hf 2 (x)i , it is easy. Third condition in Proposition 2.16
.
allows us to apply Hensel’s lemma again and again, and get a solution in each Fq [x] hf i (x)i for any

i ∈ Z+ .



WARING’S PROBLEM IN FINITE RINGS

25

Using this proposition, the discussion right before the proposition and finite field tables in Section 3 we
literally have dozens of nice results for the matrix rings, but it would be a waste of paper to write out all
of them. That is why we will state the results only for some small k values to get across our point to the
reader in the following theorem. Note that we denote with Rk,n the set of all kth powers in Matn (Fq ) i.e.

	
Rk,n = M k | M ∈ Matn (Fq ) . Also, Matn (Fq ) ⊆ mRk,n means every element of Matn (Fq ) can be
written as a sum of m many kth powers.

Theorem 4.2. In the following table in a fixed row, let k be a positive integer as in the first column, and
let Fq be the finite field with q elements where q is different than the values in the second column. Then
k
Matn (Fq ) ⊆ mRk,n for any n. In fact, in this case any A ∈ Matn (Fq ) has A = B1k + B2k + · · · + Bm

with B1 , B2 , · · · , Bm in the subring generated by A. (For example the first row should be read as "If

|Fq | =
6 2, 4, or any power of 3, then Matn (Fq ) ⊆ 3R3,n for any n. In fact, in this case any A ∈ Matn (Fq )
has A = B13 + B23 + B33 with B1 , B2 , B3 in the subring generated by A.")
k=
3
4

5

6

7

8

9

10

q 6=
m=
s
2, 4, 3
3
2, 4, 7, 3s
2
s
3, 9, 2
5
3, 5, 9, 2s
4
3, 5, 9, 13, 17, 25, 29, 2s
3
s
2, 4, 16, 5
5
s
2, 4, 11, 16, 5
3
2, 4, 11, 16, 31, 41, 61, 5s
2
s
s
2, 4, 5, 25, 2 , 3
7
2, 4, 5, 7, 13, 25, 2s , 3s
5
2, 4, 5, 7, 13, 19, 25, 31, 2s , 3s
4
s
s
2, 4, 5, 7, 13, 19, 25, 31, 37, 43, 49, 61, 67, 73, 79, 109, 139, 223, 2 , 3
3
2, 8, 7s
4
s
2, 8, 29, 43, 7
3
2, 4, 8, 29, 43, 64, 71, 113, 127, 7s
2
s
3, 7, 9, 49, 2
9
3, 7, 9, 17, 49, 2s
5
3, 5, 7, 9, 17, 25, 41, 49, 2s
4
3, 5, 7, 9, 11, 13, 17, 25, 29, 41, 49, 73, 81, 89, 97, 113, 121, 137, 233, 257, 3
289, 337, 761, 2s
2, 4, 8, 64, 3s
9
2, 4, 8, 19, 64, 3s
5
2, 4, 8, 19, 37, 64, 3s
3
2, 4, 7, 8, 19, 37, 64, 73, 109, 127, 163, 181, 199, 271, 307, 343, 3s
2
s
s
2, 3, 4, 9, 16, 81, 2 , 5
11
s
s
2, 3, 4, 9, 11, 16, 81, 2 , 5
6
2, 3, 4, 9, 11, 16, 31, 81, 2s , 5s
5
2, 3, 4, 9, 11, 16, 31, 41, 61, 81, 2s , 5s
4
2, 3, 4, 9, 11, 16, 31, 41, 61, 71, 81, 101, 121, 131, 151, 181, 191, 211, 241, 3
251, 271, 281, 311, 331, 401, 421, 431, 461, 491, 641, 911, 2s , 5s

26

YEŞİM DEMİROĞLU KARABULUT

11

23, 11s
23, 67, 11s
23, 67, 89, 11s
23, 67, 89, 199, 331, 353, 419, 463, 617, 11s

5
4
3
2

Proof. To explain the process, we will only do for the first row. Let k = 3. By Section 3 we know that every
element of a finite field can be written as a sum of three cubes as long
. as q 6= 4. Let A ∈.Matn (Fq ). By
the discussion prior to Proposition 4.1, we know that Fq [A] ∼
= Fq [x] hpi1 i × · · · × Fq [x] hpij i for some
1

j

p1 , p2 , · · · , pj distinct irreducible
. polynomials over Fq . We first exclude.all of the subfields of F4 from our
list so that none of the Fq [x] hpr i will be isomorphic to F4 . So, Fq [x] hpr i will be different than F4 , as
.
long as Fq 6= F2 , F4 . This guarantees that every element of Fq [x] hpr i can be written as a sum of three
.
.
cubes. Then, we want to lift the kth powers from Fq [x] hpr i to Fq [x] hpirr i . We will use Proposition 4.1.
To use this proposition we need the characteristic of the finite field not to divide
. k. That is why we need to
F
[x]
exclude p = 3 cases. Once we guarantee that three cubes is enough for q
hpir i for every 1 6 r 6 j,
. r
.
then Chinese remainder theorem guarantees that three cubes is enough for Fq [x] hpi11 i ×· · ·× Fq [x] hpij i .
j
th
One last thing to note is that when we
determine
m,
if
−1
is
a
k
power
(in
particular
if
k
is
odd)
we
can

.

th
use the same m from the downstairs Fq [x] hp i ; but if −1 is not a k power (for example in some cases
r

when k is even) we need to increase m by 1 when we do the lifting using Proposition 4.1. That is why in
the table when k is even, we increased m by 1 just to be safe without paying any attention to −1 being a kth

power or not.



Note if we have a finite semisimple ring, by Artin-Wedderburn theory it is a direct product of finitely many
matrix rings over finite fields and we can use matrix rings results to get sharp bounds for the Waring problem
on finite semisimple rings. For example if we know R is semisimple with |R| = 54 112 13, then we know

every element of R can be written as a sum of two cubes; since there is not any possibility that R has a matrix
ring over F2 , F4 or a finite field of characteristic 3 in its decomposition.

Next we give an example which shows that sometimes the matrix rings are better than the finite fields in
terms of coverability, since we have more flexibility.
.
Example. Take F4 ∼
= F2 [x] hx2 + x + 1i so that we can denote the elements with {0, 1, x, x + 1}. We




1
1
x+1 1
2
2
2
have x = x + 1, (x + 1) = x + 1 = x and x(x + 1) = 1. Let A =
and B =
.
1 x+1
1
1






x 1
0 1
x 0
Then, A3 =
and B 3 =
. So, A3 + B 3 =
. This is very interesting although we
1 0
1 x
0 x


x 0
3
3
cannot write x as a sum of cubes in F4 (since x = (x + 1) = 1 in F4 ), we can write
as a sum of
0 x
two cubes in Mat2 (F4 ). Furthermore, one can also show that every element of Mat2 (F4 ) can be written as a
sum of two cubes.

WARING’S PROBLEM IN FINITE RINGS

5. WARING ’ S P ROBLEM

IN

27

F INITE R INGS

Let R be a finite ring with identity which is not necessarily commutative, and let k be any positive integer.
In this section we want to find an integer n with the property that every element of R can be written as a
sum of at most n many kth powers in R. Before we dive into results and proofs, first we need to setup our
machinery for finite rings with identity. First notice R /J is semisimple i.e. J R /J = 0. Moreover,

since R is finite, R /J is finite so R /J is both left and right Artinian. Theorem 2.6 implies that R /J ∼
=
Matn1 (D1 ) × · · · × Matnr (Dr ) for some D1 , · · · Dr division rings. Since R /J is finite, each Di has to

have finitely many elements. By Wedderburn’s little theorem Di ’s are finite fields. Therefore, we have
R /J ∼
= Matn1 (Fq1 ) × · · · × Matnr (Fqr ) for some finite fields Fq1 , · · · , Fqr . Furthermore
J ⊇ J 2 ⊇ J 3 ⊇ · · · ⊇ J l = (0)
for some l by Corollary 2.9 and
R = R /J l ։ R /J l−1 ։ · · · R /J 2 ։ R /J ∼
= Matn1 (Fq1 ) × · · · × Matnr (Fqr ).

Theorem 5.1. Let R be a finite ring with identity which is not necessarily commutative and J denote the
Jacobson radical of R. Let k be a positive integer such that gcd(|R|, k) = 1 where |R| denotes the order of
the ring.

• If every element of R /J is a kth power, then unit elements of R are kth powers and nonunit elements
of R can be written as a sum of two kth powers.

• Let m > 1. Assume every element of R /J can be written as a sum of m many kth powers in R /J .
If α ∈ R is a unit (or equivalently if α mod J in R /J is a unit), then α can be written as a sum of
m many kth powers in R. If k is odd (resp. even), then every element of R can be written as a sum of

m (resp. m + 1) many kth powers in R.
Proof. Case 1: Let R be commutative. Then we have R /J ∼
= Fq1 × · · · × Fqr for some finite fields, Fqi ’s.
Let α ∈ R. Since we assumed every element of R /J can be written as a sum of m many kth powers in
k mod J for some B , · · · , B ∈ R. We can send α from R to R /
R /J , we know α ≡ B1k + · · · + Bm
1
m
J

with the reduction mod J, and denote it with ᾱ so that ᾱ = (α1 , α2 , · · · , αr ) for some αi ∈ Fqi where

1 6 i 6 r. Similarly, we will use B̄j to denote Bj mod J for every Bj ∈ R.

Case 1.a: If ᾱ is a unit in R /J that means each entry of ᾱ (i.e. αi for every 1 6 i 6 r) is nonzero. Then
we can arrange B̄j ’s (by shuffling the entries of B̄j ’s) such that B̄1 does not have any zero entry, so that B̄1
is a unit in Fq1 × · · · × Fqr . Since we have gcd(|R|, k) = 1 by assumption, k̄ = (k1 , k2 , · · · , kr ) that is the
image of k under reduction mod J is a unit in Fq1 × · · · × Fqr . This implies k̄B̄1k−1 is a unit, and the result
follows from Corollary 2.14.

Case 1.b: If ᾱ is not a unit in R /J , that means at least one of the entries of ᾱ is zero. Assume only one
k mod J by assumption. We can shuffle the entries
of them equals 0, say α1 . We have α ≡ B1k + · · · + Bm

28

YEŞİM DEMİROĞLU KARABULUT

of B̄j ’s such that the ith entry of B̄1 is nonzero for every 2 6 i 6 r. If the first entry of one of the B̄j ’s
is nonzero, then we can shuffle the nonzero entry to B̄1 and B̄1 becomes again a unit, we are back in case
1.a. If the first entries of all of the B̄j ’s are zero for 1 6 j 6 m, then we can do the following trick. We
can replace 0 in the first entry of B̄1 with 1, so that B̄1 becomes a unit. But then the first entry of B̄1k also
k = ᾱ). Therefore,
becomes 1 and we need to destroy the effect of 1 in the summation (B̄1k + B̄2k + · · · + B̄m

we have to change the first entries of B̄j ’s for 2 6 j 6 m such that the first entry of the summation
k will be −1. If k is odd, then simply replace 0 in the first entry of B̄ with −1, leave
B̄2k + · · · + B̄m
2

the other B̄j ’s as they are and the problem is solved since (−1)k = −1. If k is even, by assumption
(−1, 0, · · · , 0) can be written as a sum of m many kth powers in R /J , this implies for some xj ∈ Fq1 we

have (−1, 0, · · · , 0) = (x1 , 0, · · · , 0)k +(x2 , 0, · · · , 0)k +· · ·+(xm , 0, · · · , 0)k . Let B̄new = (x1 , 0, · · · , 0),
and replace the first entries of B̄j ’s with xj ’s for 2 6 j 6 r, so that the first entry of the summation

k
k
k will be −1 and ᾱ will be equal to B̄ k + B̄ k
k
+ B̄2k + · · · + B̄m
B̄new
new + B̄2 + · · · + B̄m . We again have
1

k̄B̄1k−1 is a unit, since gcd(|R|, k) = 1 and B̄1 is a unit. Corollary 2.14 implies that α can be written as a
sum of m + 1 many kth powers.
Case 2: Let R be noncommutative. To reduce this case to the commutative case, we use the following trick.

	
Let α ∈ R. Consider the subring generated by α, i.e. Z[α] = a0 .1 + a1 α + · · · + al αl | a0 , a1 · · · al ∈ Z .

It is a subring but it is a commutative finite ring with identity by itself. Moreover, since the order of Z[α] has
to divide |R|, gcd(|R|, k) = 1 implies gcd(|Z[α]|, k) = 1 and we are again in case 1. Note that this approach

enables us to write every element of Z[α] as a sum of kth powers from Z[α] instead of R, which means when

R is not commutative the n value (i.e. the number of kth powers needed to write α as a sum) we find with
this approach can be bigger than the actual n value.



We actually proved a stronger result in the last proof. It follows that in the second part of Theorem 5.1 if −1

is a kth power in R, then every element of R can be written as a sum of m many kth powers in R, otherwise
we need to increase m by 1.

Theorem 5.2. Let R be a finite ring with identity which is not necessarily commutative. In the following
table in a fixed row, let k be a positive integer as in the first column. If none of the q values stated in the
second column divides the order of the ring, then every element of R can be written as a sum of n many k th
powers in R. In fact, in this case any α ∈ R has α = B1k + B2k + · · · + Bnk with B1 , B2 , · · · , Bn in Z[α].

(For example the first row should be read as "If 3, 4 ∤ |R|, then any element of R can be written as a sum of
three cubes in R. In fact, in this case any α ∈ R has α = B13 + B23 + B33 with B1 , B2 , B3 in Z[α].")
k=
3
4

q∤
3, 4
3, 4, 7
2, 9
2, 5, 9
2, 5, 9, 13, 17, 29

n=
3
2
5
4
3

WARING’S PROBLEM IN FINITE RINGS

5

6

7

8

9

10

11

29

5, 16
5, 11, 16
5, 11, 16, 31, 41, 61
2, 3, 25
2, 3, 7, 13, 25
2, 3, 7, 13, 19, 25, 31
2, 3, 7, 13, 19, 25, 31, 37, 43, 61, 67, 73, 79, 109, 139, 223
7, 8
7, 8, 29, 43
7, 8, 29, 43, 71, 113, 127
2, 9, 49
2, 9, 17, 49
2, 5, 9, 17, 41, 49
2, 5, 9, 13, 17, 29, 41, 49, 73, 89, 97, 113, 121, 137, 233, 257, 337, 761
3, 4
3, 4, 19
3, 4, 19, 37
3, 4, 7, 19, 37, 73, 109, 127, 163, 181, 199, 271, 307
2, 5, 81
2, 5, 11, 81
2, 5, 11, 31, 81
2, 5, 11, 31, 41, 61, 81
2, 5, 11, 31, 41, 61, 71, 81, 101, 131, 151, 181, 191, 211, 241, 251, 271, 281,
311, 331, 401, 421, 431, 461, 491, 641, 911
11, 23
11, 23, 67
11, 23, 67, 89
11, 23, 67, 89, 199, 331, 353, 419, 463, 617

5
3
2
7
5
4
3
4
3
2
9
5
4
3
9
5
3
2
11
6
5
4
3
5
4
3
2

Proof. Given a k value, we want to find an integer n with the property that every element of R can be written
as a sum of at most n many kth powers in R. We want to use the previous theorem. One of the assumptions
in that theorem is gcd(|R|, k) = 1. In the table, notice that q-column always has the divisors of k. So when
we say q does not divide |R| in the statement, it is guaranteed that gcd(|R|, k) = 1.
If R is commutative, then R /J is isomorphic to the direct product of some finite fields as we discussed
earlier. If R
. is not commutative, then let α ∈ R. Since Z[α] is a commutative finite ring with identity, we
have Z[α] J (Z[α]) ∼
= Fq × · · · × Fq for some finite fields Fq , · · · , Fq . That means to find m in the
1

1

r

r

th

previous theorem, first we need to find how many k powers is necessary to write every element of Fqi as

a sum of kth powers in Fqi . We denote this number with mi for each Fqi , i.e. every
element of.Fqi can be


th
written as a sum of mi many k powers in Fqi . Then, every element of R /J or resp. Z[α] J (Z[α])
.


can be written as a sum of m = max16i6r mi many kth powers in R /J or resp. in Z[α] J (Z[α]) .
Therefore, building on our results in Section 3 we can determine m, and using the previous theorem we can
let n = m or n = m + 1 depending on the parity of k.



30

YEŞİM DEMİROĞLU KARABULUT

Notice that in the previous theorem, we did not note the rings in which every element is a kth power, i.e.
there are not any rows with n = 1 in the table. The following propositions are stated with this purpose, and
their proofs follow from Proposition 3.1 and Theorem 5.1 easily.
Proposition 5.3. Let R be a finite ring with identity and with a cube-free order. Let |R| = pi11 pi22 · · · piss be

the prime factorization of the order of the ring. Let k be a positive integer such that pj ∤ k for any j, and
i

gcd(k, pjj − 1) = 1 for all 1 6 j 6 s. If α ∈ R is a unit, then α is a kth power in R. If k is odd, then any

element of the ring is a kth power. If k is even, then any element of the ring can be written as a sum of two

kth powers.
factorization
Proposition 5.4. Let R be a finite ring with identity. Let |R| = pi11 pi22 · · · piss be the
 prime
 of
Q ij
ι
the order of the ring. Let k be a positive integer such that pj ∤ k for any j, and gcd k, ι=1 (pj − 1) = 1

for all 1 6 j 6 s. If α ∈ R is a unit, then α is a kth power in R. If k is odd, then any element of the ring is a
kth power. If k is even, then any element of the ring can be written as a sum of two kth powers.

For example consider the group algebra
F3 [T ] where
 of upper triangular 3 × 3 matrices with
 T is the group
 1 a b 

1’s in the diagonal over F3 i.e. T = 0 1 c   a, b, c ∈ F3 . T is a group under multiplication and


0 0 1
nonabelian, this implies F3 [T ] is noncommutative. Moreover, Maschke’s theorem does not apply, the group
algebra is not semisimple. But via the last proposition we can conclude that every element of F3 [T ] is a
septic (7th power), since 3 ∤ 7 and gcd(7, 2 × 8 × 26 × 80) = 1.
A PPENDIX A. L EMMATA

Here we prove the basic inequalities used in Section 3.
Lemma A.1. Let x, y ∈ Z+ \ {1}. If y > x4 , then (y − 1)4 − x4 y 3 + (y − 1)y 2 x3 > 0.
Proof. Step 1: Pick any x ∈ Z+ \ {1} and fix it.

We will prove F (x, y) = (y − 1)4 − x4 y 3 + (y − 1)y 2 x3 > 0 when y = x4 + 1.
F (x, x4 + 1) = x16 − x4 (x4 + 1)3 + x4 (x4 + 1)2 x3

= x4 (x3 − x − 1)(x8 + x6 − 2x5 + 3x4 − x3 + x2 − x + 1).

x4 > 0 for every x ∈ R.

x3 − x − 1 has only one real root in the interval (1, 2) and two complex conjugate roots, as the first derivative

test and sign chart illustrates it. We have x3 − x − 1 > 0 when x ∈ Z+ \ {1}.

Also, x8 + x6 − 2x5 + 3x4 − x3 + x2 − x + 1 > 0 as x8 + x6 > 2x5 and 2x4 > x3 + x when x ∈ Z+ \ {1}.

As a result, we proved F (x, y) > 0 when y = x4 + 1 and x ∈ Z+ \ {1}.

Step 2: Pick any x ∈ Z+ \ {1}. Now, we will prove by induction that F (x, y) > 0 for any y > x4 . We

WARING’S PROBLEM IN FINITE RINGS

31

already showed in Step 1 that F (x, y) > 0 when y = x4 + 1. We assume this holds for y = x4 + C for any
C ∈ Z+ , and we demonstrate below F (x, y) > 0 also holds when y = x4 + C + 1.

We have

F (x, x4 + C) = (x4 + C − 1)4 − x4 (x4 + C)3 + (x4 + C − 1)(x4 + C)2 x3 > 0
by assumption, and
F (x, x4 + C + 1) = (x4 + C + 1 − 1)4 − x4 (x4 + C + 1)3 + (x4 + C + 1 − 1)(x4 + C + 1)2 x3 .
Notice that if we show B = [F (x, x4 + C + 1) − F (x, x4 + C)] > 0, then we are done.
We have

2 3
2
8
7
4
3
12
11
4
B = 4C 3 +9C 2 x4 +3C
−
− 9x8} +x7 +3x
| x {z− 6C } +6Cx +6Cx
|
| {z
{z15Cx} +Cx +4C+x +3x
| {z− 1} .

Notice that we have

3C 2 x3 − 6C 2 = 3C 2 (x3 − 2) > 0

6Cx7 − 15Cx4 = 3Cx4 (2x3 − 5) > 0
3x11 − 9x8 = 3x8 (x3 − 3) > 0 and

3x4 − 1 > 0

since x ∈ Z+ \ {1}. These calculations show B > 0, and the result follows.



Lemma A.2. Let x, y ∈ Z+ \ {1}. If y > x3 , then (y − 1)3 − x2 y(xy − y + 1) > 0.
Proof. We again use induction to prove the claim.
Step 1: Pick any x ∈ Z+ \ {1} and fix it.

We need to show F (x, y) = (y − 1)3 − x2 y(xy − y + 1) > 0 holds when y = x3 + 1.

We have F (x, x3 + 1) = x8 − 2x6 + x5 − x3 is clearly bigger than zero as x ∈ Z+ \ {1}.

Step 2: Pick any x ∈ Z+ \ {1}. We assume the claim holds for y = x3 + C for any C ∈ Z+ , and we

demonstrate below F (x, y) > 0 holds also when y = x3 + C + 1.
We have

F (x, x3 + C) = (x3 + C − 1)3 − x2 (x3 + C)[x(x3 + C) − (x3 + C) + 1] > 0
by assumption, and
F (x, x3 + C + 1) = (x3 + C + 1 − 1)3 − x2 (x3 + C + 1)[x(x3 + C + 1) − (x3 + C + 1) + 1].
Notice that if we show B = [F (x, x3 + C + 1) − F (x, x3 + C)] > 0, then we are done.
We have

2
6
5
B = 3C 2 + 4Cx3 + 2Cx
− 4x3} +1.
|
{z− 3C} +x + |2x {z

Notice that both 2Cx2 − 3C > 0 and 2x5 − 4x3 > 0 as x ∈ Z+ \ {1}. So, we have B > 0 and the result
follows.



32

YEŞİM DEMİROĞLU KARABULUT

A PPENDIX B. C OMPUTER C ODE

The computer search was carried out on a supercomputer using a computer program called Sage (ours was
Sage/6.9). The code used to generate Table 1, 2, 3 and the data in Theorem 3.8 is provided below. Inside the
code there are some parts written after the pound sign #. These are just comments for better understanding the code, and these comments are ignored by the computer. Also, note that we provided the original,
indented code below. If you want to use the same code for some calculation, you need to preserve this
indentation.
k=37
def f (n) :

#We define a new function f (n) in the next four lines.

A=[]

#A is an empty list.

for j in FiniteField(n,′ a′ ) :

#FiniteField(n,′ a′ ) is the finite field with order n.

A.append(j ∗ ∗k)
return uniq(A)

#This command adds j k to A.
#uniq(A) removes the same entries of the array A.

def f 2(n) :
A2 = [ ]
for x in f (n) :
for y in f (n) :
A2.append(x + y)
return uniq(A2)

···

#f 2(n) gives the list of the elements in 2Rk .

#Similarly, we have the definition of f X here for every X between 2 and 41.

def f 41(n) :
A41 = [ ]
for x in f 40(n) :
for y in f (n) :
A41.append(x + y)
return uniq(A41)

#f 41(n) gives the list of the elements in 41Rk .

WARING’S PROBLEM IN FINITE RINGS

33

#S will keep the list of the finite fields with order n for n 6 8k4 .

S =[]
for n in range(1, 8k4 + 1) :

if len(prime_divisors(n)) == 1 : #len(prime_divisors(n)) gives the number of distinct prime divisors of n.
S.append(n)

S1 = [ ]

#S1 will keep the list of the finite fields with order n such that |Rk | =
6 n.

for n in S :
if len(f (n))! = n :
S1.append(n)

S2 = [ ]

#S2 will keep the list of the finite fields with order n such that |2Rk | =
6 n.

for n in S1 :
if len(f 2(n))! = n :
S2.append(n)

···

#Similarly, we have the definition of SX here for every X between 2 and 41.

S41 = [ ]

#S41 will keep the list of the finite fields with order n such that |41Rk | =
6 n.

for n in S40 :
if len(f 41(n))! = n :
S41.append(n)

print ′k =′ , k
print ′S1′ ,′ :′ , S1
print ′S2′ ,′ :′ , S2
···

print ′S41′ ,′ :′ , S41

#Similarly, we have the same command for SX here for every X between 2 and 41.

34

YEŞİM DEMİROĞLU KARABULUT

ACKNOWLEDGEMENT

I would like to express my sincere gratitude to my advisers, Professor Jonathan Pakianathan and Professor
David Covert for suggesting this problem. I also thank University of Rochester and the CIRC team for letting
me use their supercomputer. This work was partially supported by NSA grant H98230-15-1-0319.

R EFERENCES
[1] Alperin, Jonathan L. Local representation theory: Modular representations as an introduction to the local representation
theory of finite groups. Vol. 11. Cambridge University Press, 1993.
[2] Barbara, Roy. "91.07 Sums of cubes in finite fields." The Mathematical Gazette 91, no. 520 (2007): 85–87.
[3] Bhaskaran, M. "Sums of m th powers in algebraic and abelian number fields." Archiv der Mathematik 17, no. 6 (1966): 497–
504.
[4] Brouwer, Andries E., and Willem H. Haemers. Spectra of graphs. Springer Science & Business Media, 2011.
[5] Curtis, Charles W., and Irving Reiner. Representation theory of finite groups and associative algebras. Vol. 356. American
Mathematical Soc., 1966.
[6] Farb, Benson, and R. Keith Dennis. Noncommutative algebra. Vol. 144. Springer Science & Business Media, 2012.
[7] Godsil, Chris, and Gordon F. Royle. Algebraic graph theory. Vol. 207. Springer Science & Business Media, 2013.
[8] Hungerford, Thomas W. Algebra. Vol. 73. Springer Science & Business Media, 2003.
[9] Ireland, Kenneth, and Michael Rosen. A classical introduction to modern number theory. Vol. 84. Springer Science & Business
Media, 2013.
[10] Katre, S., and Anuradha Garge. "Matrices over commutative rings as sums of k-th powers." Proceedings of the American
Mathematical Society 141, no. 1 (2013): 103–113.
[11] Robert, Alain M. A course in p-adic analysis. Vol. 198. Springer Science & Business Media, 2013.
[12] Serre, Jean-Pierre. Linear representations of finite groups. Vol. 42. Springer Science & Business Media, 2012.
[13] Small, Charles. "Solution of Waring’s Problem modn." The American Mathematical Monthly 84, no. 5 (1977): 356–359.
[14] Small, Charles. "Sums of powers in large finite fields." Proceedings of the American Mathematical Society 65, no. 1 (1977):
35–36.
[15] Small, Charles. "Waring’s problem." Mathematics Magazine 50, no. 1 (1977): 12–16.
[16] Small, Charles. "Waring’s Problem modn." The American Mathematical Monthly 84, no. 1 (1977): 12–25.
[17] Tornheim, Leonard. "Sums of n-th powers in fields of prime characteristic." Duke Math. J 4 (1938): 359–362.
[18] Vaughan, Robert Ch, and Trevor D. Wooley. "Waring’s problem: a survey." Number theory for the millennium 3 (2002):
301–340.
[19] Weil, André. "Numbers of solutions of equations in finite fields." Bull. Amer. Math. Soc 55, no. 5 (1949): 497–508.
[20] West, Douglas Brent. Introduction to graph theory. Vol. 2. Upper Saddle River: Prentice hall, 2001.
[21] Winterhof, Arne. "On Waring’s problem in finite fields." Acta Arithmetica 87, no. 2 (1998): 171–177.
E-mail address: yesim.demiroglu@rochester.edu

D EPARTMENT OF M ATHEMATICS , U NIVERSITY OF ROCHESTER , ROCHESTER , NY

