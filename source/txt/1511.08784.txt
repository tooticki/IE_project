ON THE NUMBER OF DISTINCT PRIME FACTORS
OF A SUM OF SUPER-POWERS

arXiv:1511.08784v3 [math.NT] 18 Nov 2017

PAOLO LEONETTI AND SALVATORE TRINGALI
Abstract. Given k, ℓ ∈ N+ , let xi,j be, for 1 ≤ i ≤ k and 0 ≤ j ≤ ℓ, some fixed integers, and
P
Q
nj . We prove that the following are equivalent:
define, for every n ∈ N+ , sn := ki=1 ℓj=0 xi,j
(a) There are a real θ > 1 and infinitely many indices n for which the number of distinct
prime factors of sn is greater than the super-logarithm of n to base θ.
Q
(2n)i
(b) There do not exist non-zero integers a0 , b0 , . . . , aℓ , bℓ such that s2n = ℓi=0 ai
and
Q
(2n−1)i
s2n−1 = ℓi=0 bi
for all n.
We will give two different proofs of this result, one based on a theorem of Evertse (yielding,
for a fixed finite set of primes S, an effective bound on the number of non-degenerate solutions
of an S-unit equation in k variables over the rationals) and the other using only elementary
methods.
As a corollary, we find that, for fixed c1 , x1 , . . . , ck , xk ∈ N+ , the number of distinct prime
+
n
factors of c1 xn
1 + · · · + ck xk is bounded, as n ranges over N , if and only if x1 = · · · = xk .

1. Introduction
Given k, ℓ ∈ N+ , let xi,j be, for 1 ≤ i ≤ k and 0 ≤ j ≤ ℓ, some fixed rationals. Then, consider
the Q-valued sequence (sn )n≥1 obtained by taking
sn :=

ℓ
k Y
X

j

xni,j

(1)

i=1 j=0

for every n ∈ N+ (notations and terminology, if not explained, are standard or should be clear
from the context); we refer to sn as a sum of super-powers of degree ℓ. Notice that (sn )n≥1
includes as a special case any Q-valued sequence of general term
ℓi
k Y
X

f

yi,ji,j

(n)

,

(2)

i=1 j=1

where, for each i = 1, . . . , k, we let ℓi ∈ N+ and yi,1 , . . . , y1,ℓi ∈ Q \ {0}, while fi,1 , . . . , fi,ℓi
are polynomials in one variable with integral coefficients. Conversely, sequences of the form (1)
2010 Mathematics Subject Classification. Primary: 11A05, 11A41, 11A51. Secondary: 11R27, 11D99.
Key words and phrases. Integer sequences; number of distinct prime factors; sum of powers; S-unit equations;
super-logarithm and tetration.
P.L. was supported by a PhD scholarship from Università “Luigi Bocconi”, and S.T. by NPRP grant No.
[5-101-1-025] from the Qatar National Research Fund (a member of Qatar Foundation), by the French ANR
Project No. ANR-12-BS01-0011, and by the Austrian FWF Project No. M 1900-N39.

2

P. Leonetti and S. Tringali

can be viewed as sequences of the form (2), the latter being prototypical of scenarios where
polynomials are replaced with more general functions N+ → Z (see also § 4).
Now, let ω(x) denote, for each x ∈ Z \ {0}, the number of distinct prime divisors of x, and
define ω(0) := ∞. Then, for x ∈ Z and y ∈ N+ we set ω(xy −1 ) := ω(δ −1 x) + ω(δ −1 y), where δ
is the greatest common divisor of x and y.
In addition, given n ≥ 2 and θ > 1, we write slogθ (n) for the super-logarithm of n to base
⊗(κ−1)
θ, that is, the largest integer κ ≥ 0 for which θ⊗κ ≤ n, where θ⊗0 := 1 and θ⊗κ := θθ
for
κ ≥ 1; note that slogθ (n) → ∞ as n → ∞.
The main goal of this paper is to provide necessary and sufficient conditions for the boundedness of the sequence (ω(sn ))n≥1 . More precisely, we have:
Theorem 1. The following are equivalent:
(a) There is a base θ > 1 such that ω(sn ) > slogθ (n) for infinitely many n.
(b) lim supn→∞ ω(sn ) = ∞.
Qℓ
(2n)j
and
(c) There do not exist non-zero rationals a0 , b0 , . . . , aℓ , bℓ such that s2n = j=0 aj
Qℓ
(2n−1)j
for all n.
s2n−1 = j=0 bj

We will give two proofs of Theorem 1 in § 2, one based on a theorem of Evertse (yielding,
for a fixed finite set of primes S, an effective bound on the number of non-degenerate solutions
of an S-unit equation in k variables over the rationals), and the other using only elementary
methods: It is, in fact, in the second proof that there lies, we hope, the added value of this work.
Results in the spirit of Theorem 1 have been obtained by various authors in the special case of
Z-valued sequences raising from the solution of non-degenerate linear homogeneous recurrence
equations with (constant) integer coefficients of order ≥ 2, namely, in relation to a sequence
(un )n≥1 of general term
un := αn1 f1 (n) + · · · + αnh fh (n),
(3)
where α1 , . . . , αh are the non-zero (and pairwise distinct) roots of the characteristic polynomial
of the recurrence under consideration, and f1 , . . . , fh are non-zero polynomials in one variable
with coefficients in the smallest field extension of the rational field containing α1 , . . . , αh , see [9,
Theorem C.1]. (A recurrence is non-degenerate if its characteristic polynomial has at least two
distinct non-zero complex roots and the ratio of any two distinct non-zero characteristic roots
is not a root of unity.) More specifically, it was shown by van der Poorten and Schlickewei [14]
and, independently, by Evertse [4, Corollary 3], using Schlickewei’s p-adic analogue of Schmidt’s
Subspace Theorem [7], that the greatest prime factor of un tends to ∞ as n → ∞.
In a similar note, effective lower bounds on the greatest prime divisor and on the greatest
square-free factor of a sequence of type (3) were obtained under mild assumptions by Shparlinski
[10] and Stewart [11–13], based on variants of Baker’s theorem on linear forms in the logarithms
of algebraic numbers [2]. Further results in the same spirit can be found in [3, § 6.2].
On the other hand, Luca has shown in [6] that if (vn )n≥1 is a sequence of rational numbers
satisfying a recurrence of the form
g0 (n)vn+2 + g1 (n)vn+1 + g2 (n)vn = 0,

for all n ∈ N+ ,

Distinct prime factors of a sum of super-powers

3

where g0 , g1 and g2 are univariate polynomials over the rational field and not all zero, and
(vn )n≥n0 is not binary recurrent (viz., a solution of a linear homogeneous second-order recurrence
equation with integer coefficients) for some n0 ∈ N+ , then there exists a real constant c > 0 such
that the product of the numerators and denominators (in the reduced fraction) of the non-zero
rational terms of the finite sequence (vi )1≤i≤n has at least c log n prime factors as n → ∞.
Lastly, it seems worth noting that Theorem 1 can be significantly improved in special cases.
E.g., given a, b ∈ N+ with a 6= b, we have by Zsigmondy’s theorem [15] that ω(n) ≥ d(n) − 2
for all n, where d(n) is the number of (positive integer) divisors of n. Now, it is known, e.g.,
Pn
from [8] that n1 i=1 d(i) is asymptotic to log n as n → ∞. So, it follows that there exist a
constant c ∈ R+ and infinitely many n for which ω(an − bn ) > c log n.
Corollary 2. The sequence (ω(sn ))n≥1 is bounded if and only if there exist non-zero rationals
Qℓ
Qℓ
(2n−1)j
(2n)j
for all n.
and s2n−1 = j=0 bj
a0 , b0 , . . . , aℓ , bℓ such that s2n = j=0 aj

Corollary 3. Let c1 , . . . , ck ∈ Q+ and x1 , . . . , xk ∈ Q \ {0}. Then, (ω(c1 xn1 + · · · + ck xnk ))n≥1
is a bounded sequence only if |x1 | = · · · = |xk |, and this condition is also sufficient provided that
Pk
−1
is the sign of xi .
i=1 εi ci 6= 0, where, for each i ∈ J1, kK, εi := xi · |xi |
The proof of Corollary 3 is postponed to § 3, while Corollary 2 is trivial by Theorem 1.

Notations. We reserve the letters h, i, j, and κ (with or without subscripts) for non-negative
integers, the letters m and n for positive integers, the letters p and q for (positive rational)
primes, and the letters A, B, and θ for real numbers. We denote by P the set of all (positive
rational) primes and by υp (x), for p ∈ P and a non-zero x ∈ Z, the p-adic valuation of x, viz.,
the exponent of the largest power of p dividing x. Given X ⊆ R, we take X + := X ∩ ]0, ∞[.
Further notations, if not explained, are standard or should be clear from the context.
2. Proof of Theorem 1
The implications (a) ⇒ (b) and (b) ⇒ (c) are straightforward, and (c) ⇒ (a) is trivial if at
least one of the sequences (s2n )n≥1 and (s2n−1 )n≥1 is eventually zero.
Therefore, we can just focus on the two cases below, in each of which we have to prove that
there exists a base θ > 1 such that ω(sn ) > slogθ (n) for infinitely many n.
Qℓ
(2n)j
for all n. Then k ≥ 2,
Case (i): There do not exist a0 , . . . , aℓ ∈ Q such that s2n = j=0 aj
sn 6= 0 for infinitely many n, and |xi,j | 6= 1 for some (i, j) ∈ J1, kK × J1, ℓK (otherwise we would
Pk
have s2n = i=1 xi,0 , a contradiction).
Without loss of generality, we can suppose that xi,j 6= 0 for all (i, j) ∈ J1, kK×J0, ℓK (otherwise
we end up with a sum of super-powers with fewer than k summands), and actually that xi,j > 0
Qℓ
Qℓ
j
(2n)j
for j 6= 0: This is because j=0 xi,j
= xi,0 · j=1 |xi,j |(2n) for all n, and, insofar as we
deal with Case (i), we can replace (sn )n≥1 with the subsequence (s2n )n≥1 , after noticing that
ω(s2n ) > slogθ (n), for some θ > 1, only if ω(s2n ) > slog2θ (2n), which is easily proved by
induction (we omit details). Accordingly, we may also assume
(x1,1 , . . . , x1,ℓ ) ≺ · · · ≺ (xk,1 , . . . , xk,ℓ ),

(4)

4

P. Leonetti and S. Tringali

where ≺ denotes the binary relation on Rℓ defined by taking (u1 , . . . , uℓ ) ≺ (v1 , . . . , vℓ ) if and
only if |ui | < |vi | for some i ∈ J1, ℓK and |uj | = |vj | for i < j ≤ ℓ (the ℓ-tuples (xi,1 , . . . , xi,ℓ )
cannot be equal to each other for all i ∈ J1, kK, and on the other hand, if two of these tuples are
equal, then we can add up some terms in (1) so as to obtain a sum of super-powers of degree ℓ,
but again with fewer summands). It follows by (4) that there exists N ∈ N+ such that
ℓ
XY

j

xni,j 6= 0,

for all n ≥ N and ∅ 6= I ⊆ J1, kK.

(5)

i∈I j=0

Now, for each (i, j) ∈ J1, kK × J0, ℓK pick αi,j , βi,j ∈ Z such that αi,j > 0 and xi,j = α−1
i,j βi,j , and
consequently set x̃i,j := αj xi,j , where αj := α1,j · · · αk,j ; note that x̃i,j is a non-zero integer, and
Pk Qℓ
Qℓ
j
j
x̃i,j > 0 for j 6= 0. Then, let un := i=1 j=0 x̃ni,j and vn := j=0 αjn , so that sn = un vn−1 .
Clearly, (un )n≥1 and (vn )n≥1 are integer sequences, and (x̃i,1 , . . . , x̃i,ℓ ) ≺ (x̃j,1 , . . . , x̃j,ℓ ) for
1 ≤ i < j ≤ k. Moreover, ω(sn ) ≥ ω(un ) − ω(vn ) = ω(un ) − ω(v1 ) for all n. This shows that
it is sufficient to prove the existence of a base θ > 1 such that ω(un ) > slogθ (n) for infinitely
many n, and it entails, along with the rest, that we can further assume that xi,j is a non-zero
integer for every (i, j) ∈ J1, kK × J0, ℓK.
We claim that it is also enough to assume δ0 = · · · = δℓ = 1, where for each j ∈ J0, ℓK we
let δj := gcd(x1,j , . . . , xk,j ). In fact, define, for 1 ≤ i ≤ k and 0 ≤ j ≤ ℓ, ξi,j := δj−1 xi,j , and
Q
P
Q
j
nj
let (wn )n≥1 and (s̃n )n≥1 be the integer sequences of general term ℓj=0 δjn and ki=1 ℓj=0 ξi,j
,
respectively. Then sn = wn s̃n , and hence ω(sn ) ≥ ω(s̃n ). On the other hand, there cannot exist
Qℓ
Qℓ
j
(2n)j
for all n, or else we would have s2n = j=0 (δj ãj )(2n)
ã0 , . . . , ãℓ ∈ Z such that s̃2n = j=0 ãj
for every n (which is impossible). This leads to the claim.
Qk Qℓ
With the above in mind, let P be the set of all (positive) prime divisors of z := i=1 j=1 xi,j ;
observe that P is finite and non-empty, as the preceding considerations yield |z| ≥ 2. Then


k
X
Y (i)
xi,0
sn =
pep (n) , for every n ∈ N+ ,
(6)
i=1

p∈P

P
(i)
where ep denotes, for all p ∈ P and i ∈ J1, kK, the function N+ → N : n 7→ ℓj=1 nj υp (xi,j ).
Since δ0 = · · · = δℓ = 1, it is easily seen that for every p ∈ P there are i, j ∈ J1, kK for which
(i )
(i)
(j)
(i)
ep 6= ep , and there exist ip ∈ J1, kK and np ≥ N such that ep p (n) < ep (n) for all n ≥ np and
(i )
(i)
i ∈ J1, kK for which ep 6= ep p . Let nP := maxp∈P np (recall that P is a non-empty finite set),
(i )
(i)
(i)
and for each p ∈ P and i ∈ J1, kK define ∆ep := ep − ep p . Then set


k
Y
Y (ip )
X
(i)
xi,0
(7)
p∆ep (n) .
πn :=
pep (n) and σn :=
p∈P

i=1

p∈P

We have |sn | = πn · |σn |, and we obtain from (5) that σn ∈ Z \ {0} for n ≥ nP . Furthermore,
having assumed xi,j > 0 for all (i, j) ∈ J1, kK × J1, ℓK implies, together with (4) and (6), that
nj
ℓ 
Y
Y (k)
(i)
xk,j
ep (n)−ep
(n)
p
= lim
lim
= ∞, for each i ∈ J1, k − 1K.
(8)
n→∞
n→∞
xi,j
j=1
p∈P

5

Distinct prime factors of a sum of super-powers
Consequently, we find that
|sn | ∼ |xk,0 | ·

ℓ
Y

j

xnk,j = |xk,0 | ·

j=1

and
|σn | =

Y

(k)

pep

(n)

,

as n → ∞

(9)

p∈P

Y
(k)
|sn |
∼ |xk,0 | ·
p∆ep (n) ,
πn

as n → ∞.

(10)

p∈P

We want to show that the sequence (|σn |)n≥1 is eventually (strictly) increasing.
(k)

Lemma 1. There exists p ∈ P such that ∆ep (n) → ∞ as n → ∞.
(i )

(k)

(k)

Proof. Suppose the contrary is true. Then, for each p ∈ P we have ep = ep p , since ∆ep (n)
(k)
(k)
is basically a polynomial with integral coefficients in the variable n and ∆ep (n) = ep (n) −
(i )
ep p (n) ≥ 0 for n ≥ nP . Therefore, we get from (8) that
Y (ip )
Y (i)
Y (k)
Y (ip )
pep (n) ≤
pep (n) ≤
pep (n) =
pep (n)
p∈P

p∈P

p∈P

p∈P

(i)

(i )

for all n ≥ nP and i ∈ J1, kK. But this is impossible, as it implies that ep = ep p for all p ∈ P
(ip )
Q
and i ∈ J1, kK, and hence, in view of (6), sn = (x1,0 + · · · + xk,0 ) · p∈P pep (n) for all n.


Now, let A := 2z2 (this is just a convenient value for A: We make no effort to try to optimize
(k)
it, and the same is true for other constants later on). Since ∆ep is eventually non-decreasing
(k)
(k)
for every p ∈ P (recall that ∆ep is a polynomial function and ∆ep (n) ≥ 0 for all large n), we
obtain from (5), (9), (10), and Lemma 1 that there exists n0 ≥ max(2, nP ) such that
ℓ

σn2 ≤ sn2 < An

and 0 6= |σn | < |σn+1 |,

for n ≥ n0 .

(11)

From here on, the proof of Case (i) splits, as we present two different approaches that can be
used to finish it, the first of them relying on a theorem of Evertse from [5], and the second using
only elementary methods (as anticipated in the introduction).
1st Approach: Let y := z ·
following:

Qk

i=1

|xi,0 | and B := max(nℓ0 , (235 k 2 )2k

3

yℓ log A

). We will need the

Lemma 2. There is a sequence (rκ )κ≥0 of integers ≥ n0 such that rκℓ ≤ B ⊗(κ+1) and ω(srκ ) ≥ κ
for every κ ∈ N.
Proof. Set r0 := n0 , fix κ ∈ N+ , and suppose we have already found an integer rκ−1 ≥ n0 such
ℓ
that rκ−1
≤ B ⊗κ and ω(srκ−1 ) ≥ κ − 1: Notice how these conditions are trivially satisfied for
κ = 1, because r0ℓ = n0ℓ ≤ B = B ⊗1 and ω(x) ≥ 0 for all x ∈ Z.
Accordingly, denote by Sκ the set of prime divisors of y·srκ−1 , and for all n ≥ n0 and i ∈ J1, kK
Qℓ
nj
let Xi (n) := s−1
n ·
j=0 xi,j (note that these quantities are well defined, since we have by (5)
that sn 6= 0 for n ≥ n0 ). A few remarks are in order.
Firstly, it is easy to check that, for every n ≥ n0 , the k-tuple Xn := (X1 (n), . . . , Xk (n)) ∈ Qk
is a solution to the following equation (over the additive group of the rational field):
Y1 + · · · + Yk = 1,

(12)

6

P. Leonetti and S. Tringali

and we derive from (5) that it is actually a non-degenerate solution, where a solution (Y1 , . . . , Yk )
P
of (12) is called non-degenerate if i∈I Yi 6= 0 for every non-empty I ⊆ J1, kK.
Secondly, it is plain from our definitions that Xm = Xn , for some m, n ≥ n0 , only if
υp (Xi (m)) = υp (Xi (n)),

for all p ∈ P and i ∈ J1, kK,

(13)

and we want to show that this, in turn, is possible only if |σm | = |σn |.
Qℓ
j
Indeed, let p ∈ P and n ≥ n0 . By construction, the p-adic valuation of j=1 xnip ,j is equal to
(i )

(i )

ep p (n), with ep p (n) being zero if p ∈
/ P. Thus, we obtain from (7) that

υp (Xip (n)) = υp (xip ,0 ) + ep(ip ) (n) − υp (sn ) = vp (xip ,0 ) − υp (σn ).
It follows that, for m, n ≥ n0 , (13) holds true only if υp (σm ) = υp (σn ) for all p ∈ P, which is
equivalent to |σm | = |σn |. Accordingly, we conclude from (11) and the above that, for m, n ≥ n0
and m 6= n, Xm and Xn are distinct non-degenerate solutions of (12).
Thirdly, let Nκ be the number of non-degenerate solutions (Y1 , . . . , Yk ) to (12) for which each
Yi is an Sκ -unit (i.e., lies in the subgroup of the multiplicative group of Q generated by Sκ ).
3
We obtain from [5, Theorem 3] that Nκ ≤ (235 k 2 )k gκ , where
(11)

ℓ
ℓ
gκ := |Sκ | ≤ ω(y) + ω(srκ−1 ) ≤ y + log |srκ−1 | ≤ y + rκ−1
log A ≤ y · rκ−1
log A.
ℓ
Using that rκ−1
≤ B ⊗κ (by the inductive hypothesis), we thus conclude that
⊗κ 3

⊗κ

Nκ ≤ (235 k 2 )B k y log A ≤ B B /(2ℓ) .
(14)
Q
With this in hand, define ℘ := p | sr (p − 1) and let (th )h≥0 be the subsequence of (sn )n≥1 of
κ−1
general term th := sh℘+rκ−1 . We know from the above that there exists hκ ∈ J0, Nκ K such that
thκ is not an Sκ -unit (note that h℘ + rκ−1 ≥ rκ−1 ≥ n0 for all h), with the result that at least
one prime divisor of thκ does not divide srκ−1 . On the other hand, a straightforward application
of Fermat’s little theorem shows that p | thκ for every p ∈ P such that p | srκ−1 . So, putting it
all together, we find ω(srκ ) ≥ 1 + ω(srκ−1 ) ≥ κ, where
(11)

ℓ

ℓ

rκ := hκ ℘ + rκ−1 ≤ Nκ srκ−1 + rκ−1 ≤ Nκ srκ−1 rκ−1 ≤ Arκ−1 Nκ rκ−1 ≤ A2rκ−1 Nκ
(14)

ℓ

≤ A2rκ−1 B B

⊗κ

/(2ℓ)

≤ A2B

⊗κ

BB

⊗κ

/(2ℓ)

≤ BB

⊗κ

/(2ℓ)

BB

⊗κ

/(2ℓ)

ℓ
(recall from the above that rκ−1
≤ B ⊗κ ). This completes the induction step (and hence the
⊗κ
3
proof of the lemma), since it implies rκℓ ≤ B 4 B B ⊗κ ≤ B ⊗(κ+1) .


So to conclude, let (rκ )κ≥0 be the sequence of Lemma 2 and take θ := B ⊗3 . Then θ > 1 and
ω(srκ ) ≥ κ > slogθ (rκ ) for all κ ∈ N+ , because rκ ≤ rκℓ ≤ B ⊗(κ+1) .
2nd Approach: Denote by Qn the set of all prime divisors of σn and let Q⋆n := Qn \ P. It is
clear that Qn is finite for n ≥ n0 (recall that σn 6= 0 for n ≥ nP ). Thus, let
λ := max υp (σn0 ) + max max ∆e(i)
p (n0 ),
p∈P

p∈P 1≤i≤k

7

Distinct prime factors of a sum of super-powers
and then
α := k · max |xi,0 | ·
1≤i≤k

Y

pλ ,

Y

β :=

p∈P

pα−1 (p − 1),

and B := A2 β.

p∈P

Lastly, suppose that, for a fixed κ ∈ N, we have already found r0 , . . . , rκ ∈ N+ with n0 ≤ r0 ≤
Q
· · · ≤ rκ , and define βκ := β · p∈Q⋆r pυp (σrκ ) (p − 1).
κ
By taking r0 := n0 and rκ+1 := βκ + rκ , we obtain an increasing sequence (rκ )κ≥0 of integers
≥ n0 with the property that, however we choose a prime p ∈ P and an index i ∈ J1, kK,
(i)
α−1
∆e(i)
(q − 1),
p (rκ+1 ) ≡ ∆ep (rκ ) mod q

for all q ∈ P

(15)

for all q ∈ Q⋆rκ ,

(16)

and
(i)
υq (σrκ )
∆e(i)
(q − 1),
p (rκ+1 ) ≡ ∆ep (rκ ) mod q
(i)

where we use that ∆ep is essentially a polynomial with integral coefficients, and rκ+1 ≡ rκ mod
m whenever m | βκ . In particular, (15) and a routine induction imply
(i)
α−1
∆e(i)
(q − 1),
p (rκ ) ≡ ∆ep (n0 ) mod q

for all p, q ∈ P, i ∈ J1, kK, and κ ∈ N.

(17)

Also, since rκ ≥ n0 , there exists B > A such that, for all κ,
Y
ℓ
ℓ (11)
ℓ
rκ+1 ≤ rκ + β ·
pυp (σrκ ) (p − 1) ≤ rκ + β σr2κ < rκ + βArκ ≤ βrκ Arκ < B rκ .

(18)

p∈Qrκ

Based on these premises, we prove a series of three lemmas. To ease notation, we denote by Ip ,
(i )
(i)
for each p ∈ P, the set of all i ∈ J1, kK such that ep 6= ep p , and we let Ip⋆ := J1, kK \ Ip .
Lemma 3. Qrκ ⊆ Qrκ+1 for every κ.
(i)

(i)

Proof. Pick κ ∈ N and q ∈ Qrκ . If i ∈ Ip , then ∆ep (n) = 0 for all n, and hence p∆ep (n) = 1.
(i)
If, on the other hand, i ∈ Ip⋆ , then ∆ep (n) > 0 for n ≥ nP , and we conclude from Fermat’s little
(i)

(i)

(i)

theorem that p∆ep (n) ≡ 0 mod q if q = p, and p∆ep (n) ≡ pm mod q if p 6= q and ∆ep (n) ≡
m mod (q − 1). So we get from (15), (16), and rκ+1 > rκ ≥ n0 > nP that
(i)

p∆ep

(rκ+1 )

(i)

≡ p∆ep

(rκ )

mod q,

for all p ∈ P and i ∈ J1, kK,

which in turn implies




k
k
X
Y
X
Y
(i)
(i)
xi,0
xi,0
p∆ep (rκ+1 )  ≡
σrκ+1 ≡
p∆ep (rκ )  ≡ σrκ ≡ 0 mod q.
i=1

p∈P

i=1

p∈P

This finishes the proof, since κ ∈ N and q ∈ Qrκ were arbitrary.



Lemma 4. Let q ∈ P and κ ∈ N. Then υq (σrκ ) ≤ α − 1.
Proof. The claim is straightforward if κ = 0, since r0 = n0 and υq (σn0 ) ≤ λ < α. So assume for
the rest of the proof that κ ≥ 1. Then, we have from (7) that




X
X
Y
Y
(i)
(i)
xi,0
xi,0
σn =
(19)
p∆ep (n)  +
p∆ep (n) , for all n.
i∈Iq

p∈P

i∈Iq⋆

q6=p∈P

8

P. Leonetti and S. Tringali

If i ∈ Iq , n > n0 and n ≡ n0 mod β, then q α divides
(i)

(i)

Q

(i)

p∈P

p∆ep

(n)

(i)

, because n | ∆ep (n) and

∆ep (n) 6= 0, hence α < β < β + n0 ≤ n ≤ ∆ep (n).
On the other hand, it is seen by induction that rκ ≡ n0 mod β (recall that rκ ≡ rκ−1 mod β).
Thus, we get from the above, equations (19) and (17), [1, Theorem 2.5(a)], and Euler’s totient
theorem that




X
X
Y
Y
(i)
(i)
xi,0
xi,0
(20)
σrκ ≡
p∆ep (rκ )  ≡
p∆ep (n0 )  mod q α .
i∈Iq⋆

i∈Iq⋆

q6=p∈P

q6=p∈P

But ∅ 6= Iq⋆ ⊆ J1, kK, so it follows from (5) that
 



 


ℓ
X
Y

 1 XY

j
(i)
(n
)
0
∆ep (n0 ) 




xi,j  = 
0<
xi,0
p

π
  ⋆
 n0

⋆ j=0
i∈Iq

i∈Iq

≤ max |xi,0 | ·
1≤i≤k

X Y

p

q6=p∈P

(i)
∆ep
(n0 )

≤ k · max |xi,0 | ·
1≤i≤k

i∈Iq⋆ q6=p∈P

Y

pλ = α < q α ,

p∈P

which, together with (20), yields υq (σrκ ) < α.



Lemma 5. Let κ ∈ N+ and q ∈ Qrκ . Then υq (σrκ ) = υq (σrκ+1 ).
Proof. If q ∈
/ P, then we infer from (7) and (16), [1, Theorem 2.5(a)], and Euler’s totient theorem
that σrκ+1 ≡ σrκ mod q υq (σrκ )+1 , and we are done.
If, on the other hand, q ∈ P, then we get from Lemma 4 that υq (σr1 ) ≤ α − 1, which, along

with (20), gives σrκ ≡ σr1 mod q υq (σr1 )+1 , and consequently υq (σrκ ) = υq (σr1 ).
At this point, since (|σn |)n≥n0 is an increasing sequence by (11) and rκ ≥ n0 for all κ ∈ N+ ,
we see from Lemmas 3-5 that ∅ 6= Qrκ ( Qrκ+1 , and hence ω(σrκ ) < ω(σrκ+1 ). By induction,
this implies ω(σrκ ) ≥ κ for every κ.
On the other hand, if we let θ := max(B ℓ ℓ, r1ℓ ), then we get from (18) and another induction
that rκℓ < θ⊗κ for all κ ∈ N+ , which, together with the above considerations, leads to ω(σrκ ) ≥
κ > slogθ (rκ ) and the desired conclusion.
Case (ii): There do not exist b0 , . . . , bℓ ∈ Q such that s2n−1 =
we are reduced to Case (i) by taking
yi,j :=

ℓ
Y

(−1)h−j (h
j)

xi,h

,

(2n−1)j
j=0 bj

Qℓ

for all n. Then,

for 1 ≤ i ≤ k and 0 ≤ j ≤ ℓ,

h=j

and by noting that for every n ∈ N+ we have s2n−1 = t2n , where (tn )n≥1 is the integer sequence
Pk Q ℓ
nj
of general term i=1 j=0 yi,j
(we omit further details).
3. Proof of Corollary 3
Suppose for a contradiction that there are c1 , . . . , ck ∈ Q+ and x1 , . . . , xk ∈ Q \ {0} such
Pk
that |xi | 6= |xj | for some i, j ∈ J1, kK and (ω(un ))n≥1 is bounded, where un := i=1 ci xni for all
n, and let k the minimal positive integer for which this is pretended to be true.

Distinct prime factors of a sum of super-powers

9

Then k ≥ 2, and we can assume that |x1 | ≤ · · · ≤ |xk | 6= |x1 |. Furthermore, we get from
Theorem 1 that there must exist c, x ∈ Q+ such that u2n = cx2n . So now, we have two cases,
each of which will lead to a contradiction (the rest is trivial and we may omit details):
Pk
Case (i): x ≤ |xk |. We have cy 2n = i=1 ci yi2n for all n, where yi := |xi | · |xk |−1 for 1 ≤ i ≤ k
and y := x · |xk |−1 . Let h be the maximal index in J2, kK such that yh−1 < yk , which exists
because y1 < yk . Since 0 < y ≤ 1 and 0 < yi < 1 for 1 ≤ i < h, we find that
c · lim y 2n = ch + · · · + ck ,
n→∞

which can happen only if y = 1, as ch , . . . , ck > 0. But then c = c1 + · · · + ck , and consequently
Ph−1
2n
i=1 ci yi = 0 for all n, which is impossible, because h ≥ 2 and c1 , . . . , ch−1 > 0.
Pk
Case (ii): x > |xk |. Then c = i=1 ci zi2n for all n, where zi := |xi | · x−1 for 1 ≤ i ≤ k. But
P
this is still impossible, since z1 , . . . , zk ∈ ]0, 1[, and hence ki=1 ci zi2n → 0 as n → ∞.
4. Closing remarks

Let τ be an increasing function from N+ into itself. What can be said about the behavior
of ω(sτ (n) ) as n → ∞? And what about the asymptotic growth of the average of the function
R+ → N : x 7→ #{n ≤ x : ω(sτ (n) ) ≥ h} for a fixed h ∈ N+ ?
In this paper, we have answered the first question in the case where τ is the identity or, more
in general, a polynomial function (by the considerations made in the introduction). It could be
interesting as a next step to look at the case where τ is a geometric progression, which however
may be hard, when taking into account that it is a longstanding open problem to decide whether
n
there are infinitely many composite Fermat numbers (that is, numbers of the form 22 + 1).
On the other hand, the basic question addressed in the present manuscript has the following
algebraic generalization: Given a unique factorization domain D, let αi,j be, for 1 ≤ i ≤ k
and 0 ≤ j ≤ ℓ, some fixed elements in D, and for x ∈ D let ωD (x) denote the number of
non-associate primes dividing x. What can be said about the sequence (An )n≥1 of general term
Pk Qℓ
nj
j=0 αi,j if the sequence (ωD (An ))n≥1 is bounded? Does anything along the lines of
i=1
Theorem 1 hold true?
Acknowledgements
The authors are grateful to Carlo Sanna (Università di Torino, IT) for useful comments.
Moreover, they are greatly indebted to an anonymous referee for outlining a proof of Lemma
2 in the case when the numbers xi,j are positive, and most notably for explaining how to
use [5, Theorem 3] to bound, in the notations of the same proof, the number of non-degenerate
Sκ -unit solutions of equation (12), which is the key step in the first approach (“Approach 1”) to
the proof of Theorem 1.
References
[1] T. M. Apostol, Introduction to Analytic Number Theory, Undergrad. Texts Math., Springer-Verlag: New
York, 1976.

10

P. Leonetti and S. Tringali

[2] A. Baker and G. Wüstholz, Logarithmic forms and Diophantine geometry, New Mathematical Monographs
9, Cambridge University Press: Cambridge, 2007.
[3] G. Everest, A. van der Poorten, I. Shparlinski, and T. Ward, Recurrence Sequences, Math. Surveys Monogr.
104, Amer. Math. Soc.: Providence (RI), 2003.
[4] J.-H. Evertse, On sums of S-units and linear recurrences, Compositio Math. 53 (1984), No. 2, 225–244.
[5]
, The number of solutions of decomposable form equations, Invent. Math. 122 (1995), No. 3, 559–601.
[6] F. Luca, Prime divisors of binary holonomic sequences, Adv. Appl. Math. 40 (2008), No. 2, 168–179.
[7] H. P. Schlickewei, Linearformen mit algebraischen Koeffizienten, Manuscripta Math. 18 (1976), 147–185.
[8] R. A. Smith and M. V. Subbarao, The average number of divisors in an arithmetic progression, Canad.
Math. Bull. 24 (1981), No. 1, 37–41.
[9] T. N. Shorey and R. Tijdeman, Exponential Diophantine Equations, Cambridge Tracts in Mathematics 87,
Cambridge Univ. Press: Cambridge, 1986.
[10] I. E. Shparlinski, Prime divisors of recurrent sequences, Isv. Vyssh. Uchebn. Zaved. Math. 215 (1980),
101–103.
[11] C. L. Stewart, On divisors of terms of linear recurrence sequences, J. reine angew. Math. 333 (1982), 12–31.
[12]
[13]

, On the greatest prime factor of terms of a linear recurrence sequence, Rocky Mountain J. Math.
15 (1985), No. 2, 599–608.
, “On Prime Factors of Terms of Linear Recurrence Sequences”, pp. 341–359 in J. M. Borwein,
I. Shparlinski, and W. Zudilin (eds.), Number Theory and Related Fields. In Memory of Alf van der Poorten,
Springer Proc. Math. Stat. 43, Springer: New York, 2013.

[14] A. J. van der Poorten and H. P. Schlickewei, The growth conditions for recurrence sequences, Macquarie
Math. Reports 82-0041 (1982).
[15] K. Zsigmondy, Zur Theorie der Potenzreste, Monatsh. Math. 3 (1892), 265–284.
Department of Decision Sciences, Università L. Bocconi, via Roentgen 1, 20136 Milano, Italy
E-mail address: leonetti.paolo@gmail.com
URL: https://sites.google.com/site/leonettipaolo/
Department of Mathematics, Texas A&M University at Qatar, PO Box 23874 Doha, Qatar
Current address: Institute for Mathematics and Scientific Computing, University of Graz, NAWI Graz |
Heinrichstr. 36, 8010 Graz, Austria
E-mail address: salvatore.tringali@uni-graz.at
URL: http://imsc.uni-graz.at/tringali

