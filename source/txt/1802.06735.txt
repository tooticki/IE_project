arXiv:1802.06735v5 [math.AC] 17 May 2018

WHEN ARE PERMUTATION INVARIANTS COHEN-MACAULAY OVER ALL
FIELDS?
BEN BLUM-SMITH AND SOPHIE MARQUES

Abstract. We prove that the polynomial invariants of a permutation group are Cohen-Macaulay
for any choice of coefficient field if and only if the group is generated by transpositions, double
transpositions, and 3-cycles. This unites and generalizes several previously known results. The “if”
direction of the argument uses Stanley-Reisner theory and a recent result of Christian Lange in
orbifold theory. The “only-if” direction uses a local-global result based on a theorem of Raynaud to
reduce the problem to an analysis of inertia groups, and a combinatorial argument to identify inertia
groups that obstruct Cohen-Macaulayness.

1. Introduction
The invariant ring of a graded action by a finite group G on a polynomial ring
krxs “ krx1 , . . . , xn s
over a field k is well-behaved when the field characteristic is prime to the group order. For
example, it is generated in degree ď |G| (Noether’s bound), and it is a Cohen-Macaulay ring
(the Hochster-Eagon theorem).
When the characteristic divides the group order (the modular case), the situation is much
more mysterious. Both of these statements (and many others) can, but do not always, fail.
The question of when such pathologies arise has attracted research attention over the last few
decades.
In this article we focus on Cohen-Macaulayness. Let krxsG be the invariant ring and let
p “ char k
be the field characteristic. We interpret krxs as the coordinate ring of Ank , so that the action
of G on krxs is induced from an action on Ank by automorphisms. Because the action on krxs
is graded, the corresponding action on Ank is linear, i.e. it arises from a linear representation
of G on a k-vector space. Here is a sampling of known results:
— In 1980, Ellingsrud and Skjelbred ([8]) showed that if G is cyclic of order pm , then
krxsG is not Cohen-Macaulay unless G fixes a subspace of Ank of codimension ď 2.
— In 1996, Larry Smith ([33]) showed that if n “ 3, then krxsG is Cohen-Macaulay. (This
was priorly known to hold for n ď 2.)
— In 1999, Campbell et al ([4]) showed that if G is a p-group, and if the action of G
on Ank is the sum of three copies of the same linear representation, then krxsG is not
Cohen-Macaulay.
— Also in 1999, Gregor Kemper ([19]) showed that if G is a p-group and krxsG is CohenMacaulay, then G is necessarily generated by elements g whose fixed-point sets in Ank
have codimension ď 2, generalizing [8] beyond cyclic groups and [4] beyond three-copies
representations.
1

2

BEN BLUM-SMITH AND SOPHIE MARQUES

See [21] for a more detailed overview.
A theme uniting these results is that generation of G by elements fixing codimension ď 2
subspaces is related to good behavior of krxsG . Further variations on this theme are found in
[5], [11], [18], and [25]. The main goal of this paper is a result of this kind for permutation
groups G Ă Sn , acting on krxs by permuting the xi ’s. The result characterizes permutation
groups generated in this way, and is not restricted to p-groups.
Permutation groups have the feature that the definition of the action is insensitive to the
choice of a ground field k. Thus it is natural to ask:
Question 1.1. For which G Ă Sn is krxsG Cohen-Macaulay regardless of k?
An additional motivation for this question is that krxsG is Cohen-Macaulay for every choice
of k if and only if ZrxsG is free as a module over the subring ZrxsSn of symmetric polynomials,
and also if and only if ArxsG is Cohen-Macaulay for every Cohen-Macaulay ring A. (We will
not develop these equivalences here, but see [1, §2.4.1] where the first is worked out in detail,
and [3, Exercise 5.1.25] for a sketch of the second in a slightly different setting.)
In [20], Kemper gave an if-and-only-if criterion that determines Cohen-Macaulayness of a
permutation invariant ring when p divides |G| exactly once. This criterion allows to determine
Cohen-Macaulayness for many specific groups and primes, but does not in general answer
question 1.1 because few permutation groups have squarefree order. Some special cases of
question 1.1 are known:
— If G is a Young subgroup (i.e. a product of symmetric groups acting on disjoint sets),
then krxsG is a polynomial algebra over k, so it is Cohen-Macaulay regardless of k.
— It follows from the result of Kemper ([19]) quoted above that if G is a p-group, then
krxsG cannot be Cohen-Macaulay over all fields unless G is generated by transpositions
and double transpositions, or 3-cycles (and p “ 2 or 3).
— Kemper also showed in ([19]) that if G Ă Sn is regular (i.e. its action on
rns “ t1, . . . , nu
krxsG

is free and transitive), then
is Cohen-Macaulay over every k if it is isomorphic to
C2 , C3 , or C2 ˆC2 , but not otherwise. (In fact, in other cases, it is not Cohen-Macaulay
for any k with char k dividing |G|.)
— Victor Reiner ([29], [15]) has shown that An , and the diagonally embedded Sn ãÑ
Sn ˆ Sn Ă S2n , have invariant rings that are Cohen-Macaulay regardless of the field.
(These are the Sn -cases of results he found for all finite Coxeter groups.) Patricia
Hersh ([14], [15]) has shown the same for the wreath product S2 ≀ Sn Ă S2n .
Our main objective in this article is to answer question 1.1 completely. We will prove the
following theorem, which unites all of these cases and ties them into the theme mentioned
above.
Theorem 1.2. Let G Ă Sn . The ring krxsG is Cohen-Macaulay for all choices of k if and only
if G is generated by transpositions, double transpositions, and 3-cycles.
Let N be the subgroup of G generated by transpositions, double transpositions, and 3cycles. The “if” direction of theorem 1.2, together with the Hochster-Eagon theorem ([16,
Proposition 13]), imply that the characteristics p in which krxsG fails to be Cohen-Macaulay
must be among those that divide rG : Ns. This implication will be discussed in more detail in
the conclusion (§5). The “only-if” direction implies that if rG : Ns ą 1, then there is at least
one such characteristic p. This p is explicitly constructed in the course of the proof.

WHEN ARE PERMUTATION INVARIANTS COHEN-MACAULAY OVER ALL FIELDS?

3

The proof of this theorem is methodologically eclectic. The “if” direction uses StanleyReisner theory, which relates Cohen-Macaulayness of krxsG to the topology of the quotient of
a ball by G, and a recent result in orbifold theory by Christian Lange ([22]) that characterizes
the groups G such that this quotient is a piecewise-linear ball. The “only-if” direction is
much more algebraic. It is based on a local-global result (theorem 3.1) reducing the CohenMacaulayness of a noetherian invariant ring to that of the invariant rings of its inertia groups
acting on strict localizations.
Though theorem 1.2 is specific to the situation of a polynomial ring krxs and a permutation
group G, a substantial portion of our method for the “only-if” direction applies in considerably
more generality. Section 2.3 concerns arbitrary commutative, unital rings, and the localglobal result just mentioned only assumes that the invariant ring is noetherian. (Other work
on Cohen-Macaulayness of invariants at the generality of noetherian rings includes [11] and
[25].) A secondary goal of this paper is to develop these general tools, which we expect have
broader applicability. The fact that Cohen-Macaulayness depends fully on the local action of
the inertia groups yields information about Cohen-Macaulayness whenever inertia groups can
be accessed directly and are simpler than the whole group, as in the present case.
The method of the “if” direction is similar to the methods used by Reiner and Hersh ([29],
[14], [15]) to prove the results mentioned above. The novelty is the application of Lange’s
orbifold result ([22]) in place of an explicit shelling of a cell complex. The main novelties in
the “only-if” direction are the local-global theorem 3.1; its application to show that certain
kinds of inertia p-groups obstruct Cohen-Macaulayness (proposition 3.11); and a combinatorial
argument that exhibits such an inertia p-group explicitly in the case at hand (lemma 4.5).
The organization of the paper is as follows. Section 2 collects together the needed background from commutative algebra, Stanley-Reisner theory, and piecewise-linear topology, and
introduces notation that is used throughout the article. Section 3 contains the general results on Cohen-Macaulayness and inertia groups that are needed for the “only-if” direction of
theorem 1.2, including the local-global theorem 3.1 and the p-group obstruction proposition
3.11. Section 4 proves the “if” direction of theorem 1.2, and then using this, proves the “onlyif” direction. Finally, section 5 draws out some implications and poses questions for further
inquiry.
2. Background
Throughout this paper, A denotes an arbitrary commutative, unital ring, k denotes a field,
p denotes the characteristic of k, krxs denotes the polynomial ring krx1 , . . . , xn s, rns denotes the
set t1, . . . , nu, and G denotes a finite group with a faithful action on krxs by permutations of
the xi ’s, or on A by arbitrary automorphisms. In §4.2, the prime number p will be conceptually
prior to k, and k will be chosen to satisfy char k “ p.
2.1. Cohen-Macaulayness. Recall that the depth of a local noetherian ring is the length
of the longest regular sequence contained in the maximal ideal. The depth is always bounded
above by the dimension. When equality is achieved, the ring is said to be Cohen-Macaulay.
A general noetherian ring is defined to be Cohen-Macaulay if its localization at every maximal,
or equivalently at every prime, is Cohen-Macaulay ([3, Definition 2.1.1 and Theorem 2.1.3(b)]).
Although there has been work on extending the theory of Cohen-Macaulayness to the nonnoetherian setting ([13]), in this paper we will follow tradition by regarding noetherianity as
a requirement of Cohen-Macaulayness.
Cohen-Macaulayness is automatic for artinian rings, since if the dimension is zero, the depth
of a localization cannot be strictly lower than this. For example, fields are Cohen-Macaulay.

4

BEN BLUM-SMITH AND SOPHIE MARQUES

Noetherian regular rings, for example polynomial rings over fields, are also Cohen-Macaulay
([3, Corollary 2.2.6]).
For our purposes it will be necessary to know how the Cohen-Macaulayness of a ring relates
to that of a flat extension. The needed fact ([3, Theorem 2.1.7]) is that if A Ñ B is a flat
extension of noetherian rings, then B is Cohen-Macaulay if and only if, for each prime ideal
q of B and its contraction p in A, both Ap and Bq {pBq are Cohen-Macaulay. It is enough to
quantify this statement over maximal ideals q of B. We will use this fact repeatedly in §3.
When a noetherian ring is finite over a regular subring, Cohen-Macaulayness is related to
flatness as a module over the subring. In the traditional situation of invariant theory, this
fact has a particularly nice formulation. For if krxs is a polynomial ring over a field, and G
acts by graded automorphisms, then krxsG is finitely generated and graded, and the Noether
normalization lemma guarantees a graded polynomial subring (generated by a homogeneous
system of parameters) over which krxsG is finite. In this situation, krxsG is Cohen-Macaulay if
and only if it is a free module over this subring (the Hironaka criterion). We will not build on
this fact directly, but we mention it both because it motivates interest in Cohen-Macaulayness,
and because we do use a result ([15, Theorem A.1]) that depends on it, whose proof we outline
in the next section.
2.2. Combinatorial commutative algebra and PL topology. The proof of the “if” direction of theorem 1.2 relies on results in combinatorial commutative algebra and some basic
facts about PL topology. For motivation, we describe the plan of the proof before recalling
these results.
By work of Adriano Garsia and Dennis Stantion [10], refined by Victor Reiner in [15],
Cohen-Macaulayness of the polynomial invariant ring krxsG can be deduced from the CohenMacaulayness of the Stanley-Reisner ring of a certain cell complex (specifically a boolean
complex) that depends on G. The Cohen-Macaulayness of this Stanley-Reisner ring can in turn
be deduced from information about the complex that depends only on the homeomorphism
class of its total space. For G generated as in theorem 1.2, a recent result of Christian Lange
[22] hands us this topological information. This is the structure of the proof, which will be
assembled in section 4.1. Here, we recall the needed results and definitions regarding boolean
complexes and Stanley-Reisner rings.
Let P be a finite poset and k a field.
Definition 2.1. The Stanley-Reisner ring of P over k, written krPs, is the quotient of the
polynomial ring krtyα uαPP s, with indeterminates indexed by the elements of P, by the ideal
generated by products yα yβ indexed by incomparable pairs α, β P P.
Remark 2.2. This is a special case of a more general definition, which we will not use directly:
the Stanley-Reisner ring of a simplicial complex. (We will use a further generalization – see
definition 2.5 below.) The Stanley-Reisner ring of a poset is nothing but the Stanley-Reisner
ring of the chain complex of the poset, i.e. the simplicial complex with vertex set the elements
of the poset, whose simplices are the chains in the poset. It is helpful to keep in mind that
the Stanley-Reisner ring of a poset has an underlying simplicial complex as well.
Write rns “ t1, . . . , nu. Let Bn be the boolean algebra on the set rns, i.e. the set of subsets
of rns, ordered by inclusion. Then the Stanley-Reisner ring krBn ztHus is, in a sense that
can be made precise, a coarse approximation of the polynomial ring krxs. In particular, it
carries a natural action of Sn via the latter’s action on the set rns, and if G Ă Sn , then
krxsG is Cohen-Macaulay whenever krBn ztHusG is Cohen-Macaulay. This is the content of
[15, Theorem A.1].

WHEN ARE PERMUTATION INVARIANTS COHEN-MACAULAY OVER ALL FIELDS?

5

The proof is given in full there, and also in great detail in [1, Section 2.5.3], and in any
case is essentially a characteristic-neutral reformulation of an argument of Adriano Garsia
and Dennis Stanton in [10], building on Garsia’s earlier work [9]. However, we would like this
result to be better-known, so we indicate the line of proof.
As mentioned in section 2.1, a finitely generated graded k-algebra is Cohen-Macaulay if
and only if it is free as a module over the subring generated by any homogeneous system
of parameters. Thus, Cohen-Macaulayness can be established by showing the existence of a
module basis over such a subring. For any G Ă Sn , krxsSn and krBn ztHusSn are such subrings,
respectively, of krxsG and krBn ztHusG , and they are isomorphic. Thus, Cohen-Macaulayness
may be passed from krBn ztHusG to krxsG by showing that the existence of a module basis for
the former over the common subring krBn ztHusSn – krxsSn implies the existence of a basis
for the latter. In [9], Garsia introduced a k-linear, Sn -equivariant map G : krBn ztHus Ñ krxs
sending
ź
yU ÞÑ
xi ,
iPU

where U P Bn ztHu is any nonempty subset of rns. The map G is first extended multiplicatively to all monomials of krBn ztHus, and then k-linearly to the whole ring. This map is an
isomorphism of k-vector spaces, and also, in a sense made precise in [1, Proposition 2.5.66], a
coarse approximation of a ring homomorphism. In particular, for any G Ă Sn , if krBn ztHusG
is Cohen-Macaulay, it maps an appropriately chosen krBn ztHusSn -basis of krBn ztHusG to a
krxsSn -basis of krxsG . This statement about bases was proven by Garsia and Stanton in [10]
with k “ Q, in which case both rings are automatically Cohen-Macaulay – Garsia and Stanton’s interest was in the explicit construction of bases – but it was observed by Reiner in
[15, Theorem A.1] that the argument is characteristic-neutral and so allows one to deduce
Cohen-Macaulayness of krxsG from that of krBn ztHusG in the modular situation.
Remark 2.3. Garsia [9], Garsia-Stanton [10], and Reiner [15] all refer to the map G as the
transfer map. Other authors in invariant theory ([27], [32]) use the same phrase to denote the
AG -linear map
Tr : A Ñ AG
ÿ
x ÞÑ
gpxq.
gPG

While this latter map is also called the trace, there are well-established usages of transfer to
describe maps analogous to Tr in both topology and group theory, so we prefer to call G the
Garsia map to avoid competition for the term and to honor Garsia’s introduction of it in [9].
The present paper makes no use of the Garsia map except implicitly in quoting [15, Theorem
A.1].
The work cited above reduces proving Cohen-Macaulayness of krxsG to the analogous statement for krBn ztHusG . The Cohen-Macaulayness of this latter ring can be assessed using a
topological criterion, following a general philosophy in Stanley-Reisner theory that the CohenMacaulayness of a Stanley-Reisner ring is equivalent to a condition on the homology of the
underlying simplicial complex. In the present situation, krBn ztHusG is not the Stanley-Reisner
ring of a poset or simplicial complex, but it turns out to be the Stanley-Reisner ring of a boolean
complex. We recall the needed definitions:
Definition 2.4. A boolean complex is a regular CW complex in which every face has the
combinatorial type of a simplex.

6

BEN BLUM-SMITH AND SOPHIE MARQUES

D
B

A

C

D

A

B

C

H

Figure 1. Left: a boolean complex with total space homeomorphic to a circle. Right:
its face poset.

This is a mild generalization of a simplicial complex, in which it is possible for two faces
to intersect in an arbitrary subcomplex rather than a single subface. (For example, two faces
can have all the same vertices.) See figure 1. The terminology is due to Garsia and Stanton
in [10].
The face poset of a cell complex is the poset whose elements are the cells (faces), and
the relation α ď β means that α’s closure is contained in β’s closure. For our purposes it is
convenient to modify this definition to include an additional empty face H, with H ď α
for all faces α. With this convention, a boolean complex can be characterized as a regular
CW complex whose face poset has the property that every lower interval is a finite boolean
algebra; this is the etymology of the name boolean complex. Face posets of boolean complexes
are referred to as simplicial posets, a term introduced by Richard Stanley in [34].
Stanley generalized the notion of a Stanley-Reisner ring to a boolean complex Ω in [35], as
follows. Let k be a field and let Q be the face poset of Ω, including the minimal element H.
Let krtzα uαPQ s be a polynomial ring with indeterminates indexed by the elements of Q. Let I
be the ideal of this ring generated by:
(1) the element zH ´ 1;
(2) all products zα zβ where α, β P Q have no common upper bound; and
(3) all elements of the form
zα zβ ´ zα^β

ÿ

zγ

γPlubpα,βq

where α, β have at least one common upper bound and lubpα, βq denotes the (consequently nonempty) set of least upper bounds of α, β.
The greatest (common) lower bound α ^ β of α and β exists and is unique in the above
formula because, as remarked above, every lower interval, and in particular the lower interval
below any common upper bound for α, β, is a boolean algebra and therefore a lattice. Thus
whenever α, β have any common upper bound, they have a unique greatest common lower
bound in some lower interval containing them both, and thus in the whole poset.
Definition 2.5. The quotient ring krtzα uαPP s{I is called the Stanley-Reisner ring of Ω and
denoted krΩs.
Remark 2.6. Definition 2.5 generalizes definition 2.1, but in a somewhat subtle way. Given
a poset P, one can form its chain complex Ω, regarded as a boolean complex, and then the
krPs of 2.1 will be isomorphic to the krΩs of 2.5; however, the poset Q of the latter definition
will not be P. Instead, its elements will be chains in P, ordered by inclusion. For example,

WHEN ARE PERMUTATION INVARIANTS COHEN-MACAULAY OVER ALL FIELDS?

[3]
12

7

3
23

13

23

13

r3s
1

3

2
B3 ztHu

1

12

2

∆pB3 ztHuq

Figure 2. The poset B3 ztHu, and its order complex, which is a 2-ball.

let P “ B2 ztHu. Then the elements of P may be abbreviated 1, 2, and 12, and the only
incomparable pair consists of 1 and 2. Thus
krPs “ kry1 , y2 , y12 s{py1 y2 q
according to definition 2.1. However, Q consists of the six chains in P: the empty chain H,
three chains of length 1 (1, 2, and 12), and two chains of length 2 (1 Ă 12 and 2 Ă 12). Thus
krΩs “ krzH , z1 , z2 , z12 , z1Ă12 , z2Ă12 s{I
where I is as described above. The isomorphism is given by mapping the z of a given chain
to the product of y’s corresponding to elements of the chain, for example z1Ă12 ÞÑ y1 y12 .
Indeed, the definition of I becomes much more transparent after considering why this map is
an isomorphism.
The ring of interest to us is the invariant ring krBn ztHusG inside the Stanley-Reisner ring
of the poset Bn ztHu. This ring can be identified with the Stanley-Reisner ring of a boolean
complex using a result of Victor Reiner, as follows. Let ∆ be the order complex of Bn ztHu,
i.e. the simplicial complex whose vertices are the elements of Bn ztHu, and whose faces are
the chains in Bn ztHu. As a simplicial complex, ∆ is the barycentric subdivision of an pn ´ 1qsimplex, thus it is topologically an pn ´ 1q-ball. See figure 2.
The simplicial complex ∆ carries a natural simplicial action of Sn , via the latter’s action
on rns. The quotient cell complex ∆{G is usually not simplicial, but it is a boolean complex.
This is because ∆ is a balanced complex, and the action of G is a balanced action.
Definition 2.7. A boolean complex of dimension d is balanced if there is a labeling of its
vertices by d ` 1 labels such that the vertices of any one face have distinct labels. Given such
a labeling, a cellular action by a group is a balanced action if it preserves the labeling.
In the present case, the vertices of ∆ are the nonempty subsets of rns, and thus ∆ is balanced
by associating a subset to its cardinality. (Here, d “ n ´ 1, so the n possible cardinalities give
the right number of labels.) The action of Sn is clearly balanced with respect to this labeling.
See figure 3.
It is straightforward to check that the quotient of a balanced boolean complex by a balanced
action is again a balanced boolean complex. (Details are given in [1], Lemma 2.5.86.) Thus
∆{G is a balanced boolean complex.
In [29, Theorem 2.3.1], Victor Reiner showed that if a group G acts cellularly and balancedly
on a balanced boolean complex Ω, then the invariant ring krΩsG inside the Stanley-Reisner
ring of Ω is isomorphic to krΩ{Gs, the Stanley-Reisner ring of the quotient boolean complex
Ω{G. In the present situation, this gives us
(1)

kr∆{Gs – krBn ztHusG .

8

BEN BLUM-SMITH AND SOPHIE MARQUES

1
2

2
3

1

2

1

Figure 3. The labeling of the order complex of B3 ztHu, showing it is balanced.

Thus the problem is reduced to showing that kr∆{Gs is Cohen-Macaulay.
Finally, the Cohen-Macaulayness of kr∆{Gs can be assessed topologically. In general, the
Cohen-Macaulayness of the Stanley-Reisner ring of a boolean complex Ω is equivalent (just
as for a simplicial complex) to a condition on |Ω|, the underlying topological space of Ω, that
depends only on its homeomorphism class. Namely, krΩs is Cohen-Macaulay if and only if
(2)

H̃i p|Ω|; kq “ 0 and Hi p|Ω|, |Ω| ´ q; kq “ 0

for all points q P |Ω| and all i ă dim Ω. (Here, H̃i p|Ω|; kq is reduced singular homology
and Hi p|Ω|, |Ω| ´ q; kq is relative singular homology.) This theorem is the product of work of
Gerald Reisner (building on work of Melvin Hochster), James Munkres, Richard Stanlely, and
Art Duval. Reisner proved in [30] that for a simplicial complex Ω, Cohen-Macaulayness of
krΩs is equivalent to a homological vanishing condition that a priori depends on the simplicial
structure and not just the underlying topological space. Munkres in [26] showed that Reisner’s
condition is equivalent to the purely topological condition stated above. Richard Stanley in
[35] showed that the direction
(2) is satisfied for all q P |Ω| and i ă dim Ω ñ krΩs is Cohen-Macaulay
generalizes to boolean complexes, and Art Duval in [6] showed that this generalization is
bidirectional. See [1, §2.5.2] for more details.
Remark 2.8. Since we only use Stanley-Reisner theory to show the “if” direction of theorem
1.2 and thus we only need it to deduce Cohen-Macaulayness, and not the failure of CohenMacaulayness, the proof of 1.2 only uses Stanley’s and not Duval’s part of the generalization
of (2) to boolean complexes.
Combining the results quoted above, we see that to demonstrate the Cohen-Macaulayness
of the ring krxsG , it is sufficient to prove that the boolean complex Ω “ ∆{G satisfies the
homological vanishing condition (2) for all x P |∆{G| and all i ă n ´ 1. The proof of the “if”
direction of theorem 1.2 will consist in showing that this condition holds when G is generated
by transpositions, double transpositions, and 3-cycles.
This will be accomplished by quoting a recent result of Christian Lange (see section 4.1)
that is stated in the language of piecewise-linear (PL) topology, so we also need to recall a
few definitions and a basic fact from this field. We follow [22, Section 3.1] and [31, Chapters
1 and 2] for these details. A polyhedron is a subset X of Rm in which each point has a
compact cone neighborhood, i.e. given x P X, there is a compact set K Ă X such that (i) the
union S of line segments from x to points of K is contained in X, (ii) each point of Sztxu is on
a unique such line segment from x, and (iii) S is a neighborhood of x in X, i.e. it contains an
open subset of X containing x. The set S is called a star of x in X, and K is called a link of
x. See figure 4.

WHEN ARE PERMUTATION INVARIANTS COHEN-MACAULAY OVER ALL FIELDS?

9

x

Figure 4. A compact cone neighborhood of a point in R2 . The link K is drawn in
bold, and the star S is the entire set, the union of segments from x to the points of K.
Some of these segments are also drawn. Note each point of Sztxu is on exactly one
such segment.

Remark 2.9. This definition of polyhedron is a technical device, used here to define the
concepts piecewise-linear and polyhedral star. It includes the more conventional meaning of a
three-dimensional polytope as a special case, but is much, much broader. For example, any
open subset of Rn , or of any polytope, is a polyhedron.
More broadly, our use of PL topology in this paper is only to serve a technical need linking
Lange’s result to our setting.
If X Ă Rm and Y Ă Rn are polyhedra, a continuous map f : X Ñ Y is a piecewise-linear
(or PL) map if its graph tpx, f pxqq : x P Xu Ă Rm`n is a polyhedron. A piecewise-linear
(or PL) space is a second-countable, Hausdorff topological space equipped with a covering
by open sets Ui , each with a homeomorphism ϕi : Xi Ñ Ui from a polyhedron Xi in some Rmi ,
such that the transition maps
ϕ´1
˝ ϕi |ϕ´1 pUi XU j q
j
i

are PL. A PL space is a PL manifold (with or without boundary) if the charts Xi can be
taken to be open subsets of Rn or the half-space Rn´1 ˆ Rě0 .
A subset P of a PL space Y is called a polyhedron if for each of the charts ϕi : Xi Ñ Ui Ă Y,
the preimage ϕ´1
pPq Ă Xi Ă Rmi is a polyhedron.
i
n
If X Ă R is a polyhedron and x P X, one may always find a link and star for x that are
polyhedra ([31, p. 5]). It then follows from the definitions that if Y is a PL space, any point
y of Y has a neighborhood S contained in some Ui Q y, such that the preimage ϕ´1
pSq Ă Xi
i
´1
is both a polyhedron and a star of ϕi pyq in Xi . We will refer to such an S as a polyhedral
star of y.
The key fact we need is that if X is a polyhedron and x P X, then any two polyhedral stars
of x in X are PL-homeomorphic, in other words the star is a PL-homeomorphism invariant
of x ([31, pp. 20–21]). It follows from the above discussion that the same is true in any PL
space.
If Y is a PL manifold, one may take each chart Xi to be an open subset in Rn or Rn´1 ˆRě0 .
In any open subset of Rn , the star of a point px1 , . . . , xn q may be taken to be the cube
rx1 ´ ε, x1 ` εs ˆ ¨ ¨ ¨ ˆ rxn ´ ε, xn ` εs for sufficiently small ε ą 0; and in Rn´1 ˆ Rě0 it can be
taken to be the intersection of this cube with the closed half-space txn ě 0u. In all cases, this
is topologically a closed ball. It then follows from the fact quoted in the previous paragraph
that every polyhedral star in a PL manifold is topologically a ball.
The “if” direction of theorem 1.2 will be proven by quoting the result of Lange mentioned
above to show that if G is generated by transpositions, double transpositions, and 3-cycles,
then ∆{G is a polyhedral star of a point in a PL manifold, and therefore a ball. Thus it meets
the homological vanishing criterion described above, regardless of the field k.

10

BEN BLUM-SMITH AND SOPHIE MARQUES

2.3. Generalities about group actions on a ring. The purpose of this section is to develop
the commutative algebra needed to prove the general results in §3, which are then used in
section §4.2 to prove the “only-if” direction of theorem 1.2.
Let 1 denote the group identity. (In commutative diagrams, let it also denote a trivial
group.) Let AG denote the ring of invariants, and similarly for any subgroup of G. It is well
known that A is always integral over AG ([2, Chapitre V §1.9, Proposition 22]).
Let P Ÿ A be a prime ideal.
Recall that the decomposition group DG pPq of P is the stabilizer of P in G:
DG pPq “ tg P G : gP “ Pu.
The decomposition group acts on the integral domain A{P. The inertia group IG pPq of P
is the kernel of this action:
IG pPq “ tg P G : pg ´ 1qA Ă Pu ,
where
pg ´ 1qA “ tga ´ a : a P Au.
The notations IG pPq and DG pPq implicitly specify the ring A being acted on by G, since P
belongs to A.
We recall some basic facts in this setup ([2, Chapitre V §2.2, Théorème 2]), which we use
freely in what follows: (i) G acts transitively on the prime ideals of A lying over P‹ “ P X AG ;
and (ii) the extension of residue fields κpPq{κpP‹ q is a normal field extension, and the canonical
map from DG pPq to the group of κpP‹ q-automorphisms of κpPq is a surjection with kernel
IG pPq, i.e. the sequence
1 ÝÝÝÝÑ IG pPq ÝÝÝÝÑ DG pPq ÝÝÝÝÑ AutκpP‹ q pκpPqq ÝÝÝÝÑ 1
is exact.
If N Ÿ G is a normal subgroup, then the quotient group G{N acts on the invariant ring AN ,
and the decomposition and inertia groups in G and G{N relate straightforwardly. Note that,
by their definitions, IN pPq “ IG pPq X N and DN pPq “ DG pPq X N.
Lemma 2.10. We have
DG{N pP X AN q – DG pPq{DN pPq
and
IG{N pP X AN q – IG pPq{IN pPq.
We believe this and the next lemma may be well-known; however, as we were unable to
locate references, we include full proofs.
Proof. The sequences
ϕ

1 ÝÝÝÝÑ DN pPq ÝÝÝÝÑ DG pPq ÝÝÝÝÑ DG{N pP X AN q ÝÝÝÝÑ 1
and
ψ

1 ÝÝÝÝÑ IN pPq ÝÝÝÝÑ IG pPq ÝÝÝÝÑ IG{N pP X AN q ÝÝÝÝÑ 1
are exact in the first and second positions by the definitions; we have to prove surjectivity of
ϕ and ψ.
Consider ϕ first. Suppose g P G is such that its image g in G{N lies in DG{N pP X AN q.
Then, setting Q “ gP, we have
Q X AN “ P X AN .

WHEN ARE PERMUTATION INVARIANTS COHEN-MACAULAY OVER ALL FIELDS?

11

All primes of A that intersect AN in P X AN lie in the same orbit of N. Thus there exists
n P N with nQ “ P. Therefore ngP “ P, i.e. ng P DG pPq, and we have ϕpngq “ g. So ϕ is
surjective.
We establish the surjectivity of ψ with a diagram chase. Let P1 “ P X AN and let P‹ “
P X AG . We have the following commutative diagram:
1
1
1
§
§
§
§
§
§
đ
đ
đ
1 ÝÝÝÝÑ

1 ÝÝÝÝÑ

IN pPq
§
§
đ

DN pPq
§
§
pN đ

ÝÝÝÝÑ

ı

ÝÝÝDÝÑ

IG pPq
§
§i
đG

DG pPq
§
§p
đG

ψ

ÝÝÝÝÑ

ϕ

ÝÝÝÝÑ

IG{N pP1 q
§
§i
đ G{N

DG{N pP1 q
§
§pG{N
đ

ÝÝÝÝÑ 1

1 ÝÝÝÝÑ AutκpP1 q pκpPqq ÝÝÝÝÑ AutκpP‹ q pκpPqq ÝÝÝÝÑ AutκpP‹ q pκpP1 qq ÝÝÝÝÑ 1
ıκ
ξ
§
§
§
§
§
§
đ
đ
đ
1

1
1
where
are the residue fields. The first and second row are exact by what
we have just done. The third row is exact by consideration of the definitions and the fact that
κpPq is normal over κpP1 q (by [2, Chapitre V §2.2, Théorème 2(ii)], as recalled above), since
field automorphisms always extend to normal extensions. The columns are also exact by [2,
Chapitre V §2.2, Théorème 2(ii)].
Let g P IG{N pP1 q be arbitrary and consider iG{N pgq. Since ϕ is surjective, there is a y P
DG pPq with ϕpyq “ iG{N pgq. Then
κpPq, κpP1 q, κpP‹ q

1 “ pG{N ˝ iG{N pgq “ pG{N ˝ ϕpyq “ ξ ˝ pG pyq,
so that pG pyq P ker ξ “ im ıκ . Thus there is a z P AutκpP1 q pκpPqq with ıκ pzq “ pG pyq. Since
pN is surjective, we have a z1 P DN pPq with pN pz1 q “ z. Now consider
y‹ “ ıD pz1 q´1 y P DG pPq.
We have
pG py‹ q “ pG ˝ ıD pz1 q´1 pG pyq
“ ıκ ˝ pN pz1 q´1 pG pyq
“ ıκ pzq´1 pG pyq
“ pG pyq´1 pG pyq
“ 1.
Thus y‹ P ker pG “ im iG , so there exists g1 P IG pPq with iG pg1 q “ y‹ . Then
iG{N ˝ ψpg1 q “ ϕ ˝ iG pg1 q
“ ϕpy‹ q
`
˘
“ ϕ ıD pz1 q´1 y

“ ϕ ˝ ıD pz1 q´1 ϕpyq

12

BEN BLUM-SMITH AND SOPHIE MARQUES

“ 1´1 iG{N pgq “ iG{N pgq.
Since iG{N is injective, we can conclude ψpg1 q “ g. Thus ψ is surjective.



The inertia group of a prime that survives a base change remains stable under that base
change, and the decomposition group can only shrink:
Lemma 2.11. Let C be an arbitrary AG -algebra, and let B :“ AbAG C. Let G act on B through
its action on A and trivial action on C. If there is a prime Q of B pulling back to P in A,
then DG pQq Ă DG pPq, and IG pQq “ IG pPq.
Proof. Let τ : A Ñ B be the canonical map. By construction, τ is G-equivariant. Thus if
g P G stabilizes Q Ÿ B setwise, it also stabilizes the preimage P Ÿ A setwise, and it follows
that DG pQq Ă DG pPq.
When g P DG pQq and therefore P DG pPq, it has an induced action on both B{Q and A{P,
and the G-equivariance of τ then implies that the induced map
τ : A{P Ñ B{Q
is xgy-equivariant. If also g P IG pQq, then its action on B{Q is trivial. Since P is the full
preimage of Q, τ is an injective map, and it follows that g’s action on A{P is also trivial, i.e.
g P IG pPq. Thus IG pQq Ă IG pPq.
In the other direction, suppose g P IG pPq. By [24, Chapter 1, Corollary 1.13], we have a
canonical isomorphism
(3)

B{τpPqB – A{P bAG C.

Using only the fact that g P DG pPq and the G-equivariance of τ, we already know that g fixes
P and τpPq setwise, and thus has well-defined actions on A{P and B{τpPqB that coincide via
(3). But because g is actually in IG pPq, the action on A{P is trivial, and therefore, by (3),
the action of g on B{τpPqB is also trivial.
In other words, g fixes the cosets of the additive subgroup τpPqB of B setwise. Since Q pulls
back to P, it contains the image of P, thus we have Q Ą τpPqB. Then the cosets of Q are
unions of cosets of τpPqB, and therefore g fixes these setwise as well. In other words, g acts
trivially on B{Q, i.e. g P IG pQq. Thus IG pPq Ă IG pQq, and we conclude IG pPq “ IG pQq.

Remark 2.12. Examining the proof of lemma 2.11, we see why the analogous equality to
IG pPq “ IG pQq may fail for decomposition groups. If g P DG pPq, then we do have the xgyequivariant isomorphism (3), and therefore g does act on the cosets of τpPqB in B, but the
only one we know it fixes is τpPqB itself. In particular, Q, which may be the union of many
of these cosets, need not be fixed setwise, so that g R DG pQq.
Henceforth, let p be a prime of AG . Our goal is to show that, in a suitable sense, the local
structure of AG at p is determined by the inertia group of a prime of A lying over p. The
precise statement is lemma 2.14 below. It is stated by Michel Raynaud in [28, Chapitre X §1,
Corollaire 1], with lines of proof indicated. Because it is central to our results, we develop in
detail the notation and tools that will be required to state and prove this lemma.
Let Chs
p be the strict henselization (see [28, Chapitre VIII, Definition 4] or [12, Definition
18.8.7]) of AG at p, with respect to some embedding of κppq in its separable closure. Then
G
Chs
p is faithfully flat over pA qp , and of relative dimension zero ([12, Proposition 18.8.8(iii)]).
G
Furthermore, Chs
p and pA qp are simultaneously noetherian ([12, Proposition 18.8.8(iv)]), and
hs
Ahs
p :“ A bAG Cp

WHEN ARE PERMUTATION INVARIANTS COHEN-MACAULAY OVER ALL FIELDS?

13

G
is integral over Chs
p (as it is a base change of the integral morphism A Ñ A). Moreover, G
hs
acts on Ahs
p via the the first component of the tensor product, so that the map A Ñ Ap is
G-equivariant, and
G
hs
pAhs
p q “ Cp

since AG Ñ pAG qp Ñ Chs
p is flat and the functor of invariants commutes with flat base change.
Let P be a prime ideal of A lying over p, and let Q be a prime ideal of Ahs
p lying over the
maximal ideal of Chs
corresponding
to
p,
and
pulling
back
to
P
in
A.
p
From lemma 2.11, we have that
IG pQq “ IG pPq.
hs
hs
The action of G on Ap induces an action on its ideals. Since Ahs
p is integral over Cp , all of
hs
hs
its maximal ideals lie over the one maximal of Cp . Because Cp is the invariant ring under the
action of G, this implies ([2, Chapitre V §2.2, Théorème 2(i)]) that the maximal ideals of Ahs
p
comprise a single orbit for the action on ideals. The maximals are therefore finite in number.
We denote them by M1 p“ Qq, . . . , Ms .
The product of canonical localization homomorphisms
s
ź
Ñ
(4)
φ : Ahs
pAhs
p
p qM j
j“1

is the inductive limit of Chs
is an isomorphism. Indeed,
p -finite subalgebras (since it is
hs
hs
integral over Cp ). Since Ap has only s maximals, there exists a finite subalgebra containing
s maximals. Now view Ahs
p as the inductive limit just of the finite subalgebras that contain
this one. For each of them, the analogous product of canonical localization morphisms is an
isomorphism because Chs
p is henselian (see [28, Chapitre I, §1 Définition 1 and Proposition 3]);
then the statement about (4) follows because inductive limits commute with finite products.
Ahs
p

Lemma 2.13. If A is a noetherian ring, then Ahs
p is noetherian too.
Proof. Because of the isomorphism (4), it suffices to show that the localizations of Ahs
p at its
maximal ideals M j are noetherian rings, and because the action of G on Ahs
by
automorphisms
p
is transitive on these maximals, it suffices to show this for a single maximal. We will do this
by showing that there is a maximal ideal M j of Ahs
p such that
pAhs
p qM j
is isomorphic to the strict henselization of the noetherian local ring AP , whereupon the result
will follow because strict henselization preserves noetherianity ([12, Proposition 18.8.8(iv)]).
Consider the local ring pAG qp . By slight abuse of notation, let us call its maximal ideal p.
Note that the residue field κppq is the same whether p refers to the prime in AG or in pAG qp ,
so we can write κppq without ambiguity. Then the maximal ideals in the ring
B :“ A bAG pAG qp
are in bijection with the prime ideals of A lying over p Ÿ AG . There are finitely many of
these since they are subject to a transitive action by G, so B is semilocal. It is also integral
as an extension of pAG qp since this is a base change of the integral extension AG Ă A. One
of the prime ideals over p in A is P. By the same abuse of notation, let P also refer to the
corresponding ideal in B; again, this does not introduce ambiguity when writing κpPq. Note
that BP “ AP because B is obtained from A by inverting some but not all of the elements in
the complement of P.

14

BEN BLUM-SMITH AND SOPHIE MARQUES

Because B is semilocal and integral over pAG qp (and P and p are maximal ideals of these
rings respectively), if we can show that the extension of residue fields κpPq{κppq has finite
separable degree, then it will follow from [12, Proposition 18.8.10 and its proof, and Remarque
18.8.11] that the strict henselization
pBP qhs
of the localization BP (with respect to some embedding of its residue field in a separable
closure) is isomorphic to the localization of
B bpAG qp Chs
p
G
at some maximal ideal, since Chs
p is a strict henselization of pA qp . But we also have
G
hs
B bpAG qp Chs
p “ A bAG pA qp bpAG qp Cp

“ A bAG Chs
p
“ Ahs
p .
Thus the conclusion from [12, 18.8.10 and 18.8.11] will actually be that
pAP qhs “ pBP qhs – pAhs
p qM j
for some maximal ideal M j of Ahs
p . This is the desired conclusion, so it remains to show that
κpPq{κppq has finite separable degree.
Now return p, P to the setting of AG and A, recalling that the residue fields κppq, κpPq do
not change. From [2, Chapitre V, §2.2(ii)] we have that κpPq{κppq is a normal field extension,
and the group of κppq-automorphisms of κpPq is isomorphic to
DG pPq{IG pPq.
This is a subquotient of the finite group G and is therefore finite. For a normal field extension,
infinite separable degree would imply infinitely many automorphisms. Thus κpPq{κppq is an
extension of finite separable degree, and the proof is complete.

ś
s
hs
The action of G on Ahs
p induces, via the isomorphism φ of (4), an action on
1 pAp qM j : it
is the unique action on this ring such that φ is G-equivariant. Because φ is the product of
the canonical localization maps
hs
φ j : Ahs
p Ñ pAp qM j ,

it is possible to write down this action explicitly. Via the isomorphism φ of (4) we associate
uniquely to a P Ahs
p the s-tuple
(5)

s
ź
φpaq “ paM1 , ¨ ¨ ¨ , aMs q P
pAhs
p qM j
j“1

where each aM j is the image in pAhs
p qM j of a under φ j . If g P G maps Mi to M j , then it also
induces an isomorphism
g

pAhs
Ñ pAhs
p qMi Ý
p qM j
a{s ÞÑ ga{gs

WHEN ARE PERMUTATION INVARIANTS COHEN-MACAULAY OVER ALL FIELDS?

15

of the localizations that makes the following square
Ahs
p
§
§
φi đ

g

ÝÝÝÝÑ

Ahs
p
§
§φ
đ j

ÝÝÝÑ pAhs
pAhs
p qM j
p qMi Ý
g

commutative. By such isomorphisms, G acts on the disjoint union of the localizations pAhs
p qM j .
hs
hs
Given an α P pAp qMi , if one chooses a P Ap with φi paq “ α, then the commutativity of this
square can be rewritten as
gα “ φ j pgaq.
Note that this statement is true regardless of the choice of a. For any such choice, writing
α “ aMi and φ j pgaq “ pgaqM j “ pgaqgpMi q , this becomes
gpaMi q “ pgaqgpMi q ,
or equivalently,
(6)

gpag´1 pM j q q “ pgaqM j .

of φpgaq,
Thus, for any a P Ahs
p , the ith coordinate of φpaq determines the jth coordinate
śs hs
without requiring additional information about a. Then the action of G on 1 pAp qM j induced
by φ may be written
´ ´
¯
´
¯¯
(7)
gpaM1 , . . . , aMs q “ g ag´1 pM1 q , . . . , g ag´1 pMs q .
Indeed, if a P Ahs
p , then the left side of this formula is gφpaq, and the right side is φpgaq by
(6).
Because IG pQq stabilizes Q “ M1 , it acts on pAhs
p qQ . In this setting, we have the following
lemma. As mentioned above, this lemma was stated by Michel Raynaud in [28, Chapitre X
§1, Corollaire 1], with the proof sketched. It is the needed statement that the local structure
of AG is determined by the inertia groups. Because it is critical to our results, we give a
detailed proof.
Lemma 2.14 (Raynaud). We have a ring isomorphism
I pPq

G
pAhs
p qQ

– Chs
p .

Proof. Recall that IG pPq “ IG pQq. Let g1 , ¨ ¨ ¨ , gs P G be a set of left coset representatives
for G{IG pPq, with g1 the identity. Since Chs
p is strictly henselian, its residue field is separably
closed, so there are no nontrivial automorphisms of κpQq over it. Since the group of automorphisms of κpQq{κpChs
p q is isomorphic to DG pQq{IG pQq, we have DG pQq “ IG pQq, so that
IG pQq, which equals IG pPq, is the stabilizer of Q. Thus, if we put M j :“ g j Q, then the ideals
M1 , ..., Ms are exactly the maximal ideals of Ahs
p , and all of the above discussion applies.
We claim that if one restricts the canonical localization map
hs
φ1 : Ahs
p Ñ pAp qQ
I pQq

hs G
to Chs
. We see this as follows:
p , one obtains an isomorphism onto pAp qQ
The map φ1 is the composition of φ with projection to the first coordinate. Because (7)
hs
hs G
makes φ a G-equivariant isomorphism, a P Ahs
p is in Cp “ pAp q if and only if
´ ´
¯
´
¯¯
(8)
g ag´1 pM1 q , . . . , g ag´1 pMs q
“ paM1 , . . . , aMs q

16

BEN BLUM-SMITH AND SOPHIE MARQUES

for all g P G. From (8), we will deduce the following:
hs
(a) If a P Chs
p is an arbitrary G-invariant, then φ1 paq is invariant under IG pPq. Thus φ1 pCp q
I pPq

G
is contained in pAhs
p qQ

.

(b) If a P Chs
p is an arbitrary G-invariant, then all the coordinates of φpaq are determined
by the first coordinate. Thus a itself is determined by φ1 paq. In other words, the
restriction of φ1 to Chs
p is injective.
I pPq

G
is arbitrary, there exists an a P Chs
(c) If α P pAhs
p with φ1 paq “ α. Thus the restriction
p qQ
hs
of φ1 to Cp is surjective.

This will suffice to establish the lemma.
To prove (a), take g P IG pPq. The condition in the first coordinate of (8) is
gpag´1 pM1 q q “ aM1 .
For g P IG pPq “ DG pQq, we have g´1 pM1 q “ M1 “ Q, and this condition becomes
gpaQ q “ aQ .
Thus for the G-invariant a, we have that aQ “ φ1 paq is an IG pPq-invariant. Therefore, φ1 pChs
p q
I pPq

G
is contained in pAhs
.
p qQ
For (b), consider g “ g j for j “ 1, . . . , s. The condition in the jth coordinate of (8) is

gpag´1 pM j q q “ aM j .
Since g´1
pM j q “ Q, this becomes
j
g j paQ q “ aM j .
Letting j “ 1, . . . , s, this shows that if a is a G-invariant, then all the coordinates of φpaq are
determined by aQ , which is φ1 paq, so a itself is determined by φ1 paq. Therefore, the restriction
of φ1 to Chs
p is injective.
I pPq

G
Lastly, for (c), let α P pAhs
p qQ
and show it lies in Chs
p . Set

be arbitrary. We construct a specific a P Ahs
p with φ1 paq “ α,
aM j :“ g j pαq

for j “ 1, . . . , s, and let
`
˘
a :“ φ´1 aM1 , . . . , aMs P Ahs
p .

Note that this a satisfies φ1 paq “ aM1 “ g1 pαq “ α since g1 is the identity. To show that it
hs G
also lies in Chs
p “ pAp q , it is necessary and sufficient to show that φpaq satisfies (8) for all
g P G, i.e. that
(9)

gpag´1 pM j q q “ aM j

for all g P G and all j “ 1, . . . , s.
To do this, we first establish that
(10)

agpQq “ gpaQ q

for all g P G, and then use this to show (9) for all g and all j.
To see (10), first recall that α “ aM1 “ aQ , and then use this and M j “ g j pQq to rewrite
the definition of each aM j :
ag j pQq “ g j paQ q.

WHEN ARE PERMUTATION INVARIANTS COHEN-MACAULAY OVER ALL FIELDS?

17

This establishes (10) in the particular case that g is one of g1 , . . . , gs . An arbitrary g P G has
the form g j h for some g j and some h P IG pPq. Since Q and aQ “ α are both IG pPq-invariant,
we have
agpQq “ ag j hpQq “ ag j pQq “ g j paQ q “ g j hpaQ q “ gpaQ q,
and (10) is established for all g P G.
Now we deduce (9). If g P G is arbitrary, then
ag´1 pM j q “ ag´1 g j pQq
because g j pQq “ M j , and
ag´1 g j pQq “ g´1 g j paQ q
by (10). Thus ag´1 pM j q “ g´1 g j paQ q, and applying g to the left on both sides yields
gpag´1 pM j q q “ g j paQ q “ aM j ,
so condition (9) is met for all g and all j, i.e. (8) is met for all g. Thus
G
hs
a P pAhs
p q “ Cp .
I pPq

G
Since α P pAhs
p qQ

I pPq

G
onto pAhs
p qQ

was arbitrary, this shows that the restriction of φ1 to Chs
p is surjective

, completing the proof of isomorphism.



3. Inertia groups and Cohen-Macaulayness of invariant rings
Using lemma 2.14, we can show that the Cohen-Macaulayness of a ring of invariants at a
prime ideal p can always be tested in a faithfully flat neighborhood of p, and only depends on
the action of the inertia group considered around this neighborhood. The precise statement
is theorem 3.1.
We use this to derive an obstruction to Cohen-Macaulayness for a characteristic p ring that
will apply in the situation of theorem 1.2 to prove the “only-if” direction. The statement is
proposition 3.11.
In all of what follows, we use the notation of §2.3: A is a commutative, unital ring endowed
with a faithful action of a finite group G; and if p is a prime ideal of AG , then Chs
p is the strict
henselization of AG at p, and Ahs
is
p
A bAG Chs
p ,
with G acting through its action on A (and trivially on Chs
p ).
Theorem 3.1. Assume that AG is noetherian. Then the following assertions are equivalent:
(1) AG is Cohen-Macaulay.
hs
(2) For every prime ideal p of AG , and for every prime ideal Q of Ahs
p lying over pCp and
pulling back to a prime P of A lying over p,

pAhs
p qQ

IG pPq

is Cohen-Macaulay.
hs
(3) For every maximal ideal p of AG , there is some prime ideal Q of Ahs
p lying over pCp
and pulling back to a prime P of A lying over p, such that

pAhs
p qQ
is Cohen-Macaulay.

IG pPq

18

BEN BLUM-SMITH AND SOPHIE MARQUES

Proof. Clearly (2)ñ(3). We will show that (3)ñ(1) and (1)ñ(2).
(3)ñ(1): Lemma 2.14 states that for each maximal ideal p of AG and for any choice of P, Q
as in (3),
I pPq

hs G
Chs
p – pAp qQ

.

Thus (3) implies that for each p, Chs
p is Cohen-Macaulay. The homomorphism of local noetherian rings
pAG qp Ñ Chs
p
is flat, so by the result [3, Theorem 2.1.7] quoted in §2.1, Cohen-Macaulayness of Chs
p is
hs . In particular, since Chs is Cohen-Macaulay,
equivalent to that of pAG qp plus that of Chs
{pC
p
p
p
so is pAG qp . Since this holds for all maximal ideals p of AG , AG is Cohen-Macaulay.
(1)ñ(2) Suppose AG is Cohen-Macaulay. Let p be any prime ideal of AG . It suffices to
prove that Chs
p is Cohen-Macaulay, since by lemma 2.14, for any P, Q as in (2), we have
I pPq

hs G
Chs
p – pAp qQ

.

Since pAG qp Ñ Chs
p is flat, we again have by [3, Theorem 2.1.7] that the Cohen-Macaulayness
hs
hs
of Cp is equivalent to that of pAG qp plus that of Chs
p {pCp . The former ring is Cohen-Macaulay
G
since A is, by the hypothesis (1), and the latter is Cohen-Macaulay since it is a field (cf.

§2.1), namely, the residue field of the local ring Chs
p .
Theorem 3.1 allows us to test Cohen-Macaulayness of an invariant ring AG locally, prime-byprime, in terms of the local ring pAhs
p qQ and the local group action IG pPq. For the application
we have in mind in §4, we will need to carry information about A and G to pAhs
p qQ and IG pPq,
so we enunciate a few more lemmas to accomplish this:
Lemma 3.2. If A is Cohen-Macaulay, then for any prime ideal p of AG , Ahs
p is CohenMacaulay.
Proof. Suppose A is Cohen-Macaulay, thus noetherian, and p is a prime of AG . By lemma
2.13, Ahs
p is noetherian.
Let Q be any maximal ideal of Ahs
p and let P be its contraction in A. (Note that Q lies
hs
over pCp , per section 2.3, and therefore P lies over p.) Now
AG Ñ pAG qp Ñ Chs
p
is a flat map. Therefore, base changing by AG Ñ AP ,
hs
AP Ñ AP bAG Chs
p “ A P bA A p
hs
hs
is also a flat map. Since Q Ÿ Ahs
p pulls back to P in A, pAp qQ is a localization of AP bA Ap ;
thus
AP Ñ pAhs
p qQ

is also flat. Therefore, again by [3, Theorem 2.1.7] discussed in §2.1, Cohen-Macaulayness of
hs
hs
pAhs
p qQ is equivalent to that of AP plus that of pAp qQ {PpAp qQ . The former is Cohen-Macaulay
since A is, while the latter is Cohen-Macaulay since it is an artinian local ring (cf. §2.1), which
in turn is because AP Ñ pAhs
p qQ is of relative dimension zero. This itself is because this map is
a localization of the base change AP bpAG qp ´ of the map pAG qp Ñ Chs
p , which is flat of relative
dimension zero because it is a strict henselization ([12, Proposition 18.8.8(iii)]).


WHEN ARE PERMUTATION INVARIANTS COHEN-MACAULAY OVER ALL FIELDS?

19

For a natural number t, an element g P G is called a t-reflection if the ideal generated by
pg ´ 1qA in A is contained in a prime of height ď t. A prime P contains pg ´ 1qA if and only
if g P IP pAq, so another way to say this is that g is a t-reflection if it is in the inertia group of
some prime of height ď t.
In the geometric situation (where A is a finitely generated algebra over a field), the ideal
generated by pg ´ 1qA corresponds to the fixed point locus of g, so this definition makes a
group element a t-reflection if this fixed point locus has codimension at most t. Thus if G is a
linear group acting on the coordinate ring of affine space, a 1-reflection is either the identity
or a reflection in the classical sense. A 2-reflection has a fixed point locus of codimension 0,
1, or 2. In particular, if G acts by permutations of a basis, then the 2-reflections are exactly
the identity, the transpositions, the double transpositions, and the 3-cycles.
Lemma 3.3. If an element g P IG pPq acts as a t-reflection on AP , then it acts as a t-reflection
on A.
Proof. Since g P IG pPq, we have pg ´ 1qA Ă P. The primes of A contained in P are in
containment-preserving bijection with the primes of AP , with the bijection given by extension
along the canonical localization map, and pg ´ 1qAP is the extension of pg ´ 1qA along this
map. Thus if a prime of height t in AP contains pg ´ 1qAP , then its pullback in A is also of
height t and contains pg ´ 1qA.

Lemma 3.4. If A is noetherian, and g P IG pPq “ IG pQq acts as a t-reflection on Ahs
p , then it
acts as a t-reflection on A.
hs
Proof. If g is a t-reflection on Ahs
p , then there is a prime ideal S of Ap of height ď t and
hs
containing pg ´ 1qAp . Let R be S’s pullback in A. Then R contains pg ´ 1qA. Since by
section 2.3 and lemma 2.13,
A Ñ Ahs
p
is a flat extension of noetherian rings, going-down applies ([7, Lemma 10.11]), so that the
height of S is at least that of R. In particular, the height of R is ď t, so that g is a t-reflection
on A.


We will also need to take an element of G acting on A but not as a t-reflection, and conclude
that it does not act on a certain subring as a t-reflection either:
Lemma 3.5. If N is the normal subgroup of G generated by the t-reflections, then no element
of GzN acts on AN as a t-reflection.
Remark 3.6. This lemma does not require a noetherian hypothesis on A.
Proof. Let g P G. We will show that if its image g P G{N acts on AN as a t-reflection, then
actually g P N.
If g acts on AN as a t-reflection, then there is a prime p of AN of height ď t with g P IG{N ppq.
Let P be any prime of A lying over p. The height of P is equal to that of p (e.g. by [11,
Lemma 5.3], which is stated for noetherian A but the argument holds in general); in particular
it is ď t. By lemma 2.10, we have
IG{N ppq “ IG pPq{IN pPq.
In particular, IG pPq surjects onto IG{N ppq, so there is an element g1 P IG pPq whose image in
G{N is g. Since P has height ď t, g1 is a t-reflection, so it is contained in N by construction.
Then its image g must actually be the identity. So g (with the same image) lies in the kernel
of G Ñ G{N, i.e. g P N.


20

BEN BLUM-SMITH AND SOPHIE MARQUES

The following lemma allows us to detect a failure of Cohen-Macaulayness locally.
Lemma 3.7. Let A be a ring containing the prime field Fp , and let G be a p-group. Suppose
that A is Cohen-Macaulay, AG is noetherian, and A is finite over AG . Further, suppose there
is a prime ideal P of A such that G “ IG pPq. Then AG is not Cohen-Macaulay unless G is
generated by its 2-reflections.
Remark 3.8. This statement is closely related to [11, Theorem 5.5], which also applies to
non-p-groups and gives some control over how far AG can be from Cohen-Macaulay. However,
a key step in the proof of that result requires the rings to be normal rings that are localizations
of algebras finitely generated over fields. As our application will be to rings that do not fulfill
this hypothesis, we give an independent proof.
Proof of lemma 3.7. Let N be the normal subgroup of G generated by the 2-reflections.
Since A is finite over the noetherian ring AG , it is noetherian as an AG -module. Since it
also contains Fp , [25, Corollary 4.3] applies, which, when specialized to the situation that G
is a p-group, states that if both A and AG are Cohen-Macaculay, then the map
TrG{N : AN Ñ AG
given by
x ÞÑ

ÿ

gx

gPG{N

is surjective onto AG , where we think of each g as an element of G and the sum is taken over
coset representatives of N.
We will show that this map cannot be surjective unless N “ G. Since A is Cohen-Macaulay
by assumption, this will show AG is not Cohen-Macaulay if N ‰ G.
If TrG{N is surjective, then we have
ÿ
gx
1“
gPG{N

for some x P AN . Since G “ IG pPq, all g P G satisfy gx “ x mod P in A, thus
ÿ
x “ rG : Nsx mod P
1“
gPG{N

in A. Since G is a p-group and A contains Fp , rG : Nsx “ 0 in A unless N “ G. In particular,
rG : Nsx cannot be 1 mod P unless N “ G.

Remark 3.9. The map TrG{N is called the relative trace or relative transfer; see remark 2.3.
Remark 3.10. The proof uses the result [25, Lemma 4.3] of Lorenz and Pathak, which has as
a hypothesis that A is noetherian as an AG -module; call this (‹). Above, we deduced (‹) from
the assumptions that (1) AG is noetherian and (2) A is finite over it. Actually, (‹) also implies
(1) and (2), hence is equivalent to them. Since any ideal of AG is also an AG -submodule of
A (since AG embeds in A), (‹) implies that all these ideals are finitely generated, thus (1).
Meanwhile, A itself is an AG -submodule of A, so (‹) implies it is finitely generated as an
AG -module, thus (2). More generally, if a module M over a ring R has an injective R-module
map from R, then noetherianity of M as R-module is equivalent to noetherianity of R as a
ring plus finite generation of M over R, by the same arguments.

WHEN ARE PERMUTATION INVARIANTS COHEN-MACAULAY OVER ALL FIELDS?

21

Combining all of these results, we get an obstruction to Cohen-Macaulayness for a characteristic p ring expressed entirely in terms of the presence of a certain inertia group. The proof
of the “only-if” direction of theorem 1.2 will be an application of this proposition.
Proposition 3.11. Let A be a ring containing Fp and let G be a finite group of automorphisms
of A. Let N be the normal subgroup of G generated by the 2-reflections. Suppose that AN is
Cohen-Macaulay, AG is noetherian, and AN is finite over AG . If there is an inertia group for
the action of G{N on AN that is a nontrivial p-group, then AG is not Cohen-Macaulay.
Proof. Note that
AG “ pAN qG{N .
Since AG is noetherian, theorem 3.1 applies.
Suppose P is a prime of AN whose inertia group IG{N pPq is a p-group, per the hypothesis.
Let
p “ P X pAN qG{N ,
G
N G{N q , and let
let Chs
p
p be the strict henselization of pA qp “ ppA q
hs
N
pAN qhs
p “ A b AG C p ,

as in section 2.3.
By assumption, AN is Cohen-Macaulay. Thus pAN qhs
p is Cohen-Macaulay, by lemma 3.2,
and thus so is
ppAN qhs
p qQ
for any Q Ÿ pAN qhs
p , and in particular any Q as described in theorem 3.1.
N
As A is finite over the noetherian ring AG by assumption, its base change pAN qhs
p is finite
hs
over Cp , which is noetherian by [12, Proposition 18.8.8(iv)], as discussed in section 2.3. The
N hs
localization ppAN qhs
p qQ is a homomorphic image of pA qp by the isomorphism (4), so it too is
finite over Chs
p .
N hs
By lemma 2.14, Chs
p is the invariant ring for the action of IG{N pPq on ppA qp qQ . Since A
contains Fp and therefore so do AN and ppAN qhs
p qQ , and since IG{N pPq is a p-group that is equal
to IG{N pQq which is an inertia group of ppAN qhs
p qQ , we have now verified all the hypotheses of
N
lemma 3.7 for the action of IG{N pPq on ppA qhs
p qQ . We can conclude from that lemma that
the invariant ring cannot be Cohen-Macaulay unless IG{N pPq is generated by 2-reflections.
However IG{N pPq is not so generated. By lemma 3.5, no nontrivial element of G{N acts
on AN as a 2-reflection. In particular, no nontrivial element of IG{N pPq acts on AN as a
2-reflection. Since AN is Cohen-Macaulay, it is noetherian, so lemma 3.4 applies, and no
nontrivial element of IG{N pPq acts on pAN qhs
p as a 2-reflection either. By lemma 3.3, the same
is true for the action of IG{N pPq “ IG{N pQq on
ppAN qhs
p qQ .
In particular, the p-group IG{N pPq is not generated by 2-reflections on this ring, since it is
nontrivial. Then lemma 3.7 implies that
I

G{N
ppAN qhs
p qQ

pPq

is not Cohen-Macaulay. Therefore, by theorem 3.1, neither is pAN qG{N “ AG .



22

BEN BLUM-SMITH AND SOPHIE MARQUES

∆{G satisfies (2)

Reisner etc. (§2.2)

kr∆{Gs is CM

Reiner (§2.2)

kr∆sG is CM

Lange’s theorem (§4.1)

Garsia-Stanton/Reiner (§2.2)

G gen by 2-reflections

krxsG is CM

G not gen by 2-reflections

If char k “ p, krxsG is not CM

Lemma 4.5 (§4.2)

krxsN is CM
Dp with GBπ N{N – Z{p

Proposition 3.11 (§3)

Lemma 4.4 (§4.2)

DP Ÿ krxsN s.t. IG{N pPq – Z{p
Figure 5. Schematic diagram of the proof of theorem 1.2. Arrows are implications,
and small print above or interrupting an arrow names a result needed for the implication to go through. The §-references indicate where to look for statements and
notation definitions. The top half is the “if” direction (proposition 4.1). The bottom
half is the “only-if” direction (proposition 4.2). The group N is the subgroup of G
generated by the 2-reflections, so the “if” direction is required to conclude that krxsN
is Cohen-Macaulay in the bottom half.

4. Permutation invariants
In this section we prove the two directions of theorem 1.2. A schematic diagram of the
proof is found in figure 5.
4.1. The if direction. In this section we prove:
Proposition 4.1. If G is generated by transpositions, double transpositions, and 3-cycles,
then krxsG is Cohen-Macaulay regardless of the field k.
The groundwork has been laid in §2.2. The remaining piece of the proof is supplied by a
recent, beautiful result of Christian Lange, building on earlier work of Marina Mikhaı̂lova.
Let H be a finite subgroup of the orthogonal group Od pRq, acting on Rd . Endow Rd with

WHEN ARE PERMUTATION INVARIANTS COHEN-MACAULAY OVER ALL FIELDS?

23

its standard piecewise-linear (PL) structure. The topological quotient Rd {H carries a PL
structure such that the quotient map Rd Ñ Rd {H is a PL map, and the main result of [22] is
that it is a PL manifold (possibly with boundary) if and only if H is generated by 2-reflections.
(Lange calls elements of Od pRq fixing a codimension-2 subspace rotations since they rotate
a plane and fix its orthogonal complement, so he calls groups generated this way rotationreflection groups.) The bulk of the work in this result lies in the “if” direction. The proof is a
delicate induction on the group order, based on a complete classification of rotation-reflection
groups. This classification was proven in joint work with Marina Mikhaı̂lova ([23]).
Proof of proposition 4.1. Let G act on Rn by permutations of the axes. Let x1 , . . . , xn be the
coordinates on Rn . The subspace
#
+
n
ÿ
T“
xi “ 0
i“1

is G-invariant. Transpositions in G act as reflections on T, while double transpositions and
3-cycles act as rotations. Thus under the hypothesis of the proposition, G acts on T as a
rotation-reflection group. By Lange’s work ([22]), T{G is a PL manifold.
Recall the ∆ of section 2.2: it is the order complex of Bn ztHu, which is the first barycentric
subdivision of an pn ´ 1q-simplex. Embed the underlying topological space |∆| of ∆ in T as
follows. First, map the vertices of ∆ to the barycenters of the standard simplex
!
)
ÿ
xi ě 0,
xi “ 1
in Rn by mapping each vertex, which by definition is an element α P Bn ztHu, which is itself
a nonempty subset of rns, to the barycenter
1 ÿ
ei
|α| iPα

of the set of standard basis vectors tei uiPα corresponding to that subset. Then, extend this map
to all of ∆ by extending ř
linearly from the vertices to each simplex in ∆. Finally, project the
affine hyperplane plane t xi “ 1u containing the image orthogonally onto T via px1 , . . . , xn q ÞÑ
px1 ´ 1{n, . . . , xn ´ 1{nq. This embedding is G-equivariant for the action of G on |∆| induced
from its action on rns, and the present action of G on T.
The embedded complex |∆| Ă T is evidently a polyhedron, and it is a star of the origin
in T since it is the union of closed line segments from the origin to its compact boundary,
these segments are disjoint except for the origin itself, and it is a neighborhood of the origin
in T (see the definition of a star in §2.2). Since the action of G is linear, it permutes these
segments. Thus |∆|{G “ |∆{G| is also a union of line segments from the (image of the) origin
to its compact boundary, and these segments are disjoint except for the origin itself. Also,
|∆{G| is a neighborhood of the (image of the) origin since T Ñ T{G is the quotient map by a
group of homeomorphisms and is therefore an open map. It is additionally a polyedron since
the quotient map T Ñ T{G is PL, and the image of a compact polyhedron under a PL map is
a compact polyhedron ([31, Corollary 2.5]). In other words, |∆{G| is a polyhedral star of the
image of the origin in the PL pn ´ 1q-manifold T{G. It is therefore (per [31, pp. 20-21], see the
discussion at the end of §2.2) homeomorphic to a ball. In particular, it is contractible, thus
H̃i p|∆{G|; kq “ 0
for all i, regardless of the field k; and it is a manifold (with boundary), thus
Hi p|∆{G|, |∆{G| ´ q; kq “ 0

24

BEN BLUM-SMITH AND SOPHIE MARQUES

for all i ă n ´ 1 and all q P |∆{G|, regardless of k. Thus it satisfies (2) for all i ă dim ∆{G and
all q P |∆{G|, so by the discussion in §2.2, krxsG is Cohen-Macaulay.

4.2. The only-if direction. In this section we complete the proof of theorem 1.2 by proving
the converse of 4.1.
Proposition 4.2. If G is not generated by transpositions, double transpositions, and 3-cycles,
then there exists a prime p such that for any k of characteristic p, krxsG is not Cohen-Macaulay.
The proof is at the end of the section. Actually we prove somewhat more: for a group
G not generated by transpositions, double transpositions, and 3-cycles, we give an explicit
construction yielding the prime p. The precise statement is given below as proposition 4.2b.
In this section, p is conceptually prior to the field k. Our proof will first construct p and
then prove that when char k “ p, krxsG is not Cohen-Macaulay.
We develop the needed machinery for the proof. Let Πn be the poset of partitions of the
set rns, with the order relation given, for any π, τ P Πn , by
π ď τ ô π refines τ.
An element g P G Ă Sn partitions rns into orbits, and thus determines an element π P Πn .
This gives a map
ϕ : G Ñ Πn
g ÞÑ π.
If π P Πn , we write GBπ for the blockwise stabilizer of π in G, i.e. the set of elements of G
that act separately on each block of π.
For a given π P Πn , let P‹π be the prime ideal of krxs generated by the binomials xi ´ x j for
every pair i, j P rns lying in the same block of π. The dimension of P‹π (i.e. the dimension of
krxs{P‹π ) is the number of blocks of π.
Lemma 4.3. With this notation, we have
IG pP‹π q “ GBπ .
Proof. The ring krxs{P‹π is the polynomial ring obtained by identifying xi with x j for each i, j
in the same block of π, so its indeterminates are in bijection with the blocks of π. If h P GBπ ,
then h acts separately on the xi ’s in each block, and therefore h fixes P‹π setwise and the
induced action on krxs{P‹π is trivial. Thus h P IG pP‹π q. Conversely, if h R GBπ , then either h
fixes π but not blockwise, in which case h fixes P‹π setwise but the action of h on krxs{P‹π is
not trivial, so that h P DG pP‹π q but not IG pP‹π q; or else h does not fix π at all, in which case
it does not act on P‹π , and is not contained in DG pP‹π q, let alone IG pP‹π q.

If N is a normal subgroup of G, denote by GBπ N{N the image of GBπ in the quotient G{N,
and let
Pπ “ P‹π X krxsN .
Lemma 4.4. With this notation, we have
IG{N pPπ q “ GBπ N{N.
Proof. We have from lemma 2.10 that
IG{N pPπ q “ IG pP‹π q{IN pP‹π q “ IG pP‹π q{ pN X IG pP‹π qq ,
and from lemma 4.3 that
IG pP‹π q{pN X IG pP‹π qq “ GBπ {pN X GBπ q “ GBπ N{N.



WHEN ARE PERMUTATION INVARIANTS COHEN-MACAULAY OVER ALL FIELDS?

25

The following lemma is the device we use to find the characteristic p in which we can prove
that krxsG fails to be Cohen-Macaulay.
Lemma 4.5. Let NŸG be a proper normal subgroup. Let π be minimal in Πn among partitions
associated (via ϕ) with elements of G that are not in N. Then:
(1) The group GBπ N{N is cyclic of prime order, say p;
(2) any element g of GzN whose orbits are given by π has order a power of p, and
(3) the image of g in G{N generates GBπ N{N.
Proof. Let g be an element of GzN whose orbits are given by π, and let h be any other
nontrivial element of GBπ , in other words a nontrivial element of G whose orbits refine π.
(Note that, by minimality of π, either ϕphq “ π or else h P N.) Pick any element a P rns acted
on nontrivially by h. Then g acts nontrivially on a as well since h’s orbits refine g’s.
Since h preserves π and g acts transitively on each block of π, there is an m P Z such that
gm paq “ hpaq. Then h´1 gm paq “ a, so that h´1 gm both preserves π and has a fixed point a
that g does not have. Thus its orbits properly refine π, and minimality of π among partitions
associated to elements of GzN implies that h´1 gm P N. Thus hN “ gm N. This shows that
g generates the image of GBπ in G{N, proving 3; thus GBπ N{N is cyclic. Meanwhile, for any
prime p dividing the order of g, gp ’s orbits also properly refine g’s, so gp is in N too; thus g’s
image in G{N has order dividing p. Since g R N by construction, the order of g’s image in
G{N is exactly p. This completes the proof of 1. If q is a hypothetical second prime dividing
the order of g in G, then the order of g’s image in G{N is q, for the same reason it is p, and it
follows that q “ p after all, so there is no such second prime. Therefore g has p-power order
in G. This proves 2.

Proof of proposition 4.2. Let N be the subgroup of G generated by the transpositions, double
transpositions, and 3-cycles (i.e. 2-reflections). By proposition 4.1, krxsN is a Cohen-Macaulay
ring. Since krxs is a finitely generated algebra over k, krxsG is also finitely generated as an
algebra over k ([2, Chapitre V §1.9, Théorème 2]), so in particular it is noetherian. By the
same logic, krxsN is finitely generated as an algebra over k, and therefore over krxsG . Since it
is a subring of krxs, which is integral over krxsG by [2, Chapitre V §1.9, Proposition 22], it is
integral over krxsG as well, which, together with finite generation as an algebra, implies it is
actually finite over the noetherian ring krxsG . Thus if k is a field of positive characteristic p,
then proposition 3.11 applies, and we can show krxsG is not Cohen-Macaulay by exhibiting an
inertia group for the action of G{N on krxsN that is a nontrivial p-group.
Now if N is a proper subgroup of G per the hypothesis, then we can find a π P Πn that is
minimal among all partitions associated (via ϕ) with elements of GzN. Then lemma 4.5 gives
us a prime number p such that GBπ N{N is cyclic of order p, and then lemma 4.4 gives us a
prime ideal Pπ of krxsN such that
IG{N pPπ q “ GBπ N{N.
Thus, for any k of this specific characteristic, we can conclude by proposition 3.11 that krxsG
fails to be Cohen-Macaulay.

An examination of the proof in view of conclusion 2 of lemma 4.5 shows that we have
actually proven the following constructive version of proposition 4.2 with no additional work:
Proposition 4.2b. Let N be the subgroup of G generated by the transpositions, double transpositions, and 3-cycles. If N Ĺ G, then for any g P GzN whose orbits are not refined by the

26

BEN BLUM-SMITH AND SOPHIE MARQUES

orbits of any other g P GzN, the order of g is a prime power pℓ , where p has the property that
krxsG is not Cohen-Macaulay if char k “ p.

5. Conclusion and further questions
In this section we note some implications of the results above, and pose questions for further
exploration. Throughout, let N be the subgroup of G Ă Sn generated by the transpositions,
double transpositions, and 3-cycles, as at the end of §4.2.
5.1. Bad primes; relation to previous work. Given a permutation group G Ă Sn , let us
refer to the set of prime numbers p for which, if char k “ p, then krxsG fails to be CohenMacaulay, as G’s bad primes.
It was mentioned in the introduction that the “if” direction of theorem 1.2 implies that
G’s bad primes are a subset of the primes dividing rG : Ns. We see this as follows: the “if”
direction implies that krxsN is Cohen-Macaulay. Then, since
krxsG “ pkrxsN qG{N ,
it follows from the Hochster-Eagon theorem ([16, Proposition 13]) that krxsG is CohenMacaulay in any characteristic not dividing the order of G{N. Meanwhile, the “only-if” direction of theorem 1.2 implies that if the set of primes dividing rG : Ns is nonempty, then so is
G’s set of bad primes.
It was also mentioned in the introduction that the present work unites and generalizes
several previously known results: Reiner’s ([29]) theorem that the invariant rings of An and
the diagonally embedded Sn ãÑ Sn ˆ Sn are Cohen-Macaulay over all fields; Hersh’s ([14], [15])
similar theorem for the wreath product S2 ≀ Sn Ă S2n , and Kemper’s ([19]) theorems that in
the p-group case, the “only-if” direction of theorem 1.2 holds, and that the invariant ring of a
regular permutation group G is Cohen-Macaulay over all fields if and only if G “ C2 , C3 , or
C2 ˆ C2 , and in all other cases, every prime dividing |G| is a bad prime for G. Most of these
results are immediate implications of the “if” direction of theorem 1.2:
— The group An is generated by 3-cycles.
— The diagonal Sn ãÑ Sn ˆ Sn is generated by the double transpositions pi, i ` 1qpi ` n, i `
n ` 1q for i “ 1, . . . , n ´ 1.
— The wreath product S2 ≀Sn is generated by the transpositions p2i´ 1, 2iq and the double
transpositions p2i ´ 1, 2i ` 1qp2i, 2i ` 2q for i “ 1, . . . , n ´ 1.
— The regular representations of C2 , C3 , and C2 ˆ C2 are generated by (in fact, their
only nontrivial elements are) transpositions, 3-cycles, and double transpositions, respectively.
Recovering the other half of Kemper’s result on regular permutation groups (that every prime
dividing |G| is bad for G) from the present work requires the constructive version of the
“only-if” direction given in proposition 4.2b. Recall that if G acts regularly, i.e. freely and
transitively, on rns, then this action is isomorphic to G’s left-translation action on its own
elements. Then we have |G| “ n, and every element g of G splits rns into orbits of equal
length the order of g, because these orbits are in bijection with the right cosets xgyh, h P G.
If G acts regularly and |G| “ n ě 5, then G does not contain any transpositions, double
transpositions, or 3-cycles, so N is trivial. If p is any prime dividing |G|, then G has an
element g of order p, which, by the discussion in the last paragraph, partitions rns into orbits
of equal length p. This partition cannot be refined by any nontrivial partition with parts of

WHEN ARE PERMUTATION INVARIANTS COHEN-MACAULAY OVER ALL FIELDS?

27

equal length since p is prime; thus no element of GzN “ Gzt1u can have orbits refining g’s.
It follows from proposition 4.2b that p is a bad prime for G.
The remaining case is n “ 4 and G “ C4 . In this case, G is a 2-group not generated by its
lone double transposition, so it follows from theorem 1.2 that 2 is a bad prime for G.
5.2. Groups generated by transpositions, double transpositions, and 3-cycles. Theorem 1.2 calls attention to the family of permutation groups generated by transpositions,
double transpositions, and 3-cycles. One may wonder how extensive is this family of groups.
It turns out to be very limited. One can extract a classification from Lange and Mikhaı̂lova’s
classification of all rotation-reflection groups ([23]), but this is more power than is needed. In
the case that G is transitive, such groups were already classified in 1979 by W. Cary Huffman
([17, Theorem 2.1]):
(1) If G’s transpositions generate a transitive subgroup, then G “ Sn .
(2) If G contains a transposition but the transpositions do not act transitively, then n “ 2m
is even and G is isomorphic to the wreath product S2 ≀ Sm .
(3) If G does not contain a transposition but does contain a three-cycle, then G “ An .
(4) Otherwise, G contains no transpositions or 3-cycles and is generated by double transpositions. Then we have:
(a) If G contains a subgroup acting transitively on 5 points and fixing the rest, then
either n “ 5 and G – D5 in its usual action on the vertices of a regular pentagon,
or else n “ 6 and G – A5 – PSLp2, 5q in its transitive action on 6 points, e.g. the
six points of the projective line over F5 .
(b) If G contains a subgroup acting transitively on 7 points and fixing the rest, then
either n “ 7 and G – GLp3, 2q acting on the nonzero vectors of F32 , or else n “ 8
and G – AGLp3, 2q “ F32 ¸ GLp3, 2q acting on the points of A3F .
2

(c) If G does not contain either of these kinds of subgroups, then n “ 2m is even, and
G is isomorphic to the alternating subgroup of the wreath product S2 ≀ Sm .
When one considers intransitive groups G, one does not end up too far beyond direct products
of the above, since transpositions and 3-cycles can only act in a single orbit, while double
transpositions can only act in two orbits, as a transposition in each. For example, if G has
two orbits, the classification begins as follows. If G is not a direct product of the above, it
contains a double transposition that acts as a transposition in each orbit. Then its image in
each orbit contains a transposition, so is either Sn or S2 ≀ Sm by the above. The possibilities
are then highly constrained by Goursat’s lemma.
Thus theorem 1.2 shows that most permutation groups G have at least one bad prime.
5.3. Further questions. Since theorem 1.2 implies that the set of bad primes of G is contained in the set of prime factors of rG : Ns and is nonempty exactly when the latter is
nonempty, one might hope that these two sets are always equal. This is not the case. For
example, let G Ă S7 be the Frobenius group of order 21 generated by
p1234567q, p124qp365q.
All the nontrivial elements in this group are 7-cycles or double 3-cycles. Thus N is trivial in
this case, and the candidate bad primes are 3 and 7.
Now π “ t1, 2, 4u Y t3, 5, 6u Y t7u is a minimal partition as in lemma 4.5, and thus the
corresponding g “ p124qp365q generates an inertia group of order 3 for the action of G{N “ G

28

BEN BLUM-SMITH AND SOPHIE MARQUES

on krxsN “ krxs. Then proposition 4.2b shows that if k has characteristic 3, krxsG fails to be
Cohen-Macaulay; i.e. 3 is a bad prime for this G.
On the other hand, 7 is not a bad prime for this G. This can be seen using the criterion
given by Kemper in [20, Theorem 3.3], since 7 divides |G| just once. Thus, a prime can divide
rG : Ns without being bad. (By a computer calculation, no example of this phenomenon
occurs below degree 7.)
At the other extreme, one might hope that the bad primes of G are only those which are
furnished by proposition 4.2b. This is not true either. Take G “ D7 , the dihedral group
of order 14 acting on the vertices of a heptagon, which is also a Frobenius group. Now, all
the nontrivial elements are 7-cycles and triple transpositions, so again, N is trivial, and the
candidate bad primes are 2 and 7. This time, they both really are bad primes. One can see
this using Kemper’s criterion [20, Theorem 3.3]. For 2 it also follows from proposition 4.2b,
but for 7 it does not, since the 7-cycles have orbits that are properly refined by the triple
transpositions.
Thus it remains to be determined, for a given G, exactly which primes are bad. Theorem
1.2 gives us a finite list of candidate bad primes (those dividing rG : Ns), and, if this list is
nonempty, proposition 4.2b gives us some specific primes that are definitely bad. Among the
remaining candidate bad primes, if any divide |G| only once, [20, Theorem 3.3] can be used
to determine if they are actually bad. What remains to be determined is whether p is a bad
prime if p2 | |G| and p is not associated to a g P GzN with minimal orbits as in proposition
4.2b.
Question 5.1. How can Cohen-Macaulayness of krxsG be assessed when [20, Theorem 3.3]
and the present work are both inapplicable, i.e. when p | rG : Ns and p2 | |G|, but p does not
come from a minimal g P GzN as in proposition 4.2b?
Another line of inquiry that flows from the present work has to do with the relationship
between the arguments in the “if” and “only-if” directions. The proof of the “if” direction is
a mildly revised version of an argument given by the first author in his doctoral thesis [1].
In that same work, he also proved the “only-if” direction for kr∆sG (see §2.2 for notation),
but not for krxsG . There, the “only-if” argument was framed in the same topological language
as the “if” argument, which is why it applied to kr∆sG (taking advantage of Stanley-Reisner
theory) but not krxsG . The second author suggested to transfer the “only-if” argument from
topological into commutative-algebraic language, and much of the present paper sprang from
this suggestion.
This transfer was accomplished piecemeal, with an individual search for each commutativealgebraic fact needed to replace each topological fact. For example, Raynaud’s theorem
(lemma 2.14) replaced an elementary principle about the relationship between point stabilizers and the local structure in a topological quotient. The well-behavedness of inertia groups
with respect to normal subgroups (lemma 2.10) replaced an elementary fact about group actions on a set. The observation that inertia p-groups obstruct Cohen-Macaulayness if they are
not generated by 2-reflections (lemma 3.7), based on Lorenz and Pathak’s [25, Corollary 4.3],
replaced an argument about the homology of links in the quotient of a simplicial complex.
Nonetheless, the authors had the conviction throughout that an overarching principle was
at play. It may be fruitful to seek a more comprehensive understanding of the relationship
between the topology and the algebra. Stanley-Reisner theory gives a partial answer to this
question, but it does not appear to account for the “only-if” direction of theorem 1.2, so a
fuller picture is desirable.
Here are two more focused questions that approach this inquiry from various directions:

WHEN ARE PERMUTATION INVARIANTS COHEN-MACAULAY OVER ALL FIELDS?

29

Question 5.2. Is there a purely algebraic proof of theorem 1.2, making no use of StanleyReisner theory or Lange’s result on PL manifolds?
Question 5.3. For a fixed p “ char k as in question 5.1, can krxsG be Cohen-Macaulay without
kr∆{Gs being Cohen-Macaulay?
6. Acknowledgement
The authors wish to thank Gregor Kemper, Victor Reiner, and Christian Lange for fruitful
discussions and comments, Tom Zaslavsky for alerting them to the conventional partial order
on Πn , and an anonymous referee for very helpful comments.
The second author’s work on this project was partially supported by a grant from the
National Research Foundation of South Africa.
Parts of this work originally appeared as part the first author’s doctoral thesis under the
supervision of Yuri Tschinkel and Fedor Bogomolov at the Courant Institute of Mathematical
Sciences at NYU.
References
[1] B. Blum-Smith, Two inquiries about finite groups and well-behaved quotients. PhD thesis, New York University,
New York City, New York, 2017.
[2] N. Bourbaki, Algèbre Commutative: Chapitres 5 à 7. Springer, Berlin, Heidelberg, New York, 2007.
[3] W. Bruns and J. Herzog, Cohen-Macaulay Rings. Cambridge University Press, Cambridge, 1993.
[4] H. E. A. Campbell, A. V. Geramita, I. P. Hughes, R. J. Shank, and D. L. Wehlau, Non-Cohen-Macaulay vector
invariants and a Noether bound for a Gorenstein ring of invariants. Canadian Mathematical Bulletin 42(2): 155–161,
1999.
[5] E. Dufresne, J. Elmer, and M. Kohls, The Cohen-Macaulay property of separating invariants of finite groups.
Transformation Groups 14:771–785 , 2009.
[6] A. M. Duval, Free resolutions of simplicial posets. Journal of Algebra 188: 363–399, 1997.
[7] D. Eisenbud, Commutative Algebra with a View Toward Algebraic Geometry. Springer, New York, New York, 2004.
[8] G. Ellingsrud and T. Sjelbred, Profondeur d’anneaux d’invariants en caractéristique p. Compositio Mathematica
41(2): 233–244, 1980.
[9] A. M. Garsia, Combinatorial methods in the theory of Cohen-Macaulay rings. Advances in Mathematics 38: 229–266,
1980.
[10] A. M. Garsia and D. Stanton, Group actions on Stanley-Reisner rings and invariants of permutation groups. Advances
in Mathematics 51: 107–201, 1984.
[11] N. Gordeev and G. Kemper, On the branch locus of quotients by finite groups and the depth of the algebra of
invariants. Journal of Algebra 268:22-38, 2003.
[12] A. Grothendieck and J. Dieudonné, Éléments de Géométrie Algébrique IV. Publications mathématiques de l’I.H.É.S.
32, Le Bois-Marie et Bures-sur-Yvette, 1967.
[13] T. D. Hamilton and T. Marley, Non-Noetherian Cohen-Macaulay rings. Journal of Algebra 307(1): 343–360, 2007.
[14] P. Hersh, Lexicographic shellability for balanced complexes. Journal of Algebraic Combinatorics 17: 225–254, 2003.
[15] P. Hersh, A partitioning and related properties for the quotient complex ∆pBlm q{Sl ≀ Sm . With an appendix by Victor
Reiner. Journal of Pure and Applied Algebra 178: 255–272, 2003.
[16] M. Hochster and J. A. Eagon, Cohen-Macaulay rings, invariant theory, and the generic perfection of determinantal
loci. American Journal of Mathematics 93(4): 1020–1058, 1971.
[17] W. C. Huffman, Imprimitive linear groups generated by elements containing an eigenspace of codimension two.
Journal of Algebra 63: 499–513, 1980.
[18] V. Kac and K. Watanabe, Finite linear groups whose ring of invariants is a complete intersection. Bulletin of the
American Mathematical Society 6: 221–223, 1982.
[19] G. Kemper, On the Cohen-Macaulay property of modular invariant rings. Journal of Algebra 215(1): 330–351, 1999.
[20] G. Kemper, The depth of invariant rings and cohomology. Journal of Algebra 245(2): 463–531, 2001.
[21] G. Kemper, The Cohen-Macaulay property and depth in invariant theory. In Proceedings of the 33rd Symposium
on Commutative Algebra in Japan 53–63, 2012.

30

BEN BLUM-SMITH AND SOPHIE MARQUES

[22] C. Lange, Characterization of finite groups generated by reflections and rotations. Journal of Topology 9(4): 1109–
1129, 2016.
[23] C. Lange, and M. Mikhaı̂lova, Classification of finite groups generated by reflections and rotations. Transformation
Groups 21(4): 1155–1201, 2016.
[24] Q. Liu, Algebraic Geometry and Arithmetic Curves. Oxford University Press, Oxford, Great Britain, 2002.
[25] M. Lorenz, and J. Pathak, On Cohen-Macaulay Rings of Invariants. Journal of Algebra 245(1): 247–264, 2001.
[26] J. R. Munkres, Topological results in combinatorics. Michigan Math. J. 31: 113–128, 1984.
[27] M. Neusel and L. Smith, Invariant Theory of Finite Groups. American Mathematical Society, Providence, Rhode
Island, 2002.
[28] M. Raynaud, Anneaux locaux henséliens. Lecture Notes in Mathematics, Vol. 169. Springer-Verlag, Berlin, 1970.
[29] V. Reiner, Quotients of Coxeter complexes and P-partitions. American Mathematical Society, Providence, Rhode
Island, 1992.
[30] G. A. Reisner, Cohen-Macaulay quotients of polynomial rings. Advances in Mathematics 21: 30–49, 1976.
[31] C. P. Rourke and B. J. Sanderson, Introduction to Piecewise-Linear Topology. Springer-Verlag, Berlin, Heidelberg,
1982.
[32] L. Smith, Polynomial Invariants of Finite Groups. A K Peters, Wellesley, MA, 1995.
[33] L. Smith, Some rings of invariants that are Cohen-Macaulay. Canadian Mathematical Bulletin 39(2): 238–240, 1996.
[34] R. P. Stanley, Enumerative Combinatorics, Volume I. Wadsworth and Brooks/Cole, Monterey, CA, 1986.
[35] R. P. Stanley, f -vectors and h-vectors of simplicial posets. Journal of Pure and Applied Algebra 71: 319–331, 1991.
E-mail address: ben@cims.nyu.edu
E-mail address: sophie.marques@uct.ac.za

