THE SHANNON-MCMILLAN-BREIMAN THEOREM
BEYOND AMENABLE GROUPS

arXiv:1701.03965v1 [math.DS] 14 Jan 2017

AMOS NEVO AND FELIX POGORZELSKI
Abstract. We introduce a new isomorphism-invariant notion of entropy for measure preserving
actions of arbitrary countable groups on probability spaces, which we call cocycle entropy.
We develop methods to show that cocycle entropy satisfies many of the properties of classical
amenable entropy theory, but applies in much greater generality to actions of non-amenable
groups. One key ingredient in our approach is a proof of a subadditive convergence principle
which is valid for measure-preserving amenable equivalence relations, going beyond the OrnsteinWeiss Lemma for amenable groups.
For a large class of countable groups, which may in fact include all of them, we prove
the Shannon-McMillan-Breiman pointwise convergence theorem for cocycle entropy in their
measure-preserving actions.
We also compare cocycle entropy to Rokhlin entropy, and using an important recent result
of Seward we show that they coincide for free, ergodic actions of any countable group in the
class. Finally, we use the example of the free group to demonstrate the geometric significance
of the entropy equipartition property implied by the Shannon-McMillan-Breiman theorem.

Contents
1. Introduction
2. Statement of main results
2.1. Probability measure preserving actions of groups and cocycle extensions
2.2. Definition of cocycle entropy
2.3. Cocycle entropy, finitary entropy and Rokhlin entropy
2.4. The Shannon-McMillan-Breiman theorem
3. Amenable equivalence relations
3.1. Measurable equivalence relations
3.2. Hyperfiniteness and amenability
4. Subadditive convergence and entropy
5. Pointwise covering lemmas
6. Proof of the Shannon-McMillan-Breiman theorem
7. Amenable relations, injective cocycles and ergodic extensions
7.1. Groups admitting injective cocycles
7.2. Ergodicity of cocycle extensions
8. The free group
8.1. The boundary of the free group
8.2. The horospherical relation and the fundamental cocycle
8.3. Shannon-McMillan-Breiman theorem for the free groups
References

2
5
6
6
7
8
9
10
11
12
15
18
24
24
25
27
27
27
28
29

Date: January 17, 2017.
Key words and phrases. Ergodic group actions, entropy, measured equivalence relations, hyperfiniteness.
The first author acknowledges the support of ISF grant # 2022962. The second author gratefully acknowledges
support through a Technion Fine fellowship .
1

2

AMOS NEVO AND FELIX POGORZELSKI

1. Introduction
Classical amenable entropy theory. The notion of entropy as an isomorphism invariant of
dynamical systems originated in the work of Kolmogorov and Sinai, who defined entropy for
probability measure preserving (p.m.p.) actions of Z and studied its basic properties [Ko58,
Ko59, Si59]. Entropy theory has been developed extensively and has played a major role in the
theory of dynamical systems ever since. One of the main themes of development has been the
program of extending entropy theory to the class of dynamical systems defined by p.m.p. actions
of amenable groups. In particular, [OW87] settled the problem of classifying Bernoulli shifts for
countable amenable groups by the value of the entropy of the underlying dynamical system. A
central goal of classical entropy theory has been ”entropy equipartition” results, established by
Shannon [Sh48], McMillan [Mc53] and Breiman [Br57] and culminating in the Shannon-McMillanBreiman pointwise convergence theorem, a major achievement of the classical theory. In the
more general context of amenable groups, the Shannon-McMillan mean convergence theorem for
countable amenable groups has been established by Kieffer [Ki75], and a subadditive ergodic
theorem for entropy has been established by Ollagnier [Ol85]. Further, pointwise convergence
for countable amenable groups admitting regular Følner sequences is due to Ornstein and Weiss
[OW83]. The Shannon-McMillan-Breiman pointwise pointwise convergence theorem for tempered
Følner satisfying a mild growth condition was established by Lindenstrauss [Li01]. This latter
result was extended by Weiss [We03] to the case of non-ergodic actions and without a growth
assumption on the sequences in question. The proof is based on previous joint work of Ornstein
and Weiss, and avoids the random tiling and covering arguments used in [Li01].
Anticipating our discussion below, let us note that our approach to entropy theory has the
significant advantage that it treats amenable and non-amenable groups on an equal footing, and
thus allows us to make extensive use of the methods and ideas developed in the discussion of
entropy theory of amenable groups, and apply them to the setting of non-amenable group.
Entropy for actions of non-amenable groups. The problem of developing entropy theory
for p.m.p. actions of non-amenable countable groups remained open for nearly half a century, but
has seen remarkable ground-breaking progress in recent years. The first major breakthrough was
the introduction by Bowen (see [Bo10b][Bo10c][Bo12]) of the concept of sofic entropy and the
developments of its main properties as an isomorphism-invariant for p.m.p. actions of sofic groups.
While this is certainly a very large class of groups, it is not yet known whether it includes all
countable groups or not. Bowen’s notion of sofic entropy was developed further by Kerr and Li,
[Ke13, KL11]. In particular, sofic entropy constitutes a major extension of the classical entropy
theory of p.m.p. group actions, since for amenable groups, sofic entropy coincides with the classical
Kolmogorov-Sinai entropy [Bo12, KL13].
Another important breakthrough in entropy theory, for actions of completely arbitrary groups,
has recently been obtained by Seward, who introduced the concept of Rokhlin entropy. As for
the case of sofic entropy, for amenable groups this notion coincides with the classical KolmogorovSinai entropy as well, a result due to Rokhlin for the classical case of Z-actions, and to Seward
and Tucker-Drob in general [ST12]. Furthermore, Seward proved several remarkable results about
Rokhlin entropy, including the fact that every ergodic group action with finite Rokhlin entropy
admits a finite generating partition [Se14, Thm. 1.3]. This greatly extends the classical finite
generator theorems of Rokhlin and Krieger [Ro67, Kr70], to actions of general countable groups.
This result is material for our work since the Shannon-McMillan-Breiman theorem proposed in
Theorem 2.7 below is valid in the context of finite partitions. Moreover, in [Se15, Se16], Seward
implicitly deals with another notion of entropy which we will call finitary entropy below. It follows
from the fundamental inequality stated in [Se16, Thm. 1.5] that finitary entropy and Rokhin
entropy coincide for free, ergodic p.m.p. actions of arbitrary countable groups, a result that will
be crucial in our considerations below.
Main results of the present paper. Let us note that while the three notions of entropy
mentioned above - sofic, Rokhlin and finitary - generalize the classical entropy of amenable groups,
none of them gives rise to an entropy equipartition theorem in the form of a Shannon-McMillan

THE SHANNON-MCMILLAN-BREIMAN THEOREM FOR GROUP ACTIONS

3

mean convergence theorem or a Shannon-McMillan-Breiman pointwise convergence theorem. The
present paper is devoted to solving this problem, as follows.
• We define a new isomorphism-invariant notion of entropy for probability measure preserving (p.m.p.) actions of a very extensive class of groups, which may in fact coincide with
the class of all countable infinite groups. We establish the existence of this invariant, which
we call cocycle entropy, via a new general subadditive convergence theorem for actions of
non-amenable groups (see Theorem 2.1).
• We show that cocycle entropy is naturally bounded from below by finitary entropy and
bounded from above by Rokhlin entropy (see Theorem 2.6). It follows that for free,
ergodic p.m.p. countable group actions, cocycle entropy coincides with Rokhlin entropy
and finitary entropy.
• We prove an analog of the Shannon-McMillan-Breiman pointwise convergence theorem
for cocycle entropy, under a suitable ergodicity assumption (see Theorem 2.7). As a
consequence, an analog of the Shannon-McMillan mean convergence theorem follows (see
Corollary 2.8).
Let us add the following comments.
1) In the classical theory one defines the entropy of a partition as a limit of the normalized Shannon entropy of refinements of that partition. The crucial tool in this undertaking
are abstract subadditive convergence theorems. The corresponding statement for Følner sequences in amenable groups is also called the Ornstein-Weiss Lemma. In the context of discrete, amenable structures, there are multiple versions of this result in the literature, cf. e.g.
[OW87, Gr99, LW00, CCK14, Po14]. We will formulate a new subadditive convergence principle
and use it to establish convergence in the mean of the normalized Shannon entropy of a sequence
of successive refinements of a given partition of the underlying probability space, thus establishing
the existence of cocycle entropy (see Theorem 2.1).
2) The subadditive convergence theorem we establish is the first subadditive convergence principle that we are aware of for actions of non-amenable groups. It is valid for general subadditive
functions and its usefulness is not restricted to convergence of measure-theoretic information functions (see Theorem 4.2). In particular, it can be used to define a notion of topological entropy for
certain actions of non-amenable groups on compact metric spaces, thus raising also the possibility
of a variational principle for cocycle entropy.
The method of the proof : from amenable groups to amenable equivalence relations.
Given a p.m.p. action of a group Γ on (X, λ), a main preoccupation in ergodic theory is to
establish convergence properties for averages
Pdefined by a sequence of finite subsets Fn ⊂ Γ. Thus
ergodic theorems concern the averages |F1n | γ∈Fn f (γ −1 x) for a measurable function f on X, and
the Shannon-McMillan-Breiman theorem concerns the convergence of the normalized information
functions, given in integrated form by


_
1
H
γ −1 P  ,
|Fn |
γ∈Fn

where P is a (finite) partition of X and H denotes the Shannon entropy.
An mentioned briefly above, an elaborate and very useful set of techniques was developed when
the group Γ is amenable, and the sequences Fn are asymptotically invariant (often satisfying some
additional properties). These techniques allow for rather complete solutions to both convergence
problems in the amenable case. Remarkably, it is possible to develop a point of view that treats
amenable groups and non-amenable groups on an equal footing, thus raising the very attractive
possibility of leveraging the arguments of classical amenable ergodic theory to deduce analogous
results in the non-amenable case. The point view in question is based on the following heuristics.
Suppose that R is an amenable probability-measure-preserving Borel equivalence relation on a
space Y , with countable classes. Suppose that α : R → Γ is a measurable cocycle. Let there
be given a sequence of finite subset functions Fn with Fn (y) ⊂ [y]R , which are asymptotically
invariant under the relation in a suitable sense. We then obtain a collection of finite subsets of Γ,

4

AMOS NEVO AND FELIX POGORZELSKI

depending on the parameter y ∈ Y , P
given by y 7→ {α(y, z) ; z ∈ Fn (y)}. We can then consider the
convergence of the averages |Fn1(y)| z∈Fn (y) f (α(y, z)x), with f being a measurable function on
X, and the convergence of the information functions, given in integrated form by

_
1
H
|Fn (y)|

z∈Fn (y)



α(y, z)P  ,

(1.1)

where P is a finite partition of X. Given this set-up, it is to be expected that the amenability
of the equivalence relation R and the asymptotic invariance of the subset functions Fn (y) can be
utilized using the classical arguments of amenable ergodic theory to prove convergence.
This point of view was initiated and developed in [BN13a][BN13b][BN15a][BN15b], where it
was applied to prove mean and pointwise convergence theorems for averages of functions on X.
The present paper is concerned with the application of this method to the case of convergence of
information functions. For this purpose, we consider a specific kind of asymptotically invariant
subset functions Fn , namely we choose them to be an increasing
sequence of subequivalence
S
relations Rn of R consisting of finite classes, such that R = n∈N Rn (a hyperfinite exhaustion).
The generality of our approach is based on the fact that every amenable p.m.p. equivalence relation
admits such a sequence, a result due to Connes, Feldman and Weiss [CFW81]. A natural question
that arises here is to what extent can general asymptotically invariant sequences Fn (which can
often be defined in geometric terms, e.g. via horospheres in hyperbolic groups) be approximated
by hyperfinite sequences. We plan to address this issue and the issue of establishing amenability
of equivalence relations in terms of combinatorial asymptotic invariance, in a separate paper.
It is a vindication of the point of view described above that our proof of the Shannon-McMillanBreiman theorem proceeds by adapting the intricate overall strategy and some of the ingenious
arguments developed in the amenable group case by E. Lindenstrauss in [Li01], to the setting
of amenable equivalence relations. As in the situation of amenable groups, there are two major
ingredients for the proof. The first is an abstract covering lemma for the averaging sequences
under consideration. We prove a corresponding assertion in Lemma 5.2. Using the hyperfinite
structure of the equivalence relation, we are able to avoid some difficult technicalities that appear
in [Li01] such as the construction of random collection of tilings and establishing control of the
overlapping of different tiles. The second ingredient is a suitable pointwise ergodic theorem. For
the classical setting, it was observed in [OW83] that the pointwise ergodic theorem is the crucial
dynamical tool for the proof of the Shannon-McMillan-Breiman theorem. We will use the pointwise
ergodic theorem proved in [BN13b], but note that in our present setting of hyperfinite equivalence
relations, the required pointwise convergence also follows in a straightforward manner from the
martingale convergence theorem.
Let us turn to comment briefly on precursors to our approach in the literature. The usefulness
of coycles for problems in ergodic theory, and in particular for entropy questions, has already
been observed in [RW00], where Rudolph and Weiss show that p.m.p. actions of amenable groups
which have the completely positive entropy property have strong mixing properties. For the proof
of the main theorem, the authors employ orbit equivalence theory, where cocycles mapping from
the orbit equivalence relation of one (amenable) group into another (amenable) group appear
naturally. Another interesting precursor to our approach has been developed by Danilenko [Da01]
and by Danilenko and Park [DP02]. In particular, [Da01] introduced the information function (1.1)
for a given amenable relation R and a cocycle α : R → Γ. Its properties were studied in [Da01] and
[DP02] when Γ is amenable. However, the notion of entropy considered by Danilenko and Park is
not suitable for our purposes, since in all the examples we will consider in this paper it assumes the
value ∞. In [Av10], Avni studies entropy defined via cocycles arising from cross sections in locally
compact amenable groups. Among other interesting results, he proves a Shannon-McMillan type
theorem for the underlying notion of entropy in this case.
We note, however, that considering cocycles taking values in non-amenble groups and establishing the validity of the corresponding subadditive convergence principle, as well as of the ShannonMcMillan-Breiman theorem, have no precedents in the literature that we are aware of.

THE SHANNON-MCMILLAN-BREIMAN THEOREM FOR GROUP ACTIONS

5

Entropy equipartition and the geometric significance of cocycle entropy. One of the
most important aspects of the classical Shannon-McMillan-Breiman theorem is that it establishes
an ”entropy equipartition” property of the dynamical system under
W consideration. This property
asserts that the size of a typical atom in the partition Fn = γ∈Fn γ −1 P is comparable to
exp (−h(P) |Fn |), where h(P) is the Shannon entropy of the partition P. In particular, refining P
by the action of the elements γ ∈ Fn in the space X eventually produces refined partitions with
most atoms of roughly the same size. The analog of the Shannon-McMillan-Breiman theorem
that we prove for cocycle entropy implies the analogous equipartition property, upon refining the
partition P of X by the sets {α(y, z) ; z ∈ Rn (y)} ⊂ Γ, and thus expresses a property which is
directly connected to the dynamics of the group action on X.
It is a very natural problem to study what are the sets of group elements that arise in the
form {α(y, z) ; z ∈ Rn (y)}, namely as the cocycle images of hyperfinite exhaustions Rn (y). We
emphasize that in many geometric situations, it is possible to give a very concrete and meaningful
description of such sets, and this fact constitutes one of the main advantages of the definition of
cocycle entropy. We will exemplify this statement in complete detail in §8 below for actions of
finitely generated free groups Fr . In that case, choosing R as the horospherical (=synchronous
tail) relation on the boundary ∂Fr = Y of the free group, and α the canonical cocycle on it, the
equivalence classes [ω]R (where ω ∈ ∂Fr ) constitute a combinatorial construction of the unstable
leaves of the horospherical foliation. Their images α(ω, ξ) ∈ Fr for ξ ∈ Rn (ω) under the canonical
cocycle coincide with the intersection of the word metric ball B2n (e) in Fr with the horoball based
at ω and passing through e. Thus the Shannon-McMillan-Breiman theorem asserts in this case that
refining a partition of X along the sequence of (the inverses of) horospherical balls of increasing
radii in the group has the entropy equipartition property almost surely. Namely, the information
functions of the refined partitions converge to the cocycle entropy of the partition. We remark
that a similar geometric interpretation holds in much greater generality, and serves as evidence for
the existence of deep connections between the theory of p.m.p. actions of a non-amenable group,
and the theory of its amenable actions, particularly its actions on its Poisson boundaries. We
will briefly comment further on these topics in §§7 and 8 below, and plan to give a more detailed
exposition elsewhere.
Organization of the present paper. The paper is organized as follows. In Section 2 we
present and discuss the main results of our work in detail. Section 3 is devoted to the discussion
of amenability of measured equivalence relations and to hyperfinite exhaustions. Next, we prove a
subadditive convergence theorem which amounts to an integrated Ornstein-Weiss type lemma in
Section 4. We then establish pointwise covering and tiling lemmas for hyperfinite exhaustions in
amenable equivalence relations in Section 5. Those statements will be the crucial tools in the proof
of the Shannon-McMillan-Breiman theorem. This latter assertion is proven in Section 6, along
with the Shannon-McMillan L1 -convergence theorem. In Section 7, we describe the generality of
the framework in which the Shannon-McMillan-Breiman theorem holds true. We illustrate the
convergence theorems by explicating the case of the free group in Section 8.
Acknowledgements. The authors would like to thank Lewis Bowen, Brandon Seward and
Benjamin Weiss for several enlightening and useful conversations and for their comments on a
preliminary version of the present manuscript.

2. Statement of main results
In the present section, we will briefly mention some key definitions, and then state our main
results. A detailed discussion of all relevant concepts will appear in subsequent sections devoted
to the proofs of the main results.
Throughout the paper, we consider standard Borel equivalence relations with countable classes
R ⊂ Y × Y , where (Y, ν) is a probability space. [y] = R(y) ⊂ Y denotes the R-class of y ∈ Y . We
assume that the equivalence relation preserves the probability measure ν. It is further assumed
that R is hyperfinite, or equivalently, that R is amenable in the sense of [CFW81]. Thus R can

6

AMOS NEVO AND FELIX POGORZELSKI

be written as an increasing union of equivalence subrelations Rn ⊂ R, each with finite classes, i.e.
R(y) :=

∞
[

Rn (y), for ν-almost every y ∈ Y.

n=1

Such a representation of R will be called a hyperfinite exhaustion. If for every n, the relations
Rn are bounded, namely the size of the equivalence classes Rn (y) is essentially bounded (with
a bound depending on n), we will call the representation a bounded hyperfinite exhaustion. Let
us note that hyperfinite relations always admit a bounded hyperfinite exhaustion, as will be seen
below. In fact it is possible to construct a hyperfinite exhaustion satisfying |Rn (y)| ≤ n almost
surely, as noted in [We84] in a more general context.
2.1. Probability measure preserving actions of groups and cocycle extensions. Throughout the paper, Γ denotes a countable group. The collection of all finite subsets of Γ is denoted by
F in Γ . We consider a probability measure preserving (p.m.p.) ergodic action Γ y (X, λ), and
aim to define a notion of entropy for the action.
To that end, assume that there is an amenable p.m.p. equivalence relation R over (Y, ν),
admitting a measurable cocycle α : R → Γ. Thus for ν-almost every y ∈ Y and every w, u, z ∈
[y] = R(y), the cocycle identity holds :



α z, u = α z, w · α w, u .
A crucial construction in our discussion is the equivalence relation, denoted RX , which is the
extension of the equivalence relation R by the cocycle α and the Γ-action on X. The extended
equivalence relation RX over X × Y, λ × ν is defined by the condition

(x, y), (x′ , y ′ ) ∈ RX ⇐⇒ yRy ′ and x = α(y, y ′ )x′ .

Assuming that the measure ν is R-invariant, it follows that λ × ν is RX -invariant, since the
Γ-action on X preserves λ. The projection map π : RX → R given by (x, y) → y is class injective,
namely injective on almost every RX -equivalence class.
Further, it is well known that an extension of an amenable action is amenable, and thus in
particular if R is amenable, so is RX . Thus, when R is hyperfinite, so is RX . But since the
extension is class-injective, in fact every hyperfinite exhaustion (Rn ) of R can be canonically
X
X
lifted to a hyperfinite exhaustion (RX
n ) of R , via Rn ((x, y)) = {(α(z, y)x, z) ; z ∈ Rn (y)}. Note
that if (Rn ) is a bounded hyperfinite exhuastion, then so is (RX
n ), with the same bounds on the
equivalence classes.
The cocycle α is called class injective if for ν-almost every y ∈ Y , we have that α(y, z) 6= α(y, w)
whenever w 6= z. In order to avoid degenerate cases, we will assume in the sequel that the cocycle
under consideration is class injective.
2.2. Definition of cocycle entropy. In order to define the measure theoretic entropy of the
p.m.p. Γ-action on X, recall first the following. For a countable measurable partition P = {Ai ; i ∈
I} of X the Shannon entropy H(P) is defined as
X


H P := −
λ(A) log λ(A) ,
A∈P

where we use the convention that
 0 · log 0 = 0. For two countable partitions P and Q, their
common refinement is P ∨ Q := P ∩ Q | P ∈ P, Q ∈ Q}. For a finite set F ∈ F in(Γ), we set
_
P F :=
g −1 P,
g∈F


	
where g −1 P = g −1 Ai ; i ∈ I . If F is the empty set, then we define P F to be the trivial partition,
which of course has Shannon entropy zero. Given two partitions P and Q, Q is called finer than
P or a refinement of P, denoted Q ≥ P, if for every Q ∈ Q, there is some P ∈ P such that Q ⊆ P
up to λ-measure zero.

THE SHANNON-MCMILLAN-BREIMAN THEOREM FOR GROUP ACTIONS

7

Now for a subset function F : Y → F in(Y ) (as always, with F (y) ⊂ R(y) a.e.) and a countable
partition P of X with H(P) < ∞, we consider the entropy function

 _
α(z, y)−1 P .
hP (F ) : Y → [0, ∞) : hP (F )(y) := H
z∈F (y)

We can now state our first main theorem which shows that we can attach a notion of cocycle
entropy to every partition P with finite Shannon entropy.
Theorem 2.1. Given a class injective cocycle on R, for every countable partition P of X with
H(P) < ∞, there is a number h∗P (α) such that for every bounded hyperfinite exhaustion (Rn ),

Z
hP Rn (y)
∗


hP (α) := lim
Rn (y) dν(y).
n→∞ Y

Let us highlight the crucial fact that it is part of the conclusion of Theorem 2.1 that the limit
is independent of the choice of the bounded hyperfinite exhaustion.

Remark 2.2. As can be seen from the proof of Theorem 2.1, the assumption on the cocycle being
class injective is not necessary for this convergence result. But we dispense with this additional
generality in order to make sure that the values h∗P (α) accurately reflect entropy theoretic information regarding the action of Γ on X.
In the following, the number h∗P (α) shall be called the cocycle entropy of the partition P for the
action Γ y (X, λ). Let us proceed to use it to define a notion of measure-theoretic entropy for the
dynamical system Γ y (X, λ) itself. For this, we must restrict ourselves to generating partitions,
i.e. countable partitions P for X such that (modulo null sets)
_
gP = B.
g∈Γ

Definition 2.3 (Cocycle entropy). Let (X, λ) be a p.m.p. ergodic action of Γ. Let α : R → Γ be
a class injective cocycle defined on a hyperfinite relation. The number

	
hC (Γ y X) := inf h∗P (α) | P countable, generating partition

is called the cocycle entropy for the action Γ y (X, λ) and for the injective cocycle α : R → Γ.

As we shall see presently, the cocycle entropy of a free ergodic action is an intrinsic invariant,
independent of the p.m.p. hyperfinite relation R, the bounded hyperfinite exhaustion Rn , and
the class injective cocycle α used to define it. This remarkable fact is ultimately based on the
important recent result established by Seward relating two completely different notions of entropy,
which we now proceed to describe.
2.3. Cocycle entropy, finitary entropy and Rokhlin entropy. The notion of Rokhlin entropy has its origin in Rokhlin’s studies of entropy for a single transformation. It has recently
been greatly generalized and studied intensively in the context of general group actions by Seward
in the series of papers [Se14, Se15, Se16]. Is particular, Seward defines
Definition 2.4 (Rokhlin entropy). Let Γ y (X, λ) be a p.m.p. ergodic group action. Then, the
number

	
hRok (Γ y X) := inf H(P) | P countable, generating partition

is called the Rokhlin entropy of the group action.

Seward and Tucker-Drob showed in [ST12] that for free ergodic actions of amenable groups,
Rokhlin entropy coincides with the classical Kolmogorov-Sinai entropy. In a recent important
breakthrough Seward [Se16] established the following upper bound for the Rokhlin entropy for
every countable, generating partition P, assuming the Γ action on X is essentially free.
_


1
hRok Γ y X ≤ inf
H
g −1 P .
(2.1)
T ∈F in(Γ) |T |
g∈T

8

AMOS NEVO AND FELIX POGORZELSKI

(In fact, Theorem 1.5 in [Se16] shows a stronger statement involving entropy conditioned on Γinvariant σ-algebras.)
Let us now note that by the standard subadditivity property of Shannon entropy (see Proposition 4.3 (iii) below), the right hand side of (2.1) is bounded from above by H(P). Hence, by
passing to the infimum over all generating partitions, we obtain in fact equality of the lower and
the upper bound. Let us therefore define the following notion of finitary entropy.
Definition 2.5 (Finitary entropy).

n
_

o


inf H
hfin Γ y X := inf
g −1 P /|T |  P countable, generating partition .
T ∈F in(Γ)

g∈T

By the preceding discussion, it follows from Seward’s inequality(2.1) that these two notions of
entropy coincide for ergodic (essentially) free actions: hfin Γ y X = hRok (Γ y X).
Using this result, it is not hard to show that our definition of cocycle entropy above gives rise
to the same value as well.
Theorem 2.6. Assume that Γ y (X, λ) is an ergodic essentially free p.m.p. action. Then,
for every amenable p.m.p. equivalence relation R over (Y, ν) and every class injective cocycle
α : R → Γ, we obtain



hfin Γ y X = hC Γ y X, α = hRok Γ y X .

Proof. Let P be a countable partition with finite Shannon entropy. Assume that (Rn ) is any
bounded hyperfinite exhaustion for R. Since the cocycle α is class injective, and Rn (y) is a finite
set almost surely, we obtain
_
 hP R (y)

1
n
−1
 ≤H P ,
H
g P ≤ 
inf

T ∈F in(Γ) |T |
Rn (y)
g∈T

for each n ∈ N and for ν-almost every y ∈ Y . Note that these inequalities remain valid even if
H(P) = ∞. In the case that there exist generating partitions with finite Shannon entropy, we
integrate over Y and pass to the limit as n → ∞. By Theorem 2.1 we conclude that hfin (Γ y
X) ≤ h∗P (α) ≤ H(P) independently of the cocycle α. Now taking the infimum over all generating
partitions, since by the discussion above hRok (Γ y X) = hfin (Γ y X), the above inequality
immediately implies equality of all three notions of entropy.


To conclude this subsection, let us comment briefly on the relation of the concept of entropy
described above to Bowen’s sofic entropy introduced in [Bo10c]. First, we note the fact that
for every sofic approximation Σ of a sofic group Γ, the corresponding sofic entropy hsof
Σ (Γ y
X) is bounded above by Rohklin entropy, cf. [Bo10c, Ke13]. It follows from Theorem 2.6 that
for essentially free actions, the same is true if we replace Rokhlin entropy by cocycle entropy.
N
Consequently, we can easily conclude that for sofic groups Γ and a Bernoulli shift Γ y (AΓ , Γ p)
with
P A being a countable alphabet and p = (pa ) denoting a probability vector with H(p) :=
is equal to	H(p). Indeed, the cocycle entropy is less
− a∈A pa log pa < ∞, the cocycle entropy

than or equal to H(p) since the sets [xa = i], i ∈ A form a generating partition of AΓ with
Shannon entropy H(p). Bowen shown that the sofic entropy for Bernoulli shifts is equal to H(p),
cf. Theorem 8.1 in [Bo10c] (see also the work of Kerr [Ke13], Theorem 4.2). Hence, since cocycle
entropy is bounded from below by sofic entropy, we obtain what we claimed. To the best of our
knowledge, the question of determining Rokhlin entropy for Bernoulli shifts over general countable
groups is still open.
2.4. The Shannon-McMillan-Breiman theorem. The generalization that we propose of the
Shannon-McMillan-Breiman theorem concerns mean or pointwise almost everywhere convergence
of a sequence of natural information functions on X. For a given countable partition P with
H(P) < ∞, we set

J (P)(x) := − log λ P(x) ,

THE SHANNON-MCMILLAN-BREIMAN THEOREM FOR GROUP ACTIONS

9

where we define P(x) to be the unique set A ∈ P containing the point x (namely the P-name of
x). Note that by definition, we have
Z


J P (x) dλ(x) .
H P =
X

Given an ergodic p.m.p. group action Γ y (X, λ), and a class-injective cocycle α : R → Γ consider
the extended relation RX over X × Y . For the proof of the Shannon-McMillan-Breiman theorem,
we will assume that the extended relation RX is ergodic. Though being a non-trivial assumption on
the equivalence relation and the action under consideration, ergodicity of the extension is satisfied
in many situations. One important example is that of arbitrary ergodic actions of irreducible
lattices in connected semisimple Lie groups with finite center. In general, a sufficient condition
in order to guarantee ergodicity of RX is weak mixing of the relation R over (Y, ν), as defined in
[BN13a]. For a more detailed elaboration of these issues, we refer the reader to Section 7.
We are now able to state the Shannon-McMillan-Breiman pointwise convergence theorem in
our context.
Theorem 2.7. Let Γ y (X, λ) be an ergodic essentially free p.m.p. action. Assume that R is an
amenable, p.m.p. equivalence relation, and α : R → Γ is a class injective cocycle, such that the
extended relation RX is ergodic. Then, for every bounded hyperfinite exhaustion (Rn ) satisfying
the growth condition
lim ess inf y |Rn (y)|/ log n = ∞
n→∞

the information functions satisfy the following convergence property. Given a finite partition P of
X, for (λ × ν)-almost every (x, y) ∈ X × Y ,

J P Rn (y) (x)
= h∗P (α),
lim
n→∞
|Rn (y)|

where h∗P (α) is the cocycle entropy of the partition P.

Let us point out that the growth condition on the (Fn ) is very mild, and in fact one can always
find bounded hyperfinite exhaustions which satisfy it. To see this, recall that any two ergodic
p.m.p. actions of amenable groups are orbit equivalent. This fact goes back to Dye [Dy59] for
a pair of (ergodic) Z-actions and was stated in full generality in [OW80]. For a survey on the
topic of orbit-equivalence, see also [Ga00]. Now in [CFW81] it was shown that any amenable
equivalence relation is hyperfinite and any hyperfinite relation is generated by the action of a
single transformation. This action is orbit equivalent to the standard odometer action, and we
can transfer the hyperfinite exhaustion of the odometer to the underlying equivalence relation
(using the orbit equivalence). It follows that bounded hyperfinite exhaustions satisfying the growth
condition required in Theorem 2.7 always exist.
We note that the analogous growth condition for (tempered) Følner sequences appears also
in E. Lindenstrauss’ proof of the Shannon-McMillan-Breiman theorem for amenable groups, see
Theorem 1.3 in [Li01]. In the survey paper [We03] Weiss gives a deterministic combinatorial proof
of the Shannon-McMillan-Breiman theorem based on previous joint work of Ornstein and Weiss.
This proof is valid for general tempered Følner sequences even without an additional growth
condition and also for non-ergodic actions, see Theorem 6.2 in [We03].
As a corollary of Theorem 2.7, we obtain the corresponding Shannon-McMillan theorem, asserting convergence of the information functions in L1 .
Corollary 2.8. Convergence in Theorem 2.7 holds for ν-almost every y ∈ Y in the L1 (X, λ)norm, and also in the L1 (X × Y, λ × ν)-norm.
We do not know whether one can also expect convergence in L1 (Y, ν) for λ-almost every x ∈ X.
3. Amenable equivalence relations
In this section, we discuss measured Borel equivalence relations which are amenable in the sense
of Connes, Feldman and Weiss [CFW81]. This condition was shown in that paper to be equivalent
to hyperfiniteness.

10

AMOS NEVO AND FELIX POGORZELSKI

3.1. Measurable equivalence relations. Consider a Borel measurable equivalence relation R
defined over a standard Borel probability space (Y, B(Y ), ν), namely R is a Borel measurable
subset of Y × Y with the properties
• (y, y) ∈ R for all y ∈ Y ,
• if (y, z) ∈ R, then (z, y) ∈ R for all y, z ∈ Y ,
• if (y, z) ∈ R and (z, w) ∈ R, then (y, w) ∈ R for all y, z, w ∈ Y .
Two points y and z are called R-equivalent points if (y, z) ∈ R, and the equivalence class is
denoted R(y) = [y] = [y]R . Each y ∈ Y determines a left and a right fiber in R, given by
Ry = {(y, z) ; zRy} ⊂ R and Ry = {(z, y) ; zRy} ⊂ R. We will always assume that for almost
every y, the fiber Ry (and hence also Ry ) is countable. cy will denote the counting measure on Ry ,
and cy the counting measure on Ry . Integrating the counting
R obtain two σR measures over Y , we
finite (but in general not finite) measures on R, namely ν̃l = Y cy dν(y) and ν̃r = Y cy dν(y). The
measure ν on Y is called R-non-singular if these two measures are equivalent. Note that (R, ν̃l )
is a standard Borel space, and πl : R → Y given by πl (y, z) = y is a measurable factor map, and
similarly for ν̃r and πr . Note that under the coordinate projection πl : R → Y , the integral above
expresses the measure disintegration of ν̃l with respect to ν. If ν̃l = ν̃r then we denote it by ν̃,
and then ν̃ as well as ν are called R-invariant, and R is called a probability-measure-preserving
(p.m.p.) equivalence relation. This is the only case we will consider below.
An inner automorphism of the relation R is a measurable mapping φ : Y → Y which is almost
surely bijective with measurable inverse and with its graph gr(φ) being contained in R. The
collection of all inner automorphisms gives rise to a group Aut(R) = [R], called the full group of
R. A countable subset Φ0 ∈ Aut(R) is said to be generating (for R) if for ν̃-almost all (y, z) ∈ R
there is some φ ∈ Φ0 such that z = φ(y). Φ0 of course generates a countable subgroup of Aut(R),
denoted Φ.
For measurable subsets A, B ⊆ Y of positive measure, we say that ψ is a partial transformation
if ψ : A → B is measurable, essentially bijective with measurable inverse and again, gr(ψ) ⊆ R.
The space F in(Y ) of finite S
subsets of a Borel space Y is a Borel space in a natural way, using the
obvious Borel structure on n∈N Y n /Sym(n). Measurable mappings of the form F : Y → F in(Y )
satisfying that for almost every y, the set F (y) consists of finitely many points equivalent to y,
are called subset functions of R. The possibility that F (y) = φ is the empty set is allowed. We
consider two subset functions T , S to be equal if the set {y | S(y) 6= T (y)} has zero measure.
We write S ⊂ T if S(y) ⊂ T (y) for ν-almost every y. Subset functions can be composed with
each other, inverted, and subtracted from each other. We refer to [BN13a] and [BN13b] for a full
discussion, and recall here the following definitions.
[

S ◦ T (y) :=

S(z),

z∈T (y)

T −1 (y) :=

S \ T (y) :=


	
z ∈ [y] | y ∈ T (z) ,

S(y) \ T (y).

A finite non-empty set D ⊂ Aut(R) gives rise to the subset function D(y) = {φ(y) ; φ ∈ D}. Given
a subset function T and a finite set D ⊂ Aut(R), D ◦ T is defined as above, and is given by
D ◦ T (y) :=

[

φ∈D


φ T (y) .

We will also use the notation D ◦ T for this expression. A subset K ⊆ R is said to be bounded if

	
kKk := ess-supy max |Ky |, |Ky | < ∞,


	

	
where Ky := z ∈ [y] | (z, y) ∈ K and Ky := z ∈ [y]
K . Analogously,
we say that a
 | (y, z) ∈ −1
	
subset function T is bounded, if kT k := ess-supy max |T (y)|, |T (y)| is finite.

THE SHANNON-MCMILLAN-BREIMAN THEOREM FOR GROUP ACTIONS

11

3.2. Hyperfiniteness and amenability. The relation R is called hyperfinite if there exists a
sequence (Rn ) consisting of subrelations Rn ⊂ R, where each Rn has finite classes, satisfying
Rn ⊆ Rn+1 , R =

∞
[

Rn .

n=1

We refer to such a sequence as a hyperfinite exhaustion of R. Note that each Rn is a subset
function as defined above. If each Rn is a bounded subset function we will call the hyperfinite
exhaustion a bounded hyperfinite exhaustion. Recall that it was proved by Connes, Feldman and
Weiss [CFW81, Thm. 10] that R being amenable is equivalent to R being hyperfinite.
Let us note that hyperfinite exhaustions are asymptotically invariant under inner automorphisms of finite rank, in the following sense (see also [BN13a], [BN13b]).
Proposition 3.1. If (Rn ) is a bounded hyperfinite exhaustion of the relation R, then S
there exists
an increasing sequence of finite subgroups Φn ⊆ Aut(R), n ≥ 1, such that Φ := n≥1 Φn is
generating for R and for all n ∈ N and φ ∈ Φn , the graph gr(φ) is contained in Rn .
In particular, for every φ ∈ Φ, there is an n0 ∈ N such that Rn (y) △ φ(Rn (y)) = ∅ for ν-almost
every y ∈ Y and every n ≥ n0 .
Proof. Let T be any equivalence subrelation of R with finite classes of bounded size. We can
divide Y to finitely many measurable T -invariant sets where the size of T (y) is fixed, and we can
restrict T to one of them. Without loss of generality we can thus assume that T has classes of fixed
size N in Y . As is well known (see e.g. [FM77, §4], or [CFW81, Lem. 3b]) the factor space Y /T
consisting of equivalence classes of T is a standard Borel space and admits measurable sections
J1 , . . . , JN : Y /T → Y such that {Ji (T (y)) ; 1 ≤ i ≤ N } = [y]T = T (y) for almost every y. Define
the cyclic permutation σT (y) given by J1 (T (y)) 7→ J2 (T (y)) 7→ · · · JN (T (y)) 7→ J1 (T (y)) in each
class, whose cycle length is N . Denote by φT the map on Y which coincides with σT (y) on each
class T (y), and denote the cyclic group generated by φT by ΦT . Then φT is measurable and
constitutes an inner automorphism of R which leaves invariant almost every class of the relation
T , and the group ΦT generates the relation T .
Applying this procedure to each of the finite bounded relations Rn and taking the union of the
corresponding groups, the stated result follows.

We proceed to state and prove another lemma which will be useful in our considerations below.
The statement of part (i) is very close to [BN13b, Lem. 2.8, 2.9], but we give full details in order
to eliminate the assumption of uniformity of the sets Rn that appears there. Part (ii) is close to
[Da01, Cor. 2.3] but we will use the form stated below so again give full details.
Lemma 3.2. Let R be hyperfinite and (Rn ) a bounded hyperfinite exhaustion.
(i) Assume that the subset function D is bounded. Then

Z 
Rn (y) △ D ◦ Rn (y)


dν(y) = 0.
lim
Rn (y)
n→∞ Y

(ii) Assume that T ⊂ R is a bounded sub-equivalence relation. For every ε > 0, and for all large
enough n ∈ N (depending on ε) there is a set Yn ⊆ Y with ν(Yn ) ≥ 1 − ε such that for all
y ∈ Yn

	
 z ∈ Rn (y) | T (z) ⊆ Rn (y) 


> 1 − ε · kT k .
(3.1)
Rn (y)

Proof. (i). First let us assume that D is defined by a finite set of inner automorphisms D =
{ψi , 1 ≤ i ≤ N } ⊂ [R]. It suffices to show that for each 1 ≤ i ≤ N

Z 
Rn (y) △ ψi (Rn (y))


lim
dν(y) = 0.
Rn (y)
n→∞ Y

12

AMOS NEVO AND FELIX POGORZELSKI

Using the invariance of the measure ν̃ and Rn (y) = Rn (z) for z ∈ Rn (y), we compute for ψ = ψi


Z
Z 
X 

ψ Rn (y) △ Rn (y)
1
{ψ(z)} \ Rn (y) dν(y)




dν(y)
≤
Rn (y)


Y Rn (y) z∈R (y)
Y
n
Z
X 

1
{ψ −1 (z)} \ Rn (y) dν(y)


+


Y Rn (y) z∈R (y)
n
Z
X 
−1 

Rn (z) {ψ(z)} \ Rn (z) dν(z)
=
Y y∈R (z)
n

+

Z

X

Y y∈R (z)
n

=

Z

Y


 

Rn (z)−1 {ψ −1 (z)} \ Rn (z) dν(z)



{ψ(z)} \ Rn (z) dν(z) +

Z

Y

 −1

{ψ (z)} \ Rn (z) dν(z).

Now since the union of the Rn is the full relation R, we obtain that the integrand tends to
zero pointwise almost surely as n → ∞. Since all integrands are bounded by 1, we can use the
dominated convergene theorem to deduce that the above integrals converges to zero as well. In the
general case, for every bounded subset function U, there exists a finite set of inner automorphisms
D such that U(y) ⊂ D(y) for a.e. y, as shown in the proof of Lemma 2.9 in [BN13b]. This
establishes the validity of the assertion (i).
(ii). Fix ε > 0. By (i), we can choose n(ε) ∈ N such that for n ≥ n(ε)

Z 
T ◦ Rn (y) \ Rn (y)


dν(y) < ε2 .
Rn (y)
Y
It is a consequence of Markov’s inequality that we can find a set Yn ⊂ Y with ν(Yn ) ≥ 1 − ε and
such that for all y ∈ Yn


T ◦ Rn (y) \ Rn (y)


< ε.
(3.2)
Rn (y)
Now suppose y ∈ Yn and (3.1) fails to hold for some ε > 0. Then there are at least ε kT k |Rn (y)|
many elements z ∈ Rn (y) with T (z) \ Rn (y) containing at least one element ez . T is a sub
equivalence relation consisting of disjoint cells, and each cell T (z) contains at most kT k points.
Thus there are at least ε |Rn (y)| many distinct such elements ez . However, this contradicts the
inequality (3.2).

4. Subadditive convergence and entropy
The notion of subadditivity and the convergence of subadditive functions along a suitable
family of sets are two key concepts in the development of ergodic theory of amenable groups.
In the present section we will extend the scope of this concept and develop a natural notion of
subadditivity for p.m.p. amenable equivalence relations, along bounded hyperfinite exhaustions.
This will be the crucial tool in the proof of Theorem 2.1, establishing the existence of cocycle
entropy as a limit of normalized information functions. By the standard subadditivity properties
of Shannon entropy, we show in Proposition 4.4 that the information functions hP (Rn (y)) are
subadditive functions in the sense proposed below. Applying the subadditive convergence lemma
below immediately gives the validity of Theorem 2.1.
Let us turn to state the definition of subadditive functions. Recall that a measurable subset
function is a measurable map F : Y → F in(Y ), satisfying
 that F (y) is a finite subset of R(y)
for almost every y. F is bounded if |F (y)| and F −1 (y) are essentially bounded. Let BSF (R)
denote the space of measurable bounded subset functions on the equivalence relation R.

Definition 4.1 (Subadditive functions). A mapping H : BSF (R) → Map Y, [0, ∞) is called
subadditive if
• for every bounded subset function A, the function H(A) : Y → [0, ∞) is measurable;

THE SHANNON-MCMILLAN-BREIMAN THEOREM FOR GROUP ACTIONS

13

• H is bounded in the sense that there exists C > 0 such that for all subset functions A, we
have H(A)(y) ≤ C |A(y)| a.e.;
• H is R-invariant, i.e. for every bounded sub-equivalence relation T ⊆ R, one has h(T )(y) =
h(T )(z), whenever yT z.
• H has the following
`m subadditivity property: if A, Ai are bounded subset functions that
satisfy A(y) := i=1 Ai (zi ) then for a.e. y ∈ Y
m
X


H Ai (zi ) ,
H A (y) ≤
i=1


	
where z1 (y), . . . , zm(y) (y) ⊂ A(y) is a set of points depending measurably on y.

We now prove the subadditive convergence theorem.


Theorem 4.2. Let R be p.m.p. and hyperfinite and let H : BSF (R) → Map Y, [0, ∞) be subadditive. Then, for all bounded hyperfinite exhaustions (Rn ), the following holds:


Z
Z
H T (y)
H Rn (y)
∗

 dν(y),
H := inf
dν(y) = lim
n→∞ Y Rn (y)
T ⊆R Y |T (y)|
where the infimum is taken with respect to all non-trivial, bounded sub-equivalence relations T ⊆ R.

Proof. Let (Rn ) be a non-trivial, bounded hyperfinite exhaustion and denote by T be an arbitrary
sub-equivalence relation of R. It is enough to show that


Z
Z
H Rn (y)
H T (y)
lim sup
dν(y) ≤
dν(y).
(4.1)
n→∞
Y |Rn (y)|
Y |T (y)|
To this end, fix ε > 0, as well as m ∈ N. We apply Lemma 3.2 (ii) to
for large enough
 T . Hence,


n ∈ N, there is Yn ⊆ Y with ν(Yn ) > 1−ε and for all y ∈ Yn , we have R̊n (y) ≥ (1−ε kT k) Rn (y),
where R̊n (y) := {z ∈ Rn (y) | T (z) ⊆ Rn (y)}.
R̊n (y) is of course a bounded subset function (possibly assuming the empty set as a value),
`
and consider now the disjoint decomposition Rn (y) = R̊n (y)
Rn (y) \ R̊n (y) . Applying the
subadditivity of H to this decomposition, this yields for a.e. y ∈ Y
H(Rn )(y) ≤ H(R̊n )(y) + H(Rn \ R̊n )(y) .

(4.2)

Now note that if z ∈ R̊n (y) and wT z, then w ∈ R̊n (y) as well, so that R̊n (y) is a union of
disjoint T -classes. Hence, we can choose points z1 , . . . , zm in each of the resulting cells such that
the choice of representatives is measurable in y (since an equivalence relation with finite classes
`m
admits measurable sections). Hence, R̊n (y) = j=1 T (zj ), and using the subadditivity property
of H, along with the invariance property with respect to T , we get

X H T (z)
H(R̊n )(y) ≤
|T (z)|.
z∈R̊n (y)

Dividing inequality (4.2) by |Rn (y)|, and using the boundedness of H applied to the second summand, we conclude that for a.e. y ∈ Yn :
X H∗ (z)
T
+ C ε kT k ,
H∗n (y) ≤
|Rn (y)|
z∈R̊n (y)




where, for brevity, we have set H∗T (y) := H T (y)/T (y). By the boundedness of H, clearly
`
Y \ Yn
H∗n (y) ≤ C for all y ∈ Y and since H∗T ≥ 0, and as ν(Yn ) < ε, we integrate over Y = Yn
in order to arrive at
Z
Z
X H∗ (z)
T
H∗n (y) dν(y) ≤
dν(y) + C (1 + kT k) ε.
|Rn (y)|
Y
Y
z∈Rn (y)

14

AMOS NEVO AND FELIX POGORZELSKI

Now using the R-invariance of the measure ν̃, along with the fact that Rn (y) = Rn (z) for zRn y,
we obtain
Z
Z
Z
X H∗ (z)
X H∗ (z)
T
T
dν(y) =
dν(z) =
H∗T (z) dν(z).
|Rn (y)|
|Rn (z)|
Y
Y
Y
y∈Rn (z)

z∈Rn (y)

Consequently, one gets
lim sup
n→∞

Z

Y

H∗n (y) dν(y) ≤

Z

Y

H∗T (z) dν(z) + C (1 + kT k) ε.

Letting ε → 0, we see that the inequality 4.1 is verified.



Before proceeding with the proof of Theorem 2.1, let us recall the following standard properties
of the Shannon entropy of countable partitions.
Proposition 4.3. Let (X, λ) be a p.m.p. action of Γ. Fix F ∈ F in(Γ) and g ∈ Γ. Further, let
two countable partitions P and Q of X be given. Then,
(i) H(PW∨ Q) ≤ H(P)
 + H(Q);
−1
(ii) H
g
P
≤ H(P) |F |;
g∈F
(iii) H(P) ≤ H(Q) if Q ≥ P.
(iv) H(g P) = H(P);
Proof. See e.g. [CFS, Ch. 10, §6].



The following proposition shows that for a countable partition
P with H(P) < ∞, choosing for

H the Shannon entropy map hP : BSF (R) → Map Y, [0, ∞) as defined in Section 2 gives rise to
a subadditive function.
Proposition 4.4. Fix a countable partition P
 of (X, λ) with finite Shannon entropy H(P). Then
the mapping hP : BSF (R) → Map Y, [0, ∞) is subadditive according to Definition 4.1.
Proof. Recall that we have defined

hP (F ) : Y → [0, ∞) via : hP (F )(y) := H



_

w∈F (y)


α(w, y)−1 P .

The boundedness and the subadditivity property for hP are easily verified by properties (i) and
(ii) listed in Proposition 4.3. Concerning the invariance property, fix an arbitrary bounded subequivalence relation T ⊆ R. Let y, z ∈ Y be such that yT z. We need to show that hP (T )(z) =
hP (T	)(y). To this end, note
 that by the cocycle
	 identity, the set of group elements α(w, z) | w ∈
T (z) is equal to the set α(w, y) | w ∈ T (y) · α(y, z). Hence, the desired invariance follows from
part (iv) of Proposition 4.3. It remains to show the measurability statement. To this end, let
A be any measurable bounded subset function. Note first that given a partition P, the function
hP (A)(·) takes at most countably many different values, since F in(Γ) is countable. More precisely,
those values only depend on the finite collection of group elements of the form {α(w, y) | w ∈
A(y)} ∈ F in(Γ) for y ∈ Y . Since A and the cocycle α are measurable by assumption,
the function


W
−1
h(A) : R → [0, ∞), defined by h(A) (y, z) := H
P is measurable. Using
w∈A(y) α(w, z)

the cocycle identity α(z, w)α(w, y) = α(z, y) we observe that h(A) ((y, z)) = h(A) (y, y) for all
z ∈ [y], by property (iv) in Proposition 4.4. Consequently, we can write hP (A) := h(A)◦ℓ∆ , where
ℓ∆ : Y → R is the lift y 7→ (y, y) of Y to the diagonal. Since the latter function is measurable, so
is h(A).

We can now complete the proof of Theorem 2.1.

Proof of Theorem 2.1. By Proposition 4.4, the mapping hP : BSF (R) → Map Y, [0, ∞) is subadditive. Hence, the convergence claimed in the theorem, as well as the fact that the limit does
not depend on the hyperfinite exhaustion, both follow from Theorem 4.2, and this concludes the
proof of Theorem 2.1.


THE SHANNON-MCMILLAN-BREIMAN THEOREM FOR GROUP ACTIONS

15

As noted in the introduction, Theorem 4.2 establishes a general subadditive convergence principle, valid for all functions in the large class of subadditive set functions over equivalence relations,
as described in Definition 4.1. In particular, it can be applied to prove an analog of Theorem 2.1
for a natural notion of topological entropy in the present context.
5. Pointwise covering lemmas
We now establish pointwise decomposition results for subset functions which will provide the
central tool for proving the Shannon-McMillan-Breiman theorem in the next section. Our main
lemma builds on the techniques developed by Lindenstrauss for the proof of the corresponding
covering lemma for tempered Følner sequences in amenable groups (see [Li01, Lem. 2.4]). However,
working with hyperfinite exhaustions, we are able to avoid two difficult technicalities:
• we do not need to use an auxiliary random parameter in order to be able to choose the
desired coverings with high probability;
• we are able to produce strictly disjoint coverings, and the discussion of δ-disjointness (see
[Li01, Lem. 2.6, 2.7]) becomes unnecessary.
Instead, we exploit the disjointness properties inherent in a sequence of nested equivalence relations.
As usual, R will denote a p.m.p amenable equivalence relation over (Y, ν) with ν̃ denoting the
invariant measure on R, and (Rn ) will denote a bounded hyperfinite exhaustion for R.
We start with the following elementary covering (and disjointification) lemma.
Proposition 5.1. Let N, L ∈ N≥1 with N < L and consider an arbitrary finite sequence of subset
functions Bj ⊆ RL , 1 ≤ j ≤ N . Further, for y ∈ Y , consider a collection of classes (of the
relations Rn where 1 ≤ n ≤ N ) given by

	
F(y) := Rn(j) (w) | w ∈ Bj (y), 1 ≤ j ≤ N .
Then, for a.e. y ∈ Y , we can extract from F(y) a disjoint subcollection S(y) of classes such
that
N
N
[

[
X
a


|C| ≥ 
Bj (y).
C⊃
Bj (y) , and so
C∈S(y)

j=1

C∈S(y)

j=1

Proof. Fix y ∈ Y . We note first that for z1 , z2 ∈ RL (y) and 1 ≤ j1 , j2 ≤ N , there are three
possibilities for the inclusion relation between Rj1 (z1 ) and Rj2 (z2 ):
• Rj1 (z1 ) ∩ Rj2 (z2 ) = ∅,
• Rj1 (z1 ) ⊆ Rj2 (z2 ), or
• Rj1 (z1 ) ⊇ Rj2 (z2 ).

Any collection F(y) of sets with the latter property has the property that the union of its constituents has a unique representation as a disjoint union of some of the constituents. To find this
representation explicitly, namely to choose the subcollection S(y), enumerate all the elements in
F(y) and give them distinct labels collected in an index set I. Then run the following checking
algorithm.
(1) Set S∗ (y) = ∅, I ∗ = I.
(2) Check an arbitrary class C ∈ F(y) with its corresponding label being contained in I ∗ .
(3) Given C, there are two possibilities:
(A) Either for all 1 ≤ j ≤ N and z ∈ Bj (y) such that Rn(j) (z)∩C 6= ∅, we have C ⊇ Rn(j) (z),
(B) or there is some 1 ≤ j1 ≤ N , z1 ∈ Bj1 (y) such that C ⊆ Rn(j1 ) (z1 ) and C 6= Rn(j1 ) (z1 ).
(4) Only in case of (A), add C to the subcollection S∗ (y). Then remove from I ∗ all labels
corresponding to classes Rn(j) (z) ∈ F(y) being contained in C. If the new set I ∗ = ∅, jump
to step (5), otherwise return to step (2).
(5) We have I ∗ = ∅ (meaning all classes have been checked) and we set S(y) = S∗ (y). This is
the collection we aim for.

16

AMOS NEVO AND FELIX POGORZELSKI

By construction, for a.e. Y , the elements C ∈ S(y) are pairwise disjoint. Also, we made sure that
for every 1 ≤ j ≤ N , every single b ∈ Bj (y) is contained in some class C taken into S(y). This
proves the above inequality.

We now prove the main covering lemma, motivated by [Li01, Lemma 2.1].
Lemma 5.2. Fix 0 < δ < 1 and fix an (arbitrary) finite non-empty set D ⊂ Φ. Then, for
sufficiently large M ∈ N, depending only on D and δ, the following property holds.
Let Ti,j ⊆ RL (1 ≤ i ≤ M, 1 ≤ j ≤ Ni ) be an array of subset functions, such that for a.e. y,
Ti,j (y) = Rn(i,j) (y), where n(i, j) ≤ L. Assume that for 2 ≤ i ≤ M and every 1 ≤ j ≤ Ni
[
 


−1
(5.1)
D ◦ Tk,∗
Ti,j  ≤ (1 + δ) Ti,j 

k<i

S Nk

almost surely, where Tk,∗ := j=1 Tk,j for 1 ≤ k ≤ M .
Then, given another array Bi,j ⊆ RL for 1 ≤ i ≤ M and 1 ≤ j ≤ Ni , for ν-almost every y ∈ Y
there are disjoint subcollections
	

S(y) ⊆ Ti,j (w) | w ∈ Bi,j (y), 1 ≤ i ≤ M, 1 ≤ j ≤ Ni
such that

X

C∈S(y)

Ni


[


Bi,j (y).
|C| ≥ (1 − δ) min D ◦
1≤i≤M

j=1

Proof. Fix a conull set Y0 ⊆ Y such that for all y ∈ Y0 the inequality (5.1) is fulfilled. For i = M ,
apply Proposition 5.1 to the subset functions defined as Bj := BM,j , where 1 ≤ j ≤ NM . This
way, by passing to another conull subset of Y0 , for ν-a.e. y ∈ Y0 , we obtain a disjoint subcollection

	
SM (y) ⊆ TM,j (w) | 1 ≤ j ≤ NM , w ∈ BM,j (y) .
with

X

C∈SM (y)

Proceeding iteratively, for i < M , we set

M

N

[
BM,j (y).
|C| ≥ 

j=1

B̃i,j (y) := Bi,j (y) \

[

l>i

[
−1
Ti,j
◦ ( Sl )(y),

S
where 1 ≤ j ≤ Ni and Sl denotes the union over all sets in Sl . Applying Proposition 5.1 again,
this time to the subset functions defined as Bj := B̃i,j , 1 ≤ j ≤ Ni gives a subcollection

	
Si (y) ⊆ Ti,j (w), 1 ≤ j ≤ Ni , w ∈ B̃i,j (y)
with the corresponding covering property, namely
X

C∈Si (y)

Ni

[


B̃i,j (y).
|C| ≥ 
j=1

Having constructed Si for all 1 ≤ i ≤ M , we finally set S :=
disjoint collection of sets. We are going to show
M
X

X

i=m C∈Si (y)

SM

i=1

Si . By construction, S is a

Ni


[

δ2 	


|C| ≥ min 1 − δ, (M − m + 1)
Bi,j (y)
· min D ◦
|D| m≤i≤M
j=1

(5.2)

for all 1 ≤ m ≤ M and ν-almost every y ∈ Y . The proof is by induction on m = M, . . . , 1, starting
with M . By the first case in our argument above,
X

C∈SM (y)

N
M
M

 N[

[
1 



BM,j (y) ≥
|C| ≥ 
BM,j (y),
D ◦
|D|
j=1
j=1

THE SHANNON-MCMILLAN-BREIMAN THEOREM FOR GROUP ACTIONS

17

which shows the validity of an inequality which is in fact stronger than 5.2. In order to show the
claim for m < M , we assume that for the element y ∈ Y under consideration,
X

X

|C| < (1 − δ)

l>m C∈Sl (y)

Ni


[


Bi,j (y),
min D ◦

m≤i≤M

(5.3)

j=1

since, otherwise, there is nothing to prove. By construction of the collection Sm (y), we have
X

C∈Sm (y)

It follows from

m

N

[
B̃m,j (y).
|C| ≥ 

(5.4)

j=1

[

B̃m,j (y) = Bm,j (y) \

[

−1
Tm,j
C

l>m C∈Sl (y)

that


D◦

N
m
[

B̃m,j

j=1



N
m


[
[
Bm,j (y) \
(y) ⊇ D ◦
j=1

[

D◦

m
N
[

j=1

l>m C∈Sl (y)


−1
Tm,j
C .

(5.5)

Recall that by assumption (5.1), we have
m


N
[
 


−1
Tm,j
C  ≤ (1 + δ) C 
D ◦

j=1

for a.e. y ∈ Y0 , where C ∈

S

l>m

m

N

[
B̃m,j (y)


Sl (y). Hence, by (5.5),

N
m
 
[
1 

B̃m,j (y)
 D◦
|D|
j=1

≥

j=1

N
m


X X
[
1 

Bm,j (y) − (1 + δ)
|C| .
D ◦
|D|
j=1

≥

l>m C∈Sl

With (5.4) we obtain by taking into account (5.3)
X

|C| ≥

N
m
 1+δ X X
[
1 

Bm,j (y) −
|C|
D ◦
|D|
|D|
j=1
l>m C∈Sl

C∈Sm

≥

 1
1 − (1 + δ)(1 − δ)
|D|
2

=

δ
|D|

X X

|C| ≥

l≥m C∈Sl

X X

l>m C∈Sl

≥



m≤i≤M

j=1

Ni


[


Bi,j (y).
min D ◦

m≤i≤M

Consequently,

Ni


[


Bi,j (y)
min D ◦

δ2
|C| +
|D|

j=1

Ni


[


Bi,j (y)
min D ◦

m≤i≤M
2

j=1

2

 δ
δ 
M − (m + 1) + 1
+
|D| |D|

min

m≤i≤M

Ni


[


Bi,j (y).
D ◦
j=1

Hence, the proof of the inequality (5.2) is complete. Finally, choosing M large enough such that
(M − 1)δ 2
≥ (1 − δ)
|D|
concludes the proof of the lemma.



18

AMOS NEVO AND FELIX POGORZELSKI

6. Proof of the Shannon-McMillan-Breiman theorem
The goal of this section is to prove Theorem 2.7, as well as Corollary 2.8. To this end, we adapt
the overall strategy given in [Li01, Section 4] to the situation of amenable equivalence relations.
As usual, R is p.m.p. and hyperfinite, Γ is countable and α : R → Γ a class injective measurable
X
cocycle. Recall that
 for a p.m.p. group action Γ y (X, λ), the extended equivalence relation R
over X × Y, λ × ν is defined by the condition

(x, y), (x′ , y ′ ) ∈ RX ⇐⇒ yRy ′ and x = α(y, y ′ )x′ ,

When the measure ν is R-invariant, it follows that λ × ν is RX -invariant, since the Γ-action on X
preserves λ. The projection map π : RX → R given by (x, y) → y is injective when restricted to
the RX -equivalence class of (x, y), for almost all (x, y) ∈ RX . Further, it is well known that an extension of an amenable action is amenable, and thus in particular if R is amenable, so is RX . But
since the extension is class-injective, in fact every hyperfinite exhaustion (Rn ) of R can be canonX
X
ically lifted to a hyperfinite exhaustion (RX
n ) of R , via Rn ((x, y)) = {(α(z, y)x, z) ; z ∈ Rn (y)}.
Note that if (Rn ) is a bounded hyperfinite exhuastion, then so is (RX
n ), with the same bounds on
the equivalence classes.
For a given hyperfinite exhaustion (Rn ) for R, we define a set Φ ⊆ Aut(R) satisfying the conclusions of Proposition 3.1. Then, every φ ∈ Φ can be extended naturally to an inner automorphism
φX ∈ Aut(RX ) by setting


φX (x, y) := α(φ(y), y)x, φ(y) .
(6.1)
 X
	
X
For a subset D ⊆ Φ, we write D for the set φ | φ ∈ D . Note that by definition, the set
ΦX := {φX | φ ∈ Φ} is generating for the relation RX . Clearly, if φ preserves the classes of Rn
almost surely, then φX preserves the classes of RX
n almost surely.
Let us now recall the concept of ergodicity for a measure preserving equivalence relation. Let
Z be such a relation over a probability space (Z, η). A subset A ⊆ Z will be called Z-invariant if

A × Z ∩ Z = A × A.
The relation Z is ergodic if every Z-invariant set A ⊆ Z satisfies η(A) ∈ {0, 1}. From now on,
we will always assume that the relation RX is ergodic. For sufficient conditions guaranteeing this
property, we refer to the discussion in §7 below.
One crucial ingredient for the proofs of Theorem 2.7 and Corollary 2.8 is the pointwise ergodic
theorem. A general form of it being valid for suitable asymptotically invariant sequences of subset
functions in an amenable equivalence relation was established in [BN13b, Thm. 2.1]. Since we
restrict our discussion here to hyperfinite exhaustions, we will state a less general but easily accessible special case which is sufficient for our purposes. Indeed, the following fact is an immediate
consequence of the martingale convergence theorem.
Theorem 6.1. Let Z be an ergodic, p.m.p. equivalence relation over a probability space (Z, η).
Let (Zn ) be a bounded hyperfinite exhaustion for Z.
Then for all f ∈ L1 (Z, η), we have
Z

−1 X
f (w) dη(w)
f (w) =
lim Zn (z)
n→∞

w∈Zn (z)

Z

for η-almost every z ∈ Z.

We now turn to establish some preliminary lemmas that will be used below. The first step is a
straightforward consequence of the ergodicity of the relation.
Lemma 6.2. Let Z be an ergodic p.m.p. equivalence relation over a probability (Z, η) along with
a countable set Φ of inner automorphisms generating Z. Then, for every δ > 0, and every set
A ⊆ Z with η(A) > 0, there is a finite set D ⊂ Φ such that

η D ◦ A ≥ 1 − δ.

THE SHANNON-MCMILLAN-BREIMAN THEOREM FOR GROUP ACTIONS

19

Proof. Let A ⊆ Z be measurable with η(A) > 0. Assume that there is some δ0 > 0 such
S that for
all finite collections D ⊂ Φ, we have η(D ◦ A) < 1 − δ0 . We define A := Φ ◦ A = φ∈Φ φ(A).
This set is invariant under the relation Z. To see this, consider z ∈ Z, φ ∈ Φ and a ∈ A such
that (φ(a), z) ∈ Z. Since Φ is generating, there is a further inner automorphism φ′ ∈ Φ such that
z = φ′ φ(a). We conclude that z ∈ Φ ◦ A and thus,

A × Z ∩ Z = A × A.

Since Φ is countable, it follows η(A) ≤ 1 − δ0 by our assumption. Now A is an invariant set,
hence by ergodicity of the relation, we obtain η(A) = 0. However, since every inner automorphism

preserves the measure, we have η(A) ≥ η(A) > 0. This is a contradiction.
We need the following combinatorial lemma which is the measured equivalence relation analog
of the version for Følner sequences, see Lemma 1 in [OW83] and Lemma 4.2 in [Li01].

Lemma 6.3. Let R be a p.m.p. equivalence relation over (Y, ν), and let (Rn ) be a bounded
hyperfinite exhaustion satisfying limn→∞ ess inf y |Rn (y)| = ∞. Then, for every η > 0, there is
some ℓ ∈ N such that the following holds.
Suppose that to y ∈ Y there corresponds a finite increasing sequence (ki ), 1 ≤ i ≤ r(y) of
integers (depending on y) with |Rk1 (z)| ≥ ℓ for almost every z ∈ Y . Then, there is n0 ∈ N such
that for all n ≥ n0 , the number of possible disjoint subcollections S(y) of the form
	

S(y) ⊆ Rki (c) | c ∈ Rn (y), 1 ≤ i ≤ r(y)

is at most 2η|Rn (y)| .

Proof. Let η > 0. Consider ℓ ∈ N, y ∈ Y and an increasing sequence (ki ), 1 ≤ i ≤ r(y) of integers
(depending on y) with |Rk1 (z)| ≥ ℓ for all 1 ≤ i ≤ r(y) and almost every z ∈ Y . Since we
assume that S(y) is a collection of disjoint Rki -classes contained in Rn (y), there is a center set
C(y) ⊆ Rn (y) such that
	

S(y) = Rkt(c) (c) | c ∈ C(y) with 1 ≤ t(c) ≤ r(y).

Given S(y) (and hence C(y)), we define a set of points N (y) as follows. For c ∈ C(y), define
n(c) := i as the maximal 1 ≤ i ≤ t(c) such that Rki (c)\Rki−1 (c) 6= ∅, where R0 = ∅ by convention.
Then add to the set N (y) an arbitrary point p(c) ∈ Rki (c)\Rki−1 (c). By processing in that way for
all c ∈ C(y), we obtain a set N (y) with cardinality at most |C(y)|. We claim that we can uniquely
recover S(y) from knowing the elements in both sets C(y) and N (y). Indeed, given C(y) and N (y),
by construction, for every c ∈ C(y), there is a minimal (and thus unique) 1 ≤ t(c) ≤ r(y) such
that Rkt(c) (c) ∩ N (y) 6= ∅. Hence, the number of possible disjoint subcollections must be bounded
by the number of choices for the two sets C(y) and N (y). Since the sizes of all classes involved
are uniformly bounded from below by ℓ, the cardinality of every C(y) and N (y) is bounded from
above by ⌈|Rn (y)|/ℓ⌉. In light of that, we need to bound the expression

2
2
|Rn (y)|
⌈|Rn (y)|/ℓ⌉ + 1
.
⌈|Rn (y)|/ℓ⌉
To do so, we use the entropy formula for the Stirling approximation. For this purpose, we define


1
1
1 −1
E(ℓ) := log ℓ + 1 −
.
log 1 −
ℓ
ℓ
ℓ
By Stirling’s approximation (see e.g. [FS08], Example VIII.10), for large enough n ∈ N, we get

2 

2
|Rn (y)|
≤ 24 E(ℓ/2) |Rn (y)| .
≤ exp E(ℓ/2)|Rn (y)|
⌈|Rn (y)|/ℓ⌉
Now increasing n if necessary, we can make sure that

2
2
|Rn (y)|
⌈Rn (y)/ℓ⌉ + 1
≤ 25 E(ℓ/2) |Rn (y)| .
⌈|Rn (y)|/ℓ⌉
Since E(ℓ) → 0 as ℓ → ∞, we can find some ℓ such that E(ℓ/2) < η/5, and this completes the
proof of the claim.


20

AMOS NEVO AND FELIX POGORZELSKI

We are ready to prove the main lemma of this section. It is motivated by Lemma 4.3 in [Li01]
and provides an analog of it for hyperfinite exhaustions.
Lemma 6.4. Let (Bk ) be a sequence of measurable sets in X × Y such that
!
∞ [
\
λ×ν
Bj > 0.
k=1 j≥k

Then, for every δ > 0 and λ × ν-a.e. (x, y) ∈ X × Y , there is n(x, y) ∈ N for which the following
holds true: for each n ≥ n(x, y), there is a disjoint collection of subsets of Rn (y)
	

S = Rki (bi ) | 1 ≤ i ≤ r

with bi ∈ Rn (y) and 1 ≤ ki < n(x, y), such that

(i) P
α(bi , y)x, bi ∈ Bki for all i,
(ii)
C∈S |C| ≥ (1 − δ) |Rn (y)|.

Proof. Let δ > 0. We set

∗

B :=

∞ [
\

Bj .

k=1 j≥k

By assumption, (λ × ν)(B ∗ ) > 0. Given the hyperfinite exhaustion (Rn ), we fix ΦX ⊆ Aut(RX )
satisfying the conclusions of Proposition 3.1. Since the extended relation RX is ergodic, and since
the set ΦX is generating for RX , we can use Lemma 6.2 in order to find a finite set D ⊂ Φ such
that the lifted automorphisms DX ⊆ ΦX satisfy

(6.2)
λ × ν DX ◦ B ∗ ≥ 1 − δ/10.

Thus clearly λ × ν B ∗ ≥ (1 − δ/10)/ |D|. Further, choose M ∈ N such that Lemma 5.2 holds
true for the fixed parameters δ and D for the relation R.
The next step is to construct two finite increasing integer sequences (mi ), (Ni ), 1 ≤ i ≤ M ,
according to the following algorithm.
(1) Define m1 := 1.
(2) If mi has been chosen, then determine Ni large enough such that
mi[
+Ni

 δ · λ × ν(B ∗ )
.
Bj <
λ × ν B∗ \
10 M |D|
j=m
i

(3) Further, if Ni has been chosen, choose mi+1 large enough such that for every l ≥ mi+1 , we
get
[
D ◦ R−1
j Rl ⊆ Rl .
j<mi +Ni

This is possible by Proposition 3.1 and since D ⊂ Φ. In fact D ◦ Rn = Rn for all sufficiently
large n. So it suffices that mi+1 > mi + Ni and also that Rm2 (and hence each Rmi+1 ) is
invariant under D.
With the sequences (mi ), (Ni ) at our disposal, we define
B̃ ∗ :=

+Ni
M mi[
\

Bj .

i=1 j=mi

Clearly
∗

λ × ν B \ B̃
and so

∗



≤

M
X
i=1



∗

λ×ν B \

mi[
+Ni
j=mi

 δ · λ × ν(B ∗ )
Bj <
,
10 |D|

 δ · λ × ν(B ∗ )
.
λ × ν DX ◦ B ∗ \ DX ◦ B̃ ∗ <
10

THE SHANNON-MCMILLAN-BREIMAN THEOREM FOR GROUP ACTIONS

21

Consequently,
 δ · λ × ν(B ∗ )

δ
δ · λ × ν(B ∗ )
δ
λ × ν DX ◦ B̃ ∗ ≥ ν DX ◦ B ∗ −
≥1−
−
≥1− .
10
10
10
5

Now by the pointwise ergodic theorem (Theorem 6.1), for λ × ν-a.e. (x, y), we can define n(x, y)
as the smallest integer value greater than mM + NM such that for all n ≥ n(x, y), we have

−1 X


δ
(6.3)
1DX ◦B̃ ∗ (α(z, y)x, z) > 1 − .
A n, 1DX ◦B̃ ∗ (x, y) := Rn (y)
4
z∈Rn (y)

We fix some pair (x, y) satisfying this condition, as well as n ≥ n(x, y). For 1 ≤ i ≤ M and
1 ≤ j ≤ Ni , set Ti,j := Rmi +j−1 and
	


Ai,j (y) := b ∈ Rn (y) | α(b, y)x, b ∈ Bmi +j−1 .

By step (3) of the algorithm and since n > mM + NM , we have D ◦ Rn ⊆ Rn . In particular, each
φ ∈ D gives rise to bijections φ : Rn (y) → Rn (y), for a.e. y ∈ Y .
Applying the transformations in the set D to the sets Ai,j (y), we then obtain

D◦

Ni
[

Ai,j (y) =

j=1

Ni
[ 
	
 [
Bmi +j−1
φ(b) | b ∈ Rn (y), α(b, y)x, b ∈
j=1

φ∈D

=



Ni
	
 [
Bmi +j−1 .
b ∈ Rn (y) | ∃ φ ∈ D, b′ ∈ Rn (y) : b = φ(b′ ), α(b′ , y)x, b′ ∈
j=1

Together with (6.3), this yields for all 1 ≤ i ≤ M :
Ni

[


D ◦ Ai,j (y)


=

j=1

j=1

(using (6.1))

Ni

	
 [
 b ∈ Rn (y) | ∃ φ ∈ D : b′ = φ−1 (b), α(b′ , y)x, b′ ∈
Bmi +j−1 

=

∗

(since B̃ is an intersection) ≥
(by the pointwise ergodic theorem) ≥



 b ∈ Rn (y) | α(b, y)x, b ∈ DX ◦



Rn (y) A n, 1 X ∗ (x, y)
D ◦B̃


δ  
1−
Rn (y) .
4

Ni
[

j=1

	
Bmi +j−1 

We finally apply Lemma 5.2 with δ/4 instead of δ to the arrays Ti,j and Ai,j (y), where 1 ≤ i ≤ M
and 1 ≤ j ≤ Ni . The assumption of the Lemma is indeed satisfied, namely Ti,j = Rmi +j−1 satisfy
(5.1) by the construction of m2 , which guarantees D ◦ Rm = Rm for all m ≥ m2 . Furthermore,
we have just shown that
Ni
 
[

δ  


D ◦ Ai,j (y) ≥ 1 −
min 
Rn (y)
1≤i≤M
4
j=1

and hence Lemma 5.2 implies that there is a disjoint subcollection

	
S(y) ⊆ Ti,j (b) | b ∈ Ai,j (y)

with

X

C∈S(y)

as desired.



|C| ≥ (1 − δ) Rn (y),

The following is an immediate consequence from the previous lemma.



22

AMOS NEVO AND FELIX POGORZELSKI

Lemma 6.5. Let (Rn ) be a bounded hyperfinite exhaustion, and keep the assumptions of the
previous lemma. Then, for the number

J P Rn (y) (x)
,
h := ess-inf x,y lim inf
n→∞
|Rn (y)|
the following holds true. For every δ > 0, each N ∈ N and λ × ν-a.e. (x, y), there is a number
n(x, y) ∈ N such that for all n ≥ n(x, y), we can find a disjoint collection (depending on both x
and y)
	

S = Rki (bi ) | 1 ≤ i ≤ r
such that all bi ∈ Rn (y) and N ≤ ki < n(x, y) and further,
(i) for all i,

J P Rki (bi ) α(bi , y)x
≤ h + δ,
|Rki (bi )|
P
(ii)
C∈S |C| ≥ (1 − δ) |Rn (y)|.

Proof. We apply the previous Lemma 6.4 to the sequence (Rn )n≥N and the sets

o
n
 J P RN +k (y) (x)
≤h+δ .
Bk := (x, y) ∈ X × Y 
|RN +k (y)|



We are now in position to prove the Shannon-McMillan-Breiman Theorem. To do so, we
combine the previous results of this section, motivated by the proof of Theorem 1.3 in [Li01].
Proof of Theorem 2.7. As before, we set
h := essinf x,y


J P Rn (y) (x)
lim inf
.
n→∞
|Rn (y)|

If h = ∞, then there is nothing left to show. So assume that h < ∞. We show that for a.e. (x, y),

J P Rn (y) (x)
lim sup
≤ h.
(6.4)
|Rn (y)|
n→∞
To this end, fix δ > 0. We find N ∈ N large enough such that Lemma 6.3 holds for η = δ and
ℓ = N . By the growth assumption on the (Rn ), we find N1 ∈ N such that for a full measure set
of y’s, we have |Rk (z)| ≥ N for all k ≥ N1 and each z ∈ [y]. We have seen in Lemma 6.5 that for
λ × ν-almost every (x, y), there is n(x, y) ∈ N, n(x, y) > N1 , such that for n > n(x, y), we obtain
a special subcollection S = S(x, y) of subsets of Rn (y). Namely, this collection
• is disjoint,
P
• satisfies C∈S |C| ≥ (1 − δ) |Rn (y)|,
• Each C ∈ S is of the form Rk (b) with N1 ≤ k < n(x, y) and b ∈ Rn (y), which by the
choice of N1 implies that |Rk (b)| ≥ N for all k ≥ N1 ,
• writing C = Rk (b) ∈ S, the following holds

J P Rk (b) α(b, y)x
≤ h+δ.
(6.5)
|Rk (b)|
By increasing n if necessary, due to |Rn (y)| → ∞, we can assume that


Rn (y) ≥ 8δ −1 (log n).

(6.6)

Let us now fix x, y, n = n(x, y) and S(x, y) = S satisfying all the conditions stated above.
We first
and
:=
 Gn (y)
S note that since Rn (y) is the disjoint union of the sets C = RWk (bC ) ∈RS
k (bC )
∨ P Gn (y) .
Rn (y) \ C∈S Rk (bC ), it follows that the partition P Rn (y) is given by
C∈S P
Therefore for any point x ∈ X, its P Rn (y) -name arises as the intersection of the P Rk (bC ) -name
of α(bC ,S
y)x where C = Rk (bC ) ∈ S, and of the P-name of α(b, y)x for every b ∈ Gn (y) :=
Rn (y) \ C∈S Rk (bC ).

THE SHANNON-MCMILLAN-BREIMAN THEOREM FOR GROUP ACTIONS

23

Consider the partition P Rn (y) (which is finer than each partition P Rk (b) when b ∈ Rn (y)) and
define a set of atoms in it which we denote by Kn (x, y). Namely, for our fixed x, we consider the
disjoint collection S(x, y) of subsets of Rn (y), and we put an atom of P Rn (y) in Kn (x, y) provided
that it arises as the intersection of elements of the partitions P Rk (b) which satisfy inequality (6.5)
(where we allow any Rk (b) = C ∈ S(x, y)), with elements in the partition P Gn (y) .
Now, for every Rk (b) = C ∈ S(x, y), inequality (6.5) gives a lower bound on the measure of
some of the atoms in the partition, and hence an upper bound on their number. It follows that
for each such C, there are at most 2(h+δ)|Rk (b)| atoms of P Rk (b) (namely P Rk (b) -names) for which
the inequality (6.5) can hold true.
Consequently, the number of atoms of P Rn (y) which appear as elements in Kn (x, y) is bounded
by
S
Y
Y
|R (y)\ S|
2(h+δ) |Rk (b)| · |P||Gn (y)| =
2(h+δ) |C| · |P| n
.
C∈S

C∈S

Since Rn (y) is disjointly (1 − δ)-covered by the elements in S, we conclude that for a fixed x ∈ X,
there are at most
2(h+δ) |Rn (y)| · |P|δ |Rn (y)|
many elements in Kn (x, y).
Kn (x, y) depends on both x and y, having been constructed using the collection S(x, y) of
subsets on Rn (y). Now, we define another collection of atoms of P Rm (y) , which we denote by
Km (y). It consists of all the atoms in the sets Km (x, y) as x varies in X, provided that n(x, y)
satisfies the conditions stated above and in addition n(x, y) ≤ m. By Lemma 6.3 (and the choices
for N and N1 ), for all m ≥ m(y) the number of possibilities for S(x, y) is bounded by 2δ|Rm (y)| .
Hence, we obtain


Km (y) ≤ 2(h+2δ+δ log |P|) |Rm (y)| .
We now consider the sets


o
 J P Rm (y) (x)
> h + 3δ + δ log |P| .
Xm (y) := x ∈ X 
|Rm (y)|
n

Consider

Km (y), the union of all P Rm (y) -atoms which belong to Km (y). Then,
[

λ Xm (y) ∩
Km (y) ≤ |Km (y)| 2−(h+3δ+δ log |P|) |Rm (y)| ≤ 2−δ |Rm (y)| .

S

It follows from the growth condition (6.6) stated above that
2−δ |Rm (y)| ≤ 2log m

−8

≤

1
m2

P∞
for large enough m. This implies that m=1 2−δ|Rm (y)| < ∞. Thus, for ν-almost-every y ∈ Y , we
can
/ Xm (y) ∩
S apply the Borel-Cantelli lemma and obtain that for λ × ν-almost every (x, y), x ∈
Km (y) if m is large enough. On the S
other hand, we deduce from Lemma 6.5 that for large
enough m (depending on x and y), x ∈ Km (y). This implies that for λ × ν-a.e. (x, y), and m
large enough, we must have x ∈
/ Xm (y), which means by definition of Xm (y) that

J P Rm (y) (x)
≤ h + 3δ + δ log |P|.
lim sup
|Rm (y)|
m→∞
Letting δ → 0 yields (6.4).
 This establishes almost everywhere convergence, as stated. Since the
integrals of J P Rm (y) (x) / |Rm (y)| over X × Y converge to the cocycle entropy by Theorem 2.1,
we have h = h∗P (α), as claimed.

We conclude this section with the proof of Corollary 2.8. The proof follows along the lines of
the L1 -convergence case proved in [Li01, Thm. 4.1].

24

AMOS NEVO AND FELIX POGORZELSKI

Proof of Corollary 2.8. By Theorem 2.7, the normalized information function converges pointwise
almost surely (w.r.t. the measure λ × ν) to h∗P = h∗P (α). Fix ε > 0, and for n ∈ N and fixed y ∈ Y ,
define

o
n 
J P Rn (y) (x)
∗
∗



≤
h
+
ε
.
Cn (y) := x hP − ε ≤
P
Rn (y)
Integration over X gives
h∗P




− ε λ Cn (y)


J P Rn (y) (x)
dλ(x)
≤
|Rn (y)|
Cn (y)

Z
J P Rn (y) (x)
≤
dλ(x)
|Rn (y)|
X
Z


≤ h∗P + ε λ Cn (y) +
Z

X\Cn (y)

∗


J P Rn (y) (x)
dλ(x).
|Rn (y)|

We define a new measure λ on X \ Cn (y) by setting
λ∗ (A) :=

λ(A)
.
λ(X \ Cn (y))

Then, since Cn (y) is a disjoint union of atoms of the partition P Rn (y) of X,


Z
Z

J P Rn (y) (x)
J ∗ P Rn (y) (x)


dλ∗ (x)
dλ(x) = λ X \ Cn (y)
Rn (y)
|Rn (y)|
X\Cn (y)
X\Cn (y)


−λ X \ Cn (y) log λ(X \ Cn (y)) ,

where J ∗ denotes the information function with respect to λ∗ . Now since the integral on the right
hand side in the inequality above is just the Shannon entropy of the partition P Rn (y) with respect
to the measure λ∗ , we arrive at

Z



J P Rn (y) (x)
dλ(x) ≤ λ X \ Cn (y) log |P| − λ X \ Cn (y) log λ(X \ Cn (y)) .
|Rn (y)|
X\Cn (y)
Clearly, by Theorem 2.7, for ν-almost every y ∈ Y , the latter expression tends to zero as n → ∞.
Now sending ε → 0 yields the first assertion of the claimed statement. For the second statement
note that due to the dominated convergence theorem (with dominating function g(y) := 2 |P|) we
have

Z Z 

R (y)
 J P n (x)

lim
− h∗P  dλ(x) dν(y) = 0.

n→∞ Y X
|Rn (y)|
This concludes the proof of the corollary.



7. Amenable relations, injective cocycles and ergodic extensions
7.1. Groups admitting injective cocycles. As usual, Let (Y, ν) be a probability space, and let
R ⊂ Y × YS be a p.m.p. Borel equivalence relation with R-invariant probability measure ν̃, such
that R = n∈N Rn is hyperfinite, or equivalently, R is amenable in the sense of [CFW81]. Let
(X, λ) be a p.m.p. action of a countable group Γ and let α : R → Γ be a measurable cocycle. Let
RX denote the extended relation on (X × Y, λ × ν).
As noted in the proof of Theorem 2.1, given the ingredients just listed, the following limit exists

Z
hP Rn (y)
∗


hP (α) := lim
Rn (y) dν(y).
n→∞ Y

However, in this generality we cannot say too much about its properties. A meaningful entropy
invariant arises when we assume that the hyperfinite exhaustion is by bounded finite relations,
and the cocycle is injective. The first condition can always be satisfied, and thus cocycle entropy
exists as an invariant with the properties stated for all countable groups Γ admitting an injective
cocycle defined on a hyperfinite relation. In particular, cocycle entropy then coincides with Rokhlin

THE SHANNON-MCMILLAN-BREIMAN THEOREM FOR GROUP ACTIONS

25

entropy and finitary entropy provided that the Γ-action on X is ergodic and essentially free. It
may be the case that every countable group admits an injective cocycle defined on an ergodic
hyperfinite relation, but this remains to be seen.
To indicate briefly that the class of groups in question is extensive indeed, let us note the
following constructions of cocycles on amenable actions.
1) Amenable groups.
Let Γ be amenable, let (Y, ν) be any p.m.p. action of Γ, and assume that the action is essentially
Γ
free. For example, we can take Y to the Bernoulli action of Γ on {0, 1} . Let R = OΓ be the orbit
relation of Γ on Y , and then there is a cocycle α : R → Γ given by α(γy, y) = γ. This cocycle is
indeed an injective cocycle on a p.m.p. amenable equivalence relation R, by amenability of Γ and
freeness of the action. Given a p.m.p. action of Γ on a space (X, λ), clearly Γ acts on the product
(X × Y, λ × ν), and the orbit relation of Γ in the product coincides with the extended relation
RX on X × Y that we have used throughout the paper. Thus α : R → Γ is an injective cocycle
defined on a p.m.p. amenable relation.
2) The Maharam extension of the Poisson boundary. For every countable infinite group
Γ, and every generating probability measure µ on Γ, the Poisson boundary B = B(Γ, µ) is an
amenable action of Γ, in the sense defined by Zimmer [Zi78], or equivalently, in the sense of
[CFW81]. Let η denote the stationary measure on B, and rη (γ, b) = dη◦γ
dη (b) the Radon-Nikodym
derivative cocycle of η, so that rη : Γ × B → R∗+ . The Maharam extension of B by the cocycle rη is
the Γ-action on B × R given by γ(b, t) = (γb, t − log rη (γ, b)), and this action preserves the measure
η × θ, where dθ(t) = et dt and dt is Lebesgue measure on R. This action is again an amenable
action of Γ, being an extension of an amenable action. Let us define Y = B × (−∞, 0), and let ν
be the restriction of η × L to Y , a finite measure which we normalize to be a probability measure.
Then (Y, ν) is a probability space, and we define the relation R on it to be the restriction of the
orbit relation OΓ defined by Γ on B × R to the subset Y . Thus R is a p.m.p. Borel equivalence
relation with countable classes, since Γ is countable and preserves the measure η × L. The orbit
relation OΓ is an amenable relation, hence it is hyperfinite, and as a result so is its restriction R
to the subset Y . Finally, if the action of Γ on its Poisson boundary B is essentially free, then we
can define a cocycle α : OΓ → Γ, by the formula α(γ(b, t), (b, t)) = γ. This cocycle is well-defined
since the elements in a Γ-orbit are in bijective correspondence to the elements of Γ, by essential
freeness. Restricting α to R we obtain a cocycle from an amenable p.m.p. equivalence relation R
to Γ. Furthermore, this cocycle is injective in this case, since γ(b, t) = (γb, t − log rη (γ, b)), so that
if γ 6= γ ′ then α((b, t), γ(b, t)) 6= α((b, t), γ ′ (b, t)).
Clearly, the class of groups admitting a random walk such that the action on the associated
Poisson boundary is essentially free is extensive indeed. In fact typically many different random
walks on a given non-amenable group Γ give rise to Poisson boundaries admitting an essentially
free action. It is a remarkable feature of the construction of cocycle entropy that it gives one and
the same value for the entropy of the Γ-action on X, provided only that this action is ergodic and
essentially free, and the value is independent of which cocycle α : R → Γ as above was chosen to
calculate it.
7.2. Ergodicity of cocycle extensions. The Shannon-McMillan-Breiman theorem stated in
Theorem 2.7, being a pointwise convergence result for cocycle entropy, requires an additional
ergodicity assumption for its validity, beyond those sufficient to guarantee the existence of cocycle
entropy itself. We note that an ergodicity assumption also plays a role in the Shannon-McMillanBreiman theorem for amenable groups, see [Li01].
Let us recall that in [BN15a, Def. 2.2] a notion of weak-mixing for a cocycle α on p.m.p. relation
R on (Y, ν) was defined, as follows. A cocycle α : R → Γ is weak-mixing if for every p.m.p. ergodic
action of Γ on a spaces (X, λ), the extended relation RX on X × Y is ergodic with respect to the
product measure λ × ν. In particular, the relation R itself must be ergodic. This definition is a
natural extension of the notion of weak-mixing for group actions, where the action of Γ on a space
(B, η) (with η not necessarily invariant), is called weak-mixing if given any p.m.p. ergodic action
of Γ on a space (X, λ), the product action of Γ on (X × B, λ × η) is still ergodic.

26

AMOS NEVO AND FELIX POGORZELSKI

1) Amenable groups. Let us first consider the case where Γ is amenable. Referring to the
relation R and the cocycle α defined in §7.1(1), if the Γ-action on (Y, ν) is weak-mixing (in the
usual sense for group actions), then the Γ-action on (X × Y, λ × ν) is ergodic for every ergodic
p.m.p. action of Γ. Thus, referring to §7.1(1), the cocycle α : R → Γ defined there is a weak-mixing
cocycle and so here the extended relation RX is ergodic.
2) Poisson boundaries.
When Γ is non-amenable, the most important source (but not
always the only one) of weak-mixing actions of a countable group Γ is the set of its actions on
Poisson boundaries B = B(Γ, µ) [AL05]. These actions are amenable as noted above, and satisfy
a stronger condition than weak-mixing, namely double ergodicity with coefficients, see [Ka03]. If
Γ is a non-amenable group, then the ergodic action on a Poisson boundary (B, η) is not measurepreserving, and thus of type III. The action on the Maharam extension (B × R, η × L) is in fact
measure-preserving, on a σ-finite (but not finite) measure space, but the Maharam extension is
not necessarily an ergodic action of Γ. The possibilities for it are determined by the type of the
Γ-action on (B, η), and in particular, if it is III1 , then the Maharam extension is ergodic. In
general, this does not imply that for any ergodic action of Γ on (X, λ), the Maharam extension of
(X × B, λ × η) is ergodic. If indeed this is the case for every p.m.p. action of Γ, then the action
of Γ on (B, η) is defined in [BN13b] to have stable type III1 .
Assume that the Γ-action on (B, η) is essentially free, and let (Y, ν), R and α be as defined
§7.1(2). Then the cocycle α : R → Γ is injective, defined on a p.m.p. amenable relation, and if
the type of the Γ-action on (B, η) is III1 it is ergodic. If, furthermore, the Γ-action on (B, η) has
stable type III1 , then the cocycle α is weak-mixing, and hence RX is ergodic for every p.m.p.
action of Γ. Thus all the assumptions in the Shannon-McMillan-Breiman theorem are verified in
this case, for which examples will be provided below.
3) Non-trivial stable type. If the type of the Γ-action on (B, η) is IIIτ for some τ > 0
then the action of Γ on the Maharam extension has a set of ergodic components admitting a
free transitive action of the circle group R/Z · log τ , which acts on the Maharam extension and
which commutes with the Γ-action. If this is also the situation for the Maharam extension of
all the spaces (X × B, λ × η) for every ergodic p.m.p. action of Γ, then the Γ-action on (B, η)
is defined in [BN13b] to have stable type τ . In that case, it is also possible to prove a version
of the Shannon-McMillan-Breiman pointwise convergence theorem, which applies, rather than to
the information functions we defined, to a further average of them. In particular, this provides
a proof of the Shannon-McMillan mean-convergence theorem in our context. In the interest of
brevity, however, we shall provide the details elsewhere. We refer to [BN13b] and [BN15a] for
to a detailed discussion of type, stable type and Maharam extensions in the context of pointwise
ergodic theorems for group actions.
4) Ergodicity and mixing conditions. Given an injective cocycle α : R → Γ on an ergodic
p.m.p. amenable relation and a p.m.p. action of Γ on (X, λ), it is possible to develop criteria to
show that the extended relation RX is ergodic, provided that the Γ-action on X satisfies additional
ergodicity or mixing conditions. This implies that the Shannon-McMillan-Breiman theorem is valid
for Γ-actions on a suitable class of p.m.p. actions on (X, λ). A simple example of this phenomenon
arises for the p.m.p. actions of finitely generated non-abelian free groups Fr . Here, taking the
boundary (∂Fr , ν) with the uniform measure ν, we construct a cocycle α : R → Fr , where R
is an amenable p.m.p. relation on ∂Fr , which is not ergodic, but in fact has exactly two ergodic
components. If (X, λ) is a p.m.p. ergodic action of Fr for which the index 2 subgroup of even length
words is ergodic, then the extended relation RX is an ergodic relation, see [BN13a] for a detailed
exposition. Hence these actions of Fr satisfy the Shannon-McMillan-Breiman theorem. We will
give a detailed exposition of this case, which will also demonstrate the geometric significance of
the theorem, in the next section.
To conclude this section let us note the following results concerning type and stable type, which
are relevant to the foregoing discussion.

Examples 7.1.
(1) Let Γ be an irreducible lattice in a connected semisimple Lie group with
finite center and without compact factors. Then the action of Γ on the maximal boundary

THE SHANNON-MCMILLAN-BREIMAN THEOREM FOR GROUP ACTIONS

27

(G/P, m), where P is a minimal parabolic subgroup and m is the Lebesgue measure class,
is amenable and has stable type III1 , see [BN13b].
(2) Let Γ be a discrete non-elementary subgroup of isometries of real hyperbolic space. By
[Su78] [Su82], the type of the action of Γ on the boundary of hyperbolic space with respect
to the Lebesgue measure class is III1 . In [Sp87] this result was proved for the action of
fundamental groups of compact connected negatively curved manifolds acting on the visual
boundary with the manifold measure class.
(3) Let Γ be a finitely generated free group. By [RR07], the action of Γ has non-trivial type
with respect to harmonic measures, namely stationary measures of suitable random walks.
For Γ being a word hyperbolic group, it was proved in [INO08] that the action of Γ on the
Poisson boundary associated with a generating measure of finite support has non-trivial
type.
(4) In [Bo14] it was proved that for word hyperbolic groups (with an additional technical
condition) the action on the Gromov boundary with respect to a quasi-conformal measure
(and in particular the Patterson-Sullivan measure) measure has non-trivial stable type.
8. The free group
8.1. The boundary of the free group. We briefly describe the ingredients we need for our
analysis, following the exposition of [BN13a].
Let F = ha1 , . . . , ar i be the free group of rank r ≥ 2, with S = {a±1
: 1 ≤ i ≤ r} a free set
i
of generators. The (unique) reduced form of an element g ∈ F is the expression g = s1 · · · sn with
si ∈ S and si+1 6= s−1
for all i. Define |g| := n, the length of the reduced form of g. The distance
i
function on F is defined by d(g1 , g2 ) := |g1−1 g2 |. The Cayley graph associated with the generating
set S is a regular tree of valency 2r, and d coincides with its edge-path distance.
The boundary of F is the set of all sequences ξ = (ξ1 , ξ2 , . . .) ∈ S N such that ξi+1 6= ξi−1
 for
all i ≥ 1. We denote it by ∂F. A metric d∂ on ∂F is defined by d∂ (ξ1 , ξ2 , . . .), (t1 , t2 , . . .) = n1
where n is the largest natural number such that ξi = ti for all i < n. If {gi }∞
i=1 is any sequence
of elements in F and gi := ti,1 · · · ti,ni is the reduced form of gi then limi gi = (ξ1 , ξ2 , . . .) ∈ ∂F if
ti,j is eventually equal to ξj for all j. If ξ ∈ ∂F then we will write ξi ∈ S for i-th element in the
sequence ξ = (ξ1 , ξ2 , ξ3 , . . .).
We define a probability measure ν on ∂F, by the requirement that every finite sequence t1 , . . . , tn
with ti+1 6= t−1
for 1 ≤ i < n, the following holds :
i

	
ν (ξ1 , ξ2 , . . .) ∈ ∂F : ξi = ti 1 ≤ i ≤ n := |Sn (e)|−1 = (2r − 1)−n+1 (2r)−1 .
There is a natural action of F on ∂F by

(t1 · · · tn )ξ := (t1 , . . . , tn−k , ξk+1 , ξk+2 , . . .)
where t1 , . . . , tn ∈ S, t1 · · · tn is in reduced form and k is the largest number ≤ n such that
ξi−1 = tn+1−i for all i ≤ k. Observe that if g = t1 · · · tn then the Radon-Nikodym derivative
satisfies
dν ◦ g
(ξ) = (2r − 1)2k−n .
dν
8.2. The horospherical relation and the fundamental cocycle. Let R be the equivalence
relation on ∂F given by (ξ, η) ∈ R if and only when writing ξ = (ξ1 , ξ2 , . . .) and η = (η1 , η2 , . . .),
there exists n such that ηi = ξi for all i > n. Thus ηRξ if and only if η and ξ have the same
synchronous tail, if and only if they differ by finitely many coordinates only.
Let Rn be the equivalence relation given by (ξ, η) ∈ Rn if and only if ξi = ηi ∀i > n. Then R
is the increasing union of the finite subequivalence relations Rn . Thus R is a hyperfinite relation.
Consider the relation R′ on ∂F such that ηR′ ξ if and only if there is a g ∈ F such that
dν◦g
gξ
n = η and dν (ξ)o = 1. Note that the level set of the Radon-Nikodym derivative, namely
g ∈ F;

dν◦g
dν (ξ)

=1

is the horosphere in the Cayley tree based at ξ and passing through the

−1
−1
dν◦g
identity in F. Note that in that case ξ = g −1 η, and dν◦g
= 1, so that the
dν (η) =
dν (ξ)

28

AMOS NEVO AND FELIX POGORZELSKI

relation is indeed symmetric. The transitivity of the horospherical relation R′ follows from the
cocycle identity which the Radon-Nikodym derivative satisfies. Thus R′ is an equivalence relation,
and by definition, the measure ν is R′ -invariant.
The relation R′ on ∂Fr can also be defined more concretely by the condition that (ξ, η) ∈ R′
iff there exists k s.t. η = gξ and g = η1 · ... · ηk · ξk−1 · ... · ξ1−1 . It follows that η = gξ has the same
synchronous tail as ξ from the k +1-th letter onwards. Equivalently, g −1 belongs to the horosphere
based at ξ and passing through the identity in Fr , namely the geodesic from g −1 to ξ and the
geodesic from e to ξ meet at a point which is equidistant from e and g −1 . Thus it is natural to
call R′ the horospherical relation and the equivalence class of ξ under Rn the horospherical ball
of radius n based at ξ. Since ξ and η = gξ have the same synchronous tail, R′ coincides with the
synchronous tail relation R.
The fundamental cocycle of the tail relation is the measurable map α : R → Fr given, for
η = (η1 , . . . , ηk , . . . ) and ξ = (ξ1 , . . . , ξk , . . . ) (with (η, ξ) ∈ Rk ), by
α(η, ξ) = η1 · ... · ηk · ξk−1 · ... · ξ1−1
so that α(η, ξ)ξ = η. The cocycle takes values in the subgroup Fer consisting of words of even
length, and more precisely for each k the set of values α(η, ξ) for fixed η and ξ ∈ Rk (η) coincides
with the intersection of the word metric ball B2k (e) with the horoball based at η and passing
through e. This set is called the horospherical ball of radius 2k determined by η and denoted by
η
B2k
.
η −1
Note further that the set of cocycle values α(ξ, η) for ξRk η with η fixed, namely the set (B2k
) ,
is given by
α(ξ, η) = ξ1 · ... · ξk · ηk−1 · ... · η1−1
and this set contains words of length at most 2k whose first (k − 1) letters can be specified
arbitrarily.
Finally, consider the set of values of the cocycles α(η, ξ) for all points η 6= ξ which are Rk
equivalent to another, i.e. as we go over all pairs of distinct points in some equivalence class of the
form Rk (ζ). This set of values clearly contains all the even words in a ball of radius 2k − 2, i.e.
B2k−2 (e) ∩ Fer .
The finite order automorphisms of R is the subgroup Φ of ∪n∈N [Rn ] generated by the transformations defined as follows. Let πn : ∂Fr → S n be the projection given by πn (s1 , s2 , ...) =
(s1 , s2 , ..., sn ). We say that a map ψ : ∂Fr → ∂Fr has order n if ψ (ξ) = ψ (ξ ′ ) for any two
boundary points ξ, ξ ′ ∈ ∂Fr with πn (ξ) = πn (ξ ′ ).
For any (ξ, ξ ′ ) ∈ R there exists a map φ ∈ Φ such that φ (ξ) = ξ ′ and φ has order n for
some n ∈ N, see [BN13a]. Thus the group of finite order automorphisms clearly generates the
synchronous tail (i.e. the horospherical) relation.
The extended horospherical relation. Let F act by measure-preserving transformations on a
′ ′
probability space (X, λ). Let RX
n be the equivalence relation on X×∂F defined by ((x, ξ), (x , ξ )) ∈
X
′ ′
′
Rn if and only if there exists g ∈ F with (gx, gξ) = (x , ξ ) and (ξ, ξ ) ∈ Rn (i.e., if ξ = (ξ1 , . . .) ∈
S N and ξ ′ = (ξ1′ , . . .) ∈ S N then ξi = ξi′ for all i ≥ n).
Inspecting the definitions, we see that the extended horospherical relation on X × ∂Fr coincides with the extension of the horospherical (i.e. synchronous tail) relation R on ∂Fr via the
fundamental cocycle α : R → Fr defined above.
It is easy to see that for any (y, ξ) ∈ X × ∂F,
 X

Rn (y, ξ)) = |Rn (ξ)| = (2r − 1)n .
S
The relation RX = n≥1 RX
n is thus a hyperfinite measurable equivalence relation, it preserves
the measure ν × λ, and it is uniform, namely for each n ≥ 1 almost every equivalence class of the
relation RX
n has the same cardinality.
8.3. Shannon-McMillan-Breiman theorem for the free groups. Let RX be the equivalence
relation on X × ∂Fr . We may assume the action of Fr on (X, λ) is ergodic, and we will use the
following.

THE SHANNON-MCMILLAN-BREIMAN THEOREM FOR GROUP ACTIONS

29

Theorem 8.1. [BN13a]. If Fer acts on (X, λ) ergodically, then the diagonal action Fer y X × ∂Fr
is ergodic.
The type of the boundary action. The type of the action Fr y (∂Fr , ν) is IIIτ where
τ = (2r − 1)−1 . It is follows from [BN13a, Theorem 4.1] that the stable type of Fr y (∂Fr , ν)
is IIIτ 2 . In fact, if Fer denotes the index 2 subgroup of F consisting of all elements of even word
length then Fer y (∂Fr , ν) is of type IIIτ 2 and stable type IIIτ 2 . It is also weakly mixing. Indeed,
(∂Fr , ν) is naturally identified with B(Fr , µ), the Poisson boundary of the random walk generated
by the measure µ that is distributed uniformly on S. By [AL05], the action of any countable
group Γ on the Poisson boundary B(Γ, κ) is weakly mixing whenever the measure κ is adapted.
This shows that Fr y (∂Fr , ν) is weakly mixing. Moreover, if we denote S 2 = {st : s, t ∈ S},
then (∂Fr , ν) is naturally identified with the Poisson boundary B(Fer , µ2 ) where µ2 is the uniform
probability measure on S 2 . So the action Fer y (∂F, ν) is also weakly mixing.
Let Fr act on ∂Fr × Z by g(b, t) = (gb, t − log rν (g, b)), which gives the discrete Maharam
extension in this case. Let R be the orbit-equivalence relation restricted to ∂Fr × {0}, which we
may, for convenience, identify with ∂Fr . In other words, bRb′ if and only if there is an element
g ∈ Fr such that gb = b′ and dν◦g
dν (b) = 1. As noted above, this is the same as the (synchronous)
tail-equivalence relation on Fr . In other words, two elements ξ = (ξ1 , ξ2 , . . .), η = (η1 , η2 , . . .) ∈ ∂Fr
are R-equivalent if and only if there is an m such that ξn = ηn for all n ≥ m. But now note that
if bR(gb), then necessarily g ∈ Fer . So R can also be regarded as the orbit-equivalence relation for
the Fer -action on ∂Fr × Z restricted to ∂Fr × {0}.
Let α : R → Fer be the cocycle α(gb, b) = g for g ∈ Fer , b ∈ ∂Fr . This is well-defined almost
everywhere because the action of Fer is essentially free. Because Fer y (∂Fr , ν) has type IIIτ 2
and stable type IIIτ 2 , this cocycle is weakly mixing for Fer . In other words, if Fer y (X, µ) is
any ergodic p.m.p action, then the equivalence relation RX defined on X × ∂Fr by the cocycle
extension is ergodic. Since the relation is hyperfinite and the cocycle is injective, we conclude that
the action of Fr on any ergodic p.m.p. space satisfies the Shannon-McMillan-Breiman theorem,
provided only that Fer acts ergodically on X.
References
[AL05]

Aaronson, J. and Lemanczyk, M. Exactness of Rokhlin endomorphisms and weak mixing of Poisson
boundaries. Algebraic and topological dynamics. Contemp. Math. 385, Amer. Math. Soc., Providence,
RI (2005), pp. 77–87.
[ADR]
Anantharaman-Delaroche, C. and Renault, J. Amenable groupoids. L’Enseignement Mathématique, vol.
36, 2000.
[Av10]
Avni, N., Entropy Theory for Cross Sections, Geom. Func. Ana., vol. 19 (2010), pp. 1515-1538.
[Br57]
Breiman, L., The individual ergodic theorem of information theory, Ann. Math. Stat. 28 (1957), pp.
809–911. Correction, ibid. 31 (1960), pp. 809–910.
[Bo10a] Bowen, L. Invariant measures on the space of horofunctions of a word-hyperbolic group. Ergodic Theory
and Dynamical Systems, 30, no. 1 (2010), pp. 97–129.
[Bo10b] Bowen, L. The ergodic theory of free group actions: entropy and the f-invariant. Groups Geom. Dyn. 4,
no. 3 (2010), pp. 419-432.
[Bo10c] Bowen, L. Measure conjugacy invariants for actions of countable sofic groups. J. Amer. Math. Soc. 23
(2010), pp. 217–245.
[Bo12]
Bowen, L. Sofic entropy and amenable groups. Ergodic Theory Dynam. Systems 32, no. 2 (2012), pp.
427–466.
[Bo14]
Bowen, L. The type and stable type of the boundary of a Gromov hyperbolic group. Geometriae Dedicata
172 (2014), pp. 363–386.
[BN13a] Bowen, L. and Nevo, A. Geometric covering arguments and ergodic theorems for free groups.
L’Enseignement Mathématique, 59 (2013), pp. 133–164.
[BN13b] Bowen, L. and Nevo, A. Pointwise ergodic theorems beyond amenable groups. Ergod. Th. and Dynam.
Sys. 33 (2013), pp. 777–820.
[BN15a] Bowen, L. and Nevo, A. Amenable equivalence relations and the construction of ergodic averages for
group actions. To appear in Journal d’Analyse Mathématique,(2015).
[BN15b] Bowen, L. and Nevo, A. von Neumann and Birkhoff ergodic theorems for negatively curved groups. Ann.
Sci. Ec. Norm. Supér. 48 (2015), pp. 1113–1147.
[CCK14] Ceccherini-Silberstein, T., Coornaert, M. and Krieger, F. An analogue of Fekete’s lemma for subadditive
functions on cancellative amenable semigroups. J. Ana. Math. 124 (2014), pp. 59–81.

30

[CFS]

AMOS NEVO AND FELIX POGORZELSKI

Cornfeld, I. P., Fomin, S. V., and Sinai, Ya. G.,Ergodic Theory. A Series of Comprehensive Studies in
Mathematics, vol. 245, Springer Verlag, 1982.
[CFW81] Connes, A., Feldman, J. and Weiss, B. An amenable equivalence relation is generated by a single transformation. Ergod. Th. and Dynam. Sys. 1 (1981), pp. 431–450.
[Da01]
Danilenko, A., Entropy Theory from the Orbital Point of View. Monatsh. Math. 134 (2001), pp. 121-141.
[DP02]
Danilenko, A. and Park, K. Generators and Bernoullian factors for amenable actions and cocycles on
their orbits. Ergod. Th. and Dynam. Sys. (2002) 22, pp. 1715–1745.
[De74]
Denker, M. Finite generators for ergodic, measure-preserving transformations. Prob. Th. Rel. Fields 29
(1974), pp. 45–55.
[Dy59]
Dye, H. On groups of measure transformations I. Amer. J. Math., vol. 81 (1959), pp. 119–159.
[Em75]
Emerson, W. R. Averaging strongly subadditive set functions in unimodular amenable groups I. Pacific
Journal of Mathematics 61 (1975), pp. 391–400.
[FM77]
Feldman, J. and Moore, C. C. Ergodic equivalence relations, von Neumann algebras and cohomology. I
and II. Trans. A.M.S. 234 (1977), pp. 289–324
[FS08]
Flajolet, P. and Sedgewick, R. Analytic Combinatorics. Cambridge University Press New York, 2008.
[Ga00]
Gaboriau, D. On orbit equivalence of measure preserving actions. Rigidity in dynamics and geometry
(Cambridge, 2000), Springer Berlin 2002, pp. 167–186.
[Gr99]
Gromov, M. Topological invariants of dynamical systems and spaces of holomorphic maps. I. Math.
Phys. Anal. Geom. 2 (1999), pp. 323–415.
[INO08] Izumi, M., Neshveyev, S. and Okayasu, R. The ratio set of the harmonic measure of a random walk on
a hyperbolic group. Israel J. Math. 163 (2008), pp. 285–316.
[Ka97]
Kaimanovich, V. Amenability, hyperfiniteness and isoperimetric inequalities. C. R. Acad. Sci. Paris Sér.
I Math., 325 (1997), pp. 999–1004.
[Ka02]
Kaimanovich, V. Equivalence relations with amenable leaves need not be amenable. In Topology, ergodic
theory, real algebraic geometry of Amer. Math. Soc. Trans. Ser. 2, 202 (2001), pp. 151–166.
[Ka03]
Kaimanovich, V. A. Double ergodicity of the Poisson boundary and applications to bounded cohomology.
Geom. Funct. Anal. 13 (2003), no. 4, pp. 852–861.
[Ki75]
Kieffer, J. C. A ratio limit theorem for a strongly subadditive set function in a locally compact amenable
group. Pacific Journal of Mathematics 61 (1975), pp. 183–190.
[Ke13]
Kerr, D. Sofic measure entropy via finite partitions. Groups. Geom. Dyn. 7 (2013), pp. 617–632.
[KL11]
Kerr, D. and Li, H. Entropy and the variational principle for actions of sofic groups. Invent. Math., 186
(2011), pp. 501–558.
[KL13]
Lerr, D. and Li, H. Soficity, amenability, and dynamical entropy. Amer. J. Math. 135 (2013), pp. 721-761.
[Ko58]
Kolmogorov, A.N. New Metric Invariant of Transitive Dynamical Systems and Endomorphisms of
Lebesgue Spaces. (Russian) Doklady of Russian Academy of Sciences 119 (1958), pp. 861–864.
[Ko59]
Kolmogorov, A.N. Entropy per unit time as a metric invariant for automorphisms (Russian) Doklady
of Russian Academy of Sciences 124 (1959), pp. 754–755.
[Kr70]
Krieger, W. On entropy and generators of measure-preserving transformations. Trans. Amer. Math. Soc.
149 (1970), pp. 453–464.
[Li01]
Lindenstrauss, E. Pointwise theorems for amenable groups. Invent. Math., 146 (2001) pp. 259–295.
[LW00]
Lindenstrauss, E. and Weiss, B. Mean topological dimension. Israel J. Math. 115 (2000), pp. 1–24.
[Mc53]
McMillan, B., The basic theorems of information theory. Ann. Math. Stat. 24 (1953), pp. 196–219.
[Ne05]
Nevo, A. Pointwise ergodic theorems for actions of groups. Handbook of Dynamical Systems, vol. 1B,
Eds. B. Hasselblatt and A. Katok, 2006, Elsevier, pp. 871-982.
[Ol85]
Ollagnier, J. Ergodic Theory and Statistical Mechanics. Lecture Notes in Mathematics 1115, SpringerVerlag, Berlin, 1985.
[OW80] Ornstein, D. and Weiss, B. Ergodic theory of amenable group actions. I. The Rohlin lemma., Bull. Amer.
Math. Soc. vol. 2 (1980), pp. 161–164.
[OW83] Ornstein, D. and Weiss, B. The Shannon-McMillan-Breiman theorem for a class of amenable groups.
Israel J. Math. 44 (1983) pp. 53–60.
[OW87] Ornstein, D. and Weiss, B. Entropy and isomorphism theorems for actions of amenable groups. Journal
d’Analyse Mathématique 48 (1987), pp. 1–141.
[Po14]
Pogorzelski, F. Convergence theorems for graph sequences. Int. J. Alg. Comp. 24 (2014), pp. 1233–1251.
[PS16]
Pogorzelski, F. and Schwarzenberger, F. A Banach space-valued ergodic theorem for amenable groups
and applications. Journal d’Analyse Mathématique 130 (2016), pp. 19–69.
[RR07]
Ramagge, J. and Robertson, G. Factors from trees. Proc. Amer. Math. Soc. 125 no. 7 (1997), pp.
2051–2055.
[Ro67]
Rokhlin, V.A. Lectures on the entropy theory of transformations with invariant measure. Uspehi Mat.
Nauk. 22 (1967), pp. 3–56.
[RW00] Rudolph, D. and Weiss, B. Entropy and mixing for amenable group actions. Ann. Math. 151 (2000), pp.
1119–1150.
[Se12]
Seward, B. Ergodic actions of countable groups and finite generating partitions. Groups, Geometry, and
Dynamics 9 no. 3 (2015), pp. 793–810.

THE SHANNON-MCMILLAN-BREIMAN THEOREM FOR GROUP ACTIONS

[Se14]
[Se15]
[Se16]
[Sh48]
[Si59]
[Sp87]
[ST12]
[Su78]

[Su82]
[We84]
[We03]
[Zi78]

31

Seward, B. Krieger’s finite generator theorem for ergodic actions of countable groups I.
http://arxiv.org/abs/1405.3604 (2014).
Seward, B. Krieger’s finite generator theorem for ergodic actions of countable groups II.
http://arxiv.org/abs/1501.03367 (2015).
Seward, B. Weak containment and Rokhlin entropy. http://arxiv.org/abs/1602.06680 (2016).
Shannon, C. E., A mathematical theory of communication. Bell System Tech. J. 27 (1948), pp. 379–423,
pp. 623–656.
Sinai, Y. On the concept of entropy for a dynamical system. Dokl. Akad. Nauk SSSR 124 (1959), pp.
768–771.
Spatzier, R. J. An example of an amenable action from geometry. Ergodic Theory Dynam. Systems 7
no. 2 (1987), pp. 289–293.
Seward, B. and Tucker-Drob, R. Borel structurability on the 2-shift of a countable group. Ann. Pure and
Applied Logic 167 (2016).
Sullivan, D. On the ergodic theory at infinity of an arbitrary discrete group of hyperbolic motions.
Riemann surfaces and related topics: Proceedings of the 1978 Stony Brook Conference (State Univ. New
York, Stony Brook, N.Y., 1978), pp. 465–496, Ann. of Math. Stud. 97, Princeton Univ. Press, Princeton,
N.J., 1981.
Sullivan, D. Discrete conformal groups and measurable dynamics. Bull. Amer. Math. Soc. (N.S.) 6 no. 1
(1982), pp. 57–73.
Weiss, B. Measurable dynamics. Contemp. Math. voL. 26 (1984), pp. 395-421.
Weiss, B. Actions of amenable groups. London Mathematical Society Lecture Note Series 310, 226-262,
(2003).
Zimmer, R. Amenable ergodic group actions and an application to Poisson boundaries of random walks.
J. Funct. Anal. 27 (1978), 350-372.

Technion, Israel Institute of Technology
E-mail address: anevo@tx.technion.ac.il
Technion, Israel Institute of Technology
E-mail address:
felixp@technion.ac.il

