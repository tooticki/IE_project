TWISTED RELATIVE TRACE FORMULAE
WITH A VIEW TOWARDS UNITARY GROUPS

arXiv:1701.01762v1 [math.NT] 6 Jan 2017

JAYCE R. GETZ AND ERIC WAMBACH
Abstract. We introduce a twisted relative trace formula which simultaneously generalizes
the twisted trace formula of Langlands et. al. (in the quadratic case) and the relative trace
formula of Jacquet and Lai [JL]. Certain matching statements relating this twisted relative
trace formula to a relative trace formula are also proven (including the relevant fundamental
lemma in the “biquadratic case”). Using recent work of Jacquet, Lapid and their collaborators [J1] and the Rankin-Selberg integral representation of the Asai L-function (obtained by
Flicker using the theory of Jacquet, Piatetskii-Shapiro, and Shalika [Fl2]), we give the following application: Let E/F be a totally real quadratic extension with hσi = Gal(E/F ), let U σ
be a quasi-split unitary group with respect to a CM extension M/F , and let U := ResE/F U σ .
Under suitable local hypotheses, we show that a cuspidal cohomological automorphic representation π of U whose Asai L-function has a pole at the edge of the critical strip is
nearly equivalent to a cuspidal cohomological automorphic representation π ′ of U that is
U σ -distinguished in the sense that there is a form in the space of π ′ admitting a nonzero
period over U σ . This provides cohomologically nontrivial cycles of middle dimension on unitary Shimura varieties analogous to those on Hilbert modular surfaces studied by Harder,
Langlands, and Rapoport [HLR].

Contents
1. Introduction
1.1. Distinction
1.2. A result on unitary groups
1.3. Outline of a proof
2. Selected notation and conventions
2.1. Algebraic groups
2.2. Adèles
2.3. Harish-Chandra subgroups
3. Twisted relative classes and norm maps
3.1. Twisted relative classes
3.2. Norms of stable classes: Definitions
3.3. Existence of norms

2
2
4
5
7
7
8
8
9
9
12
14

2010 Mathematics Subject Classification. Primary 11F70.
The first author is thankful for partial support provided by NSF grant DMS 0703537. Commutative
diagrams were typeset using Paul Taylor’s diagrams package.
1

2

JAYCE R. GETZ AND ERIC WAMBACH

4. Matching of functions
4.1. Local orbital integrals: Definitions
4.2. Stable local orbital integrals
4.3. Matching of functions: Definition
4.4. Local relative κ-orbital integrals
4.5. Proof of the fundamental lemma: First case
4.6. Matching at the E-split places
5. Matching at the ramified places
5.1. Local constancy of the relative orbital integrals
5.2. Proof of Theorem 5.1
6. Spherical characters
7. Prestabilization of a single stable relative orbital integral
7.1. Global relative orbital integrals
7.2. Some cohomology groups
7.3. Prestabilization of a single relatively elliptic term
8. Grouping relatively elliptic terms
8.1. Haar measures
8.2. Elliptic kernels
8.3. Stable geometric expansions
8.4. The unitary case
9. Relative trace formulae
9.1. A simple relative trace formula
9.2. Comparison
10. Application
10.1. Statement of theorem
10.2. Proof of Corollary 10.4
10.3. Preparations for the proof of Theorem 10.3
10.4. Proof of Theorem 10.3: Separating Hecke characters
10.5. Proof of Theorem 10.3: Nonvanishing
Acknowledgments
References
Index of Notation

17
17
17
18
18
19
21
24
24
30
31
32
32
34
35
36
36
37
38
39
41
41
42
42
43
45
45
48
50
52
52
55

1. Introduction
1.1. Distinction. Let F be a number field and let G be a reductive F -group with automorphism σ over F of order 2. Write Gσ ≤ G for the reductive subgroup whose points in an

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

3

F -algebra R are given by
Gσ (R) := {g ∈ G(R) : g = g σ }.
Let π be a cuspidal unitary automorphic representation of G(AF ). For smooth φ in the
π-isotypic subspace of the cuspidal subspace L20 (G(F )\1 G(AF )) ≤ L2 (G(F )\1 G(AF )), the
period integral
Z
(1.1.1)
φ(x)dx
PGσ (φ) : =
Gσ (F )\(Gσ (AF )∩1 G(AF ))

converges (see [AGR, Proposition 1, §2]). Here 1 G(AF ) ≤ G(AF ) is the Harish-Chandra
subgroup (see §2.3) and dx is induced by a choice of Haar measure on Gσ (AF ) ∩ 1 G(AF ). If
PGσ (φ) 6= 0 for some smooth φ in the π-isotypic subspace of L20 (G(F )\1G(AF )), we say that
π is Gσ -distinguished, or simply distinguished.
In [HLR], Harder, Langlands, and Rapoport introduced the notion of distinction as a tool
for producing cohomologically nontrivial cycles on Hilbert modular surfaces. Their work was
based on the following observation: If G(F ⊗Q R) ∼
= Gσ (F ⊗Q R) × Gσ (F ⊗Q R) and if π has
nonzero cohomology with coefficients in C (see Definition 10.2) and is Gσ -distinguished then
there is a differential form ω on a locally symmetric space attached to G that is π ∞ -isotypic
under the action of certain Hecke correspondences such that ω has a nonzero period over a
sub-symmetric space defined by Gσ . Harder, Langlands and Rapoport investigated the case
where G = ResQ(√d)/Q GL2 for a square-free positive integer d and σ is the automorphism of G
√
induced by the nontrivial element of Gal(Q( d)/Q). As a consequence of their investigation
they proved the Tate conjecture for the “non-CM” part of the cohomology of Hilbert modular
surfaces. The key fact that allowed them to link Galois invariant elements in an étale
cohomology group to the existence of cycles was a characterization of GL2 -distinguished
cuspidal automorphic representations of ResQ(√d)/Q GL2 (AQ ) in terms of a certain invariance
property of π under σ.
The characterization of GL2/Q -distinguished representations used in [HLR] can be proven
using a modification of the Rankin-Selberg method [A]. More generally, let E/F be a
quadratic extension of number fields. A variation of Jacquet, Piatetskii-Shapiro and Shalika’s interpretation of the Rankin-Selberg method similarly gives some characterization of
those automorphic representations of ResE/F GLn distinguished by GLn/F in terms of Asai
L-functions [Fl2]. However, in most situations a characterization of the automorphic representations of G distinguished by Gσ in terms of arithmetic properties of the automorphic
representation or analytic properties of L-functions attached to the automorphic representation is unknown.
To address these situations, Jacquet has introduced relative trace formulae in order to
provide a (mostly conjectural) conceptual understanding of distinction in great generality.
Though the theory still is far from complete, many interesting results are known, even in
higher rank. For example, if E/F is a quadratic extension as above, Jacquet, Lapid, and their

4

JAYCE R. GETZ AND ERIC WAMBACH

collaborators have provided a characterization of those representations of ResE/F GLn (AF )
that are distinguished by a quasi-split unitary group in n-variables attached to E/F [J1]
[J2].
1.2. A result on unitary groups. Since the locally symmetric spaces attached to GLn
are never hermitian for n > 2, the higher rank results of Jacquet and Lapid mentioned
above cannot be directly applied to the study of the Tate conjecture for Shimura varieties
as in [HLR]. Despite this, in this paper we provide one means of relating distinction of
automorphic representations of GLn to distinction of automorphic representations on unitary
groups (including those defining hermitian locally symmetric spaces). We now state an
application. Let E/F be a quadratic extension of totally real number fields, let hσi =
Gal(E/F ), and let M/F be a CM extension. Let U σ be a quasi-split unitary group in n
variables attached to the extension M/F and let U := ResE/F U σ . We have the following
result:
Theorem 1.1. Let π be a cuspidal automorphic representation of U σ (AE ) = U(AF ). Suppose
that π satisfies the following assumptions:
(1) There is a finite-dimensional representation V of UF∞ such that π has nonzero cohomology with coefficients in V .
(2) There is a finite place v1 of F totally split in ME/F such that πv1 is supercuspidal.
(3) There is a finite place v2 6= v1 of F totally split in ME/F such that πv2 is in the
discrete series.
(4) For all places v of F such that ME/F is ramified and M/F , E/F are both nonsplit
at v the weak base change Π of π to U(AM E ) ∼
= GLn (AM E ) has the property that Πv
is relatively τ -regular.
The representation π admits a weak base change Π to GLn (AM E ). If the partial Asai Lfunction LS (s, Π; r) has a pole at s = 1 then some cuspidal automorphic representation π ′ of
U(AF ) nearly equivalent to π is U σ -distinguished. Moreover, we can take π ′ to have nonzero
cohomology with coefficients in V .
Here we say two automorphic representations are nearly equivalent if their local factors are
isomorphic at almost all places. Moreover, S is a finite set of places of M including all
infinite places, all places where ME/M is ramified, and all places below places of ME where
Π is ramified, and
r : L ResM E/M GLn −→ GLn2 (C)
is the twisted tensor representation attached to the extension ME/M (see [Fl2] or [R, §6]
for the definition of this representation). We are also using the fact that LS (s, Π; r) has a
meromorphic continuation to a closed right half plane containing s = 1 (see [Fl2] and [FlZ]).

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

5

Theorem 1.1 is proved as Corollary 10.4 below. For the definition of a relatively τ -regular
representation, see §6 below. For other unexplained notation and terminology, see §10. We
indicate the role of some of the assumptions in the theorem:
Remarks.
(1) The assumption that π is cohomological allows us to use the proof of [HL, Theorem
3.1.4] to conclude that the weak base change Π exists.
(2) The assumptions at the places v1 and v2 are made for two reasons. First, they allow
us to apply known results on base change liftings from [HL]. Second, they allow us to
use the simple form of the relative trace formula proved in [H]. If a relative version
of the Arthur-Selberg trace formula were known, together with a theory of relative
endoscopy, then it would probably be possible to remove the restrictions on v1 and
v2 .
(3) Assumption (4) allows us to use test functions supported on the relatively τ -regular
semisimple set at places where we have not proven satisfactory matching statements
for arbitrary functions. The definition of a relatively τ -regular admissible representation is given in §6 below.
(4) The assumption that U σ is quasi-split is relaxed somewhat in Corollary 10.4 below.
Given all of these simplifying assumptions, one might be surprised that this paper is still
rather long. As an explanation, we point out that to prove our theorem we have to provide,
from scratch, analogues of many standard constructions in the theory of the usual trace
formula (for example, we need analogues of many of the results of [K1], [K3], [K4], [K5]).
Unfortunately, this takes some space. We have tried to streamline the presentation by not
working in the greatest possible generality.
1.3. Outline of a proof. Let π be a cuspidal automorphic representation of U(AF ) satisfying the hypotheses of Theorem 1.1 and admitting a weak base change Π to ResM E/F GLn (AF )
(see §10.1 for our conventions regarding weak base change). Let τ be the automorphism of
G := ResM E/F GLn fixing U, and let θ = σ ◦ τ . We prove Theorem 1.1 in two steps. First,
we prove that if Π is distinguished by ResM/F GLn and the quasi-split unitary group Gθ
attached to EM/(EM)hθi then some automorphic representation π ′ nearly equivalent to π
is U σ distinguished. We prove this by exhibiting identities of the form
X X
X X
PGσ (Π(f 1 )φ0 )PGθ (φ0 )
PU σ (π(Φ1 )φ)PU σ (φ) = 2
π

φ∈B(π)

Π φ0 ∈B(Π)

Cc∞ (G(AF ))

for a sufficiently large set of functions f ∈
and Φ ∈ Cc∞ (U(AF )) that match
in the sense of Definition 4.1. Here the sum on the left is over cuspidal automorphic representations of U(AF ), the sum on the right is over cuspidal automorphic representations
of G(AF ), and B(π) is an orthonormal basis of the π-isotypic subspace of L2 (U(F )\U(AF ))
consisting of smooth vectors; B(Π) is defined similarly. We refer the reader to Proposition
9.2 for more details.

6

JAYCE R. GETZ AND ERIC WAMBACH

Second, the fact that Π is a base change implies that Πτ ∼
= Π. By work of Flicker
and his collaborators, our assumption on the pole of the Asai L-function implies that Π
is distinguished by ResM/F GLn and moreover that Π∨ ∼
= Π,
= Πσ . This implies that Πθ∨ ∼
and hence by work of Jacquet, Lapid, and their collaborators this in turn implies that Π is
distinguished by Gθ . This second step is contained in §10 and we will say no more about it
in the introduction.
The proof of the first step is the heart of this paper and is based on a particular case
of a general principle which we now explain. Let H be a connected reductive group, let
hτ i = Gal(M/F ), and let
G := ResM/F H.
Let σ be an automorphism of H of order 2 and let H σ ≤ H and Gσ ≤ G be the subgroups
fixed by σ. Let θ = σ ◦ τ , viewed as an automorphism of G, and let Gθ ≤ G be the subgroup
fixed by θ. Let π be a cuspidal automorphic representation of H(AF ). Assume that π admits
a weak base change Π to G(AF ). In favorable circumstances the machinery developed in this
paper together with suitable fundamental lemmas should imply that if Π is Gσ -distinguished
and Gθ -distinguished then a cuspidal automorphic representation π ′ nearly equivalent to π
is H σ -distinguished.
We mention two large obstacles to turning the general principle
Π distinguished by Gσ and Gθ ⇒ ∃ H σ -distinguished π ′ nearly equivalent to π
into a theorem in any given case. First is the current lack of a relative analogue of the ArthurSelberg trace formula or a topological relative trace formula. Second is the current lack of
a theory of relative endoscopy and the fundamental lemmas that should come along with
the theory. If we had the tools of a relative Arthur-Selberg trace formula and the theory
of relative endoscopy in hand, one could probably remove the annoying local restrictions
in Theorem 1.1 and prove much more general versions of the principle indicated above.
However, we caution that if one considers involutions σ that are not Galois involutions as we
are primarily concerned with in this paper, there seem to be new phenomena lurking that
we cannot explain here. These new phenomena may make the principle false as it is stated,
though we believe something close to it is true.
We end this outline with some speculation regarding the undefined term “relative endoscopy.” The theory of (twisted) endoscopy, when complete, should yield an understanding
of automorphic representations of classical groups in terms of those on general linear groups
via a twisted trace formula (see [Ar2, §30], for example). We conjecture that a similar theory
will relate distinguished representations on a classical group to representations on GLn that
are distinguished with respect to two subgroups. We believe that Theorem 1.1 provides an
interesting implication of these relations in the special case where endoscopy reduces to base
change.

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

7

Remark. We note that our approach to the relative trace formula is modeled on that exposed
in [JL] and the introduction to [JLR]. More precisely, let E/F be a quadratic extension,
suppose H σ = GL2 , H = ResE/F GL2 , and let σ be induced by the nontrivial automorphism
σ of Gal(E/F ). Then the relatively elliptic part of the trace formula developed in [JL] is
roughly the “τ = 1” case of our theory. If we instead let E = F ⊕ F/F be the “split”
quadratic extension and again let σ be the automorphism of H induced by the nontrivial
F -automorphism of E/F , then our trace formula comparing distinction on G := ResM/F H to
distinction on H is roughly equivalent to the “elliptic part” of the trace formula comparison
used to establish quadratic base change in [L1] (though, of course, Langlands treats general
cyclic extensions). This justifies our claim in the abstract that our formulae simultaneously
generalize the relative trace formula and the twisted trace formula (in the quadratic case).
See Proposition 9.2 for a precise statement regarding trace formula comparisons.
We now give a synopsis of the various sections. We fix some notation in the next section. In
§3.1, following [JL] we develop a notion of relative classes and relative τ -classes generalizing
conjugacy classes and twisted conjugacy classes, respectively. A norm map is also defined
and studied, and in §3.3 we prove that it has the properties one would expect, at least in
the “biquadratic unitary” case (see §3.1).
Section 4 studies the corresponding notion of matching of stable local relative orbital
integrals. We also prove the fundamental lemma for unit elements in the “biquadratic case”
and the fundamental lemma for Hecke functions when various objects split (e.g. M/F ). In
§5 we prove that one can find some function in Cc∞ (H(Fv )) matching a given function in
Cc∞ (G(Fv )) for nonarchimedian v. We define the notion of a relatively τ -regular admissible
representation in §6; we require this notion due to our incomplete knowledge of matching
functions.
Section 7 concerns globalization of stable relative orbital integrals. Here we follow Labesse’s
formulation [La1] of the work of Kottwitz and Shelstad (following Langlands, see [KS], [L2])
on the usual trace formula. In §8 we discuss the geometric expansion of the stable twisted
relative trace formula. In §9 we use the main theorem of [H] together with all of the previous
work to give a spectral expansion of the twisted relative trace formula on G and the relative
trace formula on H, at least in the case relevant for the proof of Theorem 1.1. As noted
above, §10 contains the final argument proving Theorem 1.1.
2. Selected notation and conventions
2.1. Algebraic groups. Let G be an algebraic group over a field F . We write ZG for the
center of G and G◦ for the identity component of G in the Zariski topology. If γ ∈ G(F )
and G′ ≤ G is a subgroup we write Cγ,G′ for the centralizer in G′ of γ. If the element γ is
semisimple then we say it is elliptic if Cγ,G /ZG is anisotropic. If τ is an automorphism of

8

JAYCE R. GETZ AND ERIC WAMBACH

G and γ ∈ G(R) for some commutative F -algebra R we write
γ −τ := (γ −1 )τ .
τ
We write Cγ,G
for the τ -centralizer of γ in G; it is the reductive F -group whose points in an
F -algebra R are given by
τ
Cγ,G
(R) := {g ∈ G(R) : g −1 γg τ = γ}.

A torus T ≤ G is said to be τ -split if for any commutative F -algebra R we have g τ = g −1
for all g ∈ T (R). If θ is another automorphism of G, we say that T is (τ, θ)-split if it is both
τ and θ-split.
2.2. Adèles. The adèles of a number field F are denoted by AF . For a set of places S of
Q
Q
F we write AF,S := AF ∩ v∈S Fv and ASF := AF ∩ v6∈S Fv . If S is finite we often write
FS := AF,S . The set of infinite places of F will be denoted by ∞. Thus AQ,∞ = R and
Q
A∞
p∈Z>0 Qp . For an affine F -variety G and a subset W ≤ G(AF ) the notation WS
Q :=
p prime

(resp. W S ) will denote the projection of W to G(AF,S ) (resp. G(ASF )). If W is replaced
by an element of G(AF ), or if G is an algebraic group and W is replaced by a character of
G(AF ) or a Haar measure on G(AF ), the same notation will be in force; e.g. if γ ∈ G(AF )
then γv is the projection of γ to G(Fv ).

2.3. Harish-Chandra subgroups. Let G be a connected reductive group over a number
field F . We write AG ≤ ZG (F ⊗Q R) for the connected component of the real points of the
largest Q-split torus in the center of ResF/Q G. Here when we say “connected component”
we mean in the real topology. Write X for the group of Q-rational characters of G. There
is a morphism
HCG : G(AF ) −→ Hom(X, R)
defined by
(2.3.1)

hHCG (x), χi = | log(xχ )|

for x ∈ G(AF ) and χ ∈ X. We write
(2.3.2)

1

G(AF ) := ker(HCG )

and refer to it as the Harish-Chandra subgroup of G(AF ). Note that G(F ) ≤ 1 G(AF ) and
G(AF ) is the direct product of AG and 1 G(AF ).

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

9

3. Twisted relative classes and norm maps
In this section we recall the notion of relative classes in algebraic groups with involution
and extend this notion to the “τ -twisted” case. In §3.2 we define stable relative classes and
a relative version of the usual norm map, which, in the original setting of the trace formula,
relates τ -conjugacy classes and conjugacy classes. In §3.3 we use work of Borovoi to show
that the norm map has particularly nice properties in the “biquadratic unitary case.”
3.1. Twisted relative classes. Let F be a number field and let M/F be either a quadratic
or a trivial extension. Let τ be the generator of Gal(M/F ). Fix, once and for all, an algebraic
closure M of M. We usually regard M as an algebraic closure of F as well, and denote it by
F . For all places v of F , choose once and for all an algebraic closure F v of the completion
Fv of F and a compatible system of embeddings F ֒→ F v .
Let H be a reductive F -group with (semisimple) automorphism σ of order two (defined
over F ). We let H σ be the reductive F -group whose points in an F -algebra R are given by
H σ (R) := {g ∈ H(R) : g σ = g}.
We assume that
• H σ is connected.

This will always be the case if H is semisimple and simply connected [St1, §8]. Write
G : = ResM/F H
Gσ : = ResM/F H σ .
The automorphism σ of H induces an automorphism of G which we will also denote by σ.
Set θ := σ ◦ τ (where σ and τ are viewed as automorphisms of G), and write Gθ ≤ G for the
subgroup whose points in an F -algebra R are given by
Gθ (R) := {g ∈ G(R) : g = g θ }.
We note that θ, σ, and τ all commute.
Remark. Let E/F be a quadratic extension of number fields with ME/F biquadratic. The
primary case of interest for us in this paper is the case where H = ResE/F H σ and σ is the
automorphism of H defined by the generator of Gal(E/F ) (which we will also denote by σ).
We refer to this case as the biquadratic case.
We have left actions of H σ × H σ on H and Gσ × Gθ on G given by
(H σ × H σ )(R) × H(R) −→ H(R)
(3.1.1)

(g1 , g2 , g) 7−→ (g1 gg2−1)

(Gσ × Gθ )(R) × G(R) −→ G(R)

(g1 , g2 , g) 7−→ (g1 gg2−1)

10

JAYCE R. GETZ AND ERIC WAMBACH

for F -algebras R. Our goal in this section is to compare the sets of double cosets H σ (R)\H(R)/H σ (R)
and Gσ (R)\G(R)/Gθ (R).
For this purpose, following [Ri, Lemma 2.4] we introduce the subschemes Q := QH ⊂ H
and S := SG ⊂ G. They are defined to be the scheme theoretic images of the morphisms
given on points in an F -algebra R by
Bσ : H(R) −→ H(R)
(3.1.2)

g 7−→ gg −σ

Bθ : G(R) −→ G(R)
g 7−→ gg −θ ,

respectively; they are closed affine F -subschemes of H and G, respectively (see [HW, §2.1]).
Notice that Bσ (g1 gg2−1) = g1 Bσ (g)g1−1 and Bθ (g1 gg2−1) = g1 Bθ (g)g1−τ for (g1 , g2 ) ∈ H σ (R)2
(resp. (g1 , g2) ∈ Gσ × Gθ (R)). There are injections
H σ (R)\H(R)/H σ (R) −→ H σ (R)\Q(R)
(3.1.3)

g 7−→ gg −σ

Gσ (R)\G(R)/Gθ (R) −→ Gσ (R)\S(R)
g 7−→ gg −θ

where H σ acts by conjugation on Q and Gσ acts by τ -conjugation on S.
For any F -algebra k and any γ ∈ H(k) (resp. δ ∈ G(k)) write Hγ (resp. Gδ ) for the
k-group whose points in a commutative k-algebra R are given by
(3.1.4)

Hγ (R) : = {(g1 , g2 ) ∈ H σ (R) × H σ (R) : g1−1 γg2 = γ}
Gδ (R) : = {(g1 , g2 ) ∈ Gσ (R) × Gθ (R) : g1−1 δg2 = δ}.

σ
τ
(resp. τ -centralizer of δ in Gσ ).
Write Cγ,H σ (resp. Cδ,G
σ ) for the centralizer of γ in H
τ
˜ δδ
Lemma 3.1. There are isomorphisms Hγ →C
˜ γγ −σ ,H σ and Gδ →C
−θ ,Gσ given on a k-algebra
R by

Hγ (R)−→C
˜ γγ −σ ,H σ (R)
(3.1.5)

(g1 , g2 ) 7−→ g1

τ
Gδ (R)−→C
˜ δδ
−θ ,Gσ (R)

(g1 , g2 ) 7−→ g1 .
Proof. Injectivity is clear. For surjectivity, note that if g1−1γγ −σ g1 = γγ −σ for g1 ∈ H σ (R)
then
γ −1 g1−1γ = γ −σ g1−1 γ σ = (γ −1 g1−1 γ)σ ,

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

11

so (g1 , (γ −1 g1−1γ)−1 ) ∈ Hγ (R). Similarly, if g1−1 δδ −θ g1τ = δδ −θ for g1 ∈ Gσ (R), then
δ −1 g1−1 δ = δ −θ g1−τ δ θ = (δ −1 g1−σ δ)θ = (δ −1 g1−1δ)θ
so (g1 , (δ −1 g1−1δ)−1 ) ∈ Gδ (R).



Lemma 3.2. Let k/F be a field, let γ ∈ H(k) and δ ∈ G(k). If γγ −σ is semisimple
τ
(resp. δδ −θ is τ -semisimple) then Cγγ −σ ,H σ (resp. Cδδ
−θ ,Gσ ) is reductive.
Proof. See [H, §2].



We also often use the following lemma:
Lemma 3.3. Let k/F be a field, let γ ∈ H(k) and δ ∈ G(k). Assume we are in the
biquadratic case and that (H σ )der is simply connected. If γγ −σ is semisimple (resp. δδ −θ is
τ
τ -semisimple) then Cγγ −σ ,H σ (resp. Cδδ
−θ ,Gσ ) is connected.
Proof. Recall that for any semisimple x ∈ H σ (k) the group Cx,H σ is connected by a theorem
of Steinberg ([St1], [K1, §3]). Upon passing to the algebraic closure, it is easy to see that
this fact implies the lemma.

For an F -algebra R write
(3.1.6)

Γr (R) : = H σ (R)\H(R)/H σ (R)
Γrτ (R) : = Gσ (R)\G(R)/Gθ (R).

We refer to the elements of Γr (R) (resp. Γrτ (R)) as relative classes (resp. relative τ -classes).
If two elements γ, γ ′ ∈ H(R) (resp. δ, δ ′ ∈ G(R)) map to the same class in Γr (R) (resp.
Γrτ (R)) we say that they are in the same relative class (resp. relative τ -class). In this paper
we will loosely refer to any construction or object involving relative τ -classes as the twisted
case.
The following definitions are adaptations of those appearing in [JL] and [Fl3]:
Definition 3.4. Let k/F be a field. An element γ ∈ H(k) is relatively semisimple
(resp. relatively elliptic, relatively regular) if γγ −σ is semisimple (resp. elliptic, regular) as
an element of H(k).
Definition 3.5. Let k/F be a field. An element δ ∈ G(k) is relatively τ -semisimple
(resp. relatively τ -elliptic, relatively τ -regular) if δδ −θ is τ -semisimple (resp. τ -elliptic, τ regular) in the usual sense.
For brevity, we say that δ is relatively τ -regular semisimple if it is both relatively τ regular and relatively τ -semisimple, with similar conventions regarding other combinations
of regular, semisimple, and elliptic. It is easy to check that γ ∈ H(R) is relatively semisimple
(resp. elliptic, regular) if and only if every element in H σ (R)γH σ (R) is relatively semisimple

12

JAYCE R. GETZ AND ERIC WAMBACH

(resp. elliptic, regular). A similar statement holds in the twisted case. For a field k/F we
denote by
(3.1.7)

σ
σ
Γss
r (k) : = {H (k)γH (k) ∈ Γr (k) : γ is relatively semisimple}

σ
θ
Γss
rτ (k) : = {G (k)δG (k) ∈ Γrτ (k) : δ is relatively τ -semisimple}.

Let Qss ⊂ Q be the subscheme whose points in an F -algebra R are semisimple elements
of H(R).
Lemma 3.6. Assume that we are in the biquadratic case and H der is simply connected. For
k either F or Fv for some place v of F the natural morphism (3.1.2) induce a bijection
σ
ss
Γss
r (k) ↔ H (k)\Q (k).

Proof. We claim that every element of Qss (k) is of the form γγ −σ for some γ ∈ H(k).
To prove the claim, first let α ∈ Qss (k) and consider Cα,H (k). Since α is semisimple and
H der is simply connected, Cα,H is a (connected) reductive group ([St1], [K1, §3]). Using
the fact that α = α−σ , it is trivial to check that Cα,H is σ-invariant, and it follows that
Cα,H = ResE⊗F k/k I for some reductive subgroup I ≤ H σ . Let T ′ ≤ I be a maximal torus
and let T = ResE⊗F k/k T ′ . Then α is in the centralizer of T in Cα,H , and it follows that
α ∈ T (k) [B, §IV.11.12].
Denoting by hσi the subgroup of the group of automorphisms of T (k) generated by σ, we
have
b −1 (hσi, T (k)) ∼
=1
= H 1 (hσi, T (k)) ∼
N T (k)/Ihσi T (k) = H
hσi

(see [S1, §VIII.1 and §VIII.4] for notation and the existence of the first isomorphism). Here
we have used Shapiro’s lemma for the last isomorphism. By definition of Nhσi T (k)/Ihσi T (k),
it follows that α = γγ −σ for some γ ∈ T (k). This completes the proof of our claim. We
leave to the reader the straightforward task of deducing the lemma from the claim.

3.2. Norms of stable classes: Definitions. In this subsection we define stable classes
and a notion of norm. We assume throughout the subsection that k is either F or Fv for
some place v of F . In this section and for the remainder of the paper, we will always make
the following simplifying assumption:
• For all relatively semisimple γ ∈ H(F ) the group Hγ is connected.

By passing to an algebraic closure, it is easy to see that this assumption implies that Gδ is
connected for all relatively τ -semisimple δ ∈ G(F ). For a condition sufficient to ensure the
assumption above holds, see Lemma 3.3.
Definition 3.7. Two relatively semisimple elements γ, γ0 ∈ H(k) are in the same stable
relative class if and only if xγγ −σ x−1 = γ0 γ0−σ for some x ∈ H σ (k).

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

13

Similarly, two elements δ, δ0 ∈ G(k) are in the same stable relative τ -class if and only
if yδδ −θ y −τ = δ0 δ0−θ for some y ∈ Gσ (k).
For a pair of reductive k-groups I, H, define


D(I, H; k) := ker H 1 (k, I) → H 1 (k, H) .

We note that the set of relative classes in the stable relative class of γ0 ∈ H(k) is in bijection
with
D(Cγ0 γ0−σ ,H σ , H σ ; k)

(3.2.1)

and the set of relative τ -classes in the stable relative τ -class of δ0 ∈ G(k) is in bijection with
D(Cδτ0 δ−θ ,Gσ , Gσ ; k).

(3.2.2)

0

In particular, if k = Fv for some place v of F , then both of these sets of stable classes are
finite (compare [La1, §1.8, §2.3]).
Later, when defining orbital integrals, the following observation will be useful. Suppose
that γ, γ0 are in the same stable relative class; choose x as in Definition 3.7. Then we have
an inner twist
(3.2.3)

˜ γγ −σ ,H σ (k)−→C
˜ γ0 γ0−σ ,H σ (k)−→H
˜ γ0 (k)
Hγ (k)−→C
g 7−→ xgx−1

where the first and last isomorphism are those of (3.1.5) (compare [K1, Lemma 3.2]). Similarly, if δ, δ0 are in the same stable relative τ -class, choose y as in Definition 3.7. Then there
is an inner twisting
(3.2.4)

τ
Gδ (k)−→C
˜ δδ
˜ δτ0 δ−θ ,Gσ (k)−→G
˜ δ0 (k)
−θ ,Gσ (k)−→C
0

g 7−→ ygy −1.
We have the following definition:
Definition 3.8. Suppose that γ ∈ H(k) is relatively semisimple. We say that γ is a norm
of δ ∈ G(k) if there is an y ∈ Gσ (k) such that
yδδ −θ (δδ −θ )τ y −1 = γγ −σ .
The following lemma together with Proposition 3.10 below can be used to show that norms
exist in certain cases:
Lemma 3.9. Suppose that δ ∈ G(k) is relatively τ -semisimple. Let O(k) ⊂ Q(k) denote the
subset of elements that are Gσ (k)-conjugate to δδ −θ (δδ −θ )−σ = δδ −θ (δδ −θ )τ . Then O(k) is
fixed by Gal(k/k) and is the set of k-points of a (nonempty) homogeneous space O for Hkσ .
Any γ ∈ H(k) such that γγ −σ ∈ O(k) is a norm of δ.

14

JAYCE R. GETZ AND ERIC WAMBACH

e := ResM/F Q; it is the scheme theoretic image of the map G −→ G defined by
Proof. Let Q
G(R) −→ G(R)
g 7−→ gg −σ

e by conjugation. Note that δδ −θ (δδ −θ )τ ∈
for F -algebras R. The group scheme Gσ acts on Q
e
Q(k).
We claim that a Gσ (k)-conjugate γ of δδ −θ (δδ −θ )τ is contained in Q(k). Assuming
the claim for a moment, it is easy to check that
O(k) := {h−1 γh : h ∈ H σ (k)} = {g −1 δδ −θ (δδ −θ )τ g : g ∈ Gσ (k)} ∩ Q(k).
Since the set on the right is fixed by Gal(k/k), the set on the left is as well. It follows that
O(k) is the set of k-points of a homogeneous space O for Hkσ .
Choose an isomorphism
(3.2.5)

Gk −→H
˜ k × Hk

equivariant with respect to σ and intertwining τ with (x, y) 7→ (y, x). Let (δ1 , δ2 ) be the
image of δδ −θ under this isomorphism. Then δ2 = δ1−σ . Replacing δδ −θ by g −1δδ −θ g τ for
some g ∈ Gσ (k) does not affect the Gσ (k)-conjugacy class of δδ −θ (δδ −θ )τ . Translating
this statement to Hk × Hk using (3.2.5), we see that to prove the claim it suffices to exhibit
−1
−1
−1
−σ
, this is equivalent
h1 , h2 ∈ H σ (k) such that h−1
1 δ1 h2 = h2 δ2 h1 . Since h2 δ2 h1 = (h1 δ1 h2 )
to the statement that δ1 is in the relative class of an element t satisfying t−σ = t. Because
δδ −θ (δδ −θ )τ is semisimple by assumption, δ1 is relatively semisimple. Thus δ1 is in the
relative class of an element t of a σ-split torus by [Ri, Theorem 7.5]. This element satisfies
t = t−σ .

Suppose that γ ∈ H(k) is a norm of δ ∈ G(k). We then have an inner twist
(3.2.6)

τ
˜ δδ
˜ δδ−θ (δδ−θ )τ ,H σ (k)−→C
˜ γγ −σ ,H σ (k)−→H
˜ γ (k)
Gδ (k)−→C
−θ ,Gσ (k)−→C

g 7−→ ygy −1

for y as in Definition 3.8. Here the first and last isomorphism are those of (3.1.5), and the
τ
σ
σ
∼ σ
second is the restriction to Cδδ
−θ ,Gσ of the projection of G (k) = H (k) × H (k) onto the
factor indexed by the identity.
3.3. Existence of norms. If we were in the standard trace formula setting, now would be
the point where we would use the Kottwitz-Steinberg theorem, which states that a conjugacy class defined over F in a quasi-split reductive group with simply connected derived
group contains an element [K1], and therefore (in this setting) norms exist. Unfortunately,
no general analogue of this theorem is known in the relative setting. In fact, preliminary
investigations suggest that it is not true.

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

15

In this subsection we provide a conditional relative analogue of the Kottwitz-Steinberg
theorem using work of Borovoi. We say that H is a unitary group if there is an F -algebra
D and an involution † : D → D of the second kind such that H(R) is equal to
{g ∈ (D ⊗F R)× : gg † = 1}
for F -algebras R. We assume in addition that either D is simple or the center of D is F ⊕ F
and D = D0 ×D0 for some simple algebra D0 . Throughout this subsection we always assume
that H is a unitary group and that we are in the biquadratic case. Thus (H σ )der is simply
connected. Moreover since we are in the biquadratic case we have ZH σ ≤ ZH , so the H σ -orbit
of any α ∈ Q(F ) under conjugation is equal to its orbit under the subgroup (H σ )der . This
fact is used in the proof of the following proposition:
Proposition 3.10. If δ ∈ G(F ) = ResM/F H(F ) is relatively τ -regular semisimple, the
element δv0 is relatively τ -elliptic for some place v0 , and for all v|∞ there is a γ ∈ H(Fv )
that is a norm of δ ∈ G(Fv ), then there is a γ ∈ H(F ) such that γ is a norm of δ.
Before proving Proposition 3.10 we will state and prove a converse to it:
Lemma 3.11. Let k be either F or Fv for some place v of F . If γ ∈ H(k) is relatively
semisimple, then it is a norm of some δ ∈ G(k). In fact, γγ −σ = δδ −θ (δδ −θ )τ for some
δ ∈ G(k).
Proof. By the proof of Lemma 3.6, for any relatively semisimple γ ∈ H(k) we can choose a
σ-stable torus T ≤ Hk such that γγ −σ is in the image of the map
T (k) −→ Q(k)

g 7−→ gg −σ .

Let Te := ResM ⊗k/k T ≤ Gk . Then we have two composite maps
x7→xxτ

ψ1 : Te(k) −−−−→
−θ

T (k)

y7→yy −σ

−−−−−→ T ∩ Q(k)
τ

y7→yy
x7→xx
ψ2 : Te(k) −−−−−→ Te ∩ S(k) −−−−→ T ∩ Q(k).

It suffices to show that ψ2 is surjective. Since all of the groups in the definition of the ψi are
commutative, ψ1 = ψ2 , so it suffices to show that ψ1 is surjective. The second map in the
definition of ψ1 is surjective by the argument in the proof of Lemma 3.6. The first map is

surjective by [Ro2, Proposition 3.11.1(a)].
We prove Proposition 3.10 using a cohomological obstruction to the existence of points in
a homogeneous space developed in [Bo1]. In order to use Borovoi’s results, we must develop
a little notation. Set
Y
(3.3.1)
kerj (F, ·) := ker(H j (F, ·) →
H j (Fv , ·))
v

16

JAYCE R. GETZ AND ERIC WAMBACH

where the product is over all places of v. Let H be an F -group and let X be a homogeneous
space for H. Suppose for simplicity that the stabilizer Hx of a point x ∈ X(F ) is connected
and reductive. The stabilizer Hx is not in general the base change to F of an algebraic
group over F . However, as explained in [Bo1, §1.7], the maximal toric quotient Hx /Hxder
m
has a canonical F -form. We denote this F -form by Cx,H
. The obstruction Ob(H, X) lies in
2
m
ker (F, Cx,H ) [Bo1, §1.5].
We now prove Proposition 3.10:
Proof. Let α = δδ −θ (δδ −θ )τ . By Lemma 3.9 the set of elements of Q(F ) that are Gσ (F )conjugate to α defines a homogeneous space O(α) for H σ and hence also for (H σ )der since
ZH σ ≤ ZH . By [Bo1, Theorem 1.6] it suffices to show that
m
Ob((H σ )der , O(α)) ∈ ker2 (F, Cα,(H
σ )der )
2
m
m
is trivial; to do this we will show that (Cα,(H
σ )der )Fv0 is anisotropic and hence ker (F, Cα,(H σ )der ) =
0 by [Sa, Lemme 1.9]. One checks via [Bo1, §1.7] that there is a natural injection
m
m
Cα,(H
σ )der −→ Cα,H σ
m
m
m
and ZH σ Cα,(H
σ )der = Cα,H σ . Hence to prove that the torus (Cα,(H σ )der )Fv0 is anisotropic it
m
is anisotropic.
suffices to show that the torus (Cα,H
σ /ZH σ )Fv
0
The H(F )-conjugacy class of α is fixed by Gal(F /F ). Denote this conjugacy class by OH ;
m
m
we view OH as a homogeneous space for H. We have (Cα,H
σ )F = Cα,H σ and (Cα,H )F = Cα,H
since α is regular semisimple and H der is simply connected. We therefore have a natural
σ-equivariant embedding

(3.3.2)

m
)F
Cα,H σ → (Cα,H

m
where we define Cα,H
with respect to the homogeneous space OH for H. Thus (3.3.2) defines
an F -form of Cα,H σ . By assumption, αξ is H σ (F )-conjugate to α for all ξ ∈ Gal(F /F ).
Using this fact, one checks that the F -form of Cα,H σ defined by (3.3.2) is isomorphic to the
m
F -torus Cα,H
σ defined with respect to O(α) (see [Bo1, §1.7]). Thus, by (3.3.2), we have that
m
σ
m
= g}
Cα,H
σ (R) = {g ∈ Cα,H (R) : g

for commutative F -algebras R. By the theorem of Kottwitz-Steinberg [K1, Theorem 4.1]
the H(F )-conjugacy class of α contains an element α′ ∈ H(F ). We therefore have a natural
m ∼
isomorphism of F -groups Cα,H
= Cαm′ ,H ∼
= Cα′ ,H (see [Bo1, §1.7]). Since we assumed that δv0
was relatively τ -elliptic, we have that (Cα′ ,H /ZH )Fv0 is anisotropic, and hence the same is
m
true of (Cα,H
σ /ZH σ )Fv , completing the proof of the proposition.
0


RELATIVE TRACE FORMULAE AND UNITARY GROUPS

17

4. Matching of functions
In §3.2 we defined a notion of norm for relative classes. In this section we define a
corresponding notion of matching functions. This necessitates the introduction of local
orbital integrals and their stable analogues (these are defined in §4.1 and §4.2, respectively).
We then define what we mean by matching of functions in §4.3. As in the usual trace formula,
it is useful to have at our disposal local orbital integrals twisted by a character of a certain
cohomology group; these relative κ-orbital integrals are defined in §4.4. They play a role in
the prestabilization of (the regular elliptic part of) the twisted relative trace formula carried
out in §7 and §8 below. In §4.5 and §4.6 we prove various matching statements.
4.1. Local orbital integrals: Definitions. Let v be a place of F . Let Φ ∈ Cc∞ (H(Fv ))
and let γ ∈ H(Fv ) be a relatively semisimple element. The (local) relative orbital integral
is defined by
ZZ
dh1 dh2
(4.1.1)
ROγ (Φ) := ROγ (Φ, dtγ ) : =
Φ(h−1
1 γh2 )
dtγ
Hγ (Fv )\H σ (Fv )2
where dhi and dtγ are Haar measures on H σ (Fv ) and Hγ (Fv ), respectively.
Similarly, let f ∈ Cc∞ (G(Fv )) and let δ ∈ G(Fv ) be a relatively τ -semisimple element. The
(local) twisted relative orbital integral is defined by
ZZ
dg1 dg2
T ROδ (f ) := T ROδ (f, dtδ ) :=
f (g1−1δg2 )
,
dtδ
Gδ (Fv )\Gσ ×Gθ (Fv )
where dgi , and dtδ are Haar measures on Gσ (Fv ), Gθ (Fv ) and Gδ (Fv ), respectively. These
relative orbital integrals and twisted relative orbital integrals are all absolutely convergent
[H].
4.2. Stable local orbital integrals. We assume the notation of the previous subsection.
For any relatively semisimple γ0 ∈ H(Fv ) we define the stable relative orbital integral
by
X
(4.2.1)
e(Hγ )ROγ (Φ, dtγ ),
SROγ0 (Φ) :=
γ∼γ0

where e(Hγ ) denotes the Kottwitz sign as in [K2] and the sum is over a set of representatives
for the set of relative classes in the stable relative class of γ0 .
Similarly, for a relatively τ -semisimple δ0 ∈ G(Fv ) we define the stable twisted relative
orbital integral by
X
(4.2.2)
e(Gδ )T ROδ (f, dtδ ),
ST ROδ0 (f ) :=
δ∼δ0

where the sum is over a set of representatives for the set of relative τ -classes in the stable relative τ -class of δ0 . In both cases, we assume that the measures dtγ (resp. dtδ ) are compatible
with respect to the inner twists given by (3.2.3) and (3.2.4), respectively. For the definition

18

JAYCE R. GETZ AND ERIC WAMBACH

of compatible, see, e.g., [K5, p. 631]. We note that the sums in (4.2.1) and (4.2.2) are finite
since their cardinality is equal to the cardinality of the finite groups D(Hγ , H σ × H σ ; Fv )
and D(Gδ , Gσ × Gθ ; Fv ), respectively (see §3.2).
4.3. Matching of functions: Definition.
Definition 4.1. Two functions Φ ∈ Cc∞ (H(Fv )) and f ∈ Cc∞ (G(Fv )) match on the relatively regular set (resp. match) if
SROγ (Φ) = ST ROδ (f )
whenever a relatively regular semisimple (resp. relatively semisimple) γ ∈ H(Fv ) is a norm
of δ ∈ G(Fv ),
SROγ (Φ) = 0
whenever γ is relatively regular semisimple (resp. relatively semisimple) and not a norm of
a δ ∈ G(Fv ), and
ST ROδ (f ) = 0
whenever δ is relatively τ -regular semisimple (resp. relatively τ -semisimple) and does not
admit a norm γ ∈ H(Fv ).
In the definition, we assume that the implicit Haar measures are compatible with respect
to the inner twist of (3.2.6)
Remark. The inner twists given by (3.2.3), (3.2.4), and (3.2.6) are not canonical, since they
depend on choices of elements in H σ (k) and Gσ (k). However, if H1 and H2 are inner forms of
the same connected reductive F -group, then the notion of a measure on H1 being compatible
with a measure on H2 is independent of the particular inner twist realizing the two groups
as inner forms of each other (see [K5, p. 631]). Thus the ambiguity in (3.2.3), (3.2.4), and
(3.2.6) is irrelevant for our purposes.
4.4. Local relative κ-orbital integrals. In this subsection we define relative versions of
the κ-orbital integrals that occur in Langland’s and Kottwitz’s prestabilization of the usual
trace formula [K4]. We use Labesse’s reformulation; see [La1] for notation and generalities
regarding abelianized cohomology.
Let v be a place of F and let I ≤ H be a pair of connected reductive Fv -groups. Letting
a superscript “D” denote the Pontryagin dual, we set notation for the finite abelian groups
(4.4.1)

0
K(I, H; Fv ) : = Hab
(Fv , I\H)D .

Let γ ∈ H(Fv ) be relatively semisimple and let δ ∈ G(Fv ) be relatively τ -semisimple. For
κHv ∈ K(Hγ , H σ × H σ ; Fv ) and Φv ∈ Cc∞ (H(Fv )) (resp. κv ∈ K(Gδ , Gσ × Gθ ; Fv ) and

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

fv ∈ Cc∞ (G(Fv ))) we set
Z
κHv
(4.4.2) ROγ (Φv ) =

H 0 (Fv ,Hγ \H σ ×H σ )

T ROδκv (fv ) =

Z

H 0 (Fv ,Gδ \Gσ ×Gθ )

19

−1
hκHv , (h˙1 , h˙2 )ie((Hh−1
)Fv )Φv (h−1
1 γh2 )dḣ1 dḣ2 ,
1 γh2

hκv , (ġ1 , ġ2−1)ie((Gg1−1 δg2 )Fv )fv (g1−1 δg2 )dġ1 dġ2.

Here we use a system of compatible measures as in §4.2 to define the measures dḣ1 dḣ2 on
H 0 (Fv , Hγ \H σ × H σ ) and dġ1 dġ2 on H 0 (Fv , Gδ \Gσ × Gθ ), respectively (compare [La1, p. 42,
68]). Of course, the orbital integrals depend on this choice, but we will not encode it into
our notation. In defining (4.4.2), we choose for each class (h˙1 , h˙2 ) ∈ H 0 (Fv , Hγ \H σ × H σ ) an
element (h1 , h2 ) ∈ H σ ×H σ (F v ) whose image in H 0 (Fv , Hγ \H σ ×H σ ) is (h˙1 , h˙2 ). Similarly, we
choose for each class (ġ1 , ġ2 ) ∈ H 0 (Fv , Gδ \Gσ × Gθ ) an element (g1 , g2 ) ∈ Gσ × Gθ (F v ) whose
image in H 0 (Fv , Gδ \Gσ × Gθ ) is (ġ1 , ġ2 ). The integrals do not depend on these choices. The
−1
−1
symbol hκHv , (h˙1 , h˙2 )i is the value of κv on the image of (h˙1 , h˙2 ) under the abelianization
map, and similarly for hκv , (ġ1 , ġ2−1)i. In the case that κHv (resp. κv ) is trivial, we have
ROγκHv (Φv ) = SROγ (Φv )
T ROδκv (fv ) = ST ROδ (fv ).
4.5. Proof of the fundamental lemma: First case. Let v be a place of F . For this
subsection we assume that there is an isomorphism
(4.5.1)

GF v ∼
= HF v × HF v

equivariant with respect to σ and intertwining τ with (x, y) 7→ (y, x). For example, M/F
could be split at v or (in the biquadratic case) ME/F could be split at v with E/F and
M/F unramified and E/F nonsplit at v. In the latter case we have an isomorphism
(4.5.2)

E ⊗F M ⊗F Fv ∼
= Ev ⊕ Ev

equivariant with respect to the natural action of σ on both sides and intertwining τ on the
left with (x, y) 7→ (y, x) on the right.
Remark. By class field theory, at almost every place either E/F is split or E/F and M/F
are unramified with E/F nonsplit at v.
Definition 4.2. An element γ ∈ H(Fv ) is a split norm of an element δ = (δ1 , δ2 ) ∈ G(Fv )
if γ is in the relative class of δ1 δ2−σ .
The basic properties of this notion are summarized in the following lemma:
Lemma 4.3. If γ is a split norm of δ, then every element of the relative class of γ is a split
norm of every element of the relative τ -class of δ. If γ and γ ′ are split norms of δ, then γ
and γ ′ are in the same relative class. If δ and δ ′ both have split norm γ, then δ and δ ′ are in

20

JAYCE R. GETZ AND ERIC WAMBACH

the same relative τ -class. Every γ ∈ H(Fv ) is a split norm and every δ ∈ G(Fv ) has a split
norm. If γ is relatively semisimple and γ is a split norm of δ, then it is a norm of δ.
Proof. The first three assertions are easy to verify. For the fourth, note that (γ, 1) ∈ G(Fv )
has split norm γ for any γ ∈ H(Fv ). Conversely, δ = (δ1 , δ2 ) has split norm δ1 δ2−σ .
We now prove the final statement of the lemma. Suppose γ is a split norm of δ. Write
δδ −θ = (δ1 δ2−σ , δ2 δ1−σ ) = (xδ , x−σ
δ )
for some xδ ∈ H(Fv ). At the expense of replacing γ with something in its relative class, we
can and do assume that γ = xδ . Thus it suffices to show that we can choose g ∈ H σ (F v )
−1 −σ
such that xδ x−σ
δ = g xδ xδ g, for then
−σ
−σ
−σ
(1, g)−1δδ −θ (δδ −θ )τ (1, g) = (1, g)−1(xδ x−σ
δ , xδ xδ )(1, g) = (xδ xδ , xδ xδ ),

which implies γ = xδ is a norm of δ.
Since γ is relatively semisimple, there is a σ-split torus Tσ ≤ HF v such that xδ x−σ
δ ∈ Tσ (F v )
−σ
2
[Ri, Theorem 7.5]. Since the map x 7→ xx coincides with x 7→ x on Tσ , we can and do
choose x′ ∈ Tσ (F v ) such that x′ x′−σ = xδ x−σ
δ . The fiber of the map H → Q of (3.1.2) over
σ
any point in Q(F v ) is a H (F )-torsor, so we have xδ g ′ = x′ ∈ Tσ (F ) for some g ′ ∈ H σ (F v ).
Since Tσ is σ-stable, we have that (xδ g ′ )−σ commutes with xδ g ′ . In other words,
−σ
xδ x−σ
= (xδ g)−σ (xδ g) = g −1x−σ
δ = (xδ g)(xδ g)
δ xδ g.


If δ = (δ1 , δ2 ) ∈ G(Fv ) then there is an isomorphism G(δ1 ,δ2 ) →H
˜ δ1 δ2−σ given on Fv -algebras
R by
(4.5.3)

G(δ1 ,δ2 ) (R) −→ Hδ1 δ2−σ (R)

(g1 , g2 , g3 , g3σ ) 7−→ (g1 , g2 )

and thus isomorphisms Gδ −→H
˜ γ for any split norm γ of δ. For the purposes of the following
definition and lemma, fix a compact open subgroup KH ≤ H(Fv ) that is σ-stable and let
K = KH × KH ≤ G(Fv ) ∼
= H(Fv ) × H(Fv ).
Definition 4.4. Two functions Φ ∈ Cc∞ (H(Fv )) and f ∈ Cc∞ (G(Fv )) split match if
ROγ (Φ, dtγ ) = T ROδ (f, dtδ )
whenever γ ∈ H(Fv ) is a split norm of δ ∈ G(Fv ). Here the Haar measures dtγ and dtδ
are normalized so that the isomorphism Gδ (Fv )−→H
˜ γ (Fv ) induced by (4.5.3) is measurepreserving and the Haar measure on H(Fv ) (resp. G(Fv )) gives KH (resp. K) volume 1.
For Φi ∈ Cc∞ (H(Fv )) (i ∈ {1, 2}) we write Φ1 × Φ2 ∈ Cc∞ (G(Fv )) = Cc∞ (H × H(Fv )) for
the product function using (4.5.1). We have the following lemma:

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

21

Lemma 4.5. Let Φ1 , Φ2 ∈ Cc∞ (H(Fv )//KH ) and write f = Φ1 × Φ2 ∈ Cc∞ (G(Fv )//K) for
−σ
the product function. Write Φ−σ
). The functions f and Φ1 ∗ Φ−σ
split match,
2 (g) := Φ2 (g
2
∞
where the ∗ denotes convolution in Cc (H(Fv )//KH ).
Proof. Let δ = (δ1 , δ2 ) ∈ G(Fv ). We have
Z
f (g −1δh)dgdh
Gδ (Fv )\Gσ ×Gθ (Fv )

(4.5.4)

=
=

Z

Z

Hγ (Fv )\H σ ×H σ (Fv )

Hγ (Fv

)\H σ ×H σ (F

v)

Z

H(Fv )

Φ1 (g1−1 δ1 h1 )Φ2 (g2−1δ2 hσ1 )dh1



dg1 dg2

−1
−σ
Φ1 ∗ Φ−σ
2 (g1 δ1 δ2 g2 )dg1 dg2 .

Here we have used (4.5.1) to write g = (g1 , g2 ) ∈ Gσ (Fv ) ∼
= H σ (Fv ) × H σ (Fv ) and h =
(h1 , hσ1 ) ∈ Gθ (Fv ) and we have used our assumption that the isomorphism Gδ (Fv )−→H
˜ γ (Fv )
given by (4.5.3) is measure preserving. With this in mind, the lemma follows from (4.5.4)
and Lemma 4.3.

The inclusion H → G induces an L-map L H → L G. Assume for the moment that HFv
and GFv are both quasi-split, let K ≤ G(Fv ) and KH ≤ H(Fv ) be hyperspecial subgroups
and let
b : Cc∞ (G(Fv )//K) −→ Cc∞ (H(Fv )//KH )
be the base change homomorphism induced by the L-map above. One can check that with
respect to the isomorphism (4.5.1) this homomorphism is given by
b(f1 × f2 ) = f1 ∗ f2 .
Thus in view of Lemma 4.3 and the remark at the end of §4.3 we have the following corollary:
Corollary 4.6. Let KH ≤ H(Fv ) be a σ-stable hyperspecial subgroup and let K = KH ×KH ≤
G(Fv ) ∼
= H(Fv ) × H(Fv ). Then if f1 ∈ Cc∞ (H(Fv )//KH ) the functions f1 × chKH and
b(f1 × chKH ) = f1 match.

4.6. Matching at the E-split places. Assume for the remainder of this section that we
are in the biquadratic case. Let v be a place of F . In this subsection we will always assume
that E/F splits at v. Thus there is an isomorphism
(4.6.1)

E ⊗F Fv ∼
= Fv ⊕ Fv

intertwining σ with (x, y) 7→ (y, x) and an isomorphism
(4.6.2)

HF v ∼
= HFσv × HFσv

intertwining σ with (x, y) 7→ (y, x). Using this one easily deduces the following lemma:

22

JAYCE R. GETZ AND ERIC WAMBACH

Lemma 4.7. Let γ ∈ H(Fv ) and δ ∈ G(Fv ) be relatively semisimple and relatively τ semisimple, respectively. Use (4.6.1) to write γγ −σ = (yγ , yγ−1 ) and δδ −θ = (xδ , x−τ
δ ). We
−τ
σ
have that γ is a norm of δ if and only if xδ xδ is G (F v )-conjugate to yγ .

If Φi ∈ Cc∞ (H σ (Fv )) (resp. fi ∈ Cc∞ (Gσ (Fv ))) for i ∈ {1, 2}, we let Φ1 × Φ2 ∈ Cc∞ (H(Fv ))
(resp. f1 × f2 ∈ Cc∞ (G(Fv ))) be the product functions defined using the isomorphism (4.6.2).
For the definition of the K1 groups in the following proposition we refer the reader to §7.2.
Proposition 4.8. Suppose that γ ∈ H(Fv ) is relatively semisimple and δ ∈ G(Fv ) is relatively τ -semisimple. Let Φi and fi be as above. Finally let κH ∈ K(Hγ , H σ × H σ ; Fv )1 and
κ ∈ K(Gδ , Gσ × Gθ ; Fv )1 . We then have
ROγκH (Φ1 × Φ2 ) = OyκγH (Φ1 ∗ Φ−1
2 )

T ROδκ (f1 × f2 ) = Oxκδ ⋊τ (f1 ∗ f2−τ )
−τ
−1
−τ
−σ
where Φ−1
= (yγ , yγ−1), and δδ −θ = (xδ , x−τ
2 (h) := Φ2 (h ), f2 (h) := f2 (h ), γγ
δ ).

In the proposition, we use notation as in [HL, §1.5] for the κ-orbital integrals OyκγH and Oxκδ ⋊τ ,
and the K1 -groups are defined as in [La1, §1.8] (see also §7.2). Strictly speaking, the κH in
OyκγH (resp. κ in Oxκδ ⋊τ ) should actually be the image of κH (resp. κ) under
(4.6.3)

K(Hγ , H σ × H σ ; Fv )1 ∼
= K(Cyγ ,H σ , H σ ; Fv )1
= K(Cγγ −σ ,H σ , H σ × H σ ; Fv )1 ∼
K(Gδ , Gσ × Gθ ; Fv )1 ∼
= K(C τ σ , Gσ ; Fv )1
= K(C τ −θ σ , Gσ × Gθ ; Fv )1 ∼
δδ

,G

xδ ,G

where the left isomorphisms are induced by Lemma 3.1 and the right isomorphisms are due
τ
˜ xτδ ,Gσ induced by the projection of
˜ yγ ,H σ and Cδδ
to the isomorphisms Cγγ −σ ,H σ →C
−θ ,Gσ →C
H ∼
= Gσ × Gσ ) onto the first factor. However, we won’t burden the
= H σ × H σ (resp. G ∼
notation by indicating this. Also, to make the κH -orbital integrals well-defined we need to
specify choices of Haar measures on H σ , Gσ , and various centralizers, but, again, we will not
incorporate this into the notation.
Proof. The statement involving relative orbital integrals can be recovered from the statement
involving twisted relative orbital integrals by taking τ to be trivial. Therefore, it suffices to
prove the statement regarding twisted relative orbital integrals.
Note that there is an isomorphism of Fv -group schemes Gδ → Cxτδ ,Gσ given by
(4.6.4)

Gδ (R) −→ Cxτδ ,Gσ (R)

((u, u), (h, hτ )) 7−→ u

for Fv -algebras R (compare Lemma 3.1). Moreover, for a given δ = (δ1 , δ2 ) ∈ G(Fv ) there is
an isomorphism of affine Fv -schemes Gσ × Gθ → (Gσ )2 given by
(4.6.5)

Gσ × Gθ (R) −→ Gσ × Gσ (R)

((u, u), (h, hτ )) 7−→ ((u, u), (u−1δ2 hτ , u−1δ2 hτ ))

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

23

for Fv -algebras R. This maps Gδ onto Cxτδ ,Gσ × {(δ2 , δ2 )}, and thus a domain of integration
for H 0 (Fv , Gδ \Gσ × Gθ ) onto H 0 (Fv , Cxτδ,Gσ \Gσ ) × Gσ (Fv ). This observation is used in one
change of variables in the following computation:
(4.6.6)
T ROδκ (f1 × f2 )
Z
=

hκ, (ġ1 , ġ2 )ie(Gg1−1 δg2 )f1 × f2 (g1−1δg2τ )dġ1dġ2

H 0 (Fv ,Gδ \Gσ ×Gθ )

=

Z

H 0 (Fv ,Cxτ

σ \G
δ ,G

σ)

Z

Gσ (Fv )

−τ τ
τ
hκ, ((ḣ1 , ḣ1 ), (δ̇2−τ ḣτ1 ḣτ2 , δ̇2−1 ḣ1 ḣ2 ))ie(Chτ−1 xδ hτ ,Gσ )f1 (h−1
1 δ1 δ2 h1 h2 )f2 (h2 )dh2 dḣ1 .
1

1

In the last equality we used the fact that there is an isomorphism of Fv -groups Gg1−1 δg2 ∼
=
σ
θ
τ
Cg−1 x gτ ,Gσ for (g1 , g2) ∈ G × G (Fv ) (compare (4.6.4)). If we temporarily denote the image
δ 1
1
of κ under (4.6.3) by κ, then
hκ, ((ḣ1 , ḣ1 ), (δ̇2−τ ḣτ1 ḣτ2 , δ̇2−1 ḣ1 ḣ2 ))i = hκ, ḣ1 i

(4.6.7)

holds. From now on, we will omit the bar and just write κ. With (4.6.7) in mind, the
expression in (4.6.6) is equal to
Z
Z
−τ τ
τ
hκ, ḣ1 ie((Chτ−1 xδ hτ ,Gσ )Fv )f1 (h−1
1 δ1 δ2 h1 h2 )f2 (h2 )dh2 dḣ1
1

H 0 (Fv ,Cxτ

1

σ
σ
σ \G ) G (Fv )

δ,G

= Oxκδ ⋊τ (f1 ∗ f2−τ ).

Assume now that v is nonarchimedian. If GσFv and HFσv are both unramified, let K ′ ≤
′
Gσ (Fv ) and KH
≤ H σ (Fv ) be hyperspecial subgroups and let
′
b : Cc∞ (Gσ (Fv )//K ′ ) −→ Cc∞ (H σ (Fv )//KH
)

be the homomorphism induced by the base change homomorphism L H σ → L Gσ .
Corollary 4.9. If v is nonarchimedian, then for every Φ ∈ Cc∞ (H(Fv )) there is a matching
f ∈ Cc∞ (G(Fv )) and conversely. If M ⊗F Fv /Fv is unramified, GσFv and HFσv are unramified
′
with hyperspecial subgroups K ′ , KH
as above, and Φ1 ∈ Cc∞ (Gσ (Fv )//K ′) then Φ1 × chK ′
matches b(Φ1 ) × chKH′ .
Proof. This follows immediately from Proposition 4.8, Lemma 4.7, [La1, Théorème 3.3.1]
and [La1, Proposition 3.7.3].


24

JAYCE R. GETZ AND ERIC WAMBACH

5. Matching at the ramified places
We assume the notation of §4 regarding the definition of stable twisted relative orbital
integrals and matching of functions. In §4 we provided a supply of matching functions for
places of F where various data were unramified. We now prove a weaker matching statement
for the ramified places. It is contained in the following theorem, the main theorem of this
section:
Theorem 5.1. Let v be a place of F . If f ∈ Cc∞ (G(Fv )) is supported in a sufficiently small
neighborhood of a relatively τ -regular semisimple δ ∈ G(Fv ) admitting a norm γ ∈ H(Fv )
then there is a Φ ∈ Cc∞ (H(Fv )) that matches f on the relatively regular set.
The proof will occupy the remainder of the section. Our approach is an adaptation of that
in [La1, §3.1]. We also found the work of Rader-Rallis [RR] and Hakim [Hak2] useful.
5.1. Local constancy of the relative orbital integrals. Let v be a place of F and let
δ ∈ G(Fv ) be a relatively τ -regular semisimple element. In this subsection we show that
the relative orbital integrals of functions with support in a small neighborhood of δ can be
viewed as a locally constant functions on a torus related to δ. To ease notation, throughout
this section we abbreviate H = HFv , S = SFv , etc.
We begin with the following lemma:
Lemma 5.2. If γ ∈ H(Fv ) is relatively regular semisimple, then the maximal σ-split subtorus
of Cγγ −σ ,H is a maximal σ-split torus of H. If δ is relatively τ -regular semisimple then the
τ
maximal σ-split subtorus of Cδδ
−θ ,G has the same dimension as a maximal σ-split torus of
H.
We write Tγ for the maximal σ-split subtorus of Cγγ −σ ,H and Teδ for the maximal σ-split
τ
subtorus of Cδδ
−θ ,G .
Proof. The element γγ −σ is contained in a maximal σ-split torus Tσ of HF v [Ri, Theorem 7.5]
which in turn is contained in a maximal σ-stable torus T [He, Proposition 1.4]. Moreover,
Tσ is the unique maximal σ-split torus of T (this follows from [Ri, Theorem 7.5]). Since
γγ −σ is regular semisimple, it is contained in a unique maximal torus, so T = (Cγγ −σ ,H )F v ,
and it follows that Tσ = TγF v . Here we are implicitly using the fact that Tσ is in fact defined
over Fv , being the σ-split component of the Fv -torus Cγγ −σ ,H . Thus Tγ is a maximal σ-split
torus.
We now prove the second claim. Choose an isomorphism GF v ∼
= HF v × HF v equivariant
with respect to σ and intertwining τ with (x, y) 7→ (y, x). Using this isomorphism, write
δδ −θ = (xδ , x−σ
δ ) for some xδ ∈ H(F v ). Our assumption that δ is relatively τ -regular
semisimple implies that xδ is relatively semisimple. By the argument above, we see that

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

25

there is a (unique) maximal σ-split subtorus of Cxδ x−σ ,H which is moreover a maximal σδ
split subtorus of H. On the other hand, there is a σ-equivariant isomorphism
τ
(Cδδ
˜ xδ x−σ ,H
−θ ,G )F −→C
v
δ

induced by the projection of GF v ∼
= HF v × HF v onto the first factor. It follows that the
τ
maximal σ-split subtorus of (Cδδ
−θ ,H )F v has the same dimension as a maximal σ-split torus
τ
of HF v . The maximal σ-split torus of (Cδδ
−θ ,G )F v is in fact defined over Fv (compare [He,
§1.3]), and the lemma follows.

Our first step to proving Theorem 5.1 is the following proposition:
Proposition 5.3. Suppose that δ0 ∈ G(Fv ) is relatively τ -regular semisimple. Let V be a
neighborhood of 1 in Teδ0 (Fv ) and W be a neighborhood of δ0 in G(Fv ).

(1) Suppose that f ∈ Cc∞ (G(Fv )) has support in W. If V and W are sufficiently small,
then there is a function ψ ∈ Cc∞ (Teδ0 (Fv )) with support in V such that if δ ∈ G(Fv ) is
τ -regular semisimple and its Gσ × Gθ (Fv )-orbit meets W, then
δ = g1−1tδ0 g2
with t ∈ Teδ0 (Fv ), (g1 , g2 ) ∈ Gσ × Gθ (Fv ), and

T ROδ (f ) = ψ(t).

Moreover, if t ∈ Teδ0 (Fv ) and tδ0 is in the stable relative τ -class of δ, then
ST ROδ (f ) = ψ(t).

(2) Conversely, if ψ ∈ Cc∞ (Teδ0 (Fv )) has support in V and the neighborhoods V and W
are sufficiently small, then there is an f ∈ Cc∞ (G(Fv )) satisfying the identities of (1).
In [La1, §3.1], Labesse proves the analogue of Proposition 5.3 in the context of the usual
trace formula. Our proof follows his closely. We require some preparatory lemmas:
Lemma 5.4. Assume δ0 is relatively τ -regular semisimple. There is an analytic subvariety
Y ⊂ Gσ × Gθ (Fv ) that is symmetric (i.e. (x, y) ∈ Y if and only if (x−1 , y −1) ∈ Y ) and a
neighborhood V of 1 in Teδ0 (Fv ) such that the following are true:
(i) The map

Y × V −→ G(Fv )

(x, y, t) 7−→ x−1 tδ0 y
is a diffeomorphism from Y × V to a neighborhood W = W(Y, V) of δ0 ∈ G(Fv ).
(ii) If (x, y) ∈ Y , then x−1 tδ0 y ∈ W and t ∈ Teδ0 (Fv ) imply t ∈ V. Thus
Teδ0 (Fv )δ0 ∩ W = Vδ0 .

26

JAYCE R. GETZ AND ERIC WAMBACH

Proof. Choose a complement n of c = Lie Cδτ δ−θ ,Gσ (Fv ) in gσ := Lie Gσ (Fv ):
0 0

σ

g = n ⊕ c.
Let gθ := Lie Gθ (Fv ), let O be a neighborhood of 0 in n ⊕ gθ , and let Y = Exp O be its
image under the exponential map. Thus Y ⊂ Gσ × Gθ (Fv ) is an analytic subvariety. We
claim that the analytic morphism
(5.1.1)

Y × Teδ0 (Fv ) −→ G(Fv )

(g1 , g2 , t) 7−→ (g1−1 tδ0 g2 )

is locally an isomorphism at (1, 1, 1).
In order to show this, we first explain how the work of Rader and Rallis implies that the
analytic morphism
(5.1.2)

Gσ × Gθ (Fv ) × Teδ0 (Fv ) −→ G(Fv )

(g1 , g2 , t) 7−→ g1−1tδ0 g2

is a submersion whose fibers are of dimension dimFv Cδτ δ−θ ,Gσ . If τ is trivial, then this
0 0
follows from [RR, Theorem 3.4(1)]. Assume that τ is not trivial. Note that (5.1.2) fits into
a commutative diagram

(5.1.3)

Gσ × Gθ (Fv ) × Teδ0 (Fv ) −−−−−−−−−−−−→ G(Fv )




y
yg7→gg−θ
Gσ (Fv ) × Teδ0 (Fv )

(g1 ,t)7→g −1 t2 δ0 δ−θ g τ

0
1
−−−−−−1−−−−−
−→
S(Fv )

where the left arrow is the canonical projection and the top is (5.1.2). The vertical arrows are
induced by smooth surjective maps of affine varieties both of relative dimension dimFv Gθ .
Thus if we show that the bottom map is a submersion at (1,1), it follows that the top is a
submersion at (1, 1, 1). Since the map t 7→ t2 on Teδ0 is an isogeny, in order to show that the
bottom map of (5.1.3) is a submersion at (1, 1) it suffices to show that the map
(5.1.4)

Gσ (Fv ) × Teδ0 (Fv ) −→ S(Fv )

(g1 , t) 7−→ g1−1tδ0 δ0−θ g1τ

is a submersion at (1, 1).
To see this, let Mv be Fv if v splits in M/F and M ⊗F Fv otherwise. To prove that (5.1.4)
is a submersion whose fibers are of dimension dimFv Cδτ δ−θ ,Gσ , it suffices to show that
0 0

(5.1.5)

Gσ (Mv ) × Teδ0 (Mv ) −→ S(Mv )

(g1 , t) 7−→ g1−1 tδ0 δ0−θ g1τ

is a submersion at (1, 1) of relative dimension dimFv Cδτ δ−θ ,Gσ . Choose an isomorphism GMv ∼
=
0 0
HMv × HMv equivariant with respect to σ and intertwining τ with (x, y) 7→ (y, x). Using this

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

27

isomorphism, write δ0 δ0−θ = (x0 , x−σ
0 ) for some x0 ∈ H(Mv ) and let Tx0 be the largest σ-split
torus in Cx0 x−σ
. There is a commutative diagram of analytic morphisms
0 ,H

(5.1.6)

Gσ (Mv ) × Teδ0 (Mv )


(u1 ,u2 ,t1 ,t2 )7→(u1 ,u2 ,t1 )y

−−−−−−−−−−−→ S(Mv )

(u ,u )7→u
y 1 2 1
(u1 ,u2 ,t)7→u−1 tx0 u2

H σ (Mv ) × H σ (Mv ) × Tx0 (Mv ) −−−−−−−−1−−−→ H(Mv )

where the top arrow is (5.1.5) and the vertical arrows are analytic isomorphisms induced by
the isomorphism G(Mv ) ∼
= H(Mv ) × H(Mv ). Using Lemma 5.2 and [RR, Theorem 3.4(1)]
(and the reference therein for the real case), we see that the bottom map is a submersion
It follows that the top vertical map of
at (1, 1, 1) of relative dimension dimFv Cx0 x−σ
σ.
0 ,H
(5.1.6) is a submersion of relative dimension dimFv Cx0 x−σ
. In view of the σ-equivariant
0 ,H
τ
isomorphism Cδ δ−θ ,G −→C
˜ x0 x−σ
induced by the projection of GMv ∼
= HMv × HMv onto the
0 ,H
0 0
first factor, this together with our comments above implies that (5.1.2) is a submersion of
relative dimension dimFv Cδτ δ−θ ,Gσ , as claimed.
0 0
The analytic subvariety
Y × Teδ0 (Fv ) ⊂ Gσ × Gθ (Fv ) × Teδ0 (Fv )

is transverse to the subvariety

X := {(g1, g2 , 1) : (g1 , g2 ) ∈ Gδ0 (Fv )} ⊂ Gσ × Gθ (Fv ) × Teδ0 (Fv )

at (1, 1, 1). The submersion (5.1.2) maps X identically to δ0 . Our claim that (5.1.1) is a
local isomorphism follows. Thus we can and do choose O and V small enough so that the
map
Y × V −→ G(Fv )
induced by restricting (5.1.1) is an isomorphism onto an open neighborhood W(Y, V) of δ0 .
This proves (i).
Fix a neighborhood V1 of 1 in Teδ0 (Fv ) and an analytic subvariety Y1 ⊂ Gσ × Gθ (Fv ) small
enough that (i) holds. For an analytic subvariety Y ⊂ Y1 and a neighborhood V ⊂ V1 of 1,
let
W := W(Y, V)
be the image of Y × V under (5.1.1). Since Teδ0 (Fv ) is a closed subgroup of G(Fv ), we can

choose Y and V small enough so that

Teδ0 (Fv )δ0 ∩ g1−1Wg2 ⊂ V1 δ0

for each (g1 , g2 ) ∈ Y . Thus g1 tδ0 g2−1 ∈ W with t ∈ Teδ0 (Fv ) and (g1 , g2 ) ∈ Y implies that
t ∈ V1 . By the proof of part (i), any x ∈ W(Y1 , V1 ) can be written in a unique manner as
x = g1−1 tδ0 g2 with (g1 , g2) ∈ Y1 and t ∈ V1 . We conclude that if g1−1tδ0 g2 ∈ W(Y, V) with
t ∈ Teδ0 (Fv ) and (g1 , g2 ) ∈ Y then t ∈ V.


28

JAYCE R. GETZ AND ERIC WAMBACH

Lemma 5.5. Suppose that W ⊂ G(Fv ) is a relatively compact neighborhood of δ0 and V
is a neighborhood of 1 in Teδ0 (Fv ). If V is sufficiently small, then there is a compact subset
Ω ⊂ Gσ × Gθ (Fv ) such that if
g1−1tδ0 g2 ∈ W
with t ∈ V then (g1 , g2) ∈ Gδ0 (Fv )Ω.

Proof. Consider the continuous map
A : Gσ × Gθ (Fv ) × Teδ0 (Fv ) −→ G(Fv )

(g1 , g2 , t) 7−→ g1−1tδ0 g2

and let
P : Gσ × Gθ (Fv ) × Teδ0 (Fv ) −→ Gσ × Gθ (Fv )

be the canonical projection. The lemma is equivalent to the statement that if V and W
are sufficiently small (with W relatively compact) then there exists a compact set Ω ⊂
Gσ × Gθ (Fv ) such that P ◦ A−1 W ⊂ Gδ0 (Fv )Ω. This latter statement is a consequence
of [RR, Proposition 2.5] (and the reference therein in the real case); in loc. cit. one takes
M = Gσ × Gθ (Fv ) and H = Gδ0 (Fv ).

Lemma 5.6. Let V be an open neighborhood of 1 in Teδ0 (Fv ) and suppose m, m′ ∈ V. If V
is sufficiently small and there is a (g1 , g2 ) ∈ Gσ × Gθ (Fv ) such that g1−1 mδ0 g2 = m′ δ0 , then
(g1 , g2 ) ∈ Gδ0 (Fv ).
Proof. The proof of [La1, Lemme 3.1.4] easily adapts to our situation to prove the lemma.
We only note that the analogue of [La1, Lemme 3.1.2] is trivial in our situation because δ0 is
relatively τ -regular semisimple, and the analogues of [La1, Lemme 3.1.1 and Lemme 3.1.3]

are given by Lemma 5.4 and Lemma 5.5, respectively.
Lemma 5.7. Under the assumptions of Lemma 5.6, if m′ δ0 and mδ0 are in the same stable
relative τ -class, then
′
g −1
1 mg 1 = m
for some g 1 ∈ Cδτ δ−θ (F v ). Hence m = m′ .
0 0

Proof. Let F1 /Fv be a finite field extension such that Cδτ δ−θ F is split. Then if m, m′ have
0 0

1

′
the property that there exists (g 1 , g 2 ) ∈ G × G (F v ) satisfying g −1
1 mδ0 g 2 = m δ0 , we can
and do assume that (g 1 , g 2 ) ∈ Gσ × Gθ (F1 ) (compare (3.2.2)). Applying Lemma 5.6 “over
F1 ” we have that (g 1 , g 2 ) ∈ Gδ0 (F1 ). Since Cδτ δ−θ is a torus, g 1 commutes with m, which
0 0
proves the last statement.

σ

θ

Lemma 5.8. For Y, V, and W(Y, V) as in Lemma 5.4, suppose Y ⊂ U where U is an open
neighborhood of 1 in Gσ × Gθ (Fv ). If U and V are sufficiently small, then each
g1−1 tδ0 g2 ∈ W(Y, V)

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

29

with (g1 , g2 ) ∈ Gσ × Gθ (Fv ) and t ∈ V satisfies (g1 , g2 ) ∈ Gδ0 (Fv )Y .
Proof. By our hypothesis and Lemma 5.4, we have
g1−1 tδ0 g2 = y1−1 t′ δ0 y2
for some (y1 , y2 ) ∈ Y and t′ ∈ V. By Lemma 5.6, if U and V are sufficiently small we have
that (g1 y1−1 , g2 y2−1) ∈ Gδ0 (Fv ).

With these lemmas in place, we can now prove Proposition 5.3:
Proof of Proposition 5.3. Choose a neighborhood V of 1 in Teδ0 (Fv ) and an analytic subvariety
Y ⊂ Gσ × Gθ (Fv ) satisfying the conclusion of Lemma 5.4. Let dg1 , dg2, and dtδ0 be Haar
measures on Gσ (Fv ), Gθ (Fv ), and Gδ0 (Fv ), respectively. In this proof we use these measures
to define T ROδ0 (f ) = T ROδ0 (f, dtδ0 ). There is a natural map
Y −→ Gδ0 (Fv )\Gσ × Gθ (Fv );
let dµ be the measure on Y that is the pullback of the measure dgdt1δdg2 with respect to this
0
map. Suppose that f ∈ Cc∞ (G(Fv )) has support in W := W(Y, V) and that Y and V are
sufficiently small. For each t ∈ Teδ0 (Fv ), define
Z
ψ(t) :=
f (g1−1tδ0 g2 )dµ(g1, g2 ).
Y

By Lemma 5.4 the function ψ on Teδ0 (Fv ) is smooth and compactly supported (with support
in V). Since Gδ0 = Gδ we have
Z
dg1 dg2
T ROδ (f ) =
f (g1−1tδ0 g2 )
dtδ0
Gδ0 (Fv )\Gσ ×Gθ (Fv )
for some t ∈ V. In view of Lemma 5.8 this implies
Z
T ROδ (f ) =
f (g1−1tδ0 g2 )dµ(g1 , g2 )
Y

and thus
T ROδ (f ) = ψ(t).
The assertion involving stable twisted relative orbital integrals follows from Lemma 5.7, and
this completes the proof of (1).
For the proof of (2), suppose that we are given ψ with support in V. Each δ ∈ W can be
written in a unique fashion as
δ = g1−1tδ0 g2
with (g1 , g2 ) ∈ Y and t ∈ V. Define
(J β ψ)(δ) = β(g1 , g2 )ψ(t)

30

JAYCE R. GETZ AND ERIC WAMBACH

where β ∈ Cc∞ (Y ) is chosen so that
Z

β(g1 , g2)dµ(g1 , g2 ) = 1.

Y

Setting f = J β ψ, statement (2) follows from the observation that
Z
J β ψ = ψ.
Y


5.2. Proof of Theorem 5.1. For this entire subsection we assume the hypotheses of Theorem 5.1. We assume f is supported in a neighborhood W = W(Y, V) of a relatively τ -regular
semisimple element δ0 , with Y and V as in Lemma 5.4. With notation and assumptions as
in Proposition 5.3, we have that
ST ROδ (f ) = 0
if the stable class of δ does not meet Teδ0 (Fv )δ0 , and
ST ROδ (f ) = ψ(t)

if δ is in the stable class of tδ0 with t ∈ Teδ0 (Fv ).
In a sufficiently small neighborhood of the identity in Teδ0 (Fv ), the map t 7→ t2 is an
isomorphism that preserves conjugacy classes. Thus we can and do choose a function ψ1 ∈
Cc∞ (Teδ0 (Fv )) with support in a small neighborhood V1 of the identity such that
ψ(t) = ψ1 (t2 ).

By shrinking V if necessary, we can make V1 as small as we wish.
Assume that δ0 has norm γ0 ∈ H(Fv ). Thus Cδτ δ−θ ,G and Cγ0 γ0−σ ,H are inner twists of each
0 0

other, and the inner twist can be defined by an element of H σ (F v ) (compare (3.2.6)). Since
δ0 is relatively τ -regular, Cδτ δ−θ is a torus, and thus the inner twist induces a σ-equivariant
0 0
isomorphism
(5.2.1)

B : Cδτ0 δ−θ ,G −→ Cγ0 γ0−σ ,H .
0

Note that Teδ0 is a maximal σ-split torus of Cδτ δ−θ ,Gσ . Since Tγ0 and Teδ0 have the same
0 0
dimension by Lemma 5.2, the isomorphism (5.2.1) induces another isomorphism
B : Teδ0 −→ Tγ0

such that for Fv -algebras R one has B(g1−1 tg1 ) = B(g1 )−1 B(t)B(g1 ) for g1 ∈ Cδτ δ−θ ,Gσ (R)
0 0
−1
∞
e
and t ∈ Tδ0 (R). Set ψ2 := ψ1 ◦ B ∈ Cc (Tγ0 (Fv )). Then ψ2 has support in B(V1 ), and
(5.2.2)

ψ1 (t2 ) = ψ2 (B(t2 )).

We note that B(t2 )γ0 is a norm of tδ0 (this is the reason for employing the squaring map
above).

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

31

Invoking Proposition 5.3(2), we shrink V and V1 if necessary and choose a function Φ ∈
such that
SROγ (Φ) = 0

Cc∞ (H(Fv ))

if the stable class of γ does not meet Tγ0 (Fv )γ0 , and
SROγ (Φ) = ψ2 (t2 )
if t2 γ0 and γ are in the same stable class. This implies the assertion of the theorem.



6. Spherical characters
In this section we introduce the notion of a relatively τ -regular and relatively τ -elliptic
representation of a reductive group over a local field. The first of these notions was used in
the statement of Theorem 1.1, and we believe the second to be of interest as well. Let Πv
be an irreducible admissible representation of G(Fv ) with space VΠv and choose
X
Λ=
λi ⊗ λ∨i ∈ HomGσ (Fv ) (VΠv , C) ⊗ HomGθ (Fv ) (VΠ∨v , C);
i

here C is the trivial representation and Π∨v is the contragredient representation acting on
VΠ∨v . The linear form Λ defines a distribution (i.e. a linear map)
(6.0.1)

ΘΛ : Cc∞ (G(Fv )) −→ C
X
hΠv (fv )λi , λ∨i i.
fv 7−→
i

A spherical matrix coefficient (of Πv ) is a distribution attached to Λ in this manner
(compare [Hak2]). If the extension M/F is trivial (so H = G and Gσ = Gθ = H σ ) then
the spherical matrix coefficient ΘΛ is representable by a locally constant function on the
relatively regular subset of G(Fv ) = H(Fv ) by [Hak2, Lemma 6]. We denote this function
by ΘΛ as well. The authors suspect that the same result is true when τ is nontrivial, but we
will not prove this.
Definition 6.1. An admissible representation Πv of G(Fv ) is relatively Λ-regular if there
is a function f ∈ Cc∞ (G(Fv )) supported in the set of relatively τ -regular elements of G(Fv )
admitting norms in H(Fv ) such that
ΘΛ (f ) 6= 0.
It is relatively τ -regular if it is relatively Λ-regular for all nonzero
Λ ∈ HomGσ (Fv ) (VΠv , C) ⊗ HomGθ (Fv ) (VΠ∨v , C).
Definition 6.2. An admissible representation Πv of G(Fv ) is relatively Λ-elliptic if there
is a function f ∈ Cc∞ (G(Fv )) supported in the set of relatively τ -elliptic semisimple elements
of G(Fv ) admitting norms in H(Fv ) such that
ΘΛ (f ) 6= 0.

32

JAYCE R. GETZ AND ERIC WAMBACH

It is relatively τ -elliptic if it is relatively Λ-elliptic for all nonzero
Λ ∈ HomGσ (Fv ) (VΠv , C) ⊗ HomGθ (Fv ) (VΠ∨v , C).
If τ is trivial then we omit it from notation, writing relatively regular for relatively τ -regular.
The analogous convention with regular replaced by elliptic will also be in force. If τ is trivial
the norm map is the identity map so the condition on elements admitting norms can be
omitted.
Remark. In certain circumstances one can use the simple twisted relative trace formula of
[H] to prove the existence of relatively τ -regular (resp. τ -semisimple) representations.
It is well known that the character of an irreducible admissible representation does not
vanish on the regular semisimple set. Thus if τ is trivial, G := H = H σ ×H σ and σ : H → H
is the automorphism switching the two factors every irreducible admissible representation
is relatively regular. We do not know if the same statement is true in general, and one has
to be cautious given [RR, §4]. However, it seems likely that in the settings of interest to
this paper every irreducible admissible representation arising as a local factor of a cuspidal
automorphic representation that is both Gσ and Gθ -distinguished is relatively τ -regular.
7. Prestabilization of a single stable relative orbital integral
In this section, following work of Langlands, Kottwitz, Shelstad, and Labesse, we define
stable relative and stable twisted relative global orbital integrals and show how they decompose into a sum of global relative κ-orbital integrals. The main result is Proposition
7.2. As anyone familiar with the usual (not relative) stable trace formula could guess, the
reason for introducing the relative κ-orbital integrals is that they factor into local κ-orbital
integrals. This makes it possible to apply the local matching theory developed in §3 and
§4. Our treatment follows [La1], and we refer to loc. cit. for notation involving abelianized
cohomology of reductive groups and quotients. We emphasize that we do not attempt to
write the κ-orbital integrals given below in terms of stable relative orbital integrals on other
groups; this is why the section is entitled “Prestabilization...” instead of “Stabilization...”
In §8 below, we show how to collect the relatively elliptic terms of the relative trace formula
together.
We should note that in the biquadratic, non-twisted case, a stabilization dependent on
various conjectural fundamental lemmas was given by Flicker in [Fl4], together with a conjectural definition of relative transfer factors.
7.1. Global relative orbital integrals. Let Φ ∈ Cc∞ (H(AF )), f ∈ Cc∞ (G(AF )). Moreover
let γ ∈ H(F ) (resp. δ ∈ G(F )) be a relatively semisimple element (resp. relatively τ semisimple element). We define the (global) relative orbital integral
ZZ
dh1 dh2
(7.1.1)
ROγ (Φ) := ROγ (Φ, dtγ ) :=
Φ(h−1
1 γh2 )
dtγ
Hγ (AF )\H σ (AF )2

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

33

where dhi = ⊗′v dhi,v and dtγ = ⊗′v dtγ,v are Haar measures on H σ (AF ) and Hγ (AF ), respectively. Similarly, we define the (global) twisted relative orbital integral
ZZ
dg1dg2
(7.1.2)
T ROδ (f ) := T ROδ (f, dtδ ) :=
f (g1−1δg2 )
dtδ
Gδ (AF )\Gσ ×Gθ (AF )
where dgi = ⊗′v dgi,v and dtδ := ⊗′v dtδ,v are Haar measures on Gσ (AF ) and Gδ (AF ), respectively. If Φ = ⊗′v Φv is factorable then
Y
(7.1.3)
ROγ (Φ, dtγ ) =
ROγv (Φv , dtγ,v ).
v

If f = ⊗′v fv is factorable then
(7.1.4)

T ROδ (f, dtδ ) =

Y

T ROδv (fv , dtδ,v ).

v

Let γ0 ∈ H(F ) and δ0 ∈ G(F ) be relatively semisimple and relatively τ -semisimple,
respectively. The (global) stable relative orbital integral is
X
(7.1.5)
ROγ (Φ, dtγ )
SROγ0 (Φ) :=
γ∼γ0

where the sum is over relatively semisimple γ ∈ H(F ) in the same stable relative class as γ0 .
The (global) stable twisted relative orbital integral is
X
(7.1.6)
T ROδ (f, dtδ )
ST ROδ0 (f ) :=
δ∼δ0

where the sum is over relatively τ -semisimple δ ∈ G(F ) in the same stable relative τ -class as
δ0 . Here we assume that the dtγ = ⊗′v dtγ,v (resp. dtδ = ⊗′v dtδ,v ) are compatible in the sense
that for each v the dtγ,v (resp. dtδ,v ) are compatible as in §4.3.
In analogy with (4.4.1), for a pair of (connected) reductive F -groups I ≤ H we set notation
for the abelian group
0
K(I, H; F ) : = Hab
(AF /F, I\H)D .

For each place v there is a localization map
(7.1.7)

K(I, H; F ) −→ K(I, H; Fv )
κH 7−→ κHv

defined as the dual of
0
0
0
Hab
(Fv , I\H) −→ Hab
(AF , I\H) −→ Hab
(AF /F, I\H).

Let Φ = ⊗′v Φv ∈ Cc∞ (H(AF )) and f = ⊗′v fv ∈ Cc∞ (G(AF )) be factorable, and let γ ∈ H(F )
(resp. δ ∈ G(F )) be relatively semisimple (resp. relatively τ -semisimple). Finally, let κH ∈

34

JAYCE R. GETZ AND ERIC WAMBACH

K(Hγσ , H σ × H σ ; F ) and κ ∈ K(Gδ , Gσ × Gσ ; F ). We then set
Y
(7.1.8)
ROγκH (Φ) : =
ROγκvHv (Φv )
v

T ROδκ (f ) : =

Y

T ROγκvv (fv ),

v

whenever this product is well-defined (i.e. convergent). The following proposition ensures
convergence:
Proposition 7.1. Let γ0 ∈ H(F ) (resp. δ0 ∈ G(F )) be relatively regular semisimple
(resp. relatively τ -regular semisimple) and let κH ∈ K(Hγ0 , H σ ×H σ ; F ) (resp. κ ∈ K(Gδ0 , Gσ ×
Gθ ; F )). Moreover, let Φ = ⊗′v Φv ∈ Cc∞ (H(AF )) and f = ⊗′v fv ∈ Cc∞ (G(AF )). There is a
Hv
finite set S of places of F such that if v 6∈ S then ROγκ0v
(Φv ) = 1 (resp. T ROδκ0vv (fv ) = 1).
We note that this is a weak relative analogue of the results of [K4, §7].
Proof. Note that (Gδ )Fv = GδFv is quasi-split for almost all v, and hence e(GδFv ) = 1 for
almost all v, and the character κv is trivial on the intersection of the Gσ × Gθ -orbit of δv
and the support of fv for almost all v by the definition of the (restricted direct) topology
0
on Hab
(AF , Gγ \Gσ × Gθ ) [La1, §1.4-1.8] and the proof of [H, Proposition 3.4]. With this
in mind, the proposition follows immediately from [H, Proposition 3.2] and the proof of [H,
Proposition 3.4].

7.2. Some cohomology groups. In this subsection we collect notation for some Galois
cohomology groups that will be used in the following subsections. Let v be a place of F and
let I ≤ H be a pair of connected reductive Fv -groups. Set
 1

1
(7.2.1)
E(I, H; Fv ) := ker Hab
(Fv , I) → Hab
(Fv , H) .
There is a natural map

0
Hab
(Fv , I\H) −→ E(I, H; Fv )

induced by the long exact sequence attached to the crossed Gal(F v /F v )-module I(F v ) →
H(F v ) [La1, p. 20]. The image of the dual map
E(I, H; Fv )D −→ K(I, H; Fv )
is denoted K(I, H; Fv )1 . Similarly, if I ≤ H is a pair of connected reductive F -groups, write
 0

0
E(I, H; AF /F ) : = coker Hab
(AF , H) → Hab
(AF /F, I\H) .
There is a natural quotient map

0
Hab
(AF /F, I\H) −→ E(I, H; AF /F ).

The image of the dual map
E(I, H; AF /F )D −→ K(I, H; F )

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

35

is denoted K(I, H; F )1. The localization map (7.1.7) induces a homomorphism
Y
(7.2.2)
K(I, H; F )1 −→
K(I, H; Fv )1
v

(compare [La1, p. 43]). The kernel of this map is denoted K(I, H; F )0.
7.3. Prestabilization of a single relatively elliptic term. For a reductive F -group H,
write τ (H) for the Tamagawa number of H (this τ should not be confused with the Galois
automorphism τ from above). Finally, for a pair of reductive F -groups I and H, write
 1

1
(7.3.1)
d(I, H) := #coker Hab
(AF /F, I) → Hab
(AF /F, H) .
The main result of this section is the following adaptation of the work of Langlands, Kottwitz,
and Labesse [L2], [K3], [K4], [La1] to our situation:
Proposition 7.2. Let Φ = ⊗′v Φv ∈ Cc∞ (H(AF )) and f = ⊗′v fv ∈ Cc∞ (G(AF )) be factorable.
If γ ∈ H(F ) is relative regular and relatively elliptic then
SROγ (Φ) =

X
τ (H σ × H σ )
ROγκH (Φ)
σ
σ
τ (Hγ )d(Hγ , H × H ) κ
H

σ

=

σ

τ (H × H )
τ (Hγ )d(Hγ , H σ × H σ )

XY
κH

ROγκvHv (Φv )

v

where the sum is over κH ∈ K(Hγ , H σ × H σ ; F )1 .
Similarly, if δ ∈ G(F ) is relatively τ -regular and relatively elliptic then
ST ROδ (f ) =
=

X
τ (Gσ × Gθ )
T ROδκ (f )
τ (Gγ )d(Gδ , Gσ × Gσ ) κ

XY
τ (Gσ × Gθ )
T ROγκvv (fv )
τ (Gδ )d(Gδ , Gσ × Gθ ) κ v

where the sum is over κ ∈ K(Gγ , Gσ × Gθ ; F )1 .
Proof. We begin by recalling that Hγ and Gδ are connected, and hence the groups
K(Hγ , H σ × H σ ; F )1 = E(Hγ , H σ × H σ ; AF /F )D
K(Gδ , Gσ × Gθ ; F )1 = E(Gδ , Gσ × Gθ ; AF /F )D

are finite [La1, Proposition 1.8.4]. Moreover, the κ-orbital integrals converge by Proposition
7.1. With these observations in mind, the proof is a standard consequence of the Fourier
transform on a finite group. In more detail, one combines the first exact sequence on [La1,
p. 42] with [La1, Proposition 1.8.5 and 1.8.6] (compare the proof of [La1, Proposition 4.2.1]).


36

JAYCE R. GETZ AND ERIC WAMBACH

8. Grouping relatively elliptic terms
In this section, we group together the relatively elliptic and relatively τ -elliptic portions
of the relative trace formula and twisted relative trace formula, respectively.
8.1. Haar measures. Recall the Harish-Chandra subgroups 1 H(AF ) and the central subgroups AH ≤ H(F ⊗Q R) of §2.3. For every γ ∈ H(AF ) and δ ∈ G(AF ) write
2

H σ (AF ) : = H σ (AF ) ∩ 1 H(AF )

2

Gσ (AF ) : = Gσ (AF ) ∩ 1 G(AF )

2
2

Gθ (AF ) : = Gθ (AF ) ∩ 1 G(AF )

Hγ (AF ) : = Hγ (AF ) ∩ 1 H(AF ) × 1 H(AF )

2

Gδ (AF ) : = Gδ (AF ) ∩ 1 G(AF ) × 1 G(AF ).

Moreover, write
AσH : = H σ (F ⊗Q R) ∩ AH
AσG : = Gσ (F ⊗Q R) ∩ AG
AθG : = Gθ (F ⊗Q R) ∩ AG

and
A : = {(x, x) ∈ AσH × AσH }

e : = {(z, z) ∈ Aσ × Aθ : z ∈ Aσ ∩ Aθ }.
A
G
G
G
G

We then have decompositions


Hγ (AF )\2 H σ (AF ) × 2 H σ (AF )

e σ × Aθ ) × 2 Gδ (AF )\2 Gσ (AF ) × 2 Gθ (AF ) .
Gδ (AF )\Gσ (AF ) × Gθ (AF ) = (A\A
G
G

(8.1.1) Hγ (AF )\H σ (AF ) × H σ (AF ) ∼
= (A\AσH × AσH ) ×

2

We now specify a choice of Haar measure on all of the groups appearing in (8.1.1), at least
if γ is relatively elliptic (resp. δ is relatively τ -elliptic). Whenever a reductive F -group H
appears, we give H(AF ), AH , and 1 H(AF ) the measures that are used in the definition of
the Tamagawa number τ (H). We then fix, once and for all, measures dz1 = dz2 for AσH , de
z
σ
θ
for AG and de
zθ for AG , and stipulate that the isomorphisms
H σ (AF ) ∼
= AH σ /AσH × 1 H σ (AF )
2 σ
G (AF ) ∼
= AGσ /Aσ × 1 Gσ (AF )

2

G

2

G (AF ) ∼
= AGθ /AθG × 1 Gθ (AF )
θ

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

37

are measure preserving. Notice that if γ is relatively elliptic (resp. δ is relatively τ -elliptic)
then
2

Hγ (AF ) = 1 Hγ (AF )

2

Gδ (AF ) = 1 Gδ (AF ).

By our earlier convention, we have already endowed 2 Hγ (AF ), 2 Gδ (AF ), A = AHγ and
e = AG with measures. Altogether, this endows all of the groups occurring in (8.1.1) with
A
δ
measures. Thus 2 Hγ (AF ) and 2 Gδ (AF ) are given the unique Haar measures such that if γ is
relatively elliptic and δ is relatively τ -elliptic then
vol(Hγ (F )\2 Hγ (AF )) = τ (Hγ )
vol(Gδ (F )\2 Gδ (AF )) = τ (Gδ ).
For the rest of this paper, we use these choices of measures when we form relative orbital
integrals and twisted relative orbital integrals. These measures will be compatible for the
same reason that the Tamagawa measures in the usual trace formula are compatible, namely
that the Tamagawa numbers of two inner forms of the same quasi-split reductive group are
equal [K5] [Ch].
For Φ ∈ Cc∞ (H(AF )) and f ∈ Cc∞ (G(AF )) we define
Z
dz1 dz2
1
Φ(z1−1 z2 x)
Φ (x) : =
(8.1.2)
du
A\Aσ ×Aσ
Z H H
de
z de
zθ
f (e
z −1 zeθ x)
f 1 (x) : =
.
dt
e σ ×Aθ
A\A
G
G
8.2. Elliptic kernels. Let Φ ∈ Cc∞ (H(AF )), f ∈ Cc∞ (G(AF )) and consider the kernel
functions
X
KΦ (x, y) :=
Φ1 (x−1 γy) : 1 H(AF ) × 1 H(AF ) −→ C
γ

Kf (x, y) :=

X
δ

f 1 (x−1 δy) : 1 G(AF ) × 1 G(AF ) −→ C

where the first sum is over relatively regular elliptic γ ∈ H(F ) and the second is over
relatively τ -regular elliptic δ ∈ G(F ). Define the integrals
ZZ
RTe (Φ) : =
KΦ (h1 , h2 )dh1 dh2
(H σ (F )\2 H σ (AF ))2
ZZ
T RTe (f ) : =
Kf (g1 , g2)dg1 dg2 .
Gσ (F )\2 Gσ (AF )×Gθ (F )\1 Gθ (AF )

38

JAYCE R. GETZ AND ERIC WAMBACH

Here the dhi are both induced by the measure on 2 H σ (AF ) fixed above and dg1 , dg2 are
induced by the measures on 2 Gσ (AF ) and 2 Gθ (AF ) fixed above, respectively. These integrals
are absolutely convergent (see the proof of [H, Theorem 4.1]).
8.3. Stable geometric expansions. Using standard manipulations (compare [H]), we
rewrite
(8.3.1)

RTe (Φ) =

XX

a(γ)ROγ (Φ)

γ0 γ∼γ0

T RTe (f ) =

XX

aτ (δ)T ROδ (f )

δ0 δ∼δ0

where the exterior sums are over a set of representatives for the stable relatively regular
elliptic classes (resp. stable relatively τ -regular elliptic classes) and the interior sums are
over a set of representatives for the relative classes (resp. relative τ -classes) in the stable
relative class of γ0 (resp. stable relative τ -class of δ0 ). Here
(8.3.2)

a(γ) : = vol(Hγ (F )\2Hγ (AF )) = vol(Hγ (F )\1 Hγ (AF )) = τ (Hγ )
aτ (δ) : = vol(Gδ (F )\2 Gδ (AF )) = vol(Gδ (F )\1 Gδ (AF )) = τ (Gδ ),

where the volumes are taken with respect to the measures fixed in §8.1. Here, as in §8.1, we
are using the fact that γ and δ are relatively elliptic and relatively τ -elliptic, respectively,
to conclude that 2 Hγ (AF ) = 1 Hγ (AF ) and 2 Gδ (AF ) = 1 Gδ (AF ). Note that with the choice
of Haar measure fixed in §8.1, the measures occurring in the summands corresponding to γ
in the same stable relative class as a given γ0 are compatible with respect to (3.2.3) above.
Similarly, the measures occurring in the summands corresponding to δ in the same stable
relative τ -class as a given δ0 are compatible with respect to (3.2.3). This follows from the
well-known fact that the Tamagawa numbers of two inner forms of the same quasi-split
reductive group are equal [K5] [Ch]. With this in mind, we group stable classes in (8.3.1)
and obtain
(8.3.3)

RTe (Φ) =

X

τ (Hγ0 )SROγ0 (Φ)

γ0

T RTe (f ) =

X

τ (Gδ0 )ST ROδ0 (f )

δ0

where the first sum is over a set {γ0 } of representatives for the stable relative classes in H(F )
that consist of relatively regular elliptic elements and the second sum is over a set {δ0 } of
representatives for the stable relative τ -classes in G(F ) that consist of relatively τ -regular
semisimple elements. The measures inherent in the definition of SROγ0 (Φ) and ST ROδ0 (f )
are specified as in §8.1.

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

39

Applying Proposition 7.2 we can rewrite (8.3.3) as
(8.3.4)

RTe (Φ) =

X

T RTe (f ) =

X

γ0

δ0

τ (H σ × H σ ) X
ROγκ0H (Φ)
d(Hγ0 , H σ × H σ ) κ
H

σ

θ

τ (G × G )
d(Gδ0 , Gσ × Gθ )

X

T ROδκ0 (f ).

κ

Here the interior sum indexed by γ0 is over κH ∈ K(Hγ0 , H σ × H σ ; F )1 and the interior sum
indexed by δ0 is over κ ∈ K(Gδ , Gσ × Gθ ; F )1 (compare Proposition 7.2).
8.4. The unitary case. We now specialize our notation to our primary case of interest.
Thus assume that H σ = U σ is a unitary group with respect to a quadratic extension of fields
M/F with M a CM field and F a totally real field. In other words, we assume that there is
a simple algebra D over F with center M and an involution † of D such that the fixed field
of † acting on M is F and such that if R is an F -algebra then
U σ (R) := {g ∈ (D ⊗F R)× : gg † = 1}.

(8.4.1)

We let E/F be a quadratic extension of fields with E totally real and assume moreover that
we are in the biquadratic situation, thus U := ResE/F U σ and σ is the automorphism induced
by the generator of Gal(E/F ) which we will also denote by σ. We let τ be the generator of
M/F and Gσ := ResM/F U σ , G := ResM/F U. The automorphism τ defines an automorphism
τ : G → G such that the subgroup of G fixed by τ is U. Finally, choose a (finite-dimensional)
representation
UFσ∞ −→ AutR (V )
and let GσF∞ → AutR (ResM∞ /F∞ V ) be the representation obtained by restriction of scalars.
We have the following proposition:
Proposition 8.1. Suppose that Φ ∈ Cc∞ (U(AF )) and f ∈ Cc∞ (G(AF )) are factorable and
that Φv matches fv for all finite places v of F . Consider the following assumptions:
(1) One has
f∞ = f1 × f2 ∈ Cc∞ (Gσ (F∞ ) × Gσ (F∞ )) = Cc∞ (G(F∞ ))
with f1−τ ∗ f2 = fL,ResM∞ /F∞ V,τ .
(2) One has
Φ∞ = Φ1 × Φ2 ∈ Cc∞ (U σ (F∞ ) × U σ (F∞ )) = Cc∞ (U(F∞ ))
with Φ−1
1 ∗ Φ2 = c∞ fEP,V for some c∞ ∈ R>0 .

If the assumptions hold, then for an appropriate choice of c∞ ∈ R>0 one has
RTe (Φ) = 2T RTe (f ).

40

JAYCE R. GETZ AND ERIC WAMBACH

In the proposition, fL,ResM∞ /F∞ V,τ is the Lefschetz function attached to the representation
ResM∞ /F∞ V of GσF∞ and the involution τ of GσFv (see [BLS, Proposition 8.4]). Moveover
fEP,V is the Euler-Poincaré function attached to V ; this is simply the Lefschetz function in
the case that the associated automorphism is trivial.
Proof. The functions fL,ResM∞ /F∞ V,τ and fEP,V are stable in the sense of [La1, Définition
3.8.2] (see [CL, Théorème A.1.1] and [La2, Théorème 7.1]). Thus, in view of Proposition
4.8 and assumptions (2) and (1), any γ0 (resp. δ0 ) contributing a nonzero summand to
RTe (Φ) (resp. T RTe (f )) is relatively regular elliptic (resp. relatively τ -regular elliptic) at
F∞ . Applying [La1, Proposition 1.9.6 and Lemme 1.9.7] we conclude that for these places
the set ∞ is (H, Hγ0 ) (resp. (G, Gδ ))-essential for any γ0 (resp. δ0 ) contributing a nonzero
summand. Using the fact that fL,ResM∞ /F∞ V,τ and fEP,V are stable and Proposition 4.8 again,
we conclude that the κ-orbital integrals for κ 6= 1 in (8.3.4) all vanish, and hence
X τ (U σ × U σ )
RTe (Φ) =
SROγ0 (Φ)
σ × U σ)
d(U
,
U
γ
0
γ
0

T RTe (f ) =

X
δ0

τ (Gσ × Gθ )
ST ROδ0 (f ).
d(Gδ0 , Gσ × Gθ )

By [La1, Corollaire A.1.2] for all v|∞ the functions fv and cv Φv match for an appropriate
constant cv ∈ R>0 (see also [La2, Théorème 7.1]). We henceforth assume that fv and Φv
match for all v.
Since every relatively regular semisimple γ0 is a norm of a δ0 by Lemma 3.11 and every
relatively τ -regular elliptic semisimple δ0 that has local norms at infinity has a global norm
by Proposition 3.10, to complete the proof it suffices to show that
(8.4.2)

τ (U σ × U σ )
τ (Gσ × Gθ )
SRO
(Φ)
=
2
ST ROδ0 (f )
γ0
d(Uγ0 , U σ × U σ )
d(Gδ0 , Gσ × Gθ )

if γ0 is a norm of δ0 . By the definition of matching we have SROγ0 (Φ) = ST ROδ0 (f ).
Moreover
 1

1
(8.4.3) d(Uγ0 , U σ × U σ ) = #coker Hab
(AF /F, U σ × U σ ) → Hab
(AF /F, U σ × U σ ) = 1
 1

1
d(Gδ0 , Gσ × Gθ ) = #coker Hab
(AF /F, U σ × Gθ ) → Hab
(AF /F, Gσ × Gθ ) = 1

by the fact that γ0 and δ0 are relatively elliptic and relatively τ -elliptic, respectively, and
[La1, Corollaire 1.9.3]. By [La1, Corollaire 1.7.4], we have

(8.4.4)

τ (U σ × U σ ) =
τ (Gσ × Gθ ) =

1
4
#Hab
(AF /F, U σ × U σ )
=
1
1
# kerab (F, U σ × U σ )
# kerab (F, U σ × U σ )
1
#Hab
(AF /F, Gσ × Gθ )
2
=
1
1
# kerab (F, Gσ × Gθ )
# kerab (F, Gσ × Gθ )

1
1
Here we are using the fact that Hab
(AF /F, GLn ) = 1 and Hab
(AF /F, H) = 2 if H is a
(nonsplit) unitary group (see [HL, Lemma 1.2.1(i)] for the latter statement).

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

41

Since Gσ is an inner form of a general linear group, the Hasse principle is valid for it. On
the other hand, Gθ and U σ are unitary groups, so the Hasse principle is valid for them as
well [HL, Lemma 1.2.1(i)], so ker1ab (F, U σ × U σ ) = ker1ab (F, Gσ × Gθ ) = 1. In view of (8.4.3)

and (8.4.4), this completes the proof of the proposition.
9. Relative trace formulae
9.1. A simple relative trace formula. For f ∈ Cc∞ (G(AF )) and a cuspidal unitary automorphic representation Π of G(AF ), Arthur has shown [Ar1, Lemma 4.5, Lemma 4.8] that
there is a (unique) function KΠ(f 1 ) (x, y) ∈ L20 (G(F )\1 G(AF )×G(F )\1 G(AF )) that is smooth
in x and y separately with L2 -expansion
X
(9.1.1)
KΠ(f 1 ) (x, y) =
Π(f 1 )φ(x)φ(y).
φ∈B(Π)

Here B(Π) is an orthonormal basis of the Π-isotypic subspace VΠ ≤ L20 (G(F )\1 G(AF )) with
respect to the pairing
(9.1.2)

VΠ × VΠ −→ C
Z
(φ1 , φ2 ) 7−→

φ1 (y)φ2(y)dy,

G(F )\1 G(AF )

with dy induced by the Tamagawa measure. We emphasize that this expansion (9.1.1), in
general, is only convergent in the L2 sense. Following [H], we define
ZZ
1
(9.1.3)
T RT (Π(f )) =
KΠ(f 1 ) (x, y)dxdy.
Gσ (F )\2 Gσ (AF )×Gθ (F )\2 Gθ (AF )

The integral is absolutely convergent by [AGR, §2, Proposition 1]. The following simple
relative trace formula is proved in [H] via a modification of the argument used to prove the
usual simple trace formula:
Theorem 9.1. Let f = fv1 ⊗ fv2 ⊗ f v1 v2 ∈ Cc∞ (G(AF )) be a factorable function such that
• fv1 is F -supercuspidal.
• fv2 is supported on relatively τ -regular elliptic elements of G(Fv2 ).
Then
(9.1.4)

T RTe (f ) :=

X
δ

τ (Gδ )T ROδ (f ) =

X

T RT (Π(f 1 ))

Π

where the sum on the left is over a set of representatives for the relatively τ -regular elliptic
classes in G(F ) and the sum on the right is over a set of representatives for the equivalence
classes of cuspidal automorphic representations Π of 1 G(AF ).

42

JAYCE R. GETZ AND ERIC WAMBACH

Here we say that fv is F -supercuspidal if fv has zero integral along the unipotent radical
of any proper parabolic of GFv that is defined over F ; i.e. is the base change to Fv of a
parabolic subgroup of G. As usual, we allow τ to be trivial in the theorem above. By
convention, an automorphic representation of 1 G(AF ) is the restriction to 1 G(AF ) of an
automorphic representation of G(AF ), and we consider two such to be equivalent if they are
equivalent as representations of 1 G(AF ).
Let K∞ ≤ G(F∞ ) be a maximal compact subgroup. We note that if Π is cuspidal and f
is K∞ -finite or Π(f 1 ) has finite rank then we have
X
(9.1.5)
T RT (Π(f 1 )) =
PGσ (Π(f 1 )φ)PGθ (φ)
φ∈B(Π)

where the sum is over an orthonormal basis B(Π) of the Π-isotypic subspace of L20 (G(F )\1 G(AF ))
consisting of smooth vectors (see (1.1.1) for the definition of PGσ ). For any f ∈ Cc∞ (G(AF )),
if T RT (Π(f 1 )) is nonzero then Π is both Gσ and Gθ -distinguished.
9.2. Comparison. Upon combining Proposition 8.1 and Theorem 9.1, we obtain the following proposition:
Proposition 9.2. Suppose that Φ = ⊗′v Φv ∈ Cc∞ (U(AF )) and f = ⊗′v fv ∈ Cc∞ (G(AF )) are
factorable, and satisfy the following conditions:
•
•
•
•
•

Φv matches fv for all v.
Φ∞ and f∞ satisfy conditions (1-2) of Proposition 8.1.
There is a finite place v1 such that Φv1 is F -supercuspidal.
There is a place v2 of F such that fv2 is F -supercuspidal.
There is a place v3 of F such that Φv3 is supported on relatively regular elliptic
semisimple elements.
• There is a place v4 of F such that fv4 is supported on relatively τ -regular elliptic
semisimple elements.

Under the above assumptions, we have
X
X
RT (π(Φ1 )) = 2
T RT (Π(f 1)),
π

Π

where the sums are over equivalence classes of cuspidal automorphic representations π of
U(AF ) and Π of 1 G(AF ), respectively.

Note that we do not require that the places vi be distinct. Here RT (π(Φ1 )) is defined to be
T RT (Π(f 1 )) in the “τ = 1” case.
10. Application
For this entire section we will place ourselves in the following special case of the construction exposed in the previous sections. Let E/F be a quadratic extension of totally real

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

43

fields and let M/F be a CM extension. Let U σ be a unitary group over F as in (8.4.1)
and U := ResE/F U σ . We let σ be the automorphism of U induced by the generator of
Gal(E/F ), which we will also denote by σ. The groups Gσ = ResM/F U σ and G = ResM/F U
are isomorphic to inner forms of ResM/F GLn and ResM E/F GLn , respectively, for some n.
When we refer to the base change map below, we will mean the (partially defined) functorial lifting with respect to the map of L-groups
b : L U −→ L G
induced by the natural inclusion U → G (see [HL]).
Definition 10.1. Let π be a cuspidal automorphic representation of U σ (AE ) = U(AF ).
We say that a cuspidal automorphic representation Π of Gσ (AE ) = G(AF ) is a weak base
change of π if Πw is the base change of πw for all places w of E satisfying the following:
• w is infinite,
• ME/E is split at w, or
• πw and UEσw are unramified.
By strong multiplicity one for G [Ba], if a weak base change of π exists then it is unique.
Suppose that π and π ′ are cuspidal and both admit weak base changes to G(AF ). If π and
π ′ are moreover nearly equivalent, i.e. πv ∼
= πv′ for almost all places v, then their weak
base changes are obviously equal.
10.1. Statement of theorem. To state the main theorem of this section, it is convenient
to introduce a definition. Let KU ∞ ≤ U(F∞ ) be a maximal compact subgroup and let V be
a representation of U(F∞ ). Let u := Lie(UF∞ ) ⊗R C be the complexification of the real Lie
group U(F∞ ).
Definition 10.2. An automorphic representation π of U(AF ) has nonzero cohomology
with coefficients in V if H ∗ (u, KU ∞ ; π∞ ⊗ V ) is not identically zero.
We have the following theorem:
Theorem 10.3. Let π be a cuspidal automorphic representation of U σ (AE ) = U(AF ) that
admits a weak base change Π to G(AF ). Suppose that π satisfies the following conditions:
(1) There is a finite-dimensional representation V of UF∞ such that π has nonzero cohomology with coefficients in V .
(2) There is a finite place v1 of F totally split in ME/F such that πv1 is supercuspidal.
(3) There is a finite place v2 6= v1 of F totally split in ME/F such that πv2 is in the
discrete series.
(4) For all places v of F such that ME/F is ramified and M/F , E/F are both nonsplit at
v the weak base change Π of π to G(F ) has the property that Πv is relatively τ -regular.

44

JAYCE R. GETZ AND ERIC WAMBACH

If the automorphic representation Π is both Gσ and Gθ -distinguished then there is a cuspidal automorphic representation π ′ of U σ (AE ) = U(AF ) that is U σ -distinguished and nearly
equivalent to π. Moreover, we can take π ′ to have nonzero cohomology with coefficients in
V.
Theorem 10.3 will be proven later in this section. Combining it with the work of Jacquet,
Lapid and their collaborators, and Flicker and his collaborators, we obtain the following
corollary:
Corollary 10.4. Assume that U σ is quasi-split or more generally that Gθ and Gσ are quasisplit. Let π be a cuspidal automorphic representation of U(AF ) satisfying conditions (1)-(4)
of Theorem 10.3. The representation π admits a weak base change Π to GLn (AM E ). If
the partial Asai L-function LS (s, Π; r) has a pole at s = 1 then some cuspidal automorphic
representation π ′ of U(AF ) nearly equivalent to π is U σ -distinguished. Moreover, we can
take π ′ to have nonzero cohomology with coefficients in V .
We require the following lemma for the proof of Corollary 10.4 and also below in the proof
of Theorem 10.3:
Lemma 10.5. Suppose that Π is a cuspidal automorphic representation of G(AF ). If Π is
Gθ -distinguished, then Π ∼
= Πθ∨ . If Π is Gσ -distinguished, then Πσ ∼
= Π∨ .
Proof. Both of these are well-known. For the first, see [J1, §3]. For the second, assume that
Π is Gσ -distinguished. For places v of F split in E/F , it is trivial to check that Πσv ∼
= Π∨v
using an analogue of the proof of Proposition 10.6 given below. If v is inert (and unramified)
in E/F , the fact that Πσv ∼
= Π∨ by strong
= Π∨v is [P, Corollary 2] (see also [Fl2]). Thus Πσ ∼
multiplicity one.

We also require the following proposition in the proof of Theorem 10.3:
Proposition 10.6. Let Ξ be the set of places of F that split in E/F , let π be a cuspidal
automorphic representation of U(AF ). If π is U σ -distinguished, then πΞ∨ ∼
= (πΞ )σ .
Proof. We may assume, without loss of generality, that the φ0 in the space of π with nonzero
period over U σ (AF ) is factorable. Write φ0 = ⊗v φ0,v , where the tensor product is over
all places of F . For v ∈ Ξ, choose an isomorphism UFv ∼
= UFσv × UFσv intertwining σ with
(x, y) 7→ (y, x). Using this isomorphism, we can and do decompose
(10.1.1)

′
′
πv ∼
⊗ π2,v
= π1,v

′
for some admissible representations πi,v
of U σ (Fv ). Thus
′
′
πvσ ∼
⊗ π1,v
.
= π2,v

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

45

′
′
′ , Vπ ′ , and Vπ be the spaces of the representations π
For a fixed v ∈ Ξ, let Vπ1,v
1,v , π2,v ,
2,v
and π, respectively. Consider the bilinear pairing
′
′
Vπ1,v
⊗ Vπ2,v
֒→ Vπ −→ C.

Here the first map is (φ1 , φ2 ) 7→ (⊗v′ 6=v φ0,v′ ) ⊗ (φ1 ⊗ φ2 ) and the second is φ 7→ PU σ (φ). This
bilinear pairing is U σ (Fv )-equivariant, and is nonzero by hypothesis. By the irreducibility of
πv , we conclude that
∨
π2,v ∼
= π1,v
and thus
πvσ ∼
= πv∨ .

We give the proof of Corollary 10.4 now:
10.2. Proof of Corollary 10.4. We assume the notation and hypotheses of Corollary 10.4.
Let Π be the weak base change of π; it exists by the proof of [HL, Theorem 3.1.4]. Since Π
is a weak base change we have Πv ∼
= Πτv for almost all places v. By strong multiplicity one
we conclude that Π ∼
= Πτ . View Π as an automorphic representation of ResM E/M GLn (AM ).
Let r : L ResM E/M GLn → GLn2 (C) be the Asai representation (see [R, §6] or [Fl1] for the
definition of this representation). By assumption the partial Asai L-function
LS (s, Π; r)
has a pole at s = 1. Here S is a finite set of places of M containing the infinite places
and all finite places where ME/M or Πv is ramified. We note that we are using the fact
that LS (s, Π; r) admits a meromorphic continuation to a closed right half-plane containing
s = 1, a fact established by Flicker and Flicker-Zinoviev [Fl1] [FlZ, Theorem] using the
Langlands-Shahidi method [Sh] and an adaptation of the Rankin-Selberg method of Jacquet,
Piatetski-Shapiro, and Shalika [JPSS]. As a biproduct of this method, Flicker and FlickerZinoviev also establish in [FlZ, Theorem] that if LS (s, Π; r) has a pole at s = 1, then Π is
distinguished by GLn/M . This implies that Πσ ∼
= Π∨ by Lemma 10.5.
Writing L for the subfield of ME fixed by θ := σ ◦ τ , note that ME/L splits at all infinite
places. Since Πσ ∼
= Π. Thus, applying results of Jacquet
= Π we have Πθ∨ ∼
= Π∨ and Πτ ∼
([J1, Theorem 3 and 4] and [J2]) we conclude that Π is distinguished by “the” quasi-split
unitary group in n-variables with respect to ME/L.

The corollary now follows from Theorem 10.3.
10.3. Preparations for the proof of Theorem 10.3. We isolate three steps in the proof of
Theorem 10.3 in the following lemmas. If the reader so desires, (s)he can skip this subsection
and refer back to it as needed during the following subsection.
For the purpose of stating a lemma we develop some notation. Assume that we are in the
biquadratic case of §3.1 and let v be a place of F split in E/F . Suppose Πv is an irreducible

46

JAYCE R. GETZ AND ERIC WAMBACH

unitary (admissible) representation of G(Fv ). We agree to realize it on a Hilbert space VΠv .
Write
HΠv := Im(Cc∞ (G(Fv )) → EndHS (VΠv )),
where the map sends f to Πv (f ). Here EndHS (VΠv ) is the space of Hilbert-Schmidt operators
on VΠv . For any x, y ∈ G(Fv ) we have linear left multiplication by x and right multiplication
by y maps
Lx , Ry : EndHS (VΠv ) −→ EndHS (VΠv )

given by Lx (T ) := Πv (x−1 ) ◦ T and Ry (T ) := T ◦ Πv (y −1 ).
Lemma 10.7. The space of linear forms
ℓ : HΠv −→ C

satisfying Lx (ℓ) = Ry (ℓ) = ℓ for (x, y) ∈ Gσ × Gθ (Fv ) is at most one-dimensional.
A linear form as in the lemma is known as a (Gσ (Fv ), Gθ (Fv ))-invariant linear form.
Proof. The natural isomorphism
EndHS (VΠv )∨ ∼
= VΠv ⊠ VΠ∨v
is G(Fv ) × G(Fv )-equivariant. On the right we are taking the completed (Hilbert space)
tensor product. A linear form ℓ as in the lemma is sent to
(10.3.1)

(VΠv )G

σ (F

v)

⊠ (VΠ∨v )G

θ (F

v)

under this isomorphism. Since Πv ∼
= Π1v ⊗ Π2v for some admissible representations Πiv of
σ
G (Fv ), it follows that (10.3.1) is at most one dimensional. This proves that the space of
linear forms satisfying the hypotheses of the lemma is at most one dimensional.

We now record a lemma on supercusp forms. Let v be a finite place of F that splits
completely in ME/F . Thus we have isomorphisms
(10.3.2)

UFv ∼
= (U σ )2Fv
GF ∼
= (U σ )4
= U2 ∼
v

Fv

Fv

intertwining σ with (x, y) 7→ (y, x) (resp. (x, y, z, w) 7→ (z, w, x, y)) and τ with (x, y, z, w) 7→
(y, x, w, z). Let πv be a unitary admissible representation of U(Fv ) satisfying πv∨ ∼
= πvσ ; thus
we can and do decompose
πv ∼
= πv′ ⊗ πv′∨

for some admissible representation πv′ of U σ (Fv ) using (10.3.2). Let Πv be the base change
of πv to G(Fv ). We can and do factor
Πv = πv ⊗ πv∨ ∼
= πv′ ⊗ πv′∨ ⊗ πv′∨ ⊗ πv′
with respect to the second line of (10.3.2). We also write Π′v = πv′ ⊗ πv′∨ .

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

47

Let H be a reductive F -group. As above, we say that a function f ∈ Cc∞ (H(Fv )) is
F -supercuspidal if the integral of f along the Fv -points of the unipotent radical of any
F -rational proper parabolic subgroup of H vanishes.
Lemma 10.8. If πv′ is supercuspidal, then there are matching functions
f = f1 × f2 ∈ Cc∞ (Gσ × Gσ (Fv )) ∼
= Cc∞ (G(Fv ))
and Φ ∈ Cc∞ (U(Fv )), both F -supercuspidal, such that

tr Π′v (f1−τ ∗ f2 ) ◦ τ 6= 0.

Proof. Let Φ1 be a truncated diagonal matrix coefficient of πv′ [HL, §1.9]. We simply let
′
f1 = Φ−1
1 × chKU
v

f2 = meas(KU′ v )−2 chKU′ v × chKU′ v
′
Φ = Φ−1
1 × chKU
v

for a sufficiently small compact open subgroup KU′ v ≤ U σ (Fv ) such that Φ1 ∈ Cc∞ (U σ (Fv )//KU′ v ).

The functions f1 × f2 and Φ match by Proposition 4.8.
We require an analogous lemma in the discrete series case:
Lemma 10.9. If πv′ is in the discrete series, then there are matching functions
f = f1 × f2 ∈ Cc∞ (Gσ × Gσ (Fv )) ∼
= Cc∞ (G(Fv ))
and Φ ∈ Cc∞ (U(Fv )), supported on the relatively τ -regular elliptic subset of G(Fv ) and the
relatively regular elliptic subset of U(Fv ), respectively, such that

tr Π′v (f1−τ ∗ f2 ◦ τ ) 6= 0.
Proof. Let Gre (Fv ) ⊂ G(Fv ) (resp. U re (Fv ) ⊂ U(Fv )) denote the subset of relatively τ regular elliptic elements (resp. regular elliptic elements). By definition, Gre (Fv ) is the preimage of the set
{(x, y, y −1, x−1 ) ∈ (U σ )4 (Fv ) ∼
= G(Fv ) : xy is elliptic regular} ⊂ S(Fv )
under the map g 7→ gg −θ . Similarly, U re (Fv ) is the preimage of the set

{(x, x−1 ) ∈ (U σ )2 (Fv ) ∼
= U(Fv ) : x is elliptic regular} ⊂ Q(Fv )

under the map g 7→ gg −σ . It follows that both Gre (Fv ) ⊂ G(Fv ) and U re (Fv ) ⊂ U(Fv ) are
open and intersect arbitrarily small neighborhoods of the identity.
Let Θπv′ be the character of πv′ . Using a well-known result of Harish-Chandra, we view Θπv′
as a locally constant function on the elliptic regular set of U σ (Fv ) and as a locally integrable
function on all of U σ (Fv ). Since πv′ is in the discrete series, there is a regular elliptic γ0 ∈
U σ (Fv ) such that Θπv′ (γ0 ) 6= 0 [Ro1, Proposition 5.5]. Note (γ0 , 1, 1, 1) ∈ U σ (Fv )4 ∼
= G(Fv )
is relatively τ -elliptic regular. By the openness statement above, we can and do choose a

48

JAYCE R. GETZ AND ERIC WAMBACH

sufficiently small compact open subgroup KU′ v ≤ U σ (Fv ) and a function Φ1 ∈ Cc∞ (U σ (Fv ))
supported in the elliptic regular set of U σ (Fv ) such that
′ ) × chK ′
× chKU′ v
f1 × f2 = (Φ−1
1 × chKU
Uv
v

is supported in Gre (Fv ) and tr(πv′ (Φ1 )) 6= 0. Here we are using the fact that Θπv′ is a locally
constant function on the elliptic regular set of U σ (Fv ). By Proposition 4.8 the functions
′
′
satisfy the
match, and hence f1 × f2 and Φ := Φ−1
f1 × f2 and Φ := Φ−1
1 × chKU
1 × chKU
v
v
requirements of the lemma.

10.4. Proof of Theorem 10.3: Separating Hecke characters. In this subsection we
use our trace formula identity Proposition 9.2 together with an adaptation of the argument
of [JL, §3] (see also [Hak1, §13]) to reduce the proof of Theorem 10.3 to a nonvanishing
statement that will be proved in the following subsection. We assume the hypotheses of
Theorem 10.3.
By assumption, π has nonzero cohomology with coefficients in V . In view of Proposition
10.6 this implies that there is a representation V1 of UFσ∞ such that V ∼
= V1 ⊠ V1∨ . Let
K∞ ≤ G(F∞ ) (resp. KU ∞ ≤ U(F∞ )) be a maximal compact subgroup. We claim that we
can choose f∞ ∈ G(F∞ ) and Φ∞ ∈ Cc∞ (U(F∞ )) that match, are right K∞ and right KU ∞ finite, respectively, and satisfy the hypotheses (1-2) of Proposition 8.1 for the representations
V1 . To see this we recall that Lefschetz functions are finite under the left and right action
of the relevant maximal compact subgroup [BLS, Proposition 8.4]. Thus it follows from
σ
the Dixmier-Malliavin lemma [DM] that we can choose right-K∞
:= K∞ ∩ Gσ (F∞ )-finite
f1 , f2 ∈ Cc∞ (Gσ (F∞ )) such that f1−τ ∗ f2 = fL,ResM∞ /F∞ V1 ,τ . A similar argument with G(F∞ )
replaced by U(F∞ ) together with Proposition 8.1 implies our claim. We henceforth assume
Φ∞ and f∞ satisfying the conclusion of our claim.
Now let
Φ = Φ∞ ⊗ Φ∞ ∈ Cc∞ (U(AF ))
f = f∞ ⊗ f ∞ ∈ Cc∞ (G(AF ))

be factorable functions satisfying the hypotheses of Proposition 9.2. Such functions exist
by Lemma 4.5, Proposition 4.8, Theorem 5.1, Lemma 10.8 and Lemma 10.9. Thus by
Proposition 9.2 we have
X
X
RT (π ′ (Φ1 )) = 2
(10.4.1)
T RT (Π′ (f 1 )).
π′

Π′

Here the sum on the left is over equivalence classes of cuspidal automorphic representations of
1
U(AF ) = U(AF ) and the sum on the right is over equivalence classes of cuspidal automorphic
representations of 1 G(AF ). Let S be a finite set of places containing all infinite places and
all places where π is ramified. Choose compact open subgroups KUS ≤ U(ASF ), K S ≤ G(ASF )
such that KUS v and KvS are hyperspecial for all v 6∈ S and π S (resp. ΠS ) contains the

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

49

unit representation of KUS (resp. K S ). We assume that f S ∈ Cc∞ (G(ASF )//K S ) and ΦS ∈
Cc∞ (U(ASF )//K S ); then (10.4.1) implies the following identity:
X
X
tr(π ′ (ΦS ))RT (π ′ (Φ1S chKUS )) = 2
(10.4.2)
tr(Π′ (f S ))T RT (Π′(fS1 chK S ))
π′

Π′

(compare [JL, §3(2)]). The reason (10.4.1) simplifies to (10.4.2) is simply that if πv′ (resp.
Π′v ) is unramified then it contains a unique fixed vector under the hyperspecial subgroup
KU v (resp. Kv ).
We have the following lemma:
Lemma 10.10. Any Π′ contributing a nonzero summand to the right of (10.4.2) has nonzero
cohomology with coefficients in ResM∞ /F∞ V . Any π ′ contributing a nonzero summand to the
left of (10.4.2) has nonzero cohomology with coefficients in V .
∼ Gσ (F∞ ) × Gσ (F∞ ) equivariant with respect to τ
Proof. Choose an isomorphism G(F∞ ) =
and intertwining σ with (x, y) 7→ (y, x). Write Π′∞ = Π1 ⊗ Π2 for some representations Πi
of Gσ (F∞ ) using this isomorphism. For a fixed fS∞ ∈ Cc∞ (G(FS∞ )), consider the linear forms
ℓi : HΠ∞ −→ C


(Π1 (f1 ), Π2 (f2 )) 7−→ tr Π1 (f1−τ ∗ f2 ◦ τ )
X
(Π1 (f1 ), Π2 (f2 )) 7−→
PGσ (Π1 × Π2 ((f1 × f2 )1 )Π′ (fS∞ )φ)PGθ (φ).
φ∈B(Π′ )KS

They are both (Gσ (Fv ), Gθ (F∞ ))-invariant and hence equal up to a constant multiple (possibly zero) by Lemma 10.7. Thus the first assertion of the lemma follows from the defining
property of Lefschetz functions [BLS, Proposition 8.4] and Lemma 10.5. The proof of the

second assertion is similar; one uses Proposition 10.6 instead of Lemma 10.5.
By the lemma, the collection of Π′ on the right of (10.4.2) is finite in a sense independent
of f S ∈ Cc∞ (G(ASF )//K S ) for fixed fS by our assumption on f∞ . Indeed, the sum can be
thought of as being over automorphic representations contributing to the cohomology of
a locally symmetric space depending only on fS with coefficients in a fixed local system
depending only on f∞ by Lemma 10.10. Using the supply of matching f S and ΦS provided
by Corollary 4.6 and Corollary 4.9 we separate strings of Hecke eigenvalues “outside S” in
(10.4.2) to arrive at the following refined identity:
X
(10.4.3)
tr(π ′ (ΦS ))RT (π ′ (Φ1S chKUS )) = 2tr(Π(f S ))T RT (Π(fS1 chK S )).
π′
π ′S ∼
=π S

Here we are using Lemma 10.5 and strong multiplicity one for G(AF ) to isolate the contribution of Π on the right hand side. We are also using the fact that when ME/F , U, and
G are unramified at a finite place v then the base change map from irreducible admissible
unramified representations of U(Fv ) to irreducible admissible unramified representations of
G(Fv ) is injective [M, Corollary 4.2].

50

JAYCE R. GETZ AND ERIC WAMBACH

Let S(ME) be the set of finite places of F such that ME/F is ramified and both E/F
and M/F are nonsplit. We let S0 = ∞ ∪ {v1 , v2 } and S0 (ME) = S(ME) ∪ S0 . Enlarging
S if necessary, we assume that S0 (ME) ⊆ S. To complete the proof of the theorem, we
show that the left side of (10.4.3) is nonzero for some f ∈ Cc∞ (G(AF )) satisfying the various
conditions we have placed earlier. In view of Theorem 5.1, it suffices to show that upon
enlarging S if necessary we can choose fS∞ so that
T RT (Π(fS1 chK S )) 6= 0
where fS(M E) is supported on relatively τ -regular semisimple elements admitting norms, fv1
is F -supercuspidal and matches an F -supercuspidal Φv1 and fv2 is supported on relatively
τ -regular elliptic semisimple elements and matches a function Φv2 supported on relatively
regular elliptic semisimple elements. This is done in the following subsection.
10.5. Proof of Theorem 10.3: Nonvanishing. We assume all of the notation and conventions of the previous section and the hypotheses of Theorem 10.3. In particular, Π is
both Gσ and Gθ -distinguished. We prove the following proposition:
Proposition 10.11. With notation as in §10.4, upon possibly enlarging S we can choose a
function fS∞ ∈ Cc∞ (G(FS∞ )) so that
T RT (Π(fS1 chK S )) 6= 0
where K S ≤ G(ASF ) is a hyperspecial subgroup, fS(M E) is supported on relatively τ -regular
semisimple elements admitting norms, fv1 is F -supercuspidal and matches an F -supercuspidal
Φv1 , and fv2 is supported on relatively τ -regular elliptic semisimple elements and matches a
function Φv2 ∈ Cc∞ (U(Fv2 )) supported on relatively regular elliptic semisimple elements.
This proposition completes the proof of Theorem 10.3 as noted at the end of the previous
subsection.
Proof. We claim that we can choose a pure tensor φ0 ∈ VΠ such that the restriction of the
two forms
PGσ (·) : VΠ −→ C

and

PGθ (·) : VΠ −→ C

to φS0 ⊗ VΠ,S are nonzero. Indeed, by assumption, there are vectors φ1 , φ2 ∈ VΠ such
that PGσ (φ1 ) 6= 0 and PGθ (φ2 ) 6= 0. If either PGσ (φ2 ) 6= 0 or PGθ (φ1 ) 6= 0 then we are
done, otherwise PGσ (φ1 + φ2 )PGθ (φ1 + φ2 ) 6= 0. Thus there is a vector φ0 ∈ VΠ such that
PGσ (φ0 )PGθ (φ0 ) 6= 0. We may assume that φ0 is a pure tensor, which implies the claim.
S (M E)
S (M E)
Enlarging S if necessary, we choose a function fS 0
∈ Cc∞ (G(FS 0
)) such that
S0 (M E)
S0 (M E)
Π(fS
) is the orthogonal projection onto φS
; this is possible by the Jacobson density
theorem and the matching statements Lemma 4.5 and Proposition 4.8.

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

51

With this choice, for an orthonormal basis B(Π) of the Π-isotypic subspace of L20 (G(F )\1G(AF ))
we have
(10.5.1)
X
X
S (M E)
S (M E)
⊗ Π′ (fS10 (M E) )ai )PGθ (φ0 0
PGσ (φ0 0
⊗ ai )
PGσ (Π′ (f 1 )φ)PGθ (φ) = tr(Π(f S ))
ai

φ∈B(Π)K S

where the sum is over an orthonormal basis B(Π) of VΠS0 (M E) with respect to the Hermitian
pairing
( , ) : VΠS0 (M E) × VΠS0 (M E) −→ C
given by
(ψ1 , ψ2 ) 7−→

Z

G(F )\1 G(A

F)

φ0 (g S0(M E) ) ⊗ ψ1 (gS0 (M E) )φ0 (g S0(M E) ) ⊗ ψ2 (gS0 (M E) )dgdg,

where dg is the Tamagawa measure. Note that only finitely many of the ai terms will have
a nonzero contribution to (10.5.1).
For the moment let fS0 be chosen so that ΠS0 (fS0 ) is the projection to the space spanned
by φ0S0 . Consider the linear functional
Θ : Cc∞ (G(FS(M E) )) −→ C
X
fS(M E) 7−→
PGσ (φS0 0 ⊗ Π(fS10 (M E) )ai )PGθ (φS0 0 ⊗ ai ).

(10.5.2)

ai

For each v ∈ S(ME) this defines a spherical matrix coefficient of Πv in the sense of §6.
It is nonzero because we can choose fS(M E) ∈ Cc∞ (G(FS(M E) )) such that Π(fS(M E) ) is the
projection onto the space spanned by φ0S(M E) . By assumption, Πv is relatively τ -regular for
v ∈ S(ME), so we can and do choose fS(M E) ∈ Cc∞ (G(FS(M E) )) that is supported in the set of
τ -regular semisimple elements in G(FS(M E) ) that admit norms and such that Θ(fS(M E) ) 6= 0.
This fS(M E) admits a matching function ΦS(M E) ∈ Cc∞ (H(FS(M E) )) by Theorem 5.1 above.
We are left with choosing fS0 . Fix an isomorphism
G(FS0 )−→G
˜ σ (FS0 ) × Gσ (FS0 )

(10.5.3)

intertwining σ with (x, y) 7→ (y, x) and τ with (x, y) 7→ (xτ , y τ ). By Lemma 10.5 we can and
do factor
Π0S0 ∼
= Π1S0 ⊗ Π∨1S0
with respect to (10.5.3) for some irreducible admissible representation Π1S0 of Gσ (FS0 ). The
map
ℓ1 : HΠ0S0 −→ C
Y

−τ
tr Π1v (f1v ∗ f2v
)
Π1v (f1 ) ⊗ Π∨1v (f2 ) 7−→
v∈S0

σ

θ

is (G (FS0 ), G (FS0 ))-invariant in the sense of §10.3, and clearly not identically zero.

52

JAYCE R. GETZ AND ERIC WAMBACH

Notice the linear functional
ℓ2 : HΠS0 −→ C
X
Π(fS0 ) 7−→
PGσ (φS0 0 ⊗ Π(fS10 (EF ) )ai )PGθ (φS0 0 ⊗ ai )
ai

is also (Gσ (FS0 ), Gθ (FS0 ))-invariant. By Lemma 10.7 we have that
ℓ2 = cℓ1
for some constant c ∈ C. By our choice of fS(M E) above the linear functional ℓ2 is not
identically zero and hence we have that c 6= 0.
Choosing a factorable function
fS∞0 = f1 × f2 ∈ Cc∞ (Gσ × Gσ (FS∞0 )),
we have
(10.5.4)





Y

−τ
ℓ2 (fS0 ) = c tr(Π1∞ (fL,ResM∞ /F∞ V1 ,τ ◦ τ )) 
tr Π1v (f1v ∗ f2v
◦ τ) 
v∈S0 \∞

with V1 as in §10.4. We now show that we can choose a test function f = f1 × f2 satisfying
the conditions at ∞, v1 , and v2 stipulated in the statement of the proposition such that
(10.5.4) is nonzero; this will complete the proof of the proposition.
We work place by place. The factor corresponding to the infinite places is nonzero by [La2,

Lemme 4.2]. Lemma 10.8 takes care of v = v1 , and Lemma 10.9 takes care of v = v2 .
Acknowledgments
The first named author appreciates the time Erez Lapid spent pointing out serious mistakes
in an earlier version of this work and for thoughtful comments as the new version emerged.
He would like to thank Chris Skinner for support throughout this project, and Hervé Jacquet,
David Whitehouse, and Sophie Morel for useful conversations. He also thanks Heekyoung
Hahn for help with editing. The second author thanks Dinakar Ramakrishnan, Elena Mantovan, Kimball Martin and David Whitehouse for helpful conversations and advice. Both
authors thank the referees for thorough readings of the paper and their suggestions and
corrections, some of which were incorporated.
References
[A] T. Asai, On certain Dirichlet series associated with Hilbert modular forms and Rankin’s method, Math.
Ann. 226 (1977) 81-94. 3
[Ar1] J. Arthur, A trace formula for reductive groups I: terms associated to classes in G(Q), 45 No. 4, (1978)
911-952. 41
[Ar2] J. Arthur, An introduction to the trace formula, in The Trace Formula and Shimura Varieties,
Clay Math. Proc. 4 2005. 6

RELATIVE TRACE FORMULAE AND UNITARY GROUPS

53

[AGR] A. Ash, D. Ginzburg, and S. Rallis, Vanishing periods of cusp forms over modular symbols, Math.
Ann. 296 (1993) 709-723. 3, 41
[Ba] A. I. Badulescu, Global Jacquet-Langlands correspondence, multiplicity one and classification of automorphic representations, Invent. Math. 172 No. 2, (2008) 383-438. 43
[B] A. Borel, Linear Algebraic Groups, Springer, 1991. 12
[BLS] A. Borel, J-P. Labesse, J. Schwermer, On the cuspidal cohomology of S-arithmetic subgroups of reductive groups over number fields, Compositio Math. 102 No. 1 (1996) 1-40. 40, 48, 49
[Bo1] M. Borovoi, The Hasse principle for homogeneous spaces, J. reine angew. Math. 426 (1992) 179-192.
15, 16
[Ch] V. I. Chernousov, The Hasse principal for groups of type E8, Soviet Math. Dokl. 39 (1989) 592-596.
37, 38
[CL] L. Clozel and J-P. Labesse, Changement de base pour les représentations cohomologiques de certains
groupes unitaires, in Cohomologie, stabilisation et changement de base, Astérisque 257 1999. 40
[DM] J. Dixmier and P. Malliavin, Factorisations de fonctions et de vecteurs indéfiniment différentiables,
Bull. Sci. Math. 102 (1978) 305-330. 48
[Fl1] Y. Flicker, Twisted tensors and Euler products, Bull. Soc. Math. France 116 (1988) 295-313. 45
[Fl2] Y. Flicker, On distinguished representations, Journal für die reine und ang. math. 418 (1991) 139-172.
1, 3, 4, 44
[Fl3] Y. Flicker, Relative trace formula and simple algebras, Proc. AMS, 99 No. 3 (1987) 421-426. 11
[Fl4] Y. Flicker, Stable bi-period summation formula and transfer factors, Canadian Journal of Mathematics
51 (1999) 771-791. 32
[FlZ] Y. Flicker and D. Zinoviev, On poles of twisted tensor L-functions, Proceedings of the Japan Academy
71 (1995) 114-116. 4, 45
[H] H. Hahn, A simple twisted relative trace formula, IMRN (2009) 3957-3978. 5, 7, 11, 17, 32, 34, 38, 41
[Hak1] J. Hakim, Character relations for distinguished representations, AJM, 116 No. 5 (1994) 1153-1202.
48
[Hak2] J. Hakim, Supercuspidal Gelfand Pairs, Journal of Number Theory, 100 (2003) 251269. 24, 31
[HLR] H. Harder, R. Langlands, and M. Rapoport, Algebraische Zyklen auf Hilbert-Blumenthal-Flächen,
Jour. für die reine und ang. Math. 366 (1986). 1, 3, 4
[HL] M. Harris and J-P. Labesse, Conditional base change for unitary groups, Asian J. Math. 8 No. 4 (2004)
653-684. 5, 22, 40, 41, 43, 45, 47
[He] A. H. Helminck, Tori invariant under an involutorial automorphism I, Adv. in Math. 85 (1991), 1-38.
24, 25
[HW] A. H. Helminck and S. P. Wang, Rationality properties of involutions of reductive groups, Adv. in
Math. 99 (1993) 26-97. 10
[J1] H. Jacquet, Kloosterman identities over a quadratic extension II, Ann. Scient. Éc. Norm. Sup., 4e série,
t. 38, (2005) 609-669. 1, 4, 44, 45
[J2] H. Jacquet, Distinction by a quasi-split unitary group, Israeli Journal of Mathematics, 178 No. 1 (2010)
269-324. 4, 45
[JL] H. Jacquet and K. F. Lai, A relative trace formula, Compositio Math. 54 No. 2 (1985) 243-310. 1, 7,
11, 48, 49
[JLR] H. Jacquet, K. F. Lai, and S. Rallis, A trace formula for symmetric spaces, Duke Math. J. 70 No. 2
(1993) 305-372. 7
[JPSS] H. Jacquet, I. Piatetskii-Shapiro, and J. Shalika, Rankin-Selberg convolutions, AJM 105 (1983) 367464. 45

54

JAYCE R. GETZ AND ERIC WAMBACH

[K1] R. E. Kottwitz, Rational conjugacy classes in reductive groups, Duke Math. J. 49 No. 4 (1982) 785-806.
5, 11, 12, 13, 14, 16
[K2] R. E. Kottwitz, Sign changes in harmonic analysis on reductive groups, Trans. AMS 278 (1983) 289-297.
17
[K3] R. E. Kottwitz, Stable trace formula: cuspidal tempered terms, Duke 51 No. 3 (1984) 611-650. 5, 35
[K4] R. E. Kottwitz, Stable trace formula: elliptic singular terms, Math. Ann. 275 (1986) 365-399. 5, 18,
34, 35
[K5] R. E. Kottwitz, Tamagawa numbers, Ann. of Math. 127 No. 3 (1988) 629-646. 5, 18, 37, 38
[KS] R. E. Kottwitz and D. Shelstad, Foundations of twisted endoscopy, Asterisque 255 1999. 7
[La1] J-P. Labesse, Cohomologie, stabilisation et changement de base, Astérisque 257 1999. 7, 13,
18, 19, 22, 23, 24, 25, 28, 32, 34, 35, 40
[La2] J-P. Labesse, Changement de base CM et séries discrètes, in On the stabilization of the Trace
Formula, International Press of Boston, 2011. 40, 52
[L1] R. Langlands, Base change for GL(2), Ann. of Math. Studies, 96 (1980). 7
[L2] R. Langlands, Les débuts d’une formule des traces stable, Publ. Math. Univ. Paris VII, Vol 13,
Paris (1983). 7, 35
[M] A. Minguez, Unramified representations of unitary groups, in On the Stabilization of the Trace
Formula, International Press of Boston 2011. 49
[P] D. Prasad, On a conjecture of Jacquet about distinguished representations of GL(n), Duke Math. J. 109
No. 1 (2001). 44
[RR] C. Rader and S. Rallis, Spherical characters on p-adic symmetric spaces, AJM 118 (1996) 91-178. 24,
26, 27, 28, 32
[R] D. Ramakrishnan, Algebraic cycles on Hilbert modular fourfolds and poles of L-functions, in Algebraic
groups and arithmetic, Tata Inst. Fund. Res., Mumbai, (2004) 221-274. 4, 45
[Ri] R. W. Richardson, Orbits, invariants and representations associated to involutions of reductive groups,
Invent. Math. 66 (1982) 287-312. 10, 14, 20, 24
[Ro1] J. D. Rogawski, Representations of GL(n) and division algebas over a p-adic field, Duke
Math. J. 50 (1983) 161-196. 47
[Ro2] J. D. Rogawski, Automorphic Representations of Unitary Hroups in Three Variables, Ann.
of Math. Studies 123, 1990. 15
[Sa] J.-J. Sansuc, Groupe de Brauer et arithmètique des groupes algébriques linéaires sur une corps de nombres, J. Reine Angew. Math. 327 (1981) 12-80. 16
[S1] J-P. Serre, Local Fields Springer HTM 67 1979. 12
[S2] J-P. Serre, Galois Cohomology Springer 2002.
[Sh] F. Shahidi, On the Ramanujan conjecture and finiteness of poles for certain L-functions,
Ann. of Math. (2) 127 (1989) no. 2, 265-280. 45
[St1] R. Steinberg, Endomorphisms of linear algebraic groups, Memoirs of the AMS 80, AMS 1968.
9, 11, 12

Index of Notation
A, 36
AG , 8
AσG , 36
AθG , 36
AσH , 36
Bσ , 10
Bθ , 10
m
, 16
Cx,H
τ
Cγ,G
,8
D, 18
G, 9
Gσ , 9
Gθ , 9
Gδ , 10
H, 9
Hσ, 9
Hγ , 10
Kf , 37
KΦ , 37
KΠ(f 1 ) (x, y), 41
Q, 10
ROγκH (Φ), 34
ROγκHv (Φv ), 19
ROγ (Φ), 17, 33
RTe (Φ), 37
S, 10
SROγ0 (Φ), 33
SROγ0 (f ), 17
ST ROδ0 (f ), 17, 33
T ROδκv (fv ), 19
T ROδκ (f ), 34
T ROδ (f ), 17, 33
T RT (Π(f 1)), 41
T RTe (f ), 37
Tγ , 24
U σ , 39
Γr , 11
Γss
r , 12
Γrτ , 11
Γss
rτ , 12
Λ, 31
Φ1 , 37
ΘΛ , 31

B(Π), 41
D(I, H; k), 13
PGσ (φ), 3
E(I, H; Fv ), 34
E(I, H; AF /F ), 34
K(I, H; F ), 33
K(I, H; F )0 , 35
K(I, H; F )1 , 35
K(I, H; Fv ), 18
K(I, H; Fv )1 , 34
Ob(H, X), 16
σ, 9
θ, 9
e 36
A,
Teδ , 24
2 σ
G (AF ), 36
2 θ
G (AF ), 36
2
Gδ (AF ), 36
2 σ
H (AF ), 36
2
Hγ (AF ), 36
1
G(AF ), 8
a(γ), 38
aτ (δ), 38
b, 21, 23
d(I, H), 35
f 1 , 37

55

56

JAYCE R. GETZ AND ERIC WAMBACH

Department of Mathematics, Duke University, Durham, NC 27708-0320
E-mail address: jgetz@math.duke.edu
Department of Mathematics, California Institute of Technology, Pasadena, CA 91125
E-mail address: wambach@its.caltech.edu

