UNIMODULAR BINARY HIERARCHICAL MODELS

arXiv:1502.06131v2 [math.CO] 18 Feb 2016

DANIEL IRVING BERNSTEIN AND SETH SULLIVANT
Abstract. Associated to each simplicial complex is a binary hierarchical model. We
classify the simplicial complexes that yield unimodular binary hierarchical models. Our
main theorem provides both a construction of all unimodular binary hierarchical models,
together with a characterization in terms of excluded minors, where our definition of a
minor allows the taking of links and induced complexes. A key tool in the proof is
the lemma that the class of unimodular binary hierarchical models is closed under the
Alexander duality operation on simplicial complexes.

1. Introduction
Associated to a simplicial complex C with ground set [m] and an integer vector d ∈ Zm
is an integral matrix AC,d . The hierarchical model associated to C, d is a log-linear model
(i.e. discrete exponential family) whose design matrix is the matrix AC,d. The Zariski
closure of a hierarchical model is a (not necessarily normal) toric variety. As for all loglinear models, important relevant problems are to study properties of the lattice kerZ AC,d,
the polyhedral cone R≥0 AC,d := {AC,dx : x ≥ 0} and the semigroup NAC,d := {AC,dx :
x ≥ 0, x integral }. For example, Markov bases of the lattice kerZ AC,d can be used for
goodness-of-fit tests of the log-linear model associated to AC,d (see [5]). In the special
case where d = 2 the vector of all twos, we call AC,2 a binary hierarchical model.
There are a number of “niceness” properties that an integral matrix A ∈ Zd×n could
satisfy. Perhaps the strongest is unimodularity.
Definition 1.1. The following are equivalent definitions for an integral matrix A to be
unimodular.
(1) The polyhedron PA,b = {x ∈ Rs : Ax = b, x ≥ 0} has all integral vertices for every
b ∈ NA.
(2) Suppose rankA = d. Then there exists a λ such that the determinants of all d × d
submatrices of A are 0 or ±λ.
(3) The entries in each circuit of A are either 0 or ±1.
(4) The Graver basis of A consists of elements whose entries are either 0 or ±1.
We elaborate on this definition in Section 2. A weaker property for the matrix A to
satisfy is normality.
Definition 1.2. A matrix A is normal if the semigroup NA is saturated, that is NA =
ZA ∩ R≥0 A.
In fact, every unimodular matrix A is normal. In previous work of Rauh and the
second author [11], normality was identified as a key property of hierarchical models to
1

2

DANIEL IRVING BERNSTEIN AND SETH SULLIVANT

be able to apply the toric fiber product construction to calculate a Markov basis. If
AC,d is unimodular, it is also easy to solve the integer programs that arise in sequential
importance sampling [4]. It is a major open problem to classify the normal hierarchical
models. The special case where the underlying simplicial complex C is a graph, and where
d = 2 was handled in [16] where it was shown that a binary graph model is normal if and
only if the graph is free of K4 minors.
Our goal in the present paper is to classify the unimodular binary hierarchical models.
In fact, this result is also an important first step in the classification of normal binary
hierarchical models because a matrix Λ(A) of Lawrence-type is normal if and only if
unimodular (this follows from [10] Corollary 16 in light of the circuit definition of unimodularity). So this provides a characterization of the normal binary hierarchical models
that have a big facet (see Definition 3.14 and remarks that follow).
Our main result is a complete structural characterization of the unimodular binary
hierarchical models. On the one hand, we show that every unimodular binary hierarchical
model can be built up from three basic families, together with three operations. As part
of that proof we also give an excluded minor characterization of the unimodular binary
hierarchical models. Here our notion of minor of a simplicial complex is one that is
obtained by taking a sequence of vertex deletions or links of vertices. We caution the
reader that our notion of simplicial complex minor does not directly generalize the notion
of a graph minor, but it does generalize the notion of a matroid minor. Our excluded minor
characterization involves an infinite number of minimally nonunimodular complexes.
Our characterization of unimodular binary hierarchical models can be seen in analogy
with the classic characterizations of regular matroids/totally unimodular matrices, which
have both excluded minor characterizations and constructive characterizations. While
there is clearly a close connection between our problem and the study of totally unimodular matrices, our methods do not make use of Seymour’s [13] nor Tutte’s [17] classification
of regular matroids. There are two reasons for this. The first is that the set of matroids
underlying the design matrices of hierarchical models is not closed under the operations
of direct sum, two sum, three sum, deletion, nor contraction. The second is that normality, unlike (total) unimodularity, is not a matroidal property and we are interested in
extending our methods to the normal classification problem [2].
The outline of this paper is as follows. In the next section, we provide a detailed introduction to hierarchical models and the construction and interpretation of the matrix
AC,d. Section 3 details basic examples of unimodular complexes and constructions of new
unimodular complexes from old ones. A main result here is Proposition 3.7 which shows
that Alexander duality preserves unimodularity. Section 4 gives the list of minimal nonunimodular binary hierarchical models. There are one infinite family and six sporadic
minimal non-unimodular complexes. The section also provides a number of structural
results on simplicial complexes that avoid this list of simplicial complexes. Section 5
provides the combinatorial description of the 1-skeleton of a simplicial complex that supports a unimodular binary hierarchical model. That result is used as a stepping stone in
a complex induction in Section 6 which gives the proof of the main theorem, Theorem

UNIMODULAR BINARY HIERARCHICAL MODELS

3

6.3. In Section 7 we explain how our characterization in the binary case can be used to
make headway in the non-binary case.
2. Preliminaries on Hierarchical Models and Unimodularity
In this section we explain how to construct the matrix AC,d associated to a hierarchical
model. We then define some terms from Definition 1.1 of a unimodular matrix and prove
the equivalence between the four parts.
Definition 2.1. Let d = (d1 , . . . , dn ) ∈ Zn be such that di ≥ 2 for each i. Then we define
Rd to be the vector space of all d1 × · · · × dn -way tables. That is, each u ∈ Rd is a table
in n dimensions where the ith dimension has di levels. We denote entries in a table u
by ui1 ,...,in where (i1 , . . . , in ) ∈ [d1 ] × · · · × [dn ]. We will use the shorthand i to denote
i1 , . . . , in .
Definition 2.2. Let C be a simplicial complex on ground set [n]. A facet of C is an
inclusion-maximal subset F ⊆ [n] that is contained in C. We let facet(C) denote the
collection of facets of C.
Definition 2.3. Let d = (d1 , . . . , dn ) ∈ Zn and F = {f1 , . . . , fk } ⊆ [n]. We define dF to
be the restriction of d to the indices in F , i.e. dF = (df1 , . . . , dfk ).
Definition 2.4. Let C be a simplicial complex on ground set [n] and let d = (d1 , . . . , dn ) ∈
Zn be such that di ≥ 2 for each i. Then we have the linear map
M
πC,d : Rd →
RdF
F ∈facet(C)

defined by

M

(ui1 ,...,in : ij ∈ [dj ]) 7→

F ∈facet(C)
F ={f1 ,...,fk }








X

i∈[d1 ]×···×[dn ]:
iF =j


ui1 ,...,in : j ∈ [df1 ] × · · · × [dfk ]
.

The matrix AC,d denotes the matrix in the standard basis that represents the linear
transformation πC,d .
We give an example of this construction.
Example 2.5. Let C be the simplicial complex on ground set [3] = {1, 2, 3} with facet(C) =
{{1}, {2, 3}}. The linear transformation πC,d maps a three-way tensor u = (uijk : i ∈
[d1 ], j ∈ [d2 ], k ∈ [d3 ]) ∈ RD to the direct sum of a one-way tensor and a two-way tensor:
X
X
uijk : i ∈ [d1 ]) ⊕ (
uijk : j ∈ [d2 ], k ∈ [d3 ]).
πC,d (u) = (
j,k

i

4

DANIEL IRVING BERNSTEIN AND SETH SULLIVANT

Taking d = 2, the matrix AC,2 could

1 1
0 0

1 0

0 1

0 0
0 0

be represented as follows:

1 1 0 0 0 0
0 0 1 1 1 1

0 0 1 0 0 0
,
0 0 0 1 0 0

1 0 0 0 1 0
0 1 0 0 0 1

the horizontal line dividing the image space into the parts corresponding to the two facets
of C.
It can be useful to be precise about how to write down
Q the matrix AC,d. The columns
of the matrix AC,d are indexed by elements of the set j∈[n] [dj ] and the rows are indexed
Q
by pairs (F, e) where F ∈ facet(C) and e ∈ j∈F [dj ]. The entry in position with row
Q
index (F, e) and column indexed by i ∈ j∈[n] [dj ] is 1 if e = (ij : j ∈ F ), otherwise it is
equal to 0.
The binary case studied in this paper concerns the situation where all table dimensions
are of size 2, that is d = 2 = (2, 2, . . . , 2); the vector of all twos. In this case, we will
usually abbreviate notation as stated in the following definition.
Definition 2.6. Let C be a simplicial complex on [n]. We define AC := AC,2 . We say
that C is unimodular if AC is unimodular as a matrix.
We now elaborate on Definition 1.1. To start, we give two definitions.
Definition 2.7. Let A be an integer matrix. A nonzero element u ∈ kerZ A is called a
circuit if its nonzero entries are relatively prime and there is no other nonzero element
v ∈ kerZ A such that supp(v) ⊂ supp(u). Here, supp(v) denotes the set of positions of
nonzero elements of v.
Definition 2.8. Let A be an integer matrix. A nonzero element u ∈ kerZ A is called
primitive if there is no nonzero v ∈ kerZ A, v 6= u such that ui vi ≥ 0 for all i, and
|vi | ≤ |ui | for all i. The set of all primitive vectors in kerZ A is called the Graver basis of
A.
Now we explain the equivalence between the four items in Definition 1.1. See [12],
Theorem 19.2 for the equivalence of (1) and (2). We can see that condition (3) of Definition
1.1 is equivalent to condition (2) because the circuits can be computed via a determinantal
formula using Cramer’s rule [14, p. 35]. Given the equivalence of (2) and (3), (3) and (4)
are equivalent by [14], Propositions 4.11 and 8.11.
Questions about unimodularity of a matrix A are invariant under certain changes to
the matrix. The following proposition gives three that we make tacit use of throughout
the rest of the paper.
Proposition 2.9. Let A be a unimodular integer matrix. Then the following are also
unimodular matrices.
(1) A matrix obtained by reordering the columns of A

UNIMODULAR BINARY HIERARCHICAL MODELS

5

(2) A matrix obtained by multiplying a column of A by −1
(3) Any matrix that has the same rowspace as A
(4) Any matrix formed by a subset of columns of A.
Proof. Unimodularity of (1) and (3) are clear when considering (3) or (4) in Definition
1.1. Unimodularity of (2) is clear when considering (2) in Definition 1.1. If A′ is a matrix
obtained by extracting a set of columns of A then the circuits of A′ are obtained by
taking those circuits of A whose nonzero elements correspond to the columns of A we are
extracting, and so (4) holds.

3. Constructions of Unimodular Complexes
In this section we describe some operations on simplicial complexes that preserve unimodularity. In particular we show that unimodularity is preserved when passing to induced subcomplexes, to the Alexander dual of a simplicial complex, and to the link of a
face of a simplicial complex. We can also build new unimodular complexes from old ones
by adding cone vertices, ghost vertices, or taking a Lawrence lifting. We also construct the
basic examples of unimodular complexes. These tools together go in to our constructive
description of unimodular complexes.
Proposition 3.1. All induced sub-complexes of a unimodular complex are unimodular.
Proof. Let C ′ be the induced subcomplex of C obtained by restricting to some vertex set
F ⊆ [n]. Let B be the matrix
Q obtained by taking the columns of AC corresponding to the
elements i = (i1 , . . . , in ) ∈ j∈[n][dj ] such that ij = 1 for all j ∈ [n] \ F . Let B ′ be the
matrix obtained from B by removing rows of all zeros. Then B ′ = AC ′ . So AC ′ and B
have the same Graver basis, which is a subset of the Graver basis of AC . So unimodularity

of AC implies unimodularity of AC ′ .
Next we will show that unimodularity is preserved under the Alexander duality operation.
Definition 3.2. Let C be a simplicial complex on [n]. The Alexander dual of C, denoted
C ∗ is defined as:
C ∗ = {S ⊆ [n] : [n] \ S ∈
/ C}.
Note that if C has d faces, then C ∗ has 2n − d faces and that the facets of C ∗ are the
complements of the minimal non-faces of C.
Since we are now restricting attention to the binary case, where di = 2 for each i ∈ [n],
entries
of vectors in Rd are indexed by elements of {1, 2}n and entries of vectors in
L
dF
are indexed by pairs (S, j) where S ∈ facet(C) and j ∈ {1, 2}S . However,
f ∈facet(C) R
the statement and proof of Proposition 3.6 become cleaner if we replace {1, 2}n and {1, 2}S
by {0, 1}n and {0, 1}S , respectively. So we adapt this convention for the remainder of this
section. We now introduce some notation that we use in Propositions 3.4 and 3.6.
Definition 3.3. Let S ⊆ [n] and j ∈ {0, 1}S and i ∈ {0, 1}[n]\S . Then ei,j denotes the
n
element v ∈ R{0,1} such that vk = 1 if kt = jt when t ∈ S and kt = it when t ∈ [n] \ S,
and vk = 0 otherwise.

6

DANIEL IRVING BERNSTEIN AND SETH SULLIVANT

We are now ready to give an explicit description of AC ∗ .
Proposition 3.4. Let C be a simplicial complex on [n]. Let M be a matrix with the
following set of columns:


 X

ei,j : S is a minimal non-face of C, i ∈ {0, 1}[n]\S .


S
j∈{0,1}

Then AC ∗ = M T .

Proof. We index the columns of M by pairs (S, i) where S is a minimal non-face of C,
and i ∈ {0, 1}[n]\S . The rows of M are indexed by elements of {0, 1}n . By construction,
M(k, (S, i)) = 1 if and only if k|[n]\S = i. Similarly, when F is a facet of C ∗ , AC ∗ ((F, i), k) =
1 if and only k|F = i. The result follows since S is a minimal non-face of C if and only if
[n] \ S is a facet of C ∗ .

In order to relate the unimodularity of AC and AC ∗ , we need two propositions. The
first is a standard result from the theory of matroid duality, though we could not find a
precise reference.
Proposition 3.5. Let A ∈ Kr×n have rank r. Let B ∈ K(n−r)×n have rank n − r such
that AB T = 0. Then there exists a non-zero scalar λ ∈ K∗ such that for all S ⊆ [n] with
#S = r,
det(AS ) = ±λ det(B[n]\S ).
Proof. After multiplying by an element of GLr (K) and permuting columns, we can assume
A has the form A = (Ir M) where Ir is an r × r identity matrix. Then we can suppose
B has the form B = (−M T In−r ). Then any det(AS ) is a minor of M with row indices
[r] \ S and column indices S \ [r]. The determinant det(B[n]\S ) is the same minor of M,
up to a sign.

Proposition 3.6. Let C be a simplicial complex on [n]. Then the following set of vectors
spans ker(AC ):


 X

K=
(−1)kjk1 ei,j : S is a minimal non-face of C, i ∈ {0, 1}[n]\S .


S
j∈{0,1}

Furthermore, if we view the entries of K as the columns of a matrix M ′ , then we can
multiply some set of rows and columns of M ′ by −1 and get M, as defined in Proposition
3.4.

Proof. First, note that for any x ∈ K, AC x = 0, so K ⊂ ker(AC ). If we view the entries of
K as the columns of a matrix M ′ , we are done if we show that rank(M ′ ) = dim(ker(AC )).
We proceed by proving the second statement of the lemma. The first statement will follow
since Proposition 3.4 implies rank(M) = rank(AC ∗ ) and we know rank(AC ∗ ) = 2n − #C =
dim(ker(AC )) ([6, Thm 2.6]).
As before, we index the columns of M ′ by pairs (S, i) where S is a minimal non-face
′
of C, and we index the rows of M ′ by the binary n-tuples. Let M(S,i)
be a column of M ′ .

UNIMODULAR BINARY HIERARCHICAL MODELS

7

′
M(S,i),k

n

For any k ∈ {0, 1} , the entry
is nonzero if and only if k|[n]\S = i - i.e. for each
column, the k for each nonzero entry has fixed k|[n]\S = i. Now in this case, recall that
′
′
M(S,i),k
= +1 if kjk1 is even, and M(S,i),k
= −1 if kjk1 is odd. Therefore, when kik1 is
′
′
even, M(S,i),k = +1 if kkk1 is even and M(S,i),k = −1 when kkk1 is odd. And when kik1 is
′
′
odd, M(S,i),k
= +1 when kkk1 is odd and M(S,i),k
= −1 when kkk1 is even. So for a fixed
′
′
column M(S,i) , the sign of a nonzero entry M(S,i),k
depends only on the parity of k. So if
′
we multiply all the rows M·,k such that kkk1 is odd by −1, the entries in each column will
all have the same sign. Then we can multiply all the negative columns by −1, to arrive
at the matrix from Proposition 3.4.

Now we are ready to show that Alexander duality preserves unimodularity.
Proposition 3.7. Let C be a simplicial complex on ground set [n]. Then C is unimodular
if and only if C ∗ is unimodular.
Proof. Consider the set K from Proposition 3.6 as a matrix of column vectors. Since K
spans the kernel of AC , Proposition 3.5 implies that K T is unimodular if and only if AC
is unimodular. Then we can multiply the appropriate rows and columns of K by −1 to
get M as in Proposition 3.4. Since these operations preserve the absolute values of full
rank determinants, K T is unimodular if and only if M T is. Proposition 3.4 says that

AC ∗ = M T .
Taking Alexander duals and induced complexes gives rise to another unimodularity
preserving operation which we now define.
Definition 3.8. Let S ∈ C be a face of C. Then the link of S in C is the new simplicial
complex
linkS (C) = {F \ S : F ∈ C and S ⊆ F } .
When S = {v}, we simply write linkv (C) := link{v} (C).
Note that we can obtain linkS (C) by repeatedly taking links with respect to vertices.
That is if S is a face of C and #S ≥ 2 and v ∈ S, then
linkS (C) = linkv (linkS\{v} (C)).
Proposition 3.9. If C is a simplicial complex and S is a face of C, then linkS (C) =
(C ∗ \ S)∗ .
Proof. By definition, we have:
(C ∗ \ S)∗ = {R ⊆ [n] \ S : ([n] \ S) \ R ∈
/ C ∗ \ S} .
Then we have the following chain of equivalences on some R ⊆ [n] \ S:
([n] \ S) \ R ∈
/ C∗ \ S
⇐⇒ ([n] \ S) \ R ∈
/ C∗
⇐⇒ [n] \ (([n] \ S) \ R) ∈ C
and since [n] \ (([n] \ S) \ R) = R ∪ S, we have R ∪ S ∈ C.



8

DANIEL IRVING BERNSTEIN AND SETH SULLIVANT

Corollary 3.10. Let C be a unimodular simplicial complex on ground set [n]. Then for
any face S of C, linkS (C) is unimodular.
Proof. Proposition 3.9 implies that linkS (C) can be obtained via Alexander duality and
passing to an induced subcomplex. Unimodularity then follows from Propositions 3.1 and
3.7.

Now we turn to operations for taking a complex that is unimodular and constructing
larger unimodular complexes. If C has a vertex v that lies in each facet of C, we say that
v is a cone vertex of C. The following proposition tells us that unimodularity is invariant
under adding or removing a cone vertex.
Proposition 3.11. Let C be a simplicial complex on [n]. We define C ′ on [n + 1] to be
the simplicial complex with the following facets:
{F ∪ {n + 1} : F is a facet of C}.
Then AC is unimodular if and only if AC ′ is.
Proof. We will index the columns of AC ′ by the binary n + 1 tuples such that those with
the n + 1 coordinate equal to 1 come before those with n + 1 coordinate equal to 2. Then
we get the following block form:


AC 0
AC ′ =
.
0 AC
The Graver basis of AC ′ is therefore {(u, 0), (0, u) : u ∈ GrA }. Hence the Graver basis
of AC ′ consists of 0, ±1 elements if and only if the Graver basis of AC consists of 0, ±1
elements.

By induction, adding or removing multiple cone vertices from a simplicial complex does
not affect unimodularity. We introduce the following notation to denote this.
Definition 3.12. Let C be a simplicial complex on vertex set [n]. Then we define conep (C)
to be the simplicial complex on [n] ∪ {u1 , . . . , up } with the following facets
{F ∪ {u1, . . . , up } : F is a facet of C}.
When p = 0, we define conep (C) = C.
Definition 3.13. For any matrix A ∈ Rs×t , we define the Lawrence lifting of A to be the
matrix


A 0
Λ(A) =  0 A ∈ R(2s+t)×2t
1 1

where 0 denotes the s × t matrix of all zeroes and 1 denotes a t × t identity matrix.

By Theorem 7.1 in [14], Λ(A) is unimodular if and only if A is unimodular. This gives
rise to another unimodularity-preserving operation on simplicial complexes.

UNIMODULAR BINARY HIERARCHICAL MODELS

9

Definition 3.14. Let C be a simplicial complex on [n]. We define the Lawrence lifting of
C to be the simplicial complex Λ(C) on [n + 1] that has the following set of facets:
{[n]} ∪ {F ∪ {n + 1} : F is a facet of C}.
In this case, we refer to the facet [n] as a big facet.
If a complex C on [n + 1] has big facet [n], then C = Λ(linkn+1 (C)). In particular,
C = Λ(D) for some complex D if and only if C has a big facet.
Proposition 3.15. The simplicial complex C is unimodular if and only if Λ(C) is unimodular.
Proof. Note that by construction Λ(AC ) = AΛ(C) . Hence Theorem 7.1 in [14] implies the
proposition.

If a simplicial complex C can be expressed as Λ(C ′ ), then we say that C is of Lawrence
type. A simplicial complex on n vertices is of Lawrence type if and only if it has a facet
containing n − 1 vertices. We will refer to any facet of C that has n − 1 elements as a big
facet.
We now give our final unimodularity preserving operation.
Definition 3.16. Let C be a simplicial complex on ground set [n]. Let Gp (C) denote the
same simplicial complex but on ground set [n + p]. Note that the vertices n + 1, . . . , n + p
are not contained in any face of Gp (C). In this case we say that n + 1, . . . , n + p are ghost
vertices. When p = 1 we drop the superscript; i.e. we just write G(C).
Proposition 3.17. A simplicial complex C is unimodular if and only if Gp (C) is unimodular.
Proof. This is true because

AGp (C) = AC . . . AC .



Note that adding a ghost vertex to a complex is Alexander dual to taking the Lawrence
lifting of a simplicial complex, that is G(C)∗ = Λ(C ∗ ).
We now state a useful fact about the interaction of these operations.
Proposition 3.18. The operation conep (·) commutes with the operations of taking links,
duals, induced sub-complexes and adding ghost vertices.
For any vertex v of C, we let C \ v denote the induced subcomplex on C \ {v}. Then for
vertices v 6= u of C, the operations · \ v and linku (·) commute. So if D can be obtained
from C by applying a series of deletions, and taking links, then we can write
D = linkR (C \ S)
where F ∈ C and S, R are a subset of vertices of C such that S ∩ R = ∅. This gives rise
to the following definition:
Definition 3.19. Let C be a simplicial complex. Then D is a minor of C if D = linkR (C\S)
where and S, R are subsets of vertices of C such that S ∩ R = ∅, and R is a face of C.

10

DANIEL IRVING BERNSTEIN AND SETH SULLIVANT

We warn the reader that although it is natural to view simplicial complexes as a generalization of graphs, our definition of simplicial complex minor does not generalize the
usual notion of graph minor. Alternatively, a simplicial complex can be seen as a generalization of a matroid, and our definition of minor is a generalization of the usual notion of
a matroid minor [8]. This definition of simplicial complex minor is useful for our purposes
because of Proposition 3.20.
Proposition 3.20. If C is a unimodular simplicial complex, then every minor of C is
unimodular.
Proof. This follows immediately from Propositions 3.1 and 3.10.



The fundamental example of a unimodular simplicial complex is the disjoint union of
two simplices. Here a simplex ∆n is the simplicial complex on an n + 1 element set with a
single facet consisting of all the elements. We denote the irrelevant complex {∅} by ∆−1
and the void complex {} by ∆−2 .
Proposition 3.21. Let C = ∆m ⊔ ∆n be the disjoint union of two simplices, for m, n ≥ 0.
Then C is unimodular.
Proof. The matrix AC in this case is the vertex-edge incidence matrix of a complete
bipartite graph with 2m+1 and 2n+1 vertices in the two parts of the partition. Such
vertex-edge incidence matrices are examples of network matrices and are hence totally
unimodular [12, Ch. 19].

A second family of fundamental examples comes from taking the duals of the disjoint
union of two simplices. We use Dm,n to denote the dual of a disjoint union of an m-simplex
and an n-simplex, i.e.
Dm,n := (∆m ⊔ ∆n )∗ .
We close this section by giving a workable description of Dm,n . We can divide the vertices
∗
of Dm,n into disjoint sets M, N such that M contains the vertices of the ∆m in Dm,n
and
∗
N contains the vertices of the ∆n in Dm,n . Then, the facets of Dm,n are precisely the
subsets of M ⊔ N that leave out exactly one element of M and one element of N. Notice
that the complexes induced on M, N are ∂∆m and ∂∆n respectively. Also, note that for
any v ∈ M, linkv (Dm,n ) = Dm−1,n and for any v ∈ N, linkv (Dm,n ) = Dm,n−1 .
4. β-avoiding Simplicial Complexes
Part of our main result is a forbidden minor classification of unimodular simplicial
complexes. In this section, we identify these forbidden minors and prove various properties
about the complexes that avoid them.
Proposition 4.1. The following simplicial complexes are minimal nonunimodular simplicial complexes:
(1) P4 , the path on 4 vertices
(2) O6 , the boundary of the octahedron or its dual O6∗
(3) J1 , the complex on {1, 2, 3, 4, 5} with facets 12, 15, 234, 345 or its dual J1∗ , with
facets 134, 235, 245.

UNIMODULAR BINARY HIERARCHICAL MODELS

11

(4) J2 , complex on {1, 2, 3, 4, 5} with facets 12, 235, 34, 145
(5) For n ≥ 1, ∂∆n ⊔ {v}, the disjoint union of the boundary of an n-simplex and a
single vertex.

Figure 1. The complexes P4 , J1 , J1∗ , and J2 .
Note that P4 , J2 and ∂∆n ⊔ {v} are isomorphic to their own duals.
Proof. We can check that the complexes P4 , O6 , O6∗, J1 , J1∗ , and J2 are not unimodular by
using the software 4ti2 [1] to compute the Graver basis and looking for entries that are not
0, ±1 In the case of O6 and O6 ∗, these are too large to compute the entire Graver basis.
However, selecting sufficiently large random subsets of the columns produced Graver basis
elements of the desired form. Computations are available on our website [3]. For the
infinite family ∂∆n ⊔ {v} where n ≥ 1, examples of a non-squarefree Graver basis element
appear in [15]. These results show that these examples are not unimodular. To see that
they are minimal, note that every subcomplex obtained by deleting a single vertex or
taking the link at a vertex produced a unimodular complex in all cases.

Definition 4.2. A simplicial complex C is β-avoiding if it does not contain any of the
complexes from Proposition 4.1 as minors.
Since none of the complexes from Proposition 4.1 is unimodular, Proposition 3.20 implies that if C is unimodular, then C is β-avoiding. The converse of this is our forbidden
minor classification of unimodular complexes which we prove in Theorem 6.3.
We now give some technical results about β-avoiding complexes. Before beginning, we
remind the reader that ∂∆1 ⊔{v} is an independent set on 3 vertices, and so no β-avoiding
complex can have an independent set of size 3.
Proposition 4.3. Let C be a β-avoiding simplicial complex. Then C ∗ is also β-avoiding.
Proof. The list of prohibited minors of β-avoiding complexes is closed under taking duals.
The proposition follows when we note that if D is a minor of C, then D ∗ is a minor of C ∗ .
This is true because if D ∗ = linkS (C ∗ \ R), then two applications of Proposition 3.9 give
D ∗ = ((C ∗ \ R)∗ \ S)∗
= (linkR (C) \ S)∗
and therefore D = linkR (C) \ S. So D is a minor of C.



Proposition 4.4. Let C be a β-avoiding simplicial complex that has C4 induced. Then
the complex induced on the non-ghost vertices of C is conep (C4 ) for some p.

12

DANIEL IRVING BERNSTEIN AND SETH SULLIVANT

Proof. Assume C has no ghost vertices. Let u1 , . . . , u4 be the vertices that induce C4
in C. If these are the only vertices, we are done, so let v be another vertex in C. Let
D denote the complex induced on v, u1, . . . , u4 . Any minor of D is a minor of C, so D
must also be β-avoiding. Vertex v cannot be disconnected from u1 , . . . , u4 since otherwise
D has an independent set of size 3. Furthermore, v must connect to u1 , . . . , u4 with a
triangle. Otherwise if v connected to ui with an edge, then ui has edge degree 3 and so
linkv (D) is an independent set on 3 vertices. There are 4 possible triangles that v can
join with u1 , . . . , u4 in D so that u1 , . . . , u4 induce C4 . If v is only in one such triangle,
wlog {v, u1, u2 }, then {v, u1, u3 , u4 } is an induced P4 . The two non-isomorphic complexes
on 5 vertices that have two triangles and an induced C4 are J1 and J2 . If D has 3 of the
possible triangles, then linkv (D) is P4 . So D must have all four - i.e. it must be cone1 (C4 ).
Any vertices v, v ′ ∈
/ {u1 , u2 , u3, u4 } must connect to each other. Otherwise, the induced
complex on v, v ′, u1 , . . . , u4 is O6 which is not unimodular. Now we denote the vertices
of C that are not any of the ui s as v1 , . . . , vk . Since vk is a cone point over the C4
on u1 , . . . , u4 and since vk connects to all vj , j < k, linkvk (C) is a β-avoiding complex
on v1 , . . . , vk−1, u1 , . . . , u4 that has C4 induced on u1 , . . . , u4. So, by induction on the
number of vertices, linkvk (C) is an iterated cone over C4 , conek−1 (C4 ). But also the
induced complex on v1 , . . . , vk−1 , u1 , . . . , u4 is conek−1 (C4 ) by induction. This implies that
C = conek (C4 ).

Proposition 4.5. Let C be a β-avoiding complex that has Dm,n induced for some m, n ≥ 1.
Then the complex induced on the non-ghost vertices of C is conep (Dm,n ) for some p.
Proof. Assume C has no ghost vertices. Just as in the remarks at the end of section 3,
we divide the vertices of Dm,n into disjoint sets M, N such that M contains the vertices
∗
∗
of the ∆m in Dm,n
and N contains the vertices of the ∆n in Dm,n
. Now, we proceed by
induction on m and n. Note that D1,1 = C4 , so the base case is handled by Proposition
4.4. Assume that, without loss of generality, m ≥ 2.
Let v ∈ C \ Dm,n . The vertex v must connect to some u ∈ M to avoid inducing
∂∆m ⊔ {v}. Then, linku (C) contains v and Dm−1,n , and so by induction, the complex
induced on v and the vertices of Dm−1,n in linku (C) is a cone over Dm−1,n . This means
that v is in every facet that contains u. Since m ≥ 2, u is connected to every other vertex
in Dm,n and thus v is attached to every vertex in Dm,n . Now we apply the same argument
to each of the vertices in the set M to see that v is in every facet that contains any vertex
in set M. Every facet of Dm,n contains some element of M. So this implies that the
induced complex on v and Dm,n must be the cone over Dm,n .
Now assume v, v ′ are both vertices in C \ Dm,n . If they were not connected by an edge,
then the induced complex on v, v ′ and Dm,n contains a minor which is isomorphic to
O6 . This means that v, v ′ are connected by an edge. Taking the link linkv (C) produces a
smaller complex with an induced Dm,n hence it must be a cone by induction on the number
of vertices not in the Dm,n . This reduces us the case where linkv (C) is conep−1 (Dm,n ) and
C \ v is conep−1 (Dm,n ) which implies that C is conep (Dm,n ).


UNIMODULAR BINARY HIERARCHICAL MODELS

13

Proposition 4.6. Let C be a β-avoiding simplicial complex on vertices u1 , . . . , uk+1, v
such that the complex induced on {u1, . . . , uk+1} is ∂∆k . Then v must be in a k-simplex
with some subset of the ui ’s.
Proof. We proceed by induction on k. For the base case k = 1, note that ∂∆1 is two
isolated points. In this case, v must connect to u1 or u2 as a 1-simplex (an edge) to avoid
inducing ∂∆1 ⊔ {v}.
Now assume k > 1. The vertex v must attach to some ui to avoid inducing ∂∆k ⊔
{v}. Then, link(ui ) has v and ∂∆k−1 , so by induction, v must form a k − 1 simplex
with some collection u1 , . . . , ûi , . . . , uˆj , . . . , uk+1. So in C, v must be in a k simplex with
u1 , . . . , uˆj , . . . , uk+1.

Proposition 4.7. Let C be a β-avoiding simplicial complex on m + n + 2 vertices that
does not have a facet of dimension m + n. Assume Dm,n ⊆ C. Then C = Dm,n .
Proof. Note that C ∗ ⊆ ∆m ⊔ ∆n because Dm,n ⊆ C. Since C does not have a facet of
dimension m+n, C ∗ has no ghost vertices. Since C ∗ has no ghost vertices, if C ∗ ( ∆m ⊔∆n ,
then C ∗ would have an induced {v} ⊔ ∂∆k for some k ≥ 1. In this case C ∗ would not be
β-avoiding and so by Proposition 4.3, neither would C.

5. The 1-Skeleton of a β-avoiding Complex
In this section we prove Lemma 5.3 which gives a complete characterization of the 1skeleton of a β-avoiding simplicial complex. This is a crucial technical lemma in the proof
of Theorem 6.3. We start with a technical proposition about graphs.
Proposition 5.1. Let H be a connected graph that avoids K3 and P4 as induced subgraphs.
Then H is a complete bipartite graph.
Proof. Let u ∈ V (H), let N(u) denote the neighbors of u, and let M(u) denote the nonneighbors of u (this set includes u). The bipartition of the vertices of H will be M(u) and
N(u). Let v ∈ M(u)\{u}. Since H is connected, there exists a path u = u1 , u2 , . . . , uk = v.
Assume k is minimal. Since v 6= u, k > 1. We cannot have k = 2 since u, v are nonneighbors. We cannot have k = 4, since in order to avoid an induced P4 , we would need an
edge (ui , ui+2 ) inducing a K3 , or an edge (u, v) contradicting that u, v are non-neighbors.
If k ≥ 5, there must exist an edge (u1 , u4 ) to avoid an induced P4 , contradicting minimality
of k. So we have k = 3. So for any v ∈ M(u) \ {u}, there exists a path u, a, v.
Now we show that H is bipartite with bipartition M(u) and N(u). It is clear that
N(u) is an independent set of vertices, for if v, w ∈ N(u) had an edge between them,
there would be a K3 on u, v, w. Now we show that M(u) is an independent set of vertices.
Assume w, v ∈ M(u). If either w, v is u, there is no edge between them by definition of
M(u), so assume w, v 6= u. Then by the above, we have paths u, a, v and u, b, w. So
an edge (v, w) would induce the 5-cycle u, a, v, w, b, u. This 5-cycle must have a chord to
avoid inducing P4 , but any chord in a 5-cycle induces a K3 .
Now we show that H is complete bipartite. Let x ∈ M(u) and y ∈ N(u). Since H is
connected, there is a path x = u1 , ..., uk = y. We may without loss of generality assume
k ≤ 3 since otherwise we could shorten the path using the edge (u1 , u4 ) required to avoid

14

DANIEL IRVING BERNSTEIN AND SETH SULLIVANT

a P4 . The sets M(u) and N(u) are disjoint, so k 6= 1. If k = 3, then there is an induced
P4 x, u2 , y, u. So k = 2, and so (x, y) is an edge.

For a graph G we define the complement graph Gc on the same set of vertices such that
(u, v) is an edge of Gc if and only if (u, v) is not an edge in G. Now we can use Proposition
5.1 to give a strong restriction on the structure of Gc whenever G is the 1-skeleton of a
β-avoiding complex.
Proposition 5.2. If G is the 1-skeleton of a β-avoiding simplicial complex C, then each
connected component of Gc is complete bipartite.
Proof. Note that {v} ⊔ ∂∆1 consists of three disconnected vertices, its complement graph
is K3 . The path P4 is its own complement. Since C is β-avoiding, G avoids P4 and an
independent set of size three as induced subgraphs. So each connected component of
Gc avoids P4 and K3 as induced subgraphs. Proposition 5.1 therefore implies that each
connected component of Gc is complete bipartite.

Now we are ready to characterize the 1-skeleton of a β-avoiding simplicial complex.
Lemma 5.3. Let C be a β-avoiding simplicial complex and let G denote its 1-skeleton.
Then G is one of the following
(a) KN
(b) Two complete graphs glued along a (possibly empty) common clique
(c) The iterated cone over a 4-cycle.
Proof. By Proposition 5.2, we know that each connected component of Gc is complete
bipartite. Let H denote the induced subgraph of Gc that removes all isolated vertices. If
H is empty, then Gc is an independent set of vertices and therefore G = KN . So assume
H is nonempty. We claim that if H is neither Km,n nor K2 ⊔ K2 for m, n ≥ 1, then H
induces either K2 ⊔ K2 ⊔ K2 or P3 ⊔ K2 . To prove the claim, first assume that H avoids
K2 ⊔ K2 ⊔ K2 . Since H is not Km,n and has no isolated vertices, this implies that H has
exactly two components. Since H is not K2 ⊔ K2 , some connected component of H has
at least three vertices. So we have a P3 induced by this component, and K2 induced by
the other component and so the claim is proven.
The complement graphs of K2 ⊔ K2 ⊔ K2 or P3 ⊔ K2 are shown in Figure 2. Both
graphs have C4 induced, but neither is the 1-skeleton for an iterated cone over C4 since
neither graph has a suspension vertex. Proposition 4.4 therefore implies that neither is
the 1-skeleton of a β-avoiding simplicial complex and so G may not induce either. So Gc
may not induce K2 ⊔ K2 ⊔ K2 nor P3 ⊔ K2 and therefore neither may H. The claim then
implies that H must be either Km,n or K2 ⊔ K2 . Assume Gc has p isolated vertices. If
H = Km,n then G is a Km+p and a Kn+p glued along a common Kp . If H = K2 ⊔ K2 then
G is an iterated cone over a 4-cycle.

As we see in the following proposition, the 1-skeleton of C completely determines C
when it is obtained by gluing two complete graphs along an empty clique.
Proposition 5.4. Let C be a β-avoiding simplicial complex such that the 1-skeleton of C
is the disjoint union of cliques Km and Kn . Then C = ∆m ⊔ ∆n .

UNIMODULAR BINARY HIERARCHICAL MODELS

15

Figure 2. The complement graphs of P3 ⊔ K2 and K2 ⊔ K2 ⊔ K2
Proof. Let v1 , . . . , vk be vertices of the Km . If {v1 , . . . , vk } is a minimal non-face of C, then
if we let u be a vertex in the Kn , then the complex indued on v1 , . . . , vk , u is ∂∆k ⊔{u}. 
6. The Main Theorem
The goal of this section is to give a proof of Theorem 6.3 which gives a complete
characterization of the unimodular binary hierarchical models.
We begin this section by defining a nuclear complex. A nuclear complex is a complex
that can be obtained from a disjoint union of two simplices by adding cone vertices, adding
ghost vertices, taking Lawrence liftings and taking Alexander duals. Since ∆m ⊔ ∆n
is unimodular and these operations all preserve unimodularity, nuclear complexes are
unimodular. Part of our main result is the converse - unimodular complexes are nuclear.
Definition 6.1. A simplicial complex C is nuclear if one of the following is true
(1) C = Λ(D) where D is nuclear
(2) C = G(D) where D is nuclear
(3) C = conep (∆m ⊔ ∆n ) for p, m, n ≥ 0
(4) C = conep (Dm,n ) for p ≥ 0 and m, n ≥ 1
(5) C = ∆k for k ≥ −2.
Every nuclear complex C can be constructed by applying the operations conep (·), G(·),
and Λ(·) to a complex D where D is of the form ∆m ⊔ ∆n , Dm,n , or ∆k . We refer to D as
the nucleus of C.
Note that Dm,0 has a ghost vertex for all m. This is why we have m, n ≥ 1 in (4). We
note that the collection of nuclear complexes is closed under Alexander duality.
Proposition 6.2. If C is nuclear then so is C ∗ .
Proof. Possibilities (1) and (2) are dual to each other, as are (3) and (4). On k vertices,
∆k and ∆−2 are dual to each other.

We now state our main result.
Theorem 6.3. Let C be a simplicial complex. Then the following are equivalent
(1) C is unimodular
(2) C is β-avoiding
(3) C is nuclear.

16

DANIEL IRVING BERNSTEIN AND SETH SULLIVANT

We defer the proof of Theorem 6.3 until the end of the section, but we give a roadmap
here. It is immediate from results in previous sections that nuclear complexes are unimodular and that unimodular complexes are β-avoiding.
We show that any β-avoiding complex C is nuclear by choosing a particular vertex v
of C and using induction on the number of vertices to conclude that linkv (C) is nuclear.
From here, we have five cases to consider - one for each of the ways that linkv (C) can
be nuclear. In four of these cases, it is relatively easy to show that C is nuclear. The
difficulty lies in the case where linkv (C) = Dm,n , which is handled in Lemma 6.8. The
proof of Lemma 6.8 is split into two main parts and the second part is further split into
six cases. Proposition 6.4 helps with the first part. Propositions 6.5, 6.6, and 6.7 handle
the hard cases in the second part.
Proposition 6.4. Let C be a β-avoiding simplicial complex. Assume that all proper
minors of C are nuclear. Assume C has a vertex v such that C \ v = conep (∆m ⊔ ∆n )
with m, n ≥ 1 and p ≥ 1. Assume C is C4 -free. Then C = conep+1 (∆m ⊔ ∆n ), C =
conep (∆m+1 ⊔ ∆n ), or C = conep (∆m ⊔ ∆n+1 ).
Proof. We induct on p. For the base case, take p = 1. If we let u denote the cone vertex
in C \ v then v must connect to one of the simplices in the ∆m ⊔ ∆n ⊂ C \ u. Otherwise
we have an independent set with three vertices induced in C \ u and this complex is not
nuclear. If v connects to only one such simplex, then v must also connect to u to avoid
inducing P4 which is not nuclear. If v connects to both such simplices, and v does not
connect to u, then C has C4 induced which contradicts our hypothesis. So assume v
connects to u and to at least one simplex. Since u is a cone vertex in C \ v, linku (C) has
no ghost vertices and by hypothesis, it is nuclear. Furthermore, linku (C \ v) = ∆m ⊔ ∆n
and so linku (C) is either ∆m+1 ⊔ ∆n or cone1 (∆m ⊔ ∆n ) (note that these are the only
nuclear complexes that become disconnected upon removing a vertex). In the first case,
C = cone1 (∆m+1 ⊔ ∆n ) and in the second case C = cone2 (∆m ⊔ ∆n ).
Now assume p ≥ 2. Let u1 , . . . , up denote the cone vertices of C \ v. Let M, N denote
the vertex sets of the ∆m , ∆n respectively. Then v must connect to at least one of M and
N to avoid inducing an independent set on three vertices. Furthermore, v must connect
to each ui - if v only connects to one of M or N, then this is required to avoid P4 , and
if v connects to both then we need this to ensure that C is C4 -free. Furthermore, the set
{u1 , . . . , up, v} is a facet of C. This is clear when p = 1 since otherwise v doesn’t connect
to u1 . Induction on p gives that {u1 , . . . , up−1, v} is a facet of linkup (C) and therefore
{u1 , . . . , up, v} is a facet of C.
Now, we can see that linkup (C) has no ghost vertices and is C4 -free. Furthermore,
linkup (C) \ v and C \ {up , v} are both equal to conep−1 (∆m ⊔ ∆n ). So by induction on p,
each of linkup (C) and (C \ up ) can either be conep (∆m ⊔ ∆n ) or conep−1 (∆m+1 ⊔ ∆n ). If
linkup (C) = C \ up , then up is a cone vertex in C. So if both equal conep (∆m ⊔ ∆n ) then
C = conep+1 (∆m ⊔ ∆n ). If both equal conep−1 (∆m+1 ⊔ ∆n ) then C = conep (∆m+1 ⊔ ∆n ).
Since linkup (C) ⊆ C \ up , it is impossible to have linkup (C) = conep (∆m ⊔ ∆n ) and
C \ up = conep−1 (∆m+1 ⊔ ∆n ). It is also impossible to have C \ up = conep (∆m ⊔ ∆n )
and linkup (C) = conep−1(∆m+1 ⊔ ∆n ). For if this were the case, then v would be a
cone vertex in C \ up and it would be part of the ∆m+1 in linkup (C). Since n ≥ 1,

UNIMODULAR BINARY HIERARCHICAL MODELS

17

#N ≥ 2, so given b1 , b2 ∈ N and a ∈ M the complex induced on a, b1 , b2 , up , v has facets
{v, a, up}, {v, b1 , b2 }, {up, b1 , b2 }. This is J1∗ , and so C is not β-avoiding.

Proposition 6.5. Let C be the simplicial complex on q vertices with a vertex v such that
′
′
linkv (C) = Dm,n with m, n ≥ 1 and (C \ v)∗ = Gm+n−m −n (∆m′ ⊔ ∆n ) with −1 ≤ m′ < m
and 0 ≤ n′ ≤ n. Unless m′ = −1 and n′ = n, C has a proper minor that is not nuclear.
Proof. Let M, N denote the sets of vertices such that in (linkv (C))∗ , the complex induced
on M is ∆m and the complex induced on N is ∆n . Then some vertex x ∈ N is a non-ghost
in (C \ v)∗ . We show that linkx (C) is not nuclear.
First we describe the facets of linkx (C). We claim that the facets of linkx (C) are precisely
the sets containing N −1−2 vertices, where the omitted vertex pair is one of the following
(1) some a ∈ M and some b ∈ N \ {x} or
(2) v and some vertex g that is a ghost in (C \ v)∗ .
We now prove the claim. The facets of linkx (C) that contain v are the sets whose complements are pairs of the first type since linkv (C) = Dm,n . The facets of linkx (C) that do
not contain v are the sets whose complements are minimal non-faces of (C \ v)∗ that do
not become faces of linkx (C) upon adding v. These minimal non-faces of (C \ v)∗ are the
ghost vertices. Therefore the facets of linkx (C) that do not contain v are the sets of the
second type.
We now show that linkx (C) is not nuclear. The complex linkx (C) cannot be Λ(D) for
any complex D since no facet lacks fewer than two vertices. Nor can linkx (C) have any
ghost vertices - m ≥ 1 implies #M ≥ 2 and so every vertex in M is in a facet of the first
type, every vertex of N is in a facet of the second type, and v is in every facet of the first
type. It is clear that no vertex is in every facet, so linkx (C) cannot be conep (Dk,l ) nor
conep (∆k ⊔ ∆l ) for any p ≥ 1. It is clear that linkx (C) has more than 2 facets, so linkx (C)
cannot be ∆k ⊔ ∆l , nor ∆k .
The only case left to check is linkx (C) = Dk,l . If this is the case then we can partition
the vertices of linkx (C) into disjoint sets C1 , C2 such that the facets of linkx (C) are precisely the subsets of C1 ∪ C2 that omit exactly one from each C1 and C2 .
Assume n′ = n and m′ ≥ 0. Let g ∈ M be a ghost vertex and without loss of generality
assume g ∈ C1 . Facets of the first type imply M ⊆ C1 . Facets of the second type imply
v ∈ C2 . Since m′ ≥ 0, there exists some a ∈ M that is not a ghost in (C \ v)∗ . Snd so
(C1 ∪ C2 ) \ {a, v} is a facet of linkx (C). But this does not fit our earlier description of the
facets of linkx (C).
Now assume −1 ≤ m′ < m and 0 ≤ n′ < n. Then there exist g ′ ∈ M and g ′′ ∈ N that
are ghosts in (C \ v)∗ . But this contradicts our earlier description of the facets of linkx (C)
- facets of the first kind imply that g ′ , g ′′ are in different Ci s and facets of the second kind
imply that they are in the same Ci .

Proposition 6.6. Let C be a simplicial complex on q vertices. Let v be a vertex in C such
that linkv (C) = Dm,n with m, n ≥ 1. Assume (C \ v)∗ = Gm+1 (∆n ). Then C = Dm,n+1 .
Proof. Let M, N denote the sets of vertices such that in (linkv (C))∗ , the complex induced
on M is ∆m and the complex induced on N is ∆n . Then all the vertices of M and none

18

DANIEL IRVING BERNSTEIN AND SETH SULLIVANT

of the vertices of N are ghosts in (C \ v)∗ . We claim that each facet of C contains N − 2
vertices, and the omitted pair is one of the following
(1) some a ∈ M and some b ∈ N
(2) v and some a ∈ M.
To see this, note that if a facet contains v, then it must be of the first form since
linkv (C) = Dm,n . If a facet does not contain v, then its complement must be v, along with
a minimal non-face of (C \ v)∗ . These minimal non faces are precisely the vertices in M.
So C = Dm,n+1 where M and N ∪ {v} are the sets of vertices for the ∆m and ∆n+1 in C ∗
respectively.

Proposition 6.7. Let C be a simplicial complex on q vertices. Let v be a vertex in C
such that linkv (C) = Dm,n with m, n ≥ 1 and has no ghost vertices. Let M, N denote the
sets of vertices such that in (linkv (C))∗ , the complex induced on M is ∆m and the complex
induced on N is ∆n . Assume (C \ v)∗ = Gm+1 (D) where D is a nuclear complex on vertex
set N with more than one facet. Then C has a proper minor that is not nuclear.
Proof. Let x ∈ M. We show that linkx (C) is not nuclear. We start by showing it is not
Lawrence type. Let F be a facet of linkx (C) that does not contain v. Then F ∪ {x} is
a facet of C \ v so it must also lack some a ∈ M \ {x}. If F is a facet of linkx (C) that
contains v, then F ∪ {x} \ {v} is a facet of linkv (C) and therefore lacks some a ∈ M and
b ∈ N. So linkx (C) is not Λ(F ) for any complex F .
We can see that linkx (C) has more than two facets - since m, n ≥ 1, there are at least
two that include v and since (C \ v)∗ = Gm+1 (D), there is at least one that does not.
linkx (C) cannot be conep (∆k ⊔ ∆l ) for any p ≥ 0.
All of the vertices of M are ghost vertices in (C \v)∗ , and (C \v)∗ has a minimal non-face
S ⊆ N with at least two vertices. This implies that C contains a facet F such that M ⊆ F ,
there exist b1 , b2 ∈ N such that b1 , b2 ∈
/ F and v ∈
/ F (since linkv (C) = Dm,n ). Facets in
linkx (C) that contain v have N − 1 − 2 vertices - they lack some a ∈ M \ {x} and some
b ∈ N. Furthermore, F \ {x} is a facet of linkx (C) containing at most N − 1 − 3 vertices.
This means that linkx (C) is not pure, and therefore not conep (Dk,l ) for any p ≥ 0. So
linkx (C) is a proper minor of C that is not nuclear.

Lemma 6.8. Let C be a β-avoiding simplicial complex on q vertices. Assume all proper
minors of C are nuclear. If there exists a vertex v of C such that linkv (C) = conep (Dm,n )
for p ≥ 0 and m, n ≥ 1, then C is nuclear.
Proof. We split this into two cases. For the first case, assume p ≥ 1. Here, Propositions
3.9 and 3.18 give C ∗ \ v = conep (∆m ⊔ ∆n ). By Proposition 4.3, C ∗ is β-avoiding so in
C ∗ , v must connect to one of the simplices in the ∆m ⊔ ∆n ⊂ C ∗ to avoid inducing an
independent set on three vertices. Now let u be a cone vertex. If v connects to only
one such simplex, then v must also connect to u to avoid inducing P4 . If v connects to
both such simplices, and v does not connect to u, then C ∗ has C4 induced. In this case
Proposition 4.4 implies C ∗ = conek (C4 ) and so C = conek (∆1 ⊔ ∆1 ). So we can assume
v connects to at least one simplex, and to all cone vertices in C ∗ \ v. From this we can
see that C ∗ has no induced C4 . Since every proper minor of C ∗ is nuclear, Proposition 6.4

UNIMODULAR BINARY HIERARCHICAL MODELS
∗

p+1

∗

19

p

implies C = cone (∆m ⊔ ∆n ) or C = cone (∆m+1 ⊔ ∆n ). Proposition 6.2 then implies
that C is nuclear.
For the second case, assume p = 0. So linkv (C) = Dm,n with m, n ≥ 1. Then Dm,n ⊆
C \ v and so (C \ v)∗ ⊆ ∆m ⊔ ∆n . Let M, N denote the sets of vertices of C such that
in (linkv (C))∗ , the vertices of the ∆m are M, and the vertices of the ∆n are N. The
non-ghost vertices of (C \ v)∗ must form a nuclear complex, and the only disconnected
nuclear complexes are of the form ∆s ⊔ ∆t . From this it follows that (C \ v)∗ must be one
of the following forms (without loss of generality)
(1) ∆m ⊔ ∆n
′
′
(2) Gm+n−m −n (∆m′ ⊔ ∆n′ ) with −1 ≤ m′ < m and 0 ≤ n′ ≤ n, but not both m′ = −1
and n′ = n
(3) Gm+1 (∆n )
(4) Gm+1 (D) where D is a nuclear complex on N with more than one facet
(5) Gm+n+2 ({∅})
(6) Gm+n+2 ({}).
We handle each possibility separately.
Case 1. Assume (C \ v)∗ = ∆m ⊔ ∆n . Then (C \ v)∗ has no ghost vertices, and so C \ v
is not of Lawrence type. So, by Lemma 4.7, C \ v = Dm,n and so C = cone1 (Dm,n ) with v
as the cone point.
′
′
Case 2. Assume (C \ v)∗ = Gm+n−m −n (∆m′ ⊔ ∆n′ ) with −1 ≤ m′ < m and 0 ≤ n′ ≤ n
but not both m′ = −1 and n′ = n. By Proposition 6.5, C has a proper minor M that is
not nuclear. By induction, M is not β-avoiding and so neither is C.
Case 3. Assume (C \ v)∗ = Gm+1 (∆n ). Then Proposition 6.6 implies that C = Dm,n+1 .
Case 4. Assume (C \ v)∗ = Gm+1 (D) where D is a nuclear complex on N with more
than one facet. By Proposition 6.7, C has a proper minor M that is not nuclear. By
induction, M is not β-avoiding and so neither is C.
Case 5. Assume (C \ v)∗ = Gm+n+2 ({∅}). Then C \ v = ∂∆m+n+1 . But linkv C = Dm,n
and so v is not in any m + n − 1 simplex with the vertices of M and N. By Proposition
4.6, C is not β-avoiding.
Case 6. Assume (C \ v)∗ = Gm+n+2 ({}). Then C \ v = ∆m+n+1 and so C = Λ(Dm,n )
with v as the added vertex.

Now we have all the necessary tools to prove Theorem 6.3.
Proof of Theorem 6.3. By Proposition 3.20, (1) implies (2). Each nuclear complex can be
obtained by applying the unimodularity-preserving operations from Section 3 to ∆n ⊔∆m ,
which is unimodular by Proposition 3.21. Therefore (3) implies (1). We now show (2)
implies (3).
Let C be a β-avoiding complex on q vertices. We show that C is nuclear by induction
on q. For the base case, note that all simplicial complexes on 2 or fewer vertices are both
β-avoiding and nuclear. We may assume that C has no ghost vertices since adding and
removing ghost vertices does not affect the properties of being nuclear nor β-avoiding. In
light of Propositions 4.4 and 5.4 and Lemma 5.3, we only need to consider the cases where
the 1-skeleton of C is Kq , or the union of two complete graphs, glued along a common

20

DANIEL IRVING BERNSTEIN AND SETH SULLIVANT

nonempty clique. Therefore, we can choose a vertex v of C that is in a facet with every
other vertex. Since C is β-avoiding, so is linkv (C). By induction, linkv (C) is also nuclear.
There are five main cases.
Case 1. This is the case where linkv (C) = Λ(D) for a nuclear D. Let F denote the big
facet of C and let u be the vertex of C that is not in F . Then C = Λ(C \ u), and C \ u is
nuclear by induction.
Case 2. This is the case where linkv (C) has ghost vertices. Since v connects to all
other vertices, this is impossible.
Case 3. This is the case where linkv (C) = conep (∆m ⊔ ∆n ) with p, m, n ≥ 0. We split
this into the sub cases, the first where m, n ≥ 1 and the second where m = 0.
Case 3.1 This is the sub case where m, n ≥ 1. Proposition 3.9 gives C ∗ \ v =
conep (Dm,n ) and so C ∗ has Dm,n induced. Proposition 4.5 then implies that C ∗ is either conep+1(Dm,n ), or conep (Dm,n ) with v as a ghost vertex. In the first case, C =
conep+1 (∆m ⊔ ∆n ). In the second case, C = Λ(conep (∆m ⊔ ∆n )).
Case 3.2 This is the sub case where m = 0. Proposition 3.9 gives C ∗ \ v = conep (D0,n )
which has a ghost vertex u. Then C ∗ \ u is nuclear by induction and since u is still a ghost
vertex in C ∗ , this implies C ∗ is nuclear. Proposition 6.2 implies that C is nuclear.
Case 4. This is the case where linkv (C) = conep (Dm,n ) with p ≥ 0 and m, n ≥ 1. By
induction, all proper minors of C are nuclear. Then Lemma 6.8 implies that C is nuclear.
Case 5. This is the case where linkv (C) = ∆k with k ≥ −2. Since linkv (C) has no
ghost vertices k = q − 2. So C = ∆q−1 .

7. Unimodularity of Non-Binary Hierarchical Models
In this section we consider the unimodularity of hierarchical models that are nonbinary; i.e. determining when AC,d is unimodular for arbitrary d. We begin by showing
how Theorem 6.3 makes this problem more tractable. Unlike in the binary case, the
Alexander dual does not always preserve unimodularity. For example, AC,d is unimodular
when C = ∆1 ⊔∆1 and d = (2, 2, 2, 3). However, AC ∗ ,d is not (see Proposition 7.9). Because
of this, our proof of Proposition 3.10 is not valid in the non-binary case. The proposition
statement does however generalize as we show with Corollary 7.4. Proposition 7.9 gives
a list of known minimal pairs (C, d) with C nuclear where AC,d is not unimodular. We
then use this list to pose a simple question whose answer would be a step in the general
classification.
Proposition 7.1. Assume AC,d is unimodular. Then for all d′ such that d′ ≤ d componentwise, AC,d′ is unimodular.
Proof. Note that AC,d′ can be realized as a subset of columns of AC,d .



The special case where d′ = 2 gives us the following useful corollary.
Corollary 7.2. If AC,d is unimodular, then C is nuclear.
So in order to classify all unimodular hierarchical models we only need to consider nuclear complexes. Therefore we can approach the general classification problem by looking
at each nuclear C and identifying the minimal values of d that give rise to non-unimodular

UNIMODULAR BINARY HIERARCHICAL MODELS

21

AC,d. Before proceeding with this, we show that the class of unimodular AC,d is still closed
under taking minors of C. However Corollary 3.7 fails in the non-binary case; we cannot
freely take the Alexander dual of C. Because of this, our proof of Corollary 3.10 is not
valid in the non-binary case. We will give an alternate proof that the class of unimodular
AC,d is closed under taking links in C. We start with a useful proposition.
Proposition 7.3. Let A ∈ Rr×n be a unimodular matrix with columns {ai }ni=1 . Assume
an is nonzero. Let A′ be the matrix that results when we project A onto the hyperplane
orthogonal to an . Then A′ is unimodular.
Proof. We may assume A has rank r since otherwise we can delete unnecessary rows. Let
B ∈ Rn×(n−r) have rank n − r such that AB T = 0. Denote the columns of B as {bi }ni=1 .
n−1
By Proposition 3.5, B is also unimodular. Denote the columns of A′ as {a′i }i=1
. Then
a′i = ai −

hai , an i
an .
kan k2

n−1
Let B ′ be the matrix with columns {bi }i=1
. Then B ′ has rank n − r or n − r − 1. The
second case implies that bn is a coloop in the matroid underlying B. Since the matroids
underlying A and B are duals, this would imply that an = 0. But then A′ = A which we
assumed to be unimodular. So we can assume that rank(B ′ ) = rank(B) = n − r and that
an 6= 0. Therefore rank(A′ ) = r − 1 and so the dimension of its kernel is n − r, which is
the rank of B ′ . We claim that A′ (B ′ )T = 0. From this it follows by Proposition 3.5 that
A′ is unimodular.
Now we prove the claim. Let bi be a column of B ′ (so 1 ≤ i ≤ n − 1). Letting bji
denote the jth entry of bi , we have

A′ bTi

n−1
X



hai , an i
bji aj −
=
an .
kan k2
j=1



Note that bjn an − hakann,akn2i an = 0, so we can add the nth term to the above sum. This
enables us to break it up as follows
n
X

n
1 X
bji aj −
bji haj , an ian .
2
ka
k
n
j=1
j=1

The first term is
proven.

AbTi

= 0. The second term is



1

aT AbTi
kan k2 n



· an = 0. So the claim is


Corollary 7.4. Assume AC,d is unimodular. Let v be a vertex of C and let d′ denote the
vector obtained by deleting the entry for v from d. Then Alinkv C,d′ is unimodular.

22

DANIEL IRVING BERNSTEIN AND SETH SULLIVANT

Proof. Let A = Alinkv C,d′ and let B = AC\v,d′ . By the remark following Lemma 2.2 in [7]
and the lemma itself, we can write


A 0 ... 0
0 A . . . 0
. . .
.. 
.
.
.
AC,d = 
.
.
.
.
.

 0 0 . . . A
B B ... B
Assume A ∈ Rm×n and B ∈ Rl×n and so AC,d ∈ Rdm+l,dn . By Proposition 2.9(3), we may
remove rows from A to make A, B, A all have full row rank. So assume that they do. Let
A′ denote the matrix that results when we project AC,d onto the subspace orthogonal to
the last (d − 1)n columns. Then if 1 ≤ i ≤ n, the ith column of A′ can be expressed as
the ith column of AC,d minus a linear combination of the last (d − 1)n columns of AC,d,
all of which are 0 in the top m rows. So this means that the top m rows of A′ are

A 0 ... 0 .

Furthermore, since A and AC,d both have full row rank, the final (d − 1)n columns of
AC,d have rank (d − 1)m + l. Therefore A′ has rank m. Since A also has rank m, we may
delete the bottom (d − 1)m + l rows of A′ without
affecting the rowspace and therefore

unimodularity. So the matrix A 0 . . . 0 , and therefore A, is unimodular.

Our proof of Proposition 3.1 is still valid in the non-binary case. Therefore, we have
the following.
Proposition 7.5. Assume C ′ is a minor of C. If AC,d is unimodular, then so is AC ′ ,d′
where d′ is the restriction of d to the vertices that are in C ′ .
The proofs of Propositions 3.12, 3.17 generalize to the non-binary setting and so we
have the following.
p
′
Proposition 7.6. If the pair (C, d) gives rise to unimodular
 AC,d, so do (cone (C), d )
′′
′′
′
and (G(C), d ) where d = d c1 . . . cp and d = d c for any c, c1 , . . . , cp ≥ 2.

Proof. In the case of a cone, the matrix Aconep (C),d′

AC,d
0
 0
AC,d
Aconep (C),d′ = 
..
 ...
.
0
0

is a block diagonal matrix:

···
0
···
0 
,
.. 
..
.
. 
· · · AC,d

with c1 c2 · · · cp blocks down the diagonal. In the case of adding a ghost vertex, the matrix
AG(C),d′ has repeated columns:

AG(C),d′′ = AC,d AC,d · · · AC,d

with c blocks.

We can also extend Proposition 3.21.



UNIMODULAR BINARY HIERARCHICAL MODELS

23

m+n+2
Z≥2
.

Proposition 7.7. Let C = ∆m ⊔ ∆n and d ∈
Let M, N denote the vertex sets of
C in the ∆m , ∆n respectively. Let D be the complex with facets {1, 2} and let e = (e1 , e2 )
where
Y
Y
e1 =
dv
e2 =
dv .
v∈M

v∈N

Then AC,d = AD,e. This matrix is unimodular.
Proof. We can see that AC,d = AD,e by inspection. The matrix AD,(e1,e2 ) is the vertex
edge incidence matrix of a complete bipartite graph with e1 and e2 vertices in each set of
the partition. Such vertex-edge incidence matrices are examples of network matrices and
are hence totally unimodular [12, Ch. 19].

We also note that Proposition 3.15 holds in a slightly more general setting.
Proposition 7.8. Let (C,
 d) be such that AC,d is unimodular. Then AΛ(C),d′ is also
′
unimodular if d = d 2 .

Proof. The proof here is similiar to the proof for Proposition 3.15. Note that Λ(AC,d) =

AΛ(C),d′ . Hence Theorem 7.1 in [14] implies the proposition.

Propositions 7.1 and 7.5 suggest that we might be able to use a short list of pairs (C, d)
that give rise to non-unimodular AC,d to eliminate the remaining non-unimodular pairs.
The following proposition lists all non-binary minimally non-unimodular complexes that
we presently know.
Proposition 7.9. The following pairs give rise to non-unimodular AC,d
(1) C = Λ(∆0 ⊔ ∆0 ) with facets {12, 23, 13} and d = (3, 3, 3)
(2) C = D1,1 with facets {12, 23, 34, 14} and d = (2, 2, 2, 3)
(3) C = Λ(G(∆0 ⊔ ∆0 )) with facets {12, 13, 234} and d = (4, 2, 2, 2)
(4) C = Λ(D1,1 ) with facets {1234, 125, 235, 345, 145} and d = (2, 2, 2, 2, 3).
Proof. By Table 1 in [9], (1) is not unimodular. Computing a Graver basis with 4ti2 [1]
shows that (2) and (4) are not unimodular. Computations are available on our website
[3]. If C and d are as in (3) then AC,d = AJ1∗ ,2 which is not unimodular by Proposition
4.1.

From these non-unimodular examples and the constructive results earlier in the section,
we can classify all unimodular hierarchical models that are nuclear with nucleus Dm,n ,
m, n ≥ 1.
Theorem 7.10. Let C be a nuclear complex with nucleus Dm,n with m, n ≥ 1. Then AC,d
is unimodular if and only if
(1) dv = 2 for all v in the original Dm,n and
(2) dv = 2 for all v corresponding to a Lawrence lifting.
Proof. The fact that all such AC,d are unimodular follows from applying Propositions 7.6
and 7.8. We now show that these are the only unimodular AC,d with this type of complex
C.

24

DANIEL IRVING BERNSTEIN AND SETH SULLIVANT

Note that since taking cone vertices commutes with adding ghost vertices and Lawrence
liftings and this always preserves unimodularity, we can assume there are no cone vertices.
Now if C is a nuclear complex obtained by successively adding ghost vertices and Lawrence
vertices to Dm,n , then the induced subcomplex on just the Dm,n and Lawrence vertices is
an iterated Lawrence lifting of Dm,n . If any of the vertices of v that are Lawrence vertices
have dv > 2, then by taking suitable links, one obtains the complex isomorphic to item
(4) in Proposition 7.9. On the other hand, if dv > 2 for some v in the original Dm,n , then
by taking suitable links, one obtains the complex isomorphic to item (2) in Proposition
7.9. In summary, if the conditions of Theorem 7.10 are not satisfied, there is a minor of
C that is not unimodular.

It remains to consider the unimodularity of AC,d when C is a nuclear complex with
nucleus ∆m ⊔ ∆n . We do not have a general characterization in this case. By Propositions
7.6 and 3.18, we may assume that C has no cone vertices. By Proposition 7.7, we may
assume that m, n = 0. Note that Λ(∆0 ⊔ ∆0 ) = ∂∆2 , and our results above (or [9]) show
that this is unimodular if and only if some dv = 2. Similarly, the iterated Lawrence liftings
Λp (∆0 ⊔ ∆0 ) = ∂∆p+1 is unimodular if and only if at most two of the dv are greater than
2.
We begin moving into uncharted territory when we consider cases where ghost vertices
are involved. The simplest case to consider is the complex Λ(G(∆0 ⊔ ∆0 )) which is the
complex on {1, 2, 3, 4} with facets {12, 13, 234}. Here 1 is the Lawrence vertex and 4 is
the ghost vertex. By Propositions 7.5 and 7.9 (3), we must have d1 ≤ 3. If d1 = 2 then
Proposition 7.8 implies that AC,d will be unimodular. So we only need to consider the case
where d1 = 3. Propositions 7.1, 7.5, and 7.9 (1) imply that one of d2 or d3 is 2, so assume
d2 = 2. This leaves us with the following question, which would classify unimodularity
for C = Λ(G(∆0 ⊔ ∆0 )).
Question 7.11. Let C = Λ(G(∆0 ⊔ ∆0 )) be the complex on {1, 2, 3, 4} with facets
{12, 13, 234}. Let d = (3, 2, d3, d4 ). For what values of d3 , d4 is the matrix AC,d unimodular?
Acknowledgments
Daniel Irving Bernstein was partially supported by the US National Science Foundation
(DMS 0954865). Seth Sullivant was partially supported by the David and Lucille Packard
Foundation and the US National Science Foundation (DMS 0954865).
References
[1] 4ti2 team. 4ti2—a software package for algebraic, geometric and combinatorial problems on linear spaces. Available at www.4ti2.de.
[2] Daniel Irving Bernstein and Seth Sullivant. Normal binary hierarchical models.
ArXiv:1508.05461, 2015.
[3] Daniel Irving Bernstein and Seth Sullivant.
Supplementary materials.
http://www4.ncsu.edu/˜smsulli2/Pubs/UnimodularWebsite/Unimodular.html,
2016.

UNIMODULAR BINARY HIERARCHICAL MODELS

25

[4] Yuguo Chen, Ian H. Dinwoodie, and Seth Sullivant. Sequential importance sampling
for multiway tables. Ann. Statist., 34(1):523–545, 2006.
[5] Persi Diaconis and Bernd Sturmfels. Algebraic algorithms for sampling from conditional distributions. Ann. Statist., 26(1):363–397, 1998.
[6] Serkan Hoşten and Seth Sullivant. Gröbner bases and polyhedral geometry of reducible and cyclic models. J. Combin. Theory Ser. A, 100(2):277–301, 2002.
[7] Serkan Hoşten and Seth Sullivant. A finiteness theorem for Markov bases of hierarchical models. J. Combin. Theory Ser. A, 114(2):311–321, 2007.
[8] Tomáš Kaiser. Minors of simplicial complexes. Discrete Applied Mathematics,
157(12):2597 – 2602, 2009. Second Workshop on Graph Classes, Optimization, and
Width Parameters.
[9] Hidefumi Ohsugi and Takayuki Hibi. Non-very ample configurations arising from
contingency tables. Annals of the Institute of Statistical Mathematics, 62(4):639–
644, 2010.
[10] Ignacio Ojeda and Alberto Vigeneron-Tenorio. Indispensable binomials in semigroup
ideals. Proc. Amer. Math. Soc., 138:4205–4216, 2010.
[11] Johannes Rauh and Seth Sullivant. Lifting markov bases and higher codimension
toric fiber products. ArXiv:1404.6392, 2014.
[12] Alexander Schrijver. Theory of Linear and Integer Programming. Wiley-Interscience
Series in Discrete Mathematics. John Wiley & Sons, Ltd., Chichester, 1986. A WileyInterscience Publication.
[13] Paul Seymour. Decomposition of regular matroids. J. Combin. Theory Ser. B,
28(3):305–359, 1980.
[14] Bernd Sturmfels. Gröbner Bases and Convex Polytopes, volume 8 of University Lecture Series. American Mathematical Society, Providence, RI, 1996.
[15] Seth Sullivant. Small contingency tables with large gaps. SIAM Journal of Discrete
Mathematics, 18(4):787–793, 2005.
[16] Seth Sullivant. Normal binary graph models. Ann. Inst. Statist. Math., 62(4):717–
726, 2010.
[17] W. T. Tutte. A homotopy theorem for matroids i,ii. Trans. Amer. Math. Soc.,
88:144–174, 1958.
Department of Mathematics, North Carolina State University, Raleigh, NC 27695
E-mail address: dibernst@ncsu.edu
E-mail address: smsulli2@ncsu.edu

