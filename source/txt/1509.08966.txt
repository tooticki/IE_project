arXiv:1509.08966v3 [math.GR] 29 Jul 2016

DIFFERENTIABILITY OF INTEGRABLE MEASURABLE
COCYCLES BETWEEN NILPOTENT GROUPS
MICHAEL CANTRELL
Abstract. We prove an analog for integrable measurable cocycles of Pansu’s
differentiation theorem for Lipschitz maps between Carnot-Carathéodory spaces.
This yields an alternative, ergodic theoretic proof of Pansu’s quasi-isometric
rigidity theorem for nilpotent groups, answers a question of Tim Austin regarding integrable measure equivalence between nilpotent groups, and gives an
independent proof and strengthening of Austin’s result that integrable measure equivalent nilpotent groups have bi-Lipschitz asymptotic cones. Our main
tools are a nilpotent-valued cocycle ergodic theorem and a Poincaré recurrence
lemma for nilpotent groups.

1. Introduction
In [13] Pansu proved the following seminal quasi-isometric rigidity theorem for
nilpotent groups.
Theorem 1.1 (Pansu [13]). Finitely generated quasi-isometric nilpotent groups
have isomorphic associated Carnot groups.
He did this in two independently interesting steps. First, he identified the
unique asymptotic cone of a finitely generated nilpotent group equipped with a leftinvariant inner metric as an associated Carnot group with a Carnot-Carathéodory
metric [12]. The second step is Pansu’s differentiation theorem.
Theorem 1.2 (Pansu [13]). A bi-Lipschitz map between Carnot groups is differentiable almost everywhere. Moreover, the derivative induces a group isomorphism.
Since asymptotic cones of quasi-isometric groups are bi-Lipschitz, one deduces
Theorem 1.1.
Measure equivalence (hereafter ‘ME’) is an equivalence relation on groups introduced by Gromov [7] that is a measure-theoretic parallel of quasi-isometry. It
has been the object of considerable study: Furman’s survey [5] provides a thorough
overview. However, a fundamental result of Ornstein and Weiss [11] implies that
measure equivalence collapses all amenable groups into one equivalence class.
A measure equivalence between two groups implicitly defines a pair of measurable
cocycles over probability measure preserving (pmp) actions of those groups. In
their study of rigidity of hyperbolic lattices, [2] Bader, Furman and Sauer have
sharpened measure equivalence to a finer equivalence relation, called integrable
measure equivalence (IME), by considering only those measure equivalences for
which these cocycles satisfy an integrability condition.
Recently Austin and Bowen [1] showed that the single ME class of infinite
amenable groups splits into many IME classes. Bowen showed that the growth
Date: September 10, 2018.
1

2

MICHAEL CANTRELL

type of a group is preserved by IME, and Austin used Bowen’s result to prove the
following.
Theorem 1.3 (Austin [1]). Finitely generated integrable measure equivalent nilpotent groups have bi-Lipschitz asymptotic cones.
Notice that combining Theorems 1.2 and 1.3 one deduces the IME analog of
Theorem 1.1.
Theorem 1.4. Finitely generated integrable measure equivalent nilpotent groups
have isomorphic associated Carnot groups.
However this proof is not entirely satisfying as it does not ‘see’ the group isomorphism through the IME. In his proof, Austin considers the measurable cocycle
as an equivariant family of random maps between the f.g. groups that induces a
sequence of measurable maps κx,n between the associated Carnot groups indexed
by the rescaling 1/n in the asymptotic cone construction. He then proves that
with high probability a subsequence of these maps converge to a bi-Lipschitz map
between the Carnot groups. Austin then asks the natural question (Question 5.2
[1]): Is there a bi-Lipschitz group isomorphism between the Carnot groups to which
this sequence of random maps converge with high probability on bounded sets? We
answer this question in the affirmative.
Theorem A.
Suppose Γ and Λ are IME f.g. nilpotent groups with associated Carnot groups G∞
and H∞ . Let κx,n be the maps as in Question 5.2 [1]. Then there is a bi-Lipschitz
group isomorphism Φ : G∞ → H∞ to which κx,n converge on bounded sets with
high probability as n → ∞
κx,n −→ Φ.
Remarks 1.5.
(1) In [15] Shalom keenly observed that amongst f.g. amenable groups, quasiisometry implies uniform measure equivalence, which in particular implies
IME. Therefore Theorem A implies Theorem 1.1. While we do not rely
logically on Theorem 1.2, we do use the idea of the Pansu derivative.
(2) One might say that the isomorphism Φ is the Pansu derivative of the given
measurable cocycle. Indeed, in the deterministic case Φ is the usual Pansu
derivative.
(3) Theorem A is for any Carnot-Carathéodory metrics on G∞ and H∞ . All
Carnot-Carathéodory metrics on a given Carnot group are bi-Lipschitz, so
in what follows we may not specify the metric. Moreover Φ being a group
isomorphism implies it is bi-Lipchitz.
Theorem A is an immediate consequence of Theorem B, which has the spirit of
a nilpotent-valued cocycle ergodic theorem.
Theorem B.
Let Γ,Λ be f.g. IME nilpotent groups with associated cocycles α : Γ × X → Λ and
β : Λ × Y → Γ, and let G∞ and H∞ be the associated Carnot groups of Γ and Λ.
Then there exists a bi-Lipschitz group isomorphism Φ : G∞ → H∞ so that for all
g ∈ G∞

EQUIVARIANT RANDOM MAPS BETWEEN NILPOTENT GROUPS

(n, γn ) −→ g

implies

3

(n, α(γn , x)) −→ Φ(g)

where the convergence is in the sense of the asymptotic cone, and the second
convergence is in measure. The same is true after exchanging the roles of Γ,Λ,
α,β, and Φ,Φ−1 .
See §2.2 for the definition of convergence in the asymptotic cone.
Remarks 1.6.
(1) Convergence in measure is the best one can hope for given the L1 integrability assumption. To have pointwise convergence even in case Γ = Λ = Zd
one must assume Ld,1 (Lorentz-space) integrability. The correct integrability assumption for pointwise convergence of ergodic theorems for nilpotent
groups is commonly believed to be related to the growth type of the group.
(2) All of the theorems stated above are true for f.g. polynomial growth groups,
which by [6] are those groups with finite index nilpotent subgroups. Theorem B is insensitive to finite index and finite kernels, so we reduce to the
torsion-free nilpotent case. See §2.6.
The proof of Theorem B is a natural extension of ideas developed in the author’s thesis [4]. The idea is that, following Pansu [12], the large scale geometry of
f.g. nilpotent groups depends only on the behavior of the projection to abelianization. Therefore, to understand the large scale geometric behavior of a random map
α(·, x) : Γ → Λ, we project it to the abelianization and integrate. Since a section
of the abelianization generates the whole group, we can write all elements in terms
of that section. We then use the cocycle identity to decompose arbitrary elements
into a product of those coming from (a section of) the abelianization, which allows
us to promote the cocycle ergodic theorem for cocycles with values in Rd , which is
easy, to the desired cocycle ergodic theorem with values in Λ.
We remark that while it is almost immediate that the limiting map Φ is a homomorphism, the nilpotent Poincaré recurrence Lemma 5.8 is needed to show that
Φ has (the obvious candidate as) an inverse.
The rest of the paper is organized as follows. The second section sets notation,
gathers background information regarding nilpotent groups, asymptotic cones, and
measure equivalence, and reduces to the torsion-free nilpotent case. In section 3 we
study asymptotics along iterates of a single element. In section 4 we combine the
results of §3 with Lemma 2.1 to understand asymptotics along arbitrary elements.
Finally in section 5 we define Φ, prove Theorem B, and deduce Theorem A.
On a first reading of this paper, one may wish to skip the proofs in subsection
2.4, as the statements are intuitive. Also, one may wish to skip the proofs in section
3, which are the most technical part of the paper.
We conclude the introduction by noting that, in light of Remark 1.5 (1), one
might hope to develop a nilpotent IME rigidity theory parallel to that of quasiisometry ([15], [14], [9]).
Acknowledgements. I would like to express my sincere gratitude to Tim Austin
and to my advisor Alex Furman.

4

MICHAEL CANTRELL

2. Background and Notation
2.1. Integrable Measure Equivalence. Two infinite discrete countable groups
Γ, Λ are measure equivalent if there exists an infinite measure space (Ω, m) with
a measurable, measure preserving action of Γ×Λ so that the actions A : Γ y (Ω, m)
and B : Λ y (Ω, m) admit finite measure fundamental domains Y, X ⊂ Ω. The
space (Ω, m) together with the Γ × Λ action is called a measurable coupling of Γ
and Λ. By restricting attention to an ergodic component, one may always assume
that m is ergodic for the Γ × Λ action.
The fundamental domains Y and X for the G and H actions give rise to functions
α : Γ × X −→ Λ

and

β : Λ × Y −→ Γ

defined uniquely by requiring
B(λ)y ∈ A(β(λ, y)−1 )Y

and

A(g)x ∈ B(α(γ, x)−1 )X

∀x ∈ X ∀y ∈ Y.

There are associated finite measure preserving actions Γ y (X, m|X ) and Λ y
(Y, m|Y ) (whose actions we denote by ·) defined by requiring that
A(γ)x = B(α(γ, x)−1 )(γ · x)

B(λ)y = A(β(λ, y)−1 )(λ · y).

and

If m is ergodic for Γ × Λ then the actions Γ y (X, m|X ) and Λ y (Y, m|Y ) are
ergodic. We may assume after renormalizing that both m|X and m|Y are probability
measures. Finally, α and β are measurable cocycles over the pmp actions in the
sense that
(1) α(γ1 γ2 , x) = α(γ1 , γ2 · x)α(γ2 , x)

and

β(λ1 λ2 , y) = β(λ1 , λ2 · y)β(λ2 , y)

for all γ1 , γ2 ∈ Γ, λ1 , λ2 ∈ Λ and for m a.e. x ∈ X, y ∈ Y . Most of our reasoning
will be about these cocycles.
Replacing the fundamental domain Y with one of its H translates only translates
the cocycle β. Since countably many translates of Y cover Ω, we may therefore
assume that m(X ∩ Y ) > 0. Moreover, (see [1] for more details) if
then

x ∈ X ∩ Y ∩ γ −1 (X ∩ Y )
β(α(γ, x), x) = γ.

Given finitely generated groups Γ, Λ, a cocycle α : Γ × X → Λ over a pmp action
Γ y (X, µ) is integrable if, for some (any) choice of finite generating set for Λ
Z
k|α(γ, ·)|Λ k1 =
|α(γ, x)|Λ dµ(x) < ∞
∀γ ∈ Γ
X

where |·|Λ is the word norm associated to the generating set. The subadditivity
of |·|Λ implies
k|α(γ, ·)|Λ k1 ≤ |γ|Γ · max k|α(s, ·)|Λ k1
s∈S

where |·|Γ is any word norm associated to a finite generating set for Γ.

EQUIVARIANT RANDOM MAPS BETWEEN NILPOTENT GROUPS

5

Finally, finitely generated groups Γ and Λ are integrably measure equivalent if they admit a measurable coupling so that the associated cocycles (1) are
integrable. This is an equivalence relation independent of choice of generating sets.
For more details, see [5].
Recall that measurable events En ⊂ (X, m) occur with high probability (whp) if
m(En ) → 1 as n → ∞. We say that a sequence of measurable functions fn : X →
[0, ∞) is o(n) in probability (or ‘whp’) if for all ǫ > 0 one has m(fn (x)/n < ǫ) → 1
as n → ∞. Thus for example dΛ (α(γ n , x), λ) = o(n) in probability means that for
all ǫ, δ > 0 there is N so that for all n ≥ N one has m(dΛ (α(γ n , x), λ) < nδ) < ǫ.
Similarly for O(n).
2.2. The Associated Graded Lie Algebra. Let Γ be a finitely generated torsion
free nilpotent group. Recall that by a theorem of Mal’cev [10] there is a unique
connected, simply connected nilpotent Lie group G, called the Mal’cev completion
of Γ, in which Γ embeds as a (necessarily cocompact) lattice.
Since G is simply-connected, the exponential map exp : g := Lie(g) → G from
the Lie algebra of G to G is a diffeomorphism, so we can work with the Lie algebra.
Let g be the Lie algebra of G, and set
g1 := g,

gi+1 := [g, gi ].

Being nilpotent, G satisfies gr+1 = {0} for some r ∈ N. Since [gi , gj ] ⊂ gi+j the
Lie bracket on g defines a bilinear map


gi /gi+1 ⊗ gj /gj+1 −→ (gi+j /gi+j+1 ),
which can then be used to define the Lie bracket [−, −]∞ on

(2)

g∞ :=

r
M

vi ,

where

vi := gi /gi+1

i=1

by extending the above maps linearly.
The resulting pair (g∞ , [−, −]∞ ) is called the graded Lie algebra associated
with g. Note that the linear maps
δt : g ∞ → g ∞ ,

δt (v1 , . . . , vr ) = (t · v1 , t2 · v2 , . . . , tr · vr ),

satisfy δt ([v, w]∞ ) = [δt (v), δt (w)]∞ and δts = δt ◦ δs for v, w ∈ g∞ , t, s > 0. Hence
{δt | t > 0} is a one-parameter family of automorphisms of the Lie algebra g∞ ,
and therefore define a one-parameter family of automorphisms of the Lie group
G∞ := exp∞ (g∞ ), that we will still denote by {δt | t > 0}. (Here we denote the
exponential map g∞ → G∞ by exp∞ to distinguish it from exp : g → G).
Choose a splitting of g as a direct sum of vector subspaces
(3)

g = V1 ⊕ · · · ⊕ Vr ,

so that

gi = Vi ⊕ · · · ⊕ Vr ,

and choose a vector space identification L : g → g∞ so that L(Vi ) = vi the
ith summand of g∞ . For t > 0 define the vector space automorphism δt of g by
δt (v) = ti · v for v ∈ Vi (i = 1, . . . , r). Note that {δt | t > 0} are not Lie algebra
automorphisms of g in general. Nevertheless they induce maps {δt | t > 0} from G
to G which we still denote δt . Note also that the maps δt defined on g and on g∞
are conjugate through L.
Now the Lie bracket [−, −]t on g, given by
[v, w]t := δ 1t ([δt (v), δt (w)]) ,

6

MICHAEL CANTRELL

defines a Lie algebra structure on g that is isomorphic to the original [−, −] =
[−, −]1 via δt .
However, one has
[L(v), L(w)]∞ = lim [v, w]t
t→∞

due to the fact that for v ∈ Vi , w ∈ Vj the ”leading term” of [v, w] lies in Vi+j ,
while the higher terms that belong to Vi+j+1 ⊕ · · · ⊕ Vr become insignificant under
the rescaling (see [12]). Using the log : G → g and exp∞ : g∞ → G∞ maps we
obtain a family of maps
(4)

<

log

δ

−1

exp

L

t
∞
sclt (−) : Γ −→ G −→ g −→
g −→ g∞ −→
G∞

(t > 0)

that explains the asymptotic cone description of Pansu [12] as follows.
Let d be an inner left-invariant metric d on Γ and
1
GH
(Γ, · d, e) −→ (G∞ , d∞ , e)
t
the Gromov-Hausdorff convergence. Then a sequence γi ∈ Γ, rescaled by t−1
with
i
ti → ∞ as i → ∞, converges to g ∈ G∞ iff sclti (γi ) → g in G∞ .
We shall often write
1
g = lim
• γi
instead of
sclti (γi ) → g.
i→∞ ti
The metric part of the statement shows that for ti → ∞ and γi , γi′ ∈ Γ
1
1
1
(5) g = lim
• γi , g ′ = lim
• γi′
=⇒
d∞ (g, g ′ ) = lim · d(γi , γi′ ).
i→∞ ti
i→∞ ti
i→∞ ti
The limiting distance d∞ on G∞ is homogeneous in the sense that
d∞ (δs (g), δs (g ′ )) = s · d∞ (g, g ′ )

(g, g ′ ∈ G∞ , s > 0).

This distance is left-invariant (this follows from Lemma 2.1). The distance d∞
arises from the sub-Finsler Carnot-Carathéodory construction.
Lemma 2.1.
Given sequences ti → ∞, γi , γi′ ∈ Γ with
1
′
′
ti • γi γi → gg .

1
ti

• γi → g and

1
ti

• γi′ → g ′ then

Proof. This follows from the Baker-Campbell-Hausdorff formula (cf. §3.3 and the
proof of Lemma 5.5 in [3]).

2.3. Logarithmic Coordinates. We will use the so called logarithmic coordinates throughout this paper, which are described as follows. Choose a real basis {X1 , . . . , Xm } for g that respects the decomposition (3). When we write g =
(x1 , . . . , xm ) ∈ G we mean that g = exp(x1 X1 + · · · xm Xm ). These are the logarithmic coordinates of G. Thus if g = (x1 , . . . , xm ) and h = (x′1 , . . . , x′m ) then
the product gh = (y1 , . . . , ym ) where
exp(x1 X1 + · · · + xm Xm ) exp(x′1 X1 + · · · x′1 Xm ) = exp(y1 X1 + · · · ym Xm ).

In light of the vector space isomorphism L : g → g∞ the basis for g yields a
basis for g∞ that respects the decomposition (2). Throughout this paper we will
think of g and g∞ as occupying the same real vector space, only with different Lie
brackets [−, −] and [−, −]∞ . We also use the logarithmic coordinates for g∞ , the
only difference in definition being the Lie bracket.

EQUIVARIANT RANDOM MAPS BETWEEN NILPOTENT GROUPS

7

Let d = dim V1 . Then there exist constants ηi ∈ N, d < i ≤ m so that Γ embeds
in G in logarithmic coordinates as
Γ = {(a1 , . . . , ad , ηd+1 ad+1 , . . . , ηm am ) : ai ∈ Z} < G.
Thus we have identified Γ < G ≡ Rm ≡ G∞ . Therefore we think of Γ < G and
G∞ as occupying the same copy of Rm . We denote the group product in Γ < G
by g · h or simply by gh, and the group product in G∞ by g ⋆ h. We will always
denote a word norm on a discrete nilpotent group Γ or Λ by |·|Γ or |·|Λ , a word
norm on a nilpotent Lie group G or H by |·|G or |·|H and a Carnot-Carathéodory
norm on a graded nilpotent Lie group G∞ or H∞ by |·|∞ , and their associated
metrics dΓ , dΛ , dH , dH , and d∞ . Thus we can without notational ambiguity omit
the linear identification L : G ≡ G∞ . For example if γ, σ ∈ Γ then |γ|∞ means
unambiguously |Lγ|∞ and γ ⋆ σ means Lγ ⋆ Lσ.
Since V1 ∼
= g/g2 , the sets
{(x1 , . . . , xd , 0, . . . , 0) ∈ G} ∼
= Rd

and

{(a1 , . . . , ad , 0, . . . , 0) ∈ Γ} ∼
= Zd

are complete sets of coset representatives for G/G2 , G∞ /G2∞ and (the torsionfree part of) Γ/Γ2 . We will use these choices of coset representatives in the arguments that follow. We define the projections on to the abelian and commutator
coordinates for Γ, G, and G∞ by
πab (a1 , . . . , am ) = (a1 , . . . , ad , 0, . . . , 0)
πcom (a1 , . . . , am ) = (0, . . . , 0, ad+1 , . . . , am ).
2.4. Some Nilpotent Geometry. We now collect some basic nilpotent geometry
facts. We make no claim to originality in this subsection.
We will use the following Lemma of Guivarc’h repeatedly throughout this paper
to simplify our arguments. Since asymptotic statements are not sensitive to quasiisometry, the Guivarc’h Lemma allows us to prove asymptotic statements for only
one of (H, dH ) or (H∞ , d∞ ).
Lemma 2.2 (Guivarc’h [8]; see also [3] Theorem 3.7). Let K be a compact neighborhood of the identity in a simply connected nilpotent Lie group G and dG (g, h) =
inf{n ≥ 1 : g −1 h ∈ K n }. Then for any homogeneous quasi-norm |·| on G there is
a constant C > 0 so that
1
|g| ≤ dG (e, g) ≤ C|g| + C.
C
We now use the Guivarc’h Lemma to give succinct proofs of several nilpotent
geometric facts, which could also be proved by induction on nilpotency class. All
of the statements are true independent of choice of symmetric generating set, but
we work with a fixed generating set S with associated norm |·|Γ and metric dΓ
to be concise. All constants depend on Γ and S. Let us say that two functions
f, g : Γ → R+ are quasi-isometric if there exists C > 0 so that for all γ ∈ Γ,
f (γ)/C − C ≤ g(γ) ≤ Cg(γ) + C. The following lemma is a natural statement
regarding the asymptotic word growth of each coordinate in a nilpotent group.
Define, for each 1 ≤ i ≤ m, the degree di = deg(Xi ) to be the greatest j so that
Xi ∈ gj−1 .

8

MICHAEL CANTRELL

Lemma 2.3. For each 1 ≤ i ≤ m there exist 0 < c1 < c2 < ∞ so that for all n ∈ Z
c1 n1/di ≤ |(0, . . . , n, . . . 0)|Γ ≤ c2 n1/di
where the non zero term is in the i-th coordinate.
Moreover, if [Xi1 , · · · , [Xil−1 , Xil ] · · · ] = cXt where ir ∈ {1, . . . , m} and c 6= 0,
then
l
X
r=1

dir ≤ dt .

Proof. The following is a quasi-norm on G
|(x1 , . . . , xm )|m := max |xi |

1/di

i

.

(G, |·|G ) restricted to Γ is quasi-isometric to (Γ, |·|Γ ), while by the Guivarc’h
Lemma, (G, |·|G ) is quasi-isometric to (G, |·|m ). But |(0, . . . , n, . . . , 0)|m = n1/di .
Since Γ is discrete we may absorb the additive factors. The moreover statement is
obvious from the definitions.

Lemma 2.4. For each 1 ≤ i ≤ m set

fi (n) = |(0, . . . , 0, n, 0, . . . , 0)|Γ

gi (n) = min |(a1 , . . . , ai−1 , n, ai+1 , . . . , am )|Γ .
aj

where the non-zero coordinate is in the i-th coordinate. Then there exists 1 ≤
C < ∞ so that for all n ∈ N
fi (n) ≤ cgi (n).
Proof.
fi (n) ≤ cn1/di ≤ c min |(a1 , . . . , ai−1 , n, ai+1 , . . . , am )|m
aj

≤ cc1 min |(a1 , . . . , ai−1 , n, ai+1 , . . . , am )|Γ + c2
aj

≤ (cc1 + c2 ) min |(a1 , . . . , ai−1 , n, ai+1 , . . . , am )|Γ
aj

(n 6= 0)

where we have used Lemma 2.3 and the Lemma of Guivarc’h.

The next lemma says that projecting to the commutator coordinates only reduces
word norm by a universal multiplicative constant.
Lemma 2.5. There is a constant C > 0 so that ∀γ ∈ Γ
|γ|Γ ≥ C|πcom γ|Γ .
Proof. For all γ ∈ Γ we have trivially
|γ|m ≥ |πcom γ|m .
The Guivarc’h Lemma and the discreteness of Γ finish the proof.
2


n

Lemma 2.6. There exists l > 0 so that for all γ ∈ Γ − Γ and for all n |γ |Γ ≥ ln.

EQUIVARIANT RANDOM MAPS BETWEEN NILPOTENT GROUPS

9

Proof. If γ ∈
/ Γ2 then |γ n |m ≥ n. The Guivarc’h Lemma and the discreteness of Γ
finish the proof.

Lemma 2.7. The functions |·|Γ , |·|G , |·|m , |·|∞ : Γ → R+ are all quasi-isometric.
Moreover,
|an,t | = o(nd(t) )

|γn |Γ = |(an,1 , . . . , . . . , an,m )|Γ = o(n)

⇐⇒

|γn |Γ = |(an,1 , . . . , . . . , an,m )|Γ = O(n)

⇐⇒

|an,t | = O(nd(t) )

|gn |G = |(an,1 , . . . , . . . , an,m )|G = o(n)

⇐⇒

|an,t | = o(n

|gn |G = |(an,1 , . . . , . . . , an,m )|G = O(n)

⇐⇒

|an,t | = O(n

d(t)

|gn |∞ = |(an,1 , . . . , . . . , an,m )|∞ = o(n)

⇐⇒

|an,t | = o(nd(t) )

∀1 ≤ t ≤ m

|gn |∞ = |(an,1 , . . . , . . . , an,m )|∞ = O(n)

⇐⇒

|an,t | = O(n

d(t)

∀1 ≤ t ≤ m

d(t)

)
)
)

∀1 ≤ t ≤ m
∀1 ≤ t ≤ m
∀1 ≤ t ≤ m
∀1 ≤ t ≤ m

where an,j ∈ Z (an,j ∈ R) is the j-th coordinate of γn ∈ Γ (gn ∈ G).
Note that the stronger statement that the corresponding left-invariant metrics
(G, dG ) and (G∞ , d∞ ) are quasi-isometric is not true in general.
Proof. For the first statement, recall that (G, |·|G ) restricted to Γ is quasi-isometric
to (Γ, |·|Γ ), while by the Guivarc’h Lemma, (G, |·|G ) is quasi-isometric to (G, |·|m ).
Note that (G, |·|m ) and (G∞ , |·|m ) are equal (under the implicit linear identification
L), and that (G∞ , |·|∞ ) is a quasi-norm. Since any two quasi-norms on the same
group are bi-Lipschitz, we have proven the first statement.
The moreover statement follows from the first statement together with the fact
that
|gn |m = o(n) ⇐⇒ |an,t | = o(nd(t) )

and similarly for O(n).

∀1 ≤ t ≤ m



Lemma 2.8. If gn ∈ G∞ is a sequence such that
(1) |πcom gn |∞ = o(n)
(2) |πab gn |∞ = O(n)
then


(πab gn )−1 ⋆ gn  = o(n).
∞

Proof. Let gn = (an,1 , . . . , an,m ) so that πab gn = (an,1 , . . . , an,d , 0, . . . , 0) and
(πab gn )−1 = (−an,1 , . . . , −an,d , 0, . . . , 0). Using the Baker-Campbell-Hausdorff formula, the nilpotency of G∞ and linearity of the bracket
(πab gn )−1 ⋆ gn = an,d+1 Xd+1 + · · · + an,m Xm + h.o.t.

where h.o.t. are precisely the terms involving at least one bracket in the product
(6)

(−an,1 X1 − · · · − an,d Xd ) ⋆ (an,d+1 Xd+1 + · · · + an,m Xm ).

Since the abelian coordinates of (πab gn )−1 ⋆ gn are all zero, by Lemma 2.7 it
suffices to show that the t-th coordinate of (πab gn )−1 ⋆ gn is o(ndt ) for every d < t ≤
m. By assumption |πcom gn |∞ = o(n), so it suffices to show that the contributions

10

MICHAEL CANTRELL

from (6) to each t coordinate are o(nd(t) ), for d < t ≤ m. Using Baker-CampbellHausdorff again, for fixed d < t ≤ m the contribution is a sum of finitely many
terms of the form
c[an,i1 Xi1 , · · · , [an,il−1 Xil−1 , an,il Xil ] · · · ]

where c is a constant from the Baker-Campbell-Hausdorff formula, i1 , . . . il ∈
{1, . . . , m} and for at least one r, ir ∈ {d + 1, . . . , m}. Since the number of such
terms depends only on G∞ , it suffices to show that
an,i1 · · · an,il = o(ndt ),

which follows immediately from the fact that at least one ir ∈ {d + 1, . . . , m}
and
for 1 ≤ ir ≤ d
• |an,ir | = O(n)
• |an,ir | = o(ndir ) for d < ir ≤ m
Pl
•
r=1 dir ≤ dt .



2.9. Let gn , hn ∈ G. If |gn |G = o(n) and |hn |G = O(n) then
Lemma

gn−1 h−1
n gn hn G = o(n). Moreover the same is true of any Carnot-Carathéodory
norm on G∞ instead of G.
Proof. Let gn = (an,1 , . . . , an,m ), hn = (bn,1 , . . . , bn,m ) and suppose |gn |G = o(n)
and |hn |G = O(n). By Lemma 2.7
|an,t | = o(ndt )

1≤t≤m

|bn,t | = O(n )

1 ≤ t ≤ m.

dt

Say gn = exp vn = exp(an,1 X1 + · · ·+ an,m Xm ) and hn = exp wn = exp(bn,1 X1 +
· · · + bn,m Xm ), so
(7)

gn−1 h−1
n gn hn = exp −vn exp −wn exp vn exp wn = exp([vn , wn ] + · · · )

where the dots stand for terms involving three or more brackets. Let us examine
the coefficient cr of Xr in (7); it is a sum of finitely many terms of the form
can,i1 · · · an,is bn,j1 · · · bn,jt

X

where

1≤p≤s
1≤q≤t

dip + djq ≤ dr

where c is a (possibly zero) constant depending only on G, and s 6= 0, i.e. there
is at least one an,i term. Employing Lemma 2.7 again it suffices to show that each
of these possible coefficients is o(ndr ). Indeed there is a constant c (coming from
the O(nd(jq ) )) so that for all ǫ > 0 and all sufficiently large n
|an,i1 · · · an,is bn,j1 · · · bn,jt | ≤ ǫn

P

dip

cn

P

diq

≤ cǫndr .

To see that the same is true for G∞ with a Carnot-Carathéodory norm |·|∞ ,
note that the proof only used Lemma 2.7 and nilpotency.


EQUIVARIANT RANDOM MAPS BETWEEN NILPOTENT GROUPS

11

2.5. Notation. All of the above was true of a general finitely generated torsion-free
nilpotent group Γ, though of course the groups G, G∞ , as well as the corresponding
dimension of the abelianization d = dim(G/[G, G]), the nilpotency step s and the
vector space dimension m all depend on Γ.
Let us fix two finitely generated torsion-free nilpotent groups Γ and Λ that are
integrably measure equivalent with integrable cocycles as in (1) for which the action
Γ y (X, m) is pmp ergodic. We denote their Mal’cev Lie groups G and H and
their graded lie groups G∞ and H∞ , respectively. Let us now fix finite generating
sets S and T for Γ and Λ respectively. We will denote their respective word norms
|·|Γ and |·|Λ and the metrics dΓ and dΛ . Let us also fix a compact generating set
K ⊂ H and denote the corresponding word norm and metric |·|H and dH . Finally,
there are the unique Carnot-Carathéodory metrics on H∞ and G∞ associated to
dΓ and dΛ by [12]. Let us denote both by d∞ , as no confusion can arise.
Keep in mind that, since we are not assuming Pansu’s Theorem 1.2 a priori we
do not know whether G∞ and H∞ are isomorphic groups or that the dimensions
of their abelianization are the same. So let us say that in logarithmic coordinates
Λ < H ≡ H∞ ≡ R m

Γ < G ≡ G∞ ≡ Rm

dim(h/h2 ) = d
′

dim(g/g2 ) = d′ .

We will only work in the Lie algebras h and h∞ of H and H∞ . Let us identify
as in (3)
V = V1 ⊕ · · · ⊕ Vs = h = h∞

with Lie brackets [−, −]H and [−, −]∞ . The projections we will use are for Λ,
H and H∞ :
πab (a1 , . . . , am ) = (a1 , . . . , ad , 0, . . . , 0)
πcom (a1 , . . . , am ) = (0, . . . , 0, ad+1 , . . . , am ).
We will think of the image πab (H) ∼
= Rd in order to integrate, but for notational
ease we suppress the identification. Now we may define two maps essential to what
follows
αab : Γ × X → H
αab : Γ → H

αab (γ, x) = πab ◦ α(γ, x)
Z
αab (γ, x)dm(x).
αab (γ) =
X

2.6. Reduction to torsion-free nilpotent groups. Here we reduce Theorem B
to the case of torsion-free nilpotent groups. Finitely generated polynomial growth
groups have finite index nilpotent subgroups, which themselves have finite normal
torsion subgroups. Let Γ′ < Γ be a finite index subgroup. The action Γ′ y (X, m)
has at most [Γ : Γ′ ]-many ergodic components permuted by the Γ action. Let
τ1 , . . . , τl ∈ Γ be a complete set of representatives for Γ′ \Γ. Consider an ergodic
component X ′ and the integrable cocycle α′ : Γ′ × X ′ → Λ obtained by restriction.
Suppose n1 • γn → g ∈ G∞ . For each n write γn = γn′ τni where τni ∈ {τ1 , . . . , τl }
and γn′ ∈ Γ′ . Then n1 • γn′ → g so by Theorem B n1 • α(γn′ , x) → Φ(g) for some

12

MICHAEL CANTRELL

Φ that a priori depends on the ergodic component X ′ . Now the cocycle equality
α(γn , x) = α(γn′ τni , x) = α(γn′ , τni x)α(τni , x) implies
dΛ (α(γn , x), α(γn′ , τni x)) = |α(τni , x)|Λ
which is bounded by a constant independent of n with high probability by
Markov’s inequality. Therefore
1
1
• α(γn′ , x), • α(γn , x)) = o(n)
whp.
n
n
Now let N be a finite normal subgroup of Γ. Then Γ/N acts ergodically by pmp
transformations on (X, m)/N . Since N is finite, we can find a measurable section
s : X/N → X of π : X → X/N . For every x ∈ X, there is nx ∈ N so that
nx · sπ(x) = x. Define
d∞ (

f :X →Λ
f (x) = α(nx , sπ(x))
and the cocycle cohomologous to α via f
αf (γ, x) = f (γx)−1 α(γ, x)f (x).
Notice that f takes finitely many values, so αf is integrable. A direction computation shows that αf restricted to N is the trivial map, so αf descends to a
cocycle
αf : Γ/N × X/N → Λ.
Finally, if γn ∈ Γ is such that n1 • γn → g, then also n1 • γn → g where γ =
γN ∈ Γ/N . Thus n1 • αf (γn , πx) → Φ(g). Again since f takes finitely many values,
another application of the Markov inequality shows that
dΛ (αf (γn , x), α(γn , x)) = o(n) whp
which finishes the proof.
3. Asymptotic Behavior Along Iterates
In this section we analyze the asymptotic behavior of α(γ n , x) as n → ∞ for a
given γ ∈ Γ. In the following section, we use the cocycle equation and the results of
this section to understand the asymptotic behavior of an arbitrary α(γ, x). The idea
in this section is to use the cocycle equation to see that α(γ n , x) typically behaves
like a homomorphism in to a nilpotent group. Crucially, one parameter families
of elements in nilpotent groups experience an asymptotic decay in the higher order terms (commutator coordinates). In this section we use ergodicity to extend
this phenomenon to a cocycle. Moreover, the position in the abelian coordinates
stabilizes asymptotically, so that we have a perfect picture of the asymptotics of
iterates: the higher order terms vanish, and the abelian coordinates tend to their
average value.
The main result of this section is the following proposition.
Proposition 3.1. For every γ ∈ Γ
1
• α(γ n , x) −→ αab (γ)
n

in probability.

EQUIVARIANT RANDOM MAPS BETWEEN NILPOTENT GROUPS

13

Equivalently,
d∞ (α(γ n , x), δn αab (γ)) = o(n)

in probability.

We will prove Proposition 3.1 by analyzing the abelian and commutator coordinates separately.
3.1. Abelianization Direction. In this subsection we prove the following lemma
describing the asymptotic behavior of α along iterates in the abelianization.
Lemma 3.2. For a.e. x ∈ X and every γ ∈ Γ
1
αab (γ n , x) → αab (γ)
n
where the convergence is of vectors in Rd .
The proof of the lemma is an easy application of the following found in the more
general sub-additive case in [1] and [4].
Proposition 3.3. Suppose c : Γ × X → R is a measurable cocycle over Γ y (X, m)
which is pmp ergodic. Then for a.e. x ∈ X and every γ ∈ Γ
Z
1
c(γ n , x) →
c(γ, x)dm(x).
n
X
Proof of Lemma 3.2. αab is itself a cocycle taking values in Rd which we can decompose as d independent cocycles with values in R. Indeed there are cocycles
αi : Γ × X → R for 1 ≤ i ≤ d so that
αab (γ, x) = (α1 (γ, x), . . . , αd (γ, x), 0, . . . , 0).
We can similarly decompose the averages
Z
Z
αab (γ) = ( α1 (γ, x)dm(x), . . . ,
αd (γ, x), 0, . . . , 0).
X

X

Applying Proposition 3.3 to each of the αi finishes the proof.



3.2. Commutator Direction. The purpose of this subsection is to prove the following lemma describing the asymptotic behavior of α along iterates in the commutator direction.
Lemma 3.4. For every γ ∈ Γ

|πcom ◦ α(γ n , x)|Λ = o(n)

in probability.

Moreover the same is true replacing the norm |·|Λ with |·|∞ .
The moreover statement follows immediately from Lemma 2.7. The proof of the
main statement requires some preparation. The idea is to use the cocycle equation
to write α(γ nk , x) = α(γ n , x1 )α(γ n , x2 ) · · · α(γ n , xk ) where xi+1 = γ ni x. Using
Lemma 3.2 whp the abelianization of each of the α(γ n , xi ) ≈ nv for some v, so
that the commutator of α(γ nk , x) is roughly the sum of the commutators of the
α(γ n , xi ). This allows us to promote a linear bound on the commutator to an o(n)
bound since the commutator direction ‘should’ grow at least quadratically.

14

MICHAEL CANTRELL

To begin, we use a weakened form of Proposition 3.2 from [1] to obtain the O(n)
bound. Recall that given a pmp action Γ y (X, m) a map c : Γ × X → R+ is a
subadditive cocycle if
c(γ1 γ2 , x) ≤ c(γ1 , γ2 · x) + c(γ2 , x)

∀γ1 , γ2 ∈ Γ m − a.e.x ∈ X.

Proposition 3.5. Given a subadditive cocycle c : Γ × X → R+ , there is M ≥ 1
such that for any ǫ > 0 there is C = C(ǫ) such that
|γ|Γ ≥ C

=⇒

m(|c(γ, x)| ≥ M |γ|Γ ) < ǫ.

We would like to use Proposition 3.5 to draw conclusions about the size of the
commutator of α(γ, x). To do this, we use Lemma 2.5 which says that projection to
the commutator increases word norm by at most a universal multiplicative constant,
and Lemma 2.6 which says that the norm of iterates of an element with nontrivial
abelianization grows linearly up to a multiplicative constant. Combining this with
Proposition 3.5 we easily deduce the following O(n) bound on the commutator
growth. Since the word length of iterates of γ ∈ Γ2 does not grow linearly, we must
deal with this easy case separately.
Lemma 3.6. For every γ ∈ Γ − Γ2 there is M ′ ≥ 1 so that for any ǫ > 0 there is
N so that for all n ≥ N
m(|πcom ◦ α(γ n , x)|Λ > M ′ n) < ǫ.
Proof. We apply Proposition 3.5 to the subadditive cocycle c : Γ × X → [0, ∞)
defined by c(γ, x) = |α(γ, x)|Λ . We obtain M and set M ′ = M |γ|Γ /k where k is
from Lemma 2.5. Fix ǫ > 0. Then there is C so that
|γ|Γ ≥ C

=⇒

m(|α(γ, x)|Λ ≥ M |γ|Γ ) < ǫ.

Set N = C/l where l is from Lemma 2.6. Then since |γ n |Γ ≤ n|γ|Γ ,
n ≥ N =⇒ |γ n |Γ ≥ C =⇒
Finally, by Lemma 2.5

m(|α(γ n , x)|Λ ≥ M n|γ|Γ ) < ǫ.

n ≥ N =⇒ m(|πcom α(γ n , x)|Λ ≥ M ′ n) < ǫ.



The proof of Lemma 3.4 is easy in case γ ∈ Γ2 .

Lemma 3.7. If γ ∈ Γ2 then

|πcom ◦ α(γ n , x)|Λ = o(n)

in probability.

Proof. By Markov’s inequality there is κ = maxs∈S k|α(s, ·)|Λ k1 so that for every
M ∈N
m(|α(γ n , x)|Λ > M κ|γ n |Γ ) < 1/M.

√
For γ ∈ Γ2 there is a constant c > 0 so that for all n ∈ N we have |γ n |Γ ≤ c n
(Lemma 2.3 and Lemma 2.7). Thus for such γ we have |α(γ n , x)|Λ = o(n) whp.
Lemma 2.5 completes the proof.


EQUIVARIANT RANDOM MAPS BETWEEN NILPOTENT GROUPS

15

We need one more lemma before we can prove Lemma 3.4. Let us illustrate the
idea behind the lemma through the example of the Heisenberg group. Recall that
in logarithmic coordinates, the multiplication in the Heisenberg group is
(x, y, z)(x′ , y ′ , z ′ ) = (x + x′ , y + y ′ , z + z ′ + 1/2(xy ′ − x′ y)).

The non-linear growth in the z-coordinate is given by the area enclosed by the
triangle formed by (x, y), (x+x′ , y+y ′ ) and (0, 0). So, if a pair of elements have very
similar abelianizations, the z-coordinate of their product is approximately the sum
z + z ′ . Now suppose we have k elements with uniformly controlled z-coordinates
and very similar abelianizations. Then the z-coordinate of their product grows
approximately linearly. Thus the z-coordinate is o(k) since the z-coordinate ‘should’
grow quadratically. The following lemma generalizes this idea to general finitely
generated torsion-free nilpotent groups.
We define the projection on to the first t commutator coordinates
πt : Λ → Λ
πt (a1 , . . . , am ) = (0, . . . , 0, ad+1 , . . . , at , 0, . . . 0).
1
Let d1 be the l metric on Rd and |·|1 be the l1 norm, so that |(x1 , . . . , xd )|1 =
|x1 | + · · · + |xd |.

Lemma 3.8. Fix 0 < M < ∞ and v ∈ Rd . For each d ≤ t < m for all δ > 0 there
exists K ∈ N and δ ′ > 0 so that for all k ≥ K and η ≥ 1, whenever there exist
λ1 , . . . , λk ∈ Λ such that
(8)
(9)
(10)
then

d1 (πab λi , v) < ηδ ′ |v|1
|πt λi |Λ < ηδ ′

|πcom λi |Λ < ηM
|πt+1 λ1 · · · λk |Λ < ηkδ.

Proof of Lemma 3.4. Fix γ ∈ Γ − Γ2 . We obtain M as in Lemma 3.6 and set
v = αab (γ). We prove by induction that for every d ≤ t ≤ m
|πt α(γ n , x)|Λ = o(n)
in probability.
For t = d there is nothing to show. Suppose the result is known for t. Fix ǫ > 0
and δ > 0. We apply Lemma 3.8 with the given δ, M and v to obtain k = K and
δ ′ . Let N be as in Lemma 3.6 applied to ǫ/k, so that for all η ≥ N we have with
probability at least 1 − ǫ/k
|πcom α(γ η , x)|Λ < ηM.
By taking N larger if necessary, applying the inductive hypothesis to δ ′ /3 and
ǫ/k we obtain N so that for all η ≥ N with probability at least 1 − ǫ/k we have
|πt α(γ η , x)|Λ < ηδ ′ /3.
By taking N larger again if necessary, by Lemma 3.2 for all η ≥ N with probability at least 1 − ǫ/k
d1 (πab α(γ η , x), ηv) < ηδ ′ |v|/3.

16

MICHAEL CANTRELL

Since the Γ action on (X, µ) is measure preserving, the previous three statements
remain true if we replace any instance of x with gx for any g ∈ Γ.
Finally, let N be larger if necessary so that k ≤ δ ′ N . Now let p ≥ kN . Write
p = ηk + r where 0 ≤ r < k and η ≥ N . Using the cocycle equation
α(γ kη+r , x) = α(γ η , x)α(γ η , γ η x) · · · α(γ η , γ (k−2)η , x)α(γ η+r , γ (k−1)η , x).
Since η, η + r ≥ N , with probability at least 1 − 3ǫ we have simultaneously for
all 0 ≤ i ≤ k − 2


πcom α(γ η , γ iη x) < ηM

Λ
πt α(γ η , γ iη x) < ηδ ′ /3
Λ

d1 (πab α(γ η , γ iη x), ηv) < ηδ ′ |v|1 /3
and




πcom α(γ η+r , γ (k−1)η x) < (η + r)M

Λ

η+r
(k−1)η 
,γ
x) < (η + r)δ ′ /3
πt α(γ
Λ

d1 (πab α(γ η+r , γ (k−1)η x), (η + r)v) < (η + r)δ ′ |v|1 /3.
Since r ≤ δ ′ η the final three inequalities imply




πcom α(γ η+r , γ (k−1)η x) < 2ηM

Λ

η+r
(k−1)η 
,γ
x) < ηδ ′
πt α(γ
Λ

d1 (πab α(γ η+r , γ (k−1)η x), ηv) < δ ′ |v|1
where for the final inequality we have used the triangle inequality with intermediate term (η + r)v.
Therefore with probability at least 1 − 3ǫ we apply Lemma 3.8 and obtain
|πt+1 α(γ p , x)|Λ < kηδ < pδ.



Proof of Lemma 3.8. Fix 0 < M < ∞, v ∈ Rd , d ≤ t < m, δ > 0 and 1 > δ ′ > 0.
We will show in √
the proof how to choose δ ′ as a function of δ, |v|1 , t. Choose K
large so that M/ K ≤ δ 2 , and fix k ≥ K and η ≥ 1. Suppose we have λ1 , . . . , λk
satisfying conditions (8) (9) (10). Let us denote λi = (ai,1 , ai,2 , . . . , ai,m ) for each
1 ≤ i ≤ k, keeping in mind that only ai,1 , . . . , ai,t+1 are relevant. Throughout this
proof c will denote an ever-changing constant this is independent of δ, δ ′ and η.
We are concerned with the absolute value of the t + 1 coordinate of the product
λ1 · · · λk . By Lemma 2.3 it suffices to show that the absolute value of this coordinate
is at most c(ηkδ)d(t+1) . The estimate we seek will follow from the Baker-CampbellHausdorff equation and the following constraints on the ai,j implied by conditions
(8), (9) and (10):

EQUIVARIANT RANDOM MAPS BETWEEN NILPOTENT GROUPS

(11)
(12)
(13)
(14)

|ai,j − ai′ ,j | ≤ cηδ ′ |v|1
′ d(j)

|ai,j | ≤ c(ηδ )

|ai,t+1 | ≤ c(ηM )d(t+1)

∀1 ≤ j ≤ d

∀1 ≤ i ≤ k

∀d < j ≤ t

∀1 ≤ i ≤ k

d(j)

∀1 ≤ i ≤ k
∀1 ≤ j ≤ t.
Pd
′
Indeed, setting v = (v1 , . . . , vd ), from (8) we have
j=1 |ai,j − vj | ≤ ηδ |v|1
′
which implies in particular |ai,j − vj | ≤ ηδ |v|1 for all i, giving (11). Combining
(9), Lemma 2.4 and Lemma 2.3 we immediately arrive at (12). Similarly combining
(10), Lemma 2.4 and Lemma 2.3 we arrive at (13). It only remains to prove (14)
in the case 1 ≤ j ≤ d, which follows from |ai,j − vj | ≤ ηδ ′ |v|1 above and |vj | ≤ |v|1 .
By the Baker-Campbell-Hausdorff equation we can express the product λ1 · · · λk
as a sum of terms of the form
(15)

|ai,j | ≤ cη

∀1 ≤ i, i′ ≤ k

17

c[λi1 , . . . , [λil−1 , λil ], . . .]

where ij ∈ {1, . . . , k} for each 1 ≤ j ≤ l ≤ m. We emphasize that it is possible
that the indices are repeated, i.e. that ij = ij ′ while j 6= j ′ . We are only interested
in
the brackets that contribute to the coefficient of Xt+1 . We replace each λi with
Pm
j=1 ai,j Xj in each of the summands (15) above. Using linearity of the Lie bracket,
the result is a sum of terms of the form
(16)

c[ai1 ,j(i1 ) Xj(i1 ) , . . . , [ail−1 ,j(il−1 ) Xj(il−1 ) , ail ,j(il ) Xj(il ) ] . . .]

where for each ir we have chosen j(ir ) ∈ {1, . . . , t + 1}. By Lemma 2.3, we have
that

(17)

l
X
r=1

dj(ir ) ≤ dt+1

so that in particular l ≤ t + 1. We will show that each such term is small by
analyzing the possibilities for the choices j(ir ) above. We consider three cases.
For the first case we consider all terms with j(ir ) = t + 1 for some r. Note that
in this case, in view of (17) in fact (16) becomes
cai1 ,t+1 Xt+1 .
In view of (13), summing these over all 1 ≤ i1 ≤ k, the total contribution to the
t + 1 term from this case is, in absolute value, at most
ck(ηM )dt+1 ≤ cndt+1 δ dt+1 k 1+dt+1 /2
by our choice of k. This suffices since we may assume dt+1 ≥ 2.
For the second case, we consider all terms in which at least one of the j(ir ) ∈
{d, . . . , t + 1}. By linearity we pull out all of the constants ai,j and consider the
size of their product. By our assumption and (12) one of the terms is at most
c(ηδ ′ )dj(ir ) and by (14) the rest of the terms are at most cη dj(ir ) . Therefore their
product is at most
Pl
cδ ′ η r=1 dj(ir ) ≤ cδ ′ η dt+1 .

18

MICHAEL CANTRELL

Since there are finitely many such terms independent of δ ′ , by taking δ ′ small as
a function of δ, c, t and the number of such terms, the total contribution to the t + 1
coordinate of the product λ1 · · · λk from terms of the second type is as desired.
For the third and final case we group each term into pairs and use antisymmetry,
as follows. We may assume all terms i(jr ) ∈ {1, . . . , d}. In particular the inner
most term [ail−1 ,j(il−1 ) Xj(il−1 ) , ail ,j(il ) Xj(il ) ] has j(il−1 ) = s, j(il ) = t for some
s, t ∈ [1, . . . d]. We pair the terms for which j(il−1 ) = s, j(il ) = t with that for
which j(il−1 ) = t, j(il ) = s, and all other j(ir ) equal. By anti-symmetry of the
bracket, the sum of these two terms is
[ai1 ,j(i1 ) Xj(i1 ) , . . . , [ail−1 ,j(il−1 ) Xj(il−1 ) , ail ,j(il ) Xj(il ) ] . . .]
+[ai1 ,j(i1 ) Xj(i1 ) , . . . , [ail−1 ,j(il ) Xj(il ) , ail ,j(il−1 ) Xj(il−1 ) ] . . .]
= [ai1 ,j(i1 ) Xj(i1 ) , . . . , (ail−1 ,j(il−1 ) ail ,j(il ) − ail−1 ,j(il ) ail ,j(il−1 ) )[Xj(il−1 ) , Xj(il ) ] . . .]
Pulling the constants out and considering the absolute value of the coefficient,
we are concerned with the absolute value of
(18)

ai1 ,j(i1 ) · · · ail−2 ,j(il−2 ) (ail−1 ,j(il−1 ) ail ,j(il ) − ail−1 ,j(il ) ail ,j(il−1 ) ).

By properties (11) and (14) and the triangle inequality we have

 

(ai ,j(i ) ai ,j(i ) − ai ,j(i ) ai ,j(i ) ) ≤ ai ,j(i ) ai ,j(i ) − ai ,j(i ) ai ,j(i ) 
l−1
l−1
l
l
l−1
l
l
l−1
l−1
l−1
l
l
l
l
l
l−1


+ ail ,j(il ) ail ,j(il−1 ) − ail−1 ,j(il ) ail ,j(il−1 ) 



≤ ail ,j(il ) ail−1 ,j(il−1 ) − ail ,j(il−1 ) 



+ ai ,j(i ) ai ,j(i ) − ai ,j(i ) 
l

l−1

l

l

l−1

l

≤ cηcηδ ′ |v|1 + cηcηδ ′ |v|1 = cη 2 δ ′ |v|1 .

Now by (14) each of the other terms in the product (18) has absolute value at
most cη. Putting this together with the preceding and noting that l ≤ dt+1 , the
absolute value of (18) is at most cη dt+1 δ ′ |v|1 . Since there are a finite number of
such terms independent of δ ′ , by taking δ ′ small as a function of δ, c, |v|1 , the total
contribution to the absolute value of the t + 1 coordinate of λ1 · · · λk from terms
from the third case is as desired. This finishes the proof.

3.3. Proof of Proposition 3.1. Finally we can combine Lemmas 2.8, 3.2 and 3.4
to prove Proposition 3.1.
Proof of Proposition 3.1. Fix γ ∈ Γ. Chow’s Theorem and Lemma 3.2 imply
(19)

d∞ (αab (γ n , x), nαab (γ)) = o(n)

in probability

which implies in particular that
(20)

|αab (γ n , x)|∞ = O(n)

Now we use the triangle inequality

in probability.

EQUIVARIANT RANDOM MAPS BETWEEN NILPOTENT GROUPS

19

d∞ (α(γ n , x), nαab (γ)) ≤ d∞ (α(γ n , x), αab (γ n , x))

+ d∞ (αab (γ n , x), nαab (γ)).

The second summand is o(n) by (19). For the first summand, we apply Lemma
2.8 with hn (x) = α(γ n , x); by (20), |πab hn (x)|∞ = O(n) in probability, while
Lemma 3.4 implies |πcom hn (x)|∞ = o(n) in probability.

4. Asymptotic Behavior Along Arbitrary Elements
In this section we prove the following.
Theorem 4.1. Let γn ∈ Γ be a sequence satisfying
a

a

γn = s1 n,1 · · · skn,k

where si ∈ S are fixed, in order, independent of n and for each i, N ∋ an,i → ∞
as n → ∞. Then whp
d∞ (α(γn , x), δan,1 αab (s1 ) ⋆ · · · ⋆ δan,k αab (sk )) = o(max an,i ).
We note that, for any sequence γn ∈ Γ, it is possible to write the γn to satisfy
the hypotheses of Theorem 4.1. Indeed, by Proposition 3.3 in [1], there is always
a K so that every γ = sa1 1 · · · sakk with ai ∈ N, s ∈ S and k ≤ K. By increasing
K, one may assume that every γ is represented with the same ordered generating
set. By increasing K again, we ensure an,i → ∞ as n → ∞ for each i. Indeed,
for every γ, look at a = max ai , and for each 1 ≤ j ≤ k so that aj < a/2, rewrite
a −a
a
sj j = saj sj j . We will not use either of these observations.
There is a natural way to compare the two points above. Using the cocycle
equation we write
a

a

a

α(γn , x) = α(s1 n,1 , x1 ) · · · α(skn,k , xk )
a

a

n,i+1
· · · skn,k x. Proposition 3.1 relates α(si n,i , xi ) and δan,i αab (si ).
where xi := si+1
We use the uniform boundedness of k and Lemma 2.1 to extend Proposition 3.1 to
Theorem 4.1.

Proof of Theorem 4.1. By the cocycle equation, it is enough to show that whp
d∞ (α(sa1 1 , x1 ) · · · α(sakk , xk ), δan,1 αab (s1 ) ⋆ · · · ⋆ δan,k αab (sk )) = o(max an,i ).
For each n, let an = max an,i . Now suppose the conclusion is false. Then there
are ǫ, δ > 0 and a subsequence (we keep the index n) so that
a

a

m(x : d∞ (α(s1 n,1 , x1 ) · · · α(skn,k , xk ), δan,1 αab (s1 ) ⋆ · · · ⋆ δan,k αab (sk )) > δan ) > ǫ
Notice that 0 ≤ an,i /an ≤ 1. Therefore, after taking a diagonal subsequence, we
may assume that an,i /an → ai for each 1 ≤ i ≤ k. Proposition 3.1 implies that, for
every 1 ≤ i ≤ k, whp as n → ∞
1
a
• α(si n,i , x) −→ αab (si ).
an,i

20

MICHAEL CANTRELL

The above, and an easy calculation in coordinates using the definition of the δt
and that an,i /an → ai shows that for all 1 ≤ i ≤ k, whp as n → ∞.
1
1
a
a
• α(si n,i , x) = δan,i /an
• α(si n,i , x) −→ δai αab (si ).
an
an,i
Invoking Lemma 2.1, whp as n → ∞
1
a
a
• α(s1 n,1 , x1 ) · · · α(skn,k , xk ) −→ δa1 αab (s1 ) ⋆ · · · ⋆ δak αab (sk )
an
which is equivalent to
a

a

d∞ (α(s1 n,1 , x1 ) · · · α(skn,k , xk ), δan a1 αab (s1 ) ⋆ · · · ⋆ δan ak αab (sk )) = o(an ).

But

d∞ (δan a1 αab (s1 ) ⋆ · · · ⋆ δan ak αab (sk ), δan,1 αab (s1 ) ⋆ · · · ⋆ δan,k αab (sk )) = o(an ),
so we have a contradiction.


5. Construction of Φ and Proof of Main Theorem
In this section we construct Φ, prove Theorem B and deduce Theorem A.
Definition 5.1. Let (G∞ , δt ) be a graded nilpotent lie group with its one-parameter
family of automorphisms. A finite symmetric subset S ⊂ G∞ generates G∞ with
respect to δt , t ≥ 0, if for every g ∈ G∞ there exist k ∈ N, s1 , . . . , sk ∈ S and
a1 , . . . , ak ∈ R+ so that
(21)

g = δ a1 s 1 ⋆ · · · ⋆ δ ak s k .

Example 5.2. In the Mal’cev coordinates on G∞ , the set of d′ = dim(G∞ /G2∞ )
elements
{(1, 0, . . . , 0), (0, 1, 0, . . . 0), . . . , (0, . . . , 1, 0, . . . , 0)}
together with their inverses form a finite symmetric generating set for G∞ with
respect to the homotheties δt .
More generally any finite symmetric set with real span containing V1 = g/g2
generates G∞ with respect to δt . Indeed, the group generated by exp∞ (V1 ) is a
connected subgroup of G∞ , so by the Lie correspondence, its Lie algebra is a sub
algebra of g∞ containing V1 . Since V1 generates g∞ as a Lie algebra, the group
generated by exp∞ (V1 ) is all of G∞ .
We can now give a definition of Φ that will a priori depend on a choice of
representation of g ∈ G∞ in the generating set S. Later on we will prove that
there was in fact no choice involved. Let S ⊂ G∞ be the set of 2d′ elements from
Example 5.2.
Definition 5.3 (First Definition of Φ).
where

Φ(g) = δa1 αab (s1 ) ⋆ δa2 αab (s2 ) ⋆ · · · ⋆ δak αab (sk )

g = δ a1 s 1 ⋆ · · · ⋆ δ ak s k
is a fixed choice of a representation of g as in (21).

EQUIVARIANT RANDOM MAPS BETWEEN NILPOTENT GROUPS

21

Proposition 5.4. For each g ∈ G∞ there is a sequence γn ∈ Γ so that
•

1
n

• γn → g

•

1
n

• α(γn , x) → Φ(g) with high probability as n → ∞.

Proof. Fix g ∈ G∞ and the choice of representation of g
g = δ a1 s 1 ⋆ · · · ⋆ δ ak s k

as in (21). For each n ∈ N and each 1 ≤ i ≤ k set mn,i = ⌊nai ⌋, the greatest
integer less than or equal to nai . Then for each 1 ≤ i ≤ k as n → ∞
mn,i
→ ai .
n

(22)
Now define for n ∈ N

mn,1 mn,2
s2

γn = s 1

m

· · · sk n,k .

First notice that for each 1 ≤ i ≤ k we have

1
m
• si n,i → δai si .
n
Therefore by Lemma 2.1
1
• γn → g,
n
giving the first item. For the second item we invoke Theorem 4.1, which says
that whp
d∞ (α(γn , x), δmn,1 αab (s1 ) ⋆ · · · ⋆ δmn,k αab (sk )) = o(max mn,i ).

By (22) the right hand side is o(n). Thus whp as n → ∞

d∞ (δ1/n α(γn , x), δmn,1 /n αab (s1 ) ⋆ · · · ⋆ δmn,k /n αab (sk )) → 0

But as n → ∞

δmn,1 /n αab (s1 ) ⋆ · · · ⋆ δmn,k /n αab (sk ) → Φ(g)

which finishes the proof.

The next Proposition says that


1
n

• α(σn , x) → Φ(g) uniformly as

1
n

• σn → g.

Proposition 5.5. Fix g ∈ G∞ . For all ǫ1 , ǫ2 > 0 there exist δ > 0 and N ∈ N
so that whenever σ ∈ Γ and n ≥ N are such that dG∞ ( n1 • σ, g) < δ, then with
probability at least 1 − ǫ1 we have
1
• α(σ, x), Φ(g)) < ǫ2 .
n
In particular, for any sequence n1 • σn → g we have
probability.
dH∞ (

1
n

• α(σn , x) → Φ(g) in

22

MICHAEL CANTRELL

Proof. Fix g ∈ G∞ and ǫ1 , ǫ2 > 0. Choose δ > 0 small so that κ(1 + ǫ2 )2δ/ǫ1 < ǫ2
where κ = maxs∈S k|α(s, ·)|Λ k1 . Let γn be the sequence from Proposition 5.4.
Choose N large so that for all n ≥ N , dG∞ ( n1 • γn , g) < δ and so that dH∞ ( n1 •
α(γn , x), Φ(g)) < ǫ2 with probability at least 1 − ǫ1 . Choose N larger if necessary
so that the maps sclΓn and sclΛ
n are (1 + ǫ2 )-bi-Lipschitz for all n ≥ N .
Now suppose dG∞ ( n1 • σ, g) < δ where n ≥ N . Then dG∞ ( n1 • σ, n1 • γn ) < 2δ,
which implies dΓ (σ, γn ) < (1 + ǫ2 )n2δ. Set τ = σ −1 γn , so |τ | < (1 + ǫ2 )n2δ. By
Markov’s inequality
m(|α(τ, x)|Λ ≥ κ|τ |/ǫ1 ) ≤ ǫ1
Thus by our choice of δ, with probability at least 1 − ǫ1 , we have
|α(τ, x)| ≤ nǫ2 .
Using the cocycle equation α(γn , x) = α(σ, τ x)α(τ, x) and that sclΛ
n is (1 + ǫ2 )bi-Lipschitz we have
1
1
• α(γn , x), • α(σ, τ x)) < (1 + ǫ2 )ǫ2
n
n
with probability at least 1 − ǫ1 . Since dH∞ ( n1 • α(γn , x), Φ(g)) < ǫ2 with probability at least 1 − ǫ1 , we are done.

dH∞ (

The next Corollary says that the definition of Φ is independent of the choice of
representation of g in the generating set S.
Corollary 5.6. Suppose g ∈ G∞ can be written
g = δa′1 s′1 ⋆ · · · ⋆ δa′k′ s′k′ .

where a′i ∈ R+ and s′i ∈ S. Define

Φ′ (g) = δa′1 αab (s′1 ) ⋆ · · · ⋆ δa′k′ αab (s′k′ ).

Then Φ(g) = Φ′ (g).

Proof. Repeat the proof of Proposition 5.4 with Φ′ in place of Φ. Doing so we obtain
γn′ ∈ Γ so that n1 • γn′ → g and so that δ1/n α(γn′ , x) → Φ′ (g) in probability. By
Proposition 5.5 δ1/n α(γn′ , x) → Φ(g) in probability. Therefore Φ′ (g) = Φ(g).

5.1. Φ is a bi-Lipschitz group automorphism. We can now show that Φ is
a group isomorphism. Since any two Carnot-Carathéodory metrics on the same
Carnot group are bi-Lipschitz to one another, we deduce that Φ is bi-Lipschitz. Let
Ψ denote the result of the above construction applied to the cocycle β instead of
α. By symmetry, all of the results above apply equally to Ψ. We will see that Ψ
and Φ are inverses.
Proposition 5.7. Φ is a homomorphism.
Proof. Fix g, h ∈ G∞ and n1 • γn → g and n1 • σn → h. Then by Lemma 2.1 and
Proposition 5.5
• n1 • α(γn , σn x) → Φ(g) in probability
•

1
n

• α(σn , x) → Φ(h) in probability

EQUIVARIANT RANDOM MAPS BETWEEN NILPOTENT GROUPS

•

1
n

23

• γn σn → gh

• n1 • α(γn σn , x) → Φ(gh) in probability.
Invoking Lemma 2.1 in Λ, with high probability
1
• α(γn , σn x)α(σn , x) → Φ(g) ⋆ Φ(h).
n
Combining this with the fourth item, the proof is complete.



To show that Φ and Ψ are inverse maps, we need the following nilpotent group
variant of Poincaré recurrence.
Lemma 5.8 (Poincaré recurrence for nilpotent groups). Fix g ∈ G∞ and let A ⊂ X
with m(A) > 0. Then
m{x ∈ A : ∃γnk ∈ Γ ∃nk ∈ N such that

1
• γnk → g and γnk · x ∈ A} = m(A).
nk

Lemma 5.9. Fix g ∈ G∞ , let A ⊂ X with m(A) > 0 and let δ > 0. Then
1
• γ, g) < δ and γ · x ∈ A} = m(A).
n
Proof that Lemma 5.9 implies Lemma 5.8. Set
m{x ∈ A : ∃γ ∈ Γ ∃n ∈ N such that d∞ (

Aδ = {x ∈ A : ∃γ ∈ Γ ∃n ∈ N such that d∞ (

1
• γ, g) < δ and γ · x ∈ A}
n

which has measure m(A) by 5.9. Then
A′ = ∩∞
l=1 A1/l

again has measure m(A), and has the desired property.



Proof of Lemma 5.9. Suppose for contradiction that there is g ∈ G∞ , A ⊂ X
with m(A) > 0, δ > 0 and E ⊂ A with m(E) > 0 such that for a.e. x ∈ E,
d∞ ( n1 • γ, g) < δ implies γ · x ∈
/ A.
We claim that there exist infinitely many (nk , γnk ) ∈ N × Γ such that
d∞ ( n1k • γnk , g) < δ and such that if ki < kj then
d∞ (
1
m

1
• γn−1
γ , g) < δ.
ki nkj
nkj

Indeed, pick any (n1 , γn1 ) so that d∞ ( n11 •γn1 , g) < δ. Now consider any sequence
1
→ id as m → ∞, Lemma 2.1 implies that
• γm → g. Since m
• γn−1
1

1
γm → g.
• γn−1
1
m
Thus we may pick n2 := m large to satisfy the claim. Continuing in this way,
the claim is proved.
Now we see that the sets γnk E are pairwise disjoint: indeed, if not, then
m(γn−1
γnkj E ∩ E) > 0.
k
i

24

MICHAEL CANTRELL

which implies that there is a positive measure set of x ∈ E so that γn−1
γ
·x ∈
ki nkj
1
−1
E ⊂ A while d∞ ( nk • γnk γnkj , g) < δ, contradicting the definition of E.
j

i

Thus the sets γnk E are pairwise disjoint. But as m(E) > 0, this is also impossible.


Notice that, while one can formulate the Lemmas 5.8 and 5.9 for any group
together with one of its asymptotic cones, the key ingredient that fails for groups
that are not nilpotent is Lemma 2.1. This is easily seen in the free group.
Proposition 5.10. Φ and Ψ are inverse maps. Consequently, they are group
isomorphisms.
Recall (§2.1) that the fundamental domains X and Y satisfy m(X ∩ Y ) > 0 and
that x ∈ X ∩ Y ∩ γ −1 (X ∩ Y ) implies that β(α(γ, x), x) = γ.
Proof. Fix g ∈ G∞ and ǫ > 0. We will show that d∞ (Ψ(Φ(g)), g) < 2ǫ. Using the
symmetry of α and β, we apply Proposition 5.5 to the cocycle β, the map Ψ and
the element Φ(g) to obtain N ∈ N and δ > 0 so that for any γn ∈ Γ with n ≥ N
and any x ∈ X, for a positive measure set of y ∈ X ∩ Y
1
1
• α(γn , x), Φ(g)) < δ =⇒ dG∞ ( • β(α(γn , x), y).Ψ(Φ(g))) < ǫ.
n
n
Now applying Proposition 5.5 to α, Φ and g we obtain δ ′ > 0 and N ′ ∈ N so
that whenever n ≥ N
(23)

dH∞ (

1
• γn , g) < δ ′
n
implies that for a positive measure subset of X ∩ Y both (23) occurs and
dG∞ (

1
• α(γn , x), Φ(g)) < δ.
n
′
Choose δ < ǫ if necessary, and set N = max(N, N ′ ). Then with positive probability in X ∩ Y , for n ≥ N
dH∞ (

1
1
• γn , g) < δ ′ =⇒ dG∞ ( • β(α(γn , x), x), Ψ(Φ(g))) < ǫ.
n
n
Now we invoke Lemma 5.8 (Poincaré Recurrence) applied to X ∩ Y , g and δ ′ to
assert that with positive probability in X ∩ Y there exists n ≥ N and γn ∈ Γ with
dG∞ ( n1 • γn , g) < δ ′ , such that γn x ∈ X ∩ Y and such that (24) occurs. Therefore
with positive probability
(24)

dG∞ (

dG∞ (

1
• γn , Ψ(Φ(g))) < ǫ
n

and

dG∞ (

1
• γn , g) < ǫ.
n


5.2. Theorem B implies Theorem A.
Proof. We recall the definition of the maps κx,n . For each n ∈ N the maps
sclnG∞ (−) : Γ → G∞ map Γ more and more densely into G∞ and similarly for
∞
sclH
n (−) : Λ → H∞ (see §2). For every g ∈ G∞ and every n ∈ N let jn (g) ∈ Γ be
∞
an element of Γ minimizing the distance between sclG
n (Γ) and g. Then for g ∈ G∞
we define

EQUIVARIANT RANDOM MAPS BETWEEN NILPOTENT GROUPS

25

∞
κx,n (g) = sclH
n (α(jn (g), x)).

G∞
Now fix R > 0, δ > 0 and ǫ > 0. Let BR
(e) denote the ball of radius R > 0 in
(G∞ , d∞ ) about the identity. By Theorem B, for every g ∈ G∞ there is τ = τ (g) > 0
G∞
∞
so that whenever sclG
(e), with probability at least 1 − δ we have
n (γn ) ∈ Bτ
∞
dH∞ (Φ(g), sclH
n (α(γn , x))) < ǫ.
G∞
G∞
By the compactness of BR
(e) we obtain a finite set F ⊂ BR
(e) with the
G∞
property that for every g ∈ BR (e) there is g0 ∈ F so that dG∞ (g, g0 ) < ǫ and so
that

g ∈ BτG(g∞0 )/2 (g0 ).

Now set τ = minF τ (g) and choose N large so that for all n ≥ N , for all
G∞
g ∈ BR
(e) we have
∞
dG∞ (sclG
n (jn (g)), g) < τ /2.
G∞
Then for all n ≥ N and every g ∈ BR
(e) there is g0 ∈ F so that with probability
at least 1 − δ
∞
dH∞ (Φ(g0 ), sclH
n (α(jn (g), x))) < ǫ

and
dG∞ (Φ(g), Φ(g0 )) < Lǫ
where L is the Lipschitz constant for Φ. This finishes the proof.



References
[1] T. Austin, Integrable measure equivalence for groups of polynomial growth, with an appendix
by L. Bowen, available at arXiv:1310.3216.
[2] U. Bader, A. Furman, and R. Sauer, Integrable Measure Equivalence and Rigidity of Hyperbolic Lattices, Invent. Math 194 (2013), no. 2, 313-379.
[3] E. Breuillard, Geometry of locally compact groups of polynomial growth and shape of large
balls, Groups Geom. Dyn. 8 (2014), no. 3, 669–732.
[4] M. Cantrell and A. Furman, Asymptotic Shapes for Ergodic Families of Metrics on Nilpotent
Groups, available at arXiv:1508.00244.
[5] A. Furman, A Survey of Measured Group Theory, Geometry, Rigidity, and Group Actions,
The University of Chicago Press, Chicago and London, 2011, pp. 296-374.
[6] M. Gromov, Groups of polynomial growth and expanding maps, Inst. Hautes Études Sci.
Publ. Math. 53 (1981), 53–73.
, Asymptotic Invariants of Infinite Groups, Geometric Group Theory, Vol. 2 (Nibol
[7]
and Roller, ed.), Vol. 182, Cambridge Univ. Press, Cambridge, 1993. London Math. Soc.
Lecture Series.
[8] Y. l Guivarc’h, Croissance polynmiale et priodes des fonctions harmoniques, Bull. Sc. Math.
France 101 (1973), 353-379.
[9] D. Kyed and H. D. Petersen, Quasi-isometries of Nilpotent Groups, available at
arXiv:1503.04068.
[10] A. I. Mal’cev, On a Class of Homogeneous Spaces, Izvestiya Akad. Nauk. SSSR. Ser. Mat.
13 (1949), 9-32.
[11] D. S. Ornstein and B. Weiss, Ergodic Theory of Amenable Group Actions. I. The Rohlin
Lemma, Bull. Amer. Math. Soc. (N.S.) 2 (1980), no. 1, 161-164.
[12] P. Pansu, Croissance des boules et des géodésiques fermées dans les nilvariétés, Ergodic
Theory Dynam. Systems 3 (1983), no. 3, 415–445 (French, with English summary).

26

MICHAEL CANTRELL

, Metriques de Carnot-Caratheodory et Quasiisometries des Espaces Symetriques de
rang un, The Annals of Mathematics 129 (1989), no. 1, 1-60 (French, with English summary).
[14] R. Sauer, Homological Invariants and Quasi-isometry, Geom. Funct. Anal (GAFA) 16 (2006),
no. 2, 476-515.
[15] Y. Shalom, Harmonic Analysis, Cohomology, and the Large-Scale Geometry of Amenable
Groups, Acta Mathematica 192 (2004), no. 2, 119-185.
[13]

University of Illinois at Chicago, Chicago
E-mail address: mcantr2@uic.edu

