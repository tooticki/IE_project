Kernels of conditional determinantal measures
and the Lyons-Peres Conjecture

arXiv:1612.06751v2 [math.PR] 12 Jul 2017

Alexander I. Bufetov, Yanqi Qiu and Alexander Shamov
Abstract
The main result of this paper, Theorem 1.1, establishes a conjecture of Lyons and Peres: for a determinantal point
process governed by a reproducing kernel, the system of kernels sampled at the particles of a random configuration is complete in the range of the kernel. A key step in the proof, Lemma 1.7, states that conditioning on the
configuration in a subset preserves the determinantal property, and the main Lemma 1.8 is a new local property for
kernels of conditional point processes. Along the way, we prove in Theorem 1.4 the conjecture of Lyons that the
tail sigma-algebra is trivial for determinantal point processes governed by self-adjoint kernels.
Keywords: Determinantal point processes, Lyons-Peres conjecture, conditional measures, tail triviality, measurevalued martingales, operator-valued martingales.

1
1.1

Introduction
The Lyons-Peres Conjecture

Let E be a locally compact σ -compact Polish space, let Conf(E) be the space of locally finite configurations on E.
A point process on E is a Borel probability measure on Conf(E). Let µ be a sigma-finite Radon measure on E, let
K be the kernel of a locally trace class positive contraction acting in the complex Hilbert space L2 (E, µ), and let
PK be the corresponding determinantal measure on Conf(E).
Our main result Theorem 1.1 establishes a conjecture by Lyons and Peres. Let K be a locally trace class
orthogonal projection onto a closed subspace H of L2 (E, µ); in other words, let H ⊂ L2 (E, µ) be a reproducing
kernel Hilbert space, and let K be the reproducing kernel for H. For x ∈ E, introduce a function Kx ∈ L2 (E, µ) by
the formula
Kx (t) := K(t, x), t ∈ E.
(1.1)
The Lyons-Peres Conjecture ( [19, Conjecture 4.6]). For PK -almost every X ∈ Conf(E), we have
spanL

2 (E,µ)

{Kx ; x ∈ X} = H.

(1.2)

The conjecture was inspired by a theorem of Lyons [18, Theorem 7.11] that the completeness of kernels holds
when E is discrete. In the continuous setting, Ghosh [12] established the conjecture under the important additional
assumption that the determinantal point process PK has the Ghosh-Peres number rigidity, which states that for
precompact Borel subset B ⊂ E, the number of particles of a configuration inside B is almost surely determined by
the restricition of this configuration on E \ B. While many determinantal point processes are indeed number rigid
in the sense of Ghosh and Peres (cf. e.g. [12], [13], [4], [7], [8]), a natural example without number rigidity is the
zero set of the Gaussian analytic function on the unit disk D. By the Peres-Virág Theorem [23], our zero set is the
determinantal point process induced by the Bergman kernel
KD (z, w) =

1
,
π(1 − zw̄)2

1

corresponding to the orthogonal projection onto the Bergman space of square-integrable holomorphic functions on
D. By a theorem of Holroyd and Soo [16], the process governed by KD has the property of insertion and deletion
tolerance, the opposite of number rigidity; moreover, in the setting of generalized Bergman spaces on D, insertion
and deletion tolerance is established in [8].

1.2

Kernels of conditional determinantal point processes

The key ingredients in our proof of the Lyons-Peres Conjecture are the preservation of the determinantal structure
under conditioning with respect to the configuration in a subset and a new local property for conditional kernels of
determinantal point processes.
Given a point process P on E, that is, a Borel probability measure P on Conf(E) and any Borel subset C ⊂ E,
the measure P(·|X;C) on Conf(E \C) is defined as the conditional measure of P with respect to the condition that
the restriction of our random configuration onto C coincides with X ∩C (see §2 below for the detailed definition).
Lemma 1.7 establishes that, for any determinantal point process PK induced by a self-adjoint locally trace
class kernel K, the conditional measures PK (·|X;C) are themselves determinantal and governed by explicitly given
self-adjoint kernels. For precompact B, the determinantal property for PK (·|X; B) follows from the characterization
of Palm measures for determinantal processes due to Shirai-Takahashi [29] and the characterization of induced
determinantal processes [3], [6]. For X ∈ Conf(E), in Definition 1.6 below we introduce a specific self-adjoint
kernel K [X, B] governing the measure PK (·|X; B).
In order to prove that conditioning preserves the determinantal property, we shall show that, along an increasing
or a decreasing sequence of precompact subsets B, our specifically chosen kernels K [X, B] form a martingale after
a suitable compression. The one-step martingale property (corresponding to the case of two precompact subsets
B0 = 0/ and B1 = B) for spanning trees is due to Benjamini, Lyons, Peres and Schramm [1] and for processes
on general discrete phase spaces to Lyons [18]. It seems to be essential for the argument of Benjamini, Lyons,
Peres and Schramm [1], Lyons [18] that the phase space be discrete; we do not see how to extend their argument
to continuous phase spaces. Moreover, it requires some efforts to prove fully the martingale property from the
one-step martingale property.
Our proof of the martingale property of the conditional kernels relies on a new local property for the kernels
[X,
K B] which we now informally explain. If B ⊂ C ⊂ E, then conditioning on the restriction of the configuration onto
B commutes with the natural projection map X → X ∩C from Conf(E) to Conf(C). This commutativity manifests
itself on the level of the kernels chosen in Definition 1.6 below: we have χC K [X∩B, B] χC = (χC KχC )[X∩C, B] . Our
local property claims that instead of χC one can take an (almost) arbitrary projection Q, and the relation still holds.
More precisely, let Q : L2 (E, µ) → L2 (E, µ) be an orthogonal projection such that Ran(Q) ⊂ L2 (E \ B, µ) and that
QKQ is locally trace-class. In Lemma 1.8 below we shall see that

[X, B]
(Q + χB )K(Q + χB )
= (Q + χB )K [X, B] (Q + χB ) = QK [X, B] Q.

(1.3)

Applying (1.3) to a one-dimensional projection operator Q, we obtain that, for an arbitrary ϕ ∈ L2 (E \ B, µ),
the quantity hK [X,B] ϕ, ϕi is a martingale indexed by B, cf. (4.3) below. Using the Radon-Nikodym property for
the space of trace-class operators, we obtain an operator-valued martingale that converges, along an increasing
sequence of precompact subsets of E, almost surely in the space of locally trace-class operators. As an immediate
consequence, we prove that for determinantal point processes governed by self-adjoint kernels, conditioning on the
configuration in any Borel subset, preserves the determinantal property, see Lemma 1.7.

1.3

Triviality of the tail σ -algebra

As an application of the local property for the conditional kernels, in Theorem 1.4, we establish the triviality of the
tail sigma-algebra for determinantal point processes governed by self-adjoint kernels. Lyons proved tail-triviality
in the discrete setting in [18], extending the argument of Benjamini-Lyons-Peres-Schramm [1] for spanning trees

2

and conjectured that tail triviality holds in full generality [19, Conjecture 3.2]. The argument of Benjamini-LyonsPeres-Schramm [1] and of Lyons [18] relies on an estimate for the decay of the variance of the conditional kernel;
using the local property of Lemma 1.8, we establish a similar variance estimate in full generality, see Lemma 7.3,
and obtain the desired triviality of the tail sigma-algebra. The local property of conditional kernels thus allows us
to carry out the proof of tail triviality in a unified way for both the continuous and the discrete setting.
The triviality of the tail sigma-algebra for general determinantal point processes with self-adjoint kernels is
the main result of the independent work by Osada and Osada [22]. The argument of Osada-Osada [22] is completely different from ours: Osada-Osada [22] construct a special family of discrete approximations of continuous
determinantal point processes and derive the triviality of the tail sigma-algebra in the continuous setting from the
theorem of Lyons by approximation. Another approach, due to Lyons [private communication], for establishing
the triviality of the tail sigma-algebra in the continuous setting, also proves it from the discrete result using the
Goldman’s transference principle, cf. Goldman [14, Proposition 12] and Lyons [19, Section 3.6].

1.4

Statement of the main results

Let E be a locally compact σ -compact Polish space, equipped with a metric such that any bounded set is relatively
compact, and endowed with a positive σ -finite Radon measure µ. Let Conf(E) be the space of locally finite
configurations on E. Let K be a bounded self-adjoint locally trace class operator K : L2 (E, µ) → L2 (E, µ) such
that the spectrum spec(K) ⊂ [0, 1]. A theorem obtained by Macchi [20] and Soshnikov [32], as well as Shirai and
Takahashi [28], gives a unique point process on E, denoted by PK , such that for any compactly supported bounded
measurable function g : E → C, we have
h
i


g
EPK ∏ (1 + g(x)) = det 1 + sgn(g)|g|1/2 · K · |g|1/2 2 , sgn(g) = .
|g|
L (µ)
x∈X
Here det(1 + S) denotes the Fredholm determinant of the operator 1 + S, see, e.g., Simon [31].
The locally trace class self-adjoint operator K is an integral operator. Following Soshnikov [32], we fix a Borel
subset E0 ⊂ E with µ(E \ E0 ) = 0 and fix a Borel function K : E0 × E0 → C, our kernel, in such a way that for any
k ∈ N and any bounded Borel subset B ⊂ E, we have
k

tr((χB KχB ) ) =

Z
Bk

K(x1 , x2 )K(x2 , x3 ) · · · K(xk , x1 )dµ(x1 ) · · · dµ(xk ).

(1.4)

Theorem 1.1 (Lyons-Peres conjecture). Let K be a locally trace-class orthogonal projection onto a subspace H of
L2 (E, µ). Then for PK -almost every X ∈ Conf(E), the functions Kx defined by (1.1) satisfy
spanL

2 (E,µ)

{Kx ; x ∈ X} = H.

Remark 1.2. We mention that our assumption on σ -compactness of E is not essential. In fact, all our results are
valid by replacing everywhere “relatively compact” by “with K(x, x)dµ(x)-finite measure”. Therefore, Lyons-Peres
conjecture holds in full generality.
If we fix a realization for each h ∈ H in such a way that the equation h(x) = hh, Kx i holds for every x ∈ E0 and
every h ∈ H, then Theorem 1.1 can equivalently be reformulated as follows:
Corollary 1.3. For PK -almost every X ∈ Conf(E), if h ∈ H satisfies hX = 0, then h = 0.
Theorem 1.4. Let B1 ⊂ · · · ⊂ Bn ⊂ · · · ⊂ E be an increasing exhausting sequence of bounded Borel subsets of E.
T
The σ -algebra n∈N F(E \ Bn ) is trivial with respect to PK .
Corollary 1.5. The point process PK has trivial tail σ -algebra.

3

1.4.1

Key lemma

Definition 1.6. For any bounded Borel subset B ⊂ E, we define canonical conditional kernels K [X, B] with respect
to the conditioning on the configuration in B as follows:
• For p ∈ E0 , define a kernel K p , for (x, y) ∈ E0 × E0 , by the formula

K(x, p)K(p, y)

if K(p, p) > 0
K(x, y) −
.
K p (x, y) :=
K(p, p)

0
if K(p, p) = 0
• For an n-tuple (p1 , · · · , pn ) ∈ E0n , define a kernel K p1 ,··· ,pn = (· · · (K p1 ) p2 · · · ) pn as follows (cf. ShiraiTakahashi [29, Corollary 6.6]). Given x, y ∈ E0 , write p0 = x, q0 = y, qi = pi for 1 ≤ i ≤ n, and set

 det[K(pi , q j )]0≤i, j≤n
if det[K(pi , p j )]1≤i, j≤n > 0
p1 ,··· ,pn
K
(x, y) :=
(1.5)
det[K(pi , p j )]1≤i, j≤n

0
if det[K(pi , p j )]1≤i, j≤n = 0
• For a bounded Borel subset B ⊂ E and X ∈ Conf(E) such that X ∩ B = {p1 , . . . , pl } ⊂ E0 , define

χE\B K p1 ,...,pl (1 − χB K p1 ,...,pl )−1 χE\B if 1 − χB K p1 ,...,pl is invertible
[X, B]
K
=
.
0
if 1 − χB K p1 ,...,pl is not invertible

(1.6)

We will see later, from the inequalities (3.5) and (3.6), that if 1 − χB K p1 ,...,pl is invertible, then the operator
χB K p1 ,...,pl is strictly contractive. Therefore, the series
∞

K [X, B] = χE\B ∑ K p1 ,...,pl (χB K p1 ,...,pl )n χE\B
n=0

converges in the operator norm topology. In particular, for (x, y) ∈ E0 × E0 , we will use the formula
K [X, B] (x, y) =χE\B (x)χE\B (y)K p1 ,...,pl (x, y)
D ∞

E
+ χE\B (x)χE\B (y) ∑ (χB K p1 ,...,pl )n−1 (χB (·)K p1 ,...,pl (·, y)), K p1 ,...,pl (·, x)

(1.7)

L2 (E,µ)

n=1

as our specific Borel realization of the kernel for the operator K [X, B] .
Remark. We will see in Proposition 2.5 below that K [X, B] is the correlation kernel for the conditional measure of
PK , the condition being that the configuration on B coincides with X ∩ B. In particular, for PK -almost every X, we
have X ∩ B = {p1 , · · · , pl } ⊂ E0 and 1 − χB K p1 ,...,pl is invertible. The second case K [X,B] = 0 has probability zero.
Note that the range of K [X, B] is contained in L2 (E \ B, µ) and we have
K [X, B] = χE\B K [X, B] χE\B .
For any Borel subset W ⊂ E, not necessarily bounded, consider the Borel surjection πW : Conf(E) → Conf(W )
given by X 7→ X ∩W . Fibres of this mapping can be identified with Conf(E \W ). For a Borel probability measure
P on Conf(E), the measure P(·|X;W ) on Conf(E \ W ) is defined as the conditional measure of P with respect to
the condition that the restriction of our random configuration onto W coincides with πW (X). More formally, the
measures P(·|X;W ) are conditional measures, in the sense of Rohlin [27], of our initial measure P on fibres of the
measurable partition induced by the surjection πW .
Denote by L1 (L2 (E, µ)) the space of trace class operators on L2 (E, µ) and by L1,loc (L2 (E, µ)) the space of
bounded and locally trace class operators on L2 (E, µ). The space L1,loc (L2 (E, µ)) is equipped with the topology
induced by the semi-norms T 7→ kχB T χB k1 , where k · k1 is the trace class norm, B ranges over bounded Borel
subsets of E.
For any Borel subset W ⊂ E, we denote by F(W ) := σ (#A : A ⊂ W ) the σ -algebra on Conf(E) generated by
the mappings #A : Conf(E) → R defined by #A (X) := #(X ∩ A), where A ranges over all bounded Borel subsets of
W . We are now ready to formulate our key lemma.

4

Lemma 1.7. Let W ⊂ E be a Borel subset, let B1 ⊂ · · · ⊂ Bn ⊂ · · · ⊂ W be an increasing exhausting sequence
of bounded Borel subsets of W . For PK -almost every X ∈ Conf(E) there exists a positive self-adjoint contraction
K [X,W ] ∈ L1,loc (L2 (E \W, µ)) such that
n→∞

χE\W K [X, Bn ] χE\W −−−−−−−−−−−−→ K [X,W ]
in L1,loc (L2 (E \W, µ))

and
PK (·|X,W ) = PK [X,W ] .
Remark. For fixed W , the kernel-valued function X 7→ K [X,W ] almost surely does not depend on the choice of the
approximating sequence B1 ⊂ · · · ⊂ Bn ⊂ · · · ⊂ W .
1.4.2

The local property and the martingale lemma

At the centre of our argument lies
Lemma 1.8 (First local property of conditional kernels). Let B ⊂ E be a bounded Borel subset and let Q be an
orthogonal projection, acting in L2 (E, µ), such that Ran(Q) ⊂ L2 (E \ B, µ) and the operator QKQ is locally trace
class. For PK -almost every X ∈ Conf(E), we have

[X, B]
(Q + χB )K(Q + χB )
= (Q + χB )K [X, B] (Q + χB ) = QK [X, B] Q.

(1.8)

Remark. The formula (1.8) is a strengthening, on the level of kernels, of the general property of point processes
that conditioning on the restriction to a subset commutes with the forgetting projection onto a larger subset; see
Proposition 2.4 below. The local property can be interpreted in terms of Neretin’s formalism in [21]: a determinantal measure is viewed as a “determinantal state” on a specially constructed algebra, and in order that conditional
states themselves be determinantal the local property must take place. The local property can thus be seen as the
noncommutative analogue of the fact that the operation of conditioning commutes with the operation of restriction
of a configuration onto a subset.
Let A, B be two disjoint bounded Borel subsets of E. It is a general property of point processes that conditioning
first on A and then on B amounts to a single conditioning on A ∪ B. A manifestation of this general property on the
level of kernels is
Lemma 1.9 (Second local property of conditional kernels). Let A, B be two disjoint bounded Borel subsets of E.
For PK -almost every X ∈ Conf(E), we have
(K [X, A] )[X, B] = (K [X, B] )[X, A] = K [X, A∪B] .
Using the local properties, we establish the following key martingale property of the kernels K [X,B] .
Lemma 1.10. Let W ⊂ E be a Borel subset, let B1 ⊂ · · · ⊂ Bn ⊂ · · · ⊂ W be an increasing exhausting sequence of
bounded Borel subsets of W . The sequence of random variables


χE\W K [X, Bn ] χE\W
n∈N

is an (F(Bn ))n∈N -adapted operator-valued martingale defined on the probability space (Conf(E), F(E), PK ).
By definition, we have K [X, B] = K [X∩B, B] . Hence the mapping X 7→ K [X, B] is an F(B)-measurable operatorvalued random variable defined on the probability space
F(E), PK). Lemma 1.10 is equivalent to the

 (Conf(E),
2
[X,
B
]
n
claim that, for any ϕ ∈ L (E \ W, µ), the sequence χE\W K
χE\W ϕ, ϕi n∈N is an (F(Bn ))n∈N -adapted realvalued martingale defined on the probability space (Conf(E), F(E), PK ). This notion of being a martingale is
equivalent to the general notion of Frechet space valued martingales, cf. Pisier [26].

5

Remark. The proof of Lemma 1.10 below in fact yields a stronger statement: the sequence of exterior power
operators

∧m 
χE\W K [X, Bn ] χE\W
n∈N

is an (F(Bn ))n∈N -adapted operator-valued martingale,
defined on the probability space (Conf(E), F(E), PK ) and
∧m
.
almost surely convergent to χE\W K [X,W ] χE\W

2

Conditional processes and martingales

2.1

Martingales and the Radon-Nikodym property

2.1.1

Vector-valued and measure-valued martingales

Let (Ω, F , (Fn )∞
n=1 , P) be a filtered probability space. Let B be a Banach space. A map F : Ω → B is called
Bochner measurable, if there exists a sequence Fn of measurable, in the usual sense, step functions such that
Fn (ω) → F(ω) almost everywhere. For any
1 ≤ p < ∞, we denote by L p (Ω, F , P; B) the set of all Bochner
R
p
P(dω) < ∞. The space L p (Ω, F , P; B) is a Banach space
measurable functions F : Ω → B, such that Ω kF(ω)kB
with the norm
Z
p
kFkL p (B) := ( kF(ω)kB
P(dω))1/p .
Ω

The algebraic tensor product

L p (Ω, F , P) ⊗ B

is dense in L p (Ω, F , P; B). The operator

E[·|Fn ] ⊗ IdB : L p (Ω, F , P) ⊗ B → L p (Ω, F , P) ⊗ B
extends uniquely to a bounded linear operator on L p (Ω, F , P; B), for which we keep the name “conditional expectation” and the notation, thus obtaining the operator E[·|Fn ] : L p (Ω, F , P; B) → L p (Ω, F , P; B). A sequence
p
∞
(Rn )∞
n=1 in L (Ω, F , P; B) is called an (Fn )n=1 -adapted martingale if Rn = E[Rn+1 |Fn ] for any n ∈ N.
Assume now that B is a separable space. Then there exists a countable subset D of the unit ball of the dual
space B∗ such that for any x ∈ B, we have kxk = supξ ∈D |ξ (x)|. We will need the Pettis measurability theorem for
separable Banach spaces.
Proposition 2.1 ([24, p. 278]). A function F : Ω → B is Bochner measurable with respect to F if and only if
p
for any ξ ∈ D, the scalar function ω → ξ (F(ω)) is F -measurable. A sequence (Rn )∞
n=1 in L (Ω, F , P; B) is
∞
∞
an (Fn )n=1 -adapted martingale if and only if for any ξ ∈ D, the sequence (ξ (Rn ))n=1 is an (Fn )∞
n=1 -adapted
martingale.
In this paper, we apply Proposition 2.1 in the particular case when B = L1 (L2 (E, µ)) and D is the set of
contractive finite rank operators on L2 (E, µ). Martingales in L1,loc (L2 (E, µ)) are reduced to the previous case by
restricting onto L2 (B, µ) with B a bounded Borel subset of E.
Let (T, A ) be topological space equipped with the σ -algebra of Borel subsets of T . We denote by P(T, A ) the
set of probability measures on (T, A ). A map M : Ω → P(T, A ) is called a random probability measure if for any
A ∈ A , the map ω 7→ M(ω, A) := M(ω)(A) is measurable. A sequence of random probability measures (Mn )∞
n=1
is called an (Fn )∞
n=1 -adapted measure-valued martingale on (T, A ) if for any A ∈ A , the sequence (Mn (·, A))n∈N
is a usual (Fn )∞
n=1 -adapted martingale.
2.1.2

The Radon-Nikodym property

In proving convergence of conditional kernels, we will use the Radon-Nikodym property for the space of trace class
operators. Here we briefly recall the Radon-Nikodym property for Banach spaces; see Dunford-Pettis [11], Phillips
[25] and Chapter 2 in Pisier’s recent monograph [26] for a more detailed exposition.

6

Let B be a Banach space. Let (Ω, F ) be a measurable space. Any σ -additive map m : F → B is called a
(B-valued) vector measure. A vector measure m is said to have finite total variation if
sup

n

n
o
G


km(A
)k
Ω
=
A
is
a
measurable
partition
of
Ω
< ∞.
i B
i
∑
n

i=1

i=1

Given a probability measure P on (Ω, F ), we say that the vector measure m is absolutely continuous with respect
to P if there exists a non-negative function w ∈ L1 (Ω, F , P) such that
km(A)kB ≤

Z

wdP
A

for any A ∈ F .

Definition 2.2. A Banach space B is said to have the Radon-Nikodym property if for any probability space
(Ω, F , P) and any B-valued measure m on (Ω, F ), with m having finite total variation and being absolutely
continuous with respect to P, there exists a Bochner integrable function Fm ∈ L1 (Ω, F , P; B) such that
Z

m(A) =

Fm dP
A

for any A ∈ F .

By Theorem 2.9 in Pisier [26], the Radon-Nikodym property is equivalent to either of the two requirements
1. Every B-valued martingale bounded in L1 (B) converges almost surely;
2. Every uniformly integrable B-valued martingale bounded in L1 (B) converges almost surely and in L1 (B).
Corollary 2.15 in Pisier [26] states that if B is separable and is a dual space of another Banach space, then B
has the Radon-Nikodym property. The separable space L1 (L2 (E, µ)) of trace class operators on L2 (E, µ) is the
dual space of the space of compact operators on L2 (E, µ), and we have
Proposition 2.3. The space L1 (L2 (E, µ)) has the Radon-Nikodym property.

2.2

Conditional measures of point processes

Let E be a locally compact σ -compact Polish space, endowed with a positive σ -finite Radon measure µ. We assume
that the metric on E is such that any bounded set is relatively compact, see Hocking and Young [15, Theorem 2-61].
A configuration X = {xi } on E is by definition a locally finite countable subset of E, possibly with multiplicities.
A configuration is called simple if all points in it have multiplicity one. Let Conf(E) denote the set of all configurations on E. The mapping X 7→ NX := ∑i δxi embeds Conf(E) into the space of Radon measures on E. Under the
vague topology, Conf(E) is a Polish space, see, e.g., Daley and Vere-Jones [10, Theorem 9.1. IV]. By definition, a
point process on E is a Borel probability measure P on Conf(E). We call P simple if P({X : X is simple}) = 1.
For a Borel subset W ⊂ E, let F(W ) be the σ -algebra on Conf(E) generated by all mappings X 7→ #B (X) :=
#(X ∩ B), where B ⊂ W are bounded Borel subsets; the algebra F(E) coincides with the Borel σ -algebra on
Conf(E).
Take a Borel subset W ⊂ E. A Borel probability measure P on Conf(E) can be viewed as a measure on
Conf(W ) × Conf(W c ); we shall sometimes write P = PW,W c to stress dependence on W .
Denote by (πW )∗ (P) the image measure of P under the surjective mapping πW : Conf(E) → Conf(W ) defined
by πW (X) = X ∩W . By disintegrating the probability measure PW,W c , for (πW )∗ (P)-almost every configuration X0 ∈
Conf(W ), there exists a probability measure, denoted by P(·|X0 ,W ), supported on {X0 } × Conf(W c ) ⊂ Conf(E),
such that
Z
PW,W c =
P(·|X0 ,W )(πW )∗ (P)(dX0 ).
Conf(W )

The measure P(·|X0 ,W ) is referred to as the conditional measure on Conf(W c ) or conditional point process on W c
of P, the condition being that the configuration on W coincides with X0 . In what follows, we denote also
P(·|X,W ) := P(·|X ∩W,W ),

for P-almost every configuration X ∈ Conf(E).

7

Moreover, for a random variable f ∈ L1 (Conf(E), P), we will denote by
EP ( f |X,W ) := EP [ f |F(W )](X ∩W ).
Proposition 2.4. Let W1 ,W2 be two disjoint Borel subsets of E. For P-almost every X ∈ Conf(E), we have
(πW1 ∪W2 )∗ [P](·|X,W1 ) = (πW1 ∪W2 )∗ [P(·|X,W1 )].

(2.1)

Proof. First we have
Z

P=

Z

Conf(E)

P(·|X,W1 )P(dX) and (πW1 ∪W2 )∗ [P] =

Conf(E)

(πW1 ∪W2 )∗ [P(·|X,W1 )]P(dX).

Since P(·|X,W1 ) is supported on the subset {Y ∈ Conf(E) : Y ∩ W1 = X ∩ W1 }, and (πW1 ∪W2 )∗ [P(·|X,W1 )] is supported on {Z ∈ Conf(C ∪ B) : Z ∩ B = X ∩ B}, by the uniqueness of conditional measures, we get (2.1).
Since P(·|X,W ) is by definition supported on {X ∩ W } × Conf(W c ), we consider P(·|X,W ) as a measure on
Conf(W c ). Further identifying Conf(W c ) with the subset Conf(E,W c ) := {X ∈ Conf(E) : X ∩W = 0}
/ ⊂ Conf(E),
when it is necessary, we may also view P(·|X,W ) as a measure on Conf(E) supported on the subset Conf(E,W c ).

2.3

Palm measures

The n-th correlation measure ρn,P of a point process P on E, if it exists, is the unique σ -finite Borel measure on E n
satisfying
Z
j
#(X ∩ Ai )!
k
dP(X),
ρn,P (Ak11 × · · · × A j j ) =
∏
Conf(E) i=1 (#(X ∩ Ai ) − ki )!
for all bounded disjoint Borel subsets A1 , · · · , A j ⊂ E and positive integers k1 , · · · , k j with k1 + · · · + k j = n. Here if
#(X ∩ Ai ) < ki , we set #(X ∩ Ai )!/(#(X ∩ Ai ) − ki )! = 0.
For example, the n-th correlation measure of a determinantal process PK is given by
ρn,PK (dx1 · · · dxn ) = det(K(xi , x j ))1≤i, j≤n · µ ⊗n (dx1 · · · dxn ),
where K(x, y) is the integral kernel of the operator K satisfying (1.4).
Assume that P is a simple point process on E such that ρn,P exists for any n ∈ N. The reduced n-th order
! of P is a σ -finite measure on E n × Conf(E) satisfying
Campbell measure Cn,P
Z
E n ×Conf(E)

!
(dx × dX) =
F(x, X)Cn,P

Z

h

#

∑

Conf(E) x∈X n

i
F(x, X \ {x1 , · · · , xn }) P(dX),

for any Borel function F : E n × Conf(E) → R+ . Here ∑# is the summation over all ordered n-tuples (x1 , · · · , xn )
! (dx × dX), we obtain
with distinct coordinates x1 , · · · , xn ∈ X. Disintegrating Cn,P
Z
E n ×Conf(E)

!
F(x, X)Cn,P
(dx × dX)

Z

=
En

Z

ρn,P (dx)

F(x, X)Px (dX),

(2.2)

Conf(E)

where the probability measures Px are defined for ρn,P -almost every x ∈ E n and are called reduced Palm measures
of P. In what follows, by Palm measures we always mean reduced Palm measures. Since Px1 ,··· ,xn is invariant under
permutation of the coordinates in (x1 , · · · , xn ), we may write
PX := Px1 ,··· ,xn ,

if X = {x1 , · · · , xn }.

8

2.4

Determinantal point processes, conditioning on bounded subsets

Let W ⊂ E be a Borel subset. Recall that, by definition, the push-forward (πW )∗ (PK ) is a determinantal point
process on W , induced by a correlation kernel χW KχW . We next recall, for determinantal point processes, the form
of conditional measures with respect to restricting the configuration on a bounded subset.
Recall that Conf(W ) is identified as a subset {X ∈ Conf(E) : X ⊂ W } of Conf(E). Given a point process P on
E, that is, a Borel probability on Conf(E), we set

 PConf(W )
, if P(Conf(W )) > 0
PConf(W ) :=
.
(2.3)
P(Conf(W ))

0,
if P(Conf(W )) = 0
Let B ⊂ E be a bounded Borel subset. If PK (Conf(Bc )) > 0, then, by [6, Proposition 2.1], PK Conf(Bc ) is a determinantal point process on Bc induced by the correlation kernel χBc K(1 − χB K)−1 χBc ; in the discrete setting, see
also Borodin and Rains [2], Lyons [18]. The reader is also referred to [9] for conditional measures of generalized
Ginibre point processes. Next, By a Theorem of Shirai and Takahashi [29, Theorem 1.7], for PK -almost every
X ∈ Conf(E), the Palm measure PX∩B
is a determinantal point process on E, induced by the correlation kernel
K
K X∩B = K p1 ,··· ,pn ,

if X ∩ B = {p1 , · · · , pn };

Summing up, we obtain
Proposition 2.5. PK (·|X, B) is a determinantal point process on Bc for PK -almost every X ∈ Conf(E), induced by
a correlation kernel K [X, B] defined in (1.6).
Proof. Indeed, by Proposition 8.1 in the Appendix below, for PK -almost every X ∈ Conf(E), we have
PK (·|X, B) = PX∩B
K Conf(Bc ) = PK [X, B] .
Proposition 2.6. If K is the orthogonal projection onto a closed subspace H ⊂ L2 (E, µ), then the kernel K p1 ,··· ,pn
corresponds to the orthogonal projection from L2 (E, µ) onto the subspace
H(p1 , · · · , pn ) := {h ∈ H : h(p1 ) = · · · = h(pn ) = 0}.
Moreover, for a bounded Borel subset B ⊂ E, the operator K [X, B] is the orthogonal projection onto the closure of
the subspace
χE\B H(X ∩ B) = {χE\B h : h ∈ H(X ∩ B)}.
Proof. The first assertion can be proved by induction on n, by noting that K p1 ,··· ,pn = ((K p1 )··· ) pn . In particular,
1 )K(p1 ,y)
when n = 1, the equality K p1 (x, y) = K(x, y) − K(x,p
implies that K p1 = K − ΠKp1 where ΠKp1 is the oneK(p1 ,p1 )
rank orthogonal projection onto the linear space spanned by the function Kp1 (·) = K(·, p1 ). Therefore, K p1 is the
orthogonal projection onto H(p1 ).
The second assertion is an immediate consequence of [5, Proposition 2.5]

3
3.1

The local property: proof of Lemmata 1.8, 1.9.
Proof of Lemma 1.8.

Let B ⊂ E be a bounded Borel subset and let Q : L2 (E, µ) → L2 (E, µ) be an orthogonal projection whose range
satisfies Ran(Q) ⊂ L2 (E \ B, µ) and such that QKQ is locally trace-class. Introduce a positive contractive locally
trace-class operator R by the formula
R = R(K, B, Q) := (Q + χB )K(Q + χB ).

(3.1)

Recall that from the introduction, we fixed a Borel subset E0 ⊂ E, such that µ(E \E0 ) = 0 and the kernel K(x, y)
is well-defined on E0 × E0 . Recall also the notation introduced in Definition 1.6.

9

Lemma 3.1. Let R be the operator introduced in (3.1). For any p ∈ B ∩ E0 , we have R p = (Q + χB )K p (Q + χB ).
More generally, for (p1 , · · · , pn ) ∈ (B ∩ E0 )n , we have
R p1 ,··· ,pn = (Q + χB )K p1 ,··· ,pn (Q + χB ).
In particular,
RX∩B = (Q + χB )K X∩B (Q + χB ),

for PK -almost every X ∈ Conf(E).

Proof. Take an orthonormal basis ϕi of the range Ran(Q) ⊂ L2 (E \ B, µ) of Q and write
Q=

∑ ϕi ⊗ ϕi .
i∈N

We may assume that the values ϕi (x) are well-defined for any index i ∈ N and any x ∈ E0 . Observe that for any
p ∈ B ∩ E0 , we have
R(·, p) = (Q + χB )[K(·, p)].

(3.2)

Indeed, write
R = ( ∑ ϕi ⊗ ϕi )K( ∑ ϕ j ⊗ ϕ j ) + ( ∑ ϕi ⊗ ϕi )KχB + χB K( ∑ ϕ j ⊗ ϕ j ) + χB KχB ,
i∈N

j∈N

i∈N

j∈N

since p ∈ B ∩ E0 , we get for any x ∈ E0 :
Z

R(x, p) =

∑ ϕi (x)
i∈N

=

ϕi (y)K(y, p)µ(dy) + χB (x)K(x, p)
E

∑ ϕi (x)hK(·, p), ϕi i + χB (x)K(x, p),
i∈N

which is equivalent to (3.2). Since R(p, p) = K(p, p), we have
R(·, p) ⊗ R(·, p)
(Q + χB )[K(·, p)] ⊗ (Q + χB )[K(·, p)]
= (Q + χB )K(Q + χB ) −
R(p, p)
K(p, p)
h
i
K(·, p) ⊗ K(·, p)
= (Q + χB ) K −
(Q + χB ) = (Q + χB )K p (Q + χB ).
K(p, p)

Rp = R −

The formula for R p1 ,··· ,pn follows immediately by induction on n.
Recall that, by our discussion in §2.4, the kernel χE\B K(1 − χB K)−1 χE\B is a correlation kernel for the determinantal point process PK Conf(Bc ) , provided that PK (Conf(Bc )) > 0.
Lemma 3.2. Let B be a bounded Borel subset of E such that PK (#B = 0) > 0. Let R be the operator introduced in
(3.1). Then

χE\B R(1 − χB R)−1 χE\B = Q χE\B K(1 − χB K)−1 χE\B Q.
(3.3)
Proof. The gap probability PK (#B = 0) is given by
PK (#B = 0) = PK ({X : X ∩ B = 0})
/ = det(1 − χB KχB ) > 0.

(3.4)

It follows that 1 − χB KχB is invertible and hence 1 is not an eigenvalue of χB KχB . But since χB KχB is a priori
a positive contraction and χB KχB is compact, its norm coincides with its maximal eigenvalue. Hence χB KχB is
strictly contractive. But we also have
kχB KχB k = k(χB K 1/2 )(χB K 1/2 )∗ k = kχB K 1/2 k2 < 1.

10

(3.5)

Hence
kχB Kk ≤ kχB K 1/2 kkK 1/2 k < 1.

(3.6)

Therefore, both χB K and χB R = χB K(Q + χB ) are strictly contractive. In particular, the operators on both the left
hand side and the right hand side of (3.3) are well-defined.
Since Q commutes with χE\B , we have
χE\B RχE\B = QχE\B KχE\B Q and χE\B RχB = QχE\B KχB .
Since χB RχB = χB KχB , for n ≥ 1, we have
χE\B R(χB R)n χE\B = χE\B R(χB R) · · · (χB R)χE\B = χE\B RχB (χB RχB )n−1 χB RχE\B =
= QχE\B KχB (χB KχB )n−1 χB KχE\B Q = QχE\B K(χB K)n χE\B Q. (3.7)
Now since χB R and χB K are both strictly contractive, we finally write
χE\B R(1 − χB R)−1 χE\B =

∞

∑ χE\B R(χB R)n χE\B =

n=0

∞

=

∑ QχE\B K(χB K)n χE\B Q = QχE\B K(1 − χB K)−1 χE\B Q.

(3.8)

n=0

Conclusion of the proof of Lemma 1.8. By Proposition 8.1 and Proposition 2.5,
PK (·|X, B) = (PK )X∩B Conf(Bc ) = PK X∩B Conf(Bc ) ,

for P-almost every X ∈ Conf(E).

By definition (2.3) of the normalized restriction measure PK X∩B Conf(Bc ) , we must have
PK X∩B (#B = 0) = PK X∩B (Conf(Bc )) > 0,

for PK -almost every X ∈ Conf(E).

(3.9)

Lemma 3.2 applied to the operators K X∩B and RX∩B and Lemma 3.1 now imply Lemma 1.8.

3.2

Proof of Lemma 1.9

Choose an arbitrary unit vector ϕ ∈ L2 (E \ (A ∪ B), µ), let Q be the orthogonal projection from L2 (E, µ) onto the
one dimensional subspace spanned by ϕ. Define
R = Rϕ := (χA + χB + Q)K(χA + χB + Q).
Arguing as in the proof of Lemma 1.8, we obtain the PK -almost sure equalities
R[X, A] = (χB + Q)K [X, A] (χB + Q);

R[X, A∪B] = QK [X, A∪B] Q;

(R[X, A] )[X, B] = Q(K [X, A] )[X, B] Q.

We also have the following description of conditional measures:
PR (·|X, A) = PR[X, A] and PR (·|X, A ∪ B) = PR[X, A∪B] ,

for PR -almost every X ∈ Conf(E).

The above first equality implies that


PR (·|X, A) (·|X, B) = PR[X, A] (·|X, B) = P(R[X, A] )[X, B] ,

for PR -almost every X ∈ Conf(E).

11

(3.10)

Now we may apply the measure-theoretic identity


PR (·|X, A) (·|X, B) = PR (·|X, A ∪ B),

for PR -almost every X ∈ Conf(E)

and obtain
PR[X, A∪B] = P(R[X, A] )[X, B] ,

for PR -almost every X ∈ Conf(E).

(3.11)

It follows that for PR -almost every X ∈ Conf(E), we have







EPR #(X ∩ (E \ (A ∪ B))X, A ∪ B = tr χE\(A∪B) R[X, A∪B] χE\(A∪B) = tr χE\(A∪B) (R[X, A] )[X, B] χE\(A∪B) .
Combining with (3.10), we obtain the PR -almost sure equality




tr χE\(A∪B) QK [X, A∪B] QχE\(A∪B) = tr χE\(A∪B) Q(K [X, A] )[X, B] QχE\(A∪B) .
That is,
hK [X, A∪B] ϕ, ϕi = h(K [X, A] )[X, B] ϕ, ϕi,

for PR -almost every X ∈ Conf(E).

Since ϕ is arbitrary and since L2 (E \ (A ∪ B), µ) is separable and both K [X, A∪B] and (K [X, A] )[X, B] are supported on
L2 (E \ (A ∪ B), µ), we obtain
K [X, A∪B] = (K [X, A] )[X, B] ,

for PR -almost every X ∈ Conf(E).

(3.12)

Observe that the equality χA∪B RχA∪B = χA∪B KχA∪B implies the equality (πA∪B )∗ (PR ) = (πA∪B )∗ (PK ). Combining
with (3.12) and the fact that K [X, A∪B] and (K [X, A] )[X, B] are F(A ∪ B)-measurable, we get the desired equality
K [X, A∪B] = (K [X, A] )[X, B] ,

4

for PK -almost every X ∈ Conf(E).

The martingale property: proof of Lemma 1.10.

Proposition 4.1. For any bounded Borel subset B ⊂ E, we have
EPK (K

[X, B]

Z

)=
Conf(E)

K [X, B] PK (dX) = χE\B KχE\B .

(4.1)

Remark. Extending the argument of Benjamini, Lyons, Peres and Schramm [1] for the case of spanning trees,
Lyons [18, Lemma 7.17] proved (4.1) when E is discrete and K is an orthogonal projection on `2 (E). Our proof,
based on the local property, is quite different and works both in the continuous and the discrete setting.
Proof of Lemma 1.10 assuming Proposition 4.1. Applying Proposition 4.1 to the kernel K [X, Bn ] and the bounded
Borel subset Bn+1 \ Bn ⊂ E \ Bn , we obtain
h
i
EP [X, Bn ] (K [X, Bn ] )[X, Bn+1 \Bn ] = χE\Bn+1 K [X, Bn ] χE\Bn+1 , for PK -almost every X.
K

The equality PK [X, Bn ] = PK (·|X, Bn ) now yields

h
i
h
i

EP [X, Bn ] (K [X, Bn ] )[X, Bn+1 \Bn ] = EPK (K [X, Bn ] )[X, Bn+1 \Bn ] F(Bn ) ,
K

12

for PK -almost every X.

Combining with Lemma 1.9, we get

h
i

EPK K [X, Bn+1 ] F(Bn ) = χE\Bn+1 K [X, Bn ] χE\Bn+1 ,

for PK -almost every X.

By linearity of the composition on the left and on the right with the operator of multiplication by χE\W and the
elementary equalities χE\W · χE\Bn+1 = χE\W , we get the desired martingale property:

h
i

[X, Bn+1 ]
E χE\W K
χE\W F(Bn ) = χE\W K [X, Bn ] χE\W , for PK -almost every X.

Proof of Proposition 4.1. Let ϕ ∈ L2 (E \ B, µ) be such that kϕk2 = 1. We use (3.1) for Q = ϕ ⊗ ϕ, the orthogonal
projection onto the one-dimensional space spanned by ϕ, and thus set
R = (ϕ ⊗ ϕ + χB )K(ϕ ⊗ ϕ + χB ).
We have the clear identity
(πB )∗ (PR ) = PχB RχB = PχB KχB = (πB )∗ (PK ).

(4.2)

By Lemma 1.8, for PK -almost every X ∈ Conf(E), we have
R[X, B] = QK [X, B] Q = (ϕ ⊗ ϕ)K [X, B] (ϕ ⊗ ϕ).
Since clearly K [X, B] = K [X∩B, B] and R[X, B] = R[X∩B, B] , the above equality holds for PR -almost every X ∈ Conf(E).
Now recall that PR (·|X, B) = PR[X, B] , for PR -almost every X ∈ Conf(E). Hence





EPR #E\B X, B = EP [X, B] #E\B = tr(χE\B R[X, B] χE\B ) = hK [X, B] ϕ, ϕi, for PR -almost every X ∈ Conf(E).
R

Consequently,


EPR #E\B = tr(χE\B RχE\B ) = tr(QKQ) = hKϕ, ϕi.
On the other hand,








EPR #E\B = EPR EPR #E\B X, B = EPR hK [X, B] ϕ, ϕi ,
whence



EPR hK [X, B] ϕ, ϕi = hKϕ, ϕi.

The relation K [X, B] = K [X∩B, B] and the identity (4.2) together give








EPR hK [X, B] ϕ, ϕi = EPR hK [X∩B, B] ϕ, ϕi = EPK hK [X∩B, B] ϕ, ϕi = EPK hK [X, B] ϕ, ϕi
and



EPK hK [X, B] ϕ, ϕi = hKϕ, ϕi.

(4.3)

Since ϕ is an arbitrarily chosen unit function in L2 (E \ B) and since K [X, B] = χE\B K [X, B] χE\B , we obtain (4.1).

13

5

Proof of Lemma 1.7

Proposition 5.1. Let W ⊂ E be a Borel subset, and let B1 ⊂ B2 ⊂ · · · Bn ⊂
 · · · ⊂ W be an increasing exhausting
sequence of bounded Borel subsets of W . The sequence χE\W K [X, Bn ] χE\W n∈N converges PK -almost surely in the
space of locally trace class operators.
Proof. Since K is locally of trace class, there exists a positive function ψ : E \W → (0, 1] such that ψ 1/2 Kψ 1/2 is
of trace class and for any bounded subset B ⊂ E, we have
inf ψ(x) > 0.

(5.1)

x∈B

Then

Z

EPK ( ∑ ψ(x)) =
x∈X

E

ψ(x)K(x, x)µ(dx) = tr(ψ 1/2 Kψ 1/2 ) = Mψ < ∞.

Denote
G(X, n) := χE\W K [X, Bn ] χE\W .
Then for any n ∈ N, we have
h
Mψ = EPK ( ∑ ψ(x)) = EPK EPK
x∈X

i

∑ ψ(x)F(Bn )




= EPK tr(ψ 1/2 G(X, n)ψ 1/2 ) .

(5.2)

x∈X

By the martingale property of the sequence (G(X, n))n∈N and the equality (5.2), the sequence (ψ 1/2 G(X, n)ψ 1/2 )n∈N
forms a bounded martingale in L1 (PK , L1 (L2 (E, µ))). By Proposition 2.3, the Banach space L1 (L2 (E, µ)) has the
Radon-Nikodym property. Therefore there exists a measurable function F(X, ∞) with values in L1 (L2 (E, µ)), such
that
in L1 (L2 (E, µ))
ψ 1/2 G(X, n)ψ 1/2 −−−−−−−−→ F(X, ∞).
PK -a.s.

The assumption (5.1) implies that

ψ −1/2 F(X, ∞)ψ −1/2

∈ L1,loc (L2 (E, µ)) and we have

in L1,loc (L2 (E, µ))

χE\W K [X, Bn ] χE\W = G(X, n) −−−−−−−−−−→ ψ −1/2 F(X, ∞)ψ −1/2 .
PK -a.s.

(5.3)

Proof of Lemma 1.7. By (8.6), for PK -almost every X ∈ Conf(E), we have
n→∞

(πW c )∗ [PK (·|X, Bn )] −−−−→ PK (·|X,W ).
weakly

(5.4)

By items (i) and (iv) of Proposition 2.5, for PK -almost every X ∈ Conf(E), we have
(πW c )∗ [PK (·|X, Bn )] = PχE\W K [X, Bn ] χE\W .

(5.5)

Combining (5.3), (5.4) and (5.5) with the fact that the convergence of correlation kernels in L1,loc (L2 (E, µ)) implies
the weak convergence of the corresponding determinantal measures, we complete the proof of Lemma 1.7.
We conclude this section
 with a simple general proposition that allows us to construct bounded martingales
from the sequence K [X, Bn ] n∈N .
Proposition 5.2. Let W ⊂ E be a Borel subset, and let B1 ⊂ B2 ⊂ · · · Bn ⊂ · · · ⊂ W be an increasing exhausting
sequence of bounded Borel subsets of W . Fix any positive function ψ : E \ W → (0, 1] such that ψ 1/2 Kψ 1/2 is of
trace class and for any bounded subset B ⊂ E, we have infx∈B ψ(x) > 0. Then

ψ 1/2 K [X, Bn ] ψ 1/2 n∈N
(5.6)
is an L1 (L2 (E \ W, µ))-valued martingale which is bounded in L2 (Conf(E), P; L1 (L2 (E \ W, µ))). In particular,
the sequence converges in L1 (Conf(E), P; L1 (L2 (E \W, µ))).

14

Proof. It suffices to show that the sequence (5.6) is bounded in L2 (Conf(E), P; L1 (L2 (E \W, µ))). Indeed, we have

 1/2 [X, B ] 1/2 


n
ψ K
ψ L (L2 (E\W,µ)) = tr ψ 1/2 K [X, Bn ] ψ 1/2 = EPK ∑ ψ(x)X, Bn .
1

x∈X

By Proposition 8.4, we get the desired L2 (Conf(E), P; L1 (L2 (E \W, µ)))-boundedness of the sequence (5.6).
Remark. Let B(W ) be the directed set of bounded measurable subsets of W , ordered by set-inclusion. Then the
set-indexed family χE\W K [X, B] χE\W B∈B(W ) is a set-indexed martingale adapted to the filtration (F(B))B∈B(W ) .
By virtue of Proposition 5.2, for any positive function ψ : E \W → (0, 1] such that ψ 1/2 Kψ 1/2 is of trace class and
for any bounded subset B ⊂ E, we have infx∈B ψ(x) > 0, the set-indexed martingale


ψ 1/2 K [X, B] ψ 1/2
B∈B(W )

converges in L1 (Conf(E), PK ; L1 (L2 (E \W, µ))).

6

Proof of Theorem 1.1

Recall that we have fixed a realization of our kernel, namely, a Borel function K(x, y) defined on the set E0 × E0 ,
where µ(E \ E0 ) = 0. In this section, we make the additional assumption that K is an orthogonal projection onto a
subspace H ⊂ L2 (E, µ). Recalling (1.1), we fix a realization for each h ∈ H: namely, in such a way that the equation
h(x) = hh, Kx i holds for every x ∈ E0 and every h ∈ H. Given any configuration X ∈ Conf(E) and a bounded Borel
subset B ⊂ E, we set L(X) := {h ∈ H : hX ≡ 0} and χB L(X) := {χB h : h ∈ L(X)} ⊂ L2 (E, µ). The subspace L(X)
is of course closed, but χB L(X) need not be closed.
Fix an exhausting sequence E1 ⊂ · · · ⊂ En ⊂ · · · ⊂ E \ B of bounded Borel subsets of E \ B, and denote
Fn = E \ (B ∪ En ).
Since B is bounded, we have L1,loc (L2 (B, µ)) = L1 (L2 (B, µ)). By Lemma 1.7, for PK -almost every X ∈ Conf(E),
there exists a positive contraction K [X, E\B] ∈ L1 (L2 (B, µ)), such that
n→∞

χB K [X, En ] χB −−−−−−−−→ K [X, E\B]

(6.1)

PK (·|X, E \ B) = PK [X, E\B] .

(6.2)

in L1 (L2 (B, µ))

and

Lemma 6.1. For PK -almost every X ∈ Conf(E), we have K [X, E\B] (χB h) = χB h for any h ∈ L(X ∩ (E \ B)).
Proof. Fix any h ∈ L(X ∩ (E \ B)) ⊂ H. For any n ∈ N, since En ⊂ E \ B, by definition, we have
L(X ∩ (E \ B)) ⊂ L(X ∩ En ).
Since En is bounded and E \ En = B ∪ Fn , the operator K [X,En ] is the orthogonal projection from L2 (E, µ) onto the
closure of the subspace χE\En L(X ∩ En ) = χB∪Fn L(X ∩ En ). By (6.1), we have

K [X, E\B] (χB h) = lim χB K [X, En ] χB (χB h) = lim χB K [X, En ] (χB h).
n→∞

n→∞

Using the equalities χB h = χB∪Fn h − χFn h, K [X,En ] (χB∪Fn h) = χB∪Fn h, and the relation
n→∞

kχB K [X, En ] (χFn h)k2 ≤ kχFn hk2 −−−→ 0,
we obtain K [X, E\B] (χB h) = limn→∞ χB K [X, En ] (χB∪Fn h − χFn h) = χB h − limn→∞ χB K [X, En ] (χFn h) = χB h.

15

Lemma 6.2. Let P be a point process on E. Then for any bounded Borel subset B ⊂ E, we have
P(#B = #(X ∩ B)|X, Bc ) > 0

for P-almost every X ∈ Conf(E).

(6.3)

Proof. First of all, decomposing X = Y ∪ Z, Y ∈ Conf(B), Z ∈ Conf(Bc ), we can rewrite the statement as follows:

P {W ∈ Conf(B) : #(W ) = #(Y )}|Z, Bc > 0
(6.4)
for (πBc )∗ (P)-almost every Z ∈ Conf(Bc ) and P( · |Z, Bc )-almost every Y ∈ Conf(B). We make a simple general
claim: given an integer-valued measurable function f on a probability space (Ω, P), for P-almost every y ∈ Ω we
have P{x : f (x) = f (y)} > 0. Indeed, if N = {n ∈ Z : P{x : f (x) = n)} = 0}, then the relation P{x : f (x) = f (y)} > 0
fails only if f (y) ∈ N, and
P{y : f (y) ∈ N} = ∑ P{y : f (y) = n} = 0.
n∈N

For (πBc )∗ (P)-almost every Z ∈

Conf(Bc ),

by taking Ω = Conf(B), P = P( · |Z, Bc ), f = #B , we obtain (6.4).

Proof of Theorem 1.1. Fix a countable dense subset T of E and let Sn be an enumeration of balls with rational radii
centred at T :
{Sn : n ∈ N} = {B(x, q) : x ∈ T, q ∈ Q}.

(6.5)

Fix a measurable subset A ⊂ Conf(E) with PK (A) = 1, such that for all X ∈ A and all n ∈ N, the conditional
c
measures PK (·|X, Snc ) and conditional kernels K [X, Sn ] are defined and satisfy
PK (·|X, Snc ) = PK [X, Snc ] ,

(6.6)

and, moreover, the inequality (6.3) holds:
PK (#Sn = #(X ∩ Sn )|X, Snc ) > 0

for any X ∈ A, n ∈ N.

(6.7)

We now show that L(X) = {0} for any X ∈ A. Take X ∈ A and assume, by contradiction, that there exists
h ∈ L(X), h 6= 0. We may choose n in such a way that the ball Sn from the above fixed countable collection (6.5)
satisfies hSn 6= 0 and X ∩ Sn = 0.
/ Note by passing that here we do not require that the choice of n is measurable.
c
By our choice, we have 0 6= χSn h ∈ χSn L(X ∩ Snc ). By Lemma 6.1, the function χSn h satisfies K [X, Sn ] (χSn h) = χSn h,
c
c
whence 1 is an eigenvalue of the operator K [X, Sn ] . In particular, det(1 − K [X, Sn ] ) = 0. On the other hand, the relations
(6.6), (6.7) together with the gap probability formula (3.4) imply that
c

det(1 − K [X, Sn ] ) = PK [X, Snc ] (#Sn = 0) = PK (#Sn = 0|X, Snc ) = PK (#Sn = #(X ∩ Sn )|X, Snc ) > 0.
We thus obtain a contradiction and Theorem 1.1 is proved completely.

7

Triviality of the tail σ -algebra: proof of Theorem 1.4

Definition 7.1. Fix any increasing exhausting sequence D1 ⊂ · · · ⊂ Dn ⊂ · · · ⊂ E of bounded Borel subsets fo E.
For any Borel subset W ⊂ E, set
K [X,W ] := lim χE\W K [X,W ∩Dn ] χE\W .
n→∞

The convergence takes place in L1,loc (L2 (E, µ)) by Proposition 5.1.The kernel K [X,W ] is well-defined for PK almost every X. For fixed W , the limit almost surely is independent of the choice of the sequence (Dn )∞
n=1 .
Proposition 7.2. Fix a bounded Borel subset B ⊂ E and let E \B ⊃ W1 ⊃ · · · ⊃ Wn ⊃ · · · be any decreasing sequence
of Borel subsets. Then χB K [X,Wn ] χB n∈N is an (F(Wn ))n∈N -adapted reverse martingale defined on the probability
space (Conf(E), F(E), PK ).

16


Proof. It suffices to prove that for any φ ∈ L2 (B, µ), the sequence hK [X,Wn ] φ , φ i n∈N is an (F(Wn ))n∈N -adapted
reverse martingale defined on the probability space (Conf(E), F(E), PK ). By definition, for any n ∈ N, we have
hK [X,Wn ] φ , φ i = lim hK [X,Wn ∩Dk ] φ , φ i,
k→∞

PK -almost surely.

(7.1)

Since all the operators K [X,Wn ] are contractive, by the bounded convergence theorem, the convergence (7.1) takes
place in L1 (PK ) as well. Fix an natural number n ∈ N. For any ε > 0, let k ∈ N be large enough in such a way that




 [X,Wn ]



φ , φ i − hK [X,Wn ∩Dk ] φ , φ i 1
≤ ε; hK [X,Wn+1 ] φ , φ i − hK [X,Wn+1 ∩Dk ] φ , φ i 1
≤ ε.
(7.2)
hK
L (PK )

L (PK )

For fixed n ∈ N, the sequence



h
i∞

EPK hK [X,Wn ] φ , φ iF(Wn+1 ∩ Dk )
k=1

h
i

is a martingale that converges in L1 -norm to EPK hK [X,Wn ] φ , φ iF(Wn+1 ) . We can therefore choose k large enough
in such a way that



h
i
h
i




≤ ε.
EPK hK [X,Wn ] φ , φ iF(Wn+1 ) − EPK hK [X,Wn ] φ , φ iF(Wn+1 ∩ Dk )  1
L (PK )

Since Wn+1 ∩ Dk ⊂ Wn ∩ Dk and Dk is bounded, Lemma 1.10 implies

h
i

EPK hK [X,Wn ∩Dk ] φ , φ iF(Wn+1 ∩ Dk ) = hK [X,Wn+1 ∩Dk ] φ , φ i,
whence



h
i



≤
EPK hK [X,Wn ] φ , φ iF(Wn+1 ) − hK [X,Wn+1 ] φ , φ i 1
L (PK )



h
i



≤ 2ε + EPK hK [X,Wn ] φ , φ iF(Wn+1 ∩ Dk ) − hK [X,Wn+1 ∩Dk ] φ , φ i 1
≤
L (PK )



h
i



≤ 3ε + EPK hK [X,Wn ∩Dk ] φ , φ iF(Wn+1 ∩ Dk ) − hK [X,Wn+1 ∩Dk ] φ , φ i

L1 (PK )

= 3ε, (7.3)


i
h

and we obtain the desired reverse martingale relation EPK hK [X,Wn ] φ , φ iF(Wn+1 ) = hK [X,Wn+1 ] φ , φ i.
Lemma 7.3. For any bounded Borel subset B ⊂ E and φ ∈ L2 (Bc , µ), we have


VarPK hK [X, B] φ , φ i ≤ kφ k22 · kχB Kφ k22 ,

(7.4)

where k · k2 is the Hilbert norm on L2 (E, µ).
We first prove Lemma 7.3 when K is an orthogonal projection. This part of the proof is similar to the argument
of Benjamini, Lyons, Peres and Schramm [1, Lemma 8.6] and Lyons [18, Lemma 7.18]. The proof of Lemma 7.3
in full generality proceeds by reduction to the case of projections (the usual argument of extending the phase space
must be slightly modified in the continuous setting) and is postponed to the end of the section.
Proof of Lemma 7.3 when K is an orthogonal projection. By homogeneity, we may assume that kφ k2 ≤ 1. Since K
is an orthogonal projection, by [5, Proposition 2.4], so is K [X,B] for PK -almost every X ∈ Conf(E). By Proposition
4.1, we have



2 


2

VarPK hK [X, B] φ , φ i = EPK  (K [X, B] − χBc KχBc )φ , φ  ≤ EPK (K [X, B] − χBc KχBc )φ 2 =


= EPK kK [X, B] φ k22 − hK [X, B] φ , χBc KχBc φ i − hχBc KχBc φ , K [X, B] φ i + kχBc KχBc φ k22 =


= EPK hK [X, B] φ , φ i − hK [X, B] φ , χBc KχBc φ i − hχBc KχBc φ , K [X, B] φ i + kχBc KχBc φ k22 =
= hχBc KχBc φ , φ i − kχBc KχBc φ k22 = hKφ , φ i − kχBc Kφ k22 = kKφ k22 − kχBc Kφ k22 = kχB Kφ k22 . (7.5)

17


Proposition 7.4. Fix any ` ∈ N. Then χD` K [X, E\Dn+` ] χD` n∈N is an (F(E \ Dn+` ))n∈N -adapted reverse martingale
defined on the probability space (Conf(E), F(E), PK ), and we have
n→∞

χD` K [X, E\Dn+` ] χD` −−−−−−−−−−−−−−−−−−−−−−−−−−−−→ χD` KχD` .
PK -a.s. in L1 (L2 (E, µ) and in L2 (PK ; L1 (L2 (E, µ)))

(7.6)

For any ` ∈ N, we have
∞
\
h
i

EPK PK (·|X, E \ D` )
F(E \ Dn+` ) = (πD` )∗ (PK ),

PK -almost surely

(7.7)

n=1

and, for any A ∈ F(D` ), we have


 



lim EPK EPK χA F(E \ Dn+` ) − PK (A) = 0.

n→∞

(7.8)

Proof. The reverse martingale property of the sequence follows from Proposition 7.2. Set
T :=

∞
\

F(E \ Dn+` ).

(7.9)

n=1

Since a Banach space valued reverse martingale converges (see, e.g., Pisier [26, p. 34]), we obtain
 

n→∞
χD` K [X, E\Dn+` ] χD` −−−−−−−−−−−−−−−−−−−−−−−−−−−−→ EPK χD` K [X, E\D1+` ] χD` T .
PK -a.s. in L1 (L2 (E, µ) and in L2 (PK ; L1 (L2 (E, µ)))

Set
 

G∞ (X) = EPK χD` K [X, E\D1+` ] χD` T .
In particular, for any φ ∈ L2 (D` , µ) with kφ k2 ≤ 1, we have
 i
h

[X, E\D1+` ]
φ , φ iT ,
hG∞ (X)φ , φ i = EPK hK

PK -almost surely.



By Definition 7.1 and the inequality hK [X, (E\Dn+` )∩Dk ] φ , φ i ≤ 1, which holds PK -almost surely, for any n ∈ N, we
have
k→∞

hK [X, (E\Dn+` )∩Dk ] φ , φ i −−−→ hK [X, E\Dn+` ] φ , φ i,

PK -almost surely and in L2 (PK ).

(7.10)

Similarly,
n→∞

hK [X, E\Dn+` ] φ , φ i −−−→ hG∞ (X)φ , φ i,

PK -almost surely and in L2 (PK ).

In particular, since (E \ D1+` ) ∩ Dk are bounded for all k ∈ N, we can apply Proposition 4.1 to obtain




EPK hG∞ (X)φ , φ i = EPK hK [X, E\D1+` ] φ , φ i = lim EPK hK [X, (E\D1+` )∩Dk ] φ , φ i = hKφ , φ i.
k→∞

Now by Lemma 7.3, we have


VarPK hK [X, (E\Dn+` )∩Dk ] φ , φ i ≤ kχ(E\Dn+` )∩Dk Kφ k22 ≤ kχE\Dn+` Kφ k22 .
The convergence (7.10), (7.11) yields




VarPK hK [X, E\Dn+` ] φ , φ i = lim VarPK hK [X, (E\Dn+` )∩Dk ] φ , φ i ≤ kχE\Dn+` Kφ k22 ;
k→∞




VarPK hG∞ (X)φ , φ i = lim VarPK hK [X, E\Dn+` ] φ , φ i ≤ lim sup kχE\Dn+` Kφ k22 = 0.
n→∞

n→∞

18

(7.11)

Consequently, we have hG∞ (X)φ , φ i = hKφ , φ i, PK -almost surely. Since χD` G∞ (X)χD` = G∞ (X) and since φ is
arbitrarily chosen from the separable unit sphere in L2 (D` , µ), we obtain the desired equality
G∞ (X) = χD` KχD` ,

PK -almost surely.

Finally, Proposition 8.2 implies that

i
h

(πD` )∗ [PK (·|X, E \ Dn+` )] = EPK PK (·|X, E \ D` )F(E \ Dn+` ) ,

PK -almost surely,

and
 i
h

(πD` )∗ [PK (·|X, E \ Dn+` )] −−−−→ EPK PK (·|X, E \ D` )T ,
n→∞

weakly

PK -almost surely.

(7.12)

But the convergence (7.6) implies that
(πD` )∗ [PK (·|X, E \ Dn+` )] = PχD

`

n→∞
−−−→
K [X, E\Dn+` ] χD` weakly

PχD` KχD` = (πD` )∗ (PK ),

PK -almost surely.

(7.13)

Now (7.12) and (7.13) yield (7.7). Martingale convergence for a bounded random variable implies (7.8).
Proof of Theorem 1.4. Take Dn := Bn . We prove that the σ -algebra T in (7.9) is trivial with respect to PK . Take
an event A ∈ T . For ε > 0, find ` ∈ N large enough and A1 ∈ F(D` ) such that PK (A1 ∆A) < ε/3. By (7.8), we
have







lim EPK EPK χA1 F(E \ Dn+` ) − PK (A1 ) = 0.
n→∞

Now find n ∈ N large enough in such a way that







EPK EPK χA1 F(E \ Dn+` ) − PK (A1 ) ≤ ε/3.
It follows that for any A2 ∈ F(E \ Dn+` ), we have









|PK (A1 ∩ A2 ) − PK (A1 )PK (A2 )| = EPK χA2 EPK χA1 F(E \ Dn+` ) − EPK χA2 PK (A1 )  =


i


h










= EPK χA2 EPK χA1 F(E \ Dn+` ) − PK (A1 )  ≤ EPK EPK χA1 F(E \ Dn+` ) − PK (A1 ) ≤ ε/3. (7.14)
Finally, we obtain
|PK (A ∩ A2 ) − PK (A)PK (A2 )| ≤ 2PK (A1 ∆A) + |PK (A1 ∩ A2 ) − PK (A1 )PK (A2 )| ≤ ε.
Taking A2 = A, we obtain PK (A) = (PK (A))2 , whence PK (A) is either 0 or 1, as desired.
Proof of Lemma 7.3 in the general case. Fix a bounded Borel subset B ⊂ E and a function φ ∈ L2 (E \ B, µ) such
that kφ k2 = 1. Recalling (3.1), set
R(K, B, φ ) = (φ ⊗ φ + χB )K(φ ⊗ φ + χB ).
By Lemma 1.8,
hR(K, B, φ )[X, B] φ , φ i = hK [X, B] φ , φ i,

for PK -almost every X ∈ Conf(E).

By definition, we have K [X, B] = K [X∩B, B] and similarly R(K, B, φ )[X, B] = R(K, B, φ )[X∩B, B] . In particular, we have
hR(K, B, φ )[X, B] φ , φ i = hK [X, B] φ , φ i for (πB )∗ (PK ) = PχB KχB -almost every X ∈ Conf(B);




VarPK hK [X, B] φ , φ i = VarPχB KχB hK [X, B] φ , φ i = VarPχB R(K,B,φ )χB hR(K, B, φ )[X, B] φ , φ i.

19

(7.15)

Proposition 7.5 (See [19, Section 3.3]). Let m be the counting measure on N. There exists a locally trace class
e ∈ L1,loc (L2 (E t N, µ ⊕ m)) such that K = χE Kχ
e E.
orthogonal projection operator K
Proof. The canonical orthogonal projection dilation of K on L2 (E, µ) ⊕ L2 (E, µ) is given by the formula
√


K − K2
√ K
,
K − K2
1−K
but it is not in general locally trace class. Since L2 (E, µ) is separable and all infinite dimensional separable Hilbert
spaces are isometrically isomorphic, there exists a unitary operator U : L2 (E, µ) → `2 (N) = L2 (N, m), and we set
√




2
K
−
K
1
0
1
0
K
e
√
K :=
.
0 U
0 U −1
K − K2
1−K

e is an orthogonal projection, for any bounded Borel subset B ⊂ E, which is of course also a subset of
Since K
E t N, and any φ ∈ L2 (E \ B, µ), which of course also lies in L2 ((E t N) \ B, µ ⊕ m), we have
 [X, B]

e
e k22 .
VarPKe hK
φ , φ i ≤ kχB Kφ
For the term on the right hand side, we have
e = χB Kφ .
χB Kφ

(7.16)

Since φ ⊗ φ + χB = (φ ⊗ φ + χB )χE , we have
e B, φ ) = (φ ⊗ φ + χB )K(φ
e ⊗ φ + χB ) = (φ ⊗ φ + χB )K(φ ⊗ φ + χB ) = R(K, B, φ ).
R(K,
It follows that
-a.s.

PχB KχB -a.s.
KχB
e[X, B] φ , φ i ==χ=B=
e B, φ )[X, B] φ , φ i = hR(K, B, φ )[X, B] φ , φ i ==
hK
==== hR(K,
====== hK [X, B] φ , φ i.
P

e

e B = χB KχB implies the equality P e = PχB KχB , and we have
The equality χB Kχ
χB KχB




VarPK hK [X, B] φ , φ i = VarPχB KχB hK [X, B] φ , φ i = VarPχ

e
B KχB

 [X, B]

 [X, B]

e
e
hK
φ , φ i = VarPKe hK
φ,φi .

(7.17)

Combining (7.16) and (7.17), we obtain the desired inequality (7.4).

8

Appendix: Martingales corresponding to conditional processes

Proposition 8.1. Let B ⊂ E be a bounded Borel subset. If P is a simple point process on E admitting correlation
measures of all orders, then P(·|X, B) = PX∩B Conf(Bc ) for P-almost every X ∈ Conf(E).
Proof. Let Confn (E) = {X ∈ Conf(E) : #X = n} and similarly define Confn (B). By the natural map E n → Confn (E)
# on Conf (E) as the push-forward measure of the
defined by (x1 , · · · , xn ) 7→ {x1 , · · · , xn }, we define a measure ρn,P
n
#
correlation measure ρn,P and define a σ -finite measure Cn,P on Confn (E) × Conf(E) as the push-forward measure
! . The formula (2.2) implies that
of n-th order Campbell measure Cn,P
#
#
Cn,P
(dp × dX1 ) = ρn,P
(dp)Pp (dX1 ).

20

(8.1)

# (dp) := δ and C # := δ ⊗P, where δ is the Dirac measure at the empty configuration 0,
By convention, we set ρ0,P
/
0/
0/
0/
0,P
i.e., the unique element 0/ ∈ Conf0 (E). Equivalently, for any positive Borel function H : Confn (E)×Conf(E) → R+ :
Z
Z
i
h
#
#
H(p, X1 )Cn,P
(dX0 × dX1 ) =
H({x
,
·
·
·
,
x
},
X
\
{x
,
·
·
·
,
x
})
P(dX),
1
n
1
n
∑
Confn (E)×Conf(E)

Conf(E) x∈X n

where the summation ∑# is taken over all ordered n-tuples (x1 , · · · , xn ) with distinct coordinates x1 , · · · , xn ∈ X. In
particular, when n = 0, this equality reads as: for any H : Conf0 (E) × Conf(E) → R+ , we have
Z
Conf0 (E)×Conf(E)

Z

#
H(p, X1 )C0,P
(dp × dX1 )

The boundedness of B ⊂ E implies that Conf(B) =
Conf(E) ' Conf(B) × Conf(Bc ) =

∞
G

=

H(0,
/ X)P(dX).
Conf(E)

F∞

n=0 Confn (B).

Hence

∞ 


G
Confn (B) × Conf(Bc ) =
Confn (B) × Conf(Bc ) .

n=0

n=0

For any n = 0, 1, 2, · · · , let H : Confn (E) × Conf(E) → R+ be any non-negative Borel function supported on the
subset Confn (B) × Conf(Bc ) ⊂ Confn (E) × Conf(E). Then for any configuration X ∈ Conf(E), we have

∑# H({x1 , · · · , xn }, X \ {x1 , · · · , xn }) = n! · χ{#(X∩B)=n} · H(X ∩ B, X ∩ Bc ).

x∈X n

c
#
When n = 0, this equality reads as H(0,
/ X) = χ{X∩B=0}
/ · H(X ∩ B, X ∩ B ). By definition of Cn,P , we get

Z
Confn (E)×Conf(E)

= n! ·

Z
Conf(E)

#
H(p, X1 )Cn,P
(dp × dX1 ) =

Z

h

#

∑

Conf(E) x∈X n

i
H({x1 , · · · , xn }, X \ {x1 , · · · , xn }) P(dX)

χ{#(X∩B)=n} · H(X ∩ B, X ∩ Bc )P(dX) = n! ·

Z
Confn (B)×Conf(Bc )

H(p, X1 )PB,Bc (dp × dX1 ).

The above equality, combined with (8.1), yields
1 #
C 
c (dp × dX1 )
n! n,P Confn (B)×Conf(B )
1 #
Pp (Conf(Bc )) #
= ρn,P
Conf(B) (dp)Pp Conf(Bc ) (dX1 ) =
ρn,P Conf(B) (dp)Pp Conf(Bc ) (dX1 ).
n!
n!

PB,Bc Confn (B)×Conf(Bc ) (dp × dX1 ) =

Consequently,
PB,Bc (dp × dX1 ) =




Pp (Conf(Bc )) #
ρn,P Conf(B) (dp) Pp Conf(Bc ) (dX1 ).
n!
n=0
∞

∑

This implies both the formula for πB (P)(dp) and the formula for P(dX1 |p, B) = PB,Bc (dX1 |p, B):
Pp (Conf(Bc )) #
ρn,P Conf(B) (dp);
∑
n!
n=0
∞

πB (P)(dp) =

P(dX1 |p, B) = Pp Conf(Bc ) (dX1 ),

for πB (P)-almost every p ∈ Conf(B).

(8.2)
(8.3)

Hence we get the desired relation P(·|X, B) = PX∩B Conf(Bc ) , for P-almost every X ∈ Conf(E).
Remark. Kallenberg [17, Section 12.3] defined the compound Campbell measure of P on Conf f in (E) × Conf(E)
by
∞
1 #
CP# (dp × dX1 ) := ∑ Cn,P
(dp × dX1 ),
n!
n=0
where Conf f in (E) = t∞
n=0 Confn (E).

21

Let P be a point process on E and let W ⊂ E be a Borel subset of E. Let W1 ⊂ · · · ⊂ Wn ⊂ · · · ⊂ W be an
S
increasing sequence of Borel subsets of W such that W = ∞
n=1 Wn .

Proposition 8.2. The sequence (πW c )∗ [P(·|X,Wn )] n∈N is an (F(Wn ))n∈N -adapted martingale defined on the probability space (Conf(E), F(E), P). Moreover, we have

h
i

(πW c )∗ [P(·|X,Wn )] = EP P(·|X,W )F(Wn ) , for P-almost every X ∈ Conf(E).
(8.4)
In particular, by martingale convergence theorem, for all Borel subsets A ⊂ Conf(W c ) and any 1 ≤ p < ∞, we have


n→∞
(πW c )∗ [P(·|X,Wn )] (A) −−−−−−−−−p−−−−−−→ P(A|X,W ).
(8.5)
P-a.s. and in L (Conf(E), P)

Moreover, for P-almost every X ∈ Conf(E), we have
n→∞

(πW c )∗ [P(·|X,Wn )] −−−→ P(·|X,W ).
weakly

(8.6)

Remark. In general, the statement
(8.5) cannot be strengthened to the claim that for P-almost every X ∈ Conf(E),

n→∞
we have (πW c )∗ [P(·|X,Wn )] (A) −−−→ P(A|X,W ), for all Borel subsets A ⊂ Conf(W c ).
We prepare a simple lemma. Let Ωi , i = 1, . . . , n, . . . , and Ω∗ be standard Borel spaces. Fix n ∈ N and denote
x := (xi )∞
i=1 and t =: (xi )i≥n+1 ,
∗
while z will stand for the coordinate on Ω∗ . Let Q(dx × dz) be a Borel probability measure on (∏∞
i=1 Ωi ) × Ω . For
∗
any n ∈ N, let qn (x1 , · · · , xn ; dz) be the marginal on Ω of the conditional measure Q(dt × dz|x1 , · · · , xn ).

Lemma 8.3. We have
qn (x1 , · · · , xn ; dz) = E[Q(dz|x1 , · · · , xn ,t)|x1 , · · · , xn ].
Proof. Denote by Qn the marginal measure of Q on Ω1 × · · · × Ωn . Let Q∞ be the marginal measure of Q on
∏∞
i=1 Ωi . By definition of conditional measures, we have
Q(dx × dz) = Q∞ (dx)Q(dz|x1 , · · · , xn ,t);
Q(dx × dz) = Qn (dx1 · · · dxn )Q(dt × dz|x1 , · · · , xn ).
And also
E[Q(dz|x1 , · · · , xn ,t)|x1 , · · · , xn ] =

Z
t∈∏∞
i=n+1 Ωi

Q(dz|x1 , · · · , xn ,t)Q∞ (dt|x1 , · · · , xn ).

Since
Q∞ (dx) = Qn (dx1 · · · dxn )Q∞ (dt|x1 , · · · , xn ),
we get
Q(dx × dz) = Qn (dx1 · · · dxn )Q∞ (dt|x1 , · · · , xn )Q(dz|x1 , · · · , xn ,t).
Consequently,
Q(dt × dz|x1 , · · · , xn ) = Q∞ (dt|x1 , · · · , xn )Q(dz|x1 , · · · , xn ,t).
By definition, we have
qn (x1 , · · · , xn ; dz) =

Z
t∈∏∞
i=n+1 Ωi

Z

=
t∈∏∞
i=n+1 Ωi

Q(dt × dz|x1 , · · · , xn )
Q∞ (dt|x1 , · · · , xn )Q(dz|x1 , · · · , xn ,t)

= E[Q(dz|x1 , · · · , xn ,t)|x1 , · · · , xn ].

22

Proof of Proposition 8.2. Apply Lemma 8.3 to Ωi = Conf(Wi \Wi−1 ).
Given a bounded non-negative Borel function g : E → R+ , let Sg : Conf(E) → R+ ∪ {+∞} denote the linear
statistics defined, for Z ∈ Conf(E), by the formula Sg (Z) = ∑x∈Z g(x). Denote by EP (Sg |X,W ) the conditional
expectation of Sg with respect to the sigma-algebra F(W ).
Proposition 8.4. If gW ≡ 0 and EP (Sg2 ) < ∞, then the sequence


EP (Sg |X,Wn )

n∈N

(8.7)

is an (F(Wn ))n∈N -adapted L2 (Conf(E), P)-bounded martingale defined on the probability space (Conf(E), F(E), P).
Proof. Since gW ≡ 0, by (8.4), we have

h
i

EP (Sg |X,Wn ) = EP EP (Sg |X,W )F(Wn ) ,

for P-almost every X ∈ Conf(E).

By Jensen’s inequality, we have
[EP (Sg |X,Wn )]2 ≤ EP (Sg2 |X,Wn ),
Therefore, for any n ∈ N,

for P-almost every X ∈ Conf(E).

EP [EP (Sg |X,Wn )]2 ≤ EP (Sg2 ) < ∞.

Acknowledgements. We are deeply grateful to Alexei Klimenko for useful discussions and very helpful comments.
The research of A. Bufetov on this project has received funding from the European Research Council (ERC)
under the European Union’s Horizon 2020 research and innovation programme under grant agreement No 647133
(ICHAOS). It has also been funded by the Grant MD 5991.2016.1 of the President of the Russian Federation, by
the Russian Academic Excellence Project ‘5-100’ and by the Gabriel Lamé Chair at the Chebyshev Laboratory
of the SPbSU, a joint initiative of the French Embassy in the Russian Federation and the Saint-Petersburg State
University. Y. Qiu is supported by the grant IDEX UNITI - ANR-11-IDEX-0002-02, financed by Programme
“Investissements d’Avenir” of the Government of the French Republic managed by the French National Research
Agency. Part of this work was done at the CIRM in the framework of “recherche en petit groupe” programme, at
Ushinsky University Yaroslavl and the Lomonosov Arctic University (Koryazhma branch). We are deeply grateful
to these institutions for their warm hospitality.

References
[1] I. Benjamini, R. Lyons, Y. Peres and O. Schramm. Uniform spanning forests. Ann. Prob., 29(1):1–65, 2001.
[2] A.M. Borodin, E.M. Rains. Eynard-Mehta theorem, Schur process, and their pfaffian analogs. J. Stat. Phys.,
121 (2005), 291–317.
[3] A. I. Bufetov. Multiplicative functionals of determinantal processes. Uspekhi Mat. Nauk. 67 (2012), no. 1
(403), 177–178; translation in Russian Math. Surveys 67 (2012), no. 1, 181–182.
[4] A. I. Bufetov. Rigidity of determinantal point processes with the Airy, the Bessel and the gamma kernel. Bull.
Math. Sci. 6 (2016), no. 1, 163172.
[5] A. I. Bufetov. Quasi-Symmetries of Determinantal Point Processes. arXiv:1409.2068, Nov 2016.
[6] A. I. Bufetov. Infinite determinantal measures. Electron. Res. Announc. Math. Sci., 20:12–30, 2013.

23

[7] A. I. Bufetov, Y. Dabrowski and Y. Qiu. Linear rigidity of stationary stochastic processes. To appear in
Ergodic Theory Dynam. Systems, DOI:10.1017/etds.2016.140.
[8] A. I. Bufetov and Y. Qiu. Determinantal point processes associated with Hilbert spaces of holomorphic
functions. Commun. Math. Phys., 351(2017), no.1, 1-44.
[9] A. I. Bufetov and Y. Qiu. Conditional measures of generalized Ginibre point processes. J. Funct. Anal., 272
(2017), no. 11, 4671–4708.
[10] D. J. Daley and D. Vere-Jones. An introduction to the theory of point processes. Vol. II. Probability and its
Applications (New York). Springer, New York, second edition, 2008. General theory and structure.
[11] N. Dunford and B. J. Pettis. Linear operations on summable functions. Trans. AMS, 47, (1940). 323–392.
[12] S. Ghosh. Determinantal processes and completeness of random exponentials: the critical case. Probability
Theory and Related Fields, pages 1–23, 2014.
[13] S. Ghosh and Y. Peres. Rigidity and tolerance in point processes: Gaussian zeros and Ginibre eigenvalues. to
appear in Duke Math. J.
[14] A. Goldman. The Palm measure and the Voronoi tessellation for the Ginibre process. Ann. Appl. Probab., 20
(2010), 1, 90–128.
[15] J. G. Hocking and G. S. Young. Topology. Addison-Wesley, Reading, Mass.-London, 1961.
[16] A. E. Holroyd and T. Soo. Insertion and deletion tolerance of point processes. Elec. J. Prob., 18:no. 74, 2013.
[17] O. Kallenberg. Random measures. Akademie-Verlag, Berlin; Academic Press, Inc., London, 4th ed., 1986.
[18] R. Lyons. Determinantal probability measures. Publ. Math. Inst. Hautes Études Sci., (98):167–212, 2003.
[19] R. Lyons. Determinantal probability: basic properties and conjectures. Proc. International Congress of
Mathematicians 2014, Seoul, Korea, vol. IV, 137–161.
[20] O. Macchi. The coincidence approach to stochastic point processes. Adv. Appl. Prob., 7:83–122, 1975.
[21] Yu. Neretin. Determinantal point processes and fermionic Fock space AMS Transl., 221, 2007, pp.185–191.
[22] H. Osada and S. Osada. Discrete approximations of determinantal point processes on continuous spaces: tree
representations and tail triviality. arXiv:1603.07478, Mar 2016.
[23] Yuval Peres and Bálint Virág. Zeros of the i.i.d. Gaussian power series: a conformally invariant determinantal
process. Acta. Math., 194(1):1–35, 2005.
[24] B. J. Pettis. On integration in vector spaces. Trans. Amer. Math. Soc., 44 (1938), no. 2, 277–304.
[25] R. S. Phillips. On weakly compact subsets of a Banach space. Amer. J. Math., 65, (1943). 108–136.
[26] G. Pisier. Martingales in Banach Spaces. Cambridge University Press, Cambridge, 2016.
[27] V. A. Rohlin. On the fundamental ideas of measure theory. Amer. Math. Soc. Transl., 1952(71):55, 1952.
[28] T. Shirai and Y. Takahashi. Fermion process and Fredholm determinant. Proceedings of the Second ISAAC
Congress, vol. I, 15–23, Kluwer 2000.
[29] T. Shirai and Y. Takahashi. Random point fields associated with certain Fredholm determinants. I. Fermion,
Poisson and boson point processes. J. Funct. Anal., 205(2):414–463, 2003.

24

[30] T. Shirai and Y. Takahashi. Random point fields associated with certain Fredholm determinants. II. Fermion
shifts and their ergodic and Gibbs properties. Ann. Probab., 31(3):1533–1564, 2003.
[31] B. Simon. Notes on infinite determinants of Hilbert space operators. Adv. Math., 24(3):244–273, 1977.
[32] A. Soshnikov. Determinantal random point fields. Uspekhi Mat. Nauk, 55(5(335)):107–160, 2000.
Alexander I. Bufetov
Aix-Marseille Université, Centrale Marseille, CNRS, Institut de Mathématiques de Marseille, UMR7373,
39 Rue F. Joliot Curie 13453, Marseille, France;
Steklov Mathematical Institute of RAS, Moscow, Russia;
Institute for Information Transmission Problems, Moscow, Russia;
National Research University Higher School of Economics, Moscow, Russia;
The Chebyshev Laboratory, Saint-Petersburg State University, Saint-Petersburg, Russia.
bufetov@mi.ras.ru, alexander.bufetov@univ-amu.fr
Yanqi Qiu
CNRS, Institut de Mathématiques de Toulouse, Université Paul Sabatier, Toulouse, France.
yqi.qiu@gmail.com
Alexander Shamov
Department of Mathematics, Weizmann Institute of Science, Israel.
trefoils@gmail.com

25

