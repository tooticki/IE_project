Planar graphs and Stanley’s Chromatic Functions
Alexander Paunov

arXiv:1702.05787v1 [math.CO] 19 Feb 2017

February 2016
Abstract
This article is dedicated to the study of positivity phenomena for the chromatic symmetric
function of a graph with respect to various bases of symmetric functions.
We give a new proof of Gasharov’s theorem on the Schur-positivity of the chromatic symmetric function of a (3 + 1)-free poset. We present a combinatorial interpretation of the
Schur-coefficients in terms of planar networks. Compared to Gasharov’s proof, it gives a
clearer visual illustration of the cancellation procedures and is quite similar in spirit to the
proof of monomial positivity of Schur functions via the Lindström–Gessel–Viennot lemma.
We apply a similar device to the e-positivity problem of chromatic functions. Following
Stanley, we analyze certain analogs of symmetric functions attached to graphs instead of working with chromatic symmetric functions of graphs directly. We introduce a new combinatorial
object: the correct sequences of unit interval orders, and, using these, we reprove monomial
positivity of G-analogues of the power sum symmetric functions.

1

Introduction

Let G be a finite graph, V (G) - the set of vertices of G, E(G) - the set of edges of G.
Definition 1.1. A proper coloring c of G is a map
c:V →N
such that no two adjacent vertices are colored in the same color.
For each coloring c we define a monomial
xc =

Y

xc(v) ,

v∈V

where x1 , x2 , ..., xn , ... are commuting variables. We denote by Π(G) the set of all proper colorings
of G, and by Λ the ring of symmetric functions in the infinite set of variables {x1 , x2 , ...}.
In [2], Stanley defined the chromatic symmetric function of a graph.
Definition 1.2. The chromatic symmetric function XG ∈ Λ of a graph G is the sum of the
monomials xc over all proper colorings of G:
X
xc .
XG =
c∈Π(G)

Definition 1.3. Denote by em the m-th elementary symmetric function:
X
xi1 · xi2 · ... · xim ,
em =
i1 <i2 <...<im

where i1 , .., ik ∈ N. Given a non-increasing sequence of positive integers (we will call these partitions)
λ = (λ1 ≥ λ2 ≥ ... ≥ λk ), λi ∈ N,
we define the elementary symmetric function eλ =

k
Q

i=1

1

eλi . These functions form a basis of Λ.

For a natural number k, we denote by 1k the partition λ of length k, where
λ1 = λ2 = ... = λk = 1.
Definition 1.4. A symmetric function X ∈ Λ is e-positive if it has non-negative coefficients in the
basis of the elementary symmetric functions.
Definition 1.5. Denote by pm the m-th power sum symmetric function:
X
pm =
xm
i .
i∈N

Given a partition λ = (λ1 ≥ λ2 ≥ ... ≥ λk ), we define the power sum symmetric function
k
Q
pλi . These functions also form a basis of Λ.
pλ =
i=1

Definition 1.6. Given a partition λ = (λ1 ≥ λ2 ≥ ... ≥ λk ), we define the monomial symmetric
function
X
X
λ′
λ′
λ′
xi11 · xi21 · ... · xikk ,
mλ =
i1 <i2 <...<ik λ′ ∈Sk (λ)

where the inner sum is taken over the set of all permutations of the sequence λ, denoted by Sk (λ).
Example 1.7. The chromatic symmetric function of Kn , the complete graph on n vertices, is
e-positive: XKn = n! en .
Definition 1.8. For a poset P , the incomparability graph, inc(P ), is the graph with elements of
P as vertices, where two vertices are connected if and only if they are not comparable in P .
Definition 1.9. Given a pair of natural numbers a, b ∈ N2 , we say that a poset P is (a+b)-free if
it does not contain a length-a and a length-b chain, whose elements are mutually incomparable.
Definition 1.10. A unit interval order (UIO) is a partially ordered set which is isomorphic to a
finite subset of U ⊂ R with the following poset structure:
for u, w ∈ U : u ≻ w iff u ≥ w + 1.
Thus u and w are incomparable precisely when |u − w| < 1 and we will use the notation u ∼ w in
this case.
Theorem 1.11 (Scott-Suppes [1]). A finite poset P is a UIO if and only if it is (2 + 2)- and
(3 + 1)-free.
Stanley [2] initiated the study of incomparability graphs of (3 + 1)-free partially ordered sets.
Analyzing the chromatic symmetric functions of these incomparability graphs, Stanley [2] stated
the following positivity conjecture.
Conjecture 1.12 (Stanley). If P is a (3 + 1)-free poset, then Xinc(P ) is e-positive.
For a graph G let us denote by cλ (G) the coefficients of XG with respect to the e-basis. We
omit the index G whenever this causes no confusion:
X
XG =
cλ e λ .
λ

Conjecture 1.12 has been verified with the help of computers for up to 20-element posets [6].
In 2013, Guay-Paquet [6] showed that to prove this conjecture, it would be sufficient to verify it
for the case of (3 + 1)- and (2 + 2)-free posets, i.e. for unit interval orders (see Theorem 1.11).
More precisely:
Theorem 1.13 (Guay-Paquet). Let P be a (3 + 1)-free poset. Then, Xinc (P ) is a convex combination of the chromatic symmetric functions
{Xinc (P ′ ) | P ′ is a (3 + 1)− and (2 + 2)−free poset}.
The strongest general result in this direction is that of Gasharov [3].
2

Definition 1.14. For a partition λ = (λ1 ≥ λ2 ≥ ... ≥ λk ), define the Schur functions sλ =
det(eλ∗i +j−i )i,j , where λ∗ is the conjugate partition to λ. The functions {sλ } form a basis of Λ.
Definition 1.15. A symmetric polynomial X is s-positive if it has non-negative coefficients in the
basis of Schur functions.
Obviously, a product of e-positive functions is e-positive. This also holds for s-positive functions.
Thus, the equality en = s1n implies that e-positive functions are s-positive, and thus s-positivity
is weaker than e-positivity.
Theorem 1.16 (Gasharov). If P is a (3 + 1)-free poset, then Xinc(P ) is s-positive.
Gasharov proved s-positivity by constructing so-called P -tableau and finding a one-to-one correspondence between these tableau and s-coefficients [3]. However, e-positivity conjecture 1.4 is
still open. The strongest known result on the e-coefficients was obtained by Stanley in [2]. He
showed that sums of e-coefficients over the partitions of fixed length are non-negative:
Theorem 1.17 (Stanley). For a finite graph G and j ∈ N, suppose
X
XG =
cλ e λ ,
λ

and let sink(G, j) be the number of acyclic orientation of G with j sinks. Then
X
cλ .
sink(G, j) =
l(λ)=j

Remark 1.18. By taking j = 1, it follows from the theorem that cn is non-negative.
Stanley in [2] showed that for n ∈ N and the unit interval order Pn = { 2i }ni=1 , the corresponding
Xinc(Pn ) is e-positive, while e-positivity for the UIOs
n

i
Pn,k =
k + 1 i=1
with k > 1 has not yet been proven. It was checked for small n and some k (see [2]).
In this article, we give a new proof of Gasharov’s theorem, which presents a combinatorial
interpretation of the s-coefficients in terms of planar networks. Compared to Gasharov’s proof, it
gives a clearer visual illustration of the cancellation procedures and resembles the proof of monomial
positivity of Schur functions using Lindström–Gessel–Viennot Lemma [9]. This allows us to look
at the positivity problematics from a slightly different perspective: instead of working with the
chromatic symmetric function of a graph directly, we analyze families of G-symmetric functions,
described in Section 2, first time proposed by Stanley in [7].
Next, we introduce correct sequences (abbreviated as corrects), defined below. These play a
major role in the article.
Definition 1.19. Let U be a UIO. We will call a sequence w
~ = (w1 , . . . , wk ) of elements of U
correct if
• wi 6≻ wi+1 for i = 1, 2, . . . , k − 1
• and for each j = 2, . . . , k, there exists i < j such that wi 6≺ wj .
Every sequence of length 1 is correct, and sequence (w1 , w2 ) is correct precisely when w1 ∼ w2 .
The second condition (supposing that the first one holds) may be reformulated as follows: for each
j = 1, . . . k, the subset {w1 , . . . , wj } ⊂ U is connected with respect to the graph structure (U, ∼).
Using this notation, we prove the following theorems.
P
cλ eλ be a chromatic symmetric function of the n-element unit
Theorem 1.20. Let Xinc(U) =
λ

interval order U . Then cn is equal to the number of corrects of length n, in which every element
of U is used exactly once.
P
Corollary 1.20.1. Let Xinc(P ) = cλ eλ be a chromatic symmetric function of n-element (3 + 1)λ

free poset P , then cn is a nonnegative integer.

3

Indeed, positivity for the general case follows from Theorem 1.13, which presents the chromatic
symmetric function of a (3 + 1)-free poset as a convex combination of the chromatic symmetric
functions of unit interval orders.
Stanley [7] and Chow [5] showed the positivity of cn for (3 + 1)-free posets using combinatorial
techniques, and linked e-coefficients with the acyclic orientations of the incomparability graphs.
Nevertheless, their proofs do not give visual interpretation of the cancellation procedures.
The article is structured as follows: in Section 2, we describe the G-homomorphism introduced
by Stanley in [7], which is essential for our approach. The new proof of Gasharov’s theorem
(Theorem 1.16) is presented in Section 3.1. The proof of Theorem 1.20 and positivity of G-power
sum symmetric functions is can be found in Section 3.2.
Acknowledgements. I would like to express my deep gratitude to my advisor, Andras Szenes,
for introducing me to the subject, for his guidance and help. I am grateful to Richard Rimanyi,
Emanuele Delucchi and Bart Vandereycken for helpful discussions.

2

Stanley’s G-homomorphism

For a graph G, Stanley [7, p. 6] defined G-analogues of the standard families of symmetric functions.
Let G be a finite graph with vertex set V (G) = {v1 , ..., vn } and edge set E(G). We will think of
the elements of V (G) as commuting variables.
Definition 2.1. For a positive integer i, 1 ≤ i, ≤ n, we define the G-analogues of the elementary
symmetric polynomials, or the elementary G-symmetric polynomials, as follows
X Y
eG
v,
i =
#S=i v∈S
S−stable

where the sum is taken over all i-element subsets S of V , in which no two vertices form an edge,
G
i.e. stable subsets. We set eG
0 = 1, and ei = 0 for i < 0.
Note that these polynomials are not necessarily symmetric.
n
G
Let ΛG ⊂ R[v1 , ..., vn ] be the subring generated by {eG
i }i=1 . The map ei 7→ ei extends to
a ring homomorphism φG : Λ → ΛG , called the G-homomorphism. For f ∈ Λ, we will use the
notation f G for φG (f ).
Example 2.2. Given a partition λ = λ1 ≥ λ2 ≥ ... ≥ λk , k ∈ N, we have
eG
λ =

k
Y

eG
i ,

i=1
G
sG
).
λ = det(eλ∗
i +j−i

For an integer function α : V → N and f G ∈ ΛG , let
Y
vα =
v α(v) ,
v∈V

and [v α ]f G stands for the coefficient of v α in the polynomial f G ∈ ΛG .
Let Gα denote the graph, obtained by replacing every vertex v of G by the complete subgraph
v
v
of size α(v): Kα(v)
. Given vertices u and v of G, a vertex of Kα(v)
is connected to a vertex of
u
Kα(u) if and only if u and v form an edge in G.
Considering the Cauchy product [8, ch. 4.2], Stanley [7, p. 6] found a connection between the
G-analogues of symmetric functions and XG . Following Stanley [7], we set
X
T (x, v) =
mλ (x)eG
λ (v),
λ

where the sum is taken over all partitions. Then
Y
[v α ]T (x, v)
α(v)! = XGα .
v∈V

4

(1)

Using the Cauchy identity
X

sλ (x)sλ∗ (y) =

λ

X

mλ (x)eλ (y) =

λ

X

eλ (x)mλ (y)

λ

and applying the G-homomorphism, one obtains:
X
X
X
T (x, v) =
mλ (x)eG
sλ (x)sG
eλ (x)mG
λ (v) =
λ∗ (v) = T (v, x) =
λ (v).
λ

λ

(2)

λ

An immediate consequence of the formulas (1) and (2) is the following result of Stanley:
Theorem 2.3 (Stanley). For every finite graph G
1. XGα is s-positive for every α : V (G) → N if and only if sG
λ ∈ N[V (G)] for every partition λ.
2. XGα is e-positive for every α : V (G) → N if and only if mG
λ ∈ N[V (G)] for every partition λ.
P α
G
α
G
Remark 2.4. If XGα = cλ eλ , then cα
λ = [v ]mλ . Hence, monomial positivity of mλ is equivaλ

lent to the positivity of cα
λ for every α.

The proofs of positivity of G-power sum symmetric functions and Schur G-symmetric functions
for the case of unit interval orders can be found in [10].

3

Proofs of the theorems

It follows from Theorem 2.3 that to prove that the graph G is s-positive, it is enough to show the
monomial positivity of its G-Schur polynomials. On the other hand, Guay-Paquet (Theorem 1.13)
showed that it is sufficient to check s-positivity for unit interval orders in order to prove it for
the general case of (3 + 1)-free posets. Therefore, in the following paragraph 3.1, we analyze the
functions sG
λ for the case G = inc(U ), where U is UIO.

3.1

A new proof of Gasharov’s theorem

Given unit interval order U , we arrange the elements of U according to their order on the real line.
For instance, the incomparability graph of U8 = {vi = 2i }8i=1 , the 1-chain graph with 8 vertices,
has the following labeling:

v1

v2

v3

v4

v5

v6

v7

v8

Figure 1: The incomparability graph of U8 .
A key tool in our work is the Lindström–Gessel–Viennot lemma [9]. Let Γ be a finite directed
acyclic (i.e. without directed cycles) graph with set of vertices V (Γ) and set of edges E(Γ). Let
w : E(Γ) → R be a weighting of the edges with values in some commutative ring R. For every
directed path ρ, denote by w(ρ) the product of the weights of the edges in the path. Then, for
every two vertices a and b of Γ, let
X
e(a, b) =
w(ρ),
ρ:a→b

where the sum is taken over all paths from a to b.
Definition 3.1. Let n ∈ N, and let us fix two ordered n-element subsets
A = (a1 , a2 , ..., an ) ⊂ V (Γ) and B = (b1 , b2 , ..., bn ) ⊂ V (Γ),
called base and destination vertices, correspondingly. We will call a collection ρ
~ = (ρ1 , ..., ρn )
of paths in Γ a multipath from A to B if there is a permutation σ on {1, 2, ..., n} such that
ρi : ai → bσ(i) , i = 1, ..., n. Given a multipath ρ
~, we denote the permutation σ by σρ~ . We call ρ
~
non-intersecting, if ρi ∩ ρj = ∅ for i 6= j.
5

Theorem 3.2 (Lindström–Gessel–Viennot). Let Γ, w : E(Γ) → R be a weighted locally finite
acyclic graph as above, n ∈ N, A = (a1 , a2 , ..., an ) ⊂ V (Γ) and B = (b1 , b2 , ..., bn ) ⊂ V (Γ). Define
the matrix


e(a1 , b1 ) e(a1 , b2 ) e(a1 , b3 ) . . . e(a1 , bn )
 e(a2 , b1 ) e(a2 , b2 ) e(a2 , b3 ) . . . e(a2 , bn ) 

MA,B = 
 ............................................. 
e(an , b1 ) e(an , b2 ) e(an , b3 ) . . . e(an , bn )
Then, the following equality holds in the ring R:
det(MA,B ) =

X

sign(σρ~ ) ·

ρ
~:A→B
non-int.

n
Y

w(ρi ),

i=1

where the sum is taken over all non-intersecting multipaths.
Remark 3.3. It follows from Theorem 1.13 that to prove Gasharov’s theorem, it is sufficient to
verify it for unit interval orders. Here we prove Gasharov’s theorem for this case.
Theorem 3.4. Let (U, ≻) be a unit interval order, G = inc(U ) its incomparability graph. Then,
for every partition λ, sG
λ ∈ N[V (G)].
Proof. We prove the monomial positivity of sG
λ∗ by constructing a special directed graph ΓG , the
grid of G, and applying the Lindström–Gessel–Viennot theorem to ΓG .
The vertices of ΓG are given by the pairs (i, j), where i ∈ 1, ..., n + 1 and j ∈ N. Then, for
every i ∈ {1, ..., n}, we denote by next(i) = min {j| vj ≻ vi }. If such vj does not exist, then we
define next(i) = n + 1. From every vertex (i, j), j < n + 1, we draw a directed edge to the vertex
(i, j + 1) with the weight 1, and a directed edge to (i + 1, next(j)) with the weight vi . Note that
ΓG is planar if U is a unit interval order.
For instance, for the graph U8 , mentioned above, the grid ΓU8 is as follows:

6

(1,2)

a4 =(1,1)

a3 =(2,1)

a2 =(3,1)

a1 =(4,1)

1

1

1

1

1
v1

v1

1

1
v2

v1
1

v2

1

1
v3

1

1
v4

1
v5

1
v5

1

1
v6

v4

v5
1

v6

1
v5

1
v6

1
v6

1

1

1

v3

v4

v5

v6

1

1

1

v2

v3

v4

v5

1

1

1

v1

v2

v3

v4

1

1

1

1

1
v1

v2

v3

1
v4

1

1
v3

1
v1

v2

1

1

1

1
v2

v3

v4

v1

1
v2

v3

1

v1

1

v4
1

v5
1

v6

v5
1

v6

v6

1

1

1

1

1

1

1

1

1

v7
v8 1

v7
v8 1

v7
v8 1

v7
v8 1

v7
v8 1

v7
v8 1

v7
v8 1

b4 =(3,9)

b3 =(5,9)

b2 =(7,9)

v7
v8

b1 =(8,9)

Figure 2: The grid ΓU8 .
Here, the base vertices A, (1, 1), (2, 1), (3, 1), and (4, 1), are on the top, and are colored in red.
The destination vertices B, (3, 9), (5, 9), (7, 9), and (8, 9), at the bottom, and are colored in blue.
It easily follows from the definition of ΓG that, for positive integers i and j, we have
e((i, 1), (i + j, n + 1)) = eG
j .
Note that we use the notation e(a, b) for the sum over all weights of paths from vertex a to
vertex b, and we use a similar notation eG
λ for the G-elementary symmetric functions. This is not
a coincidence: for the graphs we will consider in this article and to which we apply Theorem 3.2,
e(a, b) will turn out to be the elementary G-symmetric function.
Now, let k ∈ N, and fix a partition λ1 ≥ λ2 ≥ ... ≥ λk . Let
A = {a1 = (k, 1), a2 = (k − 1, 1), .., ai = (k + 1 − i, 1), .., ak = (1, 1)},
and
B = {b1 = (k+λ1 , n+1), b2 = (k−1+λ2 , n+1), ..., bi = (k+1−i+λi, n+1) ..., bk = (λk +1, n+1)}.
Then we have
e(ai , bj ) = eG
λi +j−i .
7

The example of λ = (4, 4, 3, 2) is shown on Figure 2.
Next, applying Theorem 3.2, we obtain
det(eG
λi +j−i ) = det(e(ai , bj )) =

X

sign(σρ~ )

n
Y

w(ρi ),

(3)

i=1

ρ
~:A→B

where the sum is taken over all non-intersecting multipaths from A to B. The permutation σ
must be the identity permutation for all possible non-intersecting multipaths ρ~ since the grid ΓG
is planar. Thus, by the definition of sG
λ , we have
X

G
sG
λ∗ = det(eλi +j−i ) =

ρ
~:A→B
non-intersecting

n
Y

w(ρi ),

(4)

i=1

where the sum is taken over all non-intersecting multipaths from A to B. This proves the monomial
positivity of sG
λ∗ .

3.2

Monomial positivity of the G-power sum functions.

Let us repeat the definition of a central notion for our work, that of correct sequences of elements
of a unit interval order.
Definition 3.5. Let (U, ≺) be a unit interval order, and G = inc(U ). We will call a sequence
w
~ = (w1 , . . . , wk ) of elements of U correct if
• wi 6≻ wi+1 for i = 1, 2, . . . , k − 1
• and for each j = 2, . . . , k, there exists i < j such that wi 6≺ wj .
We denote by PkU the set of all correct sequences (abbreviated as corrects) of length k. Since
G is uniqely defined by U , and we are working only with UIO, here and below we use the U -index
instead of G. The U -analogues of symmetric functions will be analyzed.
Theorem 3.6. Let U be a unit interval order and pU
k the Stanley power-sum function of the
corresponding incomparability graph. Then, for every natural k, we have
X
w1 · ... · wk ∈ N [U ],
pU
k =
U
w∈P
~
k

where the sum is taken over all corrects of length k.
Proof. To prove this theorem we express the power sum U -symmetric function pU
k in terms of the
elementary U -symmetric polynomials using the determinant formula:
 U
 e1
 U
2e2
 U
3e
pU
k = det  3
 ..
 .

keU
k

1
eU
1
eU
2

0
1
eU
1

eU
k−1

···



···

0 · · ·

1
.
..
. . 
.
.
eU 

(5)

1

Note that this determinant is similar to the expression for sU
(1k )∗ in terms of the e-basis; only
the first column is different:

sU
(1k )∗

 U
e1
 U
e2
 U

= det e3
 ..
 .

eU
k

1
eU
1
eU
2

0
1
eU
1

eU
k−1

···

8



···

0 · · ·

1
.
..
. . 
.
.
eU 
1

(6)

Next, we take a partition λ = 1k , a grid ΓU , and vertices (see Theorem 3.2 and its use in
Section 3.1)
A = {a1 = (k, 1), a2 = (k − 1, 1), .., ai = (k + 1 − i, 1), .., ak = (1, 1)},
and
B = {b1 = (k + 1, n + 1), b2 = (k, n + 1), ..., bi = (k + 1 − i + 1, n + 1) ..., bk = (2, n + 1)},
corresponding to the partition λ on the grid. For instance, the grid for U5 is as follows:

(1,2)

a7 =(1,1)

a6 =(2,1)

a5 =(3,1)

a4 =(4,1)

a3 =(5,1)

a2 =(6,1)

a1 =(7,1)

1

1

1

1

1

1

1

1
v1
1

v1
1

1

v2
1

v1
v2
1

v3

v1

1

v2
1

v1
1
v2

v3

1
v3

v1

1

1

v2

1

v3

v1
v2

1
v2

1

1

v3

v1

v3

v2
1

v3

v3

1

1

1

1

1

1

1

1

1

v4
v5 1

v4
v5 1

v4
v5 1

v4
v5 1

v4
v5 1

v4
v5 1

v4
v5 1

b7 =(2,9)

b6 =(3,9)

b5 =(4,9)

b4 =(5,9)

b3 =(6,9)

b2 =(7,9)

v4
v5

b1 =(8,9)

Figure 3: The grid ΓU5 and vertices located with respect to partition λ = 15 .
As in the section 3.1, we have
e(ai , bj ) = eU
1+j−i .
Recall that (see Theorem 3.2 for more details) for every directed path ρ on ΓU , w(ρ) denotes
the product of the weights of the edges in the path. Denote by w(~
ρ ) = (w(ρ1 ), ..., w(ρk )) the
vector of weight products over the paths of ρ
~.
U
sU
k = det(e1+j−i ) = det(e(ai , bj )) =

=

X

ρ
~=(ρ1 ,...,ρk ):A→B

sign(σρ~ )

k
Y

i=1

w(ρi ) =

(7)
X

k
Y

w(ρi ).

(8)

(ρ1 ,...,ρk ):A→B i=1
non-intersecting

To obtain pU
k , we adjust the first column, multiplying every element by the number of its row:

9

 U
 e1
 U
2e2
 U

U
pk = det 3e3
 ..
 .

keU
k
=

X

1
eU
1
eU
2

0
1
eU
1

eU
k−1

···

ρ
~=(ρ1 ,...,ρk ):A→B



 e(a1 ,

···


 2e(a2 ,

0 · · ·



1
 = det  3e(a3 ,

..
..
. . 

.
.
.

ke(ak ,
eU 
1

sign(σρ~ ) · σρ~−1 (1)

k
Y

b1 )
b1 )
b1 )

1
e(a2 , b2 )
e(a3 , b2 )

0
1
e(a3 , b3 )

b1 ) e(ak , b2 )

···
0
1
..
.

···




· · · 

=

..
. 
e(ak , bk )

w(ρi ).

(9)

(10)

i=1

In this sum every multipath has a multiplier equal to the index of the vertex from A, from
which the corresponding path goes to b1 . We mark the vertex b1 with a larger dot on the grid
(Picture 3) to emphasize this. We cannot apply Theorem 3.2 here, as we did for sU functions, to
obtain positive sum.
We will use the following notations:
• If we have a path ρ on ΓU , which goes from a to b through z, then let us denote by ρ|z the
part of ρ from a to z, and by ρ|z - the part of ρ from z to b.
• If the end of the path ρ coincides with the starting point π, then we will write ρ ∗ π for the
concatenation of the two paths
• For a pair of paths (ρ, π), crossing in point z, we define the usual switch operation
switchz (ρ, π) = (ρ|z ∗ π|z , π|z ∗ ρ|z ).
• Given a multipath ρ
~ with its paths ρ and π intersecting in point z, we define a multipath
δz (~
ρ) by replacing (ρ, π) by switchz (ρ, π) in ρ
~. Note that our map is defined correctly, because
here we consider only multipaths for the partition λ = 1k : it is obvious that 3 paths of ρ
~
cannot intersect in one point. Note that
sign(σ(~
ρ )) = −sign(σ(δz (~
ρ ))).
• Given an intersecting multipath ρ
~, we denote by z(~
ρ ) (or just z, if it is clear which multipath
is considered) its intersection point with minimum absciss and maximum ordinate, i.e. the
leftmost lowest intersection point.
Next, we classify the set of multipaths in order to simplify the sum (10). Every path ρ can be
uniquely defined by its weight, w(ρ), which is a product over an increasing sequence (with respect
to the relation ≻) of elements of U . Here, it is important to mention that incomparable elements
of U can not be present in a weight of any path. Hence, every multipath ρ
~ = (ρ1 , ..., ρk ) is in one
to one correspondence with its weight vector w(~
ρ ) = (w(ρ1 ), ..., w(ρk )). Below, we will use the
bar notation for the sets of multipaths. The corresponding sets of weight vectors will be defined
using the same letters without bars.
• Let Ωk be the set of all multipaths ρ~ = (ρ1 , ..., ρk ) from A to B.
~ ∈ Ωk , such that the two paths from ρ
~,
• Let I k be the set of all intersecting multipaths ρ
crossing at z(~
ρ ) do not end at b1 .
• We denote by P k the set of multipaths ρ
~ ∈ Ωk , such that w(~
ρ ) is correct:
P k = {~
ρ ∈ Ωk | w(~
ρ) ∈ PkU }.
~ is a non-intersecting multipath, since by the definition of correct
Note that if ρ
~ ∈ P k , then ρ
w(~
ρ) must be a tuple with non-decreasing elements (weights) with respect to the relation ≺.
Hence,
I k ∩ P k = ∅.
10

As a consequence, the sum (10) can be rewritten as
X

sign(σρ~ ) · σρ~−1 (1)

k
Y

w(ρi ) =

i=1

ρ
~∈Ωk

X

sign(σρ~ ) · σρ~−1 (1)

X

sign(σρ~ ) · σρ~−1 (1)

k
Y

(12)

w(ρi )

i=1

ρ
~∈I k

X

+

(11)

w(ρi )

i=1

ρ
~∈P k

+

k
Y

sign(σρ~ ) · σρ~−1 (1)

k
Y

w(ρi ).

(13)

i=1

ρ
~∈(Ωk \I k )\P k

Let ρ~ ∈ I k , then it is easy to see that δz (~
ρ ) ∈ I k , and δz (δz (~
ρ )) = ρ
~. Hence, δz is a signreversing involution on I k :
sign(σ(~
ρ )) = −sign(σ(δz (~
ρ ))) and δz (I k ) = I k
On the other hand, δz does not change the multiplier:
σ −1 (δz (~
ρ ))(1) = σρ~−1 (1).
Hence, the term (12) vanishes, and we have:
X

ρ
~∈I k

sign(σρ~ )·σρ~−1 (1)

k
Y

i=1

w(ρi ) = δz

X

sign(σρ~ )·σρ~−1 (1)

k
Y

i=1

ρ
~∈I k

!

w(ρi )

=−

X

ρ
~∈I k

sign(σρ~ )·σρ~−1 (1)

k
Y

w(ρi ) = 0.

i=1

Pictures 4 and 5 below illustrate this cancellation. Since neither of the 2 paths intersecting at z
end at b1 , a switch at z changes the sign, but not the multiplier, and the contributions of ρ~ and
δz (~
ρ ) cancel:

11

(1,2)

a7 =(1,1)

a6 =(2,1)

a5 =(3,1)

a4 =(4,1)

a3 =(5,1)

a2 =(6,1)

a1 =(7,1)

1

1

1

1

1

1

1

1
v1
1

v1
1

v2

v1
1

v1
1

b6 =(3,9)

v2

1

v1
1

v2 z ′
1
1
1
1
1
1
v3
v3
v3 z v3
v3
1
1
1
1
1
1
v4
v4
v4
v4
v4
1 v5 1 v5 1 v5 1 v5 1 v5 1
b7 =(2,9)

v2

v1

b5 =(4,9)

v2

b4 =(5,9)

b3 =(6,9)

v1
1

v2

v1
1

v2
1

v3

v2
1

v3
1

v3
1

v4 z ′′ v4
v4
v5 1 v5 1 v5

b2 =(7,9)

b1 =(8,9)

~.
Figure 4: The grid ΓU5 and multipath ρ
The path ρ5 : a5 → b4 intersects the path ρ4 : a4 → b5 at the point z. After the switch at z, we
have the paths ρ′5 : a5 → b5 and ρ′4 : a4 → b4 :

(1,2)

a7 =(1,1)

a6 =(2,1)

a5 =(3,1)

a4 =(4,1)

a3 =(5,1)

a2 =(6,1)

a1 =(7,1)

1

1

1

1

1

1

1

1
v1
1

v1
1

v2

v1
1

1

b6 =(3,9)

v2

v1
1

b5 =(4,9)

v2

v1
1

v2 z ′
1
1
1
1
1
1
v3
v3
v3 z v3
v3
1
1
1
1
1
1
v4
v4
v4
v4
v4
1 v5 1 v5 1 v5 1 v5 1 v5 1
b7 =(2,9)

v2

v1

b4 =(5,9)

b3 =(6,9)

v1
1

v2

1
v2

1
v3

v2
1

v3
1

v3
1

v4 z ′′ v4
v4
v5 1 v5 1 v5

b2 =(7,9)

ρ).
Figure 5: The grid ΓU5 and multipath δz (~

12

v1

b1 =(8,9)

We denote by Jk the following set of weights vectors, which describe multipaths like on the
Picture 6:
Jk = {(1l−1 , vi1 ·...·vil , vil+1 , ...vik ) |1 ≤ l ≤ k; vij ≺ vij+1 , if 1 ≤ j ≤ l; vi1 ⊁ vil+1 ; vij ⊁ vij+1 , if l < j ≤ k}.
Denote by J k the corresponding set of mutipaths, which are uniquely defined by the vectors of its
weights.

(1,2)

a7 =(1,1)

a6 =(2,1)

a5 =(3,1)

a4 =(4,1)

a3 =(5,1)

a2 =(6,1)

a1 =(7,1)

1

1

1

1

1

1

1

1
v1
1

v1
1

v2
1

v1
1

v2
1

v3

v1
1

1

v2
1

1

v3

v1

v3

v3

v3

v3

1

1

1

1

1

v4
v5 1

v4
v5 1

v4
v5 1

v4
v5 1

v4
v5 1

b5 =(4,9)

b4 =(5,9)

b3 =(6,9)

v1
1

v2

1

b6 =(3,9)

1

v2 z v2
1
1

1

b7 =(2,9)

v1

1

v2

1
v3

v1

v2
1

1

v3
1

v4 z ′ v4
v5 1 v5 1
b2 =(7,9)

v4
v5

b1 =(8,9)

Figure 6: The grid ΓU5 and a multipath without easy intersection points.
Let ρ
~ ∈ (Ωk \ I k ) \ P k .
• If ρ~ is intersecting, then the absolute value of the difference between the multipliers of ρ~ and
δz (~
ρ ) in the sum (13) is equal to 1:
|σρ~−1 (1) − σ(δz (~
ρ))−1 (1)| = 1,
because if ρl goes to b1 , then z could only be obtained as an intersection of ρl and ρl−1 or
ρl+1 . Hence, since δz (~
ρ) ∈ (Ωk \ I k ) \ P k , we make a switch at z and eliminate one of the
switched multipaths (from (Ωk \ I k ) \ P k \ J k ) and the multiplier of the multipath with longer
intersecting path (from J k ) in the sum (13).
• If ρ
~ ∈ (Ωk \ I k ) \ P k is non-intersecting, then its multiplier is also equal to 1. Denote the set
of such multipaths by Lk :
Lk = {~
ρ ∈ (Ωk \ I k ) \ P k | ρ~ is non-intersecting}.
Then,
Lk = {(w1 , ..., wk )| wi ⊁ wi+1 ; ∃m, s.t. wm ≻ max wq }.
1≤q<m

Hence, we can rewrite the sum (13) in the following way:
X

ρ
~∈Ωk \I k \P k

sign(σρ~ ) · σρ~−1 (1)

k
Y

w(ρi ) =

i=1

X

ρ
~∈J k ⊔Lk

13

sign(σρ~ )

k
Y

i=1

w(ρi ).

(14)

To eliminate the sum (13), we construct a sign-reversing involution on Jk ⊔ Lk . Let
Ak = {(1l−1 , w1 · ... · wl , wl+1 , ...wk ) ∈ Jk | l > 1 and wj ⊁ max wq for every 1 ≤ j ≤ k}.
1≤q<j

Bk = {(1l−1 , w1 · ... · wl , wl+1 , ...wk ) ∈ Jk ⊔ Lk | ∃m, s.t. wm ≻ max wq }.
1≤q<m

Then, we have
Jk ⊔ Lk = Ak ⊔ Bk .
Next, we construct a sign-reversing bijection between Ak and Bk .
First, we define map χ : Ak → Bk . If ~v = (1l−1 , w1 · ... · wl , wl+1 , ...wk ) ∈ Ak , then let
m = max{j ≤ n| wm ≻ wj for j < m}.
We set
χ(~v ) = (1l−1 , w1 · ... · wl · wm , wl+1 , ..., wm−1 , wm+1 , ..., wk ) ∈ Bk .
Note that χ changes the sign ~v by increasing its l-th weight by 1. Second, if
~u = (1l−1 , w1 · ... · wl , wl+1 , ...wk ) ∈ Ak ,
then we set
m′ = max{j ≤ k| wl ≻ wj },
and define
ψ(~u ) = (1l−1 , w1 · ... · wl−1 , wl+1 , ..., wm′ , wl , wm′ +1 , ...wk ) ∈ Bk .
Note that ψ = χ−1 . For instance, the multipath from Picture 6, which belongs to Ak , is transformed
to the below mutipath (Picture 7) under the action of ψ, and vice versa Picture 6 can be obtained
from Picture 7 applying direct map χ:

(1,2)

a7 =(1,1)

a6 =(2,1)

a5 =(3,1)

a4 =(4,1)

a3 =(5,1)

a2 =(6,1)

a1 =(7,1)

1

1

1

1

1

1

1

1
v1

v1

1

1
v2

v1
1

v2

1

1
v3
1

1

v4
v5 1
b7 =(2,9)

1
v2

1
v3

1

v1
1
v2
1

v3
1

v1

v1
1

v2
1

v3

1
v3

v1
1

v2

v3

v3

v3

1

1

1

v4 z ′ v4
v5 1 v5 1

v4
v5 1

v4
v5 1

v4
v5 1

b5 =(4,9)

b4 =(5,9)

b3 =(6,9)

1

v2 z v2
1
1

1

b6 =(3,9)

b2 =(7,9)

1
v4 z ′ v4
v5 1 v5
b1 =(8,9)

Figure 7: Image of the multipath from Picture 6 under the action of χ.

14

v1

Hence, among the sums (13), (12) and (11), only the latter is non-zero, we have only the set of
corrects left:
n
Y
X
w(ρi ).
pU
=
k
i=1
(ρ1 ,...,ρk ):A→B
(w(ρ1 ),...,w(ρk ))∈PkU

This result will play a major role in our future work. The construction of a correct sequence
allows to work with mU functions by expanding them in terms of pU functions. For instance, using
the following relation
U
U
U
mU
l,1 = pl · p1 − pl+1 ,
it is easy to prove the following
Theorem 3.7. Let
U
Ml,1
= {(w
~ |z) ∈ PlU × P1U | z ≻ w
~ ∨ z ≺ wl },

then
mU
l,1 =

X

w1 · ... · wl · z.

U
(w;z)∈M
~
l,1

Remark 3.8. According to Remark 3.3, this implies cn−1,1 (U ) ≥ 0.
Here, we omit the proof. This approach will be used in the next article, where positivity of
some e-coefficients for (3 + 1)-free posets will be demonstrated.

References
[1] D. Scott and P. Suppes Foundational aspects of theories of measurement, Journal of Symbolic
Logic (1954), 23, 113–128.
[2] R. Stanley, A Symmetric Function Generalization of the Chromatic Polynomial of a Graph,
Advances in Mathematics (1995), 111, 166–194.
[3] V. Gasharov, Incomparability Graphs of (3+1)-free posets are s-positive, Discrete Mathematics
(1995), 157, 193-197.
[4] J. Taylor, Chromatic Symmetric Functions of Hypertrees, arXiv:math.co/1506.08262 (2015).
[5] T. Chow, A Note on a Combinatorial Interpretation of the e-Coefficients of the Chromatic
Symmetric Function, arXiv:math.co/9712230v2 (1995).
[6] M. Guay-Paquet, A modular relation for the chromatic symmetric functions of (3+1)-free
posets, arXiv:math.co/1306.2400 (2013).
[7] R. Stanley, Graph colorings and related symmetric functions: Ideas and Applications, MIT
(1995).
[8] I.G. Macdonald, Symmetric Functions and Hall Polynomials, Oxford University Press, Oxford
(1979).
[9] M. Fulmek, Viewing determinants as nonintersecting lattice paths yields classical determinantal
identities bijectively, arXiv:math.co/1010.3860 (2010).
[10] A. Paunov Positivity for Stanley’s chromatic functions, Genève University, (2016), available
from: http://archive-ouverte.unige.ch/unige:87600

15

