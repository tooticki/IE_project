***
Theorem 1.1. [Pansu [13]] Finitely generated quasi-isometric nilpotent groups
have isomorphic associated Carnot groups.

***
Theorem 1.2. [Pansu [13]] A bi-Lipschitz map between Carnot groups is
differentiable almost everywhere.
Moreover, the derivative induces a group
isomorphism.

***
Theorem 1.3. [Austin [1]] Finitely generated integrable measure equivalent
nilpotent groups have bi-Lipschitz asymptotic cones.

***
Theorem 1.4. Finitely generated integrable measure equivalent nilpotent groups
have isomorphic associated Carnot groups.

***
Theorem A.
Suppose Î“ and Î› are IME f.g. nilpotent groups with associated Carnot groups Gâˆž
and Hâˆž . Let Îºx,n be the maps as in Question 5.2 [1]. Then there is a bi-Lipschitz
group isomorphism Î¦ : Gâˆž â†’ Hâˆž to which Îºx,n converge on bounded sets with
high probability as n â†’ âˆž
Îºx,n âˆ’â†’ Î¦.

***
Remarks 1.5.
(1) In [15] Shalom keenly observed that amongst f.g. amenable groups, quasiisometry implies uniform measure equivalence, which in particular implies
IME. Therefore Theorem A implies Theorem 1.1 . While we do not rely
logically on Theorem 1.2 , we do use the idea of the Pansu derivative.
(2) One might say that the isomorphism Î¦ is the Pansu derivative of the given
measurable cocycle. Indeed, in the deterministic case Î¦ is the usual Pansu
derivative.
(3) Theorem A is for any Carnot-CaratheÌodory metrics on Gâˆž and Hâˆž . All
Carnot-CaratheÌodory metrics on a given Carnot group are bi-Lipschitz, so
in what follows we may not specify the metric. Moreover Î¦ being a group
isomorphism implies it is bi-Lipchitz.

***
Theorem B.
Let Î“,Î› be f.g. IME nilpotent groups with associated cocycles Î± : Î“ Ã— X â†’ Î› and
Î² : Î› Ã— Y â†’ Î“, and let Gâˆž and Hâˆž be the associated Carnot groups of Î“ and Î›.
Then there exists a bi-Lipschitz group isomorphism Î¦ : Gâˆž â†’ Hâˆž so that for all
g âˆˆ Gâˆž
(n, Î³n ) âˆ’â†’ g
implies
(n, Î±(Î³n , x)) âˆ’â†’ Î¦(g)
where the convergence is in the sense of the asymptotic cone, and the second
convergence is in measure. The same is true after exchanging the roles of Î“,Î›,
Î±,Î², and Î¦,Î¦âˆ’1 .

***
Remarks 1.6.
(1) Convergence in measure is the best one can hope for given the L1
integrability assumption. To have pointwise convergence even in case Î“ =
Î› = Zd one must assume Ld,1 (Lorentz-space) integrability. The correct
integrability assumption for pointwise convergence of ergodic theorems for
nilpotent groups is commonly believed to be related to the growth type of
the group.
(2) All of the theorems stated above are true for f.g. polynomial growth
groups, which by [6] are those groups with finite index nilpotent subgroups.
Theorem B is insensitive to finite index and finite kernels, so we reduce to
the torsion-free nilpotent case. See Â§??.

***
Lemma 2.1.
Given sequences ti â†’ âˆž, Î³i , Î³i0 âˆˆ Î“ with
1
0
0
ti â€¢ Î³i Î³i â†’ gg .

1
ti

â€¢ Î³i â†’ g and

1
ti

â€¢ Î³i0 â†’ g 0 then

***
Lemma 2.2. [Guivarcâ€™h [8]; see also [3] Theorem 3.7] Let K be a compact
neighborhood of the identity in a simply connected nilpotent Lie group G and
dG (g, h) = inf{n â‰¥ 1 : g âˆ’1 h âˆˆ K n }. Then for any homogeneous quasi-norm |Â·|
on G there is a constant C > 0 so that
1
|g| â‰¤ dG (e, g) â‰¤ C|g| + C.
C

***
Lemma 2.3. For each 1 â‰¤ i â‰¤ m there exist 0 < c1 < c2 < âˆž so that for all n âˆˆ Z
c1 n1/di â‰¤ |(0, . . . , n, . . . 0)|Î“ â‰¤ c2 n1/di
where the non zero term is in the i-th coordinate.
Moreover, if [Xi1 , Â· Â· Â· , [Xilâˆ’1 , Xil ] Â· Â· Â· ] = cXt where ir âˆˆ {1, . . . , m} and c 6= 0, then
l
X
r=1

dir â‰¤ dt .

***
Lemma 2.4. For each 1 â‰¤ i â‰¤ m set
fi (n) = |(0, . . . , 0, n, 0, . . . , 0)|Î“
gi (n) = min |(a1 , . . . , aiâˆ’1 , n, ai+1 , . . . , am )|Î“ .
aj

where the non-zero coordinate is in the i-th coordinate. Then there exists 1 â‰¤ C <
âˆž so that for all n âˆˆ N
fi (n) â‰¤ cgi (n).

***
Lemma 2.5. There is a constant C > 0 so that âˆ€Î³ âˆˆ Î“
|Î³|Î“ â‰¥ C|Ï€com Î³|Î“ .

***
Lemma 2.6. There exists l > 0 so that for all Î³ âˆˆ Î“ âˆ’ Î“2 and for all n |Î³ n |Î“ â‰¥ ln.

***
Lemma 2.7. The functions |Â·|Î“ , |Â·|G , |Â·|m , |Â·|âˆž : Î“ â†’ R+ are all quasi-isometric.
Moreover,
â‡â‡’

|an,t | = o(nd(t) )

âˆ€1 â‰¤ t â‰¤ m

|Î³n |Î“ = |(an,1 , . . . , . . . , an,m )|Î“ = O(n)

â‡â‡’

|an,t | = O(n

d(t)

âˆ€1 â‰¤ t â‰¤ m

|gn |G = |(an,1 , . . . , . . . , an,m )|G = o(n)

â‡â‡’

|an,t | = o(nd(t) )

âˆ€1 â‰¤ t â‰¤ m

â‡â‡’

d(t)

âˆ€1 â‰¤ t â‰¤ m

|Î³n |Î“ = |(an,1 , . . . , . . . , an,m )|Î“ = o(n)

|gn |G = |(an,1 , . . . , . . . , an,m )|G = O(n)

|an,t | = O(n

d(t)

)

)

|gn |âˆž = |(an,1 , . . . , . . . , an,m )|âˆž = o(n)

â‡â‡’

|an,t | = o(n

|gn |âˆž = |(an,1 , . . . , . . . , an,m )|âˆž = O(n)

â‡â‡’

|an,t | = O(nd(t) )

)

where an,j âˆˆ Z (an,j âˆˆ R) is the j-th coordinate of Î³n âˆˆ Î“ (gn âˆˆ G).

âˆ€1 â‰¤ t â‰¤ m
âˆ€1 â‰¤ t â‰¤ m

***
Lemma 2.8. If gn âˆˆ Gâˆž is a sequence such that
(1) |Ï€com gn |âˆž = o(n)
(2) |Ï€ab gn |âˆž = O(n)
then


(Ï€ab gn )âˆ’1 ? gn 

âˆž

= o(n).

***
Lemma
 âˆ’1 âˆ’1 2.9. Let gn , hn âˆˆ G. If |gn |G = o(n) and |hn |G = O(n) then
gn hn gn hn  = o(n). Moreover the same is true of any Carnot-CaratheÌodory
G
norm on Gâˆž instead of G.

***
Proposition 3.1. For every Î³ âˆˆ Î“
1
â€¢ Î±(Î³ n , x) âˆ’â†’ Î±ab (Î³)
n

in probability.

Equivalently,
dâˆž (Î±(Î³ n , x), Î´n Î±ab (Î³)) = o(n)

in probability.

***
Lemma 3.2. For a.e. x âˆˆ X and every Î³ âˆˆ Î“
1
Î±ab (Î³ n , x) â†’ Î±ab (Î³)
n
where the convergence is of vectors in Rd .

***
Proposition 3.3. Suppose c : Î“ Ã— X â†’ R is a measurable cocycle over Î“ y (X, m)
which is pmp ergodic. Then for a.e. x âˆˆ X and every Î³ âˆˆ Î“
Z
1
n
c(Î³ , x) â†’
c(Î³, x)dm(x).
n
X

***
Lemma 3.4. For every Î³ âˆˆ Î“
|Ï€com â—¦ Î±(Î³ n , x)|Î› = o(n)

in probability.

Moreover the same is true replacing the norm |Â·|Î› with |Â·|âˆž .

***
Proposition 3.5. Given a subadditive cocycle c : Î“ Ã— X â†’ R+ , there is M â‰¥ 1
such that for any  > 0 there is C = C() such that
|Î³|Î“ â‰¥ C

=â‡’

m(|c(Î³, x)| â‰¥ M |Î³|Î“ ) < .

***
Lemma 3.6. For every Î³ âˆˆ Î“ âˆ’ Î“2 there is M 0 â‰¥ 1 so that for any  > 0 there is
N so that for all n â‰¥ N
m(|Ï€com â—¦ Î±(Î³ n , x)|Î› > M 0 n) < .

***
Lemma 3.7. If Î³ âˆˆ Î“2 then
|Ï€com â—¦ Î±(Î³ n , x)|Î› = o(n)

in probability.

***
Lemma 3.8. Fix 0 < M < âˆž and v âˆˆ Rd . For each d â‰¤ t < m for all Î´ > 0 there
exists K âˆˆ N and Î´ 0 > 0 so that for all k â‰¥ K and Î· â‰¥ 1, whenever there exist
Î»1 , . . . , Î»k âˆˆ Î› such that
(8)

d1 (Ï€ab Î»i , v) < Î·Î´ 0 |v|1

(9)

|Ï€t Î»i |Î› < Î·Î´ 0

(10)

|Ï€com Î»i |Î› < Î·M

then
|Ï€t+1 Î»1 Â· Â· Â· Î»k |Î› < Î·kÎ´.

***
Theorem 4.1. Let Î³n âˆˆ Î“ be a sequence satisfying
a

a

Î³n = s1 n,1 Â· Â· Â· skn,k
where si âˆˆ S are fixed, in order, independent of n and for each i, N 3 an,i â†’ âˆž as
n â†’ âˆž. Then whp
dâˆž (Î±(Î³n , x), Î´an,1 Î±ab (s1 ) ? Â· Â· Â· ? Î´an,k Î±ab (sk )) = o(max an,i ).

***
Definition 5.1. Let (Gâˆž , Î´t ) be a graded nilpotent lie group with its one-parameter
family of automorphisms. A finite symmetric subset S âŠ‚ Gâˆž generates Gâˆž with
respect to Î´t , t â‰¥ 0, if for every g âˆˆ Gâˆž there exist k âˆˆ N, s1 , . . . , sk âˆˆ S and
a1 , . . . , ak âˆˆ R+ so that
(21)

g = Î´a1 s1 ? Â· Â· Â· ? Î´ak sk .

***
Example 5.2. In the Malâ€™cev coordinates on Gâˆž , the set of d0 = dim(Gâˆž /G2âˆž )
elements
{(1, 0, . . . , 0), (0, 1, 0, . . . 0), . . . , (0, . . . , 1, 0, . . . , 0)}
together with their inverses form a finite symmetric generating set for Gâˆž with
respect to the homotheties Î´t .
More generally any finite symmetric set with real span containing V1 = g/g2
generates Gâˆž with respect to Î´t . Indeed, the group generated by expâˆž (V1 ) is
a connected subgroup of Gâˆž , so by the Lie correspondence, its Lie algebra is a sub
algebra of gâˆž containing V1 . Since V1 generates gâˆž as a Lie algebra, the group
generated by expâˆž (V1 ) is all of Gâˆž .

***
Definition 5.3. [First Definition of Î¦]
Î¦(g) = Î´a1 Î±ab (s1 ) ? Î´a2 Î±ab (s2 ) ? Â· Â· Â· ? Î´ak Î±ab (sk )
where
g = Î´a1 s1 ? Â· Â· Â· ? Î´ak sk
is a fixed choice of a representation of g as in (21).

***
Proposition 5.4. For each g âˆˆ Gâˆž there is a sequence Î³n âˆˆ Î“ so that
â€¢ n1 â€¢ Î³n â†’ g
â€¢

1
n

â€¢ Î±(Î³n , x) â†’ Î¦(g) with high probability as n â†’ âˆž.

***
Proposition 5.5. Fix g âˆˆ Gâˆž . For all 1 , 2 > 0 there exist Î´ > 0 and N âˆˆ N
so that whenever Ïƒ âˆˆ Î“ and n â‰¥ N are such that dGâˆž ( n1 â€¢ Ïƒ, g) < Î´, then with
probability at least 1 âˆ’ 1 we have
1
â€¢ Î±(Ïƒ, x), Î¦(g)) < 2 .
n
In particular, for any sequence n1 â€¢ Ïƒn â†’ g we have
probability.
dHâˆž (

1
n

â€¢ Î±(Ïƒn , x) â†’ Î¦(g) in

***
Corollary 5.6. Suppose g âˆˆ Gâˆž can be written
g = Î´a01 s01 ? Â· Â· Â· ? Î´a0k0 s0k0 .
where a0i âˆˆ R+ and s0i âˆˆ S. Define
Î¦0 (g) = Î´a01 Î±ab (s01 ) ? Â· Â· Â· ? Î´a0k0 Î±ab (s0k0 ).
Then Î¦(g) = Î¦0 (g).

***
Proposition 5.7. Î¦ is a homomorphism.

***
Lemma 5.8. [PoincareÌ recurrence for nilpotent groups] Fix g âˆˆ Gâˆž and let A âŠ‚ X
with m(A) > 0. Then
m{x âˆˆ A : âˆƒÎ³nk âˆˆ Î“ âˆƒnk âˆˆ N such that

1
â€¢ Î³nk â†’ g and Î³nk Â· x âˆˆ A} = m(A).
nk

***
Lemma 5.9. Fix g âˆˆ Gâˆž , let A âŠ‚ X with m(A) > 0 and let Î´ > 0. Then
m{x âˆˆ A : âˆƒÎ³ âˆˆ Î“ âˆƒn âˆˆ N such that dâˆž (

1
â€¢ Î³, g) < Î´ and Î³ Â· x âˆˆ A} = m(A).
n

***
Proposition 5.10. Î¦ and Î¨ are inverse maps. Consequently, they are group
isomorphisms.

