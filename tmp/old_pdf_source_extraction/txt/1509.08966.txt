***
Theorem 1.1. [Pansu [13]] Finitely generated quasi-isometric nilpotent groups
have isomorphic associated Carnot groups.

***
Theorem 1.2. [Pansu [13]] A bi-Lipschitz map between Carnot groups is
differentiable almost everywhere.
Moreover, the derivative induces a group
isomorphism.

***
Theorem 1.3. [Austin [1]] Finitely generated integrable measure equivalent
nilpotent groups have bi-Lipschitz asymptotic cones.

***
Theorem 1.4. Finitely generated integrable measure equivalent nilpotent groups
have isomorphic associated Carnot groups.

***
Theorem A.
Suppose Γ and Λ are IME f.g. nilpotent groups with associated Carnot groups G∞
and H∞ . Let κx,n be the maps as in Question 5.2 [1]. Then there is a bi-Lipschitz
group isomorphism Φ : G∞ → H∞ to which κx,n converge on bounded sets with
high probability as n → ∞
κx,n −→ Φ.

***
Remarks 1.5.
(1) In [15] Shalom keenly observed that amongst f.g. amenable groups, quasiisometry implies uniform measure equivalence, which in particular implies
IME. Therefore Theorem A implies Theorem 1.1 . While we do not rely
logically on Theorem 1.2 , we do use the idea of the Pansu derivative.
(2) One might say that the isomorphism Φ is the Pansu derivative of the given
measurable cocycle. Indeed, in the deterministic case Φ is the usual Pansu
derivative.
(3) Theorem A is for any Carnot-Carathéodory metrics on G∞ and H∞ . All
Carnot-Carathéodory metrics on a given Carnot group are bi-Lipschitz, so
in what follows we may not specify the metric. Moreover Φ being a group
isomorphism implies it is bi-Lipchitz.

***
Theorem B.
Let Γ,Λ be f.g. IME nilpotent groups with associated cocycles α : Γ × X → Λ and
β : Λ × Y → Γ, and let G∞ and H∞ be the associated Carnot groups of Γ and Λ.
Then there exists a bi-Lipschitz group isomorphism Φ : G∞ → H∞ so that for all
g ∈ G∞
(n, γn ) −→ g
implies
(n, α(γn , x)) −→ Φ(g)
where the convergence is in the sense of the asymptotic cone, and the second
convergence is in measure. The same is true after exchanging the roles of Γ,Λ,
α,β, and Φ,Φ−1 .

***
Remarks 1.6.
(1) Convergence in measure is the best one can hope for given the L1
integrability assumption. To have pointwise convergence even in case Γ =
Λ = Zd one must assume Ld,1 (Lorentz-space) integrability. The correct
integrability assumption for pointwise convergence of ergodic theorems for
nilpotent groups is commonly believed to be related to the growth type of
the group.
(2) All of the theorems stated above are true for f.g. polynomial growth
groups, which by [6] are those groups with finite index nilpotent subgroups.
Theorem B is insensitive to finite index and finite kernels, so we reduce to
the torsion-free nilpotent case. See §??.

***
Lemma 2.1.
Given sequences ti → ∞, γi , γi0 ∈ Γ with
1
0
0
ti • γi γi → gg .

1
ti

• γi → g and

1
ti

• γi0 → g 0 then

***
Lemma 2.2. [Guivarc’h [8]; see also [3] Theorem 3.7] Let K be a compact
neighborhood of the identity in a simply connected nilpotent Lie group G and
dG (g, h) = inf{n ≥ 1 : g −1 h ∈ K n }. Then for any homogeneous quasi-norm |·|
on G there is a constant C > 0 so that
1
|g| ≤ dG (e, g) ≤ C|g| + C.
C

***
Lemma 2.3. For each 1 ≤ i ≤ m there exist 0 < c1 < c2 < ∞ so that for all n ∈ Z
c1 n1/di ≤ |(0, . . . , n, . . . 0)|Γ ≤ c2 n1/di
where the non zero term is in the i-th coordinate.
Moreover, if [Xi1 , · · · , [Xil−1 , Xil ] · · · ] = cXt where ir ∈ {1, . . . , m} and c 6= 0, then
l
X
r=1

dir ≤ dt .

***
Lemma 2.4. For each 1 ≤ i ≤ m set
fi (n) = |(0, . . . , 0, n, 0, . . . , 0)|Γ
gi (n) = min |(a1 , . . . , ai−1 , n, ai+1 , . . . , am )|Γ .
aj

where the non-zero coordinate is in the i-th coordinate. Then there exists 1 ≤ C <
∞ so that for all n ∈ N
fi (n) ≤ cgi (n).

***
Lemma 2.5. There is a constant C > 0 so that ∀γ ∈ Γ
|γ|Γ ≥ C|πcom γ|Γ .

***
Lemma 2.6. There exists l > 0 so that for all γ ∈ Γ − Γ2 and for all n |γ n |Γ ≥ ln.

***
Lemma 2.7. The functions |·|Γ , |·|G , |·|m , |·|∞ : Γ → R+ are all quasi-isometric.
Moreover,
⇐⇒

|an,t | = o(nd(t) )

∀1 ≤ t ≤ m

|γn |Γ = |(an,1 , . . . , . . . , an,m )|Γ = O(n)

⇐⇒

|an,t | = O(n

d(t)

∀1 ≤ t ≤ m

|gn |G = |(an,1 , . . . , . . . , an,m )|G = o(n)

⇐⇒

|an,t | = o(nd(t) )

∀1 ≤ t ≤ m

⇐⇒

d(t)

∀1 ≤ t ≤ m

|γn |Γ = |(an,1 , . . . , . . . , an,m )|Γ = o(n)

|gn |G = |(an,1 , . . . , . . . , an,m )|G = O(n)

|an,t | = O(n

d(t)

)

)

|gn |∞ = |(an,1 , . . . , . . . , an,m )|∞ = o(n)

⇐⇒

|an,t | = o(n

|gn |∞ = |(an,1 , . . . , . . . , an,m )|∞ = O(n)

⇐⇒

|an,t | = O(nd(t) )

)

where an,j ∈ Z (an,j ∈ R) is the j-th coordinate of γn ∈ Γ (gn ∈ G).

∀1 ≤ t ≤ m
∀1 ≤ t ≤ m

***
Lemma 2.8. If gn ∈ G∞ is a sequence such that
(1) |πcom gn |∞ = o(n)
(2) |πab gn |∞ = O(n)
then


(πab gn )−1 ? gn 

∞

= o(n).

***
Lemma
 −1 −1 2.9. Let gn , hn ∈ G. If |gn |G = o(n) and |hn |G = O(n) then
gn hn gn hn  = o(n). Moreover the same is true of any Carnot-Carathéodory
G
norm on G∞ instead of G.

***
Proposition 3.1. For every γ ∈ Γ
1
• α(γ n , x) −→ αab (γ)
n

in probability.

Equivalently,
d∞ (α(γ n , x), δn αab (γ)) = o(n)

in probability.

***
Lemma 3.2. For a.e. x ∈ X and every γ ∈ Γ
1
αab (γ n , x) → αab (γ)
n
where the convergence is of vectors in Rd .

***
Proposition 3.3. Suppose c : Γ × X → R is a measurable cocycle over Γ y (X, m)
which is pmp ergodic. Then for a.e. x ∈ X and every γ ∈ Γ
Z
1
n
c(γ , x) →
c(γ, x)dm(x).
n
X

***
Lemma 3.4. For every γ ∈ Γ
|πcom ◦ α(γ n , x)|Λ = o(n)

in probability.

Moreover the same is true replacing the norm |·|Λ with |·|∞ .

***
Proposition 3.5. Given a subadditive cocycle c : Γ × X → R+ , there is M ≥ 1
such that for any  > 0 there is C = C() such that
|γ|Γ ≥ C

=⇒

m(|c(γ, x)| ≥ M |γ|Γ ) < .

***
Lemma 3.6. For every γ ∈ Γ − Γ2 there is M 0 ≥ 1 so that for any  > 0 there is
N so that for all n ≥ N
m(|πcom ◦ α(γ n , x)|Λ > M 0 n) < .

***
Lemma 3.7. If γ ∈ Γ2 then
|πcom ◦ α(γ n , x)|Λ = o(n)

in probability.

***
Lemma 3.8. Fix 0 < M < ∞ and v ∈ Rd . For each d ≤ t < m for all δ > 0 there
exists K ∈ N and δ 0 > 0 so that for all k ≥ K and η ≥ 1, whenever there exist
λ1 , . . . , λk ∈ Λ such that
(8)

d1 (πab λi , v) < ηδ 0 |v|1

(9)

|πt λi |Λ < ηδ 0

(10)

|πcom λi |Λ < ηM

then
|πt+1 λ1 · · · λk |Λ < ηkδ.

***
Theorem 4.1. Let γn ∈ Γ be a sequence satisfying
a

a

γn = s1 n,1 · · · skn,k
where si ∈ S are fixed, in order, independent of n and for each i, N 3 an,i → ∞ as
n → ∞. Then whp
d∞ (α(γn , x), δan,1 αab (s1 ) ? · · · ? δan,k αab (sk )) = o(max an,i ).

***
Definition 5.1. Let (G∞ , δt ) be a graded nilpotent lie group with its one-parameter
family of automorphisms. A finite symmetric subset S ⊂ G∞ generates G∞ with
respect to δt , t ≥ 0, if for every g ∈ G∞ there exist k ∈ N, s1 , . . . , sk ∈ S and
a1 , . . . , ak ∈ R+ so that
(21)

g = δa1 s1 ? · · · ? δak sk .

***
Example 5.2. In the Mal’cev coordinates on G∞ , the set of d0 = dim(G∞ /G2∞ )
elements
{(1, 0, . . . , 0), (0, 1, 0, . . . 0), . . . , (0, . . . , 1, 0, . . . , 0)}
together with their inverses form a finite symmetric generating set for G∞ with
respect to the homotheties δt .
More generally any finite symmetric set with real span containing V1 = g/g2
generates G∞ with respect to δt . Indeed, the group generated by exp∞ (V1 ) is
a connected subgroup of G∞ , so by the Lie correspondence, its Lie algebra is a sub
algebra of g∞ containing V1 . Since V1 generates g∞ as a Lie algebra, the group
generated by exp∞ (V1 ) is all of G∞ .

***
Definition 5.3. [First Definition of Φ]
Φ(g) = δa1 αab (s1 ) ? δa2 αab (s2 ) ? · · · ? δak αab (sk )
where
g = δa1 s1 ? · · · ? δak sk
is a fixed choice of a representation of g as in (21).

***
Proposition 5.4. For each g ∈ G∞ there is a sequence γn ∈ Γ so that
• n1 • γn → g
•

1
n

• α(γn , x) → Φ(g) with high probability as n → ∞.

***
Proposition 5.5. Fix g ∈ G∞ . For all 1 , 2 > 0 there exist δ > 0 and N ∈ N
so that whenever σ ∈ Γ and n ≥ N are such that dG∞ ( n1 • σ, g) < δ, then with
probability at least 1 − 1 we have
1
• α(σ, x), Φ(g)) < 2 .
n
In particular, for any sequence n1 • σn → g we have
probability.
dH∞ (

1
n

• α(σn , x) → Φ(g) in

***
Corollary 5.6. Suppose g ∈ G∞ can be written
g = δa01 s01 ? · · · ? δa0k0 s0k0 .
where a0i ∈ R+ and s0i ∈ S. Define
Φ0 (g) = δa01 αab (s01 ) ? · · · ? δa0k0 αab (s0k0 ).
Then Φ(g) = Φ0 (g).

***
Proposition 5.7. Φ is a homomorphism.

***
Lemma 5.8. [Poincaré recurrence for nilpotent groups] Fix g ∈ G∞ and let A ⊂ X
with m(A) > 0. Then
m{x ∈ A : ∃γnk ∈ Γ ∃nk ∈ N such that

1
• γnk → g and γnk · x ∈ A} = m(A).
nk

***
Lemma 5.9. Fix g ∈ G∞ , let A ⊂ X with m(A) > 0 and let δ > 0. Then
m{x ∈ A : ∃γ ∈ Γ ∃n ∈ N such that d∞ (

1
• γ, g) < δ and γ · x ∈ A} = m(A).
n

***
Proposition 5.10. Φ and Ψ are inverse maps. Consequently, they are group
isomorphisms.

