***
Definition 2.1.
sets, µ(∪α Uα ) =
of {Uα : α ∈ Λ}.
the metric space
is τ -smooth.

A Borel measure is τ -smooth if for every collection {Uα : α ∈ Λ} of open
sup µ(∪ni=1 Uαi ), where the supremum is taken over all finite subcollections
We say that (X, d, µ) is a metric measure space if µ is a Borel measure on
(X, d), such that for all balls B(x, r), µ(B(x, r)) < ∞, and furthermore, µ

***
Definition 2.2. Let (X, d, µ) be a metric measure space and let g be a locally integrable
function on X. For each x ∈ X, the centered Hardy-Littlewood maximal operator Mµ is
given by
Z
1
|g|dµ.
(1)
Mµ g(x) :=
sup
{r:0<µ(B(x,r))} µ(B(x, r)) B(x,r)

***
Definition 2.3. A Borel measure µ on (X, d) is doubling if there exists a C > 0 such that
for all r > 0 and all x ∈ X, µ(B(x, 2r)) ≤ Cµ(B(x, r)) < ∞.

***
Definition 2.4. A metric space is D-geometrically doubling if there exists a positive integer
D such that every ball of radius r can be covered with no more than D balls of radius r/2.

***
Definition 2.5. ([NaTa, p. 735] Let 0 < t < 1 and let K ≥ 1. Then µ is said to be
t-microdoubling with constant K if for all x ∈ X and all r > 0, we have
µB (x, (1 + t) r) ≤ KµB(x, r).

***
Definition 2.6. A measure µ satisfies a local comparability condition if there exists a constant
C ∈ [1, ∞) such that for all pairs of points x, y ∈ X, and all r > 0, whenever d(x, y) < r, we
have
µ(B(x, r)) ≤ Cµ(B(y, r)).
We denote the smallest such C by C(µ) or Cµ .

***
Remark 2.7. If µ is doubling with constant K1 then it is microdoubling and satisfies a
local comparability condition with the same constant K1 , while if it is t-microdoubling with
constant K2 and 2 ≤ (1 + t)M , then µ is doubling and satisfies a local comparability condition
with constant K2M . Thus, the difference between doubling and microdoubling lies in the size of
the constants, it is quantitative, not qualitative: The microdoubling condition adds something
new only when K2 < K1 , in which case it entails a greater regularity in the growth of the
measure of balls, as the radii increase. Likewise, bounds of the form µB(x, T r) ≤ KµB(x, r)
for T > 2, allow a greater irregularity in the growth of balls than standard doubling (T = 2)
or than microdoubling.
We mention that while local comparability is implied by doubling, it is a uniformity condition,
not a growth condition. Thus, it is compatible with the failure of doubling, and even for
doubling measures, it is compatible with any rate of growth for the volume of balls. Consider,
for instance, the case of d-dimensional Lebesgue measure λd : A doubling constant is 2d , a
1/d-microdoubling constant is e, and the smallest local comparability constant is C(λd ) = 1.

***
Definition 2.8. ([NaTa, p. 737] Let 0 < t < 1 and let K ≥ 1. Then µ is said to be strong
t-microdoubling with constant K if for all x ∈ X, all r > 0, and all y ∈ B(x, r),
µB (y, (1 + t) r) ≤ KµB(x, r).

***
Definition 2.9. Given a set S we define its s-blossom as the enlarged set
(3)

Bl(S, s) := ∪x∈S B(x, s),

and its uncentered s-blossom as the set
(4)

Blu(S, s) := ∪x∈S ∪ {B(y, s) : x ∈ B(y, s)}.

When S = B(x, r), we simplify the notation and write Bl(x, r, s), instead of Bl(B(x, r), s),
and likewise for uncentered blossoms. We say that µ blossoms boundedly if there exists a
K ≥ 1 such that for all r > 0 and all x ∈ X, µ(Blu(x, r, r)) ≤ Kµ(B(x, r)) < ∞.

***
Definition 2.10. A metric space has the approximate midpoint property if for every ε > 0
and every pair of points x, y, there exists a point z such that d(x, z), d(z, y) < ε + d(x, y)/2.

***
Definition 2.11. A metric space X is quasiconvex if there exists a constant C ≥ 1 such that
for every pair of points x, y, there exists a curve with x and y as endpoints, such that its
length is bounded above by Cd(x, y). If for every ε > 0 we can take C = 1 + ε, then we say
that X is a length space.

***
Example 2.12. The s-blossom of an r-ball may fail to contain a strictly larger ball, even in
quasiconvex spaces.
For instance, let X ⊂ R2 be the set {0} × [0, 1] ∪ [0, 1] × {0} with metric defined by restriction
of the `∞ norm; then we can take C = 2. Now B((1, 0), 1) = (0, 1] × {0}, while for every
r > 1, B((1, 0), r) = X, which is not contained in Blu((1, 0), 1, 1/6). Furthermore, neither
Blu((1, 0), 1, 1/6) nor Bl((1, 0), 1, 1/6) are balls, i.e., given any x ∈ X and any r > 0, we
have that B(x, r) 6= Blu((1, 0), 1, 1/6) and B(x, r) 6= Bl((1, 0), 1, 1/6).
On the other hand, if a metric space X has the approximate midpoint property, then blossoms
and balls coincide (as we show next) so in this case considering blossoms gives nothing new.

***
Theorem 2.13. Let (X, d) be a metric space. The following are equivalent:
a) X has the approximate midpoint property.
b) For all x ∈ X, and all r, s > 0, Bl(x, r, s) = B(x, r + s).
c) For all x ∈ X, and all r > 0, Bl(x, r, r) = B(x, 2r).

***
Example 2.14. Let X be the unit sphere (unit circumference) in the plane, with the chordal
metric, that is, with the restriction to X of the euclidean metric in the plane. While this space
does not have the approximate midpoint property, blossoms are nevertheless geodesic balls.
However, √
the √
equality Bl(x, r, s) = B(x, r + s) no loger holds. For instance, Bl((1, 0), 1, 1) 6=
Bl((1, 0), 2, 2) = B((1, 0), 2) = X \ {(−1, 0)}.

***
Definition 3.1. Let 0 < t < 1 and let K ≥ 1. Then µ is said to t-microblossom boundedly
with constant K, if for all x ∈ X and all r > 0, we have
(5)

µ(Blu (x, r, tr)) ≤ KµB(x, r).

***
Example 3.2. Microblossoming (even together with doubling) is more general than
microdoubling, in a quantitative sense. Consider (Zd , `∞ , µ), where µ is the counting measure.
Then µ is doubling, and “microdoubling in the large”, since for large radii (r > d), µ can
be regarded as a discrete approximation to Lebesgue measure. However, µB(0, 1) = 1, and
for every t > 0, µB(0, 1 + t) ≥ 3d , no matter how small t is. Thus, the measure µ is not
(t, K)-microdoubling, for any K < 3d , 0 < t << 1. However, µ is 1/d-microblossoming, since
for r > d, µ behaves as a microdoubling measure, and for r ≤ d, Blu(x, r, r/d) = B(x, r).
A less natural but stronger example is furnished by the measure µ given by [A2, Theorem 5.9].
Since µ satisfies a local comparability condition, and is defined in a geometrically doubling
space, it blossoms boundedly, so it microblossoms boundedly (at least with the blossoming
constant). But µ is not doubling, and hence it is not microdoubling.

***
Example 3.3. While (t, K1 )-microdoubling entails (2, K2 )-doubling for some K2 ≥ K1 , the
analogous statement is not true for microblossoming. The following example shows that
(1/2, 1)-microblossoming does not entail local comparability. Let X = {0, 1, 3} with the
inherited metric from R, and let µ = δ3 . Then B(0, 3) ∩ B(3, 3) = {1}, but µB(0, 3) = 0
while µB(3, 3) = 1, so local comparability fails. Since bounded blossoming implies local
comparability, all we have to do is to check that µ is (1/2, 1)-microblossoming. For t ≤ 3,
B(0, t) ⊂ Blu(0, t, t/2) ⊂ {0, 1}, so µB(0, t) = µBlu(0, t, t/2) = 0, and for t > 3, B(0, t) =
Blu(0, t, t/2) = X. Likewise, for t ≤ 2, B(1, t) = Blu(1, t, t/2) ⊂ {0, 1}, so µB(1, t) =
µBlu(1, t, t/2) = 0, and for t > 2, B(1, t) = Blu(1, t, t/2) = X.

***
Definition 3.4. Given a metric measure space (X, d, µ), and denoting the support of µ by
supp(µ), the relative increment function of µ, riµ : supp(µ) × (0, ∞) × [1, ∞), is defined as
µB(x, tr)
,
µB(x, r)
and the maximal relative increment function, as
µB(x, tr)
(7)
mriµ (r, t) := sup
.
x∈supp(µ) µB(x, r)
(6)

riµ (x, r, t) :=

When µ is understood we will simply write ri and mri.

***
Example 3.5. The interest of considering values of t > 2 in the preceding definition comes
from the fact that, under the additional assumption of microblossoming, it will allow a much
more irregular growth of balls than microdoubling or plain doubling, without a comparable
worsening of the estimates for the weak type (1,1) bounds.


K2
To fix ideas, consider the right hand side C(µ) K1 K 2 + log
of formula (10 ) below. This
log K
bound is related to the centered maximal operator when the supremum is restricted to radii R
between r and T r, T > 1. The constant K2 depends on T , as it must satisfy mriµ (r, T ) ≤ K2 .
For Lebesgue measure on Rd with the `∞ -norm, C(λd ) = 1. If we set T = 2, then we can
take K2 = 2d , while K2 = dd for T = d, a choice which yields bounds of order O(d log d). A
1/d-microdoubling constant is K1 = e (Rd has the approximate midpoint property, and in
fact it is a geodesic space, so microdoubling is the same as microblossoming in this case) and
K := max{K1 , e} = e.
Returning to Example 3.2 , by a rescaling argument it is clear that the situation for (Zd , `∞ , µ)
cannot be much worse than for (Rd , `∞ , λd ), and in fact it is easy to see that the same
argument of Stein and Strömberg (which will be presented in greater generality below) yields
the O(d log d) bounds. Now suppose we modify the measure so that at one single point it is
much smaller. Clearly, this will have little impact in the weak type (1,1) bounds, since for
d >> 1, x ∈ Zd , and r > 1, the measure of B(x, r) will be changed by little or not at all, while
for r ≤ 1, balls with distinct centers do not intersect. For definiteness, set ν = µ on Zd \ {0},
and ν{0} = d−d . Then the doubling constant, and the (t, K)-microdoubling constant, for any
t > 0, is at least dd (3d − 1) ≤ K = K2 , much larger than the corresponding constants for
µ. However, the local comparability constant is still very close to 1, since intersecting balls
of the same radius must contain at least 3d points each, and a 1/d-microblossoming constant
can be taken to be very close to e. Setting T = d, we get K2 ≤ dd (2d + 1)d , so log K2 in this
case is comparable to the constant obtained when T = 2.

***
Remark 3.6. One might define (T, K)-macroblossoming, with T > 1, by analogy with
Definition 3.1 . However, since B(x, T r) ⊂ Blu(x, r, T r), assuming directly that mriµ (r, T ) ≤
K is not stronger than (T, K)-macroblossoming,

***
Theorem 4.1. Stein-Strömberg covering theorem for sparse radii. Let (X, d, µ)
be a metric measure space, where µ satisfies a C(µ) local comparability condition, and let
R := {rn : n ∈ Z} be a T -lacunary sequence of radii, i.e., rn > 0 and rn+1 /rn ≥ T > 1.
Suppose there exists a t > 0 such that T t ≥ 1 and µ t-microblossoms boundedly with constant
K. Let {B(xi , si ) : si ∈ R, 1 ≤ i ≤ M } be a finite collection of balls with positive measure,
ordered by non-increasing radii. Set U := ∪M
i=1 B(xi , tsi ). Then there exists a subcollection
{B(xi1 , si1 ), . . . , B(xiN , siN )}, such that, denoting by Dij the disjointifications of the reduced
balls B(xij , tsij ),
µU ≤ (K + 1)µ ∪N
j=1 B(xij , tsij ),

(8)
and
(9)

N
X
j=1

µDij
1B(xij ,sij ) ≤ C(µ) K + 1.
µB(xij , sij )

***
Corollary 4.2. Let (X, d, µ) be a metric measure space, where µ satisfies a C(µ) local
comparability condition, and let R := {rn : n ∈ Z} be a T -lacunary sequence of radii.
Suppose there exists a t > 0 with T t ≥ 1 such that µ (t, K)-microblossoms boundedly. Then
kMR kL1 −L1,∞ ≤ (K + 1) (C(µ) K + 1).

***
Corollary 4.3. Let (X, d, µ) be a metric measure space, where µ satisfies a C(µ) local
comparability condition and is (t, K 1/2 )-microdoubling. If N is the least integer such that
(1 + t)N ≥ 1/t, then
kM kL1 −L1,∞ ≤ N K 1/2 (K + 1) (C(µ) K 1/2 + 1).

***
Theorem 4.4. Stein-Strömberg covering theorem for bounded radii. Let (X, d, µ)
be a metric measure space such that µ satisfies a C(µ) local comparability condition, and is
(t, K1 )-microblossoming. Set K = max{K1 , e}. Let r > 0, and suppose there exists a T > 1
such that K2 := mri(r, T ) < ∞. Let {B(xi , si ) : r ≤ si < T r, 1 ≤ i ≤ M } be a finite collection
of balls with positive measure, given in any order, and let D1 = B(x1 , ts1 ), . . . , DM =
−1
B(xM , tsM ) \ ∪M
B(xi , tsi ) be the disjointifications of the t-reduced balls. Then
1


M
X
µDi
log K2
(10)
1B(xi ,si ) ≤ C(µ) K1 K 2 +
.
µB(x
,
s
)
log
K
i
i
i=1

***
Theorem 4.5. Stein-Strömberg covering theorem. Let (X, d, µ) be a metric measure
space, where µ satisfies a C(µ) local comparability condition, and is (t, K1 )-microblossoming.
Set K = max{K1 , e}, and suppose K2 := supr>0 mri(r, 1/t) < ∞. Let {B(xi , si ) : si ∈ R, 1 ≤
i ≤ M } be a finite collection of balls with positive measure, ordered by non-increasing radii,
and let U := ∪M
i=1 B(xi , tsi ). Then there exists a subcollection {B(xi1 , si1 ), . . . , B(xiN , siN )},
−1
such that, denoting by Di1 = B(xi1 , tsi1 ), . . . , DiN = B(xiN , tsiN ) \ ∪N
B(xij , tsij ), we have
1
µU ≤ (K1 + 1)µ ∪N
j=1 B(xij , tsij ),

(12)
and
(13)

N
X
j=1



µDij
log K2
1B(xij ,sij ) ≤ 1 + C(µ) K1 K 2 +
.
µB(xij , sij )
log K

***
Corollary 4.6. Under the assumptions and with the notation of the preceding result, the
centered maximal function satisfies the weak type (1,1) bound



log K2
kM kL1 −L1,∞ ≤ (K1 + 1) 1 + C(µ) K1 K 2 +
.
log K

***
Theorem 5.1. Consider Rd with Lebesgue measure λd and balls defined by an arbitrary norm.
Let R := {rn : n ∈ Z} be a d-lacunary sequence of radii, and let MR be the corresponding
(sparsified) Hardy-Littlewood maximal operator. Then kMR kL1 −L1,∞ ≤ (e1/d + 1)(1 + 2e1/d ).
Furthermore, if the maximal function is defined using the `∞ -norm, so balls are cubes with
sides perpendicular to the coordinate axes, then kMR kL1 −L1,∞ ≤ 6.

***
Theorem 5.2. Consider Rd with Lebesgue measure λd and balls defined by an arbitrary norm.
If ε > 0, then kM kL1 −L1,∞ ≤ (2 + 3ε)d log d for all d = d(ε) sufficiently large.

