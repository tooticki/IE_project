The largest eigenvalue of a convex function, duality, and a theorem
of Slodkowski
Matthew Dellatorre

Abstract
First, we provide an exposition of a theorem due to Slodkowski regarding the largest â€œeigenvalueâ€ of a
convex function. In his work on the Dirichlet problem, Slodkowski introduces a generalized second-order
derivative which for C 2 functions corresponds to the largest eigenvalue of the Hessian. The theorem
allows one to extend an a.e lower bound on this largest â€œeigenvalueâ€ to a bound holding everywhere.
Via the Dirichlet duality theory of Harvey and Lawson, this result has been key to recent progress on
the fully non-linear, elliptic Dirchlet problem. Second, using the Legendre-Fenchel transform we derive
a dual interpretation of this largest eigenvalue in terms of convexity of the conjugate function. This dual
characterization offers more insight into the nature of this largest eigenvalue and allows for an alternative
proof of a bound needed for the theorem.

Contents
1. Introduction
1.1 Motivation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.2 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.4 Organization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2. Exposition of Slodkowskiâ€™s proof
2.1 Overview . . . . . . . . . . . . .
2.2. The generalized C 1,1 estimate .
2.3 The density lemma . . . . . . . .
2.4 Proof of Theorem 1.3 . . . . . .

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

2
2
3
5
5
5
6
8
12

3. Dual Perspective
15
3.1 Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
3.2 Quadratic convexity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
Appendix
A.1 Lipschitz gradient . . . . . . . . . . . . . . . . . . . . . .
A.2 Example of a non C 1,1 function with a sphere of support
A.3 Osculating and locally supporting spheres . . . . . . . .
A.4 Spheres of support to a function and its dual . . . . . . .

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

18
18
19
20
20

Acknowledgements

20

References

20

1

1. Introduction
1.1 Motivation
It is known that a convex function u on Rn is differentiable almost everywhere and has distributional secondorder partial derivatives. It is also known that a convex function is twice differentiable almost everywhere
in the sense that for a.e. x âˆˆ Rn , there exists a symmetric positive semi-definite matrix D2 f (x) such that
1
f (x + h) = f (x) + hâˆ‡f (x), hi + hD2 f (x)h, hi + o(||h||2 ).
2
The operator D2 f is called the second-order Peano derivative. Note that its existence does not imply the
existence of âˆ‡f in a neighbourhood, so it should not be considered the second derivative of f in the usual
sense. This result is due to Alexandrov [1]. See also [5], [6].
In [9], Slodkowski studies uniqueness for a generalized Dirichlet problem in the class of qâˆ’plurisubharmonic
(qâ€“psh) functions (for C 2 functions on Cn this is equivalent to the complex Hessian having n âˆ’ q nonnegative
eigenvalues at every point). The problem of uniqueness reduces to showing that the difference of two such
functions is n âˆ’ 1â€“psh, which implies that it satisfies a maximum principle, from which uniqueness then
follows. Functions of this qâ€“psh class can be approximated by a subclass which are convex up to a quadratic
polynomial. Because of this it is sufficient to study this smaller class, which given their quasi-convexity,
retain some of the nice properties of convex functions. In particular, quasi-convex functions are a.e. twice
differentiable, in the above sense. Thus, the second-order behavior of these functions and their difference
is known a.e. However, to show that the difference is a member of the above mentioned class, they must
satisfy this eigenvalue property everywhere. To this end, Slodkowski introduces a generalized second-order
derivative, which is simply the largest eigenvalue of the Hessian for C 2 functions, and proves that if this
quantity is bounded below almost everywhere in some domain, it is bounded below everywhere in that
domain. Using this, he shows that the difference is contained in the desired n âˆ’ 1â€“psh class.
Following Slodkowski [9, Â§3 ], we define the largest â€œeigenvalueâ€ of a convex function.
Definition 1.1. Let u : Rn â†’ R. If âˆ‡u(x0 ) exists, K(u, x0 ) is defined by the formula
K(u, x0 ) = lim sup 2âˆ’2 max {u(x0 + h) âˆ’ u(x0 ) âˆ’ hâˆ‡u(x0 ), hi : h âˆˆ S nâˆ’1 }
â†’0

otherwise K(u, x) is defined as +âˆ.
This is the generalized second-order derivative that Slodkowski defines. For the sake of context, note
that this quantity is a modification to the second-order upper Peano derivative of u in the direction of h,
which is defined as
lim sup 2âˆ’2 (u(x0 + h) âˆ’ u(x0 ) âˆ’ hâˆ‡u(x0 ), hi).
â†’0+

Being maximal, this second-order derivative is of particular interest because it corresponds to the largest
eigenvalue of the Hessian when defined (which it does, in the above sense, almost everywhere for convex
functions), and gives a useful quantity to work with otherwise, especially in the context of Slodkowskiâ€™s C 1,1
estimates.
Regarding this quantity K(u, x), Slodkowski shows the following.
Theorem 1.2. ([9, Cor. 3.5]) Let u : Rn â†’ R be a locally convex function in U âŠ‚ Rn , such that K(u, x) â‰¥
M for almost every x âˆˆ U . Then K(u, x) â‰¥ M for all x âˆˆ U .
As mentioned above, the recent work of Harvey and Lawson on the Dirichlet problem was one of our
motivations for studying this quantity K(u, x) and Slodkowskiâ€™s proof of the above result. In [4] they study
fully non-linear degenerate elliptic equations of the form
F (Hess(u)) = 0 on â„¦

(1)

u = Ï† on âˆ‚â„¦.

(2)

2

Given certain convexity assumptions on the boundary, they establish the existence and uniqueness of
continuous solutions using their new Dirichlet duality theory. The work of Slodkowski was â€œan inspirationâ€
for that paper, and in particular Theorem 1.2 is the â€œdeepest ingredientâ€ of their proof of uniqueness of
viscosity solutions of (1) [4, p. 398]. These existence and uniqueness results apply to many important
problems including all branches of the homogeneous Monge-AmpeÌ€re equation, all branches of the special
Lagrangian potential equation, and equations appearing naturally in Lagrangian and calibrated geometry.
Given the usefulness of this generalized derivative and the above result to recent progress on important
problems, it makes sense to better understand both the derivative and the proof of the theorem. The proof
is fairly difficult and very geometric so here an illustrated exposition is provided. The quantity K(u, x)
is then studied further for convex u. In particular, the Legendreâ€“Fenchel transform is applied to give a
simple alternative characterization of K(u, x) in terms of the convexity of the dual function uâˆ— to u. This
allows for an alternative proof to a key proposition needed to prove Slodkowskiâ€™s theorem. Altogether, there
are now three ways to view this generalized derivative K(u, x): analytically (Definition 1.1), geometrically
(Proposition 1.6), and dually (Theorem 1.9).
1.2 Summary
Theorem 1.2 follows immediately from the following theorem, the proof of which is the main focus of the
first part of this paper.
Theorem 1.3. ([9, Thm. 3.2]) Let u be convex near x0 âˆˆ Rn . Assume that K(u, x0 ) = k0 is finite. Then
n
0
.
for every k > k0 the set {x : K(u, x) < k} is Borel and its lower density at x0 is not less than kâˆ’k
2k
Lower density is defined as follows.
Definition 1.4. The lower density of a Lebesgue measurable set Z âŠ‚ Rn at x0 âˆˆ Rn is the number

mn Z âˆ© B(x0 , Îµ)
 ,
lim inf
Îµâ†’0
mn B(x0 , Îµ)
where mn denotes the n-dimensional Lebesgue measure.
Slodkowskiâ€™s proof of Theorem 1.3 divides naturally into two parts. First, an equivalent geometric
characterization of a bound on K(u, x) is given in terms of spheres tangent to the graph of u. This is the
content of the following definition and proposition.
For c = (c1 , . . . , cn+1 ) âˆˆ Rn , let S(c, r) denote the nâˆ’sphere with center c and radius r, and B(c, r)
denote the open n + 1-disk of radius r centered at c.
Definition 1.5. The sphere S(c, r) is a sphere of support from above at y = (x0 , u(x0 )) if y âˆˆ S(c, r),
B(c, r) âˆ© graph(u) = âˆ… and cn+1 > u(P (c)), where P denotes the orthogonal projection of Rn+1 onto Rn .
Thus, S(c, r) can be visualized as a ball resting on a â€œsurfaceâ€ that is the graph of u, and such that
(x0 , u(x0 )) is one of its resting points.
Proposition 1.6. ([9, Prop. 3.3]) Let U âŠ‚ Rn be open and u : U â†’ R be convex. Assume that u has
gradient at x.
(i) If u has second-order Peano derivatives at x, then K(u, x) is equal to the norm (i.e. the largest
eigenvalue) of the real Hessian of u at x.
(ii) If K(u, x) is finite, then for every K > K(u, x) there is Îµ > 0 such that u(x+h)âˆ’u(x)âˆ’hâˆ‡u(x), hi â‰¤
1
K|h|2 .
2
(iii) If there is a sphere S(c, r), r > 0 which supports the graph of u from the above at (x, u(x)), then
3

K(u, x) â‰¤

(1 + |âˆ‡u(x)|2 ) 2
.
r
3

(3)

Parts (ii) and (iii) give the above mentioned equivalence between a bound on K(u, x) and a sphere of support
to the graph of a corresponding radius at (x, u(x)). See section 2.2 for a more detailed explanation.
The second part of the proof then uses this alternative characterization of K(u, x) to obtain a density
result, which is essentially the statement of the theorem in terms of spheres of support as opposed to K(u, x).
This is the content of the following lemma.
Lemma 1.7. ([9, Lemma 3.4]) Let u be a non-negative convex function in B(0, d) âŠ‚ Rn , d > 0, such that
u(0) = 0 and âˆ‡u(0) = 0. Let R > 0 and assume that the closed ball BÌ„(c, R), c = (0, ..., 0, R) âˆˆ Rn+1 ,
intersects the graph of u only at 0 âˆˆ Rn+1 . Let Xr , 0 < r < R denote the set of all x âˆˆ B(0, d) âŠ‚ Rn
such that there exists a sphere of radius r supporting the graph of u from above at (x, u(x)). Then the lower
density of Xr at 0 is not less than ((R âˆ’ r)/2R)n .
As will be seen in more detail in section 2, there is an inverse relationship between the bound on K(u, x) and
the radius of the sphere of support to the graph of u at (x, u(x)). This will explain the similarity between
the lower bound on density given in the lemma and the one in the theorem.
The geometric characterization of K(u, x) is key to proving Theorem 1.3 and helpful in understanding
what quality this generalized derivative captures about the function u and its graph. Since the results here
concern functions that are at least locally convex, it is natural to study them via the Legendreâ€“Fenchel
transform, the classical transform of convex analysis. By definition, the set of points above the graph of
a convex function (epigraph) is a convex set. Any convex set in Rn can be defined entirely by a family
of supporting hyperplanes. Thus, since the epigraph of u completely determines the graph of u, which in
turn completely determines u, this family of hyperplanes can be considered an alternative description or
parametrization of u. This is essentially how the transform of u (or dual function to u) uâˆ— is defined. Each
point p âˆˆ Rn defines a collection of hyperplanes (via gradient), and uâˆ— specifies a point uâˆ— (p) âˆˆ R, such that
(0, ..., 0, âˆ’uâˆ— (p)) âˆˆ Rn lies on the one hyperplane of this collection which supports the epigraph (or graph)
of u.
Interestingly, under the Legendreâ€“Fenchel transform, differentiability properties of u correspond to convexity
properties of uâˆ— . Two classic examples of this are the following.
Proposition 1.8. Let f : Rn â†’ R. Then
(i) f is strictly convex if and only if f âˆ— is differentiable.
(ii) f is strongly convex with modulus c if and only if f âˆ— is differentiable and âˆ‡f âˆ— is Lipschitz continuous
with constant 1c .
Given that K(u, x) is a (local) differentiability property of u, it seems there should be an appropriate (local)
convexity property corresponding to uâˆ— . In section 3 we prove the following result.
Theorem 1.9. Let f : Rn â†’ R be convex. If K(f, x0 ) = k0 < k then f âˆ— is quadratically convex at y0 =
âˆ‡f (x0 ) with modulus k1 . Conversely, if uâˆ— is quadratically convex with modulus k1 , then K(f, x0 ) = k0 â‰¤ k.
Quadratically convex at y0 , which is defined in section 3, is a more local form of convexity than the two types
of convexity referred to in Proposition 1.8. This dual characterization of K(u, x) allows for an alternative
proof of Proposition 1.6. Using quadratics to define different types of convexity is standard (e.g. quasiconvexity, strong convexity). See section 3 for definitions of all these terms and a more detailed discussion.
In Slodkowskiâ€™s proof quadratics arise naturally via the definition of K(u, x), and from this, spheres. The
geometric properties of spheres make certain arguments very clear (see proof of Lemma 1.7), however some
manipulations and calculations are simpler with quadratics, given their constant second-order behavior. For
example, in [5] Harvey and Lawson provide an alternative proof of Slodkoskiâ€™s lemma (as well as Alexandrovâ€™s
theorem stated above) via a generalization by using quadratics instead of spheres. Their proof is modelled
off of Slodkowskiâ€™s, and they obtain their result for the larger class of quasi-convex functions. Instead of
spheres of support, they use the notion of upper contact jets, where given p âˆˆ Rn , and A a real symmetric
n Ã— n matrix, (p, A) is an upper contact jet for u at x if there exists a neighbourhood of x such that
1
u(y) â‰¤ u(x) + hp, y âˆ’ xi + hA(y âˆ’ x), y âˆ’ xi.
2
Slodkowskiâ€™s result then corresponds to A = Î»I.
4

1.4 Organization
Section 2 contains the exposition of Slodkowskiâ€™s proof of Theorem 1.3: Â§2.1 gives an overview of the proof,
Â§2.2 a slight variation of Slodkowskiâ€™s proof to Proposition 1.6 (the generalized C 1,1 estimate), Â§2.3 an
expanded and illustrated version of Slodkowskiâ€™s proof to Lemma 1.7, and Â§2.4 combines these for the proof
of the theorem.
Section 3 studies K(u, x) from the dual perspective: Â§3.1 recalls some basic convex analysis, including
Legendreâ€“Fenchel duality, Â§3.2 provides an equivalent interpretation of K(u, x) in terms of the dual function
to u, and uses this for an alternative proof of the C 1,1 estimate.
The Appendix considers Lipschitz continuity of the gradient and the geometric interpretation of K(u, x):
Â§A.1 demonstrates K(u, x) is bounded by the Lipschitz constant when u is C 1,1 , Â§A.2 gives an example of
a function with a sphere of support that is not C 1,1 on any neighbourhood, Â§A.3 compares K(u, x) to the
classical notion of an osculating circle to a plane curve and gives an extension of this to higher dimensions,
Â§A.4 relates the radius of a sphere of support to a function to that of the radius of a supporting sphere to
its dual.

2. Exposition of Slodkowskiâ€™s proof
2.1 Overview
Theorem 1.3 is concerned with the set of points (near x0 ) such that K(u, x) < k, for some fixed k > k0 =
K(u, x0 ). However this set may be difficult to study directly given that the only information available about
u is that it is continuous (bounded and convex) on some neighbourhood of x0 and K(u, x0 ) = k0 < âˆ.
In particular, knowing the value of K(u, x) at a given point does not immediately suggest anything about
its value nearby. Thus, the first step towards a better understanding of this set of points is an alternative
characterization of what it means for K(u, x) to bounded at some point.
If at the point x, K(u, x0 ) < âˆ this is equivalent to a (local) sphere of support from above to the graph
of u at (x, u(x)). This is precisely what Proposition 1.6 (ii) and (iii) states. (ii) implies the existence (locally)
of a quadratic function tangent to the graph of u at (x, u(x)) which majorizes u on some neighbourhood, and
this in turn implies the (local) existence of a sphere of support to the graph of u at (x, u(x)). The content
of (iii) is clear.
With this alternative geometric characterization in hand, Lemma 1.7 then proves the theorem in terms
of these spheres of support. To accomplish this another change in perspective is needed, which takes further
advantage of this more geometric interpretation of K(u, x). Instead of looking at points x in the domain of
u such that there exists a sphere of support to the graph of u at (x, u(x)), it is better to consider for each
point x in domain of u an nâˆ’sphere (of fixed radius) in Rn+1 above the graph of u with center c âˆˆ Rn+1
such that P (c) = x, where P : Rn+1 â†’ Rn is the projection map. If we lower this sphere down towards x
it will of course eventually intersect the graph of u. Since u is continuous, it is not difficult to show that
on a small enough neighbourhood these spheres will come down on a closed part of the graph of u and thus
there will be an initial point of contact. This sphere is by definition a sphere of support to the graph of u
at that point. The next step is to show that for every  neighbourhood of 0 (x0 = 0 for Lemma 1.7) there
is a corresponding Î´ = Î´() such that the spheres above the points in B(0, Î´) are spheres of support to the
graph at points (x, u(x)), where x âˆˆ B(0, ). Now B(0, Î´) is a much nicer set to work with then Xr âˆ© B(0, ),
and these two sets can be related by a few simple Lipschitz maps. Since Lipschitz maps behave nicely with
respect to measures, this allows us to place a lower bound on the measure m(Xr âˆ© B(0, )) for each epsilon.
A limiting argument is then used to obtain the lower bound on the lower density at 0.
Proposition 1.6 and Lemma 1.7 can then be combined to give Theorem 1.3. A sketch of the proof is
as follows. Start with a point x0 where K(u, x0 ) is finite (hypothesis of Theorem 1.3), and choose any
k > K(u, x0 ). Note it can be assumed without loss of generality that x0 = 0, u(0) = 0, and âˆ‡u(0) = 0 (see
section 2.3 for details). Then apply Proposition 1.6 (ii), which locally gives a sphere of support of radius
1/k at (x0 , u(x0 )). Now, apply Lemma 1.7 to get a lower bound on the density of Xr , r < 1/k, at x0 . Next,
apply Proposition 1.6 (iii) to convert this into a statement about the density of Xk0 , where
Xk0 â‰¡ {x âˆˆ dom(u)|K(u, x) < k}.

5

This last step is accomplished by using the continuity of the gradient to show that in a small enough
neighbourhood Xr âŠ‚ Xk0 . More explicitly, x âˆˆ Xr implies K(u, x) â‰¤ râˆ’1 (1 + |âˆ‡u(x)|2 )3/2 and âˆ‡u(x0 ) = 0,
so by continuity of the gradient of convex functions and since k > 1/r, âˆ‡u(x) will eventually be small enough
so that râˆ’1 (1 + |âˆ‡u(x)|2 )3/2 < k. Thus, for x âˆˆ Xr , K(u, x) < 1/k. This gives the theorem by choosing R
arbitrarily close to 1/k0 and r arbitrarily close to 1/k (see section 2.4 for a detailed proof).
2.2. The generalized C 1,1 estimate
Rn

u
t

r

d

x x+h

c

R

Figure 1: d : B(c, r) â†’ R
In this subsection we provide an alternative proof to Proposition 1.6 (iii). The main idea is as follows: given
a sphere of support of radius r to the graph of u at the point (x, u(x)), the lower hemisphere of this sphere
defines the graph of a smooth convex function that agrees up to first order with u at x and majorizes u
elsewhere. Denote this function by d. It immediately follows that K(u, x) â‰¤ K(d, x), and the rest of the
proof consists in computing K(d, x), which is equal to the largest eigenvalue of d because d is smooth
Proof of Proposition 1.6 (iii). Assume that the sphere S((c, t), r), c âˆˆ Rn supports the graph of u from the
above at (x, u(x0 )) and that u is differentiable at x0 . Define d : B(c, r) â†’ R to be the function whose graph
is the lower open hemisphere of S((c, t), r). Recall the definition for K(f, x0 ) :
K(u, x0 ) := lim sup 2âˆ’2 max {u(x0 + h) âˆ’ u(x0 ) âˆ’ hâˆ‡u(x0 ), hi : |h| = 1}.
â†’0

Clearly, since d(x0 ) = u(x0 ) and âˆ‡d(x0 ) = âˆ‡u(x0 ),
K(u, x0 ) â‰¤ K(d, x0 ).
Since d is smooth,
K(d, x0 ) = lim sup 2âˆ’2 max {d(x0 + h) âˆ’ d(x0 ) âˆ’ hâˆ‡d(x0 ), hi : |h| = 1}
â†’0

1
= lim sup 2âˆ’2 max { hâˆ‡2 d(x0 + Î³,h h)h, hi : |h| = 1},
0 < Î³,h < 1
2
â†’0
= lim sup max {hâˆ‡2 d(x0 + Î³,h h)h, hi : |h| = 1},
0 < Î³,h < 1
â†’0

= max {hâˆ‡2 d(x0 )h, hi : |h| = 1} by continuity and compactness.
=Î»max ,

maximum eigenvalue of âˆ‡2 d(x0 )

Thus, now we show that
3

Î»max

(1 + (âˆ‡u(x0 ))2 ) 2
.
=
r

The equation for d, the sphere of radius r centered at (c, t), where c âˆˆ Rn and t âˆˆ R, is
p
d(x) = t âˆ’ r2 âˆ’ |c âˆ’ x|2 .
6

Without loss of generality we may assume that the sphere of support is centered at the origin and x0 has
just first component non-zero, as otherwise we could always shift and then rotate without affecting the
second-order behavior.
In other words, assume (c, t) = 0 âˆˆ Rn+1 and x0 = (s1 , ..., sn ) = (s, 0, ..., 0) âˆˆ Rn .
p
2
Then d(x) = âˆ’ r âˆ’ |x|2 .
Let


1
|x âˆ’ x0 |2 + 2hx âˆ’ x0 , x0 i .
w(x) := 2
2
r âˆ’s
Since
|x|2 = hx, xi = h(x âˆ’ x0 ) + x0 , (x âˆ’ x0 ) + x0 i = |x âˆ’ x0 |2 + 2hx0 , x âˆ’ x0 i + |x0 |2
and |x0 |2 = s2 , we can write d(x) as
d(x) = âˆ’
Now expanding
Hessian at x0 ),

p

p

r2 âˆ’ s2

p

1 âˆ’ w(x).

1 âˆ’ w(x) as a series and dropping the terms of order higher than two (as they will have 0
p
d(x) â‰ˆ âˆ’ r2 âˆ’ s2

w(x) w(x)2
1âˆ’
âˆ’
2
8

!
.

This can be further reduced to
p
d(x) â‰ˆ âˆ’ r2 âˆ’ s2

w(x) 1
1âˆ’
âˆ’
2
8



2hx âˆ’ x0 , x0 i
r2 âˆ’ s2

2 !
,

since we are only concerned with the expression for d, modulo powers higher than two.
Thus, d(x) has been replaced by a diagonal quadratic form and straightforward computations give
âˆ‡d(x0 ) = âˆš
and
âˆ‡2 d(x0 ) = âˆš

x0
,
r2 âˆ’ s2

1
s
I+ 2
A,
2
(r
âˆ’
s2 )3/2
âˆ’s

r2

where I is the n Ã— n identity matrix and A is the n Ã— n matrix with first row x0 = (s, 0, ..., 0) and zeros
elsewhere. Since
s2
3 > 0,
(r2 âˆ’ s2 ) 2
it follows immediately that
Î»max = âˆš

1
s2
r2
=
+ 2
3 .
(r âˆ’ s2 )3/2
r2 âˆ’ s2
(r2 âˆ’ s2 ) 2

Furthermore, the vector (x0 , u(x0 )) is of length r, proportional to the upward pointing unit normal to the
graph of u at (x0 , u(x0 )), which is equal to
1
p

1 + |âˆ‡u(x0 )|2

Scaling by r, we obtain
x0 = p

(âˆ’âˆ‡u(x0 ), 1).

âˆ’r
1 + |âˆ‡u(x0 )|2

âˆ‡u(x0 ).

Giving
râˆ‡u(x0 )
x0 = p
,
1 + |âˆ‡u(x0 )|2

s2 = |x0 |2 =

7

r2 |âˆ‡u(x20 )
.
1 + |âˆ‡u(x0 )|2

Therefore,
3

Î»max =

(1 + |âˆ‡u(x0 )|2 ) 2
.
r


We state explicitly the following interesting result on â€œlower hemisphere functionsâ€, i.e. functions on a
disc D âŠ‚ Rn defined by the lower hemisphere of an nâˆ’ sphere in Rn+1 . The proof follows immediately from
the above proof, by looking at the expression for the Hessian.
Proposition 2.1. Let d : D â†’ R be a lower hemisphere function defined on a disc D âŠ‚ Rn and xÌƒ âˆˆ D. If
âˆ‡d(xÌƒ) 6= 0, then âˆ‡d(xÌƒ) 6= 0 is an eigenvector of âˆ‡2 d(xÌƒ) corresponding to the largest eigenvalue.
Proof. Without loss of generality we may assume that the lower hemisphere and thus D are centered at the
origin and xÌƒ has only first coordinate non-zero, xÌƒ = (s, 0, ..., 0). Then, as shown above, the Hessian of d at
xÌƒ is a diagonal n Ã— n matrix of the form
!
s2
1
1
1
2
+
, ..., âˆš
.
âˆ‡ d(xÌƒ) = diag âˆš
3 , âˆš
r2 âˆ’ s2
r2 âˆ’ s2
r2 âˆ’ s2
(r2 âˆ’ s2 ) 2
Thus, (1, 0, ..., 0) is an eigenvector corresponding to the largest eigenvalue. As calculated above,
âˆ‡d(xÌƒ) = âˆš

xÌƒ
s
=âˆš
(1, 0, ..., 0),
2
2
âˆ’s
r âˆ’ s2

r2

so clearly âˆ‡d(xÌƒ) is also an eigenvector corresponding to the largest eigenvalue.

2.3 The density lemma
If at the point x0 = 0 there is a sphere of support of radius R, Lemma 1.7 provides a lower bound on the
lower density of the set Xr of points with sphere of support of a radius r < R. Note that without loss of
generality it may be assumed that x0 = 0, u(0) = 0, and âˆ‡u(0) = 0, since any convex function uÌƒ can always
be adjusted by a constant and linear term so that this is true without affecting the 2nd-order behaviour of
uÌƒ.
As mentioned in section 2.1, Lemma 1.7 is proved by looking not directly at Xr but at small neighbourhoods
of 0 that are the projection of the set of centers of spheres of support to the graph of u on shrinking
neighbourhoods. For each  > 0 a Î´ = Î´() is needed so that B(0, Î´) is contained in the projection onto Rn
of the set of centers of spheres of support to the graph of u restricted to an epsilon neighbourhood. Since the
only information about u is that there is a sphere of support at 0, this is what is used to construct  and Î´.
More specifically, the appropriate â€™s and Î´â€™s are found by constructing a family of convex functions that are
identical to u on a neighbourhood of 0, but greater and simpler outside this neighbourhood. This allows one
to fully utilize the only initial information given. Using this family of simple functions and basic geometry,
three key set inclusions are obtained, which essentially relate B(0, Î´()) to Xr âˆ© B(0, ). Then using Lipschitz
maps to relate these sets and by applying properties of Lipschitz functions on measure, the lower density
bound is shown. This whole construction is crucial because it provides a much simpler approach to studying
the possibly very complex set Xr . The following is the proof given by Slodkowski.
Proof. of Lemma 1.7.
The number r âˆˆ (0, R) will be kept fixed so let X â‰¡ Xr . Define
Z = {(x, u(x)) âˆˆ Rn+1 : x âˆˆ X}.
It is clear that Z âˆ© (BÌ„(0, d0 ) Ã— R) is compact for every d0 < d, thus X âˆ© (BÌ„(0, d0 ) Ã— R) is also compact, as it
is the orthogonal projection P : Rn+1 â†’ Rn of Z. Since compact sets are Lebesgue measurable, the notion
of lower density is applicable to both X and Z.
It is more convenient to first estimate the density of Z at 0 with respect to Hausdorff measure, and then
use the properties of Lipschitz functions on measure to obtain bounds on the density of X. To accomplish
8

this a family of convex functions, built from the initial sphere of support of radius R at 0, which modify u
outside a small neighbourhood of 0 will be constructed. As mentioned above, these functions will be identical
to u on a neighbourhood of 0 and very simple outside this neighbourhood. These functions will enable us
to find a corresponding Î´ = Î´() neighbourhood for each  so that x âˆˆ B(0, Î´) implies that x = P (c), where
c âˆˆ Rn is the center of a sphere of support to (x0 , u(x0 )), for some x0 âˆˆ B(0, ) âˆ© Xr .
Step One. A family of convex functions is constructed which will let us find an appropriate Î´(), as explained
d
), define the function
above. For each Î± such that 0 < Î± < 21 arcsin( R
vÎ± : B(0, R) â†’ [0, âˆ),
as follows. First, define
Y = {y âˆˆ Rn+1 : |y âˆ’ c| = R, (y âˆ’ c, 0 âˆ’ c) = 2Î±},

(4)

where c = (0, ..., 0, R) âˆˆ Rn+1 is the center of the sphere of support to u at (0, u(0)). Y forms a â€œring â€on
R

R
TÎ±

c
2Î±

TÎ±

2Î±

Y

Y

u
âˆ’R sin 2Î±

R sin 2Î±

CÎ±

Rn

CÎ±

w

Figure 2: Construction of Auxiliary Convex Functions
S(c, R), and clearly the projection of Y , P (Y ), onto Rn is the n âˆ’ 1 sphere of radius R sin 2Î±, centered at 0.
Next, let CÎ± denote the union of all closed segments wy with one endpoint w on the axis 0 Ã— R âŠ‚ Rn+1 and
tangent to the sphere S(c, R) at the other endpoint y, where y âˆˆ Y . Note that w is independent of which
y âˆˆ Y that is being used. CÎ± is simply a finite cone with vertex w and base Y , tangent to S(c, R) along Y .
See Figure 2.
Define now
TÎ± = {y âˆˆ S(c, R) : R(1 âˆ’ cos 2Î±) â‰¤ yn+1 < R}.

(5)

TÎ± can be visualized as a â€œstripâ€ of S(c, r), and note that TÎ± âˆ© CÎ± = Y and that TÎ± âˆª CÎ± defines a convex
function kÎ± : B(0, R) â†’ R.
d
), define
For 0 < Î± < 21 arcsin( R
(
max(u(x), kÎ± (x)),
|x| < R sin 2Î±
vÎ± =
kÎ± (x),
R sin 2Î± â‰¤ |x| < R.
Note that u is only defined on B(0, d) and R sin 2Î± < d < R, so that is why vÎ± is defined this way. It is clear
that
vÎ± (x) â‰¥ u(x), for |x| < d.
9

(6)

Observe that vÎ± is locally convex on the set |x| =
6 R sin 2Î± since for |x| > R sin 2Î±, vÎ± = kÎ± (x), which is
convex, and for |x| < R sin 2Î±, vÎ± is the maximum of two convex functions which is convex. If |x| = R sin 2Î±,
then (x, vÎ± (x)) âˆˆ Y âŠ‚ S(c, r) Since S(c, r) lies above the graph of u, so kÎ± |Y > u|Y . Thus near Y, vÎ± â‰¡ kÎ± ,
and so vÎ± is locally convex in B(0, R), which implies that vÎ± is convex.
Step Two. For any convex function the following Lipschitz map can be constructed. This will let us
relate the possibly complex set, X, to the disk B(0, Î´()). Given a convex function v : B(0, R) â†’ R. Let
E(v) = {(x, t) âˆˆ Rn+1 : t > v(x)} denote the strict epigraph of v, and define Z v as the set of all y = (x, v(x)),
where |x| < R, and such that for some c0 âˆˆ Rn+1 , B(c0 , r) âŠ‚ E(v) and y âˆˆ S(c0 , r), where r < R, as defined
earlier.
Note that if y = (x, v(x)) âˆˆ Z v , then the graph(v) has a unique supporting hyperplane at y (since any
such hyperplane is tangent to S(c0 , r)), and thus c0 is uniquely determined by y.
Now consider the map Î³ v : Z v â†’ Rn+1 , where Î³ v (y) = c0 . This map is Lipschitz with constant one. To
see this, let y1 , y2 âˆˆ Z v and c0i = Î³ v (yi ), i = 1, 2. The set E(v) is convex (by definition since v is convex),
and so it contains W := co(B(c1 , r) âˆª B(c1 , r)), where co() denotes the convex hull. In particular, W âˆ©
graph(v)=âˆ…. Since yi âˆˆ S(ci , r) âˆ© graph(v), yi âˆˆ S(c0i , r) \ W, i = 1, 2. Thus, y1 and y2 do not belong to, and
are separated by, the open region between two hyperplanes which are orthogonal to the segment c01 c02 and
pass through its ends. Therefore |c01 âˆ’ c02 | â‰¤ |y1 âˆ’ y2 |. The importance of this map will be seen below, where
combined with u and the projection map P it allows the set of interest in Rn to be related to a small disk.
Step Three. Three key set inclusions are established. Along with step two this will allow on small
neighborhoods the measure of X to be bounded from below by the volume of small nâˆ’ balls. Using
the notation above, let Z Î± and Î³ Î± denote the set Z v and map Î³ v , respectively, for v = vÎ± , where
d
0 < Î± < 12 arcsin( R
).
Consider the set
UÎ± = graph(vÎ± ) \ (CÎ± âˆª TÎ± ).

(7)

d
Note that this is a subset of the graph of u. For Î± âˆˆ (0, 21 arcsin( R
)), we have the following three inclusions:

P (UÎ± ) âŠ‚ B(0, R sin 2Î±)

(8)

Z Î± âˆ© UÎ± âŠ‚ Z âˆ© UÎ±

(9)

Î±

Î±

BN (0, Î´) âŠ‚ P Î³ (Z âˆ© UÎ± ), where Î´ = (R âˆ’ r) tan Î±.

(10)

The first inclusion follows directly from the definition of UÎ± : |x| â‰¥ R sin 2Î± â‡’ vÎ± (x) âˆˆ TÎ± .
By (5), Z Î± âˆ© graph(u) âŠ‚ Z. To see this, let z âˆˆ Z Î± . Thus we have a c0 âˆˆ Rn+1 such that B(c0 , r) âŠ‚ E(vÎ± )
and z âˆˆ S(c0 , r). So there is a sphere of radius r supporting the graph of vÎ± from above at z. If z âˆˆ graph(u),
then we must have z âˆˆ Z: B(c0 , r) âŠ‚ E(vÎ± ) and vÎ± (x) â‰¥ u(x) give us that B(c0 , r) âˆ© graph(u) = âˆ… and
c0n+1 > u(P c0 ), which together with z âˆˆ S(c0 , r) imply that z âˆˆ Z, by definition. Since UÎ± âŠ‚ graph(u), Z Î± âˆ©
UÎ± âŠ‚ Z Î± âˆ© graph(u) âŠ‚ Z. And of course Z Î± âˆ© UÎ± âŠ‚ UÎ± , so together we have Z Î± âˆ© UÎ± âŠ‚ Z âˆ© UÎ± , which gives
us the second inclusion.
The third inclusion is the critical aforementioned relation between the set of points with spheres of
support and a disk in Rn . (Below we will take  = R sin Î± and Î´ = (R âˆ’ r) tan Î±). To obtain this inclusion
we proceed as follows. Let x âˆˆ Rn , be such that |x| < R âˆ’ r, and consider the set
{c0 âˆˆ {x} Ã— R : B(c0 , r) âŠ‚ E(vÎ± )}.

(11)

This set is a non-empty, closed half-line. To see this, consider lowering the sphere S((x, c0n+1 ), r) in Rn+1
onto the graph of vÎ± , by continuously decreasing the last coordinate. Because the radius of this sphere is r
and |x| < R âˆ’r, this sphere comes down on a closed subset of the graph of vÎ± . Once contact is made with the
graph of vÎ± we stop, and the corresponding value of (x, c0n+1 ) is our closed endpoint. Let c0 âˆˆ Rn+1 be this
endpoint and y âˆˆ S(c0 , r) âˆ© graph(vÎ± ) (note that y may not be unique). Then c0 = Î³ Î± (y) and x = P Î³ Î± (y),
and so
BN (0, R âˆ’ r) âŠ‚ P Î³ Î± (Z Î± ).

10

(12)

u
âˆ—

c
2Î±

2Î±

Î±
c

cN +1

âˆ’R sin 2Î±

R sin 2Î±

CÎ±

CÎ±

w

Figure 3: Closest Supporting Spheres to Origin

Now Z Î± \ (CÎ± âˆª TÎ± ) âŠ‚ graph(vÎ± ) \ (CÎ± âˆª TÎ± ) = UÎ± , so clearly Z Î± \ (CÎ± âˆª TÎ± ) âŠ‚ Z Î± âˆ© UÎ± . Therefore,
P Î³ Î± (Z Î± ) \ P Î³ Î± (Z Î± âˆ© (CÎ± âˆª TÎ± )) âŠ‚ P Î³ Î± (Z Î± âˆ© UÎ± ).

(13)

This relation and (12) will give us our third inclusion (9), once we show that
P Î³ Î± (Z Î± âˆ© (CÎ± âˆª TÎ± )) âˆ© BN (0, Î´) = âˆ….

(14)

Consider the family of all spheres S(c0 , r) which support CÎ± \Y from above and are contained in the upper
half space yn+1 â‰¥ 0. Clearly the smallest value of |P (c0 )| is attained when the sphere S(c0 , r) is tangent to
both CÎ± and {yn+1 = 0} (see Fig. 3). It is not difficult to see that in this case (c0 âˆ’c, 0âˆ’c) = Î±, where c here
is the center of the initial sphere of support. This gives us |P (c0 )| = (|c| âˆ’ c0N +1 ) tan Î± = (R âˆ’ r) tan Î± = Î´,
which implies
P Î³ Î± (Z Î± âˆ© CÎ± ) âˆ© BN (0, Î´) = âˆ….

(15)

Now when S(c0 , r) supports TÎ± \ Y from the above at some point y, the segment c0 , y is normal to S(c, R)
and yN +1 â‰¥ R(1 âˆ’ cos 2Î±) â‰¥ Î´. Thus (c0 âˆ’ c, 0 âˆ’ c) â‰¥ 2Î± and, as above, |P (c)| â‰¥ (R âˆ’ r) tan 2Î± â‰¥ Î´ (note
0 â‰¤ Î± â‰¤ Ï€4 ). This gives
P Î³ Î± (Z Î± âˆ© TÎ± ) âˆ© BN (0, Î´) = âˆ….

(16)

Combining (15) and (16) we have (13), which gives the third inclusion.
Step Four. Estimate of the density of X. The above inclusions and the effect of Lipschitz maps on measure,
will be enough to estimate the density of X = P (Z). Recall that Z = {(x, u(x)) âˆˆ RN +1 |x âˆˆ X}, where X
is the set of points in B(0, d) âŠ‚ RN such that there exists a sphere of radius r supporting the graph of u
from above at (x, u(x)).
Using a few theorems from Rockafellar [7], it can be shown that the map Ï• : P (UÎ± ) â†’ UÎ± , where
1
Ï•(x) = (x, u(x)) is Lipschitz with constant (1 + gÎ±2 ) 2 , where gÎ± = sup{|âˆ‡u| : |x| < R sin 2Î±}. More
specifically, by Theorem 10.4, u is Lipschitz, and by Theorems 24.7, 25.5, and 25.6 gÎ± is a Lipschitz bound
1
for u|B(0,R sin 2Î±) ). A simple Pythagorean argument then shows (1 + gÎ±2 ) 2 is a Lipschitz bound for Ï•. Notice
that Ï• maps X âˆ© P (UÎ± ) = P (Z âˆ© UÎ± ) onto Z âˆ© UÎ± .
11

A basic theorem regarding the effect of Lipschitz maps on Hausdorff measures (Theorem 2.29 in Rogers
[8]), along with our first inclusion from above (7), leads to:
n

H n (Z âˆ© UÎ± ) â‰¤(1 + gÎ±2 ) 2 mn (X âˆ© P (UÎ± ))
n

â‰¤(1 + gÎ±2 ) 2 mn (X âˆ© B(0, Îµ)),

Îµ = R sin 2Î±,

where again H n and mn denote the Hausdorff and Lebesgue measure on Rn , respectively. Furthermore
mn (B(0, Î´)) â‰¤mn (P Î³ Î± (Z Î± âˆ© UÎ± ))

by (9)

â‰¤H n (Z Î± âˆ© UÎ± )

P Î³ Î± is Lipschitz with constant â‰¤ 1

â‰¤H n (Z âˆ© UÎ± )

by (8).

Finally, combining these inequalities one obtains
âˆ’n mn (B(0, Î´))
mn (X âˆ© B(0, Îµ))
â‰¥ (1 + gÎ±2 ) 2
mn (B(0, Îµ))
mn (B(0, Îµ))

n
âˆ’n
(R âˆ’ r) tan Î±
= (1 + gÎ±2 ) 2
R sin 2Î±
n

âˆ’n
Râˆ’r
= (1 + gÎ±2 ) 2
cosâˆ’2n Î±,
2R
n

where the volume of an n-ball of radius r is
Thus,

Ï€ 2 rn
in the first equality, and Î“ denotes the gamma function.
Î“( n2 + 1)

âˆ’n
mn (X âˆ© B(0, Îµ))
â‰¥ lim inf (1 + gÎ±2 ) 2
lim inf
Îµâ†’0
Îµâ†’0
mn (B(0, Îµ))



Râˆ’r
2R

n

cosâˆ’2n Î±.

Now since Îµ = R sin 2Î± and 0 < Î± < Ï€4 , as Îµ â†’ 0, Î± â†’ 0. And as the gradient of a convex function is
continuous (Theorem 25.5, [1]), gÎ± â†’ 0 as well since âˆ‡u(0) = 0. Therefore the lower density of X at 0 is

N
Râˆ’r
not less than
.
2R
2.4 Proof of Theorem 1.3
Lemma 1.7 and Proposition 1.6 now combine nicely to give us Theorem 1.3.
Proof of Theorem 1.3. First, we prove the density result. Without loss of generality, let x0 = 0, u(x0 ) =
0, âˆ‡u(x0 ) = 0. Note that by the convexity of u this implies u â‰¥ 0. Set k0 = K(u, x0 ) = K(u, 0), and let
k > k0 be fixed and take K such that k > K > k0 .
1
K 2
1
1
and note that R âˆ’ (R2 âˆ’ |x|) 2 â‰¥
|x|2 =
|x| , âˆ€x such that |x| < R. This follows
Set R =
K
2R
2
immediately by contradiction. The left-hand side of this inequality is the last component of the point
(x, t) âˆˆ Rn , where x âˆˆ Rn , on the (n + 1)-dimensional sphere of radius R centered (0, ..., 0, R) âˆˆ Rn+1 (i.e
the value of d(x), where d is the lower hemisphere function defined in the proof of the proposition, see Fig.
1).
Since K > K(u, 0), by Proposition 1.6 (ii) there exists d > 0 such that
u(0 + h) âˆ’ u(0) âˆ’ hâˆ‡u(0), hi â‰¤

1
K|h|2 for every |h| < d.
2

So
u(h) â‰¤

1
K|h|2 for every |h| < d.
2

12

R

R

1
R2 âˆ’ |x|2 2

1
|x|2
2R
x

Rn

Figure 4
Thus the sphere S(c, R), where c = (0, ...0, R) âˆˆ Rn+1 , supports the graph of u|B(0,d) form above at 0 âˆˆ Rn+1 ,
and Lemma 1.7 can be applied to the function u|B(0,d) .
Let r, such that k1 < r < R, be arbitrary, and let X = Xr and Z = Zr be defined as in Lemma 1.7. By
Proposition 1.6 (iii), âˆ€x âˆˆ X
3

K(u, x) â‰¤

(1 + g 2 ) 2
,
r

where g = |âˆ‡u(x)|.

Set
gÎµ = sup{|âˆ‡u(x)| : |x| < Îµ}.
Then clearly
3

(1 + gÎµ2 ) 2
K(u, x) â‰¤
r

âˆ€x âˆˆ X âˆ© B(0, Îµ).

By the continuity of the gradient function, limÎµâ†’0 gÎµ = |âˆ‡u(0)| = 0. Thus since
where 0 < Îµ0 < d, such that

1
< k, there exists Îµ0 ,
r

3

(1 + gÎµ2 ) 2
< k,
r

for 0 < Îµ < Îµ0 ,

and so
(B(0, Îµ) âˆ© X) âŠ‚ (B(0, Îµ) âˆ© Xk0 ),

for 0 < Îµ < Îµ0 .

If x âˆˆ X then there exists a supporting sphere of radius r at (x, u(x)), and if x âˆˆ B(0, Îµ), where Îµ < Îµ0 , then
K(u, x) < k.
It follows by Lemma 1.7 that
lim inf
Îµâ†’0

mn (Xk0 âˆ© B(0, Îµ))
mn (X âˆ© B(0, Îµ))
â‰¥ lim inf
Îµâ†’0
mn (B(0, Îµ))
mn (B(0, Îµ))

n
Râˆ’r
â‰¥
.
2R

1
1
1
1
was chosen arbitrarily so that it satisfied the inequality <
< , where k and
K
k
K
k0
1
1
1
k0 are fixed. Similarly, r was chosen arbitrarily so that
<r<
. Thus we can choose R =
and r
k
K
K

Now recall that R =

13

arbitrarily close to

1
1
and , respectively, giving us the desired bound
k0
k



k âˆ’ k0
2k

n
.

Finally, the fact that Xk0 := {x âˆˆ dom (u) : K(u, x) < k} is Borel is contained in Proposition 2.2 and
Lemma 2.3 below. Let u : Rn â†’ R convex. Proposition 2.2 shows that the set W on which u is differentiable
is Borel, specifically a FÏƒÎ´ , and Lemma 2.3 proves that K(x) := K(u, x) is of second Baire class on this set.
Since K(x) = +âˆ where âˆ‡u doesnâ€™t exists,
Xk0 = {x âˆˆ dom (u) : K(x) < k} = {x âˆˆ W : K|W (x) < k}.
It follows immediately that Xk0 is Borel, as K|W : W â†’ R is a Borel measurable function. Recall that Baire
class 1 functions are the pointwise limit of continuous functions and thus Borel measurable, and Baire class
2 functions are the pointwise limit of Baire class 1 functions and thus also Borel measurable.
Proposition 2.2. Let u : Rn â†’ R be convex. Then the set on which u is differentiable is a dense Borel set,
specifically an FÏƒÎ´ .
Proof. Since u is convex, u is differentiable at x if and only if all the partial derivatives of u exist at x, with
respect to any basis [6, IV.4.2]. Let {ei }ni=1 be the standard basis in Rn , and define
f 0 (x, ei ) := lim
tâ†“0

f (x + tei ) âˆ’ f (x)
.
t

âˆ‚f
(x) exists if and only if f 0 (x, ei ) = âˆ’f 0 (x, âˆ’ei )[6, IV.4.2]. Note that the above limit always exists
Then âˆ‚x
i
for a convex function and f 0 (x, ei ) â‰¥ âˆ’f 0 (x, âˆ’ei ) for all x. Take E to be the set where u is not differentiable
âˆ‚f
and Ei to be the set of points where âˆ‚x
(x) does not exist. Then E = âˆªni=1 Ei , and
i

Ei = {f 0 (x, ei ) + f 0 (x, âˆ’ei ) > 0}.
If x âˆˆ Ei , then there exists N such that for all n â‰¥ N ,
f (x +

ei
k)
1
k

âˆ’ f (x)

+

f (x âˆ’

ei
k)
1
k

âˆ’ f (x)

>

1
,
n

for all k â‰¥ n. Let
(
En,k =

x:

f (x +

ei
k)
1
k

âˆ’ f (x)

+

f (x âˆ’

ei
k)
1
k

âˆ’ f (x)

1
>
n

)
,

and note that En,k is open since f is continuous (a real-valued convex function). Thus,
âˆ
Ei = âˆªâˆ
n=1 âˆ©k=n En,k ,

which is clearly a GÎ´Ïƒ and so E is also a GÎ´Ïƒ , being a union of finitely many. Therefore, the set Rn \ E on
which u is differentiable is an FÏƒÎ´ . That Rn \ E is dense is well-known.
Lemma 2.3. Let u : Rn â†’ R be convex and W âŠ‚ Rn the set on which u is differentiable. Then the function
K(x) := K(u, x) is of second Baire class on W .
Proof. We follow notes of Slodkowski, not contained in [9], for this proof. Let

	
2
f (x, ) = 2 max u(x + h) âˆ’ hâˆ‡u(x), hi : |h| = 1 .

Then K(x) = lim sup>0 f (x, ). Since u is convex, âˆ‡u(x) is continuous on W , and so f (x, ) is a continuous
function on W Ã— (0, âˆ).
Next, let


1
g(x, n) = sup f (x, ) : 0 <  <
.
n
Since g(Â· , n) is the supremum of a family of continuous functions it is lower semicontinuous, and thus the
limit of an increasing sequence of continuous functions on W . Therefore,g(Â· , n) is of first Baire class.
Now, note that
lim sup f (x, ) = lim g(x, n),
nâ†’âˆ

>0

and thus K(x) is of second Baire class as it is the limit of Baire class one functions.
14

3. Dual Perspective
3.1 Background
Since u is convex near x0 , it is natural to study this quantity K(u, x0 ) from the dual perspective as well. Let
Cvx(Rn ) denote the space of convex, lower semi-continuous functions on Rn . Given a function u âˆˆ Cvx(Rn ),
one can apply the Legendreâ€“Fenchel transform L : Cvx(Rn ) â†’ Cvx(Rn ) of u to obtain its conjugate or
dual function uâˆ— , where
uâˆ— â‰¡ L u(s) = sup(hs, xi âˆ’ u(x)).
x

L is an order-reversing, involutive transform on Cvx(Rn ), and for sufficiently nice convex functions (differentiable,
strictly convex, and 1-coercive), uâˆ— is given by
uâˆ— (s) = hs, (âˆ‡u)âˆ’1 (s)i âˆ’ u((âˆ‡u)âˆ’1 (s)).
The conjugate function uâˆ— can be viewed as a reparametrization of the original function u in terms of its
tangents using the duality between points and hyperplanes. More specifically, given a vector in Rn , there is
an associated family of hyperplanes with that gradient. uâˆ— distinguishes the one that supports the epigraph
of u by specifying a point on that plane.
For convex functions defined only in a neighbourhood it is standard to extend the function to all of Rn by
setting it equal +âˆ outside that neighbourhood. In our case, we are given u convex near x0 , so we extend
it in this manner, if necessary. Clearly this does not affect K(u, x0 ), which is a purely local property. Recall
the following basic definitions:
Definition 3.1. The differentiable function f : Rn â†’ R is convex if for all x, x0 âˆˆ Rn
f (x0 ) â‰¥ f (x) + hâˆ‡f (x), (x0 âˆ’ x)i,
and strictly convex if the inequality is strict for x 6= x0 .
Definition 3.2. The differentiable function f : Rn â†’ R is strongly convex with modulus c if and only if for
all (x, x0 ) âˆˆ Rn Ã— Rn ,
1
f (x0 ) â‰¥ f (x) + hâˆ‡f (x), (x0 âˆ’ x)i + c|x0 âˆ’ x|2 .
2
When f is not differentiable a lot of analysis can still be done using the calculus of subdifferentials.
n
Definition
of f , denoted âˆ‚f , is a set function, where
 3.3.n Let f : R â†’ R be convex. The nsubdifferential
	
âˆ‚f (x) = s âˆˆ R : f (y) â‰¥ f (x) + hs, y âˆ’ xi âˆ€y âˆˆ R .

Under the Legendre transform, differentiability of u corresponds to convexity or monotonicity of uâˆ— . Recall
from Proposition 1.8, two properties that transform especially well are (i) u âˆˆ C 1 if and only if uâˆ— is strictly
convex, and (ii) u âˆˆ C 1,1 , where âˆ‡u has Lipschitz constant c if and only if u is strongly convex with modulus
1
c.
3.2 Quadratic convexity
In this section we look at how a bound on K(u, x0 ) or equivalently a sphere of support to the graph of u
at (x0 , u(x0 )) transforms to a property of uâˆ— . More specifically, since K or a sphere of support is a bound
on a generalized second-order derivative of u, how does this translate to information about the convexity of
uâˆ— ? We should expect a more localized property then in Proposition 1.8, as we only have information at x0 .
Further, we are not assuming any regularity beyond differentiable at x0 .
Now, strong convexity may also defined in terms of quadratic functions: u is strongly convex with
modulus m if u âˆ’ 21 m|x|2 is convex. Similarly, quasi-convexity, is defined via quadratics: u is Î»- quasi-convex
if u + 21 Î»|x|2 is convex.

15

Let u : Rn â†’ R be convex with K(u, x0 ) = k0 < âˆ. By the definition of K(u, x), for any k > k0 there
exists  > 0 such that
1
u(x0 + h) âˆ’ u(x0 ) âˆ’ hâˆ‡u(x0 ), hi â‰¤ k|h|2 , for all |h| < .
2
This motivates the following definition.
Definition 3.4. Let f : Rn â†’ R be convex. Then f is quadratically (resp. sub-quadratically) convex at x0
with modulus m > 0 if there exists  > 0 and a quadratic function Q : Rn â†’ R with âˆ‡2 Q = mI such that
f (x0 ) = Q(x0 ) and f (x) â‰¥ Q(x),

âˆ€x âˆˆ B(x0 , )

f (x0 ) = Q(x0 ) and f (x) â‰¤ Q(x),

âˆ€x âˆˆ B(x0 , ).

resp.
Example 3.5. f (x) = |x|4/3 is quadratically convex at 0, but not sub-quadratically convex at 0. Note also
that K(f, 0) = +âˆ and it does not have a sphere of support at 0.
Example 3.6. More generally, consider any function of the form f (x) = A|x|k , at x = 0. If 0 < k < 1, f is
not convex. If k = 1, f is quadratically convex at 0, but not sub-quadratically convex. If 1 < k < 2 then f is
strictly convex and quadratically convex but not sub-quadratically convex. If k = 2, f is both quadratically
convex and sub-quadratically convex. If k > 2, f is sub-quadratically convex but not quadratically convex.
k

q

If f is of the form f = |x|k , then f âˆ— = |y|q , where k1 + 1q = 1. So, in general, given that the LegendreFenchel transform is order-reversing and quadratics are transformed into quadratics, it follows that if f is
quadratically convex, f âˆ— is sub-quadratically convex. For a convex C 2 function f , if âˆ‡2 f (x0 ) is positive
definite then f is both quadratically and sub-quadratically convex at x0 .
Proof of Theorem 1.9. Suppose K(u, x0 ) = k0 < âˆ. As stated above, by definition of K(u, x0 ), for any
k > k0 , there exists  > 0 such that u satisfies
u(x) âˆ’ u(x0 ) âˆ’ hâˆ‡u(x0 ), x âˆ’ x0 i â‰¤

1
k|x âˆ’ x0 |2 ,
2

for all x âˆˆ B(x0 , ). Thus, on this neighbourhood of x0
1
u(x) â‰¤ u(x0 ) + hâˆ‡u(x0 ), x âˆ’ x0 i + k|x âˆ’ x0 |2 .
2
By assumption u is convex, and k > k0 â‰¥ 0, so the right-hand side is also convex. Taking the Legendre
transform gives

2
1  y âˆ’ âˆ‡u(x0 ) 
âˆ—
u (y) â‰¥ hâˆ‡u(x0 ), x0 i âˆ’ u(x0 ) + hx0 , y âˆ’ âˆ‡u(x0 )i + k 
 .
2
k
Now uâˆ— may not be differentiable at âˆ‡u(x0 ), however âˆ‡u(x0 ) âˆˆ âˆ‚u(x0 ) if and only if x0 âˆˆ âˆ‚uâˆ— (âˆ‡u(x0 )),
which is equivalent to uâˆ— (âˆ‡u(x0 )) = hâˆ‡u(x0 ), x0 i âˆ’ u(x0 ). So the above inequality simplifies to
uâˆ— (y) â‰¥ uâˆ— (âˆ‡u(x0 )) + hx0 , y âˆ’ âˆ‡u(x0 )i +

1
|y âˆ’ âˆ‡u(x0 )|2 .
2k

Note that there is equality at y0 = âˆ‡u(x0 ) and the Hessian of the right-hand side is k1 I so uâˆ— is quadratically
convex with modulus k1 .
On the other hand, if uâˆ— is quadratically convex at y0 = âˆ‡u(x0 ) with modulus k1 then u will be subquadratically convex with modulus k at x0 , and it follows that K(u, x0 ) â‰¤ k.
In the above proof we do not need to worry about âˆ‚u(B(x0 , )) being degenerate (for example if u is
locally a hyperplane at x0 ) because in that case uâˆ— (y) will then be +âˆ away from âˆ‡u(x0 ) so clearly the
inequality will hold on some neighbourhood.
Our goal now is to obtain the nice bound on K(u, x) in Proposition 1.6 using the dual function, given a
sphere of support to the graph of u at (x, u(x)). The following elementary lemma, which we state without
proof, will help us to reduce arguments on Rn to ones on R.
16

Lemma 3.7. Let Sr be an n-sphere with radius r in Rn+1 , centered at (0, ..., 0, p
r), and let d : Rn â†’ R be
the function defined by the lower hemisphere, i.e., for z âˆˆ Bn (0, r), d(z) = r âˆ’ r2 âˆ’ |z|2 . Then for any
x âˆˆ Bn (0, r) and v âˆˆ Rn , |v| = 1, the graph of Ïˆ : I âŠ‚ R â†’ Rn+1 defined by Ïˆ(t) = d(x + tv) is a lower
semi-circle in Rn+1 of radius â‰¤ r, where I = (âˆ’, 0 ) is of maximal length.
Proposition 3.8. Let f : Rn â†’ R be C 2 and convex and suppose there exists a sphere of support to the
graph of f at (x0 , f (x0 )) of radius r. Then
3

K(f, x0 ) â‰¤

(1 + âˆ‡f |2x0 ) 2
.
r

Proof. Because f is C 2 , K(f, x0 ) is the largest eigenvalue Î»max of âˆ‡2 f (x0 ). If Î»max =0 or âˆ‡f (x) = 0 then the
bound on K(f, x0 ) is trivial, so let Î»max > 0 and âˆ‡f (x) 6= 0. f is convex so âˆ‡2 f (x0 ) is symmetric positive
semi-definite, and there exists an orthonormal basis of eigenvectors. Let v be the eigenvector coresponding
1
, the smallest eigenvalue of
to Î»max . By duality, v is also an eigenvector corresponding to Î»âˆ—min = Î»max
2 âˆ—
âˆ‡ f (âˆ‡f (x0 )). This follows from the fact that the Hessians of dual functions satisfy
âˆ‡2 f âˆ— (y0 ) = âˆ‡2 f (x0 )âˆ’1 ,

where y0 = âˆ‡f (x0 ).

(Here we assume without loss of generality that âˆ‡2 f (x0 ) is invertible because we are only concerned with
Î»max > 0).
Let S((c, t), r) be the sphere of support of radius r, to the graph of f at x0 , and d the associated lower
hemisphere function, i.e.
p
d(x) =t âˆ’ r2 âˆ’ |x âˆ’ c|2 , x âˆˆ BÌ„(c, r)
d(x) =âˆ, else.
Clearly d is convex and d â‰¥ f , by definition of a supporting sphere. Also, recall that f and d agree up to
first order at x0 .
Again by basic properties of the Legendre transform, the following relations hold:
f âˆ— (y0 ) = dâˆ— (y0 )

f âˆ— â‰¥ dâˆ—

âˆ‡f âˆ— (y0 ) = âˆ‡dâˆ— (y0 ) = x0 .

It follows that
âˆ—
Î»âˆ—min â‰¥ Î³min
âˆ—
where Î³min
is the smallest eigenvalues of âˆ‡2 dâˆ— (âˆ‡f (x0 )). Note that this is equivalent to

Î»max â‰¤

1

.
âˆ—
Î³min

âˆ—
Given this bound, we now show that Î³min
can always be computed using a function on R.
0
âˆ—
Let v be the unit-length eigenvector corresponding to Î³min
and Î³max . By Proposition 2.1, v 0 is in
Ëœ the restriction of d to this 1âˆ’dimensional subspace defines
the direction of âˆ‡d(x0 ). By Lemma 3.7, d,
a lower semi-circle function, and this function has the properties: dËœ0 (x0 ) = hâˆ‡d(x0 ), v 0 i = |âˆ‡d(x0 )| and
âˆ—
dËœ00 (x0 ) = Î³max . Therefore, the dual function dËœâˆ— has second derivative at |âˆ‡f (x0 )| equal to Î³min
, and so we
may assume without loss of generality that f and d are functions on R.
Now we compute dâˆ— directly by using the Legendre transforms of common functions. Rewriting d
p
d(x) =t âˆ’ r2 âˆ’ (x âˆ’ c)2
s

2
x c
=t âˆ’ r 1 âˆ’
âˆ’
,
r
r

and then applying the following well-known conjugate pairs:
p
p
h(x) = âˆ’ 1 âˆ’ x2
hâˆ— (y) = 1 + y 2
yâˆ’Î²
yâˆ’Î²
g(x) = Î± + Î²x + Î³u(Î»x + Î´)
g âˆ— (x) = âˆ’Î± âˆ’ Î´
+ Î³uâˆ— (
),
Î»
Î³Î»
17

gives
dâˆ— (y) = âˆ’ t + cy + r
d âˆ—
ry
d (y) =c + p
dy
1 + y2
d2 âˆ—
r
d (y) =
3 .
dy 2
(1 + y 2 ) 2

p

1 + y2

Thus,
3

K(f, x0 ) = Î»max

1
(1 + |âˆ‡f (x0 )|2 ) 2
â‰¤ d2
=
.
âˆ—
r
dy 2 d (|âˆ‡f (x0 )|)

The more general case, where f is not assumed to be C 2 , will use Proposition 3.8 and quadratic convexity
of the dual.
Proposition 3.9. Let f : Rn â†’ R be convex with a sphere of support at x0 of radius r. Then K(f, x0 ) â‰¤
3
(1 + âˆ‡f |2x0 ) 2
.
r
Proof. Let d be the lower hemisphere function. Then d(x0 ) = f (x0 ), and
d â‰¥ f â‡’ f âˆ— â‰¥ dâˆ— .
If y0 = âˆ‡f (x0 ) (which exists since there is a sphere of support) then
dâˆ— (y0 ) = f âˆ— (y0 ) and âˆ‡dâˆ— (y0 ) âˆˆ âˆ‚f âˆ— (y0 ).
From Proposition 3.8 the smallest eigenvalue of âˆ‡2 dâˆ— (y0 ) is equal to

r
3

(1+|y0 |2 ) 2

, so for any m <

r
3

(1+|y0 |2 ) 2

there exists a neighbourhood U of x0 such that
1
f âˆ— (y) â‰¥ dâˆ— (y) â‰¥ dâˆ— (y0 ) + hâˆ‡dâˆ— (y0 ), y âˆ’ y0 i + m|y âˆ’ y0 |2 .
2
Thus, f âˆ— is quadratically convex with modulus m.
It follows that f = (f âˆ— )âˆ— is sub-quadratically convex at x0 with modulus
quadratic. This implies that
1
K(f, x0 ) â‰¤ K(Qm , x0 ) = ,
m
r
and since this holds for any m <
3 ,
2

1
m.

Let Qm be a satisfying

(1+|y0 | ) 2

3

K(f, x0 ) â‰¤

3

(1 + |âˆ‡f (x0 )|2 ) 2
(1 + |y0 |2 ) 2
=
.
r
r

Appendix
A.1 Lipschitz gradient
Here we show that the generalized derivative K(f, x) retains the following standard property regarding the
derivative of a Lipschitz continuous function.
Proposition A.1. Suppose f : Rn â†’ R is convex and C 1,1 (i.e f is differentiable and has Lipschitz
gradient), with Lipschitz constant L. Then K(f, x) â‰¤ L for all x.
18

Proof. Let x0 âˆˆ Rn .
K(f, x0 ) := lim sup 2âˆ’2 max {f (x0 + h) âˆ’ f (x0 ) âˆ’ hâˆ‡f (x0 ), hi : |h| = 1},
â†’0

which can be can written as

K(f, x0 ) = lim sup max
â†’0


f (x0 + h) âˆ’ f (x0 ) âˆ’ hâˆ‡f (x0 ), hi
:
|h| = 1 .
2
2

Differentiability lets us use the Cauchy mean value theorem. Let Ï†1 () = f (x0 + h) âˆ’ hâˆ‡f (x0 ), hi, and
Ï†2 () = 2 . Note that
f (x0 + h) âˆ’ f (x0 ) âˆ’ hâˆ‡f (x0 ), hi
Ï†1 () âˆ’ Ï†1 (0)
2
=2
.
2
Ï†2 () âˆ’ Ï†2 (0)
Thus, there exists Î³ âˆˆ (0, ) such that
2

Ï†0 (Î³) hâˆ‡f (x0 + Î³h), hi âˆ’ hâˆ‡f (x0 ), hi
Ï†1 () âˆ’ Ï†1 (0)
=
= 2 10
Ï†2 () âˆ’ Ï†2 (0)
Ï†2 (Î³)
Î³
hâˆ‡f (x0 + Î³h) âˆ’ âˆ‡f (x0 ), hi
=
Î³
|âˆ‡f (x0 + Î³h) âˆ’ âˆ‡f (x0 )|
â‰¤
â‰¤L
Î³

Therefore K(f, x0 ) â‰¤ L, and thus

1
K(f,x0 )

bounds the modulus of convexity of f âˆ— , for any x0 .

A.2 Example of a non C 1,1 function with a sphere of support
Example A.2. It may seem that since a bound on K(u, x) implies a sphere of support to the graph of u at
(x, u(x)), that this in turn implies some kind Lipschitz continuity of the gradient in a small neighbourhood
of x. Here we construct an example of a strictly convex function f that is C 1 and twice differentiable with
K(f, 0) < âˆ, but with gradient not Lipschitz in any neighbourhood of 0, to show this is not the case. Let
f : [âˆ’1, 1] â†’ R be given by f (0) = 0, and for x â‰¥ 0
Z x
f 0 (x) =
Î³(t)dt,
where Î³(t) := n + 4 on In and 0 otherwise,
0

with In =

1
1
[1 âˆ’
, 1]. Define f 0 (âˆ’x) := âˆ’f 0 (x).
(n + 4)2
(n + 4)2

Then f 0 is clearly increasing and so f is convex. And for xn =
f 0 (xn ) =

Z

x1

Î³(t) dt =
0

X
kâ‰¥n

1
â‰¤
(k + 4)3

Z

âˆ

n+3

1
,
(n + 4)2

1
1
dt
=
<
= xn .
t3
2(n + 3)2
(n + 4)2

So we have f 0 (x) â‰¤ x for all x âˆˆ [0, 1] and f 0 (x) â‰¥ x for all x âˆˆ [âˆ’1, 0]. Since d0 (x) â‰¥ x for all x âˆˆ [0, 1]
and d0 (x) â‰¤ x for all x âˆˆ [âˆ’1, 0], it follows that the graph of d, and thus the unit circle centered at (0, 1), is
always at or above the graph of f , with f (0) = d(0). Therefore, f has a sphere of support at x0 = 0.
However, there exist sequences {xi }, {xj } such that
f 0 (xi ) âˆ’ f 0 (xj )
xi âˆ’ xj
blows up: Taking xi and xj as the endpoints of In ,
Z xi

Z xj
Z xi
f 0 (xi ) âˆ’ f 0 (xj )
1
=
Î³(t)dt âˆ’
Î³(t)dt = (n + 4)4
n + 4dt = n + 4.
xi âˆ’ xj
xi âˆ’ xj
0
0
xj
We can make f strictly convex by adding an xm term, which does not affect any of the above analysis. The
above example can be adjusted to show that f 0 is not Î±-Holder continuous for any Î±.
19

A.3 Osculating and locally supporting spheres
Here we extend the concept of an osculating circle to a plane curve to that of an â€œosculating sphereâ€to the
graph of a function in higher dimensions. The bound on the â€œlargest eigenvalue â€K(u, x) can be seen as a
generalization of the relationship between the second derivative of a C 2 plane curve u and the radius of its
osculating circle:
Let u : R â†’ R be C 2 . Provided u00 6= 0, the radius of curvature at x is defined as
3

ru,x :=

(1 + u02 ) 2
1
,
=
Îº
u00

where Îº is the curvature of u at x, and the right-hand side is the standard formula for computing the
curvature of a planar curve [2, Â§8]. Thus,
u00 =

(1 + u02 )3/2
.
r

Definition A.3. The osculating circle, or circle of curvature, to a planar curve C at p is the circle that
touches C (on the concave side) at p and whose radius is the radius of curvature of C at p.
We extend this to the graphs of C 2 convex functions in higher dimensions by
Definition A.4. For a convex function u : Rn â†’ R let the osculating sphere to the graph of u at x be the
1
.
nâˆ’sphere tangent to the graph of u at x the with radius equal to that of Î»max
It is easy to show that any tangent sphere at (x, u(x)) with radius less than the osculating sphere at that
point is a (local) sphere of support. And any tangent sphere at (x, u(x)) with radius greater than the
osculating sphere cannot be a (local) sphere of support.
A.4 Spheres of support to a function and its dual
Given a convex function u with a sphere of support at (x0 , u(x0 )), the conjugate function uâˆ— will not
necessarily have a sphere of support at the corresponding point (âˆ‡u(x0 ), uâˆ— (âˆ‡u(x0 )). For example take
4
u = 41 |x|4 and uâˆ— = 34 |x| 3 . However, for more regular and sufficiently convex functions (e.g. C 2 and locally
strongly convex), we will have a sphere of support (locally) to both graphs at corresponding points, and the
order-reversing property of L provide a simple inequality relating the radii of these spheres. We state this
without proof.
Proposition A.5. Let u : Rn â†’ R be strongly convex and C 2 near x0 , and suppose u has a sphere of
support of radius rx0 . If ry0 is the radius of a sphere of support to uâˆ— at y0 = âˆ‡u(x0 ), then
ry0 â‰¤

1 + |x|2

 23

1 + |âˆ‡u(x0 )|2
rx0

 23
.

Acknowledgements
I am very grateful to Y.A. Rubinstein for introducing me to the work of Slodkowski, Harvey and Lawson,
and for his ongoing guidance and encouragement. I thank T. Darvas and R. Hunter for helpful comments
and discussions. I would also like to thank Z. Slodkowski for an insightful correspondence, and a referee for
their careful review and stellar suggestions.
References
[1]A.D. Alexandrov, Almost everywhere existence of the second differential of a convex function and properties of
convex surfaces connected with it (in Russian), Lenningrad State Univ. Ann. Math. 37 (1939), 3-35.
[2] Y. Animov, Differential Geometry and Topology of Curves, CRC Press, 2001.

20

[3] J. Foran, Fundamentals of Real Analysis, CRC Press, 1991.
[4] F.R. Harvey, H.B. Lawson, Jr., Dirichlet duality and the non-linear Dirichlet problem, Comm. on Pure and
Applied Math. 62 (2009), 396-443.
[5] F.R. Harvey, H.B. Lawson, Jr., Notes on the differentiation of Quasi-Convex Functions, 2014.
[6] J.-B. Hiriart-Urruty, C. LemaraÌchal, Convex Analysis and Minimization Algorithms, Vol.I and II, Springer, 1993.
[7] R.T. Rockafellar, Convex Analysis, Princeton University Press, 1970.
[8] C.A. Rogers, Hausdorff measures, Cambridge University Press,1970.
[9] Z. Slodkowski, The Bremermann-Dirichlet Problem for qâˆ’Plurisubharmonic Functions, Analli della Scuola Normale
Superiore di Pisa, Classe di Scienze, 4e seÌrie, tome 11, no. 2 (1984), p. 303-326.

University of Maryland
mdellato@math.umd.edu

21

