The largest eigenvalue of a convex function, duality, and a theorem
of Slodkowski
Matthew Dellatorre

Abstract
First, we provide an exposition of a theorem due to Slodkowski regarding the largest “eigenvalue” of a
convex function. In his work on the Dirichlet problem, Slodkowski introduces a generalized second-order
derivative which for C 2 functions corresponds to the largest eigenvalue of the Hessian. The theorem
allows one to extend an a.e lower bound on this largest “eigenvalue” to a bound holding everywhere.
Via the Dirichlet duality theory of Harvey and Lawson, this result has been key to recent progress on
the fully non-linear, elliptic Dirchlet problem. Second, using the Legendre-Fenchel transform we derive
a dual interpretation of this largest eigenvalue in terms of convexity of the conjugate function. This dual
characterization offers more insight into the nature of this largest eigenvalue and allows for an alternative
proof of a bound needed for the theorem.

Contents
1. Introduction
1.1 Motivation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.2 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.4 Organization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2. Exposition of Slodkowski’s proof
2.1 Overview . . . . . . . . . . . . .
2.2. The generalized C 1,1 estimate .
2.3 The density lemma . . . . . . . .
2.4 Proof of Theorem 1.3 . . . . . .

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

2
2
3
5
5
5
6
8
12

3. Dual Perspective
15
3.1 Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
3.2 Quadratic convexity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
Appendix
A.1 Lipschitz gradient . . . . . . . . . . . . . . . . . . . . . .
A.2 Example of a non C 1,1 function with a sphere of support
A.3 Osculating and locally supporting spheres . . . . . . . .
A.4 Spheres of support to a function and its dual . . . . . . .

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

18
18
19
20
20

Acknowledgements

20

References

20

1

1. Introduction
1.1 Motivation
It is known that a convex function u on Rn is differentiable almost everywhere and has distributional secondorder partial derivatives. It is also known that a convex function is twice differentiable almost everywhere
in the sense that for a.e. x ∈ Rn , there exists a symmetric positive semi-definite matrix D2 f (x) such that
1
f (x + h) = f (x) + h∇f (x), hi + hD2 f (x)h, hi + o(||h||2 ).
2
The operator D2 f is called the second-order Peano derivative. Note that its existence does not imply the
existence of ∇f in a neighbourhood, so it should not be considered the second derivative of f in the usual
sense. This result is due to Alexandrov [1]. See also [5], [6].
In [9], Slodkowski studies uniqueness for a generalized Dirichlet problem in the class of q−plurisubharmonic
(q–psh) functions (for C 2 functions on Cn this is equivalent to the complex Hessian having n − q nonnegative
eigenvalues at every point). The problem of uniqueness reduces to showing that the difference of two such
functions is n − 1–psh, which implies that it satisfies a maximum principle, from which uniqueness then
follows. Functions of this q–psh class can be approximated by a subclass which are convex up to a quadratic
polynomial. Because of this it is sufficient to study this smaller class, which given their quasi-convexity,
retain some of the nice properties of convex functions. In particular, quasi-convex functions are a.e. twice
differentiable, in the above sense. Thus, the second-order behavior of these functions and their difference
is known a.e. However, to show that the difference is a member of the above mentioned class, they must
satisfy this eigenvalue property everywhere. To this end, Slodkowski introduces a generalized second-order
derivative, which is simply the largest eigenvalue of the Hessian for C 2 functions, and proves that if this
quantity is bounded below almost everywhere in some domain, it is bounded below everywhere in that
domain. Using this, he shows that the difference is contained in the desired n − 1–psh class.
Following Slodkowski [9, §3 ], we define the largest “eigenvalue” of a convex function.
Definition 1.1. Let u : Rn → R. If ∇u(x0 ) exists, K(u, x0 ) is defined by the formula
K(u, x0 ) = lim sup 2−2 max {u(x0 + h) − u(x0 ) − h∇u(x0 ), hi : h ∈ S n−1 }
→0

otherwise K(u, x) is defined as +∞.
This is the generalized second-order derivative that Slodkowski defines. For the sake of context, note
that this quantity is a modification to the second-order upper Peano derivative of u in the direction of h,
which is defined as
lim sup 2−2 (u(x0 + h) − u(x0 ) − h∇u(x0 ), hi).
→0+

Being maximal, this second-order derivative is of particular interest because it corresponds to the largest
eigenvalue of the Hessian when defined (which it does, in the above sense, almost everywhere for convex
functions), and gives a useful quantity to work with otherwise, especially in the context of Slodkowski’s C 1,1
estimates.
Regarding this quantity K(u, x), Slodkowski shows the following.
Theorem 1.2. ([9, Cor. 3.5]) Let u : Rn → R be a locally convex function in U ⊂ Rn , such that K(u, x) ≥
M for almost every x ∈ U . Then K(u, x) ≥ M for all x ∈ U .
As mentioned above, the recent work of Harvey and Lawson on the Dirichlet problem was one of our
motivations for studying this quantity K(u, x) and Slodkowski’s proof of the above result. In [4] they study
fully non-linear degenerate elliptic equations of the form
F (Hess(u)) = 0 on Ω

(1)

u = φ on ∂Ω.

(2)

2

Given certain convexity assumptions on the boundary, they establish the existence and uniqueness of
continuous solutions using their new Dirichlet duality theory. The work of Slodkowski was “an inspiration”
for that paper, and in particular Theorem 1.2 is the “deepest ingredient” of their proof of uniqueness of
viscosity solutions of (1) [4, p. 398]. These existence and uniqueness results apply to many important
problems including all branches of the homogeneous Monge-Ampère equation, all branches of the special
Lagrangian potential equation, and equations appearing naturally in Lagrangian and calibrated geometry.
Given the usefulness of this generalized derivative and the above result to recent progress on important
problems, it makes sense to better understand both the derivative and the proof of the theorem. The proof
is fairly difficult and very geometric so here an illustrated exposition is provided. The quantity K(u, x)
is then studied further for convex u. In particular, the Legendre–Fenchel transform is applied to give a
simple alternative characterization of K(u, x) in terms of the convexity of the dual function u∗ to u. This
allows for an alternative proof to a key proposition needed to prove Slodkowski’s theorem. Altogether, there
are now three ways to view this generalized derivative K(u, x): analytically (Definition 1.1), geometrically
(Proposition 1.6), and dually (Theorem 1.9).
1.2 Summary
Theorem 1.2 follows immediately from the following theorem, the proof of which is the main focus of the
first part of this paper.
Theorem 1.3. ([9, Thm. 3.2]) Let u be convex near x0 ∈ Rn . Assume that K(u, x0 ) = k0 is finite. Then
n
0
.
for every k > k0 the set {x : K(u, x) < k} is Borel and its lower density at x0 is not less than k−k
2k
Lower density is defined as follows.
Definition 1.4. The lower density of a Lebesgue measurable set Z ⊂ Rn at x0 ∈ Rn is the number

mn Z ∩ B(x0 , ε)
 ,
lim inf
ε→0
mn B(x0 , ε)
where mn denotes the n-dimensional Lebesgue measure.
Slodkowski’s proof of Theorem 1.3 divides naturally into two parts. First, an equivalent geometric
characterization of a bound on K(u, x) is given in terms of spheres tangent to the graph of u. This is the
content of the following definition and proposition.
For c = (c1 , . . . , cn+1 ) ∈ Rn , let S(c, r) denote the n−sphere with center c and radius r, and B(c, r)
denote the open n + 1-disk of radius r centered at c.
Definition 1.5. The sphere S(c, r) is a sphere of support from above at y = (x0 , u(x0 )) if y ∈ S(c, r),
B(c, r) ∩ graph(u) = ∅ and cn+1 > u(P (c)), where P denotes the orthogonal projection of Rn+1 onto Rn .
Thus, S(c, r) can be visualized as a ball resting on a “surface” that is the graph of u, and such that
(x0 , u(x0 )) is one of its resting points.
Proposition 1.6. ([9, Prop. 3.3]) Let U ⊂ Rn be open and u : U → R be convex. Assume that u has
gradient at x.
(i) If u has second-order Peano derivatives at x, then K(u, x) is equal to the norm (i.e. the largest
eigenvalue) of the real Hessian of u at x.
(ii) If K(u, x) is finite, then for every K > K(u, x) there is ε > 0 such that u(x+h)−u(x)−h∇u(x), hi ≤
1
K|h|2 .
2
(iii) If there is a sphere S(c, r), r > 0 which supports the graph of u from the above at (x, u(x)), then
3

K(u, x) ≤

(1 + |∇u(x)|2 ) 2
.
r
3

(3)

Parts (ii) and (iii) give the above mentioned equivalence between a bound on K(u, x) and a sphere of support
to the graph of a corresponding radius at (x, u(x)). See section 2.2 for a more detailed explanation.
The second part of the proof then uses this alternative characterization of K(u, x) to obtain a density
result, which is essentially the statement of the theorem in terms of spheres of support as opposed to K(u, x).
This is the content of the following lemma.
Lemma 1.7. ([9, Lemma 3.4]) Let u be a non-negative convex function in B(0, d) ⊂ Rn , d > 0, such that
u(0) = 0 and ∇u(0) = 0. Let R > 0 and assume that the closed ball B̄(c, R), c = (0, ..., 0, R) ∈ Rn+1 ,
intersects the graph of u only at 0 ∈ Rn+1 . Let Xr , 0 < r < R denote the set of all x ∈ B(0, d) ⊂ Rn
such that there exists a sphere of radius r supporting the graph of u from above at (x, u(x)). Then the lower
density of Xr at 0 is not less than ((R − r)/2R)n .
As will be seen in more detail in section 2, there is an inverse relationship between the bound on K(u, x) and
the radius of the sphere of support to the graph of u at (x, u(x)). This will explain the similarity between
the lower bound on density given in the lemma and the one in the theorem.
The geometric characterization of K(u, x) is key to proving Theorem 1.3 and helpful in understanding
what quality this generalized derivative captures about the function u and its graph. Since the results here
concern functions that are at least locally convex, it is natural to study them via the Legendre–Fenchel
transform, the classical transform of convex analysis. By definition, the set of points above the graph of
a convex function (epigraph) is a convex set. Any convex set in Rn can be defined entirely by a family
of supporting hyperplanes. Thus, since the epigraph of u completely determines the graph of u, which in
turn completely determines u, this family of hyperplanes can be considered an alternative description or
parametrization of u. This is essentially how the transform of u (or dual function to u) u∗ is defined. Each
point p ∈ Rn defines a collection of hyperplanes (via gradient), and u∗ specifies a point u∗ (p) ∈ R, such that
(0, ..., 0, −u∗ (p)) ∈ Rn lies on the one hyperplane of this collection which supports the epigraph (or graph)
of u.
Interestingly, under the Legendre–Fenchel transform, differentiability properties of u correspond to convexity
properties of u∗ . Two classic examples of this are the following.
Proposition 1.8. Let f : Rn → R. Then
(i) f is strictly convex if and only if f ∗ is differentiable.
(ii) f is strongly convex with modulus c if and only if f ∗ is differentiable and ∇f ∗ is Lipschitz continuous
with constant 1c .
Given that K(u, x) is a (local) differentiability property of u, it seems there should be an appropriate (local)
convexity property corresponding to u∗ . In section 3 we prove the following result.
Theorem 1.9. Let f : Rn → R be convex. If K(f, x0 ) = k0 < k then f ∗ is quadratically convex at y0 =
∇f (x0 ) with modulus k1 . Conversely, if u∗ is quadratically convex with modulus k1 , then K(f, x0 ) = k0 ≤ k.
Quadratically convex at y0 , which is defined in section 3, is a more local form of convexity than the two types
of convexity referred to in Proposition 1.8. This dual characterization of K(u, x) allows for an alternative
proof of Proposition 1.6. Using quadratics to define different types of convexity is standard (e.g. quasiconvexity, strong convexity). See section 3 for definitions of all these terms and a more detailed discussion.
In Slodkowski’s proof quadratics arise naturally via the definition of K(u, x), and from this, spheres. The
geometric properties of spheres make certain arguments very clear (see proof of Lemma 1.7), however some
manipulations and calculations are simpler with quadratics, given their constant second-order behavior. For
example, in [5] Harvey and Lawson provide an alternative proof of Slodkoski’s lemma (as well as Alexandrov’s
theorem stated above) via a generalization by using quadratics instead of spheres. Their proof is modelled
off of Slodkowski’s, and they obtain their result for the larger class of quasi-convex functions. Instead of
spheres of support, they use the notion of upper contact jets, where given p ∈ Rn , and A a real symmetric
n × n matrix, (p, A) is an upper contact jet for u at x if there exists a neighbourhood of x such that
1
u(y) ≤ u(x) + hp, y − xi + hA(y − x), y − xi.
2
Slodkowski’s result then corresponds to A = λI.
4

1.4 Organization
Section 2 contains the exposition of Slodkowski’s proof of Theorem 1.3: §2.1 gives an overview of the proof,
§2.2 a slight variation of Slodkowski’s proof to Proposition 1.6 (the generalized C 1,1 estimate), §2.3 an
expanded and illustrated version of Slodkowski’s proof to Lemma 1.7, and §2.4 combines these for the proof
of the theorem.
Section 3 studies K(u, x) from the dual perspective: §3.1 recalls some basic convex analysis, including
Legendre–Fenchel duality, §3.2 provides an equivalent interpretation of K(u, x) in terms of the dual function
to u, and uses this for an alternative proof of the C 1,1 estimate.
The Appendix considers Lipschitz continuity of the gradient and the geometric interpretation of K(u, x):
§A.1 demonstrates K(u, x) is bounded by the Lipschitz constant when u is C 1,1 , §A.2 gives an example of
a function with a sphere of support that is not C 1,1 on any neighbourhood, §A.3 compares K(u, x) to the
classical notion of an osculating circle to a plane curve and gives an extension of this to higher dimensions,
§A.4 relates the radius of a sphere of support to a function to that of the radius of a supporting sphere to
its dual.

2. Exposition of Slodkowski’s proof
2.1 Overview
Theorem 1.3 is concerned with the set of points (near x0 ) such that K(u, x) < k, for some fixed k > k0 =
K(u, x0 ). However this set may be difficult to study directly given that the only information available about
u is that it is continuous (bounded and convex) on some neighbourhood of x0 and K(u, x0 ) = k0 < ∞.
In particular, knowing the value of K(u, x) at a given point does not immediately suggest anything about
its value nearby. Thus, the first step towards a better understanding of this set of points is an alternative
characterization of what it means for K(u, x) to bounded at some point.
If at the point x, K(u, x0 ) < ∞ this is equivalent to a (local) sphere of support from above to the graph
of u at (x, u(x)). This is precisely what Proposition 1.6 (ii) and (iii) states. (ii) implies the existence (locally)
of a quadratic function tangent to the graph of u at (x, u(x)) which majorizes u on some neighbourhood, and
this in turn implies the (local) existence of a sphere of support to the graph of u at (x, u(x)). The content
of (iii) is clear.
With this alternative geometric characterization in hand, Lemma 1.7 then proves the theorem in terms
of these spheres of support. To accomplish this another change in perspective is needed, which takes further
advantage of this more geometric interpretation of K(u, x). Instead of looking at points x in the domain of
u such that there exists a sphere of support to the graph of u at (x, u(x)), it is better to consider for each
point x in domain of u an n−sphere (of fixed radius) in Rn+1 above the graph of u with center c ∈ Rn+1
such that P (c) = x, where P : Rn+1 → Rn is the projection map. If we lower this sphere down towards x
it will of course eventually intersect the graph of u. Since u is continuous, it is not difficult to show that
on a small enough neighbourhood these spheres will come down on a closed part of the graph of u and thus
there will be an initial point of contact. This sphere is by definition a sphere of support to the graph of u
at that point. The next step is to show that for every  neighbourhood of 0 (x0 = 0 for Lemma 1.7) there
is a corresponding δ = δ() such that the spheres above the points in B(0, δ) are spheres of support to the
graph at points (x, u(x)), where x ∈ B(0, ). Now B(0, δ) is a much nicer set to work with then Xr ∩ B(0, ),
and these two sets can be related by a few simple Lipschitz maps. Since Lipschitz maps behave nicely with
respect to measures, this allows us to place a lower bound on the measure m(Xr ∩ B(0, )) for each epsilon.
A limiting argument is then used to obtain the lower bound on the lower density at 0.
Proposition 1.6 and Lemma 1.7 can then be combined to give Theorem 1.3. A sketch of the proof is
as follows. Start with a point x0 where K(u, x0 ) is finite (hypothesis of Theorem 1.3), and choose any
k > K(u, x0 ). Note it can be assumed without loss of generality that x0 = 0, u(0) = 0, and ∇u(0) = 0 (see
section 2.3 for details). Then apply Proposition 1.6 (ii), which locally gives a sphere of support of radius
1/k at (x0 , u(x0 )). Now, apply Lemma 1.7 to get a lower bound on the density of Xr , r < 1/k, at x0 . Next,
apply Proposition 1.6 (iii) to convert this into a statement about the density of Xk0 , where
Xk0 ≡ {x ∈ dom(u)|K(u, x) < k}.

5

This last step is accomplished by using the continuity of the gradient to show that in a small enough
neighbourhood Xr ⊂ Xk0 . More explicitly, x ∈ Xr implies K(u, x) ≤ r−1 (1 + |∇u(x)|2 )3/2 and ∇u(x0 ) = 0,
so by continuity of the gradient of convex functions and since k > 1/r, ∇u(x) will eventually be small enough
so that r−1 (1 + |∇u(x)|2 )3/2 < k. Thus, for x ∈ Xr , K(u, x) < 1/k. This gives the theorem by choosing R
arbitrarily close to 1/k0 and r arbitrarily close to 1/k (see section 2.4 for a detailed proof).
2.2. The generalized C 1,1 estimate
Rn

u
t

r

d

x x+h

c

R

Figure 1: d : B(c, r) → R
In this subsection we provide an alternative proof to Proposition 1.6 (iii). The main idea is as follows: given
a sphere of support of radius r to the graph of u at the point (x, u(x)), the lower hemisphere of this sphere
defines the graph of a smooth convex function that agrees up to first order with u at x and majorizes u
elsewhere. Denote this function by d. It immediately follows that K(u, x) ≤ K(d, x), and the rest of the
proof consists in computing K(d, x), which is equal to the largest eigenvalue of d because d is smooth
Proof of Proposition 1.6 (iii). Assume that the sphere S((c, t), r), c ∈ Rn supports the graph of u from the
above at (x, u(x0 )) and that u is differentiable at x0 . Define d : B(c, r) → R to be the function whose graph
is the lower open hemisphere of S((c, t), r). Recall the definition for K(f, x0 ) :
K(u, x0 ) := lim sup 2−2 max {u(x0 + h) − u(x0 ) − h∇u(x0 ), hi : |h| = 1}.
→0

Clearly, since d(x0 ) = u(x0 ) and ∇d(x0 ) = ∇u(x0 ),
K(u, x0 ) ≤ K(d, x0 ).
Since d is smooth,
K(d, x0 ) = lim sup 2−2 max {d(x0 + h) − d(x0 ) − h∇d(x0 ), hi : |h| = 1}
→0

1
= lim sup 2−2 max { h∇2 d(x0 + γ,h h)h, hi : |h| = 1},
0 < γ,h < 1
2
→0
= lim sup max {h∇2 d(x0 + γ,h h)h, hi : |h| = 1},
0 < γ,h < 1
→0

= max {h∇2 d(x0 )h, hi : |h| = 1} by continuity and compactness.
=λmax ,

maximum eigenvalue of ∇2 d(x0 )

Thus, now we show that
3

λmax

(1 + (∇u(x0 ))2 ) 2
.
=
r

The equation for d, the sphere of radius r centered at (c, t), where c ∈ Rn and t ∈ R, is
p
d(x) = t − r2 − |c − x|2 .
6

Without loss of generality we may assume that the sphere of support is centered at the origin and x0 has
just first component non-zero, as otherwise we could always shift and then rotate without affecting the
second-order behavior.
In other words, assume (c, t) = 0 ∈ Rn+1 and x0 = (s1 , ..., sn ) = (s, 0, ..., 0) ∈ Rn .
p
2
Then d(x) = − r − |x|2 .
Let


1
|x − x0 |2 + 2hx − x0 , x0 i .
w(x) := 2
2
r −s
Since
|x|2 = hx, xi = h(x − x0 ) + x0 , (x − x0 ) + x0 i = |x − x0 |2 + 2hx0 , x − x0 i + |x0 |2
and |x0 |2 = s2 , we can write d(x) as
d(x) = −
Now expanding
Hessian at x0 ),

p

p

r2 − s2

p

1 − w(x).

1 − w(x) as a series and dropping the terms of order higher than two (as they will have 0
p
d(x) ≈ − r2 − s2

w(x) w(x)2
1−
−
2
8

!
.

This can be further reduced to
p
d(x) ≈ − r2 − s2

w(x) 1
1−
−
2
8



2hx − x0 , x0 i
r2 − s2

2 !
,

since we are only concerned with the expression for d, modulo powers higher than two.
Thus, d(x) has been replaced by a diagonal quadratic form and straightforward computations give
∇d(x0 ) = √
and
∇2 d(x0 ) = √

x0
,
r2 − s2

1
s
I+ 2
A,
2
(r
−
s2 )3/2
−s

r2

where I is the n × n identity matrix and A is the n × n matrix with first row x0 = (s, 0, ..., 0) and zeros
elsewhere. Since
s2
3 > 0,
(r2 − s2 ) 2
it follows immediately that
λmax = √

1
s2
r2
=
+ 2
3 .
(r − s2 )3/2
r2 − s2
(r2 − s2 ) 2

Furthermore, the vector (x0 , u(x0 )) is of length r, proportional to the upward pointing unit normal to the
graph of u at (x0 , u(x0 )), which is equal to
1
p

1 + |∇u(x0 )|2

Scaling by r, we obtain
x0 = p

(−∇u(x0 ), 1).

−r
1 + |∇u(x0 )|2

∇u(x0 ).

Giving
r∇u(x0 )
x0 = p
,
1 + |∇u(x0 )|2

s2 = |x0 |2 =

7

r2 |∇u(x20 )
.
1 + |∇u(x0 )|2

Therefore,
3

λmax =

(1 + |∇u(x0 )|2 ) 2
.
r


We state explicitly the following interesting result on “lower hemisphere functions”, i.e. functions on a
disc D ⊂ Rn defined by the lower hemisphere of an n− sphere in Rn+1 . The proof follows immediately from
the above proof, by looking at the expression for the Hessian.
Proposition 2.1. Let d : D → R be a lower hemisphere function defined on a disc D ⊂ Rn and x̃ ∈ D. If
∇d(x̃) 6= 0, then ∇d(x̃) 6= 0 is an eigenvector of ∇2 d(x̃) corresponding to the largest eigenvalue.
Proof. Without loss of generality we may assume that the lower hemisphere and thus D are centered at the
origin and x̃ has only first coordinate non-zero, x̃ = (s, 0, ..., 0). Then, as shown above, the Hessian of d at
x̃ is a diagonal n × n matrix of the form
!
s2
1
1
1
2
+
, ..., √
.
∇ d(x̃) = diag √
3 , √
r2 − s2
r2 − s2
r2 − s2
(r2 − s2 ) 2
Thus, (1, 0, ..., 0) is an eigenvector corresponding to the largest eigenvalue. As calculated above,
∇d(x̃) = √

x̃
s
=√
(1, 0, ..., 0),
2
2
−s
r − s2

r2

so clearly ∇d(x̃) is also an eigenvector corresponding to the largest eigenvalue.

2.3 The density lemma
If at the point x0 = 0 there is a sphere of support of radius R, Lemma 1.7 provides a lower bound on the
lower density of the set Xr of points with sphere of support of a radius r < R. Note that without loss of
generality it may be assumed that x0 = 0, u(0) = 0, and ∇u(0) = 0, since any convex function ũ can always
be adjusted by a constant and linear term so that this is true without affecting the 2nd-order behaviour of
ũ.
As mentioned in section 2.1, Lemma 1.7 is proved by looking not directly at Xr but at small neighbourhoods
of 0 that are the projection of the set of centers of spheres of support to the graph of u on shrinking
neighbourhoods. For each  > 0 a δ = δ() is needed so that B(0, δ) is contained in the projection onto Rn
of the set of centers of spheres of support to the graph of u restricted to an epsilon neighbourhood. Since the
only information about u is that there is a sphere of support at 0, this is what is used to construct  and δ.
More specifically, the appropriate ’s and δ’s are found by constructing a family of convex functions that are
identical to u on a neighbourhood of 0, but greater and simpler outside this neighbourhood. This allows one
to fully utilize the only initial information given. Using this family of simple functions and basic geometry,
three key set inclusions are obtained, which essentially relate B(0, δ()) to Xr ∩ B(0, ). Then using Lipschitz
maps to relate these sets and by applying properties of Lipschitz functions on measure, the lower density
bound is shown. This whole construction is crucial because it provides a much simpler approach to studying
the possibly very complex set Xr . The following is the proof given by Slodkowski.
Proof. of Lemma 1.7.
The number r ∈ (0, R) will be kept fixed so let X ≡ Xr . Define
Z = {(x, u(x)) ∈ Rn+1 : x ∈ X}.
It is clear that Z ∩ (B̄(0, d0 ) × R) is compact for every d0 < d, thus X ∩ (B̄(0, d0 ) × R) is also compact, as it
is the orthogonal projection P : Rn+1 → Rn of Z. Since compact sets are Lebesgue measurable, the notion
of lower density is applicable to both X and Z.
It is more convenient to first estimate the density of Z at 0 with respect to Hausdorff measure, and then
use the properties of Lipschitz functions on measure to obtain bounds on the density of X. To accomplish
8

this a family of convex functions, built from the initial sphere of support of radius R at 0, which modify u
outside a small neighbourhood of 0 will be constructed. As mentioned above, these functions will be identical
to u on a neighbourhood of 0 and very simple outside this neighbourhood. These functions will enable us
to find a corresponding δ = δ() neighbourhood for each  so that x ∈ B(0, δ) implies that x = P (c), where
c ∈ Rn is the center of a sphere of support to (x0 , u(x0 )), for some x0 ∈ B(0, ) ∩ Xr .
Step One. A family of convex functions is constructed which will let us find an appropriate δ(), as explained
d
), define the function
above. For each α such that 0 < α < 21 arcsin( R
vα : B(0, R) → [0, ∞),
as follows. First, define
Y = {y ∈ Rn+1 : |y − c| = R, (y − c, 0 − c) = 2α},

(4)

where c = (0, ..., 0, R) ∈ Rn+1 is the center of the sphere of support to u at (0, u(0)). Y forms a “ring ”on
R

R
Tα

c
2α

Tα

2α

Y

Y

u
−R sin 2α

R sin 2α

Cα

Rn

Cα

w

Figure 2: Construction of Auxiliary Convex Functions
S(c, R), and clearly the projection of Y , P (Y ), onto Rn is the n − 1 sphere of radius R sin 2α, centered at 0.
Next, let Cα denote the union of all closed segments wy with one endpoint w on the axis 0 × R ⊂ Rn+1 and
tangent to the sphere S(c, R) at the other endpoint y, where y ∈ Y . Note that w is independent of which
y ∈ Y that is being used. Cα is simply a finite cone with vertex w and base Y , tangent to S(c, R) along Y .
See Figure 2.
Define now
Tα = {y ∈ S(c, R) : R(1 − cos 2α) ≤ yn+1 < R}.

(5)

Tα can be visualized as a “strip” of S(c, r), and note that Tα ∩ Cα = Y and that Tα ∪ Cα defines a convex
function kα : B(0, R) → R.
d
), define
For 0 < α < 21 arcsin( R
(
max(u(x), kα (x)),
|x| < R sin 2α
vα =
kα (x),
R sin 2α ≤ |x| < R.
Note that u is only defined on B(0, d) and R sin 2α < d < R, so that is why vα is defined this way. It is clear
that
vα (x) ≥ u(x), for |x| < d.
9

(6)

Observe that vα is locally convex on the set |x| =
6 R sin 2α since for |x| > R sin 2α, vα = kα (x), which is
convex, and for |x| < R sin 2α, vα is the maximum of two convex functions which is convex. If |x| = R sin 2α,
then (x, vα (x)) ∈ Y ⊂ S(c, r) Since S(c, r) lies above the graph of u, so kα |Y > u|Y . Thus near Y, vα ≡ kα ,
and so vα is locally convex in B(0, R), which implies that vα is convex.
Step Two. For any convex function the following Lipschitz map can be constructed. This will let us
relate the possibly complex set, X, to the disk B(0, δ()). Given a convex function v : B(0, R) → R. Let
E(v) = {(x, t) ∈ Rn+1 : t > v(x)} denote the strict epigraph of v, and define Z v as the set of all y = (x, v(x)),
where |x| < R, and such that for some c0 ∈ Rn+1 , B(c0 , r) ⊂ E(v) and y ∈ S(c0 , r), where r < R, as defined
earlier.
Note that if y = (x, v(x)) ∈ Z v , then the graph(v) has a unique supporting hyperplane at y (since any
such hyperplane is tangent to S(c0 , r)), and thus c0 is uniquely determined by y.
Now consider the map γ v : Z v → Rn+1 , where γ v (y) = c0 . This map is Lipschitz with constant one. To
see this, let y1 , y2 ∈ Z v and c0i = γ v (yi ), i = 1, 2. The set E(v) is convex (by definition since v is convex),
and so it contains W := co(B(c1 , r) ∪ B(c1 , r)), where co() denotes the convex hull. In particular, W ∩
graph(v)=∅. Since yi ∈ S(ci , r) ∩ graph(v), yi ∈ S(c0i , r) \ W, i = 1, 2. Thus, y1 and y2 do not belong to, and
are separated by, the open region between two hyperplanes which are orthogonal to the segment c01 c02 and
pass through its ends. Therefore |c01 − c02 | ≤ |y1 − y2 |. The importance of this map will be seen below, where
combined with u and the projection map P it allows the set of interest in Rn to be related to a small disk.
Step Three. Three key set inclusions are established. Along with step two this will allow on small
neighborhoods the measure of X to be bounded from below by the volume of small n− balls. Using
the notation above, let Z α and γ α denote the set Z v and map γ v , respectively, for v = vα , where
d
0 < α < 12 arcsin( R
).
Consider the set
Uα = graph(vα ) \ (Cα ∪ Tα ).

(7)

d
Note that this is a subset of the graph of u. For α ∈ (0, 21 arcsin( R
)), we have the following three inclusions:

P (Uα ) ⊂ B(0, R sin 2α)

(8)

Z α ∩ Uα ⊂ Z ∩ Uα

(9)

α

α

BN (0, δ) ⊂ P γ (Z ∩ Uα ), where δ = (R − r) tan α.

(10)

The first inclusion follows directly from the definition of Uα : |x| ≥ R sin 2α ⇒ vα (x) ∈ Tα .
By (5), Z α ∩ graph(u) ⊂ Z. To see this, let z ∈ Z α . Thus we have a c0 ∈ Rn+1 such that B(c0 , r) ⊂ E(vα )
and z ∈ S(c0 , r). So there is a sphere of radius r supporting the graph of vα from above at z. If z ∈ graph(u),
then we must have z ∈ Z: B(c0 , r) ⊂ E(vα ) and vα (x) ≥ u(x) give us that B(c0 , r) ∩ graph(u) = ∅ and
c0n+1 > u(P c0 ), which together with z ∈ S(c0 , r) imply that z ∈ Z, by definition. Since Uα ⊂ graph(u), Z α ∩
Uα ⊂ Z α ∩ graph(u) ⊂ Z. And of course Z α ∩ Uα ⊂ Uα , so together we have Z α ∩ Uα ⊂ Z ∩ Uα , which gives
us the second inclusion.
The third inclusion is the critical aforementioned relation between the set of points with spheres of
support and a disk in Rn . (Below we will take  = R sin α and δ = (R − r) tan α). To obtain this inclusion
we proceed as follows. Let x ∈ Rn , be such that |x| < R − r, and consider the set
{c0 ∈ {x} × R : B(c0 , r) ⊂ E(vα )}.

(11)

This set is a non-empty, closed half-line. To see this, consider lowering the sphere S((x, c0n+1 ), r) in Rn+1
onto the graph of vα , by continuously decreasing the last coordinate. Because the radius of this sphere is r
and |x| < R −r, this sphere comes down on a closed subset of the graph of vα . Once contact is made with the
graph of vα we stop, and the corresponding value of (x, c0n+1 ) is our closed endpoint. Let c0 ∈ Rn+1 be this
endpoint and y ∈ S(c0 , r) ∩ graph(vα ) (note that y may not be unique). Then c0 = γ α (y) and x = P γ α (y),
and so
BN (0, R − r) ⊂ P γ α (Z α ).

10

(12)

u
∗

c
2α

2α

α
c

cN +1

−R sin 2α

R sin 2α

Cα

Cα

w

Figure 3: Closest Supporting Spheres to Origin

Now Z α \ (Cα ∪ Tα ) ⊂ graph(vα ) \ (Cα ∪ Tα ) = Uα , so clearly Z α \ (Cα ∪ Tα ) ⊂ Z α ∩ Uα . Therefore,
P γ α (Z α ) \ P γ α (Z α ∩ (Cα ∪ Tα )) ⊂ P γ α (Z α ∩ Uα ).

(13)

This relation and (12) will give us our third inclusion (9), once we show that
P γ α (Z α ∩ (Cα ∪ Tα )) ∩ BN (0, δ) = ∅.

(14)

Consider the family of all spheres S(c0 , r) which support Cα \Y from above and are contained in the upper
half space yn+1 ≥ 0. Clearly the smallest value of |P (c0 )| is attained when the sphere S(c0 , r) is tangent to
both Cα and {yn+1 = 0} (see Fig. 3). It is not difficult to see that in this case (c0 −c, 0−c) = α, where c here
is the center of the initial sphere of support. This gives us |P (c0 )| = (|c| − c0N +1 ) tan α = (R − r) tan α = δ,
which implies
P γ α (Z α ∩ Cα ) ∩ BN (0, δ) = ∅.

(15)

Now when S(c0 , r) supports Tα \ Y from the above at some point y, the segment c0 , y is normal to S(c, R)
and yN +1 ≥ R(1 − cos 2α) ≥ δ. Thus (c0 − c, 0 − c) ≥ 2α and, as above, |P (c)| ≥ (R − r) tan 2α ≥ δ (note
0 ≤ α ≤ π4 ). This gives
P γ α (Z α ∩ Tα ) ∩ BN (0, δ) = ∅.

(16)

Combining (15) and (16) we have (13), which gives the third inclusion.
Step Four. Estimate of the density of X. The above inclusions and the effect of Lipschitz maps on measure,
will be enough to estimate the density of X = P (Z). Recall that Z = {(x, u(x)) ∈ RN +1 |x ∈ X}, where X
is the set of points in B(0, d) ⊂ RN such that there exists a sphere of radius r supporting the graph of u
from above at (x, u(x)).
Using a few theorems from Rockafellar [7], it can be shown that the map ϕ : P (Uα ) → Uα , where
1
ϕ(x) = (x, u(x)) is Lipschitz with constant (1 + gα2 ) 2 , where gα = sup{|∇u| : |x| < R sin 2α}. More
specifically, by Theorem 10.4, u is Lipschitz, and by Theorems 24.7, 25.5, and 25.6 gα is a Lipschitz bound
1
for u|B(0,R sin 2α) ). A simple Pythagorean argument then shows (1 + gα2 ) 2 is a Lipschitz bound for ϕ. Notice
that ϕ maps X ∩ P (Uα ) = P (Z ∩ Uα ) onto Z ∩ Uα .
11

A basic theorem regarding the effect of Lipschitz maps on Hausdorff measures (Theorem 2.29 in Rogers
[8]), along with our first inclusion from above (7), leads to:
n

H n (Z ∩ Uα ) ≤(1 + gα2 ) 2 mn (X ∩ P (Uα ))
n

≤(1 + gα2 ) 2 mn (X ∩ B(0, ε)),

ε = R sin 2α,

where again H n and mn denote the Hausdorff and Lebesgue measure on Rn , respectively. Furthermore
mn (B(0, δ)) ≤mn (P γ α (Z α ∩ Uα ))

by (9)

≤H n (Z α ∩ Uα )

P γ α is Lipschitz with constant ≤ 1

≤H n (Z ∩ Uα )

by (8).

Finally, combining these inequalities one obtains
−n mn (B(0, δ))
mn (X ∩ B(0, ε))
≥ (1 + gα2 ) 2
mn (B(0, ε))
mn (B(0, ε))

n
−n
(R − r) tan α
= (1 + gα2 ) 2
R sin 2α
n

−n
R−r
= (1 + gα2 ) 2
cos−2n α,
2R
n

where the volume of an n-ball of radius r is
Thus,

π 2 rn
in the first equality, and Γ denotes the gamma function.
Γ( n2 + 1)

−n
mn (X ∩ B(0, ε))
≥ lim inf (1 + gα2 ) 2
lim inf
ε→0
ε→0
mn (B(0, ε))



R−r
2R

n

cos−2n α.

Now since ε = R sin 2α and 0 < α < π4 , as ε → 0, α → 0. And as the gradient of a convex function is
continuous (Theorem 25.5, [1]), gα → 0 as well since ∇u(0) = 0. Therefore the lower density of X at 0 is

N
R−r
not less than
.
2R
2.4 Proof of Theorem 1.3
Lemma 1.7 and Proposition 1.6 now combine nicely to give us Theorem 1.3.
Proof of Theorem 1.3. First, we prove the density result. Without loss of generality, let x0 = 0, u(x0 ) =
0, ∇u(x0 ) = 0. Note that by the convexity of u this implies u ≥ 0. Set k0 = K(u, x0 ) = K(u, 0), and let
k > k0 be fixed and take K such that k > K > k0 .
1
K 2
1
1
and note that R − (R2 − |x|) 2 ≥
|x|2 =
|x| , ∀x such that |x| < R. This follows
Set R =
K
2R
2
immediately by contradiction. The left-hand side of this inequality is the last component of the point
(x, t) ∈ Rn , where x ∈ Rn , on the (n + 1)-dimensional sphere of radius R centered (0, ..., 0, R) ∈ Rn+1 (i.e
the value of d(x), where d is the lower hemisphere function defined in the proof of the proposition, see Fig.
1).
Since K > K(u, 0), by Proposition 1.6 (ii) there exists d > 0 such that
u(0 + h) − u(0) − h∇u(0), hi ≤

1
K|h|2 for every |h| < d.
2

So
u(h) ≤

1
K|h|2 for every |h| < d.
2

12

R

R

1
R2 − |x|2 2

1
|x|2
2R
x

Rn

Figure 4
Thus the sphere S(c, R), where c = (0, ...0, R) ∈ Rn+1 , supports the graph of u|B(0,d) form above at 0 ∈ Rn+1 ,
and Lemma 1.7 can be applied to the function u|B(0,d) .
Let r, such that k1 < r < R, be arbitrary, and let X = Xr and Z = Zr be defined as in Lemma 1.7. By
Proposition 1.6 (iii), ∀x ∈ X
3

K(u, x) ≤

(1 + g 2 ) 2
,
r

where g = |∇u(x)|.

Set
gε = sup{|∇u(x)| : |x| < ε}.
Then clearly
3

(1 + gε2 ) 2
K(u, x) ≤
r

∀x ∈ X ∩ B(0, ε).

By the continuity of the gradient function, limε→0 gε = |∇u(0)| = 0. Thus since
where 0 < ε0 < d, such that

1
< k, there exists ε0 ,
r

3

(1 + gε2 ) 2
< k,
r

for 0 < ε < ε0 ,

and so
(B(0, ε) ∩ X) ⊂ (B(0, ε) ∩ Xk0 ),

for 0 < ε < ε0 .

If x ∈ X then there exists a supporting sphere of radius r at (x, u(x)), and if x ∈ B(0, ε), where ε < ε0 , then
K(u, x) < k.
It follows by Lemma 1.7 that
lim inf
ε→0

mn (Xk0 ∩ B(0, ε))
mn (X ∩ B(0, ε))
≥ lim inf
ε→0
mn (B(0, ε))
mn (B(0, ε))

n
R−r
≥
.
2R

1
1
1
1
was chosen arbitrarily so that it satisfied the inequality <
< , where k and
K
k
K
k0
1
1
1
k0 are fixed. Similarly, r was chosen arbitrarily so that
<r<
. Thus we can choose R =
and r
k
K
K

Now recall that R =

13

arbitrarily close to

1
1
and , respectively, giving us the desired bound
k0
k



k − k0
2k

n
.

Finally, the fact that Xk0 := {x ∈ dom (u) : K(u, x) < k} is Borel is contained in Proposition 2.2 and
Lemma 2.3 below. Let u : Rn → R convex. Proposition 2.2 shows that the set W on which u is differentiable
is Borel, specifically a Fσδ , and Lemma 2.3 proves that K(x) := K(u, x) is of second Baire class on this set.
Since K(x) = +∞ where ∇u doesn’t exists,
Xk0 = {x ∈ dom (u) : K(x) < k} = {x ∈ W : K|W (x) < k}.
It follows immediately that Xk0 is Borel, as K|W : W → R is a Borel measurable function. Recall that Baire
class 1 functions are the pointwise limit of continuous functions and thus Borel measurable, and Baire class
2 functions are the pointwise limit of Baire class 1 functions and thus also Borel measurable.
Proposition 2.2. Let u : Rn → R be convex. Then the set on which u is differentiable is a dense Borel set,
specifically an Fσδ .
Proof. Since u is convex, u is differentiable at x if and only if all the partial derivatives of u exist at x, with
respect to any basis [6, IV.4.2]. Let {ei }ni=1 be the standard basis in Rn , and define
f 0 (x, ei ) := lim
t↓0

f (x + tei ) − f (x)
.
t

∂f
(x) exists if and only if f 0 (x, ei ) = −f 0 (x, −ei )[6, IV.4.2]. Note that the above limit always exists
Then ∂x
i
for a convex function and f 0 (x, ei ) ≥ −f 0 (x, −ei ) for all x. Take E to be the set where u is not differentiable
∂f
and Ei to be the set of points where ∂x
(x) does not exist. Then E = ∪ni=1 Ei , and
i

Ei = {f 0 (x, ei ) + f 0 (x, −ei ) > 0}.
If x ∈ Ei , then there exists N such that for all n ≥ N ,
f (x +

ei
k)
1
k

− f (x)

+

f (x −

ei
k)
1
k

− f (x)

>

1
,
n

for all k ≥ n. Let
(
En,k =

x:

f (x +

ei
k)
1
k

− f (x)

+

f (x −

ei
k)
1
k

− f (x)

1
>
n

)
,

and note that En,k is open since f is continuous (a real-valued convex function). Thus,
∞
Ei = ∪∞
n=1 ∩k=n En,k ,

which is clearly a Gδσ and so E is also a Gδσ , being a union of finitely many. Therefore, the set Rn \ E on
which u is differentiable is an Fσδ . That Rn \ E is dense is well-known.
Lemma 2.3. Let u : Rn → R be convex and W ⊂ Rn the set on which u is differentiable. Then the function
K(x) := K(u, x) is of second Baire class on W .
Proof. We follow notes of Slodkowski, not contained in [9], for this proof. Let

	
2
f (x, ) = 2 max u(x + h) − h∇u(x), hi : |h| = 1 .

Then K(x) = lim sup>0 f (x, ). Since u is convex, ∇u(x) is continuous on W , and so f (x, ) is a continuous
function on W × (0, ∞).
Next, let


1
g(x, n) = sup f (x, ) : 0 <  <
.
n
Since g(· , n) is the supremum of a family of continuous functions it is lower semicontinuous, and thus the
limit of an increasing sequence of continuous functions on W . Therefore,g(· , n) is of first Baire class.
Now, note that
lim sup f (x, ) = lim g(x, n),
n→∞

>0

and thus K(x) is of second Baire class as it is the limit of Baire class one functions.
14

3. Dual Perspective
3.1 Background
Since u is convex near x0 , it is natural to study this quantity K(u, x0 ) from the dual perspective as well. Let
Cvx(Rn ) denote the space of convex, lower semi-continuous functions on Rn . Given a function u ∈ Cvx(Rn ),
one can apply the Legendre–Fenchel transform L : Cvx(Rn ) → Cvx(Rn ) of u to obtain its conjugate or
dual function u∗ , where
u∗ ≡ L u(s) = sup(hs, xi − u(x)).
x

L is an order-reversing, involutive transform on Cvx(Rn ), and for sufficiently nice convex functions (differentiable,
strictly convex, and 1-coercive), u∗ is given by
u∗ (s) = hs, (∇u)−1 (s)i − u((∇u)−1 (s)).
The conjugate function u∗ can be viewed as a reparametrization of the original function u in terms of its
tangents using the duality between points and hyperplanes. More specifically, given a vector in Rn , there is
an associated family of hyperplanes with that gradient. u∗ distinguishes the one that supports the epigraph
of u by specifying a point on that plane.
For convex functions defined only in a neighbourhood it is standard to extend the function to all of Rn by
setting it equal +∞ outside that neighbourhood. In our case, we are given u convex near x0 , so we extend
it in this manner, if necessary. Clearly this does not affect K(u, x0 ), which is a purely local property. Recall
the following basic definitions:
Definition 3.1. The differentiable function f : Rn → R is convex if for all x, x0 ∈ Rn
f (x0 ) ≥ f (x) + h∇f (x), (x0 − x)i,
and strictly convex if the inequality is strict for x 6= x0 .
Definition 3.2. The differentiable function f : Rn → R is strongly convex with modulus c if and only if for
all (x, x0 ) ∈ Rn × Rn ,
1
f (x0 ) ≥ f (x) + h∇f (x), (x0 − x)i + c|x0 − x|2 .
2
When f is not differentiable a lot of analysis can still be done using the calculus of subdifferentials.
n
Definition
of f , denoted ∂f , is a set function, where
 3.3.n Let f : R → R be convex. The nsubdifferential
	
∂f (x) = s ∈ R : f (y) ≥ f (x) + hs, y − xi ∀y ∈ R .

Under the Legendre transform, differentiability of u corresponds to convexity or monotonicity of u∗ . Recall
from Proposition 1.8, two properties that transform especially well are (i) u ∈ C 1 if and only if u∗ is strictly
convex, and (ii) u ∈ C 1,1 , where ∇u has Lipschitz constant c if and only if u is strongly convex with modulus
1
c.
3.2 Quadratic convexity
In this section we look at how a bound on K(u, x0 ) or equivalently a sphere of support to the graph of u
at (x0 , u(x0 )) transforms to a property of u∗ . More specifically, since K or a sphere of support is a bound
on a generalized second-order derivative of u, how does this translate to information about the convexity of
u∗ ? We should expect a more localized property then in Proposition 1.8, as we only have information at x0 .
Further, we are not assuming any regularity beyond differentiable at x0 .
Now, strong convexity may also defined in terms of quadratic functions: u is strongly convex with
modulus m if u − 21 m|x|2 is convex. Similarly, quasi-convexity, is defined via quadratics: u is λ- quasi-convex
if u + 21 λ|x|2 is convex.

15

Let u : Rn → R be convex with K(u, x0 ) = k0 < ∞. By the definition of K(u, x), for any k > k0 there
exists  > 0 such that
1
u(x0 + h) − u(x0 ) − h∇u(x0 ), hi ≤ k|h|2 , for all |h| < .
2
This motivates the following definition.
Definition 3.4. Let f : Rn → R be convex. Then f is quadratically (resp. sub-quadratically) convex at x0
with modulus m > 0 if there exists  > 0 and a quadratic function Q : Rn → R with ∇2 Q = mI such that
f (x0 ) = Q(x0 ) and f (x) ≥ Q(x),

∀x ∈ B(x0 , )

f (x0 ) = Q(x0 ) and f (x) ≤ Q(x),

∀x ∈ B(x0 , ).

resp.
Example 3.5. f (x) = |x|4/3 is quadratically convex at 0, but not sub-quadratically convex at 0. Note also
that K(f, 0) = +∞ and it does not have a sphere of support at 0.
Example 3.6. More generally, consider any function of the form f (x) = A|x|k , at x = 0. If 0 < k < 1, f is
not convex. If k = 1, f is quadratically convex at 0, but not sub-quadratically convex. If 1 < k < 2 then f is
strictly convex and quadratically convex but not sub-quadratically convex. If k = 2, f is both quadratically
convex and sub-quadratically convex. If k > 2, f is sub-quadratically convex but not quadratically convex.
k

q

If f is of the form f = |x|k , then f ∗ = |y|q , where k1 + 1q = 1. So, in general, given that the LegendreFenchel transform is order-reversing and quadratics are transformed into quadratics, it follows that if f is
quadratically convex, f ∗ is sub-quadratically convex. For a convex C 2 function f , if ∇2 f (x0 ) is positive
definite then f is both quadratically and sub-quadratically convex at x0 .
Proof of Theorem 1.9. Suppose K(u, x0 ) = k0 < ∞. As stated above, by definition of K(u, x0 ), for any
k > k0 , there exists  > 0 such that u satisfies
u(x) − u(x0 ) − h∇u(x0 ), x − x0 i ≤

1
k|x − x0 |2 ,
2

for all x ∈ B(x0 , ). Thus, on this neighbourhood of x0
1
u(x) ≤ u(x0 ) + h∇u(x0 ), x − x0 i + k|x − x0 |2 .
2
By assumption u is convex, and k > k0 ≥ 0, so the right-hand side is also convex. Taking the Legendre
transform gives

2
1  y − ∇u(x0 ) 
∗
u (y) ≥ h∇u(x0 ), x0 i − u(x0 ) + hx0 , y − ∇u(x0 )i + k 
 .
2
k
Now u∗ may not be differentiable at ∇u(x0 ), however ∇u(x0 ) ∈ ∂u(x0 ) if and only if x0 ∈ ∂u∗ (∇u(x0 )),
which is equivalent to u∗ (∇u(x0 )) = h∇u(x0 ), x0 i − u(x0 ). So the above inequality simplifies to
u∗ (y) ≥ u∗ (∇u(x0 )) + hx0 , y − ∇u(x0 )i +

1
|y − ∇u(x0 )|2 .
2k

Note that there is equality at y0 = ∇u(x0 ) and the Hessian of the right-hand side is k1 I so u∗ is quadratically
convex with modulus k1 .
On the other hand, if u∗ is quadratically convex at y0 = ∇u(x0 ) with modulus k1 then u will be subquadratically convex with modulus k at x0 , and it follows that K(u, x0 ) ≤ k.
In the above proof we do not need to worry about ∂u(B(x0 , )) being degenerate (for example if u is
locally a hyperplane at x0 ) because in that case u∗ (y) will then be +∞ away from ∇u(x0 ) so clearly the
inequality will hold on some neighbourhood.
Our goal now is to obtain the nice bound on K(u, x) in Proposition 1.6 using the dual function, given a
sphere of support to the graph of u at (x, u(x)). The following elementary lemma, which we state without
proof, will help us to reduce arguments on Rn to ones on R.
16

Lemma 3.7. Let Sr be an n-sphere with radius r in Rn+1 , centered at (0, ..., 0, p
r), and let d : Rn → R be
the function defined by the lower hemisphere, i.e., for z ∈ Bn (0, r), d(z) = r − r2 − |z|2 . Then for any
x ∈ Bn (0, r) and v ∈ Rn , |v| = 1, the graph of ψ : I ⊂ R → Rn+1 defined by ψ(t) = d(x + tv) is a lower
semi-circle in Rn+1 of radius ≤ r, where I = (−, 0 ) is of maximal length.
Proposition 3.8. Let f : Rn → R be C 2 and convex and suppose there exists a sphere of support to the
graph of f at (x0 , f (x0 )) of radius r. Then
3

K(f, x0 ) ≤

(1 + ∇f |2x0 ) 2
.
r

Proof. Because f is C 2 , K(f, x0 ) is the largest eigenvalue λmax of ∇2 f (x0 ). If λmax =0 or ∇f (x) = 0 then the
bound on K(f, x0 ) is trivial, so let λmax > 0 and ∇f (x) 6= 0. f is convex so ∇2 f (x0 ) is symmetric positive
semi-definite, and there exists an orthonormal basis of eigenvectors. Let v be the eigenvector coresponding
1
, the smallest eigenvalue of
to λmax . By duality, v is also an eigenvector corresponding to λ∗min = λmax
2 ∗
∇ f (∇f (x0 )). This follows from the fact that the Hessians of dual functions satisfy
∇2 f ∗ (y0 ) = ∇2 f (x0 )−1 ,

where y0 = ∇f (x0 ).

(Here we assume without loss of generality that ∇2 f (x0 ) is invertible because we are only concerned with
λmax > 0).
Let S((c, t), r) be the sphere of support of radius r, to the graph of f at x0 , and d the associated lower
hemisphere function, i.e.
p
d(x) =t − r2 − |x − c|2 , x ∈ B̄(c, r)
d(x) =∞, else.
Clearly d is convex and d ≥ f , by definition of a supporting sphere. Also, recall that f and d agree up to
first order at x0 .
Again by basic properties of the Legendre transform, the following relations hold:
f ∗ (y0 ) = d∗ (y0 )

f ∗ ≥ d∗

∇f ∗ (y0 ) = ∇d∗ (y0 ) = x0 .

It follows that
∗
λ∗min ≥ γmin
∗
where γmin
is the smallest eigenvalues of ∇2 d∗ (∇f (x0 )). Note that this is equivalent to

λmax ≤

1

.
∗
γmin

∗
Given this bound, we now show that γmin
can always be computed using a function on R.
0
∗
Let v be the unit-length eigenvector corresponding to γmin
and γmax . By Proposition 2.1, v 0 is in
˜ the restriction of d to this 1−dimensional subspace defines
the direction of ∇d(x0 ). By Lemma 3.7, d,
a lower semi-circle function, and this function has the properties: d˜0 (x0 ) = h∇d(x0 ), v 0 i = |∇d(x0 )| and
∗
d˜00 (x0 ) = γmax . Therefore, the dual function d˜∗ has second derivative at |∇f (x0 )| equal to γmin
, and so we
may assume without loss of generality that f and d are functions on R.
Now we compute d∗ directly by using the Legendre transforms of common functions. Rewriting d
p
d(x) =t − r2 − (x − c)2
s

2
x c
=t − r 1 −
−
,
r
r

and then applying the following well-known conjugate pairs:
p
p
h(x) = − 1 − x2
h∗ (y) = 1 + y 2
y−β
y−β
g(x) = α + βx + γu(λx + δ)
g ∗ (x) = −α − δ
+ γu∗ (
),
λ
γλ
17

gives
d∗ (y) = − t + cy + r
d ∗
ry
d (y) =c + p
dy
1 + y2
d2 ∗
r
d (y) =
3 .
dy 2
(1 + y 2 ) 2

p

1 + y2

Thus,
3

K(f, x0 ) = λmax

1
(1 + |∇f (x0 )|2 ) 2
≤ d2
=
.
∗
r
dy 2 d (|∇f (x0 )|)

The more general case, where f is not assumed to be C 2 , will use Proposition 3.8 and quadratic convexity
of the dual.
Proposition 3.9. Let f : Rn → R be convex with a sphere of support at x0 of radius r. Then K(f, x0 ) ≤
3
(1 + ∇f |2x0 ) 2
.
r
Proof. Let d be the lower hemisphere function. Then d(x0 ) = f (x0 ), and
d ≥ f ⇒ f ∗ ≥ d∗ .
If y0 = ∇f (x0 ) (which exists since there is a sphere of support) then
d∗ (y0 ) = f ∗ (y0 ) and ∇d∗ (y0 ) ∈ ∂f ∗ (y0 ).
From Proposition 3.8 the smallest eigenvalue of ∇2 d∗ (y0 ) is equal to

r
3

(1+|y0 |2 ) 2

, so for any m <

r
3

(1+|y0 |2 ) 2

there exists a neighbourhood U of x0 such that
1
f ∗ (y) ≥ d∗ (y) ≥ d∗ (y0 ) + h∇d∗ (y0 ), y − y0 i + m|y − y0 |2 .
2
Thus, f ∗ is quadratically convex with modulus m.
It follows that f = (f ∗ )∗ is sub-quadratically convex at x0 with modulus
quadratic. This implies that
1
K(f, x0 ) ≤ K(Qm , x0 ) = ,
m
r
and since this holds for any m <
3 ,
2

1
m.

Let Qm be a satisfying

(1+|y0 | ) 2

3

K(f, x0 ) ≤

3

(1 + |∇f (x0 )|2 ) 2
(1 + |y0 |2 ) 2
=
.
r
r

Appendix
A.1 Lipschitz gradient
Here we show that the generalized derivative K(f, x) retains the following standard property regarding the
derivative of a Lipschitz continuous function.
Proposition A.1. Suppose f : Rn → R is convex and C 1,1 (i.e f is differentiable and has Lipschitz
gradient), with Lipschitz constant L. Then K(f, x) ≤ L for all x.
18

Proof. Let x0 ∈ Rn .
K(f, x0 ) := lim sup 2−2 max {f (x0 + h) − f (x0 ) − h∇f (x0 ), hi : |h| = 1},
→0

which can be can written as

K(f, x0 ) = lim sup max
→0


f (x0 + h) − f (x0 ) − h∇f (x0 ), hi
:
|h| = 1 .
2
2

Differentiability lets us use the Cauchy mean value theorem. Let φ1 () = f (x0 + h) − h∇f (x0 ), hi, and
φ2 () = 2 . Note that
f (x0 + h) − f (x0 ) − h∇f (x0 ), hi
φ1 () − φ1 (0)
2
=2
.
2
φ2 () − φ2 (0)
Thus, there exists γ ∈ (0, ) such that
2

φ0 (γ) h∇f (x0 + γh), hi − h∇f (x0 ), hi
φ1 () − φ1 (0)
=
= 2 10
φ2 () − φ2 (0)
φ2 (γ)
γ
h∇f (x0 + γh) − ∇f (x0 ), hi
=
γ
|∇f (x0 + γh) − ∇f (x0 )|
≤
≤L
γ

Therefore K(f, x0 ) ≤ L, and thus

1
K(f,x0 )

bounds the modulus of convexity of f ∗ , for any x0 .

A.2 Example of a non C 1,1 function with a sphere of support
Example A.2. It may seem that since a bound on K(u, x) implies a sphere of support to the graph of u at
(x, u(x)), that this in turn implies some kind Lipschitz continuity of the gradient in a small neighbourhood
of x. Here we construct an example of a strictly convex function f that is C 1 and twice differentiable with
K(f, 0) < ∞, but with gradient not Lipschitz in any neighbourhood of 0, to show this is not the case. Let
f : [−1, 1] → R be given by f (0) = 0, and for x ≥ 0
Z x
f 0 (x) =
γ(t)dt,
where γ(t) := n + 4 on In and 0 otherwise,
0

with In =

1
1
[1 −
, 1]. Define f 0 (−x) := −f 0 (x).
(n + 4)2
(n + 4)2

Then f 0 is clearly increasing and so f is convex. And for xn =
f 0 (xn ) =

Z

x1

γ(t) dt =
0

X
k≥n

1
≤
(k + 4)3

Z

∞

n+3

1
,
(n + 4)2

1
1
dt
=
<
= xn .
t3
2(n + 3)2
(n + 4)2

So we have f 0 (x) ≤ x for all x ∈ [0, 1] and f 0 (x) ≥ x for all x ∈ [−1, 0]. Since d0 (x) ≥ x for all x ∈ [0, 1]
and d0 (x) ≤ x for all x ∈ [−1, 0], it follows that the graph of d, and thus the unit circle centered at (0, 1), is
always at or above the graph of f , with f (0) = d(0). Therefore, f has a sphere of support at x0 = 0.
However, there exist sequences {xi }, {xj } such that
f 0 (xi ) − f 0 (xj )
xi − xj
blows up: Taking xi and xj as the endpoints of In ,
Z xi

Z xj
Z xi
f 0 (xi ) − f 0 (xj )
1
=
γ(t)dt −
γ(t)dt = (n + 4)4
n + 4dt = n + 4.
xi − xj
xi − xj
0
0
xj
We can make f strictly convex by adding an xm term, which does not affect any of the above analysis. The
above example can be adjusted to show that f 0 is not α-Holder continuous for any α.
19

A.3 Osculating and locally supporting spheres
Here we extend the concept of an osculating circle to a plane curve to that of an “osculating sphere”to the
graph of a function in higher dimensions. The bound on the “largest eigenvalue ”K(u, x) can be seen as a
generalization of the relationship between the second derivative of a C 2 plane curve u and the radius of its
osculating circle:
Let u : R → R be C 2 . Provided u00 6= 0, the radius of curvature at x is defined as
3

ru,x :=

(1 + u02 ) 2
1
,
=
κ
u00

where κ is the curvature of u at x, and the right-hand side is the standard formula for computing the
curvature of a planar curve [2, §8]. Thus,
u00 =

(1 + u02 )3/2
.
r

Definition A.3. The osculating circle, or circle of curvature, to a planar curve C at p is the circle that
touches C (on the concave side) at p and whose radius is the radius of curvature of C at p.
We extend this to the graphs of C 2 convex functions in higher dimensions by
Definition A.4. For a convex function u : Rn → R let the osculating sphere to the graph of u at x be the
1
.
n−sphere tangent to the graph of u at x the with radius equal to that of λmax
It is easy to show that any tangent sphere at (x, u(x)) with radius less than the osculating sphere at that
point is a (local) sphere of support. And any tangent sphere at (x, u(x)) with radius greater than the
osculating sphere cannot be a (local) sphere of support.
A.4 Spheres of support to a function and its dual
Given a convex function u with a sphere of support at (x0 , u(x0 )), the conjugate function u∗ will not
necessarily have a sphere of support at the corresponding point (∇u(x0 ), u∗ (∇u(x0 )). For example take
4
u = 41 |x|4 and u∗ = 34 |x| 3 . However, for more regular and sufficiently convex functions (e.g. C 2 and locally
strongly convex), we will have a sphere of support (locally) to both graphs at corresponding points, and the
order-reversing property of L provide a simple inequality relating the radii of these spheres. We state this
without proof.
Proposition A.5. Let u : Rn → R be strongly convex and C 2 near x0 , and suppose u has a sphere of
support of radius rx0 . If ry0 is the radius of a sphere of support to u∗ at y0 = ∇u(x0 ), then
ry0 ≤

1 + |x|2

 23

1 + |∇u(x0 )|2
rx0

 23
.

Acknowledgements
I am very grateful to Y.A. Rubinstein for introducing me to the work of Slodkowski, Harvey and Lawson,
and for his ongoing guidance and encouragement. I thank T. Darvas and R. Hunter for helpful comments
and discussions. I would also like to thank Z. Slodkowski for an insightful correspondence, and a referee for
their careful review and stellar suggestions.
References
[1]A.D. Alexandrov, Almost everywhere existence of the second differential of a convex function and properties of
convex surfaces connected with it (in Russian), Lenningrad State Univ. Ann. Math. 37 (1939), 3-35.
[2] Y. Animov, Differential Geometry and Topology of Curves, CRC Press, 2001.

20

[3] J. Foran, Fundamentals of Real Analysis, CRC Press, 1991.
[4] F.R. Harvey, H.B. Lawson, Jr., Dirichlet duality and the non-linear Dirichlet problem, Comm. on Pure and
Applied Math. 62 (2009), 396-443.
[5] F.R. Harvey, H.B. Lawson, Jr., Notes on the differentiation of Quasi-Convex Functions, 2014.
[6] J.-B. Hiriart-Urruty, C. Lemaráchal, Convex Analysis and Minimization Algorithms, Vol.I and II, Springer, 1993.
[7] R.T. Rockafellar, Convex Analysis, Princeton University Press, 1970.
[8] C.A. Rogers, Hausdorff measures, Cambridge University Press,1970.
[9] Z. Slodkowski, The Bremermann-Dirichlet Problem for q−Plurisubharmonic Functions, Analli della Scuola Normale
Superiore di Pisa, Classe di Scienze, 4e série, tome 11, no. 2 (1984), p. 303-326.

University of Maryland
mdellato@math.umd.edu

21

