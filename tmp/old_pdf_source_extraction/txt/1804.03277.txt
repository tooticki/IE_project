***
Definition 2.1. A graphex W = (W, S, I, Ω) consists of a σ-finite measure space
Ω = (Ω, F, µ), a symmetric measurable function W : Ω × Ω → [0, 1], a measurable
function S : Ω → R+ , and a nonnegative real number I such that the following local
finiteness conditions hold:
(1) W (·, x) is integrable for almost all x ∈ Ω, and
(2) there exists a measurable subset Ω0 ⊆ Ω such that µ(Ω \ Ω0 ) < ∞ and W|Ω0
is integrable.
The quadruple will be called a signed graphex if instead of taking values in [0, 1] and
R+ , W , S and I take values in R. The graphex W = (W, S, I, Ω) is called integrable
if
Z
Z
kWk1 :=
|W (x, y)| dµ(x) dµ(y) + 2
|S(x)| dµ(x) + 2|I| < ∞,
Ω×Ω

Ω

and the restriction W|Ω0 of W to Ω0 ⊆ Ω is defined as the quadruple W0 =
(W 0 , S 0 , I 0 , Ω0 ) with Ω0 = (Ω0 , F 0 , µ0 ), where F 0 = {A ∈ F : A ⊆ Ω0 }, µ0 is the
restriction of µ to F 0 , S 0 is the restriction of S to Ω0 , and W 0 is the restriction of
W to Ω0 × Ω0 .

***
Definition 2.2. Let W be a graphex, let (GT (W))T ≥0 be the random family of
graphs defined above, and let ξ[W] be the random adjacency measure ξG∞ (W) . We
call the stochastic process (GT (W))T ≥0 the graphex process generated by W, and
the adjacency measure ξ[W] the adjacency measure generated by W. We say two
graphexes are equivalent, if the graphex processes generated by these graphons are
equal in law.

***

Remark 2.3. (1) Following [4], we defined a graphex process as a stochastic process
taking values in a space of graphs with labels in R+ . Alternatively, one might want
to define a graphex process as a process taking values in the space of unlabeled
graphs without isolated vertices. In our current context, this would correspond to
ignoring the time labels of the graphs in GT (W), leading to a graph which we denote
by GT (W). When it is important to distinguish them, we will refer to the process
(GT (W))T ≥0 as the unlabeled graphex process corresponding to W, and to the
process (GT (W))T ≥0 as the labeled graphex process corresponding to W. Note that
it is easy to recover GT (W) from GT (W): just assign i.i.d. labels chosen uniformly
at random in [0, T ] to all vertices. A related observation is the fact that GT (W) can
be generated by first choosing (xi )i≥1 according to a Poisson process with intensity
T µ in Ω, then connecting i and j with probability W (xi , xj ), then adding a star
whose number of leaves are chosen as a Poisson random variable with mean T S(xi )
to each point of the process (xi )i≥1 , and finally adding independent edges with rate
IT 2 . Forgetting the labels then gives us GT (W). Relabeling each vertex in the
resulting graph independently by a uniform t ∈ [0, T ], we obtain GT (W).
(2) It is sometimes convenient to assign a feature value to the endpoints of the
isolated edges generated from the dust part I in the graphex, as well as to the leaves
of the stars generated using the function S. For our purpose, we will say that these
vertices have the feature label ∞, and we will extend the marginal DW to Ω ∪ {∞}
by setting
Z
DW (∞) =
S(x) dµ(x) + 2I.
ΩR
Note that with this notation, kWk1 = Ω DW (x) dµ(x) + DW (∞).
e = Ω ∪ {∞}
(3) In view of (2), one might want to equip the extended feature space Ω
with a σ-finite measure by keeping the original measure on Ω, and assigning some
finite measure Q = µ
e(∞) to the feature value ∞, giving a new σ-finite measure
e
e
e
fQ , 0, 0, Ω)
space ΩQ . On ΩQ , one can then define a graphex of the form f
WQ = (W
2
fQ equal to W on Ω × Ω and to 2I/Q on {∞} × {∞}, and by setting
by setting W
f
f (∞, y) = S(y)/Q if only one of the two features x, y
W (x, ∞) = S(x)/Q and W
lies in Ω. With this construction, DW
fQ (∞) = DW (∞)/Q, DW
fQ (x) = DW (x) if
R
f
x ∈ Ω, and kWk1 = kWQ k1 = dµ(x)D f + QD f (∞), with the notation in (2)
W1

W

corresponding to the case Q = 1. It is clear that the graphon process generated
from f
W cannot have exactly the same distribution as the one generated from W
unless I and S are zero (to see this, note that in G∞ (f
W), all vertices have infinite
degrees, while G∞ (W) has vertices of degree one). But one might wonder whether
the process generated from the “pure graphon” f
W approximates the one generated
from W. As we will see in Remark 7.7 , this is indeed the case, in the sense that for
any fixed T , the distribution of GT (f
WQ ) converges to GT (W).

***

Proposition 2.4. Let W = (W, S, I, Ω) be a 4-tuple consisting of a σ-finite measure
space Ω = (Ω, F, µ), a symmetric measurable function W : Ω × Ω → [0, 1], a
measurable function S : Ω → R+ , and a nonnegative real number I. Then the local
finite conditions (1) and (2) from Definition 2.1 are equivalent to the local finiteness
of the adjacency measure generated by W. If we assume condition (1), then following
are equivalent:
(A) The graphex W obeys the local finiteness condition (2).
(B) For all D > 0, µ({DW > D}) < ∞ and W|{DW ≤D} is integrable.
(C) There exists a D > 0 such that µ({DW > D}) < ∞ and W|{DW ≤D} is integrable.
(D) For all D > 0, µ({DW > D}) < ∞, and both W |{DW ≤D} and min{S, 1} are
integrable.
(E) There exists a D > 0 such that µ({DW > D}) < ∞, and both W |{DW ≤D} and
min{S, 1} are integrable.

***

Theorem 2.5. Let W1 = (W1 , S1 , I1 , Ω1 ) and W2 = (W2 , S2 , I2 , Ω2 ) be graphexes,
where Ωi = (Ωi , Fi , µi ) are σ-finite spaces. Then Gt (W1 ) and Gt (W2 ) have the
same distribution for all t ∈ R+ if and only if there exists a third graphex W =
(W, S, I, Ω) over a σ-finite measure space Ω = (Ω, F, µ) and measure preserving
maps φi : dsupp Wi → Ω such that Wi |dsupp Wi = Wφi almost everywhere.

***

Remark 2.6. If the two graphexes are defined over Borel spaces, we can prove
an analogous statement where the measure-preserving maps are turned around.
Specifically, for the case where Ω1 and Ω2 are σ-finite Borel spaces, we can prove
that Gt (W1 ) and Gt (W2 ) have the same distribution for all t ∈ R+ if and only
if there exists a σ-finite Borel space Ω = (Ω, F, µ) and measure preserving maps
πi : Ω → dsupp Wi such that (W1 |dsupp W1 )π1 = (W2 |dsupp W2 )π2 almost everywhere.
In this case, the space Ω can be chosen to be a coupling of Ω1 and Ω2 , with πi being
the coordinate projections from Ω1 × Ω2 to Ωi . See Theorem 8.2 in Section ??.
For graphexes without a dust and star part, this was independently established in
[3] (using a different proof); see also [17], which establishes a similar result (with
yet another proof), this time giving a coupling of the two graphexes (again without
dust and star part) after trivially extending them rather than restricting them to
the support of their marginals.

***
Definition 2.7. Given a function U defined on Ω1 × Ω2 for two σ-finite measure
spaces Ωi = (Ωi , Fi , Ωi ) for i = 1, 2, we define
kU k2→2 =

sup
f,g:kf k2 =kgk2 =1

f ◦U ◦g =

sup
g:kgk2 =1

kU ◦ gk2 .

***
Definition 2.8. Given a measurable function U defined on Ω × Ω for a σ-finite
measure space Ω, we define the jumble norm


Z


1


kU k = sup  p
U (x, y) dµ(x) dµ(y) .

µ(S)µ(T ) S×T
S,T ⊆Ω 
Here the supremum is over subsets with finite and nonzero measure.

***
Definition 2.9. A signed graphex W = (W, S, I, Ω) over Ω = (Ω, F, µ) is said
to be in L1 ∩ L2 if both W and D|W| are in L1 ∩ L2 . Here |W| is the graphex
|W| = (|W |, |S|, |I|, Ω).

***
Definition 2.10. Let W1 and W2 be signed graphexes in L1 ∩ L2 . Then we define
(2.4)
δ2→2 (W1 , W2 ) = δe2→2 (W0 , W0 ),
1

2

where W01 and W02 are trivial extensions of W1 and W2 to measure spaces of infinite
total mass. We refer to δ2→2 (W1 , W2 ) as the kernel distance of W1 and W2 and
call δ2→2 the kernel metric.

***

Theorem 2.11. Let W1 and W2 be signed graphexes in L1 ∩ L2 . Then the right
side of (2.4) does not depend on the choice of the trivial extensions W01 and W02 .
Furthermore, given three signed graphexes W1 , W2 , W3 in L1 ∩ L2 ,
δ2→2 (W1 , W3 ) ≤ δ2→2 (W1 , W2 ) + δ2→2 (W2 , W3 ).

Therefore, δ2→2 is a well-defined pseudometric.

***

Remark 2.12. In [3], when defining the cut distance between two graphons, it was
only necessary to extend the smaller space to the larger one, and it was not necessary
to extend further. It is natural to ask whether a trivial extension to a space of
infinite metric is necessary, or, equivalently, whether for two graphexes W1 , W2
defined on spaces with the same (finite) measure, δe2→2 (W1 , W2 ) = δ2→2 (W1 , W2 ).
In contrast to the cut distance discussed in [3], for the kernel metric it is sometimes
necessary to take trivial extensions of both spaces, not just an extension of the
smaller space to one of the same measure as the larger one. See Example 3.11 in
Section ??.

***

Theorem 2.13. For any D > 0, δ2→2 -convergence is equivalent to GP-convergence
on the space of graphexes with D-bounded marginals.

***

Definition 2.14. Let W1 = (W1 , S1 , I1 , Ω1 ) and W2 = (W2 , S2 , I2 , Ω2 ) be signed
graphexes, where Ωi = (Ωi , Fi , µi ) and kWi k∞ < ∞ for i = 1, 2. We define
δ (W1 , W2 ) as the infimum of the set of real numbers c such that there exist two
measures µ
e1 and µ
e2 over (Ω1 , F1 ) and (Ω2 , F2 ) that satisfy the following: the signed
graphexes f
W1 and f
W2 obtained from W1 and W2 by replacing µ1 and µ2 by µ
e1
and µ
e2 , respectively, are in L1 ∩ L2 , and
(1) for i = 1, 2, we have µi − c2 ≤ µ
ei ≤ µi , and
(2) δ2→2 (f
W1 , f
W2 ) ≤ c.
We refer to δ (W1 , W2 ) as the weak kernel distance between W1 and W2 and call
δ the weak kernel metric.

***

Theorem 2.15. Given three signed graphexes W1 , W2 , W3 with bounded graphon
part,
δ (W1 , W3 ) ≤ δ (W1 , W2 ) + δ (W2 , W3 ).
Therefore, δ is a pseudometric.

***

Remark 2.16. Given a signed graphex W = (W, S, I, Ω) with Ω = (Ω, F, µ) and a
measure-preserving map ϕ : Ω0 → Ω, let W0 = Wϕ almost everywhere. We can take a
coupling µ
e on Ω0 ×Ω defined by µ
e(A×B) = µ0 (A∩ϕ−1 (B)). It is easy to see that then
the pullbacks of the two signed graphexes to Ω0 × Ω will be equal almost everywhere,
which implies that δ2→2 (W, W0 ) = δe2→2 (W0 , W) = δ (W0 , W) = δe (W0 , W) = 0.

***

Proposition 2.17. Fix D < ∞. Then δ and δ2→2 give an equivalent topology on
the space of graphexes with D-bounded marginals.

***

Theorem 2.18. Given a sequence of graphexes Wn and a graphex W, Wn is
GP-convergent to W if and only if δ (Wn , W) → 0.

***

Remark 2.19. The reader might wonder whether instead of building our metric for
GP-convergence around the kernel norm k · k2→2 , one could equivalently build it
around the cut norm, k · k . Concretely, one might want to define d by replacing
the kernel norm in (??) by the cut norm and the L2 norm by the L1 norm, then
proceed as in (??) and (2.4) to obtain a cut distance δ between graphexes with
bounded marginals, and finally proceed as in Definition 2.14 to obtain a “weak cut
metric” for arbitrary graphexes.
The following example shows that this approach does not work, in that it will not
metricize GP-convergence. Define Wn to be the graphex that is constant and equal
to n−2 over [0, n]2 and 0 everywhere else, and set Wn = (Wn , 0, 0, R+ ), where R+
is equipped with the Lebesgue measure. The marginal DWn of Wn is then equal
to 1/n times the indicator function of the interval [0, n], and its L1 norm is equal
to 1. It is then not hard to check that Wn converges to the pure dust graphex
(0, 0, 1, R+ ) in the metric δ . Indeed, kWn k2→2 → 0 and kDWn k2 = n−1/2 → 0,
while kWn k = 1 → 1 = kWk1 , which immediately implies convergence in the metric
δ and hence GP-convergence (based on the proof of equivalence in this paper,
though for this specific case it is simple to check GP-convergence directly). By
contrast, kWn k = kWn k1 = 1 stays bounded away from zero, showing in particular
that Wn does not converge to W in the cut metric δ . Since changing the Lebesgue
measure to a measure µn such that λ − εn ≤ µn ≤ λ with εn → 0 will asymptotically
not change the cut norm of Wn , the graphexes Wn do not converge to W in the
weak cut metric either. Note that this can’t be cured by choosing a different norm
for the marginal difference DW1 − DW2 , e.g., by keeping the L2 norm for that part,
since the above counter example works independently of the norm used for that
part.

***

Definition 2.20. A set S of graphexes is tight if for every ε > 0, there exist C and
D such that for every W ∈ S, W = (W, S, I, Ω) with Ω = (Ω, F, µ), there exists
Ωε ⊆ Ω such that µ(Ωε ) ≤ ε and the graphex W0 = W|Ω\Ωε is (C, D)-bounded.
Here a graphex W0 is called (C, D)-bounded if its marginals are D-bounded and
kW0 k1 ≤ C.

***

Theorem 2.21. The space of all graphexes is complete under the topology induced
by the weak kernel metric δ . A subset is relatively compact if and only if it is tight.
In particular, for any C and D, the set of graphexes with kWk1 ≤ C is compact
under δ , and the set of (C, D)-bounded graphexes is compact under both δ and
δ2→2 .

***

Remark 2.22. As mentioned above, we only develop the theory of tightness for
unsigned graphexes. In particular, we don’t characterize the set of precompact
signed graphexes. That notwithstanding, some of our compactness results do hold
for signed graphexes. Here we only mention that the analogue of the statement for
the set of graphexes with kWk1 ≤ C holds for signed graphexes as well, provided
we restrict the L∞ norm of the graphon part (which by definition is bounded
by 1 for unsigned graphexes). To be explicit, any sequence of signed graphexes
Wn = (Wn , Sn , In , Ωn ) with kWn k∞ ≤ B and kWn k1 ≤ C has a subsequence
converging to a signed graphex W = (W, S, I, Ω) with kW k∞ ≤ B and kWk1 ≤ C.
See Remark 5.10 in Section ?? below.

***

Theorem 2.23. Assume that W and Wn for n ≥ 1 are graphexes whose marginals
are D-bounded for some finite D. Then the following are equivalent.
(1) δ2→2 (Wn , W) → 0.
(2) For every graph F with no isolated vertices, t(F, Wn ) → t(F, W).
(3) For every connected graph F , t(F, Wn ) → t(F, W).
(4) GT (Wn ) → GT (W) in distribution for every T .
(5) GT (Wn ) → GT (W) in distribution for some T .

***

Remark 2.24. The above theorem implies in particular that in order to check whether
a sequence Wn of graphexes with uniformly bounded marginals is GP-convergent,
it is enough to check convergence of GT (Wn ) for a single T > 0. In a similar way,
several other properties of sequences or sets of graphexes can be equivalently stated
for all T > 0 or some T > 0 (see, in particular, the already mentioned Theorem 4.1
about tightness and Theorem 9.1 about uniform integrability). But for general
sequences of graphexes, we do not know whether GP-convergence is equivalent to
the convergence of GT (Wn ) for just one T > 0.

***
Definition 2.25. A set of graphexes S is called uniformly integrable if the graphexes
in S have uniformly bounded k · k1 -norms, and for every ε > 0, there exists a D
such that for all W ∈ S, kDW 1DW >D k1 < ε.

***

Theorem 2.26. Suppose Wn is a sequence of integrable graphexes with uniformly
bounded k · k1 -norms that converges to a graphex W in the weak kernel metric. Then
kWk1 ≤ lim inf kWn k1 .
n→∞

In particular, W is integrable. We furthermore have that
lim kWn k1 = kWk1

n→∞

if and only if the sequence Wn is uniformly integrable.

***
Definition 2.27. [[3]] Given a set of signed, integrable graphons S, we say that
they are uniformly tail regular if for any ε > 0, there exists M such that for each
W ∈ S with the usual notation, there exists Ω0 ⊆ Ω such that µ(Ω0 ) ≤ M and
kW k1 − kW |Ω0 k1 ≤ ε.

***
Theorem 2.28. Given a sequence of integrable graphexes of the form
Wn = (Wn , 0, 0, Ωn ),

the following are equivalent.
(1) The sequence Wn converges to a graphon W in cut metric.
(2) The sequence Wn is uniformly tail regular, and in the weak kernel metric,
the sequence Wn converges to a graphex of the form W = (W, 0, 0, Ω).
(3) The sequence Wn is uniformly tail regular, and in the weak kernel metric,
the sequence Wn converges to some graphex W.

***
Theorem 2.29. Given a sequence of uniformly integrable graphexes
Wn = (Wn , Sn , In , Ωn ),

which converge to a graphex W = (W, S, I, Ω) in the weak kernel metric, the following
are equivalent.
(1) The graphex W is of the form W = (W, 0, 0, Ω).
(2) kSn k1 → 0 and In → 0, and the sequence of graphons Wn has uniformly
regular tails.
(3) kSn k1 → 0 and In → 0, and the sequence of graphons Wn converges in the
cut metric.

***

Remark 2.30. In the above theorem, the assumption of uniform integrability is
necessary. To see this, let Wn be the graphon defined by being 1 on the set
[0, 1/n] × [1, n + 1] and its transpose, and 0 otherwise, and let Wn = (Wn , 0, 0, R+ ).
Then the sequence Wn converges to the zero graphex in the weak kernel metric,
which is a pure graphon. However, the sequence is clearly not uniform tail regular
(or even uniformly integrable). We can also let Sn (x) = 1/n on the set [0, n], and 0
everywhere else. In that case the sequence still converges to 0 in the weak kernel
metric, but kSn k1 does not converge to 0.

***

Theorem 3.1. Let W1 and W2 be signed graphexes in L1 ∩ L2 . Define δ by
replacing the right side of (2.4) with δe , which in turn is obtained from δe2→2 by
replacing d2→2 with d . Then the value of δ (W1 , W2 ) does not depend on the
choice of the trivial extensions W01 and W02 , and δ obeys the triangle inequality,
making it a well-defined pseudometric.

***

Lemma 3.2. Suppose φ : Ω → Ω0 is a measure preserving map between two σ-finite
measure spaces (Ω, F, µ) and (Ω0 , F 0 , µ0 ).
(1) For any σ-algebra G ⊆ F, L1 (Ω, G, µ) is a closed subspace in L1 (Ω, F, µ).
(2) If f ∈ L1 (Ω, φ−1 (F 0 ), µ), then there exists a function f 0 ∈ L1 (Ω0 , F 0 , µ0 )
such that f = f 0φ = f 0 ◦ φ almost everywhere.
φ
(3) The map φ∗ : L1 (Ω0 , F 0 , µ0 ) → L1 (Ω, φ−1 (F 0 ), µ) with f 0 7→ f 0 is an
isometric isomorphism, implying that φ∗ and its inverse are continuous
and hence Borel measurable.

***
Lemma 3.3. Suppose that Ω = (Ω, F, µ) with µ(Ω) < ∞, and suppose that g ∈
L2 (Ω). Let
R



 Ω f g dµ 

.
(3.3)
S=
sup

 qR
f ∈L∞ (Ω),0≤f ≤1 
f dµ 
Ω

Then S ≤ kgk2 < ∞, and there exists X ⊆ Ω such that
R

 g dµ
X
S= p
.
µ(X)

Note that this expression is the same as taking f = 1X in (3.3 ).

***

Proposition 3.4. Let Ω = (Ω, F, µ) and Ω0 = (Ω0 , F 0 , µ0 ) be σ-finite measure
spaces, and let ϕ : Ω0 → Ω be measurable. If U : Ω × Ω → R and F : Ω → R are
square integrable, then
kU k2→2 = kU ϕ k2→2 ,

kF k = kF ϕ k ,

and

kU k = kU ϕ k .

If instead of square integrability, we assume that U is integrable, then
kU k = kU ϕ k .

***

Lemma 3.5. Let Ω = (Ω, F, µ) and Ω0 = (Ω0 , F 0 , µ0 ) be σ-finite measure spaces,
let ϕ : Ω → Ω0 be a measure-preserving map, and let W1 , W2 be signed graphexes in
L1 ∩ L2 . Then
ϕ
∆2→2 (W1 , W2 ) = ∆2→2 (Wϕ
1 , W2 )

and

ϕ
∆ (W1 , W2 ) = ∆ (Wϕ
1 , W2 ).

***

Remark 3.6. Given a signed step graphex W = (W, S, I, Ω) over a finite subspace
partition P = (P1 , P2 , . . . , Pm ), we can define another signed graphex W0 =
(W 0 , S 0 , I 0 , Ω0 ) with Ω0 = (Ω0 , F 0 , µ0 ), where Ω0 = [m], F 0 consists of all subsets,
and the measure is defined by µ0 ({i}) = µ(Pi ). Setting I 0 = I, S 0 (i) = S(x) for any
x ∈ Pi (they are all equal), and W 0 (i, j) = W (x, y) for x ∈ Pi , y ∈ Pj (again the
choice of x and y does not matter), we obtain that W = (W0 )ϕ where ϕ : Ω → Ω0
is the map with ϕ(x) = i for x ∈ Pi . In particular, by Remark 2.16 , the distance
between W and W0 is zero (for any of the distance notions). Suppose now that
W00 = (W 00 , S 00 , I 00 , Ω00 ) with Ω00 = (Ω00 , F 00 , µ00 ) is another signed step graphex over
a finite subspace partition Q = {Q1 , Q2 , . . . , Qm }, with I 00 = I, µ00 (Qi ) = µ(Pi ),
and S 00 (x00 ) = S(x), W 00 (x00 , y 00 ) = W (x, y) for x ∈ Pi , x00 ∈ Qi , y ∈ Pj , y 00 ∈ Qj .
Then Ω00 can also be mapped to Ω0 so that W00 is the pullback of W0 (by mapping
Qi to i). This implies that the distance of both W and W00 from W0 is 0, which (by
the still to be proven triangle inequality) implies that their distance from each other
is 0 (again for any of the notions of distance).

***

Lemma 3.7. Let W1 = (W1 , S1 , I1 , Ω) and W2 = (W2 , S2 , I2 , Ω) be signed
graphexes in L1 ∩L2 . Assume that both are countable step graphexes on Ω = (Ω, F, µ)
with common refinement P = {P1 , P2 , . . . , Pm , . . . }, suppose µ0 is another measure
on Ω with µ(Pi ) = µ0 (Pi ), and let Ω0 = (Ω, F, µ0 ) and W0i = (Wi , Si , Ii , Ω0 ). Then
∆2→2 (W1 , W2 ) = ∆2→2 (W01 , W02 )

and

∆ (W1 , W2 ) = ∆ (W01 , W02 ).

***

Lemma 3.8. Let Wi = (Wi , Si , Ii , Ωi ), for i = 1, 2, 3, be countable step graphexes
in L1 ∩ L2 . Let µ12 be a coupling measure on Ω1 × Ω2 , and µ23 be a coupling measure
on Ω2 × Ω3 . Then there exists a coupling measure µ13 on Ω1 and Ω3 such that
π

∆2→2 (W1 13,1
≤

,µ13

π

, W3 13,3

,µ13

)

π
,µ
π
,µ
∆2→2 (W1 12,1 12 , W3 12,2 12 )

π

,µ23

,µ23

, W3 23,3

+ ∆2→2 (W1 23,2

π

,µ23

,µ23

),

, W3 23,3

and
π

∆ (W1 13,1
≤

,µ13

π

, W3 13,3

,µ13

)

π
,µ
π
,µ
∆ (W1 12,1 12 , W3 12,2 12 )

where the inequalities hold coordinate-wise.

π

+ ∆ (W1 23,2

π

)

***

Lemma 3.9. Suppose that Wi = (Wi , Si , Ii , Ωi ) with Ωi = (Ωi , Fi , µi ), for i =
1, 2, 3, are signed graphexes in L1 ∩ L2 , and assume that µ1 (Ω1 ) = µ2 (Ω2 ) = µ3 (Ω3 ).
Then
δe2→2 (W1 , W3 ) ≤ δe2→2 (W1 , W2 ) + δe2→2 (W2 , W3 )
and
δe (W1 , W3 ) ≤ δe (W1 , W2 ) + δe (W2 , W3 ).

***

Lemma 3.10. Let W = (W, S, I, Ω) be a signed graphex in L1 ∩ L2 , with possibly
unbounded graphon parts, and let Ω = (Ω, F, µ).
(1) If W0 and W00 are trivial extensions of W by σ-finite spaces of infinite
measure, then
δe (W0 , W00 ) = δe2→2 (W0 , W00 ) = 0.
e is obtained from W by appending an
f , S,
e I, Ω)
W = (W
(2) If µ(Ω) = ∞ and f
arbitrary σ-finite space of infinite measure, then
δe2→2 (W, f
W) = δe (W, f
W) = 0.

***

Example 3.11. Let W1 = (W1 , 0, 0, Ω1 ) where Ω1 consists of just two atoms a
and b, with weight p and 1 − p, where 0 < p < 1/2, and W1 (a, a) = W1 (b, b) = 0,
W1 (a, b) = W1 (b, a) = 1. Furthermore, let W2 = (W2 , 0, 0, Ω2 ) where
Ω2 consists
p
of just one atom c with weight 1, and W2 is the constant a = p(1 − p). Then
π1
π2
we have just one choice of coupling.
will have two
p For this coupling, W1 − W2 p
atoms, and it will be equal to − p(1 − p) on the diagonal, and 1 − p(1 − p) off
the diagonal. It is then not difficult to see that kW1 − W2 k2→2 is equal to the largest
eigenvalue (in absolute value) of the matrix


−pa
(1 − p)(1 − a)
.
p(1 − a)
−(1 − p)a
The trace of this matrix is −a, and the determinant is
p(1 − p)a2 − p(1 − p)(1 − a)2 = p(1 − p)(2a − 1) < 0.
p
Here we used that a = p(1 − p) < 1/2. We then have that the two eigenvalues of
the matrix have opposite signs, and their sum is −a, which implies that the negative
one must be less than −a; i.e., it must have larger absolute value than a.
On the other hand, clearly kW1 k2→2 = a, and kW2 k2→2 is equal to the largest
eigenvalue (in absolute value) of the matrix


0 1−p
,
p
0
p
which can easily be seen to be equal to p(1 − p) = a.
Therefore, if we extend W1 and W2 by spaces of total measure at least 1, and couple
each Ωi to the extension, then
f1 − W
f2 k2→2 = max{kW
f1 k2→2 , kW
f2 k2→2 } = a.
kW

Therefore, by extending, we can obtain a better coupling.
Finally, note that in (??), if we multiply the measure of the underlying space by c,
then the first term is multiplied by c, the second by c3/4 , and the third by c2/3 . We
can therefore take c large enough so that the maximum in the term is dominated by
kW1 − W2 k2→2 . Therefore, we obtain that also for minimizing d2→2 , we obtain a
better coupling if we extend by trivial extensions than if we do not.

***

Lemma 3.12. Let W be a signed graphex with bounded graphon part, and let
0 < D < ∞. Then the set {D|W| > D} has finite measure, and W|{D|W| ≤D} is
integrable and hence in L1 ∩ L2 .

***

Lemma 3.13. Let W1 = (W1 , S1 , I1 , Ω) and W2 = (W2 , S2 , I2 , Ω) be signed
graphexes in L1 ∩ L2 , let Ω = (Ω, F, µ), and let
(1) kW1 − W2 k2→2,µ = a,
(2) kDW1 − DW2 k2,µ = b, and
(3) |ρ(W1 ) − ρ(W2 )| = c.
If W01 = (W1 , S1 , I1 , Ω0 ) and W02 = (W2 , S2 , I2 , Ω0 ) where Ω0 = (Ω, F, µ0 ) for some
measure µ0 such that µ − r ≤ µ0 ≤ µ for some r < ∞, then
(1) kW1 − W2 k2→2,µ0 ≤ a, √
(2) kDW01 − DW02 k2,µ0 ≤ b+ a r, and
√


(3) |ρ(W01 ) − ρ(W02 )| − c ≤ 2b r + ar.

***

Lemma 3.14. For i = 1, 2, let Wi be graphexes over Ωi = (Ωi , Fi , µi ), and let
W0i be trivial extensions of Wi to σ-finite measure spaces Ω0i = (Ω0i , Fi0 , µ0i ) with
µ0i (Ω0i ) = ∞. Then δ (W1 , W2 ) = δe (W01 , W02 ), where δe (W01 , W02 ) is defined as the
infimum over all c such that there exists a measure µ0 over Ω01 × Ω02 obeying the
conditions
(1) µ0i − c2 ≤ (µ0 )πi ≤ µ0i for i = 1, 2, and
0
0
(2) d2→2 ((W01 )π1 ,µ , (W02 )π2 ,µ ) ≤ c.

***

Proposition 3.15. Fix B, C, D < ∞. Then δ and δ2→2 define the same topology
on the space of (B, C, D)-bounded signed graphexes.

***

Lemma 3.16. Let Wi = (Wi , Si , Ii , Ω), for i = 1, 2, be (B, C, D)-bounded signed
graphexes on the same measure space Ω, and let µ0 , r, W01 , and W02 be as in
Lemma 3.13 . Then
√
(1) kW1 − W2 k2→2,µ0 ≤ kW1 − W2 k2→2,µ ≤ kW1 − W2 k2→2,µ0 + 4 BDr,


(2) kDW1 − DW2 k22,µ − kDW01 − DW02 k22,µ0  ≤ (4D2 + 8BC)r, and


 


(3) ρ(W01 ) − ρ(W02 ) − ρ(W1 ) − ρ(W2 ) ≤ 4Dr.

***
Lemma 3.17. Suppose Wi = (Wi , Si , Ii , Ωi ), for i = 1, 2, are signed graphexes with
kWi k∞ ≤ B and kD|W| k∞ ≤ D, and let δ (W1 , W2 ) ≤ ε. Then |ρ(W1 ) − ρ(W2 )| ≤
ε3 + 4ε2 D. If, in addition, kW ki ≤ C, then δ2→2 (W1 , W2 ) ≤ f (ε), where



1/2
p
√
1/3
2
3
2
2
f (ε) = max ε + 4ε BD, ε + 2ε D + 2BC
, ε + 4ε D

***
Lemma 3.18. Let U : Ω × Ω → R be a measurable function. Then
kU k42→2 ≤ t(C4 , U ) ≤ kU k22→2 kU k22 .

***

Proposition 3.19. Given B, C, D < ∞, there exists a constant c < ∞ such that if
W1 and W2 are (B, C, D)-bounded signed graphexes, then the following hold.
(1) If d2→2 (W1 , W2 ) ≤ εe, then d (W1 , W2 ) ≤ max{e
ε√, εe3 }.√
(2) If d (W1 , W2 ) ≤ ε, then d2→2 (W1 , W2 ) ≤ max{ 3 ε, c 4 ε}.
If the graphexes are such that ρ(W1 ) = ρ(W
√ 2 ), then these bounds can be replaced by
d (W1 , W2 ) ≤ εe and d2→2 (W1 , W2 ) ≤ c 4 ε.

***

Lemma 3.20. Given a bounded, nonnegative, measurable function f on some
measure space (Ω, F, µ), we have
Z
kf k22
1
p
≤ sup p
f dµ ≤ kf k2 .
kf k1 kf k∞
µ(S) S
S⊆Ω

In particular, the second and third term define equivalent norms, for any C, D, on
the space of nonnegative functions with kf k1 ≤ C, kf k∞ ≤ D.

***
Lemma 3.21. Given a bounded, measurable, not necessarily nonnegative function
f on some measure space (Ω, µ), we have
Z



kf k22
1

p
≤ sup p
f dµ ≤ kf k2 .

2kf k kf k
µ(S)
S⊆Ω
1

∞

S

***
Lemma 3.22. For any measurable U : Ω × Ω → R,
kU k2→2 ≥ kU k ≥

kU k42→2
3/4

3/4

3/2

8kU k∞ kD|U | k∞ kD|U | k2

≥

kU k42→2
3/4

3/2

3/4

8kU k∞ kD|U | k∞ kU k1

.

***

Remark 3.23. The above proof can easily be modified to see that for any 0 < D < ∞
the metrics δ2→2 and δ are equivalent on the space of (unsigned) graphexes with Dbounded marginals. Indeed, if W has bounded marginals, it is integrable, and if either
δ2→2 (Wn , W) → 0 or δ (Wn , W) → 0, then kWn k1 = ρ(Wn ) → ρ(W) = kWk1 .
This shows that we can assume that the sequences are (C, D)-bounded for some C,
which means they are (B, C, D)-bounded for B = 1.

***

Proposition 3.24. For any simple graph F with no isolated vertices and graphex
W,
E [inj(F, GT (W))] = T |V (F )| t(F, W).
If the marginals of W are bounded, then the right side is finite, with
Y
i )−2
t(F, W) ≤
kWk1 kDW kv(F
,
∞
i

where the product runs over the components of F and vi is the number of vertices
in Fi .

***

Theorem 4.1. Given a set of graphexes S, the following are equivalent:
(1) S is tight. In other words, for every ε > 0, there exist C and D such
that for every graphex W ∈ S, W = (W, S, I, Ω) with Ω = (Ω, F, µ), there
exists Ωε ⊆ Ω such that µ(Ωε ) ≤ ε and W0 = W|Ω\Ωε has kW0 k1 ≤ C,
kDW0 k∞ ≤ D.
(2) For every ε > 0, there exist C such that for every graphex W ∈ S, W =
(W, S, I, Ω), there exists Ωε ⊆ Ω such that µ(Ωε ) ≤ ε and W0 = W|Ω\Ωε has
kW0 k1 ≤ C.
(3) For every ε, there is a D and C such that for any W ∈ S, taking Ω≤D to be
the set of points with DW (x) ≤ D, µ(Ω \ Ω≤D ) ≤ ε, and kW|Ω≤D k1 ≤ C.
(4) For every T > 0, the set of random unlabeled finite graphs GT (W) with
W ∈ S is tight.
(5) There exists T > 0 such that the set of random unlabeled finite graphs
GT (W) with W ∈ S is tight.

***

Corollary 4.2. Let S be a set of graphexes.
(1) If there exists a C < ∞ such that kWk1 ≤ C for all W ∈ S, then S is tight.
(2) If S is tight and has uniformly bounded marginals, then there exist C, D < ∞
such that S is (C, D)-bounded.

***

Lemma 4.3. The probability that GT (W) has more than KT 2 kWk1 edges is at
most
T 2 kWk1 /2 + T 3 kDW k22
,
(K − 1/2)2 T 4 kWk21
and the probability that it has less than T 2 kWk1 /4 edges is at most
16(T 2 kWk1 /2 + T 3 kDW k22 )
T 4 kWk21

***

Remark 4.4. It will sometimes be useful to transform a graphex W over an arbitrary
σ-finite space Ω = (Ω, F, µ) into a graphex over an atomless space by mapping Ω
to the product space Ω × [0, 1] equipped with the measure µ × λ, with λ denoting
the Lebesgue measure, and mapping W to Φ(W) = Wφ , with φ : Ω × [0, 1] → Ω
denoting the coordinate projection onto Ω. It is easy to see that δ (W, Φ(W)) = 0,
which together with the triangle inequality implies that the map Φ does not change
distances between graphons. It is also easy to check that if S is a tight set of
graphexes, then the set of graphexes obtained by mapping each graphex W ∈ S to
the corresponding atomless graphex Φ(W) is tight as well.

***

Lemma 4.5. Given C, D, M ∈ (0, ∞), there exists a function f : [0, ∞)2 → [0, ∞)
such that f (x) → 0 as x → 0 and such that the following holds
(1) Let W be a graphex over (Ω, F, µ), and let µ
e be a second measure over (Ω, F)
f
such that µ − r ≤ µ
e ≤ µ. If W is obtained from W by replacing µ with µ
e
then
µ(DW > D + r) − r ≤ µ
e(DW
e > D) ≤ µ(DW > D)
for all D > 0.
(2) Let W1 and W2 be graphexes with bounded marginals, defined over the same
space (Ω, F, µ). Suppose that d2→2 (W1 , W2 ) < ε. Then
µ({|DW1 − DW2 | ≥ ε}) < ε2 .
W1 and f
W2 be graphexes with bounded marginals, defined over
(3) Let f
(Ω1 , F1 , µ
e1 ) and (Ω2 , F2 , µ
e2 ). If δ2→2 (f
W1 , f
W2 ) < ε and D > ε, then
2
2
µ
e1 ({DW
e2 ({DW
e1 ({DW
e 1 > D + ε}) − ε ≤ µ
e 2 > D}) ≤ µ
e 1 > D − ε}) + ε .

(4) For i = 1, 2, let Wi be graphexes defined over (Ωi , Fi , µi ), and let Wi,≤D
be the restriction of Wi to the subset {DWi ≤ D} of Ωi . Assume that
ε + ε2 < D, µ1 ({DW1 > D}) + µ2 ({DW2 > D}) ≤ M , kW2,≤D k1 ≤ C,
δ (W1 , W2 ) ≤ ε, and µ2 ({D − ε − ε2 < DW2 ≤ D + ε + ε2 }) ≤ δ. Then
δ2→2 (W1,≤D , W2,≤D ) ≤ f (ε, δ).

***

Proposition 4.6. Given a sequence of graphexes Wn and a graphex W over the
σ-finite measure spaces Ωn = (Ωn , Fn , µn ) and Ω = (Ω, F, µ), respectively, define
Wn,≤D and W≤D as above. Then the following are equivalent.
(1) For all D > 0 such that µ({DW = D}) = 0, we have δ2→2 (Wn,≤D , W≤D ) →
0 and µn (Ωn,>D ) → µ(Ω>D ).
(2) The sequence is tight, and for all D > 0 such that µ({DW = D}) = 0, we
have δ2→2 (Wn,≤D , W≤D ) → 0.
(3) For every ε > 0 and n ∈ N there exist subsets Ωn,ε ⊆ Ωn and a subset Ωε ⊆ Ω
with µn (Ωn \ Ωn,ε ) ≤ ε and µ(Ω \ Ωε ) ≤ ε, such that δ2→2 (W0n , W0 ) → 0,
where W0n = (Wn )|Ωn ,ε and W0 = W|Ωε .
(4) δ (Wn , W) → 0.

***

Proposition 4.7. Given two graphexes W1 , W2 , let Wi,≤D be the graphex Wi
restricted to Ωi,≤D = {x ∈ Ωi : DWi (x) ≤ D}. Then the following are equivalent.
(1) For any D > 0,
µ1 (Ω1 \ Ω1,≤D ) = µ2 (Ω2 \ Ω2,≤D ) and δ2→2 (W1,≤D , W2,≤D ) = 0.

(2) For any D > 0, δ2→2 (W1,≤D , W2,≤D ) = 0.
(3) For any ε > 0, there exist subsets Ω1,ε ⊆ Ω1 , Ω2,ε ⊆ Ω2 with µi (Ωi \Ωi,ε ) ≤ ε,
such that if W0i is the restriction to Ωi \ Ωi,ε , then δ2→2 (W01 , W02 ) ≤ ε.
(4) δ (W1 , W2 ) = 0.

***

Remark 4.8. It is not a priori clear how to generalize the notion of tightness
to signed graphexes, even if we restrict ourselves to the case where the graphon
parts are uniformly bounded, for example by taking graphons that take values in
[−1, 1]. Indeed, recalling Lemma 3.12 and the role it played in showing that δ is
finite for signed graphexes with bounded graphon part, one might want to modify
Definition 2.20 for such graphexes by replacing the notion of D-bounded marginals
by that of D-bounded absolute marginals, since this would, in particular, guarantee
that a finite set of signed graphexes with graphon parts in [−1, 1] is tight. It would
also make the generalization of several of our results straightforward, since this
definition just reduces the notion of tightness of a set of graphexes S to the set of
graphexes S 0 = {|W| : W ∈ S}.
The following example shows that this straightforward generalization of
Definition 2.20 to signed graphexes does not give a characterization of precompact
sets with respect to the metric δ , as it did for unsigned graphexes; see Theorem 2.21
.
Let Wn be equal to n−3/4 on [0, 1) × [1, n + 1) ∪ [1, n + 1) × [0, 1), equal to −n−3/4
on [0, 1) × [n + 1, 2n + 2) ∪ [n + 1, 2n + 1) × [0, 1), and zero everywhere else on
R2+ . Define Wn to be the graphex with graphon part Wn and zero star and dust
part. Then DWn is equal to n−3/4 on [1, n + 1), equal to −n−3/4 on [n + 1, 2n + 1),
−1/2
and 0 everywhere
and
√ −1/2else. Finally, ρ(Wn ) = 0 for all n. Since kWn k2 = 2n
kDWn k2 = 2n
, Wn tends to the zero graphex in the metric δ2→2 and hence
also in δ . But kWn k1 = kW k1 = 4n1/4 → ∞, a fact which can’t be changed by
removing just a part of measure ε from the underlying space, R+ . This shows
that with the obvious generalization of Definition 2.20 to signed graphexes not all
sequences of signed graphexes that are convergent in δ2→2 or δ are tight.
We therefore believe that a complete theory of signed graphexes, even in the simplified
case where all graphons take values in [−1, 1], requires either a modification of the
metric, or modification of the notion of tightness. We leave this problem as an open
research problem.

***

Definition 5.1. Given two subspace partitions P = (ΩP , P) and Q = (ΩQ , Q),
we say that P refines Q if ΩQ ⊆ ΩP and P is a refinement of Q ∪ {ΩP \ ΩQ }.

***

Definition 5.2. Given a signed graphex W = (W, S, I, Ω) and a finite subspace
partition P = (ΩP , P), take WP to be the signed graphex WP = (WP , SP , IP , Ω)
defined by
Z
Z
1
IP =
W (x, y) dµ(x) dµ(y) +
S(x) dµ(x) + I,
2 (Ω\ΩP )×(Ω\ΩP )
Ω\ΩP
!
Z
Z
1
SP (x) =
S(x) +
W (x, y) dµ(y) dµ(x) if x ∈ Pi
µ(Pi ) Pi
Ω\ΩP
for some i ∈ {1, . . . , k}, and 0 everywhere else, and
Z
1
WP (x, y) =
W (x0 , y 0 ) dµ(x0 ) dµ(y 0 )
µ(Pi )µ(Pj ) Pi ×Pj

if

for some i, j ∈ {1, . . . , k} and WP (x, y) = 0 everywhere else.

(x, y) ∈ Pi × Pj

***

Theorem 5.3. For any B, C, D < ∞, and ε > 0, there exists an M (ε) and N (ε)
such that for any signed graphex W that is (B, C, D)-bounded there exists a partition
(ΩP , P) with P = {P1 , . . . , Pm }, m ≤ M (ε), and µ(ΩP ) ≤ N (ε) such that
d (W, WP ) ≤ ε.

We can take
M (ε) = 2(2BC+CD)/ε

2

and

N (ε) = (4C 3 D + 8BC 2 D)/ε4 .

Given any finite subspace partition Q = (ΩQ , Q), we can require the subspace
partition P = (ΩP , P) to be a refinement of Q. In this case, the bound on the
number of parts is |Q|M (ε) and the bound on µ(ΩP ) is µ(ΩQ ) + N (ε).

***

Remark 5.4. With the help of Proposition 3.19 , Theorem 5.3 can immediately be
transformed into a similar statement for the kernel distance d2→2 (W, WP ), provided
8
N (ε) and M (ε) are replaced by bounds of the form M (ε) = 2c/ε and N (ε) = d/ε16
where c and d are constants depending on B, C and D.

***
Lemma 5.5. Let W1 , W2 be two graphexes on the same space Ω, and let P be a
finite subspace partition of Ω. Then
kW1,P − W2,P k2→2 ≤ kW1 − W2 k2→2

and
kDW1,P − DW2,P k2 ≤ kDW1 − DW2 k2 .

***

Corollary 5.6. Suppose that W is a graphex, and that U is a step graphex over
the same space as W. If P = (ΩP , P) is a finite subspace partition such that U is
constant on each part of P and zero outside ΩP , then
kWP − W k2→2 ≤ 2kU − W k2→2

and
kDWP − DW k2 ≤ 2kDU − DW k2 .

***

Theorem 5.7. Given B, C, D, and ε > 0, there exists ρ0 = ρ0 (ε, B, C, D) > 0
and N0 = N0 (ε, B, C, D) such that for any ρ < ρ0 , any m ≥ N0 /ρ, and any
(B, C, D)-bounded signed graphex W on an atomless space with infinite measure,
there exists a subspace partition P = (ΩP , P) with exactly m parts of size ρ such
that d2→2 (W, WP ) ≤ ε. If P0 = (ΩP0 , P0 ) is an arbitrary finite subspace partition,
we can require P to refine P0 , as long as each part of P0 is divisible by ρ (and
increasing the bound on N0 (ε) and decreasing ρ0 appropriately depending on |P0 |
and µ(ΩP0 )).

***

Lemma 5.8. Let S be a set of signed graphexes over atomless spaces of infinite
measure such that the following condition holds:
(a) For every ε > 0, there exists B, C, D such that for any W = (W, S, I, (Ω, F, µ)) ∈
S, taking Ω≤D to be the set of points with D|W| (x) ≤ D, we have that µ(Ω \
Ω≤D ) ≤ ε, kW |Ω≤D k∞ ≤ B, and kW|Ω≤D k1 ≤ C.
Then there exist strictly increasing sequences of integers ak ≥ 2k and bk ≥ k and
sequences of positive real numbers Bk , Ck , and Dk such that the following holds. For
any graphex W ∈ S, W = (W, S, I, Ω) with Ω = (Ω, F, µ), there exists a sequence of
subsets Pk,0 ⊆ Ω and subspace partitions Pk = (ΩPk , Pk ), Pk = {Pk,1 , . . . , Pk,mk }
with mk = 2ak +bk , such that for all k, ΩPk is disjoint from Pk,0 and
(1) Pk+1,0 ⊆ Pk,0 and µ(Pk,0 ) = 2−2k ,
(2) Wk = W|Ω\Pk,0 is (Bk , Ck , Dk )-bounded,
(3) Pk+1 refines Pk ,
(4) Pk,i for i ≥ 1 has measure 2−ak , and
(5) d2→2 (Wk , (Wk )Pk ) ≤ 2−k .

***

Lemma 5.9. Every tight sequence of graphexes has a subsequence that is δ convergent. More generally, every sequence of signed graphexes obeying the condition
(a) from Lemma 5.8 has a δ -convergent subsequence. If condition (a) holds with
one or more of the constants B, C, D not depending on ε, then the subsequential
limit inherits the corresponding bound.

***
Claim. Suppose that W = (W, S, I, Ω) is a signed S
graphex, P = (ΩP , P) is a
finite subspace partition, and P0 ⊆ P. Let Ω0 = P ∈P0 P , P 0 = P \ P0 , and
P 0 = (Ω0P 0 , P 0 ), where Ω0P 0 = ΩP \ Ω0 . Then (WP )|Ω0 = (W|Ω0 )P 0 .

***

Remark 5.10. It is not hard to see that a sequence of signed graphexes Wn =
(Wn , Sn , In , Ωn ) with kWn k∞ ≤ B and kWn k1 ≤ C obeys the condition (a) from
Lemma 5.8 . If B ≤ 1, this follows by applying Corollary 4.2 (1) to the sequence
|Wn |, and for B > 1 it follows by applying Corollary 4.2 (1) to the sequence
(|Wn |/B, |Sn |/B, |In |/B, Ωn ). Choosing a convergent subsequence, it is clear from
the last proof that the limiting graphex W = (W, S, I, Ω) must obey the bound
kW k∞ ≤ B. The statement from Remark 2.22 therefore is a direct consequence of
Lemma 5.9 .

***

Lemma 6.1. Let F be a simple, connected graph with m edges and n ≥ 3 vertices,
and let C, D < ∞. Suppose that W1 and W2 are graphexes on the same underlying
space Ω, with kWi k1 ≤ C and kDWi k∞ ≤ D for i = 1, 2, and let ε = max{kW1 −
W2 k2→2 , kDW1 −W2 k2 }. Then
e n−3 ,
|t(F, W1 ) − t(F, W2 )| ≤ mεCD
√
e = max{C, CD}.
where C

***
Corollary 6.2. Suppose Wn , W have uniformly bounded marginals. If
δ2→2 (Wn , W) → 0,

then for any finite graph F with no isolated vertices, t(F, Wn ) converges to t(F, W).

***

Theorem 6.3. Assume that the marginals of Wn and W are bounded by some finite
constant D. Then the following are equivalent:
(1) GT (Wn ) → GT (W) in distribution for every T .
(2) GT (Wn ) → GT (W) in distribution for some T .
(3) For every graph F with no isolated vertices, t(F, Wn ) → t(F, W).
(4) For every connected graph F , t(F, Wn ) → t(F, W).

***

Definition 6.4. Suppose we have a connected multigraph F , and signed graphexes
We assigned to each edge e ∈ E(F ) (refer to this vector of graphexes as WF ), each
with the same feature space Ω. Let V≥2 be the set of vertices with degree at least 2.
If V≥2 is nonempty (i.e., F does not consist of a single edge), then we define
Z
Y
t(F, WF ) =
dzV≥2
W{v,w} (zv , zw )
V≥2

Ω

{v,w}∈E(F (V≥2 ))

·

Y

Y

DW{v,w} (zv ).

v∈V≥2 w∈V \V≥2 :
{v,w}∈E(F )

If F consists of just a single edge f , then
t(F, WF ) = ρ(Wf ),

with ρ(Wf ) as in (??). Note that for signed graphexes t(F, WF ) is in general only
well defined if the integrals are absolutely convergent, a condition which can, e.g.,
abs
be guaranteed by requiring that t(F, Wabs
F ) < ∞, where WF is obtained from WF
by replacing the graphexes Wf by |Wf |.

***

Definition 6.5. Suppose we have a connected multigraph F with a labeled vertex
v0 , more than one edge, and signed graphexes We assigned to each edge as before. Let
0
x ∈ Ω, and define zv0 = x. Take, furthermore, V≥2
= V≥2 \{v0 } and Ve≥2 = V≥2 ∪{v0 }.
Then we define tx (F, WF ) to be
Z
Y
Y
Y
0
DW{v,w} (zv ).
dz
W
(z
,
z
)
v
w
V
{v,w}
0
≥2
V
Ω

≥2

e≥2 ))
{v,w}∈E(F (V

v∈V≥2 w∈V \(V
e≥2 ):
{v,w}∈E(F )

If F consists of just a single edge f adjacent to v0 , then we set tx (F, W) = DW (x).
Again, for signed graphexes, this is in general only well defined if the integrals are
absolutely convergent.

***

Lemma 6.6. Suppose F is a connected multigraph with no loops and a labeled
vertex v0 , T is a spanning tree, and We is a signed graphex corresponding to each
edge e, each with the same feature space Ω. Let f ∈ T be an edge adjacent to v0 ,
and x ∈ Ω. Then
Y
Y
|tx (F, WF )| ≤ D|Wf | (x)
kD|We | k∞
kWe k∞ .
e∈T \f

e∈E(F )\T

***

Lemma 6.7. Suppose F is a connected multigraph with no loops, and we have a
signed graphex We corresponding to each edge e ∈ F . Let T be any spanning tree in
F , and f ∈ T . Then
Y
Y
|t(F, WF )| ≤ kWf k1
kD|We | k∞
kWe k∞ .
e∈T \f

e∈E(F )\T

***

Remark 6.8. It is instructive to note that the bound in Lemma 6.1 can be tightened
to give the constant
e = max max{kWi k2 , kDW k2 }
C
i
i
√
e = max{C, CD}. To see this, we first note that near the
instead of the constant C
√
end of the proof, we bounded kDWvu0 k2 by CD, even though it is possible that
the first term is finite while the second is infinite. In a similar way, bounding the
integral representing t(Fu0 , WF,f ) and t(Fv0 , WF,f ) with the help of Lemma 6.7 is
suboptimal. Indeed, the multi-graph Fv0 always contains at least one double edge, or
contain at least one edge uvi and its twin uvi0 , with both vi and vi0 having degree one.
In the first case, Lemma 6.7 can be improved to extract a factor kWf k2 instead
of a factor kWf k1 , in the second it can be improved to extract a factor kDWf k2 .
Inserted into the proof of Lemma 6.1 , this gives the claimed improvement.

***

Remark 6.9. As the reader can easily verify, the above proof immediately generalizes
to signed graphexes, showing that Lemma 6.1 holds for (B, C, D) bounded graphexes,
provided we include a factor of B m−(n−1) on the right side. As a consequence,
Corollary 6.2 holds for sequences of (B, C, D)-bounded graphexes that converge in
the kernel distance δ2→2 .

***

Theorem 6.10. Let G and Gn , for n ≥ 1, be random finite graphs with no isolated
vertices, and let X and Xn , for n ≥ 1, be the random variables that correspond to
the number of vertices in G and Gn , respectively. If, for every t > 0, E[etX ] and
E[etXn ] are finite and uniformly bounded, then the following are equivalent:
(1) For any graph G, the probability that Gn is isomorphic to G converges to
the probability that G is isomorphic to G.
(2) For every graph F , E[inj(F, Gn )] → E[inj(F, G)].
(3) For every graph F with no isolated vertices, E[inj(F, Gn )] → E[inj(F, G)].

***

Lemma 6.11. Suppose we have two random finite graphs with no isolated vertices, G
and G0 . Suppose that for every finite graph F with no isolated vertices, E[inj(F, G)] =
E[inj(F, G0 )]. Let X be the random variable that gives the number of vertices in G,
and suppose that for every t, E[etX ] is finite. Then E[inj(F, G)] and E[inj(F, G0 )]
are equal for every finite graph F .

***

Lemma 6.12. Suppose we have two random finite graphs, G and G0 . Suppose
that for every finite graph F , E[inj(F, G)] = E[inj(F, G0 )]. Let X be the random
variable that gives the number of vertices in G, and suppose that for some ε > 0,
E[(2 + ε)X ] is finite. Then G and G0 give rise to the same distribution on graphs
(up to isomorphism).

***

Lemma 6.13. Given t > 0, let t0 = 2t + log 4. Then the following holds for any
positive integer n and any graph G on n vertices with no isolated vertices. Suppose
we randomly color the vertices red and blue, and let X be the number of vertices
that are colored red, and have at least one blue neighbor. Then
0

E[et X ] ≥ etn .

***

Lemma 6.14. For any T, t, C, D ∈ R+ , there exists a finite B such that the
following holds. Suppose we have a graphex W, with kDW k∞ ≤ D and kWk1 ≤ C.
Let X be the number of vertices (that are not isolated) of GT (W). Then E[etX ] ≤ B.

***

Theorem 6.15. Given two graphexes W, W0 with bounded marginals, the following
are equivalent:
(1) GT (W) and GT (W0 ) have the same distribution for every T .
(2) GT (W) and GT (W0 ) have the same distribution for some T .
(3) For every graph F with no isolated vertices, t(F, W) = t(F, W0 ).
(4) For every connected graph F , t(F, W) = t(F, W0 ).

***
Theorem 6.16. Suppose Wn and W have uniformly bounded marginals, and
δ2→2 (Wn , W) → 0. Then Wn is GP-convergent to W.

***
Theorem 6.17. Suppose that graphexes W and (Wn )∞
n=1 have the property that
δ (Wn , W) → 0. Then Wn is GP-convergent to W.

***
Theorem 7.1. For every graphex W and ε > 0,
lim P[δ (W(GT (W), 1/T ), W) > ε] = 0.

T →∞

For a set of graphexes that is tight, the convergence is uniform.

***

Remark 7.2. The above theorem only claims convergence in probability. However,
once we establish equivalence of GP-convergence and convergence in the weak
kernel norm, the results of [18] imply convergence with probability one (since there
convergence with probability one is proved for GP-convergence). Nevertheless, to
establish the equivalence, all we need is convergence in probability, so this is all we
will prove here.

***

Theorem 7.3. Suppose W1 , W2 are two (C, D)-bounded graphexes on the same
space Ω, and suppose that d2→2 (W1 , W2 ) ≤ c for some 0 < c < 1. Then there exists
a T0 (depending only on c, C, and D) such that for any T > T0 , there exists a
coupling of the random graphs GT (W1 ) and GT (W2 ) so that
h

i
√
3
P δ2→2 (W(GT (W1 ), 1/T ), W(GT (W2 ), 1/T )) > min (31cC)1/4 , 2c3/4 , 3c < c.

***

Lemma 7.4. Let W = (W, S, I, Ω) be a (C, D)-bounded graphex, and T > 1/D.
e T (W) consist of only those
Let GT (W) be the usual sample at time T , and let G
edges which come from I or S. Then
"

1/4 #
2CD
1
e T (W), 1/T )k2→2 > √
P kW (G
<√ .
T
T

***

Lemma 7.5. Suppose H is a weighted graph on N with weights Hi,j ∈ [0, 1], and
Hi,i = 0. Suppose that G is generated by taking an edge betweenP
i and j with
probability Hi,j , independently for every pair of vertices. Suppose that i,j Hi,j ≤ E
P
and i,j,k Hi,j Hj,k ≤ F where the sum goes over pairwise distinct vertices. Let
0 < ρ. Then
√
P[kW(G, ρ) − W(H, ρ)k2→2 > ρ7/8 (E + 2F )1/4 ] < ρ.

***

Lemma 7.6. For every ε, C, and D, there exist M , N , and ρ such that the following
holds. For every (C, D)-bounded graphex W, there exists a (C, D)-bounded graphex
Wε = (Wε , 0, 0, Ωε ), where Ωε = (Ωε , Fε , µε ) and µε (Ωε ) ≤ N , and furthermore
the graphon Wε is a step function with at most M steps, with each part having size
equal to ρ, and δ2→2 (W, Wε ) ≤ ε.

***

Remark 7.7. Using the ideas of the previous proof, it is not hard to see that
e D)
fQ , 0, 0, Ω
in distribution, the process generated from the graphex f
WQ = ( W
constructed in Remark 2.3 (3) converges to the one generated from W. Indeed, we
claim that
δ (f
WQ , W) → 0
as
Q → ∞.
To see this, fix ε > 0 and choose D in such a way that the set Ω>D = {DW > D}
e ≤D = Ω≤D ∪ {∞} = Ω
e \ Ω>D .
has measure at most ε2 . Let Ω≤D = Ω \ Ω>D and Ω
f
Setting f
WQ,≤D = (f
WQ )|Ω\Ω
e >D and W≤D = W|Ω\Ω>D and defining W≤D as the
e ≤D , we will want to show that for Q large enough,
trivial extension of W≤D to Ω
f
f
d2→2 (W≤D , WQ,≤D ) ≤ ε, since this implies that δ2→2 (W≤D , f
WQ,≤D ) ≤ ε and hence
fQ , W) ≤ ε. But this follows by essentially the same argument as the one in the
δ  (W
previous proof; all that is needed is that by Proposition 2.4 , f
W≤D is (C, D)-bounded
for some C < ∞.

***

Lemma 7.8. For every N0 , ε, and δ, there exists n0 such that the following holds.
For any weighted graph H on n ≥ n0 vertices with weights in [0, 1], and any N ≤ N0 ,
the probability that δ2→2 (W(H, N/n), W(G(H), N/n)) > ε is at most δ.

***

Theorem 7.9. Given a pair of graphexes W, W0 , we have δ (W, W0 ) = 0 if and
only if for every T > 0, GT (W) and GT (W0 ) have the same distribution.

***

Theorem 8.1. Let W1 = (W1 , S1 , I1 , Ω1 ) and W2 = (W2 , S2 , I2 , Ω2 ) be graphexes,
where Ωi = (Ωi , Fi , µi ) are σ-finite spaces. Suppose δ (W1 , W2 ) = 0. Then there
exists a third graphex W = (W, S, I, Ω) over a σ-finite measure space Ω = (Ω, F, µ)
and measure preserving maps φi : dsupp Wi → Ω such that Wi |φ−1 (Ω) = Wφi (and
Wi , Si = 0 everywhere else) for i = 1, 2.

***

Theorem 8.2. Let W1 = (W1 , S1 , I1 , Ω1 ) and W2 = (W2 , S2 , I2 , Ω2 ) be graphexes,
where Ωi = (Ωi , Fi , µi ) are σ-finite Borel spaces. Suppose further that DWi > 0
everywhere for i = 1, 2, and δ (W1 , W2 ) = 0. Then µ1 (Ω1 ) = µ2 (Ω2 ), I1 = I2 , and
there exists a coupling of Ω1 and Ω2 , that is, a measure ν on (Ω1 × Ω2 , F1 × F2 )
with marginals µ1 and µ2 , such that if πi : Ω1 × Ω2 → Ωi is the projection map, then
W1π1 = W2π2 ν-almost-everywhere, and S1π1 = S2π2 ν-almost-everywhere.

***

Remark 8.3. Throughout this paper, we have considered graphexes where all three
parts are non-negative. While this makes sense when considering graphexes as
generators of a graphex process, from an analytical point of view, it is less natural.
Indeed, it is easy to define the kernel and weak kernel distance for graphexes where
the three parts take values in R. Taking, e.g., the kernel distance d2→2 defined
1
in (??), all we need to do
R is replace the RL norms in the third part by a signed
“edge density” ρ(Wi ) = W dµ × dµ + 2 S dµ + 2I, and then use the third root
of |ρ(W1 ) − ρ(W2 )| instead of the third root of |kW1 k1 − kW2 k|. In particular in
view of the just discussed results from [3] and [17], we conjecture that Theorem 8.2
holds for signed graphexes as well, provided the condition DWi > 0 is replaced by
the condition D|Wi | > 0, where |Wi | is obtained from Wi by replacing all three
components of Wi by their absolute values. We leave the proof of this conjecture as
an open problem.

***

Remark 8.4. Section ?? does not use nonnegativity in any essential way, and should
easily generalizable to signed graphexes. This should give a relatively straightforward
proof of the analogue of Theorem 8.1 for graphons of cut distance zero, and also
allow for the more general setting of signed graphexes, once the above conjectured
generalization of Theorem 8.2 is established. Again we leave this as an open
problem.

***
Lemma 8.5. For any c,
(1) limε→0 νε (Ω1,>c × Ω2,>c ) = µi (Ωi,>c ) for i = 1, 2 (regardless of the choice
of νε ), and
(2) µ1 (Ω1,>c ) = µ2 (Ω2,>c ).

***

Lemma 8.6. For any n ≥ 1, there exists a measure νn on Ω1,>1/n × Ω2,>1/n such
that the following hold:
(1) νn is a coupling of Ω1,>1/n and Ω2,>1/n ,
(2) νn+1 |Ω1,>1/n ×Ω2,>1/n = νn ,
(3) W1π1 and W2π2 are equal when restricted to (Ω1,>1/n × Ω2,>1/n )2 , νn × νn almost everywhere, and
(4) DWπ1 1 and DWπ2 2 are equal when restricted to Ω1,>1/n × Ω2,>1/n , νn -almost
everywhere.

***

Corollary 8.7. Let W = (W, S, I, Ω) and W0 = (W 0 , S 0 , I 0 , Ω0 ) be graphexes that
are equivalent, and suppose that DW , DW0 > 0 everywhere. Then there exist a
positive integer n and a chain of graphexes Wi = (Wi , Si , Ii , Ωi ) for i = 0, . . . , n,
with DWi > 0 everywhere for each i = 0, . . . , n, W0 = W, Wn = W0 , and for each
i ≥ 1, either Wi−1 = Wφi i almost everywhere for some measure preserving map φi
i
from Ωi−1 to Ωi , or Wi = Wφi−1
almost everywhere for some φi from Ωi to Ωi−1 .
In fact, we can take n = 4.

***

Lemma 8.8. Suppose that (Ω, F, µ) and (Ω0 , F 0 , µ0 ) are σ-finite measure spaces,
W : Ω × Ω0 → R is measurable, and for all x ∈ Ω, the function W (x, ·) is integrable.
Let ψW : Ω → L1 (Ω, F, µ) be the map x 7→ W (x, ·). Then we can find a separable
closed subspace B of L1 (Ω0 , F 0 , µ0 ) such that ψW (x) ∈ B for all x ∈ Ω.

***

Lemma 8.9. Suppose (Ω, F, µ) and (Ω0 , F 0 , µ0 ) are σ-finite measure spaces, W : Ω×
Ω0 → R is F × F 0 -measurable, and that for all x ∈ Ω, the function W (x, ·) is
integrable. Then the map ψW : Ω → L1 (Ω0 , F 0 , µ0 ) with x 7→ W (x, ·) is measurable
with respect to the standard Borel σ-algebra on L1 (Ω, F, µ). .

***

Lemma 8.10. Let (Ω, F, µ) be any σ-finite measure space, and B ⊆ L1 (Ω, F, µ) a
closed separable subspace. Then there exists a measurable evaluation map
Φ: B × Ω → R

such that for any f ∈ B, for almost every x ∈ Ω, f (x) = Φ(f, x) (note that f (x) is
only defined almost everywhere). In particular, if L1 (Ω, F, µ) is separable, we can
take B = L1 (Ω, F, µ).

***

Lemma 8.11. Suppose that (Ω, F, µ) and (Ω0 , F 0 , µ0 ) are σ-finite measure spaces,
W : Ω × Ω0 → R is measurable, and for all x ∈ Ω and x0 ∈ Ω0 , both W (x, ·) and
W (·, x0 ) are integrable. Let ψW be the map Ω → L1 (Ω0 , F 0 , µ0 ) with x 7→ W (x, ·),
0
and ψW
be the map Ω0 → L1 (Ω, F, µ) with y 7→ W (·, y). Further, let G be the Borel
σ-algebra on L1 (Ω, F, µ), and let
−1

0
FW
= ψ 0 W (G).

0
Then for almost every x ∈ Ω, ψW (x) ∈ L1 (Ω0 , FW
, µ0 ).

***

Proposition 8.12. The space ΩW as defined above is a complete, separable metric
e F,
e µ
e), and µW has full support in ΩW .
space, with the metric induced by L1 (Ω,
e FeW , µ
e FeW , µ
Furthermore, ΩW ⊆ L1 (Ω,
e) ⊆ L1 (Ω,
e). Finally, after modifying W and
S on a set of measure zero ψW becomes an everywhere defined, measure-preserving
−1
map from (Ω, F, µ) to (ΩW , GW , µW ), and we furthermore have ψW
(GW ) = FW .

***

Lemma 8.13. Let ΩW and µW be as defined above, and let GW be the Borel σalgebra over ΩW . If W is locally finite, W (x, ·) is integrable for all x ∈ Ω, and
µ(Ω \ dsupp W) < ∞, then (ΩW , GW , µW ) is σ-finite.

***

Remark 8.14. Note that the condition µ(Ω \ dsupp W) < ∞ is necessary, since
otherwise the point {(0, 0)} becomes an atom with infinite measure.

***

Lemma 8.15. For i = 1, 2, let Wi = (Wi , Si , Ii , Ωi ) be graphexes with Ωi =
(Ω1 , Fi , µi ) and µi (Ωi \dsupp Wi ) = 0. Suppose that there exists a measure-preserving
e1 → Ω
e2
map φ : Ω1 → Ω2 such that W1 = Wφ2 almost everywhere. Extend φ to φe : Ω
1 e
∗
1 e
e
e
by φ(Ω1,∞ ) = Ω2,∞ . Then the map φ : L (Ω2 ) → L (Ω1 ) defined by f 7→ f ◦ φe
restricts to a map ΩW2 → ΩW1 , which is an isometric measure-preserving bijection
∗
between (ΩW2 , GW2 , µW2 ) and (ΩW1 , GW1 , µW1 ), and c
W2 = c
Wφ1 almost everywhere,
for any choices of c
W1 and c
W2 .

***

Theorem 9.1. Given a set of integrable graphexes S, the following are equivalent.
(1) S is uniformly integrable.
(2) The graphexes in S have uniformly bounded k · k1 -norms, and for every
ε > 0, there exists a D such that for all W ∈ S, kWk1 − kW≤D k1 < ε.
(3) For any T > 0, the random variables E(GT (W)) with W ∈ S are uniformly
integrable.
(4) There exists T > 0 such that the random variables E(GT (W)) with W ∈ S
are uniformly integrable.

***

Lemma 9.2. Suppose that a set of graphexes consisting only of graphons is uniformly
tail regular. Then the set is uniformly integrable.

***
Lemma 9.3. Given a set of graphons S, the following are equivalent:
(1) The set of graphons is uniformly tail regular.
(2) The set of graphons has a uniform bound on their k · k1 -norm, and for every
ε, there exists a δ such that kW k1 − kW |Ω>δ k1 ≤ ε.
(3) The set of graphons has a uniform bound on their k · k1 -norm, and for every
ε, there exists a δ such that kDW 1DW ≤δ k1 ≤ ε.

***

Corollary 9.4. Given a set of graphons S, suppose that we replace each graphon
with a pullback. Let S 0 be the new set. Then S 0 is uniformly tail regular if and only
if S is.

***

Lemma 9.5. Suppose that a sequence of integrable graphons Wn converge to a
graphon W in the cut metric. Then for any D > 0 such that µ(DW = D) = 0, the
graphons Wn,≤D converge to W≤D in the cut metric.

***

Lemma 9.6. Suppose that a sequence of integrable graphons Wn have uniformly
bounded marginals, and converge to a (necessarily integrable) graphon W in the cut
metric. Then W has the same bound on its marginals, and δ2→2 (Wn , W) → 0.

***

Lemma 9.7. Suppose that δ (W, W0 ) = 0 for two integrable graphexes, and suppose
that W = (W, 0, 0, Ω). Then W0 = (W 0 , 0, 0, Ω0 ) and δ (W, W 0 ) = 0.

***

Lemma A.1. Let ψ(x) = 1 − e−x . Then the following hold, with both side of the
various identities being possibly infinite:
(1) E[η(S)] = kSk1 and E[η 2 (W )] = kW k1 ,
(2) E[ψ(η(S))] = ψ(kψ(S)k1 ), and
(3) E[(η 2 (W ))2 ] = kW k21 + 4kW ◦ W k2 + 2kW 2 k1 .

***

Proposition A.2. Let S : Ω → R+ be measurable, and let W : Ω × Ω → [0, 1] be
symmetric and measurable. Then the following hold:
(1) η(S) < ∞ a.s. if and only if k min{S, 1}k1 < ∞, and
(2) η 2 (W ) < ∞ a.s. if and only if there exists a finite D > 0 such that the
following three conditions hold:
(a) DW < ∞ almost surely,
(b) µ({x ∈ Ω : DW (x) > D}) < ∞, and
(c) kW |{x∈Ω:DW (x)≤D} k1 < ∞.

***

Proposition B.1. For any graphex W = (W, S, I, Ω), there exists a graphex f
W=
e on an atomless space Ω
e such that on the diagonal, W
f , S,
e I,
e Ω)
f is {0, 1} valued
(W
and such that Ge∞ (f
W) and GeT (f
W) are equivalent to Ge∞ (W) and GeT (W), respectively.

***

Theorem B.2. Let W1 and W2 be graphexes with special subsets as above. Then
GeT (W1 ) and GeT (W2 ) have the same distribution for all T ∈ R+ if and only if there
exists a third graphex with special subset W such that W1 and W2 are pullbacks of
W.

