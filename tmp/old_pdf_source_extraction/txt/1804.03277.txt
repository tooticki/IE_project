***
Definition 2.1. A graphex W = (W, S, I, â„¦) consists of a Ïƒ-finite measure space
â„¦ = (â„¦, F, Âµ), a symmetric measurable function W : â„¦ Ã— â„¦ â†’ [0, 1], a measurable
function S : â„¦ â†’ R+ , and a nonnegative real number I such that the following local
finiteness conditions hold:
(1) W (Â·, x) is integrable for almost all x âˆˆ â„¦, and
(2) there exists a measurable subset â„¦0 âŠ† â„¦ such that Âµ(â„¦ \ â„¦0 ) < âˆ and W|â„¦0
is integrable.
The quadruple will be called a signed graphex if instead of taking values in [0, 1] and
R+ , W , S and I take values in R. The graphex W = (W, S, I, â„¦) is called integrable
if
Z
Z
kWk1 :=
|W (x, y)| dÂµ(x) dÂµ(y) + 2
|S(x)| dÂµ(x) + 2|I| < âˆ,
â„¦Ã—â„¦

â„¦

and the restriction W|â„¦0 of W to â„¦0 âŠ† â„¦ is defined as the quadruple W0 =
(W 0 , S 0 , I 0 , â„¦0 ) with â„¦0 = (â„¦0 , F 0 , Âµ0 ), where F 0 = {A âˆˆ F : A âŠ† â„¦0 }, Âµ0 is the
restriction of Âµ to F 0 , S 0 is the restriction of S to â„¦0 , and W 0 is the restriction of
W to â„¦0 Ã— â„¦0 .

***
Definition 2.2. Let W be a graphex, let (GT (W))T â‰¥0 be the random family of
graphs defined above, and let Î¾[W] be the random adjacency measure Î¾Gâˆ (W) . We
call the stochastic process (GT (W))T â‰¥0 the graphex process generated by W, and
the adjacency measure Î¾[W] the adjacency measure generated by W. We say two
graphexes are equivalent, if the graphex processes generated by these graphons are
equal in law.

***

Remark 2.3. (1) Following [4], we defined a graphex process as a stochastic process
taking values in a space of graphs with labels in R+ . Alternatively, one might want
to define a graphex process as a process taking values in the space of unlabeled
graphs without isolated vertices. In our current context, this would correspond to
ignoring the time labels of the graphs in GT (W), leading to a graph which we denote
by GT (W). When it is important to distinguish them, we will refer to the process
(GT (W))T â‰¥0 as the unlabeled graphex process corresponding to W, and to the
process (GT (W))T â‰¥0 as the labeled graphex process corresponding to W. Note that
it is easy to recover GT (W) from GT (W): just assign i.i.d. labels chosen uniformly
at random in [0, T ] to all vertices. A related observation is the fact that GT (W) can
be generated by first choosing (xi )iâ‰¥1 according to a Poisson process with intensity
T Âµ in â„¦, then connecting i and j with probability W (xi , xj ), then adding a star
whose number of leaves are chosen as a Poisson random variable with mean T S(xi )
to each point of the process (xi )iâ‰¥1 , and finally adding independent edges with rate
IT 2 . Forgetting the labels then gives us GT (W). Relabeling each vertex in the
resulting graph independently by a uniform t âˆˆ [0, T ], we obtain GT (W).
(2) It is sometimes convenient to assign a feature value to the endpoints of the
isolated edges generated from the dust part I in the graphex, as well as to the leaves
of the stars generated using the function S. For our purpose, we will say that these
vertices have the feature label âˆ, and we will extend the marginal DW to â„¦ âˆª {âˆ}
by setting
Z
DW (âˆ) =
S(x) dÂµ(x) + 2I.
â„¦R
Note that with this notation, kWk1 = â„¦ DW (x) dÂµ(x) + DW (âˆ).
e = â„¦ âˆª {âˆ}
(3) In view of (2), one might want to equip the extended feature space â„¦
with a Ïƒ-finite measure by keeping the original measure on â„¦, and assigning some
finite measure Q = Âµ
e(âˆ) to the feature value âˆ, giving a new Ïƒ-finite measure
e
e
e
fQ , 0, 0, â„¦)
space â„¦Q . On â„¦Q , one can then define a graphex of the form f
WQ = (W
2
fQ equal to W on â„¦ Ã— â„¦ and to 2I/Q on {âˆ} Ã— {âˆ}, and by setting
by setting W
f
f (âˆ, y) = S(y)/Q if only one of the two features x, y
W (x, âˆ) = S(x)/Q and W
lies in â„¦. With this construction, DW
fQ (âˆ) = DW (âˆ)/Q, DW
fQ (x) = DW (x) if
R
f
x âˆˆ â„¦, and kWk1 = kWQ k1 = dÂµ(x)D f + QD f (âˆ), with the notation in (2)
W1

W

corresponding to the case Q = 1. It is clear that the graphon process generated
from f
W cannot have exactly the same distribution as the one generated from W
unless I and S are zero (to see this, note that in Gâˆ (f
W), all vertices have infinite
degrees, while Gâˆ (W) has vertices of degree one). But one might wonder whether
the process generated from the â€œpure graphonâ€ f
W approximates the one generated
from W. As we will see in Remark 7.7 , this is indeed the case, in the sense that for
any fixed T , the distribution of GT (f
WQ ) converges to GT (W).

***

Proposition 2.4. Let W = (W, S, I, â„¦) be a 4-tuple consisting of a Ïƒ-finite measure
space â„¦ = (â„¦, F, Âµ), a symmetric measurable function W : â„¦ Ã— â„¦ â†’ [0, 1], a
measurable function S : â„¦ â†’ R+ , and a nonnegative real number I. Then the local
finite conditions (1) and (2) from Definition 2.1 are equivalent to the local finiteness
of the adjacency measure generated by W. If we assume condition (1), then following
are equivalent:
(A) The graphex W obeys the local finiteness condition (2).
(B) For all D > 0, Âµ({DW > D}) < âˆ and W|{DW â‰¤D} is integrable.
(C) There exists a D > 0 such that Âµ({DW > D}) < âˆ and W|{DW â‰¤D} is integrable.
(D) For all D > 0, Âµ({DW > D}) < âˆ, and both W |{DW â‰¤D} and min{S, 1} are
integrable.
(E) There exists a D > 0 such that Âµ({DW > D}) < âˆ, and both W |{DW â‰¤D} and
min{S, 1} are integrable.

***

Theorem 2.5. Let W1 = (W1 , S1 , I1 , â„¦1 ) and W2 = (W2 , S2 , I2 , â„¦2 ) be graphexes,
where â„¦i = (â„¦i , Fi , Âµi ) are Ïƒ-finite spaces. Then Gt (W1 ) and Gt (W2 ) have the
same distribution for all t âˆˆ R+ if and only if there exists a third graphex W =
(W, S, I, â„¦) over a Ïƒ-finite measure space â„¦ = (â„¦, F, Âµ) and measure preserving
maps Ï†i : dsupp Wi â†’ â„¦ such that Wi |dsupp Wi = WÏ†i almost everywhere.

***

Remark 2.6. If the two graphexes are defined over Borel spaces, we can prove
an analogous statement where the measure-preserving maps are turned around.
Specifically, for the case where â„¦1 and â„¦2 are Ïƒ-finite Borel spaces, we can prove
that Gt (W1 ) and Gt (W2 ) have the same distribution for all t âˆˆ R+ if and only
if there exists a Ïƒ-finite Borel space â„¦ = (â„¦, F, Âµ) and measure preserving maps
Ï€i : â„¦ â†’ dsupp Wi such that (W1 |dsupp W1 )Ï€1 = (W2 |dsupp W2 )Ï€2 almost everywhere.
In this case, the space â„¦ can be chosen to be a coupling of â„¦1 and â„¦2 , with Ï€i being
the coordinate projections from â„¦1 Ã— â„¦2 to â„¦i . See Theorem 8.2 in Section ??.
For graphexes without a dust and star part, this was independently established in
[3] (using a different proof); see also [17], which establishes a similar result (with
yet another proof), this time giving a coupling of the two graphexes (again without
dust and star part) after trivially extending them rather than restricting them to
the support of their marginals.

***
Definition 2.7. Given a function U defined on â„¦1 Ã— â„¦2 for two Ïƒ-finite measure
spaces â„¦i = (â„¦i , Fi , â„¦i ) for i = 1, 2, we define
kU k2â†’2 =

sup
f,g:kf k2 =kgk2 =1

f â—¦U â—¦g =

sup
g:kgk2 =1

kU â—¦ gk2 .

***
Definition 2.8. Given a measurable function U defined on â„¦ Ã— â„¦ for a Ïƒ-finite
measure space â„¦, we define the jumble norm


Z


1


kU k = sup  p
U (x, y) dÂµ(x) dÂµ(y) .

Âµ(S)Âµ(T ) SÃ—T
S,T âŠ†â„¦ 
Here the supremum is over subsets with finite and nonzero measure.

***
Definition 2.9. A signed graphex W = (W, S, I, â„¦) over â„¦ = (â„¦, F, Âµ) is said
to be in L1 âˆ© L2 if both W and D|W| are in L1 âˆ© L2 . Here |W| is the graphex
|W| = (|W |, |S|, |I|, â„¦).

***
Definition 2.10. Let W1 and W2 be signed graphexes in L1 âˆ© L2 . Then we define
(2.4)
Î´2â†’2 (W1 , W2 ) = Î´e2â†’2 (W0 , W0 ),
1

2

where W01 and W02 are trivial extensions of W1 and W2 to measure spaces of infinite
total mass. We refer to Î´2â†’2 (W1 , W2 ) as the kernel distance of W1 and W2 and
call Î´2â†’2 the kernel metric.

***

Theorem 2.11. Let W1 and W2 be signed graphexes in L1 âˆ© L2 . Then the right
side of (2.4) does not depend on the choice of the trivial extensions W01 and W02 .
Furthermore, given three signed graphexes W1 , W2 , W3 in L1 âˆ© L2 ,
Î´2â†’2 (W1 , W3 ) â‰¤ Î´2â†’2 (W1 , W2 ) + Î´2â†’2 (W2 , W3 ).

Therefore, Î´2â†’2 is a well-defined pseudometric.

***

Remark 2.12. In [3], when defining the cut distance between two graphons, it was
only necessary to extend the smaller space to the larger one, and it was not necessary
to extend further. It is natural to ask whether a trivial extension to a space of
infinite metric is necessary, or, equivalently, whether for two graphexes W1 , W2
defined on spaces with the same (finite) measure, Î´e2â†’2 (W1 , W2 ) = Î´2â†’2 (W1 , W2 ).
In contrast to the cut distance discussed in [3], for the kernel metric it is sometimes
necessary to take trivial extensions of both spaces, not just an extension of the
smaller space to one of the same measure as the larger one. See Example 3.11 in
Section ??.

***

Theorem 2.13. For any D > 0, Î´2â†’2 -convergence is equivalent to GP-convergence
on the space of graphexes with D-bounded marginals.

***

Definition 2.14. Let W1 = (W1 , S1 , I1 , â„¦1 ) and W2 = (W2 , S2 , I2 , â„¦2 ) be signed
graphexes, where â„¦i = (â„¦i , Fi , Âµi ) and kWi kâˆ < âˆ for i = 1, 2. We define
Î´ (W1 , W2 ) as the infimum of the set of real numbers c such that there exist two
measures Âµ
e1 and Âµ
e2 over (â„¦1 , F1 ) and (â„¦2 , F2 ) that satisfy the following: the signed
graphexes f
W1 and f
W2 obtained from W1 and W2 by replacing Âµ1 and Âµ2 by Âµ
e1
and Âµ
e2 , respectively, are in L1 âˆ© L2 , and
(1) for i = 1, 2, we have Âµi âˆ’ c2 â‰¤ Âµ
ei â‰¤ Âµi , and
(2) Î´2â†’2 (f
W1 , f
W2 ) â‰¤ c.
We refer to Î´ (W1 , W2 ) as the weak kernel distance between W1 and W2 and call
Î´ the weak kernel metric.

***

Theorem 2.15. Given three signed graphexes W1 , W2 , W3 with bounded graphon
part,
Î´ (W1 , W3 ) â‰¤ Î´ (W1 , W2 ) + Î´ (W2 , W3 ).
Therefore, Î´ is a pseudometric.

***

Remark 2.16. Given a signed graphex W = (W, S, I, â„¦) with â„¦ = (â„¦, F, Âµ) and a
measure-preserving map Ï• : â„¦0 â†’ â„¦, let W0 = WÏ• almost everywhere. We can take a
coupling Âµ
e on â„¦0 Ã—â„¦ defined by Âµ
e(AÃ—B) = Âµ0 (Aâˆ©Ï•âˆ’1 (B)). It is easy to see that then
the pullbacks of the two signed graphexes to â„¦0 Ã— â„¦ will be equal almost everywhere,
which implies that Î´2â†’2 (W, W0 ) = Î´e2â†’2 (W0 , W) = Î´ (W0 , W) = Î´e (W0 , W) = 0.

***

Proposition 2.17. Fix D < âˆ. Then Î´ and Î´2â†’2 give an equivalent topology on
the space of graphexes with D-bounded marginals.

***

Theorem 2.18. Given a sequence of graphexes Wn and a graphex W, Wn is
GP-convergent to W if and only if Î´ (Wn , W) â†’ 0.

***

Remark 2.19. The reader might wonder whether instead of building our metric for
GP-convergence around the kernel norm k Â· k2â†’2 , one could equivalently build it
around the cut norm, k Â· k . Concretely, one might want to define d by replacing
the kernel norm in (??) by the cut norm and the L2 norm by the L1 norm, then
proceed as in (??) and (2.4) to obtain a cut distance Î´ between graphexes with
bounded marginals, and finally proceed as in Definition 2.14 to obtain a â€œweak cut
metricâ€ for arbitrary graphexes.
The following example shows that this approach does not work, in that it will not
metricize GP-convergence. Define Wn to be the graphex that is constant and equal
to nâˆ’2 over [0, n]2 and 0 everywhere else, and set Wn = (Wn , 0, 0, R+ ), where R+
is equipped with the Lebesgue measure. The marginal DWn of Wn is then equal
to 1/n times the indicator function of the interval [0, n], and its L1 norm is equal
to 1. It is then not hard to check that Wn converges to the pure dust graphex
(0, 0, 1, R+ ) in the metric Î´ . Indeed, kWn k2â†’2 â†’ 0 and kDWn k2 = nâˆ’1/2 â†’ 0,
while kWn k = 1 â†’ 1 = kWk1 , which immediately implies convergence in the metric
Î´ and hence GP-convergence (based on the proof of equivalence in this paper,
though for this specific case it is simple to check GP-convergence directly). By
contrast, kWn k = kWn k1 = 1 stays bounded away from zero, showing in particular
that Wn does not converge to W in the cut metric Î´ . Since changing the Lebesgue
measure to a measure Âµn such that Î» âˆ’ Îµn â‰¤ Âµn â‰¤ Î» with Îµn â†’ 0 will asymptotically
not change the cut norm of Wn , the graphexes Wn do not converge to W in the
weak cut metric either. Note that this canâ€™t be cured by choosing a different norm
for the marginal difference DW1 âˆ’ DW2 , e.g., by keeping the L2 norm for that part,
since the above counter example works independently of the norm used for that
part.

***

Definition 2.20. A set S of graphexes is tight if for every Îµ > 0, there exist C and
D such that for every W âˆˆ S, W = (W, S, I, â„¦) with â„¦ = (â„¦, F, Âµ), there exists
â„¦Îµ âŠ† â„¦ such that Âµ(â„¦Îµ ) â‰¤ Îµ and the graphex W0 = W|â„¦\â„¦Îµ is (C, D)-bounded.
Here a graphex W0 is called (C, D)-bounded if its marginals are D-bounded and
kW0 k1 â‰¤ C.

***

Theorem 2.21. The space of all graphexes is complete under the topology induced
by the weak kernel metric Î´ . A subset is relatively compact if and only if it is tight.
In particular, for any C and D, the set of graphexes with kWk1 â‰¤ C is compact
under Î´ , and the set of (C, D)-bounded graphexes is compact under both Î´ and
Î´2â†’2 .

***

Remark 2.22. As mentioned above, we only develop the theory of tightness for
unsigned graphexes. In particular, we donâ€™t characterize the set of precompact
signed graphexes. That notwithstanding, some of our compactness results do hold
for signed graphexes. Here we only mention that the analogue of the statement for
the set of graphexes with kWk1 â‰¤ C holds for signed graphexes as well, provided
we restrict the Lâˆ norm of the graphon part (which by definition is bounded
by 1 for unsigned graphexes). To be explicit, any sequence of signed graphexes
Wn = (Wn , Sn , In , â„¦n ) with kWn kâˆ â‰¤ B and kWn k1 â‰¤ C has a subsequence
converging to a signed graphex W = (W, S, I, â„¦) with kW kâˆ â‰¤ B and kWk1 â‰¤ C.
See Remark 5.10 in Section ?? below.

***

Theorem 2.23. Assume that W and Wn for n â‰¥ 1 are graphexes whose marginals
are D-bounded for some finite D. Then the following are equivalent.
(1) Î´2â†’2 (Wn , W) â†’ 0.
(2) For every graph F with no isolated vertices, t(F, Wn ) â†’ t(F, W).
(3) For every connected graph F , t(F, Wn ) â†’ t(F, W).
(4) GT (Wn ) â†’ GT (W) in distribution for every T .
(5) GT (Wn ) â†’ GT (W) in distribution for some T .

***

Remark 2.24. The above theorem implies in particular that in order to check whether
a sequence Wn of graphexes with uniformly bounded marginals is GP-convergent,
it is enough to check convergence of GT (Wn ) for a single T > 0. In a similar way,
several other properties of sequences or sets of graphexes can be equivalently stated
for all T > 0 or some T > 0 (see, in particular, the already mentioned Theorem 4.1
about tightness and Theorem 9.1 about uniform integrability). But for general
sequences of graphexes, we do not know whether GP-convergence is equivalent to
the convergence of GT (Wn ) for just one T > 0.

***
Definition 2.25. A set of graphexes S is called uniformly integrable if the graphexes
in S have uniformly bounded k Â· k1 -norms, and for every Îµ > 0, there exists a D
such that for all W âˆˆ S, kDW 1DW >D k1 < Îµ.

***

Theorem 2.26. Suppose Wn is a sequence of integrable graphexes with uniformly
bounded k Â· k1 -norms that converges to a graphex W in the weak kernel metric. Then
kWk1 â‰¤ lim inf kWn k1 .
nâ†’âˆ

In particular, W is integrable. We furthermore have that
lim kWn k1 = kWk1

nâ†’âˆ

if and only if the sequence Wn is uniformly integrable.

***
Definition 2.27. [[3]] Given a set of signed, integrable graphons S, we say that
they are uniformly tail regular if for any Îµ > 0, there exists M such that for each
W âˆˆ S with the usual notation, there exists â„¦0 âŠ† â„¦ such that Âµ(â„¦0 ) â‰¤ M and
kW k1 âˆ’ kW |â„¦0 k1 â‰¤ Îµ.

***
Theorem 2.28. Given a sequence of integrable graphexes of the form
Wn = (Wn , 0, 0, â„¦n ),

the following are equivalent.
(1) The sequence Wn converges to a graphon W in cut metric.
(2) The sequence Wn is uniformly tail regular, and in the weak kernel metric,
the sequence Wn converges to a graphex of the form W = (W, 0, 0, â„¦).
(3) The sequence Wn is uniformly tail regular, and in the weak kernel metric,
the sequence Wn converges to some graphex W.

***
Theorem 2.29. Given a sequence of uniformly integrable graphexes
Wn = (Wn , Sn , In , â„¦n ),

which converge to a graphex W = (W, S, I, â„¦) in the weak kernel metric, the following
are equivalent.
(1) The graphex W is of the form W = (W, 0, 0, â„¦).
(2) kSn k1 â†’ 0 and In â†’ 0, and the sequence of graphons Wn has uniformly
regular tails.
(3) kSn k1 â†’ 0 and In â†’ 0, and the sequence of graphons Wn converges in the
cut metric.

***

Remark 2.30. In the above theorem, the assumption of uniform integrability is
necessary. To see this, let Wn be the graphon defined by being 1 on the set
[0, 1/n] Ã— [1, n + 1] and its transpose, and 0 otherwise, and let Wn = (Wn , 0, 0, R+ ).
Then the sequence Wn converges to the zero graphex in the weak kernel metric,
which is a pure graphon. However, the sequence is clearly not uniform tail regular
(or even uniformly integrable). We can also let Sn (x) = 1/n on the set [0, n], and 0
everywhere else. In that case the sequence still converges to 0 in the weak kernel
metric, but kSn k1 does not converge to 0.

***

Theorem 3.1. Let W1 and W2 be signed graphexes in L1 âˆ© L2 . Define Î´ by
replacing the right side of (2.4) with Î´e , which in turn is obtained from Î´e2â†’2 by
replacing d2â†’2 with d . Then the value of Î´ (W1 , W2 ) does not depend on the
choice of the trivial extensions W01 and W02 , and Î´ obeys the triangle inequality,
making it a well-defined pseudometric.

***

Lemma 3.2. Suppose Ï† : â„¦ â†’ â„¦0 is a measure preserving map between two Ïƒ-finite
measure spaces (â„¦, F, Âµ) and (â„¦0 , F 0 , Âµ0 ).
(1) For any Ïƒ-algebra G âŠ† F, L1 (â„¦, G, Âµ) is a closed subspace in L1 (â„¦, F, Âµ).
(2) If f âˆˆ L1 (â„¦, Ï†âˆ’1 (F 0 ), Âµ), then there exists a function f 0 âˆˆ L1 (â„¦0 , F 0 , Âµ0 )
such that f = f 0Ï† = f 0 â—¦ Ï† almost everywhere.
Ï†
(3) The map Ï†âˆ— : L1 (â„¦0 , F 0 , Âµ0 ) â†’ L1 (â„¦, Ï†âˆ’1 (F 0 ), Âµ) with f 0 7â†’ f 0 is an
isometric isomorphism, implying that Ï†âˆ— and its inverse are continuous
and hence Borel measurable.

***
Lemma 3.3. Suppose that â„¦ = (â„¦, F, Âµ) with Âµ(â„¦) < âˆ, and suppose that g âˆˆ
L2 (â„¦). Let
R



 â„¦ f g dÂµ 

.
(3.3)
S=
sup

 qR
f âˆˆLâˆ (â„¦),0â‰¤f â‰¤1 
f dÂµ 
â„¦

Then S â‰¤ kgk2 < âˆ, and there exists X âŠ† â„¦ such that
R

 g dÂµ
X
S= p
.
Âµ(X)

Note that this expression is the same as taking f = 1X in (3.3 ).

***

Proposition 3.4. Let â„¦ = (â„¦, F, Âµ) and â„¦0 = (â„¦0 , F 0 , Âµ0 ) be Ïƒ-finite measure
spaces, and let Ï• : â„¦0 â†’ â„¦ be measurable. If U : â„¦ Ã— â„¦ â†’ R and F : â„¦ â†’ R are
square integrable, then
kU k2â†’2 = kU Ï• k2â†’2 ,

kF k = kF Ï• k ,

and

kU k = kU Ï• k .

If instead of square integrability, we assume that U is integrable, then
kU k = kU Ï• k .

***

Lemma 3.5. Let â„¦ = (â„¦, F, Âµ) and â„¦0 = (â„¦0 , F 0 , Âµ0 ) be Ïƒ-finite measure spaces,
let Ï• : â„¦ â†’ â„¦0 be a measure-preserving map, and let W1 , W2 be signed graphexes in
L1 âˆ© L2 . Then
Ï•
âˆ†2â†’2 (W1 , W2 ) = âˆ†2â†’2 (WÏ•
1 , W2 )

and

Ï•
âˆ† (W1 , W2 ) = âˆ† (WÏ•
1 , W2 ).

***

Remark 3.6. Given a signed step graphex W = (W, S, I, â„¦) over a finite subspace
partition P = (P1 , P2 , . . . , Pm ), we can define another signed graphex W0 =
(W 0 , S 0 , I 0 , â„¦0 ) with â„¦0 = (â„¦0 , F 0 , Âµ0 ), where â„¦0 = [m], F 0 consists of all subsets,
and the measure is defined by Âµ0 ({i}) = Âµ(Pi ). Setting I 0 = I, S 0 (i) = S(x) for any
x âˆˆ Pi (they are all equal), and W 0 (i, j) = W (x, y) for x âˆˆ Pi , y âˆˆ Pj (again the
choice of x and y does not matter), we obtain that W = (W0 )Ï• where Ï• : â„¦ â†’ â„¦0
is the map with Ï•(x) = i for x âˆˆ Pi . In particular, by Remark 2.16 , the distance
between W and W0 is zero (for any of the distance notions). Suppose now that
W00 = (W 00 , S 00 , I 00 , â„¦00 ) with â„¦00 = (â„¦00 , F 00 , Âµ00 ) is another signed step graphex over
a finite subspace partition Q = {Q1 , Q2 , . . . , Qm }, with I 00 = I, Âµ00 (Qi ) = Âµ(Pi ),
and S 00 (x00 ) = S(x), W 00 (x00 , y 00 ) = W (x, y) for x âˆˆ Pi , x00 âˆˆ Qi , y âˆˆ Pj , y 00 âˆˆ Qj .
Then â„¦00 can also be mapped to â„¦0 so that W00 is the pullback of W0 (by mapping
Qi to i). This implies that the distance of both W and W00 from W0 is 0, which (by
the still to be proven triangle inequality) implies that their distance from each other
is 0 (again for any of the notions of distance).

***

Lemma 3.7. Let W1 = (W1 , S1 , I1 , â„¦) and W2 = (W2 , S2 , I2 , â„¦) be signed
graphexes in L1 âˆ©L2 . Assume that both are countable step graphexes on â„¦ = (â„¦, F, Âµ)
with common refinement P = {P1 , P2 , . . . , Pm , . . . }, suppose Âµ0 is another measure
on â„¦ with Âµ(Pi ) = Âµ0 (Pi ), and let â„¦0 = (â„¦, F, Âµ0 ) and W0i = (Wi , Si , Ii , â„¦0 ). Then
âˆ†2â†’2 (W1 , W2 ) = âˆ†2â†’2 (W01 , W02 )

and

âˆ† (W1 , W2 ) = âˆ† (W01 , W02 ).

***

Lemma 3.8. Let Wi = (Wi , Si , Ii , â„¦i ), for i = 1, 2, 3, be countable step graphexes
in L1 âˆ© L2 . Let Âµ12 be a coupling measure on â„¦1 Ã— â„¦2 , and Âµ23 be a coupling measure
on â„¦2 Ã— â„¦3 . Then there exists a coupling measure Âµ13 on â„¦1 and â„¦3 such that
Ï€

âˆ†2â†’2 (W1 13,1
â‰¤

,Âµ13

Ï€

, W3 13,3

,Âµ13

)

Ï€
,Âµ
Ï€
,Âµ
âˆ†2â†’2 (W1 12,1 12 , W3 12,2 12 )

Ï€

,Âµ23

,Âµ23

, W3 23,3

+ âˆ†2â†’2 (W1 23,2

Ï€

,Âµ23

,Âµ23

),

, W3 23,3

and
Ï€

âˆ† (W1 13,1
â‰¤

,Âµ13

Ï€

, W3 13,3

,Âµ13

)

Ï€
,Âµ
Ï€
,Âµ
âˆ† (W1 12,1 12 , W3 12,2 12 )

where the inequalities hold coordinate-wise.

Ï€

+ âˆ† (W1 23,2

Ï€

)

***

Lemma 3.9. Suppose that Wi = (Wi , Si , Ii , â„¦i ) with â„¦i = (â„¦i , Fi , Âµi ), for i =
1, 2, 3, are signed graphexes in L1 âˆ© L2 , and assume that Âµ1 (â„¦1 ) = Âµ2 (â„¦2 ) = Âµ3 (â„¦3 ).
Then
Î´e2â†’2 (W1 , W3 ) â‰¤ Î´e2â†’2 (W1 , W2 ) + Î´e2â†’2 (W2 , W3 )
and
Î´e (W1 , W3 ) â‰¤ Î´e (W1 , W2 ) + Î´e (W2 , W3 ).

***

Lemma 3.10. Let W = (W, S, I, â„¦) be a signed graphex in L1 âˆ© L2 , with possibly
unbounded graphon parts, and let â„¦ = (â„¦, F, Âµ).
(1) If W0 and W00 are trivial extensions of W by Ïƒ-finite spaces of infinite
measure, then
Î´e (W0 , W00 ) = Î´e2â†’2 (W0 , W00 ) = 0.
e is obtained from W by appending an
f , S,
e I, â„¦)
W = (W
(2) If Âµ(â„¦) = âˆ and f
arbitrary Ïƒ-finite space of infinite measure, then
Î´e2â†’2 (W, f
W) = Î´e (W, f
W) = 0.

***

Example 3.11. Let W1 = (W1 , 0, 0, â„¦1 ) where â„¦1 consists of just two atoms a
and b, with weight p and 1 âˆ’ p, where 0 < p < 1/2, and W1 (a, a) = W1 (b, b) = 0,
W1 (a, b) = W1 (b, a) = 1. Furthermore, let W2 = (W2 , 0, 0, â„¦2 ) where
â„¦2 consists
p
of just one atom c with weight 1, and W2 is the constant a = p(1 âˆ’ p). Then
Ï€1
Ï€2
we have just one choice of coupling.
will have two
p For this coupling, W1 âˆ’ W2 p
atoms, and it will be equal to âˆ’ p(1 âˆ’ p) on the diagonal, and 1 âˆ’ p(1 âˆ’ p) off
the diagonal. It is then not difficult to see that kW1 âˆ’ W2 k2â†’2 is equal to the largest
eigenvalue (in absolute value) of the matrix


âˆ’pa
(1 âˆ’ p)(1 âˆ’ a)
.
p(1 âˆ’ a)
âˆ’(1 âˆ’ p)a
The trace of this matrix is âˆ’a, and the determinant is
p(1 âˆ’ p)a2 âˆ’ p(1 âˆ’ p)(1 âˆ’ a)2 = p(1 âˆ’ p)(2a âˆ’ 1) < 0.
p
Here we used that a = p(1 âˆ’ p) < 1/2. We then have that the two eigenvalues of
the matrix have opposite signs, and their sum is âˆ’a, which implies that the negative
one must be less than âˆ’a; i.e., it must have larger absolute value than a.
On the other hand, clearly kW1 k2â†’2 = a, and kW2 k2â†’2 is equal to the largest
eigenvalue (in absolute value) of the matrix


0 1âˆ’p
,
p
0
p
which can easily be seen to be equal to p(1 âˆ’ p) = a.
Therefore, if we extend W1 and W2 by spaces of total measure at least 1, and couple
each â„¦i to the extension, then
f1 âˆ’ W
f2 k2â†’2 = max{kW
f1 k2â†’2 , kW
f2 k2â†’2 } = a.
kW

Therefore, by extending, we can obtain a better coupling.
Finally, note that in (??), if we multiply the measure of the underlying space by c,
then the first term is multiplied by c, the second by c3/4 , and the third by c2/3 . We
can therefore take c large enough so that the maximum in the term is dominated by
kW1 âˆ’ W2 k2â†’2 . Therefore, we obtain that also for minimizing d2â†’2 , we obtain a
better coupling if we extend by trivial extensions than if we do not.

***

Lemma 3.12. Let W be a signed graphex with bounded graphon part, and let
0 < D < âˆ. Then the set {D|W| > D} has finite measure, and W|{D|W| â‰¤D} is
integrable and hence in L1 âˆ© L2 .

***

Lemma 3.13. Let W1 = (W1 , S1 , I1 , â„¦) and W2 = (W2 , S2 , I2 , â„¦) be signed
graphexes in L1 âˆ© L2 , let â„¦ = (â„¦, F, Âµ), and let
(1) kW1 âˆ’ W2 k2â†’2,Âµ = a,
(2) kDW1 âˆ’ DW2 k2,Âµ = b, and
(3) |Ï(W1 ) âˆ’ Ï(W2 )| = c.
If W01 = (W1 , S1 , I1 , â„¦0 ) and W02 = (W2 , S2 , I2 , â„¦0 ) where â„¦0 = (â„¦, F, Âµ0 ) for some
measure Âµ0 such that Âµ âˆ’ r â‰¤ Âµ0 â‰¤ Âµ for some r < âˆ, then
(1) kW1 âˆ’ W2 k2â†’2,Âµ0 â‰¤ a, âˆš
(2) kDW01 âˆ’ DW02 k2,Âµ0 â‰¤ b+ a r, and
âˆš


(3) |Ï(W01 ) âˆ’ Ï(W02 )| âˆ’ c â‰¤ 2b r + ar.

***

Lemma 3.14. For i = 1, 2, let Wi be graphexes over â„¦i = (â„¦i , Fi , Âµi ), and let
W0i be trivial extensions of Wi to Ïƒ-finite measure spaces â„¦0i = (â„¦0i , Fi0 , Âµ0i ) with
Âµ0i (â„¦0i ) = âˆ. Then Î´ (W1 , W2 ) = Î´e (W01 , W02 ), where Î´e (W01 , W02 ) is defined as the
infimum over all c such that there exists a measure Âµ0 over â„¦01 Ã— â„¦02 obeying the
conditions
(1) Âµ0i âˆ’ c2 â‰¤ (Âµ0 )Ï€i â‰¤ Âµ0i for i = 1, 2, and
0
0
(2) d2â†’2 ((W01 )Ï€1 ,Âµ , (W02 )Ï€2 ,Âµ ) â‰¤ c.

***

Proposition 3.15. Fix B, C, D < âˆ. Then Î´ and Î´2â†’2 define the same topology
on the space of (B, C, D)-bounded signed graphexes.

***

Lemma 3.16. Let Wi = (Wi , Si , Ii , â„¦), for i = 1, 2, be (B, C, D)-bounded signed
graphexes on the same measure space â„¦, and let Âµ0 , r, W01 , and W02 be as in
Lemma 3.13 . Then
âˆš
(1) kW1 âˆ’ W2 k2â†’2,Âµ0 â‰¤ kW1 âˆ’ W2 k2â†’2,Âµ â‰¤ kW1 âˆ’ W2 k2â†’2,Âµ0 + 4 BDr,


(2) kDW1 âˆ’ DW2 k22,Âµ âˆ’ kDW01 âˆ’ DW02 k22,Âµ0  â‰¤ (4D2 + 8BC)r, and


 


(3) Ï(W01 ) âˆ’ Ï(W02 ) âˆ’ Ï(W1 ) âˆ’ Ï(W2 ) â‰¤ 4Dr.

***
Lemma 3.17. Suppose Wi = (Wi , Si , Ii , â„¦i ), for i = 1, 2, are signed graphexes with
kWi kâˆ â‰¤ B and kD|W| kâˆ â‰¤ D, and let Î´ (W1 , W2 ) â‰¤ Îµ. Then |Ï(W1 ) âˆ’ Ï(W2 )| â‰¤
Îµ3 + 4Îµ2 D. If, in addition, kW ki â‰¤ C, then Î´2â†’2 (W1 , W2 ) â‰¤ f (Îµ), where



1/2
p
âˆš
1/3
2
3
2
2
f (Îµ) = max Îµ + 4Îµ BD, Îµ + 2Îµ D + 2BC
, Îµ + 4Îµ D

***
Lemma 3.18. Let U : â„¦ Ã— â„¦ â†’ R be a measurable function. Then
kU k42â†’2 â‰¤ t(C4 , U ) â‰¤ kU k22â†’2 kU k22 .

***

Proposition 3.19. Given B, C, D < âˆ, there exists a constant c < âˆ such that if
W1 and W2 are (B, C, D)-bounded signed graphexes, then the following hold.
(1) If d2â†’2 (W1 , W2 ) â‰¤ Îµe, then d (W1 , W2 ) â‰¤ max{e
Îµâˆš, Îµe3 }.âˆš
(2) If d (W1 , W2 ) â‰¤ Îµ, then d2â†’2 (W1 , W2 ) â‰¤ max{ 3 Îµ, c 4 Îµ}.
If the graphexes are such that Ï(W1 ) = Ï(W
âˆš 2 ), then these bounds can be replaced by
d (W1 , W2 ) â‰¤ Îµe and d2â†’2 (W1 , W2 ) â‰¤ c 4 Îµ.

***

Lemma 3.20. Given a bounded, nonnegative, measurable function f on some
measure space (â„¦, F, Âµ), we have
Z
kf k22
1
p
â‰¤ sup p
f dÂµ â‰¤ kf k2 .
kf k1 kf kâˆ
Âµ(S) S
SâŠ†â„¦

In particular, the second and third term define equivalent norms, for any C, D, on
the space of nonnegative functions with kf k1 â‰¤ C, kf kâˆ â‰¤ D.

***
Lemma 3.21. Given a bounded, measurable, not necessarily nonnegative function
f on some measure space (â„¦, Âµ), we have
Z



kf k22
1

p
â‰¤ sup p
f dÂµ â‰¤ kf k2 .

2kf k kf k
Âµ(S)
SâŠ†â„¦
1

âˆ

S

***
Lemma 3.22. For any measurable U : â„¦ Ã— â„¦ â†’ R,
kU k2â†’2 â‰¥ kU k â‰¥

kU k42â†’2
3/4

3/4

3/2

8kU kâˆ kD|U | kâˆ kD|U | k2

â‰¥

kU k42â†’2
3/4

3/2

3/4

8kU kâˆ kD|U | kâˆ kU k1

.

***

Remark 3.23. The above proof can easily be modified to see that for any 0 < D < âˆ
the metrics Î´2â†’2 and Î´ are equivalent on the space of (unsigned) graphexes with Dbounded marginals. Indeed, if W has bounded marginals, it is integrable, and if either
Î´2â†’2 (Wn , W) â†’ 0 or Î´ (Wn , W) â†’ 0, then kWn k1 = Ï(Wn ) â†’ Ï(W) = kWk1 .
This shows that we can assume that the sequences are (C, D)-bounded for some C,
which means they are (B, C, D)-bounded for B = 1.

***

Proposition 3.24. For any simple graph F with no isolated vertices and graphex
W,
E [inj(F, GT (W))] = T |V (F )| t(F, W).
If the marginals of W are bounded, then the right side is finite, with
Y
i )âˆ’2
t(F, W) â‰¤
kWk1 kDW kv(F
,
âˆ
i

where the product runs over the components of F and vi is the number of vertices
in Fi .

***

Theorem 4.1. Given a set of graphexes S, the following are equivalent:
(1) S is tight. In other words, for every Îµ > 0, there exist C and D such
that for every graphex W âˆˆ S, W = (W, S, I, â„¦) with â„¦ = (â„¦, F, Âµ), there
exists â„¦Îµ âŠ† â„¦ such that Âµ(â„¦Îµ ) â‰¤ Îµ and W0 = W|â„¦\â„¦Îµ has kW0 k1 â‰¤ C,
kDW0 kâˆ â‰¤ D.
(2) For every Îµ > 0, there exist C such that for every graphex W âˆˆ S, W =
(W, S, I, â„¦), there exists â„¦Îµ âŠ† â„¦ such that Âµ(â„¦Îµ ) â‰¤ Îµ and W0 = W|â„¦\â„¦Îµ has
kW0 k1 â‰¤ C.
(3) For every Îµ, there is a D and C such that for any W âˆˆ S, taking â„¦â‰¤D to be
the set of points with DW (x) â‰¤ D, Âµ(â„¦ \ â„¦â‰¤D ) â‰¤ Îµ, and kW|â„¦â‰¤D k1 â‰¤ C.
(4) For every T > 0, the set of random unlabeled finite graphs GT (W) with
W âˆˆ S is tight.
(5) There exists T > 0 such that the set of random unlabeled finite graphs
GT (W) with W âˆˆ S is tight.

***

Corollary 4.2. Let S be a set of graphexes.
(1) If there exists a C < âˆ such that kWk1 â‰¤ C for all W âˆˆ S, then S is tight.
(2) If S is tight and has uniformly bounded marginals, then there exist C, D < âˆ
such that S is (C, D)-bounded.

***

Lemma 4.3. The probability that GT (W) has more than KT 2 kWk1 edges is at
most
T 2 kWk1 /2 + T 3 kDW k22
,
(K âˆ’ 1/2)2 T 4 kWk21
and the probability that it has less than T 2 kWk1 /4 edges is at most
16(T 2 kWk1 /2 + T 3 kDW k22 )
T 4 kWk21

***

Remark 4.4. It will sometimes be useful to transform a graphex W over an arbitrary
Ïƒ-finite space â„¦ = (â„¦, F, Âµ) into a graphex over an atomless space by mapping â„¦
to the product space â„¦ Ã— [0, 1] equipped with the measure Âµ Ã— Î», with Î» denoting
the Lebesgue measure, and mapping W to Î¦(W) = WÏ† , with Ï† : â„¦ Ã— [0, 1] â†’ â„¦
denoting the coordinate projection onto â„¦. It is easy to see that Î´ (W, Î¦(W)) = 0,
which together with the triangle inequality implies that the map Î¦ does not change
distances between graphons. It is also easy to check that if S is a tight set of
graphexes, then the set of graphexes obtained by mapping each graphex W âˆˆ S to
the corresponding atomless graphex Î¦(W) is tight as well.

***

Lemma 4.5. Given C, D, M âˆˆ (0, âˆ), there exists a function f : [0, âˆ)2 â†’ [0, âˆ)
such that f (x) â†’ 0 as x â†’ 0 and such that the following holds
(1) Let W be a graphex over (â„¦, F, Âµ), and let Âµ
e be a second measure over (â„¦, F)
f
such that Âµ âˆ’ r â‰¤ Âµ
e â‰¤ Âµ. If W is obtained from W by replacing Âµ with Âµ
e
then
Âµ(DW > D + r) âˆ’ r â‰¤ Âµ
e(DW
e > D) â‰¤ Âµ(DW > D)
for all D > 0.
(2) Let W1 and W2 be graphexes with bounded marginals, defined over the same
space (â„¦, F, Âµ). Suppose that d2â†’2 (W1 , W2 ) < Îµ. Then
Âµ({|DW1 âˆ’ DW2 | â‰¥ Îµ}) < Îµ2 .
W1 and f
W2 be graphexes with bounded marginals, defined over
(3) Let f
(â„¦1 , F1 , Âµ
e1 ) and (â„¦2 , F2 , Âµ
e2 ). If Î´2â†’2 (f
W1 , f
W2 ) < Îµ and D > Îµ, then
2
2
Âµ
e1 ({DW
e2 ({DW
e1 ({DW
e 1 > D + Îµ}) âˆ’ Îµ â‰¤ Âµ
e 2 > D}) â‰¤ Âµ
e 1 > D âˆ’ Îµ}) + Îµ .

(4) For i = 1, 2, let Wi be graphexes defined over (â„¦i , Fi , Âµi ), and let Wi,â‰¤D
be the restriction of Wi to the subset {DWi â‰¤ D} of â„¦i . Assume that
Îµ + Îµ2 < D, Âµ1 ({DW1 > D}) + Âµ2 ({DW2 > D}) â‰¤ M , kW2,â‰¤D k1 â‰¤ C,
Î´ (W1 , W2 ) â‰¤ Îµ, and Âµ2 ({D âˆ’ Îµ âˆ’ Îµ2 < DW2 â‰¤ D + Îµ + Îµ2 }) â‰¤ Î´. Then
Î´2â†’2 (W1,â‰¤D , W2,â‰¤D ) â‰¤ f (Îµ, Î´).

***

Proposition 4.6. Given a sequence of graphexes Wn and a graphex W over the
Ïƒ-finite measure spaces â„¦n = (â„¦n , Fn , Âµn ) and â„¦ = (â„¦, F, Âµ), respectively, define
Wn,â‰¤D and Wâ‰¤D as above. Then the following are equivalent.
(1) For all D > 0 such that Âµ({DW = D}) = 0, we have Î´2â†’2 (Wn,â‰¤D , Wâ‰¤D ) â†’
0 and Âµn (â„¦n,>D ) â†’ Âµ(â„¦>D ).
(2) The sequence is tight, and for all D > 0 such that Âµ({DW = D}) = 0, we
have Î´2â†’2 (Wn,â‰¤D , Wâ‰¤D ) â†’ 0.
(3) For every Îµ > 0 and n âˆˆ N there exist subsets â„¦n,Îµ âŠ† â„¦n and a subset â„¦Îµ âŠ† â„¦
with Âµn (â„¦n \ â„¦n,Îµ ) â‰¤ Îµ and Âµ(â„¦ \ â„¦Îµ ) â‰¤ Îµ, such that Î´2â†’2 (W0n , W0 ) â†’ 0,
where W0n = (Wn )|â„¦n ,Îµ and W0 = W|â„¦Îµ .
(4) Î´ (Wn , W) â†’ 0.

***

Proposition 4.7. Given two graphexes W1 , W2 , let Wi,â‰¤D be the graphex Wi
restricted to â„¦i,â‰¤D = {x âˆˆ â„¦i : DWi (x) â‰¤ D}. Then the following are equivalent.
(1) For any D > 0,
Âµ1 (â„¦1 \ â„¦1,â‰¤D ) = Âµ2 (â„¦2 \ â„¦2,â‰¤D ) and Î´2â†’2 (W1,â‰¤D , W2,â‰¤D ) = 0.

(2) For any D > 0, Î´2â†’2 (W1,â‰¤D , W2,â‰¤D ) = 0.
(3) For any Îµ > 0, there exist subsets â„¦1,Îµ âŠ† â„¦1 , â„¦2,Îµ âŠ† â„¦2 with Âµi (â„¦i \â„¦i,Îµ ) â‰¤ Îµ,
such that if W0i is the restriction to â„¦i \ â„¦i,Îµ , then Î´2â†’2 (W01 , W02 ) â‰¤ Îµ.
(4) Î´ (W1 , W2 ) = 0.

***

Remark 4.8. It is not a priori clear how to generalize the notion of tightness
to signed graphexes, even if we restrict ourselves to the case where the graphon
parts are uniformly bounded, for example by taking graphons that take values in
[âˆ’1, 1]. Indeed, recalling Lemma 3.12 and the role it played in showing that Î´ is
finite for signed graphexes with bounded graphon part, one might want to modify
Definition 2.20 for such graphexes by replacing the notion of D-bounded marginals
by that of D-bounded absolute marginals, since this would, in particular, guarantee
that a finite set of signed graphexes with graphon parts in [âˆ’1, 1] is tight. It would
also make the generalization of several of our results straightforward, since this
definition just reduces the notion of tightness of a set of graphexes S to the set of
graphexes S 0 = {|W| : W âˆˆ S}.
The following example shows that this straightforward generalization of
Definition 2.20 to signed graphexes does not give a characterization of precompact
sets with respect to the metric Î´ , as it did for unsigned graphexes; see Theorem 2.21
.
Let Wn be equal to nâˆ’3/4 on [0, 1) Ã— [1, n + 1) âˆª [1, n + 1) Ã— [0, 1), equal to âˆ’nâˆ’3/4
on [0, 1) Ã— [n + 1, 2n + 2) âˆª [n + 1, 2n + 1) Ã— [0, 1), and zero everywhere else on
R2+ . Define Wn to be the graphex with graphon part Wn and zero star and dust
part. Then DWn is equal to nâˆ’3/4 on [1, n + 1), equal to âˆ’nâˆ’3/4 on [n + 1, 2n + 1),
âˆ’1/2
and 0 everywhere
and
âˆš âˆ’1/2else. Finally, Ï(Wn ) = 0 for all n. Since kWn k2 = 2n
kDWn k2 = 2n
, Wn tends to the zero graphex in the metric Î´2â†’2 and hence
also in Î´ . But kWn k1 = kW k1 = 4n1/4 â†’ âˆ, a fact which canâ€™t be changed by
removing just a part of measure Îµ from the underlying space, R+ . This shows
that with the obvious generalization of Definition 2.20 to signed graphexes not all
sequences of signed graphexes that are convergent in Î´2â†’2 or Î´ are tight.
We therefore believe that a complete theory of signed graphexes, even in the simplified
case where all graphons take values in [âˆ’1, 1], requires either a modification of the
metric, or modification of the notion of tightness. We leave this problem as an open
research problem.

***

Definition 5.1. Given two subspace partitions P = (â„¦P , P) and Q = (â„¦Q , Q),
we say that P refines Q if â„¦Q âŠ† â„¦P and P is a refinement of Q âˆª {â„¦P \ â„¦Q }.

***

Definition 5.2. Given a signed graphex W = (W, S, I, â„¦) and a finite subspace
partition P = (â„¦P , P), take WP to be the signed graphex WP = (WP , SP , IP , â„¦)
defined by
Z
Z
1
IP =
W (x, y) dÂµ(x) dÂµ(y) +
S(x) dÂµ(x) + I,
2 (â„¦\â„¦P )Ã—(â„¦\â„¦P )
â„¦\â„¦P
!
Z
Z
1
SP (x) =
S(x) +
W (x, y) dÂµ(y) dÂµ(x) if x âˆˆ Pi
Âµ(Pi ) Pi
â„¦\â„¦P
for some i âˆˆ {1, . . . , k}, and 0 everywhere else, and
Z
1
WP (x, y) =
W (x0 , y 0 ) dÂµ(x0 ) dÂµ(y 0 )
Âµ(Pi )Âµ(Pj ) Pi Ã—Pj

if

for some i, j âˆˆ {1, . . . , k} and WP (x, y) = 0 everywhere else.

(x, y) âˆˆ Pi Ã— Pj

***

Theorem 5.3. For any B, C, D < âˆ, and Îµ > 0, there exists an M (Îµ) and N (Îµ)
such that for any signed graphex W that is (B, C, D)-bounded there exists a partition
(â„¦P , P) with P = {P1 , . . . , Pm }, m â‰¤ M (Îµ), and Âµ(â„¦P ) â‰¤ N (Îµ) such that
d (W, WP ) â‰¤ Îµ.

We can take
M (Îµ) = 2(2BC+CD)/Îµ

2

and

N (Îµ) = (4C 3 D + 8BC 2 D)/Îµ4 .

Given any finite subspace partition Q = (â„¦Q , Q), we can require the subspace
partition P = (â„¦P , P) to be a refinement of Q. In this case, the bound on the
number of parts is |Q|M (Îµ) and the bound on Âµ(â„¦P ) is Âµ(â„¦Q ) + N (Îµ).

***

Remark 5.4. With the help of Proposition 3.19 , Theorem 5.3 can immediately be
transformed into a similar statement for the kernel distance d2â†’2 (W, WP ), provided
8
N (Îµ) and M (Îµ) are replaced by bounds of the form M (Îµ) = 2c/Îµ and N (Îµ) = d/Îµ16
where c and d are constants depending on B, C and D.

***
Lemma 5.5. Let W1 , W2 be two graphexes on the same space â„¦, and let P be a
finite subspace partition of â„¦. Then
kW1,P âˆ’ W2,P k2â†’2 â‰¤ kW1 âˆ’ W2 k2â†’2

and
kDW1,P âˆ’ DW2,P k2 â‰¤ kDW1 âˆ’ DW2 k2 .

***

Corollary 5.6. Suppose that W is a graphex, and that U is a step graphex over
the same space as W. If P = (â„¦P , P) is a finite subspace partition such that U is
constant on each part of P and zero outside â„¦P , then
kWP âˆ’ W k2â†’2 â‰¤ 2kU âˆ’ W k2â†’2

and
kDWP âˆ’ DW k2 â‰¤ 2kDU âˆ’ DW k2 .

***

Theorem 5.7. Given B, C, D, and Îµ > 0, there exists Ï0 = Ï0 (Îµ, B, C, D) > 0
and N0 = N0 (Îµ, B, C, D) such that for any Ï < Ï0 , any m â‰¥ N0 /Ï, and any
(B, C, D)-bounded signed graphex W on an atomless space with infinite measure,
there exists a subspace partition P = (â„¦P , P) with exactly m parts of size Ï such
that d2â†’2 (W, WP ) â‰¤ Îµ. If P0 = (â„¦P0 , P0 ) is an arbitrary finite subspace partition,
we can require P to refine P0 , as long as each part of P0 is divisible by Ï (and
increasing the bound on N0 (Îµ) and decreasing Ï0 appropriately depending on |P0 |
and Âµ(â„¦P0 )).

***

Lemma 5.8. Let S be a set of signed graphexes over atomless spaces of infinite
measure such that the following condition holds:
(a) For every Îµ > 0, there exists B, C, D such that for any W = (W, S, I, (â„¦, F, Âµ)) âˆˆ
S, taking â„¦â‰¤D to be the set of points with D|W| (x) â‰¤ D, we have that Âµ(â„¦ \
â„¦â‰¤D ) â‰¤ Îµ, kW |â„¦â‰¤D kâˆ â‰¤ B, and kW|â„¦â‰¤D k1 â‰¤ C.
Then there exist strictly increasing sequences of integers ak â‰¥ 2k and bk â‰¥ k and
sequences of positive real numbers Bk , Ck , and Dk such that the following holds. For
any graphex W âˆˆ S, W = (W, S, I, â„¦) with â„¦ = (â„¦, F, Âµ), there exists a sequence of
subsets Pk,0 âŠ† â„¦ and subspace partitions Pk = (â„¦Pk , Pk ), Pk = {Pk,1 , . . . , Pk,mk }
with mk = 2ak +bk , such that for all k, â„¦Pk is disjoint from Pk,0 and
(1) Pk+1,0 âŠ† Pk,0 and Âµ(Pk,0 ) = 2âˆ’2k ,
(2) Wk = W|â„¦\Pk,0 is (Bk , Ck , Dk )-bounded,
(3) Pk+1 refines Pk ,
(4) Pk,i for i â‰¥ 1 has measure 2âˆ’ak , and
(5) d2â†’2 (Wk , (Wk )Pk ) â‰¤ 2âˆ’k .

***

Lemma 5.9. Every tight sequence of graphexes has a subsequence that is Î´ convergent. More generally, every sequence of signed graphexes obeying the condition
(a) from Lemma 5.8 has a Î´ -convergent subsequence. If condition (a) holds with
one or more of the constants B, C, D not depending on Îµ, then the subsequential
limit inherits the corresponding bound.

***
Claim. Suppose that W = (W, S, I, â„¦) is a signed S
graphex, P = (â„¦P , P) is a
finite subspace partition, and P0 âŠ† P. Let â„¦0 = P âˆˆP0 P , P 0 = P \ P0 , and
P 0 = (â„¦0P 0 , P 0 ), where â„¦0P 0 = â„¦P \ â„¦0 . Then (WP )|â„¦0 = (W|â„¦0 )P 0 .

***

Remark 5.10. It is not hard to see that a sequence of signed graphexes Wn =
(Wn , Sn , In , â„¦n ) with kWn kâˆ â‰¤ B and kWn k1 â‰¤ C obeys the condition (a) from
Lemma 5.8 . If B â‰¤ 1, this follows by applying Corollary 4.2 (1) to the sequence
|Wn |, and for B > 1 it follows by applying Corollary 4.2 (1) to the sequence
(|Wn |/B, |Sn |/B, |In |/B, â„¦n ). Choosing a convergent subsequence, it is clear from
the last proof that the limiting graphex W = (W, S, I, â„¦) must obey the bound
kW kâˆ â‰¤ B. The statement from Remark 2.22 therefore is a direct consequence of
Lemma 5.9 .

***

Lemma 6.1. Let F be a simple, connected graph with m edges and n â‰¥ 3 vertices,
and let C, D < âˆ. Suppose that W1 and W2 are graphexes on the same underlying
space â„¦, with kWi k1 â‰¤ C and kDWi kâˆ â‰¤ D for i = 1, 2, and let Îµ = max{kW1 âˆ’
W2 k2â†’2 , kDW1 âˆ’W2 k2 }. Then
e nâˆ’3 ,
|t(F, W1 ) âˆ’ t(F, W2 )| â‰¤ mÎµCD
âˆš
e = max{C, CD}.
where C

***
Corollary 6.2. Suppose Wn , W have uniformly bounded marginals. If
Î´2â†’2 (Wn , W) â†’ 0,

then for any finite graph F with no isolated vertices, t(F, Wn ) converges to t(F, W).

***

Theorem 6.3. Assume that the marginals of Wn and W are bounded by some finite
constant D. Then the following are equivalent:
(1) GT (Wn ) â†’ GT (W) in distribution for every T .
(2) GT (Wn ) â†’ GT (W) in distribution for some T .
(3) For every graph F with no isolated vertices, t(F, Wn ) â†’ t(F, W).
(4) For every connected graph F , t(F, Wn ) â†’ t(F, W).

***

Definition 6.4. Suppose we have a connected multigraph F , and signed graphexes
We assigned to each edge e âˆˆ E(F ) (refer to this vector of graphexes as WF ), each
with the same feature space â„¦. Let Vâ‰¥2 be the set of vertices with degree at least 2.
If Vâ‰¥2 is nonempty (i.e., F does not consist of a single edge), then we define
Z
Y
t(F, WF ) =
dzVâ‰¥2
W{v,w} (zv , zw )
Vâ‰¥2

â„¦

{v,w}âˆˆE(F (Vâ‰¥2 ))

Â·

Y

Y

DW{v,w} (zv ).

vâˆˆVâ‰¥2 wâˆˆV \Vâ‰¥2 :
{v,w}âˆˆE(F )

If F consists of just a single edge f , then
t(F, WF ) = Ï(Wf ),

with Ï(Wf ) as in (??). Note that for signed graphexes t(F, WF ) is in general only
well defined if the integrals are absolutely convergent, a condition which can, e.g.,
abs
be guaranteed by requiring that t(F, Wabs
F ) < âˆ, where WF is obtained from WF
by replacing the graphexes Wf by |Wf |.

***

Definition 6.5. Suppose we have a connected multigraph F with a labeled vertex
v0 , more than one edge, and signed graphexes We assigned to each edge as before. Let
0
x âˆˆ â„¦, and define zv0 = x. Take, furthermore, Vâ‰¥2
= Vâ‰¥2 \{v0 } and Veâ‰¥2 = Vâ‰¥2 âˆª{v0 }.
Then we define tx (F, WF ) to be
Z
Y
Y
Y
0
DW{v,w} (zv ).
dz
W
(z
,
z
)
v
w
V
{v,w}
0
â‰¥2
V
â„¦

â‰¥2

eâ‰¥2 ))
{v,w}âˆˆE(F (V

vâˆˆVâ‰¥2 wâˆˆV \(V
eâ‰¥2 ):
{v,w}âˆˆE(F )

If F consists of just a single edge f adjacent to v0 , then we set tx (F, W) = DW (x).
Again, for signed graphexes, this is in general only well defined if the integrals are
absolutely convergent.

***

Lemma 6.6. Suppose F is a connected multigraph with no loops and a labeled
vertex v0 , T is a spanning tree, and We is a signed graphex corresponding to each
edge e, each with the same feature space â„¦. Let f âˆˆ T be an edge adjacent to v0 ,
and x âˆˆ â„¦. Then
Y
Y
|tx (F, WF )| â‰¤ D|Wf | (x)
kD|We | kâˆ
kWe kâˆ .
eâˆˆT \f

eâˆˆE(F )\T

***

Lemma 6.7. Suppose F is a connected multigraph with no loops, and we have a
signed graphex We corresponding to each edge e âˆˆ F . Let T be any spanning tree in
F , and f âˆˆ T . Then
Y
Y
|t(F, WF )| â‰¤ kWf k1
kD|We | kâˆ
kWe kâˆ .
eâˆˆT \f

eâˆˆE(F )\T

***

Remark 6.8. It is instructive to note that the bound in Lemma 6.1 can be tightened
to give the constant
e = max max{kWi k2 , kDW k2 }
C
i
i
âˆš
e = max{C, CD}. To see this, we first note that near the
instead of the constant C
âˆš
end of the proof, we bounded kDWvu0 k2 by CD, even though it is possible that
the first term is finite while the second is infinite. In a similar way, bounding the
integral representing t(Fu0 , WF,f ) and t(Fv0 , WF,f ) with the help of Lemma 6.7 is
suboptimal. Indeed, the multi-graph Fv0 always contains at least one double edge, or
contain at least one edge uvi and its twin uvi0 , with both vi and vi0 having degree one.
In the first case, Lemma 6.7 can be improved to extract a factor kWf k2 instead
of a factor kWf k1 , in the second it can be improved to extract a factor kDWf k2 .
Inserted into the proof of Lemma 6.1 , this gives the claimed improvement.

***

Remark 6.9. As the reader can easily verify, the above proof immediately generalizes
to signed graphexes, showing that Lemma 6.1 holds for (B, C, D) bounded graphexes,
provided we include a factor of B mâˆ’(nâˆ’1) on the right side. As a consequence,
Corollary 6.2 holds for sequences of (B, C, D)-bounded graphexes that converge in
the kernel distance Î´2â†’2 .

***

Theorem 6.10. Let G and Gn , for n â‰¥ 1, be random finite graphs with no isolated
vertices, and let X and Xn , for n â‰¥ 1, be the random variables that correspond to
the number of vertices in G and Gn , respectively. If, for every t > 0, E[etX ] and
E[etXn ] are finite and uniformly bounded, then the following are equivalent:
(1) For any graph G, the probability that Gn is isomorphic to G converges to
the probability that G is isomorphic to G.
(2) For every graph F , E[inj(F, Gn )] â†’ E[inj(F, G)].
(3) For every graph F with no isolated vertices, E[inj(F, Gn )] â†’ E[inj(F, G)].

***

Lemma 6.11. Suppose we have two random finite graphs with no isolated vertices, G
and G0 . Suppose that for every finite graph F with no isolated vertices, E[inj(F, G)] =
E[inj(F, G0 )]. Let X be the random variable that gives the number of vertices in G,
and suppose that for every t, E[etX ] is finite. Then E[inj(F, G)] and E[inj(F, G0 )]
are equal for every finite graph F .

***

Lemma 6.12. Suppose we have two random finite graphs, G and G0 . Suppose
that for every finite graph F , E[inj(F, G)] = E[inj(F, G0 )]. Let X be the random
variable that gives the number of vertices in G, and suppose that for some Îµ > 0,
E[(2 + Îµ)X ] is finite. Then G and G0 give rise to the same distribution on graphs
(up to isomorphism).

***

Lemma 6.13. Given t > 0, let t0 = 2t + log 4. Then the following holds for any
positive integer n and any graph G on n vertices with no isolated vertices. Suppose
we randomly color the vertices red and blue, and let X be the number of vertices
that are colored red, and have at least one blue neighbor. Then
0

E[et X ] â‰¥ etn .

***

Lemma 6.14. For any T, t, C, D âˆˆ R+ , there exists a finite B such that the
following holds. Suppose we have a graphex W, with kDW kâˆ â‰¤ D and kWk1 â‰¤ C.
Let X be the number of vertices (that are not isolated) of GT (W). Then E[etX ] â‰¤ B.

***

Theorem 6.15. Given two graphexes W, W0 with bounded marginals, the following
are equivalent:
(1) GT (W) and GT (W0 ) have the same distribution for every T .
(2) GT (W) and GT (W0 ) have the same distribution for some T .
(3) For every graph F with no isolated vertices, t(F, W) = t(F, W0 ).
(4) For every connected graph F , t(F, W) = t(F, W0 ).

***
Theorem 6.16. Suppose Wn and W have uniformly bounded marginals, and
Î´2â†’2 (Wn , W) â†’ 0. Then Wn is GP-convergent to W.

***
Theorem 6.17. Suppose that graphexes W and (Wn )âˆ
n=1 have the property that
Î´ (Wn , W) â†’ 0. Then Wn is GP-convergent to W.

***
Theorem 7.1. For every graphex W and Îµ > 0,
lim P[Î´ (W(GT (W), 1/T ), W) > Îµ] = 0.

T â†’âˆ

For a set of graphexes that is tight, the convergence is uniform.

***

Remark 7.2. The above theorem only claims convergence in probability. However,
once we establish equivalence of GP-convergence and convergence in the weak
kernel norm, the results of [18] imply convergence with probability one (since there
convergence with probability one is proved for GP-convergence). Nevertheless, to
establish the equivalence, all we need is convergence in probability, so this is all we
will prove here.

***

Theorem 7.3. Suppose W1 , W2 are two (C, D)-bounded graphexes on the same
space â„¦, and suppose that d2â†’2 (W1 , W2 ) â‰¤ c for some 0 < c < 1. Then there exists
a T0 (depending only on c, C, and D) such that for any T > T0 , there exists a
coupling of the random graphs GT (W1 ) and GT (W2 ) so that
h

i
âˆš
3
P Î´2â†’2 (W(GT (W1 ), 1/T ), W(GT (W2 ), 1/T )) > min (31cC)1/4 , 2c3/4 , 3c < c.

***

Lemma 7.4. Let W = (W, S, I, â„¦) be a (C, D)-bounded graphex, and T > 1/D.
e T (W) consist of only those
Let GT (W) be the usual sample at time T , and let G
edges which come from I or S. Then
"

1/4 #
2CD
1
e T (W), 1/T )k2â†’2 > âˆš
P kW (G
<âˆš .
T
T

***

Lemma 7.5. Suppose H is a weighted graph on N with weights Hi,j âˆˆ [0, 1], and
Hi,i = 0. Suppose that G is generated by taking an edge betweenP
i and j with
probability Hi,j , independently for every pair of vertices. Suppose that i,j Hi,j â‰¤ E
P
and i,j,k Hi,j Hj,k â‰¤ F where the sum goes over pairwise distinct vertices. Let
0 < Ï. Then
âˆš
P[kW(G, Ï) âˆ’ W(H, Ï)k2â†’2 > Ï7/8 (E + 2F )1/4 ] < Ï.

***

Lemma 7.6. For every Îµ, C, and D, there exist M , N , and Ï such that the following
holds. For every (C, D)-bounded graphex W, there exists a (C, D)-bounded graphex
WÎµ = (WÎµ , 0, 0, â„¦Îµ ), where â„¦Îµ = (â„¦Îµ , FÎµ , ÂµÎµ ) and ÂµÎµ (â„¦Îµ ) â‰¤ N , and furthermore
the graphon WÎµ is a step function with at most M steps, with each part having size
equal to Ï, and Î´2â†’2 (W, WÎµ ) â‰¤ Îµ.

***

Remark 7.7. Using the ideas of the previous proof, it is not hard to see that
e D)
fQ , 0, 0, â„¦
in distribution, the process generated from the graphex f
WQ = ( W
constructed in Remark 2.3 (3) converges to the one generated from W. Indeed, we
claim that
Î´ (f
WQ , W) â†’ 0
as
Q â†’ âˆ.
To see this, fix Îµ > 0 and choose D in such a way that the set â„¦>D = {DW > D}
e â‰¤D = â„¦â‰¤D âˆª {âˆ} = â„¦
e \ â„¦>D .
has measure at most Îµ2 . Let â„¦â‰¤D = â„¦ \ â„¦>D and â„¦
f
Setting f
WQ,â‰¤D = (f
WQ )|â„¦\â„¦
e >D and Wâ‰¤D = W|â„¦\â„¦>D and defining Wâ‰¤D as the
e â‰¤D , we will want to show that for Q large enough,
trivial extension of Wâ‰¤D to â„¦
f
f
d2â†’2 (Wâ‰¤D , WQ,â‰¤D ) â‰¤ Îµ, since this implies that Î´2â†’2 (Wâ‰¤D , f
WQ,â‰¤D ) â‰¤ Îµ and hence
fQ , W) â‰¤ Îµ. But this follows by essentially the same argument as the one in the
Î´  (W
previous proof; all that is needed is that by Proposition 2.4 , f
Wâ‰¤D is (C, D)-bounded
for some C < âˆ.

***

Lemma 7.8. For every N0 , Îµ, and Î´, there exists n0 such that the following holds.
For any weighted graph H on n â‰¥ n0 vertices with weights in [0, 1], and any N â‰¤ N0 ,
the probability that Î´2â†’2 (W(H, N/n), W(G(H), N/n)) > Îµ is at most Î´.

***

Theorem 7.9. Given a pair of graphexes W, W0 , we have Î´ (W, W0 ) = 0 if and
only if for every T > 0, GT (W) and GT (W0 ) have the same distribution.

***

Theorem 8.1. Let W1 = (W1 , S1 , I1 , â„¦1 ) and W2 = (W2 , S2 , I2 , â„¦2 ) be graphexes,
where â„¦i = (â„¦i , Fi , Âµi ) are Ïƒ-finite spaces. Suppose Î´ (W1 , W2 ) = 0. Then there
exists a third graphex W = (W, S, I, â„¦) over a Ïƒ-finite measure space â„¦ = (â„¦, F, Âµ)
and measure preserving maps Ï†i : dsupp Wi â†’ â„¦ such that Wi |Ï†âˆ’1 (â„¦) = WÏ†i (and
Wi , Si = 0 everywhere else) for i = 1, 2.

***

Theorem 8.2. Let W1 = (W1 , S1 , I1 , â„¦1 ) and W2 = (W2 , S2 , I2 , â„¦2 ) be graphexes,
where â„¦i = (â„¦i , Fi , Âµi ) are Ïƒ-finite Borel spaces. Suppose further that DWi > 0
everywhere for i = 1, 2, and Î´ (W1 , W2 ) = 0. Then Âµ1 (â„¦1 ) = Âµ2 (â„¦2 ), I1 = I2 , and
there exists a coupling of â„¦1 and â„¦2 , that is, a measure Î½ on (â„¦1 Ã— â„¦2 , F1 Ã— F2 )
with marginals Âµ1 and Âµ2 , such that if Ï€i : â„¦1 Ã— â„¦2 â†’ â„¦i is the projection map, then
W1Ï€1 = W2Ï€2 Î½-almost-everywhere, and S1Ï€1 = S2Ï€2 Î½-almost-everywhere.

***

Remark 8.3. Throughout this paper, we have considered graphexes where all three
parts are non-negative. While this makes sense when considering graphexes as
generators of a graphex process, from an analytical point of view, it is less natural.
Indeed, it is easy to define the kernel and weak kernel distance for graphexes where
the three parts take values in R. Taking, e.g., the kernel distance d2â†’2 defined
1
in (??), all we need to do
R is replace the RL norms in the third part by a signed
â€œedge densityâ€ Ï(Wi ) = W dÂµ Ã— dÂµ + 2 S dÂµ + 2I, and then use the third root
of |Ï(W1 ) âˆ’ Ï(W2 )| instead of the third root of |kW1 k1 âˆ’ kW2 k|. In particular in
view of the just discussed results from [3] and [17], we conjecture that Theorem 8.2
holds for signed graphexes as well, provided the condition DWi > 0 is replaced by
the condition D|Wi | > 0, where |Wi | is obtained from Wi by replacing all three
components of Wi by their absolute values. We leave the proof of this conjecture as
an open problem.

***

Remark 8.4. Section ?? does not use nonnegativity in any essential way, and should
easily generalizable to signed graphexes. This should give a relatively straightforward
proof of the analogue of Theorem 8.1 for graphons of cut distance zero, and also
allow for the more general setting of signed graphexes, once the above conjectured
generalization of Theorem 8.2 is established. Again we leave this as an open
problem.

***
Lemma 8.5. For any c,
(1) limÎµâ†’0 Î½Îµ (â„¦1,>c Ã— â„¦2,>c ) = Âµi (â„¦i,>c ) for i = 1, 2 (regardless of the choice
of Î½Îµ ), and
(2) Âµ1 (â„¦1,>c ) = Âµ2 (â„¦2,>c ).

***

Lemma 8.6. For any n â‰¥ 1, there exists a measure Î½n on â„¦1,>1/n Ã— â„¦2,>1/n such
that the following hold:
(1) Î½n is a coupling of â„¦1,>1/n and â„¦2,>1/n ,
(2) Î½n+1 |â„¦1,>1/n Ã—â„¦2,>1/n = Î½n ,
(3) W1Ï€1 and W2Ï€2 are equal when restricted to (â„¦1,>1/n Ã— â„¦2,>1/n )2 , Î½n Ã— Î½n almost everywhere, and
(4) DWÏ€1 1 and DWÏ€2 2 are equal when restricted to â„¦1,>1/n Ã— â„¦2,>1/n , Î½n -almost
everywhere.

***

Corollary 8.7. Let W = (W, S, I, â„¦) and W0 = (W 0 , S 0 , I 0 , â„¦0 ) be graphexes that
are equivalent, and suppose that DW , DW0 > 0 everywhere. Then there exist a
positive integer n and a chain of graphexes Wi = (Wi , Si , Ii , â„¦i ) for i = 0, . . . , n,
with DWi > 0 everywhere for each i = 0, . . . , n, W0 = W, Wn = W0 , and for each
i â‰¥ 1, either Wiâˆ’1 = WÏ†i i almost everywhere for some measure preserving map Ï†i
i
from â„¦iâˆ’1 to â„¦i , or Wi = WÏ†iâˆ’1
almost everywhere for some Ï†i from â„¦i to â„¦iâˆ’1 .
In fact, we can take n = 4.

***

Lemma 8.8. Suppose that (â„¦, F, Âµ) and (â„¦0 , F 0 , Âµ0 ) are Ïƒ-finite measure spaces,
W : â„¦ Ã— â„¦0 â†’ R is measurable, and for all x âˆˆ â„¦, the function W (x, Â·) is integrable.
Let ÏˆW : â„¦ â†’ L1 (â„¦, F, Âµ) be the map x 7â†’ W (x, Â·). Then we can find a separable
closed subspace B of L1 (â„¦0 , F 0 , Âµ0 ) such that ÏˆW (x) âˆˆ B for all x âˆˆ â„¦.

***

Lemma 8.9. Suppose (â„¦, F, Âµ) and (â„¦0 , F 0 , Âµ0 ) are Ïƒ-finite measure spaces, W : â„¦Ã—
â„¦0 â†’ R is F Ã— F 0 -measurable, and that for all x âˆˆ â„¦, the function W (x, Â·) is
integrable. Then the map ÏˆW : â„¦ â†’ L1 (â„¦0 , F 0 , Âµ0 ) with x 7â†’ W (x, Â·) is measurable
with respect to the standard Borel Ïƒ-algebra on L1 (â„¦, F, Âµ). .

***

Lemma 8.10. Let (â„¦, F, Âµ) be any Ïƒ-finite measure space, and B âŠ† L1 (â„¦, F, Âµ) a
closed separable subspace. Then there exists a measurable evaluation map
Î¦: B Ã— â„¦ â†’ R

such that for any f âˆˆ B, for almost every x âˆˆ â„¦, f (x) = Î¦(f, x) (note that f (x) is
only defined almost everywhere). In particular, if L1 (â„¦, F, Âµ) is separable, we can
take B = L1 (â„¦, F, Âµ).

***

Lemma 8.11. Suppose that (â„¦, F, Âµ) and (â„¦0 , F 0 , Âµ0 ) are Ïƒ-finite measure spaces,
W : â„¦ Ã— â„¦0 â†’ R is measurable, and for all x âˆˆ â„¦ and x0 âˆˆ â„¦0 , both W (x, Â·) and
W (Â·, x0 ) are integrable. Let ÏˆW be the map â„¦ â†’ L1 (â„¦0 , F 0 , Âµ0 ) with x 7â†’ W (x, Â·),
0
and ÏˆW
be the map â„¦0 â†’ L1 (â„¦, F, Âµ) with y 7â†’ W (Â·, y). Further, let G be the Borel
Ïƒ-algebra on L1 (â„¦, F, Âµ), and let
âˆ’1

0
FW
= Ïˆ 0 W (G).

0
Then for almost every x âˆˆ â„¦, ÏˆW (x) âˆˆ L1 (â„¦0 , FW
, Âµ0 ).

***

Proposition 8.12. The space â„¦W as defined above is a complete, separable metric
e F,
e Âµ
e), and ÂµW has full support in â„¦W .
space, with the metric induced by L1 (â„¦,
e FeW , Âµ
e FeW , Âµ
Furthermore, â„¦W âŠ† L1 (â„¦,
e) âŠ† L1 (â„¦,
e). Finally, after modifying W and
S on a set of measure zero ÏˆW becomes an everywhere defined, measure-preserving
âˆ’1
map from (â„¦, F, Âµ) to (â„¦W , GW , ÂµW ), and we furthermore have ÏˆW
(GW ) = FW .

***

Lemma 8.13. Let â„¦W and ÂµW be as defined above, and let GW be the Borel Ïƒalgebra over â„¦W . If W is locally finite, W (x, Â·) is integrable for all x âˆˆ â„¦, and
Âµ(â„¦ \ dsupp W) < âˆ, then (â„¦W , GW , ÂµW ) is Ïƒ-finite.

***

Remark 8.14. Note that the condition Âµ(â„¦ \ dsupp W) < âˆ is necessary, since
otherwise the point {(0, 0)} becomes an atom with infinite measure.

***

Lemma 8.15. For i = 1, 2, let Wi = (Wi , Si , Ii , â„¦i ) be graphexes with â„¦i =
(â„¦1 , Fi , Âµi ) and Âµi (â„¦i \dsupp Wi ) = 0. Suppose that there exists a measure-preserving
e1 â†’ â„¦
e2
map Ï† : â„¦1 â†’ â„¦2 such that W1 = WÏ†2 almost everywhere. Extend Ï† to Ï†e : â„¦
1 e
âˆ—
1 e
e
e
by Ï†(â„¦1,âˆ ) = â„¦2,âˆ . Then the map Ï† : L (â„¦2 ) â†’ L (â„¦1 ) defined by f 7â†’ f â—¦ Ï†e
restricts to a map â„¦W2 â†’ â„¦W1 , which is an isometric measure-preserving bijection
âˆ—
between (â„¦W2 , GW2 , ÂµW2 ) and (â„¦W1 , GW1 , ÂµW1 ), and c
W2 = c
WÏ†1 almost everywhere,
for any choices of c
W1 and c
W2 .

***

Theorem 9.1. Given a set of integrable graphexes S, the following are equivalent.
(1) S is uniformly integrable.
(2) The graphexes in S have uniformly bounded k Â· k1 -norms, and for every
Îµ > 0, there exists a D such that for all W âˆˆ S, kWk1 âˆ’ kWâ‰¤D k1 < Îµ.
(3) For any T > 0, the random variables E(GT (W)) with W âˆˆ S are uniformly
integrable.
(4) There exists T > 0 such that the random variables E(GT (W)) with W âˆˆ S
are uniformly integrable.

***

Lemma 9.2. Suppose that a set of graphexes consisting only of graphons is uniformly
tail regular. Then the set is uniformly integrable.

***
Lemma 9.3. Given a set of graphons S, the following are equivalent:
(1) The set of graphons is uniformly tail regular.
(2) The set of graphons has a uniform bound on their k Â· k1 -norm, and for every
Îµ, there exists a Î´ such that kW k1 âˆ’ kW |â„¦>Î´ k1 â‰¤ Îµ.
(3) The set of graphons has a uniform bound on their k Â· k1 -norm, and for every
Îµ, there exists a Î´ such that kDW 1DW â‰¤Î´ k1 â‰¤ Îµ.

***

Corollary 9.4. Given a set of graphons S, suppose that we replace each graphon
with a pullback. Let S 0 be the new set. Then S 0 is uniformly tail regular if and only
if S is.

***

Lemma 9.5. Suppose that a sequence of integrable graphons Wn converge to a
graphon W in the cut metric. Then for any D > 0 such that Âµ(DW = D) = 0, the
graphons Wn,â‰¤D converge to Wâ‰¤D in the cut metric.

***

Lemma 9.6. Suppose that a sequence of integrable graphons Wn have uniformly
bounded marginals, and converge to a (necessarily integrable) graphon W in the cut
metric. Then W has the same bound on its marginals, and Î´2â†’2 (Wn , W) â†’ 0.

***

Lemma 9.7. Suppose that Î´ (W, W0 ) = 0 for two integrable graphexes, and suppose
that W = (W, 0, 0, â„¦). Then W0 = (W 0 , 0, 0, â„¦0 ) and Î´ (W, W 0 ) = 0.

***

Lemma A.1. Let Ïˆ(x) = 1 âˆ’ eâˆ’x . Then the following hold, with both side of the
various identities being possibly infinite:
(1) E[Î·(S)] = kSk1 and E[Î· 2 (W )] = kW k1 ,
(2) E[Ïˆ(Î·(S))] = Ïˆ(kÏˆ(S)k1 ), and
(3) E[(Î· 2 (W ))2 ] = kW k21 + 4kW â—¦ W k2 + 2kW 2 k1 .

***

Proposition A.2. Let S : â„¦ â†’ R+ be measurable, and let W : â„¦ Ã— â„¦ â†’ [0, 1] be
symmetric and measurable. Then the following hold:
(1) Î·(S) < âˆ a.s. if and only if k min{S, 1}k1 < âˆ, and
(2) Î· 2 (W ) < âˆ a.s. if and only if there exists a finite D > 0 such that the
following three conditions hold:
(a) DW < âˆ almost surely,
(b) Âµ({x âˆˆ â„¦ : DW (x) > D}) < âˆ, and
(c) kW |{xâˆˆâ„¦:DW (x)â‰¤D} k1 < âˆ.

***

Proposition B.1. For any graphex W = (W, S, I, â„¦), there exists a graphex f
W=
e on an atomless space â„¦
e such that on the diagonal, W
f , S,
e I,
e â„¦)
f is {0, 1} valued
(W
and such that Geâˆ (f
W) and GeT (f
W) are equivalent to Geâˆ (W) and GeT (W), respectively.

***

Theorem B.2. Let W1 and W2 be graphexes with special subsets as above. Then
GeT (W1 ) and GeT (W2 ) have the same distribution for all T âˆˆ R+ if and only if there
exists a third graphex with special subset W such that W1 and W2 are pullbacks of
W.

