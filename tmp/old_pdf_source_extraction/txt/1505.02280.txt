***
Theorem 1. [Removal lemma for representable systems] Let (A, G, m) be a Γ-representable family of systems.
Let (A, G) be an element in the family associated to γ = (γ1 , . . . , γm ). Let X1 , . . . , Xm be subsets of G and let
X = X1 × · · · × Xm .
For every ε > 0 there exists a δ = δ(m, ε) > 0, universal for all the members of the family, such that if
|S(A, G, X)| < δ|S(A, G)|,
then there are sets Xi0 ⊂ Xi with |Xi0 | < ε|G|/γi for which
S (A, G, X \ X 0 ) = ∅,
0
where X \ X 0 = (X1 \ X10 ) × · · · × (Xm \ Xm
).

***
Theorem 2. [Removal lemma for linear systems over abelian groups] Let G be a finite abelian group and let m, k
be two positive integers. Let A be a group homomorphism from Gm to Gk . Let b ∈ Gk . Let Xi ⊂ G for i = [1, m],
and X = X1 × · · · × Xm .
For every ε > 0 there exists a δ = δ(m, ε) > 0 such that, if
|S((A, b), G, X)| < δ |S((A, b), G)| ,
then there are sets Xi0 ⊂ Xi ∩ Si ((A, b), G) with |Xi0 | < ε|Si ((A, b), G)| and
0
S ((A, b), G, X \ X 0 ) = ∅, where X \ X 0 = (X1 \ X10 ) × · · · × (Xm \ Xm
).

Also, let I ⊂ [1, m] be such that Xi ⊃ Si ((A, b), G) for i ∈ I. The previous statement holds with the extra condition
that Xi0 = ∅ for i ∈ I.

***
Theorem 3. [Removal lemma for finite abelian groups, Theorem 1 in [21]] Let G be a finite abelian group and let
m, k be two positive integers. Let A be a k × m integer matrix with determinantal coprime with the order of the
group |G|.9 Let b ∈ Gk . Let Xi ⊂ G for i = [1, m], and X = X1 × · · · × Xm . For every ε > 0 there exists a
δ = δ(m, ε) > 0 such that, if
|S((A, b), G, X)| < δ |S((A, b), G)| = δ|Gm−k |,
then there are sets Xi0 ⊂ Xi ∩ Si ((A, b), G) with |Xi0 | < ε|G| and
0
S ((A, b), G, X \ X 0 ) = ∅, where X \ X 0 = (X1 \ X10 ) × · · · × (Xm \ Xm
).

***
Theorem 4. [Removal lemma for subgroups] For every  > 0 and every positive integer m, there exists a δ =
δ(, m) > 0 such Q
that the following holds. Let G1 , . . . , Gm be finite abelian groups. Let S be a subgroup of G1 × · · · ×
Gm and let s ∈ i∈[m] Gi . Let Xi be a subset of Gi for each i ∈ [1, m]. If | [X1 × · · · × Xm ] ∩ s + S| < δ|S| then
0
0
there exist X10 , . . . , Xm
, with |Xi0 | < πi (S) for all i ∈ [1, m], such that {[X1 \ X10 × · · · × Xm \ Xm
] ∩ s + S} = ∅. If
0
πi (s + S) ⊂ Xi , for some i ∈ [1, m] then we can assume Xi = ∅.

***
Proposition 5. [Proposition 6 in [6]] Suppose that σ ∈ S(n), τ ∈ S(m). For every  > 0 there exist a δ = δ(, m) >
0 such that, if |Λτ (σ)| < δnm , then we may delete at most n2 index pairs to destroy all copies of τ in σ.

***
Theorem 6. [Multidimensional Szemerédi for finite abelian groups, Theorem B.2 in [37]] Let ε > 0. Let Gm be
a finite abelian group and let S ⊂ Gm be such that |S|/|Gm | ≥ ε. There exists δ = δ(ε, m + 1) > 0 such that
the number of configurations of the type {(x1 , . . . , xm ), (x1 + a, x2 , . . . , xm ), . . . , (x1 , x2 , . . . , xm + a)} ⊂ S, for some
a ∈ G, is at least δ|G|m+1 .

***
Corollary 7. Let G be a finite abelian group, let A be a k × m homomorphism for G and let b ∈ Gk . Assume that
S(A, G) = S((A, b), G) ⊂ Gm contains a set R satisfying the following conditions.
(i) The projection of R onto the i-th coordinate of Gm is Si (A, G). This is, πi (R) = Si (A, G).
(ii) For each i ∈ [1, m] and for each pair g1 , g2 ∈ Si (A, G), |πi−1 (g1 ) ∩ R| = |πi−1 (g2 ) ∩ R|.
Then, for every ε > 0 there exists a δ = δ(ε, m) > 0 such that, for any S ⊂ G with |S m ∩ R| > ε|R|, we have
|S(A, G, S m )| ≥ δ |S(A, G)|.

***
Corollary 8. Let G be a finite abelian group, let G1 , . . . Gs be subgroups of G.
homomorphisms

Let Φ1 , . . . , Φt be group

Φi : G1 × · · · × Gs → G
(x1 , . . . , xs ) 7→ Φi (x1 , . . . , xs ).
For every  > 0 there exists a δ = δ(, t) > 0 such that, for every S ⊂ G with S ≥ |G|,
(
)
s


Y


Gi | (x + Φ1 (x), . . . , x + Φt (x)) ∈ S t  >
 x ∈ G, x ∈


i=1
(
)
s


Y

t 
δ  x ∈ G, x ∈
Gi | (x + Φ1 (x), . . . , x + Φt (x)) ∈ G  .


i=1

***
Theorem 9. [Saxton, Thomason, Theorem 10.3/2.10 in [30]/[31] with Theorem 2 ] Let {Gi }i∈I be a sequence of
finite abelian groups. Let Ai be a sequence of abundant k × m homomorphism systems and bi ∈ Gki a sequence
of independent vectors such that |S((Ai , bi ), Gi )| = |Gi |m−k . Let Z be such that Z ⊂ S((Ai , bi ), Gi ) and |Z| =
o(|Gi |m−k ). Then the number of Z-solution-free subsets of Gi is 2ex(Ai ,bi ,Gi )+o(|Gi |) .

***
Definition 10. [(strongly) representable system] The family of finite systems (A, G, m) is said to be Γ-representable
if there are positive real numbers χ1 , χ2 , depending on the family (A, G, m), and for each (A, G) ∈ (A, G, m) and the
γ = (γ1 , . . . , γm ) ∈ Γ associated with (A, G), there exists a pair of coloured hypergraphs (K, H) with the following
properties RP1 , RP2 and RP3 .
RP1

• K and H are s-uniform m-colored hypergraphs.
• H has m different edges {e1 , . . . , em } and the edge ei is coloured i. Moreover χ1 ≥ |V (H)| = h > s ≥ 2.
• Each edge in K bears a label in G given by l : E(K) → G.

RP2 There exist a positive integer p, a set Q, and a surjective map r
r : C(H, K) −→ S(A, G) × Q
H = {e1 , . . . , em } 7−→ (r0 (H), rq (H))
such that r0 (H) = (l(e1 ), . . . , l(em )), and, for any given x ∈ S(A, G) and q ∈ Q, the set r−1 (x, q) has size
|r

−1

(x, q)| = pλ

m
Y

γi with λ = c

i=1

|K|s
|G|

for some c ≥ χ2 .
RP3 If ei is an edge coloured i in a copy H ∈ r−1 (x, q), then p

Qm

j=1

γi

γj

copies of H in r−1 (x, q) contain ei .

If, additionally,
RP4 For any edge ei coloured i and l(ei ) = xi , there exists a copy of H ∈ r−1 (x, q), with (x)i = xi , containing ei ,
then the family is said to be strongly Γ-representable.

***
Theorem 11. [Removal lemma for colored hypergraphs [2]] For any positive integers r, h, s with h ≥ s ≥ 2 and
every ε > 0 there exists δ > 0 depending on r, h, s and ε such that the following holds.
Let H and K be r-colored s-uniform hypergraphs with h = |V (H)| and M = |V (K)| vertices respectively. If the
number of copies of H in K (preserving the colors of the edges) is at most δM h , then there is a set E 0 ⊆ E(K) of
size at most εM s such that the hypergraph K 0 with edge set E(K) \ E 0 is H–free.

***
Claim 1. If H0 , with V (H0 ) = {x0 < · · · < xt−1 }, is a copy of Gτ = ([0, t − 1], E(Gτ )) in Gσ , then the only map
(homomorphism) from f : V (Gτ ) → V (H0 ) with the property “if e = {i → j} ∈ E(Gτ ) and is coloured c, then
{f (i) → f (j)} ∈ E(Gσ |V (H0 )) and is coloured c” is the map f (i) = xi for all i ∈ [0, t − 1].

***
Claim 2. If H0 , with V (H0 ) = {x0 < · · · < xt−1 } is a copy of Gτ in Gσ where xi ∈ V (Gσ ) corresponds to the i-th
vertex of Gτ , then {x0 < · · · < xm−1 } ∈ Λτ (σ).

***
Claim 3. If {x0 < · · · < xt−1 } ∈ Λτ (σ) then the graph induced by x0 , x1 , . . . , xt−1 in Gσ is a copy of Gτ with the
map from V (Gτ ) = [0, t − 1] to {x0 , x1 , . . . , xt−1 } ⊂ V (Gσ ) given by i 7→ xi for i ∈ [0, t − 1].

***
Proposition 12. [1-auto-equivalent systems] Let ((A2 , b2 ), G) be a k2 × m2 system 1-auto-equivalent to
((A1 , b1 ), G), a k1 × m1 system. Assume ((A2 , b2 ), G) is γ 0 -representable by (K 0 , H 0 ) with constants χ1 , χ2 . If
the edges coloured by σ(1), . . . , σ(m1 ) cover all the vertices of H 0 , then (A1 , G) is γ-representable with the same
0
constants χ1 , χ2 and γi = γσ(i)
. If ((A2 , b2 ), G) is strongly representable, then so is ((A1 , b1 ), G).

***
Proposition 13. [µ-auto-equivalent systems] Let ((A2 , b2 ), G) be a k2 ×m2 system µ-auto-equivalent to the k1 ×m1
system ((A1 , b1 ), G), m2 ≥ m1 . Let
φ : S((A2 , b2 ), G) −→ S((A1 , b1 ), G)
(x1 , . . . , xm2 ) 7−→ (x1 , . . . , xm1 )
0
be the map that defines the µ-auto-equivalence. Assume ((A2 , b2 ), G) is (γ10 , . . . , γm
)-representable by (K 0 , H 0 ) with
2
0
0
constants χ1 , χ2 . If the edges coloured by 1, . . . , m1 cover all the vertices of H , then ((A1 , b1 ), G) is (γ10 , . . . , γm
)1
representable with χ1 , χ2 as constants. If ((A2 , b2 ), G) is strongly representable, then so is ((A1 , b1 ), G).

***
Proposition 14. [µ-equivalent systems 1] Let ((A2 , b2 ), G2 ) be a k2 ×m1 system µ-equivalent to the k1 ×m1 system
((A1 , b1 ), G1 ) with
φ : S((A2 , b2 ), G2 ) −→ S((A1 , b1 ), G1 )
(x1 , . . . , xm1 ) 7−→ (φ1 (x1 ), . . . , φ1 (xm1 ))
0
0
be the map that defines the µ-equivalence. Assume (A
Q2m,1G2 )−1is (γ1 , . . . , γm1 )-representable by (K , H ) with constants
−1
χ1 , χ2 . If φ1 : G2 → G1 is surjective and φ (x) = i=1 φ1 ((x)i ) then ((A1 , b1 ), G1 ) is (γ1 , . . . , γm1 )-representable
with the same constants χ1 , χ2 . If ((A2 , b2 ), G) is strongly representable, then so is ((A1 , b1 ), G).

***
Proposition 15. [µ-equivalent systems 2] Let ((A2 , b2 ), G2 ) be a k2 ×m2 system µ-equivalent to the k1 ×m1 system
((A1 , b1 ), G1 ) with m2 ≥ m1 . Let
φ : S((A2 , b2 ), G2 ) −→ S((A1 , b1 ), G1 )
(x1 , . . . , xm2 ) 7−→ (φ1 (x1 ), . . . , φm1 (xm1 ))
be the map that defines the µ-equivalence. Assume ((A2 , b2 ), G2 ) is γ 0 -strongly-representable by (K 0 , H 0 ) with
constants χ1 , χ2 . Assume the following.
(i) The edges coloured by [1, m1 ] cover all the vertices of H 0 .
(ii) Given x ∈ S((A1 , b1 ), G1 ) and i ∈ [1, m1 ], then
|{y ∈ S((A2 , b2 ), G2 ) : φ(y) = x and (y)i = yi }|
is constant for any yi ∈ Si ((A2 , b2 ), G2 ) with φi (yi ) = (x)i .
|Si ((A2 ,b2 ),G2 )| |G1 |
for i ∈ [1, m1 ] and the same constants
Then ((A1 , b1 ), G) is strongly γ-representable with γi = γi0 |S
i ((A1 ,b1 ),G1 )| |G2 |
χ1 , χ2 .

***
Proposition 16. [Representation: any independent vector] Either there is no solution to Ax = b, x ∈ Gm or
((A, 0), G) is 1-auto-equivalent to ((A, b), G).

***
Observation 17. τ 0 : S((A0 , b), G0 ) → S((A, b), G) is surjective. If Si ((A, b), G) is the translated subgroup obtained
by projecting the solution set to the i-th coordinate of Gm , then τ −1 (Si ((A, b), G)) = Si ((A0 , b), G0 ) and
|G|
|G0 |
=
.
|Si ((A, b), G)|
|Si ((A0 , b), G0 )|
Qm
Moreover, for any x ∈ S((A, b), G), τ 0−1 (x) = i=1 τ −1 ((x)i ).

***
Remark 18. Observe that ((A0 , b), Ztn ) is µ-equivalent to ((A, b), G) with the surjective map τ 0 : S(A0 , G0 ) →
S(A, G) and that the hypotheses of Proposition 14 regarding the map φ = τ 0 hold by Observation 17 .

***
Proposition 19. [Row multiples] Let A be a k × m, m ≥ k integer matrix. Let d1 , . . . , dk denote its diagonal
elements of the Smith Normal Form of A. There is a matrix A(1) , equivalent to A (row reduced), such that the row
A(1)
j satisfies


	
gcd A(1)
j,i i∈[1,m] = dj .
Furthermore, assume that di 6= 0 for i ∈ [1, k]. The matrix A(2) , obtained from A(1) by dividing the row A(1)
j by dj ,
has k-th determinantal one.

***
Observation 20. [Solution set] Using Proposition 19 :
S(A, G) =

[

S((A(2) , b), G), for b ∈

b

where di is the greatest common divisor of the i-th row of A(1) .

k
Y
i=1

Pdi (G),

***
Observation 21. [Simulating the independent vector for Zsn ] Assume G = Zsn . For each row A(1)
j , the equation
(2)
A(2)
j,1 x1 + · · · + Aj,m xm −

n
yj = 0,
gcd(n, dj )

where yj is a new variable with yj ∈ G, is |Pn/ gcd(n,dj ) (G)|-auto-equivalent to

(1)
(2)
(2)
A(1)
j,1 x1 + · · · + Aj,m xm = dj Aj,1 x1 + · · · + Aj,m xm = 0.
The application (x1 , . . . , xm , yi ) → (x1 , . . . , xm ) gives the |Pn/ gcd(n,dj ) (G)|-auto-equivalence.
Moreover, for each value of the j-th component of the independent vector g ∈ Pdj (G), there are |G|/|Pdj (G)| values
for yj with
n
yj = g.
gcd(n, dj )

***
Remark 22. The system (A(3) , Ztn ) is µ-auto-equivalent to (A(1) , Ztn ) with
φ : S(A(3) , Ztn ) −→ S(A(1) , Ztn )
(x1 , . . . , xm , xm+1 , . . . , xm(3) ) 7−→ (x1 , . . . , xm ),
where µ is the number of preimages by φ of each x ∈ S(A(1) , Ztn ) in S(A(3) , Ztn ). If m(3) = m + k then µ =
Qtk
n
i=1 gcd(di ,n) .

***
Lemma 23. [Matrix extension, Lemma 9 in [21]] Let A be a k × m integer matrix, m ≥ k. There is an m × m
integer matrix N that contains A in its first k rows and is such that det(N ) = Dk (A).

***
Remark 24. The system ((A(4) , 0), G), hence ((A(5) , 0), G), is 1-auto-equivalent to ((A(3) , 0), G). Indeed, for any
solution y ∈ S(A(4) , G) there exists one, and only one, solution x ∈ S(A(3) , G) such that the projection
y = (y1 , . . . , ytm(5) ) 7−→ (y1 , . . . , ytm , ytm+(tm−tk)+1 , . . . , ytm(5) )
gives x.14

***

Observation 25. Let A = A0 B , with B being a k × m, m ≥ k integer matrix and A0 denotes a square matrix
of dimension k. Let n be a positive integer and assume that gcd(Dk (B), n) = 1. Then, for any value of x1 , . . . , xk ,
xi ∈ Zn , there are nm−k values for (xk+1 , . . . , xk+m ) ∈ Zm
n with Ax = 0.

***
Remark 26. (A(6) , Ztn ) is 1-auto-equivalent to (A(5) , Ztn ) with
φ : S(A(6) , Ztn ) −→ S(A(5) , Ztn )
(1)
x = (x1 , . . . , xm(5) ) 7−→ (φ(1)
1 (x1 ), . . . , φm(5) (xm(5) ))

being the map between the solutions sets.

***
Remark 27. For any κ ∈ Υ, the homomorphism
fκ : S(Jκ , Gtκ ) −→ S(A(6) , Gtκ ) ⊂ S(A(6) , Ztn )



d1,1 x(1,1) , . . . , d1,t x(1,t)
..


 



.
x(1,1) , . . . , x(1,t)




dk(6) ,1 x(k(6) ,1) , . . . , dk(6) ,t x(k(6)


..
 ,t) 

 7−→ 
.


x(k(J) +1,1) , . . . , x(k(J) +1,t)



x(m(J) ,1) , . . . , x(m(J) ,t)


..


.

x(m(J) −1,1) , . . . , x(m(J) −1,t)
is surjective and |Gtκ |-to-1.

***
Proposition 28. Let A be a kt × mt integer matrix, m ≥ k, formed by km blocks of size t × t. Assume that
A is block n–circular. Then there exists a m × m block integer matrix C = (Ci,j ), each block of size t × t and
(i, j) ∈ [1, m]2 , with the following properties.
i. AC = 0
ii. The i-th row of t × t blocks is such that Ci,j = 0, for j
matrix looks like

∗ ∗
0 ∗

0 0
C=
∗ 0

∗ ∗
∗ ∗

∈ {i + k + 1, . . . , i − 1} with indices modulo m. So, the

∗ ∗ 0 0
∗ ∗ ∗ 0

∗ ∗ ∗ ∗

0 ∗ ∗ ∗

0 0 ∗ ∗
∗ 0 0 ∗

iii. gcd(det(Ci,i ), n) = 1 and gcd(det(Ci,k+i ), n) = 1 for all i ∈ [1, m] with indices taken modulo m.

***
Lemma 29. Let n and r be positive integers and let M be an r × r integer matrix with determinant coprime with
n. There are r × r integer matrices S and T such that
 
Ir
S
 

M0 = 
M 
T 
Ir
is a 5r × r integer matrix with the property that each r × r submatrix of M 0 , consisting of r consecutive rows, has
a determinant coprime with n.

***
Remark 30. The system (A(9) , Ztn ) is 1-auto-equivalent to (A, Ztn ) by projecting onto the original coordinates using
maps φi equal to the identity map. Indeed, any solution to (A, Ztn ) can be extended uniquely to a solution in (A(9) , Ztn )
as the last m − k variables in both systems parameterize the solutions in both cases.

***
Remark 31. The system (A(7) , Gt ) is µ-equivalent to (A(6) , Ztn ) with the injection
σ : [1, m(6) ] −→ [1, m(7) ]

4(i − 1)(m(6) − k (6) + 1) + 3(m(6) − k (6) + 1) + 1
i 7−→
(4k (6) + 5)(m(6) − k (6) + 1) + i − k (6)

if i ∈ [1, k (6) ]
if i ∈ [k (6) + 1, m(6) ]

and
φ : S(A(7) , Gt ) −→ S(A(6) , Ztn )
(x1 , . . . , xm(6) ) 7−→ (φ1 (xσ(1) ), . . . , φm(6) (xσ(m(6) ) ))
with


φi (x(σ(i),j) ) =

P
di,j
P κ∈Υ x(σ(i),j),κ
κ∈Υ x(σ(i),j),κ

for i ∈ [1, k (6) ]
,
for i ∈ [k (6) + 1, m(6) ]


where di,j is the greatest common divisor of the j-th row of the block Bi(1) from A(6) = Itm B (1) .20
Additionally, for any x ∈ S(A(6) , Ztn ) and i ∈ [1, m(6) ], the number of y ∈ S(A(7) , Gt ) with φ(y) = x and fixed (y)σ(i)
is independent of the (y)σ(i) ∈ φ−1
i ((x)i ).

***
Remark 32. Since the system is n–circular and |G| is a divisor of nα , for some positive integer α, Si (A(7) , Gt ) = Gt
for all i ∈ [1, m(7) ].

***
Proposition 33. [Representation for homomorphisms] Let G be a finite abelian group and let m, k be two positive
integers with m ≥ k + 2. Let A be a homomorphism A : Gm → Gk and let b ∈ Gk be given. Then the system of
linear configurations ((A, b), G) is γ-strongly-representable with γi = |G|/|Si (A, G)| and where χ1 , χ2 depend only
on m.

***
Observation 34. [Do not remove from full sets] Assume that the γ-representation of the k × m homomorphism
system (A, G0 ), with m ≥ k + 2, is constructed using a system with an n–circular matrix (A(7) , G) by the methods
exposed in sections ?? through ??. Let I ⊂ [1, m] be a set of indices such that Xi = G0 , i ∈ I. Then Theorem 2
holds with Xi0 = ∅.

