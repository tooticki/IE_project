***

Conjecture 1.1. Let F be a non-archimedean local ﬁeld of characteristic zero, G a
reductive group over F and H its endoscopic group. Let g and h be the Lie algebras of
G and H.
1. For any f ∈ C∞
2. Take compatible Fourier transforms FG and FH on g and h. There exists a constant
c such that whenever f H is a transfer of f , then FH (f H ) is a transfer of cFG(f ).

c (g), there exists a transfer f H ∈ C∞

c (h).

***
Theorem 1.2. Choose matching orbits (γ, v, v∗) and (δ, w). We have the following
identity between nilpotent orbit integrals

ω(γ, v, v∗)Orb(f, (γ, vΛ, v∗

S1\Λ)) =

(cid:104)Λ, x(cid:105)

fW (gδxg−1, 0)dg.

(1)

(cid:88)

(cid:90)

x

U(Wx)/Tδx

***

Acknowledgement. I would like to express my great gratitude to my advisor Wei
Zhang, for suggesting this problem to me and providing marvelous insights. I also want
to thank Professor Herv´e Jacquet for helpful discussions when preparing this paper.

***

Lemma 2.1. The inner integral over T1 in (??) converges when Re(s) > 0 and admits
meromorphic continuation to the whole complex plane which at holomorphic at 0. Its
value at 0 is well deﬁned as a locally constant and compactly supported function on
GL(V )/T .

***
Theorem 2.2. [Existence of Transfers] For any f ∈ C∞
a transfer {f0, f1}. Conversely, for any pair {f0, f1}, there exists a transfer f .

c (gl(V ) × V × V ∗), there exists

***

Theorem 2.3. [Fourier Transform]
Let n = dimV = dimW . There exists a constant c independent of the matching functions,
such that if f and {f0, f1} are transfers, then cF1(f ) and {F1(f0), (−1)n−1F1(f1)} are
transfers.

***
Conjecture 2.4. [Fundamental Lemma] When p is odd, 1k and {1k0, 0} are transfers.

***

Remark. The conjecture is known when p is large enough. This is proved in [11] by Z.
Yun in the positive characteristic case, extended to characteristic zero by J. Gordon in
the appendix to [11]. It is not known for small p.

***

Deﬁnition 3.1. An endoscopic triple of G is a triple (H, s, η). Here H is a quasi-split

group over F, s is a regular semisimple element in (cid:98)G, and η is an embedding of the
complex algebraic groups: (cid:98)H (cid:44)→ (cid:98)G. The triple has to satisfy the following conditions:

• η((cid:98)H) is the identity component of the centralizer of s in (cid:98)G.
• η−1(s) is ﬁxed by the Galois action on (cid:98)H.

• The conjugacy class of η is Galois equivariant.

***

Remark. It is easy to see that the matching between embeddings to maximal F-tori and
regular semisimple elements is a matching between stable conjugacy classes in G and H.
Let G∗ be the quasi split inner form of G. Every embedding T (cid:44)→ H has a matching
T (cid:44)→ G∗. This is not true for G. An element xH ∈ h(F )r.s. is G∗-regular semisimple if
it matches a regular semisimple element x∗ in g∗(F ).

***
Deﬁnition 3.2. Let f H ∈ C∞
following conditions are satisﬁed (see below for deﬁnitions of these terms):
1) For any matching orbits xH ∈ h(F )G∗−r.s. and x ∈ g(F )r.s., we have the identity:

c (h(F )) and f ∈ C∞

c (g(F )). Then f H and f match if the

2) If there does not exist x ∈ g(F )r.s. that matches xH ∈ h(F )G∗−r.s., then

OrbSt(f H , xH ) = ∆(xH , x)Orbκ(f, x).

OrbSt(f H , xH ) = 0.

(4)

(5)

***

Theorem 3.3. [Tate-Nakayama Isomorphism [12]] Let F be a non-archimedean local
ﬁeld and T a F-torus. Then the Galois cohomology group H 1(F, T ) is canonically
isomorphic to the quotient of

{x ∈ X∗(T )|tr(x) = 0}

by its subgroup generated by

{σx − x|σ ∈ Gal(F /F ), x ∈ X∗(T )}.

***
Theorem 3.4. [Existence of Transfers] For any f ∈ C∞
matches f .

c (g), there exists f1 ∈ C∞

c (h)

***

Theorem 3.5. [Fourier Transform] There exists a constant c independent of the
matching functions, such that if f ∈ C∞
c (h) match, then cF(f ) and
F(f1) also match.

c (g) and f1 ∈ C∞

***

Remark. The constant c are given explicitly in [2]. It equals the quotient of the Weil
indexes of h and g. We will come back to this in section ??.

***
Proposition 3.6. The centralizer Tδ of δ in U(W ) equals U(1)(E[δ]×/F [δ]×). We have
Z/2Z. And the conjugacy class in the stable conjugacy class of δ is

H 1(F, Tδ) = (cid:81)

canonically a torsor of

S1

(cid:89)



ker(H 1(F, Tδ) → H 1(F, U(W ))) = ker

Z/2Z → Z/2Z

where all the map from Z/2Z to Z/2Z are identity.

S1

***
Proposition 3.7. Let m = 1. When F1 ⊇ E, then dimW is even and S is a single
point belongs to the split Hermitian space. When F1 (cid:43) E, then S consists of two points,
with one point for each Hermitian space.

***

S1

Proposition 3.8. There is a natural isomorphism S → (cid:81)

Z/2Z. It deﬁnes S as a
torsor over H 1(F, T ) which extends the classical torsor structure over ker(H 1(F, T ) →
H 1(F, U (W )).

***
Deﬁnition 3.9. Let ρ denote the map S → H 1(F, T ). Given δ1, δ2 ∈ S, deﬁne

inv(δ1, δ2) = ρ(δ1) − ρ(δ2).

***

Proposition 3.10. The character κ of H 1(F, Tδ) is deﬁned as follows: on each copy of
Z/2Z corresponding to S1(δ1), κ is the trivial map. On each copy of Z/2Z corresponding
to S1(δ2), κ is the unique nontrivial map.

***

Deﬁnition 3.11. We deﬁne elements δ and (δ1, δ2) are nice matching elements if they
arise in the way described above.

***
Theorem 3.12. For any f1 ∈ C∞

c (u(W1)), there exists a transfer f0 ∈ C∞

c (u(W0)).

***
Theorem 3.13. Let fi ∈ C∞
c (u(Wi)). There exists a constant c independent of the
matching functions, such that if f0 and f1 match, then F(f0) and cF(f1) also match.

***

Deﬁnition 3.14. [Weil index] Let F be a non-archimedean local ﬁeld of characteristic
zero and V a vector space of dimension n over F equipped with a quadratic form q :
V → F . Fix an additive character ψ : F → C×. Let fq be the function ψ ◦ q and F the
Fourier transform deﬁned by ψ. There exists a constant γq(ψ), called Weil index, such
that for all f ∈ C∞

c (V ), the following identity is true:
F(fq) = γq(ψ)f−q.

***

Proposition 3.15. The constant c in theorem 3.5 equals
quadratic forms on g and h that match each other.

γqG (ψ)
γqH (ψ) . Here qG and qH are

***
Proposition 3.16. The constant c in theorem 3.13 equals (−1)n−1.

***
Lemma 4.1. [Germ Expansions for Tori] Let f ∈ C∞
integral

(cid:90)

Orb(f, ε) =

f (t, εt−1)χ(t)dt.

c (A×A) and consider the following

When ε ∈ T is close enough to 0 (as an element in A), the above integral equals:

T

(cid:88)
(cid:88)

Λ2⊆S2

(−1)|S2\Λ2|cΛ2(f ) logq(|ε|S2\Λ2)
(cid:90)
(cid:89)

f (tΛ1, (t−1)S1\Λ1)χ(t)

where cΛ2(f ) is independent of εS2 and

c∅(f ) =

Λ1⊆S1

TS1

χ(εi)dt.

i∈S1\Λ1

The integral in c∅ is deﬁned by analytic continuation.

***

Proposition 4.2. [Germ Expansions]
When ε is close enough to 0 (depending on f ):

Orb(f, (γ, v, v∗ε)) =

(−1)|S2\Λ2|cΛ2(f )logq(|ε|S2\Λ2)

(cid:88)

Λ2⊆S2

(cid:88)

Λ1⊆S1

with cΛ2(f ) independent of εS2 and

c∅(f ) =

Orb(f, (γ, vΛ1, v∗

S1\Λ1

))

(cid:89)

S1\Λ1

χ(εi).

In the deﬁnition of c∅(f ), we use “nilpotent orbit integrals” that are deﬁned in (??).

Proposition 4.3. [Germ Expansions] When ε is close enough to 0 (depending on f ):

***

Orb(f, (δ, εw)) =

with cΛ2(f ) independent of εS2 and

(cid:88)
(cid:90)

Λ2⊆S2

(−1)|S2\Λ2| · cΛ2(f ) logq(|ε|S2\Λ2)

f (gδg−1, 0)dg.

c∅(f ) =

U(W )/Tδ

***
Lemma 4.4. When (γ, v, v∗) and (δ, w) match, choose ε ∈ F [γ]×, ε1 ∈ E[δ]× with

then (γ, v, v∗ε) and (δ, ε1w) also match.

NmE[δ]/F [δ](ε1) = ε

***

Lemma 4.5. Suppose there exists constant cΛ independent of ε such that for all the ε
close enough to 0,

(cid:88)

cΛ logq|ε|Λ= 0

then all the cΛ are 0.

Λ⊆S

***
Lemma 4.6. We use the notation S as in proposition 3.8. The map x (cid:55)→ δx deﬁnes an
isomorphism of H 1(F, Tx) torsor

F [γ]×/NmE[γ]/F [γ](E[γ]×) → S.

***

(cid:88)

(cid:90)

x

U(Wx)/Tδx

Theorem 4.7. Using the notation in this subsection, we have

ω(γ, v, v∗)Orb(f, (γ, vΛ, v∗

S1\Λ)) =

(cid:104)Λ, x(cid:105)

fW (gδxg−1, 0)dg.

(8)

***
Lemma 5.1. When v2 = v∗
to make sense its “nilpotent orbit integral”, we have

1 = 0 and (λ, v, v∗) satisﬁes the condition in equation (??)

with

D(λ) =

(x1 − x2)

Orb(f, (λ, v, v∗)) = Orb(f P , (λ, v, v∗))|D(λ)|−1

F

(cid:89)

and x1(resp. x2) runs through all the eigenvalues of λ1(resp. λ2) over F .

x1,x2

***
Lemma 5.2. The map f (cid:55)→ f P is preserved by the Fourier transforms on the gl(V)
factor.

***

Theorem 6.1. [Main Theorem] Let W be a Hermitian space of dimension n for E/F .
Let n = a + b. Deﬁne G = U(W ) and it has endoscopic group H = U(Wa,0) × U(Wb,0).
(1) For each f ∈ C∞
(2) If f and f H are matching functions, then for the Fourier transfrom F and F H
(deﬁned by tr(XY )), F(f ) and F H (f H ) are also matching functions.

c (g), there exists a transfer f H ∈ C∞

c (h).

***

Theorem 6.2. For any odd prime p and consider the fundamental
lemmas on the
Lie algebras. Then the fundamental lemma in the Jacquet-Rallis case (conjecture 2.4
) implies the fundamental lemma in the endoscopic case.

***

Remark. In [9], Kazhdan and Varshavsky have shown that the fundamental lemma in
the endoscopic case is implied by theorem 3.5 (at least when p is large). In the unitary
case, theorem 6.1 give a direct proof of theorem 3.5. Hence, we also give a genuinely
diﬀerent proof of the endoscopic fundamental lemma.

