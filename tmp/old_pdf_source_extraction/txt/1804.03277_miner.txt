***
Deﬁnition 2.1. A graphex W = (W, S, I, Ω) consists of a σ-ﬁnite measure space
Ω = (Ω,F, µ), a symmetric measurable function W : Ω × Ω → [0, 1], a measurable
function S : Ω → R+, and a nonnegative real number I such that the following local
ﬁniteness conditions hold:

(1) W (·, x) is integrable for almost all x ∈ Ω, and
(2) there exists a measurable subset Ω(cid:48) ⊆ Ω such that µ(Ω \ Ω(cid:48)) < ∞ and W|Ω(cid:48)

is integrable.

(cid:90)

Ω×Ω

(cid:90)

Ω

The quadruple will be called a signed graphex if instead of taking values in [0, 1] and
R+, W , S and I take values in R. The graphex W = (W, S, I, Ω) is called integrable
if

(cid:107)W(cid:107)1 :=

|W (x, y)| dµ(x) dµ(y) + 2

|S(x)| dµ(x) + 2|I| < ∞,

and the restriction W|Ω(cid:48) of W to Ω(cid:48) ⊆ Ω is deﬁned as the quadruple W(cid:48) =
(W (cid:48), S(cid:48), I(cid:48), Ω(cid:48)) with Ω(cid:48) = (Ω(cid:48),F(cid:48), µ(cid:48)), where F(cid:48) = {A ∈ F : A ⊆ Ω(cid:48)}, µ(cid:48) is the
restriction of µ to F(cid:48), S(cid:48) is the restriction of S to Ω(cid:48), and W (cid:48) is the restriction of
W to Ω(cid:48) × Ω(cid:48).

***
Deﬁnition 2.2. Let W be a graphex, let (GT (W))T≥0 be the random family of
graphs deﬁned above, and let ξ[W] be the random adjacency measure ξG∞(W). We
call the stochastic process (GT (W))T≥0 the graphex process generated by W, and
the adjacency measure ξ[W] the adjacency measure generated by W. We say two
graphexes are equivalent, if the graphex processes generated by these graphons are
equal in law.

***

Remark 2.3. (1) Following [4], we deﬁned a graphex process as a stochastic process
taking values in a space of graphs with labels in R+. Alternatively, one might want
to deﬁne a graphex process as a process taking values in the space of unlabeled
graphs without isolated vertices. In our current context, this would correspond to
ignoring the time labels of the graphs in GT (W), leading to a graph which we denote
by GT (W). When it is important to distinguish them, we will refer to the process
(GT (W))T≥0 as the unlabeled graphex process corresponding to W, and to the
process (GT (W))T≥0 as the labeled graphex process corresponding to W. Note that
it is easy to recover GT (W) from GT (W): just assign i.i.d. labels chosen uniformly
at random in [0, T ] to all vertices. A related observation is the fact that GT (W) can
be generated by ﬁrst choosing (xi)i≥1 according to a Poisson process with intensity
T µ in Ω, then connecting i and j with probability W (xi, xj), then adding a star
whose number of leaves are chosen as a Poisson random variable with mean T S(xi)
to each point of the process (xi)i≥1, and ﬁnally adding independent edges with rate
IT 2. Forgetting the labels then gives us GT (W). Relabeling each vertex in the
resulting graph independently by a uniform t ∈ [0, T ], we obtain GT (W).
(2) It is sometimes convenient to assign a feature value to the endpoints of the
isolated edges generated from the dust part I in the graphex, as well as to the leaves
of the stars generated using the function S. For our purpose, we will say that these
vertices have the feature label ∞, and we will extend the marginal DW to Ω ∪ {∞}
by setting

(cid:90)
Note that with this notation, (cid:107)W(cid:107)1 =(cid:82)
(3) In view of (2), one might want to equip the extended feature space (cid:101)Ω = Ω∪{∞}
ﬁnite measure Q = (cid:101)µ(∞) to the feature value ∞, giving a new σ-ﬁnite measure
space (cid:101)ΩQ. On (cid:101)ΩQ, one can then deﬁne a graphex of the form(cid:102)WQ = ((cid:102)WQ, 0, 0,(cid:101)Ω)
by setting (cid:102)WQ equal to W on Ω × Ω and to 2I/Q2 on {∞} × {∞}, and by setting
(cid:102)W (x,∞) = S(x)/Q and (cid:102)W (∞, y) = S(y)/Q if only one of the two features x, y
x ∈ Ω, and (cid:107)W(cid:107)1 = (cid:107)(cid:102)WQ(cid:107)1 =(cid:82) dµ(x)D(cid:102)W1
lies in Ω. With this construction, D(cid:102)WQ
(∞) = DW(∞)/Q, D(cid:102)WQ
+ QD(cid:102)W (∞), with the notation in (2)
from(cid:102)W cannot have exactly the same distribution as the one generated from W
unless I and S are zero (to see this, note that in G∞((cid:102)W), all vertices have inﬁnite
the process generated from the “pure graphon”(cid:102)W approximates the one generated
any ﬁxed T , the distribution of GT ((cid:102)WQ) converges to GT (W).

degrees, while G∞(W) has vertices of degree one). But one might wonder whether

from W. As we will see in Remark 7.7 , this is indeed the case, in the sense that for

with a σ-ﬁnite measure by keeping the original measure on Ω, and assigning some

DW(∞) =

S(x) dµ(x) + 2I.

Ω

Ω DW(x) dµ(x) + DW(∞).

corresponding to the case Q = 1. It is clear that the graphon process generated

(x) = DW(x) if

***
Proposition 2.4. Let W = (W, S, I, Ω) be a 4-tuple consisting of a σ-ﬁnite measure
space Ω = (Ω,F, µ), a symmetric measurable function W : Ω × Ω → [0, 1], a
measurable function S : Ω → R+, and a nonnegative real number I. Then the local
ﬁnite conditions (1) and (2) from Deﬁnition 2.1 are equivalent to the local ﬁniteness
of the adjacency measure generated by W. If we assume condition (1), then following
are equivalent:
(A) The graphex W obeys the local ﬁniteness condition (2).
(B) For all D > 0, µ({DW > D}) < ∞ and W|{DW≤D} is integrable.
(C) There exists a D > 0 such that µ({DW > D}) < ∞ and W|{DW≤D} is integrable.
(D) For all D > 0, µ({DW > D}) < ∞, and both W|{DW ≤D} and min{S, 1} are
(E) There exists a D > 0 such that µ({DW > D}) < ∞, and both W|{DW ≤D} and

integrable.
min{S, 1} are integrable.

***
Theorem 2.5. Let W1 = (W1, S1, I1, Ω1) and W2 = (W2, S2, I2, Ω2) be graphexes,
where Ωi = (Ωi,Fi, µi) are σ-ﬁnite spaces. Then Gt(W1) and Gt(W2) have the
same distribution for all t ∈ R+ if and only if there exists a third graphex W =
(W, S, I, Ω) over a σ-ﬁnite measure space Ω = (Ω,F, µ) and measure preserving
maps φi : dsupp Wi → Ω such that Wi|dsupp Wi = Wφi almost everywhere.

***

Remark 2.6. If the two graphexes are deﬁned over Borel spaces, we can prove
an analogous statement where the measure-preserving maps are turned around.
Speciﬁcally, for the case where Ω1 and Ω2 are σ-ﬁnite Borel spaces, we can prove
that Gt(W1) and Gt(W2) have the same distribution for all t ∈ R+ if and only
if there exists a σ-ﬁnite Borel space Ω = (Ω,F, µ) and measure preserving maps
πi : Ω → dsupp Wi such that (W1|dsupp W1)π1 = (W2|dsupp W2 )π2 almost everywhere.
In this case, the space Ω can be chosen to be a coupling of Ω1 and Ω2, with πi being
the coordinate projections from Ω1 × Ω2 to Ωi. See Theorem 8.2 in Section ??.
For graphexes without a dust and star part, this was independently established in
[3] (using a diﬀerent proof); see also [17], which establishes a similar result (with
yet another proof), this time giving a coupling of the two graphexes (again without
dust and star part) after trivially extending them rather than restricting them to
the support of their marginals.

***
Deﬁnition 2.7. Given a function U deﬁned on Ω1 × Ω2 for two σ-ﬁnite measure
spaces Ωi = (Ωi,Fi, Ωi) for i = 1, 2, we deﬁne

(cid:107)U(cid:107)2→2 =

sup

f,g:(cid:107)f(cid:107)2=(cid:107)g(cid:107)2=1

f ◦ U ◦ g = sup

(cid:107)U ◦ g(cid:107)2.

g:(cid:107)g(cid:107)2=1

***
Deﬁnition 2.8. Given a measurable function U deﬁned on Ω × Ω for a σ-ﬁnite
measure space Ω, we deﬁne the jumble norm

(cid:107)U(cid:107)(cid:2) = sup
S,T⊆Ω

U (x, y) dµ(x) dµ(y)

Here the supremum is over subsets with ﬁnite and nonzero measure.

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

1(cid:112)µ(S)µ(T )

(cid:90)

S×T

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) .

***
Deﬁnition 2.9. A signed graphex W = (W, S, I, Ω) over Ω = (Ω,F, µ) is said
to be in L1 ∩ L2 if both W and D|W| are in L1 ∩ L2. Here |W| is the graphex
|W| = (|W|,|S|,|I|, Ω).

***
Deﬁnition 2.10. Let W1 and W2 be signed graphexes in L1 ∩ L2. Then we deﬁne
(2.4)
where W(cid:48)
2 are trivial extensions of W1 and W2 to measure spaces of inﬁnite
total mass. We refer to δ2→2(W1, W2) as the kernel distance of W1 and W2 and
call δ2→2 the kernel metric.

δ2→2(W1, W2) =(cid:101)δ2→2(W(cid:48)

1 and W(cid:48)

1, W(cid:48)
2),

***
Theorem 2.11. Let W1 and W2 be signed graphexes in L1 ∩ L2. Then the right
side of (2.4) does not depend on the choice of the trivial extensions W(cid:48)
1 and W(cid:48)
2.
Furthermore, given three signed graphexes W1, W2, W3 in L1 ∩ L2,
δ2→2(W1, W3) ≤ δ2→2(W1, W2) + δ2→2(W2, W3).

Therefore, δ2→2 is a well-deﬁned pseudometric.

***

Remark 2.12. In [3], when deﬁning the cut distance between two graphons, it was
only necessary to extend the smaller space to the larger one, and it was not necessary
to extend further. It is natural to ask whether a trivial extension to a space of
inﬁnite metric is necessary, or, equivalently, whether for two graphexes W1, W2

deﬁned on spaces with the same (ﬁnite) measure,(cid:101)δ2→2(W1, W2) = δ2→2(W1, W2).

In contrast to the cut distance discussed in [3], for the kernel metric it is sometimes
necessary to take trivial extensions of both spaces, not just an extension of the
smaller space to one of the same measure as the larger one. See Example 3.11 in
Section ??.

***

Theorem 2.13. For any D > 0, δ2→2-convergence is equivalent to GP-convergence
on the space of graphexes with D-bounded marginals.

***
Deﬁnition 2.14. Let W1 = (W1, S1, I1, Ω1) and W2 = (W2, S2, I2, Ω2) be signed
graphexes, where Ωi = (Ωi,Fi, µi) and (cid:107)Wi(cid:107)∞ < ∞ for i = 1, 2. We deﬁne
δ(cid:5)(W1, W2) as the inﬁmum of the set of real numbers c such that there exist two

measures(cid:101)µ1 and(cid:101)µ2 over (Ω1,F1) and (Ω2,F2) that satisfy the following: the signed
graphexes (cid:102)W1 and (cid:102)W2 obtained from W1 and W2 by replacing µ1 and µ2 by (cid:101)µ1
and (cid:101)µ2, respectively, are in L1 ∩ L2, and
(1) for i = 1, 2, we have µi − c2 ≤(cid:101)µi ≤ µi, and
(2) δ2→2((cid:102)W1,(cid:102)W2) ≤ c.

We refer to δ(cid:5)(W1, W2) as the weak kernel distance between W1 and W2 and call
δ(cid:5) the weak kernel metric.

***
Theorem 2.15. Given three signed graphexes W1, W2, W3 with bounded graphon
part,

δ(cid:5)(W1, W3) ≤ δ(cid:5)(W1, W2) + δ(cid:5)(W2, W3).

Therefore, δ(cid:5) is a pseudometric.

***
Remark 2.16. Given a signed graphex W = (W, S, I, Ω) with Ω = (Ω,F, µ) and a
measure-preserving map ϕ : Ω(cid:48) → Ω, let W(cid:48) = Wϕ almost everywhere. We can take a
the pullbacks of the two signed graphexes to Ω(cid:48) × Ω will be equal almost everywhere,

coupling(cid:101)µ on Ω(cid:48)×Ω deﬁned by(cid:101)µ(A×B) = µ(cid:48)(A∩ϕ−1(B)). It is easy to see that then
which implies that δ2→2(W, W(cid:48)) =(cid:101)δ2→2(W(cid:48), W) = δ(cid:5)(W(cid:48), W) =(cid:101)δ(cid:5)(W(cid:48), W) = 0.

***
Proposition 2.17. Fix D < ∞. Then δ(cid:5) and δ2→2 give an equivalent topology on
the space of graphexes with D-bounded marginals.

***
Theorem 2.18. Given a sequence of graphexes Wn and a graphex W, Wn is
GP-convergent to W if and only if δ(cid:5)(Wn, W) → 0.

***

Remark 2.19. The reader might wonder whether instead of building our metric for
GP-convergence around the kernel norm (cid:107) · (cid:107)2→2, one could equivalently build it
around the cut norm, (cid:107) · (cid:107)(cid:3). Concretely, one might want to deﬁne d(cid:3) by replacing
the kernel norm in (??) by the cut norm and the L2 norm by the L1 norm, then
proceed as in (??) and (2.4) to obtain a cut distance δ(cid:3) between graphexes with
bounded marginals, and ﬁnally proceed as in Deﬁnition 2.14 to obtain a “weak cut
metric” for arbitrary graphexes.
The following example shows that this approach does not work, in that it will not
metricize GP-convergence. Deﬁne Wn to be the graphex that is constant and equal
to n−2 over [0, n]2 and 0 everywhere else, and set Wn = (Wn, 0, 0, R+), where R+
is equipped with the Lebesgue measure. The marginal DWn of Wn is then equal
to 1/n times the indicator function of the interval [0, n], and its L1 norm is equal
to 1. It is then not hard to check that Wn converges to the pure dust graphex
(0, 0, 1, R+) in the metric δ(cid:5). Indeed, (cid:107)Wn(cid:107)2→2 → 0 and (cid:107)DWn(cid:107)2 = n−1/2 → 0,
while (cid:107)Wn(cid:107) = 1 → 1 = (cid:107)W(cid:107)1, which immediately implies convergence in the metric
δ(cid:5) and hence GP-convergence (based on the proof of equivalence in this paper,
though for this speciﬁc case it is simple to check GP-convergence directly). By
contrast, (cid:107)Wn(cid:107)(cid:3) = (cid:107)Wn(cid:107)1 = 1 stays bounded away from zero, showing in particular
that Wn does not converge to W in the cut metric δ(cid:3). Since changing the Lebesgue
measure to a measure µn such that λ− εn ≤ µn ≤ λ with εn → 0 will asymptotically
not change the cut norm of Wn, the graphexes Wn do not converge to W in the
weak cut metric either. Note that this can’t be cured by choosing a diﬀerent norm
for the marginal diﬀerence DW1 − DW2, e.g., by keeping the L2 norm for that part,
since the above counter example works independently of the norm used for that
part.

***
Deﬁnition 2.20. A set S of graphexes is tight if for every ε > 0, there exist C and
D such that for every W ∈ S, W = (W, S, I, Ω) with Ω = (Ω,F, µ), there exists
Ωε ⊆ Ω such that µ(Ωε) ≤ ε and the graphex W(cid:48) = W|Ω\Ωε is (C, D)-bounded.
Here a graphex W(cid:48) is called (C, D)-bounded if its marginals are D-bounded and
(cid:107)W(cid:48)(cid:107)1 ≤ C.

***

Theorem 2.21. The space of all graphexes is complete under the topology induced
by the weak kernel metric δ(cid:5). A subset is relatively compact if and only if it is tight.
In particular, for any C and D, the set of graphexes with (cid:107)W(cid:107)1 ≤ C is compact
under δ(cid:5), and the set of (C, D)-bounded graphexes is compact under both δ(cid:5) and
δ2→2.

***

Remark 2.22. As mentioned above, we only develop the theory of tightness for
unsigned graphexes. In particular, we don’t characterize the set of precompact
signed graphexes. That notwithstanding, some of our compactness results do hold
for signed graphexes. Here we only mention that the analogue of the statement for
the set of graphexes with (cid:107)W(cid:107)1 ≤ C holds for signed graphexes as well, provided
we restrict the L∞ norm of the graphon part (which by deﬁnition is bounded
by 1 for unsigned graphexes). To be explicit, any sequence of signed graphexes
Wn = (Wn, Sn, In, Ωn) with (cid:107)Wn(cid:107)∞ ≤ B and (cid:107)Wn(cid:107)1 ≤ C has a subsequence
converging to a signed graphex W = (W, S, I, Ω) with (cid:107)W(cid:107)∞ ≤ B and (cid:107)W(cid:107)1 ≤ C.
See Remark 5.10 in Section ?? below.

***
Theorem 2.23. Assume that W and Wn for n ≥ 1 are graphexes whose marginals
are D-bounded for some ﬁnite D. Then the following are equivalent.

(1) δ2→2(Wn, W) → 0.
(2) For every graph F with no isolated vertices, t(F, Wn) → t(F, W).
(3) For every connected graph F , t(F, Wn) → t(F, W).
(4) GT (Wn) → GT (W) in distribution for every T .
(5) GT (Wn) → GT (W) in distribution for some T .

***

Remark 2.24. The above theorem implies in particular that in order to check whether
a sequence Wn of graphexes with uniformly bounded marginals is GP-convergent,
it is enough to check convergence of GT (Wn) for a single T > 0. In a similar way,
several other properties of sequences or sets of graphexes can be equivalently stated
for all T > 0 or some T > 0 (see, in particular, the already mentioned Theorem 4.1
about tightness and Theorem 9.1 about uniform integrability). But for general
sequences of graphexes, we do not know whether GP-convergence is equivalent to
the convergence of GT (Wn) for just one T > 0.

***
Deﬁnition 2.25. A set of graphexes S is called uniformly integrable if the graphexes
in S have uniformly bounded (cid:107) · (cid:107)1-norms, and for every ε > 0, there exists a D
such that for all W ∈ S, (cid:107)DW1DW>D(cid:107)1 < ε.

***
Theorem 2.26. Suppose Wn is a sequence of integrable graphexes with uniformly
bounded (cid:107)·(cid:107)1-norms that converges to a graphex W in the weak kernel metric. Then

In particular, W is integrable. We furthermore have that

(cid:107)W(cid:107)1 ≤ lim inf

n→∞ (cid:107)Wn(cid:107)1.

if and only if the sequence Wn is uniformly integrable.

n→∞(cid:107)Wn(cid:107)1 = (cid:107)W(cid:107)1

lim

***
Deﬁnition 2.27. [[3]] Given a set of signed, integrable graphons S, we say that
they are uniformly tail regular if for any ε > 0, there exists M such that for each
W ∈ S with the usual notation, there exists Ω0 ⊆ Ω such that µ(Ω0) ≤ M and
(cid:107)W(cid:107)1 − (cid:107)W|Ω0(cid:107)1 ≤ ε.

***

Theorem 2.28. Given a sequence of integrable graphexes of the form

Wn = (Wn, 0, 0, Ωn),

the following are equivalent.

(1) The sequence Wn converges to a graphon W in cut metric.
(2) The sequence Wn is uniformly tail regular, and in the weak kernel metric,

(3) The sequence Wn is uniformly tail regular, and in the weak kernel metric,

the sequence Wn converges to a graphex of the form W = (W, 0, 0, Ω).
the sequence Wn converges to some graphex W.

***

Theorem 2.29. Given a sequence of uniformly integrable graphexes

Wn = (Wn, Sn, In, Ωn),

which converge to a graphex W = (W, S, I, Ω) in the weak kernel metric, the following
are equivalent.

(1) The graphex W is of the form W = (W, 0, 0, Ω).
(2) (cid:107)Sn(cid:107)1 → 0 and In → 0, and the sequence of graphons Wn has uniformly
(3) (cid:107)Sn(cid:107)1 → 0 and In → 0, and the sequence of graphons Wn converges in the

regular tails.

cut metric.

***

Remark 2.30. In the above theorem, the assumption of uniform integrability is
necessary. To see this, let Wn be the graphon deﬁned by being 1 on the set
[0, 1/n] × [1, n + 1] and its transpose, and 0 otherwise, and let Wn = (Wn, 0, 0, R+).
Then the sequence Wn converges to the zero graphex in the weak kernel metric,
which is a pure graphon. However, the sequence is clearly not uniform tail regular
(or even uniformly integrable). We can also let Sn(x) = 1/n on the set [0, n], and 0
everywhere else. In that case the sequence still converges to 0 in the weak kernel
metric, but (cid:107)Sn(cid:107)1 does not converge to 0.

replacing the right side of (2.4) with (cid:101)δ(cid:2), which in turn is obtained from (cid:101)δ2→2 by

***
Theorem 3.1. Let W1 and W2 be signed graphexes in L1 ∩ L2. Deﬁne δ(cid:2) by
replacing d2→2 with d(cid:2). Then the value of δ(cid:2)(W1, W2) does not depend on the
choice of the trivial extensions W(cid:48)
2, and δ(cid:2) obeys the triangle inequality,
making it a well-deﬁned pseudometric.

1 and W(cid:48)

***
Lemma 3.2. Suppose φ : Ω → Ω(cid:48) is a measure preserving map between two σ-ﬁnite
measure spaces (Ω,F, µ) and (Ω(cid:48),F(cid:48), µ(cid:48)).

(1) For any σ-algebra G ⊆ F, L1(Ω,G, µ) is a closed subspace in L1(Ω,F, µ).
(2) If f ∈ L1(Ω, φ−1(F(cid:48)), µ), then there exists a function f(cid:48) ∈ L1(Ω(cid:48),F(cid:48), µ(cid:48))
such that f = f(cid:48)φ = f(cid:48) ◦ φ almost everywhere.
(3) The map φ∗ : L1(Ω(cid:48),F(cid:48), µ(cid:48)) → L1(Ω, φ−1(F(cid:48)), µ) with f(cid:48)
(cid:55)→ f(cid:48)φ is an
isometric isomorphism, implying that φ∗ and its inverse are continuous
and hence Borel measurable.

***
Lemma 3.3. Suppose that Ω = (Ω,F, µ) with µ(Ω) < ∞, and suppose that g ∈
L2(Ω). Let

(3.3)

Ω f g dµ
Ω f dµ
Then S ≤ (cid:107)g(cid:107)2 < ∞, and there exists X ⊆ Ω such that

f∈L∞(Ω),0≤f≤1

S =

sup

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) .

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
(cid:82)
(cid:113)(cid:82)
(cid:12)(cid:12)(cid:82)
X g dµ(cid:12)(cid:12)
(cid:112)µ(X)

.

S =

Note that this expression is the same as taking f = 1X in (3.3 ).

***
Proposition 3.4. Let Ω = (Ω,F, µ) and Ω(cid:48) = (Ω(cid:48),F(cid:48), µ(cid:48)) be σ-ﬁnite measure
spaces, and let ϕ : Ω(cid:48) → Ω be measurable. If U : Ω × Ω → R and F : Ω → R are
square integrable, then

(cid:107)U(cid:107)2→2 = (cid:107)U ϕ(cid:107)2→2,

(cid:107)F(cid:107)(cid:2) = (cid:107)F ϕ(cid:107)(cid:2),

and

(cid:107)U(cid:107)(cid:2) = (cid:107)U ϕ(cid:107)(cid:2).

If instead of square integrability, we assume that U is integrable, then

(cid:107)U(cid:107)(cid:3) = (cid:107)U ϕ(cid:107)(cid:3).

***
Lemma 3.5. Let Ω = (Ω,F, µ) and Ω(cid:48) = (Ω(cid:48),F(cid:48), µ(cid:48)) be σ-ﬁnite measure spaces,
let ϕ : Ω → Ω(cid:48) be a measure-preserving map, and let W1, W2 be signed graphexes in
L1 ∩ L2. Then

∆2→2(W1, W2) = ∆2→2(Wϕ

1 , Wϕ
2 ).

1 , Wϕ

2 ) and ∆(cid:2)(W1, W2) = ∆(cid:2)(Wϕ

***
Remark 3.6. Given a signed step graphex W = (W, S, I, Ω) over a ﬁnite subspace
partition P = (P1, P2, . . . , Pm), we can deﬁne another signed graphex W(cid:48) =
(W (cid:48), S(cid:48), I(cid:48), Ω(cid:48)) with Ω(cid:48) = (Ω(cid:48),F(cid:48), µ(cid:48)), where Ω(cid:48) = [m], F(cid:48) consists of all subsets,
and the measure is deﬁned by µ(cid:48)({i}) = µ(Pi). Setting I(cid:48) = I, S(cid:48)(i) = S(x) for any
x ∈ Pi (they are all equal), and W (cid:48)(i, j) = W (x, y) for x ∈ Pi, y ∈ Pj (again the
choice of x and y does not matter), we obtain that W = (W(cid:48))ϕ where ϕ : Ω → Ω(cid:48)
is the map with ϕ(x) = i for x ∈ Pi. In particular, by Remark 2.16 , the distance
between W and W(cid:48) is zero (for any of the distance notions). Suppose now that
W(cid:48)(cid:48) = (W (cid:48)(cid:48), S(cid:48)(cid:48), I(cid:48)(cid:48), Ω(cid:48)(cid:48)) with Ω(cid:48)(cid:48) = (Ω(cid:48)(cid:48),F(cid:48)(cid:48), µ(cid:48)(cid:48)) is another signed step graphex over
a ﬁnite subspace partition Q = {Q1, Q2, . . . , Qm}, with I(cid:48)(cid:48) = I, µ(cid:48)(cid:48)(Qi) = µ(Pi),
and S(cid:48)(cid:48)(x(cid:48)(cid:48)) = S(x), W (cid:48)(cid:48)(x(cid:48)(cid:48), y(cid:48)(cid:48)) = W (x, y) for x ∈ Pi, x(cid:48)(cid:48) ∈ Qi, y ∈ Pj, y(cid:48)(cid:48) ∈ Qj.
Then Ω(cid:48)(cid:48) can also be mapped to Ω(cid:48) so that W(cid:48)(cid:48) is the pullback of W(cid:48) (by mapping
Qi to i). This implies that the distance of both W and W(cid:48)(cid:48) from W(cid:48) is 0, which (by
the still to be proven triangle inequality) implies that their distance from each other
is 0 (again for any of the notions of distance).

***
Lemma 3.7. Let W1 = (W1, S1, I1, Ω) and W2 = (W2, S2, I2, Ω) be signed
graphexes in L1∩L2. Assume that both are countable step graphexes on Ω = (Ω,F, µ)
with common reﬁnement P = {P1, P2, . . . , Pm, . . .}, suppose µ(cid:48) is another measure
on Ω with µ(Pi) = µ(cid:48)(Pi), and let Ω(cid:48) = (Ω,F, µ(cid:48)) and W(cid:48)
i = (Wi, Si, Ii, Ω(cid:48)). Then

∆2→2(W1, W2) = ∆2→2(W(cid:48)

1, W(cid:48)
2)

and ∆(cid:2)(W1, W2) = ∆(cid:2)(W(cid:48)

1, W(cid:48)
2).

***
Lemma 3.8. Let Wi = (Wi, Si, Ii, Ωi), for i = 1, 2, 3, be countable step graphexes
in L1∩ L2. Let µ12 be a coupling measure on Ω1× Ω2, and µ23 be a coupling measure
on Ω2 × Ω3. Then there exists a coupling measure µ13 on Ω1 and Ω3 such that

, Wπ12,2,µ12

3

) + ∆2→2(Wπ23,2,µ23

1

, Wπ23,3,µ23

3

)

∆2→2(Wπ13,1,µ13

, Wπ13,3,µ13
≤ ∆2→2(Wπ12,1,µ12

1

3

1

)

∆(cid:2)(Wπ13,1,µ13

, Wπ13,3,µ13

)

1

and

, Wπ12,2,µ12
where the inequalities hold coordinate-wise.

≤ ∆(cid:2)(Wπ12,1,µ12

3

1

3

) + ∆(cid:2)(Wπ23,2,µ23

1

, Wπ23,3,µ23

3

),

***
Lemma 3.9. Suppose that Wi = (Wi, Si, Ii, Ωi) with Ωi = (Ωi,Fi, µi), for i =
1, 2, 3, are signed graphexes in L1 ∩ L2, and assume that µ1(Ω1) = µ2(Ω2) = µ3(Ω3).
Then

(cid:101)δ2→2(W1, W3) ≤(cid:101)δ2→2(W1, W2) +(cid:101)δ2→2(W2, W3)
(cid:101)δ(cid:2)(W1, W3) ≤(cid:101)δ(cid:2)(W1, W2) +(cid:101)δ(cid:2)(W2, W3).

and

***
Lemma 3.10. Let W = (W, S, I, Ω) be a signed graphex in L1 ∩ L2, with possibly
unbounded graphon parts, and let Ω = (Ω,F, µ).

(1) If W(cid:48) and W(cid:48)(cid:48) are trivial extensions of W by σ-ﬁnite spaces of inﬁnite

measure, then

(2) If µ(Ω) = ∞ and (cid:102)W = ((cid:102)W ,(cid:101)S, I,(cid:101)Ω) is obtained from W by appending an

arbitrary σ-ﬁnite space of inﬁnite measure, then

(cid:101)δ(cid:2)(W(cid:48), W(cid:48)(cid:48)) =(cid:101)δ2→2(W(cid:48), W(cid:48)(cid:48)) = 0.
(cid:101)δ2→2(W,(cid:102)W) =(cid:101)δ(cid:2)(W,(cid:102)W) = 0.

(cid:18) −pa

p(1 − a)

(cid:19)

.

(1 − p)(1 − a)
−(1 − p)a

***
Example 3.11. Let W1 = (W1, 0, 0, Ω1) where Ω1 consists of just two atoms a
and b, with weight p and 1 − p, where 0 < p < 1/2, and W1(a, a) = W1(b, b) = 0,
W1(a, b) = W1(b, a) = 1. Furthermore, let W2 = (W2, 0, 0, Ω2) where Ω2 consists

of just one atom c with weight 1, and W2 is the constant a =(cid:112)p(1 − p). Then
atoms, and it will be equal to −(cid:112)p(1 − p) on the diagonal, and 1 −(cid:112)p(1 − p) oﬀ

we have just one choice of coupling. For this coupling, W π1
2 will have two
the diagonal. It is then not diﬃcult to see that (cid:107)W1 − W2(cid:107)2→2 is equal to the largest
eigenvalue (in absolute value) of the matrix

1 − W π2

The trace of this matrix is −a, and the determinant is

Here we used that a =(cid:112)p(1 − p) < 1/2. We then have that the two eigenvalues of

p(1 − p)a2 − p(1 − p)(1 − a)2 = p(1 − p)(2a − 1) < 0.

the matrix have opposite signs, and their sum is −a, which implies that the negative
one must be less than −a; i.e., it must have larger absolute value than a.
On the other hand, clearly (cid:107)W1(cid:107)2→2 = a, and (cid:107)W2(cid:107)2→2 is equal to the largest
eigenvalue (in absolute value) of the matrix
1 − p
0

which can easily be seen to be equal to(cid:112)p(1 − p) = a.

(cid:19)

(cid:18)0

p

,

Therefore, if we extend W1 and W2 by spaces of total measure at least 1, and couple
each Ωi to the extension, then

(cid:107)(cid:102)W1 −(cid:102)W2(cid:107)2→2 = max{(cid:107)(cid:102)W1(cid:107)2→2,(cid:107)(cid:102)W2(cid:107)2→2} = a.

Therefore, by extending, we can obtain a better coupling.
Finally, note that in (??), if we multiply the measure of the underlying space by c,
then the ﬁrst term is multiplied by c, the second by c3/4, and the third by c2/3. We
can therefore take c large enough so that the maximum in the term is dominated by
(cid:107)W1 − W2(cid:107)2→2. Therefore, we obtain that also for minimizing d2→2, we obtain a
better coupling if we extend by trivial extensions than if we do not.

***
Lemma 3.12. Let W be a signed graphex with bounded graphon part, and let
0 < D < ∞. Then the set {D|W| > D} has ﬁnite measure, and W|{D|W|≤D} is
integrable and hence in L1 ∩ L2.

***
Lemma 3.13. Let W1 = (W1, S1, I1, Ω) and W2 = (W2, S2, I2, Ω) be signed
graphexes in L1 ∩ L2, let Ω = (Ω,F, µ), and let

(1) (cid:107)W1 − W2(cid:107)2→2,µ = a,
(2) (cid:107)DW1 − DW2(cid:107)2,µ = b, and
(3) |ρ(W1) − ρ(W2)| = c.
1 = (W1, S1, I1, Ω(cid:48)) and W(cid:48)
(1) (cid:107)W1 − W2(cid:107)2→2,µ(cid:48) ≤ a,
(2) (cid:107)DW(cid:48)
(3)

− DW(cid:48)
1) − ρ(W(cid:48)

(cid:12)(cid:12)(cid:12)|ρ(W(cid:48)

1

r + ar.

If W(cid:48)
measure µ(cid:48) such that µ − r ≤ µ(cid:48) ≤ µ for some r < ∞, then

2 = (W2, S2, I2, Ω(cid:48)) where Ω(cid:48) = (Ω,F, µ(cid:48)) for some

√
(cid:107)2,µ(cid:48) ≤ b + a
r, and
√
2)| − c

(cid:12)(cid:12)(cid:12) ≤ 2b

2

i) = ∞. Then δ(cid:5)(W1, W2) =(cid:101)δ(cid:5)(W(cid:48)

***
Lemma 3.14. For i = 1, 2, let Wi be graphexes over Ωi = (Ωi,Fi, µi), and let
i be trivial extensions of Wi to σ-ﬁnite measure spaces Ω(cid:48)
W(cid:48)
i = (Ω(cid:48)
i) with
i(Ω(cid:48)
µ(cid:48)
1, W(cid:48)
2) is deﬁned as the
1 × Ω(cid:48)
inﬁmum over all c such that there exists a measure µ(cid:48) over Ω(cid:48)
2 obeying the
conditions
(1) µ(cid:48)
(2) d2→2((W(cid:48)

2), where (cid:101)δ(cid:5)(W(cid:48)

i for i = 1, 2, and
2)π2,µ(cid:48)

) ≤ c.

i − c2 ≤ (µ(cid:48))πi ≤ µ(cid:48)
, (W(cid:48)

1)π1,µ(cid:48)

1, W(cid:48)

i,F(cid:48)

i, µ(cid:48)

***
Proposition 3.15. Fix B, C, D < ∞. Then δ(cid:5) and δ2→2 deﬁne the same topology
on the space of (B, C, D)-bounded signed graphexes.

***
Lemma 3.16. Let Wi = (Wi, Si, Ii, Ω), for i = 1, 2, be (B, C, D)-bounded signed
graphexes on the same measure space Ω, and let µ(cid:48), r, W(cid:48)
2 be as in
Lemma 3.13 . Then

(1) (cid:107)W1 − W2(cid:107)2→2,µ(cid:48) ≤ (cid:107)W1 − W2(cid:107)2→2,µ ≤ (cid:107)W1 − W2(cid:107)2→2,µ(cid:48) + 4
(2)

− DW(cid:48)

(cid:12)(cid:12)(cid:12) ≤ (4D2 + 8BC)r, and

1, and W(cid:48)
√

BDr,

(cid:12)(cid:12)(cid:12)(cid:107)DW1 − DW2(cid:107)2
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)ρ(W(cid:48)

1) − ρ(W(cid:48)

(3)

2,µ − (cid:107)DW(cid:48)

2)(cid:12)(cid:12) −(cid:12)(cid:12)ρ(W1) − ρ(W2)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤ 4Dr.

(cid:107)2
2,µ(cid:48)

1

2

***
Lemma 3.17. Suppose Wi = (Wi, Si, Ii, Ωi), for i = 1, 2, are signed graphexes with
(cid:107)Wi(cid:107)∞ ≤ B and (cid:107)D|W|(cid:107)∞ ≤ D, and let δ(cid:5)(W1, W2) ≤ ε. Then |ρ(W1) − ρ(W2)| ≤
ε3 + 4ε2D. If, in addition, (cid:107)W(cid:107)i ≤ C, then δ2→2(W1, W2) ≤ f (ε), where

(cid:112)

(cid:17)1/2

,(cid:0)ε3 + 4ε2D(cid:1)1/3(cid:27)

(cid:26)

√
ε + 4ε

(cid:16)

f (ε) = max

BD,

ε2 + 2ε

D2 + 2BC

***
Lemma 3.18. Let U : Ω × Ω → R be a measurable function. Then

(cid:107)U(cid:107)4

2→2 ≤ t(C4, U ) ≤ (cid:107)U(cid:107)2

2→2(cid:107)U(cid:107)2
2.

***
Proposition 3.19. Given B, C, D < ∞, there exists a constant c < ∞ such that if
W1 and W2 are (B, C, D)-bounded signed graphexes, then the following hold.

√
(2) If d(cid:2)(W1, W2) ≤ ε, then d2→2(W1, W2) ≤ max{ 3

(1) If d2→2(W1, W2) ≤(cid:101)ε, then d(cid:2)(W1, W2) ≤ max{(cid:101)ε,(cid:101)ε3}.
d(cid:2)(W1, W2) ≤(cid:101)ε and d2→2(W1, W2) ≤ c 4

If the graphexes are such that ρ(W1) = ρ(W2), then these bounds can be replaced by

√
ε, c 4

ε}.

√

ε.

***

Lemma 3.20. Given a bounded, nonnegative, measurable function f on some
measure space (Ω,F, µ), we have

(cid:107)f(cid:107)2

(cid:112)(cid:107)f(cid:107)1(cid:107)f(cid:107)∞

2

≤ sup
S⊆Ω

(cid:90)

S

1(cid:112)µ(S)

f dµ ≤ (cid:107)f(cid:107)2.

In particular, the second and third term deﬁne equivalent norms, for any C, D, on
the space of nonnegative functions with (cid:107)f(cid:107)1 ≤ C,(cid:107)f(cid:107)∞ ≤ D.

***

Lemma 3.21. Given a bounded, measurable, not necessarily nonnegative function
f on some measure space (Ω, µ), we have

(cid:112)2(cid:107)f(cid:107)1(cid:107)f(cid:107)∞

(cid:107)f(cid:107)2

2

1(cid:112)µ(S)

≤ sup
S⊆Ω

(cid:12)(cid:12)(cid:12)(cid:12)(cid:90)

S

(cid:12)(cid:12)(cid:12)(cid:12) ≤ (cid:107)f(cid:107)2.

f dµ

***
Lemma 3.22. For any measurable U : Ω × Ω → R,
≥

(cid:107)U(cid:107)2→2 ≥ (cid:107)U(cid:107)(cid:2) ≥

(cid:107)U(cid:107)4

2→2

8(cid:107)U(cid:107)3/4∞ (cid:107)D|U|(cid:107)3/4∞ (cid:107)D|U|(cid:107)3/2

2

(cid:107)U(cid:107)4

2→2

8(cid:107)U(cid:107)3/4∞ (cid:107)D|U|(cid:107)3/2∞ (cid:107)U(cid:107)3/4

1

.

***
Remark 3.23. The above proof can easily be modiﬁed to see that for any 0 < D < ∞
the metrics δ2→2 and δ(cid:2) are equivalent on the space of (unsigned) graphexes with D-
bounded marginals. Indeed, if W has bounded marginals, it is integrable, and if either
δ2→2(Wn, W) → 0 or δ(cid:2)(Wn, W) → 0, then (cid:107)Wn(cid:107)1 = ρ(Wn) → ρ(W) = (cid:107)W(cid:107)1.
This shows that we can assume that the sequences are (C, D)-bounded for some C,
which means they are (B, C, D)-bounded for B = 1.

***

Proposition 3.24. For any simple graph F with no isolated vertices and graphex
W,

If the marginals of W are bounded, then the right side is ﬁnite, with

E [inj(F, GT (W))] = T |V (F )|t(F, W).

t(F, W) ≤(cid:89)

(cid:107)W(cid:107)1(cid:107)DW(cid:107)v(Fi)−2

∞

,

where the product runs over the components of F and vi is the number of vertices
in Fi.

i

***
Theorem 4.1. Given a set of graphexes S, the following are equivalent:

(1) S is tight. In other words, for every ε > 0, there exist C and D such
that for every graphex W ∈ S, W = (W, S, I, Ω) with Ω = (Ω,F, µ), there
exists Ωε ⊆ Ω such that µ(Ωε) ≤ ε and W(cid:48) = W|Ω\Ωε has (cid:107)W(cid:48)(cid:107)1 ≤ C,
(cid:107)DW(cid:48)(cid:107)∞ ≤ D.
(2) For every ε > 0, there exist C such that for every graphex W ∈ S, W =
(W, S, I, Ω), there exists Ωε ⊆ Ω such that µ(Ωε) ≤ ε and W(cid:48) = W|Ω\Ωε has
(cid:107)W(cid:48)(cid:107)1 ≤ C.
(3) For every ε, there is a D and C such that for any W ∈ S, taking Ω≤D to be
the set of points with DW(x) ≤ D, µ(Ω \ Ω≤D) ≤ ε, and (cid:107)W|Ω≤D(cid:107)1 ≤ C.
(4) For every T > 0, the set of random unlabeled ﬁnite graphs GT (W) with
W ∈ S is tight.
GT (W) with W ∈ S is tight.

(5) There exists T > 0 such that the set of random unlabeled ﬁnite graphs

***
Corollary 4.2. Let S be a set of graphexes.

(1) If there exists a C < ∞ such that (cid:107)W(cid:107)1 ≤ C for all W ∈ S, then S is tight.
(2) If S is tight and has uniformly bounded marginals, then there exist C, D < ∞

such that S is (C, D)-bounded.

***
Lemma 4.3. The probability that GT (W) has more than KT 2(cid:107)W(cid:107)1 edges is at
most

16(T 2(cid:107)W(cid:107)1/2 + T 3(cid:107)DW(cid:107)2
2)

T 4(cid:107)W(cid:107)2

1

and the probability that it has less than T 2(cid:107)W(cid:107)1/4 edges is at most

1

T 2(cid:107)W(cid:107)1/2 + T 3(cid:107)DW(cid:107)2
(K − 1/2)2T 4(cid:107)W(cid:107)2

2

,

***
Remark 4.4. It will sometimes be useful to transform a graphex W over an arbitrary
σ-ﬁnite space Ω = (Ω,F, µ) into a graphex over an atomless space by mapping Ω
to the product space Ω × [0, 1] equipped with the measure µ × λ, with λ denoting
the Lebesgue measure, and mapping W to Φ(W) = Wφ, with φ : Ω × [0, 1] → Ω
denoting the coordinate projection onto Ω. It is easy to see that δ(cid:5)(W, Φ(W)) = 0,
which together with the triangle inequality implies that the map Φ does not change
distances between graphons. It is also easy to check that if S is a tight set of
graphexes, then the set of graphexes obtained by mapping each graphex W ∈ S to
the corresponding atomless graphex Φ(W) is tight as well.

***
Lemma 4.5. Given C, D, M ∈ (0,∞), there exists a function f : [0,∞)2 → [0,∞)
such that f (x) → 0 as x → 0 and such that the following holds

(1) Let W be a graphex over (Ω,F, µ), and let(cid:101)µ be a second measure over (Ω,F)
such that µ − r ≤(cid:101)µ ≤ µ. If (cid:102)W is obtained from W by replacing µ with (cid:101)µ

then

µ(DW > D + r) − r ≤(cid:101)µ(D(cid:101)W > D) ≤ µ(DW > D)

(2) Let W1 and W2 be graphexes with bounded marginals, deﬁned over the same

for all D > 0.
space (Ω,F, µ). Suppose that d2→2(W1, W2) < ε. Then

δ2→2(W1,≤D, W2,≤D) ≤ f (ε, δ).

µ({|DW1 − DW2| ≥ ε}) < ε2.

> D + ε}) − ε2 ≤(cid:101)µ2({D(cid:101)W2

(3) Let (cid:102)W1 and (cid:102)W2 be graphexes with bounded marginals, deﬁned over
(Ω1,F1,(cid:101)µ1) and (Ω2,F2,(cid:101)µ2). If δ2→2((cid:102)W1,(cid:102)W2) < ε and D > ε, then
(cid:101)µ1({D(cid:101)W1
(4) For i = 1, 2, let Wi be graphexes deﬁned over (Ωi,Fi, µi), and let Wi,≤D
be the restriction of Wi to the subset {DWi ≤ D} of Ωi. Assume that
ε + ε2 < D, µ1({DW1 > D}) + µ2({DW2 > D}) ≤ M , (cid:107)W2,≤D(cid:107)1 ≤ C,
δ(cid:5)(W1, W2) ≤ ε, and µ2({D − ε − ε2 < DW2 ≤ D + ε + ε2}) ≤ δ. Then

> D}) ≤(cid:101)µ1({D(cid:101)W1

> D − ε}) + ε2.

***
Proposition 4.6. Given a sequence of graphexes Wn and a graphex W over the
σ-ﬁnite measure spaces Ωn = (Ωn,Fn, µn) and Ω = (Ω,F, µ), respectively, deﬁne
Wn,≤D and W≤D as above. Then the following are equivalent.
(1) For all D > 0 such that µ({DW = D}) = 0, we have δ2→2(Wn,≤D, W≤D) →
(2) The sequence is tight, and for all D > 0 such that µ({DW = D}) = 0, we
(3) For every ε > 0 and n ∈ N there exist subsets Ωn,ε ⊆ Ωn and a subset Ωε ⊆ Ω
n, W(cid:48)) → 0,

0 and µn(Ωn,>D) → µ(Ω>D).
have δ2→2(Wn,≤D, W≤D) → 0.
with µn(Ωn \ Ωn,ε) ≤ ε and µ(Ω \ Ωε) ≤ ε, such that δ2→2(W(cid:48)
where W(cid:48)

n = (Wn)|Ωn,ε and W(cid:48) = W|Ωε.

(4) δ(cid:5)(Wn, W) → 0.

***
Proposition 4.7. Given two graphexes W1, W2, let Wi,≤D be the graphex Wi
restricted to Ωi,≤D = {x ∈ Ωi : DWi (x) ≤ D}. Then the following are equivalent.

(1) For any D > 0,

µ1(Ω1 \ Ω1,≤D) = µ2(Ω2 \ Ω2,≤D) and δ2→2(W1,≤D, W2,≤D) = 0.

(2) For any D > 0, δ2→2(W1,≤D, W2,≤D) = 0.
(3) For any ε > 0, there exist subsets Ω1,ε ⊆ Ω1, Ω2,ε ⊆ Ω2 with µi(Ωi\Ωi,ε) ≤ ε,
such that if W(cid:48)
(4) δ(cid:5)(W1, W2) = 0.

i is the restriction to Ωi \ Ωi,ε, then δ2→2(W(cid:48)

1, W(cid:48)

2) ≤ ε.

***

√

this

that

Remark 4.8. It is not a priori clear how to generalize the notion of tightness
to signed graphexes, even if we restrict ourselves to the case where the graphon
parts are uniformly bounded, for example by taking graphons that take values in
[−1, 1]. Indeed, recalling Lemma 3.12 and the role it played in showing that δ(cid:5) is
ﬁnite for signed graphexes with bounded graphon part, one might want to modify
Deﬁnition 2.20 for such graphexes by replacing the notion of D-bounded marginals
by that of D-bounded absolute marginals, since this would, in particular, guarantee
that a ﬁnite set of signed graphexes with graphon parts in [−1, 1] is tight. It would
also make the generalization of several of our results straightforward, since this
deﬁnition just reduces the notion of tightness of a set of graphexes S to the set of
graphexes S(cid:48) = {|W| : W ∈ S}.
straightforward generalization of
The following example shows
Deﬁnition 2.20 to signed graphexes does not give a characterization of precompact
sets with respect to the metric δ(cid:5), as it did for unsigned graphexes; see Theorem 2.21
.
Let Wn be equal to n−3/4 on [0, 1) × [1, n + 1) ∪ [1, n + 1) × [0, 1), equal to −n−3/4
on [0, 1) × [n + 1, 2n + 2) ∪ [n + 1, 2n + 1) × [0, 1), and zero everywhere else on
R2
+. Deﬁne Wn to be the graphex with graphon part Wn and zero star and dust
part. Then DWn is equal to n−3/4 on [1, n + 1), equal to −n−3/4 on [n + 1, 2n + 1),
and 0 everywhere else. Finally, ρ(Wn) = 0 for all n. Since (cid:107)Wn(cid:107)2 = 2n−1/2 and
(cid:107)DWn(cid:107)2 =
2n−1/2, Wn tends to the zero graphex in the metric δ2→2 and hence
also in δ(cid:5). But (cid:107)Wn(cid:107)1 = (cid:107)W(cid:107)1 = 4n1/4 → ∞, a fact which can’t be changed by
removing just a part of measure ε from the underlying space, R+. This shows
that with the obvious generalization of Deﬁnition 2.20 to signed graphexes not all
sequences of signed graphexes that are convergent in δ2→2 or δ(cid:5) are tight.
We therefore believe that a complete theory of signed graphexes, even in the simpliﬁed
case where all graphons take values in [−1, 1], requires either a modiﬁcation of the
metric, or modiﬁcation of the notion of tightness. We leave this problem as an open
research problem.

***
Deﬁnition 5.1. Given two subspace partitions P = (ΩP,P) and Q = (ΩQ,Q),
we say that P reﬁnes Q if ΩQ ⊆ ΩP and P is a reﬁnement of Q ∪ {ΩP \ ΩQ}.

***
Deﬁnition 5.2. Given a signed graphex W = (W, S, I, Ω) and a ﬁnite subspace
partition P = (ΩP,P), take WP to be the signed graphex WP = (WP, SP, IP, Ω)
deﬁned by

(cid:90)

IP =

1
2

(Ω\ΩP )×(Ω\ΩP )

(cid:32)

(cid:90)

1

µ(Pi)

Pi

(cid:90)

Ω\ΩP

(cid:90)

(cid:33)

Ω\ΩP

W (x, y) dµ(x) dµ(y) +

S(x) dµ(x) + I,

SP(x) =

S(x) +

W (x, y) dµ(y)

dµ(x)

(cid:90)

for some i ∈ {1, . . . , k}, and 0 everywhere else, and

WP(x, y) =

if
for some i, j ∈ {1, . . . , k} and WP(x, y) = 0 everywhere else.

µ(Pi)µ(Pj)

Pi×Pj

W (x(cid:48), y(cid:48)) dµ(x(cid:48)) dµ(y(cid:48))

1

if x ∈ Pi

(x, y) ∈ Pi × Pj

***
Theorem 5.3. For any B, C, D < ∞, and ε > 0, there exists an M (ε) and N (ε)
such that for any signed graphex W that is (B, C, D)-bounded there exists a partition
(ΩP,P) with P = {P1, . . . , Pm}, m ≤ M (ε), and µ(ΩP) ≤ N (ε) such that

d(cid:2)(W, WP) ≤ ε.

We can take

M (ε) = 2(2BC+CD)/ε2

Given any ﬁnite subspace partition Q = (ΩQ,Q), we can require the subspace
partition P = (ΩP,P) to be a reﬁnement of Q. In this case, the bound on the
number of parts is |Q|M (ε) and the bound on µ(ΩP) is µ(ΩQ) + N (ε).

and

N (ε) = (4C 3D + 8BC 2D)/ε4.

***

Remark 5.4. With the help of Proposition 3.19 , Theorem 5.3 can immediately be
transformed into a similar statement for the kernel distance d2→2(W, WP), provided
N (ε) and M (ε) are replaced by bounds of the form M (ε) = 2c/ε8
and N (ε) = d/ε16
where c and d are constants depending on B, C and D.

***
Lemma 5.5. Let W1, W2 be two graphexes on the same space Ω, and let P be a
ﬁnite subspace partition of Ω. Then

(cid:107)W1,P − W2,P(cid:107)2→2 ≤ (cid:107)W1 − W2(cid:107)2→2

and

(cid:107)DW1,P − DW2,P(cid:107)2 ≤ (cid:107)DW1 − DW2(cid:107)2.

***
Corollary 5.6. Suppose that W is a graphex, and that U is a step graphex over
the same space as W. If P = (ΩP,P) is a ﬁnite subspace partition such that U is
constant on each part of P and zero outside ΩP, then

(cid:107)WP − W(cid:107)2→2 ≤ 2(cid:107)U − W(cid:107)2→2

and

(cid:107)DWP − DW(cid:107)2 ≤ 2(cid:107)DU − DW(cid:107)2.

***

Theorem 5.7. Given B, C, D, and ε > 0, there exists ρ0 = ρ0(ε, B, C, D) > 0
and N0 = N0(ε, B, C, D) such that for any ρ < ρ0, any m ≥ N0/ρ, and any
(B, C, D)-bounded signed graphex W on an atomless space with inﬁnite measure,
there exists a subspace partition P = (ΩP,P) with exactly m parts of size ρ such
that d2→2(W, WP) ≤ ε. If P0 = (ΩP0 ,P0) is an arbitrary ﬁnite subspace partition,
we can require P to reﬁne P0, as long as each part of P0 is divisible by ρ (and
increasing the bound on N0(ε) and decreasing ρ0 appropriately depending on |P0|
and µ(ΩP0)).

***
Lemma 5.8. Let S be a set of signed graphexes over atomless spaces of inﬁnite
measure such that the following condition holds:
(a) For every ε > 0, there exists B, C, D such that for any W = (W, S, I, (Ω,F, µ)) ∈
S, taking Ω≤D to be the set of points with D|W|(x) ≤ D, we have that µ(Ω \
Ω≤D) ≤ ε, (cid:107)W|Ω≤D(cid:107)∞ ≤ B, and (cid:107)W|Ω≤D(cid:107)1 ≤ C.
Then there exist strictly increasing sequences of integers ak ≥ 2k and bk ≥ k and
sequences of positive real numbers Bk, Ck, and Dk such that the following holds. For
any graphex W ∈ S, W = (W, S, I, Ω) with Ω = (Ω,F, µ), there exists a sequence of
subsets Pk,0 ⊆ Ω and subspace partitions Pk = (ΩPk ,Pk), Pk = {Pk,1, . . . , Pk,mk}
with mk = 2ak+bk , such that for all k, ΩPk is disjoint from Pk,0 and

(1) Pk+1,0 ⊆ Pk,0 and µ(Pk,0) = 2−2k,
(2) Wk = W|Ω\Pk,0 is (Bk, Ck, Dk)-bounded,
(3) Pk+1 reﬁnes Pk,
(4) Pk,i for i ≥ 1 has measure 2−ak , and
(5) d2→2(Wk, (Wk)Pk ) ≤ 2−k.

***

Lemma 5.9. Every tight sequence of graphexes has a subsequence that is δ(cid:5)-
convergent. More generally, every sequence of signed graphexes obeying the condition
(a) from Lemma 5.8 has a δ(cid:5)-convergent subsequence. If condition (a) holds with
one or more of the constants B, C, D not depending on ε, then the subsequential
limit inherits the corresponding bound.

ﬁnite subspace partition, and P0 ⊆ P. Let Ω0 = (cid:83)

***
Claim. Suppose that W = (W, S, I, Ω) is a signed graphex, P = (ΩP,P) is a
P , P(cid:48) = P \ P0, and
P(cid:48) = (Ω(cid:48)

P∈P0

P(cid:48),P(cid:48)), where Ω(cid:48)

P(cid:48) = ΩP \ Ω0. Then (WP)|Ω(cid:48) = (W|Ω(cid:48))P(cid:48).

***
Remark 5.10. It is not hard to see that a sequence of signed graphexes Wn =
(Wn, Sn, In, Ωn) with (cid:107)Wn(cid:107)∞ ≤ B and (cid:107)Wn(cid:107)1 ≤ C obeys the condition (a) from
Lemma 5.8 . If B ≤ 1, this follows by applying Corollary 4.2 (1) to the sequence
|Wn|, and for B > 1 it follows by applying Corollary 4.2 (1) to the sequence
(|Wn|/B,|Sn|/B,|In|/B, Ωn). Choosing a convergent subsequence, it is clear from
the last proof that the limiting graphex W = (W, S, I, Ω) must obey the bound
(cid:107)W(cid:107)∞ ≤ B. The statement from Remark 2.22 therefore is a direct consequence of
Lemma 5.9 .

***
Lemma 6.1. Let F be a simple, connected graph with m edges and n ≥ 3 vertices,
and let C, D < ∞. Suppose that W1 and W2 are graphexes on the same underlying
space Ω, with (cid:107)Wi(cid:107)1 ≤ C and (cid:107)DWi(cid:107)∞ ≤ D for i = 1, 2, and let ε = max{(cid:107)W1 −
W2(cid:107)2→2,(cid:107)DW1−W2(cid:107)2}. Then
where (cid:101)C = max{C,

|t(F, W1) − t(F, W2)| ≤ mε(cid:101)CDn−3,

√

CD}.

***
Corollary 6.2. Suppose Wn, W have uniformly bounded marginals. If

δ2→2(Wn, W) → 0,

then for any ﬁnite graph F with no isolated vertices, t(F, Wn) converges to t(F, W).

***
Theorem 6.3. Assume that the marginals of Wn and W are bounded by some ﬁnite
constant D. Then the following are equivalent:

(1) GT (Wn) → GT (W) in distribution for every T .
(2) GT (Wn) → GT (W) in distribution for some T .
(3) For every graph F with no isolated vertices, t(F, Wn) → t(F, W).
(4) For every connected graph F , t(F, Wn) → t(F, W).

***

Deﬁnition 6.4. Suppose we have a connected multigraph F , and signed graphexes
We assigned to each edge e ∈ E(F ) (refer to this vector of graphexes as WF ), each
with the same feature space Ω. Let V≥2 be the set of vertices with degree at least 2.
If V≥2 is nonempty (i.e., F does not consist of a single edge), then we deﬁne

(cid:90)

(cid:89)

t(F, WF ) =

dzV≥2

ΩV≥2

{v,w}∈E(F (V≥2))

W{v,w}(zv, zw)

· (cid:89)

v∈V≥2

(cid:89)

w∈V \V≥2:
{v,w}∈E(F )

DW{v,w} (zv).

If F consists of just a single edge f , then

t(F, WF ) = ρ(Wf ),

with ρ(Wf ) as in (??). Note that for signed graphexes t(F, WF ) is in general only
well deﬁned if the integrals are absolutely convergent, a condition which can, e.g.,
be guaranteed by requiring that t(F, Wabs
is obtained from WF
by replacing the graphexes Wf by |Wf|.

F ) < ∞, where Wabs

F

***

(cid:90)

Deﬁnition 6.5. Suppose we have a connected multigraph F with a labeled vertex
v0, more than one edge, and signed graphexes We assigned to each edge as before. Let
x ∈ Ω, and deﬁne zv0 = x. Take, furthermore, V (cid:48)
Then we deﬁne tx(F, WF ) to be
{v,w}∈E(F ((cid:101)V≥2))

≥2 = V≥2\{v0} and(cid:101)V≥2 = V≥2∪{v0}.
(cid:89)

W{v,w}(zv, zw)

DW{v,w} (zv).

(cid:89)

dzV (cid:48)
≥2

V (cid:48)
≥2

Ω

(cid:89)
w∈V \((cid:101)V≥2):

{v,w}∈E(F )

v∈V≥2

If F consists of just a single edge f adjacent to v0, then we set tx(F, W) = DW(x).
Again, for signed graphexes, this is in general only well deﬁned if the integrals are
absolutely convergent.

***

Lemma 6.6. Suppose F is a connected multigraph with no loops and a labeled
vertex v0, T is a spanning tree, and We is a signed graphex corresponding to each
edge e, each with the same feature space Ω. Let f ∈ T be an edge adjacent to v0,
and x ∈ Ω. Then

|tx(F, WF )| ≤ D|Wf|(x)

(cid:107)D|We|(cid:107)∞

(cid:107)We(cid:107)∞.

(cid:89)

e∈T\f

(cid:89)

e∈E(F )\T

***

Lemma 6.7. Suppose F is a connected multigraph with no loops, and we have a
signed graphex We corresponding to each edge e ∈ F . Let T be any spanning tree in
F , and f ∈ T . Then

|t(F, WF )| ≤ (cid:107)Wf(cid:107)1

(cid:107)D|We|(cid:107)∞

(cid:107)We(cid:107)∞.

(cid:89)

e∈T\f

(cid:89)

e∈E(F )\T

***

i

√

Remark 6.8. It is instructive to note that the bound in Lemma 6.1 can be tightened
to give the constant

(cid:101)C = max
instead of the constant (cid:101)C = max{C,

max{(cid:107)Wi(cid:107)2,(cid:107)DWi(cid:107)2}
√
CD}. To see this, we ﬁrst note that near the
end of the proof, we bounded (cid:107)DW
vu(cid:48)(cid:107)2 by
CD, even though it is possible that
the ﬁrst term is ﬁnite while the second is inﬁnite. In a similar way, bounding the
integral representing t(F (cid:48)
u, WF,f ) and t(F (cid:48)
v, WF,f ) with the help of Lemma 6.7 is
suboptimal. Indeed, the multi-graph F (cid:48)
v always contains at least one double edge, or
contain at least one edge uvi and its twin uv(cid:48)
i, with both vi and v(cid:48)
i having degree one.
In the ﬁrst case, Lemma 6.7 can be improved to extract a factor (cid:107)Wf(cid:107)2 instead
of a factor (cid:107)Wf(cid:107)1, in the second it can be improved to extract a factor (cid:107)DWf(cid:107)2.
Inserted into the proof of Lemma 6.1 , this gives the claimed improvement.

***

Remark 6.9. As the reader can easily verify, the above proof immediately generalizes
to signed graphexes, showing that Lemma 6.1 holds for (B, C, D) bounded graphexes,
provided we include a factor of Bm−(n−1) on the right side. As a consequence,
Corollary 6.2 holds for sequences of (B, C, D)-bounded graphexes that converge in
the kernel distance δ2→2.

***
Theorem 6.10. Let G and Gn, for n ≥ 1, be random ﬁnite graphs with no isolated
vertices, and let X and Xn, for n ≥ 1, be the random variables that correspond to
the number of vertices in G and Gn, respectively. If, for every t > 0, E[etX ] and
E[etXn ] are ﬁnite and uniformly bounded, then the following are equivalent:

the probability that G is isomorphic to G.

(1) For any graph G, the probability that Gn is isomorphic to G converges to
(2) For every graph F , E[inj(F, Gn)] → E[inj(F, G)].
(3) For every graph F with no isolated vertices, E[inj(F, Gn)] → E[inj(F, G)].

***
Lemma 6.11. Suppose we have two random ﬁnite graphs with no isolated vertices, G
and G(cid:48). Suppose that for every ﬁnite graph F with no isolated vertices, E[inj(F, G)] =
E[inj(F, G(cid:48))]. Let X be the random variable that gives the number of vertices in G,
and suppose that for every t, E[etX ] is ﬁnite. Then E[inj(F, G)] and E[inj(F, G(cid:48))]
are equal for every ﬁnite graph F .

***
Lemma 6.12. Suppose we have two random ﬁnite graphs, G and G(cid:48). Suppose
that for every ﬁnite graph F , E[inj(F, G)] = E[inj(F, G(cid:48))]. Let X be the random
variable that gives the number of vertices in G, and suppose that for some ε > 0,
E[(2 + ε)X ] is ﬁnite. Then G and G(cid:48) give rise to the same distribution on graphs
(up to isomorphism).

***
Lemma 6.13. Given t > 0, let t(cid:48) = 2t + log 4. Then the following holds for any
positive integer n and any graph G on n vertices with no isolated vertices. Suppose
we randomly color the vertices red and blue, and let X be the number of vertices
that are colored red, and have at least one blue neighbor. Then

E[et(cid:48)X ] ≥ etn.

***
Lemma 6.14. For any T, t, C, D ∈ R+, there exists a ﬁnite B such that the
following holds. Suppose we have a graphex W, with (cid:107)DW(cid:107)∞ ≤ D and (cid:107)W(cid:107)1 ≤ C.
Let X be the number of vertices (that are not isolated) of GT (W). Then E[etX ] ≤ B.

***
Theorem 6.15. Given two graphexes W, W(cid:48) with bounded marginals, the following
are equivalent:

(1) GT (W) and GT (W(cid:48)) have the same distribution for every T .
(2) GT (W) and GT (W(cid:48)) have the same distribution for some T .
(3) For every graph F with no isolated vertices, t(F, W) = t(F, W(cid:48)).
(4) For every connected graph F , t(F, W) = t(F, W(cid:48)).

***
Theorem 6.16. Suppose Wn and W have uniformly bounded marginals, and
δ2→2(Wn, W) → 0. Then Wn is GP-convergent to W.

***
Theorem 6.17. Suppose that graphexes W and (Wn)∞
δ(cid:5)(Wn, W) → 0. Then Wn is GP-convergent to W.

n=1 have the property that

***
Theorem 7.1. For every graphex W and ε > 0,

P[δ(cid:5)(W(GT (W), 1/T ), W) > ε] = 0.

lim
T→∞

For a set of graphexes that is tight, the convergence is uniform.

***

Remark 7.2. The above theorem only claims convergence in probability. However,
once we establish equivalence of GP-convergence and convergence in the weak
kernel norm, the results of [18] imply convergence with probability one (since there
convergence with probability one is proved for GP-convergence). Nevertheless, to
establish the equivalence, all we need is convergence in probability, so this is all we
will prove here.

***
Theorem 7.3. Suppose W1, W2 are two (C, D)-bounded graphexes on the same
space Ω, and suppose that d2→2(W1, W2) ≤ c for some 0 < c < 1. Then there exists
a T0 (depending only on c, C, and D) such that for any T > T0, there exists a
coupling of the random graphs GT (W1) and GT (W2) so that

(cid:16)

√
(31cC)1/4, 2c3/4, 3

(cid:17)(cid:105)

3c

< c.

P(cid:104)

δ2→2(W(GT (W1), 1/T ), W(GT (W2), 1/T )) > min

***
Lemma 7.4. Let W = (W, S, I, Ω) be a (C, D)-bounded graphex, and T > 1/D.

Let GT (W) be the usual sample at time T , and let (cid:101)GT (W) consist of only those

edges which come from I or S. Then

(cid:34)
(cid:107)W ((cid:101)GT (W), 1/T )(cid:107)2→2 >

P

(cid:19)1/4(cid:35)

(cid:18) 2CD√

T

<

1√
T

.

***
Lemma 7.5. Suppose H is a weighted graph on N with weights Hi,j ∈ [0, 1], and
Hi,i = 0. Suppose that G is generated by taking an edge between i and j with
i,j Hi,j ≤ E
i,j,k Hi,jHj,k ≤ F where the sum goes over pairwise distinct vertices. Let

probability Hi,j, independently for every pair of vertices. Suppose that(cid:80)
and (cid:80)

0 < ρ. Then

P[(cid:107)W(G, ρ) − W(H, ρ)(cid:107)2→2 > ρ7/8(E + 2F )1/4] <

√

ρ.

***

Lemma 7.6. For every ε, C, and D, there exist M , N , and ρ such that the following
holds. For every (C, D)-bounded graphex W, there exists a (C, D)-bounded graphex
Wε = (Wε, 0, 0, Ωε), where Ωε = (Ωε,Fε, µε) and µε(Ωε) ≤ N , and furthermore
the graphon Wε is a step function with at most M steps, with each part having size
equal to ρ, and δ2→2(W, Wε) ≤ ε.

Remark 7.7. Using the ideas of the previous proof, it is not hard to see that

in distribution, the process generated from the graphex (cid:102)WQ = ((cid:102)WQ, 0, 0,(cid:101)ΩD)

δ(cid:5)((cid:102)WQ, W) → 0

constructed in Remark 2.3 (3) converges to the one generated from W. Indeed, we
claim that
To see this, ﬁx ε > 0 and choose D in such a way that the set Ω>D = {DW > D}

has measure at most ε2. Let Ω≤D = Ω \ Ω>D and (cid:101)Ω≤D = Ω≤D ∪ {∞} =(cid:101)Ω \ Ω>D.
Setting (cid:102)WQ,≤D = ((cid:102)WQ)|(cid:101)Ω\Ω>D
and W≤D = W|Ω\Ω>D and deﬁning (cid:102)W≤D as the
trivial extension of W≤D to (cid:101)Ω≤D, we will want to show that for Q large enough,
d2→2((cid:102)W≤D,(cid:102)WQ,≤D) ≤ ε, since this implies that δ2→2(W≤D,(cid:102)WQ,≤D) ≤ ε and hence
δ(cid:5)((cid:102)WQ, W) ≤ ε. But this follows by essentially the same argument as the one in the
previous proof; all that is needed is that by Proposition 2.4 ,(cid:102)W≤D is (C, D)-bounded

as

Q → ∞.

***

for some C < ∞.

***

Lemma 7.8. For every N0, ε, and δ, there exists n0 such that the following holds.
For any weighted graph H on n ≥ n0 vertices with weights in [0, 1], and any N ≤ N0,
the probability that δ2→2(W(H, N/n), W(G(H), N/n)) > ε is at most δ.

***
Theorem 7.9. Given a pair of graphexes W, W(cid:48), we have δ(cid:5)(W, W(cid:48)) = 0 if and
only if for every T > 0, GT (W) and GT (W(cid:48)) have the same distribution.

***
Theorem 8.1. Let W1 = (W1, S1, I1, Ω1) and W2 = (W2, S2, I2, Ω2) be graphexes,
where Ωi = (Ωi,Fi, µi) are σ-ﬁnite spaces. Suppose δ(cid:5)(W1, W2) = 0. Then there
exists a third graphex W = (W, S, I, Ω) over a σ-ﬁnite measure space Ω = (Ω,F, µ)
and measure preserving maps φi : dsupp Wi → Ω such that Wi|φ−1(Ω) = Wφi (and
Wi, Si = 0 everywhere else) for i = 1, 2.

***
Theorem 8.2. Let W1 = (W1, S1, I1, Ω1) and W2 = (W2, S2, I2, Ω2) be graphexes,
where Ωi = (Ωi,Fi, µi) are σ-ﬁnite Borel spaces. Suppose further that DWi > 0
everywhere for i = 1, 2, and δ(cid:5)(W1, W2) = 0. Then µ1(Ω1) = µ2(Ω2), I1 = I2, and
there exists a coupling of Ω1 and Ω2, that is, a measure ν on (Ω1 × Ω2,F1 × F2)
with marginals µ1 and µ2, such that if πi : Ω1 × Ω2 → Ωi is the projection map, then
W π1

ν-almost-everywhere, and Sπ1

2 ν-almost-everywhere.

1 = W π2

2

1 = Sπ2

***

“edge density” ρ(Wi) =(cid:82) W dµ × dµ + 2(cid:82) S dµ + 2I, and then use the third root

Remark 8.3. Throughout this paper, we have considered graphexes where all three
parts are non-negative. While this makes sense when considering graphexes as
generators of a graphex process, from an analytical point of view, it is less natural.
Indeed, it is easy to deﬁne the kernel and weak kernel distance for graphexes where
the three parts take values in R. Taking, e.g., the kernel distance d2→2 deﬁned
in (??), all we need to do is replace the L1 norms in the third part by a signed
of |ρ(W1) − ρ(W2)| instead of the third root of |(cid:107)W1(cid:107)1 − (cid:107)W2(cid:107)|. In particular in
view of the just discussed results from [3] and [17], we conjecture that Theorem 8.2
holds for signed graphexes as well, provided the condition DWi > 0 is replaced by
the condition D|Wi| > 0, where |Wi| is obtained from Wi by replacing all three
components of Wi by their absolute values. We leave the proof of this conjecture as
an open problem.

***

Remark 8.4. Section ?? does not use nonnegativity in any essential way, and should
easily generalizable to signed graphexes. This should give a relatively straightforward
proof of the analogue of Theorem 8.1 for graphons of cut distance zero, and also
allow for the more general setting of signed graphexes, once the above conjectured
generalization of Theorem 8.2 is established. Again we leave this as an open
problem.

***

Lemma 8.5. For any c,

(1) limε→0 νε(Ω1,>c × Ω2,>c) = µi(Ωi,>c) for i = 1, 2 (regardless of the choice

of νε), and

(2) µ1(Ω1,>c) = µ2(Ω2,>c).

***
Lemma 8.6. For any n ≥ 1, there exists a measure νn on Ω1,>1/n × Ω2,>1/n such
that the following hold:

(1) νn is a coupling of Ω1,>1/n and Ω2,>1/n,
(2) νn+1|Ω1,>1/n×Ω2,>1/n = νn,
(3) W π1

1 and W π2

almost everywhere, and

2 are equal when restricted to (Ω1,>1/n × Ω2,>1/n)2, νn × νn-
are equal when restricted to Ω1,>1/n × Ω2,>1/n, νn-almost

(4) DWπ1

and DWπ2

2

1

everywhere.

***
Corollary 8.7. Let W = (W, S, I, Ω) and W(cid:48) = (W (cid:48), S(cid:48), I(cid:48), Ω(cid:48)) be graphexes that
are equivalent, and suppose that DW, DW(cid:48) > 0 everywhere. Then there exist a
positive integer n and a chain of graphexes Wi = (Wi, Si, Ii, Ωi) for i = 0, . . . , n,
with DWi > 0 everywhere for each i = 0, . . . , n, W0 = W, Wn = W(cid:48), and for each
i ≥ 1, either Wi−1 = Wφi
i almost everywhere for some measure preserving map φi
from Ωi−1 to Ωi, or Wi = Wφi
i−1 almost everywhere for some φi from Ωi to Ωi−1.
In fact, we can take n = 4.

***
Lemma 8.8. Suppose that (Ω,F, µ) and (Ω(cid:48),F(cid:48), µ(cid:48)) are σ-ﬁnite measure spaces,
W : Ω × Ω(cid:48) → R is measurable, and for all x ∈ Ω, the function W (x,·) is integrable.
Let ψW : Ω → L1(Ω,F, µ) be the map x (cid:55)→ W (x,·). Then we can ﬁnd a separable
closed subspace B of L1(Ω(cid:48),F(cid:48), µ(cid:48)) such that ψW (x) ∈ B for all x ∈ Ω.

***
Lemma 8.9. Suppose (Ω,F, µ) and (Ω(cid:48),F(cid:48), µ(cid:48)) are σ-ﬁnite measure spaces, W : Ω×
Ω(cid:48) → R is F × F(cid:48)-measurable, and that for all x ∈ Ω, the function W (x,·) is
integrable. Then the map ψW : Ω → L1(Ω(cid:48),F(cid:48), µ(cid:48)) with x (cid:55)→ W (x,·) is measurable
with respect to the standard Borel σ-algebra on L1(Ω,F, µ). .

***
Lemma 8.10. Let (Ω,F, µ) be any σ-ﬁnite measure space, and B ⊆ L1(Ω,F, µ) a
closed separable subspace. Then there exists a measurable evaluation map

Φ : B × Ω → R

such that for any f ∈ B, for almost every x ∈ Ω, f (x) = Φ(f, x) (note that f (x) is
only deﬁned almost everywhere). In particular, if L1(Ω,F, µ) is separable, we can
take B = L1(Ω,F, µ).

***
Lemma 8.11. Suppose that (Ω,F, µ) and (Ω(cid:48),F(cid:48), µ(cid:48)) are σ-ﬁnite measure spaces,
W : Ω × Ω(cid:48) → R is measurable, and for all x ∈ Ω and x(cid:48) ∈ Ω(cid:48), both W (x,·) and
W (·, x(cid:48)) are integrable. Let ψW be the map Ω → L1(Ω(cid:48),F(cid:48), µ(cid:48)) with x (cid:55)→ W (x,·),
W be the map Ω(cid:48) → L1(Ω,F, µ) with y (cid:55)→ W (·, y). Further, let G be the Borel
and ψ(cid:48)
σ-algebra on L1(Ω,F, µ), and let

W , µ(cid:48)).

W (G).
Then for almost every x ∈ Ω, ψW (x) ∈ L1(Ω(cid:48),F(cid:48)

W = ψ(cid:48)−1
F(cid:48)

Proposition 8.12. The space ΩW as deﬁned above is a complete, separable metric

space, with the metric induced by L1((cid:101)Ω, (cid:101)F,(cid:101)µ), and µW has full support in ΩW.
Furthermore, ΩW ⊆ L1((cid:101)Ω, (cid:101)FW ,(cid:101)µ) ⊆ L1((cid:101)Ω, (cid:101)FW,(cid:101)µ). Finally, after modifying W and

***

S on a set of measure zero ψW becomes an everywhere deﬁned, measure-preserving
map from (Ω,F, µ) to (ΩW,GW, µW), and we furthermore have ψ−1W (GW) = FW.

***
Lemma 8.13. Let ΩW and µW be as deﬁned above, and let GW be the Borel σ-
algebra over ΩW. If W is locally ﬁnite, W (x,·) is integrable for all x ∈ Ω, and
µ(Ω \ dsupp W) < ∞, then (ΩW,GW, µW) is σ-ﬁnite.

***
Remark 8.14. Note that the condition µ(Ω \ dsupp W) < ∞ is necessary, since
otherwise the point {(0, 0)} becomes an atom with inﬁnite measure.

***
Lemma 8.15. For i = 1, 2, let Wi = (Wi, Si, Ii, Ωi) be graphexes with Ωi =
2 almost everywhere. Extend φ to (cid:101)φ : (cid:101)Ω1 →(cid:101)Ω2
(Ω1,Fi, µi) and µi(Ωi\dsupp Wi) = 0. Suppose that there exists a measure-preserving
by (cid:101)φ(Ω1,∞) = Ω2,∞. Then the map (cid:101)φ∗ : L1((cid:101)Ω2) → L1((cid:101)Ω1) deﬁned by f (cid:55)→ f ◦(cid:101)φ
map φ : Ω1 → Ω2 such that W1 = Wφ
between (ΩW2,GW2, µW2) and (ΩW1 ,GW1, µW1), and(cid:99)W2 =(cid:99)Wφ∗
restricts to a map ΩW2 → ΩW1, which is an isometric measure-preserving bijection
for any choices of(cid:99)W1 and(cid:99)W2.
1 almost everywhere,

***
Theorem 9.1. Given a set of integrable graphexes S, the following are equivalent.
(1) S is uniformly integrable.
(2) The graphexes in S have uniformly bounded (cid:107) · (cid:107)1-norms, and for every
(3) For any T > 0, the random variables E(GT (W)) with W ∈ S are uniformly
(4) There exists T > 0 such that the random variables E(GT (W)) with W ∈ S

ε > 0, there exists a D such that for all W ∈ S, (cid:107)W(cid:107)1 − (cid:107)W≤D(cid:107)1 < ε.

integrable.

are uniformly integrable.

***

Lemma 9.2. Suppose that a set of graphexes consisting only of graphons is uniformly
tail regular. Then the set is uniformly integrable.

***
Lemma 9.3. Given a set of graphons S, the following are equivalent:

(1) The set of graphons is uniformly tail regular.
(2) The set of graphons has a uniform bound on their (cid:107)·(cid:107)1-norm, and for every
(3) The set of graphons has a uniform bound on their (cid:107)·(cid:107)1-norm, and for every

ε, there exists a δ such that (cid:107)W(cid:107)1 − (cid:107)W|Ω>δ(cid:107)1 ≤ ε.
ε, there exists a δ such that (cid:107)DW 1DW ≤δ(cid:107)1 ≤ ε.

***
Corollary 9.4. Given a set of graphons S, suppose that we replace each graphon
with a pullback. Let S(cid:48) be the new set. Then S(cid:48) is uniformly tail regular if and only
if S is.

***

Lemma 9.5. Suppose that a sequence of integrable graphons Wn converge to a
graphon W in the cut metric. Then for any D > 0 such that µ(DW = D) = 0, the
graphons Wn,≤D converge to W≤D in the cut metric.

***

Lemma 9.6. Suppose that a sequence of integrable graphons Wn have uniformly
bounded marginals, and converge to a (necessarily integrable) graphon W in the cut
metric. Then W has the same bound on its marginals, and δ2→2(Wn, W) → 0.

***
Lemma 9.7. Suppose that δ(cid:5)(W, W(cid:48)) = 0 for two integrable graphexes, and suppose
that W = (W, 0, 0, Ω). Then W(cid:48) = (W (cid:48), 0, 0, Ω(cid:48)) and δ(cid:3)(W, W (cid:48)) = 0.

***
Lemma A.1. Let ψ(x) = 1 − e−x. Then the following hold, with both side of the
various identities being possibly inﬁnite:
(1) E[η(S)] = (cid:107)S(cid:107)1 and E[η2(W )] = (cid:107)W(cid:107)1,
(2) E[ψ(η(S))] = ψ((cid:107)ψ(S)(cid:107)1), and
(3) E[(η2(W ))2] = (cid:107)W(cid:107)2

1 + 4(cid:107)W ◦ W(cid:107)2 + 2(cid:107)W 2(cid:107)1.

***
Proposition A.2. Let S : Ω → R+ be measurable, and let W : Ω × Ω → [0, 1] be
symmetric and measurable. Then the following hold:

(1) η(S) < ∞ a.s. if and only if (cid:107) min{S, 1}(cid:107)1 < ∞, and
(2) η2(W ) < ∞ a.s. if and only if there exists a ﬁnite D > 0 such that the

following three conditions hold:
(a) DW < ∞ almost surely,
(b) µ({x ∈ Ω : DW (x) > D}) < ∞, and
(c) (cid:107)W|{x∈Ω:DW (x)≤D}(cid:107)1 < ∞.

***

Proposition B.1. For any graphex W = (W, S, I, Ω), there exists a graphex(cid:102)W =
((cid:102)W ,(cid:101)S,(cid:101)I,(cid:101)Ω) on an atomless space (cid:101)Ω such that on the diagonal, (cid:102)W is {0, 1} valued
and such that (cid:101)G∞((cid:102)W) and (cid:101)GT ((cid:102)W) are equivalent to (cid:101)G∞(W) and (cid:101)GT (W), respectively.

***
Theorem B.2. Let W1 and W2 be graphexes with special subsets as above. Then

(cid:101)GT (W1) and (cid:101)GT (W2) have the same distribution for all T ∈ R+ if and only if there

exists a third graphex with special subset W such that W1 and W2 are pullbacks of
W.

