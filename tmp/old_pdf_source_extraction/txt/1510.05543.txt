***
Theorem 1.1. [See Theorem 4.3 ] For L a lisse Zp -sheaf on Xét , we have a
canonical isomorphism of Bcris -modules
(1.0.1)

∼

→ H i (Xk,proét , L ⊗ Bcris ).
H i (Xk,ét , L) ⊗Zp Bcris −

compatible with Gk -action, filtration, and Frobenius.

***
Theorem 1.2. [See Theorem 4.5 ] Let L be a lisse Zp -sheaf on X and E be a
filtered F -isocrystal on X0 /Ok which are associated as in (??). Then there is a
natural isomorphism of Bcris -modules
∼

i
H i (Xk,ét , L) ⊗ Bcris −
→ Hcris
(X0 /Ok , E) ⊗k Bcris

which is compatible with Gk -action, filtration and Frobenius.

***
Theorem 1.3. [See Theorem 5.6 ] Let f : X → Y be a proper smooth morphism of
smooth formal schemes over Spf Ok , with fk : X → Y the generic fiber and fcris the
morphism between the crystalline topoi. Let L, E be as in Theorem 1.2 . Suppose
that Ri fk∗ L is a lisse Zp -sheaf on Y . Then it is crystalline and is associated to the
filtered F -isocrystal Ri fcris∗ E.

***
Definition 2.1. Let X be a locally noetherian adic space over Spa(k, Ok ) as above.
Consider the following sheaves on Xproét .
(1) Define Acris to be the p-adic completion of the PD-envelope A0cris of Ainf
with respect to the ideal sheaf ker(θ) ⊂ Ainf , and define B+
cris := Acris [1/p].
(2) For r ∈ Z≥0 , set Filr A0cris := ker(θ)[r] A0cris ⊂ A0cris to be the r-th divided
power ideal, and Fil−r A0cris = A0cris . So the family {Filr A0cris : r ∈ Z} gives
a descending filtration of A0cris .
(3) For r ∈ Z, define Filr Acris ⊂ Acris to be the image of the following
morphism of sheaves (we shall see below that this map is actually injective):
(2.1.4)

lim(Filr A0cris )/pn −→ lim A0cris /pn = Acris ,
←
−
←
−
n
n
r
and define Filr B+
cris = Fil Acris [1/p].

***
Lemma 2.2. We have ker(θ)|Xk = (ξ) ⊂ Ainf |Xk . Furthermore, ξ ∈ Ainf |Xk is not
a zero-divisor.

***
Corollary 2.3. (1) We have A0cris |Xk = Ainf |Xk [ξ n /n! : n ∈ N] ⊂ Binf |Xk .
∼
Moreover, for r ≥ 0, Filr A0cris |Xk = Ainf |Xk [ξ n /n! : n ≥ r] and grr A0cris |Xk −→
d
+
O
| .
X Xk

∼

(2) The morphism (2.1.4) is injective, hence limn Filr A0cris /pn −→ Filr Acris .
←−
∼ d
+
Moreover, for r ≥ 0, grr Acris |Xk −→ O
|
.
X Xk

***
Definition 2.4. Let X be a locally noetherian
space over Spa(k, Ok ). Define
P adic−s
r
Bcris = B+
[1/t].
For
r
∈
Z,
set
Fil
B
=
t
Filr+s B+
cris
cris ⊂ Bcris . (As the
cris
s∈Z
canonical element t ∈ Acris exists locally, these definitions do make sense.)

***
Lemma 2.5. Let X be a locally noetherian adic space over (k, Ok ). Let U ∈ Xproét
b = Spa(R, R+ ). Let F ∈ {A0 , Acris }.
be an affinoid perfectoid above Xk with U
cris
≈
Then for any r ≥ Z, we have a natural almost isomorphism Filr F(R, R+ )a →
r
r
a
i
a
Fil F(U ) , and have H (U, Fil F) = 0 for any i > 0.

***
Corollary 2.6. Keep the notation of Lemma 2.5 .
(1) The morphism multiplication by t on Acris is almost injective. In particular,
t ∈ B+
cris |Xk is not a zero-divisor.
(2) Let F ∈ {B+
cris , Bcris }. Then for any r ∈ Z, there is a natural isomorphism
∼
Filr F(R, R+ ) → Filr F(U ), and H i (U, Filr F) = 0 for i ≥ 1.

***
Definition 2.7. Consider the following sheaves on Xproét .
(1) Let OAcris be the p-adic completion of the PD-envelope OA0cris of OAinf
with respect to the ideal sheaf ker(θX ) ⊂ OAinf , OB+
cris := OAcris [1/p], and
OBcris := OB+
cris [1/t] with t = log([]) defined in (??).
(2) For r ∈ Z≥0 , define Filr OA0cris ⊂ OA0cris to be the r-th PD-ideal ker(θX )[r] ,
and Filr OAcris the image of the canonical map
lim Filr OA0cris /pn −→ lim OA0cris /pn = OAcris .
←−
←−
Also set Fil−r OAcris = OAcris for r > 0.
(3) For r ∈ Z, set
X
r
t−s Filr+s OB+
Filr OB+
Filr OBcris :=
cris := Fil OAcris [1/p] and
cris .
s∈Z

***
k, Ob ), one can also define Filr OBcris
Remark 2.8. As tp = p!·t[p] in Acris := Acris (b
k
P
as s∈N t−s Filr+s OAcris . A similar observation holds equally for Filr Bcris .

***
Remark 2.9.
(1) As X is flat over Ok , the structure sheaf OXét has no ptorsions. It follows that OAinf , OA0cris and OAcris have no p-torsions. So
OAcris ⊂ OB+
cris .
(2) The morphism θX of (??) extends to a surjective morphism from OA0cris
d
d
+
+
with kernel Fil1 OA0 , hence also a morphism from OA
to O
.
to O
X

cris

cris

X

Let us denote these two morphisms again by θX . As coker(Fil1 OA0cris ,→
d
+
OA0cris ) ' O
X is p-adically complete and has no p-torsions, using the snake
lemma and passing to limits one can deduce the following short exact
sequence
θX d
+
0 −→ lim(Fil1 OA0cris /pn ) −→ OAcris −→
OX
−→ 0.
←
−
n
In particular, Fil1 OAcris = ker(θX ).

***
Definition 2.10. Consider the following sheaves on Xproét .
(1) Let Acris {hu1 , . . . , ud i} be the p-adic completion of the sheaf of
Set
PD polynomial rings A0cris hu1 , . . . , ud i ⊂ Binf [u1 , . . . , ud ].
+
Bcris {hu1 , . . . , ud i} := Acris {hu1 , . . . , ud i}[1/p] and Bcris {hu1 , . . . , ud i} :=
Acris {hu1 , . . . , ud i}[1/t].
(2) For r ∈ Z, let Filr A0cris hu1 , . . . , ud i ⊂ A0cris hu1 , . . . , ud i be the ideal sheaf
given by
X
[i ]
[i ]
Filr (A0cris hu1 , . . . , ud i) :=
Filr−(i1 +...+id ) A0cris · u1 1 · · · ud d ,
i1 ,...,id ≥0
r

and Fil (Acris {hu1 , . . . , ud i}) ⊂ Acris {hu1 , . . . , ud i} the image of the
morphism

lim Filr A0cris {hu1 , . . . , ud i}/pn −→ Acris {hu1 , . . . , ud i}.
←
−
n
The family {Filr (Acris {hu1 , . . . , ud i}) : r ∈ Z} gives a descending filtration
of Acris {hu1 , . . . , ud i}. Inverting p, we obtain Filr (B+
cris {hu1 , . . . , ud i}). Set
finally
X
Filr (Bcris {hu1 , . . . , ud i}) :=
t−s Filr+s (B+
cris {hu1 , . . . , ud i}).
s∈Z

***
Lemma 2.11. Let V ∈ Xproét be an affinoid perfectoid lying above Xk with Vb =
Spa(R, R+ ). Then the following natural map is an almost isomorhpism
≈

Acris (R, R+ ){hu1 , . . . , ud i} −→ (Acris {hu1 , . . . , ud i})(V ).
Under this identification, Filr (Acris {hu1 , . . . , ud i})(V )a consists of series
X
[i ]
[i ]
ai1 ,...,id u1 1 · · · ud d ∈ Acris (R, R+ ){hu1 , . . . , ud i}
i1 ,...,id ≥0

such that ai1 ,...,id ∈ Filr−(i1 +...+id ) Acris (R, R+ ) and ai1 ,...,id tends to 0 for the p-adic
topology when the sum i1 + . . . + id tends to infinity. Furthermore
H i (V, Filr (Acris {hu1 , . . . , ud i}))a = 0,

for i > 0.

***
Proposition 2.12. The morphism α of (??) is an almost isomorphism.
Furthermore, it respects the filtrations on both sides.

***
Lemma 2.13. Let k be an algebraic closure of k. Then Acris {hu1 , . . . , ud i}|Xe has a
k

ur+
natural OX
|Xe -algebra structure, sending Ti to ui +[Ti[ ], such that the composition
k

ur+
OX
|Xe
k

θ 0 |X
f

d
+
−→ Acris {hu1 , . . . , ud i}|Xe −→k O
e
X |X
k

d
+
+
0
is the map (??) composed with OX
→O
X . Here θ :
θ d
+
induced from the map Acris → OX by sending Ui ’s to

k

d
+
Acris {hu1 , . . . , ud i} → O
X is
0.

***
Corollary 2.14. Keep the notation above. There are natural filtered isomorphisms
∼

+
B+
e {hu1 , . . . , ud i} −→ OBcris |X
e,
cris |X

both sending ui to Ti ⊗ 1 − 1 ⊗ [Ti[ ].

and

∼

Bcris |Xe {hu1 , . . . , ud i} −→ OBcris |Xe

***
Corollary 2.15. Let X be a smooth formal scheme over Ok . Then the morphism
of multiplication by t on OAcris |Xk is almost injective. In particular t ∈ OB+
cris |Xk
is not a zero-divisor and OB+
⊂
OB
.
cris
cris

***
Corollary 2.16. [Crystalline Poincaré lemma] Let X be a smooth formal scheme
of dimension d over Ok . Then there is an exact sequence of pro-étale sheaves:
∇

∇

∇

1,ur
d,ur
+
+
+
ur
ur
0 → B+
cris → OBcris → OBcris ⊗OX ΩX/k → . . . → OBcris ⊗OX ΩX/k → 0,

which is strictly exact with respect to the filtration giving Ωi,ur
In
X/k degree i.
particular, the connection ∇ is integrable and satisfies Griffiths transversality with
1,ur
i
i−1
+
ur
respect to the filtration on OB+
OB+
cris , i.e. ∇(Fil OBcris ) ⊂ Fil
cris ⊗OX ΩX/k .

***
Lemma 2.17. Keep the notation above. For any F ∈ {OAcris , OB+
cris , OBcris } and
≈
any r ∈ Z, there exists a natural almost isomorphism Filr F(S, S + ) → Filr F(V ).
r
Moreover, H i (V, Fil F)a = 0 whenever i > 0.

***
Remark 2.18. In general X does not admit a lifting of Frobenius. But as X
is smooth over Ok , for each open subset U ⊂ X admitting an étale morphism
U → Spf(Ok {T1±1 , . . . , Td±1 }), a similar argument as above shows that there exists
a unique lifting of Frobenius on U mapping Ti to Tip .

***
Lemma 2.19. Assume as above that the Frobenius of X0 = X ⊗Ok κ lifts to a
morphism σ on X compatible with the Frobenius on Ok . The Frobenius ϕ on OB+
cris
1,ur
+
is horizontal with respect to the connection ∇ : OB+
cris → OBcris ⊗ ΩX/k .

***
Lemma 2.20. Assume there is an étale morphism X → Spf(Ok {T1±1 , . . . , Td±1 }).
Let σ1 , σ2 be two Frobenius liftings on X , and let ϕ1 and ϕ2 be the induced Frobenius
maps on OB+
cris , respectively. Then for any quasi-compact U ∈ Xproét , we have the
following relation on OB+
cris (U ):
(2.3.1)

ϕ2 =

X
(n1 ,...,nd

(
)∈Nd

d
Y

(σ2 (Ti ) − σ1 (Ti ))[ni ] )(ϕ1 ◦ (

Nini ))

i=1

i=1

where the Ni ’s are the endomorphisms of

d
Y

OB+
cris

such that ∇ =

Pd

i=1

Ni ⊗ dTi .

***
Lemma 2.21. Let X be a smooth formal scheme over Ok .
(1) There are natural injective morphisms
+
B+
cris ,→ BdR ,

+
OB+
cris ,→ OBdR .

+
+
In the following, we will view B+
cris (resp. OBcris ) as a subring of BdR (resp.
+
of OBdR ).
(2) For any integer i ≥ 0, one has
i
+
+
Fili B+
cris = Fil OBdR ∩ Bcris

i
+
+
Fili OB+
cris = Fil OBdR ∩ OBcris .

i
+
In particular, the filtration {Fili B+
cris : i ∈ Z} (resp. {Fil OBcris : i ∈ Z})
+
+
on Bcris (resp. on OBcris ) is decreasing, separated and exhaustive.
(3) For i ≥ 0, the following canonical morphisms are isomorphisms:
∼

gri B+
→ gri B+
cris −
dR ,

∼

gri OB+
→ gri OB+
cris −
dR .

***
Corollary 2.22. Let X be a smooth formal scheme over Ok .
(1) There are two natural injections
OBcris ,→ OBdR .
T
(2) For any i ∈ Z, we have Fil Bcris = Bcris Fili BdR and Fili OBcris =
T i
OBcris Fil OBdR .
∼
∼
Furthermore, gri Bcris −
→ gri BdR and gri OBcris −
→ gri OBdR .
i
i
In particular, the filtration {Fil Bcris }i∈Z (resp. {Fil OBcris }i∈Z ) is
decreasing, separated and exhaustive.
Bcris ,→ BdR ,

i

***
Corollary 2.23. Let X be a smooth adic space over Spa(k, Ok ) which admits a
smooth formal model X over Ok (so that we can define OBcris ), then
w∗ OBcris ' OXét [1/p].

***
Remark 3.1. Write X0 the closed fiber of a smooth formal scheme X over Ok .
Then the category of crystals on (X0 /Ok )cris is equivalent to that of coherent OX modules M equipped with an integrable and quasi-nilpotent connection ∇ : M →
M ⊗OX Ω1X /Ok . Here the connection ∇ is said to be quasi-nilpotent if its
reduction modulo p is quasi-nilpotent in the sense of [BO, Definition 4.10]. The
correspondence between these two categories is given as follows: for E a crystal
on X0 /Ok , as X0 ,→ X is a p-adic PD-thickening, we can evalue E at it: set
EX := limn EX ⊗Ok /pn . Let ∆1 ,→ X × X be the PD-thickening of order 1 of
←−
the diagonal embedding X ,→ X × X . The two projections pi : ∆1 → X are
∼
PD-morphisms. So we have two isomorphisms p∗i EX −
→ E∆1 := limn E∆1 ⊗Ok /pn ,
←−
∼
∗
∗
whence a natural isomorphism p2 EX −
→ p1 EX . The latter isomorphism gives a
connection ∇ : EX → EX ⊗ Ω1X /Ok on EX . Together with a limit argument, that ∇
is integrable and quasi-nilpotent is due to [BO, Theorem 6.6].

***
Remark 3.2. Let X rig be a classical rigid analytic space over k, with associated
adic space X. Using [Sch13, Theorem 9.1], one sees that the notion of coherent
OX rig -modules on X rig coincides with that of coherent OXan -modules on Xan , where
Xan denote the site of open subsets of the adic space X.

***
Remark 3.3. Let X be a smooth formal scheme over Ok , with X its generic fiber
in the sense of Huber. Let Coh(OX [1/p]) denote the category of coherent OX [1/p]modules on X , or equivalently, the full subcategory of the category of OX [1/p]modules on X consisting of OX [1/p]-modules which are isomorphic to M+ [1/p] for
some coherent sheaf M+ on X . Denote also Coh(OXan ) the category of coherent
OXan -modules on X. The analytification functor gives a fully faithful embedding
Coh(OX [1/p]) ,→ Coh(OXan ). Moreover, the essential image is stable under taking
direct summands (as OXan -modules). Indeed, let E be a coherent OXan -module
admitting a coherent formal model E + over X , and E 0 ⊂ E a direct summand. Let
f : E → E be the idempotent corresponding to E 0 : write E = E 0 ⊕ E 00 , then f is the
composite of the projection from E to E 0 followed by the inclusion E 0 ⊂ E. Therefore,
there exists some n  0 such that pn f comes from a morphism f + : E + → E + of
OX -modules. Then the image of f + gives a formal model of E 0 over X , as desired.

***
Remark 3.4. In general, X0 does not necessarily admit a global formal embedding.
In this case, the category of convergent isocrystals on X0 /Ok can still be defined
by a gluing argument (see [Ber96, 2.3.2(iii)]). But the definition recalled above will
be enough for our purpose.

***
Remark 3.5. The category F -Isoc† (X0 /Ok ) has as a full subcategory the isogeny
category F -Cris(X0 /Ok )⊗Q of F -crystals E on (X0 /Ok )cris . To explain this, assume
for simplicity that X0 is the closed fiber of a smooth formal scheme X over Ok . So
]X0 [X = X, the generic fiber of X . Let (M, ∇) be the OX -module with integrable
and quasi-nilpotent connection associated to the F -crystal E (Remark 3.1 ). Let
Ean := Mν denote the generic fiber of M, which is a coherent (hence locally
free by [Ber96, 2.3.2 (ii)]) OXan -module equipped with an integrable connection
∇an : Ean −→ Ean ⊗ Ω1Xan /k , which is nothing but the generic fiber of ∇. Because of
the F -crystal structure on E, the connection ∇an is necessarily convergent ([Ber96,
2.4.1]). In this way we obtain an F -isocrystal Ean on X0 /Ok , whence a natural
functor
(3.1.1)

(−)an : F -Cris(X0 /Ok ) ⊗ Q −→ F -Isoc† (X0 /Ok ),

E 7→ Ean .

By [Ber96, 2.4.2], this analytification functor is fully faithful, and for E a convergent
F -isocrystal on X0 /Ok , there exists an integer n ≥ 0 and an F -crystal E such that
∼
∼
E−
→ Ean (n), where for F = (F, ∇, ϕ : F ∗ F −
→ F) an F -isocrystal on X0 /Ok , F(n)
∼
→ F) ([Ber96, 2.3.8 (i)]).
denotes the Tate twist of F, given by (F, ∇, pϕn : F ∗ F −

***
Lemma 3.6. Assume that the Frobenius F : X0 → X0 can be lifted to a
morphism σ : X → X compatible with the Frobenius on Ok . Still denote by σ
the endomorphism on X induced by σ. Then there is an equivalence of categories
between
(1) the category F -Isoc† (X0 /Ok ) of convergent F -isocrystals on X0 /Ok ; and
(2) the category Modσ,∇
OX of OXan -vector bundles E equipped with an integrable
and convergent connection ∇ and an OXan -linear horizontal isomorphism
ϕ : σ ∗ E → E.

***
Lemma 3.7. [see also [Bri] 7.2.3]
Assume X = Spf(A) is affine and that there exists an étale morphism X → T d
σ1 ,∇
as above. For (E, ∇, ϕ1 ) ∈ ModO
, with (E, ∇, ϕ2 ) the corresponding object of
X
σ2 ,∇
ModOX under the functor Fσ1 ,σ2 . Then on E(X) we have
!
!!
d
d
Y
Y
X
(σ2 (Ti ) − σ1 (Ti ))[ni ]
ϕ1 ◦
Nini
.
(3.1.3)
ϕ2 =
(n1 ,...,nd )∈Nd

i=1

i=1
∇=0

Furthermore, ϕ1 and ϕ2 coincide on E(X)

.

***
Remark 3.8. Let E be a convergent isocrystal on X0 /Ok . To defineSa compatible
system of Frobenii on E, we only need to give, for a cover X = i Ui of X by
open subsets Ui equipped with a lifting of Frobenius σi , a family of Frobenius
∼
morphisms ϕi : σi∗ E|Ui → E|Ui such that ϕi |Ui T Uj corresponds to ϕj |Ui T Uj under
σ ,∇
the functor Fσi ,σj : ModσOiU,∇T U → ModOjU T U (Here U• := U•,k ). Indeed, for U
i
j
i
j
any open subset equipped with a lifting of Frobenius σU , one can first use the functor
Fσi ,σU of (??) applied to (E|Ui , ∇|Ui , ϕi )|Ui T U to obtain a horizontal isomorphism
ϕU ,i : (σU∗ (E|U ))|Ui T U → E|Ui T U . From the compatibility of the ϕi ’s, we deduce
ϕU ,i |U T Ui T Uj = ϕU ,j |U T Ui T Uj . Consequently we can glue the ϕU ,i ’s (i ∈ I) to
get a horizontal isomorphism ϕU : σU∗ (E|U ) → E|U . One checks that these ϕU ’s give
the desired compatible system of Frobenii on E.

***
Corollary 3.9. The natural functor F -Isoc† (X0 /Ok ) → Modσ,∇
OX is an equivalence
of categories.

***
Remark 3.10. (1) Let M be a crystal on X0 /Ok , viewed as a coherent OX -module
ur+
admitting an integrable connection. Then w−1 M is a coherent OX
-module with
1,ur+
−1
−1
an integrable connection w M → w M ⊗Our+ ΩX/k . If furthermore M is an
X
F -crystal, then w−1 M inherits a system of Frobenii: for any open subset U ⊂ X
equipped with a lifting of Frobenius σU , there is naturally an endomorphism of
ur+
w−1 M|U which is semilinear with respect to the Frobenius w−1 σU on OX
|U (here
U := Uk ). Indeed, the Frobenius structure on M gives a horizontal OU -linear
morphism σU∗ M|U → M|U , or equivalently, a σU -semilinear morphism ϕU : M|U →
M|U (as σU is the identity map on the underlying topological space). So we obtain
a natural endomorphism w−1 ϕU of w−1 M|U , which is w−1 σU -semilinear.
(2) Let E be a convergent F -isocrystal on X0 /Ok . By Remark 3.5 , there exists
an F -crystal M on X0 /Ok and n ∈ N such that E ' Man (n). By (1), w−1 M is
ur+
a coherent OX
-module equipped with an integrable connection and a compatible
ur
system of Frobenii ϕ. Inverting p, we get an OX
-module w−1 M[1/p] equipped with
an integrable connection and a system of Frobenii ϕ/pn , which does not depend
on the choice of the formal model M or the integer n. For this reason, abusing
notation, let us denote w−1 M[1/p] by w−1 E, which is equipped with an integrable
connection and a system of Frobenii inherited from E. If furthermore E has a
descending filtration {Fili E} by locally direct summands, by Remark 3.3 , each
Fili E has a coherent formal model Ei+ on X . Then {w−1 Ei+ [1/p]} gives a descending
filtration (by locally direct summands) on w−1 E.

***
b p -sheaf L on Xproét is crystalline if there exists
Definition 3.11. We say a lisse Z
a filtered F -isocrystal E together with an isomorphism of OBcris -modules
(3.2.1)

ur OBcris ' L ⊗
w−1 E ⊗OX
bp OBcris
Z

which is compatible with connection, filtration and Frobenius. In this case, we say
b p -sheaf L and the filtered F -isocrystal E are associated.
that the lisse Z

***
Remark 3.12. The Frobenius compatibility of the isomorphism (3.2.1) means
the following. Take any open subset U ⊂ X equipped with a lifting of Frobenius
σ : U → U. By the discussion in §??, we know that OBcris |Uk is naturally endowed
with a Frobenius ϕ. Meanwhile, as E is an F -isocrystal, by Remark 3.10 w−1 E|Uk
is endowed with a w−1 σ-semilinear Frobenius, still denoted by ϕ. Now the required
Frobenius compatibility means that when restricted to any such Uk , we have ϕ⊗ϕ =
id ⊗ ϕ via the isomorphism (3.2.1).

***
b p -sheaf and i ∈ Z, set
Definition 3.13. For L a lisse Z
Dcris (L) := w∗ (L ⊗Zbp OBcris ),

and

Fili Dcris (L) := w∗ (L ⊗Zbp Fili OBcris ).

All of them are OX [1/p]-modules, and the Fili Dcris (L) give a separated exhaustive
decreasing filtration on Dcris (L) (as the same holds for the filtration on OBcris ; see
Corollary 2.22 ).

***
b p -sheaf on Xproét . Then L is crystalline if
Proposition 3.14. Let L be a lisse Z
and only if the following two conditions are verified:
(1) the OX [1/p]-modules Dcris (L) and Fili Dcris (L) (i ∈ Z) are all coherent.
ur OBcris → L ⊗
(2) the adjunction morphism w−1 Dcris (L) ⊗OX
bp OBcris is an
Z
isomorphism of OBcris -modules.

***
b p -sheaf on X. Then
Lemma 3.15. Keep the notation above. Let L be a lisse Z
there exist natural isomorphisms of R-modules
G U
∼
Dcris (L)(U) −→ VU (L) ⊗Zp OBcris (S, S + )
=: Dcris (VU (L))
and, for any r ∈ Z,
G U
∼
(Filr Dcris (L)) (U) −→ VU (L) ⊗Zp Filr OBcris (S, S + )
.
Moreover, the R-module Dcris (L)(U) is projective of rank at most that of VU (L)⊗Qp .

***
b p -sheaf on Xproét , which satisfies the condition
Corollary 3.16. Let L be a lisse Z
(1) of Proposition 3.14 . Let U = Spf(R+ ) be a small connected affine open subset
of X . Write R = R+ [1/p] and U = Uk . Then for any V ∈ Xproét /U , we have
∼

ur OBcris )(V ).
Dcris (L)(U) ⊗R OBcris (V ) → (w−1 Dcris (L) ⊗OX

***
b p -sheaf verifying the condition (1) of Proposition
Corollary 3.17. Let L be a lisse Z
3.14 . Then the condition (2) of Proposition 3.14 holds for L if and only if for any
small affine connected open subset U ⊂ X (with U := Uk ), the GU -representation
VU (L) ⊗Zp Qp is crystalline in the sense that the following natural morphism is an
isomorphism ([Bri, Chapitre 8])
∼

Dcris (VU (L)) ⊗R OBcris (S, S + ) −→ VU (L) ⊗Zp OBcris (S, S + ),
\
univ = Spa(S, S + ) are as in the paragraph before Lemma 3.15 .
where GU , U univ , U

***
b p -sheaf on X satisfying the two conditions of
Lemma 3.18. Let L be a lisse Z
Proposition 3.14 . Then (the analytification of ) Dcris (L) has a natural structure of
filtered convergent F -isocrystal on X0 /Ok .

***
Theorem 3.19. The functor Dcris above induces an equivalence of categories
∼

†
adm
Dcris : Liscris
.
b (X) −→ F F -Iso (X0 /Ok )
Q
p

A quasi-inverse of Dcris is given by
∇=0,ϕ=1
ur OBcris )
Vcris : E 7→ Fil0 (w−1 E ⊗OX

where ϕ denotes the compatible system of Frobenii on E as before.

***
Remark 3.20. Using [Bri, Theorem 8.5.2], one can show that the equivalence
above is an equivalence of tannakian category.

***
Remark 3.21. It is well known that the filtration on E(Bcris (S, S + )) does not
depend on the choice of α. More precisely, let α0 be a second morphism
R+ → Acris (S, S + ) of Ok -algebras whose composite with Acris (S, S + ) → S + is
the inclusion R+ ⊂ S + . Fix an étale morphism U → Spf(Ok {T1±1 , . . . , Td±1 }).
Denote β = (α, α0 ) : R+ ⊗Ok R+ → Acris (S, S + ) and by the same notation the
corresponding map on schemes, and write p1 , p2 : Spec R+ × Spec R+ → Spec R+
∼
the two projections. We have a canonical isomorphism (p2 ◦ β)∗ E −
→ (p1 ◦ β)∗ E, as
E is a crystal. In terms of the connection ∇ on E, this gives (cf. [Ber96, 2.2.4]) the
following Bcris (S, S + )-linear isomorphism
η : E(U) ⊗R,α Bcris (S, S + ) −→ E(U) ⊗R,α0 Bcris (S, S + )
P
sending e ⊗ 1 to n∈Nd N n (e) ⊗ (α(T ) − α0 (T ))[n] , with N the endomorphism of
E such that ∇ = N ⊗ dT . Here we use the multi-index to simplify the notations,
and note that α(Ti ) − α0 (Ti ) ∈ Fil1 Acris (S, S + ) hence the divided power (α(Ti ) −
α0 (Ti ))[ni ] is well-defined. Moreover, the series converge since the connection on
M is quasi-nilpotent. Now as the filtration on E satisfies Griffiths transversality,
the isomorphism η is compatible with the tensor product filtrations on both sides.
Since the inverse η −1 can be described by a similar formula (one just switches α
and α0 ), it is also compatible with filtrations on both sides. Hence the isomorphism
η is strictly compatible with the filtrations, and the filtration on E(Bcris (S, S + ))
does not depend on the choice of α.

***
Proposition 3.22. Keep the notation above. If E is associated to L in the sense
of Faltings then L is crystalline (not necessarily associated to E) and there is an
isomorphism Dcris (L) ' E compatible with filtration and Frobenius. Conversely,
if L is crystalline and if there is an isomorphism Dcris (L) ' E of OX an -modules
compatible with filtration and Frobenius, then L and E are associated in the sense
of Faltings.

***
b p -sheaf on X and E a filtered convergent F Proposition 3.23. Let L be a lisse Z
isocrystal on X0 /Ok . Assume that L and E are associated as defined in Definition
3.11 , then L is a de Rham in the sense of [Sch13, Definition 8.3] . More precisely,
if we view E as a filtered module with integrable connection on X (namely we forget
the Frobenius), there exists a natural filtered isomorphism that is compatible with
connections:
L ⊗Zbp OBdR −→ E ⊗OX OBdR

***
Lemma 3.24. Let X be smooth formal scheme over Ok . Then the natural
morphism below is an isomorphism in the filtered derived category:
b Ok Bcris −→ Rw∗ (OBcris ).
OX ⊗

b Ok Bcris := OX ⊗
b Ok Acris [1/t] with
Here OX ⊗
b Ok Acris := lim OX ⊗Ok Acris /pn ,
OX ⊗
←−
n∈N

b Ok Bcris is filtered by the subsheaves
and OX ⊗
b Ok Filr Bcris := lim t−n (OX ⊗
b Ok Filr+n Acris ),
O⊗
−→
n∈N

r ∈ Z.

***
Corollary 3.25. Let X be a smooth formal scheme over Ok . Let L be a crystalline
b p -sheaf associated with a filtered convergent F -isocrystal E. Then there exists
lisse Z
a natural quasi-isomorphism in the filtered derived category
∼
b k Bcris .
Rw∗ (L ⊗Zb Bcris ) −→ DR(E)⊗
p

If moreover X is endowed with a lifting of Frobenius σ, then the isomorphism above
is also compatible with the Frobenii deduced from σ on both sides.

***
Remark 3.26. Recall that Gk denotes the absolute Galois group of k. Each
element of Gk defines a morphism of Uk in the pro-étale site Xproét for any U ∈
Xproét with U := Uk . Therefore, the object Rw∗ (L ⊗ Bcris ) comes with a natural
Galois action of Gk . With this Galois action, one checks that the quasi-isomorphism
in Corollary 3.25 is also Galois equivariant.

***
Theorem 3.27. Assume further that the smooth formal scheme X is proper over
b p -sheaf
Ok . Let E be a filtered convergent F -isocrystal on X0 /Ok and L a lisse Z
on Xproét . Assume that E and L are associated. Then there is a natural filtered
isomorphism of Bcris -modules
(3.3.5)

∼

i
H i (Xk,proét , L ⊗Zbp Bcris ) −→ Hcris
(X0 /Ok , E) ⊗k Bcris

which is compatible with Frobenius and Galois action.

***
Lemma 4.1. Let (Fn )n∈N be a projective system of abelian sheaves on a site T ,
such that Rj lim Fn = 0 whenever j > 0. Then for any object Y ∈ T and any i ∈ Z,
←−
the following sequence is exact:
0 −→ R1 lim H i−1 (Y, Fn ) −→ H i (Y, lim Fn ) −→ lim H i (Y, Fn ) −→ 0.
←−
←−
←−

***
i
b p -sheaf on X
Lemma 4.2. Let L be a lisse Z
k,proét . Then for i ∈ Z, H (Xk,proét , L)
i
is a Zp -module of finite type, and H (Xk,proét , L) = 0 whenever i ∈
/ [0, 2 dim(X)].

***
b p -sheaf on Xproét .
Theorem 4.3. Let L be a lisse Z
+
isomorphism of Bcris -modules
(4.0.3)

∼

There is a canonical

+
−
→ H i (Xk,proét , L ⊗Zbp B+
H i (Xk,proét , L) ⊗Zp Bcris
cris )

compatible with Galois action, filtration and Frobenius.

***
b p -sheaf on X
Lemma 4.4. Let L be a lisse Z
k,proét . Then the following natural
morphism is an isomorphism:


≈
bX ,
H i (Xk,proét , L) ⊗Zp Cp −→ H i Xk,proét , L ⊗Zbp O
b
bX is the completed structural sheaf of X
where O
k,proét and Cp = k.

***
Theorem 4.5. Let X be a proper smooth formal scheme over Ok , with X (resp.
b p -sheaf on Xproét . Assume
X0 ) its generic (resp. closed) fiber. Let L be a lisse Z
that L is associated to a filtered F -isocrystal E on X0 /Ok . Then there exists a
canonical isomorphism of Bcris -modules
∼

i
H i (Xk,ét , L) ⊗Zp Bcris −
→ Hcris
(X0 /Ok , E) ⊗Ok Bcris

compatible with Galois action, filtration and Frobenius.

***
Proposition 5.1. (1) (Relative Poincaré lemma) The following sequence of proétale sheaves is exact and strict with respect to the filtration giving Ωi,ur
X/Y degree
i:
b
0 −→ B+
cris,X ⊗f −1 B+
k

cris,Y

∇X/Y

∇X/Y

1,ur
+
+
ur
fk−1 OB+
cris,Y → OBcris,X −→ OBcris,X ⊗OX ΩX/Y
∇X/Y

d,ur
ur
−→ · · · −→ OB+
cris,X ⊗OX ΩX/Y → 0.

Furthermore, the connection ∇X/Y is integrable and satisfies Griffiths transversality
1,ur
i−1
ur
with respect to the filtration, i.e. ∇X/Y (Fili OB+
OB+
cris,X ) ⊂ Fil
cris,X ⊗OX ΩX/Y .
(2) Suppose the Frobenius on X0 (resp. Y0 ) lifts to a Frobenius σX (resp. σY )
on the formal scheme X (resp. Y) and they commute with f . Then the induced
Frobenius ϕX on OB+
cris,X is horizontal with respect to ∇X/Y .

***
Proposition 5.2. Let f : X → Y be a proper smooth morphism between two smooth
b p -sheaf on Xproét . Suppose that Ri fk∗ L
formal schemes over Ok . Let L be a lisse Z
b p -sheaf on Yproét for all i ≥ 0. Then the following canonical morphism
is a lisse Z
is an isomorphism:
(5.0.1)

∼

(Ri fk∗ L) ⊗Zbp B+
→ Ri fk∗ (L ⊗Zbp B+
cris,Y −
cris,X )

which is compatible with filtration and Frobenius.

***
Lemma 5.3. Let V ∈ Yproét be an affinoid perfectoid which is pro-étale over Yek ,
with Vb = Spa(R, R+ ). Let wV be the composite of natural morphisms of topoi
w

∼
∼
∼
wV : Xproét
/XV −→ Xproét
−→ Xét
.

Then
(1) for any j > 0 and r ∈ Z, Rj wV ∗ OBcris = Rj wV ∗ (Filr OBcris ) = 0; and
(2) the natural morphisms
b A OBcris,Y (V ) −→ wV ∗ (OBcris,X )
OX ⊗
and
b A Filr OBcris,Y (V ) → wV ∗ (Filr OBcris,X ) for all r ∈ Z
OX ⊗

b A OBcris,Y (V ) := OX ⊗
b A OAcris,Y (V ) [1/t] with
are isomorphisms. Here OX ⊗
b A OAcris,Y (V ) := lim (OX ⊗A OAcris,Y (V )/pn ) ,
OX ⊗
←−
and

b A Filr OBcris,Y (V ) := lim t−n OX ⊗
b A Filr+n OAcris,Y (V ) .
OX ⊗
−→
n∈N

b A OBcris,Y (V ) using {OX ⊗
b A Filr OBcris,Y (V )}r∈Z ,
In particular, if we filter OX ⊗
the natural morphism
b A OBcris,Y (V ) −→ RwV ∗ (OBcris,X )
OX ⊗
is an isomorphism in the filtered derived category.

***
Lemma 5.4. Let E be a filtered convergent F -isocrystal on X , Y = Spf A, and V ∈
Yproét an affinoid perfectoid which is pro-étale over Yek . The canonical morphism
b A OBcris,Y (V ))
RΓ(X , DRX/Y (E)) ⊗A OBcris,Y (V ) −→ RΓ(X , DRX/Y (E)⊗
is an isomorphism in the filtered derived category.

***
Proposition 5.5. Let X → Y be a proper smooth morphism between two smooth
formal schemes over Ok . Let E be a filtered convergent F -isocrystal on X0 /Ok and
b p -sheaf on Xproét . Assume that E and L are associated. Then there is a
L a lisse Z
natural filtered isomorphism of OBcris,Y -modules
(5.0.13)

∼
−1
b k−1 OBcris,Y ) −→
(Ri fcris∗ (E)) ⊗ OBcris,Y
Ri fk∗ (L ⊗Zbp Bcris,X ⊗f
wY

which is compatible with Frobenius and connection.

***
b p -sheaf on X associated to a filtered
Theorem 5.6. Let L be a crystalline lisse Z
b p -sheaf
F -isocrystal E on X0 /Ok . Assume that, for any i ∈ Z, Ri fk∗ L is a lisse Z
on Y . Then Ri fk∗ L is crystalline and is associated to the filtered convergent F isocrystal Ri fcris∗ E.

***
Lemma 6.1. For n ∈ Z≥1 , there are natural isomorphisms
∼

[+
+
)/pn −→ Acris (S∞ , S∞
)/pn
Acris (R, R+ )/pn ⊗W (R[+ )/pn W (S∞

and

∼
+
+
Acris (S∞ , S∞
)/pn ⊗ OAcris (R, R+ )/pn hu1 , . . . , ud i −→ OAcris (S∞ , S∞
)/pn ,
sending ui to Ti − [Ti[ ]. Here the tensor product in the last isomorphism above is
taken over Acris (R, R+ )/pn .
Moreover, the natural morphisms
+
Acris (R, R+ )/pn → Acris (S∞ , S∞
)/pn ,

are both injective.

+
OAcris (R, R+ )/pn → OAcris (S∞ , S∞
)/pn

***
+
Proposition 6.2. Acris (S∞ , S∞
)/pn is free over Acris (R, R+ )/pn with a basis give
[ a
d
by {[T ] |a ∈ Z[1/p] }.

***
Lemma 6.3. [[AB] Lemme 11] Let 1 ≤ i ≤ d be an integer. Then one has
n
n
+
γi ([Ti[ ]p ) = [Ti[ ]p in OAcris (S∞ , S∞
)/pn .

***
Proposition 6.4. [[AB] Proposition 16]
H q (Γ, Xn hu1 , . . . , ud i) is killed by (1 − []1/p )2 .

For

any

integer

q

≥

0,

***
Lemma 6.5. [[AB] Proposition 20] The cokernel of (??), and hence H q (Γ, An hui)
for any q > 0, are killed by 1 − [].

***
Lemma 6.6. [[AB] Lemme 29] The cokernel of the last map is killed by 1 − [].

***
Proposition 6.7. For any d > 0, n > 0 and q > 0, H q (Γ, An hu1 , . . . , ud i) is killed
by (1 − [])2d−1 . Moreover, the natural morphism
(6.1.3)

C ⊗A OAcris (R, R+ )/pn −→ H 0 (Γ, An hu1 , . . . , ud i),

is injective with cokernel killed by (1 − [])2d−1 .

Ti 7→ ui + [Ti[ ]

***
Remark 6.8. With more efforts, one may prove that H q (Γ, An hu1 , . . . , ud i) is
killed by (1 − [])d for q > 0 ([AB, Proposition 21]), and that the cokernel of the
morphism (6.1.3) is killed by (1 − [])2 ([AB, Proposition 30]).

***
+
Corollary 6.9. For any n ≥ 0 and any q > 0, H q (Γ, OAcris (S∞ , S∞
)/pn ) is killed
2d
by (1 − []) . Moreover, the natural morphism
+
b A OAcris (R, R+ )/pn −→ H 0 (Γ, OAcris (S∞ , S∞
C⊗
)/pn )

is injective, with cokernel killed by (1 − [])2d .

***
Lemma 6.10. Keep the notations above and assume that the morphism f : X → Y
+
e Se+ ) = Spa(Se∞ , Se∞
is étale; thus V = Spa(R, R+ ) and X ×Y V = Spa(S,
). The
natural morphism
+
b A OAcris (R, R+ ) −→ OAcris (Se∞ , Se∞
B⊗
)
is an isomorphism.

***
+
Proposition 6.11. (i) For any n ≥ 0 and q > 0, H q (Γ, OAcris (Se∞ , Se∞
)/pn ) is
2d
killed by (1 − []) , and the natural morphism
+
B ⊗A OAcris (R, R+ )/pn −→ H 0 (Γ, OAcris (Se∞ , Se∞
))/pn

is injective with cokernel killed by (1 − [])2d .
+
(ii) For any q > 0, H q (Γ, OAcris (S∞ , S∞
)) is killed by (1 − [])4d and the natural
morphism
+
b A OAcris (R, R+ ) → H 0 (Γ, OAcris (Se∞ , Se∞
B⊗
))
2d
is injective, with cokernel killed by (1 − []) .

***
+
Theorem 6.12. Keep the notations above. Then H q (Γ, OBcris (Se∞ , Se∞
)) = 0 for
q ≥ 1, and the natural morphism
+
b A OBcris (R, R+ ) −→ H 0 (Γ, OBcris (Se∞ , Se∞
B⊗
))

is an isomorphism.

***
Lemma 6.13. Let q ∈ N>0 , and n an integer ≥ 4d + r. The multiplication-by-tn
morphism of H q (Γ, Filr OAcris ) is trivial.

***
+
Lemma 6.14. [[AB] Lemme 33] For each q ∈ Z, H q (Γ, Filr OBcris (Se∞ , Se∞
)) is a
vector space over Qp .

***
+
Proposition 6.15. [[AB] Proposition 34] H q (Γ, Filr OBcris (Se∞ , Se∞
)) = 0 for any
q > 0.

***
Lemma 6.16. [[AB] Lemme 35, Lemme 36] For each q ∈ N, the cokernel of the
map
(6.2.1)
is of p-torsion.

H q (Γ, Filr OAcris ) → H q (Γ, grr OAcris )

***
˜ (O [ ) such that η = (p −
Lemma 6.17. [[AB] Lemme 37] There exists λ ∈ ξW
b
k
1)!ξ˜[p] + λ. In particular, η ∈ ker(θ : Acris → Ob ). Furthermore, γ ν (η) ∈ p−r ηAcris

for any integers 0 ≤ ν ≤ r.

k

***
Lemma 6.18. [[AB] page 1011] There exists isomorphism
(Se[+ /ξ˜p )[ηm , wj , Zj,m , ui , Ti,m ]1≤i,j≤d;m∈N
OAcris /p ' ∞
p
p
p
, wjp , Zj,m
, upi , Ti,m
)
(ηm
where ηm denotes the image of γ m (η) in OAcris /p. We have a similar assertion for
OAcris (R, R+ )/p.

***
Lemma
6.19. [[AB] Lemme 38] For any r ∈ N, we have (pr OAcris )
Pr
r ν
ν=0 p γ (η)OAcris .

T

ηOAcris =

***
Lemma 6.20. [[AB] Lemme 39] Inside OAcris , we have
\
b A OAcris (R, R+ )) ηOAcris = η(B ⊗
b A OAcris (R, R+ )).
(B ⊗

***
Corollary 6.21. [[AB] Corollaire 40] Inside OAcris , we have
\
b A OAcris (R, R+ )) ([] − 1)p−1 OAcris = ([] − 1)p−1 (B ⊗
b A OAcris (R, R+ )).
(B ⊗

***
Proposition 6.22. [[AB] Proposition 41] For each r ∈ N, the natural injection
b A Filr OAcris (R, R+ ) −→ H 0 (Γ, Filr OAcris )
ιr : B ⊗
is an isomorphism.

***
Corollary 6.23. [[AB] Corollaire 42] The natural morphism
b A Filr OBcris (R, R+ ) −→ H 0 (Γ, Filr OBcris )
B⊗
is an isomorphism, where
b A Filr OBcris (R, R+ ) := lim B ⊗
b A Filr+n OAcris (R, R+ )
B⊗
−→
n≥0

with transition maps given by multiplication by t.

