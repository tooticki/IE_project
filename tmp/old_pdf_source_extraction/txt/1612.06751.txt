***
The Lyons-Peres Conjecture. [ [19, Conjecture 4.6]] For PK -almost every X ∈ Conf(E), we have
spanL

2 (E,µ)

{Kx ; x ∈ X} = H.

(1.2)

***
Theorem 1.1. [Lyons-Peres conjecture] Let K be a locally trace-class orthogonal projection onto a subspace H of
L2 (E, µ). Then for PK -almost every X ∈ Conf(E), the functions Kx defined by (??) satisfy
spanL

2 (E,µ)

{Kx ; x ∈ X} = H.

***
Remark 1.2. We mention that our assumption on σ -compactness of E is not essential. In fact, all our results are
valid by replacing everywhere “relatively compact” by “with K(x, x)dµ(x)-finite measure”. Therefore, Lyons-Peres
conjecture holds in full generality.

***
Corollary 1.3. For PK -almost every X ∈ Conf(E), if h ∈ H satisfies hX = 0, then h = 0.

***
Theorem 1.4. Let B1 ⊂ · · · ⊂ Bn ⊂ · · · ⊂ E be an increasing exhausting sequence of bounded Borel subsets of E.
T
The σ -algebra n∈N F(E \ Bn ) is trivial with respect to PK .

***
Corollary 1.5. The point process PK has trivial tail σ -algebra.

***
Definition 1.6. For any bounded Borel subset B ⊂ E, we define canonical conditional kernels K [X, B] with respect
to the conditioning on the configuration in B as follows:
• For p ∈ E0 , define a kernel K p , for (x, y) ∈ E0 × E0 , by the formula

K(x, p)K(p, y)

if K(p, p) > 0
K(x, y) −
p
.
K (x, y) :=
K(p, p)

0
if K(p, p) = 0
• For an n-tuple (p1 , · · · , pn ) ∈ E0n , define a kernel K p1 ,··· ,pn = (· · · (K p1 ) p2 · · · ) pn as follows (cf. ShiraiTakahashi [29, Corollary 6.6]). Given x, y ∈ E0 , write p0 = x, q0 = y, qi = pi for 1 ≤ i ≤ n, and set

 det[K(pi , q j )]0≤i, j≤n
if det[K(pi , p j )]1≤i, j≤n > 0
p1 ,··· ,pn
K
(x, y) :=
(1.5)
det[K(pi , p j )]1≤i, j≤n

0
if det[K(pi , p j )]1≤i, j≤n = 0
• For a bounded Borel subset B ⊂ E and X ∈ Conf(E) such that X ∩ B = {p1 , . . . , pl } ⊂ E0 , define

χE\B K p1 ,...,pl (1 − χB K p1 ,...,pl )−1 χE\B if 1 − χB K p1 ,...,pl is invertible
[X, B]
.
K
=
0
if 1 − χB K p1 ,...,pl is not invertible

(1.6)

***
Remark. We will see in Proposition 2.5 below that K [X, B] is the correlation kernel for the conditional measure of
PK , the condition being that the configuration on B coincides with X ∩ B. In particular, for PK -almost every X, we
have X ∩ B = {p1 , · · · , pl } ⊂ E0 and 1 − χB K p1 ,...,pl is invertible. The second case K [X,B] = 0 has probability zero.
Note that the range of K [X, B] is contained in L2 (E \ B, µ) and we have
K [X, B] = χE\B K [X, B] χE\B .

***
Lemma 1.7. Let W ⊂ E be a Borel subset, let B1 ⊂ · · · ⊂ Bn ⊂ · · · ⊂ W be an increasing exhausting sequence
of bounded Borel subsets of W . For PK -almost every X ∈ Conf(E) there exists a positive self-adjoint contraction
K [X,W ] ∈ L1,loc (L2 (E \W, µ)) such that
n→∞

χE\W K [X, Bn ] χE\W −−−−−−−−−−−−→ K [X,W ]
in L1,loc (L2 (E \W, µ))

and
PK (·|X,W ) = PK [X,W ] .

***
Remark. For fixed W , the kernel-valued function X 7→ K [X,W ] almost surely does not depend on the choice of the
approximating sequence B1 ⊂ · · · ⊂ Bn ⊂ · · · ⊂ W .

***
Lemma 1.8. [First local property of conditional kernels] Let B ⊂ E be a bounded Borel subset and let Q be an
orthogonal projection, acting in L2 (E, µ), such that Ran(Q) ⊂ L2 (E \ B, µ) and the operator QKQ is locally trace
class. For PK -almost every X ∈ Conf(E), we have

[X, B]
(Q + χB )K(Q + χB )
= (Q + χB )K [X, B] (Q + χB ) = QK [X, B] Q.

(1.8)

***
Remark. The formula (1.8) is a strengthening, on the level of kernels, of the general property of point processes
that conditioning on the restriction to a subset commutes with the forgetting projection onto a larger subset;
see Proposition 2.4 below. The local property can be interpreted in terms of Neretin’s formalism in [21]: a
determinantal measure is viewed as a “determinantal state” on a specially constructed algebra, and in order
that conditional states themselves be determinantal the local property must take place. The local property can thus
be seen as the noncommutative analogue of the fact that the operation of conditioning commutes with the operation
of restriction of a configuration onto a subset.

***
Lemma 1.9. [Second local property of conditional kernels] Let A, B be two disjoint bounded Borel subsets of E.
For PK -almost every X ∈ Conf(E), we have
(K [X, A] )[X, B] = (K [X, B] )[X, A] = K [X, A∪B] .

***
Lemma 1.10. Let W ⊂ E be a Borel subset, let B1 ⊂ · · · ⊂ Bn ⊂ · · · ⊂ W be an increasing exhausting sequence of
bounded Borel subsets of W . The sequence of random variables


χE\W K [X, Bn ] χE\W
n∈N

is an (F(Bn ))n∈N -adapted operator-valued martingale defined on the probability space (Conf(E), F(E), PK ).

***
Remark. The proof of Lemma 1.10 below in fact yields a stronger statement: the sequence of exterior power
operators

∧m 
χE\W K [X, Bn ] χE\W
n∈N

is an (F(Bn ))n∈N -adapted operator-valued martingale,
defined on the probability space (Conf(E), F(E), PK ) and
∧m
.
almost surely convergent to χE\W K [X,W ] χE\W

***
Proposition 2.1. [[24, p. 278]] A function F : Ω → B is Bochner measurable with respect to F if and only if
p
for any ξ ∈ D, the scalar function ω → ξ (F(ω)) is F -measurable. A sequence (Rn )∞
n=1 in L (Ω, F , P; B) is
∞
∞
an (Fn )n=1 -adapted martingale if and only if for any ξ ∈ D, the sequence (ξ (Rn ))n=1 is an (Fn )∞
n=1 -adapted
martingale.

***
Definition 2.2. A Banach space B is said to have the Radon-Nikodym property if for any probability space
(Ω, F , P) and any B-valued measure m on (Ω, F ), with m having finite total variation and being absolutely
continuous with respect to P, there exists a Bochner integrable function Fm ∈ L1 (Ω, F , P; B) such that
Z

m(A) =

Fm dP
A

for any A ∈ F .

***
Proposition 2.3. The space L1 (L2 (E, µ)) has the Radon-Nikodym property.

***
Proposition 2.4. Let W1 ,W2 be two disjoint Borel subsets of E. For P-almost every X ∈ Conf(E), we have
(πW1 ∪W2 )∗ [P](·|X,W1 ) = (πW1 ∪W2 )∗ [P(·|X,W1 )].

(2.1)

***
Proposition 2.5. PK (·|X, B) is a determinantal point process on Bc for PK -almost every X ∈ Conf(E), induced by
a correlation kernel K [X, B] defined in (1.6).

***
Proposition 2.6. If K is the orthogonal projection onto a closed subspace H ⊂ L2 (E, µ), then the kernel K p1 ,··· ,pn
corresponds to the orthogonal projection from L2 (E, µ) onto the subspace
H(p1 , · · · , pn ) := {h ∈ H : h(p1 ) = · · · = h(pn ) = 0}.
Moreover, for a bounded Borel subset B ⊂ E, the operator K [X, B] is the orthogonal projection onto the closure of
the subspace
χE\B H(X ∩ B) = {χE\B h : h ∈ H(X ∩ B)}.

***
Lemma 3.1. Let R be the operator introduced in (??). For any p ∈ B ∩ E0 , we have R p = (Q + χB )K p (Q + χB ).
More generally, for (p1 , · · · , pn ) ∈ (B ∩ E0 )n , we have
R p1 ,··· ,pn = (Q + χB )K p1 ,··· ,pn (Q + χB ).
In particular,
RX∩B = (Q + χB )K X∩B (Q + χB ),

for PK -almost every X ∈ Conf(E).

***
Lemma 3.2. Let B be a bounded Borel subset of E such that PK (#B = 0) > 0. Let R be the operator introduced in
(??). Then

χE\B R(1 − χB R)−1 χE\B = Q χE\B K(1 − χB K)−1 χE\B Q.
(3.3)

***
Proposition 4.1. For any bounded Borel subset B ⊂ E, we have
EPK (K [X, B] ) =

Z
Conf(E)

K [X, B] PK (dX) = χE\B KχE\B .

(4.1)

***
Remark. Extending the argument of Benjamini, Lyons, Peres and Schramm [1] for the case of spanning trees,
Lyons [18, Lemma 7.17] proved (4.1) when E is discrete and K is an orthogonal projection on `2 (E). Our proof,
based on the local property, is quite different and works both in the continuous and the discrete setting.

***
Proposition 5.1. Let W ⊂ E be a Borel subset, and let B1 ⊂ B2 ⊂ · · · Bn ⊂
 · · · ⊂ W be an increasing exhausting
[X,
B
]
n
sequence of bounded Borel subsets of W . The sequence χE\W K
χE\W n∈N converges PK -almost surely in the
space of locally trace class operators.

***
Proposition 5.2. Let W ⊂ E be a Borel subset, and let B1 ⊂ B2 ⊂ · · · Bn ⊂ · · · ⊂ W be an increasing exhausting
sequence of bounded Borel subsets of W . Fix any positive function ψ : E \ W → (0, 1] such that ψ 1/2 Kψ 1/2 is of
trace class and for any bounded subset B ⊂ E, we have infx∈B ψ(x) > 0. Then

ψ 1/2 K [X, Bn ] ψ 1/2 n∈N
(5.6)
is an L1 (L2 (E \ W, µ))-valued martingale which is bounded in L2 (Conf(E), P; L1 (L2 (E \ W, µ))). In particular,
the sequence converges in L1 (Conf(E), P; L1 (L2 (E \W, µ))).

***
Remark. Let B(W ) be the directed set of bounded measurable subsets of W , ordered by set-inclusion. Then the
set-indexed family χE\W K [X, B] χE\W B∈B(W ) is a set-indexed martingale adapted to the filtration (F(B))B∈B(W ) .
By virtue of Proposition 5.2, for any positive function ψ : E \W → (0, 1] such that ψ 1/2 Kψ 1/2 is of trace class and
for any bounded subset B ⊂ E, we have infx∈B ψ(x) > 0, the set-indexed martingale


ψ 1/2 K [X, B] ψ 1/2
B∈B(W )

converges in L1 (Conf(E), PK ; L1 (L2 (E \W, µ))).

***
Lemma 6.1. For PK -almost every X ∈ Conf(E), we have K [X, E\B] (χB h) = χB h for any h ∈ L(X ∩ (E \ B)).

***
Lemma 6.2. Let P be a point process on E. Then for any bounded Borel subset B ⊂ E, we have
P(#B = #(X ∩ B)|X, Bc ) > 0

for P-almost every X ∈ Conf(E).

(6.3)

***
Definition 7.1. Fix any increasing exhausting sequence D1 ⊂ · · · ⊂ Dn ⊂ · · · ⊂ E of bounded Borel subsets fo E.
For any Borel subset W ⊂ E, set
K [X,W ] := lim χE\W K [X,W ∩Dn ] χE\W .
n→∞

***
Proposition 7.2. Fix a bounded Borel subset B ⊂ E and let E \B ⊃ W1 ⊃ · · · ⊃ Wn ⊃ · · · be any decreasing sequence
of Borel subsets. Then χB K [X,Wn ] χB n∈N is an (F(Wn ))n∈N -adapted reverse martingale defined on the probability
space (Conf(E), F(E), PK ).

***
Lemma 7.3. For any bounded Borel subset B ⊂ E and φ ∈ L2 (Bc , µ), we have


VarPK hK [X, B] φ , φ i ≤ kφ k22 · kχB Kφ k22 ,
where k · k2 is the Hilbert norm on L2 (E, µ).

(7.4)

***

Proposition 7.4. Fix any ` ∈ N. Then χD` K [X, E\Dn+` ] χD` n∈N is an (F(E \ Dn+` ))n∈N -adapted reverse martingale
defined on the probability space (Conf(E), F(E), PK ), and we have
n→∞

χD` K [X, E\Dn+` ] χD` −−−−−−−−−−−−−−−−−−−−−−−−−−−−→ χD` KχD` .
PK -a.s. in L1

(L2 (E, µ)

and in L2 (PK ; L1 (L2 (E, µ)))

(7.6)

For any ` ∈ N, we have
∞
\
h
i

EPK PK (·|X, E \ D` )
F(E \ Dn+` ) = (πD` )∗ (PK ),

PK -almost surely

(7.7)

n=1

and, for any A ∈ F(D` ), we have


 



lim EPK EPK χA F(E \ Dn+` ) − PK (A) = 0.

n→∞

(7.8)

***
Proposition 7.5. [See [19, Section 3.3]] Let m be the counting measure on N. There exists a locally trace class
e ∈ L1,loc (L2 (E t N, µ ⊕ m)) such that K = χE Kχ
e E.
orthogonal projection operator K

***
Proposition 8.1. Let B ⊂ E be a bounded Borel subset. If P is a simple point process on E admitting correlation
measures of all orders, then P(·|X, B) = PX∩B Conf(Bc ) for P-almost every X ∈ Conf(E).

***
Remark. Kallenberg [17, Section 12.3] defined the compound Campbell measure of P on Conf f in (E) × Conf(E)
by
∞
1 #
(dp × dX1 ),
CP# (dp × dX1 ) := ∑ Cn,P
n!
n=0
where Conf f in (E) = t∞
n=0 Confn (E).

***

Proposition 8.2. The sequence (πW c )∗ [P(·|X,Wn )] n∈N is an (F(Wn ))n∈N -adapted martingale defined on the
probability space (Conf(E), F(E), P). Moreover, we have

h
i

c
(πW )∗ [P(·|X,Wn )] = EP P(·|X,W )F(Wn ) , for P-almost every X ∈ Conf(E).
(8.4)
In particular, by martingale convergence theorem, for all Borel subsets A ⊂ Conf(W c ) and any 1 ≤ p < ∞, we have


n→∞
(πW c )∗ [P(·|X,Wn )] (A) −−−−−−−−−p−−−−−−→ P(A|X,W ).
(8.5)
P-a.s. and in L (Conf(E), P)

Moreover, for P-almost every X ∈ Conf(E), we have
n→∞

(πW c )∗ [P(·|X,Wn )] −−−→ P(·|X,W ).
weakly

(8.6)

***
Remark. In general, the statement
(8.5) cannot be strengthened to the claim that for P-almost every X ∈ Conf(E),

n→∞
we have (πW c )∗ [P(·|X,Wn )] (A) −−−→ P(A|X,W ), for all Borel subsets A ⊂ Conf(W c ).

***
Lemma 8.3. We have
qn (x1 , · · · , xn ; dz) = E[Q(dz|x1 , · · · , xn ,t)|x1 , · · · , xn ].

***
Proposition 8.4. If gW ≡ 0 and EP (Sg2 ) < ∞, then the sequence


EP (Sg |X,Wn )

(8.7)

n∈N

is an (F(Wn ))n∈N -adapted
(Conf(E), F(E), P).

L2 (Conf(E), P)-bounded

martingale

defined

on

the

probability

space

