 4
 1
 0
 2
  
 c
 e
 D
 8
 2
  
  
  
 ]
 .
 A
 F
 h
 t
 a
 m
 [
  
  
 4
 v
 0
 3
 0
 3
 .
 5
 0
 0
 1
 :
 v
 i
 X
 r
 a
 ON A DISCRETE VERSION OF TANAKAS THEOREM FOR
 MAXIMAL FUNCTIONS
 JONATHAN BOBER, EMANUEL CARNEIRO, KEVIN HUGHES, AND LILLIAN B. PIERCE
 Abstract. In this paper we prove a discrete version of Tanakas theorem [19]
 for the Hardy-Littlewood maximal operator in dimension n = 1, both in the
 non-centered and centered cases. For the non-centered maximal operator fM
 we prove that, given a function f : Z  R of bounded variation,
 Var( fM f )  Var(f ),
 where Var(f ) represents the total variation of f . For the centered maximal
 operator M we prove that, given a function f : Z  R such that f  1(Z),
 Var(M f )  Ckf k1(Z).
 This provides a positive solution to a question of Haj lasz and Onninen [6] in
 the discrete one-dimensional case.
 1. Introduction
 d1
 It is natural to expect that an averaging operator should have certain smoothing
 properties; for instance, the spherical means on Rd map L2 to W
 2 ,2 [15, Chapter
 8, 5.21]. So one could expect that a maximal operator, being a supremum over
 averages, should not behave too dierently. In fact, if maximal operators are not
 smoothing operators, at least they do not destroy the regularity of functions, up to
 one weak derivative. This is the principle behind the program started in 1998 by
 Kinunnen [9] that studies the regularity of maximal operators acting on Sobolev
 functions. Since then, many authors have contributed to extend the theory, for in-
 stance [4], [5], [10], [11], [12], always having in the background the general principle
 that, for maximal operators, an Lp-bound implies a W 1,p-bound.
 Things become more dicult when one works with L1-functions, since the Hardy-
 loc(Rn) we dene
 Littlewood maximal operator does not map L1 to L1. For f  L1
 the centered maximal operator as follows:
 1
 m(B(x, r))ZB(x,r)
 |f (y)| dy ,
 Mf (x) = sup
 r0
 where B(x, r) is the ball in Rn centered at x with radius r and m(B(x, r)) is the
 n-dimensional Lebesgue measure of this ball.
 In 2004, Haj lasz and Onninen [6,
 Question 1] asked the following question:
 Question A: Is the operator f 7 |Mf | bounded from W 1,1(Rn) to L1(Rn)?
 Date: January 11, 2011.
 2000 Mathematics Subject Classication. Primary 42B25, 46E35.
 Key words and phrases. Maximal operators; Sobolev spaces; discrete operators; Tanakas
 Theorem.
 1
 2
 BOBER, CARNEIRO, HUGHES, AND PIERCE
 Observe that by dilation invariance, a bound of the type
 kMf kL1(Rn)  Ckf kL1(Rn) + kf kL1(Rn)
 implies that
 kMf kL1(Rn)  Ckf kL1(Rn) ,
 (1.1)
 and thus the fundamental question here is to compare the variation of the maximal
 function with the variation of the original function (perhaps having the additional
 information that f  L1(Rn)).
 In Tanakas elegant paper [19], he gave a positive answer to this question for
 loc(Rn) the
 the non-centered maximal operator in dimension n = 1. For f  L1
 non-centered maximal operator is dened as follows:
 fMf (x) = sup
 r0
 xBr
 1
 m(Br)ZBr
 |f (y)| dy ,
 where the supremum is now taken over all balls Br simply containing x. Tanaka
 established (1.1) for fM when f  W 1,1(R), with constant C = 2. This result was
 later rened by Aldaz and Perez Lazaro [1, Theorem 2.5] who obtained the sharp
 constant C = 1, under only the assumption that f has bounded variation.
 Philosophically, the non-centered version is a smoother operator than the cen-
 tered version since it contains more averages, making it easier to handle. Never-
 theless, we expect that (1.1) should also hold in the case of the centered maximal
 operator with constant C = 1, when n = 1 (one may take f (x) = [a,b](x) for an
 extremal example). So far, however, Question A remains untouched for the centered
 version, even in the case n = 1.
 1.1. The discrete one-dimensional setting. Finding discrete analogues for Lp-
 bounds in harmonic analysis is a topic of ongoing research. In the simplest cases,
 p-bounds for discrete analogues of classical operators such as Calderon-Zygmund
 singular integral operators, fractional integral operators, and the Hardy-Littlewood
 maximal function follow from known Lp-bounds for the original operators in the
 Euclidean setting, via elementary comparison arguments (see [16], [17]). But p-
 bounds for discrete analogues of more complicated operators, such as singular,
 fractional, and maximal Radon transforms (involving integration over a submani-
 fold, or family of submanifolds), are not implied by results in the continuous setting,
 and moreover the discrete analogues are resistant to conventional methods. Indeed,
 discrete operators may even behave dierently from their continuous counterparts,
 as is exhibited by the discrete spherical maximal operator [13]. It is only recently
 that substantial progress has been made on discrete operators with Radon charac-
 teristics via techniques motivated by the circle method of Hardy and Littlewood,
 a technique from number theory pioneered in the context of discrete analogues by
 Bourgain [2], [3], and further developed in a number of interesting cases (see for
 example [7], [8], [13], [14], [16], [17]).
 In this paper we introduce the study of the regularity theory of discrete max-
 imal operators in one dimension. Let f : Z  R be a discrete function and let
 Z+ = {0, 1, 2, 3, . . . , }. The discrete centered Hardy-Littlewood maximal operator
 DISCRETE TANAKAS THEOREM
 3
 is dened by
 M f (n) = sup
 rZ+
 1
 (2r + 1)
 while the non-centered version is dened by
 |f (n + k)| ,
 k=rXk=r
 k=sXk=r
 fM f (n) = sup
 r,sZ+
 1
 (r + s + 1)
 |f (n + k)| .
 Our aim is to answer discrete analogues of Question A for these operators. They
 clearly do not belong to the Radon transform paradigm, and we will not call upon
 the circle method; instead the challenge arises, at least in the case of the centered
 maximal operator M , from the fact that the analogous result in the continuous
 setting is not yet known!
 In order to study regularity properties of discrete operators, we establish the
 following conventions. For 1  p  , the p-norm of a function f : Z  R is
 and the -norm is
 kf kp(Z) =  Xn=
 |f (n)|p!1/p
 ,
 kf k(Z) = sup
 nZ
 |f (n)|.
 We dene the derivatives of a discrete function by
 f (n) = f (n + 1)  f (n) ,
 f (n) = f (n + 2)  2f (n + 1) + f (n) ,
 f (n) = f (n + 3)  3f (n + 2) + 3f (n + 1)  f (n) ,
 and so on. The space corresponding to W k,p(R) is then dened to be the set of
 discrete functions with nite wk,p(Z)-norm, where
 ||f ||wk,p(Z) =
 ||f (j)||p(Z).
 kXj=0
 But note that by the triangle inequality, for any k  1,
 kf (k)kp(Z)  2kkf kp(Z) ,
 (1.2)
 thus in the discrete setting, any p-bound automatically provides a wk,p-bound, for
 any k  1 (in fact, the discrete wk,p-spaces are just the classical p-spaces with an
 equivalent norm). This might make our eorts to transfer the regularity theory for
 maximal operators to the discrete setting seem almost vacuous.
 However, the situation is highly nontrivial when we deal with 1-functions or
 functions of bounded variation. We dene the total variation of f : Z  R by
 Var(f ) = kf k1(Z) =
 Xn=
 |f (n + 1)  f (n)| .
 Our rst result, a discrete version of Tanakas theorem for the discrete non-centered
 maximal operator, with sharp constant, is as follows:
 Dealing with the centered maximal operator is a much more subtle and intricate
 problem. By an extensive analysis of examples we are led to believe that the same
 bound should hold for the centered maximal operator:
 Question B: Let f : Z  R be a function of bounded variation. Is it true that
 Motivated by Question B, we prove the following result.
 Var(M f )  Var(f ) ?
 Theorem 2. Let f : Z  R be a function in 1(Z). Then
 Var(M f ) 2 +
 146
 315 kf k1(Z).
 (1.4)
 (1.5)
 Theorem 2 represents partial progress toward Question B. In fact, from (1.2),
 inequality (1.4) would imply (1.5) with constant C = 2, which would be sharp, with
 an extremal example given by (1.3). The constant we obtain here is slightly bigger
 C =2 +
 146
 315 = 21 +
 1
 5
 +
 1
 7
 
 1
 9 ,
 4
 BOBER, CARNEIRO, HUGHES, AND PIERCE
 Theorem 1. Let f : Z  R be a function of bounded variation. Then
 and the constant C = 1 is the best possible.
 Var(fM f )  Var(f ) ,
 We shall prove this result in Section 2, adapting some of the ideas of the original
 proof of Tanaka for the continuous case. It is not hard to see that the constant
 C = 1 is best possible in Theorem 1, for it suces to consider the function
 f (n) = 1
 if n = 0,
 0 otherwise.
 (1.3)
 and it appears due to combinatorial arguments in our proof (see Lemma 4 below).
 It is an interesting question whether one can improve this constant towards the
 conjectured sharp value.
 We expect higher dimensional analogues of these results, both in the continuous
 and discrete cases, to hold as well (see the original question by Haj lasz and Onninen
 [6]). However, the methods of Tanaka [19] and Aldaz and Perez Lazaro [1] for the
 one dimensional continuous (uncentered) case, and ours for the discrete (centered
 and uncentered) cases, do not easily adapt to higher dimensions.
 The simplicity and innocence of the objects and statements described above
 might appear misleading at rst glance. Before moving to the proofs, we encourage
 the interested reader to familiarize her/himself with the discrete maximal problem,
 especially Question B above, in order to better appreciate the beauty and the
 diculties of the interplay between analysis and combinatorics, still not completely
 understood, in this problem.
 2. Proof of Theorem 1
 Since Var(|f |)  Var(f ) we may assume without loss of generality that f takes
 only non-negative values. A function of bounded variation will certainly be bounded
 and thus, at each point n, the averages will also be bounded. However, since we do
 not assume f  1(Z), we must be aware of the fact that the supremum over these
 averages might not be realized.
 DISCRETE TANAKAS THEOREM
 5
 We will say that a point n is a local maximum of f if
 f (n  1)  f (n) and f (n)  f (n + 1).
 Similarly, a point n is a local minimum of f if
 f (n  1)  f (n) and f (n)  f (n + 1).
 The following lemma identies a key property of the local maxima of fM f .
 Lemma 3. If n is a local maximum of fM f , then fM f (n) = f (n).
 Proof. Let n  Z be a point such that fM f (n)  f (n) and assume that n is a local
 maximum of fM f . Let us arrive at a contradiction.
 Case 1. fM f (n) is attained for some r, s  Z+. Let I = [n  r, n + s] be such an
 to bound fM f (n + 1), i.e.
 interval. If s  1, then we may take an average over the same interval I in order
 1
 a contradiction. If s = 0, since fM f (n)  f (n), we must have r  1. We then have
 1
 fM f (n + 1) 
 (r + s + 1)
 fM f (n) =
 fM f (n  1) 
 (r + 1)
 1
 r
 k=1Xk=r
 k=sXk=r
 f (n + k) = fM f (n),
 k=0Xk=r
 f (n + k),
 f (n + k).
 This also leads to a contradiction by observing that
 fM f (n)  (r + 1)fM f (n)  rfM f (n  1)  f (n).
 Case 2. fM f (n) is not attained for any r, s  Z+. In this case we see that fM f (m) 
 fM f (n) for any m  Z, which is a contradiction. In fact, given   0, we may take
 an interval I = [n  r, n + s] big enough such that
 fM f (n)   
 1
 (r + s + 1)
 k=sXk=r
 f (n + k).
 For a xed m  Z, we consider the average over the interval I  = [m  r, m + s].
 Letting C = kf k(Z), we obtain
 fM f (m) 
 f (m + k)
 2C|m  n|
 r + s + 1
 1
 (r + s + 1)
 k=sXk=r
 fM f (n)   
 fM f (m)  (fM f (n)  .
 .
 
 Letting (r + s)   we get
 Letting   0, we arrive at the desired conclusion.
 6
 BOBER, CARNEIRO, HUGHES, AND PIERCE
 We now nish the proof of Theorem 1. From now on let us consider the alternat-
 ...  b2  a2  b1  a1  b0  a0  b1  a1  b2  a2  ....
 The sequence (2.1) can be nite or innite depending on the behavior of the tails
 ing sequence of local maxima {ai}iZ and local minima {bi}iZ of fM f , satisfying
 of fM f . Let us consider the dierent cases.
 Case 1. The sequence (2.1) is innite on both sides.
 (2.1)
 In this case we have
 VarfM f =
 =
 
 Xi=nfM f (ai1) fM f (bi)o +nfM f (ai) fM f (bi)o
 Xi=nf (ai1) fM f (bi)o +nf (ai) fM f (bi)o
 Xi=f (ai1)  f (bi) +f (ai)  f (bi)  Var(f ).
 Case 2. The sequence (2.1) is nite on one (or both) side(s).
 (2.2)
 In this case several dierent behaviors might occur, but they are essentially
 treated in the same way, using (2.2) and a minor modication in the tail(s). Suppose
 for instance that ak is the last local maximum. The function fM f (n) must be
 monotonically non-increasing for n  ak and since it is bounded, the limit
 will exist. In this case we will have
 Below we write
 Var(f )[a,b] =
 fM f () = lim
 nfM f (n) = c
 lim inf
 n
 f (n)  c.
 |f (n + 1)  f (n)| ,
 b1Xn=a
 for the variation of f on the interval [a, b], where a and b are integers (or possibly
 ). Therefore we have
 =
 VarfM f = VarfM f[,ak] + VarfM f[ak,]
 kXi=nfM f (ai1) fM f (bi) +fM f (ai) fM f (bi)o +fM f (ak)  c
 kXi=nf (ai1) fM f (bi) +f (ai) fM f (bi)o +f (ak)  c
 kXi=f (ai1)  f (bi) +f (ai)  f (bi) +f (ak)  c
 =
 
  Var(f )[,ak] + Var(f )[ak,] = Var(f ).
 DISCRETE TANAKAS THEOREM
 7
 The argument for all the other cases is a minor modication of this one. This
 concludes the proof of Theorem 1.
 3. Proof of Theorem 2
 One can begin consideration of the discrete centered maximal operator by in-
 vestigating whether Lemma 3, or any natural modication of it, continues to hold.
 The following example shows that this need not be the case:
 f (n) = 10 if n = 4,
 otherwise.
 0
 One should not expect the local maxima of M f to touch f , or even expect that
 M f should be convex in each interval in which it disconnects from f .
 Thus new ideas are required to approach this problem. We start again by as-
 suming that f takes only non-negative values, and consider the sequence of local
 maxima {ai}iZ and local minima {bi}iZ of M f , satisfying
 ...  b2  a2  b1  a1  b0  a0  b1  a1  b2  a2  ....
 (3.1)
 We have
 Var(M f ) = 2
 Xi=
 (M f (ai)  M f (bi)) .
 (3.2)
 Remark: If the sequence (3.1) terminates on one or both ends, we modify the sum
 (3.2) accordingly as follows. Since f  1(Z) we must have limn M f (n) =
 0, and this implies that if the sequence terminates, it would terminate with a
 last maximum ak and/or a rst maximum al (i.e.
 it would not terminate with a
 minimum). If there is a rst maximum al we consider
 Var(M f ) = 2M f (al) + 2
 (M f (ai)  M f (bi)) ,
 Xi=l+1
 and make minor modications in the argument below; similar modications apply
 if there is a last maximum ak.
 For each local maximum ai we let ri be the smallest radius such that
 M f (ai) = Arif (ai) =
 1
 (2ri + 1)
 k=riXk=ri
 f (ai + k) ,
 (3.3)
 where we denote by Ar the averaging operator of radius r (since f  1(Z) this
 radius exists). For each point bi we consider the average of radius si = ri + (ai  bi)
 and since we have
 it follows from (3.2), (3.3) and (3.4) that
 M f (bi)  Asi f (bi) ,
 Var(M f )  2
 (Ari f (ai)  Asi f (bi)) .
 Xi=
 Observe that the interval [bi  si, bi + si] contains the interval [ai  ri, ai + ri] and
 they both have the same right endpoint. Now we x an integer n and we will
 evaluate the maximum contribution that f (n) can give to the sum on the right
 hand side of (3.5).
 (3.4)
 (3.5)
 8
 BOBER, CARNEIRO, HUGHES, AND PIERCE
 For each i  Z , if n  [ai  ri, ai + ri], then n  [bi  si, bi + si] and f (n)
 contributes to (Ari f (ai)  Asi f (bi)) the amount
 f (n)
 f (n)
 2ri + 1
 
 2(ri + (ai  bi)) + 1
 .
 (3.6)
 If n / [ai  ri, ai + ri] the contribution of f (n) to (Ari f (ai)  Asi f (bi)) is zero or
 even negative and we disregard it. Now observe that if the contribution (3.6) occurs
 we must have ri  |n  ai|, and therefore one can show that
 f (n) 1
 2ri + 1
 
 2(ri + (ai  bi)) + 1
 1
  f (n)
 1
 2|n  ai| + 1
 2(|n  ai| + (ai  bi)) + 1
 1
  f (n)
 2|n  ai| + 1
 
 2(|n  ai| + (ai  ai1)) + 1 ,
 1
 
 1
 (3.7)
 where in the last step we just used the ordering (3.1). If we sum (3.7) over the
 index i we obtain an upper bound for the total contribution of f (n) to the right
 hand side of (3.5), namely
 2f (n)
 Xi=
 1
 2|n  ai| + 1
 
 2(|n  ai| + (ai  ai1)) + 1 .
 1
 (3.8)
 Theorem 2 will follow if we prove that for any strictly increasing sequence {ai}iZ
 of integers, the sum in (3.8) is bounded by a universal constant C. This is proved
 in Lemma 4 below. To conclude the proof of Theorem 2, we will ultimately sum the
 maximum contributions of all f (n)s to the total variation (3.5) of M f to prove, as
 desired, that
 Var(M f )  2C
 (3.9)
 If furthermore ai  ai1  2 for all i  Z, the constant C = 4
 C = 1 + 1
 5 + 1
 7  1
 9 .
 3 may be replaced by
 Proof. It is sucient to prove the result for n = 0 since we can shift any sequence
 ai 7 ai + n. For n = 0 we aim to prove that
 S =
 Xi=
 1
 2|ai| + 1
 
 2(|ai| + (ai  ai1)) + 1  C .
 1
 (3.10)
 By shifting the indices we can also assume that a1  0  a0. We divide our sum
 (3.10) into two parts
 S =
 1Xi=
 1
 2ai + 1
 
 1
 2ai1 + 1 +
 Xi=0 1
 2ai + 1
 
 2(ai + (ai  ai1)) + 1
 1
 = S1 + S2.
 Lemma 4. Given n  Z, for any strictly increasing sequence {ai}iZ of integers,
 f (n) = 2C kf k1(Z).
 Xn=
 2(|n  ai| + (ai  ai1)) + 1 
 1
 4
 3
 .
 Xi=
 1
 2|n  ai| + 1
 
 DISCRETE TANAKAS THEOREM
 9
 The rst sum S1 is a telescoping sum and we nd that
 S1 
 1
 2a1 + 1
 .
 (This continues to hold if the sequence terminates to the left as i  .)
 The second sum is more involved and we use the following inequality, for integers
 m  n  0:
 1
 2m + 1
 
 1
 2(m + (m  n)) + 1
 
 1
 2(n + 1) + 1
 
 1
 2(m + 1) + 1
 .
 (3.11)
 Inequality (3.11) can be proved simply by clearing denominators and observing that
 m  n + 1. We then use (3.11) to bound S2 as follows:
 S2 =
 
 
 1
 2a0 + 1
 1
 2a0 + 1
 1
 2a0 + 1
 
 
 
 1
 2(a0 + (a0  a1)) + 1 +
 2(a0 + (a0  a1)) + 1 +
 2(a0 + (a0  a1)) + 1 +
 1
 1
 
 2ai + 1
 Xi=1 1
 Xi=1
 1
 2(ai1 + 1) + 1
 1
 2(ai + (ai  ai1)) + 1
 2(ai + 1) + 1
 
 1
 1
 2(a0 + 1) + 1
 .
 (This also continues to hold if the sequence terminates to the right as i  .) We
 have thus arrived at
 S = S1 + S2
 
 1
 2a1 + 1
 + 1
 2a0 + 1
 
 2(a0 + (a0  a1)) + 1 +
 1
 1
 2(a0 + 1) + 1
 (3.12)
 .
 Recall that here a1  0  a0 are integers. For any 0  a0 it is easy to see that
 (3.12) is maximized when a1 = 0. Then a simple analysis of cases yields that
 a0 = 1 is the maximal choice, proving that (3.12) is bounded by
 C = 1 +
 1
 3
 =
 4
 3
 .
 If we impose the condition a0  a1  2, again we can easily see that the maximum
 of (3.12) occurs when a1 = 1 or 0. An analysis of a few cases conrms that
 (3.12) is maximized when a1 = 0 and a0 = 2, giving the upper bound
 1
 7
 and this nishes the proof of the lemma.
 C = 1 +
 1
 5
 +
 
 1
 9
 = 1 +
 73
 315
 ,
 (3.13)
 
 Observe that in the setting of our maximal operator, we have the condition
 ai  ai1  2 for all i  Z (there must be a local minimum between any two
 consecutive local maxima), and thus we can use Lemma 4 with constant C given
 by (3.13) in expression (3.9) to conclude that
 Var(M f )  21 +
 73
 315 kf k1(Z).
 10
 BOBER, CARNEIRO, HUGHES, AND PIERCE
 Acknowledgments
 The authors would like to thank Jerey Vaaler, Jean Bourgain, Diego Moreira
 and Dimitris Koukoulopoulos for helpful comments during the preparation of this
 work. J. Bober, E. Carneiro and L. B. Pierce acknowledge support from the Insti-
 tute for Advanced Study and the National Science Foundation under agreement No.
 DMS-0635607. E. Carneiro also acknowledges support from CAPES/FULBRIGHT
 grant BEX 1710-04-4. L. B. Pierce is also funded by the Simonyi Fund and National
 Science Foundation grant DMS-0902658.
 Remarks
 Our previous version of this manuscript (arXiv:1005.3030v3), which happens to
 be the published version [Proc. Amer. Math. Soc. 140 (2012), 1669-1680], had an
 oversight in the proof of Lemma 3 (iii), when we claimed that
 which is not true. The previous proof of Lemma 3 (iii), and hence of Theorem 1,
 was correct for the slightly dierent discrete non-centered maximal operator
 r,sZ+
 (3.14)
 |f (n + k)|!) ,
 fM f (n) = max{MLf (n), MRf (n)}, n  Z,
 (r + s + rs)( k=1Xk=r
 |f (n + k)|! + rs|f (n)| + k=sXk=1
 1
 where rs = 1 if rs  0 and rs = 1
 interval that has n as an endpoint, we consider is contribution with weight 1
 ffM f (n) = sup
 have now briey adjusted our proof to address our original claim for the operatorfM .
 In fact, Lemma 3 (and Theorem 1) hold for other variants of non-centered discrete
 maximal operators (e.g. placing weight 1/2 in one or both endpoints of the interval,
 considering only intervals with an odd number of integer points, considering lateral
 operators, etc.). The strategy of the proof is the same, with minor adjustments.
 The oversight in Lemma 3 (iii) in our previous version was observed independently
 by Dariusz Kosz and Matt Rosenzweig, to whom we are thankful.
 2 if rs = 0 (i.e. when we take an average over an
 2 ). We
 References
 1. J. M. Aldaz and J. Perez Lazaro, Functions of bounded variation, the derivative of the one
 dimensional maximal function, and applications to inequalities, Trans. Amer. Math. Soc. 359
 (2007), no. 5, 24432461.
 2. J. Bourgain, On the maximal ergodic theorem for certain subsets of the integers, Israel J.
 Math. 61 (1988) 3972.
 3. J. Bourgain, On the pointwise ergodic theorem on Lp for arithmetic sets, Israel J. Math. 61
 (1988) 7384.
 4. E. Carneiro and D. Moreira, On the regularity of maximal operators, Proc. Amer. Math. Soc.
 136 (2008), no. 12, 43954404.
 5. P. Haj lasz and J. Maly, On approximate dierentiability of the maximal function, Proc. Amer.
 Math. Soc., to appear.
 6. P. Haj lasz and J. Onninen, On boundedness of maximal functions in Sobolev spaces, Ann.
 Acad. Sci. Fenn. Math. 29 (2004), no. 1, 167176.
 7. A. D. Ionescu and A. Magyar and E. M. Stein and S. Wainger, Discrete Radon transforms
 and applications to ergodic theory, Acta Math. 198 (2007) 231-298.
 8. A. D. Ionescu and S. Wainger, Lp boundedness of discrete singular Radon transforms, J.
 Amer. Math. Soc. 19 (2005) no. 2, 357383.
 9. J. Kinnunen, The Hardy-Littlewood maximal function of a Sobolev function, Israel J. Math.
 100 (1997), 117124.
 DISCRETE TANAKAS THEOREM
 11
 10. J. Kinnunen and P. Lindqvist, The derivative of the maximal function, J. Reine Angew. Math.
 503 (1998), 161167.
 11. J. Kinnunen and E. Saksman, Regularity of the fractional maximal function, Bull. London
 Math. Soc. 35 (2003), no. 4, 529535.
 12. H. Luiro, Continuity of the maximal operator in Sobolev spaces, Proc. Amer. Math. Soc. 135
 (2007), no. 1, 243251.
 13. A. Magyar and E. M. Stein and S. Wainger, Discrete analogues in harmonic analysis: Spherical
 averages, Ann. Math. 155 (2002) 189208.
 14. L. B. Pierce, Discrete fractional Radon transforms and quadratic forms, preprint.
 15. E. M. Stein, Harmonic Analysis: Real Variable Methods, Orthogonality, and Oscillatory In-
 tegrals, Princeton University Press 1993.
 16. E. M. Stein and S. Wainger, Discrete analogues in harmonic analysis I: 2 estimates for singular
 Radon transforms, Amer. J. Math. 121 (1999), 12911336.
 17. E. M. Stein and S. Wainger, Discrete analogues in harmonic analysis II: Fractional integration,
 J. dAnalyse Math. 80 (2000) 335355.
 18. E. M. Stein and S. Wainger, Two discrete fractional integral operators revisited, J. dAnalyse
 Math. 87 (2002) 451479.
 19. H. Tanaka, A remark on the derivative of the one-dimensional Hardy-Littlewood maximal
 function, Bull. Austral. Math. Soc. 65 (2002), no. 2, 253258.
 School of Mathematics, Institute for Advanced Study, Einstein Drive, Princeton,
 NJ, 08540.
 E-mail address: bober@math.ias.edu
 School of Mathematics, Institute for Advanced Study, Einstein Drive, Princeton,
 NJ, 08540.
 E-mail address: ecarneiro@math.ias.edu
 Department of Mathematics, Princeton University, Fine Hall, Washington Road,
 Princeton, NJ, 08544
 E-mail address: kjhughes@math.princeton.edu
 School of Mathematics, Institute for Advanced Study, Einstein Drive, Princeton,
 NJ, 08540.
 E-mail address: lbpierce@math.ias.edu

 ***

 Theorem 1. Let f : Z  R be a function of bounded variation. Then

        0.0
         4

        0.0
         1

        0.0
         0

        0.0
         2

        0.133333333333
          

        0.0
         c

        0.0
         e

        0.0
         D

        0.0
         8

        0.0
         2

        0.133333333333
          

        0.133333333333
          

        0.133333333333
          

        0.0
         ]

        0.0
         .

        0.0
         A

        0.0
         F

        0.0
         h

        0.0
         t

        0.0666666666667
         a

        0.0
         m

        0.0
         [

        0.133333333333
          

        0.133333333333
          

        0.0
         4

        0.0
         v

        0.0
         0

        0.0
         3

        0.0
         0

        0.0
         3

        0.0
         .

        0.0
         5

        0.0
         0

        0.0
         0

        0.0
         1

        0.0666666666667
         :

        0.0
         v

        0.0
         i

        0.0
         X

        0.0
         r

        0.0666666666667
         a

        0.0
         ON A DISCRETE VERSION OF TANAKAS THEOREM FOR

        0.0
         MAXIMAL FUNCTIONS

        0.0
         JONATHAN BOBER, EMANUEL CARNEIRO, KEVIN HUGHES, AND LILLIAN B. PIERCE

        0.133333333333
         Abstract. In this paper we prove a discrete version of Tanakas theorem [19]

        0.0
         for the Hardy-Littlewood maximal operator in dimension n = 1, both in the

        0.0
         non-centered and centered cases. For the non-centered maximal operator fM

        0.6
         we prove that, given a function f : Z  R of bounded variation,

        0.133333333333
         Var( fM f )  Var(f ),

        0.133333333333
         where Var(f ) represents the total variation of f . For the centered maximal

        0.5
         operator M we prove that, given a function f : Z  R such that f  1(Z),

        0.133333333333
         Var(M f )  Ckf k1(Z).

        0.2
         This provides a positive solution to a question of Haj lasz and Onninen [6] in

        0.0
         the discrete one-dimensional case.

        0.0666666666667
         1. Introduction

        0.0
         d1

        0.0
         It is natural to expect that an averaging operator should have certain smoothing

        0.0
         properties; for instance, the spherical means on Rd map L2 to W

        0.0
         2 ,2 [15, Chapter

        0.133333333333
         8, 5.21]. So one could expect that a maximal operator, being a supremum over

        0.0
         averages, should not behave too dierently. In fact, if maximal operators are not

        0.0666666666667
         smoothing operators, at least they do not destroy the regularity of functions, up to

        0.0
         one weak derivative. This is the principle behind the program started in 1998 by

        0.0666666666667
         Kinunnen [9] that studies the regularity of maximal operators acting on Sobolev

        0.0
         functions. Since then, many authors have contributed to extend the theory, for in-

        0.0
         stance [4], [5], [10], [11], [12], always having in the background the general principle

        0.0666666666667
         that, for maximal operators, an Lp-bound implies a W 1,p-bound.

        0.0
         Things become more dicult when one works with L1-functions, since the Hardy-

        0.0
         loc(Rn) we dene

        0.133333333333
         Littlewood maximal operator does not map L1 to L1. For f  L1

        0.0
         the centered maximal operator as follows:

        0.0
         1

        0.0
         m(B(x, r))ZB(x,r)

        0.0
         |f (y)| dy ,

        0.0
         Mf (x) = sup

        0.0
         r0

        0.0
         where B(x, r) is the ball in Rn centered at x with radius r and m(B(x, r)) is the

        0.0666666666667
         n-dimensional Lebesgue measure of this ball.

        0.0
         In 2004, Haj lasz and Onninen [6,

        0.0
         Question 1] asked the following question:

        0.133333333333
         Question A: Is the operator f 7 |Mf | bounded from W 1,1(Rn) to L1(Rn)?

        0.0
         Date: January 11, 2011.

        0.0
         2000 Mathematics Subject Classication. Primary 42B25, 46E35.

        0.0
         Key words and phrases. Maximal operators; Sobolev spaces; discrete operators; Tanakas

        0.0
         Theorem.

        0.0
         1

        0.0
         2

        0.0
         BOBER, CARNEIRO, HUGHES, AND PIERCE

        0.133333333333
         Observe that by dilation invariance, a bound of the type

        0.0666666666667
         kMf kL1(Rn)  Ckf kL1(Rn) + kf kL1(Rn)

        0.0
         implies that

        0.0666666666667
         kMf kL1(Rn)  Ckf kL1(Rn) ,

        0.0
         (1.1)

        0.0666666666667
         and thus the fundamental question here is to compare the variation of the maximal

        0.2
         function with the variation of the original function (perhaps having the additional

        0.133333333333
         information that f  L1(Rn)).

        0.0666666666667
         In Tanakas elegant paper [19], he gave a positive answer to this question for

        0.0
         loc(Rn) the

        0.2
         the non-centered maximal operator in dimension n = 1. For f  L1

        0.0
         non-centered maximal operator is dened as follows:

        0.0
         fMf (x) = sup

        0.0
         r0

        0.0
         xBr

        0.0
         1

        0.0
         m(Br)ZBr

        0.0
         |f (y)| dy ,

        0.0
         where the supremum is now taken over all balls Br simply containing x. Tanaka

        0.117647058824
         established (1.1) for fM when f  W 1,1(R), with constant C = 2. This result was

        0.0666666666667
         later rened by Aldaz and Perez Lazaro [1, Theorem 2.5] who obtained the sharp

        0.2
         constant C = 1, under only the assumption that f has bounded variation.

        0.0666666666667
         Philosophically, the non-centered version is a smoother operator than the cen-

        0.0
         tered version since it contains more averages, making it easier to handle. Never-

        0.0666666666667
         theless, we expect that (1.1) should also hold in the case of the centered maximal

        0.0526315789474
         operator with constant C = 1, when n = 1 (one may take f (x) = [a,b](x) for an

        0.0
         extremal example). So far, however, Question A remains untouched for the centered

        0.0666666666667
         version, even in the case n = 1.

        0.0
         1.1. The discrete one-dimensional setting. Finding discrete analogues for Lp-

        0.133333333333
         bounds in harmonic analysis is a topic of ongoing research. In the simplest cases,

        0.0666666666667
         p-bounds for discrete analogues of classical operators such as Calderon-Zygmund

        0.0
         singular integral operators, fractional integral operators, and the Hardy-Littlewood

        0.0666666666667
         maximal function follow from known Lp-bounds for the original operators in the

        0.0
         Euclidean setting, via elementary comparison arguments (see [16], [17]). But p-

        0.0666666666667
         bounds for discrete analogues of more complicated operators, such as singular,

        0.0666666666667
         fractional, and maximal Radon transforms (involving integration over a submani-

        0.0666666666667
         fold, or family of submanifolds), are not implied by results in the continuous setting,

        0.0
         and moreover the discrete analogues are resistant to conventional methods. Indeed,

        0.0
         discrete operators may even behave dierently from their continuous counterparts,

        0.0
         as is exhibited by the discrete spherical maximal operator [13]. It is only recently

        0.0
         that substantial progress has been made on discrete operators with Radon charac-

        0.0666666666667
         teristics via techniques motivated by the circle method of Hardy and Littlewood,

        0.133333333333
         a technique from number theory pioneered in the context of discrete analogues by

        0.133333333333
         Bourgain [2], [3], and further developed in a number of interesting cases (see for

        0.0
         example [7], [8], [13], [14], [16], [17]).

        0.133333333333
         In this paper we introduce the study of the regularity theory of discrete max-

        0.529411764706
         imal operators in one dimension. Let f : Z  R be a discrete function and let

        0.0
         Z+ = {0, 1, 2, 3, . . . , }. The discrete centered Hardy-Littlewood maximal operator

        0.0
         DISCRETE TANAKAS THEOREM

        0.0
         3

        0.0
         is dened by

        0.0666666666667
         M f (n) = sup

        0.0
         rZ+

        0.0
         1

        0.0
         (2r + 1)

        0.0
         while the non-centered version is dened by

        0.0
         |f (n + k)| ,

        0.0
         k=rXk=r

        0.0
         k=sXk=r

        0.0666666666667
         fM f (n) = sup

        0.0
         r,sZ+

        0.0
         1

        0.0
         (r + s + 1)

        0.0
         |f (n + k)| .

        0.0666666666667
         Our aim is to answer discrete analogues of Question A for these operators. They

        0.0
         clearly do not belong to the Radon transform paradigm, and we will not call upon

        0.0666666666667
         the circle method; instead the challenge arises, at least in the case of the centered

        0.0
         maximal operator M , from the fact that the analogous result in the continuous

        0.0
         setting is not yet known!

        0.0666666666667
         In order to study regularity properties of discrete operators, we establish the

        0.526315789474
         following conventions. For 1  p  , the p-norm of a function f : Z  R is

        0.0
         and the -norm is

        0.0666666666667
         kf kp(Z) =  Xn=

        0.0
         |f (n)|p!1/p

        0.0
         ,

        0.0
         kf k(Z) = sup

        0.0
         nZ

        0.0
         |f (n)|.

        0.2
         We dene the derivatives of a discrete function by

        0.266666666667
         f (n) = f (n + 1)  f (n) ,

        0.25
         f (n) = f (n + 2)  2f (n + 1) + f (n) ,

        0.238095238095
         f (n) = f (n + 3)  3f (n + 2) + 3f (n + 1)  f (n) ,

        0.117647058824
         and so on. The space corresponding to W k,p(R) is then dened to be the set of

        0.0
         discrete functions with nite wk,p(Z)-norm, where

        0.0
         ||f ||wk,p(Z) =

        0.0
         ||f (j)||p(Z).

        0.0
         kXj=0

        0.0666666666667
         But note that by the triangle inequality, for any k  1,

        0.0666666666667
         kf (k)kp(Z)  2kkf kp(Z) ,

        0.0
         (1.2)

        0.0666666666667
         thus in the discrete setting, any p-bound automatically provides a wk,p-bound, for

        0.0625
         any k  1 (in fact, the discrete wk,p-spaces are just the classical p-spaces with an

        0.0
         equivalent norm). This might make our eorts to transfer the regularity theory for

        0.0
         maximal operators to the discrete setting seem almost vacuous.

        0.0
         However, the situation is highly nontrivial when we deal with 1-functions or

        0.5625
         functions of bounded variation. We dene the total variation of f : Z  R by

        0.0
         Var(f ) = kf k1(Z) =

        0.0
         Xn=

        0.133333333333
         |f (n + 1)  f (n)| .

        0.133333333333
         Our rst result, a discrete version of Tanakas theorem for the discrete non-centered

        0.0
         maximal operator, with sharp constant, is as follows:

        0.0666666666667
         Dealing with the centered maximal operator is a much more subtle and intricate

        0.0666666666667
         problem. By an extensive analysis of examples we are led to believe that the same

        0.0
         bound should hold for the centered maximal operator:

        0.666666666667
         Question B: Let f : Z  R be a function of bounded variation. Is it true that

        0.0
         Motivated by Question B, we prove the following result.

        0.133333333333
         Var(M f )  Var(f ) ?

        0.733333333333
         Theorem 2. Let f : Z  R be a function in 1(Z). Then

        0.0666666666667
         Var(M f ) 2 +

        0.0
         146

        0.0
         315 kf k1(Z).

        0.0
         (1.4)

        0.0
         (1.5)

        0.0666666666667
         Theorem 2 represents partial progress toward Question B. In fact, from (1.2),

        0.0666666666667
         inequality (1.4) would imply (1.5) with constant C = 2, which would be sharp, with

        0.0
         an extremal example given by (1.3). The constant we obtain here is slightly bigger

        0.0
         C =2 +

        0.0
         146

        0.0
         315 = 21 +

        0.0
         1

        0.0
         5

        0.0
         +

        0.0
         1

        0.0
         7

        0.0666666666667
         

        0.0
         1

        0.0
         9 ,

        0.0
         4

        0.0
         BOBER, CARNEIRO, HUGHES, AND PIERCE

        1.0
!        Theorem 1. Let f : Z  R be a function of bounded variation. Then

 Var(M f )  Var(f ) ,

        0.142857142857
         9 ,

        0.0
         4

        0.0
         BOBER, CARNEIRO, HUGHES, AND PIERCE

        0.133333333333
         Theorem 1. Let f : Z  R be a function of bounded variation. Then

        0.0
         and the constant C = 1 is the best possible.

        0.857142857143
!         Var(fM f )  Var(f ) ,

 and the constant C = 1 is the best possible.

        0.0
         9 ,

        0.0
         4

        0.0
         BOBER, CARNEIRO, HUGHES, AND PIERCE

        0.0
         Theorem 1. Let f : Z  R be a function of bounded variation. Then

        1.0
!         and the constant C = 1 is the best possible.

 ***

 Theorem 2. Let f : Z  R be a function in 1(Z). Then

        0.142857142857
         Var(fM f )  Var(f ) ,

        0.0625
         We shall prove this result in Section 2, adapting some of the ideas of the original

        0.0
         proof of Tanaka for the continuous case. It is not hard to see that the constant

        0.1875
         C = 1 is best possible in Theorem 1, for it suces to consider the function

        0.0714285714286
         f (n) = 1

        0.0
         if n = 0,

        0.0
         0 otherwise.

        0.0
         (1.3)

        0.0714285714286
         and it appears due to combinatorial arguments in our proof (see Lemma 4 below).

        0.0
         It is an interesting question whether one can improve this constant towards the

        0.0
         conjectured sharp value.

        0.0714285714286
         We expect higher dimensional analogues of these results, both in the continuous

        0.0
         and discrete cases, to hold as well (see the original question by Haj lasz and Onninen

        0.0
         [6]). However, the methods of Tanaka [19] and Aldaz and Perez Lazaro [1] for the

        0.0
         one dimensional continuous (uncentered) case, and ours for the discrete (centered

        0.0
         and uncentered) cases, do not easily adapt to higher dimensions.

        0.0
         The simplicity and innocence of the objects and statements described above

        0.0
         might appear misleading at rst glance. Before moving to the proofs, we encourage

        0.0
         the interested reader to familiarize her/himself with the discrete maximal problem,

        0.0714285714286
         especially Question B above, in order to better appreciate the beauty and the

        0.0
         diculties of the interplay between analysis and combinatorics, still not completely

        0.0714285714286
         understood, in this problem.

        0.142857142857
         2. Proof of Theorem 1

        0.125
         Since Var(|f |)  Var(f ) we may assume without loss of generality that f takes

        0.142857142857
         only non-negative values. A function of bounded variation will certainly be bounded

        0.0625
         and thus, at each point n, the averages will also be bounded. However, since we do

        0.176470588235
         not assume f  1(Z), we must be aware of the fact that the supremum over these

        0.0714285714286
         averages might not be realized.

        0.0
         DISCRETE TANAKAS THEOREM

        0.0
         5

        0.214285714286
         We will say that a point n is a local maximum of f if

        0.466666666667
         f (n  1)  f (n) and f (n)  f (n + 1).

        0.214285714286
         Similarly, a point n is a local minimum of f if

        0.466666666667
         f (n  1)  f (n) and f (n)  f (n + 1).

        0.133333333333
         The following lemma identies a key property of the local maxima of fM f .

        0.210526315789
         Lemma 3. If n is a local maximum of fM f , then fM f (n) = f (n).

        0.391304347826
         Proof. Let n  Z be a point such that fM f (n)  f (n) and assume that n is a local

        0.214285714286
         maximum of fM f . Let us arrive at a contradiction.

        0.2
         Case 1. fM f (n) is attained for some r, s  Z+. Let I = [n  r, n + s] be such an

        0.0714285714286
         to bound fM f (n + 1), i.e.

        0.111111111111
         interval. If s  1, then we may take an average over the same interval I in order

        0.0
         1

        0.227272727273
         a contradiction. If s = 0, since fM f (n)  f (n), we must have r  1. We then have

        0.0
         1

        0.142857142857
         fM f (n + 1) 

        0.0
         (r + s + 1)

        0.0714285714286
         fM f (n) =

        0.214285714286
         fM f (n  1) 

        0.0
         (r + 1)

        0.0
         1

        0.0
         r

        0.0
         k=1Xk=r

        0.0
         k=sXk=r

        0.142857142857
         f (n + k) = fM f (n),

        0.0
         k=0Xk=r

        0.0714285714286
         f (n + k),

        0.0714285714286
         f (n + k).

        0.0714285714286
         This also leads to a contradiction by observing that

        0.444444444444
         fM f (n)  (r + 1)fM f (n)  rfM f (n  1)  f (n).

        0.208333333333
         Case 2. fM f (n) is not attained for any r, s  Z+. In this case we see that fM f (m) 

        0.238095238095
         fM f (n) for any m  Z, which is a contradiction. In fact, given   0, we may take

        0.0714285714286
         an interval I = [n  r, n + s] big enough such that

        0.285714285714
         fM f (n)   

        0.0
         1

        0.0
         (r + s + 1)

        0.0
         k=sXk=r

        0.0714285714286
         f (n + k).

        0.181818181818
         For a xed m  Z, we consider the average over the interval I  = [m  r, m + s].

        0.0
         Letting C = kf k(Z), we obtain

        0.142857142857
         fM f (m) 

        0.0714285714286
         f (m + k)

        0.0714285714286
         2C|m  n|

        0.0
         r + s + 1

        0.0
         1

        0.0
         (r + s + 1)

        0.0
         k=sXk=r

        0.285714285714
         fM f (n)   

        0.285714285714
         fM f (m)  (fM f (n)  .

        0.0
         .

        0.0714285714286
         

        0.142857142857
         Letting (r + s)   we get

        0.142857142857
         Letting   0, we arrive at the desired conclusion.

        0.0
         6

        0.0
         BOBER, CARNEIRO, HUGHES, AND PIERCE

        0.0625
         We now nish the proof of Theorem 1. From now on let us consider the alternat-

        0.478260869565
         ...  b2  a2  b1  a1  b0  a0  b1  a1  b2  a2  ....

        0.0666666666667
         The sequence (2.1) can be nite or innite depending on the behavior of the tails

        0.0666666666667
         ing sequence of local maxima {ai}iZ and local minima {bi}iZ of fM f , satisfying

        0.142857142857
         of fM f . Let us consider the dierent cases.

        0.0
         Case 1. The sequence (2.1) is innite on both sides.

        0.0
         (2.1)

        0.0
         In this case we have

        0.0714285714286
         VarfM f =

        0.0
         =

        0.0714285714286
         

        0.285714285714
         Xi=nfM f (ai1) fM f (bi)o +nfM f (ai) fM f (bi)o

        0.142857142857
         Xi=nf (ai1) fM f (bi)o +nf (ai) fM f (bi)o

        0.357142857143
         Xi=f (ai1)  f (bi) +f (ai)  f (bi)  Var(f ).

        0.0714285714286
         Case 2. The sequence (2.1) is nite on one (or both) side(s).

        0.0
         (2.2)

        0.0
         In this case several dierent behaviors might occur, but they are essentially

        0.2
         treated in the same way, using (2.2) and a minor modication in the tail(s). Suppose

        0.1875
         for instance that ak is the last local maximum. The function fM f (n) must be

        0.0714285714286
         monotonically non-increasing for n  ak and since it is bounded, the limit

        0.0
         will exist. In this case we will have

        0.0
         Below we write

        0.0
         Var(f )[a,b] =

        0.0714285714286
         fM f () = lim

        0.0714285714286
         nfM f (n) = c

        0.0
         lim inf

        0.0
         n

        0.142857142857
         f (n)  c.

        0.142857142857
         |f (n + 1)  f (n)| ,

        0.0
         b1Xn=a

        0.111111111111
         for the variation of f on the interval [a, b], where a and b are integers (or possibly

        0.0
         ). Therefore we have

        0.0
         =

        0.0714285714286
         VarfM f = VarfM f[,ak] + VarfM f[ak,]

        0.352941176471
         kXi=nfM f (ai1) fM f (bi) +fM f (ai) fM f (bi)o +fM f (ak)  c

        0.214285714286
         kXi=nf (ai1) fM f (bi) +f (ai) fM f (bi)o +f (ak)  c

        0.357142857143
         kXi=f (ai1)  f (bi) +f (ai)  f (bi) +f (ak)  c

        0.0
         =

        0.0714285714286
         

        0.0714285714286
          Var(f )[,ak] + Var(f )[ak,] = Var(f ).

        0.0
         DISCRETE TANAKAS THEOREM

        0.0
         7

        0.0666666666667
         The argument for all the other cases is a minor modication of this one. This

        0.0714285714286
         concludes the proof of Theorem 1.

        0.0714285714286
         3. Proof of Theorem 2

        0.0
         One can begin consideration of the discrete centered maximal operator by in-

        0.0
         vestigating whether Lemma 3, or any natural modication of it, continues to hold.

        0.0714285714286
         The following example shows that this need not be the case:

        0.0714285714286
         f (n) = 10 if n = 4,

        0.0
         otherwise.

        0.0
         0

        0.111111111111
         One should not expect the local maxima of M f to touch f , or even expect that

        0.333333333333
         M f should be convex in each interval in which it disconnects from f .

        0.0
         Thus new ideas are required to approach this problem. We start again by as-

        0.0714285714286
         suming that f takes only non-negative values, and consider the sequence of local

        0.0714285714286
         maxima {ai}iZ and local minima {bi}iZ of M f , satisfying

        0.478260869565
         ...  b2  a2  b1  a1  b0  a0  b1  a1  b2  a2  ....

        0.0
         (3.1)

        0.0
         We have

        0.0714285714286
         Var(M f ) = 2

        0.0
         Xi=

        0.214285714286
         (M f (ai)  M f (bi)) .

        0.0
         (3.2)

        0.0
         Remark: If the sequence (3.1) terminates on one or both ends, we modify the sum

        0.1875
         (3.2) accordingly as follows. Since f  1(Z) we must have limn M f (n) =

        0.0714285714286
         0, and this implies that if the sequence terminates, it would terminate with a

        0.0714285714286
         last maximum ak and/or a rst maximum al (i.e.

        0.0714285714286
         it would not terminate with a

        0.0714285714286
         minimum). If there is a rst maximum al we consider

        0.142857142857
         Var(M f ) = 2M f (al) + 2

        0.214285714286
         (M f (ai)  M f (bi)) ,

        0.0
         Xi=l+1

        0.0714285714286
         and make minor modications in the argument below; similar modications apply

        0.0714285714286
         if there is a last maximum ak.

        0.0714285714286
         For each local maximum ai we let ri be the smallest radius such that

        0.0714285714286
         M f (ai) = Arif (ai) =

        0.0
         1

        0.0
         (2ri + 1)

        0.0
         k=riXk=ri

        0.0714285714286
         f (ai + k) ,

        0.0
         (3.3)

        0.125
         where we denote by Ar the averaging operator of radius r (since f  1(Z) this

        0.0526315789474
         radius exists). For each point bi we consider the average of radius si = ri + (ai  bi)

        0.0
         and since we have

        0.0
         it follows from (3.2), (3.3) and (3.4) that

        0.214285714286
         M f (bi)  Asi f (bi) ,

        0.142857142857
         Var(M f )  2

        0.214285714286
         (Ari f (ai)  Asi f (bi)) .

        0.0
         Xi=

        0.1
         Observe that the interval [bi  si, bi + si] contains the interval [ai  ri, ai + ri] and

        0.0
         they both have the same right endpoint. Now we x an integer n and we will

        0.0666666666667
         evaluate the maximum contribution that f (n) can give to the sum on the right

        0.0
         hand side of (3.5).

        0.0
         (3.4)

        0.0
         (3.5)

        0.0
         8

        0.0
         BOBER, CARNEIRO, HUGHES, AND PIERCE

        0.259259259259
         For each i  Z , if n  [ai  ri, ai + ri], then n  [bi  si, bi + si] and f (n)

        0.214285714286
         contributes to (Ari f (ai)  Asi f (bi)) the amount

        0.0714285714286
         f (n)

        0.0714285714286
         f (n)

        0.0
         2ri + 1

        0.0714285714286
         

        0.0714285714286
         2(ri + (ai  bi)) + 1

        0.0
         .

        0.0
         (3.6)

        0.2
         If n / [ai  ri, ai + ri] the contribution of f (n) to (Ari f (ai)  Asi f (bi)) is zero or

        0.0
         even negative and we disregard it. Now observe that if the contribution (3.6) occurs

        0.142857142857
         we must have ri  |n  ai|, and therefore one can show that

        0.0714285714286
         f (n) 1

        0.0
         2ri + 1

        0.0714285714286
         

        0.0714285714286
         2(ri + (ai  bi)) + 1

        0.0
         1

        0.142857142857
          f (n)

        0.0
         1

        0.0714285714286
         2|n  ai| + 1

        0.142857142857
         2(|n  ai| + (ai  bi)) + 1

        0.0
         1

        0.142857142857
          f (n)

        0.0714285714286
         2|n  ai| + 1

        0.0714285714286
         

        0.142857142857
         2(|n  ai| + (ai  ai1)) + 1 ,

        0.0
         1

        0.0714285714286
         

        0.0
         1

        0.0
         (3.7)

        0.0588235294118
         where in the last step we just used the ordering (3.1). If we sum (3.7) over the

        0.0588235294118
         index i we obtain an upper bound for the total contribution of f (n) to the right

        0.0
         hand side of (3.5), namely

        0.0
         2f (n)

        0.0
         Xi=

        0.0
         1

        0.0714285714286
         2|n  ai| + 1

        0.0714285714286
         

        0.142857142857
         2(|n  ai| + (ai  ai1)) + 1 .

        0.0
         1

        0.0
         (3.8)

        0.0714285714286
         Theorem 2 will follow if we prove that for any strictly increasing sequence {ai}iZ

        0.125
         of integers, the sum in (3.8) is bounded by a universal constant C. This is proved

        0.125
         in Lemma 4 below. To conclude the proof of Theorem 2, we will ultimately sum the

        0.117647058824
         maximum contributions of all f (n)s to the total variation (3.5) of M f to prove, as

        0.0
         desired, that

        0.142857142857
         Var(M f )  2C

        0.0
         (3.9)

        0.176470588235
         If furthermore ai  ai1  2 for all i  Z, the constant C = 4

        0.0
         C = 1 + 1

        0.0
         5 + 1

        0.0714285714286
         7  1

        0.0
         9 .

        0.0714285714286
         3 may be replaced by

        0.0
         Proof. It is sucient to prove the result for n = 0 since we can shift any sequence

        0.0
         ai 7 ai + n. For n = 0 we aim to prove that

        0.0
         S =

        0.0
         Xi=

        0.0
         1

        0.0
         2|ai| + 1

        0.0714285714286
         

        0.142857142857
         2(|ai| + (ai  ai1)) + 1  C .

        0.0
         1

        0.0
         (3.10)

        0.111111111111
         By shifting the indices we can also assume that a1  0  a0. We divide our sum

        0.0
         (3.10) into two parts

        0.0
         S =

        0.0
         1Xi=

        0.0
         1

        0.0
         2ai + 1

        0.0714285714286
         

        0.0
         1

        0.0
         2ai1 + 1 +

        0.0
         Xi=0 1

        0.0
         2ai + 1

        0.0714285714286
         

        0.0714285714286
         2(ai + (ai  ai1)) + 1

        0.0
         1

        0.0
         = S1 + S2.

        0.0714285714286
         Lemma 4. Given n  Z, for any strictly increasing sequence {ai}iZ of integers,

        0.0714285714286
         f (n) = 2C kf k1(Z).

        0.0
         Xn=

        0.214285714286
         2(|n  ai| + (ai  ai1)) + 1 

        0.0
         1

        0.0
         4

        0.0
         3

        0.0
         .

        0.0
         Xi=

        0.0
         1

        0.0714285714286
         2|n  ai| + 1

        0.0714285714286
         

        0.0
         DISCRETE TANAKAS THEOREM

        0.0
         9

        0.0714285714286
         The rst sum S1 is a telescoping sum and we nd that

        0.0714285714286
         S1 

        0.0
         1

        0.0
         2a1 + 1

        0.0
         .

        0.0666666666667
         (This continues to hold if the sequence terminates to the left as i  .)

        0.0
         The second sum is more involved and we use the following inequality, for integers

        0.142857142857
         m  n  0:

        0.0
         1

        0.0
         2m + 1

        0.0714285714286
         

        0.0
         1

        0.0714285714286
         2(m + (m  n)) + 1

        0.0714285714286
         

        0.0
         1

        0.0
         2(n + 1) + 1

        0.0714285714286
         

        0.0
         1

        0.0
         2(m + 1) + 1

        0.0
         .

        0.0
         (3.11)

        0.0714285714286
         Inequality (3.11) can be proved simply by clearing denominators and observing that

        0.0714285714286
         m  n + 1. We then use (3.11) to bound S2 as follows:

        0.0
         S2 =

        0.0714285714286
         

        0.0714285714286
         

        0.0
         1

        0.0
         2a0 + 1

        0.0
         1

        0.0
         2a0 + 1

        0.0
         1

        0.0
         2a0 + 1

        0.0714285714286
         

        0.0714285714286
         

        0.0714285714286
         

        0.0
         1

        0.0714285714286
         2(a0 + (a0  a1)) + 1 +

        0.0714285714286
         2(a0 + (a0  a1)) + 1 +

        0.0714285714286
         2(a0 + (a0  a1)) + 1 +

        0.0
         1

        0.0
         1

        0.0714285714286
         

        0.0
         2ai + 1

        0.0
         Xi=1 1

        0.0
         Xi=1

        0.0
         1

        0.0
         2(ai1 + 1) + 1

        0.0
         1

        0.0714285714286
         2(ai + (ai  ai1)) + 1

        0.0
         2(ai + 1) + 1

        0.0714285714286
         

        0.0
         1

        0.0
         1

        0.0
         2(a0 + 1) + 1

        0.0
         .

        0.0588235294118
         (This also continues to hold if the sequence terminates to the right as i  .) We

        0.0
         have thus arrived at

        0.0
         S = S1 + S2

        0.0714285714286
         

        0.0
         1

        0.0
         2a1 + 1

        0.0
         + 1

        0.0
         2a0 + 1

        0.0714285714286
         

        0.0714285714286
         2(a0 + (a0  a1)) + 1 +

        0.0
         1

        0.0
         1

        0.0
         2(a0 + 1) + 1

        0.0
         (3.12)

        0.0
         .

        0.142857142857
         Recall that here a1  0  a0 are integers. For any 0  a0 it is easy to see that

        0.133333333333
         (3.12) is maximized when a1 = 0. Then a simple analysis of cases yields that

        0.0
         a0 = 1 is the maximal choice, proving that (3.12) is bounded by

        0.0
         C = 1 +

        0.0
         1

        0.0
         3

        0.0
         =

        0.0
         4

        0.0
         3

        0.0
         .

        0.111111111111
         If we impose the condition a0  a1  2, again we can easily see that the maximum

        0.0588235294118
         of (3.12) occurs when a1 = 1 or 0. An analysis of a few cases conrms that

        0.0
         (3.12) is maximized when a1 = 0 and a0 = 2, giving the upper bound

        0.0
         1

        0.0
         7

        0.0
         and this nishes the proof of the lemma.

        0.0
         C = 1 +

        0.0
         1

        0.0
         5

        0.0
         +

        0.0714285714286
         

        0.0
         1

        0.0
         9

        0.0
         = 1 +

        0.0
         73

        0.0
         315

        0.0
         ,

        0.0
         (3.13)

        0.0714285714286
         

        0.0714285714286
         Observe that in the setting of our maximal operator, we have the condition

        0.315789473684
         ai  ai1  2 for all i  Z (there must be a local minimum between any two

        0.0
         consecutive local maxima), and thus we can use Lemma 4 with constant C given

        0.0714285714286
         by (3.13) in expression (3.9) to conclude that

        0.142857142857
         Var(M f )  21 +

        0.0
         73

        0.0
         315 kf k1(Z).

        0.0
         10

        0.0
         BOBER, CARNEIRO, HUGHES, AND PIERCE

        0.0
         Acknowledgments

        0.0
         The authors would like to thank Jerey Vaaler, Jean Bourgain, Diego Moreira

        0.0
         and Dimitris Koukoulopoulos for helpful comments during the preparation of this

        0.0
         work. J. Bober, E. Carneiro and L. B. Pierce acknowledge support from the Insti-

        0.0
         tute for Advanced Study and the National Science Foundation under agreement No.

        0.0
         DMS-0635607. E. Carneiro also acknowledges support from CAPES/FULBRIGHT

        0.0
         grant BEX 1710-04-4. L. B. Pierce is also funded by the Simonyi Fund and National

        0.0
         Science Foundation grant DMS-0902658.

        0.0
         Remarks

        0.0
         Our previous version of this manuscript (arXiv:1005.3030v3), which happens to

        0.0714285714286
         be the published version [Proc. Amer. Math. Soc. 140 (2012), 1669-1680], had an

        0.0714285714286
         oversight in the proof of Lemma 3 (iii), when we claimed that

        0.0625
         which is not true. The previous proof of Lemma 3 (iii), and hence of Theorem 1,

        0.0
         was correct for the slightly dierent discrete non-centered maximal operator

        0.0
         r,sZ+

        0.0
         (3.14)

        0.0
         |f (n + k)|!) ,

        0.142857142857
         fM f (n) = max{MLf (n), MRf (n)}, n  Z,

        0.0
         (r + s + rs)( k=1Xk=r

        0.0
         |f (n + k)|! + rs|f (n)| + k=sXk=1

        0.0
         1

        0.0714285714286
         where rs = 1 if rs  0 and rs = 1

        0.0
         interval that has n as an endpoint, we consider is contribution with weight 1

        0.0714285714286
         ffM f (n) = sup

        0.0
         have now briey adjusted our proof to address our original claim for the operatorfM .

        0.0714285714286
         In fact, Lemma 3 (and Theorem 1) hold for other variants of non-centered discrete

        0.0714285714286
         maximal operators (e.g. placing weight 1/2 in one or both endpoints of the interval,

        0.0
         considering only intervals with an odd number of integer points, considering lateral

        0.0
         operators, etc.). The strategy of the proof is the same, with minor adjustments.

        0.142857142857
         The oversight in Lemma 3 (iii) in our previous version was observed independently

        0.0
         by Dariusz Kosz and Matt Rosenzweig, to whom we are thankful.

        0.0
         2 if rs = 0 (i.e. when we take an average over an

        0.0
         2 ). We

        0.0
         References

        0.0
         1. J. M. Aldaz and J. Perez Lazaro, Functions of bounded variation, the derivative of the one

        0.0
         dimensional maximal function, and applications to inequalities, Trans. Amer. Math. Soc. 359

        0.0
         (2007), no. 5, 24432461.

        0.0625
         2. J. Bourgain, On the maximal ergodic theorem for certain subsets of the integers, Israel J.

        0.0
         Math. 61 (1988) 3972.

        0.0
         3. J. Bourgain, On the pointwise ergodic theorem on Lp for arithmetic sets, Israel J. Math. 61

        0.0
         (1988) 7384.

        0.0
         4. E. Carneiro and D. Moreira, On the regularity of maximal operators, Proc. Amer. Math. Soc.

        0.0
         136 (2008), no. 12, 43954404.

        0.0
         5. P. Haj lasz and J. Maly, On approximate dierentiability of the maximal function, Proc. Amer.

        0.0
         Math. Soc., to appear.

        0.0625
         6. P. Haj lasz and J. Onninen, On boundedness of maximal functions in Sobolev spaces, Ann.

        0.0
         Acad. Sci. Fenn. Math. 29 (2004), no. 1, 167176.

        0.0
         7. A. D. Ionescu and A. Magyar and E. M. Stein and S. Wainger, Discrete Radon transforms

        0.0
         and applications to ergodic theory, Acta Math. 198 (2007) 231-298.

        0.0
         8. A. D. Ionescu and S. Wainger, Lp boundedness of discrete singular Radon transforms, J.

        0.0
         Amer. Math. Soc. 19 (2005) no. 2, 357383.

        0.142857142857
         9. J. Kinnunen, The Hardy-Littlewood maximal function of a Sobolev function, Israel J. Math.

        0.0
         100 (1997), 117124.

        0.0
         DISCRETE TANAKAS THEOREM

        0.0
         11

        0.0
         10. J. Kinnunen and P. Lindqvist, The derivative of the maximal function, J. Reine Angew. Math.

        0.0
         503 (1998), 161167.

        0.0
         11. J. Kinnunen and E. Saksman, Regularity of the fractional maximal function, Bull. London

        0.0
         Math. Soc. 35 (2003), no. 4, 529535.

        0.0625
         12. H. Luiro, Continuity of the maximal operator in Sobolev spaces, Proc. Amer. Math. Soc. 135

        0.0
         (2007), no. 1, 243251.

        0.0625
         13. A. Magyar and E. M. Stein and S. Wainger, Discrete analogues in harmonic analysis: Spherical

        0.0
         averages, Ann. Math. 155 (2002) 189208.

        0.0
         14. L. B. Pierce, Discrete fractional Radon transforms and quadratic forms, preprint.

        0.0
         15. E. M. Stein, Harmonic Analysis: Real Variable Methods, Orthogonality, and Oscillatory In-

        0.0
         tegrals, Princeton University Press 1993.

        0.0588235294118
         16. E. M. Stein and S. Wainger, Discrete analogues in harmonic analysis I: 2 estimates for singular

        0.0
         Radon transforms, Amer. J. Math. 121 (1999), 12911336.

        0.0666666666667
         17. E. M. Stein and S. Wainger, Discrete analogues in harmonic analysis II: Fractional integration,

        0.0
         J. dAnalyse Math. 80 (2000) 335355.

        0.0
         18. E. M. Stein and S. Wainger, Two discrete fractional integral operators revisited, J. dAnalyse

        0.0
         Math. 87 (2002) 451479.

        0.0
         19. H. Tanaka, A remark on the derivative of the one-dimensional Hardy-Littlewood maximal

        0.0
         function, Bull. Austral. Math. Soc. 65 (2002), no. 2, 253258.

        0.0
         School of Mathematics, Institute for Advanced Study, Einstein Drive, Princeton,

        0.0
         NJ, 08540.

        0.0
         E-mail address: bober@math.ias.edu

        0.0
         School of Mathematics, Institute for Advanced Study, Einstein Drive, Princeton,

        0.0
         NJ, 08540.

        0.0
         E-mail address: ecarneiro@math.ias.edu

        0.0
         Department of Mathematics, Princeton University, Fine Hall, Washington Road,

        0.0
         Princeton, NJ, 08544

        0.0
         E-mail address: kjhughes@math.princeton.edu

        0.0
         School of Mathematics, Institute for Advanced Study, Einstein Drive, Princeton,

        0.0
         NJ, 08540.

        0.0
         E-mail address: lbpierce@math.ias.edu

1005.3030_xml.xml
1 of papers did not succeed in matching
0 of papers succeeded in matching
