BEGIN Conjecture 1.1  
 \label {MC} Let $F$ be a non-archimedean local field of characteristic zero, $G$ a reductive group over $F$ and $H$ its endoscopic group. Let $\mathfrak {g}$ and $\mathfrak {h}$ be the Lie algebras of $G$ and $H$. \par $\mathbf {1}$. For any $f \in C_c^\infty (\mathfrak {g})$, there exists a transfer $f^H \in C_c^\infty (\mathfrak {h})$. \par $\mathbf {2}$. Take compatible Fourier transforms $\mathcal {F}_G$ and $\mathcal {F}_H$ on $\mathfrak {g}$ and $\mathfrak {h}$. There exists a constant $c$ such that whenever $f^H$ is a transfer of $f $, then $\mathcal {F}_H(f^H)$ is a transfer of $c\mathcal {F}_G(f)$. \par 
END Conjecture
 
BEGIN Theorem 1.2  
 \label {XY} Choose matching orbits \textup {(}$\gamma ,v, v^*$\textup {)} and \textup {(}$\delta ,w$\textup {)}. We have the following identity between nilpotent orbit integrals \begin {equation} \omega (\gamma ,v, v^*) \textup {Orb}(f,(\gamma ,v_{\Lambda },v^*_{S_1 \backslash \Lambda }))= \sum _x \langle \Lambda ,x \rangle \int _{\textup {U}(W_x)/T_{\delta _x}}f_W(g\delta _x g^{-1},0)d\overline {g}. \end {equation}
END Theorem
 
BEGIN Acknowledgement 1  
 \textup {I would like to express my great gratitude to my advisor Wei Zhang, for suggesting this problem to me and providing marvelous insights. I also want to thank Professor Herv\'e Jacquet for helpful discussions when preparing this paper.} \par 
END Acknowledgement
 
BEGIN Lemma 2.1  
 The inner integral over $T_1$ in \textup {(\ref {converge})} converges when \textup {Re($s$)} $> 0$ and admits meromorphic continuation to the whole complex plane which at holomorphic at $0$. Its value at $0$ is well defined as a locally constant and compactly supported function on $\textup {GL($V$)}/T$.
END Lemma
 
BEGIN Proof 
 In general, given a compactly supported function $f$ on a local field $F$ and $\chi $ a unitary character of $F^\times $, the integral $$\int _{F^\times } f(t)|t|^s\chi (t)dt^\times $$ converge for Re($s$) $> 0$ and admits a meromorphic continuation to the whole complex plane. When $\chi $ is nontrivial, the meromorphic continuation is holomorphic at $0$. \par Now to prove the lemma, it suffices to write $f$ in (\ref {converge}) as a product of functions, then the meromorphic continuation and being holomorphic at $0$ are reduced to the above statement. \par If we change $g$ to $gt_0$. The vaule of the inner integral in (\ref {converge}) after evaluating at s=0 does not change. So its a well defined function on $\textup {GL$(V)$}/T$. Now since $x$ is regular semisimple, it is easy to check this function is locally constant and compactly supported. \par 
END Proof
 
BEGIN Theorem 2.2  
 [Existence of Transfers] \label {JR exist} For any $f \in C_c^\infty (\mathfrak {gl}(V)\times V\times V^*)$, there exists a transfer $\{f_0,f_1\}$. Conversely, for any pair $\{f_0,f_1\}$, there exists a transfer $f$. \par 
END Theorem
 
BEGIN Theorem 2.3  
 [Fourier Transform] \label {JR commute} \par Let $n=\textup {dim}V=\textup {dim}W$. There exists a constant $c$ independent of the matching functions, such that if $f$ and $\{f_0,f_1\}$ are transfers, then $c\mathcal {F}_1(f)$ and $\{\mathcal {F}_1(f_0),(-1)^{n-1}\mathcal {F}_1(f_1)\}$ are transfers. \par 
END Theorem
 
BEGIN Proof 
 [Proof of theorem $\ref {JR exist}$ and theorem $\ref {JR commute}$] Both theorem \ref {JR exist} and theorem \ref {JR commute} are proved in \cite {Wei1}. We remark that both proofs are local and do not rely on the fundamental lemma. However, the factor $(-1)^{n-1}$ in theorem \ref {JR commute} is missed in \cite {Wei1}. We shall explain now why there is a $(-1)^{n-1}$ factor. We shall use freely the notation in section 4 of \cite {Wei1}. \par The theorem we cite here is the $B_n$ part of theorem 4.17 in \cite {Wei1}. It is proved along with the $A_n$ part and $C_n$ part by induction. For each $C_n$, there is a $-1$ missing, which by induction, gives $(-1)^{n-1}$ for the $B_n$. The $-1$ is missing from $C_n$ because of the equation (4.30) in \cite {Wei1}. It claims \par $$\kappa ^\eta (w,w^\prime )=\lambda \kappa (w_i,w_i^\prime ).$$ \par This is proved by reducing it to the identity of Kloosterman sums (theorem 4.12 \cite {Wei1}). However, in this reduction, different $W_i$ gives a $\pm 1$. The correct version is \par $$\kappa ^\eta (w,w^\prime )=\pm \lambda \kappa (w_i,w_i^\prime ).$$ where one finds $+1$ if $i=0$ and $-1$ if $i=1$. \par \par \par 
END Proof
 
BEGIN Conjecture 2.4  
 [Fundamental Lemma] \label {Fundamental} When $p$ is odd, $1_{\mathfrak {k}}$ and $\{1_{\mathfrak {k}_0},0\}$ are transfers.
END Conjecture
 
BEGIN Remark 2.3  
 The conjecture is known when $p$ is large enough. This is proved in \cite {Yun} by Z. Yun in the positive characteristic case, extended to characteristic zero by J. Gordon in the appendix to \cite {Yun}. It is not known for small $p$.
END Remark
 
BEGIN Definition 3.1  
 An endoscopic triple of $G$ is a triple $(H,s,\eta )$. Here H is a quasi-split group over F, $s$ is a regular semisimple element in $\widehat {G}$, and $\eta $ is an embedding of the complex algebraic groups: $\widehat {H} \hookrightarrow \widehat {G}$. The triple has to satisfy the following conditions$:$ \begin {itemize} \item $\eta (\widehat {H})$ is the identity component of the centralizer of $s$ in $\widehat {G}$. \item The conjugacy class of $\eta $ is Galois equivariant. \item $\eta ^{-1}(s)$ is fixed by the Galois action on $\widehat {H}$. \end {itemize}
END Definition
 
BEGIN Remark 3.1  
 It is easy to see that the matching between embeddings to maximal F-tori and regular semisimple elements is a matching between stable conjugacy classes in $G$ and $H$. Let $G^*$ be the quasi split inner form of $G$. Every embedding $T \hookrightarrow H$ has a matching $T \hookrightarrow G^*$. This is not true for $G$. An element $x^H \in \mathfrak {h}(F)^{r.s.}$ is $G^*$-regular semisimple if it matches a regular semisimple element $x^*$ in $\mathfrak {g^*}(F)$.
END Remark
 
BEGIN Definition 3.2  
 Let $f^H \in C^{\infty }_c(\mathfrak {h}(F))$ and $f \in C^{\infty }_c(\mathfrak {g}(F))$. Then $f^H$ and $f$ match if the following conditions are satisfied (see below for definitions of these terms)$:$ \par \textup {1)} For any matching orbits $x^H \in \mathfrak {h}(F)^{G^*-r.s.}$ and $x \in \mathfrak {g}(F)^{r.s.}$, we have the identity: \begin {equation} \label {endos} \textup {Orb}^{\textup {St}}(f^H,x^H)=\Delta (x^H,x)\textup {Orb}^\kappa (f,x). \end {equation} \par \textup {2)} If there does not exist $x \in \mathfrak {g}(F)^{r.s.}$ that matches $x^H \in \mathfrak {h}(F)^{G^*-r.s.}$, then \begin {equation} \label {more} \textup {Orb}^{\textup {St}}(f^H,x^H)=0. \end {equation}
END Definition
 
BEGIN Theorem 3.3  
 [Tate-Nakayama Isomorphism \cite {Serre}] Let F be a non-archimedean local field and T a F-torus. Then the Galois cohomology group $H^1(F,T)$ is canonically isomorphic to the quotient of $$\{x \in X_*(T) | \textup {tr}(x)=0\}$$ by its subgroup generated by $$\{\sigma x-x| \sigma \in \textup {Gal}(\overline {F}/F), x \in X_*(T)\}.$$
END Theorem
 
BEGIN Theorem 3.4  
 [Existence of Transfers] \label {LS exist} For any $f \in C_c^\infty (\mathfrak {g})$, there exists $f_1 \in C_c^\infty (\mathfrak {h})$ matches $f$.
END Theorem
 
BEGIN Theorem 3.5  
 [Fourier Transform] \label {LS commute} There exists a constant $c$ independent of the matching functions, such that if $f \in C_c^\infty (\mathfrak {g})$ and $f_1 \in C_c^\infty (\mathfrak {h})$ match, then c$\mathcal {F}(f)$ and $\mathcal {F}(f_1)$ also match.
END Theorem
 
BEGIN Remark 3.1  
 The constant $c$ are given explicitly in \cite {Wa2}. It equals the quotient of the Weil indexes of $\mathfrak {h}$ and $\mathfrak {g}$. We will come back to this in section $\ref {JJ}$.
END Remark
 
BEGIN Proof 
 [Proof of theorem $\ref {LS exist}$ and theorem $\ref {LS commute}$] Both theorem \ref {LS exist} and theorem \ref {LS commute} are deduced in \cite {Wa2} from the fundamental lemma. In our paper, for the case of unitary groups, we are going to deduce theorem \ref {LS exist} (resp. theorem \ref {LS commute}) from theorem \ref {JR exist} (resp. theorem \ref {JR commute}).
END Proof
 
BEGIN Proposition 3.6  
 The centralizer $T_\delta $ of $\delta $ in $\textup {U}(W)$ equals \textup {U}$(1)(E[\delta ]^\times /F[\delta ]^\times )$. We have $H^1(F, T_\delta )=\prod _{S_1}\mathbb {Z}/2\mathbb {Z}$. And the conjugacy class in the stable conjugacy class of $\delta $ is canonically a torsor of $$\textup {ker}(H^1(F, T_\delta ) \rightarrow H^1(F,\textup {U}(W)))= \textup {ker}\left (\prod _{S_1}\mathbb {Z}/2\mathbb {Z} \rightarrow \mathbb {Z}/2\mathbb {Z}\right )$$ where all the map from $\mathbb {Z}/2\mathbb {Z}$ to $\mathbb {Z}/2\mathbb {Z}$ are identity.
END Proposition
 
BEGIN Proof 
 \par For any $\alpha \in E[\delta ]$, let $\overline {\alpha }$ be the conjugation of $\alpha $ by the unique nontrivial automorphism for the extension $E[\delta ]/F[\delta ]$. The identities $\langle \delta w_1,w_2 \rangle =\langle w_1,\delta w_2 \rangle $ and $\langle cw_1,w_2 \rangle =\langle w_1,\overline {c}w_2 \rangle $ ($c \in E$) together imply that for any $\alpha \in E[\delta ]$, $ \langle \alpha w_1, w_2 \rangle = \langle w_1,\overline {\alpha }w_2 \rangle $. \par Since Centralizer of $\delta $ in $\textup {GL}(W)$ equals $E[\delta ]^\times $, centralizer of $\delta $ in $\textup {U}(W)$ equals $\{\alpha \in E[\delta ]^\times | \langle \alpha w_1, \alpha w_2 \rangle = \langle w_1,w_2 \rangle \}$. But $\langle \alpha w_1, \alpha w_2 \rangle =\langle \overline {\alpha } \alpha w_1, w_2 \rangle $. Hence the centralizer equals U$(1)(E[\delta ]^\times /F[\delta ]^\times )$. \par Now, a simple computation shows $H^1(F,\textup {U}(1)(E_i/F_i))$ is trivial if $F_i \supseteq E$ and equals $\mathbb {Z}/2\mathbb {Z}$ if $F_i \nsupseteq E$. Therefore $H^1(F, T_\delta )=\prod _{S_1}\mathbb {Z}/2\mathbb {Z}$. The rest of the proposition follows from standard results on stable conjugacy. \par 
END Proof
 
BEGIN Proposition 3.7  
 Let $m=1$. When $F_1 \supseteq E$, then \textup {dim}$W$ is even and $S$ is a single point belongs to the split Hermitian space. When $F_1 \nsupseteq E$, then $S$ consists of two points, with one point for each Hermitian space.
END Proposition
 
BEGIN Proof 
 Let $E_1=E \bigotimes _F F_1$. To find whether S contains element in $\mathfrak {u}(W_i)$, we need to compute the determinant of any Hermitian structure on $E_1$ such that $\delta \in \mathfrak {u}(E_1)$. Given such an Hermitian form $\langle \ , \ \rangle $ and using $\delta \in \mathfrak {u}(E_1)$, we find $\langle x , y \rangle =\text {tr}_{E_1/E}(ax\overline {y})$ for some $a \in F_1^\times $. If $a_1$ and $a_2$ differ by multiplication of elements in Nm($E_1^\times /F_1^\times $), then the Hermitian space are isomorphic. So we only need to consider $a \in F_1^\times /\text {Nm}(E_1^\times /F_1^\times )$. \par When $F_1 \supseteq E$, then $F_1^\times /\text {Nm}(E_1^\times /F_1^\times )=\{1\}$ and the Hermitian space is unique. It has to be the split one since only the quasi-split unitary Lie algebras contain elements that are not Jacquet-Langlands transfer from its non-trivial inner form. This can also be verified directly. \par When $F_1 \nsupseteq E$, then $F_1^\times /\text {Nm}(E_1^\times /F_1^\times )=\mathbb {Z}/2\mathbb {Z}$. The determinant of $\text {tr}_{E_1/E}(ax\overline {y})$ equals Nm$_{F_1/F}(a)$ times a constant. By class field theory, this surjects to $F^\times /\text {Nm}_{E/F}(E^\times )$. We conclude that both Hermitian spaces occur. \par Finally, the fact that $S$ intersects with each $\mathfrak {u}(W_i)$ with at most one point follows from the computation of the conjugacy class in a fixed Lie algebras as $m=1$. \par 
END Proof
 
BEGIN Proposition 3.8  
 \label {bijection} \par There is a natural isomorphism $S \rightarrow \prod _{S_1}\mathbb {Z}/2\mathbb {Z}$. It defines $S$ as a torsor over $H^1(F,T)$ which extends the classical torsor structure over $ker(H^1(F,T) \rightarrow H^1(F,U(W))$. \par 
END Proposition
 
BEGIN Proof 
 \par The map is defined in the following way. Let $\delta \in S$ belongs to $\mathfrak {u}(W)$. As usual, $F[\delta ]=\prod F_i, E_i=E \bigotimes _F F_i$ and $W=\bigoplus W_i$, where $W_i=E_iW$. Since $\delta $ is regular semisimple and $\delta \in \mathfrak {u}(W)$, these $W_i$ are orthogonal to each other. By the $m=1$ case, the Hermitian form on $W_i$ is unique if $F_i \supseteq E$ and there are two possible choices if $F_i \nsupseteq E$. Therefore the type of these $W_i$ defines a map $S \rightarrow \prod _{S_1}\mathbb {Z}/2\mathbb {Z}$. Here, we normalize so that the split Hermitian space maps to 0. \par The map $S \rightarrow \prod _{S_1}\mathbb {Z}/2\mathbb {Z}$ admits a section. Indeed, for any element in $\mathbb {Z}/2\mathbb {Z}$, we may construct a Hermitian space $W_i$ as in the $m=1$ case. Then $W=\bigoplus W_i$ is a Hermitian space such that $F[\delta ] \subset \mathfrak {u}(W)$. The space $W$ is isomorphic to one of the Hermitian spaces of dimension $n$. And any such isomorphism defines an element in $S$ that is independent of the isomorphism we take. This implies the map $S \rightarrow \prod _{S_1}\mathbb {Z}/2\mathbb {Z}$ is surjective. And by counting numbers, we find it is an isomorphism. It also implies that $S$ contains elements of both Hermitian spaces except when $S_1=\emptyset $. \par This defines $S$ as a torsor over $H^1(F,T)$. Notice that $\delta _1$ and $\delta _2 \in S$ are in the same Hermitian space exactly when the corresponding $W_i$ differs at even number of places. Now it is almost trivial to check the torsor structure agrees with the classical one.
END Proof
 
BEGIN Definition 3.9  
 Let $\rho $ denote the map $S \rightarrow H^1(F,T)$. Given $\delta _1, \delta _2 \in S$, define $$\textup {inv}(\delta _1, \delta _2)=\rho (\delta _1)-\rho (\delta _2).$$ \par 
END Definition
 
BEGIN Proposition 3.10  
 \label {definition of kappa} The character $\kappa $ of $H^1(F,T_\delta )$ is defined as follows: on each copy of $\mathbb {Z}/2\mathbb {Z}$ corresponding to $S_1(\delta _1)$, $\kappa $ is the trivial map. On each copy of $\mathbb {Z}/2\mathbb {Z}$ corresponding to $S_1(\delta _2)$, $\kappa $ is the unique nontrivial map.
END Proposition
 
BEGIN Definition 3.11  
 \label {nice} We define elements $\delta $ and \textup {(}$\delta _1,\delta _2$\textup {)} are nice matching elements if they arise in the way described above.
END Definition
 
BEGIN Theorem 3.12  
 \label {JL exist} For any $f_1 \in C_c^\infty (\mathfrak {u}(W_1))$, there exists a transfer $f_0 \in C_c^\infty (\mathfrak {u}(W_0))$.
END Theorem
 
BEGIN Theorem 3.13  
 \label {JL commute} Let $f_i \in C_c^\infty (\mathfrak {u}(W_i))$. There exists a constant $c$ independent of the matching functions, such that if $f_0$ and $f_1$ match, then $\mathcal {F}(f_0)$ and c$\mathcal {F}(f_1)$ also match.
END Theorem
 
BEGIN Proof 
 [Proof of theorem \ref {JL exist} and theorem \ref {JL commute}] Both theorem \ref {JL exist} and theorem \ref {JL commute} are proved in \cite {Wa2} (theorem 1.5 in \cite {Wa2}). Since the fundamental lemmas between inner forms are trivial, the proof in \cite {Wa2} applies without any assumption.
END Proof
 
BEGIN Definition 3.14  
 [Weil index] Let $F$ be a non-archimedean local field of characteristic zero and $V$ a vector space of dimension $n$ over $F$ equipped with a quadratic form $q: V \rightarrow F$. Fix an additive character $\psi : F \rightarrow \mathbb {C}^\times $. Let $f_q$ be the function $\psi \circ q$ and $\mathcal {F}$ the Fourier transform defined by $\psi $. There exists a constant $\gamma _q(\psi )$, called Weil index, such that for all $f \in C_c^\infty (V)$, the following identity is true: $$\mathcal {F}(f_q)=\gamma _q(\psi )f_{-q}.$$
END Definition
 
BEGIN Proposition 3.15  
 The constant $c$ in theorem $\ref {LS commute}$ equals $\frac {\gamma _{q_G}(\psi )}{\gamma _{q_H}(\psi )}$. Here $q_G$ and $q_H$ are quadratic forms on $\mathfrak {g}$ and $\mathfrak {h}$ that match each other.
END Proposition
 
BEGIN Proposition 3.16  
 \label {E1} The constant $c$ in theorem $\ref {JL commute}$ equals $(-1)^{n-1}$.
END Proposition
 
BEGIN Proof 
 We only treat the case when $n=2$. The general case is $n-1$ copy of the $n=2$ case plus a common part in $\mathfrak {u}(W_0)$ and $\mathfrak {u}(W_1)$. Consider the $2$ dimensional Hermitian space $W$ for $E/F$ with Hermitian matrix diag$\{1,\lambda \}$. Choose the non-degenerate quadratic form as $q_W=$tr($X^2$). A basis of $\mathfrak {u}(W)$ is given by \par $$ \begin {pmatrix} 1 & 0 \\ 0 & 0 \end {pmatrix}, \begin {pmatrix} 0 & \lambda \\ 1 & 0 \end {pmatrix}, \begin {pmatrix} 0 & -\varepsilon \lambda \\ \varepsilon & 0 \end {pmatrix}, \begin {pmatrix} 0 & 0 \\ 0 & 1 \end {pmatrix}$$ where $\varepsilon ^2=x \in F$. \par Let $q_a$ denote the quadratic form on $F$ of the form $ax^2$, then this basis defines $q_W \cong q_1 \bigoplus q_{2\lambda } \bigoplus q_{-\varepsilon \lambda } \bigoplus q_1$. Let $\gamma _a=\gamma _{q_a}(\psi )$, then $\gamma _{q_W}=\gamma _1^2\gamma _{2\lambda } \gamma _{-2\varepsilon \lambda }$ since Weil index commutes with direct sum. Suppose $\gamma _{q_W}$ is independent of $\lambda $, this implies: \begin {equation} \label {A1} \gamma _{a}\gamma _{-xa}=\gamma _1\gamma _{-x} \end {equation} where $a \in F^\times $ and is not a norm from $E^\times $. We have the following properties of Weil index: $$\gamma _{-a}=\gamma _{a}^{-1},$$ $$\gamma _a\gamma _b=\gamma _1\gamma _{ab}(a,b)_F$$ where $(a,b)_F$ is the Hilbert symbol. \par Using $(a,x)_F=-1$ and the above two identities, one show (\ref {A1}) is only correct if we multiple one side by $-1$. This means $c=-1$. \par \par 
END Proof
 
BEGIN Lemma 4.1  
 [Germ Expansions for Tori] \label {main} Let $f \in C_c^\infty (A\times A)$ and consider the following integral $$\textup {Orb}(f,\varepsilon )=\int _T f(t, \varepsilon t^{-1})\chi (t)dt.$$ \par When $\varepsilon \in T$ is close enough to 0 (as an element in $A$), the above integral equals: \par $$\sum _{\Lambda _2 \subseteq S_2}(-1)^{|S_2 \backslash \Lambda _2|} c_{\Lambda _2}(f) \log _q(|\varepsilon |_{S_2 \backslash \Lambda _2})$$ where $c_{\Lambda _2}(f)$ is independent of $\varepsilon _{S_2}$ and \par $$c_\emptyset (f)=\sum _{\Lambda _1 \subseteq S_1} \int _{T_{S_1}} f(t_{\Lambda _1},(t^{-1})_{S_1 \backslash \Lambda _1}) \chi (t) \prod _{i \in S_1\backslash \Lambda _1} \chi (\varepsilon _i) dt .$$ \par The integral in $c_\emptyset $ is defined by analytic continuation. \par \par \par \par 
END Lemma
 
BEGIN Proof 
 \par Both sides are linear in $f$, so we can assume $f=\prod f_i$ with $f_i \in C_c^\infty (F_i \times F_i)$. Using this $f$ to substitute reduces the question to the case when $m=1$. So we can assume $m=1$. \par Now distinguish two cases. In the first case, $F_i \supseteq E$, so $\chi $ is trivial, we want to prove: $$\int _{F_i^\times }f(t,\varepsilon t^{-1})=c-f(0,0)\log _q|\varepsilon |.$$ \par Here $c$ is independent of $\varepsilon $ and in fact \par $$c=\bigg (\int _{F_i^\times }f(t,0)|t|^s+\int _{F_i^\times }f(0,t^{-1})|t|^s\bigg )\bigg \rvert _{s=0}.$$ \par The integrals $\int _{F_i^\times }f(t,0)|t|^s$ and $\int _{F_i^\times }f(0,t^{-1})|t|^s$ are understood as their analytic continuations. Both integrals have a simple pole at $0$ with residues that are negative of each other, so there sum is holomorphic at $0$. \par \par To prove the identity, notice that the identity is linear in $f$. If $f(x,0) \equiv 0$ or $f(0,y) \equiv 0$ or $f=1_{O_F \times O_F}$, the identity is easily verified. Now the identity follows because $C_c^\infty (A \times A)$ is generated by those three kinds of functions. \par For the other case, when $F_i \nsupseteq E$, we want to prove: \par $$\int _{F_i^\times }f(t,\varepsilon t^{-1})\chi (t)=\int _{F_i^\times }f(t,0)\chi (t)|t|^s\bigg \rvert _{s=0}+\int _{F_i^\times }f(0,\varepsilon t^{-1})\chi (t)|t|^{-s}\bigg \rvert _{s=0}.$$ \par In this case both integrals converge for Re$(s) > 0$, extends to a meromorphic function on the whole complex plane and is holomorphic at $0$. The identity can be proved in the same way as in the previous case. \par \par 
END Proof
 
BEGIN Proposition 4.2  
 [Germ Expansions] \par When $\varepsilon $ is close enough to $0$ \textup {(}depending on $f$\textup {)}$:$ \par $$\textup {Orb}(f,(\gamma ,v,v^*\varepsilon ))=\sum _{\Lambda _2 \subseteq S_2}(-1)^{|S_2 \backslash \Lambda _2|} c_{\Lambda _2}(f) \textup {log}_q(|\varepsilon |_{S_2 \backslash \Lambda _2})$$ with $c_{\Lambda _2}(f)$ independent of $\varepsilon _{S_2}$ and \par $$c_\emptyset (f)=\sum _{\Lambda _1 \subseteq S_1} \textup {Orb}(f,(\gamma ,v_{\Lambda _1},v_{S_1 \backslash \Lambda _1}^*))\prod _{S_1 \backslash \Lambda _1}\chi (\varepsilon _i).$$ \par In the definition of $c_\emptyset (f)$, we use ``nilpotent orbit integrals'' that are defined in \textup {(\ref {converge})}.
END Proposition
 
BEGIN Proof 
 \par $ \textup {Orb}(f,(\gamma ,v,v^*\varepsilon ))$ equals $$\int _{\textup {GL}(V)/T_\gamma } \bigg (\int _{T_\gamma }f(g\gamma g^{-1},gtv,v^*\varepsilon t^{-1}g^{-1})\chi (t)\chi (g)dt\bigg )dg$$ where we denote by $T_\gamma $ the centralizer of $\gamma $. \par For any fixed $g$, we may apply lemma \ref {main} to the function \par $$f_g(x,y) = f(g\gamma g^{-1},gxv,v^*y g^{-1}).$$ \par We claim that when $\varepsilon $ is close enough to $0$, lemma \ref {main} will work for all the $f_g$. This is because $\gamma $ is regular semisimple, the outer integral is over a compact set and the map $g \mapsto f_g$ is locally constant. \par Hence when $\varepsilon $ is small enough, lemma \ref {main} implies that the orbit integral equals \par $$\sum _{\Lambda _2 \subseteq S_2}(-1)^{|S_2 \backslash \Lambda _2|} c_{\Lambda _2}(f) \textup {log$_q$}(|\varepsilon |_{S_2 \backslash \Lambda _2}) $$ with $c_{\Lambda _2}(f)$ independent of $\varepsilon _{S_2}$ and \par \par $$ c_\emptyset (f)=\sum _{\Lambda _1 \subseteq S_1} \int _{\textup {GL}(V)/T_\gamma } \bigg (\int _{(T_\gamma )_1} f(g \gamma g^{-1}, gt_{\Lambda _1}v,v^*t^{-1}_{S_1 \backslash \Lambda _1}g^{-1})\chi (t)\chi (g)dt\bigg )d\overline {g} \prod _{S_1 \backslash \Lambda _1}\chi (\varepsilon _i).$$ \par This is exactly \par $$\sum _{\Lambda _1 \subseteq S_1} \textup {Orb}(f,(\gamma ,v_{\Lambda _1},v_{S_1 \backslash \Lambda _1}^*))\prod _{S_1 \backslash \Lambda _1}\chi (\varepsilon _i).$$ \par 
END Proof
 
BEGIN Proposition 4.3  
 [Germ Expansions] When $\varepsilon $ is close enough to $0$ \textup {(}depending on f\textup {)}$:$ $$\textup {Orb}(f,(\delta , \varepsilon w))=\sum _{\Lambda _2 \subseteq S_2}(-1)^{|S_2 \backslash \Lambda _2|} \cdot c_{\Lambda _2}(f) \log _q(|{\varepsilon }|_{S_2 \backslash \Lambda _2})$$ with $c_{\Lambda _2}(f)$ independent of $\varepsilon _{S_2}$ and \par $$c_\emptyset (f)=\int _{\textup {U}(W)/T_\delta }f(g\delta g^{-1},0)d\overline {g}.$$ \par 
END Proposition
 
BEGIN Proof 
 $\textup {Orb}(f,(\delta , \varepsilon w))$ equals \par $$\int _{\textup {U}(W)/T_\delta } \int _{T_\delta }f(g\delta g^{-1},gt\varepsilon w)dtd\overline {g}$$ where $T_\delta = \textup {U}(1)(E[\delta ]^\times /F[\delta ]^\times )$ is the centralizer of $\delta $. \par Let $\varepsilon =(\varepsilon _i) \in E[\delta ]^\times $ be close enough to $0$. When $i \in S_1$, U$(1)(E_i/F_i)$ is compact. So when $\varepsilon _i \rightarrow 0$ for $i \in S_1$, the $i$ component of $t\varepsilon w$ tends to $0$ uniformly. When $i \in S_2$, we may identify $E_i$ with $F_i \times F_i$ and let $\varepsilon _i \in E_i$ correspond to $(\varepsilon _i^{(1)},\varepsilon _i^{(2)})$ through this identification. \par Because $\delta $ is regular semisimple, the integral over $g$ is over an compact set. Recall for $t \in T$, we denote by $t_\Lambda $ the element which equals to $t$ for the components in $\Lambda $ and equals $0$ otherwise. When $\varepsilon $ is close enough to $0$, \par $$f(g\delta g^{-1},gt\varepsilon w)=f(g\delta g^{-1},g(t\varepsilon )_{S_2} w).$$ \par Therefore \begin {align*} \textup {Orb}(f_W,(\delta , \varepsilon w)) & =\int _{\textup {U}(W)/T_\delta } \int _{(T_\delta )_2}f(g\delta g^{-1},g(t\varepsilon )_{S_2} w)dtd\overline {g} \\ & =\int _{\textup {U}(W)/T_\delta } \int _{(T_\delta )_2}f(g\delta g^{-1},g(t\varepsilon _i^{(1)},t^{-1}\varepsilon _i^{(2)}) w)dtd\overline {g} \\ &=\int _{\textup {U}(W)/T_\delta } \int _{(T_\delta )_2}f(g\delta g^{-1},g(t,t^{-1}\varepsilon _i^{(1)}\varepsilon _i^{(2)}) w)dtd\overline {g}. \end {align*} \par Now, apply lemma \ref {main} to the function \par $$f_g(x,y)=f(g\delta g^{-1},g(x,y)w).$$ \par As before, we can find $\varepsilon $ very close to $0$ that works for all the $f_g$. Hence the orbit integral equals \par $$\sum _{\Lambda _2 \subseteq S_2}(-1)^{|S_2 \backslash \Lambda _2|} \cdot c_{\Lambda _2}(f) \log _q(|{\varepsilon }|_{S_2 \backslash \Lambda _2})$$ with $c_{\Lambda _2}(f)$ independent of $\varepsilon _{S_2}$ and \par $$c_{\emptyset }(f)=\int _{\textup {U}(W)/T_\delta }f(g\delta g^{-1},0)d\overline {g}.$$ \par 
END Proof
 
BEGIN Lemma 4.4  
 \label {change match} \par When $(\gamma , v, v^*)$ and $(\delta , w)$ match, choose $\varepsilon \in F[\gamma ]^\times $, $\varepsilon _1 \in E[\delta ]^\times $ with$$ \textup {Nm}_{E[\delta ]/F[\delta ]}(\varepsilon _1)=\varepsilon $$ then $(\gamma , v, v^*\varepsilon )$ and $(\delta , \varepsilon _1 w)$ also match. \par 
END Lemma
 
BEGIN Proof 
 The invariants $a_i$ are equal since they only depend on $\gamma $ and $\delta $. For the invariants $b_i$, since $(\gamma , v, v^*)$ and $(\delta , w)$ match, we have $\langle v^*\varepsilon , \gamma ^iv\rangle =\langle v^*, \gamma ^i \varepsilon v\rangle =\langle w, \delta ^i \varepsilon w \rangle =\langle w, \delta ^i \varepsilon _1\overline {\varepsilon _1}w \rangle =\langle \varepsilon _1w, \delta ^i \varepsilon _1w \rangle $. \par \par \par \par 
END Proof
 
BEGIN Lemma 4.5  
 Suppose there exists constant $c_\Lambda $ independent of $\varepsilon $ such that for all the $\varepsilon $ close enough to $0$, $$\sum _{\Lambda \subseteq S}c_\Lambda \log _q|\varepsilon |_\Lambda = 0$$ then all the $c_\Lambda $ are $0$.
END Lemma
 
BEGIN Proof 
 This easily follows by induction on $|S|$ and changing one of the $\varepsilon _i$ by its square.
END Proof
 
BEGIN Lemma 4.6  
 \label {get delta_x} We use the notation S as in proposition $\ref {bijection}$. The map $x \mapsto \delta _x$ defines an isomorphism of $H^1(F,T_x)$ torsor $$ F[\gamma ]^\times /\textup {Nm}_{E[\gamma ]/F[\gamma ]}(E[\gamma ]^\times ) \rightarrow S.$$
END Lemma
 
BEGIN Proof 
 The image lies in a single $S$ since they are all stably conjugate to $\gamma $. The map factors through the quotient since if $(\gamma ,v,v^*)$ and $(\delta ,w)$ match, then $(\gamma ,v, v^*\varepsilon )$ and $(\delta ,\varepsilon _1 w)$ also match with Nm$(\varepsilon _1)=\varepsilon $ (lemma \ref {change match}). \par Let us show the map is a bijection. Let $F[\gamma ]=\prod _{i=1}^m F_i$, $V_i=F_iV$, and $v=(v_i)$ in the decomposition $V=\bigoplus V_i$. Define $\Delta _i(\gamma ,v,v^*)$ to be $\chi ($det$(\{\langle v^*_i,\gamma ^{a+b}v_i\rangle \}_{a,b}))$. Similarly define $\Delta _i(\delta ,w)$. The invariant $\Delta _i$ are the same for matching orbits. \par Notice that ($\Delta _1(\gamma , v, v^*x),...,\Delta _m(\gamma , v, v^*x)$) $\in \{\pm 1\}^m$ is uniquely determined by $x$, and ($\Delta _1(\delta , w),...,\Delta _m(\delta , w)$) $\in \{\pm 1\}^m$ uniquely determines the isomorphism class of the Hermitian space $E_iW $, which uniquely determines elements in $S$. Therefore, the map is a bijection. \par Since $H^1(F,T_x)$ acts on $S$ by acting on the isomorphism class of $E_iW$, it is obvious that the map commutes with the $H^1(F,T_x)$ action. \par 
END Proof
 
BEGIN Theorem 4.7  
 \label {Nilpotent Identity} Using the notation in this subsection, we have \begin {equation} \label {identity} \omega (\gamma ,v, v^*) \textup {Orb}(f,(\gamma ,v_{\Lambda },v^*_{S_1 \backslash \Lambda }))= \sum _x \langle \Lambda ,x \rangle \int _{\textup {U}(W_x)/T_{\delta _x}}f_W(g\delta _x g^{-1},0)d\overline {g}. \end {equation}
END Theorem
 
BEGIN Lemma 5.1  
 \label {lemma descent} When $v_2=v_1^*=0$ and $(\lambda , v, v^*)$ satisfies the condition in equation \textup {(\ref {converge})} to make sense its ``nilpotent orbit integral'', we have \par $$\textup {Orb}(f,(\lambda ,v,v^*))=\textup {Orb}(f^P,(\lambda ,v,v^*))|D(\lambda )|_F^{-1}$$ with $$D(\lambda ) = \prod _{x_1,x_2 }(x_1-x_2)$$ and $x_1 (\textup {resp. } x_2)$ runs through all the eigenvalues of $\lambda _1(\textup {resp. } \lambda _2)$ over $\overline {F}$. \par 
END Lemma
 
BEGIN Proof 
 Use $G=KNM$ to compute the integral with the usual meaning of $K, M, N$ as subgroups of GL$(V)$. Let $T$ be the centralizer of $\lambda $ in GL$(V)$ and $T_1$ the components of $T$ belongs to $S_1$. We omit the discussions of the choice of Haar measures on various integrations. \begin {align*} \textup {Orb}&(f,(\lambda ,v,v^*)) \\ &=\int _{G/T}\int _{T_1}f(g\lambda g^{-1},gtv,v^*(gt)^{-1})|t|^{\pm s}\chi (t)\chi (g)\bigg \rvert _{s=0} \\ &=\int _{K}\int _{N}\int _{M/T}\int _{T_1}f(knm\lambda (knm)^{-1},knmtv,v^*(knmt)^{-1})|t|^{\pm s}\chi (t)\chi (knm)\bigg \rvert _{s=0} \\ &=\int _{N}\int _{M/T}\int _{T_1}f_K(nm\lambda (nm)^{-1},nmtv,v^*(nmt)^{-1})|t|^{\pm s}\chi (t)\chi (m)\bigg \rvert _{s=0} \\ &=\int _{N}\int _{M/T}\int _{T_1}f_K(nm\lambda (nm)^{-1},mtv,v^*(mt)^{-1})|t|^{\pm s}\chi (t)\chi (m)\bigg \rvert _{s=0}. \end {align*} The last identity follows from the assumption $v_2=v_1^*=0$. \par Now this is almost $\textup {Orb}(f^P,(\lambda ,v,v^*))$ except that the upper right block of $nm\lambda (nm)^{-1}$ equals $nm_2\lambda _2m_2^{-1}-m_1\lambda _1m_1^{-1}n$. Here $m=(m_1,m_2)$ and by an abuse of notation, we also use $n$ to denote the upper right block of the corresponding unipotent matrix. \par \par Consider the change of variables: \par $$nm_2\lambda _2m_2^{-1}-m_1\lambda _1m_1^{-1}n=n^{\prime }.$$ \par The lemma follows since $D(\lambda )^{-1}$ is the jacobian for this change of variables.
END Proof
 
BEGIN Lemma 5.2  
 The map $f \mapsto f^P$ is preserved by the Fourier transforms on the $\mathfrak {gl}$(V) factor.
END Lemma
 
BEGIN Proof 
 As before, the Fourier transforms are defined by the non-degenerate symmetric bilinear form tr$(XY)$ and a fix additive character $\psi : F \rightarrow \mathbb {C}^\times $. We can assume $f_K=f$ since $\mathcal {F}$ commutes with averaging over $K$. Since $f^P$ only change the $\mathfrak {gl}(V)$ factor, we can ignore the $V$ and $V^*$ factors and therefore assume $f \in C_c^\infty (\mathfrak {gl}(V))$. We have \par \begin {equation}\label {B1} (\mathcal {F}f)^P(\lambda )=\int _{\mathfrak {n}} \mathcal {F}f\bigg (\lambda +\begin {pmatrix} 0 & n \\ 0 & 0 \end {pmatrix}\bigg )=\int _{\mathfrak {n}} \int _{\mathfrak {gl}(V)}f(X)\psi (\textup {tr}(X_1\lambda _1+X_3n+X_4\lambda _4)) \end {equation} with \par \[ X= \begin {pmatrix} X_1 & X_2 \\ X_3 & X_4 \end {pmatrix}. \] \par \par Consider the term tr$(X_3n)$. The integration over $\mathfrak {n}$ is the same as an integration over $S_m=\pi _F^{-m}\mathfrak {n}(O_F)$ for $m$ sufficiently large. And $\int _{S_m} \psi (\textup {tr}(X_3n))$ is 0 unless $X_3$ is very close to $0$. Hence for any small $\delta $, we may find $m$ such that the domain of the integral in (\ref {B1}) can be replaced by $\{(n,X)|n \in S_m, |X_3| \leqslant \delta \}$. Take $\delta $ small enough, we may replace $f(X)$ in (\ref {B1}) by $f\bigg (\begin {pmatrix} X_1 & X_2 \\ 0 & X_4 \end {pmatrix}\bigg ).$ \par \par Now, after integrating over $\mathfrak {n}$ and $X_3$, this equals $\mathcal {F}(f^P)$. \par 
END Proof
 
BEGIN Theorem 6.1  
 [Main Theorem] \label {Main Theorem} Let $W$ be a Hermitian space of dimension $n$ for $E/F$. Let $n=a+b$. Define $G=\textup {U}(W)$ and it has endoscopic group $H=\textup {U}(W_{a,0})\times \textup {U}(W_{b,0})$. \par \textup {(1)} For each $f \in C_c^\infty (\mathfrak {g})$, there exists a transfer $f^H \in C_c^\infty (\mathfrak {h})$. \par \textup {(2)} If $f$ and $f^H$ are matching functions, then for the Fourier transfrom $\mathcal {F}$ and $\mathcal {F}^H$ \textup {(}defined by \textup {tr(}$XY$\textup {))}, $\mathcal {F}(f)$ and $\mathcal {F}^H(f^H)$ are also matching functions. \par 
END Theorem
 
BEGIN Proof 
 \par We first prove the existence of transfer. The transfer is defined in several steps. Start with $f \in C_c^\infty (\mathfrak {u}(W))$, \begin {itemize} \item Choose any $F \in C_c^\infty (\mathfrak {u}(W)\times W)$ such that $F(x,0)=f(x)$. \item Define $\phi \in C_c^\infty (\mathfrak {gl}(V_n)\times V_n \times V_n^*)$ as the Jacquet-Rallis transfer of $\{F,0\}$. \item Define $\phi ^{a,b} \in C_c^\infty (\mathfrak {gl}(V_a) \times \mathfrak {gl}(V_b) \times V_n \times V_n^*)$ as the parabolic descent of $\phi $. \item Using the product of Jacquet-Rallis transfers in dimension $a$ and $b$, we can transfer $\phi ^{a,b}$ to four functions $\{F^{a,b}_{i,j}\}({i, j = 0,1})$, where $$F^{a,b}_{i,j} \in C_c^\infty (\mathfrak {u}(W_{a,i})\times W_{a,i} \times \mathfrak {u}(W_{b,j})\times W_{b,j}).$$ \item Define $f^{a,b}_{i,j} \in \mathfrak {u}(W_{a,i}) \times \mathfrak {u}(W_{b,j})$ as $f^{a,b}_{i,j}(x,y)=F^{a,b}_{i,j}(x,0,y,0).$ \item Let $\widetilde {f^{a,b}_{i,j}}$ be the Jacquet-Langlands transfer of $f^{a,b}_{i,j}$ to $\mathfrak {u}(W_{a,0}) \times \mathfrak {u}(W_{b,0}).$ \item Finally, define $f^{a,b}=\widetilde {f^{a,b}_{0,0}}-\widetilde {f^{a,b}_{0,1}}+\widetilde {f^{a,b}_{1,0}}-\widetilde {f^{a,b}_{1,1}}.$ \end {itemize} \par We claim $f^{a,b}$ is an endoscopic transfer of $f$. Choose elements $\delta \in \mathfrak {u}(W)$ and $(\delta _1, \delta _2) \in \mathfrak {u}(W_{a,0}) \times \mathfrak {u}(W_{b,0})$ whose orbits are matching. We first verify (\ref {endos}) for these orbits. Let $W^\prime = W_{a,0} \bigoplus W_{b,0}$, recall in definition \ref {nice}, $(\delta _1, \delta _2)$ gives a nice matching element $\delta ^\prime \in \mathfrak {u}(W^\prime )$. \par Choose auxiliary $w_1 \in W_{a,0}$ and $w_2 \in W_{b,0}$ such that $(\delta _i, w_i)$ is regular semisimple. Let $(\gamma _i,v_i,v_i^*)$ be a Jacquet-Rallis transfer of $(\delta _i, w_i)$. The element $((\gamma _1,\gamma _2), (v_1,v_2), (v_1^*,v_2^*))$ is naturally a regular semisimple element in $\mathfrak {gl}(V_n)\times V_n \times V_n^*$ that is a Jacquet-Rallis transfer of $(\delta ^\prime ,(w_1, w_2))$. \par The equation (\ref {endos}) follows from a sequence of identities. To simplify the equation, for the moment, we use $C_k$ to represent all the transfer factors appearing in these identities. Recall that $F[\delta ]=\prod F_k$, $S_1=\{k|F_k \nsupseteq E\}$ and $S_1(\delta _i)=\{k \in S_1|F_k\textup { comes from }\delta _i\}$. \par \begin {align*} \textup {Orb}^{\textup {St}}(f^{a,b},(\delta _1, \delta _2)) & =\textup {Orb}(G^{a,b},((\gamma _1,\gamma _2), ((v_1)_{S_1(\delta _1)},0), (0,(v_2^*)_{S_1(\delta _2)}))) \times C_1 \\ & =\textup {Orb}(G,((\gamma _1,\gamma _2), ((v_1)_{S_1(\delta _1)},0), (0,(v_2^*)_{S_1(\delta _2)}))) \times C_2\\ &= \textup {Orb}^{\kappa }(f,\delta ) \times \kappa (\textup {inv}(\delta ^\prime ,\delta )) \times C_3. \end {align*} \par \par The first identity follows by taking the product of (\ref {identity}) applied to the case when dim$V=a$ and $\Lambda =S_1(\delta _1)$ and the case when dim$V=b$ and $\Lambda =\emptyset $. The second identity follows from parabolic descent (lemma \ref {lemma descent}). The third identity follows by applying (\ref {identity}) to the case when dim$V=n$ and $\Lambda =S_1(\delta _1)$. \par We remark that $\kappa $-orbit integral here is different from the classical one since it contains conjugacy classes in both Hermitian spaces. We have shown that these conjugacy classes is a natural torus under $H^1(F,T_\delta )$ and $\kappa $ is character of $H^1(F,T_\delta )$. Therefore we can extend the usual $\kappa $ orbit integral to \par Let us explain that the third identity does give the $\kappa $-orbit integral defined using the endoscopic group $H$. This means we will need to verify the identity \begin {equation} \label {D2} \kappa (\textup {inv}(\delta ^\prime , \delta _x))= \langle S_1(\delta _1), x \rangle . \end {equation} \par Here $(\delta _x, w_x)$ is the Jacquet-Rallis transfer of $((\gamma _1,\gamma _2), (v_1,v_2), (v_1^*,v_2^*)x)$ with $x \in F[\gamma ]^\times $. By proposition \ref {get delta_x}, the canonical isomorphism between $F[\gamma ]^\times /\textup {Nm}_{E[\gamma ]/F[\gamma ]}(E[\gamma ]^\times )$ and $H^1(F,T_\gamma )$ maps $x$ to $\textup {inv}(\delta , \delta _x)$ (proposition \ref {get delta_x}) and maps $\kappa $ to $\langle S_1(\delta _1), \ \rangle $ (proposition \ref {definition of kappa}). This implies (\ref {D2}). \par Finally, we compute the transfer factor. In the above computation, we have introduced three transfer factors: two come from the Jacquet-Rallis transfer and one comes from the parabolic descent. We need to prove their product gives the transfer factor $\chi (D(\delta ))|D(\delta )|_F$. The transfer factor in the parabolic descent equals $|D(\delta )|_F$. So it remains to show the product of the two transfer factors in the Jacquet-Rallis transfer equals $\chi (D(\delta ))$. \par To define the transfer factor in the Jacquet-Rallis case, we fix $\Omega _1 \in \wedge ^{\textup {top}}V_a$, $\Omega _2 \in \wedge ^{\textup {top}}V_b$, and take $\Omega \in \wedge ^{\textup {top}}V$ defined by $\Omega _1 \wedge \Omega _2$. For careful readers, we should fix this transfer factor before defining the Jacquet-Rallis transfer of functions. Recall we have defined $\omega (\gamma , v, v^*)$ in (\ref {transfer}). The desired equality for transfer factors reduces to \par $$\omega (\gamma , v, v^*)=\chi (D(\gamma ))\omega (\gamma _1, v_1, v_1^*)\omega (\gamma _2, v_2, v_2^*),$$ where $\gamma =(\gamma _1, \gamma _2), v=(v_1, v_2)$ and $v^*=(v^*_1, v^*_2)$. To prove this, diagonalize $\gamma _1$ and $\gamma _2$ in $\overline {F}$ and compute both sides. \par To verify $f^{a,b}$ is an endoscopic transfer of $f$, we still need to verify the requirement (\ref {more}). Namely, consider $(\delta _1,\delta _2)$ that is not a transfer from $\mathfrak {u}(W)$. This happens only when $S_1(\delta )=\emptyset $. In this case, $W^\prime =W_{n,0}$ and $W^\prime \ncong W$. The stable conjugacy class of the nice matching element $\delta ^\prime $ of $(\delta _1,\delta _2)$ is the unique conjugacy class contained in $\mathfrak {u}(W_{n,0})$. Following the same computation as before, we find $$\textup {Orb}^{\textup {St}}(f^{a,b},(\delta _1,\delta _2))=0.$$ \par This finishes the proof of the existence part. To prove the Fourier transform part, notice that our construction commutes with Fourier transforms. For this commutativity, it is important that the $(-1)^{n-1}$ in theorem \ref {JR commute} and proposition \ref {E1} exactly cancels. We have shown that for any $f$, there exists $f^H$ such that $f$ matches $f^H$ and $\mathcal {F}(f)$ matches $\mathcal {F}(f^H)$. A theorem of Waldspurger (Proposition A in \cite {Wa3}) ensures that for a fixed $f$, the validity of commutativity does not depend on the choice of $f^H$. This finishes our proof.
END Proof
 
BEGIN Theorem 6.2  
 For any odd prime $p$ and consider the fundamental lemmas on the Lie algebras. Then the fundamental lemma in the Jacquet-Rallis case $($conjecture \textup {\ref {Fundamental}}$)$ implies the fundamental lemma in the endoscopic case.
END Theorem
 
BEGIN Proof 
 We leave it to the reader to give the formulation of the fundamental lemma in the unitary Lie algebras. To prove the above theorem, we start with the right function on $\mathfrak {u}(W_{n,0})$. Then the Jacquet-Rallis fundamental lemma and a simple calculation of parabolic descent implies that we get the right function on $\mathfrak {u}(W_{a,0})\times \mathfrak {u}(W_{b,0})$ following the process as in the proof of theorem \ref {Main Theorem}.
END Proof
 
BEGIN Remark 6  
 In \cite {Kazhdan}, Kazhdan and Varshavsky have shown that the fundamental lemma in the endoscopic case is implied by theorem $\ref {LS commute}$ $($at least when $p$ is large$)$. In the unitary case, theorem $\ref {Main Theorem}$ give a direct proof of theorem $\ref {LS commute}$. Hence, we also give a genuinely different proof of the endoscopic fundamental lemma.
END Remark
 
