BEGIN Theorem 2.1  
 \label {thm:MAINcocycleentropy} Given a class injective cocycle on $\cR $, for every countable partition $\cP $ of $X$ with $H(\cP ) < \infty $, there is a number $h_{\cP }^{*}(\alpha )$ such that for every bounded hyperfinite exhaustion $(\cR _n)$, \begin {eqnarray*} h_{\cP }^{*}(\alpha ) := \lim _{n \to \infty } \int _Y \frac {h^{\cP }\big ( \cR _n \big )(y)}{\big | \cR _n(y)\big |}\, d\nu (y). \end {eqnarray*}
END Theorem
 
BEGIN Remark 2.2  
 As can be seen from the proof of Theorem \ref {thm:MAINcocycleentropy}, the assumption on the cocycle being class injective is not necessary for this convergence result. But we dispense with this additional generality in order to make sure that the values $h_{\cP }^{*}(\alpha )$ accurately reflect entropy theoretic information regarding the action of $\Gamma $ on $X$.
END Remark
 
BEGIN Definition 2.3  
 [Cocycle entropy] Let $(X,\lambda )$ be a p.m.p.\@ ergodic action of $\Gamma $. Let $\alpha : \cR \to \Gamma $ be a class injective cocycle defined on a hyperfinite relation. The number \begin {eqnarray*} h^{C}(\Gamma \curvearrowright X) := \inf \big \{h^{*}_{\cP }(\alpha )\,| \, \cP \mbox { countable, generating partition}\big \} \end {eqnarray*} is called the {\em cocycle entropy} for the action $\Gamma \curvearrowright (X,\lambda )$ and for the injective cocycle $\alpha : \cR \to \Gamma $.
END Definition
 
BEGIN Definition 2.4  
 [Rokhlin entropy] Let $\Gamma \curvearrowright (X,\lambda )$ be a p.m.p.\@ ergodic group action. Then, the number \[ h^{\operatorname {Rok}}(\Gamma \curvearrowright X) := \inf \big \{ H(\cP )\,|\, \cP \mbox { countable, generating partition}\big \} \] is called the {\em Rokhlin entropy} of the group action.
END Definition
 
BEGIN Definition 2.5  
 [Finitary entropy] \[ h^{\operatorname {fin}}\big ( \Gamma \curvearrowright X \big ) := \inf \Big \{ \inf _{T \in Fin(\Gamma )} H\Big ( \bigvee _{g \in T} g^{-1}\cP \Big ) /|T| \, \,\Big |\, \cP \mbox { countable, generating partition}\Big \}. \]
END Definition
 
BEGIN Theorem 2.6  
 \label {thm:ENT} Assume that $\Gamma \curvearrowright (X,\lambda )$ is an ergodic essentially free p.m.p.\@ action. Then, for every amenable p.m.p.\@ equivalence relation $\cR $ over $(Y, \nu )$ and every class injective cocycle $\alpha : \cR \to \Gamma $, we obtain \begin {eqnarray*} h^{\operatorname {fin}}\big ( \Gamma \curvearrowright X \big )=h^C\big (\Gamma \curvearrowright X, \alpha \big ) = h^{\operatorname {Rok}}\big (\Gamma \curvearrowright X\big ). \end {eqnarray*}
END Theorem
 
BEGIN Proof 
 Let $\cP $ be a countable partition with finite Shannon entropy. Assume that $(\cR _n)$ is any bounded hyperfinite exhaustion for $\cR $. Since the cocycle $\alpha $ is class injective, and $\cR _n(y)$ is a finite set almost surely, we obtain \begin {eqnarray*} \inf _{T \in Fin(\Gamma )} \frac {1}{|T|}\,H\Big ( \bigvee _{g \in T} g^{-1}\cP \Big ) \leq \frac {h^{\cP }\big ( \cR _n \big )(y)}{\big | \cR _n(y) \big |} \leq H\big ( \cP \big )\,, \end {eqnarray*} for each $n \in \NN $ and for $\nu $-almost every $y \in Y$. Note that these inequalities remain valid even if $H(\cP ) = \infty $. In the case that there exist generating partitions with finite Shannon entropy, we integrate over $Y$ and pass to the limit as $n\to \infty $. By Theorem \ref {thm:MAINcocycleentropy} we conclude that $ h^{\operatorname {fin}}(\Gamma \curvearrowright X)\le h^\ast _\cP (\alpha )\le H(\cP )$ independently of the cocycle $\alpha $. Now taking the infimum over all generating partitions, since by the discussion above $h^{\operatorname {Rok}}(\Gamma \curvearrowright X) = h^{\operatorname {fin}}(\Gamma \curvearrowright X)$, the above inequality immediately implies equality of all three notions of entropy. \par 
END Proof
 
BEGIN Theorem 2.7  
 \label {thm:MAIN_SMBhyp} Let $\Gamma \curvearrowright (X,\lambda )$ be an ergodic essentially free p.m.p.\@ action. Assume that $\cR $ is an amenable, p.m.p.\@ equivalence relation, and $\alpha : \cR \to \Gamma $ is a class injective cocycle, such that the extended relation $\cR ^X$ is ergodic. Then, for every bounded hyperfinite exhaustion $(\cR _n)$ satisfying the growth condition \[ \lim _{n \to \infty } \operatorname {ess}\,\operatorname {inf}_y |\cR _n(y)|/\log \,n = \infty \] the information functions satisfy the following convergence property. Given a finite partition $\cP $ of $X$, for $(\lambda \times \nu )$-almost every $(x,y) \in X \times Y$, \[ \lim _{n \to \infty } \frac {\cJ \big ( \cP ^{\cR _n(y)}(x) \big )}{|\cR _n(y)|} = h^{*}_{\cP }(\alpha ), \] where $h^{*}_{\cP }(\alpha )$ is the cocycle entropy of the partition $\cP $.
END Theorem
 
BEGIN Corollary 2.8  
 \label {cor:MAIN_SML1} Convergence in Theorem \ref {thm:MAIN_SMBhyp} holds for $\nu $-almost every $y \in Y$ in the $L^1(X,\lambda )$-norm, and also in the $L^1(X \times Y, \lambda \times \nu )$-norm.
END Corollary
 
BEGIN Proposition 3.1  
 \label {prop:finitephin} If $(\cR _n)$ is a bounded hyperfinite exhaustion of the relation $\cR $, then there exists an increasing sequence of finite subgroups $\Phi _n \subseteq \operatorname {Aut}(\cR )$, $n \geq 1$, such that $\Phi := \bigcup _{n \geq 1} \Phi _n$ is generating for $\cR $ and for all $n \in \NN $ and $\phi \in \Phi _n$, the graph $\operatorname {gr}(\phi )$ is contained in $\cR _n$. \par In particular, for every $\phi \in \Phi $, there is an $n_0 \in \NN $ such that $\cR _n(y) \, \triangle \, \phi (\cR _n(y)) = \emptyset $ for $\nu $-almost every $y \in Y$ and every $n \geq n_0$.
END Proposition
 
BEGIN Proof 
 Let $\cT $ be any equivalence subrelation of $\cR $ with finite classes of bounded size. We can divide $Y$ to finitely many measurable $\cT $-invariant sets where the size of $\cT (y)$ is fixed, and we can restrict $\cT $ to one of them. Without loss of generality we can thus assume that $\cT $ has classes of fixed size $N$ in $Y$. As is well known (see e.g. \cite [\S 4]{FM77}, or \cite [Lem. 3b]{CFW81}) the factor space $Y/\cT $ consisting of equivalence classes of $\cT $ is a standard Borel space and admits measurable sections $J_1, \dots ,J_N : Y/\cT \to Y$ such that $\set {J_i(\cT (y))\,;\, 1\le i\le N}=[y]_\cT =\cT (y)$ for almost every $y$. Define the cyclic permutation $\sigma _{\cT (y)}$ given by $J_1(\cT (y))\mapsto J_2(\cT (y))\mapsto \cdots J_N(\cT (y))\mapsto J_1(\cT (y))$ in each class, whose cycle length is $N$. Denote by $\phi _\cT $ the map on $Y$ which coincides with $\sigma _{\cT (y)}$ on each class $\cT (y)$, and denote the cyclic group generated by $\phi _\cT $ by $\Phi _\cT $. Then $\phi _\cT $ is measurable and constitutes an inner automorphism of $\cR $ which leaves invariant almost every class of the relation $\cT $, and the group $\Phi _\cT $ generates the relation $\cT $. \par Applying this procedure to each of the finite bounded relations $\cR _n$ and taking the union of the corresponding groups, the stated result follows. \par 
END Proof
 
BEGIN Lemma 3.2  
 \label {lemma:hyperfinitefolner} Let $\cR $ be hyperfinite and $(\cR _n)$ a bounded hyperfinite exhaustion. \begin {enumerate}[(i)] \item Assume that the subset function $\cD $ is bounded. Then \par \[ \lim _{n \to \infty } \int _Y \frac {\big | \cR _n(y)\,\triangle \, \cD \circ \cR _n(y) \big |} {\big | \cR _n(y) \big |} \,d\nu (y) = 0. \] \item Assume that $\cT \subset \cR $ is a bounded sub-equivalence relation. For every $\varepsilon > 0$, and for all large enough $n \in \NN $ (depending on $\varepsilon $) there is a set $Y_n \subseteq Y$ with $\nu (Y_n) \geq 1- {\varepsilon }$ such that for all $y \in Y_n$ \begin {eqnarray} \label {eqn:hyperfinitefolner} \frac {\big |\big \{ z \in \cR _n(y)\,|\, \cT (z) \subseteq \cR _n(y) \big \}\big |} {\big | \cR _n(y) \big |} > 1- \varepsilon \cdot \norm {\cT }. \end {eqnarray} \end {enumerate}
END Lemma
 
BEGIN Proof 
 (i). First let us assume that $\cD $ is defined by a finite set of inner automorphisms $D=\set {\psi _i, 1\le i \le N}\subset [\cR ]$. It suffices to show that for each $1\le i\le N$ $$\lim _{n \to \infty } \int _Y \frac {\big | \cR _n(y)\, \triangle \, \psi _i(\cR _n(y)) \big |} {\big | \cR _n(y) \big |} \,d\nu (y) = 0.$$ Using the invariance of the measure $\tilde {\nu }$ and $\cR _n(y) = \cR _n(z)$ for $z \in \cR _n(y)$, we compute for $\psi = \psi _i$ \begin {eqnarray*} \int _Y \frac {\big | \psi \big (\cR _n(y)\big ) \, \triangle \, \cR _n(y) \big |}{\big | \cR _n(y) \big |}\, d\nu (y) &\leq & \int _Y \frac {1}{\big | \cR _n(y) \big |} \sum _{z \in \cR _n(y)} \big | \{\psi (z)\} \setminus \cR _n(y) \big |\, d\nu (y) \\ && \quad \quad + \int _Y \frac {1}{\big | \cR _n(y) \big |} \sum _{z \in \cR _n(y)} \big | \{\psi ^{-1}(z)\} \setminus \cR _n(y) \big |\, d\nu (y) \\ &=& \int _Y \sum _{y \in \cR _n(z)} \big | \cR _n(z) \big |^{-1} \big | \{\psi (z)\} \setminus \cR _n(z) \big |\, d\nu (z) \\ && \quad \quad + \int _Y \sum _{y \in \cR _n(z)} \big | \cR _n(z) \big |^{-1} \, \big | \{\psi ^{-1}(z)\} \setminus \cR _n(z) \big |\, d\nu (z) \\ &=& \int _Y \big | \{\psi (z)\} \setminus \cR _n(z) \big |\, d\nu (z) + \int _Y \, \big | \{\psi ^{-1}(z)\} \setminus \cR _n(z) \big |\, d\nu (z). \end {eqnarray*} Now since the union of the $\cR _n$ is the full relation $\cR $, we obtain that the integrand tends to zero pointwise almost surely as $n \to \infty $. Since all integrands are bounded by $1$, we can use the dominated convergene theorem to deduce that the above integrals converges to zero as well. In the general case, for every bounded subset function $\cU $, there exists a finite set of inner automorphisms $D$ such that $\cU (y)\subset \cD (y)$ for a.e. $y$, as shown in the proof of Lemma 2.9 in \cite {BN13b}. This establishes the validity of the assertion (i).\\ (ii). Fix $\varepsilon > 0$. By (i), we can choose $n(\varepsilon ) \in \NN $ such that for $n\ge n(\varepsilon )$ \begin {eqnarray*} \int _Y \frac {\big | \cT \circ \cR _n(y) \setminus \cR _n(y) \big |}{\big | \cR _n(y) \big |}\, d\nu (y) < \varepsilon ^2. \end {eqnarray*} It is a consequence of Markov's inequality that we can find a set $Y_n \subset Y$ with $\nu (Y_n) \geq 1 - \varepsilon $ and such that for all $y \in Y_n$ \begin {eqnarray} \label {eqn:hyperfincontra} \frac { \big |\cT \circ \cR _n(y) \setminus \cR _n(y) \big |}{\big | \cR _n(y) \big |} < \varepsilon \,. \end {eqnarray} \par \par Now suppose $y\in Y_n$ and \eqref {eqn:hyperfinitefolner} fails to hold for some $\varepsilon > 0$. Then there are at least $\varepsilon \,\|\cT \|\,|\cR _n(y)|$ many elements $z \in \cR _n(y)$ with $\cT (z) \setminus \cR _n(y)$ containing at least one element $e_z$. $\cT $ is a sub equivalence relation consisting of disjoint cells, and each cell $\cT (z)$ contains at most $\norm {\cT }$ points. Thus there are at least $\varepsilon \,|\cR _n(y)|$ many distinct such elements $e_z$. However, this contradicts the inequality~\eqref {eqn:hyperfincontra}.
END Proof
 
BEGIN Definition 4.1  
 [Subadditive functions] \label {defi:subadditive} A mapping $\mathfrak {H}: \cB \cS \cF (\cR ) \to \operatorname {Map}\big (Y, [0,\infty ) \big )$ is called {\em subadditive} if \begin {itemize} \item for every bounded subset function $\cA $, the function $\mathfrak {H}(\cA ): Y \to [0,\infty )$ is measurable; \item $\mathfrak {H}$ is {\em bounded} in the sense that there exists $C> 0$ such that for all subset functions $\cA $, we have $\mathfrak {H}(\cA )(y) \leq C\,|\cA (y)|$ a.e.; \item $\mathfrak {H}$ is $\cR $-{\em invariant}, i.e.\@ for every bounded sub-equivalence relation $\cT \subseteq \cR $, one has $h(\cT )(y)=h(\cT )(z)$, whenever $y\cT z$. \item $\mathfrak {H}$ has the following {\em subadditivity property}: if $\cA ,\cA _i$ are bounded subset functions that satisfy $\cA (y):= \coprod _{i=1}^m \cA _i(z_i)$ then for a.e. $y\in Y$ \[ \mathfrak {H}\big ( \cA \big )(y) \leq \sum _{i=1}^m \mathfrak {H}\big ( \cA _i\big )(z_i)\,, \] where $\set {z_1(y),\dots ,z_{m(y)}(y)}\subset \cA (y)$ is a set of points depending measurably on $y$. \end {itemize}
END Definition
 
BEGIN Theorem 4.2  
 \label {thm:INT} Let $\cR $ be p.m.p.\@ and hyperfinite and let $\mathfrak {H}:\cB \cS \cF (\cR ) \to \operatorname {Map}\big (Y,[0,\infty )\big )$ be subadditive. Then, for all bounded hyperfinite exhaustions $(\cR _n)$, the following holds: \begin {eqnarray*} \mathfrak {H}^{*} := \inf _{\cT \subseteq \cR } \int _Y \frac {\mathfrak {H}\big ( \cT \big )(y)}{|\cT (y)|}\,d\nu (y) = \lim _{n \to \infty } \int _Y \frac {\mathfrak {H}\big ( \cR _n\big )(y)}{\big | \cR _n(y) \big |}\, d\nu (y), \end {eqnarray*} where the infimum is taken with respect to all non-trivial, bounded sub-equivalence relations $\cT \subseteq \cR $.
END Theorem
 
BEGIN Proof 
 \par \par Let $(\cR _n)$ be a non-trivial, bounded hyperfinite exhaustion and denote by $\cT $ be an arbitrary sub-equivalence relation of $\cR $. It is enough to show that \begin {eqnarray} \label {eqn:subaddtoshow} \limsup _{n \to \infty } \int _Y \frac {\mathfrak {H}\big (\cR _n\big )(y)}{|\cR _n(y)|}\,d\nu (y) \leq \int _Y \frac {\mathfrak {H}\big (\cT \big )(y)}{|\cT (y)|}\,d\nu (y). \end {eqnarray} To this end, fix $\varepsilon > 0$, as well as $m \in \NN $. We apply Lemma~\ref {lemma:hyperfinitefolner} (ii) to $\cT $. Hence, for large enough $n \in \NN $, there is $Y_n \subseteq Y$ with $\nu (Y_n) > 1 - \varepsilon $ and for all $y \in Y_n$, we have $\big | \mathring {\cR }_n(y) \big | \geq (1-\varepsilon \,\|\cT \|)\,\big |\cR _n(y)\big |$, where $\mathring {\cR }_n(y):= \{ z \in \cR _n(y)\,|\, \cT (z) \subseteq \cR _n(y) \}$. \par $\mathring {\cR }_n(y)$ is of course a bounded subset function (possibly assuming the empty set as a value), and consider now the disjoint decomposition $\cR _n(y)= \mathring {\cR }_n(y)\coprod \big (\cR _n(y)\setminus \mathring {\cR }_n(y)\big )$. Applying the subadditivity of $\mathfrak {H}$ to this decomposition, this yields for a.e. $y\in Y$ \begin {eqnarray} \label {eqn:esspart} \mathfrak {H}(\cR _n)(y)\le \mathfrak {H}(\mathring {\cR }_n)(y)+\mathfrak {H}(\cR _n\setminus \mathring {\cR }_n)(y)\,. \end {eqnarray} Now note that if $z\in \mathring {\cR }_n(y)$ and $w\cT z$, then $w \in \mathring {\cR }_n(y)$ as well, so that $\mathring {\cR }_n(y)$ is a union of disjoint $\cT $-classes. Hence, we can choose points $z_1, \dots , z_m$ in each of the resulting cells such that the choice of representatives is measurable in $y$ (since an equivalence relation with finite classes admits measurable sections). Hence, $\mathring {\cR }_n(y) = \coprod _{j=1}^m \cT (z_j)$, and using the subadditivity property of $\mathfrak {H}$, along with the invariance property with respect to $\cT $, we get \begin {eqnarray*} \mathfrak {H}(\mathring {\cR }_n)(y) \leq \sum _{z \in \mathring {\cR }_n(y)} \frac {\mathfrak {H}\big (\cT \big )(z)}{|\cT (z)|.} \end {eqnarray*} Dividing inequality~\eqref {eqn:esspart} by $\abs {\cR _n(y)}$, and using the boundedness of $\mathfrak {H}$ applied to the second summand, we conclude that for a.e. $y\in Y_n$ : \[ \mathfrak {H}^{*}_{n}(y) \leq \sum _{z \in \mathring {\cR }_{n}(y)} \frac {{\mathfrak {H}^{*}_{\cT }}(z)}{|\cR _{n}(y)|} + C\,\varepsilon \,\|\cT \|\,, \] where, for brevity, we have set $\mathfrak {H}^{*}_{\cT }(y) := \mathfrak {H}\big ( \cT \big )(y) /\big | \cT (y) \big |$. By the boundedness of $\mathfrak {H}$, clearly $\mathfrak {H}^{*}_{n}(y) \leq C$ for all $y \in Y$ and since $\mathfrak {H}^{*}_{\cT } \geq 0$, and as $\nu (Y_n)< \varepsilon $, we integrate over $Y=Y_n \coprod \big (Y\setminus Y_n\big )$ in order to arrive at \begin {eqnarray*} \int _Y \mathfrak {H}^{*}_{n}(y)\, d\nu (y) \leq \int _Y \sum _{z \in \cR _{n}(y)} \frac {{\mathfrak {H}^{*}_{\cT }}(z)}{|\cR _{n}(y)|} \, d\nu (y) + C\, (1 + \|\cT \|)\, \varepsilon . \end {eqnarray*} Now using the $\cR $-invariance of the measure $\tilde {\nu }$, along with the fact that $\cR _n(y) = \cR _n(z)$ for $z\cR _n y$, we obtain \begin {eqnarray*} \int _Y \sum _{z \in \cR _{n}(y)} \frac {{\mathfrak {H}^{*}_{\cT }}(z)}{|\cR _{n}(y)|} \, d\nu (y) &=& \int _Y \sum _{y \in \cR _n(z)} \frac {{\mathfrak {H}^{*}_{\cT }}(z)}{|\cR _{n}(z)|} \, d\nu (z) = \int _Y {\mathfrak {H}^{*}_{\cT }}(z)\,d\nu (z). \end {eqnarray*} Consequently, one gets \[ \limsup _{n \to \infty } \int _Y \mathfrak {H}^{*}_{n}(y)\, d\nu (y) \leq \int _Y {\mathfrak {H}^{*}_{\cT }}(z)\,d\nu (z) + C\,(1+ \|\cT \|)\,\varepsilon . \] Letting $\varepsilon \to 0$, we see that the inequality~\ref {eqn:subaddtoshow} is verified.
END Proof
 
BEGIN Proposition 4.3  
 \label {prop:propertiesofH} Let $(X,\lambda )$ be a p.m.p.\@ action of $\Gamma $. Fix $F\in Fin(\Gamma )$ and $g \in \Gamma $. Further, let two countable partitions $\cP $ and $\cQ $ of $X$ be given. Then, \begin {enumerate}[(i)] \item $H(\cP \vee \cQ ) \leq H(\cP ) + H(\cQ )$; \item $H\big ( \bigvee _{g \in F}g^{-1}\cP \big ) \leq H(\cP )\,|F|$; \item $H(\cP ) \leq H(\cQ )$ if $\cQ \geq \cP $. \item $H(g\,\cP )= H(\cP )$; \par \end {enumerate}
END Proposition
 
BEGIN Proof 
 See e.g. \cite [Ch. 10, \S 6]{CFS}.
END Proof
 
BEGIN Proposition 4.4  
 \label {prop:hpsubadditive} Fix a countable partition $\cP $ of $(X,\lambda )$ with finite Shannon entropy $H(\cP )$. Then the mapping $h^{\cP }: \cB \cS \cF (\cR ) \to \operatorname {Map}\big (Y, [0,\infty )\big )$ is subadditive according to Definition~\ref {defi:subadditive}.
END Proposition
 
BEGIN Proof 
 Recall that we have defined \[ h^{\cP }(\cF ): Y \to [0,\infty ) \text {\,\,\,via :\,\,\,} h^{\cP }(\cF )(y) := H\Big ( \bigvee _{w \in \cF (y)} \alpha (w,y)^{-1}\,\cP \Big ). \] \par The boundedness and the subadditivity property for $h^{\cP }$ are easily verified by properties (i) and (ii) listed in Proposition~\ref {prop:propertiesofH}. Concerning the invariance property, fix an arbitrary bounded sub-equivalence relation $\cT \subseteq \cR $. Let $y,z \in Y$ be such that $y \cT z$. We need to show that $h^{\cP }(\cT )(z) = h^{\cP }(\cT )(y)$. To this end, note that by the cocycle identity, the set of group elements $\big \{ \alpha (w,z) \,|\, w \in \cT (z) \big \}$ is equal to the set $\big \{ \alpha (w,y) \,|\, w \in \cT (y) \big \} \cdot \alpha (y,z)$. Hence, the desired invariance follows from part~(iv) of Proposition~\ref {prop:propertiesofH}. It remains to show the measurability statement. To this end, let $\cA $ be any measurable bounded subset function. Note first that given a partition $\cP $, the function $h^{\cP }(\cA )(\cdot )$ takes at most countably many different values, since $Fin(\Gamma )$ is countable. More precisely, those values only depend on the finite collection of group elements of the form $\{ \alpha (w,y)\, |\, w \in \cA (y)\} \in Fin(\Gamma )$ for $y \in Y$. Since $\cA $ and the cocycle $\alpha $ are measurable by assumption, the function $\overline {h}(\cA ): \cR \to [0, \infty )$, defined by $\overline {h}(\cA )\big ( (y,z) \big ):= H\Big ( \bigvee _{w \in \cA (y)} \alpha (w,z)^{-1}\cP \Big )$ is measurable. Using the cocycle identity $\alpha (z,w)\alpha (w,y)=\alpha (z,y)$ we observe that $\overline {h}(\cA )\left ((y,z)\right ) = \overline {h}(\cA )\big ( (y,y) \big )$ for all $z \in [y]$, by property (iv) in Proposition~\ref {prop:hpsubadditive}. Consequently, we can write $h^{\cP }(\cA ) := \overline {h}(\cA ) \circ \ell _{\Delta }$, where $\ell _{\Delta }: Y\to \cR $ is the lift $y\mapsto (y,y)$ of $Y$ to the diagonal. Since the latter function is measurable, so is $h(\cA )$.
END Proof
 
BEGIN Proof 
 [Proof of Theorem~\ref {thm:MAINcocycleentropy}] By Proposition~\ref {prop:hpsubadditive}, the mapping $h^{\cP }: \cB \cS \cF (\cR ) \to \operatorname {Map}\big (Y, [0,\infty )\big )$ is subadditive. Hence, the convergence claimed in the theorem, as well as the fact that the limit does not depend on the hyperfinite exhaustion, both follow from Theorem~\ref {thm:INT}, and this concludes the proof of Theorem~\ref {thm:MAINcocycleentropy}.
END Proof
 
BEGIN Proposition 5.1  
 \label {prop:basiccov} Let $N,L \in \NN _{\ge 1}$ with $N < L$ and consider an arbitrary finite sequence of subset functions $\cB _j \subseteq \cR _L$, $1 \leq j \leq N$. Further, for $y\in Y$, consider a collection of classes (of the relations $\cR _n$ where $1\le n\le N$) given by \[ \mathfrak {F}(y) := \big \{ \cR _{n(j)}(w)\,|\, w \in \cB _j(y), 1 \leq j \leq N \big \}. \] \par Then, for a.e. $y \in Y$, we can extract from $\mathfrak {F}(y)$ a disjoint subcollection $\mathfrak {S}(y)$ of classes such that \begin {eqnarray*} \coprod _{C \in \mathfrak {S}(y)} C \supset \bigcup _{j=1}^N \cB _j(y)\,, \text { and so } \sum _{C \in \mathfrak {S}(y)} \abs {C} \geq \Big | \bigcup _{j=1}^N \cB _j(y) \Big |. \end {eqnarray*}
END Proposition
 
BEGIN Proof 
 Fix $y \in Y$. We note first that for $z_1, z_2 \in \cR _L(y)$ and $1 \leq j_1, j_2 \leq N$, there are three possibilities for the inclusion relation between $\cR _{j_1}(z_1)$ and $\cR _{j_2}(z_2)$: \begin {itemize} \item $\cR _{j_1}(z_1) \cap \cR _{j_2}(z_2) = \emptyset $, \item $\cR _{j_1}(z_1) \subseteq \cR _{j_2}(z_2)$, \quad or \item $\cR _{j_1}(z_1) \supseteq \cR _{j_2}(z_2)$. \end {itemize} Any collection $\mathfrak {F}(y)$ of sets with the latter property has the property that the union of its constituents has a unique representation as a disjoint union of some of the constituents. To find this representation explicitly, namely to choose the subcollection $\mathfrak {S}(y)$, enumerate all the elements in $\mathfrak {F}(y)$ and give them distinct labels collected in an index set $\cI $. Then run the following checking algorithm. \begin {enumerate}[(1)] \item Set $\mathfrak {S}^{*}(y) = \emptyset $, $\cI ^{*} = \cI $. \item Check an arbitrary class $C \in \mathfrak {F}(y)$ with its corresponding label being contained in $\cI ^{*}$. \item Given $C$, there are two possibilities: \begin {enumerate}[(A)] \item Either for all $1 \leq j \leq N$ and $z \in \cB _j(y)$ such that $\cR _{n(j)}(z)\cap C \neq \emptyset $, we have $C \supseteq \cR _{n(j)}(z)$, \item or there is some $1 \leq j_1 \leq N$, $z_1 \in \cB _{j_1}(y)$ such that $C \subseteq \cR _{n(j_1)}(z_1)$ and $C \neq \cR _{n(j_1)}(z_1)$. \end {enumerate} \item Only in case of (A), add $C$ to the subcollection $\mathfrak {S}^{*}(y)$. Then remove from $\cI ^{*}$ all labels corresponding to classes $\cR _{n(j)}(z) \in \mathfrak {F}(y)$ being contained in $C$. If the new set $\cI ^{*} = \emptyset $, jump to step (5), otherwise return to step (2). \item We have $\cI ^{*} = \emptyset $ (meaning all classes have been checked) and we set $\mathfrak {S}(y) = \mathfrak {S}^{*}(y)$. This is the collection we aim for. \end {enumerate} By construction, for a.e. $Y$, the elements $C \in \mathfrak {S}(y)$ are pairwise disjoint. Also, we made sure that for every $1 \leq j \leq N$, every single $b \in \cB _j(y)$ is contained in some class $C$ taken into $\mathfrak {S}(y)$. This proves the above inequality.
END Proof
 
BEGIN Lemma 5.2  
 \label {lemma:abstrcomb} Fix $0 < \delta < 1$ and fix an (arbitrary) finite non-empty set $D\subset \Phi $. Then, for sufficiently large $M \in \NN $, depending only on $D$ and $\delta $, the following property holds. \par Let ${\cT }_{i,j} \subseteq \cR _L$ $(1 \leq i \leq M, 1 \leq j \leq N_i)$ be an array of subset functions, such that for a.e. $y$, $\cT _{i,j}(y)=\cR _{n(i,j)}(y)$, where $n(i,j)\le L$. Assume that for $2\le i \le M$ and every $1\le j\le N_i$ \begin {eqnarray} \label {eqn:tempinfiber} \Big | \bigcup _{k < i} D \circ \big ({\cT }^{-1}_{k,*} \,{\cT }_{i,j} \big ) \Big | \leq (1+\delta )\,\big |{\cT }_{i,j}\big | \end {eqnarray} almost surely, where ${\cT }_{k,*} := \bigcup _{j=1}^{N_k} {\cT }_{k,j}$ for $1 \leq k \leq M$. \par Then, given another array $\cB _{i,j} \subseteq \cR _L$ for $1 \leq i \leq M$ and $1 \leq j \leq N_i$, for $\nu $-almost every $y\in Y$ there are disjoint subcollections \begin {eqnarray*} \mathfrak {S}(y) \subseteq \big \{ {\cT }_{i,j}(w)\,|\, w \in \cB _{i,j}(y), 1 \leq i \leq M, 1 \leq j \leq N_i \big \} \end {eqnarray*} such that \begin {eqnarray*} \sum _{C \in \mathfrak {S}(y)} \abs {C} \geq (1-\delta )\, \min _{1 \leq i \leq M} \Big |D \circ \bigcup _{j=1}^{N_i} \cB _{i,j}(y) \Big |. \end {eqnarray*}
END Lemma
 
BEGIN Proof 
 Fix a conull set $Y_0 \subseteq Y$ such that for all $y \in Y_0$ the inequality~\eqref {eqn:tempinfiber} is fulfilled. For $i=M$, apply Proposition~\ref {prop:basiccov} to the subset functions defined as $\cB _j :=\cB _{M,j}$, where $1 \leq j \leq N_M$. This way, by passing to another conull subset of $Y_0$, for $\nu $-a.e.\@ $y \in Y_0$, we obtain a disjoint subcollection \[ \mathfrak {S}_M(y) \subseteq \big \{ {\cT }_{M,j}(w)\,|\, 1 \leq j \leq N_M, w \in \cB _{M,j}(y) \big \}. \] with \[ \sum _{C \in \mathfrak {S}_M(y)} \abs {C} \geq \Big | \bigcup _{j=1}^{N_M} \cB _{M,j}(y) \Big |. \] Proceeding iteratively, for $i < M$, we set \[ \tilde {\cB }_{i,j}(y) := \cB _{i,j}(y) \setminus \bigcup _{l > i} {\cT }^{-1}_{i,j} \circ (\bigcup \mathfrak {S}_l )(y), \] where $1 \leq j \leq N_i$ and $\bigcup \mathfrak {S}_l$ denotes the union over all sets in $\mathfrak {S}_l$. Applying Proposition~\ref {prop:basiccov} again, this time to the subset functions defined as $\cB _j := \tilde {\cB }_{i,j}$, $1 \leq j \leq N_i$ gives a subcollection \[ \mathfrak {S}_i (y)\subseteq \big \{ {\cT }_{i,j}(w), 1 \leq j \leq N_i, w \in \tilde {\cB }_{i,j}(y) \big \} \] with the corresponding covering property, namely \[ \sum _{C \in \mathfrak {S}_i(y)} \abs {C} \geq \Big | \bigcup _{j=1}^{N_i} \tilde {\cB }_{i,j}(y) \Big |. \] \par Having constructed $\mathfrak {S}_i$ for all $1 \leq i \leq M$, we finally set $\mathfrak {S} := \bigcup _{i=1}^M \mathfrak {S}_i$. By construction, $\mathfrak {S}$ is a disjoint collection of sets. We are going to show \begin {eqnarray} \label {eqn:whattoshow} \sum _{i=m}^M \sum _{C \in \mathfrak {S}_i(y)} \abs {C} \geq \min \big \{1-\delta , (M-m+1) \,\frac {\delta ^2}{|D|} \big \} \cdot \min _{m \leq i \leq M} \Big | D \circ \bigcup _{j=1}^{N_i} \cB _{i,j}(y) \Big | \end {eqnarray} for all $1 \leq m \leq M$ and $\nu $-almost every $y\in Y$. The proof is by induction on $m=M,\dots , 1$, starting with $M$. By the first case in our argument above, \[ \sum _{C \in \mathfrak {S}_M(y)} \abs {C}\geq \Big | \bigcup _{j=1}^{N_M} \cB _{M,j}(y) \Big | \geq \frac {1}{|D|} \, \Big | D\circ \bigcup _{j=1}^{N_M} \cB _{M,j}(y) \Big |, \] which shows the validity of an inequality which is in fact stronger than \ref {eqn:whattoshow}. In order to show the claim for $m < M$, we assume that for the element $y \in Y$ under consideration, \begin {eqnarray} \label {eqn:nothingtoprove} \sum _{l > m} \sum _{C \in \mathfrak {S}_l(y)} \abs {C} < (1-\delta )\, \min _{m \leq i \leq M} \Big | D \circ \bigcup _{j=1}^{N_i} \cB _{i,j}(y) \Big |, \end {eqnarray} since, otherwise, there is nothing to prove. By construction of the collection $\mathfrak {S}_m(y)$, we have \begin {eqnarray} \label {eqn:covaux11} \sum _{C \in \mathfrak {S}_m(y)} \abs {C}\geq \Big | \bigcup _{j=1}^{N_m} \tilde {\cB }_{m,j}(y) \Big |. \end {eqnarray} It follows from \[ \tilde {\cB }_{m,j}(y) = {\cB }_{m,j}(y) \setminus \bigcup _{l > m} \bigcup _{C \in \mathfrak {S}_l(y)} {\cT }_{m,j}^{-1}\,C \] that \begin {eqnarray} \label {eqn:covaux22} \Big (D \circ \bigcup _{j=1}^{N_m} \tilde {\cB }_{m,j}\Big )(y) \supseteq \Big (D\circ \bigcup _{j=1}^{N_m} \cB _{m,j}\Big )(y) \setminus \bigcup _{l > m} \bigcup _{C \in \mathfrak {S}_l(y)} D \circ \Big ( \bigcup _{j=1}^{N_m} {\cT }^{-1}_{m,j}\, C \Big )\,. \end {eqnarray} Recall that by assumption (\ref {eqn:tempinfiber}), we have \[ \Big | D \circ \Big ( \bigcup _{j=1}^{N_m} \cT _{m,j}^{-1}\,C \Big ) \Big | \leq (1+\delta )\, \big | C \big | \] for a.e.\@ $y \in Y_0$, where $C \in \bigcup _{l > m} \mathfrak {S}_l(y)$. Hence, by \eqref {eqn:covaux22}, \begin {eqnarray*} \Big | \bigcup _{j=1}^{N_m} \tilde {\cB }_{m,j}(y) \Big | &\geq & \frac {1}{|D|}\, \Big | \Big (D \circ \bigcup _{j=1}^{N_m} \tilde {\cB }_{m,j}\Big )(y) \Big | \\ &\geq & \frac {1}{|D|} \, \Big ( \Big | D \circ \bigcup _{j=1}^{N_m} \cB _{m,j}(y) \Big | -(1+\delta ) \sum _{l > m} \sum _{C \in \mathfrak {S}_l} \abs {C} \Big ). \end {eqnarray*} With \eqref {eqn:covaux11} we obtain by taking into account \eqref {eqn:nothingtoprove} \begin {eqnarray*} \sum _{C \in \mathfrak {S}_m} \abs {C} &\geq & \frac {1}{|D|} \, \Big | D \circ \bigcup _{j=1}^{N_m} \cB _{m,j}(y) \Big | - \frac {1+\delta }{|D|}\, \sum _{l > m} \sum _{C \in \mathfrak {S}_l} \abs {C}\\ &\geq & \big ( 1- (1+\delta )(1-\delta ) \big )\, \frac {1}{|D|}\, \min _{m \leq i \leq M} \Big | D \circ \bigcup _{j=1}^{N_i} \cB _{i,j}(y) \Big | \\ &=& \frac {\delta ^2}{|D|}\, \min _{m \leq i \leq M} \Big | D \circ \bigcup _{j=1}^{N_i} \cB _{i,j}(y) \Big |. \end {eqnarray*} Consequently, \begin {eqnarray*} \sum _{l \geq m} \sum _{C \in \mathfrak {S}_l} \abs {C} &\geq & \sum _{l > m} \sum _{C \in \mathfrak {S}_l} \abs {C} + \frac {\delta ^2}{|D|}\, \min _{m \leq i \leq M} \Big | D \circ \bigcup _{j=1}^{N_i} \cB _{i,j}(y) \Big | \\ &\geq & \Big ( \big (M - (m+1) + 1 \big ) \, \frac {\delta ^2}{|D|} + \frac {\delta ^2}{|D|} \Big ) \, \min _{m \leq i \leq M}\,\Big | D \circ \bigcup _{j=1}^{N_i} \cB _{i,j}(y) \Big |. \end {eqnarray*} Hence, the proof of the inequality~\eqref {eqn:whattoshow} is complete. Finally, choosing $M$ large enough such that \[ \frac {(M-1)\delta ^2}{|D|} \geq (1-\delta ) \] concludes the proof of the lemma.
END Proof
 
BEGIN Theorem 6.1  
 \label {thm:ETequiv} Let $\cZ $ be an ergodic, p.m.p.\@ equivalence relation over a probability space $(Z,\eta )$. Let $(\cZ _n)$ be a bounded hyperfinite exhaustion for $\cZ $. \\ Then for all $f \in L^1(Z,\eta )$, we have \begin {eqnarray*} \lim _{n \to \infty } \big | \cZ _n(z) \big |^{-1}\,\sum _{w \in \cZ _n(z)} f(w) = \int _Z f(w)\, d\eta (w) \end {eqnarray*} for $\eta $-almost every $z \in Z$.
END Theorem
 
BEGIN Lemma 6.2  
 \label {lemma:ergodicity} Let $\cZ $ be an ergodic p.m.p. equivalence relation over a probability $(Z, \eta )$ along with a countable set $\Phi $ of inner automorphisms generating $\cZ $. Then, for every $\delta > 0$, and every set $A \subseteq Z$ with $\eta (A) > 0$, there is a finite set $D \subset \Phi $ such that \[ \eta \big ( D \circ A \big ) \geq 1 - \delta . \]
END Lemma
 
BEGIN Proof 
 Let $A \subseteq Z$ be measurable with $\eta (A) > 0$. Assume that there is some $\delta _0 > 0$ such that for all finite collections $D \subset \Phi $, we have $\eta (D \circ A) < 1 - \delta _0$. We define $\overline {A} := \Phi \circ A = \bigcup _{\phi \in \Phi } \phi (A)$. This set is invariant under the relation $\cZ $. To see this, consider $z \in Z$, $\phi \in \Phi $ and $a \in A$ such that $(\phi (a), z) \in \cZ $. Since $\Phi $ is generating, there is a further inner automorphism $\phi ^{\prime } \in \Phi $ such that $z = \phi ^{\prime }\phi (a)$. We conclude that $z \in \Phi \circ A$ and thus, \[ \big ( \overline {A} \times Z \big ) \cap \cZ = \overline {A} \times \overline {A}. \] Since $\Phi $ is countable, it follows $\eta (\overline {A}) \le 1 -\delta _0$ by our assumption. Now $\overline {A}$ is an invariant set, hence by ergodicity of the relation, we obtain $\eta (\overline {A}) = 0$. However, since every inner automorphism preserves the measure, we have $\eta (\overline {A}) \geq \eta (A) > 0$. This is a contradiction.
END Proof
 
BEGIN Lemma 6.3  
 \label {lemma:comb} Let $\cR $ be a p.m.p. equivalence relation over $(Y,\nu )$, and let $(\cR _n)$ be a bounded hyperfinite exhaustion satisfying $\lim _{n \to \infty } \operatorname {ess}\,\operatorname {inf}_y |\cR _n(y)| = \infty $. Then, for every $\eta > 0$, there is some $\ell \in \NN $ such that the following holds. \par Suppose that to $y \in Y$ there corresponds a finite increasing sequence $(k_i), 1 \leq i \leq r(y)$ of integers (depending on $y$) with $|\cR _{k_1}(z)| \geq \ell $ for almost every $z \in Y$. Then, there is $n_0 \in \NN $ such that for all $n \geq n_0$, the number of possible disjoint subcollections $\mathfrak {S}(y)$ of the form \[ \mathfrak {S}(y) \subseteq \big \{{\cR }_{k_i}(c) \,|\, c \in \cR _n(y), 1 \leq i \leq r(y) \big \} \] is at most $2^{\eta |\cR _n(y)|}$.
END Lemma
 
BEGIN Proof 
 Let $\eta > 0$. Consider $\ell \in \NN $, $y \in Y$ and an increasing sequence $(k_i), 1 \leq i \leq r(y)$ of integers (depending on $y$) with $|\cR _{k_1}(z)| \geq \ell $ for all $1 \leq i \leq r(y)$ and almost every $z \in Y$. Since we assume that $\mathfrak {S}(y)$ is a collection of disjoint ${\cR }_{k_i}$-classes contained in $\cR _n(y)$, there is a center set $\cC (y) \subseteq \cR _n(y)$ such that \[ \mathfrak {S}(y) = \big \{ {\cR }_{k_{t(c)}}(c)\,|\, c \in \cC (y)\big \} \text { with } 1 \leq t(c) \leq r(y) . \] Given $\mathfrak {S}(y)$ (and hence $\cC (y)$), we define a set of points $\cN (y)$ as follows. For $c \in \cC (y)$, define $n(c):= i$ as the maximal $1 \leq i \leq t(c)$ such that $\cR _{k_i}(c) \setminus \cR _{k_{i-1}}(c) \neq \emptyset $, where $\cR _0 = \emptyset $ by convention. Then add to the set $\cN (y)$ an arbitrary point $p(c) \in \cR _{k_i}(c) \setminus \cR _{k_{i-1}}(c)$. By processing in that way for all $c \in \cC (y)$, we obtain a set $\cN (y)$ with cardinality at most $\abs {\cC (y)}$. We claim that we can uniquely recover $\mathfrak {S}(y)$ from knowing the elements in both sets $\cC (y)$ and $\cN (y)$. Indeed, given $\cC (y)$ and $\cN (y)$, by construction, for every $c \in \cC (y)$, there is a minimal (and thus unique) $1 \leq t(c) \leq r(y)$ such that ${\cR }_{k_{t(c)}}(c) \cap \cN (y) \neq \emptyset $. Hence, the number of possible disjoint subcollections must be bounded by the number of choices for the two sets $\cC (y)$ and $\cN (y)$. Since the sizes of all classes involved are uniformly bounded from below by $\ell $, the cardinality of every $\cC (y)$ and $\cN (y)$ is bounded from above by $\lceil |\cR _n(y)|/\ell \rceil $. In light of that, we need to bound the expression \begin {eqnarray*} \big ( \lceil |\cR _n(y)|/\ell \rceil + 1 \big )^2 \, \binom {|\cR _n(y)|}{\lceil |\cR _n(y)| /\ell \rceil }^2. \end {eqnarray*} To do so, we use the entropy formula for the Stirling approximation. For this purpose, we define \[ E(\ell ):= \frac {1}{\ell }\, \log \,\ell + \Big (1 - \frac {1}{\ell } \Big )\,\log \,\Big (1 - \frac {1}{\ell } \Big )^{-1}. \] By Stirling's approximation (see e.g.\@ \cite {FS08}, Example~VIII.10), for large enough $n \in \NN $, we get \begin {eqnarray*} \binom {|\cR _n(y)|}{\lceil |\cR _n(y)|/\ell \rceil }^2 \leq \left (\exp \Big ( E(\ell /2)|\cR _n(y)| \Big )\right )^2 \leq 2^{4\,E(\ell /2)\,|\cR _n(y)|}. \end {eqnarray*} \par Now increasing $n$ if necessary, we can make sure that \[ \big ( \lceil \cR _n(y)/\ell \rceil +1 \big )^2\, \binom {|\cR _n(y)|}{\lceil |\cR _n(y)|/\ell \rceil }^2 \leq 2^{5\,E(\ell /2)\,|\cR _n(y)|}. \] Since $E(\ell ) \to 0$ as $\ell \to \infty $, we can find some $\ell $ such that $E(\ell /2) < \eta /5$, and this completes the proof of the claim.
END Proof
 
BEGIN Lemma 6.4  
 \label {lemma:dyncov1} Let $(B_k)$ be a sequence of measurable sets in $X \times Y$ such that \begin {eqnarray*} \lambda \times \nu \Bigg ( \bigcap _{k=1}^{\infty } \bigcup _{j \geq k} B_j \Bigg ) > 0. \end {eqnarray*} Then, for every $\delta > 0$ and $\lambda \times \nu $-a.e.\@ $(x,y) \in X \times Y$, there is $n(x,y) \in \NN $ for which the following holds true: for each $n \geq n(x,y)$, there is a disjoint collection of subsets of $\cR _n(y)$ \[ \mathfrak {S} = \big \{ \cR _{k_i}(b_i)\,|\, 1 \leq i \leq r \big \} \] with $b_i \in \cR _n(y)$ and $1 \leq k_i < n(x,y)$, such that \begin {enumerate}[(i)] \item $\big ( \alpha (b_i, y)x, b_i \big ) \in B_{k_i}$ for all $i$, \item $\sum _{C \in \mathfrak {S}} \abs {C} \geq (1-\delta )\,|\cR _n(y)|$. \end {enumerate}
END Lemma
 
BEGIN Proof 
 Let $\delta > 0$. We set \[ B^{*} := \bigcap _{k=1}^{\infty } \bigcup _{j \geq k} B_j. \] By assumption, $(\lambda \times \nu )(B^{*})> 0$. Given the hyperfinite exhaustion $(\cR _n)$, we fix $\Phi ^{X} \subseteq \operatorname {Aut}(\cR ^X)$ satisfying the conclusions of Proposition~\ref {prop:finitephin}. Since the extended relation $\cR ^X$ is ergodic, and since the set $\Phi ^X$ is generating for $\cR ^X$, we can use Lemma~\ref {lemma:ergodicity} in order to find a finite set $D\subset \Phi $ such that the lifted automorphisms $D^X \subseteq \Phi ^{X}$ satisfy \begin {eqnarray} \label {eqn:useergodicity} \lambda \times \nu \big ( D^X \circ B^{*} \big ) \geq 1- \delta /10. \end {eqnarray} Thus clearly $\lambda \times \nu \big ( B^{*} \big ) \geq (1- \delta /10)/\abs {D}$. Further, choose $M \in \NN $ such that Lemma~\ref {lemma:abstrcomb} holds true for the fixed parameters $\delta $ and $D$ for the relation $\cR $. \par The next step is to construct two finite increasing integer sequences $(m_i), (N_i)$, $1 \leq i \leq M$, according to the following algorithm. \begin {enumerate}[(1)] \item Define $m_1:= 1$. \item If $m_i$ has been chosen, then determine $N_i$ large enough such that \[ \lambda \times \nu \Big ( B^{*} \setminus \bigcup _{j=m_i}^{m_i + N_i} B_j \Big ) < \frac {\delta \cdot \lambda \times \nu (B^\ast )}{10\,M\,|D|}. \] \item Further, if $N_i$ has been chosen, choose $m_{i+1}$ large enough such that for every $l \geq m_{i+1}$, we get \[ \bigcup _{j < m_i + N_i} D \circ \cR _j^{-1}\cR _{l} \subseteq \cR _l. \] This is possible by Proposition~\ref {prop:finitephin} and since $D\subset \Phi $. In fact $D\circ \cR _n =\cR _n$ for all sufficiently large $n$. So it suffices that $m_{i+1} > m_i+N_i$ and also that $\cR _{m_{2}}$ (and hence each $\cR _{m_{i+1}}$) is invariant under $D$. \par \par \par \end {enumerate} With the sequences $(m_i), (N_i)$ at our disposal, we define \[ \tilde {B}^{*} := \bigcap _{i=1}^M \bigcup _{j=m_i}^{m_i + N_i} B_j. \] Clearly \[ \lambda \times \nu \big ( B^{*} \setminus \tilde {B}^{*} \big ) \leq \sum _{i=1}^M \lambda \times \nu \Big ( B^{*} \setminus \bigcup _{j=m_i}^{m_i+ N_i} B_j \Big ) < \frac {\delta \cdot \lambda \times \nu (B^\ast )}{10\,|D|}, \] and so \[ \lambda \times \nu \big ( D^X \circ B^{*} \setminus D^X \circ \tilde {B}^{*} \big ) < \frac {\delta \cdot \lambda \times \nu (B^\ast )}{10}. \] Consequently, \[ \lambda \times \nu \big ( D^X \circ \tilde {B}^{*} \big ) \geq \nu \big ( D^X \circ {B}^{*} \big ) - \frac {\delta \cdot \lambda \times \nu (B^\ast )}{10} \geq 1-\frac {\delta }{10}- \frac {\delta \cdot \lambda \times \nu (B^\ast )}{10}\ge 1-\frac {\delta }{5}. \] Now by the pointwise ergodic theorem (Theorem~\ref {thm:ETequiv}), for $\lambda \times \nu $-a.e.\@ $(x,y)$, we can define $n(x,y)$ as the smallest integer value greater than $m_M + N_M$ such that for all $n \geq n(x,y)$, we have \begin {eqnarray} \label {eqn:ErgThm} \cA \big ( n, \one _{D^X\circ \tilde {B}^{*}} \big )(x,y):= \big | \cR _n(y) \big |^{-1} \sum _{z \in \cR _n(y)} \one _{D^X \circ \tilde {B}^{*}}\big ( (\alpha (z,y)x,z) \big ) > 1 - \frac {\delta }{4}. \end {eqnarray} We fix some pair $(x,y)$ satisfying this condition, as well as $n \geq n(x,y)$. For $1 \leq i \leq M$ and $1 \leq j \leq N_i$, set ${\cT }_{i,j}:= \cR _{m_i + j - 1}$ and \[ A_{i,j}(y) := \big \{ b \in \cR _n(y) \,|\, \big ( \alpha (b,y)x, b \big ) \in B_{m_i + j -1} \big \}. \] By step~(3) of the algorithm and since $n > m_M + N_M$, we have $D \circ \cR _n \subseteq \cR _n$. In particular, each $\phi \in D$ gives rise to bijections $\phi :\cR _n(y)\to \cR _n(y)$, for a.e. $y\in Y$. \par \par Applying the transformations in the set $D$ to the sets $A_{i,j}(y)$, we then obtain \begin {eqnarray*} \end {eqnarray*} \begin {eqnarray*} D \circ \bigcup _{j=1}^{N_i} A_{i,j}(y) &=& \bigcup _{\phi \in D} \big \{ \phi (b) \,|\, b \in \cR _n(y), \big ( \alpha (b,y)x, b \big ) \in \bigcup _{j=1}^{N_i} B_{m_i + j -1} \big \} \\ &=& \big \{ b \in \cR _n(y)\,|\,\exists \, \phi \in D,\, b^{\prime } \in \cR _n(y): \, b = \phi (b^{\prime }),\, \big ( \alpha (b^{\prime }, y)x, b^{\prime } \big ) \in \bigcup _{j=1}^{N_i} B_{m_i + j -1} \big \} . \end {eqnarray*} Together with~\eqref {eqn:ErgThm}, this yields for all $1 \leq i \leq M$ : \begin {eqnarray*} \Big | \bigcup _{j=1}^{N_i} D \circ A_{i,j}(y) \Big | &=& \big | \big \{ b\in \cR _n(y)\,|\, \exists \, \phi \in D:\, b^\prime = \phi ^{-1}(b), \, \big ( \alpha (b^{\prime }, y)x, b^{\prime } \big ) \in \bigcup _{j=1}^{N_i} B_{m_i + j -1} \big \}\big | \\ \text {(using (\ref {phi^X}))} &=& \big | \big \{ b \in \cR _n(y)\,|\, \big ( \alpha (b,y)x, b \big ) \in D^X \circ \bigcup _{j=1}^{N_i} B_{m_i + j -1} \big \} \big | \\\text {(since $\tilde {B}^\ast $ is an intersection)} &\geq & \big | \cR _n(y) \big |\, \cA \big (n, \one _{D^X \circ \tilde {B}^{*}} \big )(x,y) \\ (\text {by the pointwise ergodic theorem}) &\geq &\Big ( 1- \frac {\delta }{4} \Big ) \,\big | \cR _n(y) \big |\,. \end {eqnarray*} \par We finally apply Lemma~\ref {lemma:abstrcomb} with $\delta /4$ instead of $\delta $ to the arrays ${\cT }_{i,j}$ and $A_{i,j}(y)$, where $1 \leq i \leq M$ and $1 \leq j \leq N_i$. The assumption of the Lemma is indeed satisfied, namely $\cT _{i,j}=\cR _{m_i+j-1}$ satisfy (5.1) by the construction of $m_2$, which guarantees $D\circ \cR _m=\cR _m$ for all $m \ge m_2$. Furthermore, we have just shown that $$\min _{1\le i \le M}\Big | \bigcup _{j=1}^{N_i} D \circ A_{i,j}(y) \Big |\ge \Big ( 1- \frac {\delta }{4} \Big ) \,\big | \cR _n(y) \big |$$ and hence Lemma~\ref {lemma:abstrcomb} implies that there is a disjoint subcollection \[ \mathfrak {S}(y) \subseteq \big \{\cT _{i,j}(b) \,|\, b \in A_{i,j}(y) \big \} \] with \[ \sum _{C \in \mathfrak {S}(y)} \abs {C} \geq (1-\delta )\,\big | \cR _n(y) \big |, \] as desired.
END Proof
 
BEGIN Lemma 6.5  
 \label {lemma:dyncov2} Let $(\cR _n)$ be a bounded hyperfinite exhaustion, and keep the assumptions of the previous lemma. Then, for the number \begin {eqnarray*} h:= \operatorname {ess-inf}_{x,y} \, \liminf _{n \to \infty } \frac {\cJ \big ( \cP ^{\cR _n(y)}(x)\big )}{|\cR _n(y)|}, \end {eqnarray*} the following holds true. For every $\delta > 0$, each $N \in \NN $ and $\lambda \times \nu $-a.e.\@ $(x,y)$, there is a number $n(x,y) \in \NN $ such that for all $n \geq n(x,y)$, we can find a disjoint collection (depending on both $x$ and $y$) \[ \mathfrak {S} = \big \{ \cR _{k_i}(b_i) \,|\, 1 \leq i \leq r \big \} \] such that all $b_i \in \cR _n(y)$ and $N \leq k_i < n(x,y)$ and further, \begin {enumerate}[(i)] \item for all $i$, \[ \frac {\cJ \big ( \cP ^{\cR _{k_i}(b_i)}\big ( \alpha (b_i,y)x\big ) \big )}{|\cR _{k_i}(b_i)|} \leq h + \delta , \] \item $\sum _{C \in \mathfrak {S}} \abs {C}\geq (1-\delta )\,|\cR _n(y)|$. \end {enumerate}
END Lemma
 
BEGIN Proof 
 We apply the previous Lemma~\ref {lemma:dyncov1} to the sequence $(\cR _n)_{n \geq N}$ and the sets \[ B_k := \Big \{ (x,y) \in X \times Y\, \big | \, \frac {\cJ \big ( \cP ^{\cR _{N+k}(y)}(x) \big )} {|\cR _{N + k}(y)|} \leq h + \delta \,\, \Big \}. \]
END Proof
 
BEGIN Proof 
 [{Proof of Theorem~\ref {thm:MAIN_SMBhyp}}] As before, we set \begin {eqnarray*} h:= \operatorname {essinf}_{x,y} \, \liminf _{n \to \infty } \frac {\cJ \big ( \cP ^{\cR _n(y)}(x)\big )}{|\cR _n(y)|}. \end {eqnarray*} If $h= \infty $, then there is nothing left to show. So assume that $h < \infty $. We show that for a.e.\@ $(x,y)$, \begin {eqnarray} \label {eqn:mainclaim} \limsup _{n \to \infty } \frac {\cJ \big ( \cP ^{\cR _n(y)}(x) \big )}{|\cR _n(y)|} \leq h. \end {eqnarray} To this end, fix $\delta > 0$. We find $N \in \NN $ large enough such that Lemma~\ref {lemma:comb} holds for $\eta = \delta $ and $\ell = N$. By the growth assumption on the $(\cR _n)$, we find $N_1 \in \NN $ such that for a full measure set of $y$'s, we have $|\cR _k(z)| \geq N$ for all $k \geq N_1$ and each $z \in [y]$. We have seen in Lemma~\ref {lemma:dyncov2} that for $\lambda \times \nu $-almost every $(x,y)$, there is $n(x,y) \in \NN $, $n(x,y) > N_1$, such that for $n > n(x,y)$, we obtain a special subcollection $\mathfrak {S}=\mathfrak {S}(x,y)$ of subsets of $\cR _n(y)$. Namely, this collection \begin {itemize} \item is disjoint, \item satisfies $\sum _{C \in \mathfrak {S}}\abs {C} \geq (1-\delta )\,|\cR _n(y)|$, \item Each $C \in \mathfrak {S}$ is of the form $\cR _{k}(b)$ with $N_1 \leq k< n(x,y)$ and $b \in \cR _n(y)$, which by the choice of $N_1$ implies that $|\cR _k(b)| \geq N$ for all $k \geq N_1$, \item writing $C= \cR _k(b) \in \mathfrak {S}$, the following holds \begin {eqnarray} \label {eqn:infaux} \frac {\cJ \big ( \cP ^{\cR _k(b)}\big (\alpha (b,y)x\big ) \big )}{|\cR _k(b)|} \leq h + \delta \,. \end {eqnarray} \end {itemize} By increasing $n$ if necessary, due to $|\cR _n(y)| \to \infty $, we can assume that \begin {eqnarray} \big | \cR _{n}(y) \big | \geq 8\delta ^{-1}\,( \log \, n ). \label {eqn:growth} \end {eqnarray} Let us now fix $x$, $y$, $n=n(x,y)$ and $\mathfrak {S}(x,y)=\mathfrak {S}$ satisfying all the conditions stated above. \par We first note that since $\cR _n(y)$ is the disjoint union of the sets $C = \cR _k(b_C) \in \mathfrak {S}$ and $\cG _n(y):= \cR _n(y) \setminus \bigcup _{C \in \mathfrak {S}} \cR _k(b_C)$, it follows that the partition $\cP ^{\cR _n(y)}$ is given by $\left (\bigvee _{C \in \mathfrak {S}} \cP ^{\cR _k(b_C)}\right )\vee \cP ^{\cG _n(y)}$. Therefore for any point $x\in X$, its $\cP ^{\cR _n(y)}$-name arises as the intersection of the $\cP ^{\cR _k(b_C)}$-name of $\alpha (b_C,y)x$ where $C = \cR _k(b_C) \in \mathfrak {S}$, and of the $\cP $-name of $\alpha (b,y)x$ for every $b \in \cG _n(y):= \cR _n(y) \setminus \bigcup _{C \in \mathfrak {S}} \cR _k(b_C)$. \par \par \par \par \par \par Consider the partition $\cP ^{\cR _n(y)}$ (which is finer than each partition $\cP ^{\cR _k(b)}$ when $b\in \cR _n(y)$) and define a set of atoms in it which we denote by $K_n(x,y)$. Namely, for our fixed $x$, we consider the disjoint collection $\mathfrak {S}(x,y)$ of subsets of $\cR _n(y)$, and we put an atom of $\cP ^{\cR _n(y)}$ in $K_n(x,y)$ provided that it arises as the intersection of elements of the partitions $\cP ^{\cR _k(b)}$ which satisfy inequality~\eqref {eqn:infaux} (where we allow any $\cR _k(b)=C \in \mathfrak {S}(x,y)$), with elements in the partition $\cP ^{\cG _n(y)}$. \par \par \par \par \par \par Now, for every $\cR _k(b)=C \in \mathfrak {S}(x,y)$, inequality \eqref {eqn:infaux} gives a lower bound on the measure of some of the atoms in the partition, and hence an upper bound on their number. It follows that for each such $C$, there are at most $2^{(h + \delta )|\cR _k(b)|}$ atoms of $\cP ^{\cR _k(b)}$ (namely $\cP ^{\cR _k(b)}$-names) for which the inequality~\eqref {eqn:infaux} can hold true. \par \par Consequently, the number of atoms of $\cP ^{\cR _n(y)}$ which appear as elements in $K_n(x,y)$ is bounded by \[ \prod _{C \in \mathfrak {S}} 2^{(h+\delta )\,|\cR _k(b)|} \cdot |\cP |^{|\cG _n(y)|} = \prod _{C \in \mathfrak {S}} 2^{(h + \delta )\,|C|} \cdot \abs {\cP }^{ |\cR _n(y) \setminus \bigcup \mathfrak {S}|}. \] Since $\cR _n(y)$ is disjointly $(1-\delta )$-covered by the elements in $\mathfrak {S}$, we conclude that for a fixed $x \in X$, there are at most \[ 2^{(h+\delta ) \,|\cR _n(y)|} \cdot |\cP |^{\delta \,|\cR _n(y)|} \] many elements in $K_n(x,y)$. \par \par $K_n(x,y)$ depends on both $x$ and $y$, having been constructed using the collection $\mathfrak {S}(x,y)$ of subsets on $\cR _n(y)$. Now, we define another collection of atoms of $\cP ^{\cR _m(y)}$, which we denote by $K_m(y)$. It consists of all the atoms in the sets $ K_m(x,y)$ as $x$ varies in $X$, provided that $n(x,y)$ satisfies the conditions stated above and in addition $n(x,y)\le m$. By Lemma~\ref {lemma:comb} (and the choices for $N$ and $N_1$), for all $m\ge m(y)$ the number of possibilities for $\mathfrak {S}(x,y)$ is bounded by $2^{\delta |\cR _m(y)|}$. Hence, we obtain \[ \big | K_m(y) \big | \leq 2^{( h + 2\delta + \delta \,\log |\cP | )\,|\cR _m(y)|}. \] We now consider the sets \[ X_m(y) := \Big \{ x \in X\,\big | \, \frac {\cJ \big ( \cP ^{\cR _m(y)}(x)\big )}{|\cR _m(y)|} > h + 3 \delta + \delta \,\log |\cP |\Big \}. \] \par Consider $\bigcup K_m(y)$, the union of all $\cP ^{\cR _m(y)}$-atoms which belong to $K_m(y)$. Then, \[ \lambda \big ( X_m(y) \cap \bigcup K_m(y) \big ) \leq \abs {K_m(y)}\,2^{-(h + 3\delta + \delta \,\log |\cP |)\,|\cR _m(y)|} \leq 2^{-\delta \,|\cR _m(y)|}. \] It follows from the growth condition~\eqref {eqn:growth} stated above that \[ 2^{-\delta \,|\cR _m(y)|} \leq 2^{\log \, m^{-8}} \leq \frac {1}{m^2} \] for large enough $m$. This implies that $\sum _{m=1}^{\infty } 2^{-\delta |\cR _m(y)|} < \infty $. Thus, for $\nu $-almost-every $y \in Y$, we can apply the Borel-Cantelli lemma and obtain that for $\lambda \times \nu $-almost every $(x,y)$, $x \notin X_m(y) \cap \bigcup K_m(y) $ if $m$ is large enough. On the other hand, we deduce from Lemma~\ref {lemma:dyncov2} that for large enough $m$ (depending on $x$ and $y$), $x \in \bigcup K_m(y)$. This implies that for $\lambda \times \nu $-a.e. $(x,y)$, and $m$ large enough, we must have $x \notin X_m(y)$, which means by definition of $X_m(y)$ that \[ \limsup _{m \to \infty } \frac {\cJ \big ( \cP ^{\cR _m(y)}(x) \big )}{|\cR _m(y)|} \leq h + 3\delta + \delta \,\log |\cP |. \] Letting $\delta \to 0$ yields \eqref {eqn:mainclaim}. This establishes almost everywhere convergence, as stated. Since the integrals of $\cJ \big ( \cP ^{\cR _m(y)}(x)\big )/\abs {\cR _m(y)}$ over $X\times Y$ converge to the cocycle entropy by Theorem~\ref {thm:MAINcocycleentropy}, we have $h = h^{*}_{\cP }(\alpha )$, as claimed.
END Proof
 
BEGIN Proof 
 [Proof of Corollary~\ref {cor:MAIN_SML1}] By Theorem~\ref {thm:MAIN_SMBhyp}, the normalized information function converges pointwise almost surely (w.r.t.\@ the measure $\lambda \times \nu $) to $h^{*}_{\cP } = h^{*}_{\cP }(\alpha )$. Fix $\varepsilon > 0$, and for $n \in \NN $ and fixed $y \in Y$, define \begin {eqnarray*} \mathcal {C}_n(y) := \Big \{ x \,\big | \, h^{*}_{\cP } - \varepsilon \leq \frac {\cJ \big ( \cP ^{\cR _n(y)}(x) \big )}{\big | \cR _n(y) \big |} \leq h^{*}_{\cP } + \varepsilon \Big \}. \end {eqnarray*} Integration over $X$ gives \begin {eqnarray*} \big ( h^{*}_{\cP } - \varepsilon \big )\,\lambda \big ( \cC _n(y) \big ) &\leq & \int _{\cC _n(y)} \frac {\cJ \big ( \cP ^{\cR _n(y)}(x) \big )}{|\cR _n(y)|}\,d\lambda (x) \\ &\leq & \int _X \frac {\cJ \big ( \cP ^{\cR _n(y)}(x) \big )}{|\cR _n(y)|}\,d\lambda (x) \\ &\leq & \big ( h^{*}_{\cP } + \varepsilon \big )\,\lambda \big ( \cC _n(y) \big ) + \int _{X \setminus \cC _n(y)} \frac {\cJ \big ( \cP ^{\cR _n(y)}(x) \big )}{|\cR _n(y)|}\,d\lambda (x). \end {eqnarray*} We define a new measure $\lambda ^{*}$ on $X\setminus \cC _n(y)$ by setting \[ \lambda ^{*}(A) := \frac {\lambda (A)}{\lambda (X \setminus \cC _n(y))}. \] Then, since $\cC _n(y)$ is a disjoint union of atoms of the partition $\cP ^{\cR _n(y)}$ of $X$, \begin {eqnarray*} \int _{X \setminus \cC _n(y)} \frac {\cJ \big ( \cP ^{\cR _n(y)}(x) \big )}{|\cR _n(y)|}\,d\lambda (x) &=& \lambda \big ( X \setminus \cC _n(y) \big ) \, \int _{X \setminus \cC _n(y)} \frac {\cJ ^{*}\big ( \cP ^{\cR _n(y)}(x) \big )} {\big | \cR _n(y) \big |}\,d\lambda ^{*}(x) \\ && \quad - \lambda \big ( X \setminus \cC _n(y) \big )\, \log \big ( \lambda (X \setminus \cC _n(y)) \big ), \end {eqnarray*} where $\cJ ^{*}$ denotes the information function with respect to $\lambda ^{*}$. Now since the integral on the right hand side in the inequality above is just the Shannon entropy of the partition $\cP ^{\cR _n(y)}$ with respect to the measure $\lambda ^{*}$, we arrive at \begin {eqnarray*} \int _{X \setminus \cC _n(y)} \frac {\cJ \big ( \cP ^{\cR _n(y)}(x) \big )}{|\cR _n(y)|}\,d\lambda (x) \leq \lambda \big ( X \setminus \cC _n(y) \big )\,\log |\cP | - \lambda \big ( X \setminus \cC _n(y) \big )\, \log \big ( \lambda (X \setminus \cC _n(y)) \big ). \end {eqnarray*} Clearly, by Theorem~\ref {thm:MAIN_SMBhyp}, for $\nu $-almost every $y\in Y$, the latter expression tends to zero as $n \to \infty $. Now sending $\varepsilon \to 0$ yields the first assertion of the claimed statement. For the second statement note that due to the dominated convergence theorem (with dominating function $g(y):= 2\,|\cP |$) we have \begin {eqnarray*} \lim _{n \to \infty } \int _Y \int _X \Big | \frac {\cJ \big ( \cP ^{\cR _n(y)}(x) \big )}{|\cR _n(y)|} - h^{*}_{\cP } \Big |\,d\lambda (x)\,d\nu (y) = 0. \end {eqnarray*} This concludes the proof of the corollary.
END Proof
 
BEGIN Examples 7.1  
 \begin {enumerate} \par \par \item Let $\Gamma $ be an irreducible lattice in a connected semisimple Lie group with finite center and without compact factors. Then the action of $\Gamma $ on the maximal boundary $(G/P,m)$, where $P$ is a minimal parabolic subgroup and $m$ is the Lebesgue measure class, is amenable and has {\it stable type} $III_1$, see \cite {BN13b}. \item Let $\Gamma $ be a discrete non-elementary subgroup of isometries of real hyperbolic space. By \cite {Su78} \cite {Su82}, the type of the action of $\Gamma $ on the boundary of hyperbolic space with respect to the Lebesgue measure class is $III_1$. In \cite {Sp87} this result was proved for the action of fundamental groups of compact connected negatively curved manifolds acting on the visual boundary with the manifold measure class. \par \item Let $\Gamma $ be a finitely generated free group. By \cite {RR97}, the action of $\Gamma $ has non-trivial type with respect to harmonic measures, namely stationary measures of suitable random walks. For $\Gamma $ being a word hyperbolic group, it was proved in \cite {INO08} that the action of $\Gamma $ on the Poisson boundary associated with a generating measure of finite support has non-trivial type. \item In \cite {Bo14} it was proved that for word hyperbolic groups (with an additional technical condition) the action on the Gromov boundary with respect to a quasi-conformal measure (and in particular the Patterson-Sullivan measure) measure has non-trivial {\it stable type}.\end {enumerate}
END Examples
 
BEGIN Theorem 8.1  
 \cite {BN13a}\label {F^2-ergodic}. If $\mathbb {F}_{r}^{e}$ acts on $(X,\lambda )$ ergodically, then the diagonal action $\mathbb {F}_{r}^{e}\curvearrowright X\times \partial \mathbb {F}_{r}$ is ergodic.
END Theorem
 
