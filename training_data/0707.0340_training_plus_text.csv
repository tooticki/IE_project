words_num,awerage_word_length,italicness,formuleness,heading_first_word,boldness_first_word,is_capital_first_letter,type,text
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
1,1.0,0.0,0.0,False,0.0,False,text," r
"
1,1.0,0.0,0.0,False,0.0,False,text," p
"
1,1.0,0.0,0.0,False,0.0,True,text," A
"
1,1.0,0.0,0.0,False,0.0,False,text," 6
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
1,1.0,0.0,0.0,False,0.0,False,text," ]
"
1,1.0,0.0,0.0,False,0.0,False,text," .
"
1,1.0,0.0,0.0,False,0.0,True,text," O
"
1,1.0,0.0,0.0,False,0.0,True,text," C
"
1,1.0,0.0,0.0,False,0.0,False,text," h
"
1,1.0,0.0,0.0,False,0.0,False,text," t
"
1,1.0,0.0,0.0,False,0.0,False,text," a
"
1,1.0,0.0,0.0,False,0.0,False,text," m
"
1,1.0,0.0,0.0,False,0.0,False,text," [
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
1,1.0,0.0,0.0,False,0.0,False,text," v
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
1,1.0,0.0,0.0,False,0.0,False,text," .
"
1,1.0,0.0,0.0,False,0.0,False,text," 7
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
1,1.0,0.0,0.0,False,0.0,False,text," 7
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
1,1.0,0.0,0.0,False,0.0,False,text," :
"
1,1.0,0.0,0.0,False,0.0,False,text," v
"
1,1.0,0.0,0.0,False,0.0,False,text," i
"
1,1.0,0.0,0.0,False,0.0,True,text," X
"
1,1.0,0.0,0.0,False,0.0,False,text," r
"
1,1.0,0.0,0.0,False,0.0,False,text," a
"
5,8.0,0.0,0.0,False,0.0,True,text," Asymptotic enumeration of sparse nonnegative
"
8,5.25,0.0,0.0,False,0.0,False,text," integer matrices with specied row and column sums
"
2,9.0,0.0,0.0,False,0.0,True,text," Catherine Greenhill
"
3,4.66666666667,0.0,0.0,False,0.0,True,text," Brendan D. McKay
"
5,6.4,0.0,0.0,False,0.0,True,text," School of Mathematics and Statistics
"
5,6.2,0.0,0.0,False,0.0,True,text," Research School of Computer Science
"
6,4.66666666667,0.0,0.0,False,0.0,True,text," The University of New South Wales
"
3,9.33333333333,0.0,0.0,False,0.0,True,text," Australian National University
"
4,5.75,0.0,0.0,False,0.0,True,text," Sydney NSW 2052, Australia
"
4,6.5,0.0,0.0,False,0.0,True,text," Canberra, ACT 0200, Australia
"
1,15.0,0.0,0.0,False,0.0,False,text," csg@unsw.edu.au
"
1,17.0,0.0,0.0,False,0.0,False,text," bdm@cs.anu.edu.au
"
8,9.625,0.0,0.0,False,0.0,True,text," Keywords: asymptotic enumeration, non-negative integer matrices, contingency tables,
"
1,10.0,0.0,0.0,False,0.0,False,text," switchings
"
5,5.0,0.0,0.0,False,0.0,True,text," MSC 2000: 05A16, 05C50, 62H17
"
1,8.0,0.0,0.0,False,1.0,True,text," Abstract
"
4,2.0,0.0,0.583333333333,False,0.0,False,text," i=1 si = Pn
"
23,2.95652173913,0.0,0.449275362319,False,0.0,True,text," Let s = (s1, . . . , sm) and t = (t1, . . . , tn) be vectors of nonnegative integer-valued
"
10,3.0,0.0,0.4,False,0.0,False,text," functions of m, n with equal sum S = Pm
"
9,2.88888888889,0.0,0.259259259259,False,0.0,False,text," j=1 tj. Let M (s, t) be the number
"
16,4.0,0.0,0.145833333333,False,0.0,False,text," of m  n matrices with nonnegative integer entries such that the ith row has row
"
18,3.5,0.0,0.212962962963,False,0.0,False,text," sum si and the jth column has column sum tj for all i, j. Such matrices occur in
"
11,6.18181818182,0.0,0.0,False,0.0,False,text," many dierent settings, an important example being the contingency tables (also
"
16,4.25,0.0,0.260416666667,False,0.0,False,text," called frequency tables) important in statistics. Dene s = maxi si and t = maxj tj.
"
18,3.44444444444,0.0,0.240740740741,False,0.0,True,text," Previous work has established the asymptotic value of M (s, t) as m, n   with s
"
12,5.75,0.0,0.0833333333333,False,0.0,False,text," and t bounded (various authors independently, 19711974), and when all entries of
"
21,3.14285714286,0.0,0.333333333333,False,0.0,False,text," s equal s, all entries of t equal t, and m/n, n/m, s/n  c/ log n for suciently large c
"
15,4.26666666667,0.0,0.0,False,0.0,False,text," (Caneld and McKay, 2007). In this paper we extend the sparse range to the case
"
14,4.78571428571,0.0,0.0982142857143,False,0.0,False,text," st = o(S2/3). The proof in part follows a previous asymptotic enumeration of 0-1
"
12,5.5,0.0,0.0,False,0.0,False,text," matrices under the same conditions (Greenhill, McKay and Wang, 2006). We also
"
12,5.91666666667,0.0,0.0,False,0.0,False,text," generalise the enumeration to matrices over any subset of the nonnegative integers
"
5,3.6,0.0,0.0,False,0.0,False,text," that includes 0 and 1.
"
13,4.84615384615,0.692307692308,0.0,False,0.0,True,text," Note added in proof, 2011: This paper appeared in Advances in Applied Math-
"
16,3.6875,0.0625,0.0,False,0.0,False,text," ematics 41 (2008), 459481. Here we x a small gap in the proof of Lemma 5.1
"
13,5.07692307692,0.0,0.0,False,0.0,False,text," and make some other minor corrections. We emphasise that the statements of our
"
4,5.5,0.0,0.0,False,0.0,False,text," results have not changed.
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,1.0,False,text," 1
"
1,12.0,0.0,0.0,False,1.0,True,text," Introduction
"
28,2.42857142857,0.0,0.440476190476,False,0.0,True,text," Let s = s(m, n) = (s1, . . . , sm) and t = t(m, n) = (t1, . . . , tn) be vectors of nonnegative
"
7,3.42857142857,0.0,0.285714285714,False,0.0,False,text," integers with equal sum S = Pm
"
13,2.30769230769,0.0,0.269230769231,False,0.0,False,text," j=1 tj. Let M(s, t) be the set of all m  n
"
16,4.4375,0.0,0.0833333333333,False,0.0,False,text," matrices with nonnegative integer entries such that the ith row has row sum si and the
"
20,3.2,0.0,0.213333333333,False,0.0,False,text," jth column has column sum tj for each i, j. Then dene M(s, t) = |M(s, t)| to be the
"
4,5.25,0.0,0.0,False,0.0,False,text," number of such matrices.
"
4,2.0,0.0,0.583333333333,False,0.0,False,text," i=1 si = Pn
"
19,3.26315789474,0.0,0.131578947368,False,0.0,True,text," Our task in this paper is to determine the asymptotic value of M(s, t) as m, n  
"
7,4.42857142857,0.0,0.0,False,0.0,False,text," under suitable conditions on s and t.
"
13,5.38461538462,0.0,0.0384615384615,False,0.0,True,text," The matrices M(s, t) appear in many combinatorial contexts; see Stanley [16, Chap-
"
17,4.41176470588,0.0,0.0,False,0.0,False,text," ter 1] for a brief history. A large body of statistical literature is devoted to them under
"
17,4.52941176471,0.226890756303,0.0,False,0.0,False,text," the name of contingency tables or frequency tables; see [6, 7] for a partial survey. In theo-
"
14,5.35714285714,0.0,0.0,False,0.0,False,text," retical computer science there has been interest in ecient algorithms for the problem of
"
11,6.90909090909,0.0,0.0,False,0.0,False,text," generating contingency tables with prescribed margins at random, and for approximately
"
9,4.66666666667,0.0,0.0,False,0.0,False,text," counting these tables. See for example [1, 8, 14].
"
12,6.0,0.0,0.0,False,0.0,True,text," The history of the enumeration problem for nonnegative integer matrices is surveyed
"
17,4.52941176471,0.0,0.0,False,0.0,False,text," in [5], while a history for the corresponding problem for 0-1 matrices is given in [12]. Here
"
13,5.76923076923,0.0,0.0,False,0.0,False,text," we recall only the few previous exact results on asymptotic enumeration for nonnegative
"
22,2.95454545455,0.0,0.212121212121,False,0.0,False,text," integer matrices. Dene s = maxi si and t = maxj tj. The rst non-trivial case s1 =    =
"
22,2.68181818182,0.0,0.113636363636,False,0.0,False,text," sm = t1 =    = tn = 3 was solved by Read [15] in 1958. During the period 197174,
"
14,5.21428571429,0.0,0.142857142857,False,0.0,False,text," this was generalised to bounded s, t by three independent groups: Bekessy, Bekessy and
"
13,5.61538461538,0.0,0.0,False,0.0,True,text," Komlos [2], Bender [3], and Everett and Stein [9], under slightly dierent conditions.
"
14,4.85714285714,0.0,0.0,False,0.0,True,text," In the case of denser matrices, the only precise asymptotics were found by Caneld
"
20,3.45,0.0,0.0,False,0.0,False,text," and McKay [5] in the case that the row sums are all the same and the column sums are all
"
27,2.74074074074,0.0,0.553086419753,False,0.0,False,text," the same. Let M(m, s; n, t) = M((s, s, . . . , s), (t, t, . . . , t)), where the vectors have length
"
7,3.71428571429,0.0,0.380952380952,False,0.0,False,text," m, n, respectively, and ms = nt.
"
18,4.05555555556,0.296296296296,0.240740740741,True,1.0,True,heading," Theorem 1.1 ([5, Theorem 1]). Let s = s(m, n), t = t(m, n) be positive integers satisfying
"
23,2.13043478261,0.297101449275,0.322463768116,False,0.0,False,body," ms = nt. Dene  = s/n = t/m. Let a, b  0 be constants such that a + b  1
"
3,3.0,0.666666666667,0.0,False,0.0,False,text," 2 . Suppose
"
10,2.1,0.6,0.2,False,0.0,False,body," that m, n   in such a way that
"
3,2.0,0.0,0.111111111111,False,0.0,False,body," (1 + 2)2
"
1,2.0,0.0,0.5,False,0.0,False,after_body," 5n
"
1,5.0,0.0,0.0,False,0.0,False,text," (1.1)
"
4,1.75,0.0,0.333333333333,False,0.0,False,body," 4(1 + )1 +
"
1,2.0,0.0,0.5,False,0.0,False,after_body," 5m
"
1,2.0,0.0,0.5,False,0.0,False,text," 6n
"
1,1.0,0.0,0.0,False,0.0,False,heading," +
"
5,1.6,0.0,0.6,False,0.0,False,body," 6m  a log n.
"
6,2.5,0.430555555556,0.444444444444,False,0.0,True,body," Dene (m, s; n, t) by
"
5,2.2,0.0,0.55,False,0.0,True,text," M(m, s; n, t) =
"
5,0.8,0.0,0.6,False,0.0,False,body," n + s  1
"
1,1.0,0.0,1.0,False,0.0,False,body," s
"
5,1.0,0.0,0.6,False,0.0,False,body," mm + t  1
"
1,0.0,0.0,0.0,False,0.0,False,body," 
"
5,1.2,0.0,0.6,False,0.0,False,body," mn + mn  1
"
1,2.0,0.0,1.5,False,0.0,False,after_body," mn
"
1,1.0,0.0,1.0,False,0.0,False,text," t
"
1,1.0,0.0,2.0,False,0.0,False,heading," n
"
4,0.75,0.0,0.25,False,0.0,False,body,"  m + 1
"
4,2.5,0.0,0.464285714286,False,0.0,False,text," m (m1)/2n + 1
"
2,3.5,0.0,0.833333333333,False,0.0,False,text," n (n1)/2
"
2,2.0,0.0,0.333333333333,False,0.0,False,text," exp 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,heading," +
"
4,2.25,0.0833333333333,0.666666666667,False,0.0,False,body," (m, s; n, t)
"
3,1.0,0.0,0.666666666667,False,0.0,False,body," m + n
"
1,1.0,0.0,2.0,False,0.0,False,after_body," .
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
14,2.14285714286,0.238095238095,0.491496598639,False,0.0,True,body," Then (m, s; n, t) = O(nb)(m + n) as m, n  .
"
21,2.71428571429,0.015873015873,0.222222222222,False,0.0,True,text," Caneld and McKay conjectured that in fact 0  (m, s; n, t)  2 for all s, t  1.
"
16,4.6875,0.0,0.125,False,0.0,True,text," The results in the present paper establish that conjecture for suciently large m, n in the
"
7,4.85714285714,0.0,0.238095238095,False,0.0,False,text," case st = o(mn)1/5. (See Corollary 4.2.)
"
18,3.83333333333,0.0,0.104166666667,False,0.0,True,text," The main result in this paper is the asymptotic value of M(s, t) for st = o(S2/3). Our
"
16,4.5,0.0,0.0,False,0.0,False,text," proof uses the method of switchings in a number of dierent ways. In several aspects our
"
14,5.35714285714,0.0,0.0357142857143,False,0.0,False,text," approach is parallel to that which provided our previous asymptotic estimate of N(s, t),
"
17,4.11764705882,0.0,0.0294117647059,False,0.0,False,text," the number of 0-1 matrices in the class M(s, t). We now restate that result for conve-
"
20,3.3,0.0,0.148928571429,False,0.0,False,text," nience. For any x, dene [x]0 = 1 and for a positive integer k, [x]k = x(x1)   (xk+1).
"
2,4.0,0.0,0.0,False,0.0,True,text," Also dene
"
1,1.0,0.0,1.0,False,0.0,False,text," m
"
1,1.0,0.0,1.0,False,0.0,False,text," n
"
2,1.5,0.0,0.5,False,0.0,True,text," Sk =
"
1,4.0,0.0,0.5,False,0.0,True,text," Xi=1
"
1,6.0,0.0,0.666666666667,False,0.0,False,text," [si]k,
"
2,1.5,0.0,0.5,False,0.0,True,text," Tk =
"
1,5.0,0.0,0.6,False,0.0,False,text," [tj]k
"
1,4.0,0.0,0.5,False,0.0,True,text," Xj=1
"
11,2.0,0.0,0.227272727273,False,0.0,False,text," for k  1. Note that S1 = T1 = S.
"
23,2.82608695652,0.0869565217391,0.311594202899,True,1.0,True,body," Theorem 1.2 ([12, Corollary 5.1]). Let s = s(m, n) = (s1, . . . , sm) and t = t(m, n) =
"
2,3.0,0.166666666667,0.5,False,0.0,False,text," j=1 tj.
"
17,3.35294117647,0.470588235294,0.421568627451,False,0.0,False,heading," (t1, . . . , tn) be vectors of nonnegative integers with equal sum S = Pm
"
16,2.1875,0.3203125,0.3359375,False,0.0,True,body," Suppose that m, n  , S   and 1  st = o(S2/3). Then
"
4,2.0,0.0,0.583333333333,False,0.0,False,body," i=1 si = Pn
"
3,2.33333333333,0.0,0.166666666667,False,0.0,True,text," N(s, t) =
"
1,2.0,0.0,0.5,False,0.0,True,text," S!
"
3,2.66666666667,0.0,0.666666666667,False,0.0,False,text," i=1 si! Qn
"
1,2.0,0.0,1.0,False,0.0,True,text," Qm
"
2,3.0,0.0,0.5,False,0.0,False,text," j=1 tj!
"
1,3.0,0.0,0.666666666667,False,0.0,False,text," exp
"
1,4.0,0.0,0.5,False,0.0,True,text," S2T2
"
2,1.5,0.0,0.166666666667,False,0.0,False,text," 2S2 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,4.0,0.0,0.5,False,0.0,True,text," S3T3
"
2,1.5,0.0,0.166666666667,False,0.0,False,text," 3S3 
"
1,4.0,0.0,0.5,False,0.0,True,text," S2T2
"
2,2.0,0.0,0.166666666667,False,0.0,False,text," 2S3 +
"
1,2.0,0.0,0.5,False,0.0,True,heading," S2
"
5,1.6,0.0,0.233333333333,False,0.0,False,body," 2 T3 + S3T 2
"
1,1.0,0.0,0.0,False,0.0,False,after_body," 2
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," 2S4
"
3,3.66666666667,0.0,0.253968253968,False,0.0,True,body," S2T2(S2 + T2)
"
1,3.0,0.0,0.333333333333,False,0.0,False,after_body," 4S4
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
2,1.5,0.0,0.25,False,0.0,False,text," 2T 2
"
1,2.0,0.0,0.5,False,0.0,True,text," S2
"
3,3.0,0.0,0.377777777778,False,0.0,False,text," 2S5 + Os3t3
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
2,1.5,0.0,1.75,False,0.0,True,text," S2 .
"
16,4.3125,0.0,0.03125,False,0.0,True,text," We now state our main result, which is the asymptotic value of M(s, t) for suciently
"
13,5.46153846154,0.0,0.0,False,0.0,False,text," sparse matrices. Note that the answer is obtained by multiplying the expression for
"
10,4.6,0.0,0.05,False,0.0,True,text," N(s, t) from Theorem 1.2 by a simple adjustment factor.
"
28,2.35714285714,0.142857142857,0.440476190476,True,1.0,True,text," Theorem 1.3. Let s = s(m, n) = (s1, . . . , sm) and t = t(m, n) = (t1, . . . , tn) be vectors
"
8,2.625,0.416666666667,0.5,False,0.0,False,text," j=1 tj. Suppose that m, n  ,
"
9,4.11111111111,0.666666666667,0.222222222222,False,0.0,False,text," of nonnegative integers with equal sum S = Pm
"
10,2.0,0.2125,0.2375,False,0.0,True,text," S   and 1  st = o(S2/3). Then
"
3,2.66666666667,0.0,0.433333333333,False,0.0,True,text," S3 + Os3t3
"
6,3.33333333333,0.0,0.238095238095,False,0.0,True,text," M(s, t) = N(s, t) expS2T2
"
2,1.5,0.0,0.25,False,0.0,True,text," S2 +
"
4,2.0,0.0,0.583333333333,False,0.0,False,text," i=1 si = Pn
"
2,1.0,0.0,0.25,False,0.0,True,text," S2 
"
1,4.0,0.0,0.5,False,0.0,True,text," S2T2
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,2.0,0.0,0.5,False,0.0,True,text," S!
"
3,2.66666666667,0.0,0.666666666667,False,0.0,False,text," i=1 si! Qn
"
1,2.0,0.0,1.0,False,0.0,True,text," Qm
"
2,3.0,0.0,0.5,False,0.0,False,text," j=1 tj!
"
1,7.0,0.0,0.428571428571,False,0.0,False,text," expS2T2
"
2,2.0,0.0,0.166666666667,False,0.0,False,text," 2S2 +
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
1,4.0,0.0,0.5,False,0.0,True,text," S2T2
"
1,4.0,0.0,0.5,False,0.0,True,text," S3T3
"
2,1.5,0.0,0.166666666667,False,0.0,False,text," 3S3 
"
2,2.0,0.0,0.166666666667,False,0.0,False,text," 2S3 +
"
1,2.0,0.0,0.5,False,0.0,True,text," S2
"
5,1.6,0.0,0.233333333333,False,0.0,False,text," 2 T3 + S3T 2
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," 2S4
"
3,3.66666666667,0.0,0.253968253968,False,0.0,True,text," S2T2(S2 + T2)
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," 4S4
"
2,1.5,0.0,0.25,False,0.0,False,text," 2T 2
"
1,2.0,0.0,0.5,False,0.0,True,text," S2
"
3,3.0,0.0,0.377777777778,False,0.0,False,text," 2S5 + Os3t3
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
2,1.5,0.0,1.75,False,0.0,True,text," S2 .
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
17,4.05882352941,0.0588235294118,0.0,False,0.0,True,text," Proof. The proof of this theorem is presented in Sections 2 and 3. First we show that
"
17,4.05882352941,0.0,0.0294117647059,False,0.0,False,text," the set of matrices in M(s, t) with an entry greater than 3 forms a vanishingly small
"
18,3.77777777778,0.0,0.0555555555556,False,0.0,False,text," proportion of M(s, t). We also show that it is very unusual for an element of M(s, t)
"
19,3.52631578947,0.0,0.0,False,0.0,False,text," to have a large number of entries equal to 2 or a large number of entries equal to 3,
"
14,5.0,0.0,0.0,False,0.0,False,text," where largeness is dened in Section 2. We establish these facts using switchings on
"
16,4.5625,0.0,0.03125,False,0.0,False,text," the matrix entries. This allows us to concentrate on matrices in M(s, t) with no entries
"
13,3.46153846154,0.0,0.0,False,0.0,False,text," greater than 3 and not very many entries equal to 2 or 3.
"
16,4.3125,0.0,0.0,False,0.0,True,text," We then proceed in Section 3 to compare the number of these matrices with the number
"
18,3.72222222222,0.0,0.0698653198653,False,0.0,True,text," N(s, t) of {0, 1}-matrices with row sums s and column sums t. We do this by adapting
"
15,4.8,0.0,0.0,False,0.0,False,text," the results from [12] used to prove Theorem 1.2. These calculations are carried out in
"
14,5.07142857143,0.0,0.0,False,0.0,False,text," the pairing model, which is described in Section 3. Our theorem follows on combining
"
6,4.83333333333,0.0,0.0,True,0.0,True,text," Lemmas 3.1, 3.2 and Corollary 3.8.
"
24,2.04166666667,0.0,0.3125,False,0.0,True,text," In the semiregular case where si = s for 1  i  m and tj = t for 1  j  n,
"
5,5.4,0.0,0.0,True,0.0,True,text," Theorem 1.3 says the following.
"
18,3.44444444444,0.388888888889,0.277777777778,True,1.0,True,heading," Corollary 1.4. Suppose that m, n   and that sm = tn = S for nonnegative integer
"
21,2.61904761905,0.222222222222,0.37358276644,False,0.0,False,body," functions s = s(m, n), t = t(m, n) and S = S(m, n). If 1  st = o(S2/3) then
"
5,2.2,0.0,0.55,False,0.0,True,text," M(m, s; n, t) =
"
1,2.0,0.0,0.5,False,0.0,True,text," S!
"
8,2.625,0.0,0.235416666667,False,0.0,False,text," (s!)m (t!)n exp (s  1)(t  1)
"
1,1.0,0.0,0.0,False,0.0,False,heading," 2
"
11,1.54545454545,0.0,0.280303030303,False,0.0,False,body," (s  1)(t  1)(2st  s  t  10)
"
1,3.0,0.0,0.333333333333,False,0.0,False,after_body," 12S
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
2,3.0,0.0,0.4,False,0.0,False,text," + Os3t3
"
2,1.5,0.0,1.75,False,0.0,True,text," S2 .
"
14,4.92857142857,0.0,0.0,False,0.0,True,text," For some applications the statement of Theorem 1.3 is not very convenient. In Sec-
"
16,4.5,0.0,0.03125,False,0.0,False,text," tion 4 we will derive an alternative formulation, very similar to one given for N(s, t)
"
8,2.5,0.0,0.1875,False,0.0,False,text," in [12]. For k = 2, 3, dene
"
2,1.0,0.0,1.0,False,0.0,False,text," k =
"
2,1.0,0.0,1.0,False,0.0,False,text," k =
"
1,2.0,0.0,1.0,False,0.0,False,text," mn
"
3,2.33333333333,0.0,0.416666666667,False,0.0,True,text," S(mn + S)
"
1,2.0,0.0,1.0,False,0.0,False,text," mn
"
3,2.33333333333,0.0,0.416666666667,False,0.0,True,text," S(mn + S)
"
1,1.0,0.0,1.0,False,0.0,False,text," m
"
1,4.0,0.0,0.5,False,0.0,True,text," Xi=1
"
1,4.0,0.0,0.5,False,0.0,True,text," Xj=1
"
1,1.0,0.0,1.0,False,0.0,False,text," n
"
3,2.66666666667,0.0,0.488888888889,False,0.0,False,text," (si  S/m)k
"
3,3.0,0.0,0.5,False,0.0,False,text," (tj  S/n)k.
"
18,3.83333333333,0.0,0.166666666667,False,0.0,True,text," To motivate the denitions, recall that S/m is the mean value of si and S/n is the mean
"
16,4.5625,0.0,0.0416666666667,False,0.0,False,text," value of tj, so these are scaled central moments. We will prove Corollary 4.1, stated in
"
8,5.125,0.0,0.0,False,0.0,True,text," Section 4, which has the following special case.
"
17,4.0,0.470588235294,0.0693277310924,True,1.0,True,heading," Corollary 1.5. Under the conditions of Theorem 1.3, if (1 + 2)(1 + 2) = O(S1/3) then
"
1,1.0,0.0,1.0,False,0.0,False,after_body," m
"
1,4.0,0.0,0.5,False,0.0,True,text," Yi=1
"
3,2.33333333333,0.0,0.166666666667,False,0.0,True,text," M(s, t) =
"
1,5.0,0.0,1.0,False,0.0,False,text," n+si1
"
3,1.0,0.0,0.666666666667,False,0.0,False,text," si  n
"
1,4.0,0.0,0.5,False,0.0,True,text," Yj=1
"
1,5.0,0.0,1.0,False,0.0,False,text," mn+S1
"
1,5.0,0.0,1.0,False,0.0,False,text," m+tj1
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,2.0,0.0,1.0,False,0.0,False,text," tj
"
1,1.0,0.0,1.0,False,0.0,True,text," S
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
2,2.0,0.0,0.166666666667,False,0.0,False,text," exp 1
"
1,1.0,0.0,0.0,False,0.0,False,heading," 2
"
8,1.5,0.0,0.46875,False,0.0,False,body," (1  2)(1  2) + O st
"
1,5.0,0.0,1.0,False,0.0,True,after_body," S2/3.
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
13,5.38461538462,0.0,0.0384615384615,True,0.0,True,text," Corollary 1.5 has an instructive interpretation. Following [5], we write M(s, t) =
"
2,6.0,0.0,0.285714285714,False,0.0,True,text," MP1P2E, where
"
1,1.0,0.0,1.0,False,0.0,True,text," S
"
3,2.33333333333,0.0,0.666666666667,False,0.0,True,text," M = mn+S1
"
4,1.5,0.0,0.333333333333,False,0.0,True,body," E = exp 1
"
5,1.2,0.0,0.9,False,0.0,False,text," , P1 = M 1
"
1,5.0,0.0,1.0,False,0.0,False,text," n+si1
"
1,4.0,0.0,0.5,False,0.0,True,text," Yi=1
"
8,1.5,0.0,0.46875,False,0.0,False,text," (1  2)(1  2) + O st
"
1,5.0,0.0,1.0,False,0.0,True,text," S2/3.
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,1.0,False,0.0,False,text," m
"
6,1.33333333333,0.0,0.916666666667,False,0.0,False,text," si , P2 = M 1
"
1,1.0,0.0,1.0,False,0.0,False,text," n
"
1,4.0,0.0,0.5,False,0.0,True,text," Yj=1
"
1,5.0,0.0,1.0,False,0.0,False,text," m+tj1
"
1,2.0,0.0,1.0,False,0.0,False,text," tj
"
1,1.0,0.0,2.0,False,0.0,False,text," ,
"
18,3.72222222222,0.0,0.194444444444,False,0.0,True,text," Clearly, M is the number of m  n nonnegative matrices whose entries sum to S. In the
"
16,4.6875,0.0,0.09375,False,0.0,False,text," uniform probability space on these M matrices, P1 is the probability of the event that the
"
19,3.63157894737,0.0,0.0263157894737,False,0.0,False,text," row sums are given by s and P2 is the probability of the event that the column sums are
"
16,4.5,0.0,0.0625,False,0.0,False,text," given by t. The nal quantity E is thus a correction to account for the non-independence
"
4,4.25,0.0,0.0,False,0.0,False,text," of these two events.
"
15,4.73333333333,0.0,0.0,False,0.0,True,text," Finally, in Section 5 we show how to generalise Theorem 1.3 to matrices whose entries
"
14,4.35714285714,0.0,0.0,False,0.0,False,text," are restricted to any subset of the natural numbers that includes 0 and 1.
"
19,3.36842105263,0.0,0.0263157894737,False,0.0,True,text," A note on our usage of the O( ) notation in the following is in order. Given a xed
"
17,4.05882352941,0.0,0.139705882353,False,0.0,False,text," function f (S) = o(S2/3), and any quantity  that depends on any of our variables, O()
"
15,4.73333333333,0.0,0.155555555556,False,0.0,False,text," denotes any quantity whose absolute value is bounded above by |c| for some constant c
"
15,3.26666666667,0.186666666667,0.216666666667,False,0.0,False,text," that depends on f and nothing else, provided that 1  st  f (S).
"
16,4.125,0.3125,0.0,False,0.0,True,text," Note added in proof, 2011: This version of the paper the same as the journal ver-
"
5,5.0,0.0,0.0,False,0.0,False,text," sion [11], except as follows:
"
17,3.94117647059,0.0,0.0,False,0.0,False,text,"  Theorem 2.1, a statement of a special case of a more general result from [10], was
"
16,4.375,0.0,0.0625,False,0.0,False,text," previously incomplete. The rst inequality in (2.1) need only hold if v is a sink, but
"
6,4.83333333333,0.0,0.0,False,0.0,False,text," this condition was absent in [11].
"
18,3.55555555556,0.0,0.0,False,0.0,False,text,"  A note has been added at the end of the proofs of Lemmas 3.5 and 3.7, clarifying
"
17,3.94117647059,0.0,0.0,False,0.0,False,text," why it is valid to apply [12, Lemma 4.6] and [12, Lemma 4.8] with a possibly larger
"
8,3.375,0.0,0.104166666667,False,0.0,False,text," value of N2, N3 than used in [12].
"
19,3.26315789474,0.0,0.0,False,0.0,False,text,"  The proof of Lemma 5.1 has been changed to x a small gap. The old proof did not
"
18,2.77777777778,0.0,0.494444444444,False,0.0,False,text," guarantee that n1(Q) = S  o(S) when Q  M \ M. The denition of M has
"
11,4.72727272727,0.0,0.0,False,0.0,False,text," changed and a new switching argument is given to correct this.
"
13,4.0,0.0,0.0,False,0.0,False,text,"  We added a reference to the journal version [11] of this paper.
"
14,4.42857142857,0.0,0.0,False,0.0,True,text," Note that none of the statements of our own results from [11] have changed.
"
4,5.25,0.0,0.0,False,1.0,False,text," 2 Switchings on matrices
"
16,4.5,0.0,0.0892857142857,False,0.0,True,text," In this section we will show that the condition st = o(S2/3) implies that most matrices
"
18,3.77777777778,0.0,0.0,False,0.0,False,text," have no entries greater than 3. We also nd bounds on the number of entries equal to 2
"
1,1.0,0.0,0.0,False,0.0,False,text," 5
"
17,4.17647058824,0.0,0.0,False,0.0,False,text," or 3. Our tool will be the method of switchings, which we will analyse using results of
"
13,4.76923076923,0.0,0.0,False,0.0,True,text," Fack and McKay [10] from which we will distill the following special case.
"
19,3.42105263158,0.539473684211,0.219298245614,True,1.0,True,heading," Theorem 2.1. Let G = (V, E) be a nite simple acyclic directed graph, with each v  V
"
16,4.375,0.903125,0.0875,False,0.0,False,body," being associated with a nite set C(v), these sets being disjoint. Suppose that S is a
"
20,3.15,0.65,0.208333333333,False,0.0,False,body," multiset of ordered pairs such that for each (Q, R)  S there is an edge vw  E with
"
20,3.1,0.41,0.345,False,0.0,True,body," Q  C(v) and R  C(w). Further suppose that a, b : V  R are positive functions such
"
7,2.14285714286,0.571428571429,0.285714285714,False,0.0,False,body," that, for each v  V ,
"
6,2.33333333333,0.833333333333,0.166666666667,False,0.0,False,body," if v is not a sink,
"
1,5.0,0.0,0.0,False,0.0,False,body," (2.1)
"
19,3.47368421053,0.736842105263,0.131578947368,False,0.0,False,body," where the left hand sides are multiset cardinalities. Let  6= Y  V . Then there is a
"
22,2.59090909091,0.477272727273,0.424242424242,False,0.0,False,body," directed path v1, v2, . . . , vk in G, where v1  Y and vk is a sink, such that
"
1,1.0,0.0,1.0,False,0.0,False,after_body," ,
"
1,5.0,0.0,0.0,False,0.0,False,text," (2.2)
"
5,1.2,0.0,0.333333333333,False,0.0,False,body," (2  i  k).
"
10,2.4,0.0,0.635,False,0.0,False,after_body," {(Q, R)  S | Q  C(v)}  a(v)|C(v)|
"
11,2.27272727273,0.0,0.668181818182,False,0.0,False,text," {(Q, R)  S | R  C(v)}  b(v)|C(v)| ,
"
5,3.6,0.0,0.77,False,0.0,True,text," PvV |C(v)|  PviY N(vi)
"
2,4.5,0.0,1.0,False,0.0,True,text," PvY |C(v)|
"
2,4.5,0.0,0.925,False,0.0,True,text," P1ik N(vi)
"
5,3.8,0.84,0.12,False,0.0,False,text," where N(vi) is dened by
"
3,2.66666666667,0.0,0.3,False,0.0,True,text," N(v1) = 1,
"
2,3.0,0.0,0.3,False,0.0,True,text," N(vi) =
"
4,2.75,0.0,0.316666666667,False,0.0,False,text," a(v1)   a(vi1)
"
4,2.5,0.0,0.3,False,0.0,False,text," b(v2)   b(vi)
"
10,4.1,0.1,0.0,False,0.0,True,text," Proof. This follows from Theorems 1 and 2 of [10].
"
11,3.81818181818,0.0826446280992,0.099173553719,False,0.0,True,text," For D  2, a D-switching is described by the sequence
"
11,2.63636363636,0.0,0.795454545455,False,0.0,True,text," Q; (i0, j0), (i1, j1), . . . , (iD, jD)
"
24,3.08333333333,0.0,0.375315656566,False,0.0,False,text," where Q is a matrix in M(s, t) and (i0, j0), (i1, j1), . . . , (iD, jD) is a (D+1)-tuple of posi-
"
3,4.33333333333,0.0,0.0,False,0.0,False,text," tions such that
"
24,2.79166666667,0.0,0.472222222222,False,0.0,False,text,"  the rows i0, . . . , iD are all distinct and the columns j0, . . . , jD are all distinct;
"
11,2.72727272727,0.0,0.212121212121,False,0.0,False,text,"  there is a D in position (i0, j0) of Q;
"
24,2.29166666667,0.0,0.1875,False,0.0,False,text,"  the entries in positions (i, j) of Q are not equal to 0 or D + 1, for 1    D;
"
21,2.42857142857,0.0,0.206349206349,False,0.0,False,text,"  there is a 0 in position (i, j0) and position (i0, j) of Q for 1    D.
"
16,4.1875,0.0,0.180681818182,False,0.0,True,text," This D-switching transforms Q into a matrix R  M(s, t) by acting on the (D+1)(D+1)
"
20,3.35,0.0,0.516666666667,False,0.0,False,text," submatrix consisting of rows (i0, . . . , iD) and columns (j0, . . . , jD) as follows:
"
2,1.0,0.0,0.5,False,0.0,True,text," Q =
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
1,2.0,0.0,0.5,False,0.0,False,text," q2
"
2,1.0,0.0,0.5,False,0.0,True,text," D 0
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
1,2.0,0.0,0.5,False,0.0,False,text," q1
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
1,3.0,0.0,0.0,False,0.0,False,text," ...
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
3,0.0,0.0,0.0,False,0.0,False,text,"   
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
3,1.0,0.0,0.0,False,0.0,False,text," . . .
"
1,2.0,0.0,1.0,False,0.0,False,text," qD
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,1.0,0.0,3.0,False,0.0,False,text," 7
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,1.0,0.0,0.0,False,0.0,False,text," 6
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,3.0,0.0,0.666666666667,False,0.0,False,text," q21
"
3,0.0,0.0,0.0,False,0.0,False,text,"   
"
3,1.0,0.0,0.0,False,0.0,False,text," . . .
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
2,2.0,0.0,0.333333333333,False,0.0,False,text," 1 q11
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,3.0,0.0,0.0,False,0.0,False,text," ...
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,3.0,0.0,1.0,False,0.0,False,text," qD1
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
3,1.0,0.0,0.666666666667,False,0.0,False,text," = R .
"
15,4.73333333333,0.0,0.0,False,0.0,True,text," Matrix entries not shown can have any values and are unchanged by the switching oper-
"
14,5.07142857143,0.0,0.00649350649351,False,0.0,False,text," ation. Notice that the D-switching preserves all row and column sums and reduces the
"
20,3.2,0.0,0.1,False,0.0,False,text," number of entries equal to D by at least 1 and at most D + 1. The number of entries
"
5,4.8,0.0,0.2,False,0.0,False,text," greater than D is unchanged.
"
12,6.0,0.152777777778,0.0145202020202,False,0.0,True,text," A reverse D-switching, which undoes a D-switching (and vice-versa), is described by
"
27,2.66666666667,0.0,0.617283950617,False,0.0,False,text," a sequence R; (i0, j0), . . . , (iD, jD) where R  M(s, t) and (i0, j0), (i1, j1), . . . , (iD, jD)
"
7,4.71428571429,0.0,0.012987012987,False,0.0,False,text," is a (D+1)-tuple of positions such that
"
24,2.79166666667,0.0,0.472222222222,False,0.0,False,text,"  the rows i0, . . . , iD are all distinct and the columns j0, . . . , jD are all distinct;
"
11,3.0,0.0,0.121212121212,False,0.0,False,text,"  there is a zero in position (i0, j0) of R;
"
20,2.5,0.0,0.2,False,0.0,False,text,"  the entries in positions (i, j) of R are not equal to D, for 1    D;
"
21,2.42857142857,0.0,0.206349206349,False,0.0,False,text,"  there is a 1 in position (i, j0) and position (i0, j) of R for 1    D.
"
20,2.85,0.4,0.208333333333,True,1.0,True,heading," Lemma 2.2. Let D  2 and let Q  M(s, t) have at least K  2st non-zero entries
"
19,3.63157894737,0.894736842105,0.105263157895,False,0.0,False,body," that are not greater than D, and at least J entries equal to D. Then there are at least
"
14,4.64285714286,0.666666666667,0.209523809524,False,0.0,True,body," J(K  2st)D D-switchings and at most SDTD reverse D-switchings that apply to Q.
"
14,4.85714285714,0.0714285714286,0.0173992673993,False,0.0,True,after_body," Proof. First consider D-switchings. We want a lower bound on the number of (D+1)-
"
20,3.8,0.0,0.325378787879,False,0.0,False,text," tuples (i0, j0), . . . , (iD, jD) of indices where a D-switching may be performed. There are at
"
16,4.5625,0.0,0.109375,False,0.0,False,text," least J ways to choose the position (i0, j0). Then we can choose the remaining positions
"
16,4.5625,0.0,0.0,False,0.0,False,text," one at a time, avoiding choices which violate the rules. The choice of the last position
"
17,4.11764705882,0.0,0.142156862745,False,0.0,False,text," (iD, jD) is the most restricted, so we bound that. By assumption, there are at least K
"
18,3.88888888889,0.0,0.0833333333333,False,0.0,False,text," nonzero entries in Q that are not greater than D. Of these we must exclude the entry in
"
19,3.78947368421,0.0,0.0701754385965,False,0.0,False,text," position (i0, j0) as well as entries in the same column as a nonzero entry in row i0 other
"
18,3.94444444444,0.0,0.12037037037,False,0.0,False,text," than column j0 (at most (s D)t positions), entries in the same row as a nonzero entry in
"
18,3.83333333333,0.0,0.259259259259,False,0.0,False,text," column j0 other than row i0 (at most (t D)s positions), and entries in row i or column
"
21,2.95238095238,0.0,0.345238095238,False,0.0,False,text," j for 1    D 1 (at most (D 1)(s + t 2) positions). Overall, we can choose position
"
5,3.2,0.0,0.283333333333,False,0.0,False,text," (iD, jD) in at least
"
23,1.13043478261,0.0,0.29347826087,False,0.0,True,text," K  1  (s  D)t  (t  D)s  (D  1)(s + t  2)  K  2st
"
17,4.23529411765,0.0,0.0980392156863,False,0.0,False,text," ways, and as we noted this also applies to each of the less restricted positions (i, j),
"
15,3.2,0.0,0.156666666667,False,0.0,False,text," where 1    D. Hence at most J(K  2st)D D-switchings involve Q.
"
14,5.07142857143,0.0,0.0769230769231,False,0.0,True,text," Next consider reverse D-switchings. An ordered sequence of D entries in the same row
"
18,3.72222222222,0.0,0.111111111111,False,0.0,False,text," which equal 1 may be chosen in at most SD ways, and an ordered sequence of D entries
"
18,3.5,0.0,0.0555555555556,False,0.0,False,text," in the same column which equal 1 may be chosen in at most TD ways. Some of these
"
16,4.6875,0.0,0.0677083333333,False,0.0,False,text," choices will not give a legal position for a reverse D-switching, but SDTD is certainly an
"
2,5.5,0.0,0.0,False,0.0,False,text," upper bound.
"
1,1.0,0.0,0.0,False,0.0,False,text," 7
"
15,4.6,0.0,0.0,False,0.0,True,text," Our rst application of switchings will be to show that only a vanishing fraction of
"
20,3.1,0.0,0.13,False,0.0,False,text," our matrices have any entries greater than 3. For j  0 and D  2, let MD(j) be the
"
19,3.73684210526,0.0,0.157894736842,False,0.0,False,text," set of all matrices in M(s, t) with exactly j entries equal to D and none greater than D.
"
13,3.76923076923,0.0,0.252747252747,False,0.0,True,text," Dene MD(0) = Sj0 MD(j), and note that MD+1(0) = MD(0)  MD(0).
"
20,3.3,0.45625,0.11375,True,1.0,True,heading," Lemma 2.3. Suppose that 1  st = o(S2/3). Let U1 = U1(s, t) be the set of all matrices
"
11,4.0,0.818181818182,0.0454545454545,False,0.0,False,body," in M(s, t) which contain an entry greater than 3. Then
"
4,5.75,0.0,0.30303030303,False,0.0,False,text," |U1|/M(s, t) = O(s3t3/S2).
"
19,3.63157894737,0.0526315789474,0.0877192982456,False,0.0,True,text," Proof. The largest possible entry of a matrix in M(s, t) is  = min{s, t}. We will apply
"
14,4.92857142857,0.0,0.0357142857143,True,0.0,True,text," Theorem 2.1 to successively bound the possibility that the maximum entry is D, for
"
11,1.0,0.0909090909091,0.590909090909,False,0.0,True,text," D = ,   1, . . . , 4.
"
21,2.42857142857,0.047619047619,0.246031746032,False,0.0,True,text," Fix D with 4  D  . Dene a directed graph G = (V, E) with vertex set V =
"
26,2.38461538462,0.0,0.63141025641,False,0.0,False,text," {v0, v1, v2, . . .} and edge set E = {vjvi | j D 1  i  j 1}. Associate each vi with the
"
19,3.63157894737,0.0,0.176315789474,False,0.0,False,text," set C(vi) = MD(i). Dene S to be the set of pairs (Q, R) related by a D-switching, where
"
27,1.92592592593,0.0,0.478395061728,False,0.0,True,text," Q  vj, R  vi for some vjvi  E. Dene Y = {v1, v2, . . .}  V . Note that SDTD  0
"
4,1.75,0.25,0.25,False,0.0,False,text," since D  .
"
8,3.5,0.0,0.0,False,0.0,True,text," We can now use Theorem 2.1 to bound
"
1,7.0,0.0,0.714285714286,False,0.0,False,text," |MD(0)|
"
1,9.0,0.0,0.444444444444,False,0.0,False,text," |MD+1(0)|
"
3,3.33333333333,0.0,0.666666666667,False,0.0,False,text," = PvY |C(v)|
"
2,4.5,0.0,1.0,False,0.0,True,text," PvV |C(v)|
"
1,1.0,0.0,1.0,False,0.0,False,text," ,
"
17,4.11764705882,0.0,0.235294117647,False,0.0,False,text," once we have found positive functions a, b : V  R satisfying (2.1). These are provided
"
19,3.15789473684,0.0,0.197368421053,False,0.0,False,text," by Lemma 2.2 with J = j and K = S/D, the latter being clear since there are no
"
19,3.47368421053,0.0,0.166666666667,False,0.0,False,text," entries greater than D and the total of all the entries is S. We have S/D  2st since
"
18,2.88888888889,0.0,0.265277777778,False,0.0,True,text," D    (st)1/2. Thus we can take a(vj) = j(S/D  2st)D and b(vj) = SDTD.
"
22,3.22727272727,0.0,0.368181818182,True,0.0,True,text," Theorem 2.1 tells us that, unless MD(0) = , there is a directed path vt1, vt2, . . . , vtq ,
"
26,2.26923076923,0.0,0.134615384615,False,0.0,False,text," where q  1 and t1  t2      tq = 0 (since v0 is the only sink) such that (2.2) holds.
"
13,3.69230769231,0.0,0.0769230769231,False,0.0,True,text," Hence, using the values of N as given in Theorem 2.1 we have
"
1,7.0,0.0,0.714285714286,False,0.0,False,text," |MD(0)|
"
2,4.5,0.0,0.222222222222,False,0.0,False,heading," |MD+1(0)| 
"
7,2.14285714286,0.0,0.173469387755,False,0.0,True,body," N(vtq1) +    + N(vt1)
"
8,1.75,0.0,0.1625,False,0.0,True,text," N(vtq ) +    + N(vt2)
"
2,1.5,0.0,0.0,False,0.0,False,text,"  max
"
1,3.0,0.0,1.33333333333,False,0.0,False,text," 1iq
"
2,2.0,0.0,0.0,False,0.0,False,text," = max
"
1,3.0,0.0,1.33333333333,False,0.0,False,text," 1iq
"
1,7.0,0.0,0.714285714286,False,0.0,True,text," N(vti1)
"
1,6.0,0.0,0.666666666667,False,0.0,True,text," N(vti)
"
1,9.0,0.0,0.555555555556,False,0.0,False,text," b(MD(ti))
"
1,10.0,0.0,0.6,False,0.0,False,text," a(MD(ti1))
"
1,4.0,0.0,1.0,False,0.0,True,text," SDTD
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
4,2.5,0.0,0.5875,False,0.0,False,text," (S/D  2st)D .
"
20,2.9,0.05,0.324444444444,False,0.0,True,text," Let D denote this upper bound: that is, D = SDTD/(S/D  2st)D for 4  D  . Note
"
1,1.0,0.0,0.0,False,0.0,False,text," 8
"
16,2.125,0.0625,0.278409090909,False,0.0,False,text," that 4 = O(s3t3/S2). For 4  D  , we have D  0 and
"
1,3.0,0.0,0.666666666667,False,0.0,True,text," D+1
"
6,1.83333333333,0.0,0.7,False,0.0,True,text," D  st (D + 1)D+1
"
1,2.0,0.0,1.0,False,0.0,True,text," DD
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
3,2.66666666667,0.0,0.388888888889,False,0.0,False,text," (S  2stD)D
"
6,1.66666666667,0.0,0.322222222222,False,0.0,True,text," S  2st(D + 1)1 
"
5,2.8,0.0,0.253333333333,False,0.0,False,text," (S  2st(D + 1))D+1
"
3,2.0,0.0,0.733333333333,False,0.0,True,text," S  2stDD
"
1,3.0,0.0,1.0,False,0.0,True,text," Dst
"
1,3.0,0.0,0.666666666667,False,0.0,False,text," 2st
"
2,2.5,0.0,0.125,False,0.0,False,text," = O(1)
"
2,2.5,0.0,0.125,False,0.0,False,text," = o(1)
"
16,4.3125,0.0,0.0814732142857,False,0.0,False,text," uniformly over D, where the last step uses the observation that   (st)1/2 = o(S1/3).
"
17,2.58823529412,0.0735294117647,0.234453781513,False,0.0,True,text," Since U1 = M4(0)M5(0)  M(0) and MD+1(0)  M(s, t) for 4  D  ,
"
18,2.44444444444,0.0,0.175925925926,False,0.0,False,text," we have |U1|/M(s, t)  4 + 5 +    +  = O(s3t3/S2) as required.
"
14,4.85714285714,0.0,0.0,False,0.0,True,text," We may therefore restrict our attention to matrices with no entry greater than 3.
"
18,3.55555555556,0.0,0.0,False,0.0,True,text," Next we nd upper bounds on the numbers of entries equal to 2 or 3 which hold with
"
2,8.0,0.0,0.0,False,0.0,False,text," high probability.
"
1,4.0,0.0,0.0,False,0.0,True,text," Dene
"
2,1.5,0.0,0.25,False,0.0,True,text," N2 =
"
1,2.0,0.0,0.0,False,0.0,False,text," 22
"
2,2.0,0.0,1.16666666667,False,0.0,False,text," log S
"
1,11.0,0.0,0.545454545455,False,0.0,False,text," 5600S2T2/S2
"
4,2.75,0.0,0.225,False,0.0,False,text," if S2T2  S7/4,
"
6,1.83333333333,0.0,0.166666666667,False,0.0,False,text," if S7/4  S2T2  1
"
1,2.0,0.0,0.0,False,0.0,False,text," if
"
6,2.5,0.0,0.316666666667,False,0.0,False,text," 5600 S2 log S  S2T2;
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
4,2.75,0.0,0.25,False,0.0,False,text," 5600 S2 log S,
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
4,6.25,0.0,0.380208333333,False,0.0,True,text," N3 = maxlog S,230000S3T3/S3.
"
12,5.41666666667,0.0,0.0,False,0.0,False,text," (Here and throughout the paper we have not attempted to optimise constants.)
"
6,4.5,0.0,0.0,False,0.0,True,text," We will use the following lemma.
"
18,3.72222222222,0.722222222222,0.166666666667,True,1.0,True,text," Lemma 2.4. Let k be a positive integer and let q and n be positive real numbers such
"
5,2.4,0.466666666667,0.333333333333,False,0.0,False,text," that n  kq. Then
"
12,1.66666666667,0.0,0.302579365079,False,0.0,False,text," n(n  q)   (n  (k  1)q)  (n/e)k.
"
12,3.5,0.0833333333333,0.222222222222,False,0.0,True,text," Proof. Dividing the left side by nk gives, for n  kq,
"
1,2.0,0.0,1.0,False,0.0,False,text," k1
"
1,4.0,0.0,0.5,False,0.0,True,text," Yi=0
"
3,3.33333333333,0.0,0.333333333333,False,0.0,False,text," log(1  iq/n)
"
4,3.0,0.0,0.575,False,0.0,False,text," log(1  xq/n) dx
"
6,2.16666666667,0.0,0.355555555556,False,0.0,False,text," (1  iq/n) = exp k1
"
1,4.0,0.0,0.5,False,0.0,True,text," Xi=0
"
3,1.66666666667,0.0,0.5,False,0.0,False,text,"  expZ k
"
9,2.44444444444,0.0,0.296296296296,False,0.0,False,text," = expk  (n/q  k) log(1  kq/n))
"
2,3.5,0.0,0.214285714286,False,0.0,False,text,"  exp(k).
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
18,3.83333333333,0.0,0.137037037037,False,0.0,True,text," The second line holds because log(1  xq/n) is a decreasing function for x  [0, k]. The
"
7,4.0,0.0,0.285714285714,False,0.0,False,text," case n = kq follows by continuity.
"
1,1.0,0.0,0.0,False,0.0,False,text," 9
"
16,3.9375,0.388494318182,0.114346590909,True,1.0,True,text," Lemma 2.5. Let 1  st = o(S2/3). Then, with probability 1  O(s3t3/S2), a random
"
19,3.52631578947,0.842105263158,0.0526315789474,False,0.0,False,text," element of M(s, t) has no entry greater than 3, at most N3 entries equal to 3, and at
"
6,3.66666666667,0.833333333333,0.0833333333333,False,0.0,False,text," most N2 entries equal to 2.
"
18,4.11111111111,0.0555555555556,0.0111111111111,False,0.0,True,text," Proof. In view of Lemma 2.3, we may restrict our attention to the set M4(0) of all matrices
"
17,4.05882352941,0.0,0.0294117647059,False,0.0,False,text," in M(s, t) with maximum entry at most 3. We will start by applying 3-switchings as in
"
9,4.55555555556,0.0,0.0,True,0.0,True,text," Lemma 2.3 but the analysis will be more delicate.
"
18,3.66666666667,0.0,0.356481481481,False,0.0,True,text," In applying Theorem 2.1 we have V = {v0, v1, . . .}, with vh associated with M3(h),
"
20,3.0,0.0,0.25,False,0.0,False,text," and Y = {vh | h  N3}. For suciently large S, we have from Lemma 2.2 that we can
"
4,2.75,0.0,0.15,False,0.0,False,text," take a(vh) = 1
"
16,3.75,0.0,0.11875,False,0.0,False,text," 28hS3 and b(vh) = S3T3. If S3T3 = 0 then entries equal to 3 are impossible,
"
11,3.18181818182,0.0,0.0818181818182,False,0.0,False,text," so we assume that S3T3  0. Dene  = 28S3T3/S3.
"
8,4.75,0.0,0.0,False,0.0,True,text," According to Theorem 2.1, there is a sequence
"
11,0.818181818182,0.0,0.227272727273,False,0.0,False,text," h1  h2      hq = 0,
"
17,2.11764705882,0.0,0.264705882353,False,0.0,False,text," with h1  N3 and hi1  4  hi  hi1 for all i, such that
"
1,8.0,0.0,0.625,False,0.0,False,text," |M3(N3)|
"
4,4.0,0.0,0.389583333333,False,0.0,False,text," |M(s, t)|  |M3(N3)|
"
1,7.0,0.0,0.428571428571,False,0.0,False,text," |M4(0)|
"
9,1.88888888889,0.0,0.216666666667,False,0.0,True,text," N(h) + N(h1) +    + N(h1)
"
9,2.11111111111,0.0,0.185185185185,False,0.0,True,text," N(hq) + N(hq1) +    + N(h1)
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,1.0,0.0,1.0,False,0.0,False,text," ,
"
24,2.5,0.0,0.2125,False,0.0,False,text," where  is the largest index such that h  N3 + 1 and N(hi) = h1    hi1i+1 for all i.
"
24,1.66666666667,0.0,0.222222222222,False,0.0,False,text," 4 log S. Since N3  log S, we have  + u  q. Also, for 0  i    1,
"
5,1.4,0.0,0.2,False,0.0,True,text," Dene u =  1
"
1,5.0,0.0,1.0,False,0.0,True,text," N(hi)
"
2,3.5,0.0,0.428571428571,False,0.0,True,text," N(h+ui) 
"
1,4.0,0.0,0.75,False,0.0,True,text," N(h)
"
1,6.0,0.0,0.666666666667,False,0.0,True,text," N(h+u)
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,10.0,0.0,0.0,False,0.0,True,text," Therefore,
"
1,8.0,0.0,0.625,False,0.0,False,text," |M3(N3)|
"
3,2.66666666667,0.0,0.311111111111,False,0.0,False,text," |M(s, t)| 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
9,1.88888888889,0.0,0.216666666667,False,0.0,True,text," N(h) + N(h1) +    + N(h1)
"
8,2.75,0.0,0.22619047619,False,0.0,True,text," N(h+u) + N(h+u1) +    N(hu+1)
"
1,4.0,0.0,0.75,False,0.0,True,text," N(h)
"
1,6.0,0.0,0.666666666667,False,0.0,True,text," N(h+u)
"
1,1.0,0.0,2.0,False,0.0,False,text," u
"
5,1.6,0.0,0.4,False,0.0,False,text," hh+1    h+u1
"
12,1.58333333333,0.0,0.155555555556,False,0.0,False,text," (N3 + 1)(N3  3)   (N3  4u + 5)
"
1,1.0,0.0,2.0,False,0.0,False,text," u
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
15,3.0,0.0,0.0666666666667,False,0.0,True,text," Since N3 + 1  4u we can apply Lemma 2.4 to obtain the bound
"
6,1.5,0.0,0.322222222222,False,0.0,False,text," |M(s, t)|    e
"
1,8.0,0.0,0.625,False,0.0,False,text," |M3(N3)|
"
3,1.66666666667,0.0,0.5,False,0.0,True,text," N3 + 1u
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,2.0,0.0,0.0,False,0.0,False,text," 10
"
11,2.54545454545,0.0,0.255244755245,False,0.0,True,text," Now N3  230000S3T3/S3  8214 , and u  1
"
12,2.58333333333,0.0,0.0833333333333,False,0.0,False,text," 4 log S  1, so this upper bound is at most
"
2,2.5,0.0,0.5,False,0.0,False,text," log S1
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
2,0.5,0.0,0.5,False,0.0,False,text,"  e
"
1,4.0,0.0,0.25,False,0.0,False,text," 8214
"
2,3.0,0.0,0.2,False,0.0,False,text," = O(1)S
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
4,4.75,0.0,0.212121212121,False,0.0,False,text," 4 log(e/8214) = O(S2).
"
16,4.5,0.0,0.0625,False,0.0,True,text," This shows that with probability O(s3t3/S2) there are at most N3 entries equal to 3, as
"
1,9.0,0.0,0.0,False,0.0,False,text," required.
"
16,3.9375,0.0,0.0,False,0.0,True,text," To bound the number of entries equal to 2, we proceed in the same manner using
"
15,4.86666666667,0.0,0.0333333333333,False,0.0,False,text," 2-switchings, working under the assumption that there are at most N3 entries equal to 3
"
15,3.4,0.0,0.0666666666667,False,0.0,False,text," and none greater than 3. In applying Lemma 2.2, we can take K = 1
"
5,2.8,0.0,0.106666666667,False,0.0,False,text," 2(S  3N3), so that
"
5,1.6,0.0,0.18,False,0.0,False,text," (K  2st)2  1
"
13,4.0,0.0,0.0982905982906,False,0.0,False,text," 5S2 for suciently large S. Dene  = 5S2T2/S2. Arguing as above we
"
3,3.66666666667,0.0,0.0,False,0.0,False,text," nd a sequence
"
11,0.818181818182,0.0,0.227272727273,False,0.0,False,text," d1  d2      dr = 0,
"
24,2.75,0.0,0.229166666667,False,0.0,False,text," with the following properties: (i) d1  N2 and di1  3  di  di1 for all i, and (ii) if p is
"
21,3.09523809524,0.0,0.285714285714,False,0.0,False,text," the greatest integer such that dp  N2 then, for any w with 0  w  r p, the probability
"
18,3.88888888889,0.0,0.0555555555556,False,0.0,False,text," that there are more than N2 entries equal to 2, subject to there being at most N3 equal
"
6,3.33333333333,0.0,0.0,False,0.0,False,text," to 3, is bounded above by
"
1,1.0,0.0,2.0,False,0.0,False,text," w
"
5,2.2,0.0,0.293333333333,False,0.0,False,text," dpdp+1    dp+w1
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,5.0,0.0,0.0,False,0.0,False,text," (2.3)
"
22,2.59090909091,0.0,0.154545454545,False,0.0,True,text," First suppose that S2T2  S7/4, so that N2 = 22 and   5S1/4. Since dp  N2 + 1 =
"
16,2.5625,0.0,0.1875,False,0.0,False,text," 23, it follows that r  p  8. Taking w = 8 in (2.3) gives
"
2,1.5,0.0,1.0,False,0.0,False,text," |Y |
"
3,2.66666666667,0.0,0.311111111111,False,0.0,False,text," |M(s, t)| 
"
1,1.0,0.0,1.0,False,0.0,False,text," 8
"
5,2.0,0.0,0.233333333333,False,0.0,False,text," dpdp+1    dp+7
"
2,3.5,0.0,0.333333333333,False,0.0,False,text," = O(S2).
"
19,2.47368421053,0.0,0.249122807018,False,0.0,True,text," Now suppose that S2T2  S7/4. Then N2  log S so we can take w =  1
"
3,2.0,0.0,0.333333333333,False,0.0,False,text," 3 log S.
"
15,4.46666666667,0.0,0.04,False,0.0,True,text," Arguing as above by applying Lemma 2.4 to (2.3), we obtain the bound O(S2) again.
"
4,5.5,0.0,0.0,False,0.0,True,text," This completes the proof.
"
19,3.78947368421,0.0526315789474,0.0438596491228,False,0.0,True,text," From now on we proceed in two cases, as in [12]. Say that the pair (S2, T2) is substantial
"
5,5.8,0.0,0.0,False,0.0,False,text," if the following conditions hold:
"
6,2.0,0.0,0.229166666667,False,0.0,False,text,"  1  st = o(S2/3),
"
12,1.66666666667,0.0,0.375,False,0.0,False,text,"  S2  s log2 S and T2  t log2 S,
"
4,3.25,0.0,0.236111111111,False,0.0,False,text,"  S2T2  (st)3/2S.
"
16,4.1875,0.4375,0.141369047619,True,1.0,True,text," Lemma 2.6. If 1  st = o(S2/3) and (S2, T2) is insubstantial, then with probability
"
18,3.66666666667,0.727272727273,0.0530303030303,False,0.0,False,text," 1  O(s3t3/S2), a random element of M(s, t) has no entry greater than 3, at most one
"
12,3.41666666667,1.0,0.0,False,0.0,False,text," entry equal to 3 and at most two entries equal to 2.
"
1,2.0,0.0,0.0,False,0.0,False,text," 11
"
16,4.3125,0.0625,0.0,False,0.0,True,text," Proof. The absence of entries greater than 3 follows from Lemma 2.3. We can also, by
"
18,3.94444444444,0.0,0.0222222222222,True,0.0,True,text," Lemma 2.5, assume that the number of entries equal to 2 or 3 is o(S). Therefore, most of
"
21,3.33333333333,0.0,0.0714285714286,False,0.0,False,text," the matrix entries are 0 or 1. Let N be the set of all matrices in M(s, t) with no entries
"
18,3.5,0.0,0.0555555555556,False,0.0,False,text," greater than 3, at most N2 entries equal to 2 and at most N3 entries equal to 3.
"
17,3.70588235294,0.0,0.0,False,0.0,True,text," To bound the number of entries equal to 2 or 3 even more tightly, as this lemma
"
15,4.73333333333,0.0,0.105555555556,False,0.0,False,text," requires, we employ D-switchings (D = 2, 3) with the additional restriction that q1 =
"
17,3.82352941176,0.0588235294118,0.0637254901961,False,0.0,False,text,"    = qD = 1. This ensures that these restricted D-switchings reduce the number of
"
19,3.47368421053,0.0,0.0526315789474,False,0.0,False,text," entries equal to D by exactly one and do not create any new entries equal to 2 or 3.
"
21,2.95238095238,0.0,0.238095238095,False,0.0,True,text," Let N (h) be the number of matrices in N with h entries equal to 3. If Q is such a
"
16,4.6875,0.0,0.1,False,0.0,False,text," matrix then the number of restricted 3-switchings applicable to Q is hS3(1 + o(1)) and the
"
13,5.84615384615,0.0,0.0307692307692,False,0.0,False,text," number of reverse restricted 3-switchings is at most S3T3. (This follows using arguments
"
18,4.0,0.0,0.0833333333333,False,0.0,False,text," similar to those in Lemma 2.2, since there are S  o(S) entries equal to 1.) Therefore, if
"
4,6.0,0.0,0.0,False,0.0,False,text," the denominator is nonzero,
"
2,2.0,0.0,1.0,False,0.0,True,text," N (h)
"
2,2.5,0.0,1.0,False,0.0,True,text," N (h1)
"
2,2.5,0.0,0.125,False,0.0,False,text," = O(1)
"
1,4.0,0.0,0.5,False,0.0,True,text," S3T3
"
2,2.0,0.0,0.833333333333,False,0.0,False,text," hS3 .
"
1,5.0,0.0,0.0,False,0.0,False,text," (2.4)
"
16,4.4375,0.0,0.03125,False,0.0,True,text," We can now easily check that each of the three causes of insubstantiality (namely, S2 
"
14,2.92857142857,0.0,0.31746031746,False,0.0,False,text," s log2 S, T2  t log2 S, and S2T2  (st)3/2S) imply that
"
4,5.25,0.0,0.0,False,0.0,True,text," Hence (2.4) implies that
"
1,4.0,0.0,0.5,False,0.0,True,text," S3T3
"
5,4.4,0.0,0.287692307692,False,0.0,True,text," S3 = O(s3/2t3/2/S) = o(1).
"
3,2.33333333333,0.0,1.0,False,0.0,True,text," Ph2 N (h)
"
2,2.0,0.0,0.833333333333,False,0.0,True,text," N (0)
"
2,6.0,0.0,0.272727272727,False,0.0,False,text," = O(s3t3/S2).
"
11,5.27272727273,0.0,0.0,False,0.0,True,text," In precisely the same way, using restricted 2-switchings, we nd that
"
3,2.33333333333,0.0,0.888888888889,False,0.0,True,text," Pd3 N (d)
"
2,2.0,0.0,0.666666666667,False,0.0,True,text," N (0)
"
2,6.0,0.0,0.272727272727,False,0.0,False,text," = O(s3t3/S2),
"
20,3.25,0.0,0.183333333333,False,0.0,False,text," where N (d) is the number of matrices in N with d entries equal to 2 and at most one
"
7,4.28571428571,0.0,0.0,False,0.0,False,text," entry equal to 3. The lemma follows.
"
5,4.6,0.0,0.0,False,1.0,False,text," 3 From pairings to matrices
"
15,4.86666666667,0.122222222222,0.0,False,0.0,True,text," The remainder of the paper will involve calculations in the pairing model, which we now
"
1,9.0,0.0,0.0,False,0.0,False,text," describe.
"
12,5.0,0.0,0.0,False,0.0,False,text," (This model is standard for working with random bipartite graphs of xed
"
21,3.61904761905,0.0952380952381,0.333333333333,False,0.0,False,text," degrees: see for example [13].) Consider a set of S points arranged in cells x1, x2, . . . , xm,
"
21,3.04761904762,0.0,0.214285714286,False,0.0,False,text," where cell xi has size si for 1  i  m, and another set of S points arranged in cells
"
26,2.69230769231,0.0336538461538,0.416666666667,False,0.0,False,text," y1, y2, . . . , yn where cell yj has size tj for 1  j  n. Take a partition P (called a pairing)
"
20,3.2,0.05,0.233333333333,False,0.0,False,text," of the 2S points into S pairs with each pair having the form (x, y) where x  xi and
"
21,3.28571428571,0.0,0.18253968254,False,0.0,False,text," y  yj for some i, j. The set of all such pairings, of which there are S!, will be denoted
"
13,4.0,0.0,0.0769230769231,False,0.0,False,text," by P(s, t). We work in the uniform probability space on P(s, t).
"
1,2.0,0.0,0.0,False,0.0,False,text," 12
"
17,4.17647058824,0.176470588235,0.0,False,0.0,True,text," Two pairs are called parallel if they involve the same two cells. A parallel class is a
"
15,4.93333333333,0.0666666666667,0.0,False,0.0,False,text," maximal set of mutually parallel pairs. The multiplicity of a parallel class (and of the
"
17,4.58823529412,0.117647058824,0.0,False,0.0,False,text," pairs in the class) is the cardinality of the class. As important special cases, a simple pair
"
17,4.64705882353,0.117647058824,0.0,False,0.0,False,text," is a parallel class of multiplicity one, a double pair is a parallel class of multiplicity two,
"
11,4.72727272727,0.181818181818,0.0,False,0.0,False,text," while a triple pair is a parallel class of multiplicity three.
"
20,3.45,0.0,0.143333333333,False,0.0,True,text," Each pairing P  P(s, t) gives rise to a matrix in M(s, t) by letting the (i, j)-th entry
"
17,3.70588235294,0.0,0.176470588235,False,0.0,False,text," of the matrix equal the multiplicity of the parallel class from xi to yj in P .
"
17,3.94117647059,0.0,0.0,False,0.0,True,text," In [12] we noted that the number of pairings which gives rise to each 0-1 matrix in
"
18,3.94444444444,0.0,0.0277777777778,False,0.0,True,text," M(s, t) depends only on s and t and is independent of the structure of the matrix. Hence
"
16,4.625,0.0,0.0,False,0.0,False,text," the task of counting such matrices reduces to nding the fraction of pairings that have no
"
4,6.75,0.0,0.0,False,0.0,False,text," multiplicities greater than 1.
"
14,5.07142857143,0.0,0.0357142857143,False,0.0,True,text," More generally, matrices in M(s, t) correspond to dierent numbers of pairings. For a
"
24,2.91666666667,0.0833333333333,0.333333333333,False,0.0,False,text," pairing P  P(s, t), dene the multiplicity vector of P to be a(P ) = (a2, a3, . . . ) where ar
"
16,4.125,0.0625,0.09375,False,0.0,False,text," is the number of parallel classes of multiplicity r. Also dene the weight of P as
"
9,2.55555555556,0.0,0.12962962963,False,0.0,False,text," w(P ) = (2!)a2 (3!)a3 (4!)a4   
"
17,3.94117647059,0.0,0.132352941176,False,0.0,True,text," For Q  M(s, t), dene w(Q) and a(Q) to be the common weight and multiplicity vectors
"
6,4.0,0.0,0.0833333333333,False,0.0,False,text," of the pairings that yield Q.
"
12,4.58333333333,0.0,0.125,False,0.0,True,text," By elementary counting, a matrix Q  M(s, t) corresponds to exactly
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,4.0,0.0,0.5,False,0.0,False,text," w(Q)
"
1,1.0,0.0,1.0,False,0.0,False,text," m
"
1,4.0,0.0,0.5,False,0.0,True,text," Yi=1
"
1,3.0,0.0,0.666666666667,False,0.0,False,text," si!
"
1,1.0,0.0,1.0,False,0.0,False,text," n
"
1,4.0,0.0,0.5,False,0.0,True,text," Yj=1
"
1,3.0,0.0,0.666666666667,False,0.0,False,text," tj!
"
20,3.5,0.0,0.25,False,0.0,False,text," pairings in P(s, t). Therefore, if A is a set of multiplicity vectors, PA = {P  P(s, t) |
"
16,2.0625,0.0,0.338541666667,False,0.0,False,text," a(P )  A}, and MA = {Q  M(s, t) | a(Q)  A}, then
"
2,2.0,0.0,0.333333333333,False,0.0,False,text," w(P )
"
2,3.0,0.0,0.5,False,0.0,False,text," j=1 tj!
"
1,5.0,0.0,0.0,False,0.0,False,text," (3.1)
"
4,2.25,0.0,0.875,False,0.0,False,text," |MA| = PP PA
"
3,2.66666666667,0.0,0.666666666667,False,0.0,False,text," i=1 si! Qn
"
1,2.0,0.0,1.0,False,0.0,True,text," Qm
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
17,4.47058823529,0.0,0.0588235294118,False,0.0,True,text," This holds in particular if A is the set of all nonnegative integer sequences, in which case
"
9,2.44444444444,0.0,0.333333333333,False,0.0,True,text," PA = P(s, t) and MA = M(s, t).
"
13,4.30769230769,0.0,0.0641025641026,False,0.0,True,text," We rst prove Theorem 1.3 in the case that (S2, T2) is insubstantial.
"
17,3.94117647059,0.470588235294,0.133053221289,True,1.0,True,text," Lemma 3.1. If 1  st = o(S2/3) and (S2, T2) is insubstantial then Theorem 1.3 holds.
"
18,3.77777777778,0.111111111111,0.0,False,0.0,True,text," Proof. Similarly to [12, Lemma 2.2], dene a doublet to be to be an unordered set of 2
"
15,5.2,0.0,0.0,False,0.0,False,text," parallel pairs. A double pair provides one doublet, while a triple pair provides 3 doublets.
"
17,4.35294117647,0.0,0.0882352941176,False,0.0,True,text," For the uniform probability space over P(s, t), let br be the expectation of the number of
"
1,2.0,0.0,0.0,False,0.0,False,text," 13
"
16,3.125,0.0,0.125,False,0.0,False,text," sets of r doublets, for r  0. In [12, Lemma 2.2] it is shown that
"
3,1.66666666667,0.0,0.333333333333,False,0.0,False,text," b0 = 1,
"
2,1.5,0.0,0.25,False,0.0,False,text," b1 =
"
2,1.5,0.0,0.25,False,0.0,False,text," b2 =
"
2,1.5,0.0,0.25,False,0.0,False,text," b3 =
"
1,4.0,0.0,0.5,False,0.0,True,text," S2T2
"
1,5.0,0.0,0.2,False,0.0,False,text," 2[S]2
"
1,4.0,0.0,0.5,False,0.0,True,text," S3T3
"
1,5.0,0.0,0.2,False,0.0,False,text," 2[S]3
"
1,4.0,0.0,0.5,False,0.0,True,text," S3T3
"
1,5.0,0.0,0.2,False,0.0,False,text," 6[S]3
"
1,1.0,0.0,1.0,False,0.0,False,text," ,
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," (S2
"
6,1.83333333333,0.0,0.111111111111,False,0.0,False,text," 2  4S3  2S2)(T 2
"
1,5.0,0.0,0.2,False,0.0,False,text," 8[S]4
"
5,1.6,0.0,0.116666666667,False,0.0,False,text," 2  4T3  2T2)
"
1,1.0,0.0,1.0,False,0.0,False,text," ,
"
2,6.0,0.0,0.272727272727,False,0.0,False,text," + O(s3t3/S2),
"
3,4.66666666667,0.0,0.348484848485,False,0.0,False,text," b4 = O(s3t3/S2).
"
14,5.07142857143,0.0,0.142857142857,False,0.0,True,text," Let pk denote the probability that a randomly chosen pairing contains exactly k dou-
"
6,2.66666666667,0.0,0.166666666667,False,0.0,False,text," blets, for k  0. Then
"
3,2.0,0.0,0.777777777778,False,0.0,False,text," pk = Xrk
"
1,7.0,0.0,0.714285714286,False,0.0,False,text," (1)r+kr
"
2,1.5,0.0,1.5,False,0.0,False,text," k br
"
16,4.375,0.0,0.0625,False,0.0,False,text," and the partial sums of this series alternate above and below pk (see for example [4,
"
7,5.0,0.0,0.0,True,0.0,True,text," Theorem 1.10]). Applying this, we nd that
"
1,4.0,0.0,0.5,False,0.0,True,text," S2T2
"
1,5.0,0.0,0.2,False,0.0,False,text," 2[S]2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,4.0,0.0,0.5,False,0.0,True,text," S3T3
"
1,5.0,0.0,0.2,False,0.0,False,text," 3[S]3
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," (S2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
4,1.0,0.0,0.125,False,0.0,False,text," p0 = 1 
"
1,4.0,0.0,0.5,False,0.0,True,text," S2T2
"
2,2.5,0.0,0.1,False,0.0,False,text," 2[S]2 
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," (S2
"
2,1.5,0.0,0.25,False,0.0,False,text," p1 =
"
2,1.5,0.0,0.25,False,0.0,False,text," p2 =
"
1,4.0,0.0,0.5,False,0.0,True,text," S3T3
"
2,2.5,0.0,0.1,False,0.0,False,text," 2[S]3 
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," (S2
"
6,1.83333333333,0.0,0.111111111111,False,0.0,False,text," 2  4S3  2S2)(T 2
"
1,5.0,0.0,0.2,False,0.0,False,text," 4[S]4
"
5,1.6,0.0,0.116666666667,False,0.0,False,text," 2  4T3  2T2)
"
6,1.83333333333,0.0,0.111111111111,False,0.0,False,text," 2  4S3  2S2)(T 2
"
1,5.0,0.0,0.2,False,0.0,False,text," 8[S]4
"
5,1.6,0.0,0.116666666667,False,0.0,False,text," 2  4T3  2T2)
"
5,2.2,0.0,0.12380952381,False,0.0,False,text," 2  4S3  2S2)(T2
"
1,5.0,0.0,0.2,False,0.0,False,text," 8[S]4
"
5,1.6,0.0,0.116666666667,False,0.0,False,text," 2  4T3  2T2)
"
2,6.0,0.0,0.272727272727,False,0.0,False,text," + O(s3t3/S2),
"
2,6.0,0.0,0.272727272727,False,0.0,False,text," + O(s3t3/S2),
"
2,6.0,0.0,0.272727272727,False,0.0,False,text," + O(s3t3/S2),
"
2,1.5,0.0,0.25,False,0.0,False,text," p3 =
"
1,4.0,0.0,0.5,False,0.0,True,text," S3T3
"
1,5.0,0.0,0.2,False,0.0,False,text," 6[S]3
"
2,6.0,0.0,0.272727272727,False,0.0,False,text," + O(s3t3/S2).
"
14,5.07142857143,0.0,0.0357142857143,False,0.0,False,text," (The expression for p0 was also derived in [12, Lemma 2.2].) The congurations dening
"
15,5.2,0.0,0.0,False,0.0,False,text," these cases are, respectively, no parallel pairs, one double pair, two double pairs, and one
"
2,5.5,0.0,0.0,False,0.0,False,text," triple pair.
"
5,5.0,0.0,0.0,False,0.0,True,text," Applying Lemma 2.6 and (3.1),
"
6,3.16666666667,0.0,0.35,False,0.0,True,text," M(s, t) = 1 + O(s3t3/S2)
"
8,2.5,0.0,0.308333333333,False,0.0,False,text," j=1 tj!p0 + 2p1 + 4p2 + 6p3
"
1,2.0,0.0,0.5,False,0.0,True,text," S!
"
3,2.66666666667,0.0,0.666666666667,False,0.0,False,text," i=1 si! Qn
"
1,2.0,0.0,1.0,False,0.0,True,text," Qm
"
10,3.1,0.0,0.273333333333,False,0.0,False,text," j=1 tj!p0 + 2p1 + 4p2 + 6p3 + O(s3t3/S2)
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,2.0,0.0,0.5,False,0.0,True,text," S!
"
1,2.0,0.0,0.5,False,0.0,True,text," S!
"
3,2.66666666667,0.0,0.666666666667,False,0.0,False,text," i=1 si! Qn
"
1,2.0,0.0,1.0,False,0.0,True,text," Qm
"
3,2.66666666667,0.0,0.666666666667,False,0.0,False,text," i=1 si! Qn
"
1,2.0,0.0,1.0,False,0.0,True,text," Qm
"
2,1.0,0.0,1.0,False,0.0,False,text," 1 +
"
2,3.0,0.0,0.5,False,0.0,False,text," j=1 tj!
"
1,4.0,0.0,0.5,False,0.0,True,text," S2T2
"
1,5.0,0.0,0.2,False,0.0,False,text," 2[S]2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,4.0,0.0,0.5,False,0.0,True,text," S3T3
"
1,5.0,0.0,0.2,False,0.0,False,text," 3[S]3
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," (S2
"
6,1.83333333333,0.0,0.111111111111,False,0.0,False,text," 2  4S3  2S2)(T 2
"
1,5.0,0.0,0.2,False,0.0,False,text," 8[S]4
"
5,1.6,0.0,0.116666666667,False,0.0,False,text," 2  4T3  2T2)
"
2,6.0,0.0,0.318181818182,False,0.0,False,text," + O(s3t3/S2),
"
1,2.0,0.0,0.0,False,0.0,False,text," 14
"
22,3.13636363636,0.0,0.0795454545455,False,0.0,False,text," where we have used the fact that p0 + 2p1 + 4p2 + 6p3 = 1 + o(1) in the insubstantial case
"
5,3.8,0.0,0.0,False,0.0,False,text," to get the second line.
"
14,5.0,0.0,0.0,False,0.0,True,text," This expression is equal to the expression in Theorem 1.3 under our present assump-
"
6,3.66666666667,0.0,0.0833333333333,False,0.0,False,text," 2 /2S5 which appears in the
"
11,4.72727272727,0.0,0.121212121212,False,0.0,False,text," tions. (Note that since (S2, T2) is insubstantial, the term S2
"
10,4.9,0.0,0.0,False,0.0,False,text," statement of Theorem 1.3 is absorbed into the error term.)
"
3,1.0,0.0,0.333333333333,False,0.0,False,text," 2 T 2
"
18,3.83333333333,0.0,0.178571428571,False,0.0,True,text," For nonnegative integers d, h, dene Cd,h = Cd,h(s, t) to be the set of all pairings in
"
17,4.64705882353,0.0,0.147058823529,False,0.0,True,text," P(s, t) with exactly d double pairs and h triple pairs, but no parallel classes of multiplicity
"
5,4.2,0.0,0.0,False,0.0,False,text," greater than 3. Also dene
"
4,3.5,0.0,0.741071428571,False,0.0,False,text," w(Cd,h) = XP Cd,h
"
6,2.66666666667,0.0,0.444444444444,False,0.0,False,text," w(P ) = 2d 6h |Cd,h|.
"
19,3.63157894737,0.0,0.0263157894737,False,0.0,True,text," A special case of (3.1), used in [12], is that the number of 0-1 matrices in P(s, t) is
"
3,2.33333333333,0.0,0.166666666667,False,0.0,True,text," N(s, t) =
"
1,6.0,0.0,0.666666666667,False,0.0,False,text," |C0,0|
"
3,2.66666666667,0.0,0.666666666667,False,0.0,False,text," i=1 si! Qn
"
1,2.0,0.0,1.0,False,0.0,True,text," Qm
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
2,3.0,0.0,0.5,False,0.0,False,text," j=1 tj!
"
14,3.85714285714,0.0,0.0714285714286,False,0.0,True,text," We will proceed by writing M(s, t) in terms of N(s, t), as follows.
"
8,4.375,0.5,0.104166666667,True,1.0,True,text," Lemma 3.2. If (S2, T2) is substantial then
"
5,2.6,0.0,0.2,False,0.0,True,text," M(s, t) = N(s, t)
"
1,2.0,0.0,0.5,False,0.0,True,text," N2
"
1,2.0,0.0,0.5,False,0.0,True,text," N3
"
1,4.0,0.0,0.5,False,0.0,True,text," Xd=0
"
1,4.0,0.0,0.5,False,0.0,True,text," Xh=0
"
1,7.0,0.0,0.714285714286,False,0.0,False,text," w(Cd,h)
"
3,6.66666666667,0.0,0.378787878788,False,0.0,False,text," w(C0,0)1 + O(s3t3/S2).
"
6,4.16666666667,0.166666666667,0.0,False,0.0,True,text," Proof. By Lemma 2.5 and (3.1),
"
3,2.33333333333,0.0,0.166666666667,False,0.0,True,text," M(s, t) =
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,2.0,0.0,0.5,False,0.0,True,text," N2
"
1,2.0,0.0,0.5,False,0.0,True,text," N3
"
2,3.0,0.0,0.5,False,0.0,False,text," j=1 tj!
"
1,2.0,0.0,0.5,False,0.0,True,text," N3
"
2,4.0,0.0,0.566666666667,False,0.0,False,text," i=1 si!Qn
"
1,2.0,0.0,1.0,False,0.0,True,text," Qm
"
1,4.0,0.0,0.5,False,0.0,True,text," Xh=0
"
1,4.0,0.0,0.5,False,0.0,True,text," Xd=0
"
1,2.0,0.0,0.5,False,0.0,True,text," N2
"
3,2.33333333333,0.0,0.166666666667,False,0.0,False,text," = N(s, t)
"
3,6.33333333333,0.0,0.45,False,0.0,False,text," w(Cd,h)1 + O(s3t3/S2)
"
1,4.0,0.0,0.5,False,0.0,True,text," Xd=0
"
1,4.0,0.0,0.5,False,0.0,True,text," Xh=0
"
1,7.0,0.0,0.714285714286,False,0.0,False,text," w(Cd,h)
"
3,6.66666666667,0.0,0.378787878788,False,0.0,False,text," w(C0,0)1 + O(s3t3/S2).
"
15,4.33333333333,0.0,0.0,False,0.0,True,text," We will evaluate the sum in Lemma 3.2 using two summation lemmas proved in [12]
"
3,5.66666666667,0.0,0.0,False,0.0,False,text," and restated below.
"
18,3.16666666667,0.277777777778,0.111111111111,True,1.0,True,heading," Lemma 3.3 ([12, Corollary 4.3]). Let 0  A1  A2 and B1  B2 be real numbers.
"
23,2.5652173913,0.565217391304,0.217391304348,False,0.0,True,body," Suppose that there exist integers N , K with N  2 and 0  K  N , and a real number
"
29,1.79310344828,0.215517241379,0.313218390805,False,0.0,False,body," c  2e such that 0  Ac  N  K + 1 and |BN|  1 for all A  [A1, A2] and B  [B1, B2].
"
25,2.36,0.5,0.26,False,0.0,True,body," Further suppose that there are real numbers i, for 1  i  N , and i  0, for 0  i  K,
"
3,3.33333333333,0.666666666667,0.333333333333,False,0.0,False,body," such that Pi
"
29,2.31034482759,0.155172413793,0.61091954023,False,0.0,True,body," Given A(1), . . . , A(N)  [A1, A2] and B(1), . . . , B(N)  [B1, B2], dene n0, n1, . . . , nN by
"
4,1.75,0.25,0.125,False,0.0,False,body," n0 = 1 and
"
3,2.66666666667,0.0,0.611111111111,False,0.0,False,after_body," j=1|j|  PK
"
8,1.0,0.25,0.25,False,0.0,False,text," 5 for 1  i  N .
"
4,2.25,0.0,0.283333333333,False,0.0,False,text," j=0 j[i]j  1
"
1,4.0,0.0,0.5,False,0.0,True,text," A(i)
"
1,2.0,0.0,1.0,False,0.0,False,text," ni
"
1,3.0,0.0,1.0,False,0.0,False,text," ni1
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
8,1.75,0.0,0.508928571429,False,0.0,False,text," i 1  (i  1)B(i)1 + i)
"
1,2.0,0.0,0.0,False,0.0,False,text," 15
"
26,2.34615384615,0.384615384615,0.25,False,0.0,False,text," for 1  i  N , with the following interpretation: if A(i) = 0 then nj = 0 for i  j  N .
"
1,4.0,1.0,0.0,False,0.0,True,text," Then
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,5.0,1.0,0.0,False,0.0,False,text," where
"
2,0.5,0.0,0.5,False,0.0,False,text," 1 
"
1,4.0,0.0,0.5,False,0.0,True,text," Xi=0
"
3,1.33333333333,0.0,0.666666666667,False,0.0,False,text," ni  2,
"
5,1.6,0.0,0.28,False,0.0,False,text," 1 = expA1  1
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," 2A2
"
5,1.6,0.0,0.28,False,0.0,False,text," 2 = expA2  1
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," 2A2
"
3,1.33333333333,0.0,0.111111111111,False,0.0,False,text," 1B2  4
"
1,1.0,0.0,1.0,False,0.0,True,text," K
"
1,4.0,0.0,0.5,False,0.0,True,text," Xj=0
"
3,2.66666666667,0.0,0.238095238095,False,0.0,False,text," j(3A1)j  1
"
2,4.5,0.0,0.75,False,0.0,False,heading," 4(2e/c)N ,
"
3,1.66666666667,0.0,0.111111111111,False,0.0,False,body," 2B1 + 1
"
1,3.0,0.0,0.333333333333,False,0.0,False,after_body," 2A3
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," 2B2
"
3,1.0,0.0,0.0,False,0.0,False,body," 1 + 4
"
1,1.0,0.0,1.0,False,0.0,True,after_body," K
"
1,4.0,0.0,0.5,False,0.0,True,text," Xj=0
"
3,3.0,0.0,0.238095238095,False,0.0,False,text," j(3A2)j + 1
"
3,3.0,0.0,0.52380952381,False,0.0,False,text," 4 (2e/c)N .
"
21,2.7619047619,0.380952380952,0.142857142857,True,1.0,True,heading," Lemma 3.4 ([12, Corollary 4.5]). Let N  2 be an integer and, for 1  i  N , let
"
20,2.9,0.4475,0.111666666667,False,0.0,False,body," real numbers A(i), B(i) be given such that A(i)  0 and 1  (i  1)B(i)  0. Dene
"
3,2.33333333333,0.0,0.25,False,0.0,True,body," A1 = minN
"
2,6.0,0.0555555555556,0.388888888889,False,0.0,False,body," i=1 A(i)B(i).
"
14,2.92857142857,0.571428571429,0.142857142857,False,0.0,True,body," Suppose that there exists a real number c with 0  c  1
"
7,3.14285714286,0.285714285714,0.375,False,0.0,False,body," 3 such that max{A/N, |C|}  c
"
22,2.09090909091,0.261363636364,0.439393939394,False,0.0,False,body," for all A  [A1, A2], C  [C1, C2]. Dene n0, . . . , nN by n0 = 1 and
"
6,3.5,0.166666666667,0.263888888889,False,0.0,False,body," i=1 A(i)B(i) and C2 = maxN
"
5,3.0,0.04,0.296666666667,False,0.0,False,body," i=1 A(i), A2 = maxN
"
5,3.0,0.04,0.296666666667,False,0.0,False,body," i=1 A(i), C1 = minN
"
1,2.0,0.0,1.0,False,0.0,False,after_body," ni
"
1,3.0,0.0,1.0,False,0.0,False,text," ni1
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,4.0,0.0,0.5,False,0.0,True,heading," A(i)
"
6,1.66666666667,0.0,0.5,False,0.0,False,body," i 1  (i  1)B(i)
"
24,2.66666666667,0.395833333333,0.138888888889,False,0.0,False,body," for 1  i  N , with the following interpretation: if A(i) = 0 or 1  (i  1)B(i) = 0, then
"
11,1.36363636364,0.272727272727,0.363636363636,False,0.0,False,body," nj = 0 for i  j  N . Then
"
1,1.0,0.0,1.0,False,0.0,True,after_body," N
"
1,5.0,1.0,0.0,False,0.0,False,text," where
"
2,0.5,0.0,0.5,False,0.0,False,text," 1 
"
1,4.0,0.0,0.5,False,0.0,True,heading," Xi=0
"
3,1.0,0.0,0.666666666667,False,0.0,False,body," ni  2
"
5,1.6,0.0,0.28,False,0.0,False,body," 1 = expA1  1
"
5,1.6,0.0,0.28,False,0.0,False,body," 2 = expA2  1
"
4,3.0,0.0,0.525,False,0.0,False,body," 2A1C2  (2ec)N ,
"
2,2.5,0.0,0.25,False,0.0,False,body," 2A2C 2
"
3,2.33333333333,0.0,0.133333333333,False,0.0,False,body," 2A2C1 + 1
"
4,2.25,0.0,0.625,False,0.0,False,body," 1 + (2ec)N .
"
16,4.4375,0.0,0.0,False,0.0,True,after_body," We obtain bounds on the ratios we require by applying results from [12]. To begin with
"
17,4.17647058824,0.0,0.0,False,0.0,False,text," we focus on the eect of changing the number of triple pairs while keeping the number of
"
3,5.0,0.0,0.0,False,0.0,False,text," double pairs xed.
"
18,2.16666666667,0.240740740741,0.296296296296,True,1.0,True,heading," Lemma 3.5. Suppose 0  d  N2 and 1  h  N3, with Cd,h 6= .
"
2,7.5,1.0,0.0,False,0.0,False,body," substantial then
"
4,2.75,0.5,0.208333333333,False,0.0,True,body," If (S2, T2) is
"
1,7.0,0.0,0.714285714286,False,0.0,False,after_body," w(Cd,h)
"
1,8.0,0.0,0.75,False,0.0,False,text," w(Cd,h1)
"
1,1.0,0.0,0.0,False,0.0,False,heading," =
"
7,3.0,0.0,0.365079365079,False,0.0,True,body," S3T3 + O(s2t2(st + d + h)S)
"
1,1.0,0.0,1.0,False,0.0,False,after_body," .
"
1,3.0,0.0,0.666666666667,False,0.0,False,text," hS3
"
12,3.83333333333,0.0833333333333,0.0833333333333,False,0.0,True,text," Proof. This follows from [12, Lemma 4.6] since, for h  1,
"
1,7.0,0.0,0.714285714286,False,0.0,False,text," w(Cd,h)
"
1,8.0,0.0,0.75,False,0.0,False,text," w(Cd,h1)
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,7.0,0.0,0.857142857143,False,0.0,False,text," 6|Cd,h|
"
1,7.0,0.0,1.0,False,0.0,False,text," |Cd,h1|
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,2.0,0.0,0.0,False,0.0,False,text," 16
"
18,3.55555555556,0.0,0.0462962962963,False,0.0,True,text," Note that the values of N2, N3 used in this paper are no smaller than, and are at
"
15,4.46666666667,0.0,0.0,False,0.0,False,text," most a constant factor larger than, the values used in [12]. For example, we have
"
13,4.61538461538,0.0,0.426282051282,False,0.0,True,text," N3 = maxlog S, 230000S3T3/S3, while in [12] the value maxlog S, 7S3T3/S3
"
16,4.4375,0.0,0.0,False,0.0,False,text," was used. Examination of the proof of [12, Lemma 4.6] shows that the bound given there
"
17,2.58823529412,0.0,0.225490196078,False,0.0,False,text," for |Cd,h|/|Cd,h1| also holds for all 0  d  N2 and 1  h  N3.
"
9,5.11111111111,0.0,0.0,False,0.0,True,text," Next, adapting the proof of [12, Corollary 4.7] gives:
"
18,3.44444444444,0.388888888889,0.25462962963,True,1.0,True,heading," Corollary 3.6. Suppose 0  d  N2 with Cd,0 6= . Further suppose that (S2, T2) is
"
2,8.0,1.0,0.0,False,0.0,False,after_body," substantial. Then
"
1,2.0,0.0,0.5,False,0.0,True,text," N3
"
1,4.0,0.0,0.5,False,0.0,True,text," Xh=0
"
1,7.0,0.0,0.714285714286,False,0.0,False,text," w(Cd,h)
"
1,7.0,0.0,0.571428571429,False,0.0,False,text," w(Cd,0)
"
2,4.0,0.0,0.214285714286,False,0.0,False,heading," = expS3T3
"
5,3.6,0.0,0.45,False,0.0,True,body," S3 + Os2t2(st + d)/S2.
"
21,2.95238095238,0.047619047619,0.261904761905,False,0.0,True,after_body," Proof. We will apply Lemma 3.4. Let h be the rst value of h  N3 for which Cd,h = ,
"
20,2.05,0.0,0.275,False,0.0,False,text," or h = N3 + 1 if there is no such value. Dene h, 1  h  h, by
"
9,2.33333333333,0.0,0.375,False,0.0,True,text," S3T3  hs2t2(st + d + (h  1)S)
"
1,5.0,0.0,0.0,False,0.0,False,text," (3.2)
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,6.0,0.0,1.0,False,0.0,False,text," |Cd,h|
"
1,7.0,0.0,1.0,False,0.0,False,text," |Cd,h1|
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,3.0,0.0,0.666666666667,False,0.0,False,text," hS3
"
13,3.76923076923,0.0,0.307692307692,True,0.0,True,text," Lemma 3.5 says that h is bounded independently of h, d and S.
"
7,1.57142857143,0.0,0.285714285714,False,0.0,True,text," For 1  h  h, dene
"
2,2.5,0.0,0.25,False,0.0,True,text," A(h) =
"
5,3.6,0.0,0.333333333333,False,0.0,True,text," S3T3  h(s2t2(st + d)S)
"
1,2.0,0.0,0.5,False,0.0,True,text," S3
"
3,2.0,0.0,0.5,False,0.0,False,text," , C(h) =
"
1,5.0,0.0,0.8,False,0.0,False,text," hs2t2
"
1,2.0,0.0,0.5,False,0.0,True,text," S2
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
19,2.89473684211,0.0,0.289473684211,False,0.0,True,text," If h  0 then by denition A(h)  S3T3/S3, and S3T3  0 since h  h. Therefore
"
22,2.68181818182,0.0,0.159090909091,False,0.0,True,text," A(h)  0 in this case. If h  0 then C(h)  0, which implies that A(h)  0 since the
"
17,3.94117647059,0.0,0.149159663866,False,0.0,False,text," right side of (3.2) has the same sign as A(h) (h 1)C(h). Therefore A(h)  0 whenever
"
21,2.38095238095,0.0,0.28835978836,False,0.0,False,text," h  h. Dene B(h) = C(h)/A(h) for 1  h  h. Also dene A(h) = B(h) = 0 for
"
5,1.0,0.0,0.666666666667,False,0.0,False,text," h  h  N3.
"
17,3.70588235294,0.0,0.205882352941,False,0.0,True,text," Dene A1, A2, C1, C2 by taking the minimum and maximum of the A(h) and C(h) over
"
24,2.08333333333,0.0,0.246527777778,False,0.0,False,text," 1  h  N3, as in Lemma 3.4. Let A  [A1, A2] and C  [C1, C2], and set c = 1
"
2,4.0,0.0,0.0,False,0.0,False,text," 41. Since
"
18,3.38888888889,0.0,0.31742979243,False,0.0,True,text," A = S3T3/S3 + o(1) and C = o(1), we have that max{A/N3,|C|}  c for S suciently
"
6,4.0,0.0,0.0555555555556,False,0.0,False,text," large, by the denition of N3.
"
7,5.0,0.0,0.0,False,0.0,True,text," Therefore Lemma 3.4 applies and says that
"
1,2.0,0.0,0.5,False,0.0,True,text," N3
"
1,4.0,0.0,0.5,False,0.0,True,text," Xh=0
"
1,6.0,0.0,1.0,False,0.0,False,text," |Cd,h|
"
1,6.0,0.0,0.833333333333,False,0.0,False,text," |Cd,0|
"
2,4.0,0.0,0.214285714286,False,0.0,False,text," = expS3T3
"
7,4.14285714286,0.0,0.412337662338,False,0.0,True,text," S3 + Os2t2(st + d)/S2 + O(2e/41)N3.
"
17,4.17647058824,0.0,0.129411764706,False,0.0,True,text," Finally, (2e/41)N3  (2e/41)log S  S2. Since the sum we are estimating is at least equal
"
16,4.75,0.0,0.0,False,0.0,False,text," to one, this additive error term is covered by the error terms inside the exponential. This
"
3,6.0,0.0,0.0,False,0.0,False,text," completes the proof.
"
1,2.0,0.0,0.0,False,0.0,False,text," 17
"
10,4.2,0.0,0.0,False,0.0,True,text," Now we must sum over pairings with no triple pairs.
"
19,3.26315789474,0.421052631579,0.241228070175,True,1.0,True,heading," Lemma 3.7. Suppose that (S2, T2) is substantial and that 1  d  N2 with Cd,0 6= .
"
1,4.0,1.0,0.0,False,0.0,True,after_body," Then
"
1,7.0,0.0,0.571428571429,False,0.0,False,text," w(Cd,0)
"
1,8.0,0.0,0.625,False,0.0,False,text," w(Cd1,0)
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,5.0,0.0,0.4,False,0.0,False,text," 2A(d)
"
1,1.0,0.0,1.0,False,0.0,False,heading," d
"
7,1.57142857143,0.0,0.414285714286,False,0.0,False,body," 1  (d  1)B(1 + d)
"
1,5.0,1.0,0.0,False,0.0,False,after_body," where
"
2,2.5,0.0,0.25,False,0.0,True,text," A(d) =
"
2,1.0,0.0,0.5,False,0.0,True,text," B =
"
1,4.0,0.0,0.5,False,0.0,True,text," S2T2
"
3,1.66666666667,0.0,0.444444444444,False,0.0,False,text," 2S2 1 +
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,2.0,0.0,0.5,False,0.0,True,text," S2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,2.0,0.0,0.5,False,0.0,True,text," T2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
5,2.0,0.0,0.64,False,0.0,False,text," d = O(d  1)2s2
"
1,2.0,0.0,0.5,False,0.0,True,text," S2
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,2.0,0.0,0.5,False,0.0,True,text," S2
"
2,1.5,0.0,0.25,False,0.0,True,text," S2 +
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," 4T3
"
2,1.0,0.0,0.5,False,0.0,True,text," T 2
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,2.0,0.0,0.5,False,0.0,True,text," T2
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
2,1.5,0.0,0.25,False,0.0,True,text," S2 +
"
1,1.0,0.0,1.0,False,0.0,True,text," S
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," 4S3
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
2,0.5,0.0,0.0,False,0.0,False,text," 2 
"
1,2.0,0.0,0.5,False,0.0,True,text," S2
"
1,1.0,0.0,1.0,False,0.0,True,text," S
"
3,2.33333333333,0.0,0.233333333333,False,0.0,False,text," (d  1)2t2
"
2,1.0,0.0,0.5,False,0.0,True,text," T 2
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,5.0,0.0,0.4,False,0.0,False,text," 2S3T2
"
2,2.5,0.0,0.25,False,0.0,True,text," S2S2 +
"
1,5.0,0.0,0.4,False,0.0,False,text," 2S2T3
"
2,2.0,0.0,0.25,False,0.0,True,text," S2T2 
"
1,4.0,0.0,0.5,False,0.0,True,text," S3T3
"
2,2.5,0.0,0.3,False,0.0,True,text," SS2T2 
"
1,5.0,0.0,0.4,False,0.0,False,text," 2S2T2
"
4,2.0,0.0,0.325,False,0.0,True,text," S3  + Os3t3
"
2,1.5,0.0,1.25,False,0.0,True,text," S2 ,
"
1,1.0,0.0,1.0,False,0.0,False,text," ,
"
1,1.0,0.0,0.0,False,0.0,False,heading," +
"
3,3.0,0.0,0.488888888889,False,0.0,False,body," dst(d + st)
"
1,4.0,0.0,0.5,False,0.0,True,after_body," S2T2
"
1,1.0,0.0,2.0,False,0.0,False,text," .
"
12,3.83333333333,0.0833333333333,0.0833333333333,False,0.0,True,text," Proof. This follows from [12, Lemma 4.8] since, for d  1,
"
1,7.0,0.0,0.571428571429,False,0.0,False,text," w(Cd,0)
"
1,8.0,0.0,0.625,False,0.0,False,text," w(Cd1,0)
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,7.0,0.0,0.714285714286,False,0.0,False,text," 2|Cd,0|
"
1,7.0,0.0,0.857142857143,False,0.0,False,text," |Cd1,0|
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
19,3.52631578947,0.0,0.0263157894737,False,0.0,True,text," As in Lemma 3.5, our value of N2 is no smaller than, and is at most a constant factor
"
16,4.4375,0.0,0.0,False,0.0,False,text," larger than, the value used in [12]. Examination of the proof of [12, Lemma 4.8] shows
"
15,4.06666666667,0.0,0.146031746032,False,0.0,False,text," that the expression given there for |Cd,0|/|Cd1,0| also holds for 1  d  N2.
"
10,5.3,0.0,0.0,False,0.0,True,text," Adapting the proof of [12, Corollary 4.9] gives the following:
"
8,4.875,0.5,0.104166666667,True,1.0,True,heading," Corollary 3.8. If (S2, T2) is substantial then
"
1,2.0,0.0,0.5,False,0.0,True,after_body," N2
"
1,2.0,0.0,0.5,False,0.0,True,text," N3
"
1,4.0,0.0,0.5,False,0.0,True,text," Xd=0
"
1,4.0,0.0,0.5,False,0.0,True,text," Xh=0
"
1,7.0,0.0,0.714285714286,False,0.0,False,text," w(Cd,h)
"
1,7.0,0.0,0.428571428571,False,0.0,False,text," w(C0,0)
"
3,2.66666666667,0.0,0.277777777778,False,0.0,False,text," = exp S2T2
"
2,1.5,0.0,0.25,False,0.0,True,text," S2 +
"
1,4.0,0.0,0.5,False,0.0,True,text," S2T2
"
3,2.66666666667,0.0,0.433333333333,False,0.0,True,text," S3 + Os3t3
"
2,1.5,0.0,1.75,False,0.0,True,text," S2 .
"
17,3.94117647059,0.0588235294118,0.0,False,0.0,True,text," Proof. We need to apply Lemma 3.3 to the result of Lemma 3.7, and take into account
"
12,4.66666666667,0.0,0.0,False,0.0,False,text," the terms coming from the triple pairs (as given by Corollary 3.6).
"
25,2.4,0.0,0.273333333333,False,0.0,True,text," Let d be the rst value of d  N2 for which |Cd,0| = 0, or d = N2 + 1 if no such value
"
12,2.41666666667,0.0,0.583333333333,False,0.0,False,text," of d exists. Dene m0, m1, . . . , mN2 by
"
1,7.0,0.0,0.714285714286,False,0.0,False,text," w(Cd,h)
"
1,7.0,0.0,0.571428571429,False,0.0,False,text," w(Cd,0)
"
18,1.83333333333,0.0,0.351851851852,False,0.0,False,text," for 0  d  d, and md = 0 for d  d  N2. Then clearly
"
1,7.0,0.0,0.571428571429,False,0.0,False,text," w(Cd,0)
"
1,7.0,0.0,0.428571428571,False,0.0,False,text," w(C0,0)
"
1,4.0,0.0,0.5,False,0.0,True,text," Xh=0
"
2,1.5,0.0,0.5,False,0.0,False,text," md =
"
1,2.0,0.0,0.5,False,0.0,True,text," N3
"
1,2.0,0.0,0.5,False,0.0,True,text," N2
"
1,2.0,0.0,0.5,False,0.0,True,text," N3
"
1,4.0,0.0,0.5,False,0.0,True,text," Xd=0
"
1,4.0,0.0,0.5,False,0.0,True,text," Xh=0
"
1,7.0,0.0,0.714285714286,False,0.0,False,text," w(Cd,h)
"
1,7.0,0.0,0.428571428571,False,0.0,False,text," w(C0,0)
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,2.0,0.0,0.5,False,0.0,True,text," N2
"
1,4.0,0.0,0.5,False,0.0,True,text," Xd=0
"
1,3.0,0.0,1.0,False,0.0,False,text," md.
"
1,2.0,0.0,0.0,False,0.0,False,text," 18
"
11,3.09090909091,0.0,0.272727272727,True,0.0,True,text," Corollary 3.6 tells us that for d  d we have
"
2,1.5,0.0,0.5,False,0.0,False,text," md =
"
1,7.0,0.0,0.571428571429,False,0.0,False,text," w(Cd,0)
"
1,7.0,0.0,0.428571428571,False,0.0,False,text," w(C0,0)
"
1,7.0,0.0,0.428571428571,False,0.0,False,text," expS3T3
"
5,4.4,0.0,0.375,False,0.0,True,text," S3 + O(s3t3/S2) + ds2t2/S2
"
1,5.0,0.0,0.0,False,0.0,False,text," (3.3)
"
22,2.68181818182,0.0,0.306060606061,False,0.0,False,text," where 0 = 0 and in general d = O(d). (Note that (3.3) is also true for d  d  N2,
"
22,2.77272727273,0.0,0.242424242424,False,0.0,False,text," since both sides equal zero.) If  is a constant such that |d|  d for 0  d  d, then
"
1,7.0,0.0,0.428571428571,False,0.0,False,text," expS3T3
"
3,3.0,0.0,0.47619047619,False,0.0,False,text," md  expS3T3
"
4,3.75,0.0,0.4,False,0.0,True,text," S3 + O(s3t3/S2) N2
"
1,4.0,0.0,0.5,False,0.0,True,text," Xd=0
"
4,3.75,0.0,0.4,False,0.0,True,text," S3 + O(s3t3/S2) N2
"
1,4.0,0.0,0.5,False,0.0,True,text," Xd=0
"
2,2.5,0.0,0.3,False,0.0,False,text," nd(1) 
"
1,2.0,0.0,0.5,False,0.0,True,text," N2
"
1,4.0,0.0,0.5,False,0.0,True,text," Xd=0
"
1,5.0,0.0,0.4,False,0.0,False,text," nd(1)
"
1,5.0,0.0,0.0,False,0.0,False,text," (3.4)
"
1,5.0,0.0,0.0,False,0.0,False,text," where
"
2,3.0,0.0,0.3,False,0.0,False,text," nd(x) =
"
1,7.0,0.0,0.571428571429,False,0.0,False,text," w(Cd,0)
"
1,7.0,0.0,0.428571428571,False,0.0,False,text," w(C0,0)
"
1,13.0,0.0,0.769230769231,False,0.0,False,text," expxds2t2/S2.
"
19,2.26315789474,0.0,0.249122807018,False,0.0,True,text," Next we note that, for x  {1, 1}, n0(x) = 1, and for 1  d  d,
"
1,5.0,0.0,0.6,False,0.0,False,text," nd(x)
"
1,6.0,0.0,0.666666666667,False,0.0,False,text," nd1(x)
"
8,1.875,0.0,0.59375,False,0.0,False,text," = 2A(d)1  (d  1)B1 + d
"
15,4.6,0.0,0.193333333333,False,0.0,False,text," with A(d), B, and d satisfying the expressions given in the statement of Lemma 3.7.
"
15,4.73333333333,0.0,0.0574358974359,False,0.0,True,text," This follows since the factor exp(xs2t2/S2) is covered by the error term on A(d). For
"
9,1.66666666667,0.0,0.444444444444,False,0.0,False,text," d  d  N2 dene A(d) = 0.
"
17,3.47058823529,0.0,0.174509803922,False,0.0,True,text," Now let A1 = A1(x) = mind 2A(d), A2 = A2(x) = maxd 2A(d), where the maximum
"
23,2.4347826087,0.0,0.166666666667,False,0.0,False,text," and minimum are taken over 1  d  N2. Also let B1 = B2 = B, and K = 3, and dene
"
20,3.25,0.0,0.175,False,0.0,False,text," c = S1/4 if S2T2  S7/4 and c = 41 otherwise. The conditions of Lemma 3.3 now hold as
"
10,3.4,0.0,0.183333333333,False,0.0,False,text," we will show. Let A  [A1, A2] be arbitrary.
"
18,3.33333333333,0.0,0.212962962963,False,0.0,True,text," Clearly c  2e. If S2T2  S7/4 then N2 = 22. Using the condition S2T2  (st)3/2S
"
19,3.47368421053,0.0,0.15,False,0.0,False,text," implied by the substantiality of (S2, T2), we nd that Ac = 1 + o(1). For S2T2  S7/4,
"
19,3.57894736842,0.0,0.126156299841,False,0.0,True,text," Ac = 41S2T2/S2(1 + o(1)). It is also easy to check that BN2 = o(1). Thus, in all cases
"
16,2.6875,0.0,0.175,False,0.0,False,text," we have that Ac  N2  2 and |BN2|  1 for suciently large S.
"
5,3.6,0.0,0.3,False,0.0,True,text," If d = O(S2T2/S2) then
"
1,2.0,0.0,0.5,False,0.0,True,text," N2
"
1,4.0,0.0,0.5,False,0.0,True,text," Xd=1
"
4,2.75,0.0,0.541666666667,False,0.0,False,text," |d| = Os2S2T 3
"
2,1.5,0.0,0.25,False,0.0,True,text," S6 +
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,4.0,0.0,0.5,False,0.0,False,text," t2S3
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," 2T2
"
2,1.5,0.0,0.25,False,0.0,True,text," S6 +
"
1,4.0,0.0,0.75,False,0.0,False,text," stS2
"
2,1.5,0.0,0.25,False,0.0,False,text," 2T 2
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
2,1.5,0.0,0.25,False,0.0,True,text," S6 +
"
7,2.28571428571,0.0,0.47619047619,False,0.0,False,text," while if d  log S then
"
1,8.0,0.0,0.5,False,0.0,False,text," s2t2S2T2
"
4,2.0,0.0,0.325,False,0.0,True,text," S4  = Os3t3
"
4,2.0,0.0,0.225,False,0.0,True,text," S2  = o(1),
"
1,2.0,0.0,0.5,False,0.0,True,text," N2
"
1,4.0,0.0,0.5,False,0.0,True,text," Xd=1
"
5,2.4,0.0,0.666666666667,False,0.0,False,text," |d| = Os2 log3 S
"
1,2.0,0.0,0.5,False,0.0,True,text," S2
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
3,2.33333333333,0.0,0.5,False,0.0,False,text," t2 log3 S
"
2,1.0,0.0,0.5,False,0.0,True,text," T 2
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
3,2.33333333333,0.0,0.666666666667,False,0.0,False,text," st log3 S
"
1,4.0,0.0,0.5,False,0.0,True,text," S2T2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
3,3.0,0.0,0.5,False,0.0,False,text," s2t2 log2 S
"
4,2.5,0.0,0.225,False,0.0,True,text," S2T2  = o(1).
"
1,2.0,0.0,0.0,False,0.0,False,text," 19
"
1,1.0,0.0,1.0,False,0.0,False,text," k
"
9,2.44444444444,0.0,0.148148148148,False,0.0,True,text," Finally, for 1  k  N2, we have
"
4,1.75,0.0,0.333333333333,False,0.0,False,text," (d  1)2 s2
"
1,4.0,0.0,0.5,False,0.0,True,text," Xd=1
"
4,1.5,0.0,1.08333333333,False,0.0,False,text," |d| = O k
"
1,4.0,0.0,0.5,False,0.0,True,text," Xd=1
"
1,2.0,0.0,0.5,False,0.0,True,text," S2
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
7,2.0,0.0,0.314285714286,False,0.0,False,text," = Ok(k  1)(2k  1) s2
"
1,4.0,0.0,0.5,False,0.0,True,text," Xj=0
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,6.0,0.0,0.833333333333,False,0.0,False,text," j[k]j,
"
1,2.0,0.0,0.5,False,0.0,True,text," S2
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,1.0,False,0.0,True,text," K
"
1,2.0,0.0,0.5,False,0.0,False,text," t2
"
2,1.0,0.0,0.5,False,0.0,True,text," T 2
"
5,0.8,0.0,0.6,False,0.0,False,text," 2  + O k
"
1,4.0,0.0,0.5,False,0.0,True,text," Xd=1
"
3,0.666666666667,0.0,0.0,False,0.0,False,text," 2  +
"
1,2.0,0.0,0.5,False,0.0,False,text," t2
"
2,1.0,0.0,0.5,False,0.0,True,text," T 2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,4.0,0.0,0.75,False,0.0,False,text," d2st
"
4,1.75,0.0,0.9375,False,0.0,True,text," S2T2 + O k
"
1,4.0,0.0,0.5,False,0.0,True,text," Xd=1
"
1,5.0,0.0,0.6,False,0.0,False,text," ds2t2
"
1,4.0,0.0,0.75,False,0.0,True,text," S2T2
"
5,2.8,0.0,0.273333333333,False,0.0,False,text," k(k + 1)(2k + 1)st
"
1,4.0,0.0,0.5,False,0.0,True,text," S2T2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
3,3.33333333333,0.0,0.333333333333,False,0.0,False,text," k(k + 1)s2t2
"
1,4.0,0.0,0.5,False,0.0,True,text," S2T2
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,5.0,0.0,0.0,False,0.0,False,text," where
"
7,1.57142857143,0.0,0.714285714286,False,0.0,False,heading," 0 = 0, 1 = O s2t2
"
4,1.75,0.0,0.1875,False,0.0,False,body," 2 + t2/T 2
"
2,3.5,0.0,0.25,False,0.0,False,after_body," 2 (s2/S2
"
3,2.33333333333,0.0,0.333333333333,False,0.0,True,text," Since N 3
"
5,2.0,0.0,0.86,False,0.0,True,text," S2T2, 2 = O s2
"
1,2.0,0.0,0.5,False,0.0,True,text," S2
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,2.0,0.0,0.5,False,0.0,False,text," t2
"
2,1.0,0.0,0.5,False,0.0,True,text," T 2
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,4.0,0.0,0.5,False,0.0,False,text," s2t2
"
5,2.0,0.0,0.86,False,0.0,True,text," S2T2, 3 = O s2
"
1,2.0,0.0,0.5,False,0.0,True,text," S2
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,2.0,0.0,0.5,False,0.0,False,text," t2
"
2,1.0,0.0,0.5,False,0.0,True,text," T 2
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,2.0,0.0,1.0,False,0.0,False,text," st
"
1,5.0,0.0,0.8,False,0.0,True,text," S2T2.
"
9,4.11111111111,0.0,0.0916666666667,False,0.0,False,text," 2 + st/S2T2) = o(1), which is easily checked,
"
3,4.33333333333,0.0,0.0,False,0.0,False,text," it follows that
"
1,2.0,0.0,1.0,False,0.0,True,text," PK
"
15,2.53333333333,0.0,0.253333333333,False,0.0,False,text," j=0 j[k]j  1/5 for 1  k  N2, when S is large enough.
"
15,4.6,0.0,0.0,False,0.0,True,text," Therefore the conditions of Lemma 3.3 hold, and we conclude that each of the bounds
"
6,3.66666666667,0.0,0.111111111111,False,0.0,False,text," given by that lemma for PN2
"
5,3.6,0.0,0.186666666667,False,0.0,False,text," d=0 nd(x) has the form
"
3,1.66666666667,0.0,0.166666666667,False,0.0,False,text," expA  1
"
5,2.2,0.0,0.293333333333,False,0.0,False,text," 2 A2B + OA3B2 +
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
1,4.0,0.0,0.5,False,0.0,True,text," Xj=0
"
3,5.66666666667,0.0,0.6,False,0.0,False,text," j(3A)j + O(2e/c)N2,
"
13,3.92307692308,0.0,0.141025641026,False,0.0,False,text," where A is either A1 or A2. A somewhat tedious check shows that
"
2,4.0,0.0,0.214285714286,False,0.0,True,text," O(A3B2) +
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
1,4.0,0.0,0.5,False,0.0,True,text," Xj=0
"
3,6.0,0.0,0.40404040404,False,0.0,False,text," j(3A)j = O(s3t3/S2).
"
15,4.33333333333,0.0,0.14,False,0.0,True,text," Next consider the error term O(2e/c)N2. If N2 = 22 then (2e/c)N2 = (2eS1/4)22 =
"
16,4.25,0.0,0.189583333333,False,0.0,True,text," O(S2), while in the other cases we have (2e/c)N2 = (2e/41)N2  (2e/41)log S = O(S2).
"
18,3.88888888889,0.0,0.0277777777778,False,0.0,True,text," Since n0 = 1, this additive error term is covered by a relative error of the same form.
"
7,4.28571428571,0.0,0.0952380952381,False,0.0,True,text," Therefore, each of the bounds on PN2
"
5,3.6,0.0,0.186666666667,False,0.0,False,text," d=0 nd(x) has the form
"
3,1.66666666667,0.0,0.166666666667,False,0.0,False,text," expA  1
"
4,2.5,0.0,0.366666666667,False,0.0,False,text," 2 A2B + Os3t3
"
5,2.0,0.0,0.266666666667,False,0.0,True,text," S2  = exp S2T2
"
2,1.5,0.0,0.25,False,0.0,True,text," S2 +
"
1,4.0,0.0,0.5,False,0.0,True,text," S2T2
"
2,1.0,0.0,0.25,False,0.0,True,text," S3 
"
1,4.0,0.0,0.5,False,0.0,True,text," S3T3
"
3,2.66666666667,0.0,0.433333333333,False,0.0,True,text," S3 + Os3t3
"
2,1.5,0.0,1.75,False,0.0,True,text," S2 .
"
16,4.375,0.0,0.03125,False,0.0,True,text," Modulo the given error terms, the nal expression does not depend on x, nor on whether
"
17,4.0,0.0,0.0,False,0.0,False,text," we are taking a lower bound or upper bound in Lemma 3.3. To complete the proof, just
"
2,5.5,0.0,0.0,False,0.0,False,text," apply (3.4).
"
14,5.0,0.0,0.0,True,0.0,True,text," Corollary 3.8 and Lemma 3.2 together prove Theorem 1.3 in the substantial case. The
"
8,5.5,0.0,0.0,False,0.0,False,text," insubstantial case was already proved in Lemma 3.1.
"
1,2.0,0.0,0.0,False,0.0,False,text," 20
"
3,7.66666666667,0.0,0.0,False,1.0,False,text," 4 Alternative formulation
"
15,4.73333333333,0.0,0.133333333333,False,0.0,True,text," We now derive an alternative formulation of Theorem 1.3. Recall the denition of k and
"
5,4.8,0.0,0.4,False,0.0,False,text," k given in the Introduction.
"
8,5.5,0.75,0.0,True,1.0,True,text," Corollary 4.1. Under the conditions of Theorem 1.3,
"
1,1.0,0.0,1.0,False,0.0,False,text," m
"
1,4.0,0.0,0.5,False,0.0,True,text," Yi=1
"
3,2.33333333333,0.0,0.166666666667,False,0.0,True,text," M(s, t) =
"
1,5.0,0.0,1.0,False,0.0,False,text," n+si1
"
3,1.0,0.0,0.666666666667,False,0.0,False,text," si  n
"
1,4.0,0.0,0.5,False,0.0,True,text," Yj=1
"
1,5.0,0.0,1.0,False,0.0,False,text," mn+S1
"
1,5.0,0.0,1.0,False,0.0,False,text," m+tj1
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,2.0,0.0,1.0,False,0.0,False,text," tj
"
1,1.0,0.0,1.0,False,0.0,True,text," S
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
6,2.0,0.0,0.186111111111,False,0.0,False,text,"  exp(1  2)(1  2)1
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
2,1.0,0.0,0.25,False,0.0,False,text," 4S 
"
3,1.0,0.0,0.333333333333,False,0.0,False,text," 3  22
"
1,0.0,0.0,0.0,False,0.0,False,heading," 
"
7,1.71428571429,0.0,0.25,False,0.0,False,body," (1  2)(3 + 2  222)
"
3,1.33333333333,0.0,0.166666666667,False,0.0,False,after_body," (1  32
"
5,1.8,0.0,0.14,False,0.0,False,text," 2 + 23)(1  32
"
1,2.0,0.0,0.5,False,0.0,False,text," 4n
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," 12S
"
7,1.71428571429,0.0,0.25,False,0.0,False,text," (1  2)(3 + 2  222)
"
1,2.0,0.0,0.5,False,0.0,False,text," 4m
"
3,1.66666666667,0.0,0.111111111111,False,0.0,False,text," 2 + 23)
"
2,3.0,0.0,0.4,False,0.0,False,text," + Os3t3
"
2,1.5,0.0,1.75,False,0.0,True,text," S2 .
"
6,6.0,0.166666666667,0.0,False,0.0,True,text," Proof. By Stirlings formula or otherwise,
"
1,4.0,0.0,1.0,False,0.0,True,text," N+x1
"
3,0.666666666667,0.0,0.333333333333,False,0.0,False,text," x  =
"
2,1.0,0.0,1.0,False,0.0,True,text," N x
"
1,2.0,0.0,0.5,False,0.0,False,text," x!
"
1,7.0,0.0,0.285714285714,False,0.0,False,text," exp[x]2
"
2,1.0,0.0,0.25,False,0.0,False,text," 2N 
"
1,4.0,0.0,0.25,False,0.0,False,text," [x]3
"
3,1.0,0.0,0.166666666667,False,0.0,False,text," 6N 2 
"
1,4.0,0.0,0.25,False,0.0,False,text," [x]2
"
5,2.4,0.0,0.333333333333,False,0.0,False,text," 4N 2 + O(x4/N 3)
"
16,4.125,0.0,0.125,False,0.0,False,text," as N  , provided that the error term is bounded. This gives us the approximations
"
1,1.0,0.0,1.0,False,0.0,False,text," m
"
1,1.0,0.0,1.0,False,0.0,False,text," n
"
1,5.0,0.0,1.0,False,0.0,False,text," n+si1
"
1,4.0,0.0,0.5,False,0.0,True,text," Yi=1
"
1,5.0,0.0,1.0,False,0.0,False,text," m+tj1
"
1,4.0,0.0,0.5,False,0.0,True,text," Yj=1
"
1,5.0,0.0,1.0,False,0.0,False,text," mn+S1
"
3,1.0,0.0,0.333333333333,False,0.0,False,text," si  =
"
2,0.5,0.0,0.0,False,0.0,False,text,"  =
"
2,0.5,0.0,0.0,False,0.0,False,text,"  =
"
1,2.0,0.0,1.0,False,0.0,False,text," tj
"
1,1.0,0.0,1.0,False,0.0,True,text," S
"
1,2.0,0.0,1.0,False,0.0,False,text," nS
"
1,2.0,0.0,1.0,False,0.0,False,text," mS
"
2,2.5,0.0,0.833333333333,False,0.0,True,text," Qi si!
"
2,2.5,0.0,0.833333333333,False,0.0,True,text," Qj tj!
"
1,5.0,0.0,0.6,False,0.0,False,text," (mn)S
"
1,2.0,0.0,0.5,False,0.0,True,text," S!
"
2,2.5,0.0,0.416666666667,False,0.0,False,text," exp S2
"
2,1.0,0.0,0.25,False,0.0,False,text," 2n 
"
2,2.5,0.0,0.416666666667,False,0.0,False,text," exp T2
"
2,1.0,0.0,0.25,False,0.0,False,text," 2m 
"
2,2.5,0.0,0.416666666667,False,0.0,False,text," exp S2
"
2,1.5,0.0,0.333333333333,False,0.0,False,text," 2mn 
"
1,2.0,0.0,0.5,False,0.0,True,text," S2
"
2,1.5,0.0,0.166666666667,False,0.0,False,text," 4n2 
"
1,2.0,0.0,0.5,False,0.0,True,text," T2
"
2,1.5,0.0,0.166666666667,False,0.0,False,text," 4m2 
"
1,2.0,0.0,0.5,False,0.0,True,text," T3
"
1,2.0,0.0,0.5,False,0.0,True,text," S3
"
3,3.0,0.0,0.377777777778,False,0.0,False,text," 6n2 + Os3t3
"
2,1.0,0.0,0.25,False,0.0,True,text," S2 
"
3,3.0,0.0,0.377777777778,False,0.0,False,text," 6m2 + Os3t3
"
2,1.0,0.0,0.25,False,0.0,True,text," S2 
"
3,3.66666666667,0.0,0.4,False,0.0,False,text," 6m2n2 + Os3t3
"
1,2.0,0.0,0.5,False,0.0,True,text," S3
"
1,1.0,0.0,1.0,False,0.0,True,text," S
"
2,1.5,0.0,0.333333333333,False,0.0,False,text," 2mn 
"
2,1.5,0.0,1.75,False,0.0,True,text," S2 .
"
15,5.0,0.0,0.166666666667,False,0.0,True,text," Substitute these expressions into Theorem 1.3 and replace S2, S3, T2, T3 by their equiva-
"
13,3.76923076923,0.0,0.269230769231,False,0.0,False,text," lents in terms of 2, 3, 2, 3. The desired result is obtained.
"
12,6.0,0.0,0.0,False,0.0,True,text," As noted in the Introduction, Theorem 1.3 establishes the conjecture recalled after
"
15,4.93333333333,0.0,0.0,True,0.0,True,text," Theorem 1.1 in some cases. Using Corollary 4.1, the following is easily seen. (Note that
"
13,2.38461538462,0.0,0.307692307692,False,0.0,False,text," 2 = 3 = 2 = 3 = 0 in the semiregular case.)
"
20,3.05,0.205555555556,0.408333333333,True,1.0,True,heading," Corollary 4.2. If s = s(m, n) and t = t(m, n) satisfy ms = nt and st = o(mn)1/5,
"
1,4.0,1.0,0.0,False,0.0,False,body," then
"
5,2.0,0.0666666666667,0.533333333333,False,0.0,False,body," (m, s; n, t) =
"
3,2.0,0.0,0.277777777778,False,0.0,False,body," 5(s + t)
"
3,2.33333333333,0.0,0.533333333333,False,0.0,False,body," 1 + o(1).
"
1,3.0,0.0,0.666666666667,False,0.0,False,after_body," 6st
"
1,2.0,0.0,0.0,False,0.0,False,text," 21
"
16,4.4375,0.0,0.0,False,0.0,True,text," Most of the terms inside the exponential of Corollary 4.1 are tiny unless at least one
"
18,4.05555555556,0.0,0.0833333333333,False,0.0,False,text," of 2, 2 is quite large (that is, the graph is very far from semiregular). In particular we
"
11,5.0,0.0,0.0,False,0.0,False,text," can now prove Corollary 1.5 which was stated in the Introduction.
"
16,4.625,0.25,0.0,False,0.0,True,text," Proof of Corollary 1.5. It is only necessary to check that the additional terms in Corol-
"
21,2.90476190476,0.0,0.246031746032,False,0.0,False,text," lary 4.1 have the required size. It helps to realise that 2  s, |3|  s2, 2  t and
"
3,2.0,0.0,0.555555555556,False,0.0,False,text," |3|  t2.
"
16,4.0,0.0,0.25,False,0.0,True,text," A random nonnegative m n matrix with entries summing to S is just a random com-
"
15,4.8,0.0,0.133333333333,False,0.0,False,text," position of S into mn parts. (A composition is an ordered sum of nonnegative numbers.)
"
13,2.84615384615,0.0,0.230769230769,False,0.0,True,text," In particular, for 1  i  m the row sum si satises
"
9,1.0,0.0,0.537037037037,False,0.0,True,text," S  k + (m  1)n  1
"
9,1.44444444444,0.0,0.433333333333,False,0.0,True,text," Pr(si = k) = k + n  1
"
5,1.0,0.0,1.0,False,0.0,True,text," S + mn  1
"
5,1.2,0.0,0.333333333333,False,0.0,False,text," (0  k  S).
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,1.0,0.0,1.0,False,0.0,True,text," S
"
1,1.0,0.0,1.0,False,0.0,False,text," k
"
3,0.666666666667,0.0,0.666666666667,False,0.0,True,text," S  k
"
9,5.22222222222,0.0,0.0,False,0.0,True,text," From this we can compute the following expected values.
"
3,1.0,0.0,0.666666666667,False,0.0,True,text," E 2 =
"
3,1.0,0.0,0.666666666667,False,0.0,True,text," E 3 =
"
1,1.0,0.0,1.0,False,0.0,False,text," ,
"
3,1.66666666667,0.0,0.222222222222,False,0.0,False,text," n(m  1)
"
3,1.33333333333,0.0,0.333333333333,False,0.0,False,text," mn + 1
"
7,2.28571428571,0.0,0.235714285714,False,0.0,False,text," n(m  1)(m  2)(mn + 2S)
"
5,2.6,0.0,0.23,False,0.0,False,text," m(mn + 1)(mn + 2)
"
3,1.0,0.0,0.666666666667,False,0.0,True,text," E 2 =
"
1,1.0,0.0,1.0,False,0.0,False,text," ,
"
3,1.0,0.0,0.666666666667,False,0.0,True,text," E 3 =
"
1,1.0,0.0,1.0,False,0.0,False,text," ,
"
3,1.66666666667,0.0,0.222222222222,False,0.0,False,text," m(n  1)
"
3,1.33333333333,0.0,0.333333333333,False,0.0,False,text," mn + 1
"
7,2.28571428571,0.0,0.235714285714,False,0.0,False,text," m(n  1)(n  2)(mn + 2S)
"
5,2.6,0.0,0.23,False,0.0,False,text," n(mn + 1)(mn + 2)
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
14,5.21428571429,0.0,0.0,False,0.0,True,text," The rst two expectations suggest that the argument of the exponential in Corollary 1.5
"
19,3.89473684211,0.0,0.0,False,0.0,False,text," is close to 0 with high probability for such a random matrix. We will prove this in a future
"
17,3.94117647059,0.0,0.0,False,0.0,False,text," paper, and note that the result gives a model for the row and column sums of random
"
1,9.0,0.0,0.0,False,0.0,False,text," matrices.
"
6,5.16666666667,0.0,0.0,False,1.0,False,text," 5 Restricted sets of allowed entries
"
18,4.05555555556,0.0,0.12037037037,False,0.0,True,text," Given a subset J of the nonnegative integers, let M(s, t,J ) denote the set of matrices in
"
21,3.33333333333,0.0,0.203174603175,False,0.0,True,text," M(s, t) with all entries in the set J . Let M(s, t,J ) = |M(s, t,J )|. By generalising the
"
15,4.86666666667,0.0,0.0777777777778,False,0.0,False,text," techniques of the preceding sections, we can nd an asymptotic expression for M(s, t,J )
"
6,2.16666666667,0.0,0.25,False,0.0,False,text," whenever 0, 1  J .
"
30,1.56666666667,0.308333333333,0.316666666667,True,1.0,True,heading," Lemma 5.1. Let J  N with 0, 1  J . Dene 2 = 0 if 2 / J , 2 = 1 if 2  J , and
"
3,5.0,0.833333333333,0.166666666667,False,0.0,False,body," similarly 3. Then
"
7,2.71428571429,0.0,0.309523809524,False,0.0,True,after_body," M(s, t,J ) = N(s, t) exp2
"
1,2.0,0.0,0.5,False,0.0,True,text," S!
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,2.0,0.0,1.0,False,0.0,True,text," Qm
"
3,2.66666666667,0.0,0.666666666667,False,0.0,False,text," i=1 si! Qn
"
2,3.0,0.0,0.5,False,0.0,False,text," j=1 tj!
"
1,4.0,0.0,0.5,False,0.0,True,text," S2T2
"
3,1.33333333333,0.0,0.5,False,0.0,True,text," S2 + 2
"
3,2.0,0.0,0.133333333333,False,0.0,False,text," exp(2  1
"
1,2.0,0.0,0.0,False,0.0,False,text," 2)
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," 4S4
"
1,2.0,0.0,0.0,False,0.0,False,text," 22
"
1,4.0,0.0,0.5,False,0.0,True,text," S3T3
"
1,4.0,0.0,0.5,False,0.0,True,text," S2T2
"
5,1.4,0.0,0.3,False,0.0,True,text," S3 + (3  2)
"
3,2.66666666667,0.0,0.433333333333,False,0.0,True,text," S3 + Os3t3
"
1,4.0,0.0,0.5,False,0.0,True,text," S2T2
"
5,1.2,0.0,0.2,False,0.0,True,text," S2 + (2  1
"
1,2.0,0.0,0.0,False,0.0,False,text," 2)
"
2,1.0,0.0,0.25,False,0.0,True,text," S2 
"
1,4.0,0.0,0.5,False,0.0,True,text," S2T2
"
7,1.14285714286,0.0,0.285714285714,False,0.0,True,text," S3 + (3  2 + 1
"
2,1.0,0.0,0.0,False,0.0,False,text," 3 )
"
3,3.0,0.0,0.377777777778,False,0.0,False,text," 2S5 + Os3t3
"
2,1.5,0.0,0.25,False,0.0,False,text," 2T 2
"
1,2.0,0.0,0.5,False,0.0,True,text," S2
"
2,1.5,0.0,1.75,False,0.0,True,text," S2 .
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,4.0,0.0,0.5,False,0.0,True,text," S3T3
"
1,2.0,0.0,0.5,False,0.0,True,text," S3
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
3,3.66666666667,0.0,0.253968253968,False,0.0,True,text," S2T2(S2 + T2)
"
1,2.0,0.0,0.5,False,0.0,True,text," S2
"
4,2.0,0.0,0.25,False,0.0,False,text," 2T3 + S3T 2
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," 2S4
"
16,4.3125,0.0625,0.0,False,0.0,True,text," Proof. Our general approach will be similar to that we used for Theorem 1.3, but the
"
15,4.8,0.0,0.0,False,0.0,False,text," methods of Section 2 will need signicant modication. The source of the problem is that
"
12,3.66666666667,0.0,0.0909090909091,False,0.0,False,text," a D-switching may introduce an entry that is not in J .
"
22,2.72727272727,0.0,0.209090909091,False,0.0,True,text," For Q  M(s, t) and i  1, let ni(Q) be the number of entries of Q equal to i. Also
"
18,3.66666666667,0.0,0.218518518519,False,0.0,False,text," let n5(Q) = Pi5 ni(Q). Dene N2 and N3 as in Section 2 when (S2, T2) is substantial,
"
18,2.83333333333,0.0,0.175925925926,False,0.0,False,text," and N2 = 2 and N3 = 1 when (S2, T2) is insubstantial. For Q  M+, let
"
3,5.0,0.0,0.42962962963,False,0.0,True,text," E+(Q) = XD(st)1/4
"
1,6.0,0.0,0.666666666667,False,0.0,False,text," nD(Q),
"
2,2.5,0.0,0.375,False,0.0,True,text," E(Q) =
"
1,7.0,0.0,0.714285714286,False,0.0,False,text," (st)1/4
"
1,4.0,0.0,0.5,False,0.0,True,text," XD=5
"
1,6.0,0.0,0.666666666667,False,0.0,False,text," nD(Q).
"
7,5.14285714286,0.0,0.0714285714286,False,0.0,True,text," Consider the following subsets of M(s, t):
"
11,2.09090909091,0.0,0.55303030303,False,0.0,True,text," M+ = M(s, t,J  {4, 5, 6, . . .}),
"
5,2.2,0.0,0.533333333333,False,0.0,True,text," M = M(s, t,J ),
"
11,2.45454545455,0.0,0.590909090909,False,0.0,True,text," M = Q  M+  n2(Q), n3(Q), n4(Q)  S5/6,
"
18,2.0,0.0,0.535185185185,False,0.0,True,text," M = Q  M(s, t,J  {0, 1, 2, 3})  n2(Q)  N2, n3(Q)  N3.
"
7,4.71428571429,0.0,0.454761904762,False,0.0,True,text," E(Q)  2(stS)1/2, E+(Q)  2(st)1/4 S1/2},
"
16,4.1875,0.0,0.46875,False,0.0,True,text," Also dene the cardinalities M +, M, M , M , respectively. By monotonicity, we have
"
16,0.75,0.0,0.375,False,0.0,True,text," M   M  M + and M   M   M +.
"
19,2.47368421053,0.0,0.526315789474,False,0.0,True,text," We now employ switchings to establish that M +M   M M  and M M  =
"
14,3.92857142857,0.0,0.37012987013,False,0.0,True,text," O(s3t3/S2)M , from which it follows that M = 1 + O(s3t3/S2)M . (OK?)
"
21,2.09523809524,0.0,0.5,False,0.0,True,text," We start with the claim that M +M   M M . Let Q  M+  M such that
"
13,5.76923076923,0.0,0.0721893491124,False,0.0,True,text," E+(Q)  2(st)1/4S1/2. We will use the following switching, illustrated by this operation
"
3,7.66666666667,0.0,0.0,False,0.0,False,text," performed on submatrices:
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
6,1.16666666667,0.0,0.666666666667,False,0.0,False,text," 0 D2 7 D1  1
"
1,2.0,0.0,1.0,False,0.0,True,text," D1
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
3,1.0,0.0,0.5,False,0.0,True,text," D2  1
"
1,5.0,0.0,0.0,False,0.0,False,text," (5.1)
"
14,4.42857142857,0.0,0.110119047619,False,0.0,False,text," where D1, D2  (st)1/4. The number of forward switchings is bounded below by
"
7,4.0,0.0,0.261054421769,False,0.0,True,text," E+(Q)2  OstE+(Q) = E+(Q)(1  o(1)),
"
10,4.7,0.0,0.0,False,0.0,False,text," and the number of reverse switchings is bounded above by
"
1,4.0,0.0,0.75,False,0.0,False,text," 2stS
"
4,3.25,0.0,0.607142857143,False,0.0,False,text," (st)1/2 = 2st S.
"
14,5.14285714286,0.0,0.0,False,0.0,True,text," Hence the number of reverse switchings divided by the number of forward switchings is
"
3,4.66666666667,0.0,0.0,False,0.0,False,text," bounded above by
"
3,4.0,0.0,0.208333333333,False,0.0,False,text," 2(1 + o(1))stS
"
1,6.0,0.0,0.333333333333,False,0.0,True,text," E+(Q)2
"
3,2.0,0.0,0.0833333333333,False,0.0,False,text," 1 + o(1)
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
2,0.5,0.0,0.0,False,0.0,False,text,"  2
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
1,1.0,0.0,1.0,False,0.0,False,text," ,
"
1,2.0,0.0,0.0,False,0.0,False,text," 23
"
13,5.53846153846,0.0,0.025641025641,False,0.0,False,text," using the assumed lower bound on E+(Q). After repeatedly applying this switching, we
"
6,4.16666666667,0.0,0.166666666667,False,0.0,False,text," reach a matrix Q which satises
"
3,6.0,0.0,0.338461538462,False,0.0,True,text," E+(Q)  2(st)1/4S1/2.
"
1,5.0,0.0,0.0,False,0.0,False,text," (5.2)
"
17,3.70588235294,0.0,0.132352941176,False,0.0,True,text," The next switching is applied to matrices Q  M+ for which (5.2) holds but E(Q) 
"
16,4.3125,0.0,0.0375,False,0.0,False,text," 2(stS)1/2. The switching that we used is the same as that shown in (5.1) except that
"
18,3.77777777778,0.0,0.307407407407,False,0.0,False,text," now D1, D2  {5, . . . ,(st)1/4}. The number of forward switchings is bounded below by
"
7,3.71428571429,0.0,0.357823129252,False,0.0,True,text," E(Q)2  OstE(Q) = E(Q)2(1  o(1)),
"
10,4.7,0.0,0.0,False,0.0,False,text," and the number of reverse switchings is bounded above by
"
1,5.0,0.0,0.8,False,0.0,False,text," 2stS.
"
14,5.14285714286,0.0,0.0,False,0.0,True,text," Hence the number of reverse switchings divided by the number of forward switchings is
"
3,4.66666666667,0.0,0.0,False,0.0,False,text," bounded above by
"
3,4.0,0.0,0.166666666667,False,0.0,False,text," 2(1 + o(1))stS
"
1,5.0,0.0,0.6,False,0.0,True,text," E(Q)2
"
3,2.0,0.0,0.0833333333333,False,0.0,False,text," 1 + o(1)
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
2,0.5,0.0,0.0,False,0.0,False,text,"  2
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
15,4.26666666667,0.0,0.0666666666667,False,0.0,True,text," We apply this switching until we reach a matrix Q which satises both (5.2) and
"
13,4.53846153846,0.0,0.0,False,0.0,True,text," To analyse these two switchings using Theorem 2.1, we can dene the sets
"
3,4.66666666667,0.0,0.483333333333,False,0.0,True,text," E(Q)  2(stS)1/2.
"
1,5.0,0.0,0.0,False,0.0,False,text," (5.3)
"
9,1.55555555556,0.0,0.666666666667,False,0.0,True,text," C(i) = {Q  M+  M | XD2
"
3,3.33333333333,0.0,0.555555555556,False,0.0,True,text," DnD(Q) = i}.
"
18,3.72222222222,0.0,0.194444444444,False,0.0,True,text," If Q  C(i) and R can be obtained from Q using one of the switchings described above,
"
19,3.36842105263,0.0,0.0877192982456,False,0.0,False,text," then R  C(i  2). This leads to an acyclic directed graph in each case, and we have
"
14,4.5,0.0,0.0654761904762,False,0.0,False,text," shown above that all the ratios b(vi)/a(vi1) in Theorem 2.1 are at most 2/3.
"
16,4.125,0.0,0.1125,False,0.0,True,text," Next we need to reduce each of n2(Q), n3(Q), n4(Q) to below S5/6. We achieve this
"
14,5.57142857143,0.0,0.0,False,0.0,False,text," using a succession of three types of switchings, illustrated by the following operations on
"
5,7.0,0.0,0.0,False,0.0,False,text," submatrices: for example, the switching
"
4,1.0,0.0,0.0,False,0.0,False,text," 4 0 0 0
"
4,1.0,0.0,0.0,False,0.0,False,text," 0 4 0 0
"
4,1.0,0.0,0.0,False,0.0,False,text," 0 0 4 0
"
4,1.0,0.0,0.0,False,0.0,False,text," 0 0 0 4
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,1.0,0.0,2.0,False,0.0,False,text," 7
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,0.0,0.0,0.0,False,0.0,False,heading," 
"
4,1.0,0.0,0.0,False,0.0,False,body," 1 1 1 1
"
4,1.0,0.0,0.0,False,0.0,False,after_body," 1 1 1 1
"
4,1.0,0.0,0.0,False,0.0,False,text," 1 1 1 1
"
4,1.0,0.0,0.0,False,0.0,False,text," 1 1 1 1
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
18,4.0,0.0,0.105555555556,False,0.0,False,text," will be used to reduce n4(Q) (with analogous operations for D = 2, 3). First we apply the
"
20,3.35,0.0,0.18,False,0.0,False,text," switching for D = 4 until n4(Q)  S5/6, then the switching for D = 3 until n3(Q)  S5/6,
"
16,4.4375,0.0,0.1125,False,0.0,False,text," nally applying the switching for D = 2 until n2(Q)  S5/6. As a representative example,
"
1,2.0,0.0,0.0,False,0.0,False,text," 24
"
16,4.3125,0.0,0.0625,False,0.0,False,text," take the switching for D = 4. By counting similarly to Lemma 2.2, this switching can
"
19,3.57894736842,0.0,0.0927318295739,False,0.0,False,text," be applied to Q in at least (n4(Q)  O(st))4 ways, and the inverse can be applied in at
"
16,4.125,0.0,0.18125,False,0.0,False,text," most Ss3t3 ways. For n4(Q)  S5/6, the condition s3t3 = o(S2) implies that Ss3t3 =
"
15,4.66666666667,0.0,0.129206349206,False,0.0,False,text," o(n4(Q)  O(st))4, so the ratios denoted by b(vi)/a(vi1) in Theorem 2.1 are all o(1).
"
16,4.4375,0.0,0.0,False,0.0,True,text," Since none of the switchings can undo the work of a previous switching, the end result
"
12,4.08333333333,0.0,0.0694444444444,False,0.0,False,text," (Note that in the resulting matrix R, at least one of E+(R),
"
6,2.16666666667,0.0,0.666666666667,False,0.0,False,text," is a matrix M \ M.
"
15,4.73333333333,0.0,0.115555555556,False,0.0,True,text," E(R), n2(R), n3(R) or n4(R) will be just under the threshold value. This implies that
"
14,2.42857142857,0.0,0.761904761905,False,0.0,True,text," R 6 M.) This establishes the bound M +M   M M .
"
10,2.2,0.0,0.6,False,0.0,True,text," For any matrix Q  M \ M we have
"
1,9.0,0.0,0.888888888889,False,0.0,True,text," XD(st)1/4
"
7,4.57142857143,0.0,0.387585034014,False,0.0,True,text," DnD(Q)  min{s, t}E+(Q)  3(st)3/4 S1/2,
"
13,5.0,0.0,0.144230769231,False,0.0,False,text," since using (5.2) and since min{s, t}  (st)1/2. Similarly, (5.3) implies that
"
3,4.0,0.0,0.0,False,0.0,False,text," which leads to
"
1,7.0,0.0,0.714285714286,False,0.0,False,text," (st)1/4
"
1,4.0,0.0,0.5,False,0.0,True,text," XD=5
"
1,3.0,0.0,1.0,False,0.0,True,text," XD2
"
5,6.0,0.0,0.371095571096,False,0.0,True,text," DnD(Q)  (st)1/4E(Q)  3(st)3/4S1/2,
"
7,4.28571428571,0.0,0.297619047619,False,0.0,True,text," DnD(Q)  6(st)3/4S1/2 + 3S5/6 = o(S).
"
19,2.73684210526,0.0,0.357894736842,False,0.0,True,text," Hence when Q  M \ M, we know that n1(Q) = S  o(S). We can now continue
"
19,3.42105263158,0.0,0.0833333333333,False,0.0,False,text," precisely as in Lemmas 2.3, 2.5, using D-switchings restricted to q1 =    = qD = 1.
"
14,5.28571428571,0.0,0.00595238095238,False,0.0,True,text," This restriction ensures that D-switchings only create entries with value equal to 0 or
"
15,4.73333333333,0.0,0.0,False,0.0,False,text," 1. The various switching counts can be taken as essentially the same as before, since
"
18,3.66666666667,0.0,0.222222222222,False,0.0,False,text," all but a vanishing fraction of the non-zero entries are 1. We conclude that M M  =
"
14,4.07142857143,0.0,0.298701298701,False,0.0,True,text," O(s3t3/S2)M  which, as noted above, implies that M = 1 + O(s3t3/S2)M .
"
16,4.3125,0.0,0.125,False,0.0,True,text," Having now reduced the task to evaluation of M , we can complete the proof following
"
16,4.5625,0.0,0.0,True,0.0,True,text," Lemma 3.1 in the insubstantial case, and Section 4 in the substantial case. In Lemma 3.1
"
21,3.09523809524,0.0,0.142857142857,False,0.0,False,text," the only modication is to replace the expression p0 + 2p1 + 4p2 + 6p3 by p0 + 22 p1 +
"
5,2.0,0.0,0.366666666667,False,0.0,False,text," 42 p2 + 63 p3.
"
18,3.77777777778,0.0,0.157407407407,False,0.0,True,text," Now suppose that (S2, T2) is substantial. If 2 = 3 then the result is given by either
"
19,3.47368421053,0.0,0.105263157895,True,0.0,True,text," Theorem 1.2 or Theorem 1.3. If 2 = 0 and 3 = 1 then the result follows from applying
"
14,3.78571428571,0.0,0.0714285714286,True,0.0,True,text," Corollary 3.6 with d = 0, since arguing as in Lemma 3.2 shows that
"
6,2.5,0.0,0.277777777778,False,0.0,True,text," M(s, t,J ) = N(s, t)
"
1,2.0,0.0,0.5,False,0.0,True,text," N3
"
1,4.0,0.0,0.5,False,0.0,True,text," Xh=0
"
1,7.0,0.0,0.571428571429,False,0.0,False,text," w(C0,h)
"
3,6.33333333333,0.0,0.366666666667,False,0.0,False,text," w(C0,0)1 + O(s3t3/S2)
"
13,2.61538461538,0.0,0.153846153846,False,0.0,False,text," in this case. Finally, if 2 = 1 and 3 = 0 then
"
6,2.5,0.0,0.277777777778,False,0.0,True,text," M(s, t,J ) = N(s, t)
"
1,2.0,0.0,0.5,False,0.0,True,text," N2
"
1,4.0,0.0,0.5,False,0.0,True,text," Xd=0
"
1,7.0,0.0,0.571428571429,False,0.0,False,text," w(Cd,0)
"
3,6.33333333333,0.0,0.366666666667,False,0.0,False,text," w(C0,0)1 + O(s3t3/S2)
"
1,2.0,0.0,0.0,False,0.0,False,text," 25
"
19,3.15789473684,0.0,0.171929824561,False,0.0,False,text," so in place of (3.3) we simply have md = w(Cd,0)/w(C0,0) = nd(0) for 0  d  N2.
"
17,4.11764705882,0.0,0.0,False,0.0,True,text," The remainder of the proof is identical except that there is no need to apply (3.4) at
"
2,3.5,0.0,0.0,False,0.0,False,text," the end.
"
1,10.0,0.0,0.0,False,1.0,True,text," References
"
13,5.15384615385,0.0,0.0,False,0.0,False,text," [1] A. Barvinok, A. Samorodnitsky and A. Yong, Counting magic squares in quasi-
"
5,13.6,0.0,0.0,False,0.0,False,text," polynomial time, preprint (2007); http://www.arxiv.org/abs/math/0703227.
"
13,5.61538461538,0.0,0.0,False,0.0,False,text," [2] A. Bekessy, P. Bekessy and J. Komlos, Asymptotic enumeration of regular matrices,
"
7,5.28571428571,0.0,0.0,False,0.0,True,text," Studia Sci. Math. Hungar., 7 (1972) 343353.
"
13,5.38461538462,0.0,0.0,False,0.0,False,text," [3] E. A. Bender, The asymptotic number of nonnegative integer matrices with given
"
9,5.11111111111,0.0,0.0,False,0.0,False,text," row and column sums, Discrete Math., 10 (1974) 345353.
"
11,6.45454545455,0.0,0.0,False,0.0,False,text," [4] B. Bollobas, Random Graphs (2nd edn.), Cambridge University Press, Cambridge,
"
1,5.0,0.0,0.0,False,0.0,False,text," 2001.
"
14,4.85714285714,0.0,0.0,False,0.0,False,text," [5] E. R. Caneld and B. D. McKay, Asymptotic enumeration of integer matrices with
"
10,5.6,0.0,0.0,False,0.0,False,text," large equal row and column sums, Combinatorica, 30 (2010) 655680.
"
15,4.53333333333,0.0,0.0,False,0.0,False,text," [6] P. Diaconis and B. Efron, Testing for independence in a two-way table: new in-
"
11,6.81818181818,0.0,0.0,False,0.0,False,text," terpretations of the chi-square statistic (with discussion), Ann. Statist., 13 (1995)
"
1,7.0,0.0,0.0,False,0.0,False,text," 845913.
"
13,5.38461538462,0.0,0.0,False,0.0,False,text," [7] P. Diaconis and A. Gangolli, Rectangular arrays with xed margins, in: Discrete
"
10,6.7,0.0,0.0,False,0.0,True,text," Probability and Algorithms, IMA Volumes on Mathematics and its Applications,
"
8,4.875,0.0,0.0,False,0.0,False,text," vol. 72, Springer, New York, (1995), pp. 1541.
"
13,5.15384615385,0.0,0.0,False,0.0,False,text," [8] M. Dyer, R. Kannan and J. Mount, Sampling contingency tables, Random Struc-
"
5,6.4,0.0,0.0,False,0.0,False,text," tures Algorithms, 10 (1997), 487506.
"
15,4.66666666667,0.0,0.0,False,0.0,False,text," [9] C. J. Everett, Jr., and P. R. Stein, The asymptotic number of integer stochastic
"
6,5.83333333333,0.0,0.0,False,0.0,False,text," matrices, Discrete Math., 1 (1971) 3372.
"
14,5.07142857143,0.0,0.0,False,0.0,False,text," [10] V. Fack and B. D. McKay, A generalized switching method for combinatorial esti-
"
7,6.14285714286,0.0,0.0,False,0.0,False,text," mation, Australas. J. Combin., 39 (2007), 141154.
"
13,5.61538461538,0.0,0.0,False,0.0,False,text," [11] C. Greenhill and B. D. McKay, Asymptotic enumeration of sparse nonnegative inte-
"
12,5.41666666667,0.0,0.0,False,0.0,False,text," ger matrices with specied row and column sums, Advances in Applied Mathemat-
"
4,5.0,0.0,0.0,False,0.0,False,text," ics, 41 (2008), 459481.
"
1,2.0,0.0,0.0,False,0.0,False,text," 26
"
14,4.78571428571,0.0,0.0,False,0.0,False,text," [12] C. Greenhill, B. D. McKay and X. Wang, Asymptotic enumeration of sparse 0-1
"
14,4.85714285714,0.0,0.0,False,0.0,False,text," matrices with irregular row and column sums, J. Combin. Theory Ser. A, 113 (2006)
"
1,7.0,0.0,0.0,False,0.0,False,text," 291324.
"
14,5.14285714286,0.0,0.0,False,0.0,False,text," [13] B. D. McKay, Asymptotics for 0-1 matrices with prescribed line sums, in: Enumer-
"
9,5.77777777778,0.0,0.0,False,0.0,False,text," ation and Design, Academic Press, Toronto, 1984, pp. 225238.
"
11,6.54545454545,0.0,0.0,False,0.0,False,text," [14] B. Morris, Improved bounds for sampling contingency tables, Random Structures
"
4,6.5,0.0,0.0,False,0.0,True,text," Algorithms, 21 (2002) 135146.
"
13,5.46153846154,0.0,0.0,False,0.0,False,text," [15] R. C. Read, Some enumeration problems in graph theory, Doctoral Thesis, London
"
2,9.0,0.0,0.0,False,0.0,True,text," University, (1958).
"
11,6.63636363636,0.0,0.0,False,0.0,False,text," [16] R. P. Stanley, Combinatorics and Commutative Algebra, Progress in Mathematics,
"
5,6.0,0.0,0.0,False,0.0,False,text," vol. 41, Birkhauser, Boston, 1983.
"
1,2.0,0.0,0.0,False,0.0,False,text," 27
"
