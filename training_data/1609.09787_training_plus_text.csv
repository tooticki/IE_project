words_num,awerage_word_length,italicness,formuleness,heading_first_word,boldness_first_word,is_capital_first_letter,type,text
6,7.5,0.0,0.0,False,1.0,True,text," UNIVERSALLY AND EXISTENTIALLY DEFINABLE SUBSETS OF
"
2,6.0,0.0,0.0,False,1.0,True,text," GLOBAL FIELDS
"
6,5.83333333333,0.0,0.0,False,0.0,True,text," KIRSTEN EISENTR AGER AND TRAVIS MORRISON
"
16,4.5,0.0,0.06875,False,0.0,True,text," Abstract. We show that rings of S-integers of a global function eld K of odd character-
"
14,5.28571428571,0.0,0.0357142857143,False,0.0,False,text," istic are rst-order universally denable in K. This extends work of Koenigsmann and Park
"
18,3.83333333333,0.0,0.111111111111,False,0.0,False,text," who showed the same for Z in Q and the ring of integers in a number eld, respectively.
"
17,4.11764705882,0.0,0.0,False,0.0,True,text," We also give another proof of a theorem of Poonen and show that the set of non-squares
"
18,4.22222222222,0.0,0.0277777777778,False,0.0,False,text," in a global eld of characteristic 6= 2 is diophantine. Finally, we show that the set of pairs
"
24,2.58333333333,0.0,0.246527777778,False,0.0,False,text," (x, y)  K   K  such that x is not a norm in K(y) is diophantine over K for any global
"
6,4.0,0.0,0.25,False,0.0,False,text," eld K of characteristic 6= 2.
"
1,1.0,0.0,0.0,False,0.0,False,text," 8
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
1,1.0,0.0,0.0,False,0.0,False,text," r
"
1,1.0,0.0,0.0,False,0.0,False,text," p
"
1,1.0,0.0,0.0,False,0.0,True,text," A
"
1,1.0,0.0,0.0,False,0.0,False,text," 7
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
1,1.0,0.0,0.0,False,0.0,False,text," ]
"
1,1.0,0.0,0.0,False,0.0,True,text," T
"
1,1.0,0.0,0.0,False,0.0,True,text," N
"
1,1.0,0.0,0.0,False,0.0,False,text," h
"
1,1.0,0.0,0.0,False,0.0,False,text," t
"
1,1.0,0.0,0.0,False,0.0,False,text," a
"
1,1.0,0.0,0.0,False,0.0,False,text," m
"
1,1.0,0.0,0.0,False,0.0,False,text," .
"
1,1.0,0.0,0.0,False,0.0,False,text," [
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
1,1.0,0.0,0.0,False,0.0,False,text," v
"
1,1.0,0.0,0.0,False,0.0,False,text," 7
"
1,1.0,0.0,0.0,False,0.0,False,text," 8
"
1,1.0,0.0,0.0,False,0.0,False,text," 7
"
1,1.0,0.0,0.0,False,0.0,False,text," 9
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
1,1.0,0.0,0.0,False,0.0,False,text," .
"
1,1.0,0.0,0.0,False,0.0,False,text," 9
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
1,1.0,0.0,0.0,False,0.0,False,text," 6
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," :
"
1,1.0,0.0,0.0,False,0.0,False,text," v
"
1,1.0,0.0,0.0,False,0.0,False,text," i
"
1,1.0,0.0,0.0,False,0.0,True,text," X
"
1,1.0,0.0,0.0,False,0.0,False,text," r
"
1,1.0,0.0,0.0,False,0.0,False,text," a
"
2,7.0,0.0,0.0,False,0.0,False,text," 1. Introduction
"
13,5.53846153846,0.0,0.0,False,0.0,True,text," Hilberts Tenth Problem asks whether there exists an algorithm that decides, given an
"
14,5.64285714286,0.0,0.0,False,0.0,False,text," arbitrary polynomial equation with integer coecients, whether it has a solution in the inte-
"
14,5.35714285714,0.0,0.0,False,0.0,False,text," gers. Matiyasevich answered this in the negative in [Mat70] using work by Davis, Putnam,
"
14,5.07142857143,0.0,0.0,False,0.0,False,text," and J. Robinson [DPR61]. We say that Hilberts Tenth Problem is undecidable. The same
"
14,5.42857142857,0.0,0.0,False,0.0,False,text," question can be asked for polynomial equations with coecients and solutions in other com-
"
15,4.6,0.0,0.0666666666667,False,0.0,False,text," mutative rings R. We refer to this as Hilberts Tenth Problem over R. Hilberts Tenth
"
16,4.625,0.0,0.03125,False,0.0,True,text," Problem over Q, and over number elds in general, is still open. The function eld analogue
"
14,5.07142857143,0.0,0.0,False,0.0,False,text," is much better understood, and Hilberts Tenth Problem is known to be undecidable for
"
7,7.42857142857,0.0,0.0,False,0.0,False,text," global function elds ([Phe91], [Vid94], [Shl96], [Eis03]).
"
15,4.6,0.0,0.0666666666667,False,0.0,True,text," One approach to proving that Hilberts Tenth Problem for Q is undecidable is to show
"
6,4.0,0.166666666667,0.25,False,0.0,False,text," that Z is diophantine over Q:
"
20,3.35,0.0,0.2,False,1.125,True,heading," Denition 1.1. Let R be a ring. We say that A  Rm is diophantine over R if there exists
"
29,2.1724137931,0.0,0.754022988506,False,0.0,False,body," a polynomial g(x1, . . . , xm, y1, . . . , yn)  R[x1, . . . , xm, y1, . . . , yn] such that
"
32,1.59375,0.0,0.76875,False,0.0,False,body," (a1, . . . , am)  A  r1, . . . , rn  R s.t. g(a1, . . . , am, r1, . . . , rn) = 0.
"
17,4.35294117647,0.0,0.0882352941176,False,0.0,True,after_body," If one had a diophantine, i.e. a positive existential denition of Z in Q, then a reduction
"
12,6.25,0.0,0.0416666666667,False,0.0,False,text," argument, together with Matiyasevichs theorem for Hilberts Tenth Problem over Z, would
"
16,4.4375,0.0,0.125,False,0.0,False,text," imply that Hilberts Tenth Problem for Q is undecidable. But it is still open whether Z
"
16,4.6875,0.0,0.09375,False,0.0,False,text," is positive existentially denable in Q. In fact, if Mazurs conjecture holds, then Z is not
"
5,6.2,0.0,0.2,False,0.0,False,text," existentially denable in Q [Maz92].
"
15,5.2,0.0,0.0,False,0.0,True,text," It is, however, possible to dene the integers inside the rationals with a rst-order formula.
"
19,3.31578947368,0.0,0.0789473684211,False,0.0,True,text," This is due to J. Robinson [Rob49] who gave a  denition of Z in Q. Her result was
"
15,4.33333333333,0.0,0.1,False,0.0,False,text," improved by Poonen [Poo09a] who gave a  denition of Z in Q. Koenigsmann [Koe16]
"
16,4.625,0.0,0.0625,False,0.0,False,text," further improved on Poonens result and gave a denition of the integers inside Q that uses
"
3,7.66666666667,0.0,0.0,False,0.0,False,text," only universal quantiers.
"
17,4.11764705882,0.0,0.0882352941176,False,0.0,True,text," Park generalized this and showed that for any number eld K, the ring of integers OK is
"
5,5.8,0.0,0.2,False,0.0,False,text," universally denable in K [Par13].
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
15,4.93333333333,0.0,0.0666666666667,False,0.0,True,text," Similar denability questions can be asked for subrings of global function elds. Let q be
"
16,4.5625,0.0,0.075,False,0.0,False,text," a power of a prime. While Hilberts Tenth Problem for both Fq[t] and Fq(t) is undecidable
"
14,5.71428571429,0.0,0.0785714285714,False,0.0,False,text," ([Den79], [Phe91], [Vid94]), it is not known whether Fq[t] is diophantine over Fq(t). Showing
"
19,4.10526315789,0.0,0.0631578947368,False,0.0,False,text," this still seems out of reach, but it is possible to give a universal denition of Fq[t] in Fq(t)
"
17,4.41176470588,0.0,0.0294117647059,False,0.0,False,text," which we do in this paper for odd q. More generally, we prove the natural generalization of
"
12,4.75,0.0,0.0416666666667,False,0.0,True,text," Parks result for dening rings of integers to global function elds K.
"
18,3.66666666667,0.0,0.0,False,0.0,True,text," This is the rst of three main theorems in this paper, and we prove it in Section 3:
"
18,3.83333333333,0.807407407407,0.111111111111,True,1.0,True,heading," Theorem 1.2. Let K be a global function eld of odd characteristic and let S be a nite,
"
15,4.6,0.883597883598,0.133333333333,False,0.0,False,body," nonempty set of primes of K. Then OS is rst-order universally denable in K. Equiva-
"
8,3.75,0.5625,0.4375,False,0.0,False,body," lently, K \ OS is diophantine over K.
"
16,2.9375,0.0,0.1875,False,0.0,True,after_body," Here, for a nite set S of primes of K we denote by OS the ring
"
14,1.78571428571,0.0,0.457142857143,False,0.0,True,text," OS := {x  K : vp(x)  0  primes p 6 S}.
"
14,5.0,0.0,0.0,False,0.0,True,text," Our theorem generalizes a result by Rumely [Rum80] who gave a rst-order denition of
"
17,4.23529411765,0.0,0.0294117647059,False,0.0,False,text," a polynomial ring inside a global function eld K. It also improves one of the results in
"
17,4.17647058824,0.0,0.00588235294118,False,0.0,False,text," [Shl15], where it was shown how to dene the S-integers in a global function eld using a
"
8,6.125,0.0,0.0,False,0.0,False,text," rst-order formula that involves one change in quantiers.
"
16,4.625,0.0,0.0,False,0.0,True,text," One of the main ideas in proving Theorem 1.2 is to use certain diophantine rings, parame-
"
19,4.0,0.0,0.0526315789474,False,0.0,False,text," trized by K, to encode integrality at nite sets of primes; this is based on ideas of Poonen in
"
12,6.33333333333,0.0,0.0,False,0.0,False,text," [Poo09a] and Koenigsmann in [Koe16]. Park replaces the congruence classes that Koenigs-
"
19,3.31578947368,0.0,0.157894736842,False,0.0,False,text," mann used for Z in Q with ray classes of a xed modulus of K for a xed biquadratic
"
3,4.33333333333,0.0,0.166666666667,False,0.0,False,text," extension of K.
"
16,4.375,0.0,0.0,False,0.0,True,text," Some parts of Parks arguments do not extend to the function eld setting and require a
"
16,4.75,0.0,0.0625,False,0.0,False,text," dierent approach; in [Par13], a biquadratic extension of K is chosen so that it is linearly
"
18,4.27777777778,0.0,0.0277777777778,False,0.0,False,text," disjoint from the Hilbert class eld of K. Since the Hilbert class eld of a global function eld
"
17,4.47058823529,0.0,0.0,False,0.0,False,text," is an innite extension, we cannot use it in our arguments, but there is another natural nite
"
17,4.17647058824,0.0,0.0588235294118,False,0.0,False,text," extension of the global function eld K that we can use instead. We use a nite extension
"
17,3.94117647059,0.0,0.147058823529,False,0.0,False,text," of K whose Galois group is the ideal class group of the Dedekind domain OS for some
"
15,4.93333333333,0.0,0.0666666666667,False,0.0,False,text," carefully chosen set of primes S. Another crucial ingredient in the proof of Theorem 1.2
"
18,3.83333333333,0.0,0.111111111111,False,0.0,False,text," is showing that any class in the ray class group of a Dedekind domain A contained in K
"
6,5.0,0.0,0.0833333333333,False,0.0,False,text," contains innitely many primes of A.
"
16,4.3125,0.0,0.09375,False,0.0,True,text," We also show that other arithmetic subsets of a global eld K are diophantine over K,
"
15,3.86666666667,0.0,0.311111111111,False,0.0,False,text," extending the results in [Koe16]. Given y  K \ K2, consider the norm map
"
5,1.6,0.0,0.55,False,0.0,True,text," Ny : K(y)  K
"
7,1.57142857143,0.0,0.821428571429,False,0.0,False,text," a + by 7 a2  yb2.
"
9,4.44444444444,0.0,0.0,False,0.0,True,text," In Section 4.2 we show the following new result:
"
13,3.53846153846,0.602564102564,0.126373626374,True,1.0,True,heading," Theorem 1.3. Let K be a global eld with char(K) 6= 2. Then
"
8,2.5,0.0,0.90625,False,0.0,False,body," {(x, y)  K  K|x 6 Ny(K(y))}
"
4,4.75,0.875,0.125,False,0.0,False,body," is diophantine over K.
"
13,3.92307692308,0.0,0.153846153846,False,0.0,True,after_body," This generalizes a result of [Koe16] from K = Q to global elds.
"
10,4.1,0.0,0.0,False,0.0,True,text," We also give a new proof of the following theorem:
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
18,3.5,0.546296296296,0.313492063492,True,1.0,True,heading," Theorem 1.4. Let K be a global eld with char(K) 6= 2. Then K \ K2 is diophantine
"
2,3.0,0.75,0.25,False,0.0,False,after_body," over K.
"
13,5.69230769231,0.0,0.0,False,0.0,True,text," This was established by Poonen in [Poo09b], using results on the Brauer-Manin obstruc-
"
15,4.73333333333,0.0,0.00952380952381,False,0.0,False,text," tion. For number elds, this was extended to non-nth powers in [CTVG15] and further in
"
14,4.28571428571,0.0,0.107142857143,False,0.0,True,text," In [Koe16], Koenigsmann gave a more elementary proof for K = Q. Using re-
"
1,8.0,0.0,0.0,False,0.0,False,text," [Dit16].
"
15,5.2,0.0,0.0,False,0.0,False,text," sults in [Par13] and their extensions in this paper, together with Artin Reciprocity and the
"
11,5.45454545455,0.0,0.0,False,0.0,True,text," Chebotarev Density Theorem, we give a dierent proof of Poonens result.
"
10,5.3,0.0,0.01,False,0.0,False,text," 2. S-integers and class field theory of global function fields
"
7,3.57142857143,0.0,0.142857142857,False,0.0,True,text," Let K be a global function eld.
"
10,4.2,0.0,0.0,False,0.0,True,text," In this section we recall some facts about rings of
"
5,6.0,0.0,0.02,False,0.0,True,text," S-integers and their class groups.
"
16,4.3125,0.0,0.125,False,0.0,False,text," 2.1. Background and denitions. Let K be a global function eld, and let SK denote the
"
19,3.84210526316,0.0,0.0789473684211,False,0.0,False,text," set of all primes of K. By a prime of K we mean an equivalence class of nontrivial absolute
"
15,4.86666666667,0.0,0.0333333333333,False,0.0,False,text," values of K. In a global function eld, all such absolute values are non-archimedean and
"
23,2.86956521739,0.0,0.101449275362,False,0.0,False,text," we can represent a prime as a pair (p,Op) where Op is a local ring of K and p  Op is its
"
21,3.38095238095,0.0,0.047619047619,False,0.0,False,text," maximal ideal. We will often refer only to the ideal p as a prime of K. We denote by vp the
"
15,5.0,0.0,0.0333333333333,False,0.0,False,text," associated normalized discrete valuation on K. We now recall some facts about the ring of
"
22,2.95454545455,0.0,0.254545454545,False,0.0,True,text," S-integers OS in K where S  SK is a nite set of primes of K. The ring OS is a Dedekind
"
16,4.5625,0.0,0.0625,False,0.0,False,text," domain and its prime ideals are in one-to-one correspondence with the primes of K not in
"
6,4.83333333333,0.0,0.0833333333333,False,0.0,True,text," S; this correspondence is given by
"
5,1.2,0.0,0.6,False,0.0,False,text," p 7 p  OS.
"
18,3.88888888889,0.0,0.148148148148,False,0.0,True,text," See [Ros02, Theorem 14.5]. So given q  OS, we can factor qOS uniquely into a product of
"
17,4.52941176471,0.0,0.0980392156863,False,0.0,False,text," prime ideals of OS. The support of the divisor of q contains the primes in this factorization
"
5,3.4,0.0,0.1,False,0.0,False,text," and some primes of S.
"
21,2.95238095238,0.0,0.0952380952381,False,0.0,True,text," A modulus m of K is a formal product of primes of K, m =Q pm(p), such that m(p)  0
"
23,3.13043478261,0.0,0.0869565217391,False,0.0,False,text," for all p and m(p) = 0 for all but nitely many p. The group of fractional ideals I of K is the
"
17,4.23529411765,0.0,0.0588235294118,False,0.0,False,text," free abelian group generated by the primes of K. We dene Im to be the subgroup generated
"
18,3.38888888889,0.0,0.0555555555556,False,0.0,False,text," by the primes which do not appear in m. Given   K, it denes a fractional ideal
"
2,3.0,0.0,0.375,False,0.0,False,text," () :=Yp
"
1,5.0,0.0,0.6,False,0.0,False,text," vp().
"
1,1.0,0.0,0.0,False,0.0,False,text," p
"
1,4.0,0.0,0.0,False,0.0,True,text," Dene
"
16,2.3125,0.0,0.291666666667,False,0.0,True,text," Km,1 = {x  K : vp(x  1)  m(p) for all p dividing m}.
"
18,3.5,0.0,0.12037037037,False,0.0,True,text," We have a well-dened map i : Km,1  Im, sending  to the fractional ideal (). Dene
"
19,3.52631578947,0.0,0.0839598997494,False,0.0,True,text," Pm to be the subgroup i(Km,1) of Im. The ray class group modulo m, Cm, is dened to be
"
17,4.0,0.0,0.0294117647059,False,0.0,False,text," the quotient Im/Pm. This group is not nite, but the degree map (which we can dene by
"
10,5.9,0.0,0.0,False,0.0,False,text," viewing these formal products as divisors) induces an exact sequence
"
4,0.75,0.0,0.25,False,0.0,False,text," 0  C 0
"
7,0.857142857143,0.0,0.285714285714,False,0.0,False,text," m  Cm  Z  0.
"
4,3.25,0.0,0.25,False,0.0,True,text," The subgroup C 0
"
11,4.27272727273,0.0,0.0,False,0.0,False,text," m of degree-zero divisor classes can be shown to be nite.
"
19,3.21052631579,0.0,0.157894736842,False,0.0,True,text," Let L be a nite abelian extension of K. Suppose p  SK is unramied in L. Then we
"
16,4.4375,0.0,0.0911458333333,False,0.0,False,text," dene (p, L/K)  Gal(L/K) to be its associated Frobenius automorphism. If m is a modulus
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
16,3.9375,0.0,0.09375,False,0.0,False,text," of K divisible by those primes which ramify in L, we have the global Artin map
"
5,2.8,0.0,0.441666666667,False,0.0,True,text," L/K : Im  Gal(L/K)
"
1,2.0,0.0,1.0,False,0.0,False,text," ei
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
2,1.0,0.0,0.5,False,0.0,True,text," Y p
"
2,6.5,0.0,0.845238095238,False,0.0,False,text," 7Y(pi, L/K)ei.
"
14,5.28571428571,0.857142857143,0.0,True,1.0,True,heading," Theorem 2.1. (Artin Reciprocity) The Artin map is surjective and there exists a modulus
"
17,4.29411764706,0.768907563025,0.151260504202,False,0.0,False,body," m containing all the primes of K which ramify in L such that the kernel is PmNL/K(IL(m));
"
18,3.83333333333,0.833333333333,0.166666666667,False,0.0,False,body," here NL/K is the norm map on fractional ideals and m is the modulus of L consisting of
"
11,3.63636363636,0.772727272727,0.181818181818,False,0.0,False,body," primes of L lying above those of K contained in m.
"
17,4.05882352941,0.0588235294118,0.0588235294118,False,1.0,True,heading," Remark 2.2. We call any m as in Theorem 2.1 an admissible modulus for the extension L
"
2,3.0,0.0,0.25,False,0.0,False,after_body," over K.
"
16,4.625,0.0,0.0,False,0.0,True,text," We will need the existence theorem of class eld theory for function elds, so we introduce
"
21,3.33333333333,0.0,0.142857142857,False,0.0,False,text," the idele group. We dene the idele group of K to be the restricted product of Kp for p  SK
"
18,4.05555555556,0.0,0.0833333333333,False,0.0,False,text," with respect to the compact groups Rp , where Rp is the ring of integers in the completion
"
19,3.42105263158,0.0,0.157894736842,False,0.0,True,text," Kp of K at p. We denote the idele group of K by I. Denote the diagonal embedding of
"
20,3.1,0.0,0.35,False,0.0,True,text," K in I again by K and the idele class group by CK := I/K, which we endow with the
"
2,8.5,0.0,0.0,False,0.0,False,text," quotient topology.
"
14,4.14285714286,0.0,0.142857142857,False,0.0,True,text," An idele of K determines a fractional ideal of K via the surjective map
"
5,1.0,0.0,0.4,False,0.0,False,text," id : I  I
"
3,3.0,0.0,1.08333333333,False,0.0,False,text," (xp) 7 YpSK
"
1,7.0,0.0,0.428571428571,False,0.0,False,text," vp(xp).
"
1,1.0,0.0,0.0,False,0.0,False,text," p
"
19,3.78947368421,0.0,0.157894736842,False,0.0,True,text," Again let L/K be a nite abelian extension and let Sram be the set of primes of K ramifying
"
3,2.66666666667,0.0,0.166666666667,False,0.0,False,text," in L. Dene
"
14,2.21428571429,0.0,0.278571428571,False,0.0,True,text," ISram := {(xp)  I : xp = 1 for all p  Sram}.
"
17,3.94117647059,0.0,0.218137254902,False,0.0,True,text," There is a unique function L/K : I  Gal(L/K) which is continuous, trivial on K, and
"
15,4.86666666667,0.0,0.223789173789,False,0.0,False,text," satises L/K((xp)) = L/K(id((xp))) for all (xp)  ISram; see [Tat67]. Hence L/K induces a
"
18,3.88888888889,0.0,0.0925925925926,False,0.0,False,text," map on the idele class group CK, which we again denote by L/K. This is the idelic Artin
"
17,4.17647058824,0.0,0.172549019608,False,0.0,False,text," map. The idelic Artin reciprocity law states that the kernel of L/K is N(CL) where N is
"
5,3.8,0.0,0.0,False,0.0,False,text," the norm map on ideles.
"
17,4.05882352941,0.0,0.0,False,0.0,True,text," Now we state the existence theorem of class eld theory; see Theorem 1 of Chapter 8 in
"
1,7.0,0.0,0.0,False,0.0,False,text," [AT68].
"
15,4.66666666667,0.616666666667,0.133333333333,True,1.0,True,heading," Theorem 2.3 (Existence Theorem). Let K be any global eld. Fix an algebraic closure K
"
18,3.83333333333,0.851851851852,0.12037037037,False,0.0,False,body," of K. Given a nite index open subgroup H  CK, there is a unique nite abelian extension
"
10,2.3,0.416666666667,0.45,False,0.0,True,body," L of K in K such that H = N(CL).
"
19,3.10526315789,0.0,0.425837320574,False,0.0,False,after_body," 2.2. Ray class groups of rings of S-integers. Let S := {1, . . . ,n}  SK, and
"
19,3.47368421053,0.0,0.273684210526,False,0.0,True,text," A := OS. The ideal class group Cl(A) of the Dedekind domain A is nite. Denote by K A
"
15,4.86666666667,0.0,0.2,False,0.0,False,text," the maximal abelian unramied extension of K in which each prime of S splits completely.
"
19,3.57894736842,0.0,0.228947368421,False,0.0,True,text," Then Cl(A) = Gal(K A/K) via the Artin map (see [Ros87]), and we will use K A and Cl(A)
"
21,3.09523809524,0.0,0.119047619048,False,0.0,False,text," in Section 3.2. Set  := 1   n. For the rest of this section, let m be another modulus
"
20,3.05,0.0,0.132142857143,False,0.0,False,text," of K coprime to ; we can then view m as an ideal of A. Below we dene Clm(A), the
"
16,4.5625,0.0,0.0625,False,0.0,False,text," ray class group of A for the modulus m. One crucial ingredient to the universal denition
"
16,4.625,0.0,0.0166666666667,False,0.0,False,text," of S-integers is Lemma 3.15, where we need that a given class of Clm(A) contains innitely
"
18,4.0,0.0,0.0277777777778,False,0.0,False,text," many primes of A. This is Theorem 2.9 at the end of this section, whose proof uses idelic
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
16,4.6875,0.0,0.0,False,0.0,False,text," class eld theory. The remainder of this section is devoted to proving Theorem 2.9. One can
"
11,4.81818181818,0.0,0.0,False,0.0,False,text," think of this as a function eld analogue of Dirichlets theorem.
"
17,4.11764705882,0.0,0.0823529411765,False,1.125,True,heading," Denition 2.4. Let Im(A) be the group of fractional ideals of A which are coprime to m.
"
18,3.83333333333,0.0,0.124074074074,False,0.0,True,body," We have a natural injection j : Km,1  Im(A) whose image we denote by Pm(A). This image
"
13,4.15384615385,0.0,0.205128205128,False,0.0,False,body," consists of principal fractional ideals A with vp(  1)  m(p). Dene
"
3,6.66666666667,0.0,0.222222222222,False,0.0,True,body," Clm(A) := Im(A)/Pm(A).
"
5,4.8,0.0,0.0,False,0.0,True,after_body," We need the following lemma:
"
12,5.83333333333,0.666666666667,0.0,True,1.0,True,heading," Lemma 2.5 (Kernel-Cokernel sequence). Given a pair of maps between abelian groups
"
5,4.4,1.0,0.0,False,0.0,False,body," there is an exact sequence
"
1,1.0,0.0,1.0,False,0.0,True,after_body," A
"
2,1.0,0.0,2.0,False,0.0,False,text," f B
"
2,1.0,0.0,2.0,False,0.0,False,heading," g C
"
25,1.4,0.0,0.34,False,0.0,False,body," 0  ker f  ker g  f  ker g  coker f  coker g  f  coker g  0.
"
7,5.28571428571,0.142857142857,0.0,False,0.0,True,after_body," Proof. This is Proposition 0.24 in [Mil06].
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,4.0,0.0,0.0,False,0.0,True,text," Dene
"
11,2.09090909091,0.0,0.30303030303,False,0.0,True,text," Um,p := {x  Kp : vp(x  1)  m(p)},
"
2,3.5,0.0,0.45,False,0.0,True,text," Im :=Ypm
"
2,3.5,0.0,0.55,False,0.0,True,text," Wm :=Yp|
"
2,3.0,0.0,0.875,False,0.0,True,text," Kp Yp|m
"
3,1.66666666667,0.0,0.888888888889,False,0.0,True,text," Kp  Ypm
"
3,2.0,0.0,0.5,False,0.0,True,text," Um,p  I,
"
2,3.0,0.0,0.875,False,0.0,True,text," Op Yp|m
"
1,5.0,0.0,0.6,False,0.0,True,text," Um,p.
"
12,3.5,0.666666666667,0.166666666667,True,1.0,True,heading," Proposition 2.6. Let m be a modulus of K coprime to .
"
15,4.2,0.542857142857,0.166493506494,False,0.0,False,body," (1) The ideal map id : Im  Im(A) induces an isomorphism Im/(Km,1Wm) = Clm(A).
"
13,4.0,0.564102564103,0.287545787546,False,0.0,False,body," (2) The inclusion map Im  I induces an isomorphism Im/Km,1 = CK.
"
5,3.8,0.2,0.0,False,0.0,True,after_body," Proof. (1) We have maps
"
5,2.4,0.0,0.3,False,0.0,True,text," Km,1  Im  Im(A),
"
16,4.375,0.0,0.0,False,0.0,False,text," where the rst map is the diagonal embedding and the second is the ideal map. Applying
"
8,6.125,0.0,0.0,False,0.0,False,text," the kernel-cokernel sequence gives us the exact sequence
"
7,2.42857142857,0.0,0.248299319728,False,0.0,True,text," Wm  Im/Km,1  Clm(A)  0.
"
14,5.28571428571,0.0,0.0970238095238,False,0.0,True,text," This follows because by denition, Clm(A) = Im(A)/Pm(A), Pm(A) = j(Km,1), and the kernel
"
17,4.23529411765,0.0,0.0924369747899,False,0.0,False,text," of the ideal map restricted to Im is Wm. Thus Clm(A) is isomorphic to Im/Km,1 modulo the
"
17,4.05882352941,0.0,0.0196078431373,False,0.0,False,text," image of Wm. Since the rst map in the above sequence is reduction modulo the image of
"
6,3.0,0.0,0.138888888889,False,0.0,True,text," Km,1 in Wm, we get that
"
5,8.2,0.0,0.648985507246,False,0.0,True,text," Clm(A) = (Im/Km,1)/(WmKm,1/Km,1) = Im/Km,1Wm.
"
16,3.875,0.0,0.171130952381,False,0.0,False,text," (2) The injection Im  I gives us an injection Im/Km,1  CK. Denote the maximal
"
19,3.36842105263,0.0,0.25,False,0.0,False,text," ideal of Rp by p. Let (xp)  I and choose, using weak approximation, b  K such that
"
20,3.2,0.0,0.133452380952,False,0.0,False,text," vp(xp  b)  m(p) + vp(xp) for each p|m. Because vp(xp  b)  vp(xp), we must have that
"
4,4.25,0.0,0.166666666667,False,0.0,False,text," vp(xp) = vp(b). Then
"
11,2.45454545455,0.0,0.188311688312,False,0.0,False,text," vp(xp/b  1) = vp(xp  b)  vp(b)  m(p),
"
1,1.0,0.0,0.0,False,0.0,False,text," 5
"
20,3.35,0.0,0.1875,False,0.0,False,text," implying that xp/b  Um,p for each p|m. Then (xp/b)  Im maps to the image of (xp) in CK
"
8,3.875,0.0,0.0,False,0.0,False,text," and we see that the map is surjective.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
7,5.14285714286,0.6,0.0238095238095,True,1.0,True,heading," Proposition 2.7. The group Clm(A) is nite.
"
22,3.31818181818,0.0454545454545,0.0227272727273,False,0.0,True,after_body," Proof. In any ideal class of A, we can nd an ideal in it coprime to m, so we have a surjection
"
17,4.41176470588,0.0,0.0294117647059,False,0.0,True,text," Clm(A)  Cl(A). The kernel of this map is the subgroup of Clm(A) consisting of the principal
"
19,3.94736842105,0.0,0.0868421052632,False,0.0,False,text," ideal classes of the form xA where vp(x) = 0 for p|m. These classes can be viewed as elements
"
3,1.33333333333,0.0,0.333333333333,False,0.0,False,text," in C 0
"
16,3.6875,0.0,0.0104166666667,False,0.0,False,text," m is nite, we see that Clm(A) is an extension of nite groups and is itself
"
1,5.0,0.0,0.0,False,0.0,False,text," nite.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
4,2.25,0.0,0.25,False,0.0,False,text," m. Since C 0
"
10,4.3,0.625,0.2,True,1.0,True,heading," Corollary 2.8. There is a nite abelian extension K A
"
6,3.83333333333,0.833333333333,0.0277777777778,False,0.0,False,body," to Clm(A) via the Artin map.
"
13,5.0,0.0769230769231,0.10989010989,False,0.0,True,text," Proof. The injection Im  I, when restricted to Km,1Wm, induces an isomorphism
"
8,4.0,0.75,0.125,False,0.0,False,body," m of K whose Galois group is isomorphic
"
3,7.0,0.0,0.445512820513,False,0.0,False,after_body," (Km,1Wm)/Km,1  (KWm)/K.
"
20,2.9,0.0,0.3875,False,0.0,True,text," Indeed, given c  K and (xp)  Wm we can use weak approximation to nd c  K such
"
16,3.125,0.0,0.177083333333,False,0.0,False,text," that c/c  Km,1 as in the proof of part (2) of Theorem 2.6. Then c
"
6,2.83333333333,0.0,0.458333333333,False,0.0,False,text," c (xp)  Km,1Wm maps to
"
18,3.66666666667,0.0,0.231481481481,False,0.0,False,text," the image of c (xp) in (KWm)/K. Thus Clm(A) is a quotient of CK by an open subgroup
"
13,5.76923076923,0.0,0.0,False,0.0,False,text," subgroup, whose index is nite by Proposition 2.7. The Existence Theorem then guarantees
"
5,3.4,0.0,0.4,False,0.0,False,text," such an extension K A
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
4,3.25,0.0,0.25,False,0.0,False,text," m /K as desired.
"
12,6.08333333333,0.0,0.0,False,0.0,True,text," Together with an application of the Chebotarev Density Theorem, the above discussion
"
5,5.4,0.0,0.0,False,0.0,False,text," gives us the following theorem:
"
17,4.11764705882,0.713235294118,0.0686274509804,True,1.0,True,heading," Theorem 2.9. Let A and m be as above. Any ideal class in Clm(A) contains innitely many
"
4,3.75,0.875,0.125,False,0.0,False,body," prime ideals of A.
"
9,6.33333333333,0.0,0.0111111111111,False,0.0,False,after_body," 3. S-integers are universally definable in global function fields
"
17,4.23529411765,0.0,0.0,False,0.0,True,text," In Sections 3.1 and 3.2 we will review facts and results from [Par13]. The rest of Parks
"
17,4.17647058824,0.0,0.0,False,0.0,False,text," argument does not extend to the function eld setting, so we use results of Section 2 on
"
14,4.28571428571,0.0,0.0,False,0.0,False,text," idelic class eld theory to nish the proof in Section 3.3 and Section 3.4.
"
13,5.53846153846,0.0,0.0769230769231,False,0.0,False,text," 3.1. Notation and facts about quaternion algebras. Throughout this section, let K be
"
17,4.35294117647,0.0,0.176470588235,False,0.0,False,text," a global function eld of odd characteristic. Let a, b  K. We recall the following notation
"
2,6.0,0.0,0.0,False,0.0,False,text," from [Par13]:
"
18,3.72222222222,0.0,0.12037037037,False,0.0,False,text," (1) Given a prime p  SK, let v := vp be its associated valuation, normalized so that
"
20,2.9,0.0,0.2,False,0.0,False,text," it takes values in Z  {}. Dene Kp to be the completion of K at p, Rp the ring
"
19,3.31578947368,0.0,0.0701754385965,False,0.0,False,text," of integers in Kp, the maximal ideal of Rp by p, and Fp the residue eld of p. Set
"
24,2.29166666667,0.0,0.215277777778,False,0.0,True,text," Up := {s  Fp : x2  sx + 1 is irreducible over Fp} and let redp : Rp  Fp be the
"
19,3.0,0.0,0.105263157895,False,0.0,False,text," reduction map. Let Op := Rp  K; this is the local ring of the prime p in K.
"
17,3.29411764706,0.0,0.5,False,0.0,False,text," (2) Ha,b = K  K  K  K, the quaternion algebra over K with multiplication
"
11,1.54545454545,0.0,0.636363636364,False,0.0,False,text," given by 2 = a, 2 = b,  = .
"
24,2.0,0.0,0.375,False,0.0,False,text," (3) Given x := x1 + x2 + x3 + x4, dene x := x1  x2  x3  x4. This is the
"
18,3.5,0.0,0.22962962963,False,0.0,False,text," standard involution on Ha,b. Dene the (reduced) trace of x to be x + x = 2x1 and
"
12,2.33333333333,0.0,0.291666666667,False,0.0,False,text," the (reduced) norm of x to be x  x = x2
"
20,2.95,0.0,0.41875,False,0.0,False,text," (4) a,b = {p  SK : Ha,b K Kp 6= M2(Kp)}, that is, the set of primes where Ha,b
"
1,7.0,0.0,0.0,False,0.0,False,text," ramies.
"
3,1.33333333333,0.0,0.222222222222,False,0.0,False,text," 1  ax2
"
3,1.33333333333,0.0,0.222222222222,False,0.0,False,text," 2  bx2
"
3,2.0,0.0,0.25,False,0.0,False,text," 3 + abx2
"
1,2.0,0.0,0.0,False,0.0,False,text," 4.
"
1,1.0,0.0,0.0,False,0.0,False,text," 6
"
4,3.0,0.0,0.333333333333,False,0.0,False,text," (5) (a, b)p =(1
"
4,1.5,0.0,0.75,False,0.0,False,text," : p 6 a,b
"
5,1.2,0.0,0.4,False,0.0,False,text," 1 : p  a,b
"
6,3.66666666667,0.0,0.0555555555556,False,0.0,False,text," , the Hilbert symbol of Kp.
"
7,4.28571428571,0.0,0.114285714286,False,0.0,False,text," traces of norm one elements of Ha,b.
"
13,2.46153846154,0.0,0.397435897436,False,0.0,False,text," (6) Sa,b = {2x1  K : x2, x3, x4 such that x2
"
6,3.0,0.0,0.466666666667,False,0.0,False,text," (7) Ta,b = Sa,b + Sa,b.
"
17,4.05882352941,0.0,0.171568627451,False,0.0,True,text," Given a prime p  SK, we similarly dene Sa,b(Kp) and Ta,b(Kp) just by replacing K with
"
8,2.375,0.0,0.0416666666667,False,0.0,False,text," 4 = 1}. This is the set of
"
3,1.33333333333,0.0,0.222222222222,False,0.0,False,text," 1  ax2
"
3,1.33333333333,0.0,0.222222222222,False,0.0,False,text," 2  bx2
"
3,2.0,0.0,0.25,False,0.0,False,text," 3 + abx2
"
5,4.4,0.0,0.1,False,0.0,True,text," Kp in the above denitions.
"
2,4.5,0.0,0.0,True,1.0,True,text," Lemma 3.1.
"
9,3.0,0.398148148148,0.412037037037,False,0.0,False,heading," (1) If p 6 a,b, then Sa,b(Kp) = Kp.
"
7,2.42857142857,0.428571428571,0.178571428571,False,0.0,False,body," (2) If p  a,b then red1
"
15,2.4,0.444444444444,0.138888888889,False,0.0,False,body," (3) For any p with |Fp|  11, we have Fp = Up + Up.
"
7,2.14285714286,0.5,0.428571428571,False,0.0,False,body," (4) For each a, b  K,
"
6,2.66666666667,0.0555555555556,0.201388888889,False,0.0,False,body," p (Up)  Sa,b(Kp)  Op.
"
5,2.2,0.0,0.6,False,0.0,True,body," Sa,b = K  \pa,b
"
1,9.0,0.0,0.666666666667,False,0.0,True,after_body," Sa,b(Kp).
"
14,4.42857142857,0.0714285714286,0.0714285714286,False,0.0,True,text," Proof. See [Par13], Lemma 2.2; the arguments work when K is any global eld.
"
10,3.2,0.45,0.3,True,1.0,True,heading," Proposition 3.2. For any a, b  K, we have
"
3,3.33333333333,0.0,0.666666666667,False,0.0,True,after_body," Ta,b = \pa,b
"
1,3.0,0.0,0.666666666667,False,0.0,True,text," Op.
"
5,6.4,0.2,0.0,False,0.0,True,text," Proof. See [Par13, Proposition 2.3].
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
15,4.8,0.0,0.0,False,0.0,True,text," In our setting, we also have the following formula for the Hilbert symbol from [Ser79,
"
1,10.0,0.0,0.0,False,0.0,True,text," XIV.3.8]:,
"
3,8.66666666667,0.0,0.5,False,0.0,False,text," (a, b)p =(1)vp(a)vp(b)avp(b)
"
1,15.0,0.0,0.666666666667,False,0.0,False,text," bvp(a)(|Fp|1)/2
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,3.0,0.0,0.0,False,0.0,False,text," (1)
"
22,3.0,0.0,0.138311688312,False,0.0,True,text," Hence for a p-adic unit a, (a, p)p = 1 if and only if vp(p) is odd and redp(a) is not a
"
3,3.66666666667,0.0,0.111111111111,False,0.0,False,text," square in Fp.
"
19,3.68421052632,0.0,0.105263157895,False,0.0,False,text," 3.2. Partitioning the primes of K. Suppose a is not a square in K. Then if p is unramied
"
18,3.77777777778,0.0,0.144444444444,False,0.0,False,text," in K(a), after possibly multiplying by a square of K, a is a p-adic unit. We can then
"
9,4.77777777778,0.0,0.185185185185,False,0.0,False,text," identify K(a)/K(p) with the power residue symbol  a
"
1,2.0,0.0,0.5,False,0.0,False,text," p2
"
5,5.2,0.0,0.0,False,0.0,False,text," (see Proposition 10.5 and 10.6
"
20,3.5,0.0,0.15,False,0.0,False,text," in [Ros02]). If the images of a, b are distinct in K/K2, we can use the splitting of p in
"
16,4.4375,0.0,0.183253205128,False,0.0,True,text," Gal(K(a,b)/K) to study the Hilbert symbols (a, p)p and (b, p)p, since if vp(p) is odd,
"
4,2.0,0.0,0.75,False,0.0,False,text," (a, p)p = a
"
1,2.0,0.0,0.5,False,0.0,False,text," p2
"
19,3.26315789474,0.578947368421,0.276315789474,True,1.0,True,heading," Lemma 3.3. Take a, b  K whose images in K/K2 are distinct and let m be an admis-
"
10,4.4,0.7,0.2,False,0.0,False,text," sible modulus for the extension L := K(a,b)/K and let
"
7,1.71428571429,0.0,0.547619047619,False,0.0,True,text," L/K : Im  {1}  {1}
"
6,4.16666666667,0.0,0.0,False,0.0,False,text," . We have the following lemma:
"
18,4.11111111111,0.9,0.0222222222222,False,0.0,False,text," be the Artin map. Suppose that m is divisible also by all primes dividing (ab). For a prime
"
24,2.41666666667,0.402777777778,0.190277777778,False,0.0,False,text," p  SK such that p  m, p  a,p  b,p if and only if vp(p) is odd and L/K(p) = (1,1).
"
1,1.0,0.0,0.0,False,0.0,False,text," 7
"
18,4.0,0.0555555555556,0.0,False,0.0,True,text," Proof. See [Par13], Lemma 3.8. The only change in the argument is that we do not to worry
"
14,5.35714285714,0.0,0.0357142857143,False,0.0,False,text," about total positivity conditions dening Km,1 since there are no Archimedean primes of a
"
3,6.0,0.0,0.0,False,0.0,False,text," global function eld.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
17,4.0,0.0,0.117647058824,False,0.0,True,text," As in [Par13], we partition primes of K coprime to m based on their image under L/K.
"
13,2.46153846154,0.0,0.384615384615,False,0.0,True,text," Choose a, b  K and L as in Lemma 3.3 and set
"
9,2.66666666667,0.0,0.322222222222,False,0.0,True,text," P(p) := {p  SK : vp(p) is odd.}.
"
11,2.90909090909,0.0,0.386363636364,False,0.0,True,text," Also, for (i, j)  Gal(L/K), i, j  {1}, set
"
14,2.21428571429,0.0,0.333333333333,False,0.0,True,text," P(i,j) = {p  SK : p  Im and L/K(p) = (i, j)}
"
2,3.0,0.0,0.0,False,0.0,False,text," and set
"
5,4.2,0.0,0.353968253968,False,0.0,True,text," P(i,j)(p) = P(p)  P(i,j).
"
17,3.58823529412,0.647058823529,0.176470588235,True,1.0,True,text," Lemma 3.4. Suppose p  K and let m be a modulus as in Lemma 3.3. Additionally,
"
16,4.625,0.880208333333,0.0208333333333,False,0.0,False,text," suppose (p) and m are coprime. Then we have the following identication of sets of primes,
"
12,4.33333333333,1.02083333333,0.0,False,0.0,False,text," where the two sets dier at most by primes dividing the modulus.
"
5,3.2,0.0,0.511111111111,False,0.0,True,text," P(1,1)(p)  a,p  b,p,
"
5,3.4,0.0,0.488888888889,False,0.0,True,text," P(1,1)(p)  a,p  ab,p,
"
5,3.4,0.0,0.488888888889,False,0.0,True,text," P(1,1)(p)  b,p  ab,p.
"
5,5.2,0.2,0.0,False,0.0,True,text," Proof. See [Par13, Lemma 3.9].
"
23,2.78260869565,0.275362318841,0.210144927536,True,1.0,True,text," Lemma 3.5. Let p  SK with p  m and suppose that L/K(p) = (i, j) with (i, j) 6= (1, 1).
"
23,2.5652173913,0.380434782609,0.361111111111,False,0.0,True,text," Then p  P(i,j)(p) for some p  K. Hence there exist u, v  K such that p  u,p  v,p.
"
19,2.52631578947,0.326315789474,0.357894736842,False,0.0,True,text," If L/K(p) = (1, 1) then there exist p, q  K so that p  ap,q  bp,q.
"
6,5.5,0.166666666667,0.0,False,0.0,True,text," Proof. See [Par13, Lemmas 3.11, 3.12].
"
8,2.875,0.0,0.375,False,1.125,True,text," Denition 3.6. Let a, b  K. Let
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
2,3.0,0.0,0.5,False,0.0,True,text," Ja,b :=
"
1,4.0,0.0,0.5,False,0.0,False,text," pOp.
"
1,14.0,0.0,0.714285714286,False,0.0,False,text," pa,b(P(a)P(b))
"
1,1.0,0.0,1.0,False,0.0,False,text," \
"
7,5.42857142857,0.5,0.214285714286,True,1.0,True,heading," Proposition 3.7. Ja,b is diophantine over K.
"
7,5.42857142857,0.142857142857,0.0,False,0.0,True,after_body," Proof. See [Par13, Lemmas 3.14, 3.15, 3.17].
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
11,6.45454545455,0.0,0.0,False,0.0,False,text," 3.3. Controlling integrality with diophantine sets. The remainder of the argument
"
16,4.625,0.0,0.06875,False,0.0,False,text," used to give a universal denition of the S-integers in K requires a dierent approach than
"
20,3.3,0.0,0.15,False,0.0,False,text," the one in [Par13]. In order to make our proof work, we need to nd innitely many q  K
"
14,5.14285714286,0.0,0.0952380952381,False,0.0,False,text," with prescribed image under L/K and which generate prime ideals in a certain Dedekind
"
12,3.83333333333,0.0,0.125,False,0.0,False,text," domain contained in K in order to control the poles of q.
"
22,2.72727272727,0.662878787879,0.257575757576,True,1.0,True,heading," Lemma 3.8. Let S be a nite set of primes in SK. We can choose a, b  K so that the
"
2,7.0,1.0,0.0,False,0.0,False,body," following hold:
"
11,3.36363636364,0.727272727273,0.295454545455,False,0.0,False,body," (1) The images of a and b in K/K2 are distinct.
"
16,4.0,0.71875,0.15625,False,0.0,False,text," (2) Any admissible modulus m for L := K(a,b)/K is divisible by the primes of S.
"
1,1.0,0.0,0.0,False,0.0,False,text," 8
"
19,3.31578947368,0.731203007519,0.259398496241,False,0.0,False,text," (3) Given a nite set of primes S  SK disjoint from S, an ideal class I in Cl(OS),
"
20,2.85,0.605555555556,0.141666666667,False,0.0,False,text," and an element   Gal(L/K), there exists a prime q of K such that q  OS is in
"
11,2.72727272727,0.530303030303,0.227272727273,False,0.0,False,text," the ideal class I, q  Im, and L/K(q) = .
"
14,5.28571428571,0.857142857143,0.047619047619,False,0.0,False,text," (4) As fractional ideals, (a) and (b) are coprime, meaning their supports are disjoint.
"
25,2.36,0.04,0.349333333333,False,0.0,True,text," Proof. Set A = OS. Let p1  SK \ S and choose a  K with vp1(a) = 0 and vp(a) = 1 for
"
9,4.11111111111,0.0,0.0555555555556,False,0.0,False,text," p  S; this is possible by weak approximation.
"
23,2.78260869565,0.0,0.173188405797,False,0.0,True,text," Now we choose b  K with vp1(b) = 1 and vp(b) = 0 for any p in the support of (a). Then
"
16,4.375,0.0,0.119791666667,False,0.0,False,text," (a) and (b) have disjoint support. They have distinct images in K/K2 as the primes at
"
17,4.11764705882,0.0,0.117647058824,False,0.0,False,text," which a has odd valuation dier from the primes where b has odd valuation. Thus we have
"
18,3.94444444444,0.0,0.144444444444,False,0.0,False,text," established (1) and (4). Since the primes in S ramify in K(a), they also ramify in L and
"
10,4.9,0.0,0.075,False,0.0,False,text," hence will be contained in any admissible modulus for L/K.
"
16,4.125,0.0,0.125,False,0.0,True,text," We are left with showing that (3) holds. Recall that K A/K is the maximal abelian
"
15,4.46666666667,0.0,0.2,False,0.0,False,text," unramied extension of K in which every prime of S splits completely and for which
"
18,3.77777777778,0.0,0.228703703704,False,0.0,True,text," Gal(K A/K)  Cl(A). We claim that K A and L are linearly disjoint; this will follow if
"
21,2.90476190476,0.0,0.309523809524,False,0.0,False,text," we can show that none of a, b, and ab are in K A. Since the primes in S ramify in
"
21,3.0,0.0,0.37380952381,False,0.0,True,text," K(a), a 6 K A. As p1 ramies in K(b) and the primes of S along with p1 all ramify in
"
16,3.3125,0.0,0.291666666667,False,0.0,True,text," K(ab), we have that b, and ab are not in K A, and the claim follows.
"
2,5.0,0.0,0.0,False,0.0,True,text," We conclude
"
11,3.81818181818,0.0,0.495995670996,False,0.0,True,text," Gal(LK A/K) = Gal(L/K)  Gal(K A/K) = {(1,1)}  Cl(A).
"
14,4.07142857143,0.0,0.0,False,0.0,True,text," We then apply the Chebotarev density theorem to nd a prime q such that
"
15,3.33333333333,0.0,0.317222222222,False,0.0,False,text," (q, LK A/K) = (, I)  Gal(L/K)  Gal(K A/K). This yields part (c):
"
21,2.57142857143,0.0,0.486507936508,False,0.0,False,text,"  = (q, LK A/K)|L = (q, L/K) = L/K(q) and I = (q, LK A/K)|K A = (q, K A/K).
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
19,3.26315789474,0.0,0.210526315789,False,0.0,True,text," For the rest of this section, x a, b  K as in Lemma 3.8 along with an admissible
"
8,3.0,0.0,0.357142857143,False,0.0,False,text," modulus m of K for L := K(a,b).
"
20,2.85,0.0,0.292857142857,False,0.0,True,text," For the rest of this section, x a, b  K as in Lemma 3.8 and set L := K(a,b).
"
16,4.3125,0.0,0.0625,False,0.0,True,text," Next, we must x two additional elements of K. To construct them, we need Theorem 3.7
"
15,5.26666666667,0.0,0.0,False,0.0,False,text," of [Par13], which we restate below for convenience. This theorem lets us construct an element
"
12,5.0,0.0,0.25,False,0.0,False,text," of K with prescribed Hilbert symbols against nitely many elements of K.
"
17,3.88235294118,0.455882352941,0.0966386554622,True,1.0,True,text," Theorem 3.9. [Par13, Theorem 3.7] Let K be a global eld, char(K) 6= 2. Let  denote
"
21,3.19047619048,0.904761904762,0.0619047619048,False,0.0,False,text," the set of primes of K, and let  be a nite set of indices. Let (ai)i be a nite sequence
"
16,4.1875,0.822916666667,0.221354166667,False,0.0,False,text," of elements of K and suppose that (i,p)i,p is a family of elements of {1,1}. There
"
24,2.625,0.458333333333,0.253472222222,False,0.0,False,text," exists x  K satisfying (ai, x)p = i,p for all i   and p   if and only if the following
"
2,7.5,1.0,0.0,False,0.0,False,text," conditions hold:
"
12,3.25,0.930555555556,0.0833333333333,False,0.0,False,text," (1) All but nitely many of the i,p are equal to 1.
"
17,2.82352941176,0.485294117647,0.25,False,0.0,False,text," (3) For every p  , there exists xp  K such that (ai, xp)p = i,p.
"
11,2.27272727273,0.560606060606,0.212121212121,False,0.0,False,text," (2) For all i  , we haveQp i,p = 1.
"
21,2.90476190476,0.285714285714,0.392857142857,True,1.0,True,text," Lemma 3.10. There exist c, d  K such that a,c = P(a) or a,c = P(a)  {pa} where pa
"
21,3.33333333333,0.559523809524,0.242063492063,False,0.0,False,text," is coprime to (a) and (b), and b,d = P(b) or b,d {pb} where pb is coprime to (a), (b), and
"
1,3.0,0.333333333333,0.333333333333,False,0.0,False,text," pa.
"
1,1.0,0.0,0.0,False,0.0,False,text," 9
"
16,4.4375,0.0625,0.15625,False,0.0,True,text," Proof. Assume P(a) has even cardinality. Then by Theorem 3.9, there exists c in K such
"
24,2.75,0.0,0.158333333333,False,0.0,False,text," that (a, c)p = 1 for each p  P(a), and (a, c)p = 1 if p is not in P(a). Indeed, there are
"
20,3.35,0.0,0.145,False,0.0,False,text," an even number primes in P(a), and for a local element we can take any cp  K such that
"
2,1.0,0.0,0.25,False,0.0,False,text,"  cp
"
20,3.05,0.0,0.215833333333,False,0.0,False,text," p = 1. Then (a, cp)p = 1 since vp(a) is odd. The proof in the case that P(a) has
"
3,1.33333333333,0.0,0.666666666667,False,0.0,False,text," pa = 1
"
17,3.64705882353,0.0,0.127450980392,False,0.0,False,text," odd cardinality is the same by choosing pa coprime to (a) and (b) such that  a
"
19,3.73684210526,0.0,0.0701754385965,False,0.0,False,text," and considering the set P(a)  pa. The local element for pa can be taken to be any element
"
5,1.6,0.0,0.433333333333,False,0.0,False,text," cpa  pa \ p2
"
12,3.91666666667,0.0,0.125,False,0.0,False,text," a. The proof for the existence of d is a similar argument.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
22,2.59090909091,0.0,0.272727272727,False,0.0,True,text," We now also x c, d  K as in Lemma 3.10, along with a modulus m of K for L such
"
19,4.05263157895,0.0,0.0833333333333,False,0.0,False,text," that m contains all the primes dividing (a), (b), (c), and (d) and any other primes p such that
"
9,2.11111111111,0.0,0.388888888889,False,0.0,False,text," (a, c)p = 1 or (b, d)p = 1.
"
15,3.4,0.533333333333,0.222222222222,True,1.0,True,heading," Corollary 3.11. Let p  K such that (p) and m are coprime. We have
"
15,5.2,0.0666666666667,0.0,False,0.0,True,text," Proof. For the rst equality, see [Par13, Corollary 3.20]. We will prove the second equality.
"
2,3.0,0.0,0.0,False,0.0,True,heading," We have
"
5,3.4,0.0,0.511111111111,False,0.0,True,body," P(1,1)(p) = a,p  b,p,
"
7,3.14285714286,0.0,0.492063492063,False,0.0,True,body," P(1,1)(p) = a,p  ab,p  a,cp,
"
7,3.14285714286,0.0,0.492063492063,False,0.0,True,after_body," P(1,1)(p) = b,p  ab,p  b,dp.
"
9,2.66666666667,0.0,0.66049382716,False,0.0,False,text," a,p  ab,p = P(1,1)(p) p  P(a) :a
"
4,1.0,0.0,1.0,False,0.0,False,text," p = 1 ,
"
20,3.35,0.0,0.112222222222,False,0.0,False,text," by Lemma 3.4. Also, P(1,1)(p)  a,cp, since (a, c)p = 1 for any p coprime to m. Thus we
"
18,3.61111111111,0.0,0.216666666667,False,0.0,False,text," need to compute the intersection a,cp  {p|m}. Suppose p  P(a). Then (a, c)p = 1 by
"
14,2.21428571429,0.0,0.338095238095,False,0.0,False,text," p = 1. If p|m but p 6 P(a), then (a, p)p = 1
"
14,2.57142857143,0.0,0.297619047619,False,0.0,False,text," our choice of c, so (a, cp)p = 1 if and only if p
"
22,3.04545454545,0.0,0.166666666667,False,0.0,False,text," by Equation 1, so (a, cp)p = 1 if and only if (a, c)p = 1. In any case, we conclude that
"
19,3.36842105263,0.0,0.223684210526,False,0.0,False,text," because whenever (a, p)p = 1 for p|m, we have (a, c)p = 1 as well. Thus the second
"
14,4.78571428571,0.0,0.0,False,0.0,False,text," equality holds. The proof of the third equality goes the same way by calculating
"
7,2.0,0.0,0.657142857143,False,0.0,False,text," a,p  a,cp  {p|m} = ,
"
3,3.33333333333,0.0,0.555555555556,False,0.0,False,text," b,dp  {p|m}.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
8,3.0,0.0,0.375,False,1.125,True,heading," Denition 3.12. For p, q  K, let
"
1,6.0,0.0,0.666666666667,False,0.0,True,after_body," R(1,1)
"
1,1.0,0.0,1.0,False,0.0,False,text," p
"
1,3.0,0.0,0.666666666667,False,0.0,True,text," Op,
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
2,4.5,0.0,0.5625,False,0.0,False,text," = \pa,pb,p
"
1,1.0,0.0,1.0,False,0.0,False,text," \
"
1,1.0,0.0,1.0,False,0.0,False,text," \
"
3,4.66666666667,0.0,0.7,False,0.0,False,text," p,q = \pap,qbp,q
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,2.0,0.0,0.0,False,0.0,False,text," 10
"
1,12.0,0.0,1.16666666667,False,0.0,False,text," pa,pab,pb,dp
"
1,3.0,0.0,0.666666666667,False,0.0,True,text," Op.
"
1,12.0,0.0,1.16666666667,False,0.0,False,text," pab,pb,pa,cp
"
1,6.0,0.0,0.5,False,0.0,True,text," R(1,1)
"
1,1.0,0.0,1.0,False,0.0,False,text," p
"
1,6.0,0.0,0.5,False,0.0,True,text," R(1,1)
"
1,1.0,0.0,1.0,False,0.0,False,text," p
"
1,6.0,0.0,0.333333333333,False,0.0,True,text," R(1,1)
"
1,3.0,0.0,0.666666666667,False,0.0,True,text," Op,
"
1,3.0,0.0,0.666666666667,False,0.0,True,text," Op,
"
19,3.42105263158,0.0,0.145614035088,False,0.0,True,text," Given a nite set of primes S  SK, in Section 3 we will express the S-integers OS in
"
11,3.09090909091,0.0,0.309090909091,False,0.0,False,text," p for  = (1,1), (1, 1), and (1,1) and R(1,1)
"
3,4.66666666667,0.0,0.333333333333,False,0.0,False,text," p,q dened above.
"
5,3.2,0.0,0.4,False,0.0,False,text," terms of the rings R
"
8,4.0,0.0,0.0416666666667,False,1.125,True,heading," Denition 3.13. For each   Gal(L/K), let
"
18,2.05555555556,0.0,0.488425925926,False,0.0,False,body,"  = {p  K : (p)  Im, L/K((p)) = , and P(p)  P(1,1)  P}.
"
2,5.0,0.0,0.0,True,1.0,True,body," Lemma 3.14.
"
6,5.5,0.833333333333,0.333333333333,False,0.0,True,body," Furthermore, the Jacobson radical of R
"
11,3.45454545455,0.60101010101,0.0757575757576,False,0.0,False,heading," (1) For each   Gal(L/K),  is diophantine over K.
"
21,2.85714285714,0.492063492063,0.128968253968,False,0.0,False,body," (2) For any p   and   Gal(L/K) with  6= (1, 1), we have that P()(p) is nonempty.
"
21,2.66666666667,0.492063492063,0.105158730159,False,0.0,False,body," (3) Let   Gal(L/K) with  6= (1, 1), and let p0  m be a prime of K satisfying
"
2,3.5,1.0,0.0,False,0.0,True,body," In fact,
"
16,2.8125,0.5125,0.198214285714,False,0.0,True,body," L/K(p0) = . Then there is an element p   such that p0  P(p).
"
9,3.11111111111,0.577777777778,0.238888888889,False,0.0,False,body," p can be chosen so that P(p) = {p0}.
"
6,3.66666666667,0.666666666667,0.25,False,0.0,False,body," p ), is diophantine over K.
"
4,3.0,0.5,0.5,False,0.0,False,body," p , denoted J(R
"
16,4.5625,0.0625,0.0625,False,0.0,True,after_body," Proof. To prove (1), we rst establish that Km,1 is diophantine over K: this follows from
"
18,3.61111111111,0.0,0.0555555555556,False,0.0,False,text," the fact that Km,1 is dened by the nitely many local conditions vp(a  1)  m(p) for
"
18,3.88888888889,0.0,0.101851851852,False,0.0,False,text," p|m and that the local rings Op are diophantine over K for any prime p by [Shl94, Lemma
"
13,3.69230769231,0.0,0.115384615385,False,0.0,False,text," 3.22]. Because a class of principal ideals in Cm lies in C 0
"
9,3.33333333333,0.0,0.0,False,0.0,False,text," m which is nite, we see there are only
"
21,3.09523809524,0.0,0.304761904762,False,0.0,False,text," nitely many inequivalent classes of the form (p)Pm for p  K. Thus {p  K : (p)  Im} is
"
19,3.73684210526,0.0,0.228070175439,False,0.0,False,text," diophantine over K as it is a nite union of translates of Km. Observe that P(p)  P(1,1) P
"
7,4.57142857143,0.0,0.0,False,0.0,False,text," is equivalent to one of the following:
"
10,3.0,0.0,0.238888888889,False,0.0,False,text,"  P(1,1)(p) = P(1,1)(p) = , if  = (1,1);
"
10,3.0,0.0,0.233333333333,False,0.0,False,text,"  P(1,1)(p) = P(1,1)(p) = , if  = (1,1);
"
11,2.72727272727,0.0,0.242424242424,False,0.0,False,text,"  P(1,1)(p) = P(1,1)(p) = , if  = (1, 1);
"
13,3.07692307692,0.0,0.213675213675,False,0.0,False,text,"  P(1,1)(p) = P(1,1)(p) = P(1,1)(p) = , if  = (1, 1).
"
21,2.0,0.0,0.293650793651,False,0.0,True,text," For  6= (1, 1), we have that P (p) =  if and only if p  K2  (R
"
5,2.6,0.0,0.133333333333,False,0.0,False,text," p), and this is a
"
16,4.5,0.0,0.09375,False,0.0,False,text," diophantine subset of K. Thus for any ,  is the intersection of nitely many diophantine
"
7,4.28571428571,0.0,0.0714285714286,False,0.0,False,text," sets and is thus diophantine over K.
"
1,1.0,0.0,1.0,False,0.0,False,text," p
"
19,3.0,0.0,0.18201754386,False,0.0,True,text," Now we prove (2). Suppose  6= (1, 1) and that p  . Then because L/K((p)) = 
"
18,3.55555555556,0.0,0.135185185185,False,0.0,False,text," and P(p)  P(1,1)  P, there must be some prime p  P(p), because otherwise we would
"
5,3.2,0.0,0.146666666667,False,0.0,False,text," have ((p)) = (1, 1).
"
6,2.16666666667,0.0,0.333333333333,False,0.0,False,text," ) = Ja,p + Jb,p is
"
1,1.0,0.0,1.0,False,0.0,False,text," p
"
10,5.6,0.0,0.15,False,0.0,False,text," diophantine over K by Denition 3.6 Lemma 3.7. Similarly, J(R(1,1)
"
7,2.57142857143,0.0,0.428571428571,False,0.0,False,text," ) = Ja,p + Jab,p + Ja,cp
"
2,5.5,0.0,0.25,False,0.0,False,text," and J(R(1,1)
"
9,3.77777777778,0.0,0.125,False,0.0,True,text," If  = (1,1), then we observe that J(R(1,1)
"
21,2.7619047619,0.0,0.0689865689866,False,0.0,True,text," We move on to (3). Suppose that   Gal(K(a,b)/K) with  6= (1, 1) and p0  m is a
"
22,2.81818181818,0.0,0.260822510823,False,0.0,False,text," prime of K satisfying L/K(p0) = . Let q  m be a prime of K with L/K(q) = (1, 1) and
"
21,3.2380952381,0.0,0.178571428571,False,0.0,False,text," let S = {q}. By Lemma 3.8 we can choose a prime q of K such that it represents the class
"
22,2.90909090909,0.0,0.257575757576,False,0.0,False,text," of (p0  OS)1 in Cl(OS) and L/K (q) = (1, 1). Then there is an element p  OS such that
"
7,2.28571428571,0.0,0.371428571429,False,0.0,False,text," (p0  OS)(q  OS) = pOS.
"
11,3.45454545455,0.0,0.318181818182,False,0.0,False,text," ) = Jb,p + Jab,p + Jb,dp are diophantine over K.
"
23,2.52173913043,0.0,0.220289855072,False,0.0,True,text," We claim that p  . Since vp(p) = 0 if p 6= p0, q, q, it follows that (p)  Im and
"
1,1.0,0.0,1.0,False,0.0,False,text," p
"
5,6.0,0.0,0.661842105263,False,0.0,True,text," L/K((p)) = L/K(p0)L/K(q)L/K(q) = .
"
17,4.05882352941,0.0,0.0823529411765,False,0.0,True,text," Additionally, the only primes p with vp(p) odd are p0, q, and possibly q. Hence P(p) 
"
14,3.07142857143,0.0,0.391666666667,False,0.0,True,text," P(1,1)  P and p  . Finally, we observe that P(p) = {p0}.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,2.0,0.0,0.0,False,0.0,False,text," 11
"
20,3.25,0.416666666667,0.161904761905,True,1.0,True,heading," Lemma 3.15. Let p0, q0 be primes of K not dividing m with L/K(q0) = (1, 1). Let A :=
"
10,4.5,0.629166666667,0.35,False,0.0,True,body," O{q0}. Then there exists innitely many q  K satisfying
"
4,4.5,0.291666666667,0.28125,False,0.0,False,body," (1) L/K((q)) = (1,1);
"
3,1.33333333333,0.333333333333,0.333333333333,False,0.0,False,text," (2)  q
"
3,1.66666666667,0.166666666667,0.333333333333,False,0.0,False,text," p0 = 1;
"
23,2.5652173913,0.644927536232,0.18115942029,False,0.0,False,body," (3) qA is a prime ideal of A, so there exists a prime q of K such that q  A = qA.
"
2,4.5,0.5,0.0,False,0.0,True,after_body," Proof. Set
"
10,1.8,0.0,0.58,False,0.0,True,text," Km := {  K : vp() = 0 p|m}.
"
25,2.6,0.0,0.173333333333,False,0.0,True,text," For a prime p 6= q0 of K, let Ip := A  p be the associated prime ideal in A. Given x  Km,
"
24,2.5,0.0,0.315972222222,False,0.0,False,text," we can nd y, z  A  Km such that x = y/z. Then y and z are p-adic units for each p|m
"
5,3.2,0.0,0.0,False,0.0,False,text," . The kernel of this
"
17,2.94117647059,0.0,0.264705882353,False,0.0,False,text," and thus we can map x = y/z to the image of y/z modulo Qp|m I m(p)
"
9,4.44444444444,0.0,0.0555555555556,False,0.0,False,text," map is Km,1 so there is a well-dened isomorphism
"
1,1.0,0.0,0.0,False,0.0,False,text," p
"
2,6.5,0.0,0.869047619048,False,0.0,True,text," Km/Km,1 A,Yp|m
"
2,2.5,0.0,0.5,False,0.0,True,text," I m(p)
"
2,0.5,0.0,0.0,False,0.0,False,text," p 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
5,5.8,0.0,0.0,False,0.0,True,text," By the Chinese Remainder Theorem,
"
5,5.4,0.0,0.512012987013,False,0.0,True,text," Kp0m/Kp0m,1 = Km/Km,1  (A/Ip0).
"
14,5.35714285714,0.0,0.0765306122449,False,0.0,True,text," The group Km/Km,1 surjects onto the ray classes in Cm consisting of principal fractional
"
4,3.5,0.0,0.0,False,0.0,False,text," ideals by the map
"
3,4.0,0.0,1.03333333333,False,0.0,False,text," xKm,1 7 (x)Pm.
"
21,3.33333333333,0.0,0.104761904762,False,0.0,True,text," Now we apply Lemma 3.8 part (3) to nd a prime q of K in the principal ideal class of Cl(A)
"
16,3.875,0.0,0.311805555556,False,0.0,False,text," such that L/K(q) = (1,1). Then there exists x1  K such that L/K((x1)) = (1,1)
"
21,2.7619047619,0.0,0.222222222222,False,0.0,False,text," and x1A = q  A is a prime ideal of A. Let s be a non-square of (A/Ip0). By the
"
13,5.61538461538,0.0,0.164835164835,False,0.0,True,text," Chinese Remainder Theorem, the element (x1Km,1, s) in Km/Km,1  (A/Ip0) corresponds to
"
9,5.11111111111,0.0,0.134259259259,False,0.0,False,text," an element x2Kp0m,1  Kp0m/Kp0m,1. By construction,  x2
"
8,2.875,0.0,0.208333333333,False,0.0,False,text," p0 = 1. The ideal x2A need not
"
20,3.4,0.0,0.075,False,0.0,False,text," be a prime ideal of A, but by Theorem 2.9, we can nd innitely many prime ideals of A in
"
21,3.2380952381,0.0,0.100529100529,False,0.0,False,text," the class generated by x2 in Clmp0(A); such a prime ideal is of the form qA = q  A. Both
"
19,3.47368421053,0.0,0.249686716792,False,0.0,False,text," qA and x2A generate the same class in Clmp0(A) and hence q = x2t for some t  Kmp0,1.
"
16,4.3125,0.0,0.188368055556,False,0.0,True,text," Thus L/K((q)) = L/K((x2)) and since q and x2, as elements of A, are congruent modulo
"
5,3.0,0.0,0.166666666667,False,0.0,False,text," the ideal Ip0 of A,
"
2,0.5,0.0,0.5,False,0.0,False,text,"  q
"
2,2.5,0.0,0.583333333333,False,0.0,False,text," p0 =x2
"
3,1.66666666667,0.0,0.5,False,0.0,False,text," p0 = 1.
"
11,4.81818181818,0.0,0.0909090909091,False,0.0,True,text," Thus the element q satises the three requirements of the lemma.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
7,4.85714285714,0.0,0.0,False,0.0,True,text," We now need more denitions from [Par13].
"
1,2.0,0.0,0.0,False,0.0,False,heading," 12
"
16,3.5625,0.0,0.160714285714,False,1.125,True,body," Denition 3.16. For   Gal(K(a,b)/K), and S  SK the xed set of primes from
"
2,5.0,0.0,0.0,False,0.0,False,text," above, dene
"
5,1.2,0.0,0.8,False,0.0,False,heading," f := K2  ;
"
7,3.71428571429,0.0,0.424242424242,False,0.0,True,text," K :=((p, q)  ](1,1)  ^(1,1)|Yp|m
"
4,2.25,0.0,0.520833333333,False,0.0,False,body," (ap, q)p = 1
"
1,4.0,0.0,0.5,False,0.0,False,body," ))).
"
10,1.8,0.0,0.3625,False,0.0,False,body," and p  a  K2  (1 + J(R(1,1)
"
1,1.0,0.0,1.0,False,0.0,False,after_body," q
"
2,5.0,0.0,0.0,True,1.0,True,text," Lemma 3.17.
"
8,3.625,0.8125,0.1875,False,0.0,False,heading," (1) The set K is diophantine over K.
"
17,2.64705882353,0.328431372549,0.316176470588,False,0.0,False,body," (2) For (p, q)  L/K, we have  6= ap,q  bp,q  Im, and J(R(1,1)
"
20,3.4,0.466666666667,0.103571428571,False,0.0,False,body," (3) For each prime ideal p0 satisfying p0  m and L/K(p0) = (1, 1), there exists (p, q) 
"
5,4.2,0.6,0.2,False,0.0,False,body," p,q ) is diophantine over
"
1,2.0,0.5,0.5,False,0.0,True,body," K.
"
8,2.875,0.275,0.425,False,0.0,True,body," K such that ap,q  bp,q = {p0}.
"
17,4.11764705882,0.0588235294118,0.0882352941176,False,0.0,True,after_body," Proof. By Lemma 3.14 part (1), ](1,1)  ^(1,1) is diophantine over K, and by Lemma 3.14
"
3,5.33333333333,0.0,0.208333333333,False,0.0,False,text," part (2), J(R(1,1)
"
14,3.5,0.0,0.0714285714286,False,0.0,False,text," ) is diophantine over K. By Theorem 4.5, for any prime p of K,
"
1,1.0,0.0,1.0,False,0.0,False,text," q
"
11,1.63636363636,0.0,0.659090909091,False,0.0,False,text," {(x, y) : (x, y)p = 1}  K  K
"
17,4.29411764706,0.0,0.132352941176,False,0.0,False,text," is diophantine over K. Here, (,)p denotes the Hilbert symbol of K at p. Since only nitely
"
17,4.11764705882,0.0,0.0882352941176,False,0.0,False,text," many p divide m, the set K is the intersection of nitely many sets diophantine over K.
"
22,2.95454545455,0.0,0.0757575757576,False,0.0,True,text," For (2), the proof in [Par13] of Lemma 3.25 part (2) shows that for (p, q)  K, if p  m
"
21,2.95238095238,0.0,0.311904761905,False,0.0,False,text," then ap,q  bp,q  Im is nonempty. We only need to show that if p|m, p 6 ap,q  bp,q.
"
21,3.04761904762,0.0,0.256349206349,False,0.0,True,text," Suppose that p  ap,q. Then (ap, q)p = 1. Since p  ](1,1) and q  ^(1,1) we can assume
"
19,3.63157894737,0.0,0.204385964912,False,0.0,False,text," that, possibly after multiplying by a square of K, vp(p) = vp(q) = 0. Then (ap, q)p = 1
"
17,4.52941176471,0.0,0.0764705882353,False,0.0,False,text," implies that vp(ap) = vp(a) is odd, which implies vp(b) must be 0 since the fractional ideals
"
17,3.29411764706,0.0,0.326470588235,False,0.0,False,text," (a) and (b) have disjoint support. Thus (bp, q)p = 1 and p 6 ap,q  bp,q.
"
21,3.2380952381,0.0,0.0430839002268,False,0.0,True,text," Now we prove (3). Let p0 satisfy p0  m and L/K(p0) = (1, 1); we wish to construct a pair
"
19,3.47368421053,0.0,0.266666666667,False,0.0,False,text," (p, q)  K such that ap,q  bp,q = {p0}. We begin by constructing our candidate for q.
"
18,3.83333333333,0.0,0.10582010582,False,0.0,True,text," Choose a dierent prime q0 of K not dividing m with L/K(q0) = (1, 1). Using Lemma 3.15,
"
10,3.2,0.0,0.529166666667,False,0.0,False,text," choose q  K such that L/K((q)) = (1,1), q
"
9,3.22222222222,0.0,0.222222222222,False,0.0,False,text," p0 = 1, and q generates a prime ideal
"
22,3.09090909091,0.0,0.181818181818,False,0.0,False,text," of A := O{q0}. Thus there exists a prime q of K with qA = q  A. Observe that this implies
"
11,3.54545454545,0.0,0.113636363636,False,0.0,False,text," that the support of (q) is {q, q0}. We claim that
"
5,2.2,0.0,0.55,False,0.0,False,text," a,q  b,q = {q}.
"
21,3.33333333333,0.0,0.150793650794,False,0.0,True,text," We begin by showing that (a, q)q = (b, q)q = 1. The support of (a) and (b) is contained in
"
23,2.82608695652,0.0,0.139130434783,False,0.0,False,text," m, so vq(a) = vq(b) = 0. We have that vq(q) is odd, so we need to show a and b are non-
"
15,4.53333333333,0.0,0.144444444444,False,0.0,False,text," squares in the completion of K at q. This follows immediately from L/K(q) = (1,1).
"
22,2.81818181818,0.0,0.268939393939,False,0.0,True,text," From L/K (q0) = (1, 1) we get that q0 6 a,q  b,q. No other prime p in Im can appear
"
20,3.4,0.0,0.0766666666667,False,0.0,False,text," in this set since we have vp(q) = vp(a) = vp(b) = 0. Finally, no prime p|m can occur in
"
18,3.77777777778,0.0,0.155555555556,False,0.0,False,text," a,q  b,q since we cannot have that vp(a) and vp(b) are both odd as their supports are
"
9,4.33333333333,0.0,0.0444444444444,False,0.0,False,text," disjoint, and vp(q) = 0. This proves the claim.
"
1,2.0,0.0,0.0,False,0.0,False,text," 13
"
15,3.06666666667,0.0,0.25,False,0.0,True,text," For each prime p|m, let Ep  K be a generating set for Kp /K2
"
17,2.05882352941,0.0,0.23431372549,False,0.0,False,text," e  Ep, we have vp0(e  1)  0. Fix e0  K such that e0
"
5,1.6,0.0,0.566666666667,False,0.0,False,text," q = 1 and e0
"
22,2.59090909091,0.0,0.363636363636,False,0.0,True,text," Now one can construct p  K so that (p, q)  L/K with ap,q  bp,q = {p0} as it is
"
13,5.76923076923,0.0,0.0,False,0.0,False,text," constructed in [Par13], Lemma 3.25(c). The remainder of the proof exactly follows Parks
"
17,4.41176470588,0.0588235294118,0.0196078431373,False,0.0,False,text," after Equation 3.6 (loc. cit.). The only dierence is that instances of the ideal (q) of the
"
14,3.5,0.0,0.142857142857,False,0.0,False,text," number eld K are replaced with the prime q of K in this proof.
"
3,1.66666666667,0.0,0.166666666667,False,0.0,False,text," p0 = 1.
"
5,3.8,0.0,0.0,False,0.0,False,text," chosen so that for each
"
1,1.0,0.0,0.0,False,0.0,False,text," p
"
14,5.07142857143,0.0,0.0,False,0.0,False,text," 3.4. Proof of main theorem. Our general strategy in proving Theorem 1.2 follows that
"
2,5.0,0.0,0.0,False,0.0,False,text," of [Koe16].
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
16,3.9375,0.0,0.09375,False,1.125,True,heading," Denition 3.18. Given some nite set of primes   S of K, consider the semi-local
"
7,2.85714285714,0.0,0.380952380952,False,0.0,False,text," subring R =Tp Op of K. Set
"
2,5.0,0.0,0.0,True,1.0,True,text," Lemma 3.19.
"
6,4.33333333333,0.166666666667,0.0,False,0.0,True,text," Proof. To see (1), observe that
"
13,1.76923076923,0.0,0.589743589744,False,0.0,False,text," eR = {x  K :6 y  J(R) with xy = 1}.
"
17,3.76470588235,0.835294117647,0.147058823529,False,0.0,False,body," (1) If J(R) is diophantine over K, then eR is dened by a universal formula in K.
"
14,3.28571428571,0.47619047619,0.321428571429,False,0.0,False,text," (2) eR =Sp Op, provided that  6= . In particular, fOp = Op.
"
15,1.46666666667,0.0,0.511111111111,False,0.0,False,text," eR = {x  K : x = 0 or x1  K \ J(R)}.
"
16,4.625,0.0,0.03125,False,0.0,True,text," Since J(R) is diophantine, its complement is dened by a universal formula, and thus so is
"
1,3.0,0.0,0.666666666667,False,0.0,False,text," eR.
"
18,3.27777777778,0.0,0.305555555556,False,0.0,True,text," Now we prove (2). To see that eR Sp Op, assume x 6Sp Op. This means that for
"
22,2.5,0.0,0.362121212121,False,0.0,False,text," all p  , vp(x)  0 and hence vp(x1)  0, giving x1 Tp Op = J(R). Hence x 6 eR.
"
16,1.8125,0.0,0.322916666667,False,0.0,False,text," vp(x  y)  1 and hence x  y 6= 1. Thus x  eR.
"
21,3.04761904762,0.0,0.138095238095,False,0.0,True,text," For the reverse inclusion, suppose x  Op for some p  . Then if y  J(R), we have that
"
10,3.2,0.0,0.115,False,0.0,True,text," Given a modulus m, let S(m) := {p : p|m}.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
18,3.5,0.662037037037,0.148148148148,True,1.0,True,text," Theorem 3.20. For any global function eld K and nite set of primes S  SK, with m
"
3,5.0,1.0,0.0,False,0.0,False,text," chosen as before,
"
6,4.33333333333,0.0,0.647727272727,False,0.0,True,text," OS = \pS(m)\SfOp  \6=(1,1) \pfR
"
3,2.66666666667,0.0,1.28571428571,False,0.0,False,text," p  \(p,q)K
"
1,1.0,0.0,1.0,False,0.0,False,text," ]
"
1,6.0,0.0,0.333333333333,False,0.0,True,text," R(1,1)
"
2,2.0,0.0,1.0,False,0.0,False,heading," p,q ,
"
12,4.25,0.833333333333,0.0833333333333,False,0.0,False,body," where  and K are the diophantine sets in the previous section.
"
21,2.80952380952,0.047619047619,0.257936507937,False,0.0,True,after_body," Proof. For p   and (p, q)  K, all of the sets P(p) and ap,q  bp,q are nonempty.
"
8,3.625,0.0,0.0,False,0.0,True,text," Thus the right hand side is equal to
"
3,4.0,0.0,0.541666666667,False,0.0,True,text," RS := \pS(m)\S
"
5,3.6,0.0,0.666666666667,False,0.0,True,text," Op  \6=(1,1) \p [pP(p)
"
1,2.0,0.0,0.0,False,0.0,False,text," 14
"
4,4.75,0.0,0.864285714286,False,0.0,True,text," Op  \(p,q)K [pap,qbp,q
"
1,6.0,0.0,0.333333333333,False,0.0,True,text," R(1,1)
"
1,3.0,0.0,1.0,False,0.0,False,text," p,q
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
19,3.26315789474,0.0,0.219298245614,False,0.0,True,text," To show RS is contained in OS, consider a prime p0 6 S. We need to show that any
"
21,3.42857142857,0.0,0.152380952381,False,0.0,False,text," x  RS is integral at p0. If p0|m, this is clear. If not, consider the image of p0 under L/K.
"
20,3.25,0.0,0.220238095238,False,0.0,True,text," First we assume L/K(p0) 6= (1, 1). Then we claim that we can choose p, p   such that
"
3,3.33333333333,0.0,0.388888888889,False,0.0,True,text," Op0 = [pP(p)
"
3,2.66666666667,0.0,0.5,False,0.0,True,text," Op  [pP(p)
"
1,3.0,0.0,0.666666666667,False,0.0,True,text," Op.
"
19,3.31578947368,0.0,0.149122807018,False,0.0,True,text," If this claim is true, then x  RS implies that vp0(x)  0. Suppose  = (1,1). Using
"
20,2.95,0.0,0.105,True,0.0,True,text," Lemma 3.14, we nd p   such that {p0} = P(p). Now let p1 be some other prime of
"
20,3.15,0.0,0.320238095238,False,0.0,True,text," K not dividing m with L/K(p1) = (1, 1), set S = {p1} and A := OS. Then using Lemma
"
25,2.52,0.0,0.114666666667,False,0.0,False,text," 3.8, we nd a prime q of K such that q  A is in the ideal class of (p0  A)1 in Cl(A) and
"
21,2.85714285714,0.0,0.27380952381,False,0.0,True,text," L/K(q) = (1, 1). There exists an element p  A such that (p0  A)(q  A) = pA. Then
"
18,2.77777777778,0.0,0.282407407407,False,0.0,False,text," p  (1,1), as p0, p1, and q do not divide m, P(p) = {p0, p1, q}, and
"
5,6.8,0.0,0.453333333333,False,0.0,True,text," L/K(p) = L/K(p0)L/K(p1)L/K(q) = (1,1).
"
18,3.55555555556,0.0,0.126543209877,False,0.0,True,text," Thus P(1,1)(p)  P(1,1)(p) = {p0} and the claim follows; the case of  = (1, 1) and
"
6,4.0,0.0,0.0666666666667,False,0.0,False,text,"  = (1,1) is entirely similar.
"
20,3.4,0.0,0.103571428571,False,0.0,True,text," If p0 satises L/K(p0) = (1, 1) then we have seen in Lemma 3.17 that there exist (p, q) 
"
15,3.6,0.0,0.333333333333,False,0.0,True,text," K such that {p0} = ap,q  bp,q (and consequently (p, q)  K), implying
"
1,10.0,0.0,1.1,False,0.0,False,text," [pap,qbp,q
"
3,2.33333333333,0.0,0.333333333333,False,0.0,True,text," Op = Op0.
"
9,3.77777777778,0.0,0.166666666667,False,0.0,True,text," Thus x is integral at primes outside of S.
"
14,5.07142857143,0.0,0.0714285714286,False,0.0,True,text," To show the reverse inclusion, we claim that membership in RS imposes no integrality
"
16,2.125,0.0,0.1796875,False,0.0,True,text," If p0  S, for any   Gal(L/K) and any p  , we have
"
6,3.5,0.0,0.0833333333333,False,0.0,False,text," condition at a prime in S.
"
22,2.72727272727,0.0,0.512121212121,False,0.0,False,text," p0 6 P(p). Additionally, p0 6 ap,q  bp,q for (p, q)  K as ap,q  bp,q  Im by Lemma
"
3,4.0,0.0,0.0,False,0.0,False,text," 3.17 part (2).
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
10,3.8,0.0,0.0,False,0.0,True,text," Now we are ready to prove our rst main theorem.
"
16,4.3125,0.692708333333,0.102678571429,True,1.0,True,text," Theorem 1.2. For any global function eld K with char(K) 6= 2, and any nonempty, nite
"
14,3.85714285714,0.843650793651,0.178571428571,False,0.0,False,text," set of primes S of K, OS is dened by a rst-order universal formula.
"
9,3.55555555556,0.111111111111,0.166666666667,False,0.0,True,text," Proof. Theorem 3.20 shows that for t  K,
"
6,1.83333333333,0.0,0.619047619048,False,0.0,False,text," t  OS  t \p|mfOp
"
3,3.0,0.0,0.833333333333,False,0.0,False,text,"  p ^6=(1,1)
"
7,0.857142857143,0.0,0.714285714286,False,0.0,False,text," (p 6   t  fR
"
2,1.0,0.0,0.5,False,0.0,False,text," p )
"
1,1.0,0.0,1.0,False,0.0,False,text," ]
"
1,6.0,0.0,0.333333333333,False,0.0,True,text," R(1,1)
"
2,2.0,0.0,1.0,False,0.0,False,text," p,q .
"
3,1.0,0.0,0.833333333333,False,0.0,False,text,"  p, q
"
7,1.14285714286,0.0,0.738095238095,False,0.0,False,text," (p, q) 6 K  t 
"
16,2.4375,0.0,0.3125,False,0.0,True,text," Given   Gal(L/K), p  , and (p, q)  K, we have that J(R
"
3,2.33333333333,0.0,0.333333333333,False,0.0,False,text," p,q ) are
"
16,4.0625,0.0,0.0625,False,0.0,False,text," diophantine by Lemmas 3.14 and 3.17. The sets  and K are diophantine by the same
"
12,6.33333333333,0.0,0.0,False,0.0,False,text," lemmas, so their complements are dened by a universal formula. Additionally, membership
"
4,3.25,0.0,0.34375,False,0.0,False,text," p ) and J(R(1,1)
"
11,4.45454545455,0.0,0.0909090909091,False,0.0,False,text," p is given by a universal formula, along with membership in
"
9,3.77777777778,0.0,0.111111111111,False,0.0,False,text," in OS can be given by a universal formula.
"
2,2.0,0.0,0.75,False,0.0,False,text," in fR
"
1,2.0,0.0,0.0,False,0.0,False,text," 15
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,1.0,0.0,1.0,False,0.0,False,text," ]
"
1,6.0,0.0,0.333333333333,False,0.0,True,text," R(1,1)
"
4,4.75,0.0,0.25,False,0.0,False,text," p,q . Hence membership
"
9,5.88888888889,0.0,0.0,False,0.0,False,text," 4. Non-squares and non-norms of global fields are diophantine
"
20,3.3,0.0,0.282142857143,False,0.0,True,text," Now we let K be a global eld with char(K) 6= 2. Throughout this section, x a, b, c, d
"
20,3.15,0.0,0.1,False,0.0,False,text," as in Lemmas 3.8 and 3.10 if K is a global function eld, and if K is a number eld,
"
19,3.63157894737,0.0,0.421052631579,False,0.0,False,text," choose a, b  K as in Proposition 3.19 of [Par13]. Additionally, we x c, d  K satisfying
"
18,3.55555555556,0.0,0.0555555555556,False,0.0,False,text," the same assumptions as in Lemma 3.10 but now in the case that K is a number eld.
"
17,4.41176470588,0.0,0.0,True,0.0,True,text," Corollary 3.20 in [Par13] is incorrect as stated, and has to be modied as in Corollary 3.11
"
15,5.0,0.0,0.0,False,0.0,False,text," of our paper. With this modication, the other results from [Par13] are correct as stated.
"
17,3.64705882353,0.0,0.176470588235,False,0.0,True,text," Set L := K(a,b) and x an admissible modulus m for L/K where m contains all the
"
18,4.11111111111,0.0,0.0833333333333,False,0.0,False,text," primes dividing (2abcd), and all real places if K is a number eld. In this section we prove
"
4,4.5,0.0,0.0,True,0.0,True,text," Theorems 1.4 and 1.3.
"
16,4.5,0.0,0.1875,False,0.0,False,text," 4.1. Non-squares. We begin by proving Theorem 1.4, i.e. that K \ K2 is diophantine over
"
20,3.4,0.0,0.275,False,0.0,True,text," K. We use the fact that x 6 K2 is equivalent to x being a non-square in a completion of
"
12,3.16666666667,0.0,0.0833333333333,False,0.0,True,text," K at some prime p, where p may be nite or innite.
"
18,3.5,0.0,0.138888888889,False,0.0,True,text," Suppose  is a real archimedean prime of K corresponding to an embedding  : K  R.
"
23,2.5652173913,0.0,0.246376811594,False,0.0,True,text," For x  K, we have that x is not a square in K if and only if (x)  0. Therefore we
"
4,6.25,0.0,0.0,False,0.0,False,text," require the following lemma:
"
18,3.44444444444,0.740740740741,0.111111111111,True,1.0,True,heading," Lemma 4.1. Suppose K is a number eld and that  is a real archimedean prime of K
"
14,3.07142857143,0.535714285714,0.142857142857,False,0.0,False,body," corresponding to an embedding  : K  Kp = R. Then the set
"
7,4.85714285714,0.928571428571,0.0714285714286,False,0.0,False,body," is diophantine over K. Moreover, the set
"
9,1.33333333333,0.0,0.796296296296,False,0.0,True,body," K := {x  K : (x)  0}
"
4,4.75,0.875,0.125,False,0.0,False,body," is diophantine over K.
"
10,2.6,0.4,0.5,False,0.0,False,after_body," {x  K : x is not totally positive }
"
19,3.42105263158,0.0526315789474,0.157894736842,False,0.0,True,text," Proof. Let p be a nite prime of K and let B be the quaternion algebra over K ramied
"
21,2.90476190476,0.0,0.166666666667,False,0.0,False,text," exactly at p and . Let Nrd : B  K denote the reduced norm map on B. Then by Facts
"
20,2.8,0.0,0.32380952381,False,0.0,True,text," I and II of [SH36], Nrd(B) = K . Let b1, b2, b3, b4 be a K-basis of B. Then
"
8,3.0,0.0,0.375,False,0.0,False,text," q(x1, x2, x3, x4) := Nrd  4Xi=1
"
1,5.0,0.0,1.0,False,0.0,False,text," xibi!
"
18,3.27777777778,0.0,0.314814814815,False,0.0,False,text," is a quadratic form in the variables x1, . . . , x4 with coecients in K, and
"
21,1.80952380952,0.0,0.750793650794,False,0.0,True,text," K = {x  K : a1, . . . , a4  K s.t. q(a1, a2, a3, a4) = x}.
"
15,4.8,0.0,0.233333333333,False,0.0,True,text," We conclude that K is diophantine over K. For an alternative proof, see [Den80], Lemma
"
1,3.0,0.0,0.0,False,0.0,False,text," 10.
"
20,3.45,0.0,0.35,False,0.0,True,text," Now we will prove the second statement. Let 1, . . . , r denote a complete set of repre-
"
16,4.5625,0.0,0.09375,False,0.0,False,text," sentatives of the inequivalent embeddings of K into R. The set of elements which are not
"
13,4.61538461538,0.0,0.214285714286,False,0.0,False,text," totally positive is diophantine over K, since it is the nite unionSi Ki.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
11,4.54545454545,0.0,0.0,False,0.0,True,text," The main lemma used in proving Theorem 1.4 is the following:
"
1,2.0,0.0,0.0,False,0.0,False,text," 16
"
13,3.38461538462,0.602564102564,0.126373626374,True,1.0,True,heading," Lemma 4.2. Let K be a global eld with char(K) 6= 2. Then
"
5,0.8,0.0,0.8,False,0.0,False,body," x 6 K2  
"
6,4.0,0.833333333333,0.166666666667,False,0.0,False,body," x is not totally positive, or
"
7,3.42857142857,0.714285714286,0.114285714286,False,0.0,False,body," vp(x) is odd for some p|m0, or
"
14,2.07142857143,0.142857142857,0.421428571429,False,0.0,False,body," p  (1,1) such that x  a  K2  (1 + J(R(1,1)
"
1,1.0,0.0,1.0,False,0.0,False,after_body," p
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," )).
"
11,4.72727272727,0.0,0.0757575757576,False,0.0,True,text," Here, m0 denotes the nite primes dividing m, and (1,1), R(1,1)
"
1,1.0,0.0,1.0,False,0.0,False,text," p
"
17,4.17647058824,0.0,0.0,False,0.0,True,text," Section 3.3. Before proving Lemma 4.2, we will show how to use it to prove Theorem 1.4.
"
7,2.0,0.0,0.0714285714286,False,0.0,False,text," , a, and m are as in
"
17,4.11764705882,0.411764705882,0.0,False,0.0,True,text," Proof of Theorem 1.4 from Lemma 4.2. We begin by showing the right side of the equiva-
"
19,3.57894736842,0.0,0.0526315789474,False,0.0,False,text," lence in Lemma 4.2 denes a diophantine subset of K. We claim that, for a prime p of K,
"
2,3.0,0.0,0.0,False,0.0,False,text," the set
"
22,3.04545454545,0.0,0.195454545455,False,0.0,False,text," is diophantine over K. To see this, x p  K with vp(p) = 1. Then vp(x) is odd if and only
"
15,2.4,0.0,0.333333333333,False,0.0,False,text," if x  p  K2  Op . This is diophantine over K since
"
7,2.14285714286,0.0,0.521428571429,False,0.0,False,text," {x  K : vp(x) is odd}
"
11,1.36363636364,0.0,0.568181818182,False,0.0,True,text," Op = Op  {x  K : x1  Op}.
"
16,4.4375,0.0,0.040625,False,0.0,True,text," Since only nitely many primes divide m0, the condition that vp(x) is odd for some p|m0
"
17,4.41176470588,0.0,0.0588235294118,False,0.0,False,text," is diophantine as well. As noted in Lemma 4.1, the condition that x is not totally positive
"
4,5.25,0.0,0.0,False,0.0,False,text," denes a diophantine set.
"
13,3.61538461538,0.0,0.0769230769231,False,0.0,True,text," If K is a global function eld, Lemma 3.14 parts (1) and (2)
"
15,4.66666666667,0.0,0.0,False,0.0,False,text," complete the argument that the right side of Lemma 4.2 denes a diophantine subset of
"
17,4.05882352941,0.0,0.0294117647059,False,0.0,True,text," K. The number eld case follows from parts (a) and (b) of Lemma 3.22 of [Par13]. Hence
"
9,3.88888888889,0.0,0.444444444444,True,0.0,True,text," Lemma 4.2 shows that K \ K2 is diophantine.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
15,4.26666666667,0.0,0.0,False,0.0,True,text," We are now left with proving Lemma 4.2, for which we need the following lemma.
"
1,1.0,0.0,1.0,False,0.0,False,text," p
"
1,1.0,0.0,1.0,False,0.0,False,heading," p
"
15,2.73333333333,0.691111111111,0.155555555556,False,0.0,False,body," , a, b, and m be dened as in Section 3.3. Let p  (1,1).
"
14,3.07142857143,0.714285714286,0.214285714286,False,0.0,False,body," )) if and only if there exists an element t  K such that
"
5,4.8,0.233333333333,0.166666666667,True,1.0,True,after_body," Lemma 4.3. Let (1,1), R(1,1)
"
10,1.9,0.1,0.35,False,0.0,True,body," Then x  a  K2  (1 + J(R(1,1)
"
21,3.19047619048,0.639682539683,0.118820861678,False,0.0,False,body," q  P(1,1)(p), vq(xt2) = 0 and the image of xt2 in the residue eld of q is not a square.
"
11,3.63636363636,0.0909090909091,0.29797979798,False,0.0,True,text," Proof. Since p  (1,1), we have that P(1,1)(p) 6= .
"
6,4.66666666667,0.0,0.0,False,0.0,True,text," In the function eld setting, this
"
16,4.375,0.0,0.0,False,0.0,False,text," follows from Lemma 3.14, and in the number eld setting, it follows from Lemma 3.22 of
"
5,4.4,0.0,0.0,False,0.0,False,text," [Par13]. We also have that
"
2,6.0,0.0,0.272727272727,False,0.0,False,text," = \qP(1,1)(p)
"
3,4.33333333333,0.0,0.181818181818,False,0.0,False,text," ) = \qP(1,1)(p)
"
1,8.0,0.0,0.5,False,0.0,True,text," J(R(1,1)
"
1,6.0,0.0,0.5,False,0.0,True,text," R(1,1)
"
1,3.0,0.0,0.666666666667,False,0.0,True,text," Oq,
"
1,4.0,0.0,0.5,False,0.0,False,text," qOq.
"
1,1.0,0.0,1.0,False,0.0,False,text," p
"
1,1.0,0.0,1.0,False,0.0,False,text," p
"
19,3.0,0.0,0.266666666667,False,0.0,True,text," Suppose there exists t  K as in the lemma. Let q  P(1,1)(p). Then xt2  a in
"
9,4.33333333333,0.0,0.218518518519,False,0.0,False,text," (Oq/q)/(Oq/q)2, since by our choice of a and b,
"
1,1.0,0.0,3.0,False,0.0,False,text," a
"
1,2.0,0.0,0.5,False,0.0,False,text," q2
"
2,1.0,0.0,1.5,False,0.0,False,text," , b
"
7,3.14285714286,0.0,0.460317460317,False,0.0,False,text," q2 = (q, K(a,b)/K) = (1, 1).
"
1,2.0,0.0,0.5,False,0.0,False,text," q2
"
2,2.0,0.0,0.125,False,0.0,True,text," Here 
"
4,2.75,0.0,0.333333333333,False,0.0,False,text," that xt2 = as2
"
17,3.52941176471,0.0,0.0882352941176,False,0.0,False,text," is the degree 2 power residue symbol for K. Thus there is some sq  (Oq) such
"
17,3.35294117647,0.0,0.137254901961,False,0.0,False,text," q mod q; using the Chinese remainder theorem we nd an s so that xt2 = as2
"
1,2.0,0.0,0.0,False,0.0,False,text," 17
"
23,3.04347826087,0.0,0.11884057971,False,0.0,False,text," mod q for each q. Since q := xt2  as2  q for each q  P(1,1)(p), it is in their intersection.
"
1,4.0,0.0,0.0,False,0.0,True,text," Thus
"
21,3.14285714286,0.0,0.214285714286,False,0.0,True,text," We claim x is in a  K2  (1 +TqP(1,1)(p) qOq). Let q  P(1,1)(p). Then vq(a) = 0 because
"
20,3.6,0.0,0.0733333333333,False,0.0,False,text," (a) is only divisible by primes dividing m and q  Im. Additionally, vq(s) = 0 and vq(q)  1,
"
12,2.75,0.0,0.25,False,0.0,False,text," because s  Oq and q  q. The claim follows as
"
7,3.0,0.0,0.418650793651,False,0.0,False,text," x = a  (s/t)2(1 + q/(as2)).
"
9,2.55555555556,0.0,0.198765432099,False,0.0,False,text," vq(q/as2)  1  vq(a)  2vq(s)  1.
"
19,3.63157894737,0.0,0.278229665072,False,0.0,True,text," For the other implication, write x = at2(1 + j) with t 6= 0 and j TqP(1,1)(p) qOq. Then
"
20,3.4,0.0,0.1875,False,0.0,False,text," for each q  P(p), and x/t2  a modulo q for q  P(1,1)(p). Finally, by construction, a is
"
11,4.27272727273,0.0,0.0363636363636,False,0.0,False,text," a non-square in the completion at any prime q  P(1,1)(p).
"
9,3.0,0.0,0.174074074074,False,0.0,False,text," vq(x/t2) = vq(a(1 + j)) = vq(a) = 0
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
5,3.8,0.0,0.0,False,0.0,True,text," We now prove Lemma 4.2:
"
14,4.42857142857,0.285714285714,0.0714285714286,False,0.0,True,text," Proof of Lemma 4.2. For the forward implication, suppose x is not a square.
"
4,2.0,0.0,0.25,False,0.0,True,text," If x is not
"
19,3.94736842105,0.0,0.0552631578947,False,0.0,False,text," totally positive, or vp(x) is odd for some p|m, we are done, so assume that vp(x) is even for
"
15,4.73333333333,0.0,0.0888888888889,False,0.0,False,text," each p|m and that x is totally positive. Using weak approximation, we may assume that
"
20,3.55,0.0,0.0325,False,0.0,False,text," in fact vp(x) = 0 for each p|m. This does not change the truth value of either side of the
"
15,5.13333333333,0.0,0.0666666666667,False,0.0,False,text," implication in Lemma 4.2, as both statements are invariant under multiplying x by a square.
"
21,3.19047619048,0.0,0.130687830688,False,0.0,True,text," What we will now show is that there is a p  (1,1) such that P(1,1)(p) = {q}, vq(x) = 0,
"
18,3.88888888889,0.0,0.0555555555556,False,0.0,False,text," and such that x modulo q is not a square. Together with Lemma 4.3, this will imply that
"
9,1.66666666667,0.0,0.388888888889,False,0.0,False,text," x  a  K2  (1 + J(R(1,1)
"
18,3.83333333333,0.0,0.111111111111,False,0.0,True,text," As K(x) is a degree 2 extension of K unramied at all p|m, it is linearly disjoint from
"
15,4.2,0.0,0.222222222222,False,0.0,True,text," L = K(a,b) over K. Let  be the nontrivial automorphism of K(x)/K and consider
"
15,4.4,0.0,0.163636363636,False,0.0,False,text," (, (1, 1))  Gal(K(x)/K)  Gal(L/K). By the Chebotarev Density Theorem, there is a
"
16,4.625,0.0,0.166666666667,False,0.0,False,text," prime q of K so that its associated Frobenius automorphism is (, (1, 1)). The restriction
"
6,4.33333333333,0.0,0.125,False,0.0,False,text," of this automorphism to K(x) is
"
1,3.0,0.0,0.0,False,0.0,False,text," )).
"
1,1.0,0.0,1.0,False,0.0,False,text," p
"
17,4.17647058824,0.0,0.0941176470588,False,0.0,False,text," implying q does not split completely in K(x). Hence x is not a square in the completion
"
9,2.88888888889,0.0,0.222222222222,False,0.0,False,text," of K at q. The restriction to L is
"
4,3.0,0.0,0.270833333333,False,0.0,False,text,"  = (q, K(x)/K),
"
5,3.8,0.0,0.38,False,0.0,False,text," (1, 1) = (q, K(a,b)/K),
"
19,3.73684210526,0.0,0.0751879699248,False,0.0,False,text," so we have that q  P(1,1). If K is a global function eld, Lemma 3.14 implies there exists
"
18,3.77777777778,0.0,0.225925925926,False,0.0,False,text," an element p  K so that {q} = P(1,1)(p). In the number eld setting, this follows from
"
18,4.0,0.0,0.0555555555556,True,0.0,True,text," Lemma 3.22 in [Par13]. This is the desired element p and prime q, and nishes the rst half
"
3,3.66666666667,0.0,0.0,False,0.0,False,text," of the proof.
"
17,3.94117647059,0.0,0.141176470588,False,0.0,True,text," For the reverse implication, suppose that there is an element p  (1,1) such that x 
"
7,2.0,0.0,0.357142857143,False,0.0,False,text," a  K2  (1 + J(R(1,1)
"
16,3.375,0.0,0.135416666667,False,0.0,False,text," )). By Lemma 4.3 there exists t 6= 0 such that xt2 is a non-square in
"
19,3.78947368421,0.0,0.108771929825,False,0.0,False,text," the completion of K at each prime q  P(1,1)(p). This implies xt2 itself is not a square in
"
5,2.2,0.0,0.833333333333,False,0.0,True,text," K, i.e. x 6 K2.
"
1,1.0,0.0,1.0,False,0.0,False,text," p
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,2.0,0.0,0.0,False,0.0,False,text," 18
"
17,4.0,0.0,0.0966386554622,False,0.0,False,text," 4.2. Non-norms. Let K be a global eld with char(K) 6= 2. To prove Theorem 1.3, which
"
4,4.0,0.0,0.0,False,0.0,False,text," states that the set
"
14,1.92857142857,0.0,0.503571428571,False,0.0,False,text," {(x, y)  K  K : x is not a norm of K(y)}
"
10,4.4,0.0,0.05,False,0.0,False,text," is diophantine over K, we use the Hasse norm theorem:
"
6,4.16666666667,0.0,0.125,False,0.0,False,text," for a cyclic extension L/K, an
"
23,3.17391304348,0.0,0.0869565217391,False,0.0,False,text," element of K is a (relative) norm of an element of L if and only if it is a local norm in every
"
9,3.77777777778,0.0,0.0555555555556,False,0.0,False,text," completion of K. We will use the fact that
"
22,2.40909090909,0.0,0.252272727273,False,0.0,False,text," (x, y)p = 1  x is not a local norm of K(y)  y is not a local norm of K(x).
"
17,4.05882352941,0.0,0.0294117647059,False,0.0,True,text," We begin by establishing that, given a nite or innite prime p of K, the collection of
"
23,2.69565217391,0.0,0.300724637681,False,0.0,False,text," pairs (x, y)  K  K such that x is not a local norm in the completion of K(y) at p is
"
3,5.66666666667,0.0,0.166666666667,False,0.0,False,text," diophantine over K.
"
17,4.11764705882,0.0,0.0,False,0.0,True,text," First we need the following lemma, which will be used both in the proof of Theorem 4.5
"
6,4.66666666667,0.0,0.0,False,0.0,False,text," and later in proving Theorem 1.3.
"
23,2.60869565217,0.489130434783,0.267391304348,True,1.0,True,heading," Lemma 4.4. Let p be a nite prime of K with |Fp| odd. Fix p, s  K so that vp(p) = 1
"
23,2.86956521739,0.666666666667,0.154037267081,False,0.0,False,body," and vp(s) = 0 so that redp(s) is not a square in the residue eld of p. Then for x, y  K,
"
8,2.375,0.5,0.25,False,0.0,False,body," (x, y)p = 1 if and only if
"
21,1.19047619048,0.047619047619,0.37619047619,False,0.0,False,body," (x  p  K2  Op )  (y or  xy  s  K2  (1 + pOp))
"
21,1.2380952381,0.047619047619,0.404761904762,False,0.0,False,after_body," (y  p  K2  Op )  (x or  xy  s  K2  (1 + pOp)).
"
3,3.66666666667,0.0,0.777777777778,False,0.0,False,text," yvp(x) |Fp |1
"
17,2.52941176471,0.0,0.210084033613,False,0.0,False,text," 2 = 1 or vice versa. Then vp(x/p) is even and x/p  K2  Op .
"
18,4.05555555556,0.0555555555556,0.0833333333333,False,0.0,True,text," Proof. Assume that (x, y)p = 1. From the formula for the Hilbert symbol in Section 3.1, at
"
20,3.85,0.0,0.12,False,0.0,False,text," least one of x or y must have odd valuation at p, so without loss of generality, assume vp(x) is
"
16,4.8125,0.0,0.182291666667,False,0.0,False,text," odd. As (x, y)p = 1, the formula for the Hilbert symbol implies ((1)vp(x)vp(y))(|Fp|1)/2 = 1
"
3,4.33333333333,0.0,0.25,False,0.0,False,text," and redp xvp(y)
"
7,4.57142857143,0.0,0.107142857143,False,0.0,False,text," p-adic unit. In this case, redp xvp(y)
"
3,3.66666666667,0.0,0.777777777778,False,0.0,False,text," yvp(x) |Fp |1
"
1,1.0,0.0,1.0,False,0.0,False,text," 2
"
2,7.5,0.0,0.3,False,0.0,False,text,"  xvp(y)yvp(x)yt2
"
19,3.52631578947,0.0,0.214035087719,False,1.0,True,text," Case 1. If vp(y) is even, then using weak approximation, choose t  K so that yt2 is a
"
11,3.45454545455,0.0,0.18648018648,False,0.0,False,text," 2 = 1 since (1)vp(x)vp(y) = 1. We claim that yt2
"
1,26.0,0.0,0.423076923077,False,0.0,False,text," =(x(vp(y))/2y(1vp(x))/2t)2
"
8,4.5,0.0,0.0,False,0.0,False,text," is a non-square modulo p. This follows from
"
20,3.5,0.0,0.0333333333333,False,0.0,True,text," Since yt2 is not a square mod p, an argument similar to the one in the proof of Lemma 4.3
"
11,1.90909090909,0.0,0.290909090909,False,0.0,False,text," shows that y  s  K2  (1 + pOp).
"
17,4.29411764706,0.0,0.0529411764706,False,1.0,True,text," Case 2. Suppose vp(y) is odd. We claim that, possibly after multiplying by a square of K,
"
11,3.63636363636,0.0,0.136363636364,False,0.0,False,text," xy is not a square modulo p. This would imply that
"
1,1.0,0.0,1.0,False,0.0,False,text," 2
"
2,1.5,0.0,0.25,False,0.0,False,text," = 1.
"
1,1.0,0.0,0.0,False,0.0,False,text," p
"
1,1.0,0.0,0.0,False,0.0,False,text," p
"
7,2.14285714286,0.0,0.461904761905,False,0.0,False,text," xy  s  (K)2(1 + pOp),
"
19,3.47368421053,0.0,0.157894736842,False,0.0,False,text," which is what we want to show. To prove the claim, use weak approximation to nd t  K
"
15,5.2,0.0,0.119230769231,False,0.0,False,text," such that vp(xyt2) = 0. The following calculation shows xvp(y)/yvp(x) and xyt2 have the same
"
6,4.5,0.0,0.0,False,0.0,False,text," 2-power residue for the prime p:
"
2,8.0,0.0,0.3125,False,0.0,False,text,"  xvp(y)yvp(x)xyt2
"
1,1.0,0.0,0.0,False,0.0,False,text," p
"
1,1.0,0.0,1.0,False,0.0,False,text," 2
"
2,14.0,0.0,0.685185185185,False,0.0,False,text," = (x(vp(y)+1)/2y(1vp(x))/2t)2
"
1,1.0,0.0,0.0,False,0.0,False,text," p
"
1,1.0,0.0,1.0,False,0.0,False,text," 2
"
2,1.5,0.0,0.25,False,0.0,False,text," = 1.
"
21,3.42857142857,0.0,0.0992063492063,False,0.0,True,text," If |Fp| is 1 modulo 4, then 1 is a square in Fp. From the formula for the Hilbert symbol, we
"
19,4.10526315789,0.0,0.0704453441296,False,0.0,False,text," must have that xvp(y)/yvp(x) is not a square in the residue eld of p, and hence neither is xyt2.
"
1,2.0,0.0,0.0,False,0.0,False,text," 19
"
19,3.89473684211,0.0,0.171052631579,False,0.0,True,text," If |Fp| is 3 mod 4, then considering the formula for (x, y)p again, we have (1)(|Fp|1)/2 = 1
"
21,3.33333333333,0.0,0.178571428571,False,0.0,False,text," and thus (x, y)p = 1 implies xyt2 is a square modulo p. But since 1 is not a square modulo
"
21,2.7619047619,0.0,0.211904761905,False,0.0,False,text," p, this implies xyt2 is not a square modulo p, and hence xy  a  K2  (1 + pOp).
"
27,2.22222222222,0.0,0.281481481481,False,0.0,True,text," Conversely, if x  p  K2  Op , then vp(x) is odd. If y  s  K2  (1 + pOp), then for some
"
24,2.41666666667,0.0,0.265277777778,False,0.0,False,text," t  K, yt2 is a p-adic unit and is a non-square modulo p. If xy  s  K2  (1 + pOp),
"
18,4.05555555556,0.0,0.138888888889,False,0.0,False,text," then, possibly after multiplying by a square of K, xy is a p-adic unit and is a non-square
"
10,3.7,0.0,0.188095238095,False,0.0,False,text," modulo p. Hence (x,xy)p = 1. Since (x,x)p = 1,
"
6,2.83333333333,0.0,0.452380952381,False,0.0,False,text," (x, y)p = (x,xy)p = 1.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
22,2.63636363636,0.541666666667,0.261363636364,True,1.0,True,heading," Theorem 4.5. Let p be a nite or real innite prime of K. The set {(x, y)  K  K :
"
8,3.5,0.4375,0.3125,False,0.0,False,body," (x, y)p = 1} is diophantine over K.
"
19,3.68421052632,0.0526315789474,0.131578947368,False,0.0,True,text," Proof. First assume p corresponds to a real archimedean absolute value on K. Let  : K  R
"
20,3.25,0.0,0.2,False,0.0,False,text," be the corresponding embedding of K into Kp = R. Then (x, y)p = 1 if and only if the
"
23,2.78260869565,0.0,0.152173913043,False,0.0,False,text," equation xs2 + yt2 = 1 has no solutions in R  R, which holds if and only if (x)  0 and
"
10,4.5,0.0,0.0666666666667,False,0.0,False,text," (y)  0. These conditions are diophantine by Lemma 4.1.
"
19,3.47368421053,0.0,0.0657894736842,False,0.0,True,text," Now suppose p is a nite prime of K. If |Fp| is odd, the lemma follows from Lemma 4.4
"
16,4.875,0.0,0.03125,False,0.0,False,text," since all the sets appearing are diophantine over K. Since our statements are only for global
"
19,3.47368421053,0.0,0.152255639098,False,0.0,False,text," elds K with char(K) 6= 2, the only remaining case is that K is a number eld and p|2.
"
6,1.83333333333,0.0,0.0,False,0.0,False,text," . Let  be a uni-
"
17,4.05882352941,0.0,0.0980392156863,False,0.0,False,text," formizer for p and let e be the absolute ramication index, meaning ()e = (2). Then if
"
21,2.85714285714,0.0,0.150793650794,False,0.0,False,text,"   Rp is in 1 + p2e+1, it is a square in Rp by Hensels Lemma. We conclude that R2
"
1,2.0,0.0,0.0,False,0.0,False,text," is
"
18,3.83333333333,0.0,0.0648148148148,False,0.0,False,text," open in the pronite group Rp since it contains 1 + p2e+1, a neighborhood of 1. As open
"
11,4.90909090909,0.0,0.0909090909091,False,0.0,False,text," subgroups of compact groups have nite index, we conclude that R2
"
7,2.57142857143,0.0,0.142857142857,False,0.0,False,text," p has nite index in Rp .
"
16,3.3125,0.0,0.0625,False,0.0,False,text," ] is nite, we now just need to observe that squares of Kp are of the
"
6,2.5,0.0,0.277777777778,False,0.0,True,text," To see that [Kp : K2
"
8,1.875,0.0,0.5,False,0.0,False,text," form s  2k where s  R2
"
2,1.0,0.0,0.0,False,0.0,False,text," p .
"
15,2.73333333333,0.0,0.402592592593,False,0.0,False,text," p2e+1Op). For x  Si, y  Sj we have (x, y)p = (si, sj)p.
"
17,2.58823529412,0.0,0.509803921569,False,0.0,True,text," Let s1, . . . , sn  K be a set of representatives for Kp /K2
"
3,3.0,0.0,0.0,False,0.0,True,text," Now we dene
"
10,1.8,0.0,0.3,False,0.0,False,text," and dene Sj := sj  K2  (1 +
"
13,4.0,0.0,0.153846153846,False,0.0,True,text," First we show that there are only nitely many elements in Kp /K2
"
1,1.0,0.0,0.0,False,0.0,False,text," p
"
1,1.0,0.0,0.0,False,0.0,False,text," p
"
1,1.0,0.0,0.0,False,0.0,False,text," p
"
1,1.0,0.0,0.0,False,0.0,False,text," p
"
3,6.33333333333,0.0,0.388888888889,False,0.0,True,text," Sp := [i,j:(si,sj)p=1
"
3,1.66666666667,0.0,0.666666666667,False,0.0,True,text," Si  Sj.
"
23,3.0,0.0,0.217391304348,False,0.0,True,text," Then (x, y)p = 1 if and only if (x, y)  Sp. Each set Si is diophantine over K, and the nite
"
14,5.5,0.0,0.0714285714286,False,0.0,True,text," Cartesian product of diophantine sets is again diophantine. Thus Sp is diophantine over K.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
14,3.5,0.0,0.117346938776,False,0.0,True,text," Now we prove Theorem 1.3 for a global eld K with char(K) 6= 2.
"
18,3.55555555556,0.222222222222,0.0972222222222,False,0.0,True,text," Proof of Theorem 1.3. By the Hasse norm principle, x is not a norm in K(y) if and
"
22,2.59090909091,0.0,0.151515151515,False,0.0,False,text," only if (x, y)p = 1 for some nite or real innite prime p of K. For  6= (1, 1) 
"
19,2.63157894737,0.0,0.394987468672,False,0.0,True,text," Gal(K(a,b)/K), let s = a if  = (1,1) and s = b if  = (1,1). We claim
"
15,3.73333333333,0.0,0.133333333333,False,0.0,False,text," that (x, y)p = 1 if and only if one of the following conditions holds:
"
9,2.22222222222,0.0,0.203703703704,False,0.0,False,text,"   p|m such that (x, y)p = 1,
"
1,2.0,0.0,0.0,False,0.0,False,text," 20
"
7,2.42857142857,0.0,0.357142857143,False,0.0,False,text,"  W6=(1,1) p   such that
"
7,1.0,0.0,0.571428571429,False,0.0,False,body," (x  p  K2  (R
"
7,1.0,0.0,0.642857142857,False,0.0,False,text," (y  p  K2  (R
"
7,1.71428571429,0.0,0.469387755102,False,0.0,False,text," (x  p  K2  (R(1,1)
"
7,1.71428571429,0.0,0.540816326531,False,0.0,False,text," (y  p  K2  (R(1,1)
"
10,2.2,0.0,0.378571428571,False,0.0,False,text,"  (p, q)  K such that q  (R(1,1)
"
3,2.33333333333,0.0,0.666666666667,False,0.0,False,text," p,q ) and
"
2,2.0,0.0,0.666666666667,False,0.0,False,text," p )))
"
15,1.2,0.0,0.466666666667,False,0.0,False,text," p ))  (y or  xy  s  K2  (1 + J(R
"
2,2.5,0.0,0.75,False,0.0,False,text," p ))),
"
15,1.2,0.0,0.466666666667,False,0.0,False,text," p ))  (x or  xy  s  K2  (1 + J(R
"
2,3.0,0.0,0.666666666667,False,0.0,False,text," p,q )))
"
15,1.66666666667,0.0,0.358333333333,False,0.0,False,text," p,q ))  (y or  xy  q  K2  (1 + J(R(1,1)
"
2,3.5,0.0,0.75,False,0.0,False,text," p,q ))).
"
15,1.66666666667,0.0,0.358333333333,False,0.0,False,text," p,q ))  (x or  xy  q  K2  (1 + J(R(1,1)
"
5,2.0,0.0,0.5,False,0.0,False,text," p = Op and J(R
"
14,5.07142857143,0.0,0.0,False,0.0,True,text," This will imply the theorem, because we have already shown that the above conditions
"
17,4.17647058824,0.0,0.0588235294118,False,0.0,False,text," dene diophantine sets. We will rst prove the forward implication. If x is not a norm in
"
11,3.90909090909,0.0,0.0909090909091,False,0.0,False,text," contains all real innite primes if K is a number eld.
"
22,2.95454545455,0.0,0.156060606061,False,0.0,True,text," K(y), there is a prime p of K such that (x, y)p = 1. If p|m we are done; recall that m
"
19,3.31578947368,0.0,0.105263157895,False,0.0,True,text," Now assume p  Im and that L/K(p) =  6= (1, 1). We claim that the second condition
"
19,3.47368421053,0.0,0.127192982456,False,0.0,False,text," holds. We can nd p   such that P(p) = {p} as before. Corollary 3.11 and the denition
"
2,1.5,0.0,1.0,False,0.0,False,text," of R
"
3,2.33333333333,0.0,1.0,False,0.0,False,text," p imply R
"
16,2.6875,0.0,0.328125,False,0.0,False,text," p ) = pOp. By setting p := p and s := s, Lemma 4.4 implies
"
17,4.52941176471,0.0,0.0823529411765,False,0.0,False,text," that the second condition holds because vp(p) is odd and s, by construction, is a p-adic unit
"
19,3.47368421053,0.0,0.149122807018,False,0.0,False,text," which is not a square modulo p. For example, if  = (1,1), then s = b. The fractional
"
19,3.42105263158,0.0,0.126315789474,False,0.0,False,text," ideal (b) is coprime to m, and L/K(p) = (1,1) implies that b is not a square mod p.
"
19,3.57894736842,0.0,0.0789473684211,False,0.0,True,text," Now assume p  Im with L/K(p) = (1, 1). We claim that the third condition holds in this
"
22,3.18181818182,0.0,0.143939393939,False,0.0,False,text," case. We will rst show that we can nd (p, q)  K with the stated properties if K is a global
"
22,3.0,0.0,0.257575757576,False,0.0,False,text," function eld. By Lemma 3.17, there is a (p, q)  K with ap,q  bp,q = {p}. In fact, q can
"
23,3.13043478261,0.0,0.122463768116,False,0.0,False,text," be chosen so that vp(q) = 0, q is not a square modulo p, and such that P(q) = {q, p0}. Here, q
"
19,3.26315789474,0.0,0.234586466165,False,0.0,False,text," and p0 are primes with L/K(q) = (1,1) and L/K(p0) = (1, 1). Then q  Op = (R(1,1)
"
2,2.0,0.0,1.0,False,0.0,False,text," p,q )
"
17,4.35294117647,0.0,0.0294117647059,False,0.0,False,text," by Denition 3.12. By the formula for the Hilbert symbol, vp(ap) is odd, and since p cannot
"
9,4.33333333333,0.0,0.109259259259,False,0.0,False,text," divide (a), we conclude vp(p) is odd. As R(1,1)
"
7,2.71428571429,0.0,0.178571428571,False,0.0,False,text," p,q ) = pOp, we can apply
"
6,2.83333333333,0.0,0.25,True,0.0,True,text," Lemma 4.4 with s := q.
"
20,2.9,0.0,0.158333333333,False,0.0,True,text," If K is a number eld, then by Lemma 3.25 in [Par13], we can nd (p, q)  K such
"
20,3.4,0.0,0.139583333333,False,0.0,False,text," that (q) is a prime ideal with L/K((q)) = (1,1), q is not a square in Kp, and such that
"
16,4.3125,0.0,0.15625,False,0.0,False,text," ap,q  bp,q = {p}. A similar argument as above shows that the second condition holds.
"
17,4.11764705882,0.0,0.0,False,0.0,True,text," Now we will prove that if one of the three conditions above holds, then for some prime
"
21,3.2380952381,0.0,0.15873015873,False,0.0,False,text," p, (x, y)p = 1. Suppose the second condition holds for some  6= (1, 1). If K is a global
"
16,4.0625,0.0,0.125,False,0.0,False,text," function eld, P(p) 6=  by Lemma 3.14 (2), so P(p) contains some prime p. Assume,
"
5,5.6,0.0,0.0,False,0.0,False,text," without loss of generality, that
"
5,3.4,0.0,0.375,False,0.0,False,text," p,q = Op and J(R(1,1)
"
7,1.0,0.0,0.571428571429,False,0.0,False,text," (x  p  K2  (R
"
15,1.2,0.0,0.466666666667,False,0.0,False,text," p ))  (y or  xy  s  K2  (1 + J(R
"
2,2.5,0.0,0.75,False,0.0,False,text," p ))).
"
18,4.22222222222,0.0,0.183333333333,False,0.0,True,text," Since vp(p) is odd, vp(x) is odd, too. Also, either y or xy is, possibly after multiplying by
"
20,3.3,0.0,0.225,False,0.0,False,text," a square of K, a non-square in Kp since L/K(p) =  implies s is a non-square in Kp. By
"
19,3.63157894737,0.0,0.131578947368,True,0.0,True,text," Lemma 4.4, this implies that (x, y)p = 1. If K is a number eld, an application of Lemma
"
21,3.28571428571,0.0,0.119047619048,False,0.0,False,text," 3.22 (b) in [Par13] and a similar argument show that (x, y)p = 1 for a nite prime p of K.
"
19,3.63157894737,0.0,0.140350877193,False,0.0,True,text," We now prove that the third condition implies that (x, y)p = 1 for some p with L/K(p) =
"
19,3.94736842105,0.0,0.0701754385965,False,0.0,False,text," (1, 1). The argument is similar to the one in the second condition. If K is a global function
"
20,3.15,0.0,0.233333333333,False,0.0,False,text," eld, (p, q)  K implies that ap,q  bp,q 6=  and contains some prime p by Lemma 3.17
"
23,2.91304347826,0.0,0.239130434783,False,0.0,False,text," part (2). Then because q  (Rp,q) and (ap, q)p = (bp, q)p = 1, q is not a square mod p and
"
1,2.0,0.0,0.0,False,0.0,False,text," 21
"
20,3.35,0.0,0.145,False,0.0,False,text," vp(p) must be odd. Again by Lemma 4.4, this implies that (x, y)p = 1. If K is a number
"
14,4.85714285714,0.0,0.0,False,0.0,False,text," eld, the same argument, along with Lemma 3.25 (b) from [Par13], proves the claim.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,15.0,0.0,0.0,False,0.0,True,text," Acknowledgments
"
12,5.75,0.0,0.0,False,0.0,True,text," The rst author was partially supported by National Science Foundation grant DMS-
"
12,6.41666666667,0.0,0.0,False,0.0,False,text," 1056703. The second author was partially supported by National Science Foundation grants
"
3,8.66666666667,0.0,0.0,False,0.0,True,text," DMS-1056703 and CNS-1617802.
"
1,10.0,0.0,0.0,False,0.0,True,text," References
"
1,6.0,0.0,0.0,False,0.0,False,text," [AT68]
"
13,6.84615384615,0.0,0.00961538461538,False,0.0,False,text," [CTVG15] Jean-Louis Colliot-Thel`ene and Jan Van Geel. Le complementaire des puissances n-i`emes dans
"
15,4.86666666667,0.212698412698,0.0,False,0.0,True,text," E. Artin and J. Tate. Class eld theory. W. A. Benjamin, Inc., New York-Amsterdam, 1968.
"
1,7.0,0.0,0.0,False,0.0,False,text," [Den79]
"
1,7.0,0.0,0.0,False,0.0,False,text," [Den80]
"
1,7.0,0.0,0.0,False,0.0,False,text," [Dit16]
"
12,6.33333333333,0.152777777778,0.0,False,0.0,False,text," un corps de nombres est un ensemble diophantien. Compos. Math., 151(10):19651980, 2015.
"
14,5.92857142857,0.142857142857,0.0,False,0.0,True,text," J. Denef. The Diophantine problem for polynomial rings of positive characteristic. In Logic Col-
"
14,5.42857142857,0.583333333333,0.0,False,0.0,False,text," loquium 78 (Mons, 1978), volume 97 of Stud. Logic Foundations Math., pages 131145. North-
"
4,7.75,0.0,0.0,False,0.0,True,text," Holland, Amsterdam-New York, 1979.
"
14,5.92857142857,0.271428571429,0.0,False,0.0,True,text," J. Denef. Diophantine sets over algebraic integer rings. II. Trans. Amer. Math. Soc., 257(1):227
"
2,4.5,0.0,0.0,False,0.0,False,text," 236, 1980.
"
11,7.72727272727,0.0855614973262,0.0,False,0.0,True,text," P. Dittmann. Irreducibility of Polynomials over Number Fields is Diophantine. arXiv:1601.07829,
"
2,7.0,0.0,0.0,False,0.0,False,text," 2016. Preprint.
"
14,6.07142857143,0.0,0.0,False,0.0,False,text," [DPR61] Martin Davis, Hilary Putnam, and Julia Robinson. The decision problem for exponential dio-
"
1,7.0,0.0,0.0,False,0.0,False,text," [Eis03]
"
1,7.0,0.0,0.0,False,0.0,False,text," [Koe16]
"
1,7.0,0.0,0.0,False,0.0,False,text," [Mat70]
"
1,7.0,0.0,0.0,False,0.0,False,text," [Maz92]
"
1,7.0,0.0,0.0,False,0.0,False,text," [Mil06]
"
1,7.0,0.0,0.0,False,0.0,False,text," [Par13]
"
1,7.0,0.0,0.0,False,0.0,False,text," [Phe91]
"
8,6.0,0.46875,0.0,False,0.0,False,text," phantine equations. Ann. of Math. (2), 74:425436, 1961.
"
12,6.75,0.0,0.0,False,0.0,True,text," Kirsten Eisentrager. Hilberts Tenth Problem for algebraic function elds of characteristic 2.
"
5,6.4,0.606666666667,0.0,False,0.0,True,text," Pacic J. Math., 210(2):261281, 2003.
"
12,5.08333333333,0.3125,0.125,False,0.0,True,text," Jochen Koenigsmann. Dening Z in Q. Ann. of Math. (2), 183(1):7393, 2016.
"
13,6.07692307692,0.292307692308,0.0,False,0.0,True,text," Yu. V. Matiyasevich. The Diophantineness of enumerable sets. Dokl. Akad. Nauk SSSR, 191:279
"
2,4.5,0.0,0.0,False,0.0,False,text," 282, 1970.
"
11,6.45454545455,0.166666666667,0.0,False,0.0,True,text," Barry Mazur. The topology of rational points. Experiment. Math., 1(1):3545, 1992.
"
10,6.9,0.288888888889,0.0,False,0.0,True,text," J.S. Milne. Arithmetic Duality Theorems. BookSurge, LLC, second edition, 2006.
"
15,5.0,0.0,0.0,False,0.0,True,text," Jennifer Park. A universal rst-order formula dening the ring of integers in a number eld.
"
5,6.6,0.566666666667,0.0,False,0.0,True,text," Math. Res. Lett., 20(5):961980, 2013.
"
14,5.85714285714,0.0714285714286,0.0,False,0.0,True,text," Thanases Pheidas. Hilberts tenth problem for elds of rational functions over nite elds. Invent.
"
3,7.0,0.277777777778,0.0,False,0.0,True,text," Math., 103(1):18, 1991.
"
12,7.66666666667,0.0,0.0,False,0.0,False,text," [Poo09a] Bjorn Poonen. Characterizing integers among rational numbers with a universal-existential for-
"
6,6.16666666667,0.472222222222,0.0,False,0.0,False,text," mula. Amer. J. Math., 131(3):675682, 2009.
"
16,4.9375,0.177083333333,0.0,False,0.0,False,text," [Poo09b] Bjorn Poonen. The set of nonsquares in a number eld is Diophantine. Math. Res. Lett.,
"
1,7.0,0.0,0.0,False,0.0,False,text," [Rob49]
"
2,9.0,0.0,0.0,False,0.0,False,text," 16(1):165170, 2009.
"
12,6.75,0.236111111111,0.0,False,0.0,True,text," Julia Robinson. Denability and decision problems in arithmetic. J. Symbolic Logic, 14:98114,
"
1,5.0,0.0,0.0,False,0.0,False,text," 1949.
"
14,6.21428571429,0.130952380952,0.0,False,0.0,False,text," [Ros87] Michael Rosen. The Hilbert class eld in function elds. Exposition. Math., 5(4):365378, 1987.
"
15,5.66666666667,0.594444444444,0.0,False,0.0,False,text," [Ros02] Michael Rosen. Number theory in function elds, volume 210 of Graduate Texts in Mathematics.
"
4,7.25,0.0,0.0,False,0.0,True,text," Springer-Verlag, New York, 2002.
"
16,5.375,0.1875,0.0,False,0.0,False,text," [Rum80] R. S. Rumely. Undecidability and denability for the theory of global elds. Trans. Amer. Math.
"
1,7.0,0.0,0.0,False,0.0,False,text," [Ser79]
"
1,6.0,0.0,0.0,False,0.0,False,text," [SH36]
"
1,7.0,0.0,0.0,False,0.0,False,text," [Shl94]
"
1,7.0,0.0,0.0,False,0.0,False,text," [Shl96]
"
3,8.0,0.266666666667,0.0,False,0.0,True,text," Soc., 262(1):195217, 1980.
"
12,5.66666666667,0.154761904762,0.0,False,0.0,True,text," Jean Pierre Serre. Local Fields. Springer-Verlag New York, Inc, New York, 1979.
"
14,5.5,0.0,0.0,False,0.0,True,text," O. Schilling and H. Hasse. Die Normen aus einer normalen Divisionsalgebra uber einem alge-
"
8,6.875,0.479166666667,0.0,False,0.0,False,text," braischen Zahlkorper. J. Reine Angew. Math., 174:248252, 1936.
"
12,6.58333333333,0.15625,0.0,False,0.0,True,text," Alexandra Shlapentokh. Diophantine classes of holomorphy rings of global elds. J. Algebra,
"
2,9.5,0.0,0.0,False,0.0,False,text," 169(1):139175, 1994.
"
11,7.54545454545,0.0,0.0,False,0.0,True,text," Alexandra Shlapentokh. Diophantine undecidability over algebraic function elds over nite elds
"
7,6.42857142857,0.408163265306,0.0,False,0.0,False,text," of constants. J. Number Theory, 58(2):317342, 1996.
"
1,2.0,0.0,0.0,False,0.0,False,text," 22
"
1,7.0,0.0,0.0,False,0.0,False,text," [Shl15]
"
1,7.0,0.0,0.0,False,0.0,False,text," [Tat67]
"
1,7.0,0.0,0.0,False,0.0,False,text," [Vid94]
"
12,6.75,0.0,0.0,False,0.0,True,text," Alexandra Shlapentokh. On denitions of polynomials over function elds of positive character-
"
4,9.25,0.235294117647,0.0,False,0.0,False,text," istic. arXiv:1502.02714, 2015. Preprint.
"
14,5.57142857143,0.428571428571,0.0,False,0.0,True,text," J. T. Tate. Global class eld theory. In Algebraic Number Theory (Proc. Instructional Conf.,
"
8,7.125,0.229166666667,0.0,False,0.0,True,text," Brighton, 1965), pages 162203. Thompson, Washington, D.C., 1967.
"
14,5.78571428571,0.0714285714286,0.0,False,0.0,True,text," Carlos R. Videla. Hilberts tenth problem for rational function elds in characteristic 2. Proc.
"
5,6.8,0.56,0.0,False,0.0,True,text," Amer. Math. Soc., 120(1):249253, 1994.
"
10,7.3,0.0,0.0,False,0.0,True,text," Department of Mathematics, The Pennsylvania State University, University, Park, PA
"
2,4.5,0.0,0.0,False,0.0,False,text," 16802, USA
"
3,11.6666666667,0.625,0.0,False,0.0,True,text," E-mail address: eisentra@math.psu.edu
"
2,18.5,0.375,0.0,False,0.0,True,text," URL: http://www.personal.psu.edu/kxe8/
"
10,7.3,0.0,0.0,False,0.0,True,text," Department of Mathematics, The Pennsylvania State University, University, Park, PA
"
2,4.5,0.0,0.0,False,0.0,False,text," 16802, USA
"
3,9.33333333333,0.625,0.0,False,0.0,True,text," E-mail address: txm950@psu.edu
"
2,19.5,0.375,0.0,False,0.0,True,text," URL: http://www.personal.psu.edu/txm950/
"
1,2.0,0.0,0.0,False,0.0,False,text," 23
"
