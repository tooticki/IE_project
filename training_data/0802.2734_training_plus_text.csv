words_num,awerage_word_length,italicness,formuleness,heading_first_word,boldness_first_word,is_capital_first_letter,type,text
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
1,1.0,0.0,0.0,False,0.0,False,text," g
"
1,1.0,0.0,0.0,False,0.0,False,text," u
"
1,1.0,0.0,0.0,False,0.0,True,text," A
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
1,1.0,0.0,0.0,False,0.0,False,text," ]
"
1,1.0,0.0,0.0,False,0.0,True,text," S
"
1,1.0,0.0,0.0,False,0.0,True,text," D
"
1,1.0,0.0,0.0,False,0.0,False,text," h
"
1,1.0,0.0,0.0,False,0.0,False,text," t
"
1,1.0,0.0,0.0,False,0.0,False,text," a
"
1,1.0,0.0,0.0,False,0.0,False,text," m
"
1,1.0,0.0,0.0,False,0.0,False,text," .
"
1,1.0,0.0,0.0,False,0.0,False,text," [
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
1,1.0,0.0,0.0,False,0.0,False,text," v
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
1,1.0,0.0,0.0,False,0.0,False,text," 7
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," .
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
1,1.0,0.0,0.0,False,0.0,False,text," 8
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
1,1.0,0.0,0.0,False,0.0,False,text," :
"
1,1.0,0.0,0.0,False,0.0,False,text," v
"
1,1.0,0.0,0.0,False,0.0,False,text," i
"
1,1.0,0.0,0.0,False,0.0,True,text," X
"
1,1.0,0.0,0.0,False,0.0,False,text," r
"
1,1.0,0.0,0.0,False,0.0,False,text," a
"
7,5.57142857143,0.0,0.0,False,1.0,True,text," A HARDY FIELD EXTENSION OF SZEMEREDIS THEOREM
"
6,5.33333333333,0.0,0.0,False,0.0,True,text," NIKOS FRANTZIKINAKIS AND M ATE WIERDL
"
15,5.2,0.0,0.0,False,0.0,True,text," Abstract. In 1975 Szemeredi proved that a set of integers of positive upper density contains
"
12,6.33333333333,0.0,0.0,False,0.0,False,text," arbitrarily long arithmetic progressions. Bergelson and Leibman showed in 1996 that the
"
15,4.93333333333,0.0,0.0,False,0.0,False,text," common dierence of the arithmetic progression can be a square, a cube, or more generally
"
16,4.625,0.0,0.0625,False,0.0,False,text," of the form p(n) where p(n) is any integer polynomial with zero constant term. We produce
"
17,4.41176470588,0.0,0.0,False,0.0,False,text," a variety of new results of this type related to sequences that are not polynomial. We show
"
16,4.5625,0.0,0.0416666666667,False,0.0,False,text," that the common dierence of the progression in Szemeredis theorem can be of the form [n]
"
18,4.22222222222,0.0,0.0462962962963,False,0.0,False,text," where  is any positive real number and [x] denotes the integer part of x. More generally, the
"
18,3.94444444444,0.0,0.0462962962963,False,0.0,False,text," common dierence can be of the form [a(n)] where a(x) is any function that is a member of
"
16,4.0625,0.0,0.0793650793651,False,0.0,False,text," a Hardy eld and satises a(x)/xk   and a(x)/xk+1  0 for some non-negative integer
"
14,5.5,0.0,0.0357142857143,False,0.0,False,text," k. The proof combines a new structural result for Hardy sequences, techniques from ergodic
"
10,6.9,0.0,0.0,False,0.0,False,text," theory, and some recent equidistribution results of sequences on nilmanifolds.
"
1,8.0,0.0,0.0,False,0.0,True,text," Contents
"
1,2.0,0.0,0.0,False,0.0,False,text," 1.
"
4,6.5,0.0,0.0,False,0.0,True,text," Introduction and main results
"
5,5.4,0.0,0.0,False,0.0,False,text," 2. Background in ergodic theory
"
5,7.8,0.0,0.0,False,0.0,False,text," 3. Equidistribution results on nilmanifolds
"
6,5.33333333333,0.0,0.0,False,0.0,False,text," 4. A model multiple recurrence result
"
6,6.33333333333,0.0,0.0,False,0.0,False,text," 5. Polynomial structure for Hardy sequences
"
7,5.71428571429,0.0,0.0,False,0.0,False,text," 6. Multiple recurrence for Hardy eld sequences
"
8,5.875,0.0,0.0,False,0.0,False,text," 7. Appendix: Single recurrence for Hardy eld sequences
"
1,10.0,0.0,0.0,False,0.0,True,text," References
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 7
"
1,1.0,0.0,0.0,False,0.0,False,text," 9
"
1,2.0,0.0,0.0,False,0.0,False,text," 14
"
1,2.0,0.0,0.0,False,0.0,False,text," 19
"
1,2.0,0.0,0.0,False,0.0,False,text," 26
"
1,2.0,0.0,0.0,False,0.0,False,text," 33
"
1,2.0,0.0,0.0,False,0.0,False,text," 35
"
5,5.6,0.0,0.0,False,0.0,False,text," 1. Introduction and main results
"
14,5.5,0.0,0.0,False,0.0,False,text," 1.1. Introduction. In 1975 Szemeredi ([45]) answered a long standing question of Erdos and
"
15,5.6,0.0,0.0,False,0.0,True,text," Turan (1936, [20]), showing that a set of integers of positive upper density1 contains arbitrarily
"
14,4.92857142857,0.0,0.0357142857143,False,0.0,False,text," long arithmetic progressions, or equivalently, for every   N, patterns of the form
"
1,3.0,0.0,0.0,False,0.0,False,text," (1)
"
19,3.63157894737,0.0,0.184210526316,False,0.0,False,text," for some m  Z and d  N. This result has been very inuential, several dierent proofs and
"
16,5.125,0.0,0.0,False,0.0,False,text," extensions have been found, and the tools developed in the process led to applications in several
"
11,7.36363636364,0.0,0.0,False,0.0,False,text," diverse elds, that include combinatorics, number theory, harmonic analysis, ergodic theory,
"
4,7.5,0.0,0.0,False,0.0,False,text," and theoretical computer science.
"
14,1.42857142857,0.0,0.797619047619,False,0.0,False,text," {m, m + d, m + 2d, . . . , m + d}
"
10,7.7,0.307692307692,0.0,False,0.0,False,text," 2000 Mathematics Subject Classication. Primary: 37A45; Secondary: 28D05, 05D10, 11B25.
"
13,7.30769230769,0.307692307692,0.0,False,0.0,True,text," Key words and phrases. Hardy elds, multiple recurrence, multiple ergodic averages, arithmetic progressions.
"
15,5.33333333333,0.0,0.0,False,0.0,True,text," The rst author was partially supported by NSF grant DMS-0701027 and the second by DMS-0801316.
"
29,2.34482758621,0.0689655172414,0.330459770115,False,0.0,False,text," 1If   Z, the upper density of  is the number d() = lim supN |  {N, . . . , N }|/(2N + 1). If the
"
15,3.73333333333,0.0666666666667,0.0166666666667,False,0.0,False,text," previous limit exists we call it the density of  and denote it by d().
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
14,5.71428571429,0.0,0.0,False,0.0,True,text," In this article we are interested in obtaining renements of Szemeredis theorem by restricting
"
15,5.06666666667,0.0,0.0333333333333,False,0.0,False,text," the scope of the common dierence d. During the last thirty years several related renements
"
15,5.0,0.0,0.0,False,0.0,False,text," have been obtained, most notably a result of Bergelson and Leibman ([8]), who showed that
"
18,4.0,0.0,0.138888888889,False,0.0,False,text," d can be taken to be of the form p(n) where p is any non-constant integer polynomial with
"
17,4.29411764706,0.0,0.0147058823529,False,0.0,False,text," p(0) = 0. This had been previously established for  = 1 by Sarkozy ([44]) and Furstenberg
"
12,6.83333333333,0.0,0.0,False,0.0,False,text," ([25]). More examples, related to IP sets, generalized polynomials, polynomials with non-zero
"
19,4.26315789474,0.0,0.0,False,0.0,False,text," constant term, and the set of prime numbers, can be found in [26], [10], [39], [6], [21], [22]. All
"
15,5.2,0.0,0.0,False,0.0,False,text," these results were obtained using (in addition to other tools) methods that emerged from the
"
16,4.8125,0.0,0.0,False,0.0,False,text," pioneering paper of Furstenberg ([24]), where ergodic theory was used to give a new proof of
"
2,9.0,0.0,0.0,False,0.0,True,text," Szemeredis theorem.
"
15,4.8,0.0,0.0,False,0.0,True,text," We shall produce a variety of new examples given by sequences that are not polynomial,
"
16,4.625,0.0,0.0,False,0.0,False,text," and range from simply dened to rather exotic looking. For example, we shall show that the
"
13,3.30769230769,0.0,0.0769230769231,False,0.0,False,text," common dierence d in (1) can be taken to be of the form
"
1,3.0,0.0,0.0,False,0.0,False,text," (2)
"
1,2.0,0.0,0.5,False,0.0,False,text," [n
"
22,3.0,0.0,0.397510822511,False,0.0,False,text," 2], [n log n], [3 n5/2 + n log n], [n2/ log log n], hqn2008 + (log n)2/3 + n2e 3log ni,
"
11,3.81818181818,0.0,0.0757575757576,False,0.0,False,text," where [x] denotes the integer part of x, or the form
"
1,3.0,0.0,0.0,False,0.0,False,text," (3)
"
1,10.0,0.0,0.2,False,0.0,False,text," [log(n!)],
"
1,14.0,0.0,0.214285714286,False,0.0,False,text," [log((n3/2))],
"
4,4.0,0.0,0.25,False,0.0,False,text," [n2 sin(1/ log n)],
"
1,10.0,0.0,0.5,False,0.0,False,text," [n5/2(n)],
"
1,14.0,0.0,0.357142857143,False,0.0,False,text," [n1+1/nLi(n)],
"
17,4.11764705882,0.0,0.0,False,0.0,False,text," where  is the Gamma function,  is the Riemann zeta function, and Li is the logarithmic
"
5,2.2,0.0,0.4,False,0.0,False,text," 2 1/ log t dt).
"
7,4.57142857143,0.0,0.242857142857,False,0.0,False,text," integral function (dened by Li(x) =R x
"
14,5.35714285714,0.0,0.0,False,0.0,True,text," A more illuminating (but incomplete) description of the class of functions for which our
"
14,5.64285714286,0.142857142857,0.0714285714286,False,0.0,False,text," result apply is as follows: By LE we denote the collection of logarithmico-exponential func-
"
16,5.0,0.0625,0.0,False,0.0,False,text," tions of Hardy ([29], [30]), consisting of all functions that can be constructed using the real
"
14,5.92857142857,0.0,0.107142857143,False,0.0,False,text," constants, the functions ex and log x, and the operations of addition, multiplication, division,
"
16,4.9375,0.0,0.03125,False,0.0,False,text," and composition of functions, as long as the functions constructed are well dened for large x.
"
20,3.4,0.0,0.15,False,0.0,True,text," We shall show that if a  LE, then the common dierence d in (1) can have the form [a(n)]
"
18,4.0,0.0,0.194444444444,False,0.0,False,text," as long as a satises the growth condition xk  a(x)  xk+1 for some non-negative integer k.
"
8,3.75,0.0,0.0,False,0.0,True,text," The examples in (2) are of this type.
"
17,4.41176470588,0.0,0.0,False,0.0,True,text," In fact, our result applies to the much larger class of functions that belong to some Hardy
"
14,5.78571428571,0.0,0.0,False,0.0,False,text," eld (a notion rst introduced by Bourbaki ([18])) and satisfy the previous growth restrictions.
"
13,3.84615384615,0.0,0.0,False,0.0,True,text," This will enable us to deal with the sequences in (3) as well.
"
15,5.06666666667,0.0,0.1,False,1.125,True,heading," Denition 1.1. Let B be the collection of equivalence classes of real valued functions a(x)
"
18,4.22222222222,0.0,0.0518518518519,False,0.0,False,body," dened on some half line (u,), where we identify two functions if they agree for all large x.2
"
19,3.63157894737,0.122807017544,0.122807017544,False,0.0,True,body," A Hardy eld is a subeld of the ring (B, +,) that is closed under dierentiation. By H we
"
7,4.14285714286,0.714285714286,0.0,False,0.0,False,body," denote the union of all Hardy elds.
"
14,5.28571428571,0.0,0.0,False,0.0,True,after_body," Hardy elds have been used to study solutions of dierential equations ([11], [12], [15],
"
14,5.85714285714,0.0,0.0357142857143,False,0.0,False,text," [42], [43]), dierence and functional equations ([13], [14]), properties of curves in R2 ([19]),
"
13,6.46153846154,0.0,0.0,False,0.0,False,text," equidistribution results of sequences on the torus ([16]), and convergence properties of ergodic
"
12,5.33333333333,0.0,0.0416666666667,False,0.0,False,text," averages ([17]). We collect some results that illustrate the richness of H:
"
10,4.5,0.0,0.266666666667,False,0.0,False,text,"  H contains LE and anti-derivatives of elements of LE.
"
16,4.4375,0.0,0.171875,False,0.0,False,text,"  H contains several other functions not in LE, like the functions (x), (x), sin (1/x).
"
20,2.75,0.0,0.25,False,0.0,False,text,"  If a  LE and b  H, then there exists a Hardy eld containing both a and b.
"
18,1.38888888889,0.0,0.398148148148,False,0.0,False,text,"  If a  LE, b  H, and b(x)  , then a  b  H.
"
18,5.0,0.161111111111,0.0,False,0.0,False,text," 2The equivalence classes just dened are often called germs of functions. We choose to use the word function
"
18,5.0,0.0,0.0555555555556,False,0.0,False,text," when we refer to elements of B instead, with the understanding that all the operations dened and statements
"
16,3.9375,0.0,0.15625,False,0.0,False,text," made for elements of B are considered only for suciently large values of x  R.
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
17,1.47058823529,0.0,0.421568627451,False,0.0,True,text," If a  LE, b  H, and a(x)  , then b  a  H.
"
18,3.5,0.0,0.138888888889,False,0.0,False,text,"  If a is a continuous function that is algebraic over some Hardy eld, then a  H.
"
16,4.625,0.0,0.0625,False,0.0,True,text," We mention some basic properties of elements of H relevant to our study. Every element of
"
17,4.70588235294,0.0,0.147058823529,False,0.0,True,text," H has eventually constant sign (since it has a multiplicative inverse). Therefore, if a  H, then
"
15,4.93333333333,0.0,0.283333333333,False,0.0,False,text," a is eventually monotone (since a has eventually constant sign), and the limit limx a(x)
"
22,3.27272727273,0.0,0.295454545455,False,0.0,False,text," exists (possibly innite). Since for every two functions a  H, b  LE (b 6= 0), we have a/b  H,
"
13,5.92307692308,0.0,0.100427350427,False,0.0,False,text," it follows that the asymptotic growth ratio limx a(x)/b(x) exists (possibly innite). This
"
18,4.22222222222,0.222222222222,0.0,False,0.0,False,text," last property is key, since it will often justify our use of LHospitals rule. We are going to
"
12,5.58333333333,1.0,0.0,False,0.0,False,text," freely use all these properties without any further explanation in the sequel.
"
11,5.72727272727,0.0,0.0,False,0.0,False,text," 1.2. Results in combinatorial language. The following is our main result:
"
21,3.04761904762,0.380952380952,0.238095238095,True,1.0,True,heading," Theorem A. Let a  H satisfy xk  a(x)  xk+1 for some non-negative integer k. Let   N.
"
15,3.8,0.6,0.0888888888889,False,0.0,True,body," Then every   Z with d()  0 contains arithmetic progressions of the form
"
14,2.5,0.0,0.669642857143,False,0.0,False,body," {m, m + [a(n)], m + 2[a(n)], . . . , m + [a(n)]}
"
1,3.0,0.0,0.0,False,0.0,False,body," (4)
"
13,2.15384615385,0.346153846154,0.371794871795,False,0.0,False,body," for some m  Z and n  N with [a(n)] 6= 0.
"
17,4.23529411765,0.0588235294118,0.0,False,0.0,True,heading," Remarks.  For  = 1, Theorem A can be easily deduced from the equidistribution results in
"
9,5.0,0.0,0.0,False,0.0,False,body," [16] and the spectral theorem (see [17] for details).
"
17,4.23529411765,0.0,0.117647058824,False,0.0,False,body,"  Our assumption can also be stated in the following equivalent form: a  H has polynomial
"
18,4.27777777778,0.0555555555556,0.111111111111,False,0.0,False,body," growth and is not of the form cxk + b(x) for some non-negative integer k, non-zero real number
"
26,2.61538461538,0.0,0.283882783883,False,0.0,False,body," c, and b  H that satises b(x)/xk  0. So it is functions like x2 + log x or 2x3 + x log x that
"
16,4.625,0.0,0.03125,False,0.0,False,text,"  The assumption that a(x) has polynomial growth is essential if one wants to have sucient
"
17,4.64705882353,0.0,0.0196078431373,False,0.0,False,text," conditions that depend only on the growth of the function a(x).3 On the other hand, the precise
"
16,4.75,0.0,0.03125,False,0.0,False,text," assumptions on a(x) in Theorem A can probably be relaxed (see Conjecture A in Section 1.5);
"
11,3.63636363636,0.0,0.0,False,0.0,False,text," it certainly is possible for  = 1 (see Theorem C).
"
9,4.22222222222,0.0,0.0,False,0.0,False,text," our present methods do not allow us to handle.
"
17,4.47058823529,0.0,0.0,False,0.0,False,text,"  An immediate corollary is the following coloristic result, which we do not see how to prove
"
17,4.11764705882,0.0,0.117647058824,False,0.0,False,text," without using Theorem A: If a  H satises the growth condition of Theorem A, then every
"
14,5.42857142857,0.0,0.0,False,0.0,False,text," nite coloring of the integers has a monochromatic arithmetic progression of the form (4).
"
15,5.2,0.0,0.0,False,0.0,False,text,"  Although our result applies to rather exotic sequences, like the sequences mentioned in the
"
9,3.11111111111,0.0,0.0555555555556,False,0.0,False,text," 5] seem to be almost as hard to deal
"
9,4.88888888889,0.0,0.0555555555556,False,0.0,False,text," examples (2) and (3), simply dened sequences like [n
"
5,4.2,0.0,0.0,False,0.0,False,text," with as the general case.
"
18,3.94444444444,0.0,0.0277777777778,False,0.0,False,text,"  Unlike the case where a(n) is a polynomial with zero constant term, it is not true that
"
24,2.70833333333,0.0,0.180555555556,False,0.0,False,text," ([a(n)]) 6=  for a set of n  N with bounded gaps. To see this, take  = 2Z, a(n) = log n,
"
21,3.52380952381,0.0,0.156462585034,False,0.0,False,text," and notice that [a(n)] takes odd values for every n  [22l+1, 22l+2) for every l  N. With a bit
"
19,3.47368421053,0.0,0.105263157895,False,0.0,False,text," more eort one can show that we have the same problem for every a  H that satises the
"
5,5.6,0.0,0.0,False,0.0,False,text," growth assumptions of Theorem A.
"
15,5.13333333333,0.0,0.0,False,0.0,True,text," To prove Theorem A we rst use the correspondence principle of Furstenberg (see Section 1.3)
"
15,5.46666666667,0.0,0.0,False,0.0,False,text," to translate it into a statement about multiple recurrence in ergodic theory. The ergodic method
"
15,5.13333333333,0.0,0.0,False,0.0,False,text," used to prove Szemeredis theorem ([24]) and its polynomial extension ([8]) does not seem to
"
14,4.85714285714,0.0,0.0,False,0.0,False,text," apply4, so we use a dierent method instead. Our argument splits into three parts:
"
18,4.88888888889,0.111111111111,0.111111111111,False,0.0,False,text," 3A result mentioned in [16] suggests the possibility that for every a  H of super-polynomial growth there
"
25,3.48,0.0,0.14,False,0.0,False,text," exists b  H of the same growth, that is, the limit of b/a is a non-zero real constant, such that b(n) is an odd
"
21,4.2380952381,0.0,0.119047619048,False,0.0,False,text," integer for every n  N. If this is the case, then no growth assumption on elements of H with super-polynomial
"
7,4.85714285714,0.0,0.0,False,0.0,False,text," growth will be sucient for our purposes.
"
18,4.77777777778,0.0,0.0,False,0.0,False,text," 4The main problem appears when one deals with distal systems. Unlike the case of a polynomial with zero
"
20,4.5,0.0,0.225,False,0.0,False,text," constant term, for a  H satisfying xk  a(x)  xk+1 for some non-negative integer k, successive applications of
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
16,4.8125,0.0,0.0416666666667,False,0.0,False,text," (i) As it turns out, dealing with the full sequence [a(n)] greatly complicates our study, in
"
15,5.26666666667,0.0,0.0622222222222,False,0.0,False,text," particular step (iii) below. Instead, we show that the range of [a(n)] contains some suitably
"
14,5.64285714286,0.0,0.0,False,0.0,False,text," chosen polynomial patterns of xed degree (Proposition 5.1), and we work with this collection
"
15,5.2,0.0,0.0,False,0.0,False,text," of patterns henceforth. To obtain these patterns we use the Taylor expansion of the function
"
17,4.52941176471,0.0,0.0529411764706,False,0.0,False,text," a(x). Since some derivative of a(x) vanishes at innity, it makes sense to expect (but is non-
"
17,4.64705882353,0.0,0.0196078431373,False,0.0,False,text," trivial to verify) that the range of [a(n)] has a rich supply of polynomial progressions of xed
"
1,7.0,0.0,0.0,False,0.0,False,text," degree.
"
14,5.42857142857,0.0,0.0535714285714,False,0.0,False,text," (ii) For the polynomial patterns found in (i), we study the naturally associated multiple
"
14,5.64285714286,0.0,0.0,False,0.0,False,text," ergodic averages, and show that the nilfactor of the system controls their limiting behavior
"
14,5.71428571429,0.0,0.0,True,0.0,False,text," (Proposition 6.3). As a consequence, we reduce our problem to establishing a certain multiple
"
14,5.64285714286,0.0,0.0,False,0.0,False,text," recurrence property for nilsystems. This reduction to nilsystems step is carried out using a
"
12,6.5,0.0,0.0,False,0.0,False,text," rather cumbersome application of the by now standard polynomial exhaustion technique (PET
"
14,5.85714285714,0.0,0.0,False,0.0,False,text," induction); we use it to eliminate some undesirable constants and majorize our multiple ergodic
"
11,4.63636363636,0.0,0.0,False,0.0,False,text," averages by some polynomial ones that we know how to control.
"
13,5.92307692308,0.0,0.0461538461538,False,0.0,False,text," (iii) We verify the multiple recurrence property for nilsystems by comparing the multiple
"
15,5.33333333333,0.0,0.0222222222222,False,0.0,False,text," ergodic averages along the polynomial patterns of part (i) with some easier to handle averages
"
13,6.07692307692,0.0,0.0,False,0.0,False,text," that can be estimated using Furstenbergs classical multiple recurrence result. To carry out
"
13,6.23076923077,0.0,0.0,False,0.0,False,text," the comparison step we need an equidistribution result on nilmanifolds (Proposition 6.4). Be-
"
14,5.57142857143,0.0,0.0,False,0.0,False,text," cause our polynomial patterns consist of nite polynomial blocks rather than a single innite
"
15,5.0,0.0,0.0,False,0.0,False,text," polynomial sequence, the result we need does not seem to follow from the available quali-
"
12,6.75,0.0,0.0,False,0.0,False,text," tative equidistribution results of polynomial sequences on nilmanifolds. Instead, we adapt a
"
12,6.41666666667,0.0,0.0,False,0.0,False,text," quantitative equidistribution result that was recently obtained by Green and Tao ([28]).
"
19,3.94736842105,0.0,0.0,False,0.0,True,text," To give an example of the polynomial patterns we are led to consider, let us look at the case
"
22,3.09090909091,0.0,0.189393939394,False,0.0,False,text," of the sequence [a(n)] where a  H satises x  a(x)  x2. In this case, we can show that the
"
13,6.0,0.0,0.025641025641,False,0.0,False,text," range of the sequence [a(n)] contains certain arithmetic progressions and derive Theorem A
"
12,4.25,0.0,0.0,False,0.0,False,text," from the following result (that we nd of interest on its own):
"
20,3.25,0.55,0.25,True,1.0,True,heading," Theorem B. Suppose that for every r, m  N the set S  Z contains patterns of the form
"
9,2.11111111111,0.0,0.391534391534,False,0.0,False,body," {r(cr,m + mn) : 1  n  Nr,m}
"
16,3.25,0.489583333333,0.328125,False,0.0,False,body," where cr,m, Nr,m are integers with limm Nr,m =  for every xed r  N.
"
19,2.73684210526,0.526315789474,0.122807017544,False,0.0,True,body," Then for every   N every   Z with d()  0 contains patterns of the form
"
14,1.42857142857,0.0,0.797619047619,False,0.0,False,body," {m, m + s, r + 2s, . . . , m + s}
"
10,2.3,0.45,0.35,False,0.0,False,after_body," for some m  Z and non-zero s  S.
"
15,5.2,0.133333333333,0.0,False,0.0,True,heading," Remarks.  See Theorem 6.2 for a result that deals with more general polynomial progressions.
"
20,3.4,0.0,0.125,False,0.0,False,body,"  If cm = 0 for innitely many m  N, the result follows easily from a nitistic version of
"
15,4.8,0.0,0.0,False,0.0,True,body," Szemeredis theorem. Such an easy derivation doesnt seem to be possible when we have no
"
6,5.66666666667,0.0,0.111111111111,False,0.0,False,body," (usable) control over the constants cm.
"
16,4.25,0.0,0.0,False,0.0,True,after_body," To prove Theorem A we shall need a generalization of Theorem B that deals with more
"
14,5.78571428571,0.0,0.0,False,0.0,False,text," complicated polynomial patterns (Theorem 6.2). In order to illustrate some of the ideas needed
"
17,4.11764705882,0.0,0.0,False,0.0,False,text," to prove Theorem A in their simplest form, we choose to present the proof of Theorem B
"
1,11.0,0.0,0.0,False,0.0,False,text," separately.
"
18,3.94444444444,0.0,0.0,False,0.0,True,text," Next we mention an improvement of our main result for  = 1. This result was rst obtained
"
14,5.42857142857,0.0,0.0,False,0.0,False,text," (but never published) several years ago by Boshernitzan using a method dierent than ours.
"
21,4.14285714286,0.0,0.164399092971,False,0.0,False,text," the operation [a(n + m)]  [a(n)]  [a(m)], m  N, lead eventually to non-zero constant sequences (in n) which
"
16,5.0625,0.0,0.0,False,0.0,False,text," is a problem when one tries to prove the corresponding coloristic (van der Waerden type) result.
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
18,3.44444444444,0.444444444444,0.181481481481,True,1.0,True,heading," Theorem C. Let a  H have polynomial growth and suppose that |a(x)  cp(x)|   for
"
8,2.0,0.3125,0.375,False,0.0,False,body," every p  Z[x] and c  R.
"
23,2.47826086957,0.369565217391,0.246376811594,False,0.0,True,body," Then every   Z with d()  0, contains x, y   that satisfy y  x = [a(n)] for some
"
7,2.28571428571,0.214285714286,0.404761904762,False,0.0,False,text," n  N with [a(n)] 6= 0.
"
17,4.05882352941,0.0,0.0,False,0.0,True,text," The proof of Theorem C is rather dierent (and much easier) than the proof of our main
"
18,4.33333333333,0.0,0.0,False,0.0,False,text," result (Theorem A). In order not to digress from our main objective we give it in the Appendix.
"
16,4.5,0.0,0.0,False,0.0,True,text," Although we were not able to prove Theorem A under the more relaxed assumptions of The-
"
15,5.26666666667,0.0,0.0,False,0.0,False,text," orem C, we believe that the corresponding stronger statement should be true (see Conjecture A
"
1,7.0,0.0,0.0,False,0.0,False,text," below).
"
16,4.6875,0.125,0.0,False,0.0,False,text," 1.3. Results in ergodic language. All along the article we shall use the term measure pre-
"
17,4.17647058824,0.159663865546,0.329411764706,False,0.0,False,text," serving system, or the word system, to designate a quadruple (X,B, , T ), where (X,B, )
"
18,3.88888888889,0.0555555555556,0.166666666667,False,0.0,False,text," is a Lebesgue probability space, and T : X  X is an invertible measurable map such that
"
18,3.77777777778,0.0,0.212962962963,False,0.0,False,text," (T 1A) = (A) for every A  B. The necessary background from ergodic theory is given in
"
2,4.5,0.0,0.0,False,0.0,True,text," Section 2.
"
13,6.15384615385,0.0,0.0,False,0.0,True,text," We shall use the following correspondence principle of Furstenberg (the formulation given is
"
13,5.0,0.0,0.0,False,0.0,False,text," from [2]) to reformulate Theorems A, B, and C, in ergodic theoretic language:
"
12,5.41666666667,0.5,0.0,False,1.0,True,text," Furstenberg Correspondence Principle ([24], [2]). Let  be a set of integers.
"
22,2.81818181818,0.579545454545,0.282575757576,False,0.0,True,text," Then there exist a system (X,B, , T ) and a set A  B, with (A) = d(), and such that
"
1,3.0,0.0,0.0,False,0.0,False,heading," (5)
"
14,1.57142857143,0.25,0.583333333333,False,0.0,False,body," for every n1, . . . , n  Z and   N.
"
23,1.04347826087,0.0,0.423913043478,False,0.0,False,body," d(  (  n1)  . . .  (  n))  (A  T n1A    T nA),
"
7,5.85714285714,0.0,0.0,False,0.0,True,after_body," For convenience we give the following denition:
"
21,3.19047619048,0.285714285714,0.0757575757576,False,1.125,True,body," Denition 1.2. If   N, we say that the set S of integers is a set of -recurrence for the
"
17,2.41176470588,0.0588235294118,0.380392156863,False,0.0,False,body," system (X,B, , T ), if for every A  B with (A)  0 we have
"
1,3.0,0.0,0.0,False,0.0,False,body," (6)
"
20,1.6,0.0,0.491666666667,False,0.0,False,body," (A  T sA  T 2sA    T sA)  0 for some non-zero s  S.
"
22,3.5,0.310606060606,0.0530303030303,False,0.0,True,body," We say that the set of integers S is a set of -recurrence, or good for -recurrence, if it is a set
"
22,3.27272727273,0.0,0.121900826446,False,0.0,False,body," of -recurrence for every system. If S is a set of -recurrence for every   N, we say that S is
"
5,5.0,0.981818181818,0.0,False,0.0,False,body," a set of multiple recurrence.
"
19,3.78947368421,0.0526315789474,0.0570175438596,False,0.0,True,heading," Remarks.  If S is a set of -recurrence, then (6) will be in fact satised for innitely many
"
19,2.47368421053,0.0,0.285486443381,False,0.0,False,text," s  S (in fact S  mZ is also a set of -recurrence for every m  N).
"
19,3.68421052632,0.0,0.0526315789474,False,0.0,False,body,"  We get a similar denition for sequences of integers by letting S to be the range of the
"
1,9.0,0.0,0.0,False,0.0,False,body," sequence.
"
16,4.125,0.369791666667,0.00520833333333,False,0.0,True,body," In this case we say that a sequence is good for -recurrence, or good for multiple
"
1,11.0,0.909090909091,0.0,False,0.0,False,after_body," recurrence.
"
15,5.13333333333,0.0,0.0,False,0.0,True,text," Let us give some examples of sets of multiple recurrence and also mention some obstructions
"
18,4.22222222222,0.0,0.0972222222222,False,0.0,False,text," to recurrence. In the introduction we mentioned that if p  Z[x] is non-constant and p(0) = 0,
"
16,5.0625,0.0,0.03125,False,0.0,False,text," then the sequence p(n) is good for multiple recurrence ([8]). Other examples of sets of multiple
"
16,4.875,0.0,0.0,False,0.0,False,text," recurrence are IP sets, meaning sets that consist of all nite sums (with distinct entries) of
"
7,5.28571428571,0.0,0.0,False,0.0,False,text," from a nite version of Szemeredis theorem).
"
17,4.52941176471,0.0,0.0,False,0.0,True,text," Examples of sets that are bad for single recurrence are sets that do not contain multiples of
"
15,5.33333333333,0.0,0.0,False,0.0,False,text," some positive integer, and also the range of lacunary sequences. It follows that the sequences
"
21,3.38095238095,0.0,0.423469387755,False,0.0,False,text," some innite set ([26]), and sets of the form SnN{an, 2an, . . . , nan} where an  N (follows
"
25,2.56,0.0,0.313333333333,False,0.0,False,text," 3n + 2, n2 + 1, p + 2 (p prime), n!, are bad for single recurrence. The set n  N : {n5} 
"
20,3.55,0.0,0.178333333333,False,0.0,False,text," [1/2, 3/4] and the sequence [5n + 2] are bad for recurrence for the rotation by 5 on T (on
"
1,1.0,0.0,0.0,False,0.0,False,text," 5
"
19,3.78947368421,0.0,0.0701754385965,False,0.0,False,text," the other hand the sequences [5n + 1] and [5n + 3] are good for single recurrence, see the
"
4,5.5,0.0,0.0,False,0.0,False,text," discussion in Section 7).
"
14,5.85714285714,0.0,0.0,False,0.0,True,text," Using Furstenbergs correspondence principle it is easy to see that the following result implies
"
14,3.92857142857,0.0,0.0,True,0.0,True,text," Theorem A (in fact it is not hard to show that they are equivalent):
"
17,3.47058823529,0.382352941176,0.264705882353,True,1.0,True,heading," Theorem A. Let a  H satisfy xk  a(x)  xk+1 for some non-negative integer k.
"
14,3.71428571429,0.5,0.332908163265,False,0.0,True,body," Then S = {[a(1)], [a(2)], . . .} is a set of multiple recurrence.
"
6,5.66666666667,0.0,0.0,False,0.0,True,after_body," The following result implies Theorem B:
"
20,3.25,0.55,0.25,True,1.0,True,heading," Theorem B. Suppose that for every r, m  N the set S  Z contains patterns of the form
"
16,3.25,0.489583333333,0.328125,False,0.0,False,body," where cr,m, Nr,m are integers with limm Nr,m =  for every xed r  N.
"
8,4.0,0.875,0.125,False,0.0,True,body," Then S is a set of multiple recurrence.
"
9,2.11111111111,0.0,0.391534391534,False,0.0,False,body," {r(cr,m + mn) : 1  n  Nr,m}
"
6,5.66666666667,0.0,0.0,False,0.0,True,after_body," The following result implies Theorem C:
"
18,3.44444444444,0.444444444444,0.181481481481,True,1.0,True,heading," Theorem C. Let a  H have polynomial growth and suppose that |a(x)  cp(x)|   for
"
8,2.0,0.3125,0.375,False,0.0,False,body," every p  Z[x] and c  R.
"
14,3.57142857143,0.5,0.332908163265,False,0.0,True,body," Then S = {[a(1)], [a(2)], . . .} is a set of single recurrence.
"
15,5.0,0.0,0.0,False,0.0,False,after_body," 1.4. Structure of the article. In Section 2 we give the necessary background from ergodic
"
16,4.9375,0.0,0.0,False,0.0,False,text," theory. Key to our study are some results about the structure of the characteristic factors of
"
4,7.0,0.0,0.0,False,0.0,False,text," some multiple ergodic averages.
"
14,5.64285714286,0.0,0.0,False,0.0,True,text," In Section 3 we give the necessary background on nilsystems, and state some equidistribution
"
14,5.64285714286,0.0,0.0,False,0.0,False,text," results of sequences on nilmanifolds. A crucial ingredient for our study is the quantitative
"
13,6.23076923077,0.0,0.0,False,0.0,False,text," equidistribution result stated in Theorem 3.2 for connected groups. We generalize this result
"
8,5.5,0.0,0.0,False,0.0,False,text," to not necessarily connected groups in Theorem 3.4.
"
17,4.17647058824,0.0,0.0,False,0.0,True,text," In Section 4 we prove Theorem B which serves as a model for the more complicated result
"
7,5.71428571429,0.0,0.0,False,0.0,False,text," that involves Hardy eld sequences (Theorem A).
"
21,3.14285714286,0.0,0.0952380952381,False,0.0,True,text," In Section 5 we carry out the rst step needed to prove Theorem A. We show that if a  H
"
17,4.11764705882,0.0,0.147058823529,False,0.0,False,text," satises xk  a(x)  xk+1 for some non-negative integer k, then the range of the sequence
"
6,7.83333333333,0.0,0.0555555555556,False,0.0,False,text," [a(n)] some conveniently chosen polynomial patterns.
"
19,3.73684210526,0.0,0.0,False,0.0,True,text," In Section 6 we work with the patterns found in Section 5 and carry out the nal two steps
"
17,4.05882352941,0.0,0.0,False,0.0,False,text," of the proof of Theorem A. The rst step is a reduction to nilsystems argument. On the
"
14,5.64285714286,0.0,0.0,False,0.0,False,text," second step we verify a multiple recurrence property for nilsystems. Our argument is similar
"
18,4.0,0.0,0.0,False,0.0,False,text," to the one used to prove our model result Theorem B. The only extra diculty occurs in the
"
14,5.35714285714,0.0,0.0,False,0.0,False,text," reduction to nilsystems step which happens to be technically much more involved than the
"
7,4.28571428571,0.0,0.0,False,0.0,False,text," one needed for the our model result.
"
8,4.75,0.0,0.0,False,0.0,True,text," The Appendix contains the proof of Theorem C.
"
14,5.14285714286,0.0,0.0,False,0.0,False,text," 1.5. Further directions. Roughly speaking, the method used to prove Theorem A, or its
"
11,6.72727272727,0.0,0.0,False,0.0,False,text," equivalent version Theorem A, amounts to nding conveniently chosen polynomial pieces
"
18,4.11111111111,0.0,0.0185185185185,False,0.0,False,text," within the range of a sequence. These pieces should be chosen so that it is possible to (i)
"
16,5.0625,0.0,0.03125,False,0.0,False,text," carry out a reduction to nilsystems step, and (ii) verify a certain recurrence property for nil-
"
18,4.22222222222,0.0,0.0185185185185,False,0.0,False,text," systems. In view of the tools that have recently surfaced and help us carry out steps (i) and
"
16,4.6875,0.0,0.025,False,0.0,False,text," (ii), this polynomial method appears to be rather exible, and is very likely to nd further
"
16,4.8125,0.0,0.0,False,0.0,False,text," applications. For example, it now looks within reach to show that every set of integers with
"
21,3.7619047619,0.0,0.371598639456,False,0.0,False,text," positive density contains patterns of the form m, m + [a1(n)], . . . , m + [ak(n)] for most choices
"
1,1.0,0.0,0.0,False,0.0,False,text," 6
"
16,4.75,0.0,0.0375,False,0.0,False,text," of functions ai(x) that belong to some Hardy eld and have polynomial growth. This belief is
"
13,4.69230769231,0.0,0.0,False,0.0,False,text," reinforced by recent extensions in [5] of the weakly mixing PET from [3].
"
15,4.8,0.0,0.0,False,0.0,True,text," A more challenging problem is to nd an example of a Hardy sequence of super-polynomial
"
15,4.93333333333,0.0,0.0,False,0.0,False,text," growth that is good for Szemeredis theorem (i.e. the conclusion of Theorem A holds). For
"
13,5.92307692308,0.0,0.0538461538462,False,0.0,False,text," example, is the sequence [nlog log n] good for Szemeredis theorem? Concerning convergence
"
18,4.11111111111,0.0,0.111111111111,False,0.0,False,text," results, if a  H satises the growth assumptions of Theorem A, then it seems likely that the
"
16,4.625,0.0,0.0208333333333,False,0.0,False,text," range of the sequence [a(n)] can be split into polynomial pieces that we can control, and
"
10,5.4,0.0,0.05,False,0.0,False,text," hence prove convergence in L2 for the multiple ergodic averages
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
9,2.33333333333,0.0,0.680555555556,False,0.0,True,text," T [a(n)]f1  . . .  T [a(n)]f.
"
18,3.83333333333,0.0,0.0,False,0.0,True,text," Since the growth assumptions in Theorem A can be relaxed when  = 1 (see Theorem C), it
"
13,4.0,0.0,0.0769230769231,False,0.0,False,text," seems very likely that the same should be the case for general :
"
18,3.61111111111,0.444444444444,0.181481481481,False,1.0,True,heading," Conjecture A. Let a  H have polynomial growth and suppose that |a(x)  cp(x)|   for
"
8,2.0,0.3125,0.375,False,0.0,False,body," every p  Z[x] and c  R.
"
19,3.31578947368,0.552631578947,0.0964912280702,False,0.0,True,body," Then for every   N, every   Z with d()  0 contains arithmetic progressions of the
"
1,4.0,1.0,0.0,False,0.0,False,after_body," form
"
1,3.0,0.0,0.0,False,0.0,False,text," (7)
"
14,2.5,0.0,0.669642857143,False,0.0,False,body," {m, m + [a(n)], m + 2[a(n)], . . . , m + [a(n)]}
"
13,2.15384615385,0.346153846154,0.371794871795,False,0.0,False,after_body," for some m  Z and n  N with [a(n)] 6= 0.
"
15,4.86666666667,0.0,0.0,False,0.0,True,text," In view of the fact that Szemeredis theorem on arithmetic progressions was a key ingre-
"
13,6.23076923077,0.0,0.0,False,0.0,False,text," dient in showing that the primes contain arbitrarily long arithmetic progressions ([27]), and
"
12,6.75,0.0,0.0,False,0.0,False,text," likewise the polynomial Szemeredi theorem was key in establishing polynomial progressions in
"
8,6.125,0.0,0.0,False,0.0,False,text," the primes ([46]), the following result seems plausible:
"
16,4.375,0.645833333333,0.125,False,1.0,True,heading," Conjecture B. Let a  H satisfy the growth assumptions of Theorem A (or Conjecture A).
"
13,5.84615384615,0.942307692308,0.0,False,0.0,True,body," Then the prime numbers contain arbitrarily long arithmetic progressions of the form (7).
"
12,6.41666666667,0.0,0.0,False,0.0,False,after_body," 1.6. Notational conventions. The following notation will be used throughout the article:
"
29,2.24137931034,0.0,0.455747126437,False,0.0,True,text," N = {1, 2, . . .}, T f = f  T , e(x) = e2ix, [x] denotes the integer part of x, {x} = x  [x],
"
23,3.08695652174,0.0,0.397826086957,False,0.0,False,text," kxk = d(x, Z), om1,...,mk (1) denotes a quantity that goes to zero when m1, . . . , mk  +, by
"
18,3.72222222222,0.0,0.128086419753,False,0.0,False,text," a(x)  b(x) we mean limx a(x)/b(x) = 0, when there is no danger of confusion we write
"
17,3.82352941176,0.0,0.0294117647059,False,0.0,False,text,"  instead of +. We use the symbol  when some expression is majorized by a constant
"
14,5.71428571429,0.0,0.0,False,0.0,False,text," multiple of some other expression. We shall frequently abuse notation and denote the elements
"
9,2.0,0.0,0.388888888889,False,0.0,False,text," tZ of T, where t  R, by t.
"
12,6.0,0.0,0.0,False,1.0,True,text," Acknowledgment. The authors would like to thank Terence Tao for helpful discussions
"
15,5.4,0.0,0.0,False,0.0,False,text," related to the material of Section 3, the referee for helpful comments, and Pavel Zorin-Kranich
"
13,4.0,0.0,0.0,False,0.0,False,text," for pointing out a mistake on the statement of Theorems B and B.
"
5,5.4,0.0,0.0,False,0.0,False,text," 2. Background in ergodic theory
"
15,4.86666666667,0.0,0.0,False,0.0,True,text," Below we gather some basic notions and facts from ergodic theory that we use throughout
"
16,5.0,0.0,0.0,False,0.0,False,text," the paper. The reader can nd further background material in ergodic theory in [25], [41], [48].
"
1,1.0,0.0,0.0,False,0.0,False,text," 7
"
17,4.11764705882,0.0588235294118,0.223529411765,False,0.0,False,text," 2.1. Factors in ergodic theory. A homomorphism from a system (X,B, , T ) onto a system
"
26,2.42307692308,0.0,0.473076923077,False,0.0,False,text," (Y,D, , S) is a measurable map  : X  Y , where X is a T -invariant subset of X and Y  is
"
25,2.52,0.0,0.243636363636,False,0.0,False,text," an S-invariant subset of Y , both of full measure, such that  1 =  and S  (x) =   T (x)
"
21,3.2380952381,0.047619047619,0.252380952381,False,0.0,False,text," for x  X. When we have such a homomorphism we say that the system (Y,D, , S) is a factor
"
25,2.72,0.0,0.272,False,0.0,False,text," of the system (X,B, , T ). If the factor map  : X  Y  can be chosen to be injective, then we
"
18,4.05555555556,0.0555555555556,0.394444444444,False,0.0,False,text," say that the systems (X,B, , T ) and (Y,D, , S) are isomorphic (bijective maps on Lebesgue
"
4,7.5,0.0,0.0,False,0.0,False,text," spaces have measurable inverses).
"
16,4.1875,0.0,0.109375,False,0.0,True,text," A factor can be characterized (modulo isomorphism) by the data 1(D) which is a T -
"
16,4.5625,0.0,0.166666666667,False,0.0,False,text," invariant sub--algebra of B, and any T -invariant sub--algebra of B denes a factor; by a
"
17,4.70588235294,0.0,0.0661764705882,False,0.0,False,text," classical abuse of terminology we denote by the same letter the -algebra D and its inverse image
"
25,2.92,0.0,0.367333333333,False,0.0,False,text," by . In other words, if (Y,D, , S) is a factor of (X,B, , T ), we think of D as a sub--algebra of
"
16,4.8125,0.0,0.15625,False,0.0,True,text," B. A factor can also be characterized (modulo isomorphism) by a T -invariant subalgebra F of
"
16,4.5625,0.0,0.299851190476,False,0.0,True,text," L(X,B, ), in which case D is the sub--algebra generated by F, or equivalently, L2(X,D, )
"
17,4.47058823529,0.0,0.135154061625,False,0.0,False,text," is the closure of F in L2(X,B, ). We shall sometimes abuse notation and use the sub--algebra
"
18,4.16666666667,0.0,0.123015873016,False,0.0,True,text," D in place of the subspace L2(X,D, ). For example, if we write that a function is orthogonal
"
14,3.92857142857,0.0,0.122448979592,False,0.0,False,text," to the factor D, we mean it is orthogonal to the subspace L2(X,D, ).
"
18,4.0,0.111111111111,0.249074074074,False,0.0,True,text," If D is a T -invariant sub--algebra of B and f  L2(), we dene the conditional expectation
"
18,4.16666666667,0.222222222222,0.222222222222,False,0.0,True,text," E(f|D) of f with respect to D to be the orthogonal projection of f onto L2(D). We frequently
"
5,4.4,0.0,0.0,False,0.0,False,text," make use of the identities
"
11,2.63636363636,0.0,0.890909090909,False,0.0,True,text," Z E(f|D) d =Z f d, T E(f|D) = E(T f|D).
"
22,3.0,0.0454545454545,0.340909090909,False,0.0,True,text," The transformation T is ergodic if T f = f implies that f = c (a.e.) for some c  C, and
"
23,2.60869565217,0.0869565217391,0.369565217391,False,0.0,False,text," totally ergodic if T rf = f for some r  N implies that f = c (a.e.) for some c  C.
"
17,3.94117647059,0.113445378151,0.223529411765,False,0.0,True,text," Every system (X,B, , T ) has an ergodic decomposition, meaning that we can write  =
"
19,4.05263157895,0.0,0.364912280702,False,0.0,True,text," R t d(t), where  is a probability measure on [0, 1] and t are T -invariant probability measures
"
20,3.55,0.0,0.261666666667,False,0.0,False,text," on (X,B) such that the systems (X,B, t, T ) are ergodic for t  [0, 1]. We sometimes denote
"
9,3.55555555556,0.0,0.259259259259,False,0.0,False,text," the ergodic components by Tt, t  [0, 1].
"
23,3.04347826087,0.304347826087,0.410144927536,False,0.0,True,text," We say that (X,B, , T ) is an inverse limit of a sequence of factors (X,Bj , , T ) if (Bj)jN
"
18,4.05555555556,0.0,0.245014245014,False,0.0,False,text," is an increasing sequence of T -invariant sub--algebras such that WjN Bj = B up to sets of
"
11,6.81818181818,0.0,0.0,False,0.0,False,text," 2.2. Characteristic factors for polynomial averages. Following [31], for every system
"
18,4.05555555556,0.0,0.371825396825,False,0.0,False,text," (X,B, , T ) and function f  L(), we dene inductively the seminorms |||f||| as follows: For
"
23,3.04347826087,0.0,0.208695652174,False,0.0,False,text,"  = 1 we set |||f|||1 = R |E(f|I)|d, where I is the -algebra of T -invariant sets. For   2 we
"
1,3.0,0.0,0.0,False,0.0,False,text," set
"
2,6.0,0.0,0.0,False,0.0,False,text," measure zero.
"
1,3.0,0.0,0.0,False,0.0,False,text," (8)
"
1,10.0,0.0,0.8,False,0.0,False,text," |||f|||2+1
"
3,2.0,0.0,0.166666666667,False,0.0,False,text," +1 = lim
"
1,1.0,0.0,3.0,False,0.0,True,text," N
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
5,2.2,0.0,0.8,False,0.0,False,text," ||| f  T nf|||2
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
2,0.5,0.0,0.5,False,0.0,False,text,"  .
"
22,2.90909090909,0.0,0.151515151515,False,0.0,True,text," It was shown in [31] that for every integer   1, |||  ||| is a seminorm on L() and it
"
16,4.4375,0.0,0.317708333333,False,0.0,False,text," denes factors Z1 = Z1(T ) in the following manner: the T -invariant sub--algebra Z1 is
"
2,7.5,0.0,0.0,False,0.0,False,text," characterized by
"
15,2.6,0.0,0.3,False,0.0,False,text," for f  L(), E(f|Z1) = 0 if and only if |||f||| = 0. 5
"
15,4.0,0.0,0.116666666667,False,0.0,False,text," 5In [31] the authors work with ergodic systems, in which case |||f |||1 = 
"
6,4.5,0.0,0.166666666667,False,0.0,False,text," , and real valued functions, but
"
17,5.41176470588,0.0,0.0,False,0.0,False,text," the whole discussion can be carried out for non-ergodic systems as well and complex valued functions without
"
2,7.5,0.0,0.0,False,0.0,False,text," extra diculties.
"
3,1.0,0.0,2.0,False,0.0,True,text," R f d
"
1,1.0,0.0,0.0,False,0.0,False,text," 8
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
2,3.0,0.0,1.16666666667,False,0.0,False,text," |N| XnN
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,9.0,False,0.0,True,heading," N
"
12,2.58333333333,0.0,0.669913419913,False,0.0,True,body," T p1(n)f1  T p2(n)f2  . . .  T ps(n)fsL2()
"
2,1.5,0.0,0.25,False,0.0,False,after_body," = 0.
"
4,3.75,0.0,0.0,False,0.0,False,text," last fact is true.
"
22,3.5,0.0909090909091,0.333333333333,False,0.0,True,text," We say that Z(T ) is a characteristic factor associated to the family p1, p2, . . . , ps when this
"
12,4.91666666667,0.0,0.0,False,0.0,True,text," We shall also use the following easy corollary of the previous result:
"
25,2.8,0.36,0.458666666667,True,1.0,True,heading," Corollary 2.2. Let (X,B, , T ) be a system, p1, . . . , ps : Zr  Z be a family of non-constant
"
15,5.66666666667,0.866666666667,0.0666666666667,False,0.0,False,body," essentially distinct polynomials, and let Z(T ) be a characteristic factor for this family. Suppose
"
23,3.21739130435,0.54347826087,0.334057971014,False,0.0,False,body," that at least one of the functions f0, f1, . . . , fs  L(X) is orthogonal to the factor Z+1(T ).
"
11,3.63636363636,0.745454545455,0.227272727273,False,0.0,True,body," Then for every Flner sequence (N )NN in Zr we have
"
19,3.78947368421,0.105263157895,0.168421052632,False,0.0,True,text," We call Z the -step nilfactor of the system. By Z we denote the smallest factor that is an
"
23,3.04347826087,0.0434782608696,0.195652173913,False,0.0,False,text," extension of all the factors Z for   N, and we call Z the nilfactor of the system. If f is a
"
19,3.31578947368,0.0,0.245614035088,False,0.0,False,text," bounded function that satises E(f|Z(T )) = 0, then E(f  f|Z1(T  T )) = 0 (this is
"
19,3.94736842105,0.0,0.122807017544,False,0.0,False,text," implicit in [31]). Also, if Tt where t  [0, 1] are the ergodic components of the system, then
"
17,2.82352941176,0.0,0.170028011204,False,0.0,True,text," E(f|Z(T )) = 0 if and only if E(f|Z(Tt)) = 0 for a.e. t  [0, 1].
"
16,4.8125,0.0,0.15625,False,0.0,True,text," The factors Z are of particular interest because they control the limiting behavior in L2 of
"
11,5.90909090909,0.0,0.0,False,0.0,False,text," several multiple ergodic averages. The next result makes this more precise.
"
21,3.52380952381,0.333333333333,0.365079365079,True,1.0,True,text," Theorem 2.1 (Leibman [37]). Let p1, . . . , ps : Zr  Z be a family of non-constant essentially
"
2,10.0,1.0,0.0,False,0.0,False,heading," distinct polynomials.
"
20,3.85,0.55,0.304166666667,False,0.0,True,body," Then there exists a non-negative integer  = (p1, p2, . . . , ps) with the following property: If
"
25,2.84,0.52,0.408666666667,False,0.0,False,text," (X,B, , T ) is a system and at least one of the functions f1, . . . , fs  L(X) is orthogonal to
"
15,3.6,0.713333333333,0.233333333333,False,0.0,False,body," the factor Z(T ), then for every Flner sequence (N )NN in Zr we have
"
1,3.0,0.0,0.0,False,0.0,False,after_body," lim
"
1,1.0,0.0,3.0,False,0.0,True,text," N
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
2,3.0,0.0,1.83333333333,False,0.0,False,heading," |N| XnN
"
13,1.76923076923,0.0,1.04945054945,False,0.0,True,body," Z f0  T p1(n)f1  . . .  T ps(n)fs d
"
1,1.0,0.0,0.0,False,0.0,False,after_body," 2
"
2,1.5,0.0,0.25,False,0.0,False,text," = 0.
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
20,3.8,0.05,0.23,False,0.0,True,text," Proof. If fi is orthogonal to the factor Z+1(T ), then as mentioned above, the function fi  f i
"
15,4.13333333333,0.0,0.133333333333,False,0.0,False,text," is orthogonal to the factor Z(T  T ). Therefore, by Theorem 2.1 the averages
"
20,3.65,0.0,0.639285714286,False,0.0,False,text," |N| XnNZ Z f0(x)  f0(y) f1(T p1(n)x) f1(T p1(n)y)  . . .  fs(T ps(n)x) fs(T ps(n)y) d(x)d(y)
"
16,4.6875,0.0,0.125,False,0.0,True,text," Host and Kra ([31]) showed that the factors Z are of purely algebraic structure (a closely
"
16,5.1875,0.0,0.0,False,0.0,False,text," related result was subsequently proved by Ziegler ([50])), a result that is crucial for our study.
"
18,2.72222222222,0.305555555556,0.238888888889,True,1.0,True,heading," Theorem 2.3 (Host  Kra [31]). Let (X,B, , T ) be a system and   N.
"
9,6.33333333333,0.0,0.0,False,0.0,False,text," converge to zero. This immediately implies the advertised result.
"
16,4.5625,0.875,0.075,False,0.0,True,body," Then a.e. ergodic component of the factor Z(T ) is an inverse limit of -step nilsystems.
"
10,4.2,0.0,0.1,False,0.0,True,after_body," This result justies our name for the factors Z(T ).
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
5,7.8,0.0,0.0,False,0.0,False,text," 3. Equidistribution results on nilmanifolds
"
14,5.28571428571,0.0,0.0,False,0.0,True,text," In this section we give some background material on nilsystems and gather some equidis-
"
13,6.23076923077,0.0,0.0,False,0.0,False,text," tribution results of polynomial sequences on nilmanifolds that will be used later. Nilsystems
"
17,4.70588235294,0.0,0.0,False,0.0,False,text," play a central role in our study because they provide a sucient class for verifying several mul-
"
14,5.71428571429,0.0,0.0,False,0.0,False,text," tiple recurrence results for general measure preserving systems. In fact, when one deals with
"
14,5.21428571429,0.0,0.0,False,0.0,False,text," polynomial recurrence this is usually a consequence of Theorems 2.1 and 2.3. These two
"
1,1.0,0.0,0.0,False,0.0,False,text," 9
"
13,6.46153846154,0.0,0.0,False,0.0,False,text," results, taken together, show that nilsystems control the limiting behavior of the corresponding
"
4,8.5,0.0,0.0,False,0.0,False,text," polynomial multiple ergodic averages.
"
11,6.27272727273,0.0,0.0,False,0.0,False,text," 3.1. Nilmanifolds, denition and basic properties. The reader can nd fundamental
"
13,4.84615384615,0.0,0.0,False,0.0,False,text," properties of nilsystems related to our study in [1], [40], [38], and [36].
"
18,4.05555555556,0.0,0.0833333333333,False,0.0,True,text," Given a topological group G, we denote the identity element by e, and we let G0 denote the
"
20,3.55,0.0,0.208333333333,False,0.0,False,text," connected component of e. If A, B  G, then [A, B] is dened to be the subgroup generated by
"
22,3.04545454545,0.0,0.330627705628,False,0.0,False,text," elements of the form {[a, b] : a  A, b  B} where [a, b] = aba1b1. We dene the commutator
"
20,3.65,0.0916666666667,0.216666666667,False,0.0,False,text," subgroups recursively by G1 = G and Gk+1 = [G, Gk]. A group G is said to be k-step nilpotent
"
22,3.5,0.0,0.0984848484848,False,0.0,False,text," if its (k + 1) commutator Gk+1 is trivial. If G is a k-step nilpotent Lie group and  is a discrete
"
17,4.29411764706,0.102941176471,0.127450980392,False,0.0,False,text," cocompact subgroup, then the compact space X = G/ is said to be a k-step nilmanifold. The
"
20,3.6,0.0,0.2,False,0.0,False,text," group G acts on G/ by left translation where the translation by a xed element a  G is given
"
17,4.11764705882,0.0,0.176470588235,False,0.0,False,text," by Ta(g) = (ag). By mX we denote the unique probability measure on X that is invariant
"
16,4.875,0.1796875,0.125,False,0.0,False,text," under the action of G by left translations (called the normalized Haar measure) and G/ denote
"
19,3.52631578947,0.0,0.253446115288,False,0.0,False,text," the Borel -algebra of G/. Fixing an element a  G, we call the system (G/,G/, m, Ta) a
"
9,5.44444444444,0.295156695157,0.12962962963,False,0.0,False,text," k-step nilsystem. We call the elements of G nilrotations.
"
18,3.66666666667,0.111111111111,0.203703703704,False,0.0,True,text," Given a nilmanifold X = G/, an ergodic nilrotation is an element a  G such that the
"
17,4.17647058824,0.0,0.254901960784,False,0.0,False,text," sequence (an)nN is uniformly distributed on X. If X is a connected nilmanifold and a  G
"
20,3.9,0.0,0.15,False,0.0,False,text," is an ergodic nilrotation it can be shown that for every d  N the nilrotation ad is also ergodic.
"
14,3.78571428571,0.0,0.166666666667,False,1.0,True,heading," Example 1. On the space G = Z  R2, dene multiplication as follows:
"
13,2.61538461538,0.0,0.326923076923,False,0.0,False,body," if g1 = (m, x1, x2) and g2 = (n, y1, y2), then
"
15,1.8,0.0,0.351111111111,False,0.0,False,body," g1  g2 = (m + n, x1 + y1, x2 + y2 + my1).
"
21,3.19047619048,0.0,0.126984126984,False,0.0,True,body," Then G with  is a 2-step nilpotent Lie group and the group G0 = {0}  R2 is Abelian. The
"
19,3.57894736842,0.0,0.131578947368,False,0.0,False,body," discrete subgroup  = Z3 is cocompact and X = G/ is connected. It can be shown that the
"
17,3.47058823529,0.0,0.254901960784,False,0.0,False,body," nilrotation a = (1, , ) is ergodic if and only if  is an irrational number.
"
16,4.6875,0.0,0.0625,False,0.0,True,after_body," We remark that the representation of a nilmanifold X as a homogeneous space of a nilpotent
"
20,3.9,0.0,0.1,False,0.0,True,text," Lie group G is not unique. If X is a connected nilmanifold, it can be shown ([36]) that it admits
"
19,3.47368421053,0.0,0.201754385965,False,0.0,False,text," a representation of the form X = G/ such that: G0 is simply connected and G = G0. In
"
16,4.625,0.571428571429,0.125,False,0.0,False,text," the sequel, whenever X is connected, we will always assume that G satises these two extra
"
1,12.0,0.916666666667,0.0,False,0.0,False,text," assumptions.
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,False,text," k
"
5,1.8,0.0,0.933333333333,False,0.0,False,text,"  . . . apk(n)
"
13,6.0,0.0,0.0769230769231,False,0.0,False,text," 3.2. Qualitative equidistribution results on nilmanifolds. If G is a nilpotent group, then
"
13,2.53846153846,0.0,0.307692307692,False,0.0,False,text," a sequence g : Z  G of the form g(n) = ap1(n)
"
8,3.375,0.0,0.375,False,0.0,False,text," where ai  G and pi are polynomials
"
17,4.52941176471,0.176470588235,0.0294117647059,False,0.0,False,text," taking integer values at the integers is called a polynomial sequence in G. If the maximum of
"
22,3.27272727273,0.0454545454545,0.136363636364,False,0.0,False,text," the degrees of the polynomials pi is at most d we say that the degree of g(n) is at most d. A
"
16,4.4375,0.3125,0.1640625,False,0.0,False,text," polynomial sequence on the nilmanifold X = G/ is a sequence of the form (g(n))nZ where
"
11,2.63636363636,0.0,0.318181818182,False,0.0,False,text," g : Z  G is a polynomial sequence in G.
"
16,4.4375,0.5,0.15625,True,1.0,True,heading," Theorem 3.1 (Leibman [36]). Suppose that X = G/ is a connected nilmanifold and g(n) is
"
20,3.4,0.525,0.216071428571,False,0.0,False,body," a polynomial sequence in G. Let Z = G/([G0, G0]) and  : X  Z be the natural projection.
"
18,3.77777777778,0.722222222222,0.203703703704,False,0.0,True,body," Then for every x  X the sequence (g(n)x)nN is equidistributed in X if and only if the
"
6,6.66666666667,0.75,0.189393939394,False,0.0,False,body," sequence (g(n)(x))nN is equidistributed in Z.
"
17,3.41176470588,0.0,0.166666666667,False,0.0,True,after_body," Note that [G0, G0] is a normal subgroup of G and so G/[G0, G0] is a group.
"
6,9.0,0.0,0.0,False,0.0,False,text," 3.3. Quantitative equidistribution results on nilmanifolds.
"
1,2.0,0.0,0.0,False,0.0,False,text," 10
"
17,4.52941176471,0.352941176471,0.0,False,0.0,False,text," 3.3.1. The case of a connected group. We will later use a quantitative version of Theorem 3.1
"
19,3.84210526316,0.0,0.0,False,0.0,False,text," that was recently obtained by Green and Tao in [28]. In order to state it we need to review
"
7,5.14285714286,0.0,0.0,False,0.0,False,text," some notions that were introduced in [28].
"
16,4.25,0.125,0.104166666667,False,0.0,True,text," Given a nilmanifold X = G/, the horizontal torus is dened to be the compact Abelian
"
17,4.11764705882,0.0,0.230392156863,False,0.0,False,text," group H = G/([G, G]). If X is connected, then H is isomorphic to some nite dimensional
"
17,3.82352941176,0.117647058824,0.156862745098,False,0.0,False,text," torus Tl. By  : X  H we denote the natural projection map. A horizontal character
"
18,3.33333333333,0.0,0.148148148148,False,0.0,False,text," is a continuous homomorphism  of G that satises (g) = (g) for every   . Since
"
14,5.64285714286,0.0,0.107142857143,False,0.0,False,text," every character annihilates [G, G], every horizontal character factors through H, and so can
"
17,4.17647058824,0.0,0.0588235294118,False,0.0,False,text," be thought of as a character of the horizontal torus. Since H is identiable with a nite
"
18,4.16666666667,0.0,0.111111111111,False,0.0,False,text," dimensional torus Tl (we assume that X is connected),  can also be thought of as a character
"
23,2.82608695652,0.0,0.123188405797,False,0.0,False,text," of Tl, in which case there exists a unique   Zl such that (t) =   t, where  denotes the
"
19,3.63157894737,0.0526315789474,0.157894736842,False,0.0,False,text," inner product operation. We refer to  as the frequency of  and kk = || as the frequency
"
3,4.0,0.333333333333,0.333333333333,False,0.0,False,text," magnitude of .
"
22,2.81818181818,0.0,0.224025974026,False,1.0,True,heading," Example 2. Let X be as in Example 1. The map (m, x1, x2) = e(lx1), where l  Z, is a
"
18,4.0,0.0,0.194444444444,False,0.0,False,body," horizontal character of G and the map (m, x1, x2) = x1 (mod 1) induces an identication of
"
16,4.625,0.0,0.05625,False,0.0,False,body," the horizontal torus with T. Under this identication,  is mapped to the character 1(t1) =
"
3,3.66666666667,0.0,0.309523809524,False,0.0,False,body," e(l1t1) of T.
"
1,3.0,0.0,0.0,False,0.0,False,after_body," (9)
"
1,4.0,0.0,0.75,False,0.0,False,text," i=0n
"
21,3.28571428571,0.0,0.214285714286,False,0.0,True,text," If p : Z  R is a polynomial sequence of degree k, then p can be uniquely expressed in the
"
3,3.66666666667,0.0,0.388888888889,False,0.0,False,text," form p(n) =Pk
"
18,3.44444444444,0.0,0.25462962963,False,0.0,False,text," where kxk = d(x, Z). One also gets a similar denition for polynomials p : Z  T.
"
14,4.14285714286,0.0669642857143,0.159226190476,False,0.0,True,text," Given N  N, a nite sequence (g(n))1nN is said to be -equidistributed if
"
11,1.90909090909,0.0,0.590909090909,False,0.0,False,text," ii where i  R. For N  N we dene
"
3,2.33333333333,0.0,0.833333333333,False,0.0,False,text," (N i kik)
"
4,4.25,0.0,0.166666666667,False,0.0,False,text," ke(p(n))kC[N ] = max
"
1,3.0,0.0,1.33333333333,False,0.0,False,text," 1ik
"
14,5.35714285714,0.0,0.0952380952381,False,0.0,False,text," for some appropriate metric dX on X.6 We can now state the quantitative equidistribution
"
12,4.16666666667,0.0,0.0,False,0.0,False,text," result that we shall use. It can be easily derived from [28].
"
17,3.70588235294,0.411764705882,0.176470588235,True,1.0,True,heading," Theorem 3.2 (Green  Tao [28]). Let X = G/ be a nilmanifold with G connected and
"
6,3.66666666667,0.555555555556,0.222222222222,False,0.0,False,body," simply connected and d  N.7
"
20,3.25,0.55,0.2,False,0.0,True,body," Then there exists C = CX,d  0 with the following property: For every N  N and  small
"
21,3.42857142857,0.72619047619,0.190476190476,False,0.0,False,body," enough, if g : Z  G is a polynomial sequence of degree at most d such that the nite sequence
"
12,6.5,0.916666666667,0.143790849673,False,0.0,False,body," (g(n))1nN is not -equidistributed, then there exists a non-trivial horizontal character ,
"
9,3.77777777778,0.666666666667,0.5,False,0.0,False,text," with frequency magnitude kk  C , such that
"
1,4.0,0.0,0.0,False,0.0,False,heading," (10)
"
4,3.75,0.0,0.515151515152,False,0.0,False,body," k(g(n))kC[N ]  c1C
"
22,3.86363636364,0.0,0.113636363636,False,0.0,False,text," 6The metric dX is dened in [28] using a Malcev basis X of X, so the notion of equidistribution we get does
"
22,3.77272727273,0.0,0.0909090909091,False,0.0,False,text," depend on the choice of the Malcev basis X . The exact denition of dX will not be needed anywhere in our
"
5,3.8,0.0,0.0,False,0.0,False,text," article, so we omit it.
"
21,3.85714285714,0.0,0.047619047619,False,0.0,False,text," 7In our context, we assume that the Malcev basis and hence the metric on X is xed. So unlike the more
"
21,4.42857142857,0.0,0.0,False,0.0,False,text," rened result stated in [28], for the result we state here there is no reason to impose restrictions on the Malcev
"
8,3.5,0.0,0.0,False,0.0,False,text," basis we use (or even refer to it).
"
1,2.0,0.0,0.0,False,0.0,False,text," 11
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
3,3.0,0.0,0.944444444444,False,0.0,True,text," F (g(n)) ZX
"
10,3.4,0.0,0.3,False,0.0,False,text," for every Lipschitz function F : X  C where
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
5,2.0,0.0,0.7,False,0.0,True,text," F dmX   kFkLip
"
3,3.33333333333,0.0,0.611111111111,False,0.0,False,text," kFkLip = kFk
"
2,2.0,0.0,0.0,False,0.0,False,text," + sup
"
1,9.0,0.0,1.0,False,0.0,False,text," x,yX,x6=y
"
5,2.0,0.0,0.566666666667,False,0.0,False,text," |F (x)  F (y)|
"
2,3.5,0.0,0.65,False,0.0,False,heading," dX(x, y)
"
13,5.92307692308,0.0,0.102564102564,False,0.0,False,body,"  Condition (10) implies that the nite sequence ((g(n)))1nN1 is not (c2C )-equidistributed
"
17,4.35294117647,0.901960784314,0.0196078431373,False,0.0,False,body," for some absolute constant c1, where  is thought of as a character of the horizontal torus
"
13,3.30769230769,0.564102564103,0.24358974359,False,0.0,True,body," H = Tl and g(n) in (10) as a polynomial sequence in Tl.
"
20,3.5,0.05,0.075,False,0.0,True,heading," Remarks.  We are not going to make use of the explicit form of the upper bounds on kk and
"
17,3.76470588235,0.0,0.248663101604,False,0.0,False,body," k(g(n))kC[N ], any upper bound that depends only on , X, and d, will do just ne.
"
16,3.4375,0.0,0.239583333333,False,0.0,False,body," in G/([G, G]) for all every N1  c2C N , for some absolute constant c2.
"
18,4.22222222222,0.0,0.111111111111,False,1.0,True,heading," Example 3. It is instructive to interpret the previous result in some special case. Let X = T
"
17,4.47058823529,0.0,0.0882352941176,False,0.0,False,body," (with the standard metric), and suppose that the polynomial sequence on T is given by p(n) =
"
26,2.26923076923,0.0,0.288461538462,False,0.0,False,body," nd + q(n) where d  N,   R, and q  Z[x] satises deg q  d  1. In this case Theorem 3.2
"
22,3.13636363636,0.0,0.181818181818,False,0.0,False,body," reads as follows: There exists C = Cd  0 such that for every N  N and every  small enough,
"
18,3.72222222222,0.0,0.387731481481,False,0.0,False,body," if the nite sequence (nd + q(n))1nN is not -equidistributed in T, then kkk  c1C /N d
"
16,2.75,0.0,0.40625,False,0.0,False,body," for some k  Z with |k|  C and some absolute constant c1  0.
"
16,4.75,0.1875,0.0,False,0.0,False,after_body," 3.3.2. The general case. In this subsection we establish an extension of Theorem 3.2 to the
"
18,3.94444444444,0.0,0.166666666667,False,0.0,False,text," case where the group G is not necessarily connected (but we always assume that X = G/ is
"
6,5.33333333333,0.0,0.166666666667,False,0.0,False,text," connected and G is simply connected).
"
26,2.03846153846,0.0512820512821,0.262820512821,False,0.0,True,text," Let G be a group. A map T : G  G is said to be ane if T (g) = b  S(g) for some
"
19,3.68421052632,0.0526315789474,0.236842105263,False,0.0,False,text," homomorphism S of G and b  G. The homomorphism S is said to be unipotent if there exists
"
23,3.0,0.0,0.173913043478,False,0.0,False,text," n  N so that (S  Id)n = 0. In this case we say that the ane transformation T is a unipotent
"
2,9.0,0.0,0.0,False,0.0,False,text," ane transformation.
"
19,3.63157894737,0.122807017544,0.157894736842,False,0.0,True,text," If X = G/ is a connected nilmanifold, the ane torus of X is dened to be the homogeneous
"
15,4.73333333333,0.0,0.118095238095,False,0.0,False,text," space A = G/([G0, G0]). The next lemma (whose statement and proof are reproduced from
"
17,4.58823529412,0.0,0.142156862745,False,0.0,False,text," [23]) explains our terminology (notice that if H is the group G/[G0, G0], then H0 is Abelian).
"
17,4.11764705882,0.470588235294,0.117647058824,True,1.0,True,heading," Proposition 3.3 (F.  Kra [23]). Let X = G/ be a connected nilmanifold and suppose that
"
5,4.0,0.8,0.1,False,0.0,False,body," the group G0 is Abelian.
"
17,3.94117647059,0.649019607843,0.221568627451,False,0.0,True,body," Then the nilrotations Ta(x) = ax, a  G, dened on X with the normalized Haar measure
"
13,6.0,0.974358974359,0.0512820512821,False,0.0,False,body," mX, are simultaneously isomorphic to a collection of unipotent ane transformations on some
"
12,6.5,1.02083333333,0.0,False,0.0,False,body," nite dimensional torus with the normalized Haar measure. Furthermore, the conjugation map
"
6,4.16666666667,1.0,0.0,False,0.0,False,body," can be taken to be continuous.
"
18,4.16666666667,0.0555555555556,0.0555555555556,False,0.0,True,after_body," Proof. We start with a reduction. As we mentioned in Section 3.1 since X is connected we can
"
17,4.17647058824,0.0,0.107843137255,False,0.0,False,text," assume that G = G0. We claim that under our additional assumption that G0 is Abelian we
"
25,2.2,0.0,0.186666666667,False,0.0,False,text," have that 0 =   G0 is a normal subgroup of G. Let 0  0 and g = g0, where g0  G0
"
17,2.88235294118,0.0,0.137254901961,False,0.0,False,text," and   . Since G0 is normal in G, we have that g10g  G0. Moreover,
"
6,2.83333333333,0.0,0.711111111111,False,0.0,True,text," T a(g0) = Ta1 = a0g01.
"
1,2.0,0.0,0.0,False,0.0,False,text," 12
"
3,2.66666666667,0.0,0.777777777778,False,0.0,False,text," g10g = 1g1
"
6,1.33333333333,0.0,0.666666666667,False,0.0,False,text," 0 0g0 = 10  ,
"
19,3.63157894737,0.0,0.105263157895,False,0.0,False,text," the last equality being valid since G0 is Abelian. Hence, g10g  0 and 0 is normal in G,
"
17,4.0,0.0,0.207664884135,False,0.0,False,text," proving our claim. After substituting G/0 for G and /0 for , we have X = (G/0)/(/0).
"
17,4.17647058824,0.0,0.132352941176,False,0.0,True,text," Therefore, we can assume that G0 = {e}. Note that now G0 is a connected compact Abelian
"
12,4.58333333333,0.0,0.0555555555556,False,0.0,True,text," Lie group, and so is isomorphic to some nite dimensional torus Td.
"
22,2.72727272727,0.0,0.204545454545,False,0.0,True,text," Every g  G is uniquely representable in the form g = g0, with g0  G0,   . The map
"
19,3.05263157895,0.0,0.210526315789,False,0.0,False,text,"  : X  G0, given by (g) = g0 is a well dened homeomorphism. Since (hg) = h(g)
"
18,3.88888888889,0.0,0.194444444444,False,0.0,False,text," for every h  G0, the measure () on G0 is invariant under left translations. Thus (m) is
"
24,2.5,0.0,0.340277777778,False,0.0,False,text," the normalized Haar measure on G0. If a = a0, g = g0 with a0, g0  G0 and ,   , then
"
16,3.5,0.0,0.317708333333,False,0.0,False,text," ag = a0g01. Since g01  G0, we have that (ag) = a0g01. Hence  conjugates
"
10,1.8,0.0,0.5,False,0.0,True,text," Ta to T a : G0  G0 dened by
"
20,3.45,0.0,0.266666666667,False,0.0,True,text," Since G0 is Abelian this is an ane map; its linear part g0 7 g01 is unipotent since G is
"
18,3.83333333333,0.0,0.203703703704,False,0.0,False,text," nilpotent. Letting  : G0  Td denote the isomorphism between G0 and Td, we have that Ta
"
14,4.21428571429,0.0,0.404761904762,False,0.0,False,text," is isomorphic to the unipotent ane transformation S = T a1 acting on Td.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
18,3.77777777778,0.0,0.111111111111,False,0.0,True,text," Because of this lemma, we can identify the ane torus A of a nilmanifold X with a nite
"
16,4.875,0.0,0.125,False,0.0,False,text," dimensional torus Tl and think of a nilrotation acting on A as a unipotent ane transformation
"
2,2.5,0.0,0.333333333333,False,0.0,False,text," on Tl.
"
22,2.68181818182,0.0,0.136363636364,False,1.0,True,heading," Example 4. Let X be as in Example 1. We have X  (Z  R2)/(Z  0), so we can assume
"
26,2.23076923077,0.0,0.24358974359,False,0.0,False,body," that we have equality. If a = (m, 1, 2)  Z  T2, then the map  : Z  T2  T2, dened by
"
19,4.05263157895,0.0,0.259649122807,False,0.0,False,body," (k, t1, t2) = (t1, t2) (mod 1), factors through X, and conjugates the nilrotation Ta(x) = ax to
"
11,3.81818181818,0.0,0.181818181818,False,0.0,False,body," the unipotent ane transformation S : T2  T2 dened by
"
11,2.27272727273,0.0,0.372727272727,False,0.0,True,body," S(t1, t2) = (t1 + 1, t2 + mt1 + 2).
"
20,3.25,0.05,0.2,False,0.0,True,after_body," A quasi-character of a nilmanifold X = G/ is a function  : G  C that is a continuous
"
15,4.13333333333,0.0,0.144444444444,False,0.0,False,text," homomorphism of G0 and satises (g) = (g) for every   . Every quasi-character
"
17,4.41176470588,0.0,0.132352941176,False,0.0,False,text," annihilates [G0, G0], so it factors through the ane torus A of X. Under the identication of
"
18,4.05555555556,0.0,0.166666666667,True,0.0,True,text," Proposition 3.3 we have that A  Tl and every quasi-character of X is mapped to a character
"
24,2.79166666667,0.0,0.166666666667,False,0.0,False,text," of Tl. Therefore, thinking of  as a character of Tl we have (t) =   t for some   Zl, where
"
20,3.35,0.05,0.15,False,0.0,False,text,"  denotes the inner product operation. We refer to  as the frequency of  and kk = || as
"
5,4.8,0.4,0.2,False,0.0,False,text," the frequency magnitude of .
"
21,3.28571428571,0.0,0.240537240537,False,1.0,True,heading," Example 5. Let X be as in Example 1. The map (m, x1, x2) = e(l1x1+l2x2), where l1, l2  Z,
"
21,3.28571428571,0.0,0.0714285714286,False,0.0,False,body," is a quasi-character of X. Notice that  is not a homomorphism of G and and so it is not a
"
19,3.73684210526,0.0,0.175438596491,False,0.0,False,body," character of X. The map (m, x1, x2) = (x1, x2) (mod 1) induces an identication of the ane
"
18,3.94444444444,0.0,0.101851851852,False,0.0,False,body," torus (in this case A = X) with T2. Under this identication,  is mapped to the character
"
8,3.25,0.0,0.270833333333,False,0.0,False,body," 1(t1, t2) = e(l1t1 + l2t2) of T2.
"
12,4.58333333333,0.0,0.0,False,0.0,True,after_body," We are now ready to state the advertised extension of Theorem 3.2:
"
15,4.46666666667,0.377777777778,0.133333333333,True,1.0,True,heading," Theorem 3.4 (Corollary of Theorem 3.2). Let X = G/ be a connected nilmanifold (we
"
11,3.81818181818,0.672727272727,0.181818181818,False,0.0,False,body," always assume that G0 is simply connected) and d  N.
"
20,3.25,0.55,0.2,False,0.0,True,body," Then there exists C = CX,d  0 with the following property: For every N  N and  small
"
21,3.42857142857,0.72619047619,0.190476190476,False,0.0,False,body," enough, if g : Z  G is a polynomial sequence of degree at most d such that the nite sequence
"
12,6.41666666667,0.833333333333,0.0604575163399,False,0.0,False,body," (g(n))1nN is not -equidistributed, then there exists a non-trivial quasi-character  with
"
7,4.14285714286,0.571428571429,0.642857142857,False,0.0,False,body," frequency magnitude kk  C such that
"
1,4.0,0.0,0.0,False,0.0,False,body," (11)
"
4,3.75,0.0,0.515151515152,False,0.0,False,body," k(g(n))kC[N ]  c1C
"
17,4.29411764706,0.916666666667,0.0196078431373,False,0.0,False,body," for some absolute constant c1, where we think of  as a character of some nite dimensional
"
15,5.13333333333,0.883333333333,0.1,False,0.0,False,body," torus Tl (the ane torus) and g(n) as a polynomial sequence of unipotent ane transformations
"
2,2.5,0.666666666667,0.333333333333,False,0.0,False,text," on Tl.
"
18,3.77777777778,0.0555555555556,0.175324675325,False,0.0,True,heading," Remark. We have (g(n)) = e(p(n)) for some p  R[x] and so k(g(n))kC[N ] is well dened.
"
16,4.5,0.0,0.0,False,0.0,True,after_body," We rst make some observations that will help us deduce Theorem 3.4 from Theorem 3.2. As
"
18,4.0,0.0,0.111111111111,False,0.0,False,text," we remarked in Section 3.1, if X = G/ is a connected nilmanifold we can assume that every
"
22,2.81818181818,0.0,0.230303030303,False,0.0,False,text," g  G is representable in the form g0, where g0  G0 and   . Therefore, X = (G0)/ can
"
23,2.78260869565,0.0,0.239130434783,False,0.0,False,text," be identied with the nilmanifold G0/(G0  ). If a  G we have a = a0 for some a0  G0 and
"
23,2.65217391304,0.0,0.224637681159,False,0.0,False,text,"   . Since G0 is a normal subgroup of G we have that an = ann for some an  G0. Using
"
16,4.75,0.0,0.15625,False,0.0,False,text," this, one easily veries that any degree d polynomial sequence g(n) in G factors as follows:
"
21,3.19047619048,0.0,0.265079365079,False,0.0,False,text," g(n) = g0(n)(n) where g0(n)  G0 for n  N and (n) is a degree d polynomial sequence in .
"
1,2.0,0.0,0.0,False,0.0,False,text," 13
"
19,4.15789473684,0.0,0.0385964912281,False,0.0,True,text," By Proposition 3.9 in [35] (for a more direct proof see Proposition 4.1 in [9]) we get that g0(n)
"
17,4.64705882353,0.0,0.0882352941176,False,0.0,False,text," is also a polynomial sequence in G0. Moreover, if G is k-step nilpotent, a close examination of
"
17,3.94117647059,0.0,0.0627450980392,False,0.0,False,text," the proof of Proposition 4.1 in [9] reveals that the degree of g0(n) is at most dk.
"
20,3.15,0.0,0.133333333333,False,1.0,True,heading," Example 6. Let X be the nilmanifold of Example 1. We have G0 = {0}  R2 and the map
"
22,3.0,0.0,0.276515151515,False,0.0,False,body,"  : Z  T2  T2, dened by (k, t1, t2) = (0, t1, t2), induces an identication between X and
"
21,3.09523809524,0.0,0.365079365079,False,0.0,False,body," the nilmanifold G0/(G0  )  T2. For a = (2, , ) the polynomial sequence g(n) = an in G
"
2,4.5,0.0,0.0,False,0.0,False,body," factors as
"
3,0.666666666667,0.0,0.666666666667,False,0.0,False,body," 0  n
"
21,1.85714285714,0.0,0.31746031746,False,0.0,False,body," where a0 = (0, , 0), b0 = (0, 0, )  G0, and  = (2, 0, 0)  .
"
3,2.66666666667,0.0,0.466666666667,False,0.0,False,body," g0(n) = an
"
8,4.125,0.0,0.0416666666667,False,0.0,False,body," is a degree 2 polynomial sequence in G0.
"
7,2.42857142857,0.0,0.595238095238,False,0.0,False,body," g(n) = (2n, n, n2) = an
"
3,1.33333333333,0.0,0.222222222222,False,0.0,False,body," 0  bn2
"
1,1.0,0.0,0.0,False,0.0,False,after_body," 0
"
3,1.33333333333,0.0,0.222222222222,False,0.0,False,text," 0  bn2
"
6,3.33333333333,0.0,0.0,False,0.0,True,body," In this case we have that
"
16,4.4375,0.25,0.107954545455,False,0.0,True,after_body," Proof of Theorem 3.4. Let C = CG0/(G0),kd be the positive number dened in Theorem 3.2.
"
15,4.4,0.0,0.248611111111,False,0.0,True,text," Suppose that (g(n))1nN is not -equidistributed in X = G/ for some small enough .
"
16,4.3125,0.0,0.1125,False,0.0,True,text," As discussed before, we have g(n) = g0(n) where g0(n) is a polynomial sequence in G0
"
19,3.57894736842,0.0,0.114035087719,False,0.0,False,text," of degree at most kd. Since X can be identied with G0/(G0  ), it follows that the nite
"
15,4.73333333333,0.0,0.146388888889,False,0.0,False,text," sequence (g0(n)(G0  ))1nN is not -equidistributed in G0/(G0  ). Since G0 is connected
"
16,4.625,0.0,0.0458333333333,False,0.0,False,text," and simply connected, and the polynomial sequence g0(n) is dened in G0, and has degree at
"
15,5.13333333333,0.0,0.111111111111,False,0.0,False,text," most kd, Theorem 3.2 applies. We get that there exists a non-trivial horizontal character 0
"
10,2.4,0.0,0.45,False,0.0,False,text," of G0/(G0  ) such that k0k  C and
"
5,3.6,0.0,0.589743589744,False,0.0,False,text," k0(g0(n))kC[N ]  c1C .
"
16,4.375,0.0,0.1625,False,0.0,True,text," We can lift 0 to a quasi-character of X as follows: Consider the discrete group G/G0.
"
24,2.16666666667,0.0,0.15625,False,0.0,True,text," Since G = G0 we have G/G0 = {G0 :   }. Let  be a subset of  so that the map
"
19,3.57894736842,0.0,0.171929824561,False,0.0,False,text,"   G0, from  to G/G0, is bijective. Then every element h  G has a unique representation
"
25,1.92,0.0,0.24,False,0.0,False,text," h = h0 with h0  G0 and   . We dene the map  : G  C by (h) = 0(h0). Since
"
23,2.60869565217,0.0,0.205797101449,False,0.0,False,text," 0(g00) = 0(g0) for every g0  G0 and 0  G0  , it follows that  agrees with 0 on G0.
"
23,2.21739130435,0.0,0.152173913043,False,0.0,True,text," Furthermore, writing    as  = 0 with 0  G0   and   , and using again that
"
19,3.10526315789,0.0,0.24649122807,False,0.0,False,text," 0(g00) = 0(g0) for g0  G0, one gets that (g0) = (g00) = 0(g00) = 0(g0) = (g0)
"
26,2.19230769231,0.0,0.230769230769,False,0.0,False,text," for every g0  G0 and   . Since every g  G can be written as g = g0 for some g0  G0
"
23,2.17391304348,0.0,0.18115942029,False,0.0,False,text," and   , we conclude that (g) = (g0) = (g) for every g  G and   . We have
"
13,4.69230769231,0.0,0.115384615385,False,0.0,False,text," established that  is a quasi-character of X that extends the character 0.
"
18,3.44444444444,0.0,0.351851851852,False,0.0,True,text," Since (g(n)) = 0(g0(n)), we get that kk = k0k  C and also that equation (11) is
"
17,4.41176470588,0.0,0.117647058824,False,0.0,False,text," satised. Lastly,  factors through the ane torus A and by Proposition 3.3, A can be identied
"
17,4.29411764706,0.0,0.0980392156863,False,0.0,False,text," with a nite dimensional torus Tl. Under this identication  is mapped to a character of Tl
"
17,4.29411764706,0.0,0.0882352941176,False,0.0,False,text," and the polynomial sequence g(n) on the ane torus A is mapped to a polynomial sequence of
"
9,6.0,0.0,0.0740740740741,False,0.0,False,text," unipotent ane transformations on Tl. This completes the proof.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
6,5.33333333333,0.0,0.0,False,0.0,False,text," 4. A model multiple recurrence result
"
13,4.76923076923,0.0,0.0,False,0.0,True,text," We are going to prove Theorem B. For convenience, we repeat its statement:
"
20,3.25,0.55,0.25,True,1.0,True,heading," Theorem B. Suppose that for every r, m  N the set S  Z contains patterns of the form
"
9,2.11111111111,0.0,0.391534391534,False,0.0,False,body," {r(cr,m + mn) : 1  n  Nr,m}
"
16,3.25,0.489583333333,0.328125,False,0.0,False,after_body," where cr,m, Nr,m are integers with limm Nr,m =  for every xed r  N.
"
8,4.0,0.875,0.125,False,0.0,True,body," Then S is a set of multiple recurrence.
"
1,2.0,0.0,0.0,False,0.0,False,after_body," 14
"
20,3.7,0.0,0.0,False,0.0,True,text," Part of the proof of Theorem B (the proof of Proposition 4.5 and the nal step of the proof of
"
15,5.0,0.0,0.0,True,0.0,True,text," Theorem B in Section 4.2) carries almost verbatim to the more complicated Hardy eld setup
"
18,4.27777777778,0.0,0.0,False,0.0,False,text," (proof of Theorem A). In order to better illustrate the ideas we chose to give the argument in
"
18,4.38888888889,0.0,0.0,False,0.0,False,text," this simpler setup. It splits in two parts, we rst reduce things to nilsystems and then verify a
"
5,8.0,0.0,0.0,False,0.0,False,text," multiple recurrence property for nilsystems.
"
14,5.35714285714,0.0,0.0,False,0.0,False,text," 4.1. Reduction to nilsystems. We shall study the multiple ergodic averages that are nat-
"
15,5.0,0.0,0.0,False,0.0,False,text," urally associated to the multiple recurrence problem of Theorem B. We shall show that the
"
14,5.78571428571,0.0,0.00510204081633,False,0.0,False,text," nilfactor is characteristic for L2-convergence of these averages. Using Theorem 2.3 it is then
"
18,4.22222222222,0.0,0.111111111111,False,0.0,False,text," not hard to see that in order to establish Theorem B it suces to verify a multiple recurrence
"
3,7.33333333333,0.0,0.0,False,0.0,False,text," property for nilsystems.
"
18,4.05555555556,0.0,0.0,False,0.0,True,text," As it is often the case when proving such reduction results, a key tool is a Hilbert space
"
16,4.875,0.0,0.0,False,0.0,False,text," version of a classical elementary estimate of van der Corput. Its proof is identical with the
"
10,4.9,0.0,0.0,False,0.0,False,text," proof of this classical estimate (e.g. Lemma 3.1 in [34]).
"
29,2.31034482759,0.344827586207,0.454022988506,True,1.0,True,heading," Lemma 4.1. Let v1, . . . , vN be vectors of a Hilbert space with kvik  1 for i = 1, . . . , N .
"
11,3.45454545455,0.727272727273,0.181818181818,False,0.0,True,body," Then for every integer H between 1 and N we have
"
1,1.0,0.0,0.0,False,0.0,False,after_body," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,2.0,0.0,3.5,False,0.0,False,text," vn
"
1,1.0,0.0,0.0,False,0.0,False,heading," 2
"
4,0.5,0.0,0.0,False,0.0,False,body,"  4  1
"
1,1.0,0.0,1.0,False,0.0,True,after_body," H
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,1.0,0.0,1.0,False,0.0,True,text," H
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," H
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,1.0,False,0.0,True,text," H
"
1,4.0,0.0,1.25,False,0.0,True,text," Xh=1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
2,5.0,0.0,1.41666666667,False,0.0,False,text," hvn+h, vni.
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
23,2.60869565217,0.369565217391,0.360869565217,True,1.0,True,heading," Lemma 4.2. Let (X,B, , T ) be a system and f1, f2  L() satisfy fiZ for i = 1 or 2,
"
21,2.80952380952,0.619047619048,0.285714285714,False,0.0,False,body," where Z is the nilfactor of the system. Let cm, Nm be integers and Nm   as m  .
"
3,5.0,1.0,0.0,False,0.0,True,body," Then the averages
"
1,1.0,0.0,1.0,False,0.0,True,after_body," M
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,4.0,0.0,0.0,False,0.0,False,text," (12)
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
2,2.5,0.0,0.375,False,0.0,True,heading," Xm=1 1
"
9,2.33333333333,0.555555555556,0.277777777778,False,0.0,False,body," converge to 0 in L2() as M  .
"
17,4.35294117647,0.0588235294118,0.0441176470588,False,0.0,True,after_body," Proof. We can assume that f2Z, the proof is similar in the other case. Furthermore, we can
"
14,4.0,0.0,0.214285714286,False,0.0,False,text," assume that kf1kL ,kf2kL  1. Let AM denote the averages (12). We have
"
5,3.8,0.0,0.662857142857,False,0.0,True,body," T cm+mnf1  T 2(cm+mn)f2
"
1,4.0,0.0,0.5,False,0.0,True,after_body," Xn=1
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,5.0,0.0,0.8,False,0.0,False,text," kAMk4
"
2,2.0,0.0,0.25,False,0.0,True,text," L2() 
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,4.0,0.0,1.75,False,0.0,True,text," Xm=1
"
5,3.8,0.0,0.742857142857,False,0.0,True,text," T cm+mnf1  T 2(cm+mn)f2
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,4.0,0.0,0.5,False,0.0,True,text," L2()
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
15,4.8,0.0,0.05,False,0.0,True,text," Using Lemma 4.1 and the Cauchy-Schwarz inequality we get that for every Hm,1 such that
"
17,3.17647058824,0.0,0.271008403361,False,0.0,True,text," Hm,1  Nm (meaning Hm,1/Nm  0 as m  ) the last expression is bounded by
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
1,4.0,0.0,0.5,False,0.0,True,text," Xm=1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
14,3.71428571429,0.0,0.937662337662,False,0.0,True,text," Xn=1Z T cm+mn f1  T 2(cm+mn) f2  T cm+mn+mh1f1 T 2(cm+mn+mh1)f2 d
"
1,5.0,0.0,1.0,False,0.0,True,text," Xh1=1
"
2,6.0,0.0,0.318181818182,False,0.0,False,text," + oM,Hm,1(1).
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,4.0,0.0,0.75,False,0.0,True,text," Hm,1
"
1,4.0,0.0,0.75,False,0.0,True,text," Hm,1
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
12,6.41666666667,0.0,0.15,True,0.0,True,text," Factoring out the measure preserving transformation T cm+mn and using the Cauchy-Schwarz
"
10,4.7,0.0,0.0,False,0.0,False,text," inequality we see that the last expression is bounded by
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,4.0,0.0,0.5,False,0.0,True,text," Xm=1
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,4.0,0.0,0.75,False,0.0,True,text," Hm,1
"
1,4.0,0.0,0.75,False,0.0,True,text," Hm,1
"
1,5.0,0.0,1.0,False,0.0,True,text," Xh1=1
"
5,2.4,0.0,0.522222222222,False,0.0,False,text," f1  T mh1f1L()Z 
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
1,2.0,0.0,0.0,False,0.0,False,text," 15
"
5,4.2,0.0,0.926666666667,False,0.0,True,text," T cm+mn f2 T cm+mn+2mh1f2
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,13.0,0.0,0.692307692308,False,0.0,False,text," d+oM,Hm,1(1).
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
19,3.68421052632,0.0,0.157894736842,True,0.0,True,text," Factoring out T cm and using that kf1kL  1 we see that the last expression is bounded by
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,4.0,0.0,0.75,False,0.0,True,text," Hm,1
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,4.0,0.0,0.75,False,0.0,True,text," Hm,1
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
1,4.0,0.0,0.5,False,0.0,True,text," Xm=1
"
2,6.0,0.0,0.318181818182,False,0.0,False,text," + oM,Hm,1(1).
"
16,5.0,0.0,0.104166666667,False,0.0,True,text," Using Lemma 4.1 again, factoring out T mn, and noticing that the resulting expression no longer
"
18,3.77777777778,0.0,0.169444444444,False,0.0,False,text," depends on n, we get that for every Hm,1, Hm,2  Nm this last expression is bounded by
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
6,2.5,0.0,0.768518518519,False,0.0,True,text," T mn f2  T mn+2mh1f2
"
1,5.0,0.0,1.4,False,0.0,True,text," Xh1=1
"
14,2.35714285714,0.0,0.869047619048,False,0.0,True,text," Xh2=1Z f2  T 2mh1 f1  T mh2 f2  T 2mh1+mh2f2 d
"
20,3.15,0.0,0.210833333333,False,0.0,True,text," We can choose Hm,1, Hm,2 to be  Nm, increase to  as m  , and furthermore such that
"
6,3.5,0.0,0.0833333333333,False,0.0,False,text," the subsets of N3 dened by
"
2,8.5,0.0,0.34375,False,0.0,False,text," + oM,Hm,1,Hm,2(1).
"
1,5.0,0.0,0.4,False,0.0,True,text," Xh1=1
"
1,4.0,0.0,0.5,False,0.0,True,text," Xm=1
"
1,4.0,0.0,0.75,False,0.0,True,text," Hm,2
"
1,4.0,0.0,0.75,False,0.0,True,text," Hm,1
"
1,4.0,0.0,0.75,False,0.0,True,text," Hm,2
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,4.0,0.0,0.75,False,0.0,True,text," Hm,1
"
1,4.0,0.0,0.5,False,0.0,True,text," L2()
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
23,1.52173913043,0.0,0.341304347826,False,0.0,True,text," M = {(m, h1, h2)  N3 : 1  m  M, 1  h1  Hm,1, 1  h2  Hm,2}
"
15,3.6,0.0,0.15,False,0.0,False,text," for M  N, form a Flner sequence. Since f2Z, by Corollary 2.2 we have
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
15,2.8,0.0,0.877777777778,False,0.0,False,text," |M| X(m,h1,h2)MZ f2  T 2mh1 f1  T mh2 f2  T 2mh1+mh2f2 d
"
19,3.52631578947,0.0,0.184210526316,False,0.0,False,text," converges to zero as M  . This shows that the averages AM converge to zero in L2() as
"
7,2.71428571429,0.0,0.142857142857,False,0.0,True,text," M   and nishes the proof.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
17,4.29411764706,0.0,0.0,False,0.0,True,text," The proof of the next result is very similar to the proof of Lemma 4.2, only notationally
"
7,4.28571428571,0.0,0.0,False,0.0,False,text," more complicated, and so we omit it.
"
23,2.86956521739,0.347826086957,0.55652173913,True,1.0,True,heading," Proposition 4.3. Let (X,B, , T ) be a system and f1, . . . , f  L() satisfy fiZ for some
"
25,2.64,0.52,0.46,False,0.0,False,body," i = 1, . . . , , where Z is the nilfactor of the system. Let cm, Nm be integers with Nm  .
"
3,5.0,1.0,0.0,False,0.0,True,body," Then the averages
"
1,1.0,0.0,1.0,False,0.0,True,after_body," M
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
2,2.5,0.0,0.375,False,0.0,True,text," Xm=1 1
"
1,2.0,0.0,1.0,False,0.0,True,heading," Nm
"
12,2.58333333333,0.0,0.684523809524,False,0.0,True,body," T cm+mnf1  T 2(cm+mn)f2  . . .  T (cm+mn)f
"
1,4.0,0.0,0.5,False,0.0,True,body," Xn=1
"
9,2.33333333333,0.555555555556,0.277777777778,False,0.0,False,body," converge to 0 in L2() as M  .
"
8,6.875,0.875,0.0,False,0.0,False,after_body," 4.1.1. Dealing with nilsystems, a key equidistribution result.
"
22,2.81818181818,0.511363636364,0.310606060606,True,1.0,True,heading," Lemma 4.4. Let B  R \ Q and K  N be nite sets, and (em)mN be a sequence of positive
"
8,3.5,0.5625,0.21875,False,0.0,False,body," real numbers such that limm em = 0.
"
16,4.8125,0.0625,0.09375,False,0.0,True,text," Proof. If  is irrational, then the sequence (mk)mN is equidistributed in T. Hence, for every
"
24,1.95833333333,0.354166666667,0.4375,False,0.0,True,body," Then the set S = {m  N : mk  em for some   B, and k  K} has density 0.
"
25,2.2,0.0,0.37,False,0.0,False,after_body,"   0 we have d({m  N : mk  }) = 2. It follows that for xed k  N and  irrational,
"
22,2.86363636364,0.0,0.401515151515,False,0.0,False,text," the set Sk, = {m  N : mk  em} has zero density. Since S is contained in a nite union
"
11,3.54545454545,0.0,0.121212121212,False,0.0,False,text," of sets of the form Sk, it also has zero density.
"
17,3.82352941176,0.0,0.21568627451,False,0.0,True,text," Remember that given a connected nilmanifold X = G/, an element a  G is an ergodic
"
8,6.125,0.0,0.166666666667,False,0.0,False,text," nilrotation if the sequence (an)nN equidistributed in X.
"
18,4.05555555556,0.555555555556,0.222222222222,True,1.0,True,heading," Proposition 4.5. Let X = G/ be a connected nilmanifold and a  G be an ergodic nilrotation.
"
16,3.75,0.75,0.239583333333,False,0.0,True,body," Let cm be positive integers and (Nm)mN be a sequence of integers with Nm  .
"
1,0.0,0.0,0.0,False,0.0,False,after_body," 
"
1,2.0,0.0,0.0,False,0.0,False,text," 16
"
8,2.875,0.625,0.1875,False,0.0,True,body," Then for every F  C(X) we have
"
2,2.5,0.0,0.375,False,0.0,True,after_body," Xm=1 1
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,True,text," M
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
6,2.66666666667,0.0,0.875,False,0.0,True,text," F (acm+mn) =Z F dmX .
"
3,5.0,0.0,0.692307692308,False,0.0,False,text," (acm+mn)C[Nm]  M.
"
23,2.69565217391,0.0434782608696,0.0869565217391,False,0.0,True,text," Proof. It suces to show that for every   0, for a set of m  N of density 1, the nite
"
6,7.0,0.0,0.232638888889,False,0.0,False,text," sequence (acm+mn)1nNm is -equidistributed in X.
"
16,4.0,0.0,0.0520833333333,False,0.0,True,text," Let   0 be small enough, and suppose that the nite sequence (acm+mn)1nNm is not
"
18,3.83333333333,0.0,0.244212962963,False,0.0,False,text," -equidistributed for some m  N. By Theorem 3.4, there exist a constant M = M,X (M does
"
17,3.23529411765,0.0,0.28431372549,False,0.0,False,text," not depend on m, Nm, or cm) and a quasi-character  with kk  M such that
"
1,4.0,0.0,0.0,False,0.0,False,text," (13)
"
18,4.11111111111,0.0,0.111111111111,False,0.0,True,text," As explained in Section 3.3.2, the ane torus A of X can be identied with a nite dimensional
"
20,3.4,0.0,0.15,False,0.0,False,text," torus Tl. After making this identication, we have (t) =   t for some non-zero   Zl, and
"
17,4.11764705882,0.0,0.264705882353,False,0.0,False,text," the nilrotation a induces a d-step unipotent ane transformation Ta : Tl  Tl. Let (a) =
"
23,3.08695652174,0.0,0.449275362319,False,0.0,False,text," (1Z, . . . , sZ), where i  R, be the projection of a on the horizontal torus Ts. Since (a) is
"
18,4.38888888889,0.0,0.416666666667,False,0.0,False,text," an ergodic rotation the real numbers 1, 1, . . . , s are rationally independent. The coordinates
"
3,1.33333333333,0.0,0.666666666667,False,0.0,False,text," of T n
"
5,3.0,0.0,0.4,False,0.0,False,text," a e is a polynomial
"
20,3.2,0.0,0.125,False,0.0,False,text," of n. Moreover, it is not hard to see that the leading term of the polynomial   T n
"
4,2.0,0.0,0.5,False,0.0,False,text," a e has the
"
7,2.42857142857,0.0,0.428571428571,False,0.0,False,text," from nk, where k  d and
"
1,4.0,0.0,0.5,False,0.0,True,text," Xi=1
"
1,4.0,0.0,0.0,False,0.0,False,text," (14)
"
18,3.27777777778,0.0,0.425925925926,False,0.0,False,text," a e, where e is the identity element of Tl, are polynomials of n, and so T n
"
15,2.26666666667,0.0,0.383333333333,False,0.0,False,text," rii, ri  Z not all of them zero with |ri|  c1  M
"
19,3.89473684211,0.0,0.115789473684,False,0.0,False,text," for some constant c1 that depends only on a. From this and the denition of kkC[N ] (see (9))
"
3,4.33333333333,0.0,0.0,False,0.0,False,text," it follows that
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,2.0,0.0,0.5,False,0.0,False,text," k!
"
2,0.5,0.0,0.0,False,0.0,False,text,"  =
"
1,1.0,0.0,1.0,False,0.0,False,text," s
"
7,4.28571428571,0.0,0.0,False,0.0,True,text," Combining this with (13) we get that
"
1,4.0,0.0,0.0,False,0.0,False,text," (15)
"
1,1.0,0.0,1.0,False,0.0,False,text," a
"
3,7.0,0.0,1.07008547009,False,0.0,False,text," (acm+mn)C[Nm] =(T cm+mn
"
2,1.0,0.0,1.5,False,0.0,False,text," mk 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
2,1.0,0.0,1.0,False,0.0,True,text," N k
"
1,1.0,0.0,1.0,False,0.0,False,text," m
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,1.0,0.0,4.0,False,0.0,False,text," m
"
1,2.0,0.0,3.0,False,0.0,False,text," mk
"
4,2.25,0.0,0.75,False,0.0,False,text," e)C[Nm]  N k
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
19,3.73684210526,0.0,0.131578947368,False,0.0,True,text," Since k  d, and by (14) we have only nitely many options for (the irrational) , Lemma 4.4
"
19,4.0,0.0,0.105263157895,False,0.0,False,text," applies and shows that the set of m  N that satisfy equation (15) has zero density. This shows
"
17,3.94117647059,0.0,0.229166666667,False,0.0,False,text," that the nite sequence (acm+mn)1nNm is -equidistributed in X for a set of m  N with
"
5,5.6,0.0,0.0,False,0.0,False,text," density 1, completing the proof.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
16,4.5,0.0,0.0,False,0.0,False,text," 4.2. Conclusion of the argument. We rst use Proposition 4.3 to carry out a reduction to
"
15,5.53333333333,0.0,0.0,False,0.0,False,text," nilsystems step, and then use the equidistribution result of Proposition 4.5 to verify a multiple
"
16,4.875,0.0,0.0,False,0.0,False,text," recurrence result for nilsystems. This will enable us conclude the proof of Theorem B. We rst
"
3,4.33333333333,0.0,0.0,False,0.0,False,text," need one lemma.
"
18,3.72222222222,0.555555555556,0.222222222222,True,1.0,True,text," Lemma 4.6. Let X = G/ be a connected nilmanifold and a  G be an ergodic nilrotation.
"
19,3.73684210526,0.684210526316,0.210526315789,False,0.0,True,body," Then there exists a connected sub-nilmanifold Z of X  such that for a.e. g  G the element
"
13,3.30769230769,0.269230769231,0.628205128205,False,0.0,False,body," bg = (g1ag, g1a2g, . . . , g1ag) acts ergodically on Z.
"
19,3.47368421053,0.0526315789474,0.210526315789,False,0.0,True,heading," Remark. The independence of Z on the generic g  G will not be needed, only that Z is
"
4,5.0,0.0,0.0,False,0.0,False,body," connected will be used.
"
18,4.27777777778,0.0555555555556,0.0,False,0.0,True,after_body," Proof. This is an easy consequence of a limit formula that appears in Theorem 2.2 of [49] (the
"
10,5.0,0.0,0.0,False,0.0,False,text," details of the deduction appear in Corollary 2.10 of [21]).
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,2.0,0.0,0.0,False,0.0,False,text," 17
"
11,3.45454545455,0.0,0.0,False,0.0,True,text," We are now ready to give the proof of Theorem B.
"
13,2.23076923077,0.346153846154,0.192307692308,False,0.0,True,text," Proof of Theorem B. Fix   N. For r  N let
"
9,2.11111111111,0.0,0.391534391534,False,0.0,False,text," {r(cr,m + mn) : 1  n  Nr,m}
"
19,3.63157894737,0.0,0.0526315789474,False,0.0,False,text," be the subset of S dened in the statement of Theorem B. It suces to show that for every
"
21,3.2380952381,0.0,0.371428571429,False,0.0,False,text," system (Y,B, , T ), and f  L() non-negative and not a.e. zero, there exists an r  N such
"
1,4.0,0.0,0.0,False,0.0,False,text," that
"
1,4.0,0.0,0.0,False,0.0,False,text," (16)
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
2,3.0,0.0,0.0,False,0.0,False,text," lim inf
"
1,1.0,0.0,3.0,False,0.0,True,text," M
"
1,4.0,0.0,1.0,False,0.0,True,text," Nr,m
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
2,2.5,0.0,0.375,False,0.0,True,text," Xm=1 1
"
1,4.0,0.0,1.0,False,0.0,True,text," Nr,m
"
16,2.25,0.0,0.784090909091,False,0.0,True,text," Xn=1 Z f  T r(cr,m+mn)f  . . .  T r(cr,m+mn)f d  0.
"
15,4.93333333333,0.0,0.0,False,0.0,True,text," Suppose rst that the system is ergodic. Using a slight modication of Proposition 4.3, we
"
15,5.33333333333,0.0,0.0666666666667,False,0.0,False,text," see that the nilfactor Z is characteristic for the multiple ergodic averages appearing in (16)
"
18,4.11111111111,0.0,0.222222222222,False,0.0,False,text," (remember Z contains all factors Z for   N). Therefore, it suces to verify (16) with E(f|Z)
"
20,3.7,0.0,0.05,False,0.0,False,text," in place of f . As a consequence, by Theorem 2.3, we can assume that our system is an inverse
"
3,6.0,0.0,0.0,False,0.0,False,text," limit of nilsystems.
"
20,3.6,0.0,0.05,False,0.0,True,text," In this case, for given   0 (to be specied later) there exists a nite step nilfactor N such
"
17,2.82352941176,0.0,0.262745098039,False,0.0,False,text," that h = E(f|N ) satises kf  hkL2()  . It is easy to verify that
"
1,4.0,0.0,0.0,False,0.0,False,text," (17)
"
28,0.928571428571,0.0,1.10714285714,False,0.0,True,text," Z f  T nf  . . .  T nf d Z h  T nh  . . .  T nh d  c1
"
19,3.47368421053,0.0,0.157894736842,False,0.0,False,text," for every n  N, where c1 is some absolute constant that depends only on f . Using an
"
16,4.5,0.0,0.125,False,0.0,False,text," appropriate conjugation we can assume that T = Ta is an ergodic nilrotation acting on a
"
16,4.375,0.0,0.166666666667,False,0.0,False,text," nilmanifold X,  = mX, and h is a non-negative, bounded measurable function on X, with
"
16,3.875,0.0,0.34375,False,0.0,True,text," R h dmX =R f d. We are going to work with these extra assumptions henceforth.
"
18,4.11111111111,0.0,0.0555555555556,False,0.0,True,text," Let X0 be the connected component of the nilmanifold X. It is easy to see that there exists
"
17,4.47058823529,0.0,0.147058823529,False,0.0,False,text," an r0  N such that the nilmanifold X is the disjoint union of the connected sub-nilmanifolds
"
20,2.5,0.0,0.446666666667,False,0.0,True,text," Xi = aiX0, i = 0, . . . , r0  1, and ar0 acts ergodically on each Xi.
"
17,4.35294117647,0.0,0.078431372549,False,0.0,True,text," For r = r0, we shall see that (16) follows easily from Szemeredis theorem and the identity
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,4.0,0.0,1.0,False,0.0,True,text," Nr,m
"
1,4.0,0.0,0.0,False,0.0,False,text," (18)
"
1,4.0,0.0,1.0,False,0.0,True,text," Nr,m
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,True,text," M
"
2,2.5,0.0,0.375,False,0.0,True,text," Xm=1 1
"
13,3.69230769231,0.0,0.588141025641,False,0.0,True,text," Xn=1 Z h(x)  h(ar0(cr,m+mn)x)  . . .  h(ar0(cr,m+mn)x) dmX =
"
12,2.66666666667,0.0,0.622916666667,False,0.0,True,text," Xn=1Z h(x)  h(ar0nx)  . . .  h(ar0nx) dmX .
"
15,4.73333333333,0.0,0.0,False,0.0,True,text," We rst verify (18). An easy approximation argument shows that it suces to verify (18)
"
18,4.0,0.0,0.0777777777778,False,0.0,False,text," for every h  C(X). Our plan is to use Lemma 4.5 to establish a stronger pointwise result.
"
21,3.19047619048,0.0,0.194444444444,False,0.0,True,text," We can assume that x = g is an element of X0, a similar argument applies if x  aiX0 for
"
17,2.70588235294,0.0,0.352941176471,False,0.0,False,text," i = 1, . . . , r0  1. An easy computation shows that the limit
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,True,text," N
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
2,2.5,0.0,0.375,False,0.0,True,text," Xm=1 1
"
1,4.0,0.0,1.0,False,0.0,True,text," Nr,m
"
1,4.0,0.0,1.0,False,0.0,True,text," Nr,m
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
7,5.0,0.0,0.625,False,0.0,False,text," h(ar0(cr,m+mn)x)  . . .  h(ar0(cr,m+mn)x)
"
1,4.0,0.0,0.0,False,0.0,False,text," (19)
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,True,text," M
"
5,3.4,0.0,0.0,False,0.0,False,text," is equal to the limit
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,4.0,0.0,0.0,False,0.0,False,text," (20)
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,True,text," M
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
2,2.5,0.0,0.375,False,0.0,True,text," Xm=1 1
"
1,4.0,0.0,1.0,False,0.0,True,text," Nr,m
"
1,4.0,0.0,1.0,False,0.0,True,text," Nr,m
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
1,2.0,0.0,0.0,False,0.0,False,text," 18
"
1,12.0,0.0,0.666666666667,False,0.0,False,text," h(b(cr,m+mn)
"
1,1.0,0.0,1.0,False,0.0,False,text," g
"
1,1.0,0.0,1.0,False,0.0,False,text," )
"
5,4.2,0.0,0.0,False,0.0,False,text," which can be rewritten as
"
1,4.0,0.0,0.0,False,0.0,False,text," (21)
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,True,text," N
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,4.0,0.0,0.75,False,0.0,False,text," h(bn
"
1,1.0,0.0,1.0,False,0.0,False,text," g
"
1,1.0,0.0,0.0,False,0.0,False,text," )
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,True,text," N
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
7,2.85714285714,0.0,0.628968253968,False,0.0,False,text," h(ar0nx)  . . .  h(ar0nx).
"
1,5.0,0.0,0.0,False,0.0,False,text," where
"
9,3.44444444444,0.0,0.819444444444,False,0.0,False,text," bg = (g1ar0g, g1a2r0g, . . . , g1ar0g),
"
27,2.48148148148,0.0,0.49012345679,False,0.0,False,text," h(x1, . . . , xl) = h(gx1)  . . .  h(gx) ( C(X )), and  = . Since ar0 acts ergodically on the
"
15,4.86666666667,0.0,0.155555555556,False,0.0,False,text," connected nilmanifold X0, by Lemma 4.6 there exists a connected sub-nilmanifold Z of X 
"
2,2.5,0.0,0.0,False,0.0,False,text," 0 such
"
20,3.5,0.0,0.2,False,0.0,False,text," that for a.e. g  G the element bg acts ergodically on Z. For those values of g, Lemma 4.5
"
21,3.61904761905,0.0,0.214285714286,False,0.0,False,text," gives that the limit (20) is equal to R h dmZ . Since bg acts ergodically on Z, this integral is
"
5,3.8,0.0,0.0,False,0.0,False,text," also equal to the limit
"
14,4.28571428571,0.0,0.0,False,0.0,True,text," Next we use (18) to establish (16). In this regard, we estimate the limit
"
19,3.94736842105,0.0,0.0701754385965,False,0.0,True,text," We have established the equality of the limits (19) and (21) for a.e. x  X0. As we mentioned,
"
14,4.14285714286,0.0,0.142857142857,False,0.0,False,text," a similar argument applies for a.e. x  X and this readily implies (18).
"
12,2.66666666667,0.0,0.622916666667,False,0.0,True,text," Xn=1Z h(x)  h(ar0nx)  . . .  h(ar0nx) dmX .
"
14,5.57142857143,0.0,0.0714285714286,False,0.0,True,text," Since the function h is a.e. non-negative, using a uniform version of Furstenbergs multiple
"
18,4.38888888889,0.0,0.0,False,0.0,False,text," recurrence theorem (see e.g. [7]) we get that the limit (22) is bounded from below by a positive
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,True,text," N
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,4.0,0.0,0.0,False,0.0,False,text," (22)
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
19,3.57894736842,0.0,0.407894736842,False,0.0,False,text," constant c2 that depends only on R h dmX = R f d (and is independent of r0). Combining
"
8,3.625,0.0,0.0,False,0.0,False,text," this with (17) and (18), we get that
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
2,3.0,0.0,0.0,False,0.0,False,text," lim inf
"
1,1.0,0.0,3.0,False,0.0,True,text," M
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
2,2.5,0.0,0.375,False,0.0,True,text," Xm=1 1
"
1,5.0,0.0,0.8,False,0.0,True,text," Nr0,m
"
1,5.0,0.0,0.8,False,0.0,True,text," Nr0,m
"
18,2.38888888889,0.0,0.739316239316,False,0.0,True,text," Xn=1 Z f  T r0(cr0,m+mn)f  . . .  T r0(cr0,m+mn)f d  c2  c1.
"
19,3.78947368421,0.0,0.145614035088,False,0.0,True,text," Since the positive constants c1, c2 depend only on f we can choose   c2/c1 and verify (16)
"
4,2.0,0.0,0.333333333333,False,0.0,False,text," for r = r0.
"
15,5.0,0.0,0.0,False,0.0,True,text," To deal with the general case, we use an ergodic decomposition argument. For a.e. ergodic
"
18,3.72222222222,0.0,0.111111111111,False,0.0,False,text," component we can use the previous argument to nd an r  N for which (16) holds. Since
"
20,3.7,0.0,0.1,False,0.0,False,text," there are only countably many choices for r, there exists an r0  N for which (16) holds for a
"
11,5.63636363636,0.0,0.0,False,0.0,False,text," set of ergodic components that has positive measure. The result follows.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
6,6.33333333333,0.0,0.0,False,0.0,False,text," 5. Polynomial structure for Hardy sequences
"
20,3.55,0.0,0.1,False,0.0,False,text," 5.1. Result and idea of the proof. In this section we shall show that if the function a  H
"
17,4.11764705882,0.0,0.147058823529,False,0.0,False,text," satises xk  a(x)  xk+1 for some non-negative integer k, then the range of the sequence
"
14,5.42857142857,0.0,0.0238095238095,False,0.0,False,text," [a(n)] contains some suitably chosen polynomial patterns. We are going to work with these
"
11,4.27272727273,0.0,0.0,False,0.0,False,text," patterns in the next section in order to prove Theorem A.
"
18,3.72222222222,0.444444444444,0.222222222222,True,1.0,True,heading," Proposition 5.1. Let a  H be eventually positive and satisfy xk  a(x)  xk+1 for some
"
3,7.0,0.833333333333,0.166666666667,False,0.0,False,body," non-negative integer k.
"
18,3.72222222222,0.666666666667,0.206349206349,False,0.0,True,body," Then for every r  N, and every large enough m  N, there exist polynomials pr,m(n) of
"
24,2.25,0.465277777778,0.25,False,0.0,False,body," degree at most k  1, and Nr,m  N with Nr,m   (as m   and r is xed), such that
"
14,2.5,0.0,0.423469387755,False,0.0,False,body," {r(mnk + pr,m(n)), 1  n  Nr,m}  {[a(n)] : n  N}.
"
1,2.0,0.0,0.0,False,0.0,False,text," 19
"
16,3.1875,0.0625,0.0625,False,0.0,True,heading," Remark. For k = 1 we get the same patterns as in Theorems B and B.
"
24,3.0,0.0,0.166666666667,False,0.0,True,after_body," The initial idea is rather simple. Let us illustrate it for r = k = 1. In this case x  a(x)  x2
"
11,4.72727272727,0.0,0.0,False,0.0,False,text," and we are searching to nd arithmetic progressions of the form
"
8,1.5,0.0,0.5,False,0.0,False,text," {cm + mn, 1  n  Nm}
"
20,3.35,0.0,0.266666666667,False,0.0,False,text," within the range of [a(n)] for some cm, Nm  N with Nm  . Using the Taylor expansion of
"
13,4.23076923077,0.0,0.115384615385,False,0.0,False,text," the function a(x) around an integer nm (to be specied later) we get
"
9,3.22222222222,0.0,0.39537037037,False,0.0,False,text," a(nm + n) = a(nm) + a(nm)n + a(n)n2/2
"
1,4.0,0.0,0.0,False,0.0,False,text," (23)
"
24,2.66666666667,0.0,0.329861111111,False,0.0,False,text," for some n  [nm, nm + n]. Since a  H is eventually positive and x  a(x)  x2, it is easy
"
23,2.39130434783,0.0,0.25,False,0.0,False,text," to see that 1  a(x)  x, a(x)  0, and a(x)  0 (see Lemma 5.2). Since a  H, the
"
18,4.11111111111,0.0,0.194444444444,False,0.0,False,text," estimate for a easily implies that the range of the sequence [a(n)] is a conite subset of N
"
18,3.88888888889,0.0,0.22619047619,False,0.0,False,text," (see Lemma 5.2). Therefore, for large m there exists nm  N such that [a(nm)] = m. Since
"
21,2.90476190476,0.0,0.261904761905,False,0.0,False,text," nm  , we have a(n)  0 (also a(n)  0). Therefore, if we could choose nm so that in
"
17,4.23529411765,0.0,0.174789915966,False,0.0,False,text," addition to [a(nm)] = m we have that the fractional parts of the numbers a(nm) and a(nm)
"
12,3.0,0.0,0.166666666667,False,0.0,False,text," converge to 0 as m  , then (23) would give that
"
11,3.0,0.0,0.362445887446,False,0.0,False,text," [a(nm + n)] = [a(nm)] + [a(nm)]n = cm + mn,
"
3,3.33333333333,0.0,0.47619047619,False,0.0,False,text," cm = [a(nm)]
"
21,2.80952380952,0.0,0.277777777778,False,0.0,False,text," for every n  [1, Nm], for some Nm  N with Nm  . This is exactly what we wanted.
"
18,4.27777777778,0.0,0.0,False,0.0,True,text," To carry out this plan we shall need an equidistribution result that will enable us to get the
"
15,5.0,0.0,0.0,False,0.0,False,text," small fractional parts assumption that we mentioned before. We are going to prove this by
"
12,5.5,0.0,0.0,False,0.0,False,text," using a classical estimate of van der Corput on oscillatory exponential sums.
"
19,3.52631578947,0.0,0.19298245614,False,0.0,False,text," 5.2. Some basic properties. As we explained before, if a  H and b  LE, then the limit
"
14,5.57142857143,0.0,0.187698412698,False,0.0,False,text," limx a(x)/b(x) exists (possibly innite). Hence, if both functions a(x), b(x) converge to 0,
"
16,4.0,0.0,0.234722222222,False,0.0,False,text," or to , then by LHospitals rule we have limx a(x)/b(x) = limx a(x)/b(x). We are
"
19,3.89473684211,0.0,0.0526315789474,False,0.0,False,text," going to make use of this fact to prove some basic properties of elements of H that we shall
"
2,7.0,0.0,0.0,False,0.0,False,text," frequently use:
"
19,3.42105263158,0.473684210526,0.210526315789,True,1.0,True,heading," Lemma 5.2. Let a  H be eventually positive and satisfy xk  a(x)  xk+1 for some non-
"
4,5.25,0.875,0.125,False,0.0,False,body," negative integer k. Then
"
23,2.69565217391,0.253623188406,0.311180124224,False,0.0,False,body," (i) xkl  a(l)(x)  xk+1l for every l  k, x1  a(k+1)(x)  1 for every   0,8 and a(l)(x)
"
10,3.3,0.55,0.2,False,0.0,False,body," is eventually positive for every l  k + 1.
"
19,3.26315789474,0.421052631579,0.233082706767,False,0.0,False,body," (ii) a(l)(x) is eventually increasing for 0  l  k, and decreasing for l = k + 1.
"
27,2.25925925926,0.327160493827,0.312345679012,False,0.0,False,body," (iii) If k 6= 0 for every non-zero c  R we have xk1  a(x + c)  a(x)  xk. If k = 0, then
"
18,2.72222222222,0.537037037037,0.138888888889,False,0.0,False,body," a(x + c)  a(x)  1 and the range of [a(n)] is a conite subset of N.
"
23,2.73913043478,0.521739130435,0.249482401656,False,0.0,False,body," (iv) For every c  R we have a(x + c)/a(x)  1 as x  . More generally the same holds if
"
7,3.57142857143,0.571428571429,0.214285714286,False,0.0,False,body," c = c(x) is a bounded function.
"
11,5.0,0.0909090909091,0.030303030303,False,0.0,True,after_body," Proof. (i) All parts are a direct consequence of LHospitals rule.
"
23,3.0,0.0,0.221014492754,False,0.0,False,text," (ii) If l  k the result follows immediately from part (i). If l = k + 1 by part (i) we have
"
15,5.4,0.0,0.0666666666667,False,0.0,False,text," that a(k+1)(x)  0 and a(k+1)(x) is eventually positive. It follows that a(k+1)(x) is eventually
"
1,11.0,0.0,0.0,False,0.0,False,text," decreasing.
"
21,3.09523809524,0.0,0.230952380952,False,0.0,False,text," (iii) Let k 6= 0. By part (i) we have that xk1  a(x)  xk. The result now follows from
"
21,3.2380952381,0.0,0.0992063492063,False,0.0,False,text," the mean value theorem. Suppose now that k = 0. By part (i) we have a(x)  1 and the mean
"
24,2.45833333333,0.0,0.180555555556,False,0.0,False,text," value theorem gives that a(x + c)  a(x)  1. Since a(n)  + and a(n + 1)  a(n)  0 it
"
14,4.07142857143,0.0,0.0595238095238,False,0.0,False,text," follows that the range of the sequence [a(n)] is a conite subset of N.
"
27,2.85185185185,0.0,0.240740740741,False,0.0,False,text," 8Take a(x) = log x or a(x) = log log x and k = 0, l = 1, to see the necessity of introducing the term .
"
1,2.0,0.0,0.0,False,0.0,False,text," 20
"
24,2.83333333333,0.0,0.243055555556,False,0.0,False,text," (iv) Notice that a(x + c) = a(x) + b(x) where b(x) = a(x + c)  a(x)  a(x) by part (iii). It
"
21,3.33333333333,0.0,0.233560090703,False,0.0,False,text," follows that a(x + c)/a(x)  1. Suppose now that c = c(x) satises |c(x)|  M . Since a(x) is
"
16,4.5625,0.0,0.34375,False,0.0,False,text," eventually positive and increasing, we have a(x M )/a(x)  a(x+ c(x))/a(x)  a(x+ M )/a(x)
"
16,4.3125,0.0,0.0625,False,0.0,False,text," for all large enough x. The result now follows from the case where c(x) is constant.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,4.0,1.0,0.0,False,0.0,True,text," Then
"
16,4.4375,0.0,0.125,False,0.0,True,text," Given some growth estimates for a  H we shall derive some estimates about the composi-
"
11,4.09090909091,0.0,0.212121212121,False,0.0,False,text," tional inverse a1 of a (which is not necessarily in H).
"
22,2.86363636364,0.378787878788,0.265151515152,True,1.0,True,heading," Lemma 5.3. Let a  H be eventually positive and satisfy x  a(x)  x for some   (0, 1).
"
6,2.16666666667,0.0416666666667,0.447222222222,False,0.0,False,body," (i) x  a1(x)  x1/.
"
14,4.0,0.335714285714,0.238265306122,False,0.0,False,body," (ii) (a1) is eventually increasing, 1  (a1)(x)  x1/1, and (a1)(x)  1.
"
17,2.52941176471,0.352941176471,0.345098039216,False,0.0,False,body," (iii) For every c  R we have (a1)(x + c)/(a1)(x)  1 as x  .
"
19,3.89473684211,0.0526315789474,0.105263157895,False,0.0,True,after_body," Proof. (i) By Lemma 5.2 we have that a is eventually increasing, so the same is true for a1.
"
14,5.0,0.0,0.164285714286,False,0.0,True,text," Hence, our hypothesis gives a1(x)  x  a1(x), which implies the advertised estimate.
"
12,4.41666666667,0.0,0.208333333333,False,0.0,False,text," (ii) By Lemma 5.2 we have that a is eventually decreasing. Since
"
1,4.0,0.0,0.0,False,0.0,False,text," (24)
"
2,4.0,0.0,0.285714285714,False,0.0,False,text," (a1)(x) =
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,8.0,0.0,0.625,False,0.0,False,text," a(a1(x))
"
13,6.07692307692,0.0,0.134615384615,False,0.0,False,text," and a1 is eventually increasing, it follows immediately that (a1) is eventually increasing.
"
5,4.8,0.0,0.0,False,0.0,True,text," Using LHospitals rule we get
"
1,4.0,0.0,0.0,False,0.0,False,text," (25)
"
5,1.8,0.0,0.45,False,0.0,False,text," x1+  a(x)  1.
"
17,4.41176470588,0.0,0.0147058823529,False,0.0,True,text," Combining (24), (25), and part (i), we get the rst estimate, and similarly we deal with the
"
1,7.0,0.0,0.0,False,0.0,False,text," second.
"
20,3.85,0.0,0.105,False,0.0,False,text," (iii) Using the estimates in (ii), the proof is the same as in part (iii) and (iv) of Lemma 5.2.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
12,6.66666666667,0.0,0.0,False,0.0,False,text," 5.3. An equidistribution result. In this subsection we shall establish the equidistribution
"
18,4.27777777778,0.0,0.0,False,0.0,False,text," result needed for the proof of Proposition 5.1. We rst state and prove it in its simplest form
"
14,5.57142857143,0.0,0.0,True,0.0,False,text," (Lemma 5.6), and subsequently we prove a more technical variation (Proposition 5.7) that is
"
5,5.4,0.0,0.0,False,0.0,False,text," better suited for our purposes.
"
16,4.8125,0.0,0.0,False,0.0,True,text," The following estimate is crucial for the results in this subsection. The proof can be found
"
4,4.75,0.0,0.0,False,0.0,False,text," in [34] (Theorem 2.7).
"
1,4.0,1.0,0.0,False,0.0,True,text," Then
"
21,3.57142857143,0.43253968254,0.238095238095,True,1.0,True,heading," Lemma 5.4 (van der Corput [47]). Let k, l be integers with k  l and let f be twice dierentiable
"
20,1.65,0.216666666667,0.258333333333,False,0.0,False,body," on [k, l] with f(x)    0 or f(x)    0 for x  [k, l].
"
9,2.44444444444,0.0,0.32037037037,False,0.0,False,body," e(f (n))  (|f(l)  f(k)| + 2) 4
"
1,0.0,0.0,0.0,False,0.0,False,after_body," 
"
2,1.5,0.0,0.5,False,0.0,False,text," + 3.
"
1,1.0,0.0,1.0,False,0.0,False,text," l
"
1,4.0,0.0,0.75,False,0.0,True,text," Xn=k
"
16,4.625,0.0,0.0833333333333,False,1.125,True,heading," Denition 5.5. Let (Im)mN be a sequence of intervals of integers (with lengths going to ).
"
18,4.22222222222,0.333333333333,0.12037037037,False,0.0,True,body," We say that the sequence a(n) with values in Rd, is equidistributed in Td with respect to the
"
15,3.8,0.0666666666667,0.177777777778,False,0.0,False,body," intervals Im, if for every Riemann integrable function  : Td  C we have
"
1,3.0,0.0,0.0,False,0.0,False,after_body," lim
"
1,1.0,0.0,3.0,False,0.0,False,text," m
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
2,4.0,0.0,1.125,False,0.0,False,text," |Im| XnIm
"
2,5.0,0.0,0.625,False,0.0,False,text," (a(n)) =ZTd
"
2,2.5,0.0,0.5,False,0.0,False,text,"  dmTd.
"
16,4.875,0.0,0.0,False,0.0,True,text," As it is well known, it suces to verify the previous identity for every non-trivial character
"
12,2.75,0.0,0.0833333333333,False,0.0,False,text,"  =  of Td (in which case the integral is 0).
"
1,2.0,0.0,0.0,False,0.0,False,text," 21
"
17,3.52941176471,0.439775910364,0.225490196078,True,1.0,True,heading," Lemma 5.6. Suppose that a  H is eventually positive and satises x  a(x)  x2.
"
15,3.86666666667,0.733333333333,0.0555555555556,False,0.0,True,body," Then for every   0 there exists a sequence of intervals (Im)mN such that
"
18,2.27777777778,0.388888888889,0.393518518519,False,0.0,False,body," (i) m  a(n)  m + , for every n  Im and m large enough, and
"
14,4.78571428571,0.738095238095,0.190476190476,False,0.0,False,body," (ii) the sequence a(n) is equidistributed in T with respect to the intervals Im.
"
20,3.15,0.05,0.15,False,0.0,True,after_body," Proof. Let   0. Suppose for the moment that km, lm  N have been chosen so that the
"
18,4.27777777778,0.0,0.161111111111,False,0.0,False,text," intervals Im = [km, lm], satisfy condition (i). Let us see how we deal with condition (ii). We
"
11,4.45454545455,0.0,0.0909090909091,False,0.0,False,text," need to guarantee that for every non-zero integer s we have
"
1,4.0,0.0,0.0,False,0.0,False,text," (26)
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,False,text," m
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
3,1.33333333333,0.0,0.666666666667,False,0.0,False,text," lm  km
"
1,2.0,0.0,1.0,False,0.0,False,text," lm
"
1,5.0,0.0,0.8,False,0.0,True,text," Xn=km
"
3,3.66666666667,0.0,0.333333333333,False,0.0,False,text," e(sa(n)) = 0.
"
22,2.95454545455,0.0,0.125,False,0.0,True,text," To estimate the average in (26) we are going to use Lemma 5.4. Since m  a(n)  m +  for
"
18,3.83333333333,0.0,0.305555555556,False,0.0,False,text," n  Im, we have |a(lm) a(km)|  , and since a(x) is eventually decreasing (by Lemma 5.2)
"
17,3.64705882353,0.0,0.117647058824,False,0.0,False,text," we have for large m that  = a(lm) satises the assumptions of Lemma 5.4. We get
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
3,1.33333333333,0.0,0.666666666667,False,0.0,False,text," lm  km
"
1,2.0,0.0,1.0,False,0.0,False,text," lm
"
1,5.0,0.0,0.8,False,0.0,True,text," Xn=km
"
2,4.0,0.0,0.25,False,0.0,False,text," e(sa(n)) 
"
3,1.0,0.0,0.666666666667,False,0.0,False,text," 2 + s
"
4,1.0,0.0,0.5,False,0.0,False,text," lm  km 
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
1,7.0,0.0,1.0,False,0.0,False,text," psa(lm)
"
2,1.5,0.0,0.5,False,0.0,False,text," + 3.
"
11,4.45454545455,0.0,0.0,False,0.0,True,text," Therefore, in order to establish (26) it suces to show that
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
1,4.0,0.0,0.0,False,0.0,False,text," (27)
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,False,text," m
"
2,1.5,0.0,0.25,False,0.0,False,text," = 0.
"
3,4.0,0.0,0.518518518519,False,0.0,False,text," (lm  km)pa(lm)
"
20,3.6,0.0,0.166666666667,False,0.0,True,text," We shall now make a choice of km, lm  N so that conditions (i) and (27) are satised. Notice
"
13,4.53846153846,0.0,0.0961538461538,False,0.0,False,text," that Lemma 5.2 implies that a(x) increases to +. We consider two cases:
"
20,3.1,0.0,0.108333333333,False,1.0,True,text," Case 1. Suppose that a(x)  x1+ for every   0. Let km be the rst integer such that
"
5,2.6,0.0,0.25,False,0.0,False,text," a(n)  m, and dene
"
6,1.83333333333,0.0,0.625,False,0.0,True,text," Im = [km, km + k
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
1,3.0,0.0,0.666666666667,False,0.0,False,text," m].
"
18,3.61111111111,0.0,0.103703703704,False,0.0,True,text," We rst show that condition (i) is satised. Choose any   (0, 1/4). Since a(n)  n1+,
"
18,3.66666666667,0.0,0.0972222222222,False,0.0,False,text," arguing as in Lemma 5.2 we get a(n)  n1+. Using the mean value theorem and the fact
"
10,4.7,0.0,0.075,False,0.0,False,text," that a(x) is eventually increasing (by Lemma 5.2) we get
"
2,3.5,0.0,0.0,False,0.0,False,text," (28) max
"
1,5.0,0.0,0.8,False,0.0,False,text," nk3/4
"
1,1.0,0.0,1.0,False,0.0,False,text," m
"
9,2.33333333333,0.0,0.440740740741,False,0.0,False,text," (a(km + n)  a(km)) = a(km + k
"
5,1.8,0.0,0.46,False,0.0,False,text," m)  a(km) = k
"
5,1.2,0.0,0.65,False,0.0,False,text," m  a(m)  k
"
3,1.33333333333,0.0,0.666666666667,False,0.0,False,text," m  k1+
"
3,1.0,0.0,0.5,False,0.0,False,text," m  0.
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
19,3.47368421053,0.0,0.144736842105,False,0.0,True,text," Furthermore, since a(n + 1)  a(n)  0 (by Lemma 5.2), form the denition of km we have
"
19,3.36842105263,0.0,0.217543859649,False,0.0,False,text," that a(km)  m as m  . From this and (28) it follows that condition (i) is satised.
"
20,3.25,0.0,0.225,False,0.0,True,text," It remains to verify (27). Since a(n)  n we get by Lemma 5.2 that a(n)  n1 for every
"
16,2.6875,0.0,0.0208333333333,False,0.0,False,text,"   0. Using this, and keeping in mind that   1/4 we nd that
"
3,1.66666666667,0.0,0.555555555556,False,0.0,False,text," (km + k
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
1,1.0,0.0,1.0,False,0.0,False,text," k
"
1,1.0,0.0,1.0,False,0.0,False,text," m
"
10,4.2,0.0,0.0,False,0.0,True,text," This proves (27) and completes the proof of Case 1.
"
4,3.0,0.0,0.388888888889,False,0.0,False,text," (lm  km)pa(lm) 
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
1,2.0,0.0,0.5,False,0.0,False,text," m)
"
1,2.0,0.0,0.5,False,0.0,False,text," 1+
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
2,2.0,0.0,0.375,False,0.0,False,text,"  k1/8
"
3,1.0,0.0,0.5,False,0.0,False,text," m  0.
"
20,2.8,0.0,0.0833333333333,False,1.0,True,text," Case 2. Suppose that x1+  a(x)  x2 for some   0. Using Lemma 5.2 we nd that
"
21,2.85714285714,0.0,0.297619047619,False,0.0,False,text," x  a(x)  x so we can apply Lemma 5.3 for a in place of a. For convenience we set
"
3,4.0,0.0,0.357142857143,False,0.0,False,text," b(x) = (a)1(x)
"
15,4.73333333333,0.0,0.0,False,0.0,False,text," and summarize some properties that follow from Lemmas 5.2, 5.3 and will be used later
"
1,4.0,0.0,0.0,False,0.0,False,text," (29)
"
7,1.71428571429,0.0,0.321428571429,False,0.0,False,text," a(n + 1)  a(n)  0,
"
4,4.0,0.0,0.6875,False,0.0,False,text," b(n) increases to ,
"
1,2.0,0.0,0.0,False,0.0,False,text," 22
"
10,2.3,0.0,0.371428571429,False,0.0,False,text," b(n + c)/b(n)  1 for every c  R.
"
2,3.0,0.0,0.0,False,0.0,True,text," We dene
"
16,1.5,0.0,0.578125,False,0.0,True,text," Im = {n  N : m  a(n)  m + } = [km, lm].
"
14,5.57142857143,0.0,0.0738095238095,False,0.0,True,text," Obviously, condition (i) is satised, therefore it remains to verify (27). Since a(n+1)a(n) 
"
20,3.3,0.0,0.141666666667,False,0.0,False,text," 0 (by (29)) we get from the denition of km that a(km)m  0. It follows that b(m)km  0,
"
20,3.55,0.0,0.233333333333,False,0.0,False,text," and similarly we get b(m + )  lm  0. Since b is eventually increasing (by (29)), using the
"
9,3.77777777778,0.0,0.111111111111,False,0.0,False,text," mean value theorem we get for large m that
"
1,4.0,0.0,0.0,False,0.0,False,text," (30)
"
4,1.0,0.0,0.5,False,0.0,False,text," lm  km 
"
4,5.5,0.0,0.1875,False,0.0,True,text," Furthermore, since b(x) =
"
10,2.2,0.0,0.266666666667,False,0.0,False,text," using that b(m + )  lm  0 gives
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
4,1.25,0.0,0.25,False,0.0,False,text," 2  b(m) 
"
8,1.625,0.0,0.2375,False,0.0,False,text," 2  (b(m + )  b(m)) =
"
7,4.42857142857,0.0,0.204081632653,False,0.0,False,text," a(b(x)) , or equivalently a(b(x)) = 1
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
3,2.0,0.0,0.266666666667,False,0.0,False,text," 2  b(m).
"
9,2.11111111111,0.0,0.305555555556,False,0.0,False,text," b(x) , setting x = m +  and
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
8,3.5,0.0,0.125,False,0.0,True,text," It follows that for large m we have
"
1,4.0,0.0,0.0,False,0.0,False,text," (31)
"
2,2.5,0.0,0.5,False,0.0,False,text," a(lm) 
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
5,1.4,0.0,0.5,False,0.0,False,text," b(m + )  0.
"
2,2.5,0.0,0.5,False,0.0,False,text," a(lm) 
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
4,1.5,0.0,0.5,False,0.0,False,text," 2 b(m + )
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
10,3.8,0.0,0.1,False,0.0,True,text," Combining (30) and (31) we get for large m that
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
9,2.22222222222,0.0,0.450617283951,False,0.0,False,text," (lm  km)pa(lm)  C2  pb(m + )
"
1,4.0,0.0,0.75,False,0.0,False,text," b(m)
"
6,1.5,0.0,0.75,False,0.0,False,text," = C2 s b(m + )
"
1,4.0,0.0,0.75,False,0.0,False,text," b(m)
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,5.0,0.0,0.8,False,0.0,False,text," pb(m)
"
18,3.77777777778,0.0,0.111111111111,False,0.0,False,text," where C2 = 23/2/. The last expression converges to zero as m   since the rst fraction
"
16,4.3125,0.0,0.046875,False,0.0,False,text," converges to 1 and b(m)   (by (29)). Hence, we have established (27), completing the
"
4,3.25,0.0,0.0,False,0.0,False,text," proof of Case 2.
"
21,3.14285714286,0.0,0.190476190476,False,0.0,True,text," Since the two cases cover all the functions a  H that satisfy x  a(x)  x2 the proof is
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,9.0,0.0,0.0,False,0.0,False,text," complete.
"
20,3.6,0.0,0.0,False,0.0,True,text," We now derive an extension of Lemma 5.6 that will be used later. A big part of the proof is
"
14,3.71428571429,0.0,0.0,False,0.0,False,text," analogous to that of Lemma 5.6 so we are just going to sketch it.
"
17,4.0,0.420168067227,0.235294117647,True,1.0,True,heading," Proposition 5.7. Suppose that a  H is eventually positive and satises xk  a(x)  xk+1
"
19,1.63157894737,0.263157894737,0.438596491228,False,0.0,False,body," for some k  N. Let   0 and d0, d1, . . . , dk  N.
"
18,2.66666666667,0.388888888889,0.375661375661,False,0.0,False,body," (i) dkm  a(k)(n)  dkm + , for every n  Im and m large enough, and
"
16,5.125,0.4375,0.463808760684,False,0.0,False,body," (ii) the sequence (a(n)/d0, a(n)/d1, . . . , a(k1)(n)/dk1) is equidistributed in Tk1 with respect
"
6,4.5,0.888888888889,0.111111111111,False,0.0,False,body," to the sequence of intervals Im.
"
10,4.9,0.9,0.0833333333333,False,0.0,True,after_body," Then there exists a sequence of intervals (Im)mN such that
"
25,2.84,0.04,0.2,False,0.0,True,text," Proof. We assume that d0 = d1 = . . . = dk = 1, the general case is similar. As in the proof of
"
14,4.0,0.0,0.172619047619,True,0.0,True,text," Lemma 5.6 we dene the sequence of intervals Im = [km, lm] as follows:
"
23,2.5652173913,0.0,0.170807453416,False,1.0,True,text," Case 1: If a(x)  xk+ for every   0 (in which case a(k)(x)  x for every   0), then
"
6,2.33333333333,0.0,0.541666666667,False,0.0,True,text," Im = [km, km + k3/4
"
15,2.73333333333,0.0,0.361904761905,False,0.0,False,text," m ] where km is the smallest n  N such that a(k)(n)  m.
"
25,2.32,0.0,0.197142857143,False,1.0,True,text," Case 2: If a(x)  xk+ for some   0 (in which case x  a(k)(x)  x for some   0), then
"
11,1.63636363636,0.0,0.538961038961,False,0.0,True,text," Im = {n : m  a(k)(n)  m + }.
"
1,2.0,0.0,0.0,False,0.0,False,text," 23
"
16,4.5625,0.0,0.0208333333333,False,0.0,True,text," Arguing as in Lemma 5.6 we can show that condition (i) is satised. Therefore, it remains
"
21,3.7619047619,0.0,0.312698412698,False,0.0,False,text," to show the equidistribution property (ii), or equivalently, that for c0, . . . , ck  Z, not all of
"
7,4.42857142857,0.0,0.0714285714286,False,0.0,False,text," them zero, the sequence b(n) dened by
"
11,3.09090909091,0.0,0.482093663912,False,0.0,False,text," b(n) = c0a(n) + c1a(n) + . . . + ck1a(k1)(n)
"
19,4.05263157895,0.0,0.0877192982456,False,0.0,False,text," is equidistributed in T with respect to the sequence of intervals Im. To do this we shall use a
"
16,4.75,0.0,0.0208333333333,False,0.0,False,text," dierence theorem of van der Corput (Theorem 3.1 in [34]) which enables us to reduce matters
"
20,3.7,0.0,0.0,False,0.0,False,text," to a setup similar to the one treated in Lemma 5.6 (a similar trick was used in [16]). We are
"
14,4.14285714286,0.0,0.0714285714286,False,0.0,False,text," going to assume that c0 6= 0, the other cases can be treated similarly.
"
18,4.0,0.0,0.0833333333333,False,0.0,True,text," By the theorem of van der Corput, in order to show that b(n) is equidistributed in T with
"
19,3.78947368421,0.0,0.140350877193,False,0.0,False,text," respect to the sequence of intervals Im, it suces to show that for every m  N the sequence
"
17,4.23529411765,0.0,0.245098039216,False,0.0,False,text," mb(n), where mb(n) = b(n + m) b(n), is equidistributed in T with respect to the sequence
"
15,5.13333333333,0.0,0.0444444444444,False,0.0,False,text," of intervals Im. Applying this successively we reduce our problem to showing that for every
"
20,2.7,0.0,0.453333333333,False,0.0,False,text," m1, . . . , mk1  N the sequence B(n), where the function B  H is dened by
"
5,3.4,0.0,0.35,False,0.0,True,text," B(x) = m1m2  mk1b(x),
"
12,4.83333333333,0.0,0.138888888889,False,0.0,False,text," is equidistributed in T with respect to the sequence of intervals Im.
"
17,4.35294117647,0.0,0.0294117647059,False,0.0,True,text," In order to prove this, we rst derive some properties about the function B(x) that will be
"
14,4.0,0.0,0.135714285714,False,0.0,False,text," useful. Since xk  b(x)  xk+1, by repeatedly applying Lemma 5.2 we get
"
1,4.0,0.0,0.0,False,0.0,False,text," (32)
"
5,1.6,0.0,0.433333333333,False,0.0,False,text," x  B(x)  x2.
"
16,4.75,0.0,0.0703125,False,0.0,True,text," It will also be useful to relate the functions B(x) and a(k)(x). By repeatedly applying the
"
15,4.26666666667,0.0,0.0222222222222,False,0.0,False,text," mean value theorem and using that a(k+1)(x)  0 (follows from Lemma 5.2) we get
"
1,4.0,0.0,0.0,False,0.0,False,text," (33)
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,False,text," x
"
8,2.25,0.0,0.345833333333,False,0.0,False,text," (B(x)  M a(k)(x + x)) = 0
"
25,2.28,0.0,0.46,False,0.0,False,text," where M = c0m1  mk1, for some x  R that satises 0  x  m1 + . . . + mk1. Moreover,
"
14,3.28571428571,0.0,0.244897959184,False,0.0,False,text," since a(k)(x)  x and x is bounded, we get by Lemma 5.2 that
"
7,2.57142857143,0.0,0.34693877551,False,0.0,False,text," a(k)(x + x)  a(k)(x)  0.
"
6,4.33333333333,0.0,0.0,False,0.0,True,text," Combining this with (33) we get
"
1,4.0,0.0,0.0,False,0.0,False,text," (34)
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,False,text," x
"
6,2.83333333333,0.0,0.4125,False,0.0,False,text," (B(x)  M a(k)(x)) = 0.
"
18,3.72222222222,0.0,0.0277777777778,False,0.0,True,text," Using (32) and arguing as in the proof of Lemma 5.6 we get that the sequence B(n) is
"
16,4.875,0.0,0.125,False,0.0,False,text," equidistributed in T with respect to the sequence of intervals Jm that are chosen as follows:
"
15,4.93333333333,0.0,0.0,False,0.0,False,text," easy to verify that this choice works). Therefore, in this case we are immediately done.
"
23,2.60869565217,0.0,0.13768115942,False,1.0,True,text," Case A. If B(x)  x1+ for every   0, then we can set Jm = Im (because of (34) it is
"
14,2.5,0.0,0.0833333333333,False,1.0,True,text," Case B. If B(x)  x1+ for some   0, we can choose
"
17,1.64705882353,0.0,0.432352941176,False,0.0,True,text," Jm = {n : rm + e(n)  B(n)  r  (m + ) + e(n)}
"
18,4.33333333333,0.0,0.0833333333333,False,0.0,False,text," where r is any positive real number and e(n) is any sequence that converges to 0. Our objective
"
23,2.65217391304,0.0,0.341097308489,False,0.0,False,text," is to choose r and e(n) so that Jm = Im. We choose r = M and e(n) = B(n)  M b(k)(n)
"
12,3.83333333333,0.0,0.0,False,0.0,False,text," (which converges to 0 by (34)). In this case we have that
"
16,1.625,0.0,0.558035714286,False,0.0,True,text," Jm = {n : M m  M b(k)(n)  M (m + )} = Im.
"
13,6.0,0.0,0.0,False,0.0,True,text," Therefore, in both cases we get the required equidistribution property. This completes the
"
1,6.0,0.0,0.0,False,0.0,False,text," proof.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,2.0,0.0,0.0,False,0.0,False,text," 24
"
14,5.35714285714,0.0,0.0,False,0.0,False,text," 5.4. Finding the polynomial patterns. We will now complete the proof of Proposition 5.1.
"
15,5.0,0.0,0.0,False,0.0,True,text," First we use Proposition 5.7 to derive some more useful results for our particular setup.
"
18,3.61111111111,0.452380952381,0.222222222222,True,1.0,True,heading," Lemma 5.8. Suppose that a  H is eventually positive and satises xk  a(x)  xk+1 for
"
13,1.46153846154,0.307692307692,0.346153846154,False,0.0,False,body," some k  N. Let r, m  N and   0.
"
23,2.65217391304,0.550724637681,0.217391304348,False,0.0,True,body," Then there exist nr,m  N with nr,m   (as m   and r is xed), such that for all large
"
3,2.33333333333,0.666666666667,0.333333333333,False,0.0,False,text," m we have
"
2,5.5,0.0,0.8,False,0.0,False,text," h a(k)(nr,m)
"
1,2.0,0.0,0.5,False,0.0,False,text," k!
"
3,1.66666666667,0.0,0.666666666667,False,0.0,False,text," i = rm,
"
2,5.5,0.0,0.8,False,0.0,False,text," h a(i)(nr,m)
"
1,2.0,0.0,0.5,False,0.0,False,heading," i!
"
15,1.33333333333,0.0,0.577777777778,False,0.0,False,body," i  0 (mod r), i = 0, . . . , k  1,
"
18,2.72222222222,0.0555555555556,0.111111111111,False,0.0,True,text," Proof. Let 0    1 and r  N be xed. By Proposition 5.7 the sequence
"
1,2.0,0.0,0.5,False,0.0,False,heading," i!
"
11,1.09090909091,0.0,0.863636363636,False,0.0,False,body," o  , i = 0, . . . , k.
"
2,5.5,0.0,0.8,False,0.0,False,after_body," n a(i)(nr,m)
"
3,3.0,0.0,0.666666666667,False,0.0,False,text," b(n) = a(n)
"
13,1.92307692308,0.0,0.494505494505,False,0.0,True,text," Im = {n  N : rmk!  a(k)(n)  rmk! + }.
"
5,1.2,0.0,0.366666666667,False,0.0,False,text," r  (k  1)!
"
1,4.0,0.0,0.75,False,0.0,False,text," a(n)
"
3,1.0,0.0,0.333333333333,False,0.0,False,text," r  1!
"
1,8.0,0.0,0.5,False,0.0,False,text," a(k1)(n)
"
5,1.0,0.0,1.0,False,0.0,False,text," , . . . ,
"
1,1.0,0.0,1.0,False,0.0,False,text," r
"
1,1.0,0.0,1.0,False,0.0,False,text," ,
"
9,5.22222222222,0.0,0.111111111111,False,0.0,False,text," is equidistributed in Tk1 with respect to the intervals
"
17,3.35294117647,0.0,0.238095238095,False,0.0,True,text," Hence, for large enough m there exists an nr,m  N such that b(nr,m)  [0, 
"
4,3.5,0.0,0.375,False,0.0,False,text," r ]k1. The result
"
19,3.57894736842,0.0,0.175438596491,False,0.0,False,text," follows by noticing that {x/r}  1/r implies that [x]  0 (mod r), and the estimate {x} 
"
1,7.0,0.0,0.857142857143,False,0.0,False,text," r{x/r}.
"
18,3.61111111111,0.452380952381,0.222222222222,True,1.0,True,heading," Lemma 5.9. Suppose that a  H is eventually positive and satises xk  a(x)  xk+1 for
"
4,1.75,0.375,0.375,False,0.0,False,body," some k  N.
"
24,2.20833333333,0.340277777778,0.361111111111,False,0.0,True,body," Then there exist r,m  R, nr,m  N, with r,m  0, nr,m   (as m   and r is xed),
"
8,3.25,0.875,0.125,False,0.0,False,body," such that for all large m we have
"
1,0.0,0.0,0.0,False,0.0,False,after_body," 
"
2,5.5,0.0,0.8,False,0.0,False,text," h a(k)(nr,m)
"
1,2.0,0.0,0.5,False,0.0,False,text," k!
"
3,1.66666666667,0.0,0.666666666667,False,0.0,False,text," i = rm,
"
2,5.5,0.0,0.8,False,0.0,False,text," h a(i)(nr,m)
"
1,2.0,0.0,0.5,False,0.0,False,heading," i!
"
15,1.33333333333,0.0,0.577777777778,False,0.0,False,body," i  0 (mod r), i = 0, . . . , k  1,
"
2,5.5,0.0,0.8,False,0.0,False,after_body," n a(i)(nr,m)
"
1,2.0,0.0,0.5,False,0.0,False,text," i!
"
11,1.36363636364,0.0,0.795454545455,False,0.0,False,body," o  r,m, i = 0, . . . , k.
"
19,3.47368421053,0.0526315789474,0.204260651629,False,0.0,True,after_body," Proof. Let r  N. For  = 1/k there exist Mr,k and nr,m(k) such that the conclusion of
"
20,2.95,0.0,0.318571428571,True,0.0,True,text," Lemma 5.8 is satised for every m  Mr,k. For Mr,k  m  Mr,k+1, let r,m = 1/k and
"
16,4.8125,0.0,0.2421875,False,0.0,False,text," nr,m = nr,m(k). Thus dened, the sequences r,m, nr,m satisfy the conclusions of our lemma for
"
4,2.75,0.0,0.4,False,0.0,False,text," every m  Mr,1.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
8,4.375,0.0,0.0,False,0.0,True,text," We are now ready to prove Proposition 5.1.
"
16,4.625,0.25,0.0625,False,0.0,True,text," Proof of Proposition 5.1. If k = 0 the result follows immediately from Lemma 5.2. Suppose
"
20,3.5,0.0,0.1,False,0.0,False,text," that k  1 and let nr,m be as in the statement of Lemma 5.9. Using the Taylor expansion of
"
14,2.71428571429,0.0,0.321428571429,False,0.0,False,text," a(x) around the point x = nr,m we get for n  N that
"
1,2.0,0.0,1.0,False,0.0,False,text," nk
"
1,4.0,0.0,0.0,False,0.0,False,text," (35)
"
1,2.0,0.0,0.5,False,0.0,False,text," k!
"
12,2.58333333333,0.0,0.493551587302,False,0.0,False,text," a(nr,m + n) = a(nr,m) + na(nr,m) + . . . +
"
2,5.5,0.0,0.3,False,0.0,False,text," a(k)(nr,m) +
"
1,11.0,0.0,0.545454545455,False,0.0,False,text," a(k+1)(r,n)
"
3,2.0,0.0,0.166666666667,False,0.0,False,text," (k + 1)!
"
1,4.0,0.0,0.5,False,0.0,False,text," nk+1
"
21,2.7619047619,0.0,0.230158730159,False,0.0,False,text," for some r,n  [nr,m, nr,m + n]. By Lemma 5.2 we have a(k+1)(x)  0 as x   (also
"
9,5.0,0.0,0.214814814815,False,0.0,False,text," a(k+1)(x)  0). Furthermore, we have that n a(i)(nr,m)
"
16,1.625,0.0,0.604166666667,False,0.0,False,text," o  r,m for i = 0, . . . , k, where r,m  0
"
1,2.0,0.0,0.0,False,0.0,False,text," 25
"
1,2.0,0.0,0.5,False,0.0,False,text," i!
"
4,1.0,0.0,0.5,False,0.0,False,text," as m  .
"
13,1.92307692308,0.0,0.307692307692,False,0.0,False,text," 1  n  Nr,m and all large m  N we have
"
15,3.86666666667,0.0,0.133333333333,False,0.0,True,text," It follows that there exist integers Nr,m such that Nr,m   and for every
"
10,3.9,0.0,0.15,False,0.0,True,text," For these values of m and n, equation (35) gives
"
10,3.8,0.0,0.627777777778,False,0.0,False,text," {a(nr,m)} + n{a(nr,m)} + . . . + nkn a(k)(nr,m)
"
4,4.5,0.0,0.536363636364,False,0.0,False,text," o + nk+1n a(k+1)(r,n)
"
14,3.57142857143,0.0,0.493083900227,False,0.0,False,text," [a(nr,m + n)] = [a(nr,m)] + n[a(nr,m)] + . . . + nkh a(k)(nr,m)
"
5,1.4,0.0,0.3,False,0.0,False,text," (k + 1)! o 
"
1,2.0,0.0,1.0,False,0.0,False,text," i.
"
1,2.0,0.0,0.5,False,0.0,False,text," k!
"
1,2.0,0.0,0.5,False,0.0,False,text," k!
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
10,5.2,0.0,0.26,False,0.0,True,text," Remembering that nr,m was chosen to also satisfy h a(k)(nr,m)
"
21,1.71428571429,0.0,0.420634920635,False,0.0,False,text," (mod r), i = 0, . . . , k  1, we get for 1  n  Nr,m that
"
1,2.0,0.0,0.5,False,0.0,False,text," k!
"
6,3.0,0.0,0.6,False,0.0,False,text," i = rm and h a(i)(nr,m)
"
1,2.0,0.0,0.5,False,0.0,False,text," i!
"
15,3.2,0.0,0.493650793651,False,0.0,False,text," [a(nr,m + n)] = r(c0,r,m + c1,r,mn + . . . + ck1,r,mnk1 + mnk)
"
20,2.8,0.0,0.4,False,0.0,False,text," for some ci,r,m  N, i = 0, . . . , k  1. This proves the advertised result.
"
7,6.0,0.0,0.0,False,0.0,False,text," 6. Multiple recurrence for Hardy field sequences
"
13,4.23076923077,0.0,0.0,False,0.0,True,text," In this section we shall prove our main result which we now recall:
"
3,0.666666666667,0.0,0.333333333333,False,0.0,False,text," i  0
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
17,3.58823529412,0.382352941176,0.264705882353,True,1.0,True,heading," Theorem 6.1. Let a  H satisfy xk  a(x)  xk+1 for some non-negative integer k.
"
14,3.71428571429,0.5,0.332908163265,False,0.0,True,body," Then S = {[a(1)], [a(2)], . . .} is a set of multiple recurrence.
"
16,4.6875,0.0,0.0625,False,0.0,True,after_body," Using Proposition 5.1 we see that for elements of H that are eventually positive Theorem A
"
14,5.71428571429,0.0,0.0,False,0.0,False,text," is an immediate consequence of the following result (the case of eventually negative elements
"
6,4.33333333333,0.0,0.166666666667,False,0.0,False,text," of H can be treated similarly):
"
20,3.35,0.55,0.25,True,1.0,True,heading," Theorem 6.2. Suppose that for every r, m  N the set S  N contains patterns of the form
"
8,2.875,0.0,0.4375,False,0.0,False,body," {r(mnk + pr,m(n)), 1  n  Nr,m}
"
20,3.45,0.575,0.285714285714,False,0.0,False,body," where pr,m(n) is an integer polynomial of degree at most k 1, and Nr,m  N satisfy Nr,m  
"
8,1.875,0.458333333333,0.25,False,0.0,False,body," (as m   and r is xed).
"
8,4.0,0.875,0.125,False,0.0,True,body," Then S is a set of multiple recurrence.
"
13,4.0,0.0,0.0,False,0.0,True,after_body," The rest of this section is devoted to the proof of Theorem 6.2.
"
15,4.6,0.0,0.0,False,0.0,False,text," 6.1. Proof of Theorem 6.2 modulo a technical result. Our argument is similar to the
"
20,3.5,0.0,0.0,False,0.0,False,text," one used to prove Theorem B and is carried out in two steps. We rst show that it suces to
"
14,5.78571428571,0.0,0.0,False,0.0,False,text," verify a certain multiple recurrence property for nilsystems, and we then verify this property
"
6,7.33333333333,0.0,0.0,False,0.0,False,text," using an equidistribution result on nilmanifolds.
"
15,5.0,0.0,0.0,False,0.0,True,text," The reduction to nilsystems step is a direct consequence of Theorem 2.3 and the following
"
9,5.33333333333,0.0,0.0,False,0.0,False,text," result which serves as a substitute for Proposition 4.3:
"
24,2.70833333333,0.333333333333,0.561111111111,True,1.0,True,heading," Proposition 6.3. Let (X,B, , T ) be a system and f0, f1, . . . , f  L() be such that fiZ
"
27,2.62962962963,0.530864197531,0.407407407407,False,0.0,False,body," for some i = 0, 1, . . . , , where Z is the nilfactor of the system. For xed k, r  N consider the
"
20,3.1,0.35,0.275952380952,False,0.0,False,body," polynomials pm(n) = r(mnk + qm(n)) where deg(qm)  k  1, m  N, and let (Nm)mN be a
"
8,4.125,0.75,0.25,False,0.0,False,body," sequence of positive integers with Nm  .
"
1,4.0,1.0,0.0,False,0.0,True,after_body," Then
"
1,4.0,0.0,0.0,False,0.0,False,text," (36)
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,True,text," M
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,4.0,0.0,1.25,False,0.0,True,text," Xm=1
"
1,2.0,0.0,1.0,False,0.0,True,heading," Nm
"
16,2.1875,0.0,0.885714285714,False,0.0,True,body," Xn=1Z f0  T pm(n)f1  T 2pm(n)f2  . . .  T pm(n)f d
"
1,2.0,0.0,0.0,False,0.0,False,after_body," 26
"
2,1.5,0.0,0.25,False,0.0,False,text," = 0.
"
14,5.57142857143,0.0,0.0,False,0.0,True,text," The verication of the multiple recurrence property for nilsystems is based on the following
"
10,6.4,0.0,0.0,False,0.0,False,text," equidistribution result which serves as a substitute for Proposition 4.5:
"
18,3.55555555556,0.555555555556,0.222222222222,True,1.0,True,text," Proposition 6.4. Let X = G/ be a connected nilmanifold and let a  G be an ergodic
"
14,5.42857142857,0.928571428571,0.0595238095238,False,0.0,False,text," nilrotation. Suppose that (qm)mN is a sequence of integer polynomials with degree at most
"
16,3.1875,0.65625,0.239583333333,False,0.0,False,text," k  1, and let (Nm)mN be a sequence of positive integers with Nm  .
"
8,2.875,0.625,0.1875,False,0.0,True,text," Then for every F  C(X) we have
"
2,2.5,0.0,0.375,False,0.0,True,text," Xm=1 1
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,True,text," M
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
5,4.0,0.0,0.833333333333,False,0.0,True,text," F (amnk+qm(n)) =Z F dmX.
"
13,4.76923076923,0.0769230769231,0.0,False,0.0,True,text," Proof. The argument is identical to the one used to prove Proposition 4.5.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
15,5.2,0.266666666667,0.0,False,0.0,True,text," Proof of Theorem 6.2. Using Proposition 6.3 and Proposition 6.4 the argument is identical to
"
12,3.91666666667,0.0,0.0,False,0.0,False,text," the one used to nish the proof of Theorem B (Section 4.2).
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
17,4.58823529412,0.0,0.0,False,0.0,False,text," 6.2. Proof of Proposition 6.3. The proof of Proposition 6.3 is carried out in two steps. First
"
14,5.78571428571,0.0,0.0,False,0.0,False,text," we establish an estimate about general polynomial families using an inductive argument that is
"
13,6.07692307692,0.0,0.0,False,0.0,False,text," frequently used when one deals with multiple ergodic averages along polynomial iterates. We
"
17,4.70588235294,0.0,0.0,False,0.0,False,text," then apply this estimate to show that the ergodic averages we are interested in are majorized by
"
12,6.58333333333,0.0,0.0,False,0.0,False,text," some multi-parameter polynomial ergodic averages. A known result shows that these averages
"
14,4.64285714286,0.0,0.0,False,0.0,False,text," are controlled by nilsystems, so the same should be the case for our averages.
"
14,5.21428571429,0.285714285714,0.0,False,0.0,False,text," 6.2.1. A PET induction argument. We start with some notational conventions that we use
"
27,1.85185185185,0.0,0.518518518519,False,0.0,True,text," If h = (h1, . . . , hr), H = (H1, . . . , Hr), when we write 1  h  H we mean
"
1,11.0,0.0,0.0,False,0.0,False,text," henceforth:
"
31,1.93548387097,0.0,0.437634408602,False,0.0,False,text," 1  hi  Hi for i = 1, . . . , r, and when we write |H| we mean H1  . . .  Hr. With oh(1) we
"
23,2.91304347826,0.0,0.376811594203,False,0.0,False,text," denote an expression that converges to zero when h1, . . . , hr  , and for N  N we denote
"
18,2.61111111111,0.0,0.230158730159,False,0.0,False,text," by oh,N,hN (1) a quantity that goes to 0 if hi, N   and hi/N  0.
"
16,4.4375,0.0,0.0,False,0.0,True,text," We briey review some notions from [32] (most of which where introduced in [3]). We say
"
21,3.47619047619,0.0952380952381,0.142857142857,False,0.0,False,text," that a property holds for almost every h  Zr if it holds outside of a subset of Zr with upper
"
19,4.0,0.0,0.157894736842,False,0.0,False,text," density zero. We remark that the set of zeros of any non-identically zero polynomial p : Zr  Z
"
23,3.47826086957,0.0,0.405797101449,False,0.0,False,text," has zero upper density. If a0, a1, . . . , ak : Zr  Z are integer polynomials, with ak not identically
"
23,2.78260869565,0.0,0.233229813665,False,0.0,False,text," zero, we call a function p : Zr+1  Z dened by p(h, n) = ak(h)nk +  + a1(h)n + a0(h) an
"
17,4.41176470588,0.352941176471,0.191176470588,False,0.0,False,text," integer polynomial with r parameters and degree k. If p(h, n) has degree k, then for almost
"
21,3.47619047619,0.0,0.202380952381,False,0.0,False,text," every h  Zr, the degree of the polynomial p(h, n), with respect to the variable n is k. A set
"
21,3.85714285714,0.0,0.473015873016,False,0.0,True,text," P = {p1(h, n), . . . , pk(h, n)}, where pi(h, n) are integer polynomials with r parameters, is called
"
15,5.13333333333,0.460606060606,0.133333333333,False,0.0,False,text," a family of integer polynomials with r parameters. The polynomials in P are non-constant if
"
14,5.64285714286,0.142857142857,0.0,False,0.0,False,text," they all have positive degree, and essentially distinct if all their pairwise dierences have
"
15,5.26666666667,0.0666666666667,0.0,False,0.0,False,text," positive degree. The maximum degree of the polynomials is called the degree of the polynomial
"
15,5.0,0.0,0.0761904761905,False,0.0,False,text," family and is denoted by deg(P). Given a polynomial family P with several parameters, let
"
19,3.89473684211,0.0,0.184210526316,False,0.0,True,text," Pi be the subfamily of polynomials of degree i in P. We let wi denote the number of distinct
"
21,3.66666666667,0.047619047619,0.31746031746,False,0.0,False,text," leading coecients that appear in the family Pi. The vector (d, wd, . . . , w1) is called the type
"
5,4.6,0.0,0.1,False,0.0,False,text," of the polynomial family P.
"
13,5.92307692308,0.0,0.0,False,0.0,True,text," We shall use an induction scheme, often called PET induction (Polynomial Exhaustion Tech-
"
17,4.58823529412,0.0,0.0,False,0.0,False,text," nique), on types of polynomial families that was introduced by Bergelson in [3]. To do this we
"
25,3.32,0.0,0.52,False,0.0,False,text," order the set of all possible types lexicographically, this means, (d, wd, . . . , w1)  (d, wd, . . . , w1)
"
18,4.11111111111,0.0,0.0,False,0.0,False,text," if and only if in the rst instance where the two vectors disagree the coordinate of the rst
"
10,5.0,0.0,0.0,False,0.0,False,text," vector is greater than the coordinate of the second vector.
"
1,2.0,0.0,0.0,False,0.0,False,text," 27
"
19,4.10526315789,0.473684210526,0.355263157895,True,1.0,True,heading," Lemma 6.5. Let P = {p1, . . . , pk} be a family of non-constant essentially distinct polynomials
"
24,2.95833333333,0.375,0.489930555556,False,0.0,False,body," with r parameters such that deg(P) = deg(p1), (X,B, , T ) be a system, and f1, . . . , fk  L()
"
13,1.92307692308,0.192307692308,0.538461538462,False,0.0,False,body," with kfikL()  1 for i = 1, . . . , k.
"
22,3.04545454545,0.681818181818,0.227272727273,False,0.0,True,body," Then there exist s  N, depending only on the type of P, and r  N depending only on r and
"
19,4.36842105263,0.657894736842,0.328947368421,False,0.0,False,body," the type of P, a family of non-constant essentially distinct linear polynomials {q1, . . . , qs} with
"
22,3.18181818182,0.314393939394,0.484848484848,False,0.0,False,body," r+ r parameters, and functions g1, . . . , gs  L() (independent of h and h) with kgikL()  1
"
13,2.61538461538,0.564102564103,0.217948717949,False,0.0,False,body," and g1 = f1, such that for every h  Zr we have
"
1,1.0,0.0,0.0,False,0.0,False,after_body," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
2,2.0,0.0,0.0,False,0.0,False,text," (37) 
"
1,2.0,0.0,0.5,False,0.0,False,heading," 2r
"
9,2.55555555556,0.0,0.765432098765,False,0.0,True,body," T p1(h,n)f1  . . .  T pk(h,n)fk
"
1,0.0,0.0,0.0,False,0.0,False,after_body," 
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
4,1.75,0.0,1.08333333333,False,0.0,False,text," | H| X1h H
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,4.0,0.0,0.5,False,0.0,True,text," L2()
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
9,3.44444444444,0.0,0.744781144781,False,0.0,True,text," T q1(h,h,n)g1  . . .  T qs(h,h,n)gsL2()
"
5,2.2,0.0,0.7,False,0.0,False,body," + oN, H, HN (1)
"
21,3.57142857143,0.630952380952,0.285714285714,False,0.0,False,body," where H = (H1, . . . , Hr), and the implied constant depends only on the type of the polynomial
"
2,4.0,0.75,0.25,False,0.0,False,after_body," family P.
"
16,4.8125,0.0625,0.0,False,0.0,True,text," Proof. We remark that throughout the proof all the implied constants depend only on the type
"
5,4.6,0.0,0.1,False,0.0,False,text," of the polynomial family P.
"
16,4.5625,0.0,0.03125,False,0.0,True,text," We shall use induction on the type of the polynomial family P. Assume that the statement
"
20,4.1,0.0,0.295833333333,False,0.0,False,text," holds for all polynomial families with several parameters and type less than (d, wd, . . . , w1), and
"
24,3.20833333333,0.0,0.527777777778,False,0.0,False,text," suppose that {p1, . . . , pk} is a polynomial family with r parameters and type (d, wd, . . . , w1).
"
19,4.05263157895,0.0,0.0877192982456,False,0.0,True,text," Let d0 be the rst positive integer for which wd0 6= 0. Without loss of generality we can assume
"
17,4.52941176471,0.0,0.23137254902,False,0.0,False,text," that the polynomial pk has minimal degree and is such that the polynomials pi(h, n) pk(h, n),
"
34,2.11764705882,0.0,0.463725490196,False,0.0,False,text," pj(h, n + h1)  pk(h, n), for i = 1, . . . , k  1, j = 1, . . . , k, have degree less than or equal to the
"
17,4.23529411765,0.0,0.139775910364,False,0.0,False,text," degree of the polynomial p1(h, n)  pk(h, n). Furthermore, we can assume that deg(p1)  2,
"
15,5.4,0.0,0.0333333333333,False,0.0,False,text," otherwise all polynomials are already linear (since p1 has maximal degree), in which case there
"
16,4.3125,0.0,0.0,False,0.0,False,text," is nothing to prove. In order to carry out the inductive step we consider two cases.
"
21,3.19047619048,0.0,0.132653061224,False,1.0,True,text," Case 1. Suppose that deg(pk) = d0  2. Let r  N be the integer that is determined by the
"
7,5.71428571429,0.0,0.0,False,0.0,False,text," induction hypothesis. We are going to estimate
"
1,4.0,0.0,0.0,False,0.0,False,text," (38)
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
9,2.55555555556,0.0,0.765432098765,False,0.0,True,text," T p1(h,n)f1  . . .  T pk(h,n)fk
"
1,4.0,0.0,0.25,False,0.0,False,text," 2r+1
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,4.0,0.0,0.5,False,0.0,True,text," L2()
"
15,5.06666666667,0.0,0.114285714286,False,0.0,True,text," We use Lemma 4.1, then factor out the measure preserving transformation T pk(h,n) from the
"
15,5.4,0.0,0.0,False,0.0,False,text," resulting integrals, and use the Cauchy Schwarz inequality. Since the sup norm of all functions
"
20,3.3,0.0,0.1,False,0.0,False,text," is bounded by 1, we nd that for every h  Zr the expression in (38) is bounded by some
"
2,6.5,0.0,0.0,False,0.0,False,text," constant times
"
1,4.0,0.0,0.0,False,0.0,False,text," (39)
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,2.0,0.0,0.5,False,0.0,True,text," H1
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
1,2.0,0.0,0.5,False,0.0,True,text," H1
"
1,5.0,0.0,1.4,False,0.0,True,text," Xh1=1
"
11,2.63636363636,0.0,0.936363636364,False,0.0,True,text," T p1(h1,h,n) f1  . . .  T pl(h1,h,n) fl
"
1,2.0,0.0,0.5,False,0.0,False,text," 2r
"
1,4.0,0.0,0.5,False,0.0,True,text," L2()
"
24,3.08333333333,0.0,0.49126984127,False,0.0,False,text," where l = 2k1, f1 = f1, p1(h1, h, n) = p1(h, n)pk(h, n), the functions f2, . . . , fl are bounded
"
22,3.27272727273,0.0,0.299242424242,False,0.0,False,text," by 1 and do not depend on the parameters h1, h, and the polynomials {p2, . . . , pl} have the
"
1,4.0,0.0,0.0,False,0.0,False,text," form
"
3,4.66666666667,0.0,0.37962962963,False,0.0,False,text," + oN,H1,H1N (1),
"
13,2.61538461538,0.0,0.476923076923,False,0.0,False,text," pi(h, n)  pk(h, n), or pj(h, n + h1)  pk(h, n)
"
1,2.0,0.0,0.0,False,0.0,False,text," 28
"
37,1.94594594595,0.0,0.493243243243,False,0.0,False,text," for some i = 2, . . . , k  1 and j = 1, . . . , k. It is easy to verify that {p1, . . . , pl} is a family of
"
13,6.38461538462,0.0,0.0769230769231,False,0.0,False,text," non-constant essentially distinct polynomials with r + 1 parameters, type strictly smaller than
"
17,4.41176470588,0.0,0.0588235294118,False,0.0,False,text," the type of the family P, and the polynomial p1 has maximal degree. Therefore, we can apply
"
16,4.625,0.0,0.0,False,0.0,False,text," the induction hypothesis to give a bound for the norm that appears in (39). Putting these
"
11,6.27272727273,0.0,0.0,False,0.0,False,text," estimates together we produce the desired bound, completing the inductive step.
"
14,4.85714285714,0.0,0.0561224489796,False,1.0,True,text," Case 2. Suppose that deg(pk) = d0 = 1. After possibly rearranging the polynomials
"
26,2.57692307692,0.0,0.326923076923,False,0.0,False,text," p2, . . . , pk1 we can assume that deg pi = 1 if and only if i  k0, for some k0 that satises
"
24,2.875,0.0,0.201388888889,False,0.0,False,text," 2  k0  k. Notice that since the polynomials pi are linear for i  k0, for every h1  N we have
"
16,4.4375,0.0,0.566068735186,False,0.0,False,text," (40) pk(n+h1)pk(n) = pk(h1), pi(n+h1)pk(n) = pi(n)pk(n)+pi(h1) for i = k0, . . . , k1.
"
16,4.0625,0.0,0.0,False,0.0,True,text," Arguing as in Case 1 and keeping in mind the identities (40) we get the estimate
"
3,4.66666666667,0.0,0.37962962963,False,0.0,False,text," + oN,H1,H1N (1),
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
2,2.0,0.0,0.0,False,0.0,False,text," (41) 
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,4.0,0.0,0.5,False,0.0,True,text," L2()
"
9,2.55555555556,0.0,0.765432098765,False,0.0,True,text," T p1(h,n)f1  . . .  T pk(h,n)fk
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
1,2.0,0.0,0.5,False,0.0,True,text," H1
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,2.0,0.0,0.5,False,0.0,True,text," H1
"
1,5.0,0.0,1.4,False,0.0,True,text," Xh1=1
"
11,3.0,0.0,0.754545454545,False,0.0,True,text," T p1(h1,h,n) f1  . . .  T pl(h1,h,n) flL2()
"
29,2.41379310345,0.0,0.45632183908,False,0.0,False,text," where l = k  k0  2, f1 = f1, p1(h1, h, n) = p1(h, n)  pk(h, n), and the polynomials p2, . . . , pl
"
3,3.66666666667,0.0,0.0,False,0.0,False,text," have the form
"
13,2.61538461538,0.0,0.476923076923,False,0.0,False,text," pi(h, n)  pk(h, n), or pj(h, n + h1)  pk(h, n)
"
38,1.89473684211,0.0,0.480263157895,False,0.0,False,text," for some i = 2, . . . , k  1 and j = 1, . . . , k0  1. It is easy to verify that {p1, . . . , pl} is a family
"
14,5.92857142857,0.0,0.0714285714286,False,0.0,False,text," of non-constant essentially distinct polynomials with r + 1 parameters and type strictly smaller
"
7,3.42857142857,0.0,0.0714285714286,False,0.0,False,text," than the type of the family P.
"
18,3.77777777778,0.0,0.0740740740741,False,0.0,True,text," Note that in this case some of the functions fi may depend on h1, but this can happen
"
20,3.7,0.0,0.0642857142857,False,0.0,False,text," only for those indices i for which deg(pi) = 1. In order to get rid of these functions we use
"
10,4.0,0.0,0.0,True,0.0,True,text," Lemma 4.1 again to get a bound for the expression
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
11,3.0,0.0,0.754545454545,False,0.0,True,text," T p1(h1,h,n) f1  . . .  T pl(h1,h,n) flL2()
"
19,4.0,0.0,0.0175438596491,False,0.0,False,text," that involves one less linear term. After repeating this step a nite number of times (w1  1 in
"
14,5.57142857143,0.0,0.0,False,0.0,False,text," total), we eventually get an expression without any linear terms (see Example 7). Combining
"
7,4.0,0.0,0.0,False,0.0,False,text," this with the estimate (41) we get
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
2,2.0,0.0,0.0,False,0.0,False,text," (42) 
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," 2w1
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,4.0,0.0,0.5,False,0.0,True,text," L2()
"
9,2.55555555556,0.0,0.765432098765,False,0.0,True,text," T p1(h,n)f1  . . .  T pk(h,n)fk
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
4,1.75,0.0,1.08333333333,False,0.0,False,text," | H| X1h H
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
12,2.75,0.0,0.736111111111,False,0.0,True,text," T p1(h,h,n) f1  . . .  T pl1 (h,h,n) fl1L2()
"
5,2.2,0.0,0.7,False,0.0,False,text," + oN, H, HN (1)
"
26,2.65384615385,0.0,0.492307692308,False,0.0,False,text," for some l1  N, where h = (h1, . . . , hw1), H = (H1, . . . , Hw1). The family of non-constant
"
18,4.61111111111,0.0,0.388888888889,False,0.0,False,text," essentially distinct polynomials {p1, . . . , pl1} has r + w1 parameters, type strictly smaller than
"
24,3.08333333333,0.0,0.243055555556,False,0.0,False,text," the type of the family P, and the functions f1, . . . , fl1 are bounded by 1 and do not depend on
"
19,3.89473684211,0.0,0.0526315789474,False,0.0,False,text," the parameters h, h. We can now use the induction hypothesis, as in Case 1, to carry out the
"
6,5.5,0.0,0.0,False,0.0,False,text," inductive step and complete the proof.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,2.0,0.0,0.0,False,0.0,False,text," 29
"
13,5.15384615385,0.0,0.0,False,0.0,True,text," We illustrate the method used in the previous proof with the following example:
"
19,3.89473684211,0.0,0.166666666667,False,1.0,True,heading," Example 7. We start with polynomial family {n, 2n, n2} that has type (2, 1, 2) and study the
"
4,9.0,0.0,0.0,False,0.0,False,body," corresponding multiple ergodic averages
"
1,1.0,0.0,0.0,False,0.0,False,after_body," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
2,1.5,0.0,0.75,False,0.0,True,heading," T n2
"
7,1.71428571429,0.0,0.535714285714,False,0.0,False,body," f1  T 2nf2  T nf3.
"
15,5.26666666667,0.0,0.0,False,0.0,True,body," Since this expression involves linear terms, we perform the operation described in Case 2. We
"
18,3.38888888889,0.0,0.0555555555556,False,0.0,False,body," are led to study an average over h1 of a power of the L2 norms of the averages
"
1,1.0,0.0,0.0,False,0.0,False,after_body," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,4.0,0.0,0.5,False,0.0,True,heading," Xn=1
"
13,2.30769230769,0.0,0.463247863248,False,0.0,True,body," T (n+h1)2nf 1  T n2nf1  T n(T 2h1f 2  f2),
"
17,4.41176470588,0.0,0.0490196078431,False,0.0,False,body," which involves a polynomial family with 1 parameter that has type (2, 1, 1). We perform one
"
20,3.65,0.0,0.0583333333333,False,0.0,False,body," more time the operation described in Case 2. We are led to study an average over h1, h2 of a
"
8,3.75,0.0,0.0625,False,0.0,False,body," power of the L2 norms of the averages
"
1,1.0,0.0,0.0,False,0.0,False,after_body," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,4.0,0.0,0.5,False,0.0,True,heading," Xn=1
"
13,3.92307692308,0.0,0.484432234432,False,0.0,True,body," T (n+h1+h2)22nh2f1  T (n+h1)22nf 1  T (n+h2)22nh2f 1  T n22nf1,
"
17,4.76470588235,0.0,0.0490196078431,False,0.0,False,body," which involves a polynomial family with 2 parameters that has type (2, 1, 0). Since the resulting
"
17,4.41176470588,0.0,0.0,False,0.0,False,body," expression has no linear terms, we perform the operation described in Case 1. We are led to
"
14,3.64285714286,0.0,0.166666666667,False,0.0,False,body," study an average over h1, h2, h3 of the L2 norms of the averages
"
1,1.0,0.0,1.0,False,0.0,True,after_body," N
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,heading," N
"
6,9.16666666667,0.0,0.468181818182,False,0.0,True,body," T 2(h1+h2+h3)n+(h1+h2+h3)2h22h3f 1  T 2(h1+h2)n+(h1+h2)2h2f1
"
1,4.0,0.0,0.5,False,0.0,True,body," Xn=1
"
5,6.4,0.0,0.555279503106,False,0.0,True,body," T 2(h1+h3)n+(h1+h3)22h3f1  T 2h1n+h2
"
5,5.8,0.0,0.388,False,0.0,False,body," 1f 1  T 2(h2+h3)n+(h2+h3)2h22h3f1
"
2,4.0,0.0,0.714285714286,False,0.0,True,body," T 2h2n+h2
"
5,2.6,0.0,0.435714285714,False,0.0,False,body," 2h2f 1  T 2h3n+h2
"
2,3.5,0.0,0.55,False,0.0,False,body," 32h3f 1,
"
15,4.73333333333,0.0,0.0222222222222,False,0.0,False,body," which involves a family of linear polynomials with 3 parameters that has type (1, 7).
"
15,4.86666666667,0.0,0.0,False,0.0,True,after_body," Next we use the previous lemma to bound some multiple ergodic averages involving a col-
"
14,5.57142857143,0.0,0.0,False,0.0,False,text," lection of polynomials of a single variable with some multiple ergodic averages involving a
"
12,6.25,0.0,0.0,False,0.0,False,text," collection of polynomials of several variables that have some convenient special form.
"
19,4.15789473684,0.473684210526,0.355263157895,True,1.0,True,heading," Lemma 6.6. Let P = {p1, . . . , pk} be a family of non-constant essentially distinct polynomials,
"
21,2.33333333333,0.261904761905,0.577777777778,False,0.0,False,body," (X,B, , T ) be a system, and f0, f1, . . . , fk  L() with kfikL()  1.
"
20,3.65,0.375,0.458333333333,False,0.0,True,body," Then there exist r, s  N, non-constant essentially distinct polynomials P1, . . . , Ps : Zr 
"
17,4.17647058824,0.823529411765,0.176470588235,False,0.0,True,body," Z that are independent of n and each Pi is an integer combination of polynomials of the
"
21,3.42857142857,0.492063492063,0.43253968254,False,0.0,False,text," form pi(n + PjJ hj) where J is some subset (possibly empty) of {1, . . . , r}, and functions
"
15,2.2,0.238888888889,0.527777777778,False,0.0,True,text," F0, F1, . . . , Fs  L(), such that F1 = f1, and
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
13,2.07692307692,0.0,0.941758241758,False,0.0,True,text," Xn=1Z f0  T p1(n)f1  . . .  T pk(n)fk d
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,2.0,0.0,0.5,False,0.0,False,text," 2r
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
14,2.14285714286,0.0,1.03163265306,False,0.0,False,text," |H| X1hHZ F0  T P1(h)F1  . . .  T Ps(h)Fs d
"
3,3.66666666667,0.0,0.380952380952,False,0.0,False,body," + oN,H,HN (1)
"
21,3.52380952381,0.619047619048,0.293650793651,False,0.0,False,text," where H = (H1, . . . , Hr) and the implied constant depends only on the type of the polynomial
"
2,4.0,0.75,0.25,False,0.0,False,text," family P.
"
1,2.0,0.0,0.0,False,0.0,False,text," 30
"
19,4.0,0.0526315789474,0.298245614035,False,0.0,True,heading," Remark. Our assumptions force the polynomials P1, . . . , Ps to have very special form, we are
"
8,5.0,0.0,0.0,False,0.0,False,body," going to take advantage of this property later.
"
16,4.8125,0.0625,0.0,False,0.0,True,after_body," Proof. We remark that throughout the proof all the implied constants depend only on the type
"
5,4.6,0.0,0.1,False,0.0,False,text," of the polynomial family P.
"
7,4.42857142857,0.0,0.0,False,0.0,True,text," We are going to estimate the quantity
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
13,2.07692307692,0.0,0.941758241758,False,0.0,True,text," Xn=1Z f0  T p1(n)f1  . . .  T pk(n)fk d
"
1,2.0,0.0,0.5,False,0.0,False,text," 2r
"
16,4.6875,0.0,0.0625,False,0.0,False,text," for some appropriate choice of r. We can assume that the polynomial p1 has maximal degree.
"
18,4.5,0.0,0.12962962963,False,0.0,True,text," Indeed, if this is not the case, we can factor out the measure preserving transformation T pio (n)
"
14,4.92857142857,0.0,0.0714285714286,False,0.0,False,text," where pio is some polynomial of maximal degree and work with the resulting family.
"
17,4.0,0.0,0.0980392156863,False,0.0,True,text," Using the Cauchy Schwarz inequality and Lemma 6.5 we get that there exist r1, s1  N,
"
15,5.53333333333,0.0,0.0333333333333,False,0.0,False,text," depending only on the type of P, a family of non-constant essentially distinct linear polynomials
"
25,2.76,0.0,0.516666666667,False,0.0,False,text," q1, . . . , qs1 with r1 parameters, and functions f1, . . . , fs1  L(), such that f1 = f1 and
"
1,4.0,0.0,0.0,False,0.0,False,text," (43)
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," 2r1
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
13,2.07692307692,0.0,0.941758241758,False,0.0,True,text," Xn=1Z f0  T p1(n)f1  . . .  T pk(n)fk d
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
2,3.5,0.0,1.75,False,0.0,False,text," |H| X1hH
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
12,2.41666666667,0.0,0.718650793651,False,0.0,True,text," T q1(h,n) f1  . . .  T qs1 (h,n) fs1L2()
"
21,3.47619047619,0.0,0.280952380952,False,0.0,False,text," where H = (H1, . . . , Hr1). Since all the polynomials are linear, arguing as in the proof of
"
15,5.06666666667,0.0,0.111111111111,True,0.0,True,text," Lemma 4.2 we get that there exist r2, s2  N, non-constant essentially distinct polynomials
"
28,2.21428571429,0.0,0.497023809524,False,0.0,True,text," P1, . . . , Ps2 : Zr2  Z, and functions F0, . . . , Fs2  L(), such that F1 = f1 = f1, and
"
3,3.66666666667,0.0,0.380952380952,False,0.0,False,text," + oN,H,HN (1)
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
1,4.0,0.0,0.5,False,0.0,True,text," Xn=1
"
2,2.0,0.0,0.0,False,0.0,False,text," (44) 
"
12,2.08333333333,0.0,0.805952380952,False,0.0,True,text," T q1(h,n) f1  . . .  T qs1 (h,n) fs1
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," 2r2
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,4.0,0.0,0.5,False,0.0,True,text," L2()
"
17,2.11764705882,0.0,1.06944444444,False,0.0,False,text," | H| X1h HZ F0  T P1(h,h)F1  . . .  T Ps2 (h,h)Fs2 d
"
5,2.2,0.0,0.7,False,0.0,False,text," + oN, H, HN (1)
"
24,3.20833333333,0.0,0.488888888889,False,0.0,False,text," where H = ( H1, . . . , Hr2). Combining (43) and (44), and noticing that {P1(h, h), . . . Ps2(h, h)}
"
15,5.2,0.0,0.1,False,0.0,False,text," is a family of non-constant essentially distinct polynomials Zr1+r2  Z we get the advertised
"
19,3.84210526316,0.0,0.0964912280702,False,0.0,False,text," estimate with r = r1 + r2. Furthermore, looking at the proof of Lemma 6.5 and Lemma 4.2, we
"
19,4.31578947368,0.0,0.355263157895,False,0.0,False,text," see that the polynomials Pi are constructed starting from the family {p1, . . . , pk} and performing
"
18,4.33333333333,0.0,0.171296296296,False,0.0,False,text," r times one of the following two operations: (i) form the polynomial p(n) q(n) or (ii) form the
"
23,3.13043478261,0.0,0.43768115942,False,0.0,False,text," polynomial p(n + hi)  q(n), where p and q are already dened polynomials and i  {1, . . . , r}.
"
14,5.21428571429,0.0,0.0714285714286,False,0.0,True,text," It follows that the polynomials Pi have the advertised form. This completes the proof.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
17,4.47058823529,0.235294117647,0.0,False,0.0,False,text," 6.2.2. Conclusion of the reduction. We shall now use Lemma 6.6 to show that the nilfactor is
"
13,6.30769230769,0.0,0.0,False,0.0,False,text," characteristic for the multiple ergodic averages related to the multiple recurrence problem of
"
8,4.125,0.0,0.0,True,0.0,True,text," Theorem 6.2. We rst need a simple lemma:
"
17,3.76470588235,0.676470588235,0.137254901961,True,1.0,True,heading," Lemma 6.7. Fix k  N. Let (pm)mN be a sequence of integer polynomials of the form
"
18,2.44444444444,0.222222222222,0.360317460317,False,0.0,False,body," pm(n) = mnk + qm(n) where deg(qm)  k  1 and for li, hi  Z let
"
1,1.0,0.0,1.0,False,0.0,False,body," r
"
3,5.33333333333,0.0,0.416666666667,False,0.0,True,body," Pm,n1,...,nr (n) =
"
4,2.75,0.0,0.625,False,0.0,False,body," li pm(n + hi).
"
1,4.0,0.0,0.5,False,0.0,True,after_body," Xi=1
"
1,2.0,0.0,0.0,False,0.0,False,text," 31
"
21,3.61904761905,0.529761904762,0.448412698413,False,0.0,True,body," Then the leading coecient of Pm,h1,...,hr (n) has the form m P (h1, . . . , hr) for some polyno-
"
6,1.66666666667,0.25,0.416666666667,False,0.0,False,body," mial P : Zr  Z.
"
20,3.8,0.05,0.208333333333,False,0.0,True,after_body," Proof. For every choice of integers li, ni, and positive integer j with j  k, the degree of the
"
1,12.0,0.0,0.166666666667,False,0.0,False,text," polynomialPr
"
13,3.92307692308,0.0,0.211538461538,False,0.0,False,text," i=1 li (t + hi)k is greater than the degree of the polynomialPr
"
7,2.42857142857,0.0,0.369047619048,False,0.0,False,text," i=1 li (t + hi)j (up to
"
16,4.8125,0.0,0.0,False,0.0,False,text," a constant, we get the second polynomial by dierentiating the rst several times), as long as
"
14,5.57142857143,0.0,0.0,False,0.0,False,text," the two polynomials are not identically zero. Hence, the leading coecient of the polynomial
"
14,4.42857142857,0.0,0.267857142857,False,0.0,True,text," Pm,h1,...,hr (n) is the same as the leading coecient of the polynomial m Pr
"
6,2.66666666667,0.0,0.438888888889,False,0.0,False,text," i=1 li (n + hi)k. The
"
15,5.13333333333,0.266666666667,0.0,False,0.0,True,text," Proof of Proposition 6.3. We remark that throughout the proof all the implied constants de-
"
10,4.0,0.0,0.05,False,0.0,False,text," pend only on the type of the polynomial family P.
"
1,3.0,0.0,0.0,False,0.0,True,text," Let
"
23,2.91304347826,0.0,0.380434782609,False,0.0,True,text," Without loss of generality we can assume that kfikL()  1 for i = 0, 1, . . . , , and f1Z.
"
2,7.0,0.0,0.0,False,0.0,False,text," result follows.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
2,1.5,0.0,0.5,False,0.0,True,text," AM =
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,4.0,0.0,1.25,False,0.0,True,text," Xm=1
"
16,2.1875,0.0,0.885714285714,False,0.0,True,text," Xn=1Z f0  T pm(n)f1  T 2pm(n)f2  . . .  T pm(n)f d
"
18,3.72222222222,0.0,0.0555555555556,False,0.0,True,text," We shall use Lemma 6.6 to get a bound for the averages AM that is independent of the
"
8,5.25,0.0,0.346875,False,0.0,False,text," polynomials qm (remember pm(n) = r(mnk + qm(n))).
"
12,4.33333333333,0.0,0.166666666667,False,0.0,True,text," Using the Cauchy-Schwarz inequality we have for every t  N that
"
1,4.0,0.0,0.0,False,0.0,False,text," (45)
"
1,6.0,0.0,0.833333333333,False,0.0,False,text," |AM|2t
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,4.0,0.0,1.25,False,0.0,True,text," Xm=1
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
16,2.1875,0.0,0.885714285714,False,0.0,True,text," Xn=1Z f0  T pm(n)f1  T 2pm(n)f2  . . .  T pm(n)f d
"
1,2.0,0.0,0.5,False,0.0,False,text," 2t
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
22,3.45454545455,0.0,0.204545454545,False,0.0,True,text," If r is the integer given by Lemma 6.6, letting t = r we have that there exist s  N, non-constant
"
23,3.17391304348,0.0,0.596376811594,False,0.0,False,text," essentially distinct polynomials Pm,1, . . . , Pm,s : Zt  Z, and functions F0, . . . , Fs  L(),
"
6,2.83333333333,0.0,0.138888888889,False,0.0,False,text," such that F1 = f1, and
"
1,4.0,0.0,0.0,False,0.0,False,text," (46)
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
16,2.1875,0.0,0.885714285714,False,0.0,True,text," Xn=1Z f0  T pm(n)f1  T 2pm(n)f2  . . .  T pm(n)f d
"
14,2.57142857143,0.0,1.03571428571,False,0.0,False,text," |Hm| X1hHmZ F0  T Pm,1(h)F1  . . .  T Pm,s(h)Fs d
"
1,2.0,0.0,0.5,False,0.0,False,text," 2t
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
23,3.17391304348,0.0,0.527536231884,False,0.0,False,text," where Hm = (Hm,1, . . . , Hm,t). By Lemma 6.6, the polynomials Pm,1, . . . , Pm,s have the form
"
1,2.0,0.0,1.0,False,0.0,True,text," Pt
"
8,3.375,0.0,0.697916666667,False,0.0,False,text," i=1 li pm(n + hi) where hi =PjIi,m
"
15,3.13333333333,0.0,0.488888888889,False,0.0,False,text," hj for some subsets Ii,m of {1, . . . , t}. Since the polyno-
"
23,3.08695652174,0.0,0.421739130435,False,0.0,False,text," mials Pm,1, . . . , Pm,s are constant in n, and pm(n) = r(mnk + qm(n)) for some qm  Z[x] with
"
12,2.41666666667,0.0,0.166666666667,False,0.0,False,text," deg qm  k  1, we get from Lemma 6.7 that
"
2,7.5,0.0,0.428571428571,False,0.0,False,text," + oNm,Hm,HmNm(1)
"
4,4.0,0.0,0.720238095238,False,0.0,True,text," Pm,i(n) = rm Pi(h),
"
25,3.0,0.0,0.52,False,0.0,False,text," for i = 1, . . . , s, for some non-constant essentially distinct polynomials P1 . . . , Ps : Zt  Z.
"
13,4.23076923077,0.0,0.0,False,0.0,True,text," Keeping this in mind, and putting together (45) and (46) we nd that
"
1,6.0,0.0,0.833333333333,False,0.0,False,text," |AM|2t
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,5.0,0.0,0.0,False,0.0,False,text," where
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
14,2.64285714286,0.0,1.00595238095,False,0.0,False,text," |M| X(m,h)MZ F0  T rmP1(h)F1  . . .  T rmPs(h)Fs d
"
2,7.0,0.0,0.423076923077,False,0.0,False,text," + oM,Hm,HmNm(1)
"
18,1.27777777778,0.0,0.430555555556,False,0.0,True,text," M = {(m, h)  Nt+1 : 1  m  M, 1  h  Hm }.
"
18,3.5,0.0,0.194444444444,False,0.0,True,text," We can choose Hm such that Hm/Nm  0 and (M )MN forms a Flner sequence of subsets
"
17,4.29411764706,0.0,0.0970588235294,False,0.0,False,text," of Nt+1. Since F1 = f1Z, using Corollary 2.2 we get that the last expression converges to
"
1,2.0,0.0,0.0,False,0.0,False,text," 32
"
20,3.05,0.0,0.225,False,0.0,False,text," zero when M  . This shows that AM converges to zero in L2() as M   and completes
"
2,4.5,0.0,0.0,False,0.0,False,text," the proof.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
8,6.125,0.0,0.0,False,0.0,False,text," 7. Appendix: Single recurrence for Hardy field sequences
"
15,5.0,0.0,0.0,False,0.0,True,text," In this last section we deal with single recurrence properties of Hardy eld sequences and
"
11,4.90909090909,0.0,0.0,False,0.0,False,text," improve upon the single recurrence versions of Theorems A and A.
"
12,6.5,0.0,0.0,False,0.0,True,text," Sarkozy ([44]), and independently Furstenberg ([25]), showed that if a non-constant poly-
"
17,4.47058823529,0.0,0.117647058824,False,0.0,False,text," nomial q  Z[x] has zero constant term, then the sequence q(n) is good for single recurrence.
"
17,4.64705882353,0.0,0.101960784314,False,0.0,True,text," More generally, the same is true for (non-constant) sequences of the form [q(n)] where q  R[x],
"
20,3.7,0.0,0.0875,False,0.0,False,text," with q(0) = 0 ([4]). If the constant term of the polynomial q  R[x] is non-zero, then the se-
"
21,3.61904761905,0.0,0.206349206349,False,0.0,False,text," quence [q(n)] is still good for single recurrence, provided that q is not of the form q = cp + d
"
20,3.65,0.0,0.216666666667,False,0.0,False,text," for some p  Z[x] and c, d  R. In this case determining whether [q(n)] is good for recurrence
"
17,4.58823529412,0.0,0.107843137255,False,0.0,False,text," depends on intrinsic properties of the polynomial q.9 For example, the sequences 3n + 3, n2 1,
"
23,3.0,0.0,0.130434782609,False,0.0,False,text," [5n + 1], [5n + 3] are good for recurrence, but the sequences 3n + 1, n2 + 1, [5n + 2], are
"
3,5.66666666667,0.0,0.0,False,0.0,False,text," bad for recurrence.
"
17,3.82352941176,0.0,0.117647058824,False,0.0,True,text," We shall show that if the function a  H has polynomial growth and stays away from
"
19,3.73684210526,0.0,0.201754385965,False,0.0,False,text," polynomials of the form cp(x), where p  Z[x] and c  R, then the sequence [a(n)] is always
"
15,4.6,0.0,0.0,False,0.0,False,text," good for single recurrence. This is the statement of Theorem C which we now repeat.
"
18,3.44444444444,0.444444444444,0.181481481481,True,1.0,True,heading," Theorem C. Let a  H have polynomial growth and suppose that |a(x)  cp(x)|   for
"
8,2.0,0.3125,0.375,False,0.0,False,body," every p  Z[x] and c  R.
"
14,3.57142857143,0.5,0.332908163265,False,0.0,True,body," Then S = {[a(1)], [a(2)], . . .} is a set of single recurrence.
"
8,4.125,0.0,0.0,False,0.0,True,after_body," We are going to use the following lemma:
"
16,4.5,0.6953125,0.15625,True,1.0,True,heading," Lemma 7.1. Suppose that p  R[x] is non-constant with leading coecient , the real number
"
24,1.83333333333,0.395833333333,0.458333333333,False,0.0,False,body,"  is such that 1/ / Q/ + Q, and nm, Nm  N are such that Nm   as m  .
"
18,3.44444444444,0.546296296296,0.157407407407,False,0.0,True,body," Then for every t  (0, 1), and Riemann integrable function  : T  C, the averages
"
1,1.0,0.0,0.0,False,0.0,False,after_body," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
2,2.5,0.0,0.375,False,0.0,True,heading," Xm=1 1
"
7,2.57142857143,0.714285714286,0.285714285714,False,0.0,False,body," converge to zero as M  .
"
15,4.93333333333,0.0666666666667,0.0666666666667,False,0.0,True,text," Proof. Suppose rst that t is irrational. We shall show that for every Riemann integrable
"
6,3.16666666667,0.0,0.25,False,0.0,False,text," function f of T2 we have
"
7,2.57142857143,0.0,0.561904761905,False,0.0,False,body," (p(n) + m)  e[p(n) + m]t
"
1,5.0,0.0,0.8,False,0.0,True,after_body," Xn=nm
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,5.0,0.0,0.8,False,0.0,False,text," nm+Nm
"
1,4.0,0.0,0.0,False,0.0,False,text," (47)
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,True,text," M
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
2,2.5,0.0,0.375,False,0.0,True,text," Xm=1 1
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,5.0,0.0,0.8,False,0.0,False,text," nm+Nm
"
1,5.0,0.0,0.8,False,0.0,True,text," Xn=nm
"
7,3.0,0.0,0.952380952381,False,0.0,False,text," f(p(n) + m)t, p(n) + m =ZT2
"
4,2.75,0.0,0.791666666667,False,0.0,False,text," f (x, y) dxdy.
"
21,3.57142857143,0.0,0.277777777778,False,0.0,True,text," Applying this for f (x, y) = (y) e(x t{y}), and noticing that the integral of f is zero, we get
"
3,6.66666666667,0.0,0.0,False,0.0,False,text," the advertised result.
"
12,6.5,0.0,0.0,False,0.0,True,text," Next we verify (47). Using a standard approximation argument by trigonometric polynomials
"
25,2.76,0.0,0.217333333333,False,0.0,False,text," we can assume that f (x, y) = e(l1x + l2y) for some l1, l2  Z not both of them 0. So it suces
"
3,3.33333333333,0.0,0.0,False,0.0,False,text," to show that
"
1,4.0,0.0,0.0,False,0.0,False,text," (48)
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,True,text," M
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,4.0,0.0,0.5,False,0.0,True,text," Xm=1
"
5,2.8,0.0,0.366666666667,False,0.0,False,text," em(l1t + l2)Am = 0
"
22,3.63636363636,0.0,0.0818181818182,False,0.0,False,text," 9It can be shown that the sequence q(n), where q  Z[x], is good for recurrence if and only if the set
"
25,3.6,0.0,0.244,False,0.0,False,text," {q(n) : n  N} contains multiples of every positive integer ([33]), and the sequence [an + b], a, b  R, is good for
"
19,3.42105263158,0.0,0.175438596491,False,0.0,False,text," recurrence if and only if there exists an integer k such that b + ka  [0, 1] ([4]).
"
1,2.0,0.0,0.0,False,0.0,False,text," 33
"
1,5.0,0.0,0.0,False,0.0,False,text," where
"
2,1.5,0.0,0.5,False,0.0,True,text," Am =
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,5.0,0.0,0.8,False,0.0,False,text," nm+Nm
"
1,5.0,0.0,0.8,False,0.0,True,text," Xn=nm
"
3,5.33333333333,0.0,0.488095238095,False,0.0,False,text," el1p(n)t + l2p(n).
"
12,3.33333333333,0.0,0.0,False,0.0,False,text,"  is irrational, we get that the limit in (48) is 0.
"
20,3.5,0.0,0.125,False,0.0,True,text," Suppose rst that l1 = 0. Then l2 6= 0, and since the sequence Am is known to converge and
"
15,5.13333333333,0.0,0.1,False,0.0,True,text," Suppose now that l1 6= 0. Notice that the leading coecient of the polynomial l1p(n)t+l2p(n)
"
24,3.0,0.0,0.256944444444,False,0.0,False,text," is (l1t + l2) and this is irrational if and only if t / Q/ + Q. If this happens to be the case,
"
24,2.79166666667,0.0,0.256944444444,False,0.0,False,text," then Am  0 and (48) follows. Otherwise we have t = q1/ + q2 for some q1, q2  Q. Since t is
"
19,3.84210526316,0.0,0.105263157895,False,0.0,False,text," assumed to be irrational we have q1 6= 0 and  is irrational. Since the sequence Am is known
"
12,4.0,0.0,0.0,False,0.0,False,text," to converge, the limit in (48) is equal to a constant times
"
1,4.0,0.0,0.0,False,0.0,False,text," (49)
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,True,text," M
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,4.0,0.0,0.5,False,0.0,True,text," Xm=1
"
5,3.6,0.0,0.475,False,0.0,False,text," em(l1q1/ + l1q2 + l2).
"
23,2.82608695652,0.0,0.278985507246,False,0.0,True,text," We can rewrite (l1q1/ + l1q2 + l2) as (q1/ + q2) for some q1, q2  Q with q1 6= 0. Since
"
18,4.44444444444,0.0,0.0,False,0.0,False,text,"  is irrational, this last expression is non-zero, and as a consequence the limit in (49) is going
"
20,3.5,0.0,0.0708333333333,False,0.0,False,text," to be 0 unless (q1/ + q2) is a non-zero integer. But this cannot be the case since by our
"
18,3.88888888889,0.0,0.277777777778,False,0.0,False,text," assumption 1/ / Q/ + Q. Therefore, the limit in (49) is 0 completing the proof of (47).
"
19,3.94736842105,0.0,0.0701754385965,False,0.0,True,text," It remains to deal with the case where t  (0, 1) is rational. For convenience we shall assume
"
23,2.91304347826,0.0,0.202898550725,False,0.0,False,text," that t = 1/k for some integer k with k  2 (if the numerator of t is not 1 the argument is
"
15,5.0,0.0,0.0844444444444,False,0.0,False,text," similar). Using a standard approximation argument we can assume that (y) = e(ly) for some
"
9,3.55555555556,0.0,0.166666666667,False,0.0,False,text," l  Z. Then the limit in question becomes
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,True,text," M
"
1,1.0,0.0,1.0,False,0.0,True,text," M
"
2,2.5,0.0,0.375,False,0.0,True,text," Xm=1 1
"
1,2.0,0.0,1.0,False,0.0,True,text," Nm
"
1,5.0,0.0,0.8,False,0.0,False,text," nm+Nm
"
1,5.0,0.0,0.8,False,0.0,True,text," Xn=nm
"
9,3.0,0.0,0.516049382716,False,0.0,False,text," e(l + 1/k)(p(n) + m)  {p(n) + m}/k.
"
14,5.07142857143,0.0,0.0863095238095,False,0.0,True,text," Arguing as in the proof of (47) we can show that the sequence(l+1/k)(p(n)+m), p(n)+m
"
20,3.55,0.0,0.37,False,0.0,False,text," is equidistributed in the subset H =(lk +1)x, kx : x  T of T2 with respect to the sequence
"
3,4.0,0.0,0.472222222222,False,0.0,False,text," (SM )MN, where
"
19,1.36842105263,0.0,0.460526315789,False,0.0,True,text," SM = {(m, n)  Z2 : 1  m  M, nm  n  nm + Nm}.
"
7,4.42857142857,0.0,0.0,False,0.0,True,text," Therefore, the last limit is equal to
"
2,1.0,0.0,0.5,False,0.0,True,text," Z 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
8,2.25,0.0,0.5,False,0.0,False,text," e(lk + 1)x  (kx  i)/k dx.
"
19,3.47368421053,0.0,0.157894736842,False,0.0,True,text," Using the change of variables x  y + i/k we see that the last expression is equal to
"
7,2.42857142857,0.0,0.5,False,0.0,False,text," e(lk + 1)x  {kx}/k dx =
"
1,3.0,0.0,1.0,False,0.0,False,text," i/k
"
1,2.0,0.0,1.0,False,0.0,False,text," k1
"
2,6.0,0.0,0.514285714286,False,0.0,True,text," Xi=0Z (i+1)/k
"
1,4.0,0.0,0.0,False,0.0,False,text," (50)
"
2,2.0,0.0,0.833333333333,False,0.0,True,text," Z 1/k
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
3,2.0,0.0,0.833333333333,False,0.0,False,text," elky dy 
"
1,2.0,0.0,1.0,False,0.0,False,text," k1
"
1,4.0,0.0,0.5,False,0.0,True,text," Xi=0
"
3,4.33333333333,0.0,0.390476190476,False,0.0,False,text," e((lk + 1)i/k).
"
25,2.68,0.0,0.18,False,0.0,True,text," Since l  Z and k  2 we have lk + 1 6= 0. It follows that the sum appearing in (50) is zero.
"
4,5.5,0.0,0.0,False,0.0,True,text," This completes the proof.
"
24,2.79166666667,0.166666666667,0.219444444444,False,0.0,True,text," Proof of Theorem 1.2. If |a(x)  cp(x)|  log x for every p  Z[x] and c  R, then by [17] the
"
12,5.58333333333,0.0,0.0416666666667,False,0.0,False,text," sequence ([a(n)])nN is good for the ergodic theorem10, and the result follows.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
16,6.0,0.0,0.0,False,0.0,False,text," 10This is an easy consequence of the spectral theorem and the following equidistribution result of Boshernitzan
"
24,3.375,0.0,0.233333333333,False,0.0,False,text," [16]: If a  H has polynomial growth and satises |a(x)  p(x)|  log x for every p  Q[x], then the sequence
"
5,5.8,0.0,0.225,False,0.0,False,text," (a(n))nN is equidistributed in T.
"
1,2.0,0.0,0.0,False,0.0,False,text," 34
"
22,2.77272727273,0.0,0.295454545455,False,0.0,True,text," Therefore, we can assume that a(x) = cp(x) + b(x) for some p  Z[x], c  R, and b  H
"
20,3.4,0.0,0.125,False,0.0,False,text," that satises 1  b(x)  x. Furthermore, we can assume that b(x)  0 for large x (the other
"
18,4.38888888889,0.0,0.0833333333333,False,0.0,False,text," case can be treated similarly). If c = 0, then the range of the sequence ([b(n)])nN contains all
"
21,3.33333333333,0.0,0.119047619048,False,0.0,False,text," large enough integers (see Lemma 5.2) and so forms a set of recurrence. If c 6= 0, let   R
"
24,2.5,0.0,0.298611111111,False,0.0,False,text," be such that 1/ / Q/c + Q. Since b(x)  x we have b(x + 1)  b(x)  0 (see Lemma 5.2),
"
18,3.5,0.0,0.138888888889,False,0.0,False,text," and since b(x)   it follows that there exist integers Nm with Nm   and intervals
"
12,2.58333333333,0.0,0.395833333333,False,0.0,True,text," Im = [nm, nm + Nm], where nm  N, such that
"
1,4.0,0.0,0.0,False,0.0,False,text," (51)
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,False,text," m
"
1,3.0,0.0,0.0,False,0.0,False,text," sup
"
6,2.16666666667,0.0,0.655555555556,False,0.0,False,text," nIm |b(n)  m| = 0.
"
1,3.0,0.0,0.0,False,0.0,True,text," Let
"
1,4.0,0.0,0.0,False,0.0,False,text," (52)
"
6,5.0,0.0,0.277777777778,False,0.0,True,text," Consider the sequence (SM )MN where
"
13,2.38461538462,0.0,0.447435897436,False,0.0,True,text," J = {(m, n)  N2 : {cp(n) + m}  [1/2, 3/4]}.
"
19,1.36842105263,0.0,0.460526315789,False,0.0,True,text," SM = {(m, n)  N2 : 1  m  M, nm  n  nm + Nm}.
"
20,3.15,0.0,0.208333333333,False,0.0,True,text," Notice that because of (51) and (52), for (m, n)  SM  J with m big enough, we have
"
18,4.0,0.0,0.129966329966,False,0.0,False,text," [cp(n) + b(n)] = [cp(n) + m]. Applying Lemma 7.1 for  = 1[1/2,3/4], and noticing that the
"
18,4.05555555556,0.0,0.148148148148,False,0.0,False,text," set J has positive density (= 1/4) with respect to the sequence (SM )MN, we have for every
"
5,2.0,0.0,0.266666666667,False,0.0,False,text," t  (0, 1) that
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
9,4.33333333333,0.0,0.0,False,0.0,True,text," Using this and the spectral theorem we get that
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,True,text," M
"
2,6.5,0.0,1.0,False,0.0,False,text," |SM| X(m,n)SMJ
"
1,1.0,0.0,3.0,False,0.0,True,text," M
"
2,6.5,0.0,1.0,False,0.0,False,text," |SM| X(m,n)SMJ
"
5,3.6,0.0,0.27619047619,False,0.0,False,text," e[cp(n) + b(n)]t = lim
"
10,3.5,0.0,0.996153846154,False,0.0,False,text," |SM| X(m,n)SMJZ f  T [cp(n)+b(n)]f d =Z f d2
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,3.0,0.0,0.0,False,0.0,False,text," lim
"
1,1.0,0.0,3.0,False,0.0,True,text," M
"
5,2.8,0.0,0.509523809524,False,0.0,False,text," e[cp(n) + m]t = 0.
"
13,4.15384615385,0.0,0.134615384615,False,0.0,False,text," for every f  L(). This implies the result and completes the proof.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,10.0,0.0,0.0,False,0.0,True,text," References
"
18,4.72222222222,0.0,0.0,False,0.0,False,text," [1] L. Auslander, L. Green, F. Hahn. Flows on homogeneous spaces. With the assistance of L. Markus and
"
16,5.3125,0.2421875,0.0,False,0.0,True,text," W. Massey, and an appendix by L. Greenberg, Annals of Mathematics Studies, 53 , Princeton University
"
4,6.75,0.0,0.0,False,0.0,True,text," Press, Princeton, N.J. (1963).
"
14,6.28571428571,0.285714285714,0.0,False,0.0,False,text," [2] V. Bergelson. Ergodic Ramsey Theory. Logic and Combinatorics (edited by S. Simpson). Contemporary
"
4,6.25,0.25,0.0,False,0.0,True,text," Mathematics 65 (1987), 6387.
"
15,5.13333333333,0.266666666667,0.0,False,0.0,False,text," [3] V. Bergelson. Weakly mixing PET. Ergodic Theory Dynam. Systems 7 (1987), no. 3, 337349.
"
15,6.13333333333,0.0,0.0,False,0.0,False,text," [4] V. Bergelson, I. Haland. Sets of recurrence and generalized polynomials. Convergence in ergodic theory
"
16,5.375,0.427083333333,0.0,False,0.0,False,text," and probability (Columbus, OH, 1993), Ohio State Univ. Math. Res. Inst. Publ., 5, de Gruyter, Berlin,
"
2,7.0,0.0,0.0,False,0.0,False,text," (1996), 91-110.
"
15,6.13333333333,0.0,0.0,False,0.0,False,text," [5] V. Bergelson, I. Haland-Knutson. Weak mixing implies mixing of higher orders along tempered functions.
"
7,5.28571428571,0.553571428571,0.0,False,0.0,True,text," To appear in Ergodic Theory Dynam. Systems.
"
13,7.0,0.0,0.0,False,0.0,False,text," [6] V. Bergelson, I. Haland-Knutson, R. McCutcheon. IP Systems, generalized polynomials and recurrence.
"
7,6.14285714286,0.571428571429,0.0,False,0.0,True,text," Ergodic Theory Dynam. Systems 26 (2006), 9991019.
"
16,5.5625,0.125,0.0,False,0.0,False,text," [7] V. Bergelson, B. Host, R. McCutcheon, F. Parreau. Aspects of uniformity in recurrence. Colloq. Math.
"
5,4.8,0.0,0.0,False,1.0,False,text," 84/85 (2000), no. 2, 549576.
"
15,5.66666666667,0.0666666666667,0.0,False,0.0,False,text," [8] V. Bergelson, A. Leibman. Polynomial extensions of van der Waerdens and Szemeredis theorems. J.
"
6,4.83333333333,0.5,0.0,False,0.0,True,text," Amer. Math. Soc. 9 (1996), 725753.
"
14,6.57142857143,0.0714285714286,0.0,False,0.0,False,text," [9] V. Bergelson, A. Leibman, E. Lesigne. Intersective polynomials and polynomial Szemeredi theorem. Adv.
"
5,5.4,0.2,0.0,False,0.0,True,text," Math. 219 (2008), no.1, 369388.
"
15,5.66666666667,0.266666666667,0.0,False,0.0,False,text," [10] V. Bergelson, R. McCutcheon. An ergodic IP polynomial Szemeredi theorem. Mem. Amer. Math. Soc.
"
4,5.25,0.0,0.0,False,1.0,False,text," 146 (2000), viii+106 pp.
"
1,2.0,0.0,0.0,False,0.0,False,text," 35
"
18,4.66666666667,0.166666666667,0.0,False,0.0,False,text," [11] M. Boshernitzan. An extension of Hardys class L of Orders of Innity. J. Analyse Math. 39 (1981),
"
1,7.0,0.0,0.0,False,0.0,False,text," 235255.
"
13,5.15384615385,0.230769230769,0.0,False,0.0,False,text," [12] M. Boshernitzan. New Orders of Innity. J. Analyse Math. 41 (1982), 130167.
"
16,5.4375,0.1875,0.0,False,0.0,False,text," [13] M. Boshernitzan. Orders of Innity generated by dierence equations. Amer. J. Math. 106 (1984), no.
"
2,5.5,0.0,0.0,False,0.0,False,text," 5, 10671089.
"
15,5.2,0.2,0.0,False,0.0,False,text," [14] M. Boshernitzan. Discrete Orders of Innity. Amer. J. Math. 106 (1984), no. 5, 11471198.
"
17,5.35294117647,0.264705882353,0.0,False,0.0,False,text," [15] M. Boshernitzan. Second order dierential equations over Hardy elds. J. London Math. Soc. 2, 35 (1987),
"
3,4.0,0.0,0.0,False,0.0,False,text," no. 1, 109120.
"
14,5.64285714286,0.214285714286,0.0,False,0.0,False,text," [16] M. Boshernitzan. Uniform distribution and Hardy elds. J. Anal. Math. 62 (1994), 225240.
"
16,5.375,0.1875,0.0,False,0.0,False,text," [17] M. Boshernitzan, G. Kolesnik, A. Quas, M. Wierdl. Ergodic averaging sequences. J. Anal. Math. 95
"
2,6.5,0.0,0.0,False,0.0,False,text," (2005), 63103.
"
15,5.86666666667,0.0,0.0,False,0.0,False,text," [18] N. Bourbaki. Fonctions dune variable reele. Chapitre V (Etude Locale des Fonctions), 2nd edition,
"
3,7.33333333333,0.0,0.0,False,0.0,True,text," Hermann, Parris, (1961).
"
19,4.52631578947,0.149122807018,0.0,False,0.0,False,text," [19] L. van den Dries. Analytic Hardy elds and exponential curves in the real plane. Amer. J. Math., 106
"
4,4.75,0.0,0.0,False,0.0,False,text," (1984), no. 1, 149167.
"
17,4.64705882353,0.235294117647,0.0,False,0.0,False,text," [20] P. Erdos, P. Turan, On some sequences of integers. J. London Math. Soc. 11 (1936), 261264.
"
14,6.78571428571,0.214285714286,0.0,False,0.0,False,text," [21] N. Frantzikinakis. Multiple ergodic averages for three polynomials and applications. Trans. Amer. Math.
"
6,5.0,0.166666666667,0.0,False,0.0,True,text," Soc. 360 (2008), no. 10, 5435-5475.
"
17,5.41176470588,0.0,0.0,False,0.0,False,text," [22] N. Frantzikinakis, B. Host, B. Kra. Multiple recurrence and convergence for sets related to the primes.
"
7,5.0,0.571428571429,0.0,False,0.0,True,text," J. Reine Angew. Math. 611 (2007), 131144.
"
17,5.35294117647,0.176470588235,0.0,False,0.0,False,text," [23] N. Frantzikinakis, B. Kra. Polynomial averages converge to the product of integrals. Isr. J. Math. 148
"
2,7.0,0.0,0.0,False,0.0,False,text," (2005), 267276.
"
16,5.5625,0.0,0.0,False,0.0,False,text," [24] H. Furstenberg. Ergodic behavior of diagonal measures and a theorem of Szemeredi on arithmetic pro-
"
7,5.71428571429,0.428571428571,0.0,False,0.0,False,text," gressions. J. Analyse Math. 71 (1977), 204256.
"
13,7.0,0.153846153846,0.0,False,0.0,False,text," [25] H. Furstenberg. Recurrence in ergodic theory and combinatorial number theory. Princeton University
"
3,7.66666666667,0.277777777778,0.0,False,0.0,True,text," Press, Princeton, (1981).
"
14,6.57142857143,0.0,0.0,False,0.0,False,text," [26] H. Furstenberg, Y. Katznelson. An ergodic Szemeredi theorem for IP-systems and combinatorial theory.
"
6,5.16666666667,0.520833333333,0.0,False,0.0,True,text," J. dAnalyse Math. 45 (1985), 117168.
"
16,5.875,0.125,0.0,False,0.0,False,text," [27] B. Green, T. Tao. The primes contain arbitrarily long arithmetic progressions. Annals. Math. 167 (2008),
"
1,7.0,0.0,0.0,False,0.0,False,text," 481547.
"
16,5.875,0.0,0.0,False,0.0,False,text," [28] B. Green, T. Tao. The quantitative behaviour of polynomial orbits on nilmanifolds. Preprint 2007. Avail-
"
3,7.0,0.0,0.0,False,0.0,False,text," able at arXiv:0709.3562
"
15,6.26666666667,0.333333333333,0.0,False,0.0,False,text," [29] G. Hardy. Properties of logarithmico-exponential functions. Proc. London Math. Soc. 2 10 (1912), 54-90.
"
17,5.17647058824,0.401960784314,0.0,False,0.0,False,text," [30] G. Hardy. Orders of Innity. Cambridge Tracts in Math. and Math. Phys., 12 (2nd edition), Cambridge,
"
1,7.0,0.0,0.0,False,0.0,False,text," (1924).
"
16,5.5625,0.1875,0.0,False,0.0,False,text," [31] B. Host, B. Kra. Nonconventional ergodic averages and nilmanifolds. Annals of Math. 161 (2005), 397
"
1,4.0,0.0,0.0,False,0.0,False,text," 488.
"
16,5.0625,0.1875,0.0,False,0.0,False,text," [32] B. Host, B. Kra. Convergence of polynomial ergodic averages. Isr. J. Math. 149 (2005), 119.
"
16,5.3125,0.1875,0.0,False,0.0,False,text," [33] T. Kamae, M. Mend`es-France. Van der Corputs dierence theorem. Isr. J. Math. 31 (1978), 335342.
"
14,6.57142857143,0.0714285714286,0.0,False,0.0,False,text," [34] L. Kuipers, H. Niederreiter. Uniform distribution of sequences. Pure and Applied Mathematics. Wiley-
"
4,10.5,0.230769230769,0.0,False,0.0,True,text," Interscience, New York-London-Sydney, (1974).
"
14,5.85714285714,0.285714285714,0.0,False,0.0,False,text," [35] A. Leibman. Polynomial mappings of groups. Israel Journal of Mathematics 129 (2002), 2960.
"
15,6.0,0.0,0.0,False,0.0,False,text," [36] A. Leibman. Pointwise convergence of ergodic averages for polynomial sequences of translations on a
"
10,5.9,0.4,0.0,False,0.0,False,text," nilmanifold. Ergodic Theory Dynam. Systems 25 (2005), no. 1, 201213.
"
16,6.0,0.1875,0.0,False,0.0,False,text," [37] A. Leibman. Convergence of multiple ergodic averages along polynomials of several variables. Isr. J. Math.
"
3,5.66666666667,0.0,0.0,False,1.0,False,text," 146 (2005), 303316.
"
16,5.8125,0.0,0.0,False,0.0,False,text," [38] E. Lesigne. Sur une nil-variete, les parties minimales associees `a une translation sont uniquement er-
"
10,5.6,0.4,0.0,False,0.0,False,text," godiques. Ergodic Theory Dynam. Systems 11 (1991), no. 2, 379391.
"
14,5.71428571429,0.214285714286,0.0,False,0.0,False,text," [39] R. McCutcheon. FVIP systems and multiple recurrence. Israel J. Math. 146 (2005), 157188.
"
16,5.25,0.1875,0.0,False,0.0,False,text," [40] W. Parry. Ergodic properties of ane transformations and ows on nilmanifolds. Amer. J. Math. 91
"
2,7.0,0.0,0.0,False,0.0,False,text," (1969), 757771.
"
14,6.71428571429,0.35119047619,0.0,False,0.0,False,text," [41] K. Petersen. Ergodic theory. Cambridge Studies in Advanced Mathematics, 2, Cambridge University Press,
"
2,8.5,0.0,0.0,False,0.0,True,text," Cambridge, (1989).
"
14,4.64285714286,0.285714285714,0.0,False,0.0,False,text," [42] M. Rosenlicht. Hardy elds. J. Math. Anal. Appl. 91 (1983), no. 2, 297311.
"
18,4.33333333333,0.222222222222,0.0,False,0.0,False,text," [43] M. Rosenlicht. The rank of a Hardy eld. Trans. Amer. Math. Soc. 280 (1983), no. 2, 659671.
"
1,2.0,0.0,0.0,False,0.0,False,text," 36
"
17,4.88235294118,0.294117647059,0.0,False,0.0,False,text," [44] A. Sarkozy. On dierence sets of integers III. Acta Math. Acad. Sci. Hungar. 31 (1978), 125149.
"
17,5.23529411765,0.117647058824,0.0588235294118,False,0.0,False,text," [45] E. Szemeredi. On sets of integers containing no k elements in arithmetic progression. Acta Arith. 27
"
2,7.0,0.0,0.0,False,0.0,False,text," (1975), 299345.
"
16,5.8125,0.125,0.0,False,0.0,False,text," [46] T. Tao, T. Ziegler. The primes contain arbitrarily long polynomial progressions. Acta Math. 201 (2008),
"
1,7.0,0.0,0.0,False,0.0,False,text," 213305.
"
14,5.78571428571,0.142857142857,0.0,False,0.0,False,text," [47] J. van der Corput. Zahlentheoretische Abschatzungen. Math. Ann. 84 (1921), no. 1-2, 5379.
"
15,6.2,0.261111111111,0.0,False,0.0,False,text," [48] P. Walters. An introduction to ergodic theory. Graduate Texts in Mathematics, 79, Springer-Verlag, New
"
2,9.5,0.0,0.0,False,0.0,True,text," York-Berlin, (1982).
"
16,5.625,0.25,0.0,False,0.0,False,text," [49] T. Ziegler. A nonconventional ergodic theorem for a nilsystem, Ergodic Th. Dynam. Systems 25 (2005),
"
3,4.66666666667,0.0,0.0,False,0.0,False,text," no. 4, 13571370.
"
15,6.13333333333,0.266666666667,0.0,False,0.0,False,text," [50] T. Ziegler. Universal characteristic factors and Furstenberg averages, J. Amer. Math. Soc. 20 (2007),
"
1,5.0,0.0,0.0,False,0.0,False,text," 5397.
"
11,7.45454545455,0.0,0.0,False,0.0,False,text," (Nikos Frantzikinakis) Department of Mathematics, University of Memphis, Memphis, TN, 38152,
"
1,3.0,0.0,0.0,False,0.0,True,text," USA
"
3,12.6666666667,0.625,0.0,False,0.0,True,text," E-mail address: frantzikinakis@gmail.com
"
12,6.33333333333,0.0,0.0,False,0.0,False,text," (Mate Wierdl) Department of Mathematics, University of Memphis, Memphis, TN, 38152, USA
"
3,11.3333333333,0.625,0.0,False,0.0,True,text," E-mail address: wierdlmate@gmail.com
"
1,2.0,0.0,0.0,False,0.0,False,text," 37
"
