words_num,awerage_word_length,italicness,formuleness,heading_first_word,boldness_first_word,is_capital_first_letter,type,text
1,1.0,0.0,0.0,False,0.0,False,text," 7
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
1,1.0,0.0,0.0,False,0.0,False,text," g
"
1,1.0,0.0,0.0,False,0.0,False,text," u
"
1,1.0,0.0,0.0,False,0.0,True,text," A
"
1,1.0,0.0,0.0,False,0.0,False,text," 7
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
1,1.0,0.0,0.0,False,0.0,False,text," ]
"
1,1.0,0.0,0.0,False,0.0,False,text," .
"
1,1.0,0.0,0.0,False,0.0,True,text," O
"
1,1.0,0.0,0.0,False,0.0,True,text," C
"
1,1.0,0.0,0.0,False,0.0,False,text," h
"
1,1.0,0.0,0.0,False,0.0,False,text," t
"
1,1.0,0.0,0.0,False,0.0,False,text," a
"
1,1.0,0.0,0.0,False,0.0,False,text," m
"
1,1.0,0.0,0.0,False,0.0,False,text," [
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," v
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," 5
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
1,1.0,0.0,0.0,False,0.0,False,text," .
"
1,1.0,0.0,0.0,False,0.0,False,text," 0
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 6
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," :
"
1,1.0,0.0,0.0,False,0.0,False,text," v
"
1,1.0,0.0,0.0,False,0.0,False,text," i
"
1,1.0,0.0,0.0,False,0.0,True,text," X
"
1,1.0,0.0,0.0,False,0.0,False,text," r
"
1,1.0,0.0,0.0,False,0.0,False,text," a
"
7,7.14285714286,0.0,0.0,False,0.0,True,text," Supersaturation in Posets and Applications Involving the
"
2,7.5,0.0,0.0,False,0.0,True,text," Container Method
"
4,4.25,0.0,0.0,False,0.0,True,text," Jonathan A. Noel1, 2
"
2,5.0,0.0,0.0,False,0.0,True,text," Alex Scott3
"
2,6.5,0.0,0.0,False,0.0,True,text," Benny Sudakov1
"
1,8.0,0.0,0.0,False,1.0,True,text," Abstract
"
12,6.0,0.0,0.0,False,0.0,True,text," We consider supersaturation problems in partially ordered sets (posets) of the fol-
"
17,4.11764705882,0.0,0.117647058824,False,0.0,False,text," lowing form. Given a nite poset P and an integer m greater than the cardinality of the
"
17,4.11764705882,0.0,0.0588235294118,False,0.0,False,text," largest antichain in P , what is the minimum number of comparable pairs in a subset of
"
15,4.8,0.0,0.1,False,0.0,True,text," P of cardinality m? We provide a framework for obtaining lower bounds on this quantity
"
14,5.21428571429,0.0,0.0,False,0.0,False,text," based on counting comparable pairs relative to a random chain and apply this framework
"
13,6.30769230769,0.0,0.0,False,0.0,False,text," to obtain supersaturation results for three classical posets: the boolean lattice, the collec-
"
15,3.66666666667,0.0,0.0666666666667,False,0.0,False,text," q ordered by set inclusion and the set of divisors of the square of a
"
5,3.8,0.0,0.2,False,0.0,False,text," tion of subspaces of Fn
"
14,5.35714285714,0.0,0.0,False,0.0,False,text," square-free integer under the divides relation. The bound that we obtain for the boolean
"
15,4.66666666667,0.0,0.0,False,0.0,False,text," lattice can be viewed as an approximate version of a known theorem of Kleitman [23].
"
14,5.0,0.0,0.0,False,0.0,True,text," In addition, we apply our supersaturation results to obtain (a) upper bounds on the
"
15,4.93333333333,0.0,0.0,False,0.0,False,text," number of antichains in these posets and (b) asymptotic bounds on the cardinality of the
"
13,5.69230769231,0.0,0.00961538461538,False,0.0,False,text," largest antichain in p-random subsets of these posets which hold with high probability
"
16,4.4375,0.0,0.0625,False,0.0,False,text," (for p in a certain range). The proofs of these results rely on a container-type lemma
"
15,4.93333333333,0.0,0.0,False,0.0,False,text," for posets which generalises a result of Balogh, Mycroft and Treglown [6]. We also state
"
12,6.25,0.0,0.0,False,0.0,False,text," a number of open problems regarding supersaturation in posets and counting antichains.
"
1,1.0,0.0,0.0,False,1.0,False,text," 1
"
1,12.0,0.0,0.0,False,1.0,True,text," Introduction
"
15,5.06666666667,0.0,0.0,False,0.0,True,text," A large part of extremal combinatorics is concerned with determining the maximum size of a
"
14,5.57142857143,0.0,0.0,False,0.0,False,text," combinatorial object subject to the constraint that it does not contain a certain forbidden
"
15,5.2,0.0,0.0,False,0.0,False,text," substructure. One example of such an extremal problem is to determine the cardinality of the
"
16,4.875,0.0,0.0625,False,0.0,False,text," largest subset of a partially ordered set (poset) P which does not contain a comparable pair;
"
15,5.26666666667,0.06,0.0,False,0.0,False,text," i.e. to determine the cardinality of the largest antichain. Perhaps the most famous result in
"
17,4.41176470588,0.0,0.0,False,0.0,False,text," this area is Sperners Theorem [37] which says that the size of the largest antichain in the
"
20,4.05,0.1,0.32,False,0.0,False,text," boolean lattice poset P(n), consisting of all subsets of [n] := {1, . . . , n} ordered by inclusion,
"
3,1.0,0.0,0.333333333333,False,0.0,False,text," is  n
"
1,4.0,0.0,1.25,False,0.0,False,text," n/2.
"
15,4.8,0.0,0.0,False,0.0,True,text," A closely related problem is to determine the minimum number of copies of a particular
"
12,6.58333333333,0.0,0.0,False,0.0,False,text," substructure in a combinatorial object of prescribed size. These so called supersaturation
"
14,5.42857142857,0.0,0.0,False,0.0,False,text," problems have a long history starting with a result of Rademacher (unpublished, see [18])
"
16,4.3125,0.0,0.09375,False,0.0,False,text," which says that every graph with n vertices and more than n2/4 edges must contain at
"
11,6.90909090909,0.0,0.121212121212,False,0.0,False,text," least n/2 triangles. For additional background on supersaturation problems in extremal
"
12,5.16666666667,0.0,0.0,False,0.0,False,text," combinatorics see, e.g., [14, 29, 30, 33, 34] and the references therein.
"
13,6.38461538462,0.0,0.0,False,0.0,False,text," 1Department of Mathematics, ETH, Raemistrasse 101, HG G 33.4, 8092 Zurich, Switzerland. E-mail:
"
1,46.0,0.0,0.0434782608696,False,0.0,False,text," {jonathan.noel,benjamin.sudakov}@math.ethz.ch.
"
19,4.42105263158,0.0,0.0,False,0.0,False,text," 2Part of this work was completed while the rst author was a DPhil student at the University of Oxford.
"
11,8.0,0.0,0.0,False,0.0,False,text," 3Mathematical Institute, University of Oxford, Andrew Wiles Building, Radclie Observatory Quarter,
"
8,7.375,0.0,0.0,False,0.0,True,text," Woodstock Road, Oxford, OX2 6GG, UK. E-mail: scott@maths.ox.ac.uk.
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
16,4.5625,0.203125,0.0,False,0.0,True,text," Our focus in this paper is on a natural supersaturation problem for posets: given a nite
"
18,3.94444444444,0.791666666667,0.152777777778,False,0.0,False,text," poset P and a positive integer m  |P|, what is the minimum number of comparable pairs in
"
19,3.84210526316,0.289473684211,0.131578947368,False,0.0,False,text," a subset S of P of cardinality m? An early result in this direction is due to Kleitman [23]
"
20,3.25,0.0,0.0916666666667,False,0.0,False,text," who proved that, for 1  m  2n, the number of comparable pairs in a subset of P(n) of
"
17,4.64705882353,0.0,0.137254901961,False,0.0,False,text," cardinality m is minimised by a collection of m subsets of [n] whose cardinalities are as close
"
14,5.35714285714,0.0,0.047619047619,False,0.0,False,text," to n/2 as possible. This result strengthens Sperners Theorem and settled a conjecture of
"
10,4.7,0.0,0.0,False,0.0,True,text," Erdos and Katona (see [10, 13, 16] for further results).
"
14,5.5,0.0,0.0,False,0.0,True,text," In this paper, we prove new supersaturation results for two classical posets (Theorems 1.2
"
14,5.28571428571,0.0,0.0,False,0.0,False,text," and 1.4 below). Our method involves counting comparisons relative to a random chain and
"
15,5.0,0.0,0.0,False,0.0,False,text," should be applicable to posets beyond those covered in this paper. We also illustrate the
"
15,5.13333333333,0.0,0.0,False,0.0,False,text," method by using it to prove an approximate version of the supersaturation theorem of Kleit-
"
15,5.33333333333,0.0,0.0,False,0.0,False,text," man [23] in the boolean lattice (Theorem 3.1). All three of these supersaturation results will
"
17,4.23529411765,0.0,0.0,False,0.0,False,text," be applied to prove bounds on the number of antichains in these posets and bounds on the
"
9,5.0,0.0,0.0,False,0.0,False,text," size of antichains in random subsets of these posets.
"
19,3.63157894737,0.0,0.112781954887,False,0.0,True,text," Throughout the paper, for a subset S of a poset P , we let comp(S) denote the number of
"
4,4.75,0.0,0.125,False,0.0,False,text," comparable pairs in S.
"
21,3.14285714286,0.0,0.198412698413,False,1.125,True,heading," Denition 1.1. Given a prime power q and integers n  1 let V (q, n) be the poset of all
"
3,4.33333333333,0.0,0.333333333333,False,0.0,False,body," subspaces of Fn
"
15,3.8,0.135,0.173333333333,False,0.0,False,body," q ordered by inclusion. For an integer 0  i  n, the q-binomial coecient
"
2,0.5,0.0,0.5,False,0.0,False,body,"  n
"
8,3.5,0.0,0.3125,False,0.0,False,body," iq is the number of subspaces of Fn
"
2,1.0,0.0,1.0,False,0.0,False,after_body," h n
"
1,3.0,0.0,1.0,False,0.0,False,text," iiq
"
4,6.75,0.0,0.0,False,0.0,True,text," Elementary counting shows that
"
3,1.33333333333,0.0,0.444444444444,False,0.0,False,text," 1  qnj
"
4,1.5,0.0,0.375,False,0.0,False,text," 1  qj+1 .
"
4,3.5,0.0,0.375,False,0.0,False,body," q of dimension i.
"
1,2.0,0.0,1.0,False,0.0,False,after_body," i1
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,4.0,0.0,0.5,False,0.0,True,text," Yj=0
"
7,1.14285714286,0.0,1.14285714286,False,0.0,False,text," 0q , . . . , n
"
12,3.08333333333,0.0,0.125,False,0.0,False,text," for all 0  i  n. We prove the following theorem.
"
14,3.28571428571,0.0,0.178571428571,False,0.0,True,text," One may also observe that, for xed n and q, the sequence  n
"
3,2.66666666667,0.0,0.333333333333,False,0.0,False,text," satises  n
"
18,3.66666666667,0.796296296296,0.111111111111,True,1.0,True,heading," Theorem 1.2. Let q be a prime power and k be a xed positive integer. There exists a
"
18,3.33333333333,0.5,0.275925925926,False,0.0,False,body," constant n0(k) such that if n  n0(k) and S  V (q, n) has cardinality at least
"
4,3.75,0.0,0.375,False,0.0,False,text," nq is unimodal and
"
3,1.66666666667,0.0,1.0,False,0.0,False,text," iq =h n
"
1,4.0,0.0,1.25,False,0.0,False,text," niiq
"
1,4.0,1.0,0.0,False,0.0,False,text," then
"
1,2.0,0.0,1.0,False,0.0,False,text," k1
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,1.0,False,0.0,False,text," n
"
2,3.5,0.0,0.285714285714,False,0.0,False,text,"  nk+1+2r
"
1,4.0,0.0,0.75,False,0.0,True,text," Xr=0
"
1,1.0,0.0,3.0,False,0.0,False,text," q
"
5,3.0,0.0,0.445238095238,False,0.0,False,text," comp(S)  t(n + k)/2
"
1,1.0,0.0,1.0,False,0.0,False,text," k
"
2,1.5,0.0,0.5,False,0.0,False,text," + t,
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,1.0,0.0,2.0,False,0.0,False,text," q
"
21,2.57142857143,0.0,0.142857142857,False,0.0,True,text," It is easy to see that Theorem 1.2 is best possible when k = 1 and 0  t  h
"
1,8.0,0.0,0.875,False,0.0,False,text," (n1)/2iq
"
16,4.4375,0.0,0.208333333333,False,0.0,False,text," as the set S consisting of all subspaces of dimension n/2 and t subspaces of dimension
"
6,5.0,0.0,0.361111111111,False,0.0,False,text," (n  1)/2 contains exactly th(n+1)/2
"
22,2.72727272727,0.0,0.219696969697,False,1.125,True,heading," Denition 1.3. Given n  1, we dene a poset on {0, 1, 2}n where x  y if and only if
"
23,2.91304347826,0.0,0.31884057971,False,0.0,False,body," xj  yj for 1  j  n, where xj and yj are the jth coordinates of x and y, respectively. For
"
21,3.28571428571,0.0,0.210317460317,False,0.0,False,body," 0  i  2n, let i(n) denote the number of vectors in {0, 1, 2}n whose coordinates sum to i.
"
2,8.0,0.0,0.0,False,0.0,False,after_body," comparable pairs.
"
1,2.0,0.0,1.0,False,0.0,False,text," iq
"
1,1.0,0.0,1.0,False,0.0,False,text," n
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
20,3.6,0.0,0.0916666666667,False,0.0,True,text," The poset {0, 1, 2}n can also be viewed as the poset of divisors of the square of a square-
"
16,4.875,0.0,0.0625,False,0.0,False,text," free integer with n prime factors under the divides relation or the poset of all submultisets
"
16,5.0,0.0,0.0625,False,0.0,False,text," of a multiset consisting of n distinct elements each of multiplicity two under inclusion. It is
"
4,3.25,0.0,0.0,False,0.0,False,text," easy to see that
"
2,2.5,0.0,0.375,False,0.0,False,text," i(n) =
"
1,3.0,0.0,1.33333333333,False,0.0,False,text," i/2
"
2,6.5,0.0,0.875,False,0.0,True,text," Xs=max{0,in} n
"
5,0.8,0.0,0.8,False,0.0,False,text," i  si  s
"
2,1.0,0.0,1.5,False,0.0,False,text," s .
"
18,3.61111111111,0.0,0.162037037037,False,0.0,True,text," Also, trivially, i(n) = 2ni(n) for 0  i  2n. A result of de Bruijn, van Ebbenhorst
"
15,5.13333333333,0.0,0.122222222222,False,0.0,True,text," Tengbergen and Kruyswijk [15] says that {0, 1, 2}n has a symmetric chain decomposition (see
"
18,4.44444444444,0.0,0.288888888889,False,0.0,False,text," [3] for details) which, in particular, implies that the sequence 0(n), . . . , 2n(n) is unimodal.
"
5,5.4,0.0,0.0,False,0.0,True,text," We prove the following theorem.
"
17,4.35294117647,0.78431372549,0.0823529411765,True,1.0,True,heading," Theorem 1.4. Let k be a xed positive integer. Then there exists a constant n0(k) such that
"
14,2.92857142857,0.428571428571,0.302380952381,False,0.0,False,body," if n  n0(k) and S  {0, 1, 2}n has cardinality at least
"
1,4.0,1.0,0.0,False,0.0,False,after_body," then
"
4,2.5,0.0,0.125,False,0.0,False,text," to k, we have
"
9,2.88888888889,0.0,0.185185185185,False,0.0,True,text," Note that for k = 1 we have 3k1(n)
"
10,3.6,0.0,0.2,False,0.0,False,text," 2 and, for general k and n large with respect
"
3,2.33333333333,0.0,0.583333333333,False,0.0,False,body," r(n) + t,
"
2,2.0,0.0,1.0,False,0.0,False,after_body," n+ k1
"
2,0.5,0.0,0.0,False,0.0,False,text," 2 
"
2,3.0,0.0,1.125,False,0.0,True,text," Xr=n k1
"
2,0.5,0.0,0.0,False,0.0,False,text," 2 
"
4,2.25,0.0,0.666666666667,False,0.0,False,text," 2k1(n)  1 t.
"
2,6.5,0.0,0.571428571429,False,0.0,False,text," comp(S) 3k1(n)
"
5,2.0,0.0,0.333333333333,False,0.0,False,text," 2k1(n)  1 = n1
"
4,2.0,0.0,0.375,False,0.0,False,text," (1 + o(1) n
"
1,3.0,0.0,1.0,False,0.0,False,text," 3k1
"
2,0.5,0.0,0.5,False,0.0,False,text,"  n
"
1,3.0,0.0,1.0,False,0.0,False,text," 2k1
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,6.0,0.0,0.666666666667,False,0.0,False,text," 3k1(n)
"
4,2.0,0.0,0.166666666667,False,0.0,False,text," 2k1(n)  1 =
"
5,3.2,0.0,0.13,False,0.0,False,text," (1 + o(1))(2k  1)!nk
"
3,2.0,0.0,0.111111111111,False,0.0,False,text," (3k  1)!
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,5.0,0.0,0.0,False,0.0,False,text," (1.5)
"
18,3.83333333333,0.0,0.144444444444,False,0.0,True,text," In particular, for k = 1 and |S| not much larger than n(n), Theorem 1.4 is nearly best
"
20,3.55,0.0,0.266666666667,False,0.0,False,text," possible. To see this, let S = Sn  Sn+1 where Sn contains all elements of {0, 1, 2}n whose
"
16,4.75,0.0,0.270833333333,False,0.0,False,text," coordinates sum to n and Sn+1 contains the |S|n(n) elements of {0, 1, 2}n whose coordinates
"
16,4.25,0.0,0.0625,False,0.0,False,text," sum to n + 1 and, subject to this, have the minimum number of non-zero coordinates.
"
14,5.21428571429,0.0,0.0,False,0.0,True,text," In the past few years, there has been some considerable success in extending classical
"
13,5.92307692308,0.0,0.0,False,0.0,False,text," results in extremal combinatorics to sparse random settings due to the breakthroughs made
"
13,6.0,0.0,0.0,False,0.0,False,text," independently by Conlon and Gowers [12] and Schacht [36]. Shortly thereafter another, very
"
12,6.25,0.0,0.0,False,0.0,False,text," dierent, approach known as the container method was developed independently by Balogh,
"
15,4.66666666667,0.0,0.0,False,0.0,True,text," Morris and Samotij [5] and Saxton and Thomason [35]. As was demonstrated in [5, 35],
"
17,4.29411764706,0.0,0.0,False,0.0,False,text," the container method can be used to prove many of the results of [12, 36]. Two advantages
"
16,4.8125,0.0,0.0,False,0.0,False,text," of the container method are that it is relatively straightforward to apply and that it often
"
12,6.5,0.0,0.0,False,0.0,False,text," provides counting results which can be much stronger than the corresponding probabilistic
"
12,6.33333333333,0.0,0.0,False,0.0,False,text," statements. Supersaturation theorems form a key ingredient in most proofs involving the
"
15,5.0,0.0,0.0,False,0.0,False,text," container method. For instance, many of the proofs in [5, 35] applied the classical graph
"
12,6.41666666667,0.0,0.0,False,0.0,False,text," supersaturation theorem of Erdos and Simonovits [20]. For additional applications of the
"
10,5.1,0.0,0.0,False,0.0,False,text," container method, see [4, 8, 31] and the references therein.
"
16,4.25,0.0,0.0,False,0.0,True,text," We apply Theorems 1.2 and 1.4 and the container method to prove upper bounds on the
"
19,3.73684210526,0.0,0.210526315789,False,0.0,False,text," number of antichains in V (q, n) and {0, 1, 2}n (Theorem 1.6 and 1.7) and upper bounds on
"
16,4.875,0.0,0.0,False,0.0,False,text," the largest antichains in random subsets of these posets of a certain density which hold with
"
6,5.83333333333,0.0,0.0,False,0.0,False,text," high probability (Theorems 1.8 and 1.9).
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
17,3.70588235294,0.725490196078,0.132352941176,True,1.0,True,heading," Theorem 1.6. Let q be a xed prime power. The number of antichains in V(q, n) is
"
2,7.0,0.0,0.807692307692,False,0.0,False,after_body," (1+O(nqn/4))h n
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
13,4.46153846154,0.461538461538,0.272893772894,True,1.0,True,heading," Theorem 1.7. The number of antichains in {0, 1, 2}n is 21+Olog n/nn(n)
"
2,3.0,0.5,0.6,False,0.0,False,after_body," n/2iq .
"
1,1.0,1.0,0.0,False,0.0,False,text," .
"
19,3.47368421053,0.0,0.0526315789474,False,0.0,True,text," Of course, the number of antichains in any poset P is at least 2 to the power of the
"
17,4.52941176471,0.0,0.0,False,0.0,False,text," cardinality of its largest antichain, and so Theorems 1.6 and 1.7 are best possible up to the
"
7,4.0,0.0,0.0285714285714,False,0.0,False,text," (1 + o(1)) factor in the exponent.
"
19,3.73684210526,0.0986842105263,0.138157894737,False,0.0,True,text," Given a set X, a p-random subset of X is a subset of X obtained by including each element
"
9,5.0,0.0,0.222222222222,False,0.0,False,text," of X with probability p independently of one another.
"
18,3.55555555556,0.712962962963,0.0555555555556,True,1.0,True,heading," Theorem 1.8. Let q be a xed prime power and   0. There exists a positive constant
"
18,4.16666666667,0.666666666667,0.236111111111,False,0.0,False,body," c(, q) such that if p  c(, q)/qn/2, then with high probability every antichain in a p-random
"
13,3.15384615385,0.461538461538,0.320512820513,False,0.0,False,body," subset of V (q, n) has cardinality at most (1 + )ph n
"
20,3.45,0.570833333333,0.116666666667,True,1.0,True,heading," Theorem 1.9. Let   0 be xed. There exists a positive constant c() such that if p  c()/n,
"
16,4.875,0.8046875,0.122395833333,False,0.0,False,body," then with high probability every antichain in a p-random subset of {0, 1, 2}n has cardinality
"
5,3.2,0.428571428571,0.142857142857,False,0.0,False,body," at most (1 + )pn(n).
"
1,5.0,0.0,1.2,False,0.0,False,after_body," n/2iq
"
1,1.0,1.0,0.0,False,0.0,False,text," .
"
20,3.5,0.0,0.0,False,0.0,True,text," It is not hard to see that Theorems 1.8 and 1.9 are best possible up to the choice of the
"
12,4.16666666667,0.0,0.166666666667,False,0.0,False,text," constants c(, q) and c(); this is made explicit in Section 6.
"
17,4.29411764706,0.0,0.0,False,0.0,True,text," In the next section, we prove a general lemma for obtaining lower bounds on the number of
"
20,3.8,0.0,0.1,False,0.0,False,text," comparable pairs in a subset S of a poset P . We provide a few basic applications of this lemma
"
17,4.47058823529,0.0,0.0,False,0.0,False,text," in Section 3 including a proof of an approximate version of the theorem of Kleitman [23] and
"
18,3.94444444444,0.0,0.0,False,0.0,False,text," a proof of Theorem 1.2. In Section 4, we apply this lemma again to prove Theorem 1.4. In
"
16,4.875,0.0,0.0,False,0.0,True,text," Section 5 we prove a container-type lemma for posets which generalises a result of [6] proved
"
19,4.10526315789,0.0,0.0,False,0.0,False,text," for the boolean lattice. In Section 6, we use this lemma to prove Theorems 1.6, 1.7, 1.8 and 1.9
"
17,4.41176470588,0.0,0.0,False,0.0,False,text," and a known upper bound on the number of antichains in the boolean lattice included for the
"
15,4.86666666667,0.0,0.0666666666667,False,0.0,False,text," sake of demonstration. Throughout the paper, we will require several known bounds on  n
"
1,2.0,0.0,1.5,False,0.0,False,text," iq
"
8,4.375,0.0,0.09375,False,0.0,False,text," and i(n) which are stated in the appendix.
"
6,5.66666666667,0.0,0.0,False,1.0,False,text," 2 Comparison Counting Via Random Chains
"
14,5.5,0.0,0.0,False,0.0,True,text," Our general approach to proving supersaturation results, which was inspired by [13], is to
"
17,4.35294117647,0.0,0.117647058824,False,0.0,False,text," count comparable pairs in a subset S of P by considering the expected number of such pairs
"
16,4.625,0.0,0.0625,False,0.0,False,text," in a chain of P chosen randomly according to some distribution. One should point out that
"
16,4.75,0.0,0.0,False,0.0,False,text," the general idea of counting comparable pairs relative to a random chain goes back, in some
"
17,4.23529411765,0.0,0.0,False,0.0,False,text," sense, to Lubells proof [28] of the LYM inequality. It was recently used by Das, Gan and
"
17,4.35294117647,0.0,0.0588235294118,False,0.0,True,text," Sudakov [13] and Dove, Griggs, Kang and Sereni [16] to count chains of length k in subsets
"
16,4.8125,0.0,0.03125,False,0.0,False,text," of P(n) of prescribed cardinality. In order for this technique to be eective, one requires a
"
14,5.21428571429,0.0,0.0714285714286,False,0.0,False,text," distribution on the chains in P which is suciently balanced. Roughly speaking, what we
"
17,4.52941176471,0.0,0.0,False,0.0,False,text," mean by this is that a random chain chosen according to this distribution is not too unlikely
"
19,3.68421052632,0.0,0.0526315789474,False,0.0,False,text," to contain any xed element of P and, at the same time, not too likely to contain any xed
"
18,4.16666666667,0.0,0.0555555555556,False,0.0,False,text," comparable pair of P . Our estimates will use a lemma on random chains, for which we require
"
6,5.5,0.0,0.0,False,0.0,False,text," the notion of a comparability digraph.
"
17,3.82352941176,0.117647058824,0.176470588235,False,1.125,True,heading," Denition 2.1. Let P be a poset. A comparability digraph for P is a digraph D with
"
6,2.33333333333,0.0,0.388888888889,False,0.0,True,body," V (D) = P such that
"
1,1.0,0.0,0.0,False,0.0,False,body," 4
"
21,2.90476190476,0.0,0.222222222222,False,0.0,False,body,"  for every directed arc (x, y) of D, we have that x is comparable to y in P , and
"
23,2.91304347826,0.0,0.249275362319,False,0.0,False,body,"  for every comparable pair x, y  P , exactly one of the arcs (x, y) or (y, x) is in E(D).
"
15,4.8,0.0,0.0666666666667,False,0.0,True,after_body," We remark that a poset P can have many comparability digraphs. In particular, the fact
"
17,4.23529411765,0.0,0.117647058824,False,0.0,False,text," that a comparability digraph contains an arc from x to y does not determine which of the
"
9,2.33333333333,0.0,0.444444444444,False,0.0,False,text," relations x  y or y  x holds.
"
21,3.42857142857,0.714285714286,0.142857142857,True,1.0,True,heading," Lemma 2.2. Let P be a poset, let D be a comparability digraph for P , let  be a distribution
"
19,3.73684210526,0.894736842105,0.210526315789,False,0.0,False,body," on the chains of P and let C be a random chain chosen according to . Suppose further that
"
22,1.90909090909,0.454545454545,0.295454545455,False,0.0,True,body," P (x  C)  0 for every x  P . Then, for every set S  P , we have
"
10,1.5,0.0,0.883333333333,False,0.0,True,text," P (y  C | x  C)1 |S| min
"
3,3.33333333333,0.0,0.047619047619,False,0.0,False,text," comp(S)  max
"
5,1.6,0.0,0.75,False,0.0,True,text," P (x  C)1! .
"
1,9.0,0.0,0.666666666667,False,0.0,False,text," (x,y)E(D)
"
1,2.0,0.0,1.5,False,0.0,False,text," xP
"
19,3.42105263158,0.0526315789474,0.25,False,0.0,True,text," Proof. We proceed by induction on |S| where the base case |S|  (minxP P (x  C))1 is
"
8,3.0,0.0,0.25,False,0.0,False,text," trivial. Given w  S, we dene d+
"
16,2.4375,0.0,0.28125,False,0.0,True,text," S (w) to be the number of arcs (w, z)  E(D) with z  S.
"
13,2.46153846154,0.0,0.653846153846,False,0.0,True,text," S (w) max(x,y)E(D) P (y  C | x  C)1. In this
"
9,3.33333333333,0.0,0.277777777778,False,0.0,True,text," Suppose that there exists w  S with d+
"
14,4.0,0.0,0.214285714286,False,0.0,False,text," case, we apply the inductive hypothesis to S \ {w} to obtain at least
"
2,1.5,0.0,0.0,False,0.0,False,text,"  max
"
1,9.0,0.0,0.666666666667,False,0.0,False,text," (x,y)E(D)
"
12,1.58333333333,0.0,0.902777777778,False,0.0,True,text," P (y  C | x  C)1 |S \ {w}| min
"
1,2.0,0.0,1.5,False,0.0,False,text," xP
"
5,1.6,0.0,0.75,False,0.0,True,text," P (x  C)1! .
"
17,4.29411764706,0.0,0.0966386554622,False,0.0,False,text," comparable pairs in S which do not involve w. We then obtain the desired bound on comp(S)
"
19,3.78947368421,0.0,0.166666666667,False,0.0,False,text," by considering these comparable pairs along with those of the form (w, z)  E(D) with z  S.
"
10,3.4,0.0,0.2,False,0.0,True,text," Thus, we may assume that every w  S satises
"
1,2.0,0.0,0.5,False,0.0,False,text," d+
"
1,9.0,0.0,0.666666666667,False,0.0,False,text," (x,y)E(D)
"
4,1.75,0.0,0.333333333333,False,0.0,True,text," S (w)  max
"
8,1.125,0.0,0.854166666667,False,0.0,True,body," P (y  C | x  C)1
"
13,3.76923076923,0.0,0.530769230769,False,0.0,True,after_body," The chain C contains precisely |C  S| elements of S and |CS|2
"
12,3.5,0.0,0.583333333333,False,0.0,False,text," of S (since every pair in C is comparable). Since k k
"
6,1.66666666667,0.0,0.616666666667,False,0.0,True,text," P (w  C)  Xw,zS
"
4,1.25,0.0,0.333333333333,False,0.0,False,text," 2  = XwS
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
5,4.0,0.0,0.0,False,0.0,False,text,"  of the comparable pairs
"
9,2.11111111111,0.0,0.166666666667,False,0.0,False,text," 2  1 for all k, we get that
"
5,1.4,0.0,0.733333333333,False,0.0,True,text," P (w, z  C)
"
1,5.0,0.0,0.0,False,0.0,False,text," (2.3)
"
8,1.25,0.0,0.770833333333,False,0.0,False,text," 1  E|C  S| |C  S|
"
4,1.25,0.0,0.75,False,0.0,True,body," P (w  C)
"
3,1.33333333333,0.0,0.444444444444,False,0.0,False,after_body," 1  XzS
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
6,1.33333333333,0.0,0.5,False,0.0,True,text," P (w  C)1  d+
"
2,2.0,0.0,0.666666666667,False,0.0,False,text," = XwS
"
2,1.5,0.0,0.666666666667,False,0.0,False,text,"  XwS
"
1,9.0,0.0,0.666666666667,False,0.0,False,text," (w,z)E(D)
"
3,2.33333333333,0.0,0.444444444444,False,0.0,True,text," S (w) max
"
1,9.0,0.0,0.666666666667,False,0.0,False,text," (x,y)E(D)
"
1,9.0,0.0,0.666666666667,False,0.0,False,text," (w,z)E(D)
"
8,1.0,0.0,0.875,False,0.0,True,text," P (z  C | w  C)
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
9,1.0,0.0,0.888888888889,False,0.0,True,text," P (y  C | x  C) .
"
16,4.4375,0.0,0.0,False,0.0,True,text," By (2.3), all of the summands are positive, and so this expression is bounded below by
"
1,6.0,0.0,0.833333333333,False,0.0,True,text," XwSmin
"
1,2.0,0.0,1.5,False,0.0,False,text," xP
"
6,1.33333333333,0.0,0.555555555556,False,0.0,True,text," P (x  C)1  d+
"
3,2.33333333333,0.0,0.444444444444,False,0.0,True,text," S (w) max
"
1,9.0,0.0,0.666666666667,False,0.0,False,text," (x,y)E(D)
"
9,1.0,0.0,0.888888888889,False,0.0,True,text," P (y  C | x  C) .
"
1,1.0,0.0,0.0,False,0.0,False,text," 5
"
3,6.66666666667,0.0,0.0,False,0.0,True,text," Rearranging, we obtain
"
3,3.66666666667,0.0,0.492063492063,False,0.0,False,text," comp(S) = XwS
"
2,5.0,0.0,0.0,False,0.0,False,text," as desired.
"
1,2.0,0.0,0.5,False,0.0,False,text," d+
"
4,1.75,0.0,0.333333333333,False,0.0,True,text," S (w)  max
"
1,9.0,0.0,0.666666666667,False,0.0,False,text," (x,y)E(D)
"
10,1.5,0.0,0.883333333333,False,0.0,True,text," P (y  C | x  C)1 |S| min
"
1,2.0,0.0,1.5,False,0.0,False,text," xP
"
4,1.75,0.0,0.6875,False,0.0,True,text," P (x  C)1!
"
16,4.3125,0.0,0.0,False,1.0,True,heading," Remark 2.4. We remark that the proof of this lemma generalises to give a lower bound
"
21,3.28571428571,0.0,0.119047619048,False,0.0,False,body," on the number of edges induced by a set of m vertices in a general graph G in terms of m.
"
18,4.05555555556,0.0,0.0,False,0.0,True,body," That is, one could orient the edges of the graph and select a random clique according to a
"
3,8.0,0.0,0.333333333333,False,0.0,False,body," probability distribution .
"
8,3.875,0.0,0.0,False,1.0,False,after_body," 3 Supersaturation in P(n) and V (q, n)
"
16,4.5,0.0,0.0,False,0.0,True,text," To illustrate the applicability of Lemma 2.2, we prove a weak version of the theorem of
"
15,5.33333333333,0.0,0.0,False,0.0,True,text," Kleitman [23] in the boolean lattice which is often good enough for applications involving the
"
10,4.8,0.0,0.0,False,0.0,False,text," container method (see, e.g., [6, 8, 11] and Theorem 6.1).
"
16,4.6875,0.708333333333,0.0625,True,1.0,True,heading," Theorem 3.1 (Kleitman [23]). Let k be a xed positive integer. Then there exists a constant
"
18,3.05555555556,0.611111111111,0.183333333333,False,0.0,False,body," n0(k) such that if n  n0(k) and S  P(n) is a set of cardinality at least
"
1,4.0,1.0,0.0,False,0.0,False,after_body," then
"
1,2.0,0.0,1.0,False,0.0,False,text," k1
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,1.0,False,0.0,False,text," n
"
2,3.5,0.0,0.285714285714,False,0.0,False,text,"  nk+1+2r
"
1,4.0,0.0,0.75,False,0.0,True,text," Xr=0
"
3,1.0,0.0,0.333333333333,False,0.0,False,text,"  + t,
"
5,3.0,0.0,0.445238095238,False,0.0,False,text," comp(S)  t(n + k)/2
"
1,1.0,0.0,1.0,False,0.0,False,text," k
"
1,1.0,0.0,2.0,False,0.0,False,text," .
"
21,3.19047619048,0.047619047619,0.15873015873,False,0.0,True,text," Proof. For 0  r  k  1, let Pr be the poset consisting all subsets of [n] of cardinality
"
4,4.75,0.0,0.142857142857,False,0.0,False,text," equivalent to  nk+1+2r
"
13,4.23076923077,0.0,0.0769230769231,False,0.0,False,text,"  modulo k ordered by inclusion (the idea of splitting the levels of
"
16,4.75,0.0,0.09375,False,0.0,True,text," P(n) into equivalence classes modulo k is also used by Collares Neto and Morris [11]). Note
"
15,2.53333333333,0.0,0.326666666667,False,0.0,False,text," that P0    Pk1 partitions P(n). Dene Sr := S  Pr and
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
2,5.5,0.0,0.5,False,0.0,True,text," Clearly, Pk1
"
21,2.57142857143,0.0,0.18253968254,False,0.0,False,text," r=0 tr = t. Our goal is to show that, for 0  r  k  1, the following holds:
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,1.0,False,0.0,False,text," n
"
4,2.0,0.0,0.5,False,0.0,False,text," tr := |Sr| 
"
1,1.0,0.0,3.0,False,0.0,False,text," .
"
2,3.5,0.0,0.285714285714,False,0.0,False,text,"  nk+1+2r
"
5,3.4,0.0,0.45,False,0.0,False,text," comp(Sr)  tr(n + k)/2
"
1,1.0,0.0,2.0,False,0.0,False,text," .
"
1,1.0,0.0,1.0,False,0.0,False,text," k
"
1,5.0,0.0,0.0,False,0.0,False,text," (3.2)
"
1,1.0,0.0,1.0,False,0.0,False,text," k
"
2,6.0,0.0,0.277777777778,False,0.0,False,text," r=0 comp(Sr).
"
8,4.625,0.0,0.184523809524,False,0.0,True,text," This will imply the result since comp(S) Pk1
"
24,2.75,0.0,0.326388888889,False,0.0,True,text," Let r  {0, . . . , k  1} be xed. We prove (3.2) by induction on tr. Note that (3.2) holds
"
20,3.35,0.0,0.2,False,0.0,False,text," trivially if tr  0. Now, for tr  1, if Sr contains an element x which is comparable to
"
3,4.66666666667,0.0,0.285714285714,False,0.0,False,text," at least (n+k)/2
"
14,4.07142857143,0.0,0.047619047619,False,0.0,False,text,"  elements of Sr, then we apply the induction hypothesis to nd at least
"
3,4.0,0.0,0.444444444444,False,0.0,False,text," (tr  1)(n+k)/2
"
15,3.8,0.0,0.2,False,0.0,False,text,"  comparable pairs in Sr \ {x} and we are done. Therefore, we can assume
"
8,2.625,0.0,0.208333333333,False,0.0,False,text," that there is no such x  Sr.
"
14,1.71428571429,0.0,0.552721088435,False,0.0,False,text," s  {0, . . . , k  1} so that  nk+1+2r
"
16,2.3125,0.0,0.21875,False,0.0,False,text,"   s mod k. Let X be the set of all elements of Sr of
"
17,4.11764705882,0.0,0.0588235294118,False,0.0,True,text," Next, we show that we can assume that S does not contain any extremely small sets. Let
"
1,1.0,0.0,1.0,False,0.0,False,text," k
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," 6
"
22,3.13636363636,0.0,0.344155844156,False,0.0,False,text," cardinality s. Suppose that X 6=  and for each x  X let Nk+s(x) be the elements of Pr \ Sr
"
19,3.94736842105,0.0,0.184210526316,False,0.0,False,text," of cardinality k + s which are comparable to x. By the result of the previous paragraph, x is
"
5,5.6,0.0,0.171428571429,False,0.0,False,text," comparable to fewer than (n+k)/2
"
6,2.83333333333,0.0,0.166666666667,False,0.0,False,text,"  elements of Sr and so
"
1,1.0,0.0,1.0,False,0.0,False,text," k
"
4,2.75,0.0,1.16666666667,False,0.0,False,text," |Nk+s(x)| n  s
"
5,1.6,0.0,0.75,False,0.0,False,text," k  (n + k)/2
"
1,1.0,0.0,1.0,False,0.0,False,text," k
"
6,0.666666666667,0.0,0.666666666667,False,0.0,False,text,"  n  k + 1
"
1,1.0,0.0,1.0,False,0.0,False,heading," k
"
4,1.75,0.0,0.6875,False,0.0,False,body,"  (n + k)/2
"
1,1.0,0.0,1.0,False,0.0,False,after_body," k
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
14,4.0,0.0,0.0642857142857,False,0.0,False,text," which, if n0(k) is chosen large enough with respect to k, is at least
"
2,0.5,0.0,0.5,False,0.0,False,text,"  n
"
4,0.75,0.0,1.25,False,0.0,False,text," k  1 n
"
3,1.66666666667,0.0,1.0,False,0.0,False,text," s  |X|.
"
19,3.63157894737,0.0,0.315789473684,False,0.0,True,text," Therefore, we can greedily associate each element x of X to an element yx of Pr \ Sr of
"
19,3.84210526316,0.0,0.263157894737,False,0.0,False,text," cardinality k + s such that x is comparable to yx and the yx are distinct from one another.
"
25,2.64,0.0,0.306666666667,False,0.0,True,text," It is clear that the set Sr := (Sr \ X)  {yx : x  X} has the same cardinality as Sr and at
"
19,3.63157894737,0.0,0.140350877193,False,0.0,False,text," most as many comparable pairs as Sr. So, in what follows, we can assume that X = ; that
"
12,3.66666666667,0.0,0.208333333333,False,0.0,False,text," is, every element of Sr has cardinality at least k + s.
"
19,3.73684210526,0.0,0.236842105263,False,0.0,True,text," Now, dene P r to be the poset obtained from Pr by deleting all sets of cardinality s. Let
"
17,3.29411764706,0.0,0.382352941176,False,0.0,True,text," D be a digraph with V (D) = P r containing every arc (x, y) where either
"
19,3.73684210526,0.0,0.19298245614,False,0.0,False,text,"  x and y are comparable and the cardinality of y is closer to n/2 than the cardinality of
"
2,2.0,0.0,0.25,False,0.0,False,text," x, or
"
10,1.4,0.0,0.475,False,0.0,False,text,"  x  y and |x| = n  |y|.
"
19,3.57894736842,0.0,0.289473684211,False,0.0,True,text," Let C be a random chain in P r obtained by taking a maximal chain in P(n) uniformly at
"
20,3.75,0.0,0.3,False,0.0,False,text," random and intersecting it with P r . Then any two elements of P r of the same cardinality are
"
9,3.77777777778,0.0,0.222222222222,False,0.0,False,text," equally likely to be contained in C and so
"
8,3.25,0.0,0.195833333333,False,0.0,True,text," Also, given (x, y)  E(D), we have
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,1.0,False,0.0,False,text," n
"
5,1.0,0.0,0.5,False,0.0,True,text," P (x  C) 
"
1,1.0,0.0,3.0,False,0.0,False,text," 1
"
2,3.5,0.0,0.285714285714,False,0.0,False,text,"  nk+1+2r
"
9,1.0,0.0,0.944444444444,False,0.0,True,text," P (y  C | x  C) =
"
1,4.0,0.0,1.25,False,0.0,False,text," |y|1
"
1,3.0,0.0,1.33333333333,False,0.0,False,text," |x|
"
1,7.0,0.0,1.28571428571,False,0.0,False,text," |y||x|1
"
2,2.0,0.0,0.625,False,0.0,False,text,"  n|x|
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
7,1.42857142857,0.0,0.714285714286,False,0.0,False,text," for all x  P r .
"
4,1.25,0.0,0.5,False,0.0,False,text," if x  y,
"
1,10.0,0.0,0.1,False,0.0,False,text," otherwise.
"
1,1.0,0.0,1.0,False,0.0,False,text," k
"
7,3.85714285714,0.0,0.0,False,0.0,False,text," . Thus, (3.2) holds by Lemma 2.2.
"
20,3.25,0.0,0.15,False,0.0,True,text," By denition of D and the fact that X = , we get that this quantity is always at most
"
1,7.0,0.0,0.857142857143,False,0.0,False,text," (n+k)/2
"
8,4.875,0.0,0.25,False,0.0,False,text," random maximal chain C in the boolean lattice:
"
14,5.0,0.0,0.0,False,0.0,True,text," The proof of Theorem 3.1 above exploits the following two properties of a uniformly
"
1,1.0,0.0,2.0,False,0.0,False,text," 1
"
18,3.88888888889,0.0,0.12962962963,False,0.0,False,text,"  any two subsets of [n] of the same cardinality are equally likely to be contained in C
"
1,3.0,0.0,0.0,False,0.0,False,text," and
"
19,3.52631578947,0.0,0.19298245614,False,0.0,False,text,"  for any two comparable pairs (x1, y1) and (x2, y2) in P(n) such that |x1| = |x2| and
"
16,2.25,0.0,0.438541666667,False,0.0,False,text," |y1| = |y2|, we have P (x1, y1  C) = P (x2, y2  C).
"
16,4.9375,0.0,0.0,False,0.0,True,text," It is clear that one can often obtain a supersaturation result for posets satisfying these two
"
14,5.0,0.0,0.0,False,0.0,False,text," conditions by taking a maximal chain uniformly at random and applying Lemma 2.2. We
"
9,5.0,0.0,0.0,False,0.0,False,text," demonstrate this by outlining a proof of Theorem 1.2.
"
1,1.0,0.0,0.0,False,0.0,False,text," 7
"
21,3.19047619048,0.190476190476,0.238095238095,False,0.0,True,text," Proof of Theorem 1.2. For 0  r  k 1, let Pr be the poset consisting all subspaces of Fn
"
5,5.6,0.0,0.114285714286,False,0.0,False,text," dimension equivalent to  nk+1+2r
"
10,4.5,0.0,0.1,False,0.0,False,text,"  modulo k ordered by inclusion. Analogous to the proof
"
11,2.63636363636,0.0,0.272727272727,False,0.0,False,text," of Theorem 3.1, we dene Sr := S  Pr and
"
4,2.0,0.0,0.5,False,0.0,False,text," tr := |Sr| 
"
2,1.5,0.0,0.5,False,0.0,False,text," q of
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
2,5.5,0.0,0.5,False,0.0,True,text," Clearly, Pk1
"
22,2.13636363636,0.0,0.378787878788,False,0.0,False,text," r=0 tr = t. Our goal is to prove that, for each r = 0, . . . , k  1,
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,1.0,False,0.0,False,text," n
"
2,3.5,0.0,0.285714285714,False,0.0,False,text,"  nk+1+2r
"
1,1.0,0.0,3.0,False,0.0,False,text," q
"
5,3.4,0.0,0.45,False,0.0,False,text," comp(Sr)  tr(n + k)/2
"
1,1.0,0.0,2.0,False,0.0,False,text," q
"
1,1.0,0.0,1.0,False,0.0,False,text," k
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,5.0,0.0,0.0,False,0.0,False,text," (3.3)
"
18,3.66666666667,0.0,0.111111111111,False,0.0,True,text," We prove (3.3) by induction on tr where the case tr  0 is trivial. By the inductive
"
1,2.0,0.0,1.0,False,0.0,False,text," iq
"
15,4.86666666667,0.0,0.116666666667,False,0.0,False,text," hypothesis, we can assume that every element of Sr is comparable to fewer than h(n+k)/2
"
20,3.7,0.0,0.158333333333,False,0.0,False,text," other elements of Sr. If Sr contains an element of dimension s  k, then we can shift all such
"
15,4.86666666667,0.0,0.133333333333,False,0.0,False,text," elements up to subspaces of dimension k + s without increasing the number of comparable
"
9,4.0,0.0,0.0,False,0.0,False,text," pairs (as in the proof of Theorem 3.1) since
"
1,1.0,0.0,1.0,False,0.0,False,text," k
"
6,0.666666666667,0.0,0.333333333333,False,0.0,False,text,"  n  k + 1
"
1,1.0,0.0,1.0,False,0.0,False,text," k
"
4,2.0,0.0,1.1875,False,0.0,False,text," q (n + k)/2
"
1,1.0,0.0,1.0,False,0.0,False,text," k
"
3,0.666666666667,0.0,1.0,False,0.0,False,text," q  n
"
3,1.0,0.0,0.666666666667,False,0.0,False,text," k  1q
"
10,4.1,0.0,0.09,False,0.0,False,text," if n0(k) is chosen large enough with respect to k.
"
18,3.94444444444,0.0,0.222222222222,False,0.0,True,text," Now, we let P r be the poset obtained from Pr by deleting all elements of dimension less
"
22,3.18181818182,0.0,0.340909090909,False,0.0,False,text," than k and let D be a digraph with V (D) = P r containing every arc (x, y) such that either
"
21,3.28571428571,0.0,0.198412698413,False,0.0,False,text,"  x is comparable to y and the dimension of y is closer to n/2 than the dimension of x, or
"
16,2.75,0.0,0.28125,False,0.0,False,text,"  x  y and the dimension of x is n minus the dimension of y.
"
18,3.77777777778,0.0,0.277777777778,False,0.0,True,text," Let C be a uniformly random chain in P r obtained by taking a random maximal chain in
"
17,3.0,0.0,0.303921568627,False,0.0,True,text," V (q, n) and intersecting it with P r . It is not hard to show that
"
1,1.0,0.0,1.0,False,0.0,False,text," n
"
5,1.0,0.0,0.5,False,0.0,True,text," P (x  C) 
"
1,1.0,0.0,3.0,False,0.0,False,text," 1
"
7,1.71428571429,0.0,0.571428571429,False,0.0,False,text," for all x  P r and
"
1,1.0,0.0,2.0,False,0.0,False,text," 1
"
11,1.36363636364,0.0,0.840909090909,False,0.0,True,text," P (y  C | x  C) (n + k)/2
"
2,3.5,0.0,0.285714285714,False,0.0,False,text,"  nk+1+2r
"
1,1.0,0.0,1.0,False,0.0,False,text," k
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,1.0,False,0.0,False,text," q
"
6,2.66666666667,0.0,0.261111111111,False,0.0,False,text," for all (x, y)  E(D).
"
1,1.0,0.0,1.0,False,0.0,False,text," q
"
3,5.66666666667,0.0,0.0,False,0.0,True,text," The result follows.
"
17,4.05882352941,0.0,0.0,False,0.0,True,text," Our main diculty in proving Theorem 1.4 is that one can no longer obtain a good bound
"
16,4.375,0.0,0.114583333333,False,0.0,False,text," by taking a uniformly random maximal chain in {0, 1, 2}n and applying Lemma 2.2. Much
"
15,5.13333333333,0.0,0.0,False,0.0,False,text," of the next section is devoted to constructing a more appropriate distribution on chains in
"
7,4.71428571429,0.0,0.261904761905,False,0.0,False,text," {0, 1, 2}n and studying its properties.
"
1,1.0,0.0,0.0,False,0.0,False,text," 8
"
6,4.33333333333,0.0,0.0,False,1.0,False,text," 4 Supersaturation in {0, 1, 2}n
"
8,4.5,0.0,0.0,False,0.0,True,text," We open this section with a basic denition.
"
18,4.0,0.0555555555556,0.0555555555556,False,1.125,True,heading," Denition 4.1. A poset P is said to be ranked if it can be partitioned into non-empty sets
"
10,2.9,0.1,0.566666666667,False,0.0,True,body," L0, . . . , LN called levels such that
"
13,1.69230769231,0.0,0.525641025641,False,0.0,False,body,"  if x  Li and x  y, then y Sji Lj,
"
28,2.03571428571,0.0,0.339285714286,False,0.0,False,body,"  if x  y such that x  Li and y  Lj for j  i + 1, then there exists z  Li+1 such that
"
5,0.8,0.0,0.5,False,0.0,False,body," x  z  y.
"
14,2.35714285714,0.0714285714286,0.22619047619,False,0.0,True,body," If x  Li, then we say that the rank of x is i.
"
23,3.21739130435,0.0,0.202898550725,False,0.0,True,after_body," It is clear that {0, 1, 2}n is a ranked poset where Li is the set of vectors in {0, 1, 2}n whose
"
18,4.0,0.0,0.175925925926,False,0.0,False,text," coordinates sum to i. Also, the posets P(n) and V (q, n) are both ranked posets where the
"
12,5.25,0.0,0.0,False,0.0,False,text," rank of an element is equal to its cardinality or dimension, respectively.
"
16,4.625,0.0,0.0,False,0.0,True,text," In the previous section, we used the fact that a uniformly random chain of maximal length
"
21,3.42857142857,0.0,0.238095238095,False,0.0,False,text," in P(n) or V (q, n) is equally likely to contain any element of rank i. The poset {0, 1, 2}n
"
19,3.78947368421,0.0,0.0526315789474,False,0.0,False,text," does not have this property. That is, one can easily show that for n  2 a uniformly random
"
21,3.19047619048,0.0,0.119047619048,False,0.0,False,text," maximal chain is not equally likely to contain any given element in Li for 2  i  2n  2.
"
15,4.93333333333,0.0,0.0,False,0.0,True,text," Therefore, if we are to apply Lemma 2.2 to obtain a supersaturation result which applies
"
18,4.22222222222,0.0,0.135185185185,False,0.0,False,text," to all subsets of {0, 1, 2}n of cardinality greater than n(n), then we will require a dierent
"
8,4.25,0.0,0.208333333333,False,0.0,False,text," distribution on the chains of {0, 1, 2}n.
"
20,3.45,0.0,0.333333333333,False,1.125,True,heading," Denition 4.2. Let P be a ranked poset with non-empty levels L0, . . . , LN . A non-empty
"
22,3.22727272727,0.227272727273,0.136363636364,False,0.0,False,body," nite multiset C of maximal chains in P is called a regular covering by chains if for 0  i  N
"
13,4.15384615385,0.0865384615385,0.144230769231,False,0.0,False,body," every element of Li is contained in exactly |C|/|Li| chains of C .
"
18,4.16666666667,0.0,0.101851851852,False,0.0,True,after_body," As noted above, the collection of all maximal chains in {0, 1, 2}n is not a regular covering
"
16,4.6875,0.0,0.114583333333,False,0.0,False,text," by chains. However, Anderson [1] proved that {0, 1, 2}n does possess a regular covering by
"
19,4.0,0.0,0.0,False,0.0,False,text," chains (in fact, he proved that the same is true for the poset of divisors of any integer; see
"
14,5.92857142857,0.0,0.0,False,0.0,False,text," also [3]). The following useful result of Kleitman [25] characterises ranked posets with regular
"
18,4.27777777778,0.0,0.0,False,0.0,False,text," coverings by chains in terms of two other natural conditions, one of which will be used in our
"
1,6.0,0.0,0.0,False,0.0,False,text," proof.
"
24,2.91666666667,0.0,0.319444444444,False,1.125,True,heading," Denition 4.3. Let P be a ranked poset with levels L0, . . . , LN . Then P is said to have the
"
10,3.4,0.2,0.2,False,0.0,True,body," LYM property if, for every antichain A  P ,
"
1,4.0,0.0,0.5,False,0.0,True,body," Xi=0
"
3,1.66666666667,0.0,0.666666666667,False,0.0,False,body," |A  Li|
"
3,2.0,0.0,0.5,False,0.0,False,body," |Li|  1.
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
24,2.91666666667,0.0,0.319444444444,False,1.125,True,heading," Denition 4.4. Let P be a ranked poset with levels L0, . . . , LN . Then P is said to have the
"
18,2.61111111111,0.166666666667,0.222222222222,False,0.0,False,body," normalised matching property if for 0  i  N  1 and T  Li we have
"
12,1.75,0.0,0.458333333333,False,0.0,False,body," |{y  Li+1 : y  x for some x  T}|
"
1,6.0,0.0,0.666666666667,False,0.0,False,after_body," |Li+1|
"
2,1.5,0.0,0.5,False,0.0,False,text,"  |T|
"
1,4.0,0.0,1.0,False,0.0,False,text," |Li|
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
16,4.625,0.625,0.125,True,1.0,True,heading," Theorem 4.5 (Kleitman [25]). Let P be a ranked poset. The following are equivalent: (1) P
"
18,4.0,0.888888888889,0.111111111111,False,0.0,False,body," has a regular covering by chains, (2) P has the LYM property and (3) P has the normalised
"
2,8.5,1.0,0.0,False,0.0,False,after_body," matching property.
"
1,1.0,0.0,0.0,False,0.0,False,text," 9
"
15,4.6,0.0,0.122222222222,False,0.0,True,text," The distribution  on the maximal chains of {0, 1, 2}n that we construct essentially
"
14,5.0,0.0,0.0,False,0.0,False,text," amounts to choosing a uniformly random chain from a regular covering by chains. One
"
19,4.15789473684,0.0,0.0,False,0.0,False,text," subtle point is that, in the proof of Theorem 1.4, it will be useful to insist that the distribu-
"
25,2.4,0.0,0.233333333333,False,0.0,False,text," tion  is memoryless in the sense that if z1  z2    zq in {0, 1, 2}n and C is a chain
"
6,5.0,0.0,0.166666666667,False,0.0,False,text," chosen randomly according to , then
"
23,1.34782608696,0.0,0.826086956522,False,0.0,True,text," P (zq  C | z1, . . . , zq1  C) = P (zq  C | zq1  C) .
"
1,5.0,0.0,0.0,False,0.0,False,text," (4.6)
"
16,4.5,0.0,0.0,False,0.0,True,text," Note that a chain chosen uniformly at random from a regular covering by chains need not
"
17,4.76470588235,0.0,0.0,False,0.0,False,text," satisfy (4.6). Also note that, if (4.6) holds for every such sequence, then one can easily deduce
"
22,1.27272727273,0.0,0.765151515152,False,0.0,True,text," P (z1  C | z2, . . . , zq  C) = P (z1  C | z2  C)
"
11,4.90909090909,0.0,0.0909090909091,False,0.0,False,text," as well. Before constructing , we require a couple of denitions.
"
9,3.77777777778,0.0,0.277777777778,False,1.125,True,heading," Denition 4.7. For integers i and s, let Ls
"
6,3.16666666667,0.0,0.166666666667,False,0.0,False,body," equal to 2. Note that Ls
"
15,2.46666666667,0.0,0.355555555556,False,0.0,False,body," i is non-empty if and only if max{0, i  n}  s  i/2.
"
10,4.1,0.0,0.3,False,0.0,False,body," i be the elements of Li with exactly s coordinates
"
8,4.125,0.0,0.1875,False,1.125,True,heading," Denition 4.8. For integers i and s, dene
"
1,3.0,0.0,1.33333333333,False,0.0,False,after_body," i/2
"
1,2.0,0.0,1.5,False,0.0,True,text," Ls
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,2.0,0.0,0.0,False,0.0,False,text," :=
"
2,2.0,0.0,0.5,False,0.0,False,text," i and
"
1,2.0,0.0,1.0,False,0.0,True,text," Lr
"
1,4.0,0.0,0.75,False,0.0,False,text," [r=s
"
1,12.0,0.0,0.666666666667,False,0.0,False,text," [r=max{0,in}
"
1,1.0,0.0,1.0,False,0.0,False,text," s
"
1,2.0,0.0,1.0,False,0.0,True,text," Lr
"
2,1.0,0.0,1.0,False,0.0,False,text," i .
"
1,2.0,0.0,1.5,False,0.0,True,text," Ls
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,2.0,0.0,0.0,False,0.0,False,text," :=
"
18,3.83333333333,0.0,0.101851851852,False,0.0,True,text," Our goal is to construct a distribution  on the maximal chains in {0, 1, 2}n such that
"
21,3.33333333333,0.0,0.15873015873,False,0.0,False,text," (4.6) holds and, for 0  i  2n, every element of Li is equally likely to be contained in C.
"
21,3.61904761905,0.0,0.301587301587,False,0.0,True,text," We begin by insisting that C contains (0, . . . , 0) with probability one and that it is equally
"
7,4.28571428571,0.0,0.047619047619,False,0.0,False,text," likely to contain any element of L1.
"
21,2.95238095238,0.0,0.214285714286,False,0.0,True,text," Now, suppose that C has been constructed up to level i where 1  i  2n  2. In order
"
19,3.89473684211,0.0,0.131578947368,False,0.0,False,text," for (4.6) to hold, we must choose an element of Li+1 to add to C independently of the choice
"
3,2.0,0.0,1.22222222222,False,0.0,False,text," of C Si1
"
21,2.52380952381,0.0,0.333333333333,False,0.0,False,text," j=1 Lj. That is, our goal is to dene the values of P(y  C | x  C) for all
"
24,2.70833333333,0.0,0.25,False,0.0,False,text," x  Li and y  Li+1 with x  y in such a way that each element of Li+1 is equally likely to
"
4,3.75,0.0,0.25,False,0.0,False,text," be contained in C.
"
12,6.16666666667,0.0,0.0,False,0.0,True,text," We rephrase the problem of dening these conditional probabilities as follows. Suppose
"
18,3.88888888889,0.0,0.12962962963,False,0.0,False,text," that we dene a weighting of Li+1 by assigning each element of Li a weight of 1/|Li| and
"
20,3.5,0.0,0.15,False,0.0,False,text," then redistributing the weight in such a way that each x  Li sends weight wx,y  0 to each
"
8,3.75,0.0,0.354166666667,False,0.0,False,text," y  Li+1 comparable to x, where PyLi+1
"
12,3.0,0.0,0.142857142857,False,0.0,False,text," wx,y = 1/|Li|. What we would like to do is to x
"
17,4.58823529412,0.0,0.12091503268,False,0.0,False,text," the weights wx,y in such a way that every element of Li+1 receives weight 1/|Li+1|. Note that,
"
20,2.65,0.0,0.279166666667,False,0.0,False,text," for max{0, i  n}  s  (i  2)/2 all of the weight sent by elements of Ls+1
"
3,4.0,0.0,0.0,False,0.0,False,text," is received by
"
3,4.66666666667,0.0,0.25,False,0.0,False,text," elements of Ls+1
"
11,3.72727272727,0.0,0.0984848484848,False,0.0,False,text," i+1 . So, the total weight received by the set Ls+1
"
1,2.0,0.0,1.5,False,0.0,False,text," xy
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," i+1
"
1,2.0,0.0,0.0,False,0.0,False,text," is
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,4.0,0.0,0.75,False,0.0,True,text," Ls+1
"
1,4.0,0.0,1.0,False,0.0,False,text," |Li|
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
2,4.5,0.0,0.4375,False,0.0,False,text," + X(x,y)Ls
"
1,2.0,0.0,1.5,False,0.0,False,text," xy
"
1,5.0,0.0,0.8,False,0.0,False,text," iLs+1
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," i+1
"
1,5.0,0.0,1.0,False,0.0,False,text," wx,y.
"
1,2.0,0.0,0.0,False,0.0,False,text," 10
"
17,4.17647058824,0.0,0.0235294117647,False,0.0,True,text," In order to achieve the desired weighting of Li+1, we need this quantity to be equal to
"
3,5.33333333333,0.0,0.0,False,0.0,False,text," which implies that
"
1,8.0,0.0,0.875,False,0.0,True,text," X(x,y)Ls
"
2,2.5,0.0,0.875,False,0.0,False,text," i Ls+1
"
1,2.0,0.0,1.5,False,0.0,False,text," xy
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," i+1
"
3,3.0,0.0,0.916666666667,False,0.0,False,text," wx,y = |Li|
"
1,4.0,0.0,0.75,False,0.0,True,text," Ls+1
"
4,2.25,0.0,0.375,False,0.0,False,text," i+1   |Li+1|
"
2,5.0,0.0,0.833333333333,False,0.0,False,text," |Li| |Li+1|
"
1,4.0,0.0,0.75,False,0.0,True,text," Ls+1
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
2,1.5,0.0,0.166666666667,False,0.0,False,text," i+1 
"
1,4.0,0.0,0.75,False,0.0,True,text," Ls+1
"
1,6.0,0.0,0.666666666667,False,0.0,False,text," |Li+1|
"
1,1.0,0.0,0.0,False,0.0,False,text," ,
"
1,5.0,0.0,0.0,False,0.0,False,text," (4.9)
"
21,3.19047619048,0.0,0.31746031746,False,0.0,True,text," Similarly since, for max{0, i + 1 n}  s  i/2, all of the weight sent by elements of Ls1
"
6,4.0,0.0,0.25,False,0.0,False,text," is received by elements of Ls
"
4,4.25,0.0,0.0625,False,0.0,False,text," i+1, we require that
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,8.0,0.0,0.875,False,0.0,True,text," X(x,y)Ls
"
1,2.0,0.0,1.5,False,0.0,False,text," xy
"
2,1.5,0.0,1.25,False,0.0,False,text," i Ls
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," i+1
"
3,3.0,0.0,0.916666666667,False,0.0,False,text," wx,y = |Li|
"
1,2.0,0.0,1.5,False,0.0,True,text," Ls
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
2,1.5,0.0,0.666666666667,False,0.0,False,text," i+1 
"
1,3.0,0.0,1.33333333333,False,0.0,True,text," Ls1
"
1,10.0,0.0,0.8,False,0.0,False,text," |Li||Li+1|
"
1,6.0,0.0,1.16666666667,False,0.0,False,text," |Li+1|
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,6.0,0.0,0.0,False,0.0,False,text," (4.10)
"
16,4.5625,0.0,0.0625,False,0.0,True,text," We insist that our construction has the property that wx,y depends only on the number of
"
16,3.0625,0.0,0.25,False,0.0,False,text," coordinates of x and y which are equal to two. That is, if x  Ls
"
4,3.0,0.0,0.208333333333,False,0.0,False,text," i+1 for some s,
"
11,3.63636363636,0.0,0.204545454545,False,0.0,False,text," i+1, then set wx,y = wi,s. The left sides of (4.9)
"
10,2.4,0.0,0.4,False,0.0,False,text," then set wx,y = wi,s and if x  Ls
"
5,7.4,0.0,0.2,False,0.0,False,text," i|wi,s, respectively. Rearranging, we get
"
6,3.83333333333,0.0,0.194444444444,False,0.0,False,text," and (4.10) become (i  2s)|Ls
"
12,2.08333333333,0.0,0.394444444444,False,0.0,False,text," that, for max{0, i  n}  s  (i  1)/2,
"
7,2.57142857143,0.0,0.471428571429,False,0.0,False,text," i|wi,s and (n  i + s)|Ls
"
5,1.8,0.0,0.5,False,0.0,False,text," i and y  Ls+1
"
5,1.4,0.0,0.6,False,0.0,False,text," i and y  Ls
"
3,3.0,0.0,0.916666666667,False,0.0,False,text," wi,s = |Li|
"
1,4.0,0.0,0.75,False,0.0,True,text," Ls+1
"
1,3.0,0.0,1.0,False,0.0,False,text," |Ls
"
5,3.4,0.0,0.526666666667,False,0.0,False,text," i| |Li||Li+1| (i  2s)
"
4,2.25,0.0,0.375,False,0.0,False,text," i+1   |Li+1|
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,4.0,0.0,0.75,False,0.0,True,text," Ls+1
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,6.0,0.0,0.0,False,0.0,False,text," (4.11)
"
12,1.91666666667,0.0,0.402777777778,False,0.0,False,text," and, for max{0, i  n + 1}  s  i/2,
"
3,3.0,0.0,1.0,False,0.0,False,text," wi,s = |Li|
"
1,2.0,0.0,1.5,False,0.0,True,text," Ls
"
1,3.0,0.0,1.33333333333,False,0.0,True,text," Ls1
"
8,2.25,0.0,0.583333333333,False,0.0,False,text," i| |Li| |Li+1| (n  i + s)
"
3,3.0,0.0,0.833333333333,False,0.0,False,text," i+1  |Li+1|
"
1,3.0,0.0,1.0,False,0.0,False,text," |Ls
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,6.0,0.0,0.0,False,0.0,False,text," (4.12)
"
22,3.27272727273,0.0,0.215151515152,False,0.0,True,text," For completeness, if i is even, then set wi,i/2 := 0 and if i  n, set wi,in := 0. The weights
"
15,5.0,0.0,0.272222222222,False,0.0,False,text," wi,s and wi,s are all non-negative since {0, 1, 2}n has the normalised matching property.
"
19,3.47368421053,0.0,0.263157894737,False,0.0,True,text," So, we extend the chain C to level i + 1 in the following way. Given that C contains
"
3,1.0,0.0,0.666666666667,False,0.0,False,text," x  Ls
"
19,3.57894736842,0.0,0.236842105263,False,0.0,False,text," i , then we add an element y of Li+1 comparable to x to C, independently of the choice
"
11,3.45454545455,0.0,0.568181818182,False,0.0,False,text," of C \ {x}, with probability |Li|wi,s if y  Ls+1
"
1,4.0,0.0,0.25,False,0.0,False,text," i+1.
"
12,3.33333333333,0.0,0.25,False,0.0,True,text," Note that x is comparable to i  2s elements of Ls+1
"
3,3.33333333333,0.0,0.111111111111,False,0.0,False,text," i+1 and that
"
17,2.58823529412,0.0,0.365546218487,False,0.0,False,text," (i  2s)wi,s + (n  i + s)wi,s = 1/|Li| = P(x  C) by denition.
"
5,4.2,0.0,0.4,False,0.0,False,text," construction, given y  Lt
"
1,4.0,0.0,1.25,False,0.0,True,text," XxLi
"
7,1.85714285714,0.0,0.695238095238,False,0.0,True,text," P (x, y  C) = XxLt1
"
10,3.9,0.0,0.325,False,0.0,False,text," i+1, the probability that y is contained in C is
"
14,1.28571428571,0.0,0.660714285714,False,0.0,True,text," P (x  C) P (y  C | x  C) + XxLt
"
16,4.4375,0.0,0.190972222222,False,0.0,True,text," Let us verify that any element of Li+1 is contained in C with probability 1/|Li+1|. By
"
9,3.77777777778,0.0,0.384259259259,False,0.0,False,text," i+1 and with probability |Li|wi,s if y  Ls
"
10,2.2,0.0,0.433333333333,False,0.0,False,text," i+1 and n  i + s elements of Ls
"
13,1.07692307692,0.0,0.692307692308,False,0.0,True,text," P (x  C) P (y  C | x  C) .
"
1,2.0,0.0,1.5,False,0.0,False,text," xy
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,2.0,0.0,1.5,False,0.0,False,text," xy
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,2.0,0.0,1.5,False,0.0,False,text," xy
"
20,2.8,0.0,0.108333333333,False,0.0,True,text," If t = 0, then the rst sum is zero and the second is equal to (i + 1)wi,0 =
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
23,3.04347826087,0.0,0.14154589372,False,0.0,False,text," 1/|Li+1|. If i is odd and t = (i + 1)/2, then the second sum is zero and the rst is equal to
"
1,2.0,0.0,1.0,False,0.0,True,text," L0
"
1,3.0,0.0,1.33333333333,False,0.0,False,text," i+1
"
1,5.0,0.0,0.8,False,0.0,False,text," (i+1)
"
1,12.0,0.0,0.75,False,0.0,False,text," i||Li+1|(ni)
"
1,3.0,0.0,0.666666666667,False,0.0,False,text," |L0
"
1,2.0,0.0,0.0,False,0.0,False,text," 11
"
2,1.5,0.0,0.166666666667,False,0.0,False,text,"  i+1
"
4,2.75,0.0,0.166666666667,False,0.0,False,text," 2  wi,(i1)/2 =
"
4,6.25,0.0,0.0,False,0.0,False,text," the above expression becomes
"
1,8.0,0.0,0.5,False,0.0,True,text," L(i+1)/2
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," i+1
"
1,7.0,0.0,0.571428571429,False,0.0,True,text," L(i1)/2
"
1,5.0,0.0,0.8,False,0.0,False,text," (i+1)
"
1,1.0,0.0,3.0,False,0.0,False,text," 2
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,6.0,0.0,1.16666666667,False,0.0,False,text," |Li+1|
"
15,2.66666666667,0.0,0.297037037037,False,0.0,False,text," = 1/|Li+1|. Finally, if max{i + 1  n, 1}  t  i/2, then
"
7,2.57142857143,0.0,0.336734693878,False,0.0,False,text," twi,t1 + (i + 1  2t)wi,t
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,2.0,0.0,1.5,False,0.0,True,text," Lt
"
1,2.0,0.0,1.5,False,0.0,True,text," Lt
"
1,2.0,0.0,1.5,False,0.0,True,text," Lt
"
1,5.0,0.0,1.8,False,0.0,False,text," t|Li|
"
3,3.0,0.0,0.833333333333,False,0.0,False,text," i+1  |Li+1|
"
2,0.5,0.0,0.5,False,0.0,False,text," i 
"
5,2.2,0.0,0.357142857143,False,0.0,False,text," (i + 1  2t)|Li|
"
1,3.0,0.0,1.66666666667,False,0.0,True,text," Lt1
"
6,2.83333333333,0.0,0.333333333333,False,0.0,False,text," |Li||Li+1| (i  2t + 2)
"
2,2.5,0.0,1.0,False,0.0,False,text," + |Li|
"
3,3.0,0.0,0.833333333333,False,0.0,False,text," i+1  |Li+1|
"
2,2.5,0.0,1.0,False,0.0,False,text," = |Li|
"
3,3.0,0.0,0.833333333333,False,0.0,False,text," i+1  |Li+1|
"
2,0.5,0.0,0.5,False,0.0,False,text," i 
"
2,0.5,0.0,0.5,False,0.0,False,text,"  n
"
2,0.5,0.0,0.5,False,0.0,False,text,"  n
"
1,8.0,0.0,1.0,False,0.0,False,text," i+1ti+1t
"
1,8.0,0.0,1.0,False,0.0,False,text," i+1ti+1t
"
1,10.0,0.0,0.9,False,0.0,False,text," |Li||Li+1|
"
1,3.0,0.0,1.0,False,0.0,False,text," |Lt
"
1,4.0,0.0,0.5,False,0.0,False,text," i+1|
"
2,0.5,0.0,0.5,False,0.0,False,text,"  n
"
1,8.0,0.0,1.0,False,0.0,False,text," i+1ti+1t
"
1,6.0,0.0,0.833333333333,False,0.0,False,text," |Li+1|
"
1,6.0,0.0,0.666666666667,False,0.0,False,text," |Li+1|
"
1,3.0,0.0,1.0,False,0.0,False,text," |Lt
"
1,2.0,0.0,1.5,False,0.0,True,text," Lt
"
1,2.0,0.0,1.5,False,0.0,True,text," Lt
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,1.0,0.0,1.0,False,0.0,False,text," t
"
1,1.0,0.0,1.0,False,0.0,False,text," t
"
1,1.0,0.0,1.0,False,0.0,False,text," t
"
2,5.0,0.0,0.958333333333,False,0.0,False,text," |Li| |Li+1|
"
1,3.0,0.0,1.33333333333,False,0.0,True,text," Lt1
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
7,2.57142857143,0.0,0.52380952381,False,0.0,False,text," i||Li| |Li+1| (n  i + t)
"
1,2.0,0.0,1.5,False,0.0,True,text," Lt
"
3,3.0,0.0,0.833333333333,False,0.0,False,text," i+1  |Li+1|
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,3.0,0.0,1.33333333333,False,0.0,True,text," Lt1
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
18,4.27777777778,0.0,0.351851851852,False,0.0,True,text," We complete the construction by insisting that C contains (2, . . . , 2) with probability one.
"
14,4.42857142857,0.0,0.0,False,0.0,True,text," Most of the work in this section is devoted to proving the following lemma.
"
23,2.78260869565,0.666666666667,0.217391304348,True,1.0,True,heading," Lemma 4.13. Let k  1 be a xed integer, let n be large with respect to k and let C be a
"
17,3.41176470588,0.647058823529,0.205882352941,False,0.0,False,body," chain chosen randomly according to . Let 0  i, j  2n be integers such that
"
6,1.0,0.0833333333333,0.416666666667,False,0.0,False,body,"  |i  j|  k,
"
14,2.42857142857,0.238095238095,0.309523809524,False,0.0,False,body,"  either min{i, j}  2k or max{i, j}  2n  2k, and
"
8,1.125,0.0416666666667,0.458333333333,False,0.0,False,body,"  |j  n|  |i  n|.
"
17,2.52941176471,0.558823529412,0.323529411765,False,0.0,True,body," If x  Li and y  Lj are such that x is comparable to y, then
"
10,1.4,0.0,0.716666666667,False,0.0,True,body," P (y  C | x  C)  3k1(n)
"
3,2.66666666667,0.0,0.555555555556,False,0.0,False,after_body," 2k1(n)  11
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
16,4.25,0.0,0.0,False,0.0,True,text," We now derive Theorem 1.4 from Lemma 4.13 after which we will turn our attention to
"
4,5.5,0.0,0.0,False,0.0,False,text," proving the lemma itself.
"
19,3.57894736842,0.368421052632,0.140350877193,False,0.0,True,text," Proof of Theorem 1.4 assuming Lemma 4.13. For 0  r  k1, let Pr be the poset consisting
"
14,3.28571428571,0.0,0.245238095238,False,0.0,False,text," all elements of {0, 1, 2}n of rank equivalent to n +  2rk+1
"
6,3.83333333333,0.0,0.166666666667,False,0.0,False,text,"  modulo k with partial order
"
12,3.0,0.0,0.388888888889,False,0.0,False,text," inherited from {0, 1, 2}n. Dene Sr := S  Pr and
"
1,4.0,0.0,0.75,False,0.0,False,text," (n).
"
6,2.5,0.0,0.683333333333,False,0.0,False,text," tr := |Sr|  n+ 2rk+1
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
2,5.5,0.0,0.5,False,0.0,True,text," Clearly, Pk1
"
19,2.0,0.0,0.438596491228,False,0.0,False,text," r=0 tr = t. We prove that, for each r = 0, . . . , k  1,
"
4,2.5,0.0,0.666666666667,False,0.0,False,text," 2k1(n)  1 tr.
"
2,7.0,0.0,0.625,False,0.0,False,text," comp(Sr) 3k1(n)
"
1,6.0,0.0,0.0,False,0.0,False,text," (4.14)
"
18,3.72222222222,0.0,0.111111111111,False,0.0,True,text," We prove (4.14) by induction on tr where the case tr  0 is trivial. By the inductive
"
3,2.33333333333,0.0,0.222222222222,False,0.0,False,text," 2k1(n)  1
"
15,4.73333333333,0.0,0.111111111111,False,0.0,False,text," hypothesis, we can assume that every element of Sr is comparable to fewer than 3k1(n)
"
4,4.5,0.0,0.166666666667,False,0.0,False,text," other elements of Sr.
"
1,2.0,0.0,0.0,False,0.0,False,text," 12
"
17,4.11764705882,0.0,0.0588235294118,False,0.0,True,text," Next, we prove that it suces to consider the case that Sr contains no elements of rank
"
21,3.52380952381,0.0,0.134920634921,False,0.0,False,text," less than 2k. First, let A be the set of all elements of Sr of rank less than k. Clearly, each
"
20,3.45,0.0,0.125,False,0.0,False,text," element of A has rank r. Let us show that we can assume that A is empty. For each subset
"
22,3.18181818182,0.0,0.170454545455,False,0.0,True,text," T of A, let (T ) denote the elements of Lr+k comparable to at least one member of T . If we
"
20,3.5,0.0,0.233333333333,False,0.0,False,text," had |(T )\ Sr|  |T| for every subset T of A, then by Halls Marriage Theorem [21] we could
"
24,2.79166666667,0.0,0.350694444444,False,0.0,False,text," associate each element of x  A to an element f (x) of Lr+k \ Sr such that x  f (x) and the
"
24,3.04166666667,0.0,0.3125,False,0.0,False,text," function f is injective. Given such a function f , it is clear that the set S := (Sr \ A)  f (A)
"
15,4.0,0.0,0.111111111111,False,0.0,False,text," has the same cardinality as Sr and at most as many comparable pairs as Sr.
"
21,3.14285714286,0.0,0.142857142857,False,0.0,True,text," Thus, we suppose that no such f exists and so there there must be a set T  A such that
"
17,3.76470588235,0.0,0.308823529412,False,0.0,False,text," |(T ) \ Sr|  |T|. Since {0, 1, 2}n has the normalised matching property, we have
"
4,1.75,0.0,0.416666666667,False,0.0,False,text," |(T )  Sr|
"
1,3.0,0.0,1.0,False,0.0,False,text," |T|
"
3,2.0,0.0,0.388888888889,False,0.0,False,text," = |(T )|
"
6,1.83333333333,0.0,0.611111111111,False,0.0,False,text," |T|  |(T ) \ Sr|
"
1,3.0,0.0,1.0,False,0.0,False,text," |T|
"
2,3.0,0.0,0.416666666667,False,0.0,False,text,"  |Lr+k|
"
3,1.66666666667,0.0,0.333333333333,False,0.0,False,text," |Lr|  1
"
5,4.0,0.0,0.133333333333,False,0.0,False,text," which is at least 3k1(n)
"
13,4.23076923077,0.0,0.0512820512821,False,0.0,False,text," 2k1(n)  1 by Theorem A.3. Putting these two facts together, we have
"
6,2.16666666667,0.0,0.388888888889,False,0.0,False,text," |(T )  Sr|  3k1(n)
"
4,2.75,0.0,0.666666666667,False,0.0,False,text," 2k1(n)  1 |T|.
"
1,6.0,0.0,0.0,False,0.0,False,text," (4.15)
"
16,4.5,0.0,0.0625,False,0.0,True,text," So, by the Pigeonhole Principle, there must be some element of T which is comparable to
"
3,4.66666666667,0.0,0.222222222222,False,0.0,False,text," more than 3k1(n)
"
15,4.46666666667,0.0,0.155555555556,False,0.0,False,text," 2k1(n)  1 elements of Sr, which is a contradiction. Thus, Sr contains no elements
"
19,3.89473684211,0.0,0.114035087719,False,0.0,False,text," of rank less than k. Applying the same argument to the elements of Sr of rank r+k (and using
"
20,3.7,0.0,0.125,False,0.0,False,text," the fact that Sr has no elements of rank r, which we just proved), we get that Sr contains no
"
6,4.16666666667,0.0,0.0555555555556,False,0.0,False,text," elements of rank less than 2k.
"
19,3.68421052632,0.0,0.210526315789,False,0.0,True,text," Now, we let P r be the poset obtained from Pr by deleting all elements of rank less than
"
24,2.625,0.0,0.402777777778,False,0.0,False,text," 2k. By the above argument, we can assume Sr  P r . Let D be a digraph with V (D) = P r
"
7,4.42857142857,0.0,0.166666666667,False,0.0,False,text," containing every arc (x, y) such that
"
21,2.71428571429,0.0,0.214285714286,False,0.0,False,text,"  x is comparable to y and the rank of y is closer to n than the rank of x, or
"
16,2.1875,0.0,0.25,False,0.0,False,text,"  x  y and the rank of x is 2n minus the rank of y.
"
20,3.3,0.0,0.341666666667,False,0.0,True,text," Let C be a random chain in P r obtained by taking a random chain in {0, 1, 2}n chosen
"
17,4.23529411765,0.0,0.2,False,0.0,False,text," according to  and intersecting it with P r . Provided that n0(k) is suciently large, the
"
8,4.75,0.0,0.0,False,0.0,False,text," theorem now follows from Lemmas 2.2 and 4.13.
"
5,3.8,0.0,0.0,False,1.0,False,text," 4.1 Proof of Lemma 4.13
"
23,2.73913043478,0.0,0.282608695652,False,0.0,True,text," It is clear by construction of  that one can obtain an upper bound on P (y  C | x  C)
"
17,4.35294117647,0.0,0.25,False,0.0,False,text," when x and y are in consecutive levels by bounding the weight functions wi,s and wi,s from
"
14,4.57142857143,0.0,0.0,False,0.0,False,text," above. Our rst step is to bound the weight functions relative to one another.
"
21,2.19047619048,0.2,0.272222222222,True,1.0,True,heading," Proposition 4.16. For 1  i  n  1 and 0  s  i/2 we have wi,s  wi,s.
"
17,4.41176470588,0.0588235294118,0.0294117647059,False,0.0,True,text," Proof. Dene a weighting of the elements of Li+1 by rst assigning weight one to each element
"
19,3.0,0.0,0.263157894737,False,0.0,False,text," of Li and then redistributing the weight so that, for 0  s  i/2, each x  Ls
"
3,4.0,0.0,0.333333333333,False,0.0,False,text," i sends weight
"
12,3.66666666667,0.0,0.319444444444,False,0.0,False,text," i+1 comparable to x and weight |Li|wi,s to each y  Ls+1
"
6,2.83333333333,0.0,0.520833333333,False,0.0,False,text," |Li|wi,s to each y  Ls
"
2,6.5,0.0,0.166666666667,False,0.0,False,text," i+1 comparable
"
16,4.9375,0.0,0.171875,False,0.0,False,text," to x. By construction of the weight functions wi,s and wi,s we see that, after redistributing,
"
15,4.6,0.0,0.15,False,0.0,False,text," each element of Li has weight zero and each element of Li+1 has weight |Li|/|Li+1|.
"
1,2.0,0.0,0.0,False,0.0,False,text," 13
"
17,4.11764705882,0.0,0.0882352941176,False,0.0,True,text," Now, we dene a second weighting of Li+1 by assigning each element of Li weight one and
"
8,4.25,0.0,0.125,False,0.0,False,text," i sends its weight evenly to the elements
"
9,4.88888888889,0.0,0.111111111111,False,0.0,False,text," redistributing the weight so that each element of Ls
"
12,3.91666666667,0.0,0.208333333333,False,0.0,False,text," of Li+1 comparable to it. Under this weighting, each y  Ls
"
5,1.0,0.0,0.3,False,0.0,False,text," i + 1  2s
"
3,2.0,0.0,0.444444444444,False,0.0,False,text," f (s) :=
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,1.0,0.0,1.0,False,0.0,False,text," s
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
3,5.66666666667,0.0,0.111111111111,False,0.0,False,text," i+1 receives weight
"
5,0.8,0.0,0.4,False,0.0,False,text," n + 1  s
"
3,0.666666666667,0.0,0.666666666667,False,0.0,False,text," n  s
"
20,2.85,0.0,0.233333333333,False,0.0,True,text," We claim that f (s) is strictly decreasing in s for s in the range 0  s  i+1
"
5,0.8,0.0,0.4,False,0.0,False,text," 0  s  i1
"
4,2.0,0.0,0.0,False,0.0,False,body," 2 , we have
"
4,3.0,0.0,0.0,False,0.0,False,after_body," 2 . Indeed, for
"
6,0.5,0.0,0.5,False,0.0,False,text," n  s  1 
"
11,1.27272727273,0.0,0.439393939394,False,0.0,False,text," f (s + 1)  f (s) = s + 1
"
5,0.8,0.0,0.3,False,0.0,False,text," i  2s  1
"
3,0.666666666667,0.0,0.666666666667,False,0.0,False,text," n  s
"
11,1.36363636364,0.0,0.242424242424,False,0.0,False,text," s(n  i  2)  (n  i)(n + 1)
"
11,1.36363636364,0.0,0.295454545455,False,0.0,False,text," (n  s + 1)(n  s)(n  s  1)
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,1.0,0.0,1.0,False,0.0,False,text," s
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
5,0.8,0.0,0.4,False,0.0,False,text," n  s + 1
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
4,0.5,0.0,0.5,False,0.0,False,text," n  s 
"
5,1.0,0.0,0.3,False,0.0,False,text," i  2s + 1
"
9,1.22222222222,0.0,0.277777777778,False,0.0,False,text," (n  i)(s  n  1)  2s
"
11,1.36363636364,0.0,0.295454545455,False,0.0,False,text," (n  s + 1)(n  s)(n  s  1)
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
3,1.0,0.0,0.333333333333,False,0.0,False,text," 2  n2
"
7,2.42857142857,0.0,0.285714285714,False,0.0,True,text," Therefore, for 0  s  i1
"
23,2.0,0.0,0.275362318841,False,0.0,False,text," 2  n + 1 and n  i  2  n  i. Thus, f (s) is strictly decreasing in s.
"
11,3.36363636364,0.0,0.181818181818,False,0.0,True,text," The denominator is always positive for 0  s  n2
"
12,2.41666666667,0.0,0.444444444444,False,0.0,False,text," 2 . If i  {n 2, n 1}, then the numerator
"
19,3.63157894737,0.0,0.105263157895,False,0.0,False,text," is clearly negative. Finally, if 1  i  n  3, then the numerator is again negative since
"
5,0.8,0.0,0.4,False,0.0,False,text," 0  s  i1
"
6,2.83333333333,0.0,0.25,False,0.0,False,text," 2 , the elements of Ls
"
7,4.85714285714,0.0,0.047619047619,False,0.0,False,text," i+1 receive more weight on average under
"
9,4.55555555556,0.0,0.0833333333333,False,0.0,False,text," the second weighting than do the elements of Ls+1
"
7,5.14285714286,0.0,0.047619047619,False,0.0,False,text," i+1 . Note that, under both redistribution
"
7,3.85714285714,0.0,0.190476190476,False,0.0,False,text," rules, all of the weight from Ls1
"
3,2.66666666667,0.0,0.0,False,0.0,False,text," is sent to
"
1,4.0,0.0,0.75,False,0.0,True,text," Ls+1
"
13,4.46153846154,0.0,0.0833333333333,False,0.0,False,text," i+1 . Therefore, the amount of weight received by the elements of Ls+1
"
4,4.5,0.0,0.0833333333333,False,0.0,False,text," i+1 versus the amount
"
5,4.4,0.0,0.3,False,0.0,False,text," received by elements of Ls
"
14,3.78571428571,0.0,0.0952380952381,False,0.0,False,text," i+1 is only aected by the amount of weight that the elements of Ls
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
5,3.2,0.0,0.2,False,0.0,False,text," choose to send to Ls
"
11,4.81818181818,0.0,0.030303030303,False,0.0,False,text," i+1 . As we have mentioned, the rst redistribution rule assigns
"
16,4.5625,0.0,0.03125,False,0.0,False,text," each element of Li+1 to the same weight while the second assigns more weight to elements
"
17,4.47058823529,0.0,0.0294117647059,False,0.0,False,text," of Li+1 which have fewer coordinates equal to two. Putting this all together, it must be the
"
11,4.18181818182,0.0,0.181818181818,False,0.0,False,text," case that, under the rst redistribution rule, each x  Ls
"
7,4.14285714286,0.0,0.142857142857,False,0.0,False,text," i sends more weight to each element
"
2,3.0,0.0,0.25,False,0.0,False,text," of Ls+1
"
6,4.66666666667,0.0,0.0555555555556,False,0.0,False,text," i+1 comparable to it. This proves
"
4,3.25,0.0,0.5125,False,0.0,False,text," that wi,s  wi,s.
"
12,3.75,0.0,0.111111111111,False,0.0,False,text," i+1 comparable to it than it sends to each element of Ls
"
8,3.5,0.0,0.135416666667,False,0.0,False,text," i+1 and all of the weight from Ls+1
"
3,3.33333333333,0.0,0.277777777778,False,0.0,False,text," i+1 and Ls+1
"
4,2.5,0.0,0.375,False,0.0,False,text," is sent to Ls
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
15,4.86666666667,0.0,0.0,False,0.0,True,text," We also use a similar weight redistribution trick to obtain various bounds on the ratio
"
16,5.1875,0.0,0.0511363636364,False,0.0,False,text," |Li+1|/|Li| which will be needed later in this section. Since these proofs are all fairly routine,
"
11,5.72727272727,0.0,0.0,False,0.0,False,text," and not particularly enlightening, we have included them in the appendix.
"
17,4.47058823529,0.0,0.132352941176,False,0.0,True,text," In what follows, it will be useful to notice that the weight functions wi,s and wi,s exhibit
"
8,5.625,0.0,0.0416666666667,False,0.0,False,text," a certain symmetry around the nth level. Specically,
"
1,3.0,0.0,1.0,False,0.0,False,text," 2ni
"
1,5.0,0.0,1.2,False,0.0,True,text," Lni+s
"
3,6.0,0.0,0.842857142857,False,0.0,False,text," w2ni1,ni+s = |L2ni1|
"
1,5.0,0.0,1.4,False,0.0,True,text," Lni+s
"
3,7.33333333333,0.0,0.350877192982,False,0.0,False,text," 2ni1|L2ni1||L2ni|(s + 1)
"
3,1.33333333333,0.0,0.583333333333,False,0.0,False,text,"   |Li|
"
3,2.0,0.0,0.5,False,0.0,False,text,"   |L2ni|
"
1,3.0,0.0,1.33333333333,False,0.0,False,text," i+1
"
1,2.0,0.0,1.5,False,0.0,True,text," Ls
"
3,5.66666666667,0.0,0.373015873016,False,0.0,False,text," i||Li+1||Li|(i  2s)
"
2,3.5,0.0,0.583333333333,False,0.0,False,text," = |Li+1|
"
2,2.5,0.0,0.5,False,0.0,False,text," = wi,s
"
1,3.0,0.0,1.0,False,0.0,False,text," |Ls
"
1,2.0,0.0,1.5,False,0.0,True,text," Ls
"
1,4.0,0.0,1.0,False,0.0,False,text," 2ni1
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,6.0,0.0,1.16666666667,False,0.0,True,text," Lni+s1
"
2,7.0,0.0,0.0,False,0.0,False,text," and, similarly,
"
3,5.66666666667,0.0,0.733333333333,False,0.0,False,text," w2ni1,ni+s1 = wi,s.
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,6.0,0.0,0.0,False,0.0,False,text," (4.17)
"
1,6.0,0.0,0.0,False,0.0,False,text," (4.18)
"
19,3.10526315789,0.0,0.210526315789,False,0.0,True,text," Next, we prove an upper bound on wi,s which is tight when i is odd and s = i1
"
12,4.08333333333,0.0,0.152777777778,False,0.0,False,text," result for the upper half of {0, 1, 2}n follows from (4.17).
"
4,3.25,0.0,0.0,False,0.0,False,text," 2 . An analogous
"
1,2.0,0.0,0.0,False,0.0,False,text," 14
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
22,2.13636363636,0.25,0.227272727273,True,1.0,True,text," Proposition 4.19. Suppose that n  5. Then for 1  i  n  1 and 0  s  i
"
2,2.0,0.0,0.5,False,0.0,False,text," wi,s 
"
14,2.57142857143,0.0714285714286,0.214285714286,False,0.0,True,text," Proof. If there is an integer s such that 0  s  i
"
1,11.0,0.0,0.454545454545,False,0.0,False,text," (i+1)|Li+1|
"
2,2.0,0.0,0.0,False,0.0,False,text," 2 and
"
1,1.0,1.0,0.0,False,0.0,False,text," .
"
3,2.33333333333,0.666666666667,0.0,False,0.0,False,text," 2 we have
"
14,1.78571428571,0.0,0.372619047619,False,0.0,False,text," 2|Li| s(s + 1)(n  i + s)(n  i + s + 1)
"
24,1.83333333333,0.0,0.293948412698,False,0.0,False,text,"  (i  2s  1)(i  2s)(i  2s + 1) ((i + 1)|Li+1|  (n  i + s + 1)|Li|) ,
"
1,6.0,0.0,0.0,False,0.0,False,text," (4.20)
"
19,3.84210526316,0.0,0.0526315789474,False,0.0,False,text," then we let s0 be the largest such integer. Otherwise, set s0 := 0. Note that both sides of
"
13,3.0,0.0,0.230769230769,False,0.0,False,text," (4.20) are non-negative for all s such that 0  s  i
"
9,3.22222222222,0.0,0.0,False,0.0,False,text," 2 , where Lemma A.4 is used to verify
"
18,4.11111111111,0.0,0.0277777777778,False,0.0,False,text," that the right side is non-negative. If s0  1, then the inequality (4.20) must hold for all
"
29,2.0,0.0,0.26724137931,False,0.0,False,text," 0  i  n1 and s such that 0  s  s0 and must fail to hold for all s such that s0+1  s  i
"
2,1.0,0.0,0.0,False,0.0,False,text," 2 ;
"
22,1.86363636364,0.0,0.227272727273,False,0.0,False,text," this is because, for xed 0  i  n  1 and s in the range 0  s  i
"
8,2.875,0.0,0.0,False,0.0,False,text," 2 , the left side of (4.20) is
"
11,4.0,0.0,0.136363636364,False,0.0,False,text," increasing in s and the right side is decreasing in s.
"
6,4.33333333333,0.0,0.166666666667,False,0.0,True,text," By (4.11), the inequality wi,s 
"
1,4.0,0.0,0.75,False,0.0,True,text," Ls+1
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,11.0,0.0,0.454545454545,False,0.0,False,text," (i+1)|Li+1|
"
5,4.8,0.0,0.0,False,0.0,False,text," can be rewritten as follows:
"
2,8.0,0.0,0.0,False,0.0,False,text," or, equivalently,
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
3,3.0,0.0,0.611111111111,False,0.0,False,text," (i + 1)|Li|
"
3,3.0,0.0,0.833333333333,False,0.0,False,text," |Li|(i + 1)
"
1,4.0,0.0,0.75,False,0.0,True,text," Ls+1
"
4,2.25,0.0,0.375,False,0.0,False,text," i+1   |Li+1|
"
6,2.0,0.0,0.222222222222,False,0.0,False,text," i+1   2(i  2s)|Ls
"
3,1.33333333333,0.0,0.25,False,0.0,False,text,"   2|Ls
"
6,2.16666666667,0.0,0.694444444444,False,0.0,False,text," i|  |Li+1| (i + 1)
"
1,4.0,0.0,0.75,False,0.0,True,text," Ls+1
"
4,2.75,0.0,0.458333333333,False,0.0,False,text," i||Li| (i  2s)
"
1,4.0,0.0,0.75,False,0.0,True,text," Ls+1
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,6.0,0.0,0.0,False,0.0,False,text," (4.21)
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
14,2.64285714286,0.0,0.142857142857,False,0.0,True,text," Our goal is to prove that (4.21) holds for 0  s  i
"
7,2.42857142857,0.0,0.285714285714,False,0.0,False,text," on s or induction on  i
"
15,2.93333333333,0.0,0.155555555556,False,0.0,False,text," case s  s0, though, we need to verify the base case s = 0.
"
5,2.0,0.2,0.2,False,0.0,True,heading," Case 1: s = 0.
"
18,2.61111111111,0.0,0.277777777778,False,0.0,False,after_body," 2  s depending on whether s  s0 or s  s0 + 1. Before proving the
"
8,4.375,0.0,0.0,False,0.0,False,text," 2 . The argument will either use induction
"
5,4.8,0.0,0.0,False,0.0,True,text," In this case, (4.21) becomes
"
7,3.14285714286,0.0,0.392857142857,False,0.0,False,text," |Li|(i + 1)|Li+1|  (i + 1)L0
"
3,2.33333333333,0.0,0.666666666667,False,0.0,False,text," i+1  2iL0
"
4,3.0,0.0,0.3125,False,0.0,True,text," Since (i + 1)L0
"
6,1.66666666667,0.0,0.5,False,0.0,False,text," i+1 = (i + 1) n
"
5,1.8,0.0,0.433333333333,False,0.0,False,text," i+1 = (n  i)n
"
8,2.625,0.0,0.416666666667,False,0.0,False,text," (i + 1)|Li+1|  (n + i)|Li| .
"
5,1.6,0.0,0.7,False,0.0,False,text," i = (n  i)L0
"
7,2.57142857143,0.0,1.14285714286,False,0.0,False,text," i  |Li+1| (i + 1)|Li| L0
"
2,1.0,0.0,2.5,False,0.0,False,text," i .
"
4,4.0,0.0,0.375,False,0.0,False,text," i, this simplies to
"
1,6.0,0.0,0.0,False,0.0,False,text," (4.22)
"
10,4.2,0.0,0.1,False,0.0,True,text," To prove (4.22), we observe that each element of Lr
"
5,3.6,0.0,0.2,False,0.0,False,text," and each element of Lr
"
12,3.5,0.0,0.25,False,0.0,False,text," i+1 comparable to i + 1  r elements of Li. Therefore,
"
10,3.1,0.0,0.35,False,0.0,False,text," i is comparable to n  r elements of Li+1
"
2,1.5,0.0,0.166666666667,False,0.0,False,text,"  i+1
"
2,0.5,0.0,0.0,False,0.0,False,text," 2 
"
1,4.0,0.0,0.5,False,0.0,True,text," Xr=0
"
5,1.6,0.0,0.35,False,0.0,False,text," (i + 1  r)Lr
"
2,2.0,0.0,0.5,False,0.0,False,text," i+1 =
"
7,5.14285714286,0.0,0.0,False,0.0,True,text," This equality can be rewritten as follows:
"
2,0.5,0.0,0.5,False,0.0,False,text,"  i
"
1,1.0,0.0,1.0,False,0.0,False,text," 2
"
1,4.0,0.0,0.5,False,0.0,True,text," Xr=0
"
3,2.33333333333,0.0,0.433333333333,False,0.0,False,text," (n  r)|Lr
"
2,1.5,0.0,1.0,False,0.0,False,text," i| .
"
4,2.75,0.0,0.25,False,0.0,False,text," (i + 1)|Li+1| 
"
2,1.5,0.0,0.166666666667,False,0.0,False,text,"  i+1
"
2,0.5,0.0,0.0,False,0.0,False,text," 2 
"
1,4.0,0.0,0.5,False,0.0,True,text," Xr=0
"
1,3.0,0.0,1.66666666667,False,0.0,False,text," rLr
"
6,2.16666666667,0.0,0.388888888889,False,0.0,False,text," i+1 = (n + i)|Li| 
"
2,0.5,0.0,0.5,False,0.0,False,text,"  i
"
1,1.0,0.0,1.0,False,0.0,False,text," 2
"
1,4.0,0.0,0.5,False,0.0,True,text," Xr=0
"
3,2.66666666667,0.0,0.433333333333,False,0.0,False,text," (i + r)|Lr
"
2,1.5,0.0,1.0,False,0.0,False,text," i| .
"
1,2.0,0.0,0.0,False,0.0,False,text," 15
"
13,4.0,0.0,0.0,False,0.0,True,text," So, after a change of index, we see that (4.22) is equivalent to
"
6,1.16666666667,0.0,0.333333333333,False,0.0,True,text," For 0  r  i1
"
4,1.75,0.0,0.0,False,0.0,False,text," 2  we have
"
3,2.66666666667,0.0,0.433333333333,False,0.0,False,text," (i + r)|Lr
"
2,0.5,0.0,0.5,False,0.0,False,text,"  i
"
1,1.0,0.0,1.0,False,0.0,False,text," 2
"
1,4.0,0.0,0.5,False,0.0,True,text," Xr=0
"
3,2.66666666667,0.0,0.433333333333,False,0.0,False,text," (i + r)|Lr
"
2,1.0,0.0,0.5,False,0.0,False,text,"  i1
"
2,0.5,0.0,0.0,False,0.0,False,text," 2 
"
1,4.0,0.0,0.5,False,0.0,True,text," Xr=0
"
2,1.0,0.0,0.5,False,0.0,False,text," i| 
"
3,3.0,0.0,0.388888888889,False,0.0,False,text," (r + 1)Lr+1
"
2,2.0,0.0,1.0,False,0.0,False,text," i+1 .
"
1,5.0,0.0,1.4,False,0.0,False,text," i+1ir
"
3,3.0,0.0,0.444444444444,False,0.0,False,text," (i + r)Lr+1
"
2,0.5,0.0,0.5,False,0.0,False,text," r 
"
5,0.8,0.0,0.8,False,0.0,False,text," i  ri  r
"
3,0.666666666667,0.0,0.333333333333,False,0.0,False,text," r  =
"
1,2.0,0.0,2.0,False,0.0,False,text," ir
"
1,3.0,0.0,0.666666666667,False,0.0,False,text," r+1
"
5,2.4,0.0,0.433333333333,False,0.0,False,text," i+1  (r + 1)Lr+1
"
1,4.0,0.0,1.0,False,0.0,True,text," Lr+1
"
1,3.0,0.0,1.0,False,0.0,False,text," i+1
"
6,1.5,0.0,0.583333333333,False,0.0,False,text," i| = (i + r) n
"
3,1.0,0.0,0.5,False,0.0,False,text," i  2r
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
5,2.0,0.0,0.2,False,0.0,False,text," (i + r)(r + 1)
"
11,4.45454545455,0.0,0.0,False,0.0,False,text," and so (4.22) holds. This completes the proof in this case.
"
7,1.57142857143,0.142857142857,0.190476190476,False,0.0,True,heading," Case 2: 1  s  s0.
"
18,4.05555555556,0.0,0.0555555555556,False,0.0,True,after_body," We can assume, by induction and the previous case, that (4.21) is true if s is replaced by
"
13,3.92307692308,0.0,0.0769230769231,False,0.0,False,text," s  1. That is, we assume that the following inequality is true:
"
1,2.0,0.0,1.5,False,0.0,True,text," Ls
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,2.0,0.0,1.5,False,0.0,True,text," Ls
"
13,4.84615384615,0.0,0.0,False,0.0,True,text," Subtracting this inequality from (4.21), we see that it suces to prove that
"
3,3.0,0.0,0.833333333333,False,0.0,False,text," |Li|(i + 1)
"
3,4.33333333333,0.0,0.555555555556,False,0.0,False,text," |Li|(i + 1)Ls+1
"
6,5.33333333333,0.0,0.166666666667,False,0.0,True,text," After substituting the values of Ls+1
"
4,2.5,0.0,0.625,False,0.0,False,text," |Li|(i + 1) n
"
7,2.0,0.0,0.452380952381,False,0.0,False,text," i+1  2(i  2s + 2)Ls1
"
5,2.4,0.0,0.4,False,0.0,False,text," i+1  2(i  2s)|Ls
"
5,3.0,0.0,0.366666666667,False,0.0,False,text,"  |Li+1| (i + 1)Ls+1
"
2,3.0,0.0,1.16666666667,False,0.0,False,text," i|, Ls1
"
2,3.5,0.0,0.875,False,0.0,False,text," i+1, |Ls
"
8,1.25,0.0,0.5,False,0.0,False,text," s + 1  2(i  2s) n
"
5,0.8,0.0,0.8,False,0.0,False,text," i  si  s
"
5,2.2,0.0,0.333333333333,False,0.0,False,text,"  |Li+1| (i + 1)
"
9,0.666666666667,0.0,0.5,False,0.0,False,heading," i  s  1i  s  1
"
4,1.0,0.0,0.75,False,0.0,False,after_body," s + 1 .
"
6,1.83333333333,0.0,0.444444444444,False,0.0,False,text,"   |Li+1| (i + 1)
"
7,2.0,0.0,0.404761904762,False,0.0,False,text," i| + 2(i  2s + 2)Ls1
"
3,2.33333333333,0.0,0.333333333333,False,0.0,False,text,"  and Ls+1
"
8,1.25,0.0,0.291666666667,False,0.0,False,text," s  + 2(i  2s + 2)
"
5,0.8,0.0,0.8,False,0.0,False,text," i  si  s
"
1,7.0,0.0,0.0,False,0.0,False,text," becomes
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
2,0.5,0.0,0.5,False,0.0,False,text,"  .
"
1,1.0,0.0,1.0,False,0.0,False,text," n
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
6,4.16666666667,0.0,0.0,False,0.0,False,text,"  into the above inequality, it
"
9,0.888888888889,0.0,0.5,False,0.0,False,text," i  s + 1i  s + 1
"
4,0.5,0.0,0.25,False,0.0,False,text," s  1 
"
1,1.0,0.0,1.0,False,0.0,False,text," n
"
17,4.76470588235,0.0,0.0,False,0.0,True,text," By simplifying this expression, one can show that it is in fact equivalent to (4.20), which holds
"
13,3.61538461538,0.0,0.179487179487,False,0.0,False,text," for s because s  s0. This completes the proof in this case.
"
9,1.33333333333,0.111111111111,0.277777777778,False,0.0,True,text," Case 3: s0 + 1  s  i
"
2,1.0,0.0,0.0,False,0.0,False,text," 2 .
"
11,2.36363636364,0.0,0.272727272727,False,0.0,True,text," In the case that i is odd and s = i1
"
5,2.4,0.0,0.2,False,0.0,False,text," 2 we have wi,s =
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,11.0,0.0,0.454545454545,False,0.0,False,text," (i+1)|Li+1|
"
6,2.0,0.0,0.166666666667,False,0.0,False,text," 2 , then wi,s = 2
"
5,3.6,0.0,0.0,False,0.0,False,text," by denition and so the
"
2,3.5,0.0,0.357142857143,False,0.0,False,text," i|Li+1| 
"
1,1.0,0.0,0.0,False,0.0,False,text," 4
"
1,9.0,0.0,0.777777777778,False,0.0,False,text," (2ni)|Li|
"
2,4.5,0.0,0.0,False,0.0,False,text," by (4.11).
"
12,3.33333333333,0.0,0.25,False,0.0,False,text," result holds with equality. If i is even and s = i2
"
7,3.28571428571,0.0,0.142857142857,False,0.0,True,text," In this case, the bound wi,s 
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
4,5.5,0.0,0.0,False,0.0,False,text," reduces to the following:
"
1,11.0,0.0,0.454545454545,False,0.0,False,text," (i+1)|Li+1|
"
7,3.14285714286,0.0,0.293650793651,False,0.0,False,text," (2n  i)|Li|  2(i + 1)|Li+1|.
"
17,3.0,0.0,0.117647058824,False,0.0,True,text," Since 1  i  n  1, this inequality holds by Lemmas A.4, A.5 and A.6.
"
20,3.9,0.0,0.1,False,0.0,False,text," (4.21) is true if s is replaced by s + 1. That is, we assume that the following inequality holds:
"
10,2.2,0.0,0.25,False,0.0,True,text," So, we are done unless s0  s  i
"
4,1.75,0.0,0.375,False,0.0,False,text," 2  s, that
"
11,2.63636363636,0.0,0.0909090909091,False,0.0,False,text," 2  1. We can assume, by induction on  i
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
6,1.83333333333,0.0,0.444444444444,False,0.0,False,text,"   |Li+1| (i + 1)
"
8,1.75,0.0,0.229166666667,False,0.0,False,text," i+1   2(i  2s  2)Ls+1
"
1,4.0,0.0,0.75,False,0.0,True,text," Ls+2
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
1,4.0,0.0,0.75,False,0.0,True,text," Ls+2
"
1,2.0,0.0,0.0,False,0.0,False,text," 16
"
3,3.0,0.0,0.833333333333,False,0.0,False,text," |Li|(i + 1)
"
16,4.625,0.0,0.0,False,0.0,True,text," Similar to the proof of the previous case, we can derive (4.21) from the above inequality
"
7,5.0,0.0,0.0,False,0.0,False,text," provided that we can prove the following:
"
3,4.33333333333,0.0,0.555555555556,False,0.0,False,text," |Li|(i + 1)Ls+2
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
7,2.0,0.0,0.357142857143,False,0.0,False,text," i+1  2(i  2s  2)Ls+1
"
5,2.0,0.0,0.2,False,0.0,False,text,"  + 2(i  2s)|Ls
"
1,2.0,0.0,1.5,False,0.0,False,text," i|
"
5,3.0,0.0,0.366666666667,False,0.0,False,text,"  |Li+1| (i + 1)Ls+2
"
2,0.5,0.0,0.5,False,0.0,False,text,"  .
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
17,4.64705882353,0.0,0.0,False,0.0,True,text," Simplifying this expression in a similar fashion to the proof of the previous case, we see that
"
7,5.57142857143,0.0,0.0,False,0.0,False,text," it is equivalent to the following inequality:
"
18,1.72222222222,0.0,0.336111111111,False,0.0,False,text," 2|Li| (s + 1)(s + 2)(n  i + s + 1)(n  i + s + 2)
"
26,1.69230769231,0.0,0.284798534799,False,0.0,False,text,"  (i  2s  3)(i  2s  2)(i  2s  1) ((i + 1)|Li+1|  (n  i + s + 2)|Li|) .
"
18,4.11111111111,0.0,0.111111111111,False,0.0,True,text," This is precisely the negation of (4.20) with s is replaced by s + 1. This inequality holds
"
17,4.29411764706,0.0,0.117647058824,False,0.0,False,text," because s  s0 and s0 was chosen to be the largest index satisfying (4.20). This completes
"
5,5.0,0.0,0.0,False,0.0,False,text," the proof of the proposition.
"
5,6.0,0.0,0.0,False,0.0,True,text," We derive the following corollary.
"
27,2.07407407407,0.296296296296,0.296296296296,True,1.0,True,heading," Corollary 4.23. For n  5 and 0  i  2n 1, if x  Li and y  Li+1 such that x  y, then
"
11,2.36363636364,0.0,0.717171717172,False,0.0,True,text," P (y  C | x  C) (2|Li|/(i + 1)|Li+1|
"
6,0.833333333333,0.166666666667,0.333333333333,False,0.0,False,text," if i  n  1
"
1,10.0,1.0,0.0,False,0.0,False,text," otherwise.
"
3,2.33333333333,0.0,0.3,False,0.0,False,text," 2/(2n  i)
"
15,2.06666666667,0.0666666666667,0.4,False,0.0,True,text," Proof. Let max{0, i  n}  s  i/2 so that x  Ls
"
13,2.07692307692,0.0,0.576923076923,False,0.0,False,text," i . By construction, P (y  C | x  C) is
"
6,5.33333333333,0.0,0.333333333333,False,0.0,False,text," either equal to wi,s|Li| or wi,s|Li|.
"
20,3.05,0.0,0.175,False,0.0,True,text," Suppose rst that i  n  1. If s  i/2, then by Propositions 4.16 and 4.19, we have
"
9,4.0,0.0,0.25,False,0.0,False,text," that wi,s and wi,s are both bounded above by
"
8,3.25,0.0,0.0,False,0.0,False,text," and we are done. In the case that
"
17,2.64705882353,0.0,0.254901960784,False,0.0,False,text," i is even and s = i/2, we have that wi,i/2 = 0 and wi,i/2 = 2
"
5,4.4,0.0,0.2,False,0.0,False,text," 2ni which is bounded above
"
17,3.11764705882,0.0,0.117647058824,False,0.0,False,text," by Lemmas A.4, A.5 and A.6. This completes the proof for i  n  1. The
"
1,2.0,0.0,0.0,False,0.0,False,text," by
"
22,3.09090909091,0.0,0.181818181818,False,0.0,False,text," case i  n follows from the case i  n  1 via equations (4.17) and (4.18) and the fact that
"
17,1.70588235294,0.0,0.752100840336,False,0.0,True,text," P (y  C | x  C) = P (x  C | y  C)|Li+1|/|Li|.
"
1,11.0,0.0,0.454545454545,False,0.0,False,text," (i+1)|Li+1|
"
1,11.0,0.0,0.454545454545,False,0.0,False,text," (i+1)|Li+1|
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
16,4.375,0.0,0.0,False,0.0,True,text," We are now ready to prove Lemma 4.13. The proof is divided into three cases depending
"
2,4.5,0.0,0.0,False,0.0,False,text," on whether
"
6,2.0,0.0,0.333333333333,False,0.0,False,text,"  |j  i| is small,
"
13,1.76923076923,0.0,0.333333333333,False,0.0,False,text,"  |j  i| is large and i + j = 2n, or
"
12,1.83333333333,0.0,0.402777777778,False,0.0,False,text,"  |j  i| is large and i + j 6= 2n.
"
17,4.05882352941,0.0,0.117647058824,False,0.0,True,text," The rst case is done by summing over all chains containing x and y and applying (4.6)
"
7,4.14285714286,0.0,0.0,False,0.0,False,text," and Corollary 4.23 to each of them.
"
11,3.72727272727,0.0,0.106060606061,False,0.0,True,text," In the second case, we assume that (x, y) is chosen
"
23,2.5652173913,0.0,0.369565217391,False,0.0,False,text," from Li  Lj to maximise P (y  C | x  C) and obtain a lower bound on the number of
"
29,1.89655172414,0.0,0.591954022989,False,0.0,False,text," y  Lj comparable to x such that P (y  C | x  C) = P (y  C | x  C). Since the sum of
"
25,2.56,0.0,0.44,False,0.0,True,text," P (y  C | x  C) over all such y is at most one, this lower bound on the number of such y
"
23,2.86956521739,0.0,0.268115942029,False,0.0,False,text," gives us an upper bound on P (y  C | x  C). The third case is done by a simple inductive
"
7,4.14285714286,0.0,0.0,False,0.0,False,text," trick which uses the rst two cases.
"
1,2.0,0.0,0.0,False,0.0,False,text," 17
"
20,3.45,0.2,0.1,False,0.0,True,text," Proof of Lemma 4.13. Let k  1 be a xed integer and let n be suciently large with respect
"
18,4.22222222222,0.0,0.138888888889,False,0.0,False,text," to k. Let i, j be integers satisfying the hypotheses of the lemma. Note that, by the symmetry
"
19,3.57894736842,0.0,0.131578947368,False,0.0,False,text," of  around level n (i.e. by equations (4.17) and (4.18)), we can assume that i  n. The
"
22,2.45454545455,0.0,0.378787878788,False,0.0,False,text," assumption |j  n|  |i  n| can therefore be rewritten as i  j and i + j  2n.
"
9,1.77777777778,0.111111111111,0.365079365079,False,0.0,True,heading," Case 1: k  j  i  11n/10.
"
32,1.90625,0.0,0.5625,False,0.0,True,after_body," It is clear that P (y  C | x  C) is equal to the sum of P (zi+1, . . . , zj  C | zi  C) over
"
23,2.78260869565,0.0,0.260869565217,False,0.0,False,text," all sequences zi  zi+1    zj such that zi = x and zj = y. The number of such sequences
"
15,3.93333333333,0.0,0.0555555555556,False,0.0,False,text," is clearly bounded above by (j  i)! and, for every such sequence, we have
"
14,1.42857142857,0.0,0.821428571429,False,0.0,True,text," P (zi+1, . . . , zj  C | zi  C) =
"
1,2.0,0.0,1.0,False,0.0,False,text," j1
"
1,4.0,0.0,0.75,False,0.0,True,text," Yr=i
"
8,1.5,0.0,0.8,False,0.0,True,text," P (zr+1  C | zr  C)
"
22,1.72727272727,0.0,0.427272727273,False,0.0,False,text," by (4.6). For i  r  n  1, we have that P (zr+1  C | zr  C) 
"
3,3.0,0.0,0.333333333333,False,0.0,False,text," n by Corol-
"
26,2.23076923077,0.0,0.361538461538,False,0.0,False,text," lary 4.23 and Lemmas A.4, A.5 and A.6 and for n  r  j1 we have P (zr+1  C | zr  C) 
"
18,2.44444444444,0.0,0.37962962963,False,0.0,False,text," 2nr by Corollary 4.23. Since i + j  2n, we have that i  n  ji
"
3,4.0,0.0,0.151515151515,False,0.0,False,text," (i+1)|Li+1|  2
"
5,2.2,0.0,0.0,False,0.0,False,text," 2 and so we get
"
1,1.0,0.0,0.0,False,0.0,False,text," 2
"
1,5.0,0.0,0.8,False,0.0,False,text," 2|Li|
"
15,1.33333333333,0.0,0.766666666667,False,0.0,True,text," P (zi+1, . . . , zj  C | zi  C)  2
"
1,7.0,0.0,1.14285714286,False,0.0,False,text," n(ji)/2
"
5,2.6,0.0,0.46,False,0.0,False,text," 2ji(n  (j  i)/2)!
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,9.0,0.0,0.888888888889,False,0.0,False,text," n(ji)/2n!
"
1,7.0,0.0,0.857142857143,False,0.0,False,text," 2(ji)/2
"
10,1.6,0.0,0.441666666667,False,0.0,False,text," n(n  1) (n  (j  i)/2 + 1)
"
18,3.83333333333,0.0,0.0462962962963,False,0.0,True,text," As mentioned earlier, the number of such sequences is at most (j  i)! and so we obtain
"
9,0.888888888889,0.0,0.722222222222,False,0.0,True,text," P (y  C | x  C) 
"
7,2.57142857143,0.0,0.385714285714,False,0.0,False,text," 2ji(j  i)!(n  (j  i)/2)!
"
1,9.0,0.0,0.888888888889,False,0.0,False,text," n(ji)/2n!
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
1,6.0,0.0,0.0,False,0.0,False,text," (4.24)
"
1,4.0,0.0,0.5,False,0.0,False,text," 2(n)
"
8,3.625,0.0,0.1875,False,0.0,False,text," k1 which, by (1.5) and the fact that
"
15,2.46666666667,0.0,0.233333333333,False,0.0,True,text," In the case j  i = k, the right side is at most 2kn
"
5,1.6,0.0,0.3,False,0.0,False,text," 1(n)  1 = n1
"
9,4.11111111111,0.0,0.0444444444444,False,0.0,False,text," for n0(k) suciently large and so we are done.
"
28,2.28571428571,0.0,0.267857142857,False,0.0,True,text," Also, the right side is decreasing in j  i for k  j  i  n/10 and so we are done for j  i in
"
4,4.0,0.0,0.0,False,0.0,False,text," this range as well.
"
6,2.83333333333,0.0,0.166666666667,False,0.0,False,text," n , then (4.24) can be
"
17,2.41176470588,0.0,0.310924369748,False,0.0,True,text," So, we assume that n/10  j  i  11n/10. If we dene c := ji
"
7,2.57142857143,0.0,0.0952380952381,False,0.0,False,text," 2 , is less than  3k1(n)
"
3,2.66666666667,0.0,0.555555555556,False,0.0,False,text," 2k1(n)  11
"
2,5.5,0.0,0.0,False,0.0,False,text," rewritten as
"
9,0.888888888889,0.0,0.722222222222,False,0.0,True,text," P (y  C | x  C) 
"
3,5.33333333333,0.0,0.444444444444,False,0.0,False,text," 2cn(cn)!(n  cn/2)!
"
1,7.0,0.0,1.0,False,0.0,False,text," ncn/2n!
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
13,5.23076923077,0.0,0.0,False,0.0,True,text," Applying Stirlings Approximation, we see that the right side is bounded above by
"
1,1.0,0.0,1.0,False,0.0,False,text," e
"
1,7.0,0.0,0.714285714286,False,0.0,False,text," n(1c/2)
"
2,3.0,0.0,1.125,False,0.0,False,text," n2cn cn
"
3,3.33333333333,0.0,1.19047619048,False,0.0,False,text," e cn n(1c/2)
"
1,2.0,0.0,1.5,False,0.0,False,text," en
"
2,3.0,0.0,1.0,False,0.0,False,text," ncn/2 n
"
1,1.0,0.0,2.0,False,0.0,True,text," O
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,11.0,0.0,0.454545454545,False,0.0,False,text," (2c)c(1c/2)
"
15,4.13333333333,0.0,0.154358974359,False,0.0,False,text," ec/2(1c/2)c/2  0.99 for 1/10  c  11/10 and so the above expression decreases
"
4,5.75,0.0,0.1,False,0.0,False,text," for n0(k) suciently large.
"
6,2.33333333333,0.0,0.566666666667,False,0.0,False,text," = On (2c)c (1  c/2)
"
4,3.75,0.0,0.59375,False,0.0,False,text," ec/2(1  c/2)c/2n .
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
10,4.6,0.0,0.166666666667,False,0.0,False,text," exponentially with n and therefore is less than  3k1(n)
"
7,4.57142857143,0.0,0.0,False,0.0,True,text," This completes the proof in this case.
"
3,2.66666666667,0.0,0.555555555556,False,0.0,False,text," 2k1(n)  11
"
2,5.0,0.0,0.0,False,0.0,True,text," Notice that
"
11,2.0,0.0909090909091,0.348484848485,False,0.0,True,heading," Case 2: i + j = 2n and i  9n/20.
"
1,2.0,0.0,0.0,False,0.0,False,after_body," 18
"
19,3.52631578947,0.0,0.166666666667,False,0.0,True,text," In this case, we suppose further that the pair (x, y) is chosen from Li  L2ni so that
"
15,3.0,0.0,0.433333333333,False,0.0,True,text," P (y  C | x  C) is maximised. We prove the following claim.
"
22,3.0,0.522727272727,0.19696969697,True,1.0,True,heading," Claim 4.25. If there exist a coordinate   [n] such that x = 0 and y = 2, then for every
"
13,2.30769230769,0.346153846154,0.333333333333,False,0.0,False,body," coordinate   [n] with x = 1 we have y = 2.
"
22,3.09090909091,0.0454545454545,0.19696969697,False,0.0,True,after_body," Proof. Suppose to the contrary that there is a coordinate   [n] such that x = 0 and y = 2
"
25,2.44,0.0,0.48,False,0.0,False,text," and a coordinate   [n] with x = y = 1. Let , : {0, 1, 2}n  {0, 1, 2}n be the function
"
15,4.4,0.0,0.2,False,0.0,False,text," which exchanges the th coordinate with the th coordinate. Note that x  ,(y). Our
"
5,3.2,0.0,0.0,False,0.0,False,text," goal is to show that
"
17,1.11764705882,0.0,0.794117647059,False,0.0,True,text," P (,(y)  C | x  C)  P (y  C | x  C)
"
9,4.0,0.0,0.166666666667,False,0.0,False,text," which will contradict our choice of x and y.
"
26,2.46153846154,0.0,0.46858974359,False,0.0,True,text," Given a sequence Z = (zi, . . . , z2ni) of elements of {0, 1, 2}n with zi    z2ni, zi = x
"
21,3.19047619048,0.0,0.246031746032,False,0.0,False,text," and z2ni = y dene (Z) to be the smallest integer  such that the th coordinate of z is a
"
11,5.18181818182,0.0,0.0606060606061,False,0.0,False,text," two. For every such sequence, dene another sequence (Z) as follows:
"
16,2.25,0.0,1.18333333333,False,0.0,False,text," (Z) :=zi, . . . , z(Z)1, ,z(Z) , . . . , , (z2ni) .
"
20,3.5,0.0,0.133333333333,False,0.0,True,text," Notice that (Z) is a chain starting with x and ending at ,(y). It is not hard to see that
"
17,4.41176470588,0.0,0.0588235294118,False,0.0,False,text," the function  is injective. Now, the key observation is that, by construction of C, for any
"
5,4.0,0.0,0.1,False,0.0,False,text," such sequence Z, we have
"
13,1.61538461538,0.0,0.884615384615,False,0.0,True,text," P (zi+1, . . . , z2ni  C | zi  C)
"
22,1.81818181818,0.0,1.14242424242,False,0.0,False,text," = Pzi+1, . . . , z(Z)1, ,z(Z) , . . . , , (z2ni)  C | zi  C .
"
30,1.63333333333,0.0,0.666666666667,False,0.0,True,text," This proves P (,(y)  C | x  C)  P (y  C | x  C) since P (y  C | x  C) is equal
"
26,2.65384615385,0.0,0.429487179487,False,0.0,False,text," to the sum over all such sequences of P (zi+1, . . . , z2ni  C | zi  C). In order to prove the
"
18,4.05555555556,0.0,0.125,False,0.0,False,text," strict inequality, all that we need is a single chain containing x and ,(y) which is not a
"
21,3.09523809524,0.0,0.234126984127,False,0.0,False,text," subsequence of one of the chains (Z) for Z as above. Any chain of the form x  z  ,(y)
"
14,3.92857142857,0.0,0.142857142857,False,0.0,False,text," with z = 2 has this property. This completes the proof of the claim.
"
18,3.66666666667,0.0,0.0462962962963,False,0.0,True,text," We now prove that, in fact, there must be at least n/10 coordinates   [n] such that
"
23,2.82608695652,0.0,0.239130434783,False,0.0,False,text," x = 0 and y = 2. If not, then we must have that the rank of y is at most 2i+(ni)+n/10 =
"
19,3.78947368421,0.0,0.149122807018,False,0.0,False,text," 11n/10 + i. However, by assumption of this case, the rank of y is precisely 2n  i. Putting
"
20,3.55,0.0,0.208333333333,False,0.0,False,text," this together, we get that 2n  i  11n/10 + i which implies that i  9n/20, a contradiction.
"
20,2.85,0.0,0.216666666667,False,0.0,True,text," Thus, by Claim 4.25 we have that y = 2 for every coordinate   [n] with x  1.
"
16,4.375,0.0,0.0625,False,0.0,True,text," By the result of the previous paragraph and the symmetry of the distribution , we see
"
27,1.85185185185,0.0,0.611111111111,False,0.0,False,text," that P (y  C | x  C) is equal to P (y  C | x  C) for every y  L2ni such that
"
15,2.26666666667,0.0,0.355555555556,False,0.0,False,text,"  y = 2 for every coordinate   [n] with x  1, and
"
13,3.15384615385,0.0,0.282051282051,False,0.0,False,text,"  y has the same number of coordinates in {0, 1} as y.
"
22,3.18181818182,0.0,0.106060606061,False,0.0,True,text," By the hypotheses of the lemma and the fact that the rank of x plus the rank of y is 2n, we
"
22,3.04545454545,0.0,0.174242424242,False,0.0,False,text," must have that the rank of y is at most 2n  2k. This implies that y must have at least k
"
19,3.94736842105,0.0,0.131578947368,False,0.0,False,text," coordinates in {0, 1}. Also, recall that we have proved above that there are at least n/10  k
"
23,2.73913043478,0.0,0.289855072464,False,0.0,False,text," coordinates such that   [n] such that x = 0 and y = 2. Since i  9n/20, we have that x
"
1,2.0,0.0,0.0,False,0.0,False,text," 19
"
17,4.52941176471,0.0,0.0196078431373,False,0.0,False,text," has at least 11n/20 coordinates which are equal to zero. Putting all of this together, we get
"
13,4.07692307692,0.0,0.184615384615,False,0.0,False,text," that, for n0(k) suciently large, the number of such y is at least
"
1,6.0,0.0,0.833333333333,False,0.0,False,text," 11n/20
"
1,1.0,0.0,1.0,False,0.0,False,text," k
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
1,6.0,0.0,0.666666666667,False,0.0,False,text," 3k1(n)
"
3,2.33333333333,0.0,0.222222222222,False,0.0,False,text," 2k1(n)  1
"
24,2.66666666667,0.0,0.375,False,0.0,False,text," by (1.5). Since P (y  C | x  C) is the same for all such y and the sum of this quantity
"
22,2.18181818182,0.0,0.416666666667,False,0.0,False,text," over all y is at most one, we must have that P (y  C | x  C)   3k1(n)
"
2,2.5,0.0,0.0,False,0.0,False,text," . This
"
13,1.76923076923,0.0769230769231,0.358974358974,False,0.0,True,heading," Case 3: j  i  11n/10 and i + j  2n.
"
3,2.66666666667,0.0,0.555555555556,False,0.0,False,after_body," 2k1(n)  11
"
6,4.66666666667,0.0,0.0,False,0.0,False,text," completes the proof in this case.
"
19,3.63157894737,0.0,0.184210526316,False,0.0,True,text," In this case, we proceed by induction on 2n i j. The basis of our induction will be the
"
26,2.03846153846,0.0,0.346153846154,False,0.0,False,text," case 2n  i  j = 0, which is covered by Case 2. We can write P (y  C | x  C) as
"
1,3.0,0.0,1.66666666667,False,0.0,False,text," xzy
"
9,1.11111111111,0.0,0.851851851852,False,0.0,True,text," P (y, z  C | x  C)
"
1,6.0,0.0,0.833333333333,False,0.0,True,text," XzLi+1
"
16,1.0,0.0,0.8125,False,0.0,True,text," P (z  C | x  C) P (y  C | z  C)
"
1,3.0,0.0,1.66666666667,False,0.0,False,text," xzy
"
2,3.5,0.0,0.416666666667,False,0.0,False,text," = XzLi+1
"
18,2.0,0.0,0.361111111111,False,0.0,True,text," P (z  C | x  C)  1, we see that it suces to show that
"
10,1.4,0.0,0.716666666667,False,0.0,True,text," P (y  C | z  C)  3k1(n)
"
3,2.66666666667,0.0,0.555555555556,False,0.0,False,text," 2k1(n)  11
"
4,4.75,0.0,0.208333333333,False,0.0,False,text," by (4.6). Since PzLi+1
"
1,3.0,0.0,1.66666666667,False,0.0,False,text," xzy
"
1,6.0,0.0,0.0,False,0.0,False,text," (4.26)
"
22,2.90909090909,0.0,0.227272727273,False,0.0,False,text," for every z  Li+1 such that x  z  y. So, let z be any such element. By assumption, we
"
30,2.1,0.0,0.2,False,0.0,False,text," have that i + 1  j and (i + 1) + j  2n and so the rank of y is at least as close to n as the
"
22,3.0,0.0,0.126623376623,False,0.0,False,text," rank of z is. If we have j  (i + 1)  11n/10, then (4.26) holds by the argument given in
"
27,2.40740740741,0.0,0.134038800705,False,0.0,True,text," Case 1 and we are done. So, we assume that j  (i + 1)  11n/10. If we have (i + 1) + j = 2n,
"
21,3.2380952381,0.0,0.0873015873016,False,0.0,False,text," then (4.26) holds by the argument given in Case 2. Thus, we have that j  (i + 1)  11n/10
"
20,3.35,0.0,0.1,False,0.0,False,text," and (i + 1) + j  2n and we now get that (4.26) holds by the inductive hypothesis. This
"
6,4.66666666667,0.0,0.0,False,0.0,False,text," completes the proof of the lemma.
"
4,6.0,0.0,0.0,False,1.0,False,text," 5 Containers for Antichains
"
15,5.4,0.0,0.0,False,0.0,True,text," In this section, we generalise a container-type lemma for the boolean lattice proved by Balogh,
"
16,4.5625,0.0,0.0,False,0.0,True,text," Mycroft and Treglown [6] to general posets. The main idea in the proof originated in the
"
18,4.05555555556,0.0,0.0,False,0.0,False,text," work of Kleitman and Winston [26] and has now been used many times; see, e.g., [6, 8, 31].
"
16,4.75,0.0,0.0625,False,0.0,True,text," In essence, what this lemma says is that if P satises a certain supersaturation bound, then
"
19,3.89473684211,0.0,0.105263157895,False,0.0,False,text," there is a collection of not very large subsets of P indexed by very small subsets of P with
"
18,4.38888888889,0.0,0.0555555555556,False,0.0,False,text," the property that every antichain in P is contained in at least one set from the collection. The
"
16,4.875,0.0568181818182,0.0,False,0.0,False,text," elements of such a collection are referred to as containers. The fact that the containers are
"
17,4.47058823529,0.0,0.0588235294118,False,0.0,False,text," indexed by small subsets of P is typically used to argue that the total number of containers
"
10,4.8,0.0,0.0,False,0.0,False,text," is very small compared to the total number of antichains.
"
14,3.0,0.0,0.178571428571,False,1.125,True,heading," Denition 5.1. Given a set X and an integer j, we let  X
"
2,2.5,0.0,1.75,False,0.0,False,body," j :=Pj
"
14,2.71428571429,0.0,0.285714285714,False,0.0,False,body," m of cardinality at most j. Also, for n  j, dene  n
"
8,3.375,0.0,0.375,False,0.0,False,body," j denote the set of all subsets of
"
1,4.0,0.0,0.75,False,0.0,False,after_body," r=0n
"
1,2.0,0.0,1.0,False,0.0,False,text," r.
"
1,2.0,0.0,0.0,False,0.0,False,text," 20
"
21,3.09523809524,0.619047619048,0.238095238095,True,1.0,True,heading," Lemma 5.2. Let d and m be positive integers and let P be a poset such that |P|  m and
"
16,4.6875,0.75,0.25,False,0.0,False,body," every subset S of P of cardinality greater than m contains at least |S|d comparable pairs.
"
5,4.8,1.0,0.0,False,0.0,True,body," Then there exists a function
"
2,1.0,0.0,1.0,False,0.0,False,after_body," f :
"
1,1.0,0.0,1.0,False,0.0,True,text," P
"
6,1.83333333333,0.0,0.369047619048,False,0.0,False,body,"  |P|/(2d + 1)  P
"
2,0.5,0.0,1.0,False,0.0,False,body,"  m
"
19,3.57894736842,0.736842105263,0.210526315789,False,0.0,False,body," such that for every antichain I  P there exists a subset T of I of cardinality at most
"
19,1.57894736842,0.131578947368,0.353383458647,False,0.0,False,body," |P|/(2d + 1) with T  f (T ) =  and I  T  f (T ).
"
17,4.29411764706,0.0,0.0,False,0.0,True,after_body," A key idea from [6] is that it can often be advantageous to prove a multi-stage container
"
18,4.11111111111,0.0,0.0,False,0.0,False,text," lemma, where the purpose of the early stages is to thin out the poset to reduce the overall
"
16,4.875,0.0,0.0,False,0.0,False,text," number of containers (see also [8]). We prove the following lemma of this type, which implies
"
2,4.5,0.0,0.0,True,0.0,True,text," Lemma 5.2.
"
24,2.20833333333,0.333333333333,0.208333333333,True,1.0,True,heading," Lemma 5.3. For k  1 let d1    dk and m0    mk be positive integers and let P
"
23,2.95652173913,0.586956521739,0.217391304348,False,0.0,False,body," be a poset such that |P| = m0 and, for 1  j  k, every subset S of P of cardinality greater
"
19,4.21052631579,0.578947368421,0.40350877193,False,0.0,False,body," than mj contains at least |S|dj comparable pairs. Then there exists functions f1, . . . , fk where
"
2,1.5,0.0,1.0,False,0.0,False,after_body," fj :
"
1,2.0,0.0,1.5,False,0.0,True,text," Pj
"
1,1.0,0.0,1.0,False,0.0,True,text," P
"
6,2.83333333333,0.0,0.388888888889,False,0.0,False,text," r=1 (mr1/(2dr + 1))  P
"
2,1.0,0.0,0.75,False,0.0,False,heading,"  mj
"
21,3.28571428571,0.52380952381,0.412698412698,False,0.0,False,body," such that for every antichain I  P there exists disjoint subsets T1, . . . , Tk of I with
"
12,2.08333333333,0.208333333333,0.270833333333,False,0.0,False,body," (i) |Tj|  mj1/(2dj + 1) for 1  j  k,
"
4,3.0,0.25,0.541666666667,False,0.0,False,body," (ii) Tj  fj1Sj1
"
10,1.3,0.15,0.383333333333,False,0.0,False,body," r=1 Tr for 2  j  k  1,
"
4,2.25,0.0,0.770833333333,False,0.0,False,text," r=1 Tr  fjSj
"
2,3.5,0.5,0.75,False,0.0,False,text," (iii) Sj
"
3,2.33333333333,0.333333333333,1.0,False,0.0,False,text," (iv) I Sk
"
11,1.36363636364,0.181818181818,0.348484848485,False,0.0,False,body," r=1 Tr =  for 1  j  k and
"
4,2.25,0.0,0.770833333333,False,0.0,False,after_body," r=1 Tr  fkSk
"
2,3.0,0.166666666667,0.666666666667,False,0.0,False,text," r=1 Tr.
"
23,3.39130434783,0.0434782608696,0.289855072464,False,0.0,True,text," Proof. Fix an arbitrary total order x1, . . . , x|P| on the elements of P (this will only be used to
"
18,4.27777777778,0.0,0.0,False,0.0,False,text," break ties later in the proof). The proof of this lemma amounts to a simple application of the
"
12,6.5,0.0,0.0,False,0.0,False,text," so-called KleitmanWinston algorithm [26]. This algorithm takes, as an input, an antichain
"
16,5.0625,0.0,0.0,False,0.0,False,text," describing this algorithm, we will verify that these sets have all of the desired properties and
"
24,2.54166666667,0.0,0.556051587302,False,0.0,True,text," I of P and produces the sets T1, . . . , Tk as well as the sets f1(T1), . . . , fkSk
"
3,3.66666666667,0.0,0.444444444444,False,0.0,False,text," r=1 Tr. After
"
17,3.35294117647,0.0,0.406862745098,False,0.0,False,text," that the functions f1, . . . , fk are well dened; i.e., we show that fjSj
"
4,4.0,0.0,0.458333333333,False,0.0,False,text," r=1 Tr depends only
"
2,2.0,0.0,0.5,False,0.0,False,text," on Sj
"
20,3.2,0.0,0.4,False,0.0,False,text," r=1 Tr and not on the input antichain I or on the sets T1, . . . , Tj individually.
"
22,2.54545454545,0.0,0.231818181818,False,0.0,True,text," Given a set S  P and x  S, dene NS(x) to be the set of elements of S that are
"
21,3.33333333333,0.0,0.225,False,0.0,False,text," comparable to x and let dS(x) := |NS(x)|. Set P0 := P and let u0 be the element of P0 such
"
19,3.94736842105,0.0,0.0488721804511,False,0.0,False,text," that dP0(u0) is maximum; if there is a tie, then we let u0 be the choice which comes earliest
"
21,3.2380952381,0.0,0.194444444444,False,0.0,False,text," in the total order. Now, given i  1, the set Pi1 and an element ui1 of Pi1, the ith step
"
18,4.0,0.0,0.166666666667,False,0.0,False,text," of the algorithm will either terminate or it will produce a non-empty set Pi ( Pi1 and an
"
18,4.11111111111,0.0,0.111111111111,False,0.0,False,text," element ui of Pi which it will pass to the next step. We proceed dierently depending on the
"
4,4.25,0.0,0.375,False,0.0,False,text," value of dPi1 (ui1).
"
5,3.8,0.2,0.255555555556,False,0.0,True,heading," Case 1: dPi1(ui1)  2dk.
"
1,2.0,0.0,0.0,False,0.0,False,after_body," 21
"
24,2.83333333333,0.0,0.483796296296,False,0.0,True,text," Let j be the smallest integer in {1, . . . , k} such that dPi1(ui1)  2dj . If ui1 / I, then
"
22,2.77272727273,0.0,0.333333333333,False,0.0,False,text," we dene Pi := Pi1 \ {ui1}. On the other hand, if ui1  I, then we add ui1 to Tj and
"
14,3.35714285714,0.0,0.479761904762,False,0.0,False,text," dene Pi := Pi1 \{ui1}  NPi1(ui1). It is clear that Pi ( Pi1.
"
20,3.35,0.0,0.310714285714,False,0.0,True,text," If Pi 6= , then let ui  Pi such that dPi(ui) is maximum and, subject to this, ui comes
"
18,4.27777777778,0.0,0.0674603174603,False,0.0,False,text," earliest in the total order. If, in addition, dPi(ui)  2dj, then we simply proceed to the next
"
4,4.75,0.0,0.0,False,0.0,False,text," step of the algorithm.
"
23,2.73913043478,0.0,0.183229813665,False,0.0,True,text," Suppose now that Pi =  or that dPi(ui)  2dj. In the former case, set  := k  j and, in
"
25,2.8,0.0,0.319238095238,False,0.0,False,text," the latter case, let   {0, . . . , k  j} be the largest integer such that dPi(ui)  2dj+. We do
"
2,6.5,0.0,0.0,False,0.0,False,text," the following:
"
6,4.16666666667,0.0,0.111111111111,False,0.0,False,text,"  terminate the denition of Tj,
"
10,1.8,0.0,0.66,False,0.0,False,text,"  set Tj+1, . . . , Tj+ := ,
"
3,2.33333333333,0.0,0.416666666667,False,0.0,False,text,"  set fjSj
"
14,4.5,0.0,0.142857142857,False,0.0,True,text," If Pi = , then terminate the algorithm; otherwise, proceed to the next step.
"
6,3.16666666667,0.166666666667,0.35,False,0.0,True,heading," Case 2: dPi1 (ui1)  2dk.
"
6,2.16666666667,0.0,0.5,False,0.0,False,after_body," r=1 Tr =  = fj+Sj+
"
4,2.5,0.0,0.625,False,0.0,False,text," r=1 Tr := Pi.
"
14,5.21428571429,0.0,0.0,False,0.0,True,text," In this case, we simply terminate the algorithm. This concludes the description of the
"
1,10.0,0.0,0.0,False,0.0,False,text," algorithm.
"
2,3.0,0.0,0.666666666667,False,0.0,False,text," r=1 Tr.
"
4,6.0,0.0,0.520833333333,False,0.0,False,text," r=1 Tr. Therefore, compfjSj
"
16,3.5,0.0,0.395833333333,False,0.0,False,text," r=1 Tr  mj by hypothesis. This veries that fj does, indeed, map into  P
"
18,4.33333333333,0.0,0.253703703704,False,0.0,True,text," A key feature of the algorithm is that the sequence dP0(u0), dP1 (u1), . . . is non-increasing,
"
21,3.47619047619,0.0,0.349206349206,False,0.0,False,text," which follows easily from the choice of the elements u0, u1, . . . and the fact that Pi ( Pi1
"
21,3.14285714286,0.0,0.119047619048,False,0.0,False,text," for all i  1. Since this sequence is non-increasing and d1    dk we see that, for each
"
23,3.0,0.0,0.31884057971,False,0.0,False,text," j  {1, . . . , k}, there is a unique step of the algorithm such that the denition of Tj and
"
17,2.35294117647,0.0,0.446078431373,False,0.0,False,text," r=1 Tr is nalised. Also, if 1  j  j  k, then Tj and fjSj
"
5,3.8,0.0,0.366666666667,False,0.0,False,text," r=1 Tr are dened before
"
1,4.0,0.0,1.25,False,0.0,False,text," fjSj
"
3,3.0,0.0,1.08333333333,False,0.0,True,text," Tj and fjSj
"
22,2.95454545455,0.0,0.159090909091,False,0.0,True,text," It is clear by construction that (ii) and (iii) hold and that Tj  I for 1  j  k. Also,
"
17,4.23529411765,0.0,0.0588235294118,False,0.0,False,text," (iv) holds since we never delete an element of I during the running of the algorithm. By
"
5,6.2,0.0,0.25,False,0.0,False,text," construction, every element of fjSj
"
10,4.4,0.0,0.25,False,0.0,False,text," r=1 Tr is comparable to fewer than 2dj other elements
"
4,1.25,0.0,0.583333333333,False,0.0,False,text," r=1 Tr  
"
2,3.0,0.0,0.625,False,0.0,False,text," in fjSj
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,4.0,0.0,1.25,False,0.0,False,text," fjSj
"
2,3.0,0.0,0.666666666667,False,0.0,False,text," mj. For
"
19,3.68421052632,0.0,0.0877192982456,False,0.0,False,text," each element that we added to T1, we deleted at least 2d1 + 1 elements of P . Therefore,
"
20,3.4,0.0,0.140178571429,False,0.0,False,text," |T1|  |P|/(2d1 + 1) = m0/(2d1 + 1). Similarly, for j  2, for each element that we added
"
12,3.41666666667,0.0,0.236111111111,False,0.0,False,text," to Tj we deleted at least 2dj + 1 elements of fj1Sj1
"
9,2.88888888889,0.0,0.398148148148,False,0.0,False,text," r=1 Tr and so |Tj|  mj1/(2dj + 1).
"
21,3.47619047619,0.0,0.412698412698,False,0.0,True,text," Finally, we argue that the functions f1, . . . , fk are well dened. Let I and I be antichains
"
5,4.0,0.0,0.2,False,0.0,False,text," yielding the same set Sj
"
23,1.95652173913,0.0,0.54347826087,False,0.0,False,text," r=1 Tr for some j with 1  j  k. Let u0, u1, . . . and P0, P1, . . .
"
16,4.4375,0.0,0.125,False,0.0,False,text," be the elements and subsets of P produced while running the algorithm with input I and
"
25,2.92,0.0,0.52,False,0.0,False,text," let u0, u1, . . . and P 0, P 1, . . . be the elements and subsets of P produced while running the
"
16,4.25,0.0,0.200892857143,False,0.0,False,text," algorithm with input I. Let i denote the minimum integer such that dPi(ui)  2dj. We
"
26,2.53846153846,0.0,0.346153846154,False,0.0,False,text," prove that ut = ut and Pt = P t for all 0  t  i. If not, let t be the smallest such integer
"
23,3.04347826087,0.0,0.326086956522,False,0.0,False,text," for which it fails. Clearly, t  1. Now, if Pt = P t , then ut = ut follows immediately so we
"
22,2.81818181818,0.0,0.44696969697,False,0.0,False,text," must have Pt 6= P t . However, since ut1 = ut1 and Pt1 = P t1, the only way that we
"
24,2.54166666667,0.0,0.513888888889,False,0.0,False,text," can have Pt 6= P t is if ut1  I and ut1 / I or vice versa. By denition of i, we have
"
2,2.5,0.0,1.66666666667,False,0.0,False,text," r=1 Tr
"
1,4.0,0.0,1.25,False,0.0,False,text," fjSj
"
4,4.5,0.0,0.25,False,0.0,False,text," dj which implies that
"
3,4.66666666667,0.0,0.0,False,0.0,True,text," Thus, (i) holds.
"
1,2.0,0.0,0.0,False,0.0,False,text," 22
"
11,3.0,0.0,0.540404040404,False,0.0,False,text," dPt1(ut1)  2dj and so ut1  I implies ut1 Sj
"
8,4.5,0.0,0.166666666667,False,0.0,False,text," r=1 Tr by the description of the algorithm.
"
23,3.13043478261,0.0,0.536231884058,False,0.0,True,text," However, ut1 / I implies that the algorithm will not add ut1 to any of the sets T1, . . . , Tk
"
11,4.63636363636,0.0,0.386363636364,False,0.0,False,text," r=1 Tr, contradicting the fact that ut1 = ut1. Therefore fjSj
"
3,3.0,0.0,0.611111111111,False,0.0,False,text," r=1 Tr does
"
4,2.75,0.0,0.666666666667,False,0.0,False,text," and so ut1 /Sj
"
16,4.0,0.0,0.09375,False,0.0,False,text," not depend on I. This argument also proves that it depends only on the union Sj
"
15,3.73333333333,0.0,0.377777777778,False,0.0,False,text," not on the sets T1, . . . , Tj individually. This completes the proof.
"
3,2.66666666667,0.0,0.444444444444,False,0.0,False,text," r=1 Tr and
"
16,4.5,0.0,0.0,False,0.0,True,text," The following lemma is a consequence of Lemma 5.3 which we will use to count antichains
"
4,4.25,0.0,0.0,False,0.0,False,text," in the next section.
"
1,3.0,0.0,1.0,False,0.0,False,text," mr1
"
24,2.20833333333,0.333333333333,0.208333333333,True,1.0,True,heading," Lemma 5.4. For k  1 let d1    dk and m0    mk be positive integers and let P
"
23,2.95652173913,0.586956521739,0.217391304348,False,0.0,False,body," be a poset such that |P| = m0 and, for 1  j  k, every subset S of P of cardinality greater
"
17,4.47058823529,0.823529411765,0.176470588235,False,0.0,False,body," than mj contains at least |S|dj comparable pairs. Then there is a collection F of subsets of
"
3,3.0,0.666666666667,0.333333333333,False,0.0,True,body," P such that
"
3,2.66666666667,0.333333333333,0.833333333333,False,0.0,False,text," (a) |F| Qk
"
1,3.0,0.0,0.666666666667,False,0.0,False,text," r=1
"
5,2.2,0.2,0.533333333333,False,0.0,False,text," (b) |A|  mk +Pk
"
18,2.72222222222,0.583333333333,0.305555555556,False,0.0,False,body," (c) for every antichain I of P , there exists A  F such that I  A.
"
26,3.19230769231,0.0384615384615,0.483974358974,False,0.0,True,text," Proof. Apply Lemma 5.3 to obtain the functions f1, . . . , fk. For each antichain I, let T1,I , . . . , Tk,I
"
11,3.36363636364,0.0,0.272727272727,False,0.0,False,text," be disjoint sets as in Lemma 5.3 such that I Sk
"
4,2.5,0.0,0.729166666667,False,0.0,False,text," r=1 Tr,I  fSk
"
3,4.0,0.0,0.444444444444,False,0.0,False,text," r=1 Tr,I. Dene
"
8,2.25,0.375,0.333333333333,False,0.0,False,body," 2dr +1 for every A  F and
"
2,6.0,0.125,0.5625,False,0.0,False,after_body," mr1/(2dr +1),
"
1,3.0,0.0,1.0,False,0.0,False,text," mr1
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," r=1
"
4,1.25,0.0,0.666666666667,False,0.0,True,text," F :=(  k
"
1,4.0,0.0,0.5,False,0.0,False,text," [r=1
"
5,1.4,0.0,0.8,False,0.0,True,text," Tr,I!  f  k
"
1,4.0,0.0,0.5,False,0.0,False,text," [r=1
"
9,2.55555555556,0.0,0.455555555556,False,0.0,True,text," Tr,I! : I  P is an antichain) .
"
18,3.94444444444,0.0,0.0,False,0.0,True,text," Then (b) and (c) hold by construction. Let us show that (a) holds. The number of ways of
"
1,3.0,0.0,1.0,False,0.0,False,text," |P|
"
6,3.33333333333,0.0,0.125,False,0.0,False,text," choosing T1,I is at most 
"
11,3.81818181818,0.0,0.19696969697,False,0.0,False,text," been chosen, we know that Tj,I is a subset of fj1Sj1
"
10,5.0,0.0,0.200833333333,False,0.0,False,text," mj1/(2dj +1) ways to choose Tj,I. This argument proves (a).
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
18,2.77777777778,0.0,0.490740740741,False,0.0,False,text," |P|/(2d1+1). Now, for 2  j  k, given that T1,I , . . . , Tj1,I have
"
7,4.57142857143,0.0,0.190476190476,False,0.0,False,text," r=1 Tr,I. Therefore, there are at most
"
1,3.0,0.0,1.0,False,0.0,False,text," mj1
"
6,6.16666666667,0.0,0.0,False,1.0,False,text," 6 Applications of the Container-Type Lemma
"
3,7.0,0.0,0.0,False,1.0,False,text," 6.1 Counting Antichains
"
16,4.9375,0.0,0.0,False,0.0,True,text," Before presenting the proofs of Theorems 1.6 and 1.7, we illustrate the the method by applying
"
18,3.83333333333,0.0,0.0,True,0.0,True,text," Lemma 5.4 and Theorem 3.1 to obtain a short proof of a known upper bound on the number
"
15,4.86666666667,0.0,0.06,False,0.0,False,heading," of antichains in P(n). The problem of approximating the number of antichains in P(n) is
"
12,4.5,0.0,0.0,False,0.0,False,after_body," known as Dedekinds Problem and has a long history; see Kahn [22].
"
14,4.35714285714,0.571428571429,0.0357142857143,True,1.0,True,text," Theorem 6.1 (See, e.g., [22]). The number of antichains in P(n) is at most
"
2,7.0,0.0,0.846153846154,False,0.0,False,text," 21+Olog(n)/n( n
"
1,4.0,0.0,1.0,False,0.0,False,text," n/2)
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
16,4.375,0.0625,0.03125,False,0.0,True,text," Proof. We generate a set of containers for the antichains of P(n) using Lemma 5.4. An
"
16,4.6875,0.0,0.0,False,0.0,False,text," upper bound on the number of antichains will then follow by considering all subsets of the
"
1,2.0,0.0,0.0,False,0.0,False,text," 23
"
16,2.8125,0.0,0.364583333333,False,0.0,False,text," containers. Set d1 := nlog n, d2 := n log n, m0 := 2n, m1 :=
"
16,3.6875,0.0,0.114583333333,False,0.0,True,text," If S is a subset of P(n) of cardinality at least m1, then, by Theorem 3.1,
"
2,1.5,0.0,0.5,False,0.0,False,text," 2( n
"
4,3.5,0.0,0.267857142857,False,0.0,False,text," 18d1/n2 and m2 :=
"
1,4.0,0.0,1.0,False,0.0,False,text," n/2)
"
2,1.0,0.0,0.5,False,0.0,False,text," ( n
"
1,4.0,0.0,1.0,False,0.0,False,text," n/2)
"
2,3.5,0.0,0.333333333333,False,0.0,False,text," 12d2/n .
"
5,2.4,0.0,0.761904761905,False,0.0,False,text," comp(S) |S|  2 n
"
2,2.5,0.0,1.41666666667,False,0.0,False,text," n/2 n2
"
2,2.5,0.0,1.41666666667,False,0.0,False,text," n/2 n2
"
2,0.5,0.0,0.0,False,0.0,False,text," 8 
"
10,2.1,0.0,0.245,False,0.0,False,text," 8   (|S|  m1)d1 + m1d1 = |S|d1
"
5,2.0,0.0,0.383333333333,False,0.0,False,text," = (|S|  m1) n2
"
2,2.5,0.0,1.41666666667,False,0.0,False,text," n/2 n2
"
6,1.0,0.0,0.444444444444,False,0.0,False,text," 8  +m1  2 n
"
4,2.25,0.0,0.571428571429,False,0.0,False,text," sincem1  2 n
"
15,3.66666666667,0.0,0.125079365079,False,0.0,False,text," 8  = m1d1. Similarly, if S has cardinality at least m2, then comp(S) 
"
21,3.52380952381,0.0,0.222222222222,False,0.0,False,text," |S|d2. Therefore, we can apply Lemma 5.4 to P(n) with k = 2 and these values of d1, d2, m0, m1
"
12,2.91666666667,0.0,0.166666666667,False,0.0,False,text," and m2 to obtain a collection F of at most  2n
"
5,6.6,0.0,0.2,False,0.0,False,text," m1/d2 containers, each of cardinality
"
5,2.2,0.0,0.2,False,0.0,False,text," at most m2 + m1
"
14,4.35714285714,0.0,0.0357142857143,False,0.0,False,text," , such that each antichain of P(n) is contained in at least one container.
"
1,2.0,0.0,0.5,False,0.0,False,text," d2
"
10,4.0,0.0,0.05,False,0.0,True,text," Thus, the number of antichains in P(n) is at most
"
3,3.66666666667,0.0,0.351851851852,False,0.0,False,text,"  m1/d22m2+ m1
"
10,2.8,0.0,0.325,False,0.0,False,text," d1  (e  d1)2n/d1 (e  d2)m1/d2 2m2+ m1
"
2,1.0,0.0,0.25,False,0.0,False,text,"  2n
"
3,2.33333333333,0.0,0.5,False,0.0,False,text,"  2n/d1 m1
"
2,3.5,0.0,0.85,False,0.0,False,text," 2n/d1 m1
"
2,1.5,0.0,0.25,False,0.0,False,text," + 2n
"
1,2.0,0.0,0.5,False,0.0,False,text," d1
"
2,1.5,0.0,0.25,False,0.0,False,text," + 2n
"
1,2.0,0.0,0.5,False,0.0,False,text," d1
"
2,1.5,0.0,0.25,False,0.0,False,text," + 2n
"
1,2.0,0.0,0.5,False,0.0,False,text," d2
"
1,2.0,0.0,0.5,False,0.0,False,text," d2
"
2,5.5,0.0,0.416666666667,False,0.0,False,text," 2n log2(ed1)
"
2,1.0,0.0,0.0,False,0.0,False,text," = 2
"
1,2.0,0.0,0.5,False,0.0,False,text," d1
"
3,4.0,0.0,0.277777777778,False,0.0,False,text," + m1 log2(ed2)
"
1,2.0,0.0,0.5,False,0.0,False,text," d2
"
2,3.0,0.0,0.375,False,0.0,False,text," +m2+ m1
"
1,2.0,0.0,0.5,False,0.0,False,text," d2
"
2,1.5,0.0,0.25,False,0.0,False,text," + 2n
"
1,2.0,0.0,0.5,False,0.0,False,text," d1
"
10,4.8,0.0,0.1,False,0.0,False,text," for n suciently large. Now, bounding the exponent, we get
"
4,2.5,0.0,0.5625,False,0.0,False,text," m2+O 2n log n
"
1,2.0,0.0,0.5,False,0.0,False,text," d1
"
2,0.5,0.0,0.0,False,0.0,False,text,"  2
"
4,1.75,0.0,0.375,False,0.0,False,text," + m1 log n
"
1,2.0,0.0,0.5,False,0.0,False,text," d2
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
6,1.66666666667,0.0,0.666666666667,False,0.0,False,text," m2 + O 2n log n
"
1,2.0,0.0,0.5,False,0.0,False,text," d1
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
3,2.0,0.0,0.5,False,0.0,False,text," m1 log n
"
4,2.0,0.0,0.85,False,0.0,False,text," + O 2nlog n
"
3,0.666666666667,0.0,0.666666666667,False,0.0,False,text," n  n
"
5,0.8,0.0,0.3,False,0.0,False,text," d2  =  n
"
1,3.0,0.0,1.66666666667,False,0.0,False,text," n/2
"
3,2.0,0.0,0.2,False,0.0,False,text," 1  2d2/n
"
2,0.5,0.0,0.5,False,0.0,False,text,"  n
"
2,2.0,0.0,0.833333333333,False,0.0,False,text," n/2 +
"
5,2.4,0.0,0.82,False,0.0,False,text," =1 + Oplog n/n n
"
1,3.0,0.0,1.66666666667,False,0.0,False,text," n/2
"
2,1.0,0.0,1.0,False,0.0,False,text," + n
"
2,5.0,0.0,1.09523809524,False,0.0,False,text," n/2plog n/n
"
4,1.5,0.0,1.41666666667,False,0.0,False,text," n/2 + O n
"
2,5.0,0.0,1.09523809524,False,0.0,False,text," n/2plog n/n
"
1,3.0,0.0,0.333333333333,False,0.0,False,text," 4d2
"
1,1.0,0.0,1.0,False,0.0,False,text," n
"
3,2.0,0.0,0.333333333333,False,0.0,False,text," since  n
"
4,1.5,0.0,0.541666666667,False,0.0,False,text," n/2 =  2n
"
7,6.14285714286,0.0,0.428571428571,False,0.0,False,text," n by Stirlings Approximation. The result follows.
"
16,4.1875,0.0,0.0,False,0.0,True,text," We now prove Theorems 1.6 and 1.7 by following along similar lines to the proof of
"
4,5.25,0.0,0.0,True,0.0,True,text," Theorem 6.1 given above.
"
18,3.55555555556,0.222222222222,0.248148148148,False,0.0,True,text," Proof of Theorem 1.6. For brevity, dene N := |V(q, n)| and note that N = qn2/2 by
"
9,3.11111111111,0.0,0.333333333333,True,0.0,True,text," Theorem A.1. Let d := nqn/4 and m :=
"
18,3.27777777778,0.0,0.222222222222,False,0.0,False,text," implies that m = qn2/2 and so m and N are of the same order of magnitude. By
"
17,3.35294117647,0.0,0.21568627451,True,0.0,True,text," Theorem 1.2, if S is a subset of V (q, n) of cardinality at least m, then
"
3,4.0,0.0,0.642857142857,False,0.0,False,text," n/2q!(n + 1)/2
"
1,1.0,0.0,2.0,False,0.0,False,text," q
"
1,5.0,0.0,1.2,False,0.0,False,text," n/2iq
"
2,1.0,0.0,1.0,False,0.0,False,text," h n
"
2,5.0,0.0,0.785714285714,False,0.0,False,text," 1dh (n+1)/2
"
6,3.83333333333,0.0,0.0,False,0.0,False,text," . Note that Theorem A.1 also
"
1,2.0,0.0,1.0,False,0.0,False,text," i1
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,1.0,False,0.0,False,text," q
"
6,2.33333333333,0.0,0.375,False,0.0,False,text," = (|S|  m)(n + 1)/2
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
3,4.0,0.0,0.642857142857,False,0.0,False,text," n/2q!(n + 1)/2
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
10,1.7,0.0,0.625,False,0.0,False,text," q  (|S|  m) d + md = |S|d.
"
5,2.2,0.0,0.428571428571,False,0.0,False,text," comp(S)  |S|  n
"
1,1.0,0.0,2.0,False,0.0,False,text," q
"
4,0.75,0.0,0.75,False,0.0,False,text," + m  n
"
1,2.0,0.0,0.0,False,0.0,False,text," 24
"
15,4.26666666667,0.0,0.0666666666667,False,0.0,False,text," d , such that each antichain is contained in at least one container. Thus, the
"
5,6.2,0.0,0.333333333333,False,0.0,True,text," N/d containers, each of cardinality
"
13,3.30769230769,0.0,0.0769230769231,False,0.0,True,text," Thus, by Lemma 5.4, there is a collection of at most  N
"
5,1.8,0.0,0.4,False,0.0,False,text," at most m + N
"
10,3.4,0.0,0.216666666667,False,0.0,False,text," number of antichains in V (q, n) is at most
"
5,1.0,0.0,0.4,False,0.0,False,text," d  (e  d)
"
3,1.66666666667,0.0,0.777777777778,False,0.0,False,text," d 2m+ N
"
2,0.5,0.0,0.5,False,0.0,False,text,"  N
"
3,2.33333333333,0.0,0.611111111111,False,0.0,False,text,"  N/d2m+ N
"
1,1.0,0.0,1.0,False,0.0,True,text," N
"
6,2.0,0.0,0.527777777778,False,0.0,False,text," d = 2m+log N +( N
"
2,6.5,0.0,0.625,False,0.0,False,text," d )(log(ed)+1)
"
15,3.86666666667,0.0,0.0666666666667,False,0.0,True,text," Since q is xed, we can use Theorem A.1 to bound the exponent as follows:
"
1,1.0,0.0,1.0,False,0.0,False,text," q
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
2,0.5,0.0,0.5,False,0.0,False,text," d 
"
3,0.666666666667,0.0,0.666666666667,False,0.0,True,text," N  n
"
5,1.6,0.0,0.6,False,0.0,False,text," m + log N +N
"
8,1.5,0.0,0.208333333333,False,0.0,False,text," d  (log(e  d) + 1) 
"
2,1.0,0.0,1.0,False,0.0,False,text," h n
"
1,5.0,0.0,1.2,False,0.0,False,text," n/2iq
"
3,3.33333333333,0.0,0.222222222222,False,0.0,False,text," 1  dh(n+1)/2
"
5,0.8,0.0,0.8,False,0.0,False,text," + O N  n
"
2,0.5,0.0,0.5,False,0.0,False,text,"  n
"
1,4.0,0.0,1.5,False,0.0,False,text," n/2q
"
3,0.666666666667,0.0,0.666666666667,False,0.0,False,text," d  .
"
8,3.875,0.0,0.315625,False,0.0,False,text," n/2iq and, for xed q, we have h(n+1)/2
"
9,3.33333333333,0.0,0.444444444444,False,0.0,True,text," This completes the proof since N = h n
"
1,5.0,0.0,1.0,False,0.0,False,text," qn/2.
"
20,2.85,0.2,0.321666666667,False,0.0,True,text," Proof of Theorem 1.7. Set d1 := nlog n, d2 := n log n, m0 := 3n, m1 := 2n(n)
"
3,2.66666666667,0.0,0.416666666667,False,0.0,False,text," m2 := n(n)
"
3,1.66666666667,0.0,0.333333333333,False,0.0,False,text," + On2 +
"
1,2.0,0.0,1.0,False,0.0,False,text," i1
"
2,2.0,0.0,0.833333333333,False,0.0,False,text," 2dh n
"
1,5.0,0.0,1.2,False,0.0,False,text," n/2iq
"
1,8.0,0.0,0.625,False,0.0,False,text," h(n+1)/2
"
1,2.0,0.0,1.0,False,0.0,False,text," iq
"
2,5.5,0.0,0.25,False,0.0,False,text," 150d1/n2 and
"
20,3.5,0.0,0.191666666667,False,0.0,False,text," 14d2/n . If S is a subset of {0, 1, 2}n of cardinality at least m1, then, by Theorem 1.4,
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,2.0,0.0,1.0,False,0.0,False,text," iq
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
6,3.16666666667,0.0,0.343253968254,False,0.0,False,text," comp(S)  (|S|  2n(n)) n2
"
1,2.0,0.0,0.5,False,0.0,False,text," 50
"
9,2.55555555556,0.0,0.331481481481,False,0.0,False,text," 50  (|S|  m1)d1 + m1d1 = |S|d1,
"
5,2.8,0.0,0.291666666667,False,0.0,False,text," 50 + (m1  2n(n))n2
"
5,2.0,0.0,0.383333333333,False,0.0,False,text," = (|S|  m1) n2
"
5,3.2,0.0,0.3,False,0.0,False,text," since (m1  2n(n)) n2
"
14,3.78571428571,0.0,0.159523809524,False,0.0,False,text," 50 = m1d1. Similarly, if the cardinality of S is at least m2, then
"
19,3.47368421053,0.0,0.191729323308,False,0.0,False,text," comp(S)  |S|d2. Therefore, we can apply Lemma 5.4 to {0, 1, 2}n with k = 2 and these
"
17,3.17647058824,0.0,0.279411764706,False,0.0,False,text," values of d1, d2, m0, m1 and m2 to obtain a collection F of at most 3n
"
2,8.0,0.0,0.5,False,0.0,False,text," m1/d2 containers,
"
8,3.5,0.0,0.125,False,0.0,False,text," each of cardinality at most m2 + m1
"
11,3.90909090909,0.0,0.166666666667,False,0.0,False,text," , such that each antichain of {0, 1, 2}n is contained
"
1,2.0,0.0,0.5,False,0.0,False,text," d2
"
19,3.68421052632,0.0,0.0964912280702,False,0.0,False,text," in at least one container. We get that the number of antichains in {0, 1, 2}n is at most
"
2,3.5,0.0,0.85,False,0.0,False,text," 3n/d1 m1
"
2,1.5,0.0,0.25,False,0.0,False,text," + 3n
"
1,2.0,0.0,0.5,False,0.0,False,text," d1
"
2,1.0,0.0,0.25,False,0.0,False,text,"  3n
"
3,2.33333333333,0.0,0.5,False,0.0,False,text,"  3n/d1 m1
"
3,3.66666666667,0.0,0.351851851852,False,0.0,False,text,"  m1/d22m2+ m1
"
1,2.0,0.0,0.5,False,0.0,False,text," d2
"
2,1.5,0.0,0.25,False,0.0,False,text," + 3n
"
10,2.8,0.0,0.325,False,0.0,False,text," d1  (e  d1)3n/d1 (e  d2)m1/d2 2m2+ m1
"
1,2.0,0.0,0.5,False,0.0,False,text," d2
"
2,1.5,0.0,0.25,False,0.0,False,text," + 3n
"
1,2.0,0.0,0.5,False,0.0,False,text," d1
"
4,2.5,0.0,0.5625,False,0.0,False,text," m2+O 3n log n
"
1,2.0,0.0,0.5,False,0.0,False,text," d1
"
2,0.5,0.0,0.0,False,0.0,False,text,"  2
"
4,1.75,0.0,0.375,False,0.0,False,text," + m1 log n
"
1,2.0,0.0,0.5,False,0.0,False,text," d2
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
10,4.8,0.0,0.1,False,0.0,False,text," for n suciently large. Now, bounding the exponent, we get
"
6,1.66666666667,0.0,0.666666666667,False,0.0,False,text," m2 + O 3n log n
"
1,2.0,0.0,0.5,False,0.0,False,text," d1
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
3,2.0,0.0,0.5,False,0.0,False,text," m1 log n
"
3,1.0,0.0,0.166666666667,False,0.0,False,text," d2  =
"
1,4.0,0.0,0.75,False,0.0,False,text," n(n)
"
3,2.0,0.0,0.2,False,0.0,False,text," 1  4d2/n
"
5,1.6,0.0,0.7,False,0.0,False,text," + O 3n log n
"
1,2.0,0.0,0.5,False,0.0,False,text," d1
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
3,2.66666666667,0.0,0.583333333333,False,0.0,False,text," n(n) log n
"
5,2.4,0.0,0.25,False,0.0,False,text," since n(n) =  3n
"
7,4.42857142857,0.0,0.428571428571,False,0.0,False,text," n by Theorem A.2. The result follows.
"
1,2.0,0.0,0.0,False,0.0,False,text," 25
"
1,2.0,0.0,0.5,False,0.0,False,text," d2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,2.0,0.0,0.5,False,0.0,False,text," d2
"
3,2.66666666667,0.0,0.583333333333,False,0.0,False,text," n(n) log n
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
1,7.0,0.0,0.571428571429,False,0.0,False,text," 8d2n(n)
"
5,1.6,0.0,0.7,False,0.0,False,text," + O 3n log n
"
1,2.0,0.0,0.5,False,0.0,False,text," d1
"
1,1.0,0.0,1.0,False,0.0,False,text," n
"
3,1.66666666667,0.0,0.25,False,0.0,False,text,"  n(n) +
"
5,3.0,0.0,0.703333333333,False,0.0,False,text," =1 + Oplog n/n n(n)
"
15,4.93333333333,0.0,0.0,False,1.0,True,heading," Remark 6.2. Balogh, Treglown and Wagner [8] have also used the container method to prove
"
16,4.75,0.0,0.025,False,0.0,False,body," an upper bound on the number of antichains in P(n). Their proof only applies a single-stage
"
15,4.73333333333,0.0,0.0,False,0.0,False,body," container lemma (similar to Lemma 5.2), however, and so the bound that they obtain is
"
6,4.5,0.0,0.0,False,0.0,False,body," weaker than that of Theorem 6.1.
"
20,3.2,0.0,0.05,False,0.0,True,body," In the proofs of Theorems 6.1 and 1.7 we used Lemma 5.3 with k = 2 and in the proof
"
20,3.45,0.0,0.05,False,0.0,False,body," of Theorem 1.6 we used Lemma 5.3 with k = 1. We remark that it is not possible to obtain
"
14,4.14285714286,0.0,0.0357142857143,False,0.0,False,body," better bounds by following the same proof with a larger xed value of k.
"
15,4.66666666667,0.0,0.0,False,0.0,True,body," We should also mention that much stronger bounds than that of Theorem 6.1 are known.
"
13,5.92307692308,0.0,0.0,False,0.0,True,body," In particular, Korshunov [27] obtained precise asymptotics of the number of antichains in
"
1,5.0,0.0,0.4,False,0.0,True,after_body," P(n).
"
5,5.6,0.0,0.0,False,1.0,False,text," 6.2 Antichains in Random Subsets
"
17,3.94117647059,0.0,0.0,False,0.0,True,text," In this section, we use Lemma 5.4 to prove Theorems 1.8 and 1.9. We remark that our
"
17,4.35294117647,0.0,0.0,False,0.0,False,text," approach is very similar to that of Balogh, Mycroft and Treglown [6] who used a rough form
"
18,3.88888888889,0.0,0.0902777777778,False,0.0,False,text," of Theorem 3.1 to show that, when p  1/n, the largest antichain in a p-random subset of
"
6,2.66666666667,0.0,0.333333333333,False,0.0,True,text," P(n) is (1 + o(1))p n
"
10,6.0,0.0,0.166666666667,False,0.0,False,text," n/2 with high probability; the same result was obtained independently
"
11,5.18181818182,0.0,0.0,False,0.0,False,text," by Collares Neto and Morris [11] using a somewhat dierent approach.
"
18,4.05555555556,0.0,0.0,False,0.0,True,text," In both proofs, the rst step will be to use Lemma 5.2 to obtain a collection of containers
"
16,4.75,0.0,0.0078125,False,0.0,False,text," for the antichains of the poset. Now, if a p-random subset contains a large antichain, then
"
16,4.8125,0.0,0.0,False,0.0,False,text," in particular it must contain a large subset of one of the containers (since every antichain
"
14,5.0,0.0,0.0,False,0.0,False,text," is contained in some container). By applying a version of the standard Cherno Bound
"
15,5.0,0.0,0.0,True,0.0,False,text," (Theorem 6.3, stated below) one obtains that the probability that this occurs for any xed
"
18,4.27777777778,0.0,0.0,False,0.0,False,text," container is very small and, using the fact that the number of containers is not too large, we
"
10,4.4,0.0,0.0,False,0.0,False,text," can apply a simple union bound to complete the proof.
"
18,4.16666666667,0.222222222222,0.314814814815,True,1.0,True,body," Theorem 6.3 (The Cherno Bound; see, e.g., [17]). Suppose that X1, . . . , Xn are independent
"
11,4.09090909091,0.636363636364,0.242424242424,False,0.0,False,heading," random variables taking values in {0, 1} and let X :=Pn
"
3,2.0,0.0,1.16666666667,False,0.0,False,text," e 2 E(X)
"
2,2.5,0.0,1.375,False,0.0,False,heading," e E(X)
"
6,2.0,0.0,0.194444444444,False,0.0,True,body," P(X  (1 + )E(X)) 
"
1,0.0,0.0,0.0,False,0.0,False,after_body," 
"
4,4.5,0.0,0.0,False,0.0,True,text," We prove Theorem 1.8.
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
1,1.0,0.0,0.0,False,0.0,False,heading," 3
"
3,3.33333333333,0.444444444444,0.333333333333,False,0.0,False,body," i=1 Xi. Then
"
6,0.833333333333,0.166666666667,0.0833333333333,False,0.0,False,body," if 0    1,
"
4,1.0,0.25,0.125,False,0.0,False,body," if   1.
"
17,2.82352941176,0.235294117647,0.43137254902,False,0.0,True,after_body," Proof of Theorem 1.8. Dene N := |V (q, n)| and note that N = h n
"
3,4.0,0.0,0.466666666667,False,0.0,False,text," n/2iq by Theo-
"
21,3.33333333333,0.0,0.240362811791,False,0.0,False,text," rem A.1. Let p = c(, q)/qn/2 for some constant c(, q), to be chosen later, and let Ap be a
"
15,5.13333333333,0.0,0.177777777778,False,0.0,False,text," subset of V (q, n) obtained by including each element independently with probability p. Let
"
6,1.83333333333,0.0,0.458333333333,False,0.0,False,text," m := (1 + /2)h n
"
16,3.4375,0.0,0.260416666667,False,0.0,False,text," . By Theorem 1.2, every subset S of V (q, n) of cardinality at least m
"
1,5.0,0.0,1.2,False,0.0,False,text," n/2iq
"
1,7.0,0.0,0.0,False,0.0,False,text," satises
"
3,2.66666666667,0.0,0.714285714286,False,0.0,False,text," comp(S) 1 
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
5,2.2,0.0,0.4,False,0.0,False,text," 1 + /2(n + 1)/2
"
1,9.0,0.0,0.666666666667,False,0.0,False,text," 3h(n+1)/2
"
4,1.0,0.0,0.75,False,0.0,False,text," q |S|  
"
1,2.0,0.0,1.0,False,0.0,False,text," iq
"
3,2.66666666667,0.0,0.611111111111,False,0.0,False,text," 3(n + 1)/2
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
2,2.0,0.0,1.5,False,0.0,False,text," q |S|
"
12,2.16666666667,0.0,0.152777777778,False,0.0,False,text," given that   (0, 1). So, we set d := 
"
8,4.125,0.0,0.125,False,0.0,False,text," and let f be the function resulting from
"
20,3.65,0.0,0.233333333333,False,0.0,False,text," applying Lemma 5.2 to V (q, n) with these values m and d. Note that, since q is constant, we
"
17,4.0,0.0,0.270588235294,False,0.0,False,text," have d = qn/2. In particular, p is bounded below by a constant multiple of c(, q)/d.
"
1,1.0,0.0,0.0,False,0.0,False,text," 1
"
1,2.0,0.0,0.0,False,0.0,False,text," 26
"
11,2.0,0.0,0.469696969697,False,0.0,True,text," Fix T  V (q, n) such that |T|  N
"
8,2.5,0.0,0.25,False,0.0,False,text," of size at least (1 + )ph n
"
1,5.0,0.0,1.2,False,0.0,False,text," n/2iq
"
13,1.46153846154,0.0,0.346153846154,False,0.0,False,text," with T  I  T  f (T ) is at most
"
10,4.5,0.0,0.225,False,0.0,False,text," 2d+1 . The probability that Ap contains an antichain I
"
15,1.4,0.0,0.644444444444,False,0.0,True,text," P(T  Ap)  P |Ap  f (T )|  p(1 + ) n
"
3,2.66666666667,0.0,0.833333333333,False,0.0,False,text," n/2q  |T|!
"
4,3.0,0.0,0.604166666667,False,0.0,False,text," 2d+1 = Oqn/2h n
"
14,2.07142857143,0.0,0.392857142857,False,0.0,False,text," since T  f (T ) = . By Theorem A.1, |T|  N
"
3,1.33333333333,0.0,1.0,False,0.0,False,text," 4 ph n
"
1,5.0,0.0,1.2,False,0.0,False,text," n/2iq
"
9,3.0,0.0,0.111111111111,False,0.0,False,text," suciently large, we can make |T|   
"
3,2.66666666667,0.0,0.0,False,0.0,False,text," is at most
"
5,4.2,0.0,0.533333333333,False,0.0,False,text," n/2iq. By choosing c(, q)
"
8,4.125,0.0,0.0,False,0.0,False,text," and so we get that the above probability
"
11,2.0,0.0,0.571212121212,False,0.0,False,text," p|T|P |Ap  f (T )|  p(1 + 3/4) n
"
2,3.0,0.0,1.2,False,0.0,False,text," n/2q! .
"
6,3.83333333333,0.0,0.0,False,0.0,True,text," Applying Theorem 6.3 with  =
"
2,4.5,0.0,0.6875,False,0.0,False,text," (1+3/4)h n
"
3,3.66666666667,0.0,0.761904761905,False,0.0,False,text," n/2iq|f (T )|
"
3,2.0,0.0,0.666666666667,False,0.0,False,text," |f (T )|
"
3,3.0,0.0,0.0,False,0.0,False,text," we get that
"
11,1.63636363636,0.0,0.643939393939,False,0.0,True,text," P |Ap  f (T )|  p(1 + 3/4) n
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
4,2.25,0.0,1.04166666667,False,0.0,False,text," e 2|f (T )|p
"
4,2.0,0.0,1.16666666667,False,0.0,False,text," e |f (T )|p
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
6,0.833333333333,0.0,0.0833333333333,False,0.0,False,text," if 0    1,
"
4,1.0,0.0,0.125,False,0.0,False,text," if   1.
"
2,2.5,0.0,0.7,False,0.0,False,text," n/2q! 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
11,1.90909090909,0.0,0.431818181818,False,0.0,True,text," Since |f (T )|  m = (1 + /2)h n
"
16,4.0,0.0,0.1875,False,0.0,False,text," fore, the probability that Ap contains an antichain of size at least (1 + )ph n
"
10,4.4,0.0,0.0666666666667,False,0.0,False,text," , the right side is bounded above by e2mp/100. There-
"
1,5.0,0.0,1.2,False,0.0,False,text," n/2iq
"
1,5.0,0.0,1.2,False,0.0,False,text," n/2iq
"
1,4.0,0.0,0.0,False,0.0,False,text," most
"
2,2.0,0.0,0.0,False,0.0,False,text," is at
"
2,6.0,0.0,0.416666666667,False,0.0,False,text," p|T|e2mp/100 
"
1,8.0,0.0,0.875,False,0.0,True,text," XTV(q,n)
"
1,11.0,0.0,0.636363636364,False,0.0,False,text," |T|N/(2d+1)
"
10,4.0,0.0,0.35,False,0.0,True,text," Given that c(, q) is large enough, the quantity N
"
5,4.0,0.0,0.0,False,0.0,False,text," this is bounded above by
"
1,8.0,0.0,0.375,False,0.0,True,text," N/(2d+1)
"
1,12.0,0.0,0.916666666667,False,0.0,False,text," apae2mp/100.
"
2,2.5,0.0,1.25,False,0.0,True,text," Xa=0 N
"
9,2.33333333333,0.0,0.37037037037,False,0.0,False,text," apa is increasing for 0  a  N
"
3,3.33333333333,0.0,0.0833333333333,False,0.0,False,text," 2d+1 . Thus,
"
2,0.5,0.0,0.5,False,0.0,False,text,"  N
"
3,1.33333333333,0.0,0.166666666667,False,0.0,False,text," 2d + 1
"
6,4.83333333333,0.0,0.418518518519,False,0.0,False,text," + 1 (e(2d + 1)p)N/(2d+1) e2mp/100.
"
16,4.625,0.0,0.129464285714,False,0.0,False,text," multiple of c(, q) and 2mp/100 is bounded below by a constant multiple (depending only on
"
13,4.53846153846,0.0,0.0923076923077,False,0.0,False,text," 2d+1  2mp/200, and so the above expression is o(1). The result follows.
"
18,3.44444444444,0.0,0.240740740741,False,0.0,True,text," Since d = qn/2 and N = (m), the quantity e(2d + 1)p bounded above by a constant
"
7,1.85714285714,0.0,0.5,False,0.0,False,text,"  and q) of c(, q) N
"
13,4.38461538462,0.0,0.165384615385,False,0.0,False,text," 2d+1. Therefore, we may choose c(, q) large enough so that log(e(2d +
"
2,2.5,0.0,0.75,False,0.0,False,text," 1)p) N
"
18,3.83333333333,0.0,0.0740740740741,False,0.0,True,text," Let us note that Theorem 1.8 is best possible up to the choice of the constant c(, q).
"
21,3.0,0.0,0.291666666667,False,0.0,True,text," Let Ap be a p-random subset of V (q, n) where p = c/qn/2 for some constant c  0 and
"
22,2.90909090909,0.0,0.321212121212,False,0.0,False,text," let n be large with respect to q and c. Given x  V (q, n) of dimension (n + 1)/2, the
"
15,4.73333333333,0.0,0.222222222222,False,0.0,False,text," expected number of subspaces of x of dimension n/2 contained in Ap is constant. Thus,
"
16,4.8125,0.0,0.166666666667,False,0.0,False,text," with probability bounded away from zero, a constant proportion of the elements of V (q, n)Ap
"
16,4.4375,0.0,0.21875,False,0.0,False,text," of dimension (n + 1)/2 have no subspaces of dimension n/2 contained in Ap. Taking this
"
7,4.0,0.0,0.142857142857,False,0.0,False,text," set along with all subspaces of Fn
"
11,4.18181818182,0.0,0.30303030303,False,0.0,False,text," q of dimension n/2 contained in Ap gives us an antichain
"
1,2.0,0.0,0.0,False,0.0,False,text," 27
"
8,2.5,0.0,0.25,False,0.0,False,text," of size at least (1 + )ph n
"
1,1.0,0.0,1.0,False,0.0,False,text," h
"
1,9.0,0.0,0.666666666667,False,0.0,False,text," (n+1)/2iq
"
3,1.0,0.0,1.0,False,0.0,False,text," = h n
"
1,1.0,0.0,1.0,False,0.0,False,text," n
"
1,5.0,0.0,1.2,False,0.0,False,text," n/2iq
"
11,4.54545454545,0.0,0.218181818182,False,0.0,False,text," n/2iq for xed q (Theorem A.1). A similar argument shows that
"
17,3.88235294118,0.0,0.0294117647059,True,0.0,True,text," Theorem 1.9 is best possible up to the choice of c(). Next, we apply Lemma 5.2 and
"
6,4.66666666667,0.0,0.0,True,0.0,True,text," Theorem 1.4 to prove Theorem 1.9.
"
14,2.64285714286,0.0,0.107142857143,False,0.0,False,text," for some  = (q, c)  0. Here, we used the fact that
"
19,3.63157894737,0.210526315789,0.182456140351,False,0.0,True,text," Proof of Theorem 1.9. Let p = c()/n for some constant c() to be chosen later and let Ap
"
16,4.9375,0.0,0.145833333333,False,0.0,False,text," be a subset of {0, 1, 2}n obtained by including each element independently with probability p.
"
21,3.2380952381,0.0,0.240873015873,False,0.0,True,text," Let m1 := 3n(n) and let m2 := (1 + /2)n(n). By Theorem 1.4, every subset S of {0, 1, 2}n
"
6,4.83333333333,0.0,0.0833333333333,False,0.0,False,text," of cardinality at least m1 satises
"
6,3.16666666667,0.0,0.343253968254,False,0.0,False,text," comp(S)  (|S|  2n(n)) n2
"
3,1.33333333333,0.0,0.333333333333,False,0.0,False,text," 50  n2
"
1,6.0,0.0,0.666666666667,False,0.0,False,text," 200|S|
"
17,4.05882352941,0.0,0.196078431373,False,0.0,True,text," Also, by Theorem 1.4, every subset S of {0, 1, 2}n of cardinality at least m2 satises
"
6,2.83333333333,0.0,0.44880952381,False,0.0,False,text," comp(S)  (|S|  n(n)) n
"
3,0.666666666667,0.0,1.0,False,0.0,False,text," 4  n
"
1,5.0,0.0,0.8,False,0.0,False,text," 12|S|
"
5,2.2,0.0,0.5,False,0.0,False,text," 200 and d2 := n
"
12,2.41666666667,0.0,0.111111111111,False,0.0,False,text," given that   (0, 1). So, we set d1 := n2
"
9,3.0,0.0,0.111111111111,False,0.0,False,text," 12 . Let f1 and f2 be the functions
"
21,3.38095238095,0.0,0.253968253968,False,0.0,False,text," resulting from applying Lemma 5.3 to {0, 1, 2}n with k = 2 and the values of d1, d2, m1, m2
"
1,6.0,0.0,0.0,False,0.0,False,text," above.
"
3,3.0,0.0,0.0666666666667,False,0.0,False,text," 2d2+1 . The
"
21,3.2380952381,0.0,0.230158730159,False,0.0,False,text," probability that Ap contains an antichain I of size at least (1 + )pn(n) with T1  T2  I 
"
10,2.0,0.0,0.173333333333,False,0.0,True,text," T1  T2  f2(T1  T2) is at most
"
11,2.81818181818,0.0,0.207575757576,False,0.0,False,text," 2d1+1 and x T2  f1(T1) such that |T2|  m1
"
11,2.45454545455,0.0,0.325757575758,False,0.0,True,text," Fix T1  {0, 1, 2}n such that |T1|  3n
"
21,1.85714285714,0.0,0.335714285714,False,0.0,True,text," P(T1  T2  Ap)  P (|Ap  f2 (T1  T2)|  p(1 + )n(n)  |T1  T2|)
"
3,2.33333333333,0.0,0.833333333333,False,0.0,False,text," n  10n(n)
"
18,2.22222222222,0.0,0.253703703704,False,0.0,False,text," since (T1  T2)  f2 (T1  T2) = . Note that |T1  T2|  1003n
"
3,3.0,0.0,0.333333333333,False,0.0,False,text," for large n
"
19,3.47368421053,0.0,0.19298245614,False,0.0,False,text," by Theorem A.2. Since p = c()/n, we may choose c() suciently large so that |T1  T2| 
"
2,0.0,0.0,0.0,False,0.0,False,text,"  
"
11,4.81818181818,0.0,0.151515151515,False,0.0,False,text," 4 pn(n). Therefore, the expression in (6.4) is bounded above by
"
3,2.66666666667,0.0,0.366666666667,False,0.0,False,text," n2 + 6n(n)
"
11,3.18181818182,0.0,0.401262626263,False,0.0,False,text," p|T1T2|P (|Ap  f2(T1  T2)|  p(1 + 3/4)n(n)) .
"
1,5.0,0.0,0.0,False,0.0,False,text," (6.4)
"
1,1.0,0.0,2.0,False,0.0,False,text," n
"
7,6.28571428571,0.0,0.0816326530612,False,0.0,True,text," Applying Theorem 6.3 with  = (1+3/4)n(n)|f2(T1T2)|
"
1,10.0,0.0,0.6,False,0.0,False,text," |f2(T1T2)|
"
3,3.0,0.0,0.0,False,0.0,False,text," we get that
"
11,2.45454545455,0.0,0.321717171717,False,0.0,True,text," P (|Ap  f2(T1  T2)|  p(1 + 3/4)n(n)) 
"
1,0.0,0.0,0.0,False,0.0,False,text," 
"
2,6.5,0.0,1.33333333333,False,0.0,False,text," e 2|f2(T1T2)|p
"
2,6.0,0.0,1.36363636364,False,0.0,False,text," e |f2(T1T2)|p
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
1,1.0,0.0,0.0,False,0.0,False,text," 3
"
6,0.833333333333,0.0,0.0833333333333,False,0.0,False,text," if 0    1,
"
4,1.0,0.0,0.125,False,0.0,False,text," if   1.
"
18,4.0,0.0,0.155092592593,False,0.0,True,text," Since |f2 (T1  T2)|  (1 + /2)n(n), the right side is bounded above by e2n(n)p/100. There-
"
18,4.11111111111,0.0,0.101851851852,False,0.0,False,text," fore, the probability that Ap contains an antichain of size at least (1 + )pn(n) is at most
"
1,2.0,0.0,0.5,False,0.0,False,text," 3n
"
1,2.0,0.0,0.5,False,0.0,False,text," m1
"
1,5.0,0.0,0.2,False,0.0,False,text," 2d1+1
"
1,5.0,0.0,0.2,False,0.0,False,text," 2d2+1
"
2,3.0,0.0,0.75,False,0.0,True,text," Xb=0 3n
"
6,5.66666666667,0.0,0.144444444444,False,0.0,True,text," For c() suciently large, the quantity3n
"
5,0.8,0.0,0.3,False,0.0,False,text," 0  a  3n
"
1,4.0,0.0,0.5,False,0.0,True,text," Xa=0
"
7,1.71428571429,0.0,0.242857142857,False,0.0,False,text," 2d1+1 and 0  b  m1
"
2,1.0,0.0,0.25,False,0.0,False,text,"  3n
"
4,1.75,0.0,0.708333333333,False,0.0,False,text," 2d1 + 1 m1
"
1,3.0,0.0,1.33333333333,False,0.0,False,text," am1
"
1,3.0,0.0,1.33333333333,False,0.0,False,text," am1
"
4,3.0,0.0,0.440476190476,False,0.0,False,text," 2d2 + 1 (3ed1p)
"
2,8.0,0.0,0.9,False,0.0,False,text," b pa+be2n(n)p/100
"
12,3.16666666667,0.0,0.333333333333,False,0.0,False,text," b pa+b is increasing in both a and b in the range
"
1,2.0,0.0,0.5,False,0.0,False,text," 3n
"
2,6.0,0.0,0.314285714286,False,0.0,False,text," 2d1+1 (3ed2p)
"
1,2.0,0.0,0.5,False,0.0,False,text," m1
"
2,8.5,0.0,0.475,False,0.0,False,text," 2d2+1 e2n(n)p/100.
"
9,4.66666666667,0.0,0.0222222222222,False,0.0,False,text," 2d2+1 . Therefore, the above expression is at most
"
1,2.0,0.0,0.0,False,0.0,False,text," 28
"
18,3.83333333333,0.0,0.0888888888889,False,0.0,True,text," By denition of d2 and p, we have that 3ed2p is bounded above by a constant multiple of
"
17,3.94117647059,0.0,0.130392156863,False,0.0,False,text," c() and, since n(n) =  (m1), we have that 2n(n)p/100 is bounded below by a constant
"
8,4.0,0.0,0.3125,False,0.0,False,text," multiple (depending only on ) of c() m1
"
3,5.33333333333,0.0,0.3,False,0.0,False,text," that log(3ed2p) m1
"
9,4.66666666667,0.0,0.111111111111,False,0.0,False,text," 2d2+1. Therefore we may choose c() large enough so
"
12,4.83333333333,0.0,0.1,False,0.0,False,text," 2d2+1  2n(n)p/200 and so the above expression is o(1). This completes
"
2,4.5,0.0,0.0,False,0.0,False,text," the proof.
"
16,4.75,0.0,0.0,False,0.0,True,text," To close this section, we remark that none of the proofs in this section required asymptot-
"
13,6.07692307692,0.0,0.0,False,0.0,False,text," ically sharp supersaturation results. In applying the container method, it is often sucient
"
17,4.47058823529,0.0,0.0,False,0.0,False,text," to have a supersaturation result which is best possible up to a constant factor (such as the
"
8,6.625,0.0,0.0,False,0.0,False,text," graph supersaturation theorem of Erdos and Simonovits [20]).
"
3,4.33333333333,0.0,0.0,False,1.0,False,text," 7 Open Problems
"
26,2.5,0.0,0.333333333333,False,0.0,True,text," For general r  1 one can dene a partial order on {0, . . . , r}n where x  y if and only if
"
28,2.32142857143,0.0,0.416666666667,False,0.0,False,text," xj  yj for all j. For 0  i  rn let i(n, r) be the number of elements of {0, . . . , r}n with
"
10,5.4,0.0,0.05,False,0.0,False,text," coordinate sum equal to i. We propose the following conjecture.
"
19,4.05263157895,0.710526315789,0.184210526316,False,1.0,True,heading," Conjecture 7.1. Let r, n be positive integers such that n is large with respect to r. Then, for
"
25,2.8,0.45,0.336666666667,False,0.0,False,body," 1  m  (r + 1)n, the number of comparable pairs in a subset of {0, . . . , r}n of cardinality m
"
16,4.4375,0.9375,0.046875,False,0.0,False,body," is minimised by a set whose elements have coordinate sum as close to rn/2 as possible.
"
14,5.07142857143,0.0,0.0,False,0.0,True,after_body," We remark that the same conjecture was made independently by Balogh and Wagner [10].
"
17,4.17647058824,0.0,0.0588235294118,False,0.0,True,text," The case r = 1 of Conjecture 7.1 follows from the theorem of Kleitman [23] (without the
"
19,4.05263157895,0.0,0.0789473684211,False,0.0,False,text," requirement that n is large), but it is open for all other values of r. In particular, the case
"
17,4.29411764706,0.0,0.0588235294118,False,0.0,False,text," r = 2 of Conjecture 7.1 is strictly stronger than Theorem 1.4. The following weak form of
"
9,5.88888888889,0.0,0.0,False,0.0,True,text," Conjecture 7.1 would be good enough for certain applications.
"
16,4.6875,0.4375,0.125,False,1.0,True,heading," Conjecture 7.2 (Weak form of Conjecture 7.1). Let r, k be positive integers. There exist a
"
18,3.05555555556,0.444444444444,0.439814814815,False,0.0,False,body," positive constant c(r, k) such that for every S  {0, . . . , r}n we have
"
7,4.0,0.0,0.776360544218,False,0.0,False,body," comp(S) |S|  krn/2(n, r) c(r, k)nk
"
23,3.0,0.0,0.260869565217,False,0.0,True,after_body," The poset {0, . . . , r}n can also be viewed as the poset of divisors of the rth power of a
"
14,5.64285714286,0.0,0.0714285714286,False,0.0,False,text," square-free integer with n prime factors. Another natural direction for future work could be
"
15,5.26666666667,0.0,0.0,False,0.0,False,text," to prove a non-trivial supersaturation theorem for the poset of divisors of a general integer
"
15,5.33333333333,0.0,0.0,False,0.0,False,text," (perhaps with the number of distinct prime factors suciently large with respect to the largest
"
14,5.57142857143,0.0,0.0,False,0.0,False,text," multiplicity of a prime factor). As mentioned earlier, Anderson [1] proved that such posets
"
14,5.5,0.0,0.0,False,0.0,False,text," have regular coverings by chains. It seems possible that one could prove a supersaturation
"
15,5.13333333333,0.0,0.0,False,0.0,False,text," theorem for such a poset by considering a chain chosen randomly according to a distribution
"
17,4.41176470588,0.0,0.0,False,0.0,False,text," based on a regular covering by chains and applying Lemma 2.2. The devil, however, is in the
"
1,8.0,0.0,0.0,False,0.0,False,text," details.
"
12,6.75,0.0,0.0,False,0.0,True,text," Also, one could consider supersaturation problems for other classical posets. In particular,
"
15,5.06666666667,0.0,0.0,False,0.0,False,text," it would also be interesting to prove supersaturation results for posets which do not have
"
12,4.83333333333,0.0,0.0,False,0.0,False,text," regular coverings by chains, or for posets which are not even ranked.
"
16,4.5625,0.0,0.0,False,0.0,True,text," In another direction, one could try to improve our bounds on the number of antichains in
"
18,4.05555555556,0.0,0.222222222222,False,0.0,True,text," V (q, n) and {0, 1, 2}n (Theorems 1.6 and 1.7) and obtain similar bounds for other posets.
"
1,2.0,0.0,0.0,False,0.0,False,text," 29
"
14,5.14285714286,0.0,0.0,False,1.0,True,heading," Note added in the proof. Following the submission of this paper, Balogh, Petrcova and
"
17,4.35294117647,0.0,0.0588235294118,False,0.0,True,body," Wagner [7] disproved Conjecture 7.1 for all r  2 and Samotij [32] proved the conjecture of
"
23,2.69565217391,0.0,0.144927536232,False,0.0,True,body," Kleitman [23] that, for any k  2 and 1  m  2n, the number of chains of length k in a
"
21,3.57142857143,0.0,0.119047619048,False,0.0,False,body," subset of P(n) of size m is minimised by a collection of subsets of [n] of size as close to n/2
"
2,5.5,0.0,0.0,False,0.0,False,after_body," as possible.
"
1,10.0,0.0,0.0,False,1.0,True,text," References
"
15,4.66666666667,0.253333333333,0.0,False,0.0,False,text," [1] I. Anderson. On the divisors of a number. J. London Math. Soc., 43:410418, 1968.
"
13,5.53846153846,0.205128205128,0.0,False,0.0,False,text," [2] I. Anderson. A variance method in combinatorial number theory. Glasgow Math. J.,
"
2,7.5,0.0,0.0,False,0.0,False,text," 10:126129, 1969.
"
12,6.33333333333,0.3375,0.0,False,0.0,False,text," [3] I. Anderson. Combinatorics of nite sets. Oxford Science Publications. The Clarendon
"
7,5.85714285714,0.0,0.0,False,0.0,True,text," Press, Oxford University Press, New York, 1987.
"
17,4.41176470588,0.0,0.00980392156863,False,0.0,False,text," [4] J. Balogh, H. Liu, and M. Sharifzadeh. The number of subsets of integers with no k-term
"
9,6.33333333333,0.533333333333,0.0,False,0.0,False,text," arithmetic progression. Int. Math. Res. Not. IMRN, 2016(00): 119.
"
15,5.0,0.2,0.0,False,0.0,False,text," [5] J. Balogh, R. Morris, and W. Samotij. Independent sets in hypergraphs. J. Amer. Math.
"
3,7.66666666667,0.266666666667,0.0,False,0.0,True,text," Soc., 28(3):669709, 2015.
"
15,4.66666666667,0.0666666666667,0.0,False,0.0,False,text," [6] J. Balogh, R. Mycroft, and A. Treglown. A random version of Sperners theorem. J.
"
6,5.83333333333,0.583333333333,0.0,False,0.0,True,text," Combin. Theory Ser. A, 128:104110, 2014.
"
15,4.86666666667,0.0,0.0,False,0.0,False,text," [7] J. Balogh, S. Petrcova, and A. Zs. Wagner. Families in posets minimizing the number
"
5,9.2,0.0,0.0,False,0.0,False,text," of comparable pairs. arXiv:1703.05427v1, preprint.
"
15,4.8,0.0,0.0,False,0.0,False,text," [8] J. Balogh, A. Treglown, and A. Zs. Wagner. Applications of graph containers in the
"
7,8.57142857143,0.415584415584,0.0,False,0.0,False,text," boolean lattice. Random Structures Algorithms, 49(4):845872, 2016.
"
16,4.625,0.0,0.0,False,0.0,False,text," [9] J. Balogh and A. Zs. Wagner. Further applications of the container method. In A. Bev-
"
15,4.73333333333,0.2,0.0,False,0.0,False,text," eridge, J. R. Griggs, G. Hogben, L. Musiker, and P. Tetali, editors, Recent Trends in
"
12,5.83333333333,0.737637362637,0.0,False,0.0,True,text," Combinatorics, volume 159 of The IMA Volumes in Mathematics and its Applications,
"
5,6.2,0.0,0.0,False,0.0,False,text," pages 191213. Springer, Cham, 2016.
"
15,5.0,0.0,0.0,False,0.0,False,text," [10] J. Balogh and A. Zs. Wagner. Kleitmans conjecture about families of given size mini-
"
8,7.375,0.0,0.0138888888889,False,0.0,False,text," mizing the number of k-chains. arXiv:1609.02262v1, preprint, 2016.
"
12,6.16666666667,0.0833333333333,0.0,False,0.0,False,text," [11] M. Collares and R. Morris. Maximum-size antichains in random set-systems. Random
"
4,9.75,0.477272727273,0.0,False,0.0,True,text," Structures Algorithms, 49(2):308321, 2016.
"
15,5.0,0.2,0.0,False,0.0,False,text," [12] D. Conlon and T. Gowers. Combinatorial theorems in sparse random sets. Ann. of Math.
"
3,7.66666666667,0.25,0.0,False,0.0,False,text," (2), 184(2):367454, 2016.
"
16,4.3125,0.0,0.0,False,0.0,False,text," [13] S. Das, W. Gan, and B. Sudakov. Sperners theorem and a problem of Erdos, Katona
"
7,7.42857142857,0.410714285714,0.0,False,0.0,False,text," and Kleitman. Combin. Probab. Comput., 24(4):585608, 2015.
"
17,4.17647058824,0.0,0.0,False,0.0,False,text," [14] S. Das, W. Gan and B. Sudakov, The minimum number of disjoint pairs in set systems
"
6,8.5,0.154761904762,0.0,False,0.0,False,text," and related problems, Combinatorica, 36(6):623660, 2016.
"
1,2.0,0.0,0.0,False,0.0,False,text," 30
"
16,4.3125,0.0,0.0,False,0.0,False,text," [15] N. G. de Bruijn, Ca. van Ebbenhorst Tengbergen, and D. Kruyswijk. On the set of
"
10,5.5,0.375,0.0,False,0.0,False,text," divisors of a number. Nieuw Arch. Wiskunde (2), 23:191193, 1951.
"
17,4.41176470588,0.0,0.0,False,0.0,False,text," [16] A. P. Dove, J. R. Griggs, R. J. Kang, and J.-S. Sereni. Supersaturation in the Boolean
"
7,5.57142857143,0.126984126984,0.0,False,0.0,False,text," lattice. Integers, 14A:Paper No. A4, 7, 2014.
"
15,5.06666666667,0.533333333333,0.0,False,0.0,False,text," [17] D. P. Dubhashi and A. Panconesi. Concentration of measure for the analysis of random-
"
7,7.85714285714,0.272727272727,0.0,False,0.0,False,text," ized algorithms. Cambridge University Press, Cambridge, 2009.
"
13,5.46153846154,0.217948717949,0.0,False,0.0,False,text," [18] P. Erdos. On a theorem of Rademacher-Turan. Illinois J. Math., 6:122127, 1962.
"
16,4.9375,0.125,0.0,False,0.0,False,text," [19] P. Erdos. Some recent results on extremal problems in graph theory. Results. In Theory of
"
11,6.72727272727,0.439393939394,0.0,False,0.0,True,text," Graphs (Internat. Sympos., Rome, 1966), pages 117123 (English); pp. 124130 (French).
"
8,5.125,0.0,0.0,False,0.0,True,text," Gordon and Breach, New York; Dunod, Paris, 1967.
"
11,6.90909090909,0.0844155844156,0.0,False,0.0,False,text," [20] P. Erdos and M. Simonovits. Supersaturated graphs and hypergraphs. Combinatorica,
"
2,8.5,0.0,0.0,False,0.0,False,text," 3(2):181192, 1983.
"
13,5.53846153846,0.292307692308,0.0,False,0.0,False,text," [21] P. Hall. On representatives of subsets. J. London Math. Soc., 10(1):2630, 1935.
"
13,5.46153846154,0.0,0.0,False,0.0,False,text," [22] J. Kahn. Entropy, independent sets and antichains: a new approach to Dedekinds
"
7,6.71428571429,0.542857142857,0.0,False,0.0,False,text," problem. Proc. Amer. Math. Soc., 130(2):371378, 2002.
"
13,5.69230769231,0.0,0.0,False,0.0,False,text," [23] D. Kleitman. A conjecture of Erdos-Katona on commensurable pairs among subsets of
"
13,5.46153846154,0.525641025641,0.0128205128205,False,0.0,False,text," an n-set. In Theory of Graphs (Proc. Colloq., Tihany, 1966), pages 215218. Academic
"
4,4.75,0.0,0.0,False,0.0,True,text," Press, New York, 1968.
"
12,5.83333333333,0.0,0.0,False,0.0,False,text," [24] D. Kleitman. On Dedekinds problem: The number of monotone Boolean functions.
"
6,5.83333333333,0.633333333333,0.0,False,0.0,True,text," Proc. Amer. Math. Soc., 21:677682, 1969.
"
15,4.73333333333,0.0,0.0,False,0.0,False,text," [25] D. J. Kleitman. On an extremal property of antichains in partial orders. The LYM
"
12,6.08333333333,0.25,0.0,False,0.0,False,text," property and some of its implications and applications. In Combinatorics (Proc. NATO
"
11,6.81818181818,1.0,0.0,False,0.0,True,text," Advanced Study Inst., Breukelen, 1974), Part 2: Graph theory; foundations, partitions
"
12,6.0,0.240740740741,0.0,False,0.0,False,text," and combinatorial geometry, pages 7790. Math. Centre Tracts, No. 56. Math. Centrum,
"
2,7.5,0.0,0.0,False,0.0,True,text," Amsterdam, 1974.
"
16,4.625,0.0625,0.0,False,0.0,False,text," [26] D. J. Kleitman and K. J. Winston. On the number of graphs without 4-cycles. Discrete
"
3,8.0,0.277777777778,0.0,False,0.0,True,text," Math., 41(2):167172, 1982.
"
12,6.0,0.158333333333,0.0,False,0.0,False,text," [27] A. D. Korshunov. The number of monotone Boolean functions. Problemy Kibernet.,
"
3,6.33333333333,0.0,0.0,False,0.0,False,text," (38):5108, 272, 1981.
"
14,5.21428571429,0.204081632653,0.0,False,0.0,False,text," [28] D. Lubell. A short proof of Sperners lemma. J. Combinatorial Theory, 1:299, 1966.
"
12,6.5,0.166666666667,0.0,False,0.0,False,text," [29] B. Patkos. Supersaturation and stability for forbidden subposet problems. J. Combin.
"
5,5.6,0.5,0.0,False,0.0,True,text," Theory Ser. A, 136:220237, 2015.
"
13,5.46153846154,0.288461538462,0.0,False,0.0,False,text," [30] C. Reiher. The clique density theorem. Ann. of Math. (2), 184(3):683707, 2016.
"
13,5.84615384615,0.221153846154,0.0,False,0.0,False,text," [31] W. Samotij. Counting independent sets in graphs. European J. Combin., 48:518, 2015.
"
12,6.33333333333,0.0,0.0,False,0.0,False,text," [32] W. Samotij. Subsets of posets minimising the number of chains. arXiv:1708.02436v1,
"
1,9.0,0.0,0.0,False,0.0,False,text," preprint.
"
1,2.0,0.0,0.0,False,0.0,False,text," 31
"
14,5.14285714286,0.142857142857,0.0,False,0.0,False,text," [33] W. Samotij and B. Sudakov, On the number of monotone sequences, J. Combinatorial
"
5,5.4,0.6,0.0,False,0.0,True,text," Theory Ser. B 115:132163, 2015.
"
16,4.8125,0.0,0.0,False,0.0,False,text," [34] W. Samotij and B. Sudakov. The number of additive triples in subsets of abelian groups.
"
7,7.14285714286,0.685714285714,0.0,False,0.0,True,text," Math. Proc. Cambridge Philos. Soc., 160(3):495512, 2016.
"
11,6.72727272727,0.166666666667,0.0,False,0.0,False,text," [35] D. Saxton and A. Thomason. Hypergraph containers. Invent. Math., 201(3):925992,
"
1,5.0,0.0,0.0,False,0.0,False,text," 2015.
"
13,5.53846153846,0.288461538462,0.0,False,0.0,False,text," [36] M. Schacht. Extremal results for random discrete structures. Ann. of Math. (2),
"
2,9.5,0.0,0.0,False,0.0,False,text," 184(2):333365, 2016.
"
13,5.92307692308,0.128205128205,0.0,False,0.0,False,text," [37] E. Sperner. Ein Satz uber Untermengen einer endlichen Menge. Math. Z., 27(1):544548,
"
1,5.0,0.0,0.0,False,0.0,False,text," 1928.
"
14,5.28571428571,0.321428571429,0.0,False,0.0,False,text," [38] H. S. Wilf. Three problems in combinatorial asymptotics. J. Combin. Theory Ser. A,
"
2,9.0,0.0,0.0,False,0.0,False,text," 35(2):199207, 1983.
"
11,2.81818181818,0.0,0.0,False,1.0,True,text," A Rank Numbers in V (q, n) and {0, 1, 2}n
"
19,3.73684210526,0.0,0.210526315789,False,0.0,True,text," We provide a number of results regarding the rank numbers in V (q, n) and {0, 1, 2}n that
"
20,3.5,0.0,0.0,False,0.0,False,text," we require in the paper. The rst is a theorem of Wilf [38] which is used in the proofs of
"
4,4.5,0.0,0.0,True,0.0,True,text," Theorems 1.6 and 1.8.
"
16,3.125,0.583333333333,0.1875,True,1.0,True,heading," Theorem A.1 (Wilf [38]). For a xed prime power q and n  , we have
"
7,2.57142857143,0.142857142857,0.619047619048,False,0.0,False,text," |V (q, n)| = qn2/2 , and
"
2,0.5,0.0,0.5,False,0.0,False,text,"  n
"
1,4.0,0.0,1.5,False,0.0,False,text," n/2q
"
3,2.33333333333,0.0,0.666666666667,False,0.0,False,text," = qn2/2 .
"
1,6.0,0.166666666667,1.16666666667,False,0.0,False,heading," n/2iq.
"
8,3.0,0.25,0.666666666667,False,0.0,True,body," In particular, |V (q, n)| = h n
"
1,2.0,0.5,1.5,False,0.0,False,after_body," n.
"
8,3.875,0.0,0.15625,True,1.0,True,text," Theorem A.2 (Anderson [2]). n(n) =  3n
"
16,4.25,0.0,0.0,False,0.0,True,text," The following result of Anderson [2] is used in the proofs of Theorems 1.7 and 1.9.
"
15,3.0,0.0666666666667,0.411111111111,False,0.0,True,text," A sequence a0, . . . , aN is said to be log-concave if ai+1
"
10,1.3,0.0,0.2,False,0.0,False,text," for 1  i  N  1. In the
"
16,4.75,0.0,0.0,False,0.0,False,text," proof of Theorem 1.4 we use the following theorem, which has been proven in several dierent
"
17,4.47058823529,0.0,0.0,False,0.0,False,text," papers (see Chapter 4 of [3] for references). To our knowledge, the earliest proof is due to
"
2,6.0,0.0,0.0,False,0.0,True,text," Anderson [1].
"
3,1.33333333333,0.0,0.666666666667,False,0.0,False,text," ai  ai
"
1,3.0,0.0,1.0,False,0.0,False,text," ai1
"
14,4.5,0.285714285714,0.371428571429,True,1.0,True,heading," Theorem A.3 (Anderson [1]). The sequence 0(n), . . . , 2n(n) is log-concave.
"
13,5.30769230769,0.0,0.048951048951,False,0.0,True,after_body," We now provide some quantitative upper and lower bounds on the ratios i+1(n)/i(n)
"
19,3.47368421053,0.0,0.157894736842,False,0.0,False,text," which we used in Section 4. We obtain dierent bounds depending on whether 1  i  n 3,
"
11,1.0,0.0,0.363636363636,False,0.0,False,text," i = n  2 or i = n  1.
"
14,1.57142857143,0.178571428571,0.214285714286,True,1.0,True,heading," Lemma A.4. For n  4 and 1  i  n  3,
"
3,1.0,0.0,0.333333333333,False,0.0,False,body," n + 1
"
4,0.75,0.0,0.25,False,0.0,False,body," i + 1 
"
1,6.0,0.0,0.5,False,0.0,False,body," i+1(n)
"
5,2.0,0.0,0.683333333333,False,0.0,False,body," i(n)  i/2  i/2
"
1,3.0,0.0,1.33333333333,False,0.0,False,after_body," i/2
"
1,2.0,0.0,0.0,False,0.0,False,text," 32
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
3,1.33333333333,0.0,0.777777777778,False,0.0,False,text," n  i/2
"
3,2.33333333333,0.0,0.5,False,0.0,False,body," (i + 2)/2
"
1,1.0,0.0,1.0,False,0.0,False,after_body," .
"
17,4.17647058824,0.0588235294118,0.0882352941176,False,0.0,True,text," Proof. Begin by giving each element y of Li+1 a weight of 1 and then redistributing the
"
23,2.65217391304,0.0,0.282608695652,False,0.0,False,text," weight of y evenly among the x  Li with x  y. For 0  s  i/2, the weight recieved by
"
3,1.0,0.0,0.666666666667,False,0.0,False,text," x  Ls
"
3,4.0,0.0,0.333333333333,False,0.0,False,text," i is precisely
"
3,2.0,0.0,0.444444444444,False,0.0,False,text," f (s) :=
"
3,1.0,0.0,0.5,False,0.0,False,text," i  2s
"
3,0.666666666667,0.0,0.666666666667,False,0.0,False,text," i  s
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
5,0.8,0.0,0.6,False,0.0,False,text," n  i + s
"
5,0.8,0.0,0.4,False,0.0,False,text," i  s + 1
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
24,2.875,0.0,0.215277777778,False,0.0,True,text," Note that f (s) is well dened as i  1 and so s  i. We claim that f (s) is non-decreasing for
"
24,1.95833333333,0.0,0.266666666667,False,0.0,False,text," s in the range 0  s  i/2. Indeed, for i  2 and 0  s  (i  2)/2, we have
"
5,0.8,0.0,0.6,False,0.0,False,text," i  s + 1
"
5,0.8,0.0,0.6,False,0.0,False,text," n  i + s
"
5,0.6,0.0,0.3,False,0.0,False,text,"   i  2s
"
3,0.666666666667,0.0,0.666666666667,False,0.0,False,text," i  s
"
3,0.666666666667,0.0,0.666666666667,False,0.0,False,text," i  s
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
7,0.857142857143,0.0,0.428571428571,False,0.0,False,text," n  i + s + 1
"
13,1.15384615385,0.0,0.410256410256,False,0.0,False,text," f (s + 1)  f (s) = i  2s  2
"
5,0.6,0.0,0.4,False,0.0,False,text," i  s  1
"
13,1.07692307692,0.0,0.346153846154,False,0.0,False,text," s(n + i  1) + ni  n  i2  1
"
11,1.36363636364,0.0,0.295454545455,False,0.0,False,text," (i  s + 1)(i  s)(i  s  1)
"
8,4.0,0.0,0.0,False,0.0,False,text," 2 , this expression is bounded below by
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
1,1.0,0.0,1.0,False,0.0,False,text," .
"
8,1.625,0.0,0.5,False,0.0,True,text," Since n  i and s  i2
"
15,1.33333333333,0.0,0.233333333333,False,0.0,False,text," (i  2)(n + i  1) + 2ni  2n  2i2  2
"
11,1.45454545455,0.0,0.280303030303,False,0.0,False,text," 2(i  s + 1)(i  s)(i  s  1)
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
5,1.2,0.0,0.333333333333,False,0.0,False,text," i(n  i  3)
"
11,1.45454545455,0.0,0.280303030303,False,0.0,False,text," 2(i  s + 1)(i  s)(i  s  1)
"
18,4.0,0.0,0.166666666667,False,0.0,False,text," which is non-negative since i  n  3. Therefore, the total weight is bounded below by |Li|
"
10,4.4,0.0,0.05,False,0.0,False,text," multiplied by the weight recieved by an element of L0
"
7,4.57142857143,0.0,0.285714285714,False,0.0,False,text," i and bounded above by |Li| multiplied
"
9,4.0,0.0,0.138888888889,False,0.0,False,text," by the weight recieved by an element of Li/2
"
8,5.25,0.0,0.0,False,0.0,False,text," . However, clearly, the total weight is precisely
"
5,3.8,0.0,0.133333333333,False,0.0,False,text," |Li+1| and so we obtain
"
8,2.375,0.0,0.75,False,0.0,False,text," i + 1|Li|  |Li+1| i/2  i/2
"
4,0.75,0.0,0.25,False,0.0,False,text,"  n + 1
"
3,3.66666666667,0.0,0.625,False,0.0,False,text," (i + 2)/2|Li|
"
3,1.33333333333,0.0,0.777777777778,False,0.0,False,text," n  i/2
"
1,3.0,0.0,1.33333333333,False,0.0,False,text," i/2
"
1,1.0,0.0,0.0,False,0.0,False,text," +
"
1,1.0,0.0,1.0,False,0.0,False,text," i
"
2,5.0,0.0,0.0,False,0.0,False,text," as desired.
"
8,2.5,0.375,0.125,True,1.0,True,heading," Lemma A.5. For n  5 we have
"
3,1.0,0.0,0.333333333333,False,0.0,False,body," n + 2
"
2,0.5,0.0,0.5,False,0.0,False,after_body," n 
"
1,5.0,0.0,0.8,False,0.0,False,text," n1(n)
"
2,2.5,0.0,0.4,False,0.0,False,heading," n2(n) 
"
3,1.33333333333,0.0,0.166666666667,False,0.0,False,body," 4n + 7
"
3,1.0,0.0,0.166666666667,False,0.0,False,body," 4n  2
"
19,3.89473684211,0.0526315789474,0.0526315789474,False,0.0,True,after_body," Proof. Distribute weights to the elements of Li in the same way as in the proof of Lemma A.4
"
22,2.81818181818,0.0,0.151515151515,False,0.0,False,text," and dene f (s) in the same way as well, except that i = n  2. As in that proof, for
"
9,1.66666666667,0.0,0.266666666667,False,0.0,False,text," 0  s  (n  4)/2, we have
"
8,1.375,0.0,0.354166666667,False,0.0,False,text," f (s + 1)  f (s) =
"
19,1.21052631579,0.0,0.19298245614,False,0.0,False,text," s(n + (n  2)  1) + n(n  2)  n  (n  2)2  1
"
17,1.41176470588,0.0,0.172549019608,False,0.0,False,text," ((n  2)  s + 1)((n  2)  s)((n  2)  s  1)
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
5,1.0,0.0,0.4,False,0.0,False,text," 3s + n  5
"
13,1.15384615385,0.0,0.153846153846,False,0.0,False,text," (n  1  s)(n  2  s)(n  3  s)
"
12,3.33333333333,0.0,0.111111111111,False,0.0,False,text," 3 . So, we have that f (s) is non-decreasing in the
"
5,3.0,0.0,0.0,False,0.0,False,text," 2 . It follows that
"
10,3.3,0.0,0.2,False,0.0,False,text," which is non-negative if and only if s  n5
"
6,1.5,0.0,0.333333333333,False,0.0,False,text," range 0  s  n2
"
9,3.33333333333,0.0,0.111111111111,False,0.0,False,text," 3  and non-increasing in the range  n2
"
6,1.83333333333,0.0,0.625,False,0.0,False,text," minf (0), f n  2
"
4,1.25,0.0,0.0833333333333,False,0.0,False,text," 2  = n+2
"
6,0.666666666667,0.0,0.333333333333,False,0.0,False,text," 3   s  n2
"
9,1.55555555556,0.0,0.574074074074,False,0.0,False,text," 2 |Li|  |Li+1|  f n  2
"
3,1.66666666667,0.0,0.333333333333,False,0.0,False,text," 3  |Li|
"
4,1.5,0.0,0.0625,False,0.0,False,text," 3  = 4n+7
"
7,1.85714285714,0.0,0.714285714286,False,0.0,False,text," n1 = f (0) and f n2
"
2,2.0,0.0,0.333333333333,False,0.0,False,text," 4n2 .
"
3,1.33333333333,0.0,0.444444444444,False,0.0,False,text," n  n+1
"
7,3.85714285714,0.0,0.428571428571,False,0.0,False,text," and the result follows since f n2
"
1,2.0,0.0,0.0,False,0.0,False,text," 33
"
8,2.5,0.375,0.125,True,1.0,True,heading," Lemma A.6. For n  5 we have
"
7,1.71428571429,0.0,0.428571428571,False,0.0,False,body," (n  1)/2  (n  1)/2
"
3,2.0,0.0,0.5,False,0.0,False,text," (n  1)/2
"
4,2.0,0.0,0.375,False,0.0,False,body," + (n + 1)/2
"
4,1.75,0.0,0.375,False,0.0,False,text," (n + 1)/2 
"
1,4.0,0.0,0.75,False,0.0,False,text," n(n)
"
2,2.5,0.0,0.4,False,0.0,False,heading," n1(n) 
"
3,1.0,0.0,0.333333333333,False,0.0,False,body," n + 1
"
1,1.0,0.0,1.0,False,0.0,False,after_body," n
"
12,4.41666666667,0.0833333333333,0.0,False,0.0,True,text," Proof. Proceed as in the previous two proofs. This time, we have
"
8,1.375,0.0,0.354166666667,False,0.0,False,text," f (s + 1)  f (s) =
"
19,1.21052631579,0.0,0.19298245614,False,0.0,False,text," s(n + (n  1)  1) + n(n  1)  n  (n  1)2  1
"
17,1.41176470588,0.0,0.172549019608,False,0.0,False,text," ((n  1)  s + 1)((n  1)  s)((n  1)  s  1)
"
14,2.21428571429,0.0,0.309523809524,False,0.0,False,text," and so f (s) is decreasing in s for 0  s  n1
"
1,1.0,0.0,0.0,False,0.0,False,text," =
"
3,2.0,0.0,0.222222222222,False,0.0,False,text," 2(s + 1)
"
11,1.27272727273,0.0,0.181818181818,False,0.0,False,text," (n  s)(n  1  s)(n  2  s)
"
3,4.0,0.0,0.333333333333,False,0.0,False,text," 2 . Therefore,
"
7,2.85714285714,0.0,0.571428571429,False,0.0,False,text," and we are done since f n1
"
7,2.71428571429,0.0,0.534013605442,False,0.0,False,text," 2 |Li|  |Li+1|  f (0)|Li|
"
4,0.75,0.0,1.0,False,0.0,False,text," f n  1
"
4,3.5,0.0,0.229166666667,False,0.0,False,text," 2  = (n1)/2(n1)/2
"
1,6.0,0.0,0.833333333333,False,0.0,False,text," (n1)/2
"
2,4.0,0.0,0.285714285714,False,0.0,False,text," + (n+1)/2
"
1,7.0,0.0,0.571428571429,False,0.0,False,text," (n+1)/2
"
5,2.2,0.0,0.266666666667,False,0.0,False,text," and f (0) = n+1
"
2,1.0,0.0,0.5,False,0.0,False,text," n .
"
1,2.0,0.0,0.0,False,0.0,False,text," 34
"
